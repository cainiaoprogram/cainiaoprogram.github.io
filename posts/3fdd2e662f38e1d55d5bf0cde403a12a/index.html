<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python爬虫学习 爬取京东商品 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python爬虫学习 爬取京东商品" />
<meta property="og:description" content="1. 本节目标 以抓取京东 App 的商品信息和评论为例，实现 Appium 和 mitmdump 二者结合的抓取。抓取的数据分为两部分：一部分是商品信息，我们需要获取商品的 ID、名称和图片，将它们组成一条商品数据；另一部分是商品的评论信息，我们将评论人的昵称、评论正文、评论日期、发表图片都提取，然后加入商品 ID 字段，将它们组成一条评论数据。最后数据保存到 MongoDB 数据库。
2. 准备工作 请确保 PC 已经安装好 Charles、mitmdump、Appium、Android 开发环境，以及 Python 版本的 Appium API。Android 手机安装好京东 App。另外，安装好 MongoDB 并运行其服务，安装 PyMongo 库。具体的配置过程可以参考第 1 章。
3. Charles 抓包分析 首先，我们将手机代理设置到 Charles 上，用 Charles 抓包分析获取商品详情和商品评论的接口。
获取商品详情的接口，这里提取到的接口是来自 cdnware.m.jd.com 的链接，返回结果是一个 JSON 字符串，里面包含了商品的 ID 和商品名称，如图 11-47 和图 11-48 所示。
再获取商品评论的接口，这个过程在前文已提到，在此不再赘述。这个接口来自 api.m.jd.com，返回结果也是 JSON 字符串，里面包含了商品的数条评论信息。
之后我们可以用 mitmdump 对接一个 Python 脚本来实现数据的抓取。
4. mitmdump 抓取 新建一个脚本文件，然后实现这个脚本以提取这两个接口的数据。首先提取商品的信息，代码如下所示：
这里声明了接口的部分链接内容，然后与请求的 URL 作比较。如果该链接出现在当前的 URL 中，那就证明当前的响应就是商品详情的响应，然后提取对应的 JSON 信息即可。在这里我们将商品的 ID、名称和图片提取出来，这就是一条商品数据。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3fdd2e662f38e1d55d5bf0cde403a12a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-06T17:26:18+08:00" />
<meta property="article:modified_time" content="2023-05-06T17:26:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python爬虫学习 爬取京东商品</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1__0"></a>1. 本节目标</h3> 
<p>以抓取京东 App 的商品信息和评论为例，实现 Appium 和 mitmdump 二者结合的抓取。抓取的数据分为两部分：一部分是商品信息，我们需要获取商品的 ID、名称和图片，将它们组成一条商品数据；另一部分是商品的评论信息，我们将评论人的昵称、评论正文、评论日期、发表图片都提取，然后加入商品 ID 字段，将它们组成一条评论数据。最后数据保存到 MongoDB 数据库。</p> 
<h3><a id="2__4"></a>2. 准备工作</h3> 
<p>请确保 PC 已经安装好 Charles、mitmdump、Appium、Android 开发环境，以及 Python 版本的 Appium API。Android 手机安装好京东 App。另外，安装好 MongoDB 并运行其服务，安装 PyMongo 库。具体的配置过程可以参考第 1 章。</p> 
<h3><a id="3_Charles__8"></a>3. Charles 抓包分析</h3> 
<p>首先，我们将手机代理设置到 Charles 上，用 Charles 抓包分析获取商品详情和商品评论的接口。</p> 
<p>获取商品详情的接口，这里提取到的接口是来自 cdnware.m.jd.com 的链接，返回结果是一个 JSON 字符串，里面包含了商品的 ID 和商品名称，如图 11-47 和图 11-48 所示。</p> 
<p><img src="https://images2.imgbox.com/82/cd/hmJrKQzN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/96/9c/Y2vPP6Ut_o.png" alt="在这里插入图片描述"><br> 再获取商品评论的接口，这个过程在前文已提到，在此不再赘述。这个接口来自 api.m.jd.com，返回结果也是 JSON 字符串，里面包含了商品的数条评论信息。</p> 
<p>之后我们可以用 mitmdump 对接一个 Python 脚本来实现数据的抓取。</p> 
<h3><a id="4_mitmdump__20"></a>4. mitmdump 抓取</h3> 
<p>新建一个脚本文件，然后实现这个脚本以提取这两个接口的数据。首先提取商品的信息，代码如下所示：</p> 
<p><img src="https://images2.imgbox.com/28/4a/zfYkbZZ0_o.png" alt="在这里插入图片描述"><br> 这里声明了接口的部分链接内容，然后与请求的 URL 作比较。如果该链接出现在当前的 URL 中，那就证明当前的响应就是商品详情的响应，然后提取对应的 JSON 信息即可。在这里我们将商品的 ID、名称和图片提取出来，这就是一条商品数据。</p> 
<p>再提取评论的数据，代码实现如下所示：</p> 
<p><img src="https://images2.imgbox.com/3f/30/bBaDFZDD_o.png" alt="在这里插入图片描述"><br> 这里指定了接口的部分链接内容，以判断当前请求的 URL 是不是获取评论的 URL。如果满足条件，那么就提取商品的 ID 和评论信息。</p> 
<p>商品的 ID 实际上隐藏在请求中，我们需要提取请求的表单内容来提取商品的 ID，这里直接用了正则表达式。</p> 
<p>商品的评论信息在响应中，我们像刚才一样提取了响应的内容，然后对 JSON 进行解析，最后提取出商品评论人的昵称、评论正文、评论日期和图片信息。这些信息和商品的 ID 组合起来，形成一条评论数据。</p> 
<p>最后用 MongoDB 将两部分数据分开保存到两个 Collection，在此不再赘述。</p> 
<p>运行此脚本，命令如下所示：</p> 
<p><img src="https://images2.imgbox.com/81/7b/c3JSJfRL_o.png" alt="在这里插入图片描述"><br> 手机的代理设置到 mitmdump 上。我们在京东 App 中打开某个商品，下拉商品评论部分，即可看到控制台输出两部分的抓取结果，结果成功保存到 MongoDB 数据库，如图 11-49 所示。</p> 
<p><img src="https://images2.imgbox.com/d7/b4/wYFya2WY_o.png" alt="在这里插入图片描述"><br> 如果我们手动操作京东 App 就可以做到京东商品评论的抓取了，下一步要做的就是实现自动滚动刷新。</p> 
<h3><a id="5_Appium__46"></a>5. Appium 自动化</h3> 
<p>将 Appium 对接到手机上，用 Appium 驱动 App 完成一系列动作。进入 App 后，我们需要做的操作有点击搜索框、输入搜索的商品名称、点击进入商品详情、进入评论页面、自动滚动刷新，基本的操作逻辑和爬取微信朋友圈的相同。</p> 
<p>京东 App 的 Desired Capabilities 配置如下所示：</p> 
<p><img src="https://images2.imgbox.com/ec/21/LBqj9ecu_o.png" alt="在这里插入图片描述"><br> 首先用 Appium 内置的驱动打开京东 App</p> 
<p><img src="https://images2.imgbox.com/d6/c1/1PHJtghs_o.png" alt="在这里插入图片描述"><br> 这里进行一系动作操作并录制下来，找到各个页面的组件的 ID 并做好记录，最后再改写成完整的代码。参考代码实现如下所示：</p> 
<p><img src="https://images2.imgbox.com/23/68/utziIBOi_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/cb/cc/HjCyBTLy_o.png" alt="在这里插入图片描述"><br> 代码实现比较简单，逻辑与上一节微信朋友圈的抓取类似。注意，由于 App 版本更新的原因，交互流程和元素 ID 可能有更改，这里的代码仅做参考。</p> 
<p>下拉过程已经省去了用 Appium 提取数据的过程，因为这个过程我们已经用 mitmdump 帮助实现了。</p> 
<p>代码运行之后便会启动京东 App，进入商品的详情页，然后进入评论页再无限滚动，这样就代替了人工操作。Appium 实现模拟滚动，mitmdump 进行抓取，这样 App 的数据就会保存到数据库中。</p> 
<h3><a id="_66"></a>结语</h3> 
<p>以上内容便是 Appium 和 mitmdump 抓取京东 App 数据的过程。有了两者的配合，我们既可以做到实时数据处理，又可以实现自动化爬取，这样就可以完成绝大多数 App 的爬取了。</p> 
<h3><a id="httpsblogcsdnnetJavachichiarticledetails122513096spm1001201430015501Python_70"></a><a href="https://blog.csdn.net/Javachichi/article/details/122513096?spm=1001.2014.3001.5501"></a>关于Python技术储备</h3> 
<p>学好 Python 不论是就业还是做副业赚钱都不错，但要学会 Python 还是要有一个学习规划。最后大家分享一份全套的 Python 学习资料，给那些想学习 Python 的小伙伴们一点帮助！</p> 
<p><strong>对于0基础小白入门：</strong></p> 
<blockquote> 
 <p>如果你是零基础小白，想快速入门Python是可以考虑的。</p> 
 <p>一方面是学习时间相对较短，学习内容更全面更集中。<br> 二方面是可以找到适合自己的学习方案</p> 
</blockquote> 
<p>包括：Python激活码+安装包、Python web开发，Python爬虫，Python数据分析，人工智能、机器学习等习教程。带你从零基础系统性的学好Python！</p> 
<h2><a id="httpsblogcsdnnetSpringJavaMyBatisarticledetails129155908spm1001201430015501Python_84"></a><a href="https://blog.csdn.net/SpringJavaMyBatis/article/details/129155908?spm=1001.2014.3001.5501"></a>零基础Python学习资源介绍</h2> 
<h3><a id="httpsblogcsdnnetSpringJavaMyBatisarticledetails129155908spm1001201430015501Python_87"></a><a href="https://blog.csdn.net/SpringJavaMyBatis/article/details/129155908?spm=1001.2014.3001.5501"></a>👉Python学习路线汇总👈</h3> 
<p>Python所有方向的技术点做的整理，形成各个领域的知识点汇总，它的用处就在于，你可以按照上面的知识点去找对应的学习资源，保证自己学得较为全面。<strong>（全套教程文末领取哈）</strong><br> <img src="https://images2.imgbox.com/5e/d8/kFOwN9H2_o.png" alt=""></p> 
<h3><a id="httpsblogcsdnnetSpringJavaMyBatisarticledetails129155908spm1001201430015501Python_93"></a><a href="https://blog.csdn.net/SpringJavaMyBatis/article/details/129155908?spm=1001.2014.3001.5501"></a>👉Python必备开发工具👈</h3> 
<p><img src="https://images2.imgbox.com/8a/58/k9AZlbaB_o.png" alt=""></p> 
<p><strong>温馨提示：篇幅有限，已打包文件夹，获取方式在：文末</strong></p> 
<h3><a id="httpsblogcsdnnetSpringJavaMyBatisarticledetails129155908spm1001201430015501Python600_100"></a><a href="https://blog.csdn.net/SpringJavaMyBatis/article/details/129155908?spm=1001.2014.3001.5501"></a>👉Python学习视频600合集👈</h3> 
<p>观看零基础学习视频，看视频学习是最快捷也是最有效果的方式，跟着视频中老师的思路，从基础到深入，还是很容易入门的。<br> <img src="https://images2.imgbox.com/69/1d/EBTaKvij_o.png" alt=""></p> 
<h3><a id="httpsblogcsdnnetSpringJavaMyBatisarticledetails129155908spm1001201430015501_106"></a><a href="https://blog.csdn.net/SpringJavaMyBatis/article/details/129155908?spm=1001.2014.3001.5501"></a>👉实战案例👈</h3> 
<p>光学理论是没用的，要学会跟着一起敲，要动手实操，才能将自己的所学运用到实际当中去，这时候可以搞点实战案例来学习。<br> <img src="https://images2.imgbox.com/c7/05/a7V30nLe_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="httpsblogcsdnnetSpringJavaMyBatisarticledetails129155908spm1001201430015501100Python_112"></a><a href="https://blog.csdn.net/SpringJavaMyBatis/article/details/129155908?spm=1001.2014.3001.5501"></a>👉100道Python练习题👈</h3> 
<p>检查学习结果。<img src="https://images2.imgbox.com/79/54/0pxeElYh_o.png" alt=""></p> 
<h3><a id="httpsblogcsdnnetSpringJavaMyBatisarticledetails129155908spm1001201430015501_117"></a><a href="https://blog.csdn.net/SpringJavaMyBatis/article/details/129155908?spm=1001.2014.3001.5501"></a>👉面试刷题👈</h3> 
<p><img src="https://images2.imgbox.com/39/73/blvIJlkc_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/c5/bc/yJcihOAG_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/89/51/hyvFpkBG_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="httpsblogcsdnnetJavachichiarticledetails122513096spm1001201430015501httpsblogcsdnnetm0_57081622articledetails122378123spm1001201430015501PythonCSDNCSDN100_126"></a><a href="https://blog.csdn.net/Javachichi/article/details/122513096?spm=1001.2014.3001.5501"></a><a href="https://blog.csdn.net/m0_57081622/article/details/122378123?spm=1001.2014.3001.5501"></a>这份完整版的Python全套学习资料已经上传CSDN，朋友们如果需要可以微信扫描下方CSDN官方认证二维码免费领取【<code>保证100%免费</code>】</h6> 
<p><img src="https://images2.imgbox.com/29/64/aNzpqL8o_o.png" alt=""></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fbdc9dd656886f8825671a092274050b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">达梦数据库查询所有外键约束并关闭</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b38d3b24c2bf3a4905c48366b7595e55/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java面试题复习(1）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>