<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>操作系统资源限制问题（Memory Analyzer使用OutOfMemoryError） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="操作系统资源限制问题（Memory Analyzer使用OutOfMemoryError）" />
<meta property="og:description" content="java8使用Memory Analyzer大概是10左右的版本，用最新版本要java17
MemoryAnalyzer-1.10.0.20200225-win32.win32.x86_64
MAT(Memory Analyzer Tool)下载
https://www.cnblogs.com/zwh0910/p/15774590.html
Eclipse downloads - Select a mirror | The Eclipse Foundation
Eclipse Memory Analyzer Open Source Project | The Eclipse Foundation
Memory Analyzer使用教程 - 掘金
问题处理参考 记录flink taskmanager 生产环境 unable to create new native thread · 语雀
sudo vi /etc/security/limits.d/20-nproc.conf * soft nproc unlimited root soft nproc unlimited * hard nproc unlimited root hard nproc unlimited ulimit -u ulimit -u 65535 vi ~/.bash_profile vi ~/." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f949b4cece1303c4fb5922b56cbf766c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-25T10:16:37+08:00" />
<meta property="article:modified_time" content="2023-07-25T10:16:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">操作系统资源限制问题（Memory Analyzer使用OutOfMemoryError）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>java8使用Memory Analyzer大概是10左右的版本，用最新版本要java17</p> 
<p>MemoryAnalyzer-1.10.0.20200225-win32.win32.x86_64</p> 
<p><a href="https://www.cnblogs.com/zwh0910/p/15774590.html" rel="nofollow" id="cb_post_title_url" title="MAT(Memory Analyzer Tool">MAT(Memory Analyzer Tool</a>)下载</p> 
<p><a href="https://www.cnblogs.com/zwh0910/p/15774590.html" rel="nofollow" title="https://www.cnblogs.com/zwh0910/p/15774590.html">https://www.cnblogs.com/zwh0910/p/15774590.html</a></p> 
<p><a href="https://www.eclipse.org/downloads/download.php?file=/mat/1.14.0/rcp/MemoryAnalyzer-1.14.0.20230315-win32.win32.x86_64.zip" rel="nofollow" title="Eclipse downloads - Select a mirror | The Eclipse Foundation">Eclipse downloads - Select a mirror | The Eclipse Foundation</a></p> 
<p><a href="https://eclipse.dev/mat/previousReleases.php" rel="nofollow" title="Eclipse Memory Analyzer Open Source Project | The Eclipse Foundation">Eclipse Memory Analyzer Open Source Project | The Eclipse Foundation</a></p> 
<p><a href="https://juejin.cn/post/7077108758865772575" rel="nofollow" title="Memory Analyzer使用教程 - 掘金">Memory Analyzer使用教程 - 掘金</a></p> 
<h2>问题处理参考</h2> 
<p><a href="https://www.yuque.com/xiahua-1lcq8/ugrkrz/gn52vo?#%20%E3%80%8A%E8%AE%B0%E5%BD%95flink%E7%BA%BF%E4%B8%8Aunable%20to%20create%20new%20native%20thread%E3%80%8B" rel="nofollow" title="记录flink taskmanager 生产环境 unable to create new native thread · 语雀">记录flink taskmanager 生产环境 unable to create new native thread · 语雀</a></p> 
<pre><code>sudo vi /etc/security/limits.d/20-nproc.conf
*          soft    nproc     unlimited
root       soft    nproc     unlimited
*          hard    nproc     unlimited
root       hard    nproc     unlimited

ulimit -u
ulimit -u 65535
vi ~/.bash_profile
vi ~/.bashrc
~/.bash_profile 是交互式、login 方式进入 bash 运行的
~/.bashrc 是交互式 non-login 方式进入 bash 运行的
source ~/.bash_profile

sudo vi /etc/security/limits.conf
* soft nproc 65535
* hard nproc 65535


# 通过端口号确定进程号
netstat -tnlp |grep 52345

# 通过进程ID拉取dump
jmap -dump:format=b,file=~/flink-taskmanager.hprof 进程ID</code></pre> 
<p>国外文章</p> 
<p><a href="https://dzone.com/articles/troubleshoot-outofmemoryerror-unable-to-create-new" rel="nofollow" title="Troubleshoot OutOfMemoryError: Unable to Create New Native Thread - DZone">Troubleshoot OutOfMemoryError: Unable to Create New Native Thread - DZone</a></p> 
<pre><code>There is no room in the memory to accommodate new threads.
The number of threads exceeds the Operating System limit.</code></pre> 
<p>在线内存分析使用</p> 
<p><a href="https://blog.csdn.net/weixin_30484149/article/details/112693697" title="高逼格可视化在线内存分析工具(Java Memory Head Dump Analyzer Tool）_在线分析dump_帅帅的Max的博客-CSDN博客">高逼格可视化在线内存分析工具(Java Memory Head Dump Analyzer Tool）_在线分析dump_帅帅的Max的博客-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/weixin_47019045/article/details/125498018" title="flink任务内存调优，TaskManager、JobManager内存配置_flink内存调优_大数据动物园的博客-CSDN博客">flink任务内存调优，TaskManager、JobManager内存配置_flink内存调优_大数据动物园的博客-CSDN博客</a></p> 
<h2>使用教程</h2> 
<p><a href="https://www.cnblogs.com/trust-freedom/p/6744948.html" rel="nofollow" title="https://www.cnblogs.com/trust-freedom/p/6744948.html">https://www.cnblogs.com/trust-freedom/p/6744948.html</a></p> 
<h3>使用测试 </h3> 
<pre><code class="hljs">public class OOMHeapTest {
    public static void main(String[] args){
        oom();
    }

    private static void oom(){
        Map&lt;String, OOMBean&gt; map = new HashMap&lt;String, OOMBean&gt;();
        Object[] array = new Object[1000000];
        for(int i=0; i&lt;1000000; i++){
            String d = new Date().toString();
            OOMBean o = new OOMBean(d, i);
            map.put(i+"_oom", o);
            array[i] = o;
        }
    }

    private static class OOMBean {
        private String d;
        private Integer i;
        public OOMBean(String d, int i) {
            d=d;
            i=i;
        }
    }
}</code></pre> 
<p>jvm参数设置</p> 
<pre><code class="hljs">-Xms10m  -Xmx10m  -XX:+HeapDumpOnOutOfMemoryError</code></pre> 
<p><img alt="" height="127" src="https://images2.imgbox.com/02/b0/T7fOT6ml_o.png" width="742"></p> 
<p>生成文件如下</p> 
<p> <img alt="" height="624" src="https://images2.imgbox.com/67/69/zNepV0H7_o.png" width="988"></p> 
<p>用MA加载得到</p> 
<p><img alt="" height="1040" src="https://images2.imgbox.com/4d/80/DVvPp1EM_o.png" width="1200"> </p> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e0e8a6bfaa6c0850fcbe59486453e3aa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">「问题」Mapper层无法正确映射子查询的结果的解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/85fa0476ccb4065c9dcda88da4303f10/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vscode debug时 stepinto 无法跳进代码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>