<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>如何查找native服务的接口实现 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="如何查找native服务的接口实现" />
<meta property="og:description" content="以Netd为例：
首先adb看一下服务的接口：
接口文件是INetd，去源码找一下INetd.aidl
已经确定了接口API，对于native服务端的实现，一般的继承顺序为：
根据继承关系，对于BnXxx/XxxService 对象，含有三张虚表
虚表1 虚表1（来自IXxx）
01destructor02destructor03android::BnInterface::onAsBinder(void)04getInterfaceDescriptor()05 ~ (04&#43;n)n个接口 ... ...05&#43;ngetInterfaceVersion(void)06&#43;nqueryLocalInterface(const String16&amp; _descriptor)07&#43;nonTransact(uint32_t code, const Parcel&amp; data, Parcel* reply, uint32_t flags) 虚表2 虚表2（来自BBinder）
01queryLocalInterface(const String16&amp; _descriptor)02getInterfaceDescriptor()03android::BBinder::isBinderAlive(void)04android::BBinder::pingBinder(void)05android::BBinder::dump(int,android::Vector&lt;android::String16&gt; const&amp;)06android::BBinder::transact(uint,android::Parcel const&amp;,android::Parcel*,uint)07android::BBinder::linkToDeath(android::sp&lt;android::IBinder::DeathRecipient&gt; const&amp;,void *,uint)08android::BBinder::unlinkToDeath(android::wp&lt;android::IBinder::DeathRecipient&gt; const&amp;,void ,uint,android::wp&lt;android::IBinder::DeathRecipient&gt;)09android::IBinder::checkSubclass(void const*)10android::BBinder::attachObject(void const*,void ,void ,void ()(void const,void *,void *))11android::BBinder::findObject(void const*)12android::BBinder::detachObject(void const*)13android::BBinder::localBinder(void)14android::IBinder::remoteBinder(void) 虚表3 虚表3（来自RefBase）
01destructor02destructor03android::RefBase::onFirstRef(void)04android::RefBase::onLastStrongRef(void const*)05android::RefBase::onIncStrongAttempted(uint,void const*)06android::RefBase::onLastWeakRef(void const*) 下面在IDA中查找其具体API地址。先从手机中CP出system目录，在/system/bin 下面找到netd可执行程序，IDA打开。搜索BnNetd虚表中的函数，直接搜“BnNetd::onTransact”
查找引用定位虚表，一般虚表位于.data.rel.ro节中
定位到.data.rel.ro中的这一项，当虚表顺序满足Bn对象的虚表顺序时，这就是Bn对象的虚表（第二张虚表几乎全为导入函数，辨识度很高）
虚表一：
虚表二：
虚表三：
虚表一中getInterfaceVersion函数上面就是接口函数列表，IDA没有识别为函数，且还需要对该列表进行重命名，写一个IDA脚本来完成：
import idc import ida_funcs import ida_bytes import ida_idaapi ApiLists = &#39;&#39;&#39; android::net::INetdDefault::isAlive(bool *)	." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/7c27326ce5b085648c45f6c0ae8fdc65/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-08T10:36:10+08:00" />
<meta property="article:modified_time" content="2024-01-08T10:36:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">如何查找native服务的接口实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>以Netd为例：</p> 
<p>首先adb看一下服务的接口：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/0e/c2/a2bRWpL9_o.png"></p> 
<p>接口文件是INetd，去源码找一下INetd.aidl</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/46/23/BS8pdrDH_o.png"></p> 
<p>已经确定了接口API，对于native服务端的实现，一般的继承顺序为：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/30/38/HH9CcPHv_o.png"></p> 
<p>根据继承关系，对于BnXxx/XxxService 对象，含有三张虚表</p> 
<h4 id="id-常见的native层binder继承关系-虚表1">虚表1</h4> 
<table><thead><tr><th colspan="1"> <p></p> </th><th> <p>虚表1（来自IXxx）</p> </th></tr></thead><tbody><tr><td colspan="1">01</td><td>destructor</td></tr><tr><td colspan="1">02</td><td>destructor</td></tr><tr><td colspan="1">03</td><td>android::BnInterface::onAsBinder(void)</td></tr><tr><td colspan="1">04</td><td>getInterfaceDescriptor()</td></tr><tr><td colspan="1">05 ~ (04+n)</td><td>n个接口 ... ...</td></tr><tr><td colspan="1">05+n</td><td>getInterfaceVersion(void)</td></tr><tr><td colspan="1">06+n</td><td>queryLocalInterface(const String16&amp; _descriptor)</td></tr><tr><td colspan="1">07+n</td><td>onTransact(uint32_t code, const Parcel&amp; data, Parcel* reply, uint32_t flags)</td></tr></tbody></table> 
<h4 id="id-常见的native层binder继承关系-虚表2">虚表2</h4> 
<table><thead><tr><th colspan="1"> <p></p> </th><th> <p>虚表2（来自BBinder）</p> </th></tr></thead><tbody><tr><td colspan="1">01</td><td>queryLocalInterface(const String16&amp; _descriptor)</td></tr><tr><td colspan="1">02</td><td>getInterfaceDescriptor()</td></tr><tr><td colspan="1">03</td><td>android::BBinder::isBinderAlive(void)</td></tr><tr><td colspan="1">04</td><td>android::BBinder::pingBinder(void)</td></tr><tr><td colspan="1">05</td><td>android::BBinder::dump(int,android::Vector&lt;android::String16&gt; const&amp;)</td></tr><tr><td colspan="1">06</td><td>android::BBinder::transact(uint,android::Parcel const&amp;,android::Parcel*,uint)</td></tr><tr><td colspan="1">07</td><td>android::BBinder::linkToDeath(android::sp&lt;android::IBinder::DeathRecipient&gt; const&amp;,void *,uint)</td></tr><tr><td colspan="1">08</td><td>android::BBinder::unlinkToDeath(android::wp&lt;android::IBinder::DeathRecipient&gt; const&amp;,void <em>,uint,android::wp&lt;android::IBinder::DeathRecipient&gt;</em>)</td></tr><tr><td colspan="1">09</td><td>android::IBinder::checkSubclass(void const*)</td></tr><tr><td colspan="1">10</td><td>android::BBinder::attachObject(void const*,void <em>,void <em>,void (</em>)(void const</em>,void *,void *))</td></tr><tr><td colspan="1">11</td><td>android::BBinder::findObject(void const*)</td></tr><tr><td colspan="1">12</td><td>android::BBinder::detachObject(void const*)</td></tr><tr><td colspan="1">13</td><td>android::BBinder::localBinder(void)</td></tr><tr><td colspan="1">14</td><td>android::IBinder::remoteBinder(void)</td></tr></tbody></table> 
<h4 id="id-常见的native层binder继承关系-虚表3">虚表3</h4> 
<table><thead><tr><th colspan="1"> <p></p> </th><th> <p>虚表3（来自RefBase）</p> </th></tr></thead><tbody><tr><td colspan="1">01</td><td>destructor</td></tr><tr><td colspan="1">02</td><td>destructor</td></tr><tr><td colspan="1">03</td><td>android::RefBase::onFirstRef(void)</td></tr><tr><td colspan="1">04</td><td>android::RefBase::onLastStrongRef(void const*)</td></tr><tr><td colspan="1">05</td><td>android::RefBase::onIncStrongAttempted(uint,void const*)</td></tr><tr><td colspan="1">06</td><td>android::RefBase::onLastWeakRef(void const*)</td></tr></tbody></table> 
<p>下面在IDA中查找其具体API地址。先从手机中CP出system目录，在/system/bin 下面找到netd可执行程序，IDA打开。搜索BnNetd虚表中的函数，直接搜“BnNetd::onTransact”</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/74/d0/Kfw4v2Tz_o.png"></p> 
<p>查找引用定位虚表，一般虚表位于.data.rel.ro节中</p> 
<p>定位到.data.rel.ro中的这一项，当虚表顺序满足Bn对象的虚表顺序时，这就是Bn对象的虚表（第二张虚表几乎全为导入函数，辨识度很高）</p> 
<p>虚表一：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/48/8e/tU8vKBWn_o.png"></p> 
<p>虚表二：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/89/30/sswlomFV_o.png"></p> 
<p>虚表三：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/cc/9e/phiDKKTY_o.png"></p> 
<p>虚表一中getInterfaceVersion函数上面就是接口函数列表，IDA没有识别为函数，且还需要对该列表进行重命名，写一个IDA脚本来完成：</p> 
<pre><code class="hljs">
import idc
import ida_funcs
import ida_bytes
import ida_idaapi



ApiLists = '''
android::net::INetdDefault::isAlive(bool *)	.text	00000000000158D8	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::firewallReplaceUidChain(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,bool,std::__1::vector&lt;int,std::__1::allocator&lt;int&gt;&gt; const&amp;,bool *)	.text	00000000000158E0	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::bandwidthEnableDataSaver(bool,bool *)	.text	00000000000158E8	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::networkCreatePhysical(int,int)	.text	00000000000158F0	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::networkCreateVpn(int,bool)	.text	00000000000158F8	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::networkDestroy(int)	.text	0000000000015900	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::networkAddInterface(int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015908	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::networkRemoveInterface(int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015910	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::networkAddUidRanges(int,std::__1::vector&lt;android::net::UidRangeParcel,std::__1::allocator&lt;android::net::UidRangeParcel&gt;&gt; const&amp;)	.text	0000000000015918	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::networkRemoveUidRanges(int,std::__1::vector&lt;android::net::UidRangeParcel,std::__1::allocator&lt;android::net::UidRangeParcel&gt;&gt; const&amp;)	.text	0000000000015920	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::networkRejectNonSecureVpn(bool,std::__1::vector&lt;android::net::UidRangeParcel,std::__1::allocator&lt;android::net::UidRangeParcel&gt;&gt; const&amp;)	.text	0000000000015928	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::socketDestroy(std::__1::vector&lt;android::net::UidRangeParcel,std::__1::allocator&lt;android::net::UidRangeParcel&gt;&gt; const&amp;,std::__1::vector&lt;int,std::__1::allocator&lt;int&gt;&gt; const&amp;)	.text	0000000000015930	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::tetherApplyDnsInterfaces(bool *)	.text	0000000000015938	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::tetherGetStats(std::__1::vector&lt;android::net::TetherStatsParcel,std::__1::allocator&lt;android::net::TetherStatsParcel&gt;&gt; *)	.text	0000000000015940	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::interfaceAddAddress(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int)	.text	0000000000015948	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::interfaceDelAddress(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int)	.text	0000000000015950	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::getProcSysNet(int,int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;*)	.text	0000000000015958	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::setProcSysNet(int,int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015960	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipSecSetEncapSocketOwner(android::os::ParcelFileDescriptor const&amp;,int)	.text	0000000000015968	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::ipSecAllocateSpi(int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int,int *)	.text	0000000000015970	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipSecAddSecurityAssociation(int,int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int,int,int,int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::vector&lt;uchar,std::__1::allocator&lt;uchar&gt;&gt; const&amp;,int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::vector&lt;uchar,std::__1::allocator&lt;uchar&gt;&gt; const&amp;,int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::vector&lt;uchar,std::__1::allocator&lt;uchar&gt;&gt; const&amp;,int,int,int,int,int)	.text	0000000000015978	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipSecDeleteSecurityAssociation(int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int,int,int,int)	.text	0000000000015980	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipSecApplyTransportModeTransform(android::os::ParcelFileDescriptor const&amp;,int,int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int)	.text	0000000000015988	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipSecRemoveTransportModeTransform(android::os::ParcelFileDescriptor const&amp;)	.text	0000000000015990	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::ipSecAddSecurityPolicy(int,int,int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int,int,int,int)	.text	0000000000015998	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipSecUpdateSecurityPolicy(int,int,int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int,int,int,int)	.text	00000000000159A0	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipSecDeleteSecurityPolicy(int,int,int,int,int,int)	.text	00000000000159A8	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::ipSecAddTunnelInterface(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int,int,int)	.text	00000000000159B0	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipSecUpdateTunnelInterface(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int,int,int)	.text	00000000000159B8	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipSecRemoveTunnelInterface(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	00000000000159C0	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::wakeupAddInterface(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int,int)	.text	00000000000159C8	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::wakeupDelInterface(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int,int)	.text	00000000000159D0	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::setIPv6AddrGenMode(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int)	.text	00000000000159D8	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::idletimerAddInterface(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	00000000000159E0	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::idletimerRemoveInterface(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	00000000000159E8	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::strictUidCleartextPenalty(int,int)	.text	00000000000159F0	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::clatdStart(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;*)	.text	00000000000159F8	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::clatdStop(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015A00	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipfwdEnabled(bool *)	.text	0000000000015A08	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::ipfwdGetRequesterList(std::__1::vector&lt;std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;,std::__1::allocator&lt;std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;&gt;&gt; *)	.text	0000000000015A10	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipfwdEnableForwarding(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015A18	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipfwdDisableForwarding(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015A20	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipfwdAddInterfaceForward(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015A28	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::ipfwdRemoveInterfaceForward(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015A30	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::bandwidthSetInterfaceQuota(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,long)	.text	0000000000015A38	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::bandwidthRemoveInterfaceQuota(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015A40	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::bandwidthSetInterfaceAlert(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,long)	.text	0000000000015A48	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::bandwidthRemoveInterfaceAlert(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015A50	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::bandwidthSetGlobalAlert(long)	.text	0000000000015A58	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::bandwidthAddNaughtyApp(int)	.text	0000000000015A60	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::bandwidthRemoveNaughtyApp(int)	.text	0000000000015A68	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::bandwidthAddNiceApp(int)	.text	0000000000015A70	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::bandwidthRemoveNiceApp(int)	.text	0000000000015A78	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::tetherStart(std::__1::vector&lt;std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;,std::__1::allocator&lt;std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;&gt;&gt; const&amp;)	.text	0000000000015A80	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::tetherStop(void)	.text	0000000000015A88	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::tetherIsEnabled(bool *)	.text	0000000000015A90	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::tetherInterfaceAdd(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015A98	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::tetherInterfaceRemove(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015AA0	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::tetherInterfaceList(std::__1::vector&lt;std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;,std::__1::allocator&lt;std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;&gt;&gt; *)	.text	0000000000015AA8	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::tetherDnsSet(int,std::__1::vector&lt;std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;,std::__1::allocator&lt;std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;&gt;&gt; const&amp;)	.text	0000000000015AB0	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::tetherDnsList(std::__1::vector&lt;std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;,std::__1::allocator&lt;std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;&gt;&gt; *)	.text	0000000000015AB8	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::networkAddRoute(int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015AC0	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::networkRemoveRoute(int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015AC8	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::networkAddLegacyRoute(int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int)	.text	0000000000015AD0	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::networkRemoveLegacyRoute(int,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int)	.text	0000000000015AD8	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::networkGetDefault(int *)	.text	0000000000015AE0	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::networkSetDefault(int)	.text	0000000000015AE8	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::networkClearDefault(void)	.text	0000000000015AF0	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::networkSetPermissionForNetwork(int,int)	.text	0000000000015AF8	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::networkSetPermissionForUser(int,std::__1::vector&lt;int,std::__1::allocator&lt;int&gt;&gt; const&amp;)	.text	0000000000015B00	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::networkClearPermissionForUser(std::__1::vector&lt;int,std::__1::allocator&lt;int&gt;&gt; const&amp;)	.text	0000000000015B08	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::trafficSetNetPermForUids(int,std::__1::vector&lt;int,std::__1::allocator&lt;int&gt;&gt; const&amp;)	.text	0000000000015B10	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::networkSetProtectAllow(int)	.text	0000000000015B18	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::networkSetProtectDeny(int)	.text	0000000000015B20	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::networkCanProtect(int,bool *)	.text	0000000000015B28	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::firewallSetFirewallType(int)	.text	0000000000015B30	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::firewallSetInterfaceRule(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int)	.text	0000000000015B38	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::firewallSetUidRule(int,int,int)	.text	0000000000015B40	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::firewallEnableChildChain(int,bool)	.text	0000000000015B48	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::interfaceGetList(std::__1::vector&lt;std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;,std::__1::allocator&lt;std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt;&gt;&gt; *)	.text	0000000000015B50	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::interfaceGetCfg(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,android::net::InterfaceConfigurationParcel *)	.text	0000000000015B58	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::interfaceSetCfg(android::net::InterfaceConfigurationParcel const&amp;)	.text	0000000000015B60	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::interfaceSetIPv6PrivacyExtensions(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,bool)	.text	0000000000015B68	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::interfaceClearAddrs(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015B70	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::interfaceSetEnableIPv6(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,bool)	.text	0000000000015B78	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::interfaceSetMtu(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,int)	.text	0000000000015B80	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::tetherAddForward(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015B88	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::tetherRemoveForward(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015B90	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::setTcpRWmemorySize(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;)	.text	0000000000015B98	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::registerUnsolicitedEventListener(android::sp&lt;android::net::INetdUnsolicitedEventListener&gt; const&amp;)	.text	0000000000015BA0	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::firewallAddUidInterfaceRules(std::__1::basic_string&lt;char,std::__1::char_traits&lt;char&gt;,std::__1::allocator&lt;char&gt;&gt; const&amp;,std::__1::vector&lt;int,std::__1::allocator&lt;int&gt;&gt; const&amp;)	.text	0000000000015BA8	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::firewallRemoveUidInterfaceRules(std::__1::vector&lt;int,std::__1::allocator&lt;int&gt;&gt; const&amp;)	.text	0000000000015BB0	00000008			R	.	.	.	.	.	.
android::net::INetdDefault::trafficSwapActiveStatsMap(void)	.text	0000000000015BB8	00000008			R	.	.	.	.	T	.
android::net::INetdDefault::getOemNetd(android::sp&lt;android::IBinder&gt; *)	.text	0000000000015BC0	00000008			R	.	.	.	.	.	.
'''

reals = []

def getName():
    apis = ApiLists.split("\n")
    for name in apis:
        for func in name.split("::"):
            if func.find("(") != -1:
                reals.append(func.split("(")[0])
    for i, name in enumerate(reals):
        print(str(i + 1) + " -&gt; " + name)


def changeName(start_addr, end_addr):
    '''
    :param start_addr: 接口在虚表中的起始地址
    :param end_addr:   接口在虚表中的终点位置
    :return: None
    '''
    addrs = []
    for addr in range(start_addr, end_addr, 8):
        addrs.append(addr)

    for i,addr in enumerate(addrs):
        # 读取接口函数地址
        funcaddr = idc.get_qword(addr)

        # 将地址转化为函数
        ida_funcs.add_func(funcaddr)

        # 修改函数名称
        bsuccess = idc.set_name(funcaddr, reals[i])
        print("0x%X  -&gt; %s  %s" % (funcaddr, reals[i], str(bsuccess)))

        # 设置虚表中的项为函数偏移
        bsuccess = idc.op_plain_offset(addr,0,0)
        print("op_plain_offset -&gt; " + str(bsuccess))


if __name__ == '__main__':
    getName()
    changeName(0x8E768, 0x8EA58)

</code></pre> 
<p>跑一下脚本：</p> 
<p><img alt="" src="https://images2.imgbox.com/03/e2/DceIs4c9_o.png"><img alt="" src="https://images2.imgbox.com/7c/90/RHZX1hOY_o.png"></p> 
<p>函数名都改好了</p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p style="text-align:center;"></p> 
<p style="text-align:center;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a9b9b6b3d4dc11afeda220edb9a93ed6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JVS低代码与Nacos联手：打造用户满意的个性化首页配置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8add9d2d49b325e081217a5e2c9b12ae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">在 SpringBoot 项目中，如何解决依赖冲突问题？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>