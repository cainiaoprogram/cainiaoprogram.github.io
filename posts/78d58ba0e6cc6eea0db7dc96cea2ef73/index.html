<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>百度地图调用，传递经纬度到后台 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="百度地图调用，传递经纬度到后台" />
<meta property="og:description" content="最近使用到了百度地图，需要调用百度地图并在上面做标记，并将标记的经纬度传递到数据库进行保存。
首选看一下效果图，如下： 代码如下 总共有三部分 1. 引入百度地图 2. body 3. js
1. 引入 &lt;script type=&#34;text/javascript&#34; src=&#34;http://api.map.baidu.com/api?key=&amp;v=1.1&amp;services=true&#34;&gt;&lt;/script&gt; 2. body &lt;form action=&#34;/publicsh&#34; method=&#34;POST&#34;&gt; &lt;input type=&#34;hidden&#34; class=&#34;longitude&#34; id=&#34;houses.longitude&#34; name=&#34;houses.longitude&#34;&gt; &lt;input type=&#34;hidden&#34; class=&#34;latitude&#34;　id=&#34;houses.latitude&#34; name=&#34;houses.latitude&#34;&gt; &lt;span class=&#34;w-fabu-lable2&#34;&gt;标注地图：&lt;/span&gt; &lt;!--&lt;textarea class=&#34;w-textare3&#34; name=&#34;&#34; rows=&#34;&#34; cols=&#34;&#34;&gt;&lt;/textarea&gt;--&gt; &lt;div style=&#34;width:697px;height:550px;border:#ccc solid 1px;&#34; id=&#34;dituContent&#34;&gt;&lt;/div&gt; &lt;input type=&#34;submit&#34; value=&#34;submit&#34;&gt; &lt;/form&gt; &lt;/body&gt; 注意： 最开始两个隐藏标签是用来传递经纬度，后面通过js为他们赋值
3. js &lt;script type=&#34;text/javascript&#34;&gt; &lt;!--****百度地图开始****--&gt; //创建和初始化地图函数： function initMap(){ createMap();//创建地图 setMapEvent();//设置地图事件 addMapControl();//向地图添加控件 addMarker();//向地图中添加marker } //创建地图函数： function createMap(){ var map = new BMap." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/78d58ba0e6cc6eea0db7dc96cea2ef73/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-02-06T12:17:06+08:00" />
<meta property="article:modified_time" content="2017-02-06T12:17:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">百度地图调用，传递经纬度到后台</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>最近使用到了百度地图，需要调用百度地图并在上面做标记，并将标记的经纬度传递到数据库进行保存。</p> 
</blockquote> 
<h2 id="首选看一下效果图如下">首选看一下效果图，如下：</h2> 
<p><img src="https://images2.imgbox.com/3c/46/bm7GiHIF_o.jpg" alt="百度地图效果图" title=""></p> 
<h2 id="代码如下">代码如下</h2> 
<blockquote> 
 <p>总共有三部分 <br> 1. 引入百度地图 <br> 2. body <br> 3. js</p> 
</blockquote> 
<h4 id="1-引入">1. 引入</h4> 
<pre class="prettyprint"><code class="language-javascript hljs "> &lt;script type=<span class="hljs-string">"text/javascript"</span> src=<span class="hljs-string">"http://api.map.baidu.com/api?key=&amp;v=1.1&amp;services=true"</span>&gt;<span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span></span></code></pre> 
<h4 id="2-body">2. body</h4> 
<pre class="prettyprint"><code class="language-html hljs "><span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">action</span>=<span class="hljs-value">"/publicsh"</span> <span class="hljs-attribute">method</span>=<span class="hljs-value">"POST"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"hidden"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"longitude"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"houses.longitude"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"houses.longitude"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"hidden"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"latitude"</span>　<span class="hljs-attribute">id</span>=<span class="hljs-value">"houses.latitude"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"houses.latitude"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"w-fabu-lable2"</span>&gt;</span>标注地图：<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
    <span class="hljs-comment">&lt;!--&lt;textarea class="w-textare3" name="" rows="" cols=""&gt;&lt;/textarea&gt;--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">"width:697px;height:550px;border:#ccc solid 1px;"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"dituContent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"submit"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"submit"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span></code></pre> 
<p><em>注意：</em> 最开始两个隐藏标签是用来传递经纬度，后面通过js为他们赋值</p> 
<h4 id="3-js">3. js</h4> 
<pre class="prettyprint"><code class="language-javascript hljs ">&lt;script type=<span class="hljs-string">"text/javascript"</span>&gt;
 <span class="xml"><span class="hljs-comment">&lt;!--****百度地图开始****--&gt;</span>
   //创建和初始化地图函数：
   function initMap(){
       createMap();//创建地图
       setMapEvent();//设置地图事件
       addMapControl();//向地图添加控件
       addMarker();//向地图中添加marker
   }

   //创建地图函数：
   function createMap(){
       var map = new BMap.Map("dituContent");//在百度地图容器中创建一个地图
       var point = new BMap.Point(119.912408,28.46469);//定义一个中心点坐标
       map.centerAndZoom(point,18);//设定地图的中心点和坐标并将地图显示在地图容器中
       window.map = map;//将map变量存储在全局
       map.addEventListener("click",function(e){
        var mylng = document.getElementsByClassName("longitude")[0];
        mylng.value = e.point.lng;//为隐藏标签赋值
        var mylat = document.getElementsByClassName("latitude")[0];
        mylat.value = e.point.lat;
        map.clearOverlays();   //覆盖物清除
        var marker = new BMap.Marker(new BMap.Point(e.point.lng, e.point.lat)); // 创建点
        alert(e.point.lng + "," + e.point.lat);
        map.addOverlay(marker);
    });
   }

   //地图事件设置函数：
   function setMapEvent(){
       map.enableDragging();//启用地图拖拽事件，默认启用(可不写)
       map.enableScrollWheelZoom();//启用地图滚轮放大缩小
       map.enableDoubleClickZoom();//启用鼠标双击放大，默认启用(可不写)
       map.enableKeyboard();//启用键盘上下左右键移动地图
   }

   //地图控件添加函数：
   function addMapControl(){
       //向地图中添加缩放控件
        var ctrl_nav = new  BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE});
map.addControl(ctrl_nav);
       //向地图中添加缩略图控件
var ctrl_ove = new BMap.OverviewMapControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,isOpen:1});
map.addControl(ctrl_ove);
       //向地图中添加比例尺控件
var ctrl_sca = new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});
map.addControl(ctrl_sca);
   }

   //标注点数组
   var markerArr = [{title:"丽水学院",content:"电话：(0578)2271004<span class="hljs-tag">&lt;<span class="hljs-title">br</span>/&gt;</span>手机：(0578)2271004",point:"119.912408|28.46469",isOpen:1,icon:{w:23,h:25,l:46,t:21,x:9,lb:12}}
  ];
   //创建marker
   function addMarker(){
       for(var i=0;i<span class="hljs-tag">&lt;<span class="hljs-title">markerArr.length;i++){
</span>           <span class="hljs-attribute">var</span> <span class="hljs-attribute">json</span> = <span class="hljs-attribute">markerArr</span>[<span class="hljs-attribute">i</span>];
           <span class="hljs-attribute">var</span> <span class="hljs-attribute">p0</span> = <span class="hljs-attribute">json.point.split</span>("|")[<span class="hljs-attribute">0</span>];
           <span class="hljs-attribute">var</span> <span class="hljs-attribute">p1</span> = <span class="hljs-attribute">json.point.split</span>("|")[<span class="hljs-attribute">1</span>];
           <span class="hljs-attribute">var</span> <span class="hljs-attribute">point</span> = <span class="hljs-attribute">new</span> <span class="hljs-attribute">BMap.Point</span>(<span class="hljs-attribute">p0</span>,<span class="hljs-attribute">p1</span>);
  <span class="hljs-attribute">var</span> <span class="hljs-attribute">iconImg</span> = <span class="hljs-attribute">createIcon</span>(<span class="hljs-attribute">json.icon</span>);
           <span class="hljs-attribute">var</span> <span class="hljs-attribute">marker</span> = <span class="hljs-attribute">new</span> <span class="hljs-attribute">BMap.Marker</span>(<span class="hljs-attribute">point</span>,{<!-- --><span class="hljs-attribute">icon:iconImg</span>});
  <span class="hljs-attribute">var</span> <span class="hljs-attribute">iw</span> = <span class="hljs-attribute">createInfoWindow</span>(<span class="hljs-attribute">i</span>);
  <span class="hljs-attribute">var</span> <span class="hljs-attribute">label</span> = <span class="hljs-attribute">new</span> <span class="hljs-attribute">BMap.Label</span>(<span class="hljs-attribute">json.title</span>,{"<span class="hljs-attribute">offset</span>"<span class="hljs-attribute">:new</span> <span class="hljs-attribute">BMap.Size</span>(<span class="hljs-attribute">json.icon.lb-json.icon.x</span>+<span class="hljs-attribute">10</span>,<span class="hljs-attribute">-20</span>)});
  <span class="hljs-attribute">marker.setLabel</span>(<span class="hljs-attribute">label</span>);
           <span class="hljs-attribute">map.addOverlay</span>(<span class="hljs-attribute">marker</span>);
           <span class="hljs-attribute">label.setStyle</span>({
                       <span class="hljs-attribute">borderColor:</span>"#<span class="hljs-attribute">808080</span>",
                       <span class="hljs-attribute">color:</span>"#<span class="hljs-attribute">333</span>",
                       <span class="hljs-attribute">cursor:</span>"<span class="hljs-attribute">pointer</span>"
           });

  (<span class="hljs-attribute">function</span>(){
   <span class="hljs-attribute">var</span> <span class="hljs-attribute">index</span> = <span class="hljs-attribute">i</span>;
   <span class="hljs-attribute">var</span> <span class="hljs-attribute">_iw</span> = <span class="hljs-attribute">createInfoWindow</span>(<span class="hljs-attribute">i</span>);
   <span class="hljs-attribute">var</span> <span class="hljs-attribute">_marker</span> = <span class="hljs-attribute">marker</span>;
   <span class="hljs-attribute">_marker.addEventListener</span>("<span class="hljs-attribute">click</span>",<span class="hljs-attribute">function</span>(){
       <span class="hljs-attribute">this.openInfoWindow</span>(<span class="hljs-attribute">_iw</span>);
      });
      <span class="hljs-attribute">_iw.addEventListener</span>("<span class="hljs-attribute">open</span>",<span class="hljs-attribute">function</span>(){
       <span class="hljs-attribute">_marker.getLabel</span>()<span class="hljs-attribute">.hide</span>();
      })
      <span class="hljs-attribute">_iw.addEventListener</span>("<span class="hljs-attribute">close</span>",<span class="hljs-attribute">function</span>(){
       <span class="hljs-attribute">_marker.getLabel</span>()<span class="hljs-attribute">.show</span>();
      })
   <span class="hljs-attribute">label.addEventListener</span>("<span class="hljs-attribute">click</span>",<span class="hljs-attribute">function</span>(){
       <span class="hljs-attribute">_marker.openInfoWindow</span>(<span class="hljs-attribute">_iw</span>);
      })
   <span class="hljs-attribute">if</span>(!!<span class="hljs-attribute">json.isOpen</span>){
    <span class="hljs-attribute">label.hide</span>();
    <span class="hljs-attribute">_marker.openInfoWindow</span>(<span class="hljs-attribute">_iw</span>);
   }
  })()
       }
   }
   //创建<span class="hljs-attribute">InfoWindow</span>
   <span class="hljs-attribute">function</span> <span class="hljs-attribute">createInfoWindow</span>(<span class="hljs-attribute">i</span>){
       <span class="hljs-attribute">var</span> <span class="hljs-attribute">json</span> = <span class="hljs-attribute">markerArr</span>[<span class="hljs-attribute">i</span>];
       <span class="hljs-attribute">var</span> <span class="hljs-attribute">iw</span> = <span class="hljs-attribute">new</span> <span class="hljs-attribute">BMap.InfoWindow</span>("&lt;<span class="hljs-attribute">b</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">'iw_poi_title'</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">'" + json.title + "'</span>&gt;</span>" + json.title + "<span class="hljs-tag">&lt;/<span class="hljs-title">b</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">'iw_poi_content'</span>&gt;</span>"+json.content+"<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>");
       return iw;
   }
   //创建一个Icon
   function createIcon(json){
       var icon = new BMap.Icon("http://map.baidu.com/image/us_cursor.gif", new BMap.Size(json.w,json.h),{imageOffset: new BMap.Size(-json.l,-json.t),infoWindowOffset:new BMap.Size(json.lb+5,1),offset:new BMap.Size(json.x,json.h)})
       return icon;
   }

   initMap();//创建和初始化地图
   <span class="hljs-comment">&lt;!--****百度地图结束****--&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></span></code></pre> 
<h2 id="看一下为经纬度赋值部分">看一下为经纬度赋值部分</h2> 
<pre class="prettyprint"><code class=" hljs avrasm">//创建地图函数：
   function createMap(){
       var map = new BMap<span class="hljs-preprocessor">.Map</span>(<span class="hljs-string">"dituContent"</span>)<span class="hljs-comment">;//在百度地图容器中创建一个地图</span>
       var point = new BMap<span class="hljs-preprocessor">.Point</span>(<span class="hljs-number">119.912408</span>,<span class="hljs-number">28.46469</span>)<span class="hljs-comment">;//定义一个中心点坐标</span>
       map<span class="hljs-preprocessor">.centerAndZoom</span>(point,<span class="hljs-number">18</span>)<span class="hljs-comment">;//设定地图的中心点和坐标并将地图显示在地图容器中</span>
       window<span class="hljs-preprocessor">.map</span> = map<span class="hljs-comment">;//将map变量存储在全局</span>
       map<span class="hljs-preprocessor">.addEventListener</span>(<span class="hljs-string">"click"</span>,function(e){
        var mylng = document<span class="hljs-preprocessor">.getElementsByClassName</span>(<span class="hljs-string">"longitude"</span>)[<span class="hljs-number">0</span>]<span class="hljs-comment">;</span>
        mylng<span class="hljs-preprocessor">.value</span> = e<span class="hljs-preprocessor">.point</span><span class="hljs-preprocessor">.lng</span><span class="hljs-comment">;//为隐藏标签赋值</span>
        var mylat = document<span class="hljs-preprocessor">.getElementsByClassName</span>(<span class="hljs-string">"latitude"</span>)[<span class="hljs-number">0</span>]<span class="hljs-comment">;</span>
        mylat<span class="hljs-preprocessor">.value</span> = e<span class="hljs-preprocessor">.point</span><span class="hljs-preprocessor">.lat</span><span class="hljs-comment">;</span>
        map<span class="hljs-preprocessor">.clearOverlays</span>()<span class="hljs-comment">;   //覆盖物清除</span>
        var marker = new BMap<span class="hljs-preprocessor">.Marker</span>(new BMap<span class="hljs-preprocessor">.Point</span>(e<span class="hljs-preprocessor">.point</span><span class="hljs-preprocessor">.lng</span>, e<span class="hljs-preprocessor">.point</span><span class="hljs-preprocessor">.lat</span>))<span class="hljs-comment">; // 创建点</span>
        alert(e<span class="hljs-preprocessor">.point</span><span class="hljs-preprocessor">.lng</span> + <span class="hljs-string">","</span> + e<span class="hljs-preprocessor">.point</span><span class="hljs-preprocessor">.lat</span>)<span class="hljs-comment">;</span>
        map<span class="hljs-preprocessor">.addOverlay</span>(marker)<span class="hljs-comment">;</span>
    })<span class="hljs-comment">;</span>
   }</code></pre> 
<p><strong>具体看一下关键赋值代码</strong></p> 
<pre class="prettyprint"><code class=" hljs avrasm">var mylng = document<span class="hljs-preprocessor">.getElementsByClassName</span>(<span class="hljs-string">"longitude"</span>)[<span class="hljs-number">0</span>]<span class="hljs-comment">; </span>
mylng<span class="hljs-preprocessor">.value</span> = e<span class="hljs-preprocessor">.point</span><span class="hljs-preprocessor">.lng</span><span class="hljs-comment">;//为隐藏标签赋值</span></code></pre> 
<p>将经纬度赋值给表单标签，这样就可以将经纬度传递到后台，保存到数据库，用于以后显示位置</p> 
<blockquote> 
 <p>关于百度地图的部分还在学习中，以后如果有新的收获再放上来</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e6b13fd0b1c14e977d7414e8a387cdfc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mysql查询重复数据并保留一条</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c08909e3b892a466f40fdac1b2847ed6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL跳过密码登录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>