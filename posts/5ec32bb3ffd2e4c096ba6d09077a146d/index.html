<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Go-目录结构及源文件 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Go-目录结构及源文件" />
<meta property="og:description" content="一.目录结构及源文件 目录结构
一个Go语言项目的目录一般包含以下三个子目录：
src 目录：放置项目和库的源文件；pkg 目录：放置编译后生成的包/库的归档文件；bin 目录：放置编译后生成的可执行文件。 三个目录中我们需要重点关注的是 src 目录，其他两个目录了解即可
src 目录 用于以包（package）的形式组织并存放 Go 源文件，这里的包与 src 下的每个子目录是一一对应。例如，若一个源文件被声明属于 log 包，那么它就应当保存在 src/log 目录中。
包是Go语言管理代码的重要机制，其作用类似于Java中的 package 和 C/C&#43;&#43; 的头文件。Go 源文件中第一段有效代码必须是package &lt;包名&gt; 的形式，如 package hello。
另外需要注意的是，Go语言会把通过go get 命令获取到的库源文件下载到 src 目录下对应的文件夹当中。
pkg 目录 用于存放通过go install 命令安装某个包后的归档文件。归档文件是指那些名称以“.a”结尾的文件。
该目录与 GOROOT 目录（也就是Go语言的安装目录）下的 pkg 目录功能类似，区别在于这里的 pkg 目录专门用来存放项目代码的归档文件。
编译和安装项目代码的过程一般会以代码包为单位进行，比如 log 包被编译安装后，将生成一个名为 log.a 的归档文件，并存放在当前项目的 pkg 目录下。
bin 目录 与 pkg 目录类似，在通过go install 命令完成安装后，保存由 Go 命令源文件生成的可执行文件。在类 Unix 操作系统下，这个可执行文件的名称与命令源文件的文件名相同。而在 Windows 操作系统下，这个可执行文件的名称则是命令源文件的文件名加 .exe 后缀。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/5ec32bb3ffd2e4c096ba6d09077a146d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-07T10:53:50+08:00" />
<meta property="article:modified_time" content="2023-12-07T10:53:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Go-目录结构及源文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一.目录结构及源文件</h2> 
<p>目录结构</p> 
<p>一个Go语言项目的目录一般包含以下三个子目录：</p> 
<ul><li>src 目录：放置项目和库的源文件；</li><li>pkg 目录：放置编译后生成的包/库的归档文件；</li><li>bin 目录：放置编译后生成的可执行文件。</li></ul> 
<p></p> 
<p>三个目录中我们需要重点关注的是<strong> src 目录</strong>，其他两个目录了解即可</p> 
<h3>src 目录</h3> 
<p>用于以包（package）的形式组织并存放 Go 源文件，这里的包与 src 下的每个子目录是一一对应。例如，若一个源文件被声明属于 log 包，那么它就应当保存在 src/log 目录中。</p> 
<p></p> 
<p>包是Go语言管理代码的重要机制，其作用类似于<a href="https://c.biancheng.net/java/" rel="nofollow" title="Java">Java</a>中的 package 和 C/<a href="https://c.biancheng.net/cplus/" rel="nofollow" title="C++">C++</a> 的头文件。Go 源文件中第一段有效代码必须是package &lt;包名&gt; 的形式，如 package hello。</p> 
<p></p> 
<p>另外需要注意的是，Go语言会把通过go get 命令获取到的库源文件下载到 src 目录下对应的文件夹当中。</p> 
<h3>pkg 目录</h3> 
<p>用于存放通过go install 命令安装某个包后的归档文件。归档文件是指那些名称以“.a”结尾的文件。</p> 
<p></p> 
<p>该目录与 GOROOT 目录（也就是Go语言的安装目录）下的 pkg 目录功能类似，区别在于这里的 pkg 目录专门用来存放项目代码的归档文件。</p> 
<p></p> 
<p>编译和安装项目代码的过程一般会以代码包为单位进行，比如 log 包被编译安装后，将生成一个名为 log.a 的归档文件，并存放在当前项目的 pkg 目录下。</p> 
<h3>bin 目录</h3> 
<p>与 pkg 目录类似，在通过go install 命令完成安装后，保存由 Go 命令源文件生成的可执行文件。在类 Unix 操作系统下，这个可执行文件的名称与命令源文件的文件名相同。而在 Windows 操作系统下，这个可执行文件的名称则是命令源文件的文件名加 .exe 后缀。</p> 
<h3>源文件</h3> 
<p>上面我们提到了命令源文件和库源文件，它们到底是什么呢？</p> 
<ul><li>命令源文件：如果一个 Go 源文件被声明属于 main 包，并且该文件中包含 main 函数，则它就是命令源码文件。命令源文件属于程序的入口，可以通过Go语言的go run 命令运行或者通过go build 命令生成可执行文件。</li><li>库源文件：库源文件则是指存在于某个包中的普通源文件，并且库源文件中不包含 main 函数。</li></ul> 
<p>不管是命令源文件还是库源文件，在同一个目录下的所有源文件，其所属包的名称必须一致的。</p> 
<h2>二.依赖管理</h2> 
<h3>godep</h3> 
<p>godep 是一个 Go 语言官方提供的通过 vender 模式来管理第三方依赖的工具，类似的还有由社区维护的准官方包管理工具 dep。</p> 
<p>Go 语言从 1.5 版本开始开始引入 vendor 模式，如果项目目录下有 vendor 目录，那么 Go 语言编译器会优先使用 vendor 内的包进行编译、测试等。</p> 
<h3><strong>安装 godep 工具</strong></h3> 
<p>我们可以通过 go get 命令来获取 godep 工具。</p> 
<pre><code class="language-Go">go get github.com/tools/godep</code></pre> 
<p>命令执行成功后会将 godep 工具的源码下载到 GOPATH 的 src 目录下对应的文件夹中，同时还会在 GOPATH 的 bin 目录下生成一个名为 godep.exe 的可执行文件，如下图所示。</p> 
<p><img alt="" height="270" src="https://images2.imgbox.com/34/8b/w75rnv7W_o.png" width="566"></p> 
<p>为了方便使用 godep 工具，我们需要将存放 godep.exe 文件的目录添加到环境变量 PATH 中。在系统变量中找到并选中“Path”一行，点击“编辑”按钮，在新弹出的窗口中点击“新建”，然后在最下面一行中填入对应的目录信息。确认无误后点击“确定”。</p> 
<p><img alt="" height="462" src="https://images2.imgbox.com/a3/5c/TytZGJb1_o.png" width="767"></p> 
<h3>godep 工具的基本命令</h3> 
<p>完成上面的操作后，我们就可以在命令行窗口（CMD）中使用 godep 工具了，godep 支持的命令如下表所示：</p> 
<p>godep save</p> 
<p>将依赖包的信息保存到 Godeps.json 文件中</p> 
<p></p> 
<p>godep go</p> 
<p>使用保存的依赖项运行 go 工具</p> 
<p></p> 
<p>godep get</p> 
<p>下载并安装指定的包</p> 
<p></p> 
<p>godep path</p> 
<p>打印依赖的 GOPATH 路径</p> 
<p></p> 
<p>godep restore 在 GOPATH 中拉取依赖的版本</p> 
<p></p> 
<p>godep update 更新选定的包或 go 版本</p> 
<p></p> 
<p>godep diff</p> 
<p>显示当前和以前保存的依赖项集之间的差异</p> 
<p></p> 
<p>godep version 查看版本信息</p> 
<p>使用 godep help [命令名称]可以查看命令的帮助信息，如下所示。</p> 
<p></p> 
<pre><code class="language-bash">C:\Users\Administrator&gt;godep help go
Args: godep go [-v] [-d] command [arguments]
Go runs the go tool with a modified GOPATH giving access to
dependencies saved in Godeps.
Any go tool command can run this way, but "godep go get"
is unnecessary and has been disabled. Instead, use
"godep go install".
If -v is given, verbose output is enabled.
If -d is given, debug output is enabled (you probably don't want this, see -v).</code></pre> 
<p></p> 
<h3>使用 godep 工具</h3> 
<p>执行 godep save 命令，会在当前目录中创建 Godeps 和 vender 两个文件夹。Godeps 文件夹下会生成一个 Godeps.json 文件，用来记录项目中所依赖的包信息；vender 目录则是用来保存当前项目所依赖的所有第三方包。</p> 
<p><img alt="" height="279" src="https://images2.imgbox.com/53/47/WTVr6U41_o.png" width="501"></p> 
<p>生成的 Godeps.json 文件的结构如下所示：</p> 
<pre><code class="language-Go">{
"ImportPath": "main",
"GoVersion": "go1.13",
"GodepVersion": "v80",
"Deps": [
{
"ImportPath": "github.com/go-gomail/gomail",
"Comment": "2.0.0-23-g81ebce5",
"Rev": "81ebce5c23dfd25c6c67194b37d3dd3f338c98b1"
}
]
}</code></pre> 
<p>其中，“ImportPath”为项目的路径信息，“GoVersion”为 Go 语言的版本号，“GodepVersion”为 godep 工具的版本号，“Deps”为当前依赖包的路径、版本号信息等等。</p> 
<p>提示：当引用的第三方包要升级时，只需要修改 Godep.json 里面的依赖包的版本号，然后再次执行 godep save 命令即可。</p> 
<p>godep 工具的主要功能就是控制 Go 语言程序编译时依赖包搜索路径的优先级。例如查找项目的某个依赖包，首先会在项目根目录下的</p> 
<p>vender 文件夹中查找，如果没有找到就会去 GOAPTH/src 目录下查找。</p> 
<p></p> 
<h3>go module</h3> 
<p>go module 是 Go 语言从 1.11 版本之后官方推出的版本管理工具，并且从 Go1.13 版本开始，go module 成为了 Go 语言默认的依赖管理工具。</p> 
<p></p> 
<h3>GO111MODULE</h3> 
<p>在 Go 语言 1.12 版本之前，要启用 go module 工具首先要设置环境变量 GO111MODULE，不过在 Go 语言 1.13 及以后的版本则不再需要设置环境变量。</p> 
<p>通过 GO111MODULE 可以开启或关闭 go module 工具。</p> 
<pre><code class="language-Go">GO111MODULE=off 禁用 go module，编译时会从 GOPATH 和 vendor 文件夹中查找包。
GO111MODULE=on 启用 go module，编译时会忽略 GOPATH 和 vendor 文件夹，只根据 go.mod 下载依赖。
GO111MODULE=auto（默认值），当项目在 GOPATH/src 目录之外，并且项目根目录有 go.mod 文件时，开启 go module。</code></pre> 
<p>Windows 下开启 GO111MODULE 的命令为：</p> 
<pre><code class="language-Go">set GO111MODULE=on 或者 set GO111MODULE=auto</code></pre> 
<p>MacOS 或者 Linux 下开启 GO111MODULE 的命令为：</p> 
<pre><code class="language-Go">export GO111MODULE=on 或者 export GO111MODULE=auto</code></pre> 
<p>在开启 GO111MODULE 之后就可以使用 go module 工具了，也就是说在以后的开发中就没有必要在 GOPATH 中创建项目了，并且还能够很好的管理项目依赖的第三方包信息。</p> 
<p>使用 go module 的 go mod init 命令后会在当前目录下生成一个 go. mod 文件，并且在编译/运行当前目录下代码或者使用 goget 命令的时候会在当前目录下生成一个 go.sun 文件。</p> 
<p><img alt="" height="260" src="https://images2.imgbox.com/3c/4f/6fC0XYjv_o.png" width="487"></p> 
<p>go.mod 文件记录了项目所有的依赖信息，其结构大致如下：</p> 
<pre><code class="language-Go">module main.go
go 1.13
require (
github.com/astaxie/beego v1.12.0
github.com/shiena/ansicolor v0.0.0-20151119151921-a422bbe96644 // indirect
)</code></pre> 
<p>其中，module 为 go.mod 文件所属的包，require 为项目所依赖的包及版本号，indirect 表示间接引用。</p> 
<p>go.sum 文件则是用来记录每个依赖包的版本及哈希值，如下所示。</p> 
<pre><code class="language-Go">github.com/Knetic/govaluate v3.0.0+incompatible/go.mod h1:r7JcOSlj0wfOMncg0iLm8Leh48TZaKVeNIfJntJ2wa0=
github.com/OwnLocal/goes v1.0.0/go.mod h1:8rIFjBGTue3lCU0wplczcUgt9Gxgrkkrw7etMIcn8TM=
github.com/astaxie/beego v1.12.0 h1:MRhVoeeye5N+Flul5PoVfD9CslfdoH+xqC/xvSQ5u2Y=
github.com/astaxie/beego v1.12.0/go.mod h1:fysx+LZNZKnvh4GED/xND7jWtjCR6HzydR2Hh2Im57o=</code></pre> 
<h3>常用的 go mod 命令如下表所示：</h3> 
<p></p> 
<p>go mod download 下载依赖包到本地（默认为 GOPATH/pkg/mod 目录）</p> 
<p></p> 
<p>go mod edit</p> 
<p>编辑 go.mod 文件</p> 
<p></p> 
<p>go mod graph</p> 
<p>打印模块依赖图</p> 
<p></p> 
<p>go mod init</p> 
<p>初始化当前文件夹，创建 go.mod 文件</p> 
<p></p> 
<p>go mod tidy</p> 
<p>增加缺少的包，删除无用的包</p> 
<p></p> 
<p>go mod vendor</p> 
<p>将依赖复制到 vendor 目录下</p> 
<p></p> 
<p>go mod verify</p> 
<p>校验依赖</p> 
<p></p> 
<p>go mod why</p> 
<p>解释为什么需要依赖</p> 
<p></p> 
<h3>GOPROXY</h3> 
<p>proxy 顾名思义就是代理服务器的意思。大家都知道，国内的网络有防火墙的存在，这导致有些 Go 语言的第三方包我们无法直接通过</p> 
<p></p> 
<p>go get 命令获取。GOPROXY 是 Go 语言官方提供的一种通过中间代理商来为用户提供包下载服务的方式。要使用 GOPROXY 只需要设置环境变量 GOPROXY 即可。</p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/983a38afb53fd8ba1e84976c2e26828e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【S32K144】MCAL基础工程搭建</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/00184f439d568856fdb2c2402c1560db/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">el-date-picker二次封装 自定义右侧图标</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>