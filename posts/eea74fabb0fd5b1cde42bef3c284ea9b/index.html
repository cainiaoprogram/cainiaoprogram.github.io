<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>树莓派连接天猫精灵等蓝牙音箱并播放wav和pcm格式文件 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="树莓派连接天猫精灵等蓝牙音箱并播放wav和pcm格式文件" />
<meta property="og:description" content="树莓派连接天猫精灵等蓝牙音箱并播放wav和pcm格式文件 我们使用bluealsa来连接蓝牙音箱，并通过aplay实现wav文件播放
一、安装配置bluealsa模块 1. 安装 sudo apt-get install bluealsa
2. 添加用户组 sudo usermode -aG bluetooth pi
3. 重启并检查bluealsa服务状态 sudo reboot
systemctl status bluealsa
如果重启后，bluealsa服务状态为active即安装成功
二、连接蓝牙音箱 1. 进入蓝牙工具 sudo bluetoothctl
2. 扫描蓝牙设备 scan on
scan on 会列出搜索到的蓝牙设备，如果遇到蓝牙被占用的情况，可以通过rfkill命令来解决占用。
rfkill list 查看所有设备情况
rfkill unblock all 启动所有设备
3. 连接设备 connect 10:9E:3A:A3:6E:47
4. 退出蓝牙工具 exit
三、播放音频 播放wav格式文件 sudo aplay -D bluealsa:DEV=10:9E:3A:A3:6E:47 /usr/share/sounds/alsa/Rear_Right.wav
播放pcm格式文件 sudo aplay -t raw -c 1 -f S16_LE -r 16000 -D bluealsa:DEV=10:9E:3A:A3:6E:47 demo." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/eea74fabb0fd5b1cde42bef3c284ea9b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-15T10:25:19+08:00" />
<meta property="article:modified_time" content="2021-08-15T10:25:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">树莓派连接天猫精灵等蓝牙音箱并播放wav和pcm格式文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="wavpcm_0"></a>树莓派连接天猫精灵等蓝牙音箱并播放wav和pcm格式文件</h2> 
<p>我们使用bluealsa来连接蓝牙音箱，并通过aplay实现wav文件播放</p> 
<h3><a id="bluealsa_3"></a>一、安装配置bluealsa模块</h3> 
<h4><a id="1__4"></a>1. 安装</h4> 
<blockquote> 
 <p>sudo apt-get install bluealsa</p> 
</blockquote> 
<h4><a id="2__7"></a>2. 添加用户组</h4> 
<blockquote> 
 <p>sudo usermode -aG bluetooth pi</p> 
</blockquote> 
<h4><a id="3_bluealsa_10"></a>3. 重启并检查bluealsa服务状态</h4> 
<blockquote> 
 <p>sudo reboot<br> systemctl status bluealsa</p> 
</blockquote> 
<p>如果重启后，bluealsa服务状态为active即安装成功</p> 
<h3><a id="_16"></a>二、连接蓝牙音箱</h3> 
<h4><a id="1__17"></a>1. 进入蓝牙工具</h4> 
<blockquote> 
 <p>sudo bluetoothctl</p> 
</blockquote> 
<h4><a id="2__20"></a>2. 扫描蓝牙设备</h4> 
<blockquote> 
 <p>scan on</p> 
</blockquote> 
<p>scan on 会列出搜索到的蓝牙设备，如果遇到蓝牙被占用的情况，可以通过rfkill命令来解决占用。</p> 
<blockquote> 
 <p>rfkill list 查看所有设备情况<br> rfkill unblock all 启动所有设备</p> 
</blockquote> 
<h4><a id="3__27"></a>3. 连接设备</h4> 
<blockquote> 
 <p>connect 10:9E:3A:A3:6E:47</p> 
</blockquote> 
<h5><a id="4__30"></a>4. 退出蓝牙工具</h5> 
<blockquote> 
 <p>exit</p> 
</blockquote> 
<h3><a id="_33"></a>三、播放音频</h3> 
<h5><a id="wav_35"></a>播放wav格式文件</h5> 
<blockquote> 
 <p>sudo aplay -D bluealsa:DEV=10:9E:3A:A3:6E:47 /usr/share/sounds/alsa/Rear_Right.wav</p> 
</blockquote> 
<h5><a id="pcm_38"></a>播放pcm格式文件</h5> 
<blockquote> 
 <p>sudo aplay -t raw -c 1 -f S16_LE -r 16000 -D bluealsa:DEV=10:9E:3A:A3:6E:47 demo.pcm</p> 
</blockquote> 
<p>其中，<br> -t: type raw表示是PCM<br> -c: channel 1<br> -f S16_LE: Signed 16bit-width Little-Endian<br> -r: sample rate 16000<br> -D: 指定播放设备</p> 
<p>pcm其实就是没有头信息的wav，所以播放时要手动指定头信息<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          p 
         
        
          c 
         
        
          m 
         
        
          + 
         
        
          头 
         
        
          信 
         
        
          息 
         
        
          = 
         
        
          w 
         
        
          a 
         
        
          v 
         
        
       
         pcm + 头信息 = wav 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">c</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mord cjk_fallback">头</span><span class="mord cjk_fallback">信</span><span class="mord cjk_fallback">息</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span></span></span></span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f98bf4569a54e80cc682f6ebcdfe271f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Mysql事务</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ffe974785a382428c222aa6bba2dddba/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java stream 实现双重for循环</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>