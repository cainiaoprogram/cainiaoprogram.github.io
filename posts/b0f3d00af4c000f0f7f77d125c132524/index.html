<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>EasyUI框架02——datagrid - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="EasyUI框架02——datagrid" />
<meta property="og:description" content="datagrid是easyUI使用比较常用的一个组件，列表等基本功能的使用，可以参考easyUI的API。
1. Editor的用法 editor编辑器是easyUI中比较重要的一个东东，在其他组件中都有其身影。
1.1 常用API 1.1.1 获取 1）获取编辑器
获取索引值为index，字段field的编辑器
var editor = $(this).datagrid(&#39;getEditor&#39;, {index: index, field: field}); 2）获取编辑器数据
1. 获取combobox的数据
var editors = $(&#39;#product_info_table&#39;).datagrid(&#39;getEditors&#39;, index); productName = editors[0].target.combobox(&#39;getValue&#39;); 2. 获取input的数据
var editors = $(&#39;#product_info_table&#39;).datagrid(&#39;getEditors&#39;, index); productName = editors[1].target.val(); 1.1.2 编辑器的生命周期 1）开始编辑器
$(&#34;#id&#34;).datagrid(&#39;beginEdit&#39;, index); 2）结束编辑器
$(&#34;#id&#34;).datagrid(&#39;endEdit&#39;, currentEditIndex); 3）取消编辑器
$(&#34;#product_info_table&#34;).datagrid(&#39;cancelEdit&#39;,index); 1.1.3 聚焦到编辑行 $(editor.target).focus(); 1.2 动态编辑器 1.2.1 定义 /* * 动态Editor * */ function initEditor(type){ if(type === &#39;treegrid&#39;){ $.extend($.fn.treegrid.methods, { addEditor : function(jq, param) { if (param instanceof Array) { $." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b0f3d00af4c000f0f7f77d125c132524/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-02T12:46:05+08:00" />
<meta property="article:modified_time" content="2020-02-02T12:46:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">EasyUI框架02——datagrid</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>        datagrid是easyUI使用比较常用的一个组件，列表等基本功能的使用，可以参考easyUI的API。</p> 
<h2>1. Editor的用法</h2> 
<p>editor编辑器是easyUI中比较重要的一个东东，在其他组件中都有其身影。</p> 
<h3>1.1 常用API</h3> 
<h4>1.1.1 获取</h4> 
<p>1）获取编辑器</p> 
<p>获取索引值为index，字段field的编辑器</p> 
<pre class="has"><code>var editor = $(this).datagrid('getEditor', {index: index, field: field});</code></pre> 
<p>2）获取编辑器数据</p> 
<p>1. 获取combobox的数据</p> 
<pre class="has"><code>var editors = $('#product_info_table').datagrid('getEditors', index);      
productName = editors[0].target.combobox('getValue');</code></pre> 
<p>2. 获取input的数据</p> 
<pre class="has"><code>var editors = $('#product_info_table').datagrid('getEditors', index);      
productName = editors[1].target.val();</code></pre> 
<h4>1.1.2 编辑器的生命周期</h4> 
<p>1）开始编辑器</p> 
<pre class="has"><code>$("#id").datagrid('beginEdit', index);</code></pre> 
<p>2）结束编辑器</p> 
<pre class="has"><code>$("#id").datagrid('endEdit', currentEditIndex);</code></pre> 
<p>3）取消编辑器</p> 
<pre class="has"><code>$("#product_info_table").datagrid('cancelEdit',index);</code></pre> 
<h4>1.1.3 聚焦到编辑行</h4> 
<pre class="has"><code>$(editor.target).focus();</code></pre> 
<h3>1.2 动态编辑器</h3> 
<h4>1.2.1 定义</h4> 
<pre class="has"><code class="language-javascript">/*

 * 动态Editor

 * */

function initEditor(type){

     if(type === 'treegrid'){

          $.extend($.fn.treegrid.methods, {   

             addEditor : function(jq, param) {  

                 if (param instanceof Array) {  

                     $.each(param, function(index, item) { 

                         var e = $(jq).treegrid('getColumnOption', item.field);

                         e.editor = item.editor; });

                     } else {   

                         var e = $(jq).treegrid('getColumnOption', param.field);   

                         e.editor = param.editor;   

                     }  

                 }, 

             removeEditor : function(jq, param) {   

                 if (param instanceof Array) {  

                     $.each(param, function(index, item) { 

                         var e = $(jq).treegrid('getColumnOption', item);  

                         e.editor = {}; 

                         });

                 } else {   

                     var e = $(jq).treegrid('getColumnOption', param);

                     e.editor = {}; 

                 }  

             }

         });

     }

     if(type === 'datagrid'){

          $.extend($.fn.datagrid.methods, {   

             addEditor : function(jq, param) {  

                 if (param instanceof Array) {  

                     $.each(param, function(index, item) { 

                         var e = $(jq).datagrid('getColumnOption', item.field);

                         e.editor = item.editor; });

                     } else {   

                         var e = $(jq).datagrid('getColumnOption', param.field);   

                         e.editor = param.editor;   

                     }  

                 }, 

             removeEditor : function(jq, param) {   

                 if (param instanceof Array) {  

                     $.each(param, function(index, item) { 

                         var e = $(jq).datagrid('getColumnOption', item);  

                         e.editor = {}; 

                         });

                 } else {   

                     var e = $(jq).datagrid('getColumnOption', param);

                     e.editor = {}; 

                 }  

             }

         });

     }

}</code></pre> 
<h3>1.2.2 使用</h3> 
<pre class="has"><code class="language-javascript">// 动态添加编辑器

for(var i = colFlag+1 ; i &lt; 13 ; i++){

    $("#grid").treegrid('addEditor',[ //添加cardNo列editor

        {field:("month"+i),editor:{

                type:'numberbox',

                options:{

                    required:true,

                    precision:4

                }

        }

    }]);

}</code></pre> 
<h2>2. datagrid的常用API</h2> 
<p>1）'loadData'与checkAll的用法</p> 
<pre class="has"><code>$("#dtsTable").datagrid('loadData', data).datagrid("checkAll");</code></pre> 
<p>2）选中某行'selectRow'</p> 
<pre class="has"><code class="language-javascript">$("#dtsTable").datagrid('selectRow',index);</code></pre> 
<p>3）更新某行的数据'updateRow'</p> 
<pre class="has"><code>$("#dtsTable").datagrid('updateRow', {index: index,row:{data:row}});

$("#dtsTable").datagrid('updateRow', {index: index,row:{owner:row.owner}});

$('#grid').treegrid('updateRow',{index: index,row: JSON.parse(oldRowStr)});</code></pre> 
<p>4）获取datagrid的数据</p> 
<pre class="has"><code>var rows = $("#dtsTable").datagrid('getData').rows

var rowData = $("#product_info_table").datagrid('getRows')</code></pre> 
<p>5）获取行索引</p> 
<pre class="has"><code>Var index = $("#changeGrid").datagrid('getRowIndex',rowData[index]);</code></pre> 
<p>6）删除某行</p> 
<pre class="has"><code>$("#product_info_table").datagrid('deleteRow',index);</code></pre> 
<p>7）获取改变的行</p> 
<pre class="has"><code>var changes = $('#product_info_table').datagrid('getChanges',’ updated’);</code></pre> 
<p>一般用于editor中</p> 
<p>8）插入一行</p> 
<pre class="has"><code>$('#product_info_table').datagrid('insertRow',{row:newRow});</code></pre> 
<p>注意：</p> 
<p>当插入一行的时候，如果列表为空，那么插入一行的数据不会以列表展示，例如</p> 
<p><img alt="image.png" class="has" src="https://images2.imgbox.com/ff/a2/UnlfgkxI_o.png"></p> 
<p> </p> 
<p>这时候，需要添加样式</p> 
<p>$("div[class='datagrid-body'] table").addClass("datagrid-btable");</p> 
<p>例如：</p> 
<pre class="has"><code class="language-javascript">var newRow = {
     productName: '',
     emuiVersion: '',
     projectType: '',
     marketType: '',
     finishDate: '',
     ratio: ''
};

function addPlanInfo(){
     $("#addPlanInfo").bind('click',function(){
          $('#product_info_table').datagrid('insertRow',{row:newRow});
          $("div[class='datagrid-body'] table").addClass("datagrid-btable");
          // 插入时候，触发编辑事件
          newIndex = $('#product_info_table').datagrid("getRowIndex",newRow);
          editRow(newIndex,true);  // true表示为新增的编辑
     })
}</code></pre> 
<p>9）刷新表格</p> 
<pre class="has"><code>$('#grid').datagrid('reload');</code></pre> 
<h2>3. 合并单元格</h2> 
<h3>3.1 定义</h3> 
<pre class="has"><code class="language-javascript">$.extend($.fn.datagrid.methods, {
                       autoMergeCells: function(jq, fields) {
                           return jq.each(function() {
                               var target = $(this);
                               if (!fields) {
                                   fields = target.datagrid("getColumnFields");
                               }

                               var rows = target.datagrid("getRows");
                               var i = 0,
                               j = 0,
                               temp = {};
                               for (i; i &lt; rows.length; i++) {
                                   var row = rows[i];
                                   j = 0;
                                   for (j; j &lt; fields.length; j++) {
                                       var field = fields[j];
                                       var tf = temp[field];
                                       if (!tf) {
                                           tf = temp[field] = {};
                                           tf[row[field]] = [i];
                                       } else {
                                           var tfv = tf[row[field]];
                                           if (tfv) {
                                               tfv.push(i);
                                           } else {
                                               tfv = tf[row[field]] = [i];
                                           }
                                       }
                                   }
                               }

                               $.each(temp,
                                   function(field, colunm) {
                                   $.each(colunm,
                                   function() {
                                       var group = this;
 
                                       if (group.length &gt; 1) {
                                           var before, after, megerIndex = group[0];
                                           for (var i = 0; i &lt; group.length; i++) {
                                               before = group[i];
                                               after = group[i + 1];
                                               if (after &amp;&amp; (after - before) == 1) {
                                                   continue;
                                               }

                                               var rowspan = before - megerIndex + 1;
                                               if (rowspan &gt; 1) {
                                                   target.datagrid('mergeCells', {
                                                       index: megerIndex,
                                                       field: field,
                                                       rowspan: rowspan
                                                   });
                                               }

                                               if (after &amp;&amp; (after - before) != 1) {
                                                   megerIndex = after;
                                               }
                                           }
                                       }
                                   });
                               });
                           });
                       }
                   });</code></pre> 
<h3>3.2 使用</h3> 
<p>例如：将a和b合并</p> 
<pre class="has"><code class="language-javascript">onLoadSuccess:function(data){
          $(this).datagrid("autoMergeCells", [‘a’, ‘b’]);
},</code></pre> 
<h2>4. queryParam条件查询</h2> 
<pre class="has"><code class="language-javascript">// 给按钮绑定属性
$("#searchStave").bind('click', function(){
// $("#grid").datagrid('reload');

//查询参数直接添加在url中        

//查询参数直接添加在queryParams中   

var queryParams = $('#grid').datagrid('options').queryParams; 

queryParams.product = $("#product").combobox('getValue');
queryParams.product_model = $("#product_model").val();
queryParams.zone = $("#zone").val();
queryParams.operator = $("#operator").val();
$('#grid').datagrid('options').queryParams=queryParams;       
    $("#grid").datagrid('reload');
});</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b3171d7db429e4e4a562060782d455a8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spring容器中获取Bean实例的七种方式（附实战源码）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/83e85d46beeb57c2d6c13ea4fa7c7fd2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">HTTP协议详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>