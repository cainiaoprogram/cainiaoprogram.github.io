<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Excel经验分享-单元格字符统计 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Excel经验分享-单元格字符统计" />
<meta property="og:description" content="Excel经验分享 如何在电子表选定范围内，统计任意字符出现的次数 根据日常统计需要，大概有三种情景： 情景一： 要查找的词完全占据一个单元格时，
直接使用函数：COUNTIF(range,criteria)，即COUNTIF(查找范围，查找词)，
示例：统计保卫人员“罗应光”本周内实际值班的次数，见下表：
操作方法：
选择任意空白单元格，在内输入：
=countif(查找范围,“查找词”) */如果没有正常统计结果，把查找词换为对应单元格地址 情景二： 要查找的词是某一单元格内容的一部分且在一个单元格中只出现一次，也是使用COUNTIF函数，第二个参数是查找词加通配符，即COUNTIF(查找范围，“查找词&#43;通配符”)；
查找词&#43;通配符的形式如：“上海南站”“上海北站”“上海东站”可以统一使用“上海*”来表示，查找词与通配符是顺序排列的，即“上海*”表示的字段是“上海”开头之后为任意字符的意思。
示例：统计所有姓王的人员值班总数
任然可以使用countif()函数操作，如下图
要注意的是，在我使用的office2013版的Excel2013中，在countif(range,criteria)函数的criteria参数位置直接输入需要查找或统计的字符是不会出结果的，只能输入字符所在的单元格地址，另外 “字符&#43;通配符” 的形式提示函数错误。其他版本的excel是否有这个问题，不是很清楚。
纠正：字符的输入两边必须加“”号，应该是受数字类型的限制，之上的错误主要原因就是没有在字符串两边加“”，Excel里所有符号都应该是英文符号，不能使用中文符号。
情景三 要查找的词在一个单元格中出现多次，使用SUMPRODUCT函数，即SUMPRODUCT(LEN(查找范围)-LEN(SUBSTITUTE(查找范围，查找词，替换后的值)))。
其中主要用到的有三个函数，分别为
SUMPROUCT(array1,array2,array3…)，具体用法参看后文SUMPRODUCT函数
SUBSTITUTE()，用新字符替换查找字符
LEN()，返回字符数
此用法灵活性比较高，关键是根据需要统计的字符，合理的选择“替换后的值”，最好使替换前和替换后字符相减后值为“1”，当然也可以选择最终统计完之后除以差值。
示例： SUMPRODUCT 函数 SUMPRODUCT函数返回相应范围或数组的个数之和。 默认操作是乘法，但也可以执行加减除运算。
本示例使用 SUMPRODUCT 返回给定项和大小的总销售额：
SUMPRODUCT 匹配项 Y/大小 M 的所有实例并求和，因此对于此示例，21 加 41 等于 62。
语法 若要使用默认操作 (乘法) ：
=SUMPRODUCT (array1， [array2]， [array3]， …)
SUMPRODUCT 函数语法具有下列参数：
参数说明array1 必需其相应元素需要进行相乘并求和的第一个数组参数。[array2]， [array3],… 可选2 到 255 个数组参数，其相应元素需要进行相乘并求和。 执行其他算术运算
像往常一样使用 SUMPRODUCT，但请将分隔数组参数的逗号替换为所需的算术运算符 (*、/、&#43;、-) 。 执行所有操作后，结果将像往常一样进行求和。
注意: 如果使用算术运算符，请考虑将数组参数括在括号中，并使用括号对数组参数进行分组以控制算术运算的顺序。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/699a4e99bf02db19b49f82453f0685c1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-24T15:51:28+08:00" />
<meta property="article:modified_time" content="2023-10-24T15:51:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Excel经验分享-单元格字符统计</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Excel_0"></a>Excel经验分享</h2> 
<h3><a id="_2"></a>如何在电子表选定范围内，统计任意字符出现的次数</h3> 
<h4><a id="_4"></a>根据日常统计需要，大概有三种情景：</h4> 
<h5><a id="_6"></a>情景一：</h5> 
<p>要查找的词完全占据一个单元格时，</p> 
<p>直接使用函数：<em>COUNTIF(range,criteria)</em>，即COUNTIF(查找范围，查找词)，<br> <img src="https://images2.imgbox.com/62/bc/89xcWnfR_o.png" alt="在这里插入图片描述"></p> 
<p><strong>示例：统计保卫人员“罗应光”本周内实际值班的次数，见下表：</strong></p> 
<p><img src="https://images2.imgbox.com/01/1e/3gYIXKRJ_o.png" alt="在这里插入图片描述"></p> 
<p><strong>操作方法：</strong></p> 
<p>选择任意空白单元格，在内输入：</p> 
<pre><code class="prism language-excel-formula">=countif(查找范围,“查找词”)  */如果没有正常统计结果，把查找词换为对应单元格地址
</code></pre> 
<p><img src="https://images2.imgbox.com/4d/44/1E0UPDyc_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_32"></a>情景二：</h5> 
<p>要查找的词是某一单元格内容的一部分且在一个单元格中只出现一次，也是使用COUNTIF函数，第二个参数是查找词加通配符，即COUNTIF(查找范围，“查找词+通配符”)；</p> 
<p><strong>查找词+通配符</strong>的形式如：“上海南站”“上海北站”“上海东站”可以统一使用“上海*”来表示，查找词与通配符是顺序排列的，即“上海*”表示的字段是“上海”开头之后为任意字符的意思。</p> 
<p><strong>示例：统计所有姓王的人员值班总数</strong></p> 
<p>任然可以使用countif()函数操作，如下图</p> 
<p><img src="https://images2.imgbox.com/17/5d/ahULscqu_o.png" alt="在这里插入图片描述"></p> 
<p>要注意的是，在我使用的office2013版的Excel2013中，在countif(range,criteria)函数的criteria参数位置直接输入需要查找或统计的字符是不会出结果的，只能输入字符所在的单元格地址，另外 <strong>“字符+通配符”</strong> 的形式提示函数错误。其他版本的excel是否有这个问题，不是很清楚。</p> 
<p><img src="https://images2.imgbox.com/73/60/QNgrFVwu_o.png" alt=""></p> 
<p>纠正：字符的输入两边必须加“”号，应该是受数字类型的限制，之上的错误主要原因就是没有在字符串两边加“”，Excel里所有符号都应该是<strong>英文符号</strong>，不能使用中文符号。</p> 
<p><img src="https://images2.imgbox.com/44/9c/SFtfYGov_o.png" alt=""></p> 
<h5><a id="_56"></a>情景三</h5> 
<p>要查找的词在一个单元格中出现多次，使用SUMPRODUCT函数，即SUMPRODUCT(LEN(查找范围)-LEN(SUBSTITUTE(查找范围，查找词，替换后的值)))。</p> 
<p>其中主要用到的有三个函数，分别为</p> 
<ul><li> <p>SUMPROUCT(array1,array2,array3…)，具体用法参看后文SUMPRODUCT函数</p> </li><li> <p>SUBSTITUTE()，用新字符替换查找字符</p> </li><li> <p>LEN()，返回字符数</p> </li></ul> 
<p>此用法灵活性比较高，关键是根据需要统计的字符，合理的选择“替换后的值”，最好使替换前和替换后字符相减后值为“1”，当然也可以选择最终统计完之后除以差值。</p> 
<h5><a id="_70"></a>示例：</h5> 
<h5><a id="SUMPRODUCT__76"></a>SUMPRODUCT 函数</h5> 
<p><strong>SUMPRODUCT</strong>函数返回相应范围或数组的个数之和。 默认操作是乘法，但也可以执行加减除运算。</p> 
<p>本示例使用 SUMPRODUCT 返回给定项和大小的总销售额：</p> 
<p><img src="https://images2.imgbox.com/90/78/1rp7ilVI_o.png" alt="在这里插入图片描述"></p> 
<p>SUMPRODUCT 匹配项 Y/大小 M 的所有实例并求和，因此对于此示例，21 加 41 等于 62。</p> 
<h3><a id="_87"></a>语法</h3> 
<p>若要使用默认操作 (乘法) ：</p> 
<p><strong>=SUMPRODUCT (array1， [array2]， [array3]， …)</strong></p> 
<p>SUMPRODUCT 函数语法具有下列参数：</p> 
<table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td><strong>array1</strong> 必需</td><td>其相应元素需要进行相乘并求和的第一个数组参数。</td></tr><tr><td><strong>[array2]， [array3],…</strong> 可选</td><td>2 到 255 个数组参数，其相应元素需要进行相乘并求和。</td></tr></tbody></table> 
<p><strong>执行其他算术运算</strong></p> 
<p>像往常一样使用 SUMPRODUCT，但请将分隔数组参数的逗号替换为所需的算术运算符 (*、/、+、-) 。 执行所有操作后，结果将像往常一样进行求和。</p> 
<p><strong>注意:</strong> 如果使用算术运算符，请考虑将数组参数括在括号中，并使用括号对数组参数进行分组以控制算术运算的顺序。</p> 
<h3><a id="_106"></a>备注</h3> 
<ul><li> <p>数组参数必须具有相同的维数。 否则，函数 SUMPRODUCT 将返回 #VALUE! 错误值 #REF!。 例如，=SUMPRODUCT (C2：C10，D2：D5) 将返回错误，因为范围的大小不同。</p> </li><li> <p>SUMPRODUCT 将非数值数组条目视为零。</p> </li><li> <p>为获得最佳性能，SUMPRODUCT 不应与完整列引用一同使用。 请考虑 =SUMPRODUCT (A：A，B：B) ，在此函数将 A 列中的 1，048，576 个单元格乘以 B 列中的 1，048，576 个单元格，然后再添加它们。</p> </li></ul> 
<h3><a id="_1_114"></a>示例 1</h3> 
<p><img src="https://images2.imgbox.com/48/cd/y6fjam3S_o.png" alt="在这里插入图片描述"></p> 
<p>若要使用上面的示例列表创建公式，请键入 =SUMPRODUCT (C2：C5，D2：D5) 并<strong>按 Enter。</strong> 列 C 中的每个单元格乘以 D 列中同一行中的对应单元格，结果将相加。 杂货的总量为 $78.97。</p> 
<p>若要编写提供相同结果的较长公式，请键入 =C2<em>D2+C3</em>D3+C4<em>D4+C5</em>D5，然后<strong>按 Enter。</strong> 按 Enter 后，结果相同：$78.97。 单元格 C2 乘以 D2，其结果将添加到单元格 C3 乘以单元格 D3 的结果，以此类比。</p> 
<h3><a id="_2_123"></a>示例 2</h3> 
<p>以下示例使用 SUMPRODUCT 按销售代理返回总净销售额，其中按代理计算总销售额和费用。 在这种情况下，我们将使用一个Excel表， <a href="https://support.office.microsoft.com/client/excel-%E8%A1%A8%E6%A6%82%E8%BF%B0-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c?NS=EXCEL&amp;Version=15&amp;AppVer=ZXL150" rel="nofollow"></a>它使用结构化<a href="https://support.office.microsoft.com/client/%E5%AF%B9-excel-%E8%A1%A8%E6%A0%BC%E4%BD%BF%E7%94%A8%E7%BB%93%E6%9E%84%E5%8C%96%E5%BC%95%E7%94%A8-f5ed2452-2337-4f71-bed3-c8ae6d2b276e?NS=EXCEL&amp;Version=15&amp;AppVer=ZXL150" rel="nofollow">引用而不是标准</a>引用Excel区域。 在这里，你将看到按名称引用"销售、支出"和"代理"范围。</p> 
<p><img src="https://images2.imgbox.com/2f/76/bmzO31sp_o.png" alt="在这里插入图片描述"></p> 
<p>公式为：=SUMPRODUCT ( ( (Table1[Sales]) + (Table1[Expenses]) ) * (Table1[Agent]=B8) ) ，它返回单元格 B8 中列出的代理的所有销售和费用的总和。</p> 
<h3><a id="_3_132"></a>示例 3</h3> 
<p>此示例中，我们想要返回给定区域销售的特定商品的总数。 在这种情况下，东部区域销售了多少个水果？</p> 
<p><img src="https://images2.imgbox.com/fe/c7/dvcTDsUZ_o.png" alt="在这里插入图片描述"></p> 
<p>此处的公式为：=SUMPRODUCT ( (B2：B9=B12) * (C2：C9=C12) *D2：D9) 。 它首先将"东部"的出现次数乘以匹配切分次数。 最后，对"销售额"列中相应行的值进行汇总。 若要了解如何Excel，请选择公式单元格，然后转到"公式"&gt;"公式&gt;<strong>计算"。</strong></p> 
<p>( (B2：B9=B12) * (C2：C9=C12) *D2：D9) 。 它首先将"东部"的出现次数乘以匹配切分次数。 最后，对"销售额"列中相应行的值进行汇总。 若要了解如何Excel，请选择公式单元格，然后转到"公式"&gt;"公式&gt;<strong>计算"。</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c9f5629c248e97e7857ea3cd780e5497/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">简单粗暴处理IDEA项目提示 Cannot resolve symbol ‘String‘错误</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3bf5c51bcaef3da3a799fe48ae0f741c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Pytorch--3.使用CNN和LSTM对数据进行预测</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>