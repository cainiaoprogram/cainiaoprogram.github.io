<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SM4加密(代发） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SM4加密(代发）" />
<meta property="og:description" content="SM4分组密码算法 一：SM4概念 SM4分组密码算法，原名SMS4，是国家密码管理局于2012年发布的密码行业标准之一（http://www.gb688.cn/bzgk/gb/newGbInfo?hcno=7803DE42D3BC5E80B0C3E5D8E873D56A）。与DES和AES算法类似，SM4算法是一种分组密码算法。其分组长度为128bit，密钥长度也为128bit。加密算法与密钥扩展算法均采用32轮非线性迭代Feistel结构，以字（32位）为单位进行加密运算，每一次迭代运算均为一轮变换函数F。SM4算法加/解密算法的结构相同，只是使用的轮密钥相反，其中解密轮密钥是加密轮密钥的逆序。 二：名词解释 1：分组密码
分组密码是将明文消息编码后的数字序列划分成长为N的分组，分别在密钥K=(k0,k1,k2 ……)的控制下变换成等长的数字序列（序列长为M，输入分组长度和输出分组长度可以不等）。 2：代换
为保证加解密运算可逆，明文的每个分组在特定的加密算法作用之后应当产生唯一的密文分组，明文分组到密文分组之间的可逆变换称为代换。 3：S 盒
如果明文和密文分组的长都为N比特，则每个明文分组都对应着2N种可能的取值，不同可逆代换的个数为(2N)!个，这也意味着密钥的长度为(2^N)!比特。从实际的角度来看，分组长度很大的可逆代换是不现实的，如果分组太小，又不能满足算法的安全性能。因此实际中常将分组分为较小的子段，可将长度为N的序列的代换拆分成m个较小的子代换，每个子代换称为代换盒，简称S盒或Sbox。SM4算法中，S盒的长度为8bit。 4：Feistel加密结构
Feistel加密算法的输入是长为2w的明文和一个密钥K=（K1，K2…,Kn）。将明文分组分成左右两半L和R，然后进行n轮迭代，迭代完成后，再将左右两半合并到一起以产生密文分组。其第i轮迭代的函数为：Li=Ri-1，Ri=Li-1&#43;F（Ri-1，Ki）其中Ki是第i轮的子密钥，“&#43;”表示异或运算，F表示轮函数。一般地，各轮的子密钥彼此各不相同，且轮函数F也各不相同。代换过程完成后，在交换左右两半数据，这一过程称为置换。
使用上述Feistel结构的密码有几个值得注意的特点:轮函数相对简单,需要将它迭代多轮，典型地，4、8、16和32轮较为常见。最重要的部分是加密和解密可以使用同样的结构:轮函数为这两种运 算的主体(加密和解密也可能有更多的区别。如，一些Feistel结构的密码对其初始轮和末尾轮有不同的形式，比如初始置换和末尾置换不同)。轮函数可以为非线性和不可逆的。在许多密码中，例如Caesar密码，核心函数都必须可逆：我们由此才能反过来解密。但是,对于Feistel结构的密码，我们不需要计算轮函数的逆。通常地,轮函数是置换、替代和其他函数的乘积密码。由于它只对一半比特进行运算，因而使用轮函数肯定能节约时间和空间，因此必须考虑–些问题：轮函数作用于一半比特,采用暴力破解需尝试的比特位更少。此外，由于轮函数的安全性决定了算法的安全性,它必须有足够的强度。 5 IV：初始化向量
三：SM4算法实现 1：SM4密码算法整体程序框图如下：
将数据分组生成明文，密钥通过多次轮函数迭代生成密文。
2 ：SM4算法结构图：
3：参数产生
（1）字节由8位2进制数表示，字由32位2进制数表示；
（2）S盒为固定的8位输入和输出置换（查表法实现）；
（3）加密密钥长度为128位，表示为MK=(MK0,MK1,MK2,MK3)，其中MKi (i=0,1,2,3)长度为字（32位）。轮密钥表示为rki（i=0,1,2…,31）长度为字（32位）。FK=(FK0,FK1,FK2,FK3)为系统参数，CK=(CK0,CK1,…,CK31)为固定参数，长度都为字（32位）。
4：轮函数
整体的加密函数为：
X i &#43; 4 = F ( X i , X i &#43; 1 , X i &#43; 2 , X i &#43; 3 , r k ) = X i ⨁ T ( X i ⨁ X i &#43; 1 ⨁ X i &#43; 2 ⨁ X i &#43; 3 ⨁ r k ) X_{i&#43;4}=F(X_{i},X_{i&#43;1},X_{i&#43;2},X_{i&#43;3},rk)=X_{i}\bigoplus T(X_{i}\bigoplus X_{i&#43;1}\bigoplus X_{i&#43;2}\bigoplus X_{i&#43;3}\bigoplus rk) Xi&#43;4​=F(Xi​,Xi&#43;1​,Xi&#43;2​,Xi&#43;3​,rk)=Xi​⨁T(Xi​⨁Xi&#43;1​⨁Xi&#43;2​⨁Xi&#43;3​⨁rk)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2b588fd5f1aa74752ab8e007cc76fccb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-16T16:34:50+08:00" />
<meta property="article:modified_time" content="2021-01-16T16:34:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SM4加密(代发）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="SM4_0"></a>SM4分组密码算法</h2> 
<h3><a id="SM4_1"></a>一：SM4概念</h3> 
<ul><li>SM4分组密码算法，原名SMS4，是国家密码管理局于2012年发布的密码行业标准之一（http://www.gb688.cn/bzgk/gb/newGbInfo?hcno=7803DE42D3BC5E80B0C3E5D8E873D56A）。与DES和AES算法类似，SM4算法是一种分组密码算法。其分组长度为128bit，密钥长度也为128bit。加密算法与密钥扩展算法均采用32轮非线性迭代Feistel结构，以字（32位）为单位进行加密运算，每一次迭代运算均为一轮变换函数F。SM4算法加/解密算法的结构相同，只是使用的轮密钥相反，其中解密轮密钥是加密轮密钥的逆序。</li></ul> 
<h3><a id="_3"></a>二：名词解释</h3> 
<p><strong>1：分组密码</strong></p> 
<ul><li>分组密码是将明文消息编码后的数字序列划分成长为N的分组，分别在密钥K=(k0,k1,k2 ……)的控制下变换成等长的数字序列（序列长为M，输入分组长度和输出分组长度可以不等）。</li></ul> 
<p><strong>2：代换</strong></p> 
<ul><li>为保证加解密运算可逆，明文的每个分组在特定的加密算法作用之后应当产生唯一的密文分组，明文分组到密文分组之间的可逆变换称为代换。</li></ul> 
<p><strong>3：S 盒</strong></p> 
<ul><li>如果明文和密文分组的长都为N比特，则每个明文分组都对应着2<sup>N种可能的取值，不同可逆代换的个数为(2</sup>N)!个，这也意味着密钥的长度为(2^N)!比特。从实际的角度来看，分组长度很大的可逆代换是不现实的，如果分组太小，又不能满足算法的安全性能。</li><li>因此实际中常将分组分为较小的子段，可将长度为N的序列的代换拆分成m个较小的子代换，每个子代换称为代换盒，简称S盒或Sbox。SM4算法中，S盒的长度为8bit。</li></ul> 
<p><strong>4：Feistel加密结构</strong></p> 
<ul><li>Feistel加密算法的输入是长为2w的明文和一个密钥K=（K1，K2…,Kn）。将明文分组分成左右两半L和R，然后进行n轮迭代，迭代完成后，再将左右两半合并到一起以产生密文分组。其第i轮迭代的函数为：Li=Ri-1，Ri=Li-1+F（Ri-1，Ki）其中Ki是第i轮的子密钥，“+”表示异或运算，F表示轮函数。一般地，各轮的子密钥彼此各不相同，且轮函数F也各不相同。代换过程完成后，在交换左右两半数据，这一过程称为置换。<br> <img src="https://images2.imgbox.com/a3/96/ErwREz5r_o.png" alt="在这里插入图片描述"><br> <strong>使用上述Feistel结构的密码有几个值得注意的特点:</strong></li><li>轮函数相对简单,需要将它迭代多轮，典型地，4、8、16和32轮较为常见。</li><li>最重要的部分是加密和解密可以使用同样的结构:轮函数为这两种运 算的主体(加密和解密也可能有更多的区别。如，一些Feistel结构的密码对其初始轮和末尾轮有不同的形式，比如初始置换和末尾置换不同)。</li><li>轮函数可以为非线性和不可逆的。在许多密码中，例如Caesar密码，核心函数都必须可逆：我们由此才能反过来解密。但是,对于Feistel结构的密码，我们不需要计算轮函数的逆。通常地,轮函数是置换、替代和其他函数的乘积密码。</li><li>由于它只对一半比特进行运算，因而使用轮函数肯定能节约时间和空间，因此必须考虑–些问题：轮函数作用于一半比特,采用暴力破解需尝试的比特位更少。此外，由于轮函数的安全性决定了算法的安全性,它必须有足够的强度。</li></ul> 
<p><strong>5 IV：初始化向量</strong></p> 
<h3><a id="SM4_24"></a>三：SM4算法实现</h3> 
<p><strong>1：SM4密码算法整体程序框图如下：</strong><br> <img src="https://images2.imgbox.com/95/6d/EoHBt9jQ_o.png" alt="在这里插入图片描述"><br> 将数据分组生成明文，密钥通过多次轮函数迭代生成密文。</p> 
<p><strong>2 ：SM4算法结构图：</strong><br> <img src="https://images2.imgbox.com/0e/2f/ILm83EfR_o.png" alt="在这里插入图片描述"></p> 
<p><strong>3：参数产生</strong><br> （1）字节由8位2进制数表示，字由32位2进制数表示；<br> （2）S盒为固定的8位输入和输出置换（查表法实现）；<br> （3）加密密钥长度为128位，表示为MK=(MK0,MK1,MK2,MK3)，其中MKi (i=0,1,2,3)长度为字（32位）。轮密钥表示为rki（i=0,1,2…,31）长度为字（32位）。FK=(FK0,FK1,FK2,FK3)为系统参数，CK=(CK0,CK1,…,CK31)为固定参数，长度都为字（32位）。</p> 
<p><strong>4：轮函数</strong><br> 整体的加密函数为：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           X 
          
          
          
            i 
           
          
            + 
           
          
            4 
           
          
         
        
          = 
         
        
          F 
         
        
          ( 
         
         
         
           X 
          
         
           i 
          
         
        
          , 
         
         
         
           X 
          
          
          
            i 
           
          
            + 
           
          
            1 
           
          
         
        
          , 
         
         
         
           X 
          
          
          
            i 
           
          
            + 
           
          
            2 
           
          
         
        
          , 
         
         
         
           X 
          
          
          
            i 
           
          
            + 
           
          
            3 
           
          
         
        
          , 
         
        
          r 
         
        
          k 
         
        
          ) 
         
        
          = 
         
         
         
           X 
          
         
           i 
          
         
        
          ⨁ 
         
        
          T 
         
        
          ( 
         
         
         
           X 
          
         
           i 
          
         
        
          ⨁ 
         
         
         
           X 
          
          
          
            i 
           
          
            + 
           
          
            1 
           
          
         
        
          ⨁ 
         
         
         
           X 
          
          
          
            i 
           
          
            + 
           
          
            2 
           
          
         
        
          ⨁ 
         
         
         
           X 
          
          
          
            i 
           
          
            + 
           
          
            3 
           
          
         
        
          ⨁ 
         
        
          r 
         
        
          k 
         
        
          ) 
         
        
       
         X_{i+4}=F(X_{i},X_{i+1},X_{i+2},X_{i+3},rk)=X_{i}\bigoplus T(X_{i}\bigoplus X_{i+1}\bigoplus X_{i+2}\bigoplus X_{i+3}\bigoplus rk) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.891661em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.60001em; vertical-align: -0.55001em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span></span></span></span></span></span></p> 
<p>其中T为一个合成置换，由非线性变换和线性变换复合而成。<br> 非线性变换由4个平行的S盒构成，S盒的数据均采用16进制，通过查表直接获得。<br> 线性变换公式如下，其中B为非线性变换得到的字.<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          C 
         
        
          = 
         
        
          L 
         
        
          ( 
         
        
          B 
         
        
          ) 
         
        
          = 
         
        
          B 
         
        
          ⨁ 
         
        
          ( 
         
        
          B 
         
        
          ≪ 
         
        
          2 
         
        
          ) 
         
        
          ⨁ 
         
        
          ( 
         
        
          B 
         
        
          ≪ 
         
        
          10 
         
        
          ) 
         
        
          ⨁ 
         
        
          ( 
         
        
          B 
         
        
          ≪ 
         
        
          18 
         
        
          ) 
         
        
          ⨁ 
         
        
          ( 
         
        
          B 
         
        
          ≪ 
         
        
          24 
         
        
          ) 
         
        
       
         C=L(B)=B\bigoplus (B\ll 2)\bigoplus (B\ll 10)\bigoplus(B\ll 18)\bigoplus (B\ll 24) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.60001em; vertical-align: -0.55001em;"></span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.60001em; vertical-align: -0.55001em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.60001em; vertical-align: -0.55001em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.60001em; vertical-align: -0.55001em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord">4</span><span class="mclose">)</span></span></span></span></span></span></p> 
<p><strong>5：密钥扩展（计算轮密钥）</strong><br> 已知加密密钥MK=(MK0,MK1,MK2,MK3)，系统参数FK=(FK0,FK1,FK2,FK3)，固定参数CK=(CK0,CK1,…,CK31).<br> rki为轮密钥，轮密钥由加密密钥生成。<br> 首先<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ( 
         
         
         
           K 
          
         
           0 
          
         
        
          , 
         
         
         
           K 
          
         
           1 
          
         
        
          , 
         
         
         
           K 
          
         
           2 
          
         
        
          , 
         
         
         
           K 
          
         
           3 
          
         
        
          ) 
         
        
          = 
         
        
          ( 
         
        
          M 
         
         
         
           K 
          
         
           0 
          
         
        
          ⨁ 
         
        
          F 
         
         
         
           K 
          
         
           0 
          
         
        
          , 
         
        
          M 
         
         
         
           K 
          
         
           1 
          
         
        
          ⨁ 
         
        
          ( 
         
         
         
           K 
          
          
          
            i 
           
          
            + 
           
          
            1 
           
          
         
        
          ⨁ 
         
         
         
           K 
          
          
          
            i 
           
          
            + 
           
          
            2 
           
          
         
        
          ⨁ 
         
         
         
           K 
          
          
          
            i 
           
          
            + 
           
          
            3 
           
          
         
        
          ⨁ 
         
        
          C 
         
         
         
           K 
          
         
           i 
          
         
        
          ) 
         
        
       
         (K_{0},K_{1},K_{2},K_{3})=(MK_{0}\bigoplus FK_{0},MK_{1}\bigoplus (K_{i+1}\bigoplus K_{i+2}\bigoplus K_{i+3}\bigoplus CK_{i}) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.60001em; vertical-align: -0.55001em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.10903em;">M</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">M</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 然后对i=0,1,2,…,31:<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          r 
         
         
         
           k 
          
         
           i 
          
         
        
          = 
         
         
         
           K 
          
          
          
            i 
           
          
            + 
           
          
            4 
           
          
         
        
          = 
         
         
         
           K 
          
         
           i 
          
         
        
          ⨁ 
         
         
         
           T 
          
         
           ′ 
          
         
        
          ( 
         
         
         
           K 
          
          
          
            i 
           
          
            + 
           
          
            1 
           
          
         
        
          ⨁ 
         
         
         
           K 
          
          
          
            i 
           
          
            + 
           
          
            2 
           
          
         
        
          ⨁ 
         
         
         
           K 
          
          
          
            i 
           
          
            + 
           
          
            3 
           
          
         
        
          ⨁ 
         
        
          C 
         
         
         
           K 
          
         
           i 
          
         
        
          ) 
         
        
       
         rk_{i}=K_{i+4}=K_{i}\bigoplus{T}'(K_{i+1}\bigoplus K_{i+2}\bigoplus K_{i+3}\bigoplus CK_{i}) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.891661em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.60001em; vertical-align: -0.55001em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 密钥扩展变换与加密中的T变换基本相同，只是将其中的线性变换改为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          L 
         
         
          
         
           ˙ 
          
         
        
          ( 
         
        
          B 
         
        
          ) 
         
        
          = 
         
        
          B 
         
        
          ⨁ 
         
        
          ( 
         
        
          B 
         
        
          ≪ 
         
        
          13 
         
        
          ) 
         
        
          ⨁ 
         
        
          ( 
         
        
          B 
         
        
          ≪ 
         
        
          23 
         
        
          ) 
         
        
       
         L\dot{}(B)=B\bigoplus(B\ll 13)\bigoplus (B\ll 23) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">L</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.13889em;">˙</span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.60001em; vertical-align: -0.55001em;"></span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.60001em; vertical-align: -0.55001em;"></span><span class="mord">1</span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: -5e-06em;">⨁</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord">3</span><span class="mclose">)</span></span></span></span></span></span><br> 由于系统参数个固定参数是已知的，轮密钥即可求得。<br> <strong>6：加解密过程</strong></p> 
<p>加密最后一轮变换时，输出为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ( 
         
         
         
           Y 
          
         
           0 
          
         
        
          , 
         
         
         
           Y 
          
         
           1 
          
         
        
          , 
         
         
         
           Y 
          
         
           2 
          
         
        
          , 
         
         
         
           Y 
          
         
           3 
          
         
        
          ) 
         
        
          = 
         
        
          R 
         
        
          ( 
         
         
         
           X 
          
         
           32 
          
         
        
          , 
         
         
         
           X 
          
         
           33 
          
         
        
          , 
         
         
         
           X 
          
         
           34 
          
         
        
          , 
         
         
         
           X 
          
         
           35 
          
         
        
          ) 
         
        
          = 
         
        
          ( 
         
         
         
           X 
          
         
           35 
          
         
        
          , 
         
         
         
           X 
          
         
           34 
          
         
        
          , 
         
         
         
           X 
          
         
           33 
          
         
        
          , 
         
         
         
           X 
          
         
           32 
          
         
        
          ) 
         
        
       
         (Y_{0},Y_{1},Y_{2},Y_{3})=R(X_{32},X_{33},X_{34},X_{35})=(X_{35},X_{34},X_{33},X_{32}) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.22222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.22222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.22222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.22222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 最后输出是加密的反序，解密时只是将轮密钥的使用顺序进行逆向进行。</p> 
<h3><a id="_76"></a>四：迭代模式</h3> 
<p><strong>1：ECB模式</strong><br> <img src="https://images2.imgbox.com/24/42/iXbrdFKF_o.png" alt="在这里插入图片描述"><br> 优点:<br> 1.简单；<br> 2.有利于并行计算；<br> 3.误差不会被传送；<br> 缺点:<br> 1.不能隐藏明文的模式；<br> 2.可能对明文进行主动攻击；<br> <strong>2：CBC模式</strong><br> <img src="https://images2.imgbox.com/a6/2b/e73j4LLQ_o.png" alt="在这里插入图片描述"><br> 优点：<br> 1.不容易主动攻击,安全性好于ECB,适合传输长度长的报文,是SSL、IPSec的标准。<br> 缺点：<br> 1.不利于并行计算；<br> 2.误差传递；<br> 3.需要初始化向量IV<br> <strong>3：CFB模式</strong><br> <img src="https://images2.imgbox.com/1a/6a/7nRCTdEA_o.png" alt="在这里插入图片描述"><br> 优点：<br> 1.隐藏了明文模式;<br> 2.分组密码转化为流模式;<br> 3.可以及时加密传送小于分组的数据;<br> 缺点:<br> 1.不利于并行计算;<br> 2.误差传送：一个明文单元损坏影响多个单元;<br> 3.唯一的IV;<br> <strong>4：OFB模式</strong><br> <img src="https://images2.imgbox.com/6c/59/IcZX7MxF_o.png" alt="在这里插入图片描述"><br> 优点:<br> 1.隐藏了明文模式;<br> 2.分组密码转化为流模式;<br> 3.可以及时加密传送小于分组的数据;<br> 缺点:<br> 1.不利于并行计算;<br> 2.对明文的主动攻击是可能的;<br> 3.误差传送：一个明文单元损坏影响多个单元;<br> 注：本程序中使用的是ECB模式</p> 
<h3><a id="_116"></a>五：代码解读</h3> 
<ul><li>源代码共有7个函数，原型如下：</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">four_uCh2uLong</span><span class="token punctuation">(</span>u8 <span class="token operator">*</span>in<span class="token punctuation">,</span> u32 <span class="token operator">*</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//四字节转换成u32</span>
<span class="token keyword">void</span> <span class="token function">uLong2four_uCh</span><span class="token punctuation">(</span>u32 in<span class="token punctuation">,</span> u8 <span class="token operator">*</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">//u32转换成四字节</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">move</span><span class="token punctuation">(</span>u32 data<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">//左移，保留丢弃位放置尾部</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">func_key</span><span class="token punctuation">(</span>u32 input<span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">//先使用Sbox进行非线性变化，再将线性变换L置换为L'</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">func_data</span><span class="token punctuation">(</span>u32 input<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//先使用Sbox进行非线性变化，再进行线性变换L</span>
<span class="token keyword">void</span> <span class="token function">encode_fun</span><span class="token punctuation">(</span>u8 len<span class="token punctuation">,</span>u8 <span class="token operator">*</span>key<span class="token punctuation">,</span> u8 <span class="token operator">*</span>input<span class="token punctuation">,</span> u8 <span class="token operator">*</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//加密函数</span>
<span class="token keyword">void</span> <span class="token function">decode_fun</span><span class="token punctuation">(</span>u8 len<span class="token punctuation">,</span>u8 <span class="token operator">*</span>key<span class="token punctuation">,</span> u8 <span class="token operator">*</span>input<span class="token punctuation">,</span> u8 <span class="token operator">*</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//解密函数</span>
</code></pre> 
<ul><li>其中前五个函数为算法内部使用函数，用户无需调用。encode_fun为加密函数，decode_fun为解密函数。</li><li>加密函数的原型为void encode_fun(u8 len,u8 *key, u8 *input, u8<br> *output);，共有四个参数，u8 len为待加密数据数组的长度，可手动给出或者使用sizeof自动计算。</li></ul> 
<pre><code class="prism language-c">u8 <span class="token operator">*</span>key为<span class="token number">16</span>字节的密钥数组，由用户给出
u8 <span class="token operator">*</span>input为待加密数组（明文），长度应小于<span class="token number">256</span>字节
u8 <span class="token operator">*</span>output为已加密数组（密文），长度应小于<span class="token number">256</span>字节
</code></pre> 
<ul><li>解密函数的原型为void decode _fun(u8 len,u8 *key, u8 *input, u8 *output);，共有四个参数，u8 len为待解密数据数组的长度，可手动给出或者使用sizeof自动计算。</li></ul> 
<pre><code class="prism language-c">u8 <span class="token operator">*</span>key为<span class="token number">16</span>字节的密钥数组，由用户给出
u8 <span class="token operator">*</span>input为待解密数组（密文），长度应小于<span class="token number">256</span>字节
u8 <span class="token operator">*</span>output为已解密数组（明文），长度应小于<span class="token number">256</span>字节
</code></pre> 
<ul><li>例子1：</li></ul> 
<pre><code class="prism language-c"><span class="token function">encode_fun</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Data_plain<span class="token punctuation">)</span><span class="token punctuation">,</span>key<span class="token punctuation">,</span> Data_ plain<span class="token punctuation">,</span> encode_ Result<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//数据加密</span>
<span class="token function">decode_fun</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Data_plain<span class="token punctuation">)</span><span class="token punctuation">,</span>key<span class="token punctuation">,</span> encode_Result<span class="token punctuation">,</span> decode_Result<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//数据解密</span>
</code></pre> 
<p>其中Data_plain为明文，key为密钥，encode_Result为密文，decode_Result为已解密的明文，对比decode_Result和Data_plain的值是否相等，就可以初步验证加解密是否正常。</p> 
<ul><li>例子2：</li></ul> 
<pre><code class="prism language-c">u8 encode_Result<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//定义加密输出缓存区</span>
u8 decode_Result<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//定义解密输出缓存区</span>
u8 key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
u8 Data plain<span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">1</span> <span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token operator">/</span>定义<span class="token number">200</span>字节的原始输入数据<span class="token punctuation">(</span>测试用<span class="token punctuation">)</span>
encode_ <span class="token function">fun</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Data plain<span class="token punctuation">)</span><span class="token punctuation">,</span>key<span class="token punctuation">,</span> Data plain<span class="token punctuation">,</span> encode_ Result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//数据加密</span>
decode_ <span class="token function">_fun</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Data plain<span class="token punctuation">)</span><span class="token punctuation">,</span>key<span class="token punctuation">,</span> encode Result<span class="token punctuation">,</span> decode_ Result<span class="token punctuation">)</span> 
<span class="token comment">//数据解密</span>
</code></pre> 
<p>其中encode_Result和decode_Result为用户定义的u8数组，长度不得小于待加密数据的长度。Key为密钥，用户自行给出。<br> 源码解读1：</p> 
<pre><code class="prism language-c"><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>定义系统参数FK的取值<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>
<span class="token keyword">const</span> u32 TBL SYS PARAMS<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
<span class="token number">0xa3b1bac6</span><span class="token punctuation">,</span>
<span class="token number">0x56aa3350</span>，
<span class="token number">0x677d9197</span><span class="token punctuation">,</span>
<span class="token number">0xb27022dc</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>定义固定参数CK的取值<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>
<span class="token keyword">const</span> u32 TBL_FIX_PARAMS<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
<span class="token number">0x00070e15</span><span class="token punctuation">,</span><span class="token number">0x1c232a31</span><span class="token punctuation">,</span><span class="token number">0x383f464d</span><span class="token punctuation">,</span><span class="token number">0x545b6269</span><span class="token punctuation">,</span>
<span class="token number">0x70777e85</span><span class="token punctuation">,</span><span class="token number">0x8c939aa1</span><span class="token punctuation">,</span><span class="token number">0xa8afb6bd</span><span class="token punctuation">,</span><span class="token number">0xc4cbd2d9</span><span class="token punctuation">,</span>
<span class="token number">0xe0e7eef5</span><span class="token punctuation">,</span><span class="token number">0xfc030a11</span><span class="token punctuation">,</span><span class="token number">0x181f262d</span><span class="token punctuation">,</span><span class="token number">0x343b4249</span><span class="token punctuation">,</span>
<span class="token number">0x5057</span> <span class="token number">5e65</span><span class="token punctuation">,</span><span class="token number">0x6c737a81</span> <span class="token punctuation">,</span><span class="token number">0x888f969d</span><span class="token punctuation">,</span><span class="token number">0xa4abb2b9</span><span class="token punctuation">,</span>
<span class="token number">0xc0c7ced5</span><span class="token punctuation">,</span><span class="token number">0xdce3eaf1</span><span class="token punctuation">,</span><span class="token number">0xf8ff060d</span><span class="token punctuation">,</span><span class="token number">0x141b2229</span><span class="token punctuation">,</span>
<span class="token number">0x30373e45</span><span class="token punctuation">,</span><span class="token number">0x4c535a61</span> <span class="token punctuation">,</span><span class="token number">0x686f767d</span><span class="token punctuation">,</span><span class="token number">0x848b9299</span><span class="token punctuation">,</span>
<span class="token number">0xa0a7aeb5</span><span class="token punctuation">,</span><span class="token number">0xbcc3cad1</span><span class="token punctuation">,</span><span class="token number">0xd8dfe6ed</span><span class="token punctuation">,</span><span class="token number">0xf4fb0209</span><span class="token punctuation">,</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>Box参数列表<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>
<span class="token keyword">const</span> u8 TBL_SBOX<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
<span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xe</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0xc2</span> <span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span>
<span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x67</span> <span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span>
<span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span>
<span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span>
<span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span>
<span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0x7</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span>
<span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0xd1</span> <span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span>
<span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0xe</span> <span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span>
<span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0xc</span> <span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0x6</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span>
</code></pre> 
<p>其中FK CK SBox均为固定值，在库里面已经给出。<br> 例程可通过百度文库获得：<br> 链接：https://pan.baidu.com/s/1khJ9yahy7BF_6I617SqceA<br> 提取码：lr37<br> 库文件也可通过百度文库获得：<br> 链接：https://pan.baidu.com/s/1uPdGYqnAxyPtLEANpwOygA<br> 提取码：dwkv</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bf286696b4f8cf5e6719cfe1b169037f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Win10&#43;VS2019&#43;PCL1.11.1配置方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/89d0f215bac6d4c425df5b56ccaa4b70/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">闲鱼开发接口_闲鱼｜支撑千万日活的交易链路架构如何设计？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>