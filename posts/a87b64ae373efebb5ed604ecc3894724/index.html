<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>通过itextpdf向PDF文件最后一页添加图片 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="通过itextpdf向PDF文件最后一页添加图片" />
<meta property="og:description" content="产品需求: 在pdf 最后一页嵌上签名,因为每个pdf 内容不一样,故不能用pdf 模板的方式,所以采用将签名嵌在最后一页.
最终方案,首先上最终代码:
public static void main(String[] args) throws Exception { ​​​​​​​ PdfReader reader = null; PdfStamper stamper = null; FileInputStream fis = null; try { fis = new FileInputStream(new File(&#34;C:\\Users\\EDZ\\Desktop\\peletter.pdf&#34;)); } catch (FileNotFoundException e) { log.error(&#34;pdf文件路径不正确&#34;,e); } String path = &#34;C:\\Users\\EDZ\\Desktop\\peletter888.pdf&#34;; try { reader = new PdfReader(fis); stamper = new PdfStamper(reader, new FileOutputStream(path)); //新增空白页 stamper.insertPage(reader.getNumberOfPages() &#43; 1, reader.getPageSizeWithRotation(1)); //捕获新增的空白页 PdfContentByte under = stamper.getOverContent(reader.getNumberOfPages()); Image image = Image." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a87b64ae373efebb5ed604ecc3894724/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-22T11:37:32+08:00" />
<meta property="article:modified_time" content="2022-09-22T11:37:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">通过itextpdf向PDF文件最后一页添加图片</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>产品需求: 在pdf 最后一页嵌上签名,因为每个pdf 内容不一样,故不能用pdf 模板的方式,所以采用将签名嵌在最后一页.</p> 
<p>最终方案,首先上最终代码:</p> 
<pre><code class="hljs">public static void main(String[] args) throws Exception {    
​​​​​​​    PdfReader reader = null;
    PdfStamper stamper = null;
    FileInputStream fis = null;
    try {
        fis = new FileInputStream(new File("C:\\Users\\EDZ\\Desktop\\peletter.pdf"));

    } catch (FileNotFoundException e) {
        log.error("pdf文件路径不正确",e);
    }
    String path = "C:\\Users\\EDZ\\Desktop\\peletter888.pdf";
    try {
        reader = new PdfReader(fis);
        stamper = new PdfStamper(reader, new FileOutputStream(path));
        //新增空白页
        stamper.insertPage(reader.getNumberOfPages() + 1, reader.getPageSizeWithRotation(1));
        //捕获新增的空白页
        PdfContentByte under = stamper.getOverContent(reader.getNumberOfPages());
        Image image = Image.getInstance("C:\\Users\\EDZ\\Desktop\\sign.jpg");
        // 图片大小 宽，高
        image.scaleAbsolute(250, 200);

        image.setAbsolutePosition(25, 530);
        under.addImage(image);
        stamper.close();
        reader.close();
    } catch (DocumentException | IOException e) {
        log.error("向pdf追加图片失败",e);
    } finally {
        if (ObjectUtils.isEmpty(stamper)) {
            stamper.close();
        }
        if (ObjectUtils.isEmpty(reader)) {
            reader.close();
        }
    }
}</code></pre> 
<p>最终效果:</p> 
<p><img alt="" height="885" src="https://images2.imgbox.com/49/81/LMnLgygQ_o.png" width="898"></p> 
<p> </p> 
<p>之前尝试的两种方案都不尽人意,</p> 
<p>方案一: 把签名图片固定在某一页(第一页的某个位置,功能能实现,不满足产品需求,就像是水印嵌在pdf 的某个位置(同样可以设置图片大小和横纵坐标))</p> 
<pre><code class="hljs">File file = new File("C:\\Users\\EDZ\\Desktop\\peletter.pdf");
        //合成后的文件
        FileOutputStream outputStream = new FileOutputStream("C:\\Users\\EDZ\\Desktop\\peletter_sign1.pdf");
        PdfReader pdfReader = new PdfReader(new FileInputStream(file));
        PdfStamper pdfStamper = new PdfStamper(pdfReader, outputStream);
        //将签名图片放在pdf文件的第4页
        PdfContentByte pdfContentByte = pdfStamper.getOverContent(1);
        //签名图片
        Image contractSealImg = Image.getInstance("C:\\Users\\EDZ\\Desktop\\sign.jpg");
        pdfContentByte.saveState();
        PdfGState pdfGState = new PdfGState();
        //给图片设置透明度
        pdfGState.setFillOpacity(0.8F);
        pdfContentByte.setGState(pdfGState);
        //设置图片位置
//        contractSealImg.setAbsolutePosition(75, 320);
        //设置图片大小
//        contractSealImg.scaleAbsolute(80, 60);
        contractSealImg.setAbsolutePosition(80, 80);
        contractSealImg.scaleAbsolute(200, 200);
        //将图片添加到pdf文件
        pdfContentByte.addImage(contractSealImg);
        pdfContentByte.restoreState();
        pdfStamper.setFormFlattening(true);
        pdfStamper.close();
        pdfReader.close();
        outputStream.close();</code></pre> 
<p>效果图:</p> 
<p><img alt="" height="776" src="https://images2.imgbox.com/cb/bb/nH1lNdne_o.png" width="1024"></p> 
<p> </p> 
<p>方案二: 思路: 将图片转成PDF ,再 合并pdf,用的spire插件,能实现功能,但是最后两张上面均有水印,除去 比较麻烦:</p> 
<p>&lt;dependency&gt;<br>     &lt;groupId&gt;e-iceblue&lt;/groupId&gt;<br>     &lt;artifactId&gt;spire.office&lt;/artifactId&gt;<br>     &lt;version&gt;2.10.0&lt;/version&gt;<br> &lt;/dependency&gt;<br> pdf 去水印: Evaluation Warning : The document was created with Spire.PDF for Java.</p> 
<pre><code class="hljs">//获取要合并的PDF文档的路径
        String[] files = new String[]{"C:\\\\Users\\\\EDZ\\\\Desktop\\\\peletter.pdf", "output/ToPDF1.pdf"};

        //合并这些文档并返回一个 PdfDocumentBase 类对象
        PdfDocumentBase doc = PdfDocument.mergeFiles(files);

        //保存合并后的文档
        doc.save("4.pdf", FileFormat.PDF);*/

        /*//加载PDF文档
        PdfDocument pdf = new PdfDocument();
        pdf.loadFromFile("C:\\Users\\EDZ\\Desktop\\4.pdf");
        //添加一个空白页，目的为了删除jar包添加的水印，后面再移除这一页
        pdf.getPages().add();
        //移除第一个页
        pdf.getPages().remove(pdf.getPages().get(0));
        //pdf.getPages().remove(pdf.getPages().get(pdf.getPages().getCount()-1));
        //保存为另外一个文档
        pdf.saveToFile("C:\\Users\\EDZ\\Desktop\\7.pdf");*/

//        PdfDocument pdf = new PdfDocument();
//        pdf.loadFromFile("C:\\Users\\EDZ\\Desktop\\4.pdf");
//        //保存为Word格式
//        pdf.saveToFile("a.docx", FileFormat.DOCX);

//        DocToPDF.docTopdf("C:\\Users\\EDZ\\Desktop\\a.docx", "C:\\Users\\EDZ\\Desktop\\8.pdf", "C:\\Users\\EDZ\\Desktop\\");

        /*PdfDocument pdf = new PdfDocument();
        pdf.loadFromFile("C:\\Users\\EDZ\\Desktop\\ToPDF.pdf");
        int pageCount = pdf.getPages().getCount();
        log.info("pageCount: {}", pageCount);
        pdf.getPages().add();
        //获取PDF文件的页数
        int pageCount1 = pdf.getPages().getCount();
        log.info("pageCount1: {}", pageCount1);
//        pdf.getPages().remove(pdf.getPages().get(0));
        pdf.getPages().remove(pdf.getPages().get(pdf.getPages().getCount()-1));
        pdf.saveToFile("C:\\Users\\EDZ\\Desktop\\9.pdf");*/

        /*//加载Word文档
        Document document = new Document("C:\\Users\\EDZ\\Desktop\\a.docx");
        //使用新文本替换文档中的指定文本
        document.replace("Evaluation Warning : The document was created with Spire.PDF for Java.", "", false, true);
        //保存文档
        document.saveToFile("C:\\Users\\EDZ\\Desktop\\c.docx");

        PdfDocument pdf = new PdfDocument();
        pdf.loadFromFile("C:\\Users\\EDZ\\Desktop\\ToPDF.pdf");
        //保存为Word格式
        pdf.saveToFile("d.docx", FileFormat.DOCX);

        //获取要合并的PDF文档的路径
        String[] files = new String[]{"C:\\Users\\EDZ\\Desktop\\peletter.pdf", "output/ToPDF1.pdf"};
        //合并这些文档并返回一个 PdfDocumentBase 类对象
        PdfDocumentBase doc = PdfDocument.mergeFiles(files);

        //保存合并后的文档
        doc.save("8.pdf", FileFormat.PDF);*/</code></pre> 
<p><img alt="" height="882" src="https://images2.imgbox.com/7a/15/nvANSbOJ_o.png" width="736"></p> 
<p> </p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/de7b9ddf47709652ff8067d9b68919b2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue项目启动报错：npm ERR! job-schedule@0.1.0 serve: `vue-cli-service serve`以及No matching version found forX</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0d6a88fb672886fdae3191ddcc9f5aea/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Visio Viewer for Mac(Visio文件编辑查看工具)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>