<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pytorch - Cross Entropy Loss - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Pytorch - Cross Entropy Loss" />
<meta property="og:description" content="Pytorch - Cross Entropy Loss Pytorch 提供的交叉熵相关的函数有:
torch.nn.CrossEntropyLoss
torch.nn.KLDivLoss
torch.nn.BCELoss
torch.nn.BCEWithLogitsLoss
torch.nn.MultiLabelSoftMarginLoss
​
1. CrossEntropyLoss class torch.nn.CrossEntropyLoss(weight=None, size_average=True, ignore_index=-100, reduce=True)[source] 作用
针对单目标分类问题, 结合了 nn.LogSoftmax() 和 nn.NLLLoss() 来计算 loss.
用于训练 C C 类别classes 的分类问题. 参数 weight 是 1D Tensor, 分别对应每个类别class 的权重. 对于类别不平衡的训练数据集比较有用.
输入input 包含了每一类别的概率或score.
输入 input Tensor 的大小是 (minibatch,C)(minibatch,C) 或 (minibatch,C,d1,d2,...,dK) ( m i n i b a t c h , C , d 1 , d 2 , ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/20fdd4166cededad690b87684d812707/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-05-04T15:56:37+08:00" />
<meta property="article:modified_time" content="2018-05-04T15:56:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Pytorch - Cross Entropy Loss</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2 id="pytorch-cross-entropy-loss">Pytorch - Cross Entropy Loss</h2> 
<p>Pytorch 提供的交叉熵相关的函数有:</p> 
<ul><li><p><a href="https://pytorch.org/docs/stable/_modules/torch/nn/modules/loss.html#CrossEntropyLoss" rel="nofollow">torch.nn.CrossEntropyLoss</a></p></li><li><p><a href="https://pytorch.org/docs/stable/_modules/torch/nn/modules/loss.html#KLDivLoss" rel="nofollow">torch.nn.KLDivLoss</a></p></li><li><p><a href="https://pytorch.org/docs/stable/_modules/torch/nn/modules/loss.html#BCELoss" rel="nofollow">torch.nn.BCELoss</a></p></li><li><p><a href="https://pytorch.org/docs/stable/_modules/torch/nn/modules/loss.html#BCEWithLogitsLoss" rel="nofollow">torch.nn.BCEWithLogitsLoss</a></p></li><li><p><a href="https://pytorch.org/docs/stable/_modules/torch/nn/modules/loss.html#MultiLabelSoftMarginLoss" rel="nofollow">torch.nn.MultiLabelSoftMarginLoss</a></p> <p>​</p></li></ul> 
<h3 id="1-crossentropyloss">1. CrossEntropyLoss</h3> 
<pre class="prettyprint eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);"><code class="language-python hljs "><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">torch</span>.<span class="hljs-title">nn</span>.<span class="hljs-title">CrossEntropyLoss</span><span class="hljs-params">(weight=None, size_average=True, ignore_index=-<span class="hljs-number">100</span>, reduce=True)</span>[<span class="hljs-title">source</span>]</span></code></pre> 
<ul><li><p>作用</p> <p>针对单目标分类问题, 结合了 <strong>nn.LogSoftmax()</strong> 和 <strong>nn.NLLLoss()</strong> 来计算 loss.</p> <p>用于训练 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1059" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1000.77em, 2.308em, -999.997em); top: -2.149em; left: 0em;"><span class="mrow" id="MathJax-Span-1060"><span class="mi" id="MathJax-Span-1061" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.154em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        C 
       
     </span></span><script type="math/tex" id="MathJax-Element-55">C</script> 类别classes 的分类问题. </p>

<p>参数 <code class="eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);">weight</code> 是 1D Tensor, 分别对应每个类别class 的权重. 对于类别不平衡的训练数据集比较有用.</p>

<p>输入<code class="eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);">input</code> 包含了每一类别的概率或score.</p>

<p>输入 input Tensor 的大小是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mo stretchy="false"&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy="false"&gt;)&lt;/mo&gt;&lt;/math&gt;' role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1062" style="width: 7.892em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.457em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1006.36em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1063"><span class="mo" id="MathJax-Span-1064" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1065" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-1066" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1067" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1068" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1069" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-1070" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1071" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-1072" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1073" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-1074" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1075" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1076" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>m</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mo>,</mo><mi>C</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-56">(minibatch, C)</script> 或 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1077" style="width: 15.166em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.4em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1012.3em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1078"><span class="mo" id="MathJax-Span-1079" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1080" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-1081" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1082" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1083" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1084" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-1085" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1086" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-1087" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1088" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-1089" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1090" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1091" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1092" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1093" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-1094" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1095" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1096" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1097" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-1098" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1099" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1100" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-1101" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-1102" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-1103" style="font-family: MathJax_Main; padding-left: 0.156em;">,</span><span class="msubsup" id="MathJax-Span-1104" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1105" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1106" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1107" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        ( 
       
      
        m 
       
      
        i 
       
      
        n 
       
      
        i 
       
      
        b 
       
      
        a 
       
      
        t 
       
      
        c 
       
      
        h 
       
      
        , 
       
      
        C 
       
      
        , 
       
       
       
         d 
        
       
         1 
        
       
      
        , 
       
       
       
         d 
        
       
         2 
        
       
      
        , 
       
      
        . 
       
      
        . 
       
      
        . 
       
      
        , 
       
       
       
         d 
        
       
         K 
        
       
      
        ) 
       
     </span></span><script type="math/tex" id="MathJax-Element-57">(minibatch, C, d_1, d_2, ..., d_K)</script>. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1108" style="width: 3.281em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.666em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1002.62em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1109"><span class="mi" id="MathJax-Span-1110" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1111" style="font-family: MathJax_Main; padding-left: 0.259em;">≥</span><span class="mn" id="MathJax-Span-1112" style="font-family: MathJax_Main; padding-left: 0.259em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        K 
       
      
        ≥ 
       
      
        2 
       
     </span></span><script type="math/tex" id="MathJax-Element-58">K \geq 2</script> 表示 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1113" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.92em, 2.308em, -999.997em); top: -2.149em; left: 0em;"><span class="mrow" id="MathJax-Span-1114"><span class="mi" id="MathJax-Span-1115" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.154em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        K 
       
     </span></span><script type="math/tex" id="MathJax-Element-59">K</script>-dim 场景.</p>

<p>输入 target 是类别class 的索引(<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mo stretchy="false"&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy="false"&gt;]&lt;/mo&gt;&lt;/math&gt;' role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1116" style="width: 4.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.896em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.79em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1117"><span class="mo" id="MathJax-Span-1118" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-1119" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1120" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1121" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1122" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-1123" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span><span class="mo" id="MathJax-Span-1124" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>C</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-60">[0, C-1]</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1125" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1000.77em, 2.308em, -999.997em); top: -2.149em; left: 0em;"><span class="mrow" id="MathJax-Span-1126"><span class="mi" id="MathJax-Span-1127" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.154em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        C 
       
     </span></span><script type="math/tex" id="MathJax-Element-61">C</script> 是类别classes 总数.)</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy="false"&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy="false"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy="false"&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy="false"&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy="false"&gt;[&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy="false"&gt;]&lt;/mo&gt;&lt;mo stretchy="false"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/munder&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy="false"&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy="false"&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy="false"&gt;]&lt;/mo&gt;&lt;mo stretchy="false"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo stretchy="false"&gt;)&lt;/mo&gt;&lt;/math&gt;' role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1128" style="width: 17.164em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.039em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.925em, 1013.94em, 3.076em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1129"><span class="mi" id="MathJax-Span-1130" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1131" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1132" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1133" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1134" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1135" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1136" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1137" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">c</span><span class="mi" id="MathJax-Span-1138" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1139" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1140" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1141" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1142" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1143" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-1144" style="font-family: MathJax_Main; padding-left: 0.259em;">−</span><span class="mi" id="MathJax-Span-1145" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1146" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1147" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1148" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-1149"><span style="display: inline-block; position: relative; width: 4.101em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.332em, 1003.95em, 4.306em, -999.997em); top: -4.557em; left: 50%; margin-left: -1.995em;"><span class="mrow" id="MathJax-Span-1150"><span class="mi" id="MathJax-Span-1151" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1153" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1154" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1155" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1156" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1157" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1158" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1159" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1160" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1161" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1162" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1163" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1003.85em, 4.46em, -999.997em); top: -3.532em; left: 50%; margin-left: -1.944em;"><span class="mrow" id="MathJax-Span-1164"><span class="munderover" id="MathJax-Span-1165"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.72em, 4.306em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1166" style="font-size: 70.7%; font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.788em; left: 0.771em;"><span class="mi" id="MathJax-Span-1167" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-1168" style="font-size: 70.7%; font-family: MathJax_Math-italic; padding-left: 0.259em;">e</span><span class="mi" id="MathJax-Span-1169" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1170" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1171" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1173" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1174" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1175" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1176" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1004.1em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.101em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-1177" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.934em; border-left: 0px solid; width: 0px; height: 2.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">[</mo><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mi>j</mi></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow></mfrac><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-62">loss(x, class) = -log (\frac{exp(x[class])}{\sum_j exp(x[j])})</script></p> <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1178" style="width: 24.029em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.675em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1019.57em, 2.769em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1179"><span class="mi" id="MathJax-Span-1180" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1181" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1182" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1183" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1184" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1185" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1186" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1187" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">c</span><span class="mi" id="MathJax-Span-1188" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1189" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1190" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1191" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1192" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1193" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-1194" style="font-family: MathJax_Main; padding-left: 0.259em;">−</span><span class="mi" id="MathJax-Span-1195" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1196" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1197" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1198" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1199" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1200" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1201" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1202" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1203" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-1204" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">l</span><span class="mi" id="MathJax-Span-1205" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1206" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1207" style="font-family: MathJax_Main;">(</span><span class="munderover" id="MathJax-Span-1208"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.03em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1209" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.686em; left: 1.078em;"><span class="mi" id="MathJax-Span-1210" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-1211" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">e</span><span class="mi" id="MathJax-Span-1212" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1213" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1214" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1215" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1216" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1217" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1218" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1219" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1220" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        l 
       
      
        o 
       
      
        s 
       
      
        s 
       
      
        ( 
       
      
        x 
       
      
        , 
       
      
        c 
       
      
        l 
       
      
        a 
       
      
        s 
       
      
        s 
       
      
        ) 
       
      
        = 
       
      
        − 
       
      
        x 
       
      
        [ 
       
      
        c 
       
      
        l 
       
      
        a 
       
      
        s 
       
      
        s 
       
      
        ] 
       
      
        + 
       
      
        l 
       
      
        o 
       
      
        g 
       
      
        ( 
       
       
       
         ∑ 
        
       
         j 
        
       
      
        e 
       
      
        x 
       
      
        p 
       
      
        ( 
       
      
        x 
       
      
        [ 
       
      
        j 
       
      
        ] 
       
      
        ) 
       
      
        ) 
       
     </span></span><script type="math/tex" id="MathJax-Element-63">loss(x, class) = -x[class] + log(\sum_j exp(x[j]))</script></p> <p>带 <code class="eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);">weight</code>形式:</p> <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1221" style="width: 31.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.13em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1026.03em, 2.769em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1222"><span class="mi" id="MathJax-Span-1223" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1224" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1225" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1226" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1227" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1228" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1229" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1230" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">c</span><span class="mi" id="MathJax-Span-1231" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1232" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1233" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1234" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1235" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1236" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1237" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">w</span><span class="mi" id="MathJax-Span-1238" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1239" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1240" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1241" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1242" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1243" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1244" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1245" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1246" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1247" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1248" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1249" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1250" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1251" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1252" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1253" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1254" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1255" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1256" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1257" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1258" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1259" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1260" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-1261" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">l</span><span class="mi" id="MathJax-Span-1262" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1263" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1264" style="font-family: MathJax_Main;">(</span><span class="munderover" id="MathJax-Span-1265"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.03em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1266" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.686em; left: 1.078em;"><span class="mi" id="MathJax-Span-1267" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-1268" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">e</span><span class="mi" id="MathJax-Span-1269" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1270" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1271" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1272" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1273" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1274" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1275" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1276" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1277" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1278" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        l 
       
      
        o 
       
      
        s 
       
      
        s 
       
      
        ( 
       
      
        x 
       
      
        , 
       
      
        c 
       
      
        l 
       
      
        a 
       
      
        s 
       
      
        s 
       
      
        ) 
       
      
        = 
       
      
        w 
       
      
        e 
       
      
        i 
       
      
        g 
       
      
        h 
       
      
        t 
       
      
        [ 
       
      
        c 
       
      
        l 
       
      
        a 
       
      
        s 
       
      
        s 
       
      
        ] 
       
      
        ( 
       
      
        − 
       
      
        x 
       
      
        [ 
       
      
        c 
       
      
        l 
       
      
        a 
       
      
        s 
       
      
        s 
       
      
        ] 
       
      
        + 
       
      
        l 
       
      
        o 
       
      
        g 
       
      
        ( 
       
       
       
         ∑ 
        
       
         j 
        
       
      
        e 
       
      
        x 
       
      
        p 
       
      
        ( 
       
      
        x 
       
      
        [ 
       
      
        j 
       
      
        ] 
       
      
        ) 
       
      
        ) 
       
      
        ) 
       
     </span></span><script type="math/tex" id="MathJax-Element-64">loss(x, class) = weight[class](-x[class] + log(\sum_jexp(x[j])))</script></p> <p>losses 在 minibatch 内求平均.</p> <p>也支持高维输入 inputs, 如 2D images, 则会逐元素计算 NLL Loss.</p></li><li><p>参数:</p> 
  <blockquote class="eye-protector-processed" style="transition: background-color 0.3s ease; border-left-color: rgba(0, 0, 0, 0.35); background-color: rgb(193, 230, 198);"> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>weight</strong>(Tensor, optional) - 每个类别class 的权重. 默认为值为 1 的 Tensor.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>size_average</strong>(bool, optional) – 默认为 True. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ size_average=True, 则 losses 在 minibatch 结合 <strong>weight</strong> 求平均average. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ size_average=False, 则losses 在 minibatch 求相加和sum. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ 当 reduce=False 时,忽略该参数.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>ignore_index</strong>(int, optional) - 指定忽略的 target 值, 不影响 input 梯度计算.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ 当 size_average=True, 对所有非忽略的 targets 求平均.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>reduce</strong>(bool, optional) - 默认为 True.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ reduce=True, 则 losses 在 minibatch 求平均或相加和.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ reduce=False, 则 losses 返回 per batch 值, 并忽略 size_average.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输入 - input x, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1279" style="width: 3.457em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.813em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1002.7em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1280"><span class="mo" id="MathJax-Span-1281" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1282" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1283" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1284" style="font-family: MathJax_Math-italic; padding-left: 0.179em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1285" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         ( 
        
       
         N 
        
       
         , 
        
       
         C 
        
       
         ) 
        
      </span></span><script type="math/tex" id="MathJax-Element-65">(N, C)</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1286" style="width: 9.546em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.79em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.291em, 1007.73em, 2.403em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1287"><span class="mi" id="MathJax-Span-1288" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1289" style="font-family: MathJax_Main; padding-left: 0.296em;">=</span><span class="mi" id="MathJax-Span-1290" style="font-family: MathJax_Math-italic; padding-left: 0.296em;">n</span><span class="mi" id="MathJax-Span-1291" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-1292" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-1293" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-1294" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1295" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1296" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1297" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1298" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1299" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1300" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.139em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         C 
        
       
         = 
        
       
         n 
        
       
         u 
        
       
         m 
        
       
         _ 
        
       
         c 
        
       
         l 
        
       
         a 
        
       
         s 
        
       
         s 
        
       
         e 
        
       
         s 
        
      </span></span><script type="math/tex" id="MathJax-Element-66">C = num\_classes</script> 类别总数. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输入 - target y, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1301" style="width: 1.994em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1001.52em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1302"><span class="mo" id="MathJax-Span-1303" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1304" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1305" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         ( 
        
       
         N 
        
       
         ) 
        
      </span></span><script type="math/tex" id="MathJax-Element-67">(N)</script>, 每个值都是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1306" style="width: 11.888em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.722em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1009.66em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1307"><span class="mn" id="MathJax-Span-1308" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1309" style="font-family: MathJax_Main; padding-left: 0.296em;">≤</span><span class="mi" id="MathJax-Span-1310" style="font-family: MathJax_Math-italic; padding-left: 0.296em;">t</span><span class="mi" id="MathJax-Span-1311" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1312" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-1313" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1314" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1315" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-1316" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1317" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1318" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1319" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1320" style="font-family: MathJax_Main; padding-left: 0.296em;">≤</span><span class="mi" id="MathJax-Span-1321" style="font-family: MathJax_Math-italic; padding-left: 0.296em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1322" style="font-family: MathJax_Main; padding-left: 0.237em;">−</span><span class="mn" id="MathJax-Span-1323" style="font-family: MathJax_Main; padding-left: 0.237em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         0 
        
       
         ≤ 
        
       
         t 
        
       
         a 
        
       
         r 
        
       
         g 
        
       
         e 
        
       
         t 
        
       
         s 
        
       
         [ 
        
       
         i 
        
       
         ] 
        
       
         ≤ 
        
       
         C 
        
       
         − 
        
       
         1 
        
      </span></span><script type="math/tex" id="MathJax-Element-68">0 \leq targets[i] \leq C-1</script></p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输出 - 如果 reduce=True, 输出标量值. 如果 reduce=False, 输出与输入target一致, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1324" style="width: 1.994em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1001.52em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1325"><span class="mo" id="MathJax-Span-1326" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1327" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1328" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         ( 
        
       
         N 
        
       
         ) 
        
      </span></span><script type="math/tex" id="MathJax-Element-69">(N)</script></p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输入 - input x, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1329" style="width: 10.834em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.844em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1008.73em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1330"><span class="mo" id="MathJax-Span-1331" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1332" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1333" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1334" style="font-family: MathJax_Math-italic; padding-left: 0.179em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1335" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1336" style="padding-left: 0.179em;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.53em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-1337" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.53em;"><span class="mn" id="MathJax-Span-1338" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1339" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1340" style="padding-left: 0.179em;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.53em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-1341" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.53em;"><span class="mn" id="MathJax-Span-1342" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1343" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1344" style="font-family: MathJax_Main; padding-left: 0.179em;">.</span><span class="mo" id="MathJax-Span-1345" style="font-family: MathJax_Main; padding-left: 0.179em;">.</span><span class="mo" id="MathJax-Span-1346" style="font-family: MathJax_Main; padding-left: 0.179em;">.</span><span class="mo" id="MathJax-Span-1347" style="font-family: MathJax_Main; padding-left: 0.179em;">,</span><span class="msubsup" id="MathJax-Span-1348" style="padding-left: 0.179em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.53em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-1349" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.53em;"><span class="mi" id="MathJax-Span-1350" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1351" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         ( 
        
       
         N 
        
       
         , 
        
       
         C 
        
       
         , 
        
        
        
          d 
         
        
          1 
         
        
       
         , 
        
        
        
          d 
         
        
          2 
         
        
       
         , 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         , 
        
        
        
          d 
         
        
          K 
         
        
       
         ) 
        
      </span></span><script type="math/tex" id="MathJax-Element-70">(N, C, d_1, d_2, ..., d_K)</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1352" style="width: 3.399em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.755em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.291em, 1002.7em, 2.462em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1353"><span class="mi" id="MathJax-Span-1354" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1355" style="font-family: MathJax_Main; padding-left: 0.296em;">≥</span><span class="mn" id="MathJax-Span-1356" style="font-family: MathJax_Main; padding-left: 0.296em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         K 
        
       
         ≥ 
        
       
         2 
        
      </span></span><script type="math/tex" id="MathJax-Element-71">K \geq 2</script> 适用于 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1357" style="width: 1.115em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.291em, 1000.88em, 2.345em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1358"><span class="mi" id="MathJax-Span-1359" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         K 
        
      </span></span><script type="math/tex" id="MathJax-Element-72">K</script>-dim 场景</p>
  
  <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输入 - target y, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" style="position: relative;" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mo stretchy="false"&gt;(&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy="false"&gt;)&lt;/mo&gt;&lt;/math&gt;' role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1360" style="width: 9.371em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.673em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1007.56em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1361"><span class="mo" id="MathJax-Span-1362" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1363" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1364" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1365" style="padding-left: 0.179em;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.53em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-1366" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.53em;"><span class="mn" id="MathJax-Span-1367" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1368" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1369" style="padding-left: 0.179em;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.53em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-1370" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.53em;"><span class="mn" id="MathJax-Span-1371" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1372" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1373" style="font-family: MathJax_Main; padding-left: 0.179em;">.</span><span class="mo" id="MathJax-Span-1374" style="font-family: MathJax_Main; padding-left: 0.179em;">.</span><span class="mo" id="MathJax-Span-1375" style="font-family: MathJax_Main; padding-left: 0.179em;">.</span><span class="mo" id="MathJax-Span-1376" style="font-family: MathJax_Main; padding-left: 0.179em;">,</span><span class="msubsup" id="MathJax-Span-1377" style="padding-left: 0.179em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.53em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-1378" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.53em;"><span class="mi" id="MathJax-Span-1379" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1380" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>N</mi><mo>,</mo><msub><mi>d</mi><mn>1</mn></msub><mo>,</mo><msub><mi>d</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>d</mi><mi>K</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-73">(N, d_1, d_2, ..., d_K)</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1381" style="width: 3.399em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.755em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.291em, 1002.7em, 2.462em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1382"><span class="mi" id="MathJax-Span-1383" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1384" style="font-family: MathJax_Main; padding-left: 0.296em;">≥</span><span class="mn" id="MathJax-Span-1385" style="font-family: MathJax_Main; padding-left: 0.296em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         K 
        
       
         ≥ 
        
       
         2 
        
      </span></span><script type="math/tex" id="MathJax-Element-74">K \geq 2</script> 适用于 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1386" style="width: 1.115em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.291em, 1000.88em, 2.345em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1387"><span class="mi" id="MathJax-Span-1388" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         K 
        
      </span></span><script type="math/tex" id="MathJax-Element-75">K</script>-dim 场景</p>
  
  <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输出 - 如果 reduce=True, 输出标量值. 如果 reduce=False, 输出与输入target一致, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" style="position: relative;" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mo stretchy="false"&gt;(&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy="false"&gt;)&lt;/mo&gt;&lt;/math&gt;' role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1389" style="width: 9.371em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.673em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1007.56em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1390"><span class="mo" id="MathJax-Span-1391" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1392" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1393" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1394" style="padding-left: 0.179em;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.53em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-1395" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.53em;"><span class="mn" id="MathJax-Span-1396" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1397" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1398" style="padding-left: 0.179em;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.53em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-1399" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.53em;"><span class="mn" id="MathJax-Span-1400" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1401" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1402" style="font-family: MathJax_Main; padding-left: 0.179em;">.</span><span class="mo" id="MathJax-Span-1403" style="font-family: MathJax_Main; padding-left: 0.179em;">.</span><span class="mo" id="MathJax-Span-1404" style="font-family: MathJax_Main; padding-left: 0.179em;">.</span><span class="mo" id="MathJax-Span-1405" style="font-family: MathJax_Main; padding-left: 0.179em;">,</span><span class="msubsup" id="MathJax-Span-1406" style="padding-left: 0.179em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.53em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-1407" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.53em;"><span class="mi" id="MathJax-Span-1408" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1409" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>N</mi><mo>,</mo><msub><mi>d</mi><mn>1</mn></msub><mo>,</mo><msub><mi>d</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>d</mi><mi>K</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-76">(N, d_1, d_2, ..., d_K)</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1410" style="width: 3.399em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.755em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.291em, 1002.7em, 2.462em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1411"><span class="mi" id="MathJax-Span-1412" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1413" style="font-family: MathJax_Main; padding-left: 0.296em;">≥</span><span class="mn" id="MathJax-Span-1414" style="font-family: MathJax_Main; padding-left: 0.296em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         K 
        
       
         ≥ 
        
       
         2 
        
      </span></span><script type="math/tex" id="MathJax-Element-77">K \geq 2</script> 适用于 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1415" style="width: 1.115em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.291em, 1000.88em, 2.345em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1416"><span class="mi" id="MathJax-Span-1417" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         K 
        
      </span></span><script type="math/tex" id="MathJax-Element-78">K</script>-dim 场景</p>
</blockquote></li>
<li><p>例示:</p>

<pre class="prettyprint eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);"><code class="language-python hljs ">
<span class="hljs-comment"># 1D</span>

<span class="hljs-keyword">import</span> torch 
<span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn

loss = nn.CrossEntropyLoss()

<span class="hljs-comment"># input, NxC=2x3</span>

input = torch.randn(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, requires_grad=<span class="hljs-keyword">True</span>)

<span class="hljs-comment"># target, N</span>

target = torch.empty(<span class="hljs-number">2</span>, dtype=torch.long).random_(<span class="hljs-number">3</span>)
output = loss(input, target)
output.backward()</code></pre>

<p>​</p></li>
</ul>



<h2 id="2-kldivloss">2. KLDivLoss</h2>



<pre class="prettyprint eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);"><code class="language-python hljs "><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">torch</span>.<span class="hljs-title">nn</span>.<span class="hljs-title">KLDivLoss</span><span class="hljs-params">(size_average=True, reduce=True)</span></span></code></pre>

<ul>
<li><p>作用:</p>

<p>相对熵, 也叫 KL 散度,  <a href="https://en.wikipedia.org/wiki/Kullback-Leibler_divergence">Kullback-Leibler divergence</a> Loss.</p>

<p>KL 散度用于估计连续分布的距离.</p>

<p>当对连续输出分布进行直接回归时, KL 散度比较有用.</p>

<p>输入 input 应该是在进行了一次 forward 来计算每个类别class 的 log-probabilities 概率.</p>

<p>输入 input 不一定是 2D Tensor, 因为其计算是逐元素进行的.</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style="position: relative;" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mo&gt;&amp;#x2113;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy="false"&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy="false"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence="false" stretchy="false"&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo fence="false" stretchy="false"&gt;}&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;' role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1418" style="width: 13.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.171em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1011.17em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1419"><span class="texatom" id="MathJax-Span-1420"><span class="mrow" id="MathJax-Span-1421"><span class="mo" id="MathJax-Span-1422" style="font-family: MathJax_Main;">ℓ</span></span></span><span class="mo" id="MathJax-Span-1423" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1424" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1425" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1426" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1427" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1428" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1429" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">L</span><span class="mo" id="MathJax-Span-1430" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-1431" style="font-family: MathJax_Main; padding-left: 0.259em;">{</span><span class="msubsup" id="MathJax-Span-1432"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.26em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1433" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mn" id="MathJax-Span-1434" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1435" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1436" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-1437" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-1438" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-1439" style="font-family: MathJax_Main; padding-left: 0.156em;">,</span><span class="msubsup" id="MathJax-Span-1440" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.26em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1441" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mi" id="MathJax-Span-1442" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1443"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.41em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1444" style="font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-1445" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>ℓ</mo></mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>L</mi><mo>=</mo><mo fence="false" stretchy="false">{</mo><msub><mi>l</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>l</mi><mi>N</mi></msub><msup><mo fence="false" stretchy="false">}</mo><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-79">ℓ(x, y) = L = \{l_1, ..., l_N\}^T</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1446" style="width: 11.632em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.531em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1009.43em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1447"><span class="msubsup" id="MathJax-Span-1448"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.26em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1449" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mi" id="MathJax-Span-1450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1451" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="msubsup" id="MathJax-Span-1452" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1453" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1454" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1455" style="font-family: MathJax_Main; padding-left: 0.207em;">⊙</span><span class="mo" id="MathJax-Span-1456" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-1457" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1458" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1459" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1460"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1461" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1462" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1463" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="msubsup" id="MathJax-Span-1464" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1465" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1466" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1467" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
        
        
          l 
         
        
          n 
         
        
       
         = 
        
        
        
          y 
         
        
          n 
         
        
       
         ⊙ 
        
       
         ( 
        
       
         l 
        
       
         o 
        
       
         g 
        
        
        
          y 
         
        
          n 
         
        
       
         − 
        
        
        
          x 
         
        
          n 
         
        
       
         ) 
        
      </span></span><script type="math/tex" id="MathJax-Element-80">l_n = y_n \odot (logy_n - x_n)</script> </p> 
   <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1468" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.92em, 2.308em, -999.997em); top: -2.149em; left: 0em;"><span class="mrow" id="MathJax-Span-1469"><span class="mi" id="MathJax-Span-1470" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.154em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         N 
        
      </span></span><script type="math/tex" id="MathJax-Element-81">N</script> - batchsize.</p>

<p>如果 <code class="eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);">reduce=True</code>, </p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" style="position: relative;" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mo&gt;&amp;#x2113;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy="false"&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy="false"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy="false"&gt;(&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy="false"&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi mathvariant="normal"&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;' role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1471" style="width: 22.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.496em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1018.45em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1472"><span class="texatom" id="MathJax-Span-1473"><span class="mrow" id="MathJax-Span-1474"><span class="mo" id="MathJax-Span-1475" style="font-family: MathJax_Main;">ℓ</span></span></span><span class="mo" id="MathJax-Span-1476" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1477" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1478" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1479" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1480" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1481" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1482" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">m</span><span class="mi" id="MathJax-Span-1483" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1484" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1485" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1486" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1487" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-1488" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1489" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1490" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">i</span><span class="mi" id="MathJax-Span-1491" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mtext" id="MathJax-Span-1492" style="font-family: MathJax_Main;"> </span><span class="mi" id="MathJax-Span-1493" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1494" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1495" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1496" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1497" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-1498" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1499" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-1500" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1501" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-1502" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1503" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1504" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-1505" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1506" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mi" id="MathJax-Span-1507" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-1508" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-1509" style="font-family: MathJax_Math-italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>ℓ</mo></mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo>,</mo><mi>i</mi><mi>f</mi><mtext> </mtext><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi mathvariant="normal">_</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo>=</mo><mi>T</mi><mi>r</mi><mi>u</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">ℓ(x,y) = mean(L), if \ size\_average =True</script> </p> 
   <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1510" style="width: 22.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.291em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1018.24em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1511"><span class="texatom" id="MathJax-Span-1512"><span class="mrow" id="MathJax-Span-1513"><span class="mo" id="MathJax-Span-1514" style="font-family: MathJax_Main;">ℓ</span></span></span><span class="mo" id="MathJax-Span-1515" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1516" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1517" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1518" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1519" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1520" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1521" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">s</span><span class="mi" id="MathJax-Span-1522" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-1523" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1524" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1525" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-1526" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1527" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1528" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">i</span><span class="mi" id="MathJax-Span-1529" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mtext" id="MathJax-Span-1530" style="font-family: MathJax_Main;"> </span><span class="mi" id="MathJax-Span-1531" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1532" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1533" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1534" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1535" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-1536" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1537" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-1538" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1539" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-1540" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1541" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1542" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-1543" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1544" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mi" id="MathJax-Span-1545" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1546" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1547" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1548" style="font-family: MathJax_Math-italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
        
        
          ℓ 
         
        
       
         ( 
        
       
         x 
        
       
         , 
        
       
         y 
        
       
         ) 
        
       
         = 
        
       
         s 
        
       
         u 
        
       
         m 
        
       
         ( 
        
       
         L 
        
       
         ) 
        
       
         , 
        
       
         i 
        
       
         f 
        
       
           
        
       
         s 
        
       
         i 
        
       
         z 
        
       
         e 
        
       
         _ 
        
       
         a 
        
       
         v 
        
       
         e 
        
       
         r 
        
       
         a 
        
       
         g 
        
       
         e 
        
       
         = 
        
       
         F 
        
       
         a 
        
       
         l 
        
       
         s 
        
       
         e 
        
      </span></span><script type="math/tex" id="MathJax-Element-83">ℓ(x,y) = sum(L), if \ size\_average = False</script></p> 
  </li><li><p>参数:</p> 
  <blockquote class="eye-protector-processed" style="transition: background-color 0.3s ease; border-left-color: rgba(0, 0, 0, 0.35); background-color: rgb(193, 230, 198);"> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>size_average</strong>(bool, optional) – 默认为 True. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ size_average=True, 则 losses 在 minibatch 求平均average. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ size_average=False, 则losses 在 minibatch 求相加和sum. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ 当 reduce=False 时,忽略该参数.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>reduce</strong>(bool, optional) - 默认为 True.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ reduce=True, 则 losses 在 minibatch 求平均或相加和.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ reduce=False, 则 losses 返回每个 input/target 元素, 并忽略 size_average. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输入 - input x, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1549" style="width: 3.165em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.579em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1002.58em, 2.638em, -999.997em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1550"><span class="mo" id="MathJax-Span-1551" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1552" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1553" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1554" style="font-family: MathJax_Main; padding-left: 0.179em;">∗</span><span class="mo" id="MathJax-Span-1555" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1556"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 82%; font-style: normal; font-weight: normal;'>​</span></span></span><span style="display: inline-block; width: 0px; height: 2.228em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         ( 
        
       
         N 
        
       
         , 
        
       
         ∗ 
        
       
         ) 
        
       
         ​ 
        
      </span></span><script type="math/tex" id="MathJax-Element-84">(N, *)​</script></p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输入 - target y, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1557" style="width: 3.165em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.579em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1002.58em, 2.638em, -999.997em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1558"><span class="mo" id="MathJax-Span-1559" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1560" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1561" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1562" style="font-family: MathJax_Main; padding-left: 0.179em;">∗</span><span class="mo" id="MathJax-Span-1563" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1564"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 82%; font-style: normal; font-weight: normal;'>​</span></span></span><span style="display: inline-block; width: 0px; height: 2.228em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         ( 
        
       
         N 
        
       
         , 
        
       
         ∗ 
        
       
         ) 
        
       
         ​ 
        
      </span></span><script type="math/tex" id="MathJax-Element-85">(N, *)​</script></p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输出 - 如果 reduce=True, 输出标量值. 如果 reduce=False, 输出与输入一致, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1565" style="width: 3.165em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.579em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1002.46em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1566"><span class="mo" id="MathJax-Span-1567" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1568" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1569" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1570" style="font-family: MathJax_Main; padding-left: 0.179em;">∗</span><span class="mo" id="MathJax-Span-1571" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         ( 
        
       
         N 
        
       
         , 
        
       
         ∗ 
        
       
         ) 
        
      </span></span><script type="math/tex" id="MathJax-Element-86">(N, *)</script></p> 
  </blockquote></li></ul> 
<h3 id="3-bceloss">3. BCELoss</h3> 
<pre class="prettyprint eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);"><code class="language-python hljs "><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">torch</span>.<span class="hljs-title">nn</span>.<span class="hljs-title">BCELoss</span><span class="hljs-params">(weight=None, size_average=True, reduce=True)</span></span></code></pre> 
<ul><li><p>作用:</p> <p>计算 target 和 output 间的二值交叉熵(Binary Cross Entropy)</p> <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1572" style="width: 13.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.171em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1011.17em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1573"><span class="texatom" id="MathJax-Span-1574"><span class="mrow" id="MathJax-Span-1575"><span class="mo" id="MathJax-Span-1576" style="font-family: MathJax_Main;">ℓ</span></span></span><span class="mo" id="MathJax-Span-1577" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1578" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1579" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1580" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1581" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1582" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1583" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">L</span><span class="mo" id="MathJax-Span-1584" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-1585" style="font-family: MathJax_Main; padding-left: 0.259em;">{<!-- --></span><span class="msubsup" id="MathJax-Span-1586"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.26em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1587" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mn" id="MathJax-Span-1588" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1589" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1590" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-1591" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-1592" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-1593" style="font-family: MathJax_Main; padding-left: 0.156em;">,</span><span class="msubsup" id="MathJax-Span-1594" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.26em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1595" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mi" id="MathJax-Span-1596" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1597"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.41em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1598" style="font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-1599" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
       
       
         ℓ 
        
       
      
        ( 
       
      
        x 
       
      
        , 
       
      
        y 
       
      
        ) 
       
      
        = 
       
      
        L 
       
      
        = 
       
      
        { 
       
       
       
         l 
        
       
         1 
        
       
      
        , 
       
      
        . 
       
      
        . 
       
      
        . 
       
      
        , 
       
       
       
         l 
        
       
         N 
        
       
       
       
         } 
        
       
         T 
        
       
     </span></span><script type="math/tex" id="MathJax-Element-87">ℓ(x,y) = L = \{l_1, ..., l_N\}^T</script></p> <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1600" style="width: 22.902em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.753em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1018.65em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1601"><span class="msubsup" id="MathJax-Span-1602"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.26em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1603" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mi" id="MathJax-Span-1604" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1605" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-1606" style="font-family: MathJax_Main; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-1607"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1608" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-1609" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1610" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-1611"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1612" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1613" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1614" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-1615" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">l</span><span class="mi" id="MathJax-Span-1616" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1617" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1618"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1619" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1620" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1621" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-1622" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mn" id="MathJax-Span-1623" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1624" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="msubsup" id="MathJax-Span-1625" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1626" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1627" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1628" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1629" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-1630" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">l</span><span class="mi" id="MathJax-Span-1631" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1632" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1633" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1634" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1635" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="msubsup" id="MathJax-Span-1636" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1637" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1638" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1639" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1640" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
       
       
         l 
        
       
         n 
        
       
      
        = 
       
      
        − 
       
       
       
         w 
        
       
         n 
        
       
      
        [ 
       
       
       
         y 
        
       
         n 
        
       
      
        ⋅ 
       
      
        l 
       
      
        o 
       
      
        g 
       
       
       
         x 
        
       
         n 
        
       
      
        + 
       
      
        ( 
       
      
        1 
       
      
        − 
       
       
       
         y 
        
       
         n 
        
       
      
        ) 
       
      
        ⋅ 
       
      
        l 
       
      
        o 
       
      
        g 
       
      
        ( 
       
      
        1 
       
      
        − 
       
       
       
         x 
        
       
         n 
        
       
      
        ) 
       
      
        ] 
       
     </span></span><script type="math/tex" id="MathJax-Element-88">l_n = -w_n [y_n \cdot logx_n + (1 - y_n) \cdot log(1 - x_n)]</script></p> <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1641" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.92em, 2.308em, -999.997em); top: -2.149em; left: 0em;"><span class="mrow" id="MathJax-Span-1642"><span class="mi" id="MathJax-Span-1643" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.154em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        N 
       
     </span></span><script type="math/tex" id="MathJax-Element-89">N</script> - batchsize</p>

<p>如果 <code class="eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);">reduce=True</code>, </p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" style="position: relative;" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mo&gt;&amp;#x2113;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy="false"&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy="false"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy="false"&gt;(&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy="false"&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi mathvariant="normal"&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;' role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1644" style="width: 22.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.496em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1018.45em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1645"><span class="texatom" id="MathJax-Span-1646"><span class="mrow" id="MathJax-Span-1647"><span class="mo" id="MathJax-Span-1648" style="font-family: MathJax_Main;">ℓ</span></span></span><span class="mo" id="MathJax-Span-1649" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1650" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1651" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1652" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1653" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1654" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1655" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">m</span><span class="mi" id="MathJax-Span-1656" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1657" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1658" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1659" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1660" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-1661" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1662" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1663" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">i</span><span class="mi" id="MathJax-Span-1664" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mtext" id="MathJax-Span-1665" style="font-family: MathJax_Main;"> </span><span class="mi" id="MathJax-Span-1666" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1667" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1668" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1669" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1670" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-1671" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1672" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-1673" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1674" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-1675" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1676" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1677" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-1678" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1679" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mi" id="MathJax-Span-1680" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-1681" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-1682" style="font-family: MathJax_Math-italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>ℓ</mo></mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo>,</mo><mi>i</mi><mi>f</mi><mtext> </mtext><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi mathvariant="normal">_</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo>=</mo><mi>T</mi><mi>r</mi><mi>u</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-90">ℓ(x,y) = mean(L), if \ size\_average =True</script> </p> <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1683" style="width: 22.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.291em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1018.24em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1684"><span class="texatom" id="MathJax-Span-1685"><span class="mrow" id="MathJax-Span-1686"><span class="mo" id="MathJax-Span-1687" style="font-family: MathJax_Main;">ℓ</span></span></span><span class="mo" id="MathJax-Span-1688" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1689" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1690" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1691" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1692" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1693" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1694" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">s</span><span class="mi" id="MathJax-Span-1695" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-1696" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1697" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1698" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-1699" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1700" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1701" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">i</span><span class="mi" id="MathJax-Span-1702" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mtext" id="MathJax-Span-1703" style="font-family: MathJax_Main;"> </span><span class="mi" id="MathJax-Span-1704" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1705" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1706" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1707" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1708" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-1709" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1710" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-1711" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1712" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-1713" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1714" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1715" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-1716" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1717" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mi" id="MathJax-Span-1718" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1719" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1720" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1721" style="font-family: MathJax_Math-italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
       
       
         ℓ 
        
       
      
        ( 
       
      
        x 
       
      
        , 
       
      
        y 
       
      
        ) 
       
      
        = 
       
      
        s 
       
      
        u 
       
      
        m 
       
      
        ( 
       
      
        L 
       
      
        ) 
       
      
        , 
       
      
        i 
       
      
        f 
       
      
          
       
      
        s 
       
      
        i 
       
      
        z 
       
      
        e 
       
      
        _ 
       
      
        a 
       
      
        v 
       
      
        e 
       
      
        r 
       
      
        a 
       
      
        g 
       
      
        e 
       
      
        = 
       
      
        F 
       
      
        a 
       
      
        l 
       
      
        s 
       
      
        e 
       
     </span></span><script type="math/tex" id="MathJax-Element-91">ℓ(x,y) = sum(L), if \ size\_average = False</script></p> <p>用于计算重构误差,如 auto-encoder 中. </p> <p>targets y 的值是 0 和 1 之间的数值.</p></li><li><p>参数:</p> 
  <blockquote class="eye-protector-processed" style="transition: background-color 0.3s ease; border-left-color: rgba(0, 0, 0, 0.35); background-color: rgb(193, 230, 198);"> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>weight</strong>(Tensor, optional) - 每个batch 元素 的权重. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>size_average</strong>(bool, optional) – 默认为 True. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ size_average=True, 则 losses 在 minibatch 结合 <strong>weight</strong> 求平均average. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ size_average=False, 则losses 在 minibatch 求相加和sum. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ 当 reduce=False 时,忽略该参数.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>reduce</strong>(bool, optional) - 默认为 True.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ reduce=True, 则 losses 在 minibatch 求平均或相加和.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ reduce=False, 则 losses 返回 per input/target 元素值, 并忽略 size_average. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输入 - input x, (N, *)</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输入 - target y, (N, *)​</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输出 - 如果 reduce=True, 输出标量值. 如果 reduce=False, 输出与输入一致, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1722" style="width: 3.165em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.579em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1002.46em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1723"><span class="mo" id="MathJax-Span-1724" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1725" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1726" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1727" style="font-family: MathJax_Main; padding-left: 0.179em;">∗</span><span class="mo" id="MathJax-Span-1728" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         ( 
        
       
         N 
        
       
         , 
        
       
         ∗ 
        
       
         ) 
        
      </span></span><script type="math/tex" id="MathJax-Element-92">(N, *)</script></p> 
  </blockquote></li><li><p>例示:</p> <pre class="prettyprint eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);"><code class="language-python hljs "><span class="hljs-keyword">import</span> torch 
<span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn

sig = nn.Sigmoid()
loss = nn.BCELoss()
input = torch.randn(<span class="hljs-number">3</span>, requires_grad=<span class="hljs-keyword">True</span>)
target = torch.empty(<span class="hljs-number">3</span>).random_(<span class="hljs-number">2</span>)
output = loss(sig(input), target)
output.backward()</code></pre> <p>​</p></li></ul> 
<h3 id="4-bcewithlogitsloss">4. BCEWithLogitsLoss</h3> 
<pre class="prettyprint eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);"><code class="language-python hljs "><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">torch</span>.<span class="hljs-title">nn</span>.<span class="hljs-title">BCEWithLogitsLoss</span><span class="hljs-params">(weight=None, size_average=True, reduce=True)</span></span></code></pre> 
<ul><li><p>作用:</p> <p>该 loss 层包括了 <strong>Sigmoid</strong> 层和 <strong>BCELoss</strong> 层. 单类别任务.</p> <p>数值计算稳定性更好( log-sum-exp trick), 相比与 Sigmoid + BCELoss. </p> <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1729" style="width: 13.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.171em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1011.17em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1730"><span class="texatom" id="MathJax-Span-1731"><span class="mrow" id="MathJax-Span-1732"><span class="mo" id="MathJax-Span-1733" style="font-family: MathJax_Main;">ℓ</span></span></span><span class="mo" id="MathJax-Span-1734" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1735" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1736" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1737" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1738" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1739" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1740" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">L</span><span class="mo" id="MathJax-Span-1741" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-1742" style="font-family: MathJax_Main; padding-left: 0.259em;">{<!-- --></span><span class="msubsup" id="MathJax-Span-1743"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.26em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1744" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mn" id="MathJax-Span-1745" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1746" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1747" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-1748" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-1749" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-1750" style="font-family: MathJax_Main; padding-left: 0.156em;">,</span><span class="msubsup" id="MathJax-Span-1751" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.26em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1752" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mi" id="MathJax-Span-1753" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1754"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.41em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1755" style="font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-1756" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
       
       
         ℓ 
        
       
      
        ( 
       
      
        x 
       
      
        , 
       
      
        y 
       
      
        ) 
       
      
        = 
       
      
        L 
       
      
        = 
       
      
        { 
       
       
       
         l 
        
       
         1 
        
       
      
        , 
       
      
        . 
       
      
        . 
       
      
        . 
       
      
        , 
       
       
       
         l 
        
       
         N 
        
       
       
       
         } 
        
       
         T 
        
       
     </span></span><script type="math/tex" id="MathJax-Element-93">ℓ(x,y) = L = \{l_1, ..., l_N\}^T</script></p> <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1757" style="width: 25.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.263em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1021.16em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1758"><span class="msubsup" id="MathJax-Span-1759"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.26em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1760" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mi" id="MathJax-Span-1761" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1762" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-1763" style="font-family: MathJax_Main; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-1764"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1765" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-1766" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1767" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-1768"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.23em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1769" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.361em;"><span class="mi" id="MathJax-Span-1770" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1771" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-1772" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">l</span><span class="mi" id="MathJax-Span-1773" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1774" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1775" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1776" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1777"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1778" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1779" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1780" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1781" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-1782" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mn" id="MathJax-Span-1783" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1784" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="msubsup" id="MathJax-Span-1785" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.23em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1786" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.361em;"><span class="mi" id="MathJax-Span-1787" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1788" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1789" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-1790" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">l</span><span class="mi" id="MathJax-Span-1791" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1792" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1793" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1794" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1795" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-1796" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1797" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1798"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1799" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1800" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1801" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1802" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1803" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
       
       
         l 
        
       
         n 
        
       
      
        = 
       
      
        − 
       
       
       
         w 
        
       
         n 
        
       
      
        [ 
       
       
       
         t 
        
       
         n 
        
       
      
        ⋅ 
       
      
        l 
       
      
        o 
       
      
        g 
       
      
        σ 
       
      
        ( 
       
       
       
         x 
        
       
         n 
        
       
      
        ) 
       
      
        + 
       
      
        ( 
       
      
        1 
       
      
        − 
       
       
       
         t 
        
       
         n 
        
       
      
        ) 
       
      
        ⋅ 
       
      
        l 
       
      
        o 
       
      
        g 
       
      
        ( 
       
      
        1 
       
      
        − 
       
      
        σ 
       
      
        ( 
       
       
       
         x 
        
       
         n 
        
       
      
        ) 
       
      
        ) 
       
      
        ] 
       
     </span></span><script type="math/tex" id="MathJax-Element-94">l_n = -w_n  [t_n \cdot log \sigma(x_n) + (1 - t_n) \cdot log(1 - \sigma(x_n))]</script></p> <p>如果 <code class="eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);">reduce=True</code>, </p> <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1804" style="width: 22.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.496em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1018.45em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1805"><span class="texatom" id="MathJax-Span-1806"><span class="mrow" id="MathJax-Span-1807"><span class="mo" id="MathJax-Span-1808" style="font-family: MathJax_Main;">ℓ</span></span></span><span class="mo" id="MathJax-Span-1809" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1810" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1811" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1812" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1813" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1814" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1815" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">m</span><span class="mi" id="MathJax-Span-1816" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1817" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1818" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1819" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1820" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-1821" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1822" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1823" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">i</span><span class="mi" id="MathJax-Span-1824" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mtext" id="MathJax-Span-1825" style="font-family: MathJax_Main;"> </span><span class="mi" id="MathJax-Span-1826" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1827" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1828" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1829" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1830" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-1831" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1832" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-1833" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1834" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-1835" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1836" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1837" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-1838" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1839" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mi" id="MathJax-Span-1840" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-1841" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-1842" style="font-family: MathJax_Math-italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
       
       
         ℓ 
        
       
      
        ( 
       
      
        x 
       
      
        , 
       
      
        y 
       
      
        ) 
       
      
        = 
       
      
        m 
       
      
        e 
       
      
        a 
       
      
        n 
       
      
        ( 
       
      
        L 
       
      
        ) 
       
      
        , 
       
      
        i 
       
      
        f 
       
      
          
       
      
        s 
       
      
        i 
       
      
        z 
       
      
        e 
       
      
        _ 
       
      
        a 
       
      
        v 
       
      
        e 
       
      
        r 
       
      
        a 
       
      
        g 
       
      
        e 
       
      
        = 
       
      
        T 
       
      
        r 
       
      
        u 
       
      
        e 
       
     </span></span><script type="math/tex" id="MathJax-Element-95">ℓ(x,y) = mean(L), if \ size\_average =True</script> </p> <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1843" style="width: 22.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.291em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1018.24em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1844"><span class="texatom" id="MathJax-Span-1845"><span class="mrow" id="MathJax-Span-1846"><span class="mo" id="MathJax-Span-1847" style="font-family: MathJax_Main;">ℓ</span></span></span><span class="mo" id="MathJax-Span-1848" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1849" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1850" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1851" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1852" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1853" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1854" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">s</span><span class="mi" id="MathJax-Span-1855" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-1856" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1857" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1858" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-1859" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1860" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1861" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">i</span><span class="mi" id="MathJax-Span-1862" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mtext" id="MathJax-Span-1863" style="font-family: MathJax_Main;"> </span><span class="mi" id="MathJax-Span-1864" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1865" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1866" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1867" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1868" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-1869" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1870" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-1871" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1872" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-1873" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1874" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1875" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-1876" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-1877" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mi" id="MathJax-Span-1878" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1879" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1880" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-1881" style="font-family: MathJax_Math-italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
       
       
         ℓ 
        
       
      
        ( 
       
      
        x 
       
      
        , 
       
      
        y 
       
      
        ) 
       
      
        = 
       
      
        s 
       
      
        u 
       
      
        m 
       
      
        ( 
       
      
        L 
       
      
        ) 
       
      
        , 
       
      
        i 
       
      
        f 
       
      
          
       
      
        s 
       
      
        i 
       
      
        z 
       
      
        e 
       
      
        _ 
       
      
        a 
       
      
        v 
       
      
        e 
       
      
        r 
       
      
        a 
       
      
        g 
       
      
        e 
       
      
        = 
       
      
        F 
       
      
        a 
       
      
        l 
       
      
        s 
       
      
        e 
       
     </span></span><script type="math/tex" id="MathJax-Element-96">ℓ(x,y) = sum(L), if \ size\_average = False</script></p> <p>用于计算重构误差,如 auto-encoder 中. </p> <p>targets <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1882" style="width: 1.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.18em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1883"><span class="mi" id="MathJax-Span-1884" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1885" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1886" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1887" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        t 
       
      
        [ 
       
      
        i 
       
      
        ] 
       
     </span></span><script type="math/tex" id="MathJax-Element-97">t[i]</script> 的值是 0 和 1 之间的数值.</p></li><li><p>参数:</p> 
  <blockquote class="eye-protector-processed" style="transition: background-color 0.3s ease; border-left-color: rgba(0, 0, 0, 0.35); background-color: rgb(193, 230, 198);"> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>weight</strong>(Tensor, optional) - 每个batch 元素 的权重. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>size_average</strong>(bool, optional) – 默认为 True. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ size_average=True, 则 losses 在 minibatch 结合 <strong>weight</strong> 求平均average. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ size_average=False, 则losses 在 minibatch 求相加和sum. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ 当 reduce=False 时,忽略该参数.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>reduce</strong>(bool, optional) - 默认为 True.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ reduce=True, 则 losses 在 minibatch 求平均或相加和.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ reduce=False, 则 losses 返回 per input/target 元素值, 并忽略 size_average.</p> 
  </blockquote> <p>​</p></li></ul> 
<h3 id="5-multilabelsoftmarginloss">5. MultiLabelSoftMarginLoss</h3> 
<pre class="prettyprint eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);"><code class="language-python hljs "><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">torch</span>.<span class="hljs-title">nn</span>.<span class="hljs-title">MultiLabelSoftMarginLoss</span><span class="hljs-params">(weight=None, size_average=True, reduce=True)</span></span></code></pre> 
<ul><li><p>作用:</p> <p>基于 max-entropy 计算输入 input x 和 target x 间的 multi-label one-versus-all loss.</p> <p>对于 minibatch 内的每个样本,</p> <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-830" style="width: 34.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 28.537em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.925em, 1028.43em, 2.974em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-831"><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-833" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-834" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-835" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-836" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-837" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-838" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-839" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-840" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-841" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-842" style="font-family: MathJax_Main; padding-left: 0.259em;">−</span><span class="munderover" id="MathJax-Span-843" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.03em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-844" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.686em; left: 1.078em;"><span class="mi" id="MathJax-Span-845" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-846" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-847" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-848" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-849" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-850" style="font-family: MathJax_Main; padding-left: 0.207em;">∗</span><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">l</span><span class="mi" id="MathJax-Span-852" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-853" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-854" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-855"><span style="display: inline-block; position: relative; width: 4.255em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.384em, 1000.31em, 4.152em, -999.997em); top: -4.403em; left: 50%; margin-left: -0.151em;"><span class="mn" id="MathJax-Span-856" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1004.05em, 4.306em, -999.997em); top: -3.532em; left: 50%; margin-left: -2.047em;"><span class="mrow" id="MathJax-Span-857"><span class="mn" id="MathJax-Span-858" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-859" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-860" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-861" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-862" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-863" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-864" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-865" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-866" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-867" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-868" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-869" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1004.25em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.255em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-870" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-871" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mn" id="MathJax-Span-872" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-873" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-874" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-875" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-876" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-877" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-878" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-879" style="font-family: MathJax_Main; padding-left: 0.207em;">∗</span><span class="mi" id="MathJax-Span-880" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">l</span><span class="mi" id="MathJax-Span-881" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-882" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-883" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-884"><span style="display: inline-block; position: relative; width: 4.255em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.332em, 1003.18em, 4.306em, -999.997em); top: -4.557em; left: 50%; margin-left: -1.637em;"><span class="mrow" id="MathJax-Span-885"><span class="mi" id="MathJax-Span-886" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-887" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-888" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-889" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-890" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-891" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-892" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-893" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-894" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-895" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1004.05em, 4.306em, -999.997em); top: -3.532em; left: 50%; margin-left: -2.047em;"><span class="mrow" id="MathJax-Span-896"><span class="mn" id="MathJax-Span-897" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-898" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-899" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-900" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-901" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-902" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-903" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-904" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-905" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-906" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-907" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-908" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1004.25em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.255em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-909" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.253em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        l 
       
      
        o 
       
      
        s 
       
      
        s 
       
      
        ( 
       
      
        x 
       
      
        , 
       
      
        y 
       
      
        ) 
       
      
        = 
       
      
        − 
       
       
       
         ∑ 
        
       
         i 
        
       
      
        y 
       
      
        [ 
       
      
        i 
       
      
        ] 
       
      
        ∗ 
       
      
        l 
       
      
        o 
       
      
        g 
       
      
        ( 
       
       
       
         1 
        
        
        
          1 
         
        
          + 
         
        
          e 
         
        
          x 
         
        
          p 
         
        
          ( 
         
        
          − 
         
        
          x 
         
        
          [ 
         
        
          i 
         
        
          ] 
         
        
          ) 
         
        
       
      
        + 
       
      
        ( 
       
      
        1 
       
      
        − 
       
      
        y 
       
      
        [ 
       
      
        i 
       
      
        ] 
       
      
        ) 
       
      
        ∗ 
       
      
        l 
       
      
        o 
       
      
        g 
       
      
        ( 
       
       
        
        
          e 
         
        
          x 
         
        
          p 
         
        
          ( 
         
        
          − 
         
        
          x 
         
        
          [ 
         
        
          i 
         
        
          ] 
         
        
          ) 
         
        
        
        
          1 
         
        
          + 
         
        
          e 
         
        
          x 
         
        
          p 
         
        
          ( 
         
        
          − 
         
        
          x 
         
        
          [ 
         
        
          i 
         
        
          ] 
         
        
          ) 
         
        
       
      
        ) 
       
     </span></span><script type="math/tex" id="MathJax-Element-44">loss(x, y) = -\sum_i y[i] * log(\frac{1}{1 + exp(-x[i])} + (1 - y[i]) * log(\frac{exp(-x[i])}{1 + exp(-x[i])})</script></p> <p>其中, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-910" style="width: 10.146em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.302em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1008.2em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-911"><span class="mi" id="MathJax-Span-912" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-913" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-914" style="font-family: MathJax_Main; padding-left: 0.259em;">[</span><span class="mn" id="MathJax-Span-915" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-916" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-917" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">n</span><span class="mi" id="MathJax-Span-918" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-919" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-920" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-921" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-922" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-923" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-924" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-925" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-926" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-927" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        i 
       
      
        = 
       
      
        [ 
       
      
        0 
       
      
        , 
       
      
        n 
       
      
        E 
       
      
        l 
       
      
        e 
       
      
        m 
       
      
        e 
       
      
        n 
       
      
        t 
       
      
        ( 
       
      
        ) 
       
      
        ] 
       
     </span></span><script type="math/tex" id="MathJax-Element-45">i = [0, nElement()]</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-928" style="width: 6.099em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.972em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1004.92em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-929"><span class="mi" id="MathJax-Span-930" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-931" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-932" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-933" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-934" style="font-family: MathJax_Main; padding-left: 0.259em;">∈</span><span class="mo" id="MathJax-Span-935" style="font-family: MathJax_Main; padding-left: 0.259em;">{<!-- --></span><span class="mn" id="MathJax-Span-936" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-937" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-938" style="font-family: MathJax_Main; padding-left: 0.156em;">1</span><span class="mo" id="MathJax-Span-939" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        y 
       
      
        [ 
       
      
        i 
       
      
        ] 
       
      
        ∈ 
       
      
        { 
       
      
        0 
       
      
        , 
       
      
        1 
       
      
        } 
       
     </span></span><script type="math/tex" id="MathJax-Element-46">y[i] \in \{0, 1\}</script></p></li><li><p>参数:</p> 
  <blockquote class="eye-protector-processed" style="transition: background-color 0.3s ease; border-left-color: rgba(0, 0, 0, 0.35); background-color: rgb(193, 230, 198);"> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>weight</strong>(Tensor, optional) - 每个类别class 的权重. 默认为值为 1 的 Tensor.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>size_average</strong>(bool, optional) – 默认为 True. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ size_average=True, 则 losses 在 minibatch 结合 <strong>weight</strong> 求平均average. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ size_average=False, 则losses 在 minibatch 求相加和sum. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ 当 reduce=False 时,忽略该参数.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>reduce</strong>(bool, optional) - 默认为 True.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ reduce=True, 则 losses 在 minibatch 求平均或相加和.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ reduce=False, 则 losses 返回 per batch 元素值, 并忽略 size_average. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​输入 - input x, (N, C), C = num_classes 类别总数. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输入 - target y, (N)</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输出 - 如果 reduce=True, 输出标量值. 如果 reduce=False, 输出与输入target一致, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-940" style="width: 1.994em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1001.52em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-941"><span class="mo" id="MathJax-Span-942" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-943" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-944" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         ( 
        
       
         N 
        
       
         ) 
        
      </span></span><script type="math/tex" id="MathJax-Element-47">(N)</script></p> 
  </blockquote></li></ul> 
<h3 id="6-multilabelmarginloss">6. MultiLabelMarginLoss</h3> 
<pre class="prettyprint eye-protector-processed" style="transition: background-color 0.3s ease; background-color: rgb(193, 230, 198);"><code class="language-python hljs "><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">torch</span>.<span class="hljs-title">nn</span>.<span class="hljs-title">MultiLabelMarginLoss</span><span class="hljs-params">(size_average=True, reduce=True)</span></span></code></pre> 
<ul><li><p>作用:</p> <p>计算 input x 和output y 间的 multi-class multi-classifitcation hinge loss.</p> <p>input x - 2D minibatch Tensor</p> <p>output y - target 类别class 索引的 2D Tensor.</p> <p>对于 minibatch 内的每个样本,</p> <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-945" style="width: 18.138em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.859em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.925em, 1014.86em, 2.974em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-946"><span class="mi" id="MathJax-Span-947" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-948" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-949" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-950" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-951" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-952" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-953" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-954" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-955" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-956" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-957" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.847em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.03em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-958" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.686em; left: 1.078em;"><span class="texatom" id="MathJax-Span-959"><span class="mrow" id="MathJax-Span-960"><span class="mi" id="MathJax-Span-961" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-962" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-963" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-964" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 7.482em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.332em, 1007.33em, 4.306em, -999.997em); top: -4.557em; left: 50%; margin-left: -3.686em;"><span class="mrow" id="MathJax-Span-965"><span class="mi" id="MathJax-Span-966" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-967" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-968" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-969" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-970" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-971" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-972" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-973" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mo" id="MathJax-Span-974" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-975" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-976" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-977" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-978" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-979" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-980" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-981" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-982" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-983" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-984" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-985" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-986" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-987" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-988" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1002.67em, 4.306em, -999.997em); top: -3.532em; left: 50%; margin-left: -1.381em;"><span class="mrow" id="MathJax-Span-989"><span class="mi" id="MathJax-Span-990" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-991" style="font-size: 70.7%; font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-992" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-993" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-994" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-995" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-996" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-997" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-998" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1007.48em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.482em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.253em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        l 
       
      
        o 
       
      
        s 
       
      
        s 
       
      
        ( 
       
      
        x 
       
      
        , 
       
      
        y 
       
      
        ) 
       
      
        = 
       
       
       
         ∑ 
        
        
        
          i 
         
        
          , 
         
        
          j 
         
        
       
       
        
        
          m 
         
        
          a 
         
        
          x 
         
        
          ( 
         
        
          0 
         
        
          , 
         
        
          1 
         
        
          − 
         
        
          ( 
         
        
          x 
         
        
          [ 
         
        
          y 
         
        
          [ 
         
        
          j 
         
        
          ] 
         
        
          ] 
         
        
          − 
         
        
          x 
         
        
          [ 
         
        
          i 
         
        
          ] 
         
        
          ) 
         
        
          ) 
         
        
        
        
          x 
         
        
          . 
         
        
          s 
         
        
          i 
         
        
          z 
         
        
          e 
         
        
          ( 
         
        
          0 
         
        
          ) 
         
        
       
     </span></span><script type="math/tex" id="MathJax-Element-48">loss(x, y) = \sum_{i,j} \frac{max(0, 1 - (x[y[j]] - x[i]))}{x.size(0)}</script></p> <p>其中, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-999" style="width: 17.728em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.501em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1014.4em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1000"><span class="mi" id="MathJax-Span-1001" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1002" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-1003" style="font-family: MathJax_Main; padding-left: 0.259em;">[</span><span class="mn" id="MathJax-Span-1004" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1005" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1006" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">x</span><span class="mo" id="MathJax-Span-1007" style="font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-1008" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">s</span><span class="mi" id="MathJax-Span-1009" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1010" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1011" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-1012" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1013" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1014" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1015" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1016" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1017" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">j</span><span class="mo" id="MathJax-Span-1018" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-1019" style="font-family: MathJax_Main; padding-left: 0.259em;">[</span><span class="mn" id="MathJax-Span-1020" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1021" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1022" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1023" style="font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-1024" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">s</span><span class="mi" id="MathJax-Span-1025" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1026" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1027" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-1028" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1029" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1030" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1031" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        i 
       
      
        = 
       
      
        [ 
       
      
        0 
       
      
        , 
       
      
        x 
       
      
        . 
       
      
        s 
       
      
        i 
       
      
        z 
       
      
        e 
       
      
        ( 
       
      
        0 
       
      
        ) 
       
      
        ] 
       
      
        , 
       
      
        j 
       
      
        = 
       
      
        [ 
       
      
        0 
       
      
        , 
       
      
        y 
       
      
        . 
       
      
        s 
       
      
        i 
       
      
        z 
       
      
        e 
       
      
        ( 
       
      
        0 
       
      
        ) 
       
      
        ] 
       
     </span></span><script type="math/tex" id="MathJax-Element-49">i = [0, x.size(0)], j = [0, y.size(0)]</script>, 对于所有的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1032" style="width: 0.412em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.31em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.26em, 2.308em, -999.997em); top: -2.149em; left: 0em;"><span class="mrow" id="MathJax-Span-1033"><span class="mi" id="MathJax-Span-1034" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.154em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        i 
       
     </span></span><script type="math/tex" id="MathJax-Element-50">i</script> 和 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;' role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1035" style="width: 0.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.412em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.41em, 2.513em, -999.997em); top: -2.149em; left: 0em;"><span class="mrow" id="MathJax-Span-1036"><span class="mi" id="MathJax-Span-1037" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.154em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">j</script> 有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1038" style="width: 3.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.23em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.18em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1039"><span class="mi" id="MathJax-Span-1040" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1041" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1042" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1043" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1044" style="font-family: MathJax_Main; padding-left: 0.259em;">≥</span><span class="mn" id="MathJax-Span-1045" style="font-family: MathJax_Main; padding-left: 0.259em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        y 
       
      
        [ 
       
      
        j 
       
      
        ] 
       
      
        ≥ 
       
      
        0 
       
     </span></span><script type="math/tex" id="MathJax-Element-52">y[j] \geq 0</script> 和 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;"> 
     
     <span class="math" id="MathJax-Span-1046" style="width: 3.794em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.076em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.97em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1047"><span class="mi" id="MathJax-Span-1048" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1049" style="font-family: MathJax_Main; padding-left: 0.259em;">≠</span><span class="mi" id="MathJax-Span-1050" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1051" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1052" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1053" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
    <span class="MJX_Assistive_MathML"> 
      
      
        i 
       
      
        ≠ 
       
      
        y 
       
      
        [ 
       
      
        j 
       
      
        ] 
       
     </span></span><script type="math/tex" id="MathJax-Element-53">i \neq y[j]</script>.</p> <p>​ <br> 该loss 只考虑从正面开始的非负 targets 的连续块.(The criterion only considers a contiguous block of non-negative targets that starts at the front.)</p></li><li><p>参数:</p> 
  <blockquote class="eye-protector-processed" style="transition: background-color 0.3s ease; border-left-color: rgba(0, 0, 0, 0.35); background-color: rgb(193, 230, 198);"> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>size_average</strong>(bool, optional) – 默认为 True. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ size_average=True, 则 losses 在 minibatch 结合 <strong>weight</strong> 求平均average. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ size_average=False, 则losses 在 minibatch 求相加和sum. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ 当 reduce=False 时,忽略该参数.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);"><strong>reduce</strong>(bool, optional) - 默认为 True.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ reduce=True, 则 losses 在 minibatch 求平均或相加和.</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​ reduce=False, 则 losses 返回 per batch 元素值, 并忽略 size_average. </p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​输入 - input x, (C) 或 (N, C), C = num_classes 类别总数, N 为 batchsize</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">​输入 - target y, C 或 (N, C)</p> 
   <p class="eye-protector-processed" style="border-color: rgba(0, 0, 0, 0.35); color: rgb(0, 0, 0);">输出 - 如果 reduce=True, 输出标量值. 如果 reduce=False, 输出, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="position: relative;"> 
      
      <span class="math" id="MathJax-Span-1054" style="width: 1.994em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1001.52em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-1055"><span class="mo" id="MathJax-Span-1056" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1057" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-1058" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span> 
     <span class="MJX_Assistive_MathML"> 
       
       
         ( 
        
       
         N 
        
       
         ) 
        
      </span></span><script type="math/tex" id="MathJax-Element-54">(N)</script></p> 
  </blockquote> <p>​</p></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/56d16251a4d3968af0a520a2d2106e5c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于深度学习的大规模多标签文本分类任务总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d45e74aaf953897fdb5c7621754a2943/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">BSTR与string相互转化</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>