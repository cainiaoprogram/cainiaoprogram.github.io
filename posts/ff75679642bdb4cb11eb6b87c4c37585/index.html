<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#上位机与欧姆龙PLC的通信10----开发专用的通讯工具软件(WPF版) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#上位机与欧姆龙PLC的通信10----开发专用的通讯工具软件(WPF版)" />
<meta property="og:description" content="1、介绍 上节开发了一个winform版的通讯测试工具，这节再搞个wpf版的，wpf是什么？请自行百度，也可以看前面的博客，WPF真入门教程，wpf的界面效果是比winform漂亮，因为wpf使用了web项目中的css样式来美化界面，在这个例子中用到wpf的控件，资源样式，命令绑定等，采用的是mvvm的渲染模式，界面如图：
前面的winform界面：
2、开工干 2.1 创建wpf项目 2.2 创建目录及PLC模型类对象 2.3 创建自定义的消息弹窗 MsgBoxWindow.xaml代码
&lt;Window x:Class=&#34;OmronFinsWPFApp.MsgBoxWindow&#34; xmlns=&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34; xmlns:x=&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34; xmlns:d=&#34;http://schemas.microsoft.com/expression/blend/2008&#34; xmlns:mc=&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34; xmlns:local=&#34;clr-namespace:OmronFinsWPFApp&#34; mc:Ignorable=&#34;d&#34; Title=&#34;消息框&#34; Height=&#34;200&#34; Width=&#34;420&#34; WindowStartupLocation=&#34;CenterScreen&#34; BorderThickness=&#34;1,0,1,1&#34; ResizeMode=&#34;NoResize&#34; WindowStyle=&#34;None&#34; AllowsTransparency=&#34;True&#34; Background=&#34;Transparent&#34;&gt; &lt;Window.Resources&gt; &lt;Style TargetType=&#34;Button&#34; x:Key=&#34;msgbtnStyle&#34;&gt; &lt;Setter Property=&#34;Width&#34; Value=&#34;60&#34;/&gt; &lt;Setter Property=&#34;Height&#34; Value=&#34;25&#34;/&gt; &lt;Setter Property=&#34;Margin&#34; Value=&#34;10,0,15,0&#34;/&gt; &lt;/Style&gt; &lt;/Window.Resources&gt; &lt;Grid Background=&#34;Transparent&#34; MouseLeftButtonDown=&#34;Grid_MouseLeftButtonDown&#34; &gt; &lt;Border BorderBrush=&#34;#FFA9AEB1&#34; BorderThickness=&#34;2&#34; CornerRadius=&#34;10&#34; Margin=&#34;5&#34;&gt; &lt;Border.Effect&gt; &lt;DropShadowEffect BlurRadius=&#34;10&#34; Color=&#34;#FFB8BBC8&#34; Direction=&#34;300&#34; ShadowDepth=&#34;2&#34;/&gt; &lt;/Border.Effect&gt; &lt;Border.Background&gt; &lt;LinearGradientBrush EndPoint=&#34;0.5,1&#34; StartPoint=&#34;0.5,0&#34;&gt; &lt;GradientStop Color=&#34;#FFFBFBFB&#34; Offset=&#34;0.16&#34;/&gt; &lt;GradientStop Color=&#34;#FFB4D8E2&#34; Offset=&#34;0.986&#34;/&gt; &lt;/LinearGradientBrush&gt; &lt;/Border." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ff75679642bdb4cb11eb6b87c4c37585/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T16:05:45+08:00" />
<meta property="article:modified_time" content="2024-01-05T16:05:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#上位机与欧姆龙PLC的通信10----开发专用的通讯工具软件(WPF版)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>1、介绍</h2> 
<p>上节开发了一个winform版的通讯测试工具，这节再搞个wpf版的，wpf是什么？请自行百度，也可以看前面的博客，<a class="link-info" href="http://t.csdnimg.cn/u7hzE" rel="nofollow" title="WPF真入门教程">WPF真入门教程</a>，wpf的界面效果是比winform漂亮，因为wpf使用了web项目中的css样式来美化界面，在这个例子中用到wpf的控件，资源样式，命令绑定等，采用的是mvvm的渲染模式，界面如图：</p> 
<p><img alt="" height="490" src="https://images2.imgbox.com/d0/7b/gFqulFso_o.png" width="979"></p> 
<p>前面的winform界面：</p> 
<h2><img alt="" height="572" src="https://images2.imgbox.com/8f/d4/ZIwYdhQ4_o.png" width="912"> 2、开工干</h2> 
<h3>2.1 创建wpf项目</h3> 
<p><img alt="" height="709" src="https://images2.imgbox.com/70/87/eYPxwCMg_o.png" width="1042"><img alt="" height="675" src="https://images2.imgbox.com/9a/39/IGxZqylu_o.png" width="1013"><img alt="" height="672" src="https://images2.imgbox.com/48/8c/6lfYMxRk_o.png" width="1018"></p> 
<h3>2.2 创建目录及PLC模型类对象</h3> 
<h3> <img alt="" height="916" src="https://images2.imgbox.com/aa/05/LX0hL8MY_o.png" width="1200">2.3 创建自定义的消息弹窗</h3> 
<p><img alt="" height="945" src="https://images2.imgbox.com/73/c5/2JpTgAdM_o.png" width="1200"></p> 
<p>MsgBoxWindow.xaml代码</p> 
<pre><code class="language-cs">&lt;Window x:Class="OmronFinsWPFApp.MsgBoxWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:OmronFinsWPFApp"
        mc:Ignorable="d"
                Title="消息框" Height="200" Width="420" WindowStartupLocation="CenterScreen" BorderThickness="1,0,1,1" ResizeMode="NoResize" WindowStyle="None" AllowsTransparency="True" Background="Transparent"&gt;
    &lt;Window.Resources&gt;
        &lt;Style TargetType="Button" x:Key="msgbtnStyle"&gt;
            &lt;Setter Property="Width" Value="60"/&gt;
            &lt;Setter Property="Height" Value="25"/&gt;
            &lt;Setter Property="Margin" Value="10,0,15,0"/&gt;
        &lt;/Style&gt;
    &lt;/Window.Resources&gt;
    &lt;Grid Background="Transparent" MouseLeftButtonDown="Grid_MouseLeftButtonDown" &gt;
        &lt;Border BorderBrush="#FFA9AEB1"  BorderThickness="2" CornerRadius="10" Margin="5"&gt;
            &lt;Border.Effect&gt;
                &lt;DropShadowEffect BlurRadius="10" Color="#FFB8BBC8" Direction="300" ShadowDepth="2"/&gt;
            &lt;/Border.Effect&gt;
            &lt;Border.Background&gt;
                &lt;LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0"&gt;
                    &lt;GradientStop Color="#FFFBFBFB" Offset="0.16"/&gt;
                    &lt;GradientStop Color="#FFB4D8E2" Offset="0.986"/&gt;
                &lt;/LinearGradientBrush&gt;
            &lt;/Border.Background&gt;
            &lt;Grid x:Name="grid" Margin="5"&gt;
                &lt;Grid.RowDefinitions&gt;
                    &lt;RowDefinition Height="30"/&gt;
                    &lt;RowDefinition/&gt;
                    &lt;RowDefinition Height="50" /&gt;
                &lt;/Grid.RowDefinitions&gt;
                &lt;Grid Grid.Row="0" Background="Transparent"&gt;
                    &lt;Border  Background="Transparent"  &gt;
                        &lt;Grid&gt;
                            &lt;TextBlock Text="{Binding MessageTitle}" HorizontalAlignment="Left"  Height="25" Width="200" VerticalAlignment="Center" Margin="5,0" /&gt;
                            &lt;Image Source="imgs/errbtn.jpg" HorizontalAlignment="Right" Margin="0,3,3,2"  MouseLeftButtonDown="Image_MouseLeftButtonDown"/&gt;
                        &lt;/Grid&gt;
                    &lt;/Border&gt;
                &lt;/Grid&gt;
                &lt;!--显示图片和文本--&gt;
                &lt;StackPanel Grid.Row="1" VerticalAlignment="Center" Orientation="Horizontal"&gt;
                    &lt;Image Source="{Binding ImagePath}" Width="30" Height="30" Margin="40,20,20,20"/&gt;
                    &lt;TextBlock VerticalAlignment="Center" HorizontalAlignment="Left" TextWrapping="WrapWithOverflow" Width="280" TextAlignment="Left"
                       Text="{Binding MessageBoxText}" FontSize="12"/&gt;
                &lt;/StackPanel&gt;
                &lt;!--Button Margin(坐上右下)--&gt;
                &lt;StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right"&gt;
                    &lt;Button Content="确 定" Style="{StaticResource msgbtnStyle}" x:Name="OkButton"   IsDefault="True"
                    Visibility="{Binding OkButtonVisibility,Mode=OneWay}" Click="OkButton_Click"/&gt;
                    &lt;Button Content="是" Style="{StaticResource msgbtnStyle}"  x:Name="YesButton"  
                    Visibility="{Binding YesButtonVisibility,Mode=OneWay}" Click="YesButton_Click"/&gt;
                    &lt;Button Content="否" Style="{StaticResource msgbtnStyle}"  x:Name="NoButton" 
                    Visibility="{Binding NoButtonVisibility,Mode=OneWay}" Click="NoButton_Click"/&gt;
                    &lt;Button Content="取消" Style="{StaticResource msgbtnStyle}"  x:Name="CancelButton" 
                    Visibility="{Binding CancelButtonVisibility}" Click="CancelButton_Click"/&gt;
                &lt;/StackPanel&gt;
            &lt;/Grid&gt;
        &lt;/Border&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;
</code></pre> 
<p> MsgBoxWindow.xaml.cs代码（这是页面MsgBoxWindow.xaml的后台逻辑代码）</p> 
<pre><code class="language-cs">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;

namespace OmronFinsWPFApp
{
    /// &lt;summary&gt;
    /// MsgBoxWindow.xaml 的交互逻辑
    /// &lt;/summary&gt;
    public partial class MsgBoxWindow : Window
    {
        public MsgBoxWindow()
        {
            InitializeComponent();
            this.DataContext = this;
            //所有按钮不显示（）
            OkButtonVisibility = Visibility.Collapsed;
            CancelButtonVisibility = Visibility.Collapsed;
            YesButtonVisibility = Visibility.Collapsed;
            NoButtonVisibility = Visibility.Collapsed;
            Result = CustomMessageBoxResult.None;
        }

        /// &lt;summary&gt;
        /// 显示按钮类型
        /// &lt;/summary&gt;
        public enum CustomMessageBoxButton
        {
            OK = 1,
            OKCancel = 2,
            YesNo = 3,
            YesNoCancel = 4
        }

        /// &lt;summary&gt;
        /// 消息框返回值
        /// &lt;/summary&gt;
        public enum CustomMessageBoxResult
        {
            None = 0,//用户直接关闭消息框
            OK = 1,//用户点击了确定按钮
            Cancel = 2,//用户点击了取消按钮
            Yes = 3,//用户点击了是按钮
            No = 4//用户点击了否按钮
        }

        /// &lt;summary&gt;
        /// 图标类型
        /// &lt;/summary&gt;
        public enum CustomMessageBoxIcon
        {
            None = 0,
            Error = 1,
            Question = 2,
            Infomation = 3
        }

        #region 页面属性定义
        /// &lt;summary&gt;
        /// 消息文本
        /// &lt;/summary&gt;
        public string MessageBoxText { get; set; }
        /// &lt;summary&gt;
        /// 消息框标题
        /// &lt;/summary&gt;
        public string MessageTitle { get; set; }
        /// &lt;summary&gt;
        /// 图标路径
        /// &lt;/summary&gt;
        public string ImagePath { get; set; }
        /// &lt;summary&gt;
        /// 显示确定
        /// &lt;/summary&gt;
        public Visibility OkButtonVisibility { get; set; }
        /// &lt;summary&gt;
        /// 显示取消
        /// &lt;/summary&gt;
        public Visibility CancelButtonVisibility { get; set; }
        /// &lt;summary&gt;
        /// 显示是
        /// &lt;/summary&gt;
        public Visibility YesButtonVisibility { get; set; }
        /// &lt;summary&gt;
        /// 显示否
        /// &lt;/summary&gt;
        public Visibility NoButtonVisibility { get; set; }
        /// &lt;summary&gt;
        /// 消息框返回值
        /// &lt;/summary&gt;
        public CustomMessageBoxResult Result { get; set; }
        #endregion

        private void CancelButton_Click(object sender, RoutedEventArgs e)
        {
            Result = CustomMessageBoxResult.Cancel;
            this.Close();
        }

        private void NoButton_Click(object sender, RoutedEventArgs e)
        {
            Result = CustomMessageBoxResult.No;
            this.Close();
        }

        private void YesButton_Click(object sender, RoutedEventArgs e)
        {
            Result = CustomMessageBoxResult.Yes;
            this.Close();
        }

        private void OkButton_Click(object sender, RoutedEventArgs e)
        {
            Result = CustomMessageBoxResult.OK;
            this.Close();
        }

        private void Image_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
        {
            this.Close();
        }

        /// &lt;summary&gt;
        /// 消息框拖动
        /// &lt;/summary&gt;
        /// &lt;param name="sender"&gt;&lt;/param&gt;
        /// &lt;param name="e"&gt;&lt;/param&gt;
        private void Grid_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
        {
            this.DragMove();
        }
        /// &lt;summary&gt;
        /// 显示消息框
        /// &lt;/summary&gt;
        /// &lt;param name="msgText"&gt;&lt;/param&gt;
        /// &lt;param name="title"&gt;&lt;/param&gt;
        /// &lt;param name="msgBtn"&gt;&lt;/param&gt;
        /// &lt;param name="msgIcon"&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static CustomMessageBoxResult Show(string msgText, string title, CustomMessageBoxButton msgBtn, CustomMessageBoxIcon msgIcon)
        {
            MsgBoxWindow msg = new MsgBoxWindow();
            msg.Topmost = true;
            msg.MessageBoxText = msgText;
            msg.MessageTitle = title;
            //消息框按钮显示
            switch (msgBtn)
            {
                case CustomMessageBoxButton.OK:
                    msg.OkButtonVisibility = Visibility.Visible;
                    break;
                case CustomMessageBoxButton.OKCancel:
                    msg.OkButtonVisibility = Visibility.Visible;
                    msg.CancelButtonVisibility = Visibility.Visible;
                    break;
                case CustomMessageBoxButton.YesNo:
                    msg.YesButtonVisibility = Visibility.Visible;
                    msg.NoButtonVisibility = Visibility.Visible;
                    break;
                case CustomMessageBoxButton.YesNoCancel:
                    msg.YesButtonVisibility = Visibility.Visible;
                    msg.NoButtonVisibility = Visibility.Visible;
                    msg.CancelButtonVisibility = Visibility.Visible;
                    break;
                default:
                    msg.OkButtonVisibility = Visibility.Visible;
                    break;
            }
            switch (msgIcon)
            {
                case CustomMessageBoxIcon.Infomation:
                    msg.ImagePath = @"imgs/success.jpg";
                    break;
                case CustomMessageBoxIcon.Error:
                    msg.ImagePath = @"imgs/error.jpg";
                    break;
                case CustomMessageBoxIcon.Question:
                    msg.ImagePath = @"imgs/question.jpg";
                    break;
            }
            msg.ShowDialog();
            return msg.Result;
        } 
    }
}
</code></pre> 
<h3>2.4 添加之前的通讯库dll文件，并引用到项目中</h3> 
<p><img alt="" height="846" src="https://images2.imgbox.com/de/93/ef88gRbj_o.png" width="1200"></p> 
<h3>2.5 添加目录及命令类RelayCommand</h3> 
<p><img alt="" height="898" src="https://images2.imgbox.com/cc/ec/Uoa05Pq9_o.png" width="1200"></p> 
<pre><code class="language-cs">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Input;

namespace OmronFinsWPFApp.Common
{
    /// &lt;summary&gt;
    /// 命令实现类
    /// &lt;/summary&gt;
    public class RelayCommand : ICommand
    {
        public event EventHandler CanExecuteChanged;
        /// &lt;summary&gt;
        /// 要执行的操作
        /// &lt;/summary&gt;
        private Action&lt;object&gt; executeActions;
        /// &lt;summary&gt;
        /// 是否可以执行的委托
        /// &lt;/summary&gt;
        private Func&lt;object, bool&gt; canExecuteFunc;
        /// &lt;summary&gt;
        /// 构造函数 无参构造
        /// &lt;/summary&gt;
        public RelayCommand() { }
        /// &lt;summary&gt;
        /// 通过执行的委托构造
        /// &lt;/summary&gt;
        /// &lt;param name="execute"&gt;&lt;/param&gt;
        public RelayCommand(Action&lt;object&gt; execute) : this(execute, null)
        {

        }
        /// &lt;summary&gt;
        /// 通过执行的操作与是否可执行的委托
        /// &lt;/summary&gt;
        /// &lt;param name="execute"&gt;要执行的操作&lt;/param&gt;
        /// &lt;param name="canExecute"&gt;是否可以被执行&lt;/param&gt;
        public RelayCommand(Action&lt;object&gt; execute, Func&lt;object, bool&gt; canExecute)
        {
            this.executeActions = execute;
            this.canExecuteFunc = canExecute;
        }

        /// &lt;summary&gt;
        /// 命令是否可以执行
        /// &lt;/summary&gt;
        /// &lt;param name="parameter"&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool CanExecute(object parameter)
        {
            if (canExecuteFunc != null)
                return this.canExecuteFunc(parameter);
            else
                return true;
        }

        /// &lt;summary&gt;
        /// 要执行的操作
        /// &lt;/summary&gt;
        /// &lt;param name="parameter"&gt;&lt;/param&gt;
        public void Execute(object parameter)
        {
            if (executeActions == null)
                return;
            this.executeActions(parameter);
        }

        /// &lt;summary&gt;
        /// 执行CanExecuteChanged事件
        /// &lt;/summary&gt;
        public void OnCanExecuteChanged()
        {
            this.CanExecuteChanged?.Invoke(this, new EventArgs());
        }
    }
}
</code></pre> 
<h3>2.6 添加视图模型类对象</h3> 
<p><img alt="" height="908" src="https://images2.imgbox.com/c0/d9/qEE9OP6f_o.png" width="1200"></p> 
<pre><code class="language-cs">using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Runtime.CompilerServices;
using System.Text;
using System.Threading.Tasks;
using static OmronFinsWPFApp.MsgBoxWindow;

namespace OmronFinsWPFApp.ViewModel
{
    /// &lt;summary&gt;
    /// 视图模型基类
    /// &lt;/summary&gt;
    public class ViewModelBase : INotifyPropertyChanged
    {
        /// &lt;summary&gt;
        /// 属性值发生更改时触发
        /// &lt;/summary&gt;
        public event PropertyChangedEventHandler PropertyChanged;



        /// &lt;summary&gt;
        /// 执行更改
        /// C#5.0中的新特性CallerMemberName
        /// &lt;/summary&gt;
        /// &lt;param name="propertyName"&gt;&lt;/param&gt;
        protected void OnPropertyChanged([CallerMemberName] string propertyName = "")
        {
            if (PropertyChanged != null)
            {
                PropertyChanged.Invoke(this, new PropertyChangedEventArgs(propertyName));
            }
        }


        /// &lt;summary&gt;
        /// 成功消息提示
        /// &lt;/summary&gt;
        /// &lt;param name="message"&gt;&lt;/param&gt;
        /// &lt;param name="title"&gt;&lt;/param&gt;
        /// &lt;param name="buttons"&gt;&lt;/param&gt;
        public void ShowMessage(string message, string title = "提示", CustomMessageBoxButton buttons = CustomMessageBoxButton.OK)
        {
            Show(message, title, buttons, CustomMessageBoxIcon.Infomation);
        }

        /// &lt;summary&gt;
        /// 错误消息框
        /// &lt;/summary&gt;
        /// &lt;param name="message"&gt;&lt;/param&gt;
        /// &lt;param name="title"&gt;&lt;/param&gt;
        /// &lt;param name="buttons"&gt;&lt;/param&gt;
        public void ShowError(string message, string title = "错误", CustomMessageBoxButton buttons = CustomMessageBoxButton.OK)
        {
            Show(message, title, buttons, CustomMessageBoxIcon.Error);
        }

        /// &lt;summary&gt;
        /// 询问消息框
        /// &lt;/summary&gt;
        /// &lt;param name="message"&gt;&lt;/param&gt;
        /// &lt;param name="title"&gt;&lt;/param&gt;
        /// &lt;param name="buttons"&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public CustomMessageBoxResult ShowQuestion(string message, string title = "询问", CustomMessageBoxButton buttons = CustomMessageBoxButton.OKCancel)
        {
            return Show(message, title, buttons, CustomMessageBoxIcon.Question);
        }



    }
}
</code></pre> 
<p><img alt="" height="877" src="https://images2.imgbox.com/74/28/0F7FmWk8_o.png" width="1200"></p> 
<p> </p> 
<pre><code class="language-cs">using Omron.Communimcation.Fins.Omron;
using OmronFinsWPFApp.Common;
using OmronFinsWPFApp.Model;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Input;

namespace OmronFinsWPFApp.ViewModel
{
    /// &lt;summary&gt;
    /// 视图模型
    /// &lt;/summary&gt;
    public class MainViewModel : ViewModelBase
    {
        /// &lt;summary&gt;
        /// finstcp对象
        /// &lt;/summary&gt;
        FinsTcp finsTcp; 
        

        PLCMemoryModel readPLCModel = SetInitModel();
        /// &lt;summary&gt;
        /// 读取PLC
        /// &lt;/summary&gt;
        public PLCMemoryModel ReadPLCModel
        {
            get { return readPLCModel; }
            set
            {
                readPLCModel = ReadPLCModel;
                OnPropertyChanged();//属性通知
            }
        }

        PLCMemoryModel writePLCModel = SetInitModel();
        /// &lt;summary&gt;
        /// 写入PLC
        /// &lt;/summary&gt;
        public PLCMemoryModel WritePLCModel
        {
            get { return writePLCModel; }
            set
            {
                writePLCModel = WritePLCModel;
                OnPropertyChanged();
            }
        }
        /// &lt;summary&gt;
        /// 初始化页面参数
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private static PLCMemoryModel SetInitModel()
        {
            PLCMemoryModel model = new PLCMemoryModel();
            model.Area = "DM";
            model.DataType = "ushort";
            model.Address = "";
            model.Count = "1";
            return model;
        }

        private string hostName = "192.168.1.4";
        /// &lt;summary&gt;
        /// PLC地址
        /// &lt;/summary&gt;
        public string HostName
        {
            get
            {
                return hostName;
            }
            set
            {
                hostName = value;
            }
        }

        private string hostPort = "7788";
        /// &lt;summary&gt;
        /// PLC端口
        /// &lt;/summary&gt;
        public string HostPort
        {
            get { return hostPort; }
            set
            {
                hostPort = value;
            }
        }


        /// &lt;summary&gt;
        /// 存储区下拉框数据源
        /// &lt;/summary&gt;
        public List&lt;string&gt; CboCustTypes
        {
            get
            {
                return new List&lt;string&gt;() { "DM", "H", "W", "CIO" };
            }
        }

        /// &lt;summary&gt;
        /// 数据类型
        /// &lt;/summary&gt;
        public List&lt;string&gt; CboCustDatas
        {
            get
            {
                return new List&lt;string&gt;() { "ushort", "short", "float", "bool" };
            }
        } 

        private string readWords = "";
        /// &lt;summary&gt;
        /// 读数结果
        /// &lt;/summary&gt;
        public string ReadWords
        {
            get { return readWords; }
            set
            {
                readWords = value;
                OnPropertyChanged();
            }
        }
        private string writeWords = "";
        /// &lt;summary&gt;
        /// 写入数据
        /// &lt;/summary&gt;
        public string WriteWords
        {
            get { return writeWords; }
            set
            {
                writeWords = value;
                OnPropertyChanged();
            }
        }

        private string connectWords = "当前未连接";
        /// &lt;summary&gt;
        /// 连接状态
        /// &lt;/summary&gt;
        public string ConnectWords
        {
            get { return connectWords; }
            set
            {
                connectWords = value;
                OnPropertyChanged();
            }
        }
         

        /// &lt;/summary&gt;
        /// &lt;summary&gt;
        /// 登录按钮的命令处理
        /// &lt;/summary&gt;
        public ICommand LoginCommand
        {
            get
            {
                return new RelayCommand(o =&gt;
                {

                    var name = HostName;
                    var port = HostPort;
                    finsTcp = new FinsTcp(name, Convert.ToInt32(port), 10, 04);// 创建连接 
                    var result = finsTcp.Connect();// 开始连接PLC
                    if (!result.IsSuccessed)
                    {
                        ShowError(result.Message, "错误");
                        return;
                    }
                    ShowMessage("PLC连接成功", "提示");
                    ConnectWords = "PLC连接成功";
                });
            }
        }

        /// &lt;/summary&gt;
        /// &lt;summary&gt;
        /// 读取按钮的命令处理
        /// &lt;/summary&gt;
        public ICommand ReadCommand
        {
            get
            {
                return new RelayCommand(o =&gt;
                {
                    var d = ReadPLCModel; 
                    //内存地址
                    string plcAddr = ReadPLCModel.Area + ReadPLCModel.Address;
                    //读取数量
                    ushort readCount = ushort.Parse(ReadPLCModel.Count);
                    //数据类型
                    string dataType = ReadPLCModel.DataType;
                    switch (dataType)
                    {
                        case "ushort":
                            var datas = finsTcp.Read&lt;ushort&gt;(plcAddr, readCount);
                            if (!datas.IsSuccessed)
                            {
                                ShowMessage(datas.Message, "提示");
                                return;
                            }
                            ReadWords = string.Join(",", datas.Datas);
                            break;
                        case "short":
                            var datas2 = finsTcp.Read&lt;short&gt;(plcAddr, readCount);
                            if (!datas2.IsSuccessed)
                            {
                                ShowMessage(datas2.Message, "提示");
                                return;
                            }
                            ReadWords = string.Join(",", datas2.Datas);
                            break;
                        case "float":
                            var datas3 = finsTcp.Read&lt;float&gt;(plcAddr, readCount);
                            if (!datas3.IsSuccessed)
                            {
                                ShowMessage(datas3.Message, "提示");
                                return;
                            }
                            ReadWords = string.Join(",", datas3.Datas);
                            break;
                        case "bool":
                            var datas4 = finsTcp.Read&lt;bool&gt;(plcAddr, readCount);
                            if (!datas4.IsSuccessed)
                            {
                                ShowMessage(datas4.Message, "提示");
                                return;
                            }
                            ReadWords = string.Join(",", datas4.Datas);
                            break;
                    }
                });
            }
        }


        /// &lt;/summary&gt;
        /// &lt;summary&gt;
        /// 写入按钮的命令处理
        /// &lt;/summary&gt;
        public ICommand WriteCommand
        {
            get
            {
                return new RelayCommand(o =&gt;
                {
                    var d = WritePLCModel;
                    //内存地址
                    string plcAddr = WritePLCModel.Area + WritePLCModel.Address;
                    //写入数量 
                    ushort writeCount = ushort.Parse(WritePLCModel.Count);
                    //数据类型
                    string dataType = WritePLCModel.DataType;
                    //实际数量
                    string objWriteVals = WriteWords;
                    ushort objWCount = (ushort)objWriteVals.Split(',').Length;
                    //实际数量与要求数量不一致，不允许操作
                    if (writeCount != objWCount)
                    {
                        ShowError("写入值的数量不正确!");
                        return;
                    }
                    List&lt;string&gt; vals = objWriteVals.Split(',').ToList();
                    switch (dataType)
                    {
                        case "ushort":
                            //实际数值转换成list集合ushort类型
                            List&lt;ushort&gt; objushort = new List&lt;ushort&gt;();
                            vals.ForEach((x) =&gt;
                            {
                                objushort.Add(ushort.Parse(x));
                            });
                            var finish1 = finsTcp.Write(objushort, plcAddr);
                            if (finish1.IsSuccessed)
                            {
                                ShowMessage(finish1.Message, "提示");
                            }
                            break;
                        case "short":
                            //实际数值转换成list集合 short类型
                            List&lt;short&gt; objshort = new List&lt;short&gt;();
                            vals.ForEach((x) =&gt;
                            {
                                objshort.Add(short.Parse(x));
                            });
                            var finish2 = finsTcp.Write(objshort, plcAddr);
                            if (finish2.IsSuccessed)
                            {
                                ShowMessage(finish2.Message, "提示");
                            }
                            break;
                        case "float":
                            //实际数值转换成list集合 float
                            List&lt;float&gt; objfloat = new List&lt;float&gt;();
                            vals.ForEach((x) =&gt;
                            {
                                objfloat.Add(float.Parse(x));
                            });
                            var finish3 = finsTcp.Write(objfloat, plcAddr);
                            if (finish3.IsSuccessed)
                            {
                                ShowMessage(finish3.Message, "提示");
                            }
                            break;
                        case "bool":
                            //实际数值转换成list集合bool
                            List&lt;bool&gt; objbool = new List&lt;bool&gt;();
                            vals.ForEach((x) =&gt;
                            {
                                if (x == "1")
                                {
                                    objbool.Add(true);
                                }
                                else
                                {
                                    objbool.Add(false);
                                }
                            });
                            var finish4 = finsTcp.Write(objbool, plcAddr);
                            if (finish4.IsSuccessed)
                            {
                                ShowMessage(finish4.Message, "提示");
                            }
                            break;
                    }
                });
            }
        }

    }
}
</code></pre> 
<h3>2.7 主界面样式</h3> 
<p>首先添加资源文件</p> 
<p><img alt="" height="1080" src="https://images2.imgbox.com/2a/fd/GLVzpwCl_o.png" width="1200"></p> 
<p> </p> 
<p><img alt="" height="665" src="https://images2.imgbox.com/3b/29/L6DB09Wq_o.png" width="947"></p> 
<p></p> 
<pre><code class="language-cs">&lt;ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"&gt;
    &lt;!--定义通用的按钮样式--&gt;
    &lt;Style TargetType="{x:Type Button}" x:Key="btnBaseStyle"&gt;
        &lt;Setter Property="Height" Value="22"/&gt;
        &lt;Setter Property="Width" Value="60"/&gt;
        &lt;Setter Property="FontFamily" Value="微软雅黑"/&gt;
        &lt;Setter Property="Margin" Value="3,0"/&gt;
        &lt;Setter Property="FontSize" Value="16"/&gt;
        &lt;Setter Property="FontWeight" Value="Bold"/&gt;
        &lt;Setter Property="Foreground"  Value="Blue"/&gt;
    &lt;/Style&gt;

    &lt;!--TextBox默认样式--&gt;
    &lt;Style TargetType="{x:Type TextBox}" x:Key="txtTextBoxStyle"&gt;
        &lt;Setter Property="Width" Value="150"/&gt;
        &lt;Setter Property="Height" Value="25"/&gt;
        &lt;Setter Property="BorderBrush" Value="#FF105190"/&gt;
        &lt;Setter Property="BorderThickness" Value="1"/&gt;
        &lt;Setter Property="Margin" Value="2,0"/&gt;
        &lt;Setter Property="VerticalContentAlignment" Value="Center"/&gt;
        &lt;Setter Property="Background"&gt;
            &lt;Setter.Value&gt;
                &lt;LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1"&gt;
                    &lt;GradientStop Color="White" Offset="0"/&gt;
                    &lt;GradientStop Color="#FFE4E4E4" Offset="1"/&gt;
                &lt;/LinearGradientBrush&gt;
            &lt;/Setter.Value&gt;
        &lt;/Setter&gt;
    &lt;/Style&gt;

    &lt;!--TextBlock默认样式--&gt;
    &lt;Style TargetType="{x:Type TextBlock}" x:Key="txtTextBlockStyle"&gt;
        &lt;Setter Property="Margin" Value="1"/&gt;
        &lt;Setter Property="Height" Value="15"/&gt;
    &lt;/Style&gt;

    &lt;!--页面下拉框样式--&gt;
    &lt;LinearGradientBrush x:Key="ComboBox.Static.Background" EndPoint="0,1" StartPoint="0,0"&gt;
        &lt;GradientStop Color="White" Offset="0"/&gt;
        &lt;GradientStop Color="#FFE4E4E4" Offset="1"/&gt;
    &lt;/LinearGradientBrush&gt;
    &lt;SolidColorBrush x:Key="ComboBox.Static.Border" Color="#FF105190"/&gt;

    &lt;!--combox默认样式--&gt;
    &lt;Style x:Key="cboStyle" TargetType="{x:Type ComboBox}"&gt;
        &lt;Setter Property="Background" Value="{StaticResource ComboBox.Static.Background}"/&gt;
        &lt;Setter Property="BorderBrush" Value="{StaticResource ComboBox.Static.Border}"/&gt;
        &lt;Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"/&gt;
        &lt;Setter Property="Width" Value="150"/&gt;
        &lt;Setter Property="Height" Value="25"/&gt;
        &lt;Setter Property="BorderThickness" Value="1"/&gt;
        &lt;Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/&gt;
        &lt;Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/&gt;
        &lt;Setter Property="Padding" Value="6,3,5,3"/&gt;
        &lt;Setter Property="ScrollViewer.CanContentScroll" Value="true"/&gt;
        &lt;Setter Property="ScrollViewer.PanningMode" Value="Both"/&gt;
        &lt;Setter Property="Stylus.IsFlicksEnabled" Value="False"/&gt;
    &lt;/Style&gt;
&lt;/ResourceDictionary&gt;</code></pre> 
<p> 使用资源文件 </p> 
<p><img alt="" height="783" src="https://images2.imgbox.com/a9/f5/CPBD7LJE_o.png" width="1200"></p> 
<h3 style="background-color:transparent;">2.8 主界面布局</h3> 
<p><img alt="" height="951" src="https://images2.imgbox.com/03/a5/nG78E7Zn_o.png" width="1200"></p> 
<p> </p> 
<pre><code class="language-cs">&lt;Window x:Class="OmronFinsWPFApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:OmronFinsWPFApp.ViewModel"
        mc:Ignorable="d"   WindowStartupLocation="CenterScreen"
        FontSize="13" FontFamily="Microsoft YaHei" FontWeight="ExtraLight" Title="欧姆龙PLC通讯工具" Height="430" Width="860" Name="loginWin"&gt;
    &lt;Window.DataContext&gt;
        &lt;local:MainViewModel/&gt;
    &lt;/Window.DataContext&gt;
    &lt;Grid Background="Honeydew" ShowGridLines="true"&gt;
        &lt;Grid.RowDefinitions&gt;
            &lt;RowDefinition Height="60"/&gt;
            &lt;RowDefinition/&gt;
        &lt;/Grid.RowDefinitions&gt;
        &lt;!--第一行标题--&gt;
        &lt;TextBlock Grid.Row="0" Text="C#利用Fins协议实现欧姆龙PLC的数据读写" FontSize="22" VerticalAlignment="Center" Margin="20,0" FontWeight="Bold" /&gt;
        &lt;!--第二行信息--&gt;
        &lt;Grid Grid.Row="1"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="200"/&gt;
                &lt;ColumnDefinition/&gt;
            &lt;/Grid.ColumnDefinitions&gt; 

            &lt;StackPanel Grid.Column="0" Margin="20"&gt;
                &lt;TextBlock Text="PLC地址"/&gt;
                &lt;TextBox   Height="30" VerticalContentAlignment="Center" Padding="5,0" Margin="0,10" Text="{Binding HostName}"  /&gt; 
                &lt;TextBlock Text="端口号" Margin="0,10,0,0"/&gt;
                &lt;TextBox  Height="30" VerticalContentAlignment="Center" Padding="5,0" Margin="0,10" Text="{Binding HostPort}"  /&gt; 
                &lt;Button Content="连接" Margin="0,30,0,0" Height="30"   Command="{Binding LoginCommand}" CommandParameter="{Binding ElementName=loginWin}"  /&gt;
                &lt;Button Content="断开" Margin="0,10" Height="30" /&gt;
                &lt;TextBlock  Text="{Binding ConnectWords,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"  Margin="0,10,0,0"  Foreground="Blue"/&gt;
            &lt;/StackPanel&gt;

            &lt;Grid Grid.Column="1"&gt;
                &lt;Grid.RowDefinitions&gt;
                    &lt;RowDefinition Height="60"/&gt;
                    &lt;RowDefinition Height="80"/&gt;
                    &lt;RowDefinition Height="30"/&gt;
                    &lt;RowDefinition Height="60"/&gt;
                    &lt;RowDefinition Height="80"/&gt;
                &lt;/Grid.RowDefinitions&gt;
                &lt;Grid.ColumnDefinitions&gt;
                    &lt;ColumnDefinition/&gt;
                    &lt;ColumnDefinition/&gt;
                &lt;/Grid.ColumnDefinitions&gt;
                &lt;StackPanel Orientation="Horizontal" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Margin="10"&gt;
                    &lt;TextBlock     Text="存储区："  Style="{StaticResource  txtTextBlockStyle}" &gt;&lt;/TextBlock&gt;
                    &lt;ComboBox  ItemsSource="{Binding CboCustTypes}" SelectedValue="{Binding  ReadPLCModel.Area}"  Width="70"  Style="{StaticResource cboStyle}"&gt;&lt;/ComboBox&gt;
                    &lt;TextBlock   Text="数据类型："  Style="{StaticResource  txtTextBlockStyle}" &gt;&lt;/TextBlock&gt;
                    &lt;ComboBox     ItemsSource="{Binding CboCustDatas}" SelectedValue="{Binding ReadPLCModel.DataType}"  Width="70" Style="{StaticResource cboStyle}"&gt;&lt;/ComboBox&gt;
                    &lt;TextBlock   Text="地址：" Style="{StaticResource  txtTextBlockStyle}" &gt;&lt;/TextBlock&gt;
                    &lt;TextBox    Text="{Binding ReadPLCModel.Address}"  Width="100"  Style="{StaticResource  txtTextBoxStyle}" /&gt;
                    &lt;TextBlock   Text="数量：" Style="{StaticResource  txtTextBlockStyle}" &gt;&lt;/TextBlock&gt;
                    &lt;TextBox    Text="{Binding ReadPLCModel.Count}"  Width="60" Style="{StaticResource  txtTextBoxStyle}"  /&gt;
                    &lt;Button Content="读取" Height="30" Width="100"  Command="{Binding ReadCommand}" CommandParameter="{Binding ElementName=loginWin}" Style="{StaticResource btnBaseStyle}"  /&gt;
                &lt;/StackPanel&gt;

                &lt;StackPanel Orientation="Vertical" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"  Margin="10"&gt;
                    &lt;TextBlock Text="读取结果(多个数据之间用逗号隔开)"  Style="{StaticResource  txtTextBlockStyle}" Margin="0 5 0 9"&gt;&lt;/TextBlock&gt;
                    &lt;TextBox   Text="{Binding ReadWords,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"  Width="600" Style="{StaticResource  txtTextBoxStyle}"    /&gt;
                &lt;/StackPanel&gt;

                &lt;StackPanel Orientation="Horizontal" Margin="5" Grid.Row="2"  Grid.Column="0" Grid.ColumnSpan="2" Background="#4490AC" Width="600"&gt;
                &lt;/StackPanel&gt;

                &lt;StackPanel Orientation="Horizontal" Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2"  Margin="10"&gt;
                    &lt;TextBlock     Text="存储区：" Style="{StaticResource  txtTextBlockStyle}" &gt;&lt;/TextBlock&gt;
                    &lt;ComboBox    ItemsSource="{Binding CboCustTypes}" SelectedValue="{Binding WritePLCModel.Area }"  Width="70"  Style="{StaticResource cboStyle}"&gt;&lt;/ComboBox&gt;
                    &lt;TextBlock   Text="数据类型：" Style="{StaticResource  txtTextBlockStyle}" &gt;&lt;/TextBlock&gt;
                    &lt;ComboBox     ItemsSource="{Binding CboCustDatas}" SelectedValue="{Binding WritePLCModel.DataType }"  Width="70"  Style="{StaticResource cboStyle}"&gt;&lt;/ComboBox&gt;
                    &lt;TextBlock   Text="地址：" Style="{StaticResource  txtTextBlockStyle}" &gt;&lt;/TextBlock&gt;
                    &lt;TextBox   Text="{Binding  WritePLCModel.Address }"  Width="100"  Style="{StaticResource  txtTextBoxStyle}"  /&gt;
                    &lt;TextBlock   Text="数量：" Style="{StaticResource  txtTextBlockStyle}" &gt;&lt;/TextBlock&gt;
                    &lt;TextBox    Text="{Binding WritePLCModel.Count}"  Width="60"   Style="{StaticResource  txtTextBoxStyle}"  /&gt;
                    &lt;Button Content="写入" Height="30" Width="100"   Command="{Binding WriteCommand}" CommandParameter="{Binding ElementName=loginWin}" Style="{StaticResource btnBaseStyle}" /&gt;
                &lt;/StackPanel&gt;

                &lt;StackPanel Orientation="Vertical" Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="2"  Margin="10"&gt;
                    &lt;TextBlock   Text="写入数据(多个数据之间用逗号隔开)" Style="{StaticResource  txtTextBlockStyle}" Margin="0 5 0 9" &gt;&lt;/TextBlock&gt;
                    &lt;TextBox    Text="{Binding WriteWords ,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"  Width="600" Style="{StaticResource  txtTextBoxStyle}"  /&gt;
                &lt;/StackPanel&gt;

            &lt;/Grid&gt;
        &lt;/Grid&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;
</code></pre> 
<p>运行起来效果</p> 
<p><img alt="" height="424" src="https://images2.imgbox.com/06/6a/pNIEeyeq_o.png" width="845"></p> 
<h2 style="background-color:transparent;">3、测试软件</h2> 
<h3>3.1 测试PLC连接</h3> 
<p><img alt="" height="423" src="https://images2.imgbox.com/28/82/GRp1smxf_o.png" width="850"></p> 
<h3><img alt="" height="422" src="https://images2.imgbox.com/e8/be/8rGmuhH9_o.png" width="843"></h3> 
<h3 style="background-color:transparent;">3.2 读取dm区100的short类型</h3> 
<p><img alt="" height="689" src="https://images2.imgbox.com/ea/69/aEB9Ml1U_o.png" width="1026"></p> 
<h3></h3> 
<h3><img alt="" height="866" src="https://images2.imgbox.com/d1/0f/UxtBZ7kY_o.png" width="1046"></h3> 
<h3>3.3 读取h区100的ushort类型</h3> 
<p><img alt="" height="670" src="https://images2.imgbox.com/3d/af/aJjVsR2A_o.png" width="981"></p> 
<p></p> 
<p><img alt="" height="954" src="https://images2.imgbox.com/38/b1/WTej6Kf3_o.png" width="1191"></p> 
<h3>3.4 读取w区100的float类型</h3> 
<p><img alt="" height="666" src="https://images2.imgbox.com/db/a8/gCZ2ttA9_o.png" width="1011"></p> 
<p><img alt="" height="995" src="https://images2.imgbox.com/bf/14/EQmveQRb_o.png" width="1200"></p> 
<h3>3.5 读取cio区100的bool类型</h3> 
<p><img alt="" height="577" src="https://images2.imgbox.com/57/6d/URkvHT9z_o.png" width="889"><img alt="" height="991" src="https://images2.imgbox.com/ce/1a/Lcz9sFlf_o.png" width="1200"></p> 
<h3>3.6 写入DM区110的short类型</h3> 
<p> <img alt="" height="558" src="https://images2.imgbox.com/1e/76/HD8yug4j_o.png" width="895"></p> 
<p><img alt="" height="438" src="https://images2.imgbox.com/35/19/PoZ9HSAw_o.png" width="636"> </p> 
<h3>3.7 写入H区110的ushort类型</h3> 
<p><img alt="" height="581" src="https://images2.imgbox.com/8b/5a/Sa3YaRI5_o.png" width="943"></p> 
<p></p> 
<p><img alt="" height="465" src="https://images2.imgbox.com/b5/52/SNDgzf5c_o.png" width="724"></p> 
<h3>3.8 写入W区110的float类型</h3> 
<p><img alt="" height="636" src="https://images2.imgbox.com/5c/27/jloulK1m_o.png" width="1024"></p> 
<p></p> 
<p><img alt="" height="616" src="https://images2.imgbox.com/7b/10/sTEdKIIn_o.png" width="1014"></p> 
<p></p> 
<h3>3.9 写入CIO区110的bool类型</h3> 
<p><img alt="" height="591" src="https://images2.imgbox.com/cb/14/7a8b9doU_o.png" width="977"></p> 
<h2><img alt="" height="628" src="https://images2.imgbox.com/7b/1a/0wJtj0WH_o.png" width="898"> </h2> 
<p>全部通讯报文 </p> 
<p><img alt="" height="906" src="https://images2.imgbox.com/8e/0e/sMXGqHEh_o.png" width="1200"></p> 
<h2></h2> 
<h2>4、小结</h2> 
<p>本例子用到WPF的MVVM模式，不是winform中的按钮点击事件，是后台绑定viewmodel，用数据驱动页面控件，跟vue中的mvvm渲染数据方式一样，跟微信小程序的MVVM模式一样的，这就实现了界面与数据的分离。</p> 
<p><span style="color:#956fe7;"><strong>打字不易，截图不易，代码不易，准备不易，原创不易，多多点赞收藏，江湖有你，共同致富。</strong></span></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/f7/95/4uRYT94U_o.png" width="1200"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/915f205ee27b817e9afd0db40b8e64ee/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vue3-37-路由-组件内的路由守卫 onBeforeRouteLeave 和 onBeforeRouteUpdate</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ab089f10a0fbd71047d179e6b947340e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">提升网络安全重要要素IP地址</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>