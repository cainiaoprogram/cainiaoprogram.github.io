<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CentOS 7 安装 PPTP - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CentOS 7 安装 PPTP" />
<meta property="og:description" content="环境：
阿里云试用机：
外网IP：114.55.80.150
内网IP：172.28.11.92
一、服务器安装 PPTP 1、安装
yum install epel-release -y 2、安装pptp
yum install pptpd iptables-services -y 3、修改配置
vim /etc/pptpd.conf # 最后加入 localip 114.55.80.150 # 本机外网IP remoteip 172.28.11.200-220 # 分配给客户端的IP，跟本机内网一个网段，地址不要冲突 4、创建用户
vim /etc/ppp/chap-secrets # 加入用户tomma 密码123456 # Secrets for authentication using CHAP # client server secret IP addresses tomma * 123456 * 5、配置DNS
vim /etc/ppp/options.pptpd # 修改 ms-dns 114.114.114.114 ms-dns 8.8.8.8 6、打开转发
echo &#34;net.ipv4.ip_forward = 1&#34; &gt;&gt;/etc/sysctl.conf # 生效 sysctl -p 7、关闭防火墙和 selinux" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8b3c43a83523e341a13454d979bdf424/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T17:12:14+08:00" />
<meta property="article:modified_time" content="2024-01-05T17:12:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CentOS 7 安装 PPTP</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>环境：</p> 
<p>阿里云试用机：</p> 
<p>外网IP：114.55.80.150</p> 
<p>内网IP：172.28.11.92</p> 
<h6>一、服务器安装 PPTP</h6> 
<p>1、安装</p> 
<pre><code>yum install epel-release -y</code></pre> 
<p>2、安装pptp</p> 
<pre><code>yum install pptpd iptables-services -y</code></pre> 
<p>3、修改配置</p> 
<pre><code>vim /etc/pptpd.conf

# 最后加入
localip 114.55.80.150        # 本机外网IP
remoteip 172.28.11.200-220   # 分配给客户端的IP，跟本机内网一个网段，地址不要冲突</code></pre> 
<p>4、创建用户</p> 
<pre><code>vim /etc/ppp/chap-secrets

# 加入用户tomma 密码123456
# Secrets for authentication using CHAP
# client        server  secret                  IP addresses
tomma * 123456 *</code></pre> 
<p>5、配置DNS</p> 
<pre><code>vim /etc/ppp/options.pptpd

# 修改
ms-dns 114.114.114.114
ms-dns 8.8.8.8</code></pre> 
<p>6、打开转发</p> 
<pre><code>echo "net.ipv4.ip_forward = 1" &gt;&gt;/etc/sysctl.conf

# 生效
sysctl -p
</code></pre> 
<p>7、关闭防火墙和 selinux</p> 
<pre><code>sed -i "s/SELINUX=enforcing/SELINUX=disabled/g" /etc/selinux/config
 
systemctl stop firewalld &amp;&amp; systemctl disable firewalld</code></pre> 
<p>8、开启nat，实现客户端连上后可以上网</p> 
<pre><code>iptables -t nat -A POSTROUTING -s 172.28.11.0/24 -j MASQUERADE

# 保存
service iptables save

# 开机启动
systemctl enable iptables</code></pre> 
<p>9、修改MTU，默认为1396</p> 
<pre><code>vim /etc/ppp/ip-up

......

# 加入
ifconfig $1 mtu 1500
 
exit 0</code></pre> 
<p>10、启动 </p> 
<pre><code>systemctl start pptpd
</code></pre> 
<p>10、本例是在阿里云上面操作的，需要放行 1723 端口与 GRE</p> 
<p><img alt="" height="294" src="https://images2.imgbox.com/45/59/2bsLd1a5_o.png" width="1046"></p> 
<h6>二、Windows 连接 VPN </h6> 
<p>1、找台 Window 11 测试，创建一个新的VPN </p> 
<p><img alt="" height="697" src="https://images2.imgbox.com/e1/83/nV6GcUfH_o.png" width="1092"></p> 
<p> <img alt="" height="740" src="https://images2.imgbox.com/a8/4e/1gXBnfMM_o.png" width="379"></p> 
<p>2、选中这个连接，点击高级选项，点击更多VPN属性</p> 
<p><img alt="" height="427" src="https://images2.imgbox.com/52/46/DkKtoWec_o.png" width="412"></p> 
<p>3、点高级</p> 
<p><img alt="" height="479" src="https://images2.imgbox.com/b0/7a/pbVn65Dr_o.png" width="455"></p> 
<p>4、取消勾选 "在远程网络上使用默认网关"，如果你想连上VPN后本机显示的是远端的IP地址，就勾选上</p> 
<p><img alt="" height="439" src="https://images2.imgbox.com/45/3a/0PpMcg5f_o.png" width="452"></p> 
<p>5、返回到VPN界面，点击连接，成功</p> 
<p> <img alt="" height="348" src="https://images2.imgbox.com/f4/e0/MdSvqVqm_o.png" width="873"></p> 
<p>6、查看连接成功后的IP</p> 
<pre><code>PS C:\Users\Administrator&gt; ipconfig

Windows IP 配置


以太网适配器 以太网:

   连接特定的 DNS 后缀 . . . . . . . :
   IPv4 地址 . . . . . . . . . . . . : 192.168.123.88
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   默认网关. . . . . . . . . . . . . : 192.168.123.1

PPP 适配器 PPTPVPN:

   连接特定的 DNS 后缀 . . . . . . . :
   IPv4 地址 . . . . . . . . . . . . : 172.28.11.201    # 成功获取
   子网掩码  . . . . . . . . . . . . : 255.255.255.255
   默认网关. . . . . . . . . . . . . :</code></pre> 
<p>7、访问远程服务器</p> 
<pre><code>PS C:\Users\Administrator&gt; ping 172.28.11.92

正在 Ping 172.28.11.92 具有 32 字节的数据:
来自 172.28.11.92 的回复: 字节=32 时间=12ms TTL=64
来自 172.28.11.92 的回复: 字节=32 时间=12ms TTL=64
来自 172.28.11.92 的回复: 字节=32 时间=12ms TTL=64
来自 172.28.11.92 的回复: 字节=32 时间=12ms TTL=64

172.28.11.92 的 Ping 统计信息:
    数据包: 已发送 = 4，已接收 = 4，丢失 = 0 (0% 丢失)，
往返行程的估计时间(以毫秒为单位):
    最短 = 12ms，最长 = 12ms，平均 = 12ms</code></pre> 
<h6>三、排错</h6> 
<p>1、如果你所在的网络连接报错，请检查你的路由器上面有没有打开 PPTP功能</p> 
<p><img alt="" height="524" src="https://images2.imgbox.com/60/b7/c12IMYUY_o.png" width="797"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bdf670a3f2c3df561fdd3b928a05acd3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【AWS系列】巧用 G5g 畅游Android流媒体游戏</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7b04093300cda5abfa9719950c46d554/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Certum与Geotrust的OV多域名证书</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>