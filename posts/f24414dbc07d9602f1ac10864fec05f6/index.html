<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>UniApp调试支付宝沙箱（安卓） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="UniApp调试支付宝沙箱（安卓）" />
<meta property="og:description" content="先看下这里完整的交互的图：小程序文档 - 支付宝文档中心
一、打包
不管怎样，先打个包先。可以直接使用云端证书、云端打包，只需要指定包名即可。
二、在支付宝开放平台创建应用
这个参考官方的过程就可以了，只要有刚才打的包，就可以提交创建。（登录 - 支付宝）
这里说的只是可以提交创建，但是因为缺少很多材料（比如营业执照等）在正式环境肯定调不通。
当然，提交审核大概率也会被打回。
三、后端接入-获取订单信息：
参考：小程序文档 - 支付宝文档中心
注意上面链接参考代码里面的编码是&#34;BGK&#34;，在传值有中文的情况下即使是沙箱都会报“商品订单数据错误”之类的报错，需要改成“UTF-8”。
这个页面里还有一个功能是它会帮忙检查产品的准备情况，正式接入前可参考下，沙箱可忽略：
四、前端获取后端的订单信息并且调用uniapp封装好的支付接口：
uniapp端的前端参考要参考这个链接：开通 | uni-app官网（关键字是：uni.requestPayment）
针对沙箱修改后的参考代码：
onLoad() {
var EnvUtils = plus.android.importClass(&#34;com.alipay.sdk.app.EnvUtils&#34;);
EnvUtils.setEnv(EnvUtils.EnvEnum.SANDBOX);
},
methods: {
goToAliPay() {
request({
url: &#39;/alipaytest/getOrderInfo&#39;,
method: &#39;get&#39;,
data: {
orderId: this.orderId,
subject: this.subject,
totalAmount: this.totalAmount
}
}).then(response =&gt; {
console.log(response.msg)
uni.getProvider({
service: &#39;payment&#39;,
success: function(res) {
console.log(res.provider)
if (~res.provider.indexOf(&#39;alipay&#39;)) {
uni.requestPayment({
&#34;provider&#34;: &#34;alipay&#34;, //固定值为&#34;alipay&#34;
&#34;orderInfo&#34;: response.msg, //此处为服务器返回的订单信息字符串" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f24414dbc07d9602f1ac10864fec05f6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-11T09:37:43+08:00" />
<meta property="article:modified_time" content="2024-01-11T09:37:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">UniApp调试支付宝沙箱（安卓）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>先看下这里完整的交互的图：<a href="https://opendocs.alipay.com/open/204/01dcc0" rel="nofollow" title="小程序文档 - 支付宝文档中心">小程序文档 - 支付宝文档中心</a></p> 
<p><strong>一、打包</strong></p> 
<p>不管怎样，先打个包先。可以直接使用云端证书、云端打包，只需要指定包名即可。</p> 
<p><strong>二、在支付宝开放平台创建应用</strong></p> 
<p>这个参考官方的过程就可以了，只要有刚才打的包，就可以提交创建。（<a href="https://open.alipay.com/develop/manage" rel="nofollow" title="登录 - 支付宝">登录 - 支付宝</a>）</p> 
<p>这里说的只是可以提交创建，但是因为缺少很多材料（比如营业执照等）在正式环境肯定调不通。</p> 
<p>当然，提交审核大概率也会被打回。</p> 
<p><strong>三、后端接入-获取订单信息：</strong></p> 
<p>参考：<a href="https://opendocs.alipay.com/open/02e7gq?scene=20" rel="nofollow" title="小程序文档 - 支付宝文档中心">小程序文档 - 支付宝文档中心</a></p> 
<p>注意上面链接参考代码里面的编码是"BGK"，在传值有中文的情况下即使是沙箱都会报“商品订单数据错误”之类的报错，需要改成“UTF-8”。</p> 
<p>这个页面里还有一个功能是它会帮忙检查产品的准备情况，正式接入前可参考下，沙箱可忽略：</p> 
<p><img alt="" height="213" src="https://images2.imgbox.com/0d/f0/nmiKiYjB_o.png" width="686"></p> 
<p><strong>四、前端获取后端的订单信息并且调用uniapp封装好的支付接口：</strong></p> 
<p>uniapp端的前端参考要参考这个链接：<a href="https://uniapp.dcloud.net.cn/tutorial/app-payment-alipay.html" rel="nofollow" title="开通 | uni-app官网">开通 | uni-app官网</a>（关键字是：<a href="https://uniapp.dcloud.net.cn/api/plugins/payment#requestpayment" rel="nofollow" title="uni.requestPayment">uni.requestPayment</a>）</p> 
<p>针对沙箱修改后的参考代码：</p> 
<p>        onLoad() {<!-- --><br>             var EnvUtils = plus.android.importClass("com.alipay.sdk.app.EnvUtils");<br>             EnvUtils.setEnv(EnvUtils.EnvEnum.SANDBOX);<br>         },<br>         methods: {<!-- --><br>             goToAliPay() {<!-- --><br>                 request({<!-- --><br>                     url: '/alipaytest/getOrderInfo',<br>                     method: 'get',<br>                     data: {<!-- --><br>                         orderId: this.orderId,<br>                         subject: this.subject,<br>                         totalAmount: this.totalAmount<br>                     }<br>                 }).then(response =&gt; {<!-- --><br>                     console.log(response.msg)<br>                     uni.getProvider({<!-- --><br>                         service: 'payment',<br>                         success: function(res) {<!-- --><br>                             console.log(res.provider)<br>                             if (~res.provider.indexOf('alipay')) {<!-- --><br>                                 uni.requestPayment({<!-- --><br>                                     "provider": "alipay", //固定值为"alipay"<br>                                     "orderInfo": response.msg, //此处为服务器返回的订单信息字符串<br>                                     success: function(res) {<!-- --><br>                                         var rawdata = JSON.parse(res.rawdata);<br>                                         console.log("支付成功");<br>                                     },<br>                                     fail: function(err) {<!-- --><br>                                         console.log('支付失败:' + JSON.stringify(err));<br>                                     }<br>                                 });<br>                             }<br>                         }<br>                     });<br>                 })<br>             }</p> 
<p>onLoad里面的代码在沙箱下是必须的。否则不会调用沙箱APP。</p> 
<p><strong>五、安装支付宝的沙箱APP，用沙箱支付账号登录该APP：</strong></p> 
<p>参考：<a href="https://opendocs.alipay.com/common/02kkv7" rel="nofollow" title="小程序文档 - 支付宝文档中心">小程序文档 - 支付宝文档中心</a> 里的：</p> 
<p><img alt="" height="107" src="https://images2.imgbox.com/9a/f9/KyRgFsxY_o.png" width="661"></p> 
<p>链接点进去自助操作。</p> 
<p><strong>六、在安装有沙箱APP的机器或者模拟器上安装我们开发的程序，测试一下就OK了。</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4799f29634bea0e05a7efcdb4f5f3016/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">代码&#43;视频，超详细的R语言svykm函数绘制复杂抽样设计数据cox回归生存曲线(Kaplan-Meier)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9d905a33cda2011fa743e9de90e2f469/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C语言】ipoib驱动 - ipoib_cm_post_receive_nonsrq_rss函数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>