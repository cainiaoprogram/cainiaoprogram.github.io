<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ubuntu20.04 Server安装部署Janus - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ubuntu20.04 Server安装部署Janus" />
<meta property="og:description" content="Janus版本：janus-gateway-0.11.5，注册版本与各组件版本的对应关系，注意组件间依赖的版本匹配问题。
1.安装依赖库：
下载最新的源代码需要git，若没有安装git可以使用下面命令进行安装：
sudo apt-get install git -y
安装lua库
sudo apt-get install liblua5.3-dev
编译运行 Janus Server 需要依赖较多的一些第三方库，而这些依赖库在 Ubuntu 下主要通过 aptitude 进行安装，首先通过安装 aptitude:
sudo apt-get install aptitude
还有一些编译的aptitude依赖库，相关安装命令如下：
sudo aptitude install libmicrohttpd-dev libjansson-dev libnice-dev
sudo aptitude install libssl-dev libsofia-sip-ua-dev libglib2.0-dev
sudo aptitude install libopus-dev libogg-dev libcurl4-openssl-dev pkg-config f
sudo aptitude install gengetopt libtool automake libconfig-dev doxygen graphviz
sudo apt-get install cmake openssl libssl-dev -y
sudo apt-get install -y
2.安装libsrtp2.2.0：
下载源码：https://github.com/cisco/libsrtp/releases/tag/v2.2.0" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f4184d3f4784d98e2cbbc6b738ec2e59/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-17T17:45:14+08:00" />
<meta property="article:modified_time" content="2021-11-17T17:45:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ubuntu20.04 Server安装部署Janus</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0;text-align:justify;">Janus版本：janus-gateway-0.11.5，注册版本与各组件版本的对应关系，注意组件间依赖的版本匹配问题。</p> 
<p style="margin-left:0;text-align:left;"><strong>1.安装依赖库：</strong></p> 
<p style="margin-left:0;text-align:justify;">下载最新的源代码需要git，若没有安装git可以使用下面命令进行安装：</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">sudo apt-get install git -y</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;">安装lua库</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">sudo apt-get install liblua5.3-dev</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;">编译运行 Janus Server 需要依赖较多的一些第三方库，而这些依赖库在 Ubuntu 下主要通过 aptitude 进行安装，首先通过安装 aptitude:</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">sudo apt-get install aptitude</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;"><span style="color:#000000;">还有一些编译的</span><span style="color:#000000;">aptitude</span><span style="color:#000000;">依赖库，相关安装命令如下：</span></p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">sudo aptitude install libmicrohttpd-dev libjansson-dev libnice-dev</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">sudo aptitude install libssl-dev libsofia-sip-ua-dev libglib2.0-dev</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">sudo aptitude install libopus-dev libogg-dev libcurl4-openssl-dev pkg-config f</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">sudo aptitude install gengetopt libtool automake </span><span style="color:#000000;">libconfig-dev doxygen graphviz</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">sudo apt-get install cmake openssl libssl-dev -y</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">sudo apt-get install -y</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:left;"><strong>2.安装libsrtp2.2.0：</strong></p> 
<p style="margin-left:0;text-align:justify;">下载源码：<a href="https://github.com/cisco/libsrtp/releases/tag/v2.2.0" title="https://github.com/cisco/libsrtp/releases/tag/v2.2.0">https://github.com/cisco/libsrtp/releases/tag/v2.2.0</a></p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#tar -xvf v2.2.0.tar.gz</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#cd libsrtp-2.2.0</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#./configure --prefix=/usr --libdir=/usr/lib64 --enable-openssl</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#make shared_library</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#sudo make install</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;">这里带上“--enable-openssl”参数，一般都需要开启https。</p> 
<p style="margin-left:0;text-align:left;"><strong>3.安装libwebsockets：</strong></p> 
<p style="margin-left:0;text-align:justify;">下载源码：<a href="https://github.com/warmcat/libwebsockets/tags" title="https://github.com/warmcat/libwebsockets/tags">https://github.com/warmcat/libwebsockets/tags</a>，这里下载3.2.2</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#tar -xvf libwebsockets-3.2.2.tar.gz</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#cd libwebsockets-3.2.2</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#make build</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#cd build</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#cmake ..</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#cmake -DLWS_MAX_SMP=1 -DLWS_WITHOUT_EXTENSIONS=0 -DCMAKE_INSTALL_PREFIX:PATH=/usr -DCMAKE_C_FLAGS="-fpic" ..</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#make</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#sudo make install</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:left;"><strong>3.安装Janus：</strong></p> 
<p style="margin-left:0;text-align:justify;">下载源码：<a href="https://github.com/meetecho/janus-gateway%20%E8%BF%99%E9%87%8C%E4%B8%8B%E8%BD%BD0.11.5" title="https://github.com/meetecho/janus-gateway 这里下载0.11.5">https://github.com/meetecho/janus-gateway 这里下载0.11.5</a>版本</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#tar -xvf janus-gateway-0.11.5.tar.gz</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#cd janus-gateway-0.11.5</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#./autogen.sh</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#./configure --prefix=/opt/janus --enable-websockets --disable-plugin-lua --enable-rest --enable-docs</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#make</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#sudo make install</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#sudo make configs      //</span><span style="color:#000000;">只需要执行一次，后面执行会覆盖前面的。</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:left;"><strong>4.启动 </strong></p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">Sudo /opt/janus/bin/janus --stun-server</span><span style="color:#000000;">=</span><span style="color:#000000;">1.1.1.1:3478 &amp;</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:left;"><strong>5.配置安装nginx</strong></p> 
<p style="margin-left:0;text-align:justify;"><strong>安装</strong></p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">apt-get install nginx</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">nginx -v                                            // </span><span style="color:#000000;">查看版本</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">systemctl start nginx                             // </span><span style="color:#000000;">启动服务</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">systemctl enable nginx                            // </span><span style="color:#000000;">开机自启动</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">systemctl stop nginx                               // </span><span style="color:#000000;">停止服务</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;"><strong>配置</strong></p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#sudo vi /etc/nginx/sites-available/default</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">//</span><span style="color:#000000;">把工程根路径指向</span><span style="color:#000000;">janus</span><span style="color:#000000;">的</span><span style="color:#000000;">demos</span><span style="color:#000000;">目录</span> </span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">root /opt/janus/share/janus/demos;</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;">保存退出，刷新配置</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#sudo nginx -s reload</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:left;"><strong>6.配置开启Https访问</strong></p> 
<p style="margin-left:0;text-align:justify;"><strong>6.1</strong><strong>生成自签发SSL证书</strong></p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#sudo mkdir /etc/nginx/cert</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#sudo openssl req -x509 -nodes -days </span><span style="color:#000000;">365</span><span style="color:#000000;"> -newkey </span><span style="color:#000000;">rsa:2048</span><span style="color:#000000;"> -keyout /etc/nginx/cert/app.key -out /etc/nginx/cert/app.crt</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">// </span><span style="color:#000000;">按自己的实际情况输入</span><span style="color:#000000;">Common</span> <span style="color:#000000;">Name</span><span style="color:#000000;">是使用证书的主机</span><span style="color:#000000;">IP</span><span style="color:#000000;">不能输错</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">Country</span> <span style="color:#000000;">Name</span><span style="color:#000000;"> (</span><span style="color:#000000;">2</span><span style="color:#000000;"> letter code) </span><span style="color:#000000;">[AU]:CN</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">State</span> <span style="color:#000000;">or</span> <span style="color:#000000;">Province</span> <span style="color:#000000;">Name</span><span style="color:#000000;"> (full name) </span><span style="color:#000000;">[Some-State]:JiangSu</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">Locality</span> <span style="color:#000000;">Name</span><span style="color:#000000;"> (eg, city) </span><span style="color:#000000;">[]:NanJing</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">Organization</span> <span style="color:#000000;">Name</span><span style="color:#000000;"> (eg, company) </span><span style="color:#000000;">[Internet Widgits Pty Ltd]:MicroSoftt</span> <span style="color:#000000;">Ltd</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">Organizational</span> <span style="color:#000000;">Unit</span> <span style="color:#000000;">Name</span><span style="color:#000000;"> (eg, section) </span><span style="color:#000000;">[]:Dept</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">Common</span> <span style="color:#000000;">Name</span><span style="color:#000000;"> (e.g. server FQDN or YOUR name) </span><span style="color:#000000;">[]:192.168.1.113</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">Email</span> <span style="color:#000000;">Address</span> <span style="color:#000000;">[]</span><span style="color:#000000;">:test@126.com</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;">增加前向保密</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#sudo openssl dhparam -out /etc/nginx/cert/dhparam.pem 2048</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;"><strong>6.2</strong><strong>配置nginx使用ssl证书</strong></p> 
<p style="margin-left:0;text-align:justify;">配置支持http和https都可以访问，http重定向到https</p> 
<p style="margin-left:0;text-align:justify;">#sudo vi /etc/nginx/sites-available/default</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">server {<!-- --></span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    listen 80 default_server;</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    server_name 192.168.1.113; # </span><span style="color:#000000;">可替换成域名</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    return 301 https://$server_name$request_uri;</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">}</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">server {<!-- --></span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    listen 443 ssl default_server;</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    listen [::]:443 ssl default_server;</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    ssl_certificate /etc/nginx/cert/app.crt;</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    ssl_certificate_key /etc/nginx/cert/app.key;</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    ssl_dhparam /etc/nginx/cert/dhparam.pem;</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    ssl_prefer_server_ciphers on;</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    ssl_ciphers "EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH";     </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;"> ...</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">}</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;">保存后退出</p> 
<p style="margin-left:0;text-align:justify;">刷新配置</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#nginx -s reload</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong>6.3</strong><strong>配置Janus使用ssl证书</strong></p> 
<p style="margin-left:0;text-align:justify;">Chrome浏览要求开启摄像头的网站必须使用https，除非只是本机访问（localhost）,所以一般都需要开启</p> 
<p style="margin-left:0;text-align:justify;"><strong>janus</strong><strong>配置修改</strong></p> 
<p style="margin-left:0;text-align:justify;">修改janus.transport.http.jcfg配置文件</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;"># sudo /opt/janus/etc/janus/janus.transport.http.jcfg</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">general: {<!-- --></span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#events = true  </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    json = "indented"                              </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    base_path = "/janus"    # Base path to bind to in the web server (plain HTTP only)</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    http = true               # Whether to enable the plain HTTP interface</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    port = 8088               # Web server HTTP port</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #interface = "eth0"       </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #ip = "192.168.0.1"                           </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;">    <span style="color:#FF0000;">https = true </span><span style="color:#000000;">             # Whether to enable HTTPS (default=false)</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;">    <span style="color:#FF0000;">secure_port = 8089 </span><span style="color:#000000;">      # Web server HTTPS port, if enabled</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #secure_interface = "eth0"             </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #secure_ip = "192.168.0.1"             </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #acl = "127.,192.168.0."               </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #mhd_connection_limit = 1020          </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    mhd_debug = true                      </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">}</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">………………………</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">admin: {<!-- --></span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;">    <span style="color:#FF0000;">admin_base_path = "/admin" </span>                  </span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;">    <span style="color:#FF0000;">admin_http = true   </span><span style="color:#000000;">                     # Whether to enable the plain HTTP interface</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    admin_port = 7088                        # Admin/monitor web server HTTP port</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #admin_interface = "eth0"                       </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #admin_ip = "192.168.0.1"                      </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;">    <span style="color:#FF0000;">admin_https = true </span>                            </span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;">    <span style="color:#FF0000;">admin_secure_port = 7889 </span><span style="color:#000000;">        # Admin/monitor web server HTTPS port, if enabled</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #admin_secure_interface = "eth0"       </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #admin_secure_ip = "192.168.0.1        </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #admin_acl = "127.,192.168.0."         </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">}</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">………………</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">certificates: {<!-- --></span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    cert_pem = "/etc/nginx/cert/app.crt"</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    cert_key = "/etc/nginx/cert/app.key"</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #cert_pwd = "secretpassphrase"</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #ciphers = "PFS:-VERS-TLS1.0:-VERS-TLS1.1:-3DES-CBC:-ARCFOUR-128"</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">}</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;">修改janus.jcfg</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#sudo vi /opt/janus/etc/janus/janus.jcfg</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">certificates: {<!-- --></span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    cert_pem = "/etc/nginx/cert/app.crt"</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    cert_key = "/etc/nginx/cert/app.key"</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #cert_pwd = "secretpassphrase"</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #dtls_accept_selfsigned = false</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #dtls_ciphers = "your-desired-openssl-ciphers"</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #rsa_private_key = false</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">}</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;">修改<span style="color:#000000;">janus.transport.websockets.jcfg</span><span style="color:#000000;">配置文件</span></p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;"># sudo /opt/janus/etc/janus/janus.transport.websockets.jcfg</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">general: {<!-- --></span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#events = true  </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    json = "indented"                              </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    base_path = "/janus"    # Base path to bind to in the web server (plain HTTP only)</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    http = true               # Whether to enable the plain HTTP interface</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    port = 8088               # Web server HTTP port</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #interface = "eth0"       </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #ip = "192.168.0.1"                           </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;">    <span style="color:#FF0000;">https = true </span><span style="color:#000000;">             # Whether to enable HTTPS (default=false)</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;">    <span style="color:#FF0000;">secure_port = 8089 </span><span style="color:#000000;">      # Web server HTTPS port, if enabled</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #secure_interface = "eth0"             </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #secure_ip = "192.168.0.1"             </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #acl = "127.,192.168.0."               </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #mhd_connection_limit = 1020          </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    mhd_debug = true                      </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">}</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">………………………</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">admin: {<!-- --></span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;">    <span style="color:#FF0000;">admin_base_path = "/admin" </span>                  </span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;">    <span style="color:#FF0000;">admin_http = true   </span><span style="color:#000000;">                     # Whether to enable the plain HTTP interface</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    admin_port = 7088                        # Admin/monitor web server HTTP port</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #admin_interface = "eth0"                       </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #admin_ip = "192.168.0.1"                      </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;">    <span style="color:#FF0000;">admin_https = true </span>                            </span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;">    <span style="color:#FF0000;">admin_secure_port = 7889 </span><span style="color:#000000;">        # Admin/monitor web server HTTPS port, if enabled</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #admin_secure_interface = "eth0"       </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #admin_secure_ip = "192.168.0.1        </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #admin_acl = "127.,192.168.0."         </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">}</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">………………</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">certificates: {<!-- --></span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    cert_pem = "/etc/nginx/cert/app.crt"</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    cert_key = "/etc/nginx/cert/app.key"</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #cert_pwd = "secretpassphrase"</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">    #ciphers = "PFS:-VERS-TLS1.0:-VERS-TLS1.1:-3DES-CBC:-ARCFOUR-128"</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">}</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;">修改完后重新启动就可</p> 
<h2 style="margin-left:0;"></h2> 
<p style="margin-left:0;text-align:left;"><strong>5.部署ICE服务器（Coturn）</strong></p> 
<p style="margin-left:0;text-align:justify;"><strong>概述：</strong></p> 
<p style="margin-left:0;text-align:justify;">WEBRTC在建立连接是一般有三个步骤：</p> 
<p style="margin-left:0;text-align:justify;">1. 尝试直连.</p> 
<p style="margin-left:0;text-align:justify;">2. 通过stun服务器进行穿透</p> 
<p style="margin-left:0;text-align:justify;">3. 无法穿透则通过turn服务器中转. </p> 
<p style="margin-left:0;text-align:justify;">只有连接的两个设备在同一NAT网络内部时，第一步直连才能成功，否则要借助穿越服务器（stun或turn）使用第2步或第3步进行连接。</p> 
<p style="margin-left:0;text-align:justify;">网上有一些免费的stun服务可以测试使用，如stun.ideasip.com。但建立连接时会比较慢</p> 
<p style="margin-left:0;text-align:justify;">所以最好的办法是自己搭建一台。</p> 
<p style="margin-left:0;text-align:justify;">coturn 是一套支持stun和turn两种功能的软件，支持tcp, udp, tls, dtls 连接，支持linux bsd solaris mac os. 暂不支持windows。</p> 
<p style="margin-left:0;text-align:justify;">coturn 依赖组件：</p> 
<p style="margin-left:0;text-align:justify;">coturn网络通讯使用的是libevent，所以需要安装livevent2.</p> 
<p style="margin-left:0;text-align:justify;"><strong>安装</strong></p> 
<p style="margin-left:0;text-align:justify;">安装基础组件：</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#sudo apt-get install libssl-dev libevent-dev libpq-dev</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;">安装coturn</p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;"># git clone https://github.com/coturn/coturn</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;"># cd coturn </span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;"># ./configure --prefix=/usr/local/coturn</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;"># make -j 4                                         // </span><span style="color:#000000;">多线程编译</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;"># make install</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;"><strong>配置</strong></p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#vi /etc/profile</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">export PATH=/usr/lodal/coturn/bin:$PATH</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#source /etc/profile</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#cd /usr/local/coturn/etc</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#sudo cp ./turnserver.conf.default ./turnserver.conf</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">#vi ./turnserver.conf</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">cli-password=qwerty</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">relay-device=eth33</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">listening-ip=192.168.1.113</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">listening-port=3478</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">tls-listening-port=5349</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">external-ip=39.105.44.xx                   // </span><span style="color:#000000;">外网（公网）</span><span style="color:#000000;">IP</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">relay-ip=192.168.1.113</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">relay-threads=50</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">lt-cred-mech</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">cert=/etc/nginx/cert/app.pem              // </span><span style="color:#000000;">测试安装，用上面生成的证书</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">pkey=/etc/nginx/cert/app.key</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">user=test:keytest1</span></span></span></p> 
</div> 
<p style="margin-left:0;text-align:justify;"><strong>启动</strong></p> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">turnserver -o -a -f -v --mobility -m 10 --max-bps=100000 --min-port=32355 --max-port=65535 --user= test:keytest1 -r test</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">参数说明：</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">-m 10 </span><span style="color:#000000;">表示启动十个</span><span style="color:#000000;">relay</span><span style="color:#000000;">线程</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">–</span><span style="color:#000000;">max-bps=100000 </span><span style="color:#000000;">限制最大速度为</span><span style="color:#000000;">100KB/s</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">当</span><span style="color:#000000;">TURN Server</span><span style="color:#000000;">用于</span><span style="color:#000000;">WebRTC</span><span style="color:#000000;">时，必须使用</span><span style="color:#000000;">long-term credential mechanism, </span><span style="color:#000000;">即指定</span><span style="color:#000000;"> -a </span><span style="color:#000000;">或者</span><span style="color:#000000;"> --lt-cred-mech</span></span></span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#d9d9d9;"><span style="background-color:#d9d9d9;"><span style="color:#000000;">添加了用户：</span><span style="color:#000000;">test</span><span style="color:#000000;">以及对应的密码</span></span></span></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/75402a4236534e215796ca488f12c6dc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">论文阅读笔记7——TransMOT: Spatial-Temporal Graph Transformer for MOT</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a33ef69eaafcf0ecb6edb348ab1dea5f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">sentinel整合feign</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>