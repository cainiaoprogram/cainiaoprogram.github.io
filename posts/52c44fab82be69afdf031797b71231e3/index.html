<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>利用stm32做一个升级版的电子多功能密码锁 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="利用stm32做一个升级版的电子多功能密码锁" />
<meta property="og:description" content="`自己利用空闲时间制作的电子密码锁，有PCB、原理图，PCB印制电路板。此设计用外部存储器，支持修改密码，本来想添加指纹识别模块，但是12864的数据口被使用了，gpio口不够用。在实际中我发现12864还是用串口比较好，因为用并口的话使用会影响同GPIO口的其他位口。毕竟是业余时间做的，可能在有些方面不是很完善。
一、功能介绍：
1、输入6位密码，即可开锁。
2、输入7次纯数字，系统会自动恢复初始状态。
3、没有输入完6位密码，按下确认键，系统不会应答。
4、密码输入错误三次，锁定键盘并且蜂鸣器提醒10秒。
5、输入错误可以退格、清零。
6、开机后12864模块会有60秒定时显示，没操作键盘60秒后，清除数据并且恢复初始状态。如果在记时期间有按键按下，这停止倒计时，并且在没有操作键盘8秒左右，重新开启倒计时12864休眠功能。
7、在功能模式下可以修改密码，也可以做其他功能选择（其他功能你们根据自身能力添加）。
8、程序有密码数值存储在数组，可用于显示等操作。（修改密码时可以显示）
9、有人体感应模块，感应到有人吗，并且12864处于关屏休眠模式下，即可打开12864屏幕。
10、有外部存储器24C02，支持修改密码，密码断电不丢失。
11、步进电机模块。
12、继电器模块。
13、温度模块，倒计时期间可以测量7805和1117芯片温度或者外部温度，并实时显示。
二、资料展示
1.原理图
2.PCB印制电路板
因为自己做的板，所以在布线的时候那那么专业，能用就好。
3.实物图
外观大概就这样，工作状态
4、说明
我是用的KT板面上贴了一层贴纸，把这些弄到了一起，自己准备在包装一下，做一个密码箱完全没有问题。可以用来放放自己的小秘密，哈哈哈 。
5、部分代码
按键模块的键值内容判断
#include &#34;key_control.h&#34; #include &#34;delay.h&#34; #include &#34;key.h&#34; #include &#34;12864.h&#34; #include &#34;Relay.h&#34; #include &#34;buzzer.h&#34; #include &#34;time.h&#34; #include &#34;24c02.h&#34; #include &#34;uln2003.h&#34; u8 password[]={0x30,0x30,0x30,0x30,0x30,0x30}; u8 new_password[]={0x30,0x30,0x30,0x30,0x30,0x30}; uchar display[]={0x2A,0x2A,0x2A,0x2A,0x2A,0x2A}; u8 nkv=0,sign=0,fkv,noe=0,Function_menu_flag=0,Move_down_flag=0, Move_up_flag=1,Revise_the_password_flag=0,New_password_flag=0, Number_of_new_passwords=0; u16 mc=1; extern uchar mima[]; extern u8 Countdown; void Key_Number(void) { u8 num=0,i; num=Key_Scan(); if(num==16&amp;&amp;Countdown==0&amp;&amp;GPIO_ReadOutputDataBit (GPIOB,GPIO_Pin_9)==1) //没有按键按下且没有开启定时器 没有黑屏 { mc&#43;&#43;; delay_ms(10); if(mc==1001) { mc=1; TIM3_Int_Init(9999,7199);//计时60S } if(mc==50001) mc=1; } if(num!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/52c44fab82be69afdf031797b71231e3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-03T11:21:12+08:00" />
<meta property="article:modified_time" content="2022-11-03T11:21:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">利用stm32做一个升级版的电子多功能密码锁</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>`自己利用空闲时间制作的电子密码锁，有PCB、原理图，PCB印制电路板。此设计用外部存储器，支持修改密码，本来想添加指纹识别模块，但是12864的数据口被使用了，gpio口不够用。在实际中我发现12864还是用串口比较好，因为用并口的话使用会影响同GPIO口的其他位口。毕竟是业余时间做的，可能在有些方面不是很完善。<br> 一、功能介绍：<br> 1、输入6位密码，即可开锁。<br> 2、输入7次纯数字，系统会自动恢复初始状态。<br> 3、没有输入完6位密码，按下确认键，系统不会应答。<br> 4、密码输入错误三次，锁定键盘并且蜂鸣器提醒10秒。<br> 5、输入错误可以退格、清零。<br> 6、开机后12864模块会有60秒定时显示，没操作键盘60秒后，清除数据并且恢复初始状态。如果在记时期间有按键按下，这停止倒计时，并且在没有操作键盘8秒左右，重新开启倒计时12864休眠功能。<br> 7、在功能模式下可以修改密码，也可以做其他功能选择（其他功能你们根据自身能力添加）。<br> 8、程序有密码数值存储在数组，可用于显示等操作。（修改密码时可以显示）<br> 9、有人体感应模块，感应到有人吗，并且12864处于关屏休眠模式下，即可打开12864屏幕。<br> 10、有外部存储器24C02，支持修改密码，密码断电不丢失。<br> 11、步进电机模块。<br> 12、继电器模块。<br> 13、温度模块，倒计时期间可以测量7805和1117芯片温度或者外部温度，并实时显示。<br> 二、资料展示<br> 1.原理图<br> <img src="https://images2.imgbox.com/f1/cc/tLfVqw3j_o.jpg" alt="在这里插入图片描述"><br> 2.PCB印制电路板<br> <img src="https://images2.imgbox.com/bc/bb/HX8xxAH7_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f8/a7/f6iT5iKq_o.jpg" alt="在这里插入图片描述"><br> 因为自己做的板，所以在布线的时候那那么专业，能用就好。</p> 
<p>3.实物图<br> <img src="https://images2.imgbox.com/3d/16/iu5qEilc_o.jpg" alt="在这里插入图片描述"><br> 外观大概就这样，工作状态<br> 4、说明<br> 我是用的KT板面上贴了一层贴纸，把这些弄到了一起，自己准备在包装一下，做一个密码箱完全没有问题。可以用来放放自己的小秘密，哈哈哈 。</p> 
<p>5、部分代码<br> 按键模块的键值内容判断</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"key_control.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"delay.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"key.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"12864.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Relay.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"buzzer.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"time.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"24c02.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"uln2003.h"</span></span>

u8 password<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

u8 new_password<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

uchar display<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">0x2A</span><span class="token punctuation">,</span><span class="token number">0x2A</span><span class="token punctuation">,</span><span class="token number">0x2A</span><span class="token punctuation">,</span><span class="token number">0x2A</span><span class="token punctuation">,</span><span class="token number">0x2A</span><span class="token punctuation">,</span><span class="token number">0x2A</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  

u8 nkv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>sign<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>fkv<span class="token punctuation">,</span>noe<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>Function_menu_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>Move_down_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
Move_up_flag<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>Revise_the_password_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>New_password_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
Number_of_new_passwords<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
u16 mc<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">extern</span> uchar mima<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">extern</span> u8 Countdown<span class="token punctuation">;</span>
 

<span class="token keyword">void</span> <span class="token function">Key_Number</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> 
<span class="token punctuation">{<!-- --></span>
u8 num<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token punctuation">;</span>
num<span class="token operator">=</span><span class="token function">Key_Scan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token operator">==</span><span class="token number">16</span><span class="token operator">&amp;&amp;</span>Countdown<span class="token operator">==</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span><span class="token function">GPIO_ReadOutputDataBit</span> <span class="token punctuation">(</span>GPIOB<span class="token punctuation">,</span>GPIO_Pin_9<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">//没有按键按下且没有开启定时器 没有黑屏 </span>
<span class="token punctuation">{<!-- --></span>
mc<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>mc<span class="token operator">==</span><span class="token number">1001</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	  mc<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	  <span class="token function">TIM3_Int_Init</span><span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">,</span><span class="token number">7199</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//计时60S</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>mc<span class="token operator">==</span><span class="token number">50001</span><span class="token punctuation">)</span>
	  mc<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token operator">!=</span><span class="token number">16</span><span class="token operator">&amp;&amp;</span>num<span class="token operator">&lt;=</span><span class="token number">9</span><span class="token punctuation">)</span>  <span class="token comment">//数字键按下 </span>
	<span class="token punctuation">{<!-- --></span>
	  <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	  <span class="token function">TIM3_STOP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//停止计时</span>
		Countdown<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>       <span class="token comment">//计时标志位清零</span>
		<span class="token function">Key_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mc<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
		sign<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>          <span class="token comment">//按键标识标志位</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>Function_menu_flag<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>                <span class="token comment">//功能标志位</span>
	    <span class="token punctuation">{<!-- --></span>
		  nkv<span class="token operator">++</span><span class="token punctuation">;</span>                                 <span class="token comment">//数字按键次数标志位</span>
		  <span class="token keyword">if</span><span class="token punctuation">(</span>nkv<span class="token operator">==</span><span class="token number">7</span><span class="token punctuation">)</span>
		  <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"      "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
		 <span class="token comment">//buzzer_On_off();</span>
		   <span class="token function">LCD_Display_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>display<span class="token punctuation">,</span>nkv<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//显示*号</span>
           <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span>nkv<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nkv<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>             <span class="token comment">//´存储密码</span>
		   password<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>num<span class="token operator">+</span><span class="token number">0x30</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token function">Key_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Function_menu_flag<span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>Revise_the_password_flag<span class="token operator">==</span><span class="token number">1</span><span class="token operator">||</span>New_password_flag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{<!-- --></span>
	  nkv<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token comment">//buzzer_On_off();</span>
	  <span class="token function">LCD_Display_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>display<span class="token punctuation">,</span>nkv<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span>nkv<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nkv<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>          
	    password<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>num<span class="token operator">+</span><span class="token number">0x30</span><span class="token punctuation">;</span>
	  <span class="token function">Key_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token operator">!=</span><span class="token number">16</span><span class="token operator">&amp;&amp;</span>num<span class="token operator">&gt;</span><span class="token number">9</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
	  Countdown<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	  <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	  <span class="token function">Key_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	  <span class="token function">TIM3_STOP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      mc<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>             
	  sign<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>         
	  fkv<span class="token operator">=</span>num<span class="token punctuation">;</span>         <span class="token comment">//功能按键记下</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>按键内容判断处理函数</p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">Key_Function</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
  u8 h<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  uint i<span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>sign<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token comment">//如果是功能按键按下</span>
   <span class="token punctuation">{<!-- --></span>
     <span class="token keyword">switch</span><span class="token punctuation">(</span>fkv<span class="token punctuation">)</span>
      <span class="token punctuation">{<!-- --></span>
	   <span class="token keyword">case</span> <span class="token number">15</span><span class="token operator">:</span>            <span class="token comment">//功能键							                  </span>
	    <span class="token punctuation">{<!-- --></span>													
	      <span class="token keyword">switch</span><span class="token punctuation">(</span>New_password_flag<span class="token punctuation">)</span>   <span class="token comment">//新密码标志位                </span>
		   <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>	  												
			 <span class="token punctuation">{<!-- --></span>											
			  <span class="token keyword">if</span><span class="token punctuation">(</span>nkv<span class="token operator">==</span><span class="token number">6</span><span class="token punctuation">)</span>           <span class="token comment">//已经输入了6位密码											 </span>
			   <span class="token punctuation">{<!-- --></span>	
			    nkv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
				 <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">6</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>         <span class="token comment">//比较密码</span>
				  <span class="token punctuation">{<!-- --></span>
				   <span class="token keyword">if</span><span class="token punctuation">(</span>mima<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>password<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>															  
				    <span class="token punctuation">{<!-- --></span>
					  h<span class="token operator">++</span><span class="token punctuation">;</span>
					  <span class="token keyword">if</span><span class="token punctuation">(</span>h<span class="token operator">==</span><span class="token number">6</span><span class="token punctuation">)</span>
					   <span class="token punctuation">{<!-- --></span>
					    <span class="token keyword">switch</span> <span class="token punctuation">(</span>Revise_the_password_flag<span class="token punctuation">)</span>  <span class="token comment">//修改密码标志位</span>
						 <span class="token punctuation">{<!-- --></span>
						  <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>                             
						   <span class="token punctuation">{<!-- --></span>
							 <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"      "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							 <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"Open!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
                             <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"      "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							 <span class="token function">Relay_on</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							 <span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              
							 <span class="token function">Relay_off</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//继电器开锁</span>
							 noe<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>                  <span class="token comment">//错误次数清零 </span>
							 <span class="token function">ULN2003_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//步进电机模块</span>
							 <span class="token function">Unlocking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						   <span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span> 
	                     <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>                           
						   <span class="token punctuation">{<!-- --></span>
							 <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"      "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							 <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"yes ok"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                             <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"ÐÂÃÜÂë:         "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							 New_password_flag<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>	         <span class="token comment">// 新密码标志位</span>
							<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
						 <span class="token punctuation">}</span>
					   <span class="token punctuation">}</span>
				    <span class="token punctuation">}</span> 
				<span class="token keyword">else</span>    <span class="token comment">//密码输入错误</span>
				 <span class="token punctuation">{<!-- --></span>
				    <span class="token keyword">switch</span> <span class="token punctuation">(</span>Revise_the_password_flag<span class="token punctuation">)</span>    
					 <span class="token punctuation">{<!-- --></span>
					   <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>                          
						 <span class="token punctuation">{<!-- --></span>
						   h<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
						   <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"      "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                           <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"Error!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                           <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"      "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						   <span class="token function">buzzer_On_off</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						   noe<span class="token operator">++</span><span class="token punctuation">;</span>                      
						   <span class="token keyword">if</span><span class="token punctuation">(</span>noe<span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span>
							<span class="token punctuation">{<!-- --></span>
							 noe<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		                     <span class="token function">TIM2_Int_Init</span><span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">,</span><span class="token number">7199</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//十秒倒计时</span>
							 <span class="token function">Time2_10_seconds_countdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						 <span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
																				
					  <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>           <span class="token comment">//在修改密码中</span>
						<span class="token punctuation">{<!-- --></span>
						  h<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
						  <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"      "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                          <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"Error!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						  <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"      "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						  <span class="token function">buzzer_On_off</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
				  <span class="token punctuation">}</span>
				 <span class="token punctuation">}</span>
			 <span class="token punctuation">}</span>
		 <span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
															
			<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>	                               
			 <span class="token punctuation">{<!-- --></span>	
				<span class="token keyword">if</span><span class="token punctuation">(</span>nkv<span class="token operator">==</span><span class="token number">6</span><span class="token punctuation">)</span> 
				 <span class="token punctuation">{<!-- --></span>
				   nkv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
                   Number_of_new_passwords<span class="token operator">++</span><span class="token punctuation">;</span>           
				   <span class="token keyword">switch</span><span class="token punctuation">(</span>Number_of_new_passwords<span class="token punctuation">)</span>      
					<span class="token punctuation">{<!-- --></span>
					  <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
						<span class="token punctuation">{<!-- --></span>
               		      <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"        "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                          <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">6</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
                          new_password<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>password<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>     
						<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
					  <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>                           
						<span class="token punctuation">{<!-- --></span>
						  <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">6</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
							<span class="token punctuation">{<!-- --></span>
							  <span class="token keyword">if</span><span class="token punctuation">(</span>password<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>new_password<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>  
								<span class="token punctuation">{<!-- --></span>
									h<span class="token operator">++</span><span class="token punctuation">;</span>
									<span class="token keyword">if</span><span class="token punctuation">(</span>h<span class="token operator">==</span><span class="token number">6</span><span class="token punctuation">)</span>                         
									  <span class="token punctuation">{<!-- --></span>
                                        <span class="token function">AT24CXX_Write</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">(</span>u8<span class="token operator">*</span><span class="token punctuation">)</span>new_password<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       								    <span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
										<span class="token function">AT24CXX_Read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>mima<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
								        <span class="token function">LCD_Display_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>new_password<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							       <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"ÐÞ¸ÄÃÜÂë³É¹¦£¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 														        
							      <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"                "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
								 <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"                "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>												       
								 <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"password: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
										 Function_menu_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//</span>
								         Move_down_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>     
										 Revise_the_password_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>      
								         New_password_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>       
							             Number_of_new_passwords<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>     												 
										<span class="token punctuation">}</span>
								 <span class="token punctuation">}</span>
								<span class="token keyword">else</span>
								 <span class="token punctuation">{<!-- --></span>
									<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"        "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
									<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"Error!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
								    <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"        "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>															                        
								    Number_of_new_passwords<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> 
								    <span class="token keyword">break</span><span class="token punctuation">;</span>
							     <span class="token punctuation">}</span>
							  <span class="token punctuation">}</span>
							<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>																	
				<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">switch</span><span class="token punctuation">(</span>Move_down_flag<span class="token punctuation">)</span>                  
			 <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
				 <span class="token punctuation">{<!-- --></span>
					<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"                "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"                "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"¹¦ÄÜ:   ÐÞ¸ÄÃÜÂë"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"Ô­ÃÜÂë£º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				    Move_down_flag<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>                 
					Revise_the_password_flag<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>        
				 <span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
			 <span class="token punctuation">}</span>
	     <span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>	
	<span class="token keyword">case</span> <span class="token number">14</span><span class="token operator">:</span>                                     
	 <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">switch</span><span class="token punctuation">(</span>Revise_the_password_flag<span class="token punctuation">)</span>         
		 <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
			 <span class="token punctuation">{<!-- --></span>
				 <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"      "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				 nkv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
			 <span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
			 <span class="token punctuation">{<!-- --></span>
				<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"      "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				nkv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>	
			<span class="token punctuation">}</span>
       <span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
     <span class="token keyword">case</span> <span class="token number">11</span><span class="token operator">:</span>                             
	  <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">switch</span><span class="token punctuation">(</span>Revise_the_password_flag<span class="token punctuation">)</span>
		 <span class="token punctuation">{<!-- --></span>
		   <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
			 <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>nkv<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
				<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"      "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nkv<span class="token operator">==</span><span class="token number">2</span><span class="token operator">||</span>nkv<span class="token operator">==</span><span class="token number">4</span><span class="token operator">||</span>nkv<span class="token operator">==</span><span class="token number">6</span><span class="token punctuation">)</span>
				 <span class="token punctuation">{<!-- --></span>
					i<span class="token operator">=</span>nkv<span class="token operator">/</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
					<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">+</span>i<span class="token punctuation">,</span><span class="token string">"* "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				 <span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nkv<span class="token operator">==</span><span class="token number">3</span><span class="token operator">||</span>nkv<span class="token operator">==</span><span class="token number">5</span><span class="token punctuation">)</span>
				 <span class="token punctuation">{<!-- --></span>
					i<span class="token operator">=</span>nkv<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
					<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">+</span>i<span class="token punctuation">,</span><span class="token string">"  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				 <span class="token punctuation">}</span>
				nkv<span class="token operator">--</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>											 
			<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
			 <span class="token punctuation">{<!-- --></span>
				 <span class="token keyword">if</span><span class="token punctuation">(</span>nkv<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
		         <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"      "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				 <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nkv<span class="token operator">==</span><span class="token number">2</span><span class="token operator">||</span>nkv<span class="token operator">==</span><span class="token number">4</span><span class="token operator">||</span>nkv<span class="token operator">==</span><span class="token number">6</span><span class="token punctuation">)</span>
				  <span class="token punctuation">{<!-- --></span>
					i<span class="token operator">=</span>nkv<span class="token operator">/</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
					<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">+</span>i<span class="token punctuation">,</span><span class="token string">"* "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				  <span class="token punctuation">}</span>
				 <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nkv<span class="token operator">==</span><span class="token number">3</span><span class="token operator">||</span>nkv<span class="token operator">==</span><span class="token number">5</span><span class="token punctuation">)</span>
				  <span class="token punctuation">{<!-- --></span>
					i<span class="token operator">=</span>nkv<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
				    <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">+</span>i<span class="token punctuation">,</span><span class="token string">"  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				  <span class="token punctuation">}</span> 
				  nkv<span class="token operator">--</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> 
		<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">13</span><span class="token operator">:</span>                                      
		 <span class="token punctuation">{<!-- --></span> 
		   <span class="token keyword">if</span><span class="token punctuation">(</span>nkv<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
			 <span class="token punctuation">{<!-- --></span>
				 Move_down_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>                    
				 Function_menu_flag<span class="token operator">++</span><span class="token punctuation">;</span>              
				 <span class="token keyword">switch</span><span class="token punctuation">(</span>Function_menu_flag<span class="token punctuation">)</span>      
		          <span class="token punctuation">{<!-- --></span>
					 <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
					  <span class="token punctuation">{<!-- --></span>
						<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"        "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"²Ëµ¥: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">"&gt;&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					    <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">"¼ÆËãÆ÷"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">"ÃÜÂëËø"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					  <span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
					<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
					  <span class="token punctuation">{<!-- --></span>
						<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"                "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"                "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"password:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						Function_menu_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
						Move_down_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
						Revise_the_password_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
						New_password_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
						Number_of_new_passwords<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
					  <span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">10</span><span class="token operator">:</span>                                    <span class="token comment">//ÏÂÒÆ</span>
			  <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>Function_menu_flag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
			     <span class="token punctuation">{<!-- --></span>
					<span class="token keyword">switch</span><span class="token punctuation">(</span>Move_down_flag<span class="token punctuation">)</span>
					 <span class="token punctuation">{<!-- --></span>
						<span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
						 <span class="token punctuation">{<!-- --></span>
						   Move_down_flag<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
						   <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">"  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						   <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">"&gt;&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			 <span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">12</span><span class="token operator">:</span>                                         <span class="token comment">//ÉÏÒÆ</span>
			 <span class="token punctuation">{<!-- --></span> 
				<span class="token keyword">if</span><span class="token punctuation">(</span>Function_menu_flag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
				 <span class="token punctuation">{<!-- --></span>
				   <span class="token keyword">switch</span><span class="token punctuation">(</span>Move_down_flag<span class="token punctuation">)</span>
					 <span class="token punctuation">{<!-- --></span>
						<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
						 <span class="token punctuation">{<!-- --></span>
						   Move_down_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
				           <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">"&gt;&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						   <span class="token function">LCD_Display_Specify_Words</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">"  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						 <span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>
					 <span class="token punctuation">}</span>
				 <span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token keyword">break</span><span class="token punctuation">;</span>									
		<span class="token punctuation">}</span>
	fkv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> 				
	<span class="token function">Key_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
          
<span class="token keyword">void</span> <span class="token function">open_close</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>                                     
<span class="token punctuation">{<!-- --></span>
	Function_menu_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>  
	Move_down_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>     
	Revise_the_password_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    
    New_password_flag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>            
	Number_of_new_passwords<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	nkv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	fkv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>代码太多了，我把主要的按键综合代码写出来了，上面的注释看不到，可以程序里面看。在资料里有单独的DS18B20、24c02、定时器的一些单一代码，直接修改一下就能移植。</p> 
<p>三、最后说几句<br> 1、有电子相关专业（专科）的同学们，可以用这个作为毕业设计，可以去掉步进电机，再添加一个指纹模块后，应该能够通过。<br> 2、我原本想用指纹模块来控制步进电机来打开老式的拉锁，现在我还没有试，不知道能不能成功。<br> 3、因为我的按键模块、12864模块、DS18B20之间的gpio口有点干扰，因为矩阵键盘的列需要输入探测是用了一整个GPIO的操作函数，所以用了它后，另外两个它也会受到影响。<br> 4、资料里包含了四个文件夹，PCB设计、程序、串口调试工具、资料（相关芯片，外设的资料）</p> 
<p>5、在密码锁的基础上 我又增加了一项功能，利用18B20制作的自动控温功能：第一个是温度到达30度，风扇自动开启，并且持续降温，直到温度降到20度，风扇就停止转动。第二个是可以自己设置温度，到达温度后自动停止降温。本来我还想再添加一个控制暖风机工作的功能，但是由于我的继电器在设计之初，就没有考虑用交流电设备，所以继电器不能用来控制强电。而且我的电源和地线的布线宽度有点低，只有30mil，PTC的加热片的瞬间功率能达到13A之多，所以无奈只能取消此功能。但是也是可以通过修改PCB的线路来搞定，有点复杂我也没有去做。但是也可以外接继电器模块来达到控制家用220V电器，有时间了我在继续更新！<br> 实物图：<br> <img src="https://images2.imgbox.com/29/29/k1PdwU01_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e7/fe/OLykh2Yn_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e5/e3/Or1KbyMM_o.jpg" alt="在这里插入图片描述"></p> 
<p>现在我附上我的控温的视频：<br> 1.自定义温度控温：https://www.bilibili.com/video/BV1HY411x7tM/（哔哩哔哩）<br> 2.30度自控温：https://v点douyin点com/R9g398R/</p> 
<p>完整资料下载：<br> https://download.csdn.net/download/qq_31309951/39573366</p> 
<p>2021年12月6日更新<br> 我之前说的控制强电设备，现在已经可以了，我重新弄了一块小的继电器PCB板，就可用用我的继电器输出口提供12V的电源来控制下一级继电器工作，从而达到控制暖风机这种家用220V的电器。<br> 新的继电器PCB板<br> <img src="https://images2.imgbox.com/15/4d/1QTS0qz4_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7a/f8/RSQmh4Vp_o.jpg" alt="在这里插入图片描述"><br> 实物图<br> <img src="https://images2.imgbox.com/39/55/U721Eu1A_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/62/2d/TrrXjoCz_o.jpg" alt="在这里插入图片描述"></p> 
<p>视频链接：https://www.bilibili.com/video/BV1rr4y1k7Ve/（哔哩哔哩）</p> 
<p>2022年10月19日更新<br> 这次把操作界面修改了一下，第一增加了初次使用的设置，修改了电子密码锁的判断机制，增加了管理员密码，通过管理员密码才能修改密码或者指纹管理，后续还可以增加其他功能。第二增加了系统掉电信息存储，在增加了其他功能以后，就可以达到断电后，再次上电直接恢复到断电前的功能界面。由于现在没有添加，显示效果不明显。<br> 现在程序还在完善中，先发布一下视频吧。大神们可以给给建议。<br> 这次给它制作了一个稍微好点的外壳，3D打印的，虽说是边角料搞得，还是一般化，先将就着。<br> 视频如下<br> </p> 
<div class="csdn-video-box"> 
 <iframe id="KBFwuTbz-1666184225223" frameborder="0" src="https://live.csdn.net/v/embed/246856" allowfullscreen="true" data-mediaembed="csdn"></iframe> 
 <p>基于stm32的多功能电子密码系统</p> 
</div> 
<p></p> 
<p>2022年11月3日更新<br> 1、增加指纹识别功能<br> 演示演示</p> 
<p></p> 
<div class="csdn-video-box"> 
 <iframe id="JekSYSwp-1667445531293" frameborder="0" src="https://live.csdn.net/v/embed/250789" allowfullscreen="true" data-mediaembed="csdn"></iframe> 
 <p>整体演示</p> 
</div> 
<p></p> 
<p>资料下载地址：https://download.csdn.net/download/qq_31309951/86888094</p> 
<p>此贴后续会持续更新<br> 接下来将会新开贴，分享制作的语音控制设备。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/00a4ef99d40f8369635f893fbb9d065e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">InfluxDB学习记录（二）——influxdb的关键概念</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f98f2515f542795bbe7b0384bd1dfed4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Scroll View到达底部加载新页</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>