<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>hive和spark-sql中 日期和时间相关函数 测试对比 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="hive和spark-sql中 日期和时间相关函数 测试对比" />
<meta property="og:description" content="测试版本： hive 2.3.4 spark 3.1.1 hadoop 2.7.7
1、增加月份 add_months(timestamp date, int months)add_months(timestamp date, bigint months)Return type: timestampusage:add_months(now(),1) 2、增加日期 adddate(timestamp startdate, int days),adddate(timestamp startdate, bigint days)Return type: timestampusage:adddate(now(),1) 3、当前时间戳 current_timestamp()和now()等价 4、日期相减 datediff(string enddate, string startdate)Return type: intusage:datediff(&#34;2018-08-05&#34;, &#34;2018-08-03&#34;) 5、得到天，得到月份 day(string date)Return type: intusage: day(&#34;2018-08-05&#34;) 6、得到星期英文 dayname(string date)Return type: stringusage:dayname(&#34;2018-08-05&#34;) Sunday 7、得到这一天是这周的第几天 dayofweek(string date) 1 (Sunday) to 7 (Saturday).Return type: intusage:dayofweek(&#34;2018-08-06&#34;) 8、加天数和减天数 1）days_add(timestamp startdate, int days)
Return type: timestampusage:days_add(now(),2) 2）、days_sub(timestamp startdate, int days)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/5fe3ce65430472d0e1602d552a6840ea/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-12T11:21:40+08:00" />
<meta property="article:modified_time" content="2023-11-12T11:21:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">hive和spark-sql中 日期和时间相关函数 测试对比</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>测试版本：</h3> 
<p>hive 2.3.4      spark 3.1.1  hadoop 2.7.7</p> 
<h3 id="E2EAECEB">1、增加月份</h3> 
<ul><li>add_months(timestamp date, int months)</li><li>add_months(timestamp date, bigint months)</li><li>Return type: timestamp</li><li>usage:add_months(now(),1)</li></ul> 
<p><img alt="" height="79" src="https://images2.imgbox.com/f6/14/4t4xZbiV_o.png" width="531"></p> 
<p><img alt="" height="136" src="https://images2.imgbox.com/4f/92/ksz40f5L_o.png" width="697"></p> 
<h3 id="E2EAE7EC"><s>2、增加日期</s></h3> 
<ul><li><s>adddate(timestamp startdate, int days),</s></li><li><s>adddate(timestamp startdate, bigint days)</s></li><li><s>Return type: timestamp</s></li><li><s>usage:adddate(now(),1)</s></li></ul> 
<p><img alt="" height="70" src="https://images2.imgbox.com/5e/cc/XSHHnRNA_o.png" width="1200"></p> 
<p><img alt="" height="96" src="https://images2.imgbox.com/10/8e/gi87zs5Y_o.png" width="759"></p> 
<h3 id="EDE9E7E7">3、当前时间戳</h3> 
<ul><li>current_timestamp()和now()等价</li></ul> 
<p><img alt="" height="73" src="https://images2.imgbox.com/79/0b/Os2RdfVk_o.png" width="550"></p> 
<p><img alt="" height="136" src="https://images2.imgbox.com/d3/8e/IykLZyG5_o.png" width="744"></p> 
<h3 id="E7ECEBE7">4、日期相减</h3> 
<ul><li>datediff(string enddate, string startdate)</li><li>Return type: int</li><li>usage:datediff("2018-08-05", "2018-08-03")</li></ul> 
<p><img alt="" height="88" src="https://images2.imgbox.com/25/0e/pnkyi1lH_o.png" width="637"></p> 
<p><img alt="" height="121" src="https://images2.imgbox.com/ae/9a/hNWioJPk_o.png" width="558"></p> 
<h3 id="EEEEEEEE">5、得到天，得到月份</h3> 
<ul><li>day(string date)</li><li>Return type: int</li><li>usage: day("2018-08-05")</li></ul> 
<p><img alt="" height="138" src="https://images2.imgbox.com/86/f3/wJAZPtX3_o.png" width="495"></p> 
<p><img alt="" height="193" src="https://images2.imgbox.com/46/40/CxMDJg6Y_o.png" width="523"></p> 
<h3 id="E98E99EB"><s>6、得到星期英文</s></h3> 
<ul><li><s>dayname(string date)</s></li><li><s>Return type: string</s></li><li><s>usage:dayname("2018-08-05") Sunday</s></li></ul> 
<p><img alt="" height="76" src="https://images2.imgbox.com/e0/0e/qgOwf9Wt_o.png" width="1131"></p> 
<p><img alt="" height="57" src="https://images2.imgbox.com/67/56/NItQvSWg_o.png" width="760"></p> 
<h3 id="E8E4E1E7">7、得到这一天是这周的第几天</h3> 
<ul><li>dayofweek(string date)  <strong><span style="color:#fe2c24;"> 1 (Sunday) to 7 (Saturday).</span></strong></li><li>Return type: int</li><li>usage:dayofweek("2018-08-06")</li></ul> 
<p><img alt="" height="70" src="https://images2.imgbox.com/65/f1/xydCs8Y4_o.png" width="508"></p> 
<p><img alt="" height="91" src="https://images2.imgbox.com/ed/67/u0h0F48f_o.png" width="502"></p> 
<p><img alt="" height="415" src="https://images2.imgbox.com/12/06/iDHl1nfY_o.png" width="517"></p> 
<h3 id="E8AEAAE9">8、加天数和减天数</h3> 
<p>1）days_add(timestamp startdate, int days)</p> 
<ul><li>Return type: timestamp</li><li>usage:days_add(now(),2)</li></ul> 
<p>2）、days_sub(timestamp startdate, int days)</p> 
<ul><li>Return type: timestamp</li><li>usage:days_sub(now(), 2)</li></ul> 
<p><img alt="" height="136" src="https://images2.imgbox.com/e9/a1/Tu2cwcyW_o.png" width="514"></p> 
<p><img alt="" height="186" src="https://images2.imgbox.com/0f/45/AL374KCy_o.png" width="531"></p> 
<h3 id="E0ECECE7">9、格式化日期</h3> 
<ul><li>from_unixtime(bigint unixtime[, string format])</li><li>Return type: string</li></ul> 
<h4 id="E3E4EFE5">注意参数</h4> 
<ul><li>usage:from_unixtime(1392394861,"yyyy-MM-dd");</li></ul> 
<p><img alt="" height="78" src="https://images2.imgbox.com/be/13/LRoVWu5L_o.png" width="742"></p> 
<p><img alt="" height="175" src="https://images2.imgbox.com/a8/96/uXKFV7HZ_o.png" width="706"></p> 
<h3 id="EEE8E0E7" style="background-color:transparent;">10、得到小时</h3> 
<ul><li>hour(string date)</li><li>Return type: int</li><li>usage:hour("2018-08-06 12:32:54")</li></ul> 
<p><img alt="" height="72" src="https://images2.imgbox.com/96/50/Eh3yK6tN_o.png" width="523"></p> 
<p><img alt="" height="93" src="https://images2.imgbox.com/92/4b/o9gvvp5I_o.png" width="519"></p> 
<h3 id="E2EAE0E7"><s>11、增加小时 和 减少小时</s></h3> 
<p><s>1）、hours_add(timestamp date, int hours)</s></p> 
<ul><li><s>Return type: timestamp</s></li><li><s>usage:hours_add(now(),2)</s></li></ul> 
<p><s>2）、hours_sub(timestamp date, int hours)</s></p> 
<ul><li><s>Return type: timestamp</s></li><li><s>usage:hours_sub(now(),2)</s></li></ul> 
<p><img alt="" height="270" src="https://images2.imgbox.com/9a/95/5lvLqAjh_o.png" width="1200"></p> 
<p><img alt="" height="145" src="https://images2.imgbox.com/07/1b/Bn2FM3gE_o.png" width="781"></p> 
<h3 id="EEE8E8E2">12、得到分钟</h3> 
<ul><li>minute(string date)</li><li>Return type: int</li><li>usage:minute(now())</li></ul> 
<p></p> 
<p><img alt="" height="136" src="https://images2.imgbox.com/b9/2f/zQldK6DQ_o.png" width="529"></p> 
<p><img alt="" height="162" src="https://images2.imgbox.com/a4/e3/uDdddZxV_o.png" width="745"></p> 
<h3 id="E2EAE8E2">13、增加分钟和减少分钟</h3> 
<p><s>1）、minutes_add(timestamp date, int minutes)</s></p> 
<ul><li><s>Return type: timestamp</s></li><li><s>usage:minutes_add(now(),2)</s></li></ul> 
<p><s>2）、minutes_sub(timestamp date, int minutes)</s></p> 
<ul><li><s>Return type: timestamp</s></li><li><s>usage:minutes_sub(now(),2)</s></li></ul> 
<p></p> 
<p><img alt="" height="294" src="https://images2.imgbox.com/a8/ba/KQqsPnoG_o.png" width="1200"></p> 
<p><img alt="" height="121" src="https://images2.imgbox.com/9b/01/xYosf5vw_o.png" width="790"></p> 
<h3 id="EEE8ECEB">14、得到月份</h3> 
<ul><li>month(string date)</li><li>Return type: int</li><li>usage:month("2018-08-06 12:32:54")</li></ul> 
<p></p> 
<h3 id="ECEBEBEA"><s>15、月份相加和减月份</s></h3> 
<p><s>1）、months_add(timestamp date, int months)</s></p> 
<ul><li><s>Return type: timestamp</s></li><li><s>usage:months_add(now(),3)</s></li></ul> 
<p><s>2）、months_sub(timestamp date, int months)</s></p> 
<ul><li><s>Return type: timestamp</s></li><li><s>months_sub(now(),3)</s></li></ul> 
<p><img alt="" height="138" src="https://images2.imgbox.com/8d/09/KUH4HdUv_o.png" width="1200"></p> 
<p><img alt="" height="147" src="https://images2.imgbox.com/ac/4a/mxttIjoy_o.png" width="781"></p> 
<h3 id="EB9E8BEA">16、得到秒</h3> 
<ul><li>second(string date)</li><li>Return type: int</li></ul> 
<p><img alt="" height="76" src="https://images2.imgbox.com/a9/98/ETh6AbwP_o.png" width="516"></p> 
<p><img alt="" height="141" src="https://images2.imgbox.com/68/ed/O9lJ0VEm_o.png" width="735"></p> 
<h3 id="E7A9E8AA"><s>17、秒加 和 秒减</s></h3> 
<p><s>1）、seconds_add(timestamp date, int seconds)</s></p> 
<ul><li><s>Return type: timestamp</s></li></ul> 
<p><s>2）、seconds_sub(timestamp date, int seconds)</s></p> 
<ul><li><s>Return type: timestamp</s></li></ul> 
<p><img alt="" height="216" src="https://images2.imgbox.com/63/61/C24MDFgG_o.png" width="1200"></p> 
<p><img alt="" height="96" src="https://images2.imgbox.com/51/d4/trYqapvk_o.png" width="790"></p> 
<h3 id="EEE8E7EC" style="background-color:transparent;">18、得到日期</h3> 
<ul><li>to_date(now())</li></ul> 
<p><img alt="" height="139" src="https://images2.imgbox.com/f9/f9/3QitoG02_o.png" width="625"></p> 
<p><img alt="" height="265" src="https://images2.imgbox.com/b1/30/w7c3Aw2W_o.png" width="715"></p> 
<h3 id="E981EBBE">19、得到1970到今秒</h3> 
<ul><li>unix_timestamp(),</li><li>unix_timestamp(string datetime),</li><li>unix_timestamp(string datetime, string format),</li><li>unix_timestamp(timestamp datetime)</li><li>Return type: bigint</li></ul> 
<p><img alt="" height="264" src="https://images2.imgbox.com/8e/16/VEUc131n_o.png" width="700"></p> 
<p><img alt="" height="384" src="https://images2.imgbox.com/77/fc/nO0vRdFV_o.png" width="738"></p> 
<h3 id="E89EBBEB">20、得到这周是这年的多少周</h3> 
<ul><li>weekofyear(string date)</li><li>Return type: int</li><li>usage:weekofyear("2018-08-06 12:32:54")</li></ul> 
<p><img alt="" height="73" src="https://images2.imgbox.com/03/9f/KyHn7Y29_o.png" width="538"></p> 
<p><img alt="" height="96" src="https://images2.imgbox.com/54/6b/o5LSFP3Q_o.png" width="534"></p> 
<h3 id="E59AE8AA"><s>21、周加  和 周减</s></h3> 
<p><s>1）、weeks_add(timestamp date, int weeks)</s></p> 
<ul><li><s>Return type: timestamp</s></li><li><s>usage:weeks_add("2018-08-06 12:32:54", 1)</s></li></ul> 
<p><s>2）、weeks_sub(timestamp date, int weeks)</s></p> 
<ul><li><s>Return type: timestamp</s></li><li><s>usage:weeks_sub("2018-08-06 12:32:54", 1)</s></li></ul> 
<p><img alt="" height="133" src="https://images2.imgbox.com/ad/b6/OAYi3poi_o.png" width="1069"></p> 
<p><img alt="" height="97" src="https://images2.imgbox.com/6e/17/6MiEnHH7_o.png" width="828"></p> 
<h3 id="EB9E8BEB">22、得到年</h3> 
<ul><li>year(string date)</li><li>Return type: int</li></ul> 
<p><img alt="" height="79" src="https://images2.imgbox.com/09/d1/KJAgRCme_o.png" width="514"></p> 
<p><img alt="" height="93" src="https://images2.imgbox.com/90/2f/auw8T8NZ_o.png" width="498"></p> 
<h3 id="E5BBE8AA"><s>23、年加 和 年减</s></h3> 
<p><s>1）、years_add(timestamp date, int years)</s></p> 
<ul><li><s>Return type: timestamp</s></li></ul> 
<p><s>2）、years_sub(timestamp date, int years)</s></p> 
<ul><li><s>Return type: timestamp</s></li></ul> 
<p><img alt="" height="136" src="https://images2.imgbox.com/d3/94/XTnkCO4V_o.png" width="1074"></p> 
<p><img alt="" height="97" src="https://images2.imgbox.com/47/01/aHj8aoRt_o.png" width="748"></p> 
<p>参考：<a href="https://www.wenjiangs.com/article/hive-riqi-hanshu.html" rel="nofollow" title="hive 日期函数 - 文章教程 - 文江博客">hive 日期函数 - 文章教程 - 文江博客</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b361cc19603270b4bf25c73f5f51cd52/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CIFAR-100数据集的加载和预处理教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f43c4752ce904fe8c7f9e9da5fc4f47b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何判断从本机上传到服务器的文件数据内容是一致的？用md5加密算法！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>