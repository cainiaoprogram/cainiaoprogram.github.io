<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>OBCP理论考题型易错点汇总 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="OBCP理论考题型易错点汇总" />
<meta property="og:description" content="默认超时类（单位都是微妙）：
单条 SQL 执行超时时间，由租户变量 ob_query_timeout控制。单位是微秒，默认是10秒。
单个事务的空闲超时时间是多少，由租户变量 ob_trx_idle_timeout控制。单位是微秒，默认120秒。
事务超时时间，由租户变量 ob_trx_timeout控制。单位是微秒，默认100秒。
备份恢复
日志归档是定期备份到备份目的端的，只需要用户发起一次 alter system archivelog，日志备份就会在后台持续进行。
错误码：
0001-3999 mysql错误码
大于4000是OB特有错误码
视图：
1、确定是通过绑定的 Outline 生成的计划后，需要确定生成的计划是否符合预期，可以通过查询 “gvKaTeX parse error: Expected group after &#39;_&#39; at position 64: …形状，具体查看方式可参考 2、_̲_all_rootservic…plan_cache_plan_stat和gvKaTeX parse error: Expected group after &#39;_&#39; at position 21: …udit可以排查慢sql 4、_̲_all_zone,__all…memory和__all_virtual_memory_info记录内存各模块使用情况，gv$memstore记录各租户memstore内存使用情况
8、__all_virtual_server_stat查看OB集群内各个服务器已分配的资源用量
参数/变量类：
1、merge_check_interval：每个 Zone 的合并进度检查间隔。
2、trace_log_slow_query_watermark 用于设置查询的执行时间阈值，如果查询的执行时间超过该阈值，则被认为是慢查询，慢查询的追踪日志会被打印到系统日志中。
3、enable_sql_audit和trace_log_slow_query_watermark不属于变量
负载均衡类：
1、租户级的 primary_zone 不能为空，如果创建时未指定 primary_zone，默认填写成 RANDOM，表示各个 Zone 优先级相同
状态类：
1、注意停止observer的状态也是active，但是stop_time&gt;0
2、zone的状态只有active和inactive，删除后是无状态
OBProxy类：
1、一台机器上可以部署多个OBproxy，但是需要指定不同的端口
2、生产环境下，可以通过config url启动，或者守护进程
3、测试模式下，通过rslist启动" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8ba424bb3cf8026ef204ee8b261fb94e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-21T17:31:11+08:00" />
<meta property="article:modified_time" content="2023-07-21T17:31:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">OBCP理论考题型易错点汇总</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>默认超时类（单位都是微妙）：<br> 单条 SQL 执行超时时间，由租户变量 ob_query_timeout控制。单位是微秒，默认是10秒。<br> 单个事务的空闲超时时间是多少，由租户变量 ob_trx_idle_timeout控制。单位是微秒，默认120秒。<br> 事务超时时间，由租户变量 ob_trx_timeout控制。单位是微秒，默认100秒。</p> 
<p>备份恢复<br> 日志归档是定期备份到备份目的端的，只需要用户发起一次 alter system archivelog，日志备份就会在后台持续进行。</p> 
<p>错误码：<br> 0001-3999 mysql错误码<br> 大于4000是OB特有错误码</p> 
<p>视图：<br> 1、确定是通过绑定的 Outline 生成的计划后，需要确定生成的计划是否符合预期，可以通过查询 “gv<span class="katex--inline">KaTeX parse error: Expected group after '_' at position 64: …形状，具体查看方式可参考 2、_̲_all_rootservic…</span>plan_cache_plan_stat和gv<span class="katex--inline">KaTeX parse error: Expected group after '_' at position 21: …udit可以排查慢sql 4、_̲_all_zone,__all…</span>memory和__all_virtual_memory_info记录内存各模块使用情况，gv$memstore记录各租户memstore内存使用情况<br> 8、__all_virtual_server_stat查看OB集群内各个服务器已分配的资源用量</p> 
<p>参数/变量类：<br> 1、merge_check_interval：每个 Zone 的合并进度检查间隔。<br> 2、trace_log_slow_query_watermark 用于设置查询的执行时间阈值，如果查询的执行时间超过该阈值，则被认为是慢查询，慢查询的追踪日志会被打印到系统日志中。<br> 3、enable_sql_audit和trace_log_slow_query_watermark不属于变量</p> 
<p>负载均衡类：<br> 1、租户级的 primary_zone 不能为空，如果创建时未指定 primary_zone，默认填写成 RANDOM，表示各个 Zone 优先级相同</p> 
<p>状态类：<br> 1、注意停止observer的状态也是active，但是stop_time&gt;0<br> 2、zone的状态只有active和inactive，删除后是无状态</p> 
<p>OBProxy类：<br> 1、一台机器上可以部署多个OBproxy，但是需要指定不同的端口<br> 2、生产环境下，可以通过config url启动，或者守护进程<br> 3、测试模式下，通过rslist启动<br> 4、一个OBProxy可以访问多个集群</p> 
<p>GTS类：<br> 1、如果没有开启 GTS，则创建全局索引失败。<br> 2、全局时间戳服务（Global Timestamp Service，简称 GTS），OceanBase 数据库内部每个租户启动一个全局时间戳服务，事务提交时通过本租户的时间戳服务获取事务版本号，保证全局的事务顺序。</p> 
<p>日志类：<br> 1、OceanBase 数据库日志划分了六个日志级别：<br> ERROR 严重错误。用于记录系统的故障信息，且必须进行故障排除，否则系统不可用。<br> USER_ERROR 用户输入导致的错误。<br> WARN 警告。用于记录可能会出现的潜在错误。<br> INFO 提示。用于记录系统运行的当前状态，该信息为正常信息。<br> TRACE 与 INFO 相比更细致化地记录事件消息。<br> DEBUG 调试信息。用于调试时更详细地了解系统运行状态，包括当前调用的函数名、参数、变量、函数调用返回值等。</p> 
<p>2、OB默认不清理observer日志，可以通过参数enable_syslog_recycle，max_syslog_file_count控制</p> 
<p>3、同一个OBS上，所有分区共用一个Clog；不同的OBS肯定是不同的Clog</p> 
<p>DML、DDL、DCL类：<br> 1、OB中，DDL语句如果集群中有一台服务器故障或者offline，则无法成功；而DML不需要，只需要多数派即可。<br> 2、需要注意MERGE是DML语句，修改变量是DCL</p> 
<p>分区表类：<br> 1、range等值条件可以分区裁剪，非等值不可以<br> 2、oracle模式下：<br> 在 Range/Range Columns/List/List Columns 分区中添加一级分区不会影响全局索引和局部索引的使用。<br> 删除一级分区时，可以删除一个或多个分区，但不能删除全部分区。<br> 3、分区表的分区键一定要包含主键的部分列<br> 4、分区不能在线转化<br> 5、hash和key类型的分区，不支持添加或删除单个分区</p> 
<p>还原/闪回：<br> 1、回收站中找不到对象，可能是：1、purge 2、回收站功能关闭 3、对象已被恢复 4、租户被重建<br> 2、系统租户不支持创建restore point<br> 3、OB支持基于 SCN/TIMESTAMP 闪回查询</p> 
<p>索引类：<br> oracle/mysql模式，如果索引属性关键字没有指定，那么默认的索引属性是 GLOBAL 属性，即创建的索引是全局索引，并且索引表只有一个分区。</p> 
<p>合并/转储类：<br> 1、merge_thread_count就算为0，也是由线程数的，为0时，合并的工作进程数的计算方式为 min{10,cpu_cnt*0.3}，其中 cpu_cnt 为系统 CPU 的数量。</p> 
<p>连接类：<br> 1、连接格式<br> username@tenantname#clustername, 如root@trade#xxbank<br> clustername:tenantname:username, 如xxbank:trade:root<br> clustername-tenantname-username, 如xxbank-trade-root<br> clustername.tenantname.username, 如xxbank.trade.root</p> 
<p>2、OBProxy和OBserver是长连接</p> 
<p>权限/角色功能：<br> 1、OB支持oracle模式下的用户角色管理功能，没有MySQL<br> 2、系统租户可以创建普通租户，并分配资源<br> 3、系统租户不能设置其他租户的密码</p> 
<p>等待事件类：<br> OB等待事件默认单位不是毫秒</p> 
<p>杂项：<br> 1、一个SSTable中，同一个rowkey并不只会有一行数据。<br> 2、OBProxy可以从config server中获取集群列表和集群RS列表<br> 3、启动observer服务是admin用户！！不是root<br> 4、OBProxy不能支持跨集群的分布式事务<br> 5、OBProxy有sys租户 location cache、普通租户location cache、用户表location cache<br> 6、OB默认单条SQL超时时间是10s<br> 7、基于LSM-TREE查询，针对单点查询get,多点查询multi get的查询流程正确的是：<br> bloomfilter——row cache——block index cache——block cache<br> 8、执行计划，cost是指每个操作算子的的执行代价（单位是微妙！！！）</p> 
<p>OCP平台用户管理：<br> 新建用户时可以选择多个资源包和权限包；用户创建完成后，可以修改资源包配置；权限资源分为租户和集群</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/675d540a62bd0ea6b7ef64e64d3843f6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">乌班图vscode头文件设置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/03e3e2e3208b47aae8955f8a13050636/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue3&#43;vite的项目中实现右键事件的神器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>