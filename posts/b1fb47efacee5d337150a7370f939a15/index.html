<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>34个数据库练习题 带你打开思路 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="34个数据库练习题 带你打开思路" />
<meta property="og:description" content="------mysql数据库练习题-------
学习基础知识的同时，没有练习题可不行
博主在这里给大家整理了34个数据库练习题
希望能帮助同学们打开思路。
注：使用的语句已用代码块的形式标注出
文章目录 34个数据库练习题带你打开思路1、取得每个部门最高薪水的人员名称2、哪些人的薪水在部门的平均薪水之上3、取得部门中（所有人的）平均的薪水等级5、取得平均薪水最高的部门的部门编号6、取得平均薪水最高的部门的部门名称7、求平均薪水的等级最低的部门的部门名称8、取得比普通员工(员工代码没有在 mgr 字段上出现的) 的最高薪水还要高的领导人姓名9、取得薪水最高的前五名员工10、取得薪水最高的第六到第十名员工11、取得最后入职的 5 名员工12、取得每个薪水等级有多少员工13、面试题：14、列出所有员工及领导的姓名15、列出受雇日期早于其直接上级的所有员工的编号,姓名,部门名称16、 列出部门名称和这些部门的员工信息, 同时列出那些没有员工的部门17、列出至少有 5 个员工的所有部门18、列出薪金比&#34;SMITH&#34; 多的所有员工信息19、 列出所有&#34;CLERK&#34;( 办事员) 的姓名及其部门名称, 部门的人数20、列出最低薪金大于 1500 的各种工作及从事此工作的全部雇员人数 按照工作岗位分组求最小值。21、列出在部门&#34;SALES&#34;&lt; 销售部&gt; 工作的员工的姓名, 假定不知道销售部的部门编号.22、列出薪金高于公司平均薪金的所有员工, 所在部门, 上级领导, 雇员的工资等级.23、 列出与&#34;SCOTT&#34; 从事相同工作的所有员工及部门名称24、列出薪金等于部门 30 中员工的薪金的其他员工的姓名和薪金.25、列出薪金高于在部门 30 工作的所有员工的薪金的员工姓名和薪金. 部门名称26、列出在每个部门工作的员工数量, 平均工资和平均服务期限27、 列出所有员工的姓名、部门名称和工资。28、列出所有部门的详细信息和人数29、列出各种工作的最低工资及从事此工作的雇员姓名30、列出各个部门的 MANAGER( 领导) 的最低薪金31、列出所有员工的 年工资, 按 年薪从低到高排序32、求出员工领导的薪水超过3000的员工名称与领导33、求出部门名称中, 带&#39;S&#39;字符的部门员工的工资合计、部门人数34、给任职日期超过 30 年的员工加薪 10%. 34个数据库练习题带你打开思路 1、取得每个部门最高薪水的人员名称 第一步：取得每个部门最高薪水(按照部门编号分组，找出每一组最大值)
mysql&gt; select deptno,max(sal) as maxsal from emp group by deptno; ±-------±--------&#43;
| deptno | maxsal |
±-------±--------&#43;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b1fb47efacee5d337150a7370f939a15/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-05T18:31:12+08:00" />
<meta property="article:modified_time" content="2022-04-05T18:31:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">34个数据库练习题 带你打开思路</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>------mysql数据库练习题-------<br> 学习基础知识的同时，没有练习题可不行<br> 博主在这里给大家整理了34个数据库练习题<br> 希望能帮助同学们打开思路。</p> 
<p>注：使用的语句已用代码块的形式标注出<br> </p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#34_8" rel="nofollow">34个数据库练习题带你打开思路</a></li><li><ul><li><a href="#1_10" rel="nofollow">1、取得每个部门最高薪水的人员名称</a></li><li><a href="#2_48" rel="nofollow">2、哪些人的薪水在部门的平均薪水之上</a></li><li><a href="#3_88" rel="nofollow">3、取得部门中（所有人的）平均的薪水等级</a></li><li><a href="#5_237" rel="nofollow">5、取得平均薪水最高的部门的部门编号</a></li><li><a href="#6_313" rel="nofollow">6、取得平均薪水最高的部门的部门名称</a></li><li><a href="#7_338" rel="nofollow">7、求平均薪水的等级最低的部门的部门名称</a></li><li><a href="#8_mgr___421" rel="nofollow">8、取得比普通员工(员工代码没有在 mgr 字段上出现的) 的最高薪水还要高的领导人姓名</a></li><li><a href="#9_472" rel="nofollow">9、取得薪水最高的前五名员工</a></li><li><a href="#10_488" rel="nofollow">10、取得薪水最高的第六到第十名员工</a></li><li><a href="#11_5__504" rel="nofollow">11、取得最后入职的 5 名员工</a></li><li><a href="#12_520" rel="nofollow">12、取得每个薪水等级有多少员工</a></li><li><a href="#13_582" rel="nofollow">13、面试题：</a></li><li><a href="#14_593" rel="nofollow">14、列出所有员工及领导的姓名</a></li><li><a href="#15_625" rel="nofollow">15、列出受雇日期早于其直接上级的所有员工的编号,姓名,部门名称</a></li><li><a href="#16___659" rel="nofollow">16、 列出部门名称和这些部门的员工信息, 同时列出那些没有员工的部门</a></li><li><a href="#17_5__692" rel="nofollow">17、列出至少有 5 个员工的所有部门</a></li><li><a href="#18SMITH__714" rel="nofollow">18、列出薪金比"SMITH" 多的所有员工信息</a></li><li><a href="#19_CLERK____738" rel="nofollow">19、 列出所有"CLERK"( 办事员) 的姓名及其部门名称, 部门的人数</a></li><li><a href="#20_1500___841" rel="nofollow">20、列出最低薪金大于 1500 的各种工作及从事此工作的全部雇员人数 按照工作岗位分组求最小值。</a></li><li><a href="#21SALES____855" rel="nofollow">21、列出在部门"SALES"&lt; 销售部&gt; 工作的员工的姓名, 假定不知道销售部的部门编号.</a></li><li><a href="#22____872" rel="nofollow">22、列出薪金高于公司平均薪金的所有员工, 所在部门, 上级领导, 雇员的工资等级.</a></li><li><a href="#23_SCOTT__907" rel="nofollow">23、 列出与"SCOTT" 从事相同工作的所有员工及部门名称</a></li><li><a href="#24_30__940" rel="nofollow">24、列出薪金等于部门 30 中员工的薪金的其他员工的姓名和薪金.</a></li><li><a href="#25_30___969" rel="nofollow">25、列出薪金高于在部门 30 工作的所有员工的薪金的员工姓名和薪金. 部门名称</a></li><li><a href="#26__1003" rel="nofollow">26、列出在每个部门工作的员工数量, 平均工资和平均服务期限</a></li><li><a href="#27__1045" rel="nofollow">27、 列出所有员工的姓名、部门名称和工资。</a></li><li><a href="#28_1077" rel="nofollow">28、列出所有部门的详细信息和人数</a></li><li><a href="#29_1101" rel="nofollow">29、列出各种工作的最低工资及从事此工作的雇员姓名</a></li><li><a href="#30_MANAGER___1152" rel="nofollow">30、列出各个部门的 MANAGER( 领导) 的最低薪金</a></li><li><a href="#31____1173" rel="nofollow">31、列出所有员工的 年工资, 按 年薪从低到高排序</a></li><li><a href="#323000_1203" rel="nofollow">32、求出员工领导的薪水超过3000的员工名称与领导</a></li><li><a href="#33_S_1226" rel="nofollow">33、求出部门名称中, 带'S'字符的部门员工的工资合计、部门人数</a></li><li><a href="#34_30__10_1251" rel="nofollow">34、给任职日期超过 30 年的员工加薪 10%.</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="34_8"></a>34个数据库练习题带你打开思路</h2> 
<h3><a id="1_10"></a>1、取得每个部门最高薪水的人员名称</h3> 
<p>第一步：取得每个部门最高薪水(按照部门编号分组，找出每一组最大值)</p> 
<pre><code>mysql&gt; select deptno,max(sal) as maxsal from emp group by deptno;
</code></pre> 
<p>±-------±--------+<br> | deptno | maxsal |<br> ±-------±--------+<br> | 10 | 5000.00 |<br> | 20 | 3000.00 |<br> | 30 | 2850.00 |<br> ±-------±--------+<br> 第二步：将以上的查询结果当做一张临时表t，<br> t和emp表连接，条件：t.deptno = e.deptno and t.maxsal = e.sal</p> 
<pre><code>select 
	e.ename, t.*
from 
	emp e
join
	(select deptno,max(sal) as maxsal from emp group by deptno) t
on
	t.deptno = e.deptno and t.maxsal = e.sal;
</code></pre> 
<p>±------±-------±--------+<br> | ename | deptno | maxsal |<br> ±------±-------±--------+<br> | BLAKE | 30 | 2850.00 |<br> | SCOTT | 20 | 3000.00 |<br> | KING | 10 | 5000.00 |<br> | FORD | 20 | 3000.00 |<br> ±------±-------±--------+</p> 
<h3><a id="2_48"></a>2、哪些人的薪水在部门的平均薪水之上</h3> 
<p>第一步：找出每个部门的平均薪水</p> 
<pre><code>select deptno,avg(sal) as avgsal from emp group by deptno;
</code></pre> 
<p>±-------±------------+<br> | deptno | avgsal |<br> ±-------±------------+<br> | 10 | 2916.666667 |<br> | 20 | 2175.000000 |<br> | 30 | 1566.666667 |<br> ±-------±------------+<br> 第二步：将以上查询结果当做t表，t和emp表连接<br> 条件：部门编号相同，并且emp的sal大于t表的avgsal</p> 
<pre><code>select 
	t.*, e.ename, e.sal
from
	emp e
join
	(select deptno,avg(sal) as avgsal from emp group by deptno) t
on
	e.deptno = t.deptno and e.sal &gt; t.avgsal;
</code></pre> 
<p>±-------±------------±------±--------+<br> | deptno | avgsal | ename | sal |<br> ±-------±------------±------±--------+<br> | 30 | 1566.666667 | ALLEN | 1600.00 |<br> | 20 | 2175.000000 | JONES | 2975.00 |<br> | 30 | 1566.666667 | BLAKE | 2850.00 |<br> | 20 | 2175.000000 | SCOTT | 3000.00 |<br> | 10 | 2916.666667 | KING | 5000.00 |<br> | 20 | 2175.000000 | FORD | 3000.00 |<br> ±-------±------------±------±--------+</p> 
<h3><a id="3_88"></a>3、取得部门中（所有人的）平均的薪水等级</h3> 
<p>平均的薪水等级：先计算每一个薪水的等级，然后找出薪水等级的平均值。</p> 
<p>平均薪水的等级：先计算平均薪水，然后找出每个平均薪水的等级值。</p> 
<p>第一步：找出每个人的薪水等级<br> emp e和salgrade s表连接。<br> 连接条件：e.sal between s.losal and s.hisal</p> 
<pre><code>select 
	e.ename,e.sal,e.deptno,s.grade
from
	emp e
join
	salgrade s
on
	e.sal between s.losal and s.hisal;
</code></pre> 
<p>±-------±--------±-------±------+<br> | ename | sal | deptno | grade |<br> ±-------±--------±-------±------+<br> | CLARK | 2450.00 | 10 | 4 |<br> | KING | 5000.00 | 10 | 5 |<br> | MILLER | 1300.00 | 10 | 2 |</p> 
<p>| SMITH | 800.00 | 20 | 1 |<br> | ADAMS | 1100.00 | 20 | 1 |<br> | SCOTT | 3000.00 | 20 | 4 |<br> | FORD | 3000.00 | 20 | 4 |<br> | JONES | 2975.00 | 20 | 4 |</p> 
<p>| MARTIN | 1250.00 | 30 | 2 |<br> | TURNER | 1500.00 | 30 | 3 |<br> | BLAKE | 2850.00 | 30 | 4 |<br> | ALLEN | 1600.00 | 30 | 3 |<br> | JAMES | 950.00 | 30 | 1 |<br> | WARD | 1250.00 | 30 | 2 |<br> ±-------±--------±-------±------+</p> 
<p>第二步：基于以上的结果继续按照deptno分组，求grade的平均值。</p> 
<pre><code>select 
	e.deptno,avg(s.grade)
from
	emp e
join
	salgrade s
on
	e.sal between s.losal and s.hisal
group by
	e.deptno;
</code></pre> 
<p>±-------±-------------+<br> | deptno | avg(s.grade) |<br> ±-------±-------------+<br> | 10 | 3.6667 |<br> | 20 | 2.8000 |<br> | 30 | 2.5000 |<br> ±-------±-------------+</p> 
<p>4、不准用组函数（Max ），取得最高薪水</p> 
<p>第一种：sal降序，limit 1</p> 
<pre><code>select ename,sal from emp order by sal desc limit 1;
</code></pre> 
<p>±------±--------+<br> | ename | sal |<br> ±------±--------+<br> | KING | 5000.00 |<br> ±------±--------+</p> 
<p>第二种方案：</p> 
<pre><code>select max(sal) from emp;
</code></pre> 
<p>第三种方案：表的自连接</p> 
<pre><code>select sal from emp where sal not in(select distinct a.sal from emp a join emp b on a.sal &lt; b.sal);
</code></pre> 
<p>±--------+<br> | sal |<br> ±--------+<br> | 5000.00 |<br> ±--------+</p> 
<pre><code>select 
	distinct a.sal 
from 
	emp a 
join 
	emp b 
on 
	a.sal &lt; b.sal
</code></pre> 
<p>a表<br> ±--------+<br> | sal |<br> ±--------+<br> | 800.00 |<br> | 1600.00 |<br> | 1250.00 |<br> | 2975.00 |<br> | 1250.00 |<br> | 2850.00 |<br> | 2450.00 |<br> | 3000.00 |<br> | 5000.00 |<br> | 1500.00 |<br> | 1100.00 |<br> | 950.00 |<br> | 3000.00 |<br> | 1300.00 |<br> ±--------+</p> 
<p>b表<br> ±--------+<br> | sal |<br> ±--------+<br> | 800.00 |<br> | 1600.00 |<br> | 1250.00 |<br> | 2975.00 |<br> | 1250.00 |<br> | 2850.00 |<br> | 2450.00 |<br> | 3000.00 |<br> | 5000.00 |<br> | 1500.00 |<br> | 1100.00 |<br> | 950.00 |<br> | 3000.00 |<br> | 1300.00 |<br> ±--------+</p> 
<h3><a id="5_237"></a>5、取得平均薪水最高的部门的部门编号</h3> 
<p>第一种方案：降序取第一个。</p> 
<p>第一步：找出每个部门的平均薪水</p> 
<pre><code>select deptno,avg(sal) as avgsal from emp group by deptno;
</code></pre> 
<p>±-------±------------+<br> | deptno | avgsal |<br> ±-------±------------+<br> | 10 | 2916.666667 |<br> | 20 | 2175.000000 |<br> | 30 | 1566.666667 |<br> ±-------±------------+</p> 
<p>第二步：降序选第一个。</p> 
<pre><code>select deptno,avg(sal) as avgsal from emp group by deptno order by avgsal desc limit 1;
</code></pre> 
<p>±-------±------------+<br> | deptno | avgsal |<br> ±-------±------------+<br> | 10 | 2916.666667 |<br> ±-------±------------+</p> 
<p>第二种方案：max</p> 
<p>第一步：找出每个部门的平均薪水</p> 
<pre><code>select deptno,avg(sal) as avgsal from emp group by deptno;
</code></pre> 
<p>±-------±------------+<br> | deptno | avgsal |<br> ±-------±------------+<br> | 10 | 2916.666667 |<br> | 20 | 2175.000000 |<br> | 30 | 1566.666667 |<br> ±-------±------------+</p> 
<p>第二步：找出以上结果中avgsal最大的值。</p> 
<pre><code>select max(t.avgsal) from (select avg(sal) as avgsal from emp group by deptno) t;
</code></pre> 
<p>±--------------+<br> | max(t.avgsal) |<br> ±--------------+<br> | 2916.666667 |<br> ±--------------+</p> 
<p>第三步：</p> 
<pre><code>select 
	deptno,avg(sal) as avgsal 
from 
	emp 
group by 
	deptno
having
	avgsal = (select max(t.avgsal) from (select avg(sal) as avgsal from emp group by deptno) t);
</code></pre> 
<p>±-------±------------+<br> | deptno | avgsal |<br> ±-------±------------+<br> | 10 | 2916.666667 |<br> ±-------±------------+</p> 
<h3><a id="6_313"></a>6、取得平均薪水最高的部门的部门名称</h3> 
<pre><code>select 
	d.dname,avg(e.sal) as avgsal 
from 
	emp e
join
	dept d
on
	e.deptno = d.deptno
group by 
	d.dname
order by 
	avgsal desc 
limit 
	1;
</code></pre> 
<p>±-----------±------------+<br> | dname | avgsal |<br> ±-----------±------------+<br> | ACCOUNTING | 2916.666667 |<br> ±-----------±------------+</p> 
<h3><a id="7_338"></a>7、求平均薪水的等级最低的部门的部门名称</h3> 
<p>平均薪水是800<br> 平均薪水是900<br> 那么他俩都是1级别。</p> 
<p>第一步：找出每个部门的平均薪水</p> 
<pre><code>select deptno,avg(sal) as avgsal from emp group by deptno;
</code></pre> 
<p>±-------±------------+<br> | deptno | avgsal |<br> ±-------±------------+<br> | 10 | 2916.666667 |<br> | 20 | 2175.000000 |<br> | 30 | 1566.666667 |<br> ±-------±------------+</p> 
<p>第二步：找出每个部门的平均薪水的等级<br> 以上t表和salgrade表连接，条件：t.avgsal between s.losal and s.hisal</p> 
<pre><code>select 
	t.*,s.grade
from
	(select d.dname,avg(sal) as avgsal from emp e join dept d on e.deptno = d.deptno group by d.dname) t
join
	salgrade s
on
	t.avgsal between s.losal and s.hisal;
</code></pre> 
<p>±-----------±------------±------+<br> | dname | avgsal | grade |<br> ±-----------±------------±------+<br> | SALES | 1566.666667 | 3 |<br> | ACCOUNTING | 2916.666667 | 4 |<br> | RESEARCH | 2175.000000 | 4 |<br> ±-----------±------------±------+</p> 
<pre><code>select 
	t.*,s.grade
from
	(select d.dname,avg(sal) as avgsal from emp e join dept d on e.deptno = d.deptno group by d.dname) t
join
	salgrade s
on
	t.avgsal between s.losal and s.hisal
where
	s.grade = (select grade from salgrade where (select avg(sal) as avgsal from emp group by deptno order by avgsal asc limit 1) between losal and hisal);
</code></pre> 
<p>±------±------------±------+<br> | dname | avgsal | grade |<br> ±------±------------±------+<br> | SALES | 1566.666667 | 3 |<br> ±------±------------±------+</p> 
<p>抛开之前的，最低等级你怎么着？<br> 平均薪水最低的对应的等级一定是最低的.</p> 
<pre><code>select avg(sal) as avgsal from emp group by deptno order by avgsal asc limit 1;
</code></pre> 
<p>±------------+<br> | avgsal |<br> ±------------+<br> | 1566.666667 |<br> ±------------+</p> 
<pre><code>select grade from salgrade where (select avg(sal) as avgsal from emp group by deptno order by avgsal asc limit 1) between losal and hisal;
</code></pre> 
<p>±------+<br> | grade |<br> ±------+<br> | 3 |<br> ±------+</p> 
<h3><a id="8_mgr___421"></a>8、取得比普通员工(员工代码没有在 mgr 字段上出现的) 的最高薪水还要高的领导人姓名</h3> 
<p>比“普通员工的最高薪水”还要高的一定是领导！<br> 没毛病！！！！</p> 
<pre><code>mysql&gt; select distinct mgr from emp where mgr is not null;
</code></pre> 
<p>±-----+<br> | mgr |<br> ±-----+<br> | 7902 |<br> | 7698 |<br> | 7839 |<br> | 7566 |<br> | 7788 |<br> | 7782 |<br> ±-----+<br> 员工编号没有在以上范围内的都是普通员工。</p> 
<p>第一步：找出普通员工的最高薪水！<br> not in在使用的时候，后面小括号中记得排除NULL。</p> 
<pre><code>select max(sal) from emp where empno not in(select distinct mgr from emp where mgr is not null);
</code></pre> 
<p>±---------+<br> | max(sal) |<br> ±---------+<br> | 1600.00 |<br> ±---------+</p> 
<p>第二步：找出高于1600的</p> 
<pre><code>select ename,sal from emp where sal &gt; (select max(sal) from emp where empno not in(select distinct mgr from emp where mgr is not null));
</code></pre> 
<p>±------±--------+<br> | ename | sal |<br> ±------±--------+<br> | JONES | 2975.00 |<br> | BLAKE | 2850.00 |<br> | CLARK | 2450.00 |<br> | SCOTT | 3000.00 |<br> | KING | 5000.00 |<br> | FORD | 3000.00 |<br> ±------±--------+</p> 
<h3><a id="9_472"></a>9、取得薪水最高的前五名员工</h3> 
<pre><code>select ename,sal from emp order by sal desc limit 5;
</code></pre> 
<p>±------±--------+<br> | ename | sal |<br> ±------±--------+<br> | KING | 5000.00 |<br> | SCOTT | 3000.00 |<br> | FORD | 3000.00 |<br> | JONES | 2975.00 |<br> | BLAKE | 2850.00 |<br> ±------±--------+</p> 
<h3><a id="10_488"></a>10、取得薪水最高的第六到第十名员工</h3> 
<pre><code>select ename,sal from emp order by sal desc limit 5, 5;
</code></pre> 
<p>±-------±--------+<br> | ename | sal |<br> ±-------±--------+<br> | CLARK | 2450.00 |<br> | ALLEN | 1600.00 |<br> | TURNER | 1500.00 |<br> | MILLER | 1300.00 |<br> | MARTIN | 1250.00 |<br> ±-------±--------+</p> 
<h3><a id="11_5__504"></a>11、取得最后入职的 5 名员工</h3> 
<p>日期也可以降序，升序。</p> 
<pre><code>select ename,hiredate from emp order by hiredate desc limit 5;
</code></pre> 
<p>±-------±-----------+<br> | ename | hiredate |<br> ±-------±-----------+<br> | ADAMS | 1987-05-23 |<br> | SCOTT | 1987-04-19 |<br> | MILLER | 1982-01-23 |<br> | FORD | 1981-12-03 |<br> | JAMES | 1981-12-03 |<br> ±-------±-----------+</p> 
<h3><a id="12_520"></a>12、取得每个薪水等级有多少员工</h3> 
<p>分组count</p> 
<p>第一步：找出每个员工的薪水等级</p> 
<pre><code>select 
	e.ename,e.sal,s.grade 
from 
	emp e 
join 
	salgrade s 
on 
	e.sal between s.losal and s.hisal;
</code></pre> 
<p>±-------±--------±------+<br> | ename | sal | grade |<br> ±-------±--------±------+<br> | SMITH | 800.00 | 1 |<br> | ALLEN | 1600.00 | 3 |<br> | WARD | 1250.00 | 2 |<br> | JONES | 2975.00 | 4 |<br> | MARTIN | 1250.00 | 2 |<br> | BLAKE | 2850.00 | 4 |<br> | CLARK | 2450.00 | 4 |<br> | SCOTT | 3000.00 | 4 |<br> | KING | 5000.00 | 5 |<br> | TURNER | 1500.00 | 3 |<br> | ADAMS | 1100.00 | 1 |<br> | JAMES | 950.00 | 1 |<br> | FORD | 3000.00 | 4 |<br> | MILLER | 1300.00 | 2 |<br> ±-------±--------±------+</p> 
<p>第二步：继续按照grade分组统计数量</p> 
<pre><code>select 
	s.grade ,count(*)
from 
	emp e 
join 
	salgrade s 
on 
	e.sal between s.losal and s.hisal
group by
	s.grade;
</code></pre> 
<p>±------±---------+<br> | grade | count(*) |<br> ±------±---------+<br> | 1 | 3 |<br> | 2 | 3 |<br> | 3 | 2 |<br> | 4 | 5 |<br> | 5 | 1 |<br> ±------±---------+</p> 
<h3><a id="13_582"></a>13、面试题：</h3> 
<p>有 3 个表 S(学生表)，C（课程表），SC（学生选课表）<br> S（SNO，SNAME）代表（学号，姓名）<br> C（CNO，CNAME，CTEACHER）代表（课号，课名，教师）<br> SC（SNO，CNO，SCGRADE）代表（学号，课号，成绩）<br> 问题：<br> 1，找出没选过“黎明”老师的所有学生姓名。<br> 2，列出 2 门以上（含2 门）不及格学生姓名及平均成绩。<br> 3，即学过 1 号课程又学过 2 号课所有学生的姓名。</p> 
<h3><a id="14_593"></a>14、列出所有员工及领导的姓名</h3> 
<pre><code>select 
	a.ename '员工', b.ename '领导'
from
	emp a
left join
	emp b
on
	a.mgr = b.empno;
</code></pre> 
<p>±-------±------+<br> | 员工 | 领导 |<br> ±-------±------+<br> | SMITH | FORD |<br> | ALLEN | BLAKE |<br> | WARD | BLAKE |<br> | JONES | KING |<br> | MARTIN | BLAKE |<br> | BLAKE | KING |<br> | CLARK | KING |<br> | SCOTT | JONES |<br> | KING | NULL |<br> | TURNER | BLAKE |<br> | ADAMS | SCOTT |<br> | JAMES | BLAKE |<br> | FORD | JONES |<br> | MILLER | CLARK |<br> ±-------±------+</p> 
<h3><a id="15_625"></a>15、列出受雇日期早于其直接上级的所有员工的编号,姓名,部门名称</h3> 
<p>emp a 员工表<br> emp b 领导表<br> a.mgr = b.empno and a.hiredate &lt; b.hiredate</p> 
<pre><code>select 
	a.ename '员工', a.hiredate, b.ename '领导', b.hiredate, d.dname
from
	emp a
join
	emp b
on
	a.mgr = b.empno
join
	dept d
on
	a.deptno = d.deptno
where
	 a.hiredate &lt; b.hiredate;
</code></pre> 
<p>±------±-----------±------±-----------±-----------+<br> | 员工 | hiredate | 领导 | hiredate | dname |<br> ±------±-----------±------±-----------±-----------+<br> | CLARK | 1981-06-09 | KING | 1981-11-17 | ACCOUNTING |<br> | SMITH | 1980-12-17 | FORD | 1981-12-03 | RESEARCH |<br> | JONES | 1981-04-02 | KING | 1981-11-17 | RESEARCH |<br> | ALLEN | 1981-02-20 | BLAKE | 1981-05-01 | SALES |<br> | WARD | 1981-02-22 | BLAKE | 1981-05-01 | SALES |<br> | BLAKE | 1981-05-01 | KING | 1981-11-17 | SALES |<br> ±------±-----------±------±-----------±-----------+</p> 
<h3><a id="16___659"></a>16、 列出部门名称和这些部门的员工信息, 同时列出那些没有员工的部门</h3> 
<pre><code>select 
	e.*,d.dname
from
	emp e
right join
	dept d
on
	e.deptno = d.deptno;
</code></pre> 
<p>±------±-------±----------±-----±-----------±--------±--------±-------±-----------+<br> | EMPNO | ENAME | JOB | MGR | HIREDATE | SAL | COMM | DEPTNO | dname |<br> ±------±-------±----------±-----±-----------±--------±--------±-------±-----------+<br> | 7782 | CLARK | MANAGER | 7839 | 1981-06-09 | 2450.00 | NULL | 10 | ACCOUNTING |<br> | 7839 | KING | PRESIDENT | NULL | 1981-11-17 | 5000.00 | NULL | 10 | ACCOUNTING |<br> | 7934 | MILLER | CLERK | 7782 | 1982-01-23 | 1300.00 | NULL | 10 | ACCOUNTING |<br> | 7369 | SMITH | CLERK | 7902 | 1980-12-17 | 800.00 | NULL | 20 | RESEARCH |<br> | 7566 | JONES | MANAGER | 7839 | 1981-04-02 | 2975.00 | NULL | 20 | RESEARCH |<br> | 7788 | SCOTT | ANALYST | 7566 | 1987-04-19 | 3000.00 | NULL | 20 | RESEARCH |<br> | 7876 | ADAMS | CLERK | 7788 | 1987-05-23 | 1100.00 | NULL | 20 | RESEARCH |<br> | 7902 | FORD | ANALYST | 7566 | 1981-12-03 | 3000.00 | NULL | 20 | RESEARCH |<br> | 7499 | ALLEN | SALESMAN | 7698 | 1981-02-20 | 1600.00 | 300.00 | 30 | SALES |<br> | 7521 | WARD | SALESMAN | 7698 | 1981-02-22 | 1250.00 | 500.00 | 30 | SALES |<br> | 7654 | MARTIN | SALESMAN | 7698 | 1981-09-28 | 1250.00 | 1400.00 | 30 | SALES |<br> | 7698 | BLAKE | MANAGER | 7839 | 1981-05-01 | 2850.00 | NULL | 30 | SALES |<br> | 7844 | TURNER | SALESMAN | 7698 | 1981-09-08 | 1500.00 | 0.00 | 30 | SALES |<br> | 7900 | JAMES | CLERK | 7698 | 1981-12-03 | 950.00 | NULL | 30 | SALES |<br> | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | OPERATIONS |<br> ±------±-------±----------±-----±-----------±--------±--------±-------±-----------+</p> 
<h3><a id="17_5__692"></a>17、列出至少有 5 个员工的所有部门</h3> 
<p>按照部门编号分组，计数，筛选出 &gt;= 5</p> 
<pre><code>select 
	deptno
from
	emp
group by
	deptno
having
	count(*) &gt;= 5;
</code></pre> 
<p>±-------+<br> | deptno |<br> ±-------+<br> | 20 |<br> | 30 |<br> ±-------+</p> 
<h3><a id="18SMITH__714"></a>18、列出薪金比"SMITH" 多的所有员工信息</h3> 
<pre><code>select ename,sal from emp where sal &gt; (select sal from emp where ename = 'SMITH');
</code></pre> 
<p>±-------±--------+<br> | ename | sal |<br> ±-------±--------+<br> | ALLEN | 1600.00 |<br> | WARD | 1250.00 |<br> | JONES | 2975.00 |<br> | MARTIN | 1250.00 |<br> | BLAKE | 2850.00 |<br> | CLARK | 2450.00 |<br> | SCOTT | 3000.00 |<br> | KING | 5000.00 |<br> | TURNER | 1500.00 |<br> | ADAMS | 1100.00 |<br> | JAMES | 950.00 |<br> | FORD | 3000.00 |<br> | MILLER | 1300.00 |<br> ±-------±--------+</p> 
<h3><a id="19_CLERK____738"></a>19、 列出所有"CLERK"( 办事员) 的姓名及其部门名称, 部门的人数</h3> 
<pre><code>select ename,job from emp where job = 'CLERK';
</code></pre> 
<p>±-------±------+<br> | ename | job |<br> ±-------±------+<br> | SMITH | CLERK |<br> | ADAMS | CLERK |<br> | JAMES | CLERK |<br> | MILLER | CLERK |<br> ±-------±------+</p> 
<pre><code>select 
	e.ename,e.job,d.dname
from 
	emp e
join
	dept d
on
	e.deptno = d.deptno
where 
	e.job = 'CLERK';
</code></pre> 
<p>±-------±------±-----------+<br> | ename | job | dname |<br> ±-------±------±-----------+<br> | MILLER | CLERK | ACCOUNTING |<br> | SMITH | CLERK | RESEARCH |<br> | ADAMS | CLERK | RESEARCH |<br> | JAMES | CLERK | SALES |<br> ±-------±------±-----------+</p> 
<pre><code>select 
	e.ename,e.job,d.dname,d.deptno
from 
	emp e
join
	dept d
on
	e.deptno = d.deptno
where 
	e.job = 'CLERK';
</code></pre> 
<p>±-------±------±-----------±-------+<br> | ename | job | dname | deptno |<br> ±-------±------±-----------±-------+<br> | MILLER | CLERK | ACCOUNTING | 10 |<br> | SMITH | CLERK | RESEARCH | 20 |<br> | ADAMS | CLERK | RESEARCH | 20 |<br> | JAMES | CLERK | SALES | 30 |<br> ±-------±------±-----------±-------+</p> 
<p>//每个部门的人数？</p> 
<pre><code>select deptno, count(*) as deptcount from emp group by deptno;
</code></pre> 
<p>±-------±----------+<br> | deptno | deptcount |<br> ±-------±----------+<br> | 10 | 3 |<br> | 20 | 5 |<br> | 30 | 6 |<br> ±-------±----------+</p> 
<pre><code>select 
	t1.*,t2.deptcount
from
	(select 
		e.ename,e.job,d.dname,d.deptno
	from 
		emp e
	join
		dept d
	on
		e.deptno = d.deptno
	where 
		e.job = 'CLERK') t1
join
	(select deptno, count(*) as deptcount from emp group by deptno) t2
on
	t1.deptno = t2.deptno;
</code></pre> 
<p>±-------±------±-----------±-------±----------+<br> | ename | job | dname | deptno | deptcount |<br> ±-------±------±-----------±-------±----------+<br> | MILLER | CLERK | ACCOUNTING | 10 | 3 |<br> | SMITH | CLERK | RESEARCH | 20 | 5 |<br> | ADAMS | CLERK | RESEARCH | 20 | 5 |<br> | JAMES | CLERK | SALES | 30 | 6 |<br> ±-------±------±-----------±-------±----------+</p> 
<h3><a id="20_1500___841"></a>20、列出最低薪金大于 1500 的各种工作及从事此工作的全部雇员人数 按照工作岗位分组求最小值。</h3> 
<pre><code>select job,count(*) from emp group by job having min(sal) &gt; 1500;
</code></pre> 
<p>±----------±---------+<br> | job | count(*) |<br> ±----------±---------+<br> | ANALYST | 2 |<br> | MANAGER | 3 |<br> | PRESIDENT | 1 |<br> ±----------±---------+</p> 
<h3><a id="21SALES____855"></a>21、列出在部门"SALES"&lt; 销售部&gt; 工作的员工的姓名, 假定不知道销售部的部门编号.</h3> 
<pre><code>select ename from emp where deptno = (select deptno from dept where dname = 'SALES');
</code></pre> 
<p>±-------+<br> | ename |<br> ±-------+<br> | ALLEN |<br> | WARD |<br> | MARTIN |<br> | BLAKE |<br> | TURNER |<br> | JAMES |<br> ±-------+</p> 
<h3><a id="22____872"></a>22、列出薪金高于公司平均薪金的所有员工, 所在部门, 上级领导, 雇员的工资等级.</h3> 
<pre><code>select 
	e.ename '员工',d.dname,l.ename '领导',s.grade
from
	emp e
join
	dept d
on
	e.deptno = d.deptno
left join
	emp l
on
	e.mgr = l.empno
join
	salgrade s
on
	e.sal between s.losal and s.hisal
where
	e.sal &gt; (select avg(sal) from emp);
</code></pre> 
<p>±------±-----------±------±------+<br> | 员工 | dname | 领导 | grade |<br> ±------±-----------±------±------+<br> | JONES | RESEARCH | KING | 4 |<br> | BLAKE | SALES | KING | 4 |<br> | CLARK | ACCOUNTING | KING | 4 |<br> | SCOTT | RESEARCH | JONES | 4 |<br> | KING | ACCOUNTING | NULL | 5 |<br> | FORD | RESEARCH | JONES | 4 |<br> ±------±-----------±------±------+</p> 
<h3><a id="23_SCOTT__907"></a>23、 列出与"SCOTT" 从事相同工作的所有员工及部门名称</h3> 
<pre><code>select job from emp where ename = 'SCOTT';
</code></pre> 
<p>±--------+<br> | job |<br> ±--------+<br> | ANALYST |<br> ±--------+</p> 
<pre><code>select 
	e.ename,e.job,d.dname
from
	emp e
join
	dept d
on
	e.deptno = d.deptno
where
	e.job = (select job from emp where ename = 'SCOTT')
and
	e.ename &lt;&gt; 'SCOTT';
</code></pre> 
<p>±------±--------±---------+<br> | ename | job | dname |<br> ±------±--------±---------+<br> | FORD | ANALYST | RESEARCH |<br> ±------±--------±---------+</p> 
<h3><a id="24_30__940"></a>24、列出薪金等于部门 30 中员工的薪金的其他员工的姓名和薪金.</h3> 
<pre><code>select distinct sal from emp where deptno = 30;
</code></pre> 
<p>±--------+<br> | sal |<br> ±--------+<br> | 1600.00 |<br> | 1250.00 |<br> | 2850.00 |<br> | 1500.00 |<br> | 950.00 |<br> ±--------+</p> 
<pre><code>select 
	ename,sal 
from 
	emp 
where 
	sal in(select distinct sal from emp where deptno = 30) 
and 
	deptno &lt;&gt; 30;
</code></pre> 
<p>Empty set (0.00 sec)</p> 
<h3><a id="25_30___969"></a>25、列出薪金高于在部门 30 工作的所有员工的薪金的员工姓名和薪金. 部门名称</h3> 
<pre><code>select max(sal) from emp where deptno = 30;
</code></pre> 
<p>±---------+<br> | max(sal) |<br> ±---------+<br> | 2850.00 |<br> ±---------+</p> 
<pre><code>select
	e.ename,e.sal,d.dname
from
	emp e
join
	dept d
on
	e.deptno = d.deptno
where
	e.sal &gt; (select max(sal) from emp where deptno = 30);
</code></pre> 
<p>±------±--------±-----------+<br> | ename | sal | dname |<br> ±------±--------±-----------+<br> | KING | 5000.00 | ACCOUNTING |<br> | JONES | 2975.00 | RESEARCH |<br> | SCOTT | 3000.00 | RESEARCH |<br> | FORD | 3000.00 | RESEARCH |<br> ±------±--------±-----------+</p> 
<h3><a id="26__1003"></a>26、列出在每个部门工作的员工数量, 平均工资和平均服务期限</h3> 
<p>没有员工的部门，部门人数是0</p> 
<pre><code>select 
	d.deptno, count(e.ename) ecount,ifnull(avg(e.sal),0) as avgsal, ifnull(avg(timestampdiff(YEAR, hiredate, now())), 0) as avgservicetime
from
	emp e
right join
	dept d
on
	e.deptno = d.deptno
group by
	d.deptno;
</code></pre> 
<p>±-------±-------±------------±---------------+<br> | deptno | ecount | avgsal | avgservicetime |<br> ±-------±-------±------------±---------------+<br> | 10 | 3 | 2916.666667 | 38.0000 |<br> | 20 | 5 | 2175.000000 | 35.8000 |<br> | 30 | 6 | 1566.666667 | 38.3333 |<br> | 40 | 0 | 0.000000 | 0.0000 |<br> ±-------±-------±------------±---------------+</p> 
<p>在mysql当中怎么计算两个日期的“年差”，差了多少年？</p> 
<p>TimeStampDiff(间隔类型, 前一个日期, 后一个日期)</p> 
<p>timestampdiff(YEAR, hiredate, now())</p> 
<p>间隔类型：<br> SECOND 秒，<br> MINUTE 分钟，<br> HOUR 小时，<br> DAY 天，<br> WEEK 星期<br> MONTH 月，<br> QUARTER 季度，<br> YEAR 年</p> 
<h3><a id="27__1045"></a>27、 列出所有员工的姓名、部门名称和工资。</h3> 
<pre><code>select 
	e.ename,d.dname,e.sal
from
	emp e
join 
	dept d
on
	e.deptno = d.deptno;
</code></pre> 
<p>±-------±-----------±--------+<br> | ename | dname | sal |<br> ±-------±-----------±--------+<br> | CLARK | ACCOUNTING | 2450.00 |<br> | KING | ACCOUNTING | 5000.00 |<br> | MILLER | ACCOUNTING | 1300.00 |<br> | SMITH | RESEARCH | 800.00 |<br> | JONES | RESEARCH | 2975.00 |<br> | SCOTT | RESEARCH | 3000.00 |<br> | ADAMS | RESEARCH | 1100.00 |<br> | FORD | RESEARCH | 3000.00 |<br> | ALLEN | SALES | 1600.00 |<br> | WARD | SALES | 1250.00 |<br> | MARTIN | SALES | 1250.00 |<br> | BLAKE | SALES | 2850.00 |<br> | TURNER | SALES | 1500.00 |<br> | JAMES | SALES | 950.00 |<br> ±-------±-----------±--------+</p> 
<h3><a id="28_1077"></a>28、列出所有部门的详细信息和人数</h3> 
<pre><code>select 
	d.deptno,d.dname,d.loc,count(e.ename)
from
	emp e
right join
	dept d
on
	e.deptno = d.deptno
group by
	d.deptno,d.dname,d.loc;
</code></pre> 
<p>±-------±-----------±---------±---------------+<br> | deptno | dname | loc | count(e.ename) |<br> ±-------±-----------±---------±---------------+<br> | 10 | ACCOUNTING | NEW YORK | 3 |<br> | 20 | RESEARCH | DALLAS | 5 |<br> | 30 | SALES | CHICAGO | 6 |<br> | 40 | OPERATIONS | BOSTON | 0 |<br> ±-------±-----------±---------±---------------+</p> 
<h3><a id="29_1101"></a>29、列出各种工作的最低工资及从事此工作的雇员姓名</h3> 
<pre><code>select 
	job,min(sal) as minsal
from
	emp
group by
	job;
</code></pre> 
<p>±----------±---------+<br> | job | minsal |<br> ±----------±---------+<br> | ANALYST | 3000.00 |<br> | CLERK | 800.00 |<br> | MANAGER | 2450.00 |<br> | PRESIDENT | 5000.00 |<br> | SALESMAN | 1250.00 |<br> ±----------±---------+</p> 
<p>emp e和以上t连接</p> 
<pre><code>select 
	e.ename,t.*
from
	emp e
join
	(select 
		job,min(sal) as minsal
	from
		emp
	group by
		job) t
on
	e.job = t.job and e.sal = t.minsal;
</code></pre> 
<p>±-------±----------±--------+<br> | ename | job | minsal |<br> ±-------±----------±--------+<br> | SMITH | CLERK | 800.00 |<br> | WARD | SALESMAN | 1250.00 |<br> | MARTIN | SALESMAN | 1250.00 |<br> | CLARK | MANAGER | 2450.00 |<br> | SCOTT | ANALYST | 3000.00 |<br> | KING | PRESIDENT | 5000.00 |<br> | FORD | ANALYST | 3000.00 |<br> ±-------±----------±--------+</p> 
<h3><a id="30_MANAGER___1152"></a>30、列出各个部门的 MANAGER( 领导) 的最低薪金</h3> 
<pre><code>select 
	deptno, min(sal)
from
	emp
where
	job = 'MANAGER'
group by
	deptno;
</code></pre> 
<p>±-------±---------+<br> | deptno | min(sal) |<br> ±-------±---------+<br> | 10 | 2450.00 |<br> | 20 | 2975.00 |<br> | 30 | 2850.00 |<br> ±-------±---------+</p> 
<h3><a id="31____1173"></a>31、列出所有员工的 年工资, 按 年薪从低到高排序</h3> 
<pre><code>select 
	ename,(sal + ifnull(comm,0)) * 12 as yearsal
from
	emp
order by
	yearsal asc;
</code></pre> 
<p>±-------±---------+<br> | ename | yearsal |<br> ±-------±---------+<br> | SMITH | 9600.00 |<br> | JAMES | 11400.00 |<br> | ADAMS | 13200.00 |<br> | MILLER | 15600.00 |<br> | TURNER | 18000.00 |<br> | WARD | 21000.00 |<br> | ALLEN | 22800.00 |<br> | CLARK | 29400.00 |<br> | MARTIN | 31800.00 |<br> | BLAKE | 34200.00 |<br> | JONES | 35700.00 |<br> | FORD | 36000.00 |<br> | SCOTT | 36000.00 |<br> | KING | 60000.00 |<br> ±-------±---------+</p> 
<h3><a id="323000_1203"></a>32、求出员工领导的薪水超过3000的员工名称与领导</h3> 
<pre><code>select 
	a.ename '员工',b.ename '领导'
from
	emp a
join
	emp b
on
	a.mgr = b.empno
where
	b.sal &gt; 3000;
</code></pre> 
<p>±------±-----+<br> | 员工 | 领导 |<br> ±------±-----+<br> | JONES | KING |<br> | BLAKE | KING |<br> | CLARK | KING |<br> ±------±-----+</p> 
<h3><a id="33_S_1226"></a>33、求出部门名称中, 带’S’字符的部门员工的工资合计、部门人数</h3> 
<pre><code>select 
	d.deptno,d.dname,d.loc,count(e.ename),ifnull(sum(e.sal),0) as sumsal
from
	emp e
right join
	dept d
on
	e.deptno = d.deptno
where
	d.dname like '%S%'
group by
	d.deptno,d.dname,d.loc;
</code></pre> 
<p>±-------±-----------±--------±---------------±---------+<br> | deptno | dname | loc | count(e.ename) | sumsal |<br> ±-------±-----------±--------±---------------±---------+<br> | 20 | RESEARCH | DALLAS | 5 | 10875.00 |<br> | 30 | SALES | CHICAGO | 6 | 9400.00 |<br> | 40 | OPERATIONS | BOSTON | 0 | 0.00 |<br> ±-------±-----------±--------±---------------±---------+</p> 
<h3><a id="34_30__10_1251"></a>34、给任职日期超过 30 年的员工加薪 10%.</h3> 
<pre><code>update emp set sal = sal * 1.1 where timestampdiff(YEAR, hiredate, now()) &gt; 30;

</code></pre> 
<p>最后感谢大家的支持<br> <img src="https://images2.imgbox.com/c4/fa/tlEhcUf0_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c1fab8de7b422b5c6f18d7a1c7e4353d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【学习笔记】大数据技术之Kafka3.x（生产调优手册）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/86562ce2376d0f5da9652e3793abf8e2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">建立时间、保持时间与亚稳态</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>