<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ubuntu20.04&#43;Windows10双系统迁移新硬盘并解决引导损坏全流程总结 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Ubuntu20.04&#43;Windows10双系统迁移新硬盘并解决引导损坏全流程总结" />
<meta property="og:description" content="目录 一. 备份原有系统1.1 压缩原系统的/目录 二. 安装新系统三. 迁移系统四. 引导修复4.1 Ubuntu引导修复4.2 Win10引导修复4.3 双系统grub修复 因工作需要，欲将Ubuntu系统迁移到一块全新SSD中，此文章提供了系统迁移后所产生一系列问题的解决方案。 原有软硬件环境：
OS1：Ubuntu20.04 (nvme0, PM981 512GB)
OS2：Windows10 (nvme1, SN850X 1TB)
现有全新SSD 致态7100Plus 2TB一块，任务为将PM981替换掉，并将Ubuntu系统和原有环境原封不动迁移到2TB的新硬盘中。
一. 备份原有系统 1.1 压缩原系统的/目录 sudo tar -cvpzf ubuntu_backup.tar.gz --exclude=/proc --exclude=/tmp --exclude=/home --exclude=/boot --exclude=/lost&#43;found --exclude=/media --exclude=/mnt --exclude=/run / 这里排除了几个不需要的文件夹：
proc 存放系统的进程文件， 根据当前系统中运行的进程动态改变
tmp 存放系统缓存文件
home 因为home目录单独挂载在一个分区， 所以待会单独打包
root 因为root目录单独挂载在一个分区， 所以待会单独打包
lost&#43;found 系统发生异常时尝试根据此文件夹中的内容进行恢复
media 插入外部存储设备如u盘时系统自动挂载的位置
mnt 提供给用户手动挂载设备的文件夹
run 系统运行时产生的日志文件
二. 安装新系统 首先使用u盘制作一个ubuntu的安装盘，制作安装盘的软件可以选择ubuntu自带的启动盘创建器软件，或者 ultraISO， rufus 之类。启动电脑进入bios设置优先启动设置为 usb 设备， 然后进入安装盘系统，分区根据硬盘大小来设定，如2TB的SSD：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/65a0f5ebdfe716f53f17a8feb9eaaa84/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-19T16:19:09+08:00" />
<meta property="article:modified_time" content="2023-04-19T16:19:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Ubuntu20.04&#43;Windows10双系统迁移新硬盘并解决引导损坏全流程总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#__8" rel="nofollow">一. 备份原有系统</a></li><li><ul><li><a href="#11__9" rel="nofollow">1.1 压缩原系统的/目录</a></li></ul> 
  </li><li><a href="#__25" rel="nofollow">二. 安装新系统</a></li><li><a href="#__36" rel="nofollow">三. 迁移系统</a></li><li><a href="#__43" rel="nofollow">四. 引导修复</a></li><li><ul><li><a href="#41_Ubuntu_44" rel="nofollow">4.1 Ubuntu引导修复</a></li><li><a href="#42_Win10_53" rel="nofollow">4.2 Win10引导修复</a></li><li><a href="#43_grub_56" rel="nofollow">4.3 双系统grub修复</a></li></ul> 
 </li></ul> 
</div> 
<br> 因工作需要，欲将Ubuntu系统迁移到一块全新SSD中，此文章提供了系统迁移后所产生一系列问题的解决方案。 
<p></p> 
<p>原有软硬件环境：<br> OS1：Ubuntu20.04 (nvme0, PM981 512GB)<br> OS2：Windows10 (nvme1, SN850X 1TB)</p> 
<p>现有全新SSD 致态7100Plus 2TB一块，任务为将PM981替换掉，并将Ubuntu系统和原有环境原封不动迁移到2TB的新硬盘中。</p> 
<h2><a id="__8"></a>一. 备份原有系统</h2> 
<h3><a id="11__9"></a>1.1 压缩原系统的/目录</h3> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">tar</span> -cvpzf ubuntu_backup.tar.gz --exclude<span class="token operator">=</span>/proc --exclude<span class="token operator">=</span>/tmp --exclude<span class="token operator">=</span>/home --exclude<span class="token operator">=</span>/boot --exclude<span class="token operator">=</span>/lost+found --exclude<span class="token operator">=</span>/media --exclude<span class="token operator">=</span>/mnt --exclude<span class="token operator">=</span>/run /
</code></pre> 
<p>这里排除了几个不需要的文件夹：</p> 
<p>proc 存放系统的进程文件， 根据当前系统中运行的进程动态改变<br> tmp 存放系统缓存文件<br> home 因为home目录单独挂载在一个分区， 所以待会单独打包<br> root 因为root目录单独挂载在一个分区， 所以待会单独打包<br> lost+found 系统发生异常时尝试根据此文件夹中的内容进行恢复<br> media 插入外部存储设备如u盘时系统自动挂载的位置<br> mnt 提供给用户手动挂载设备的文件夹<br> run 系统运行时产生的日志文件</p> 
<h2><a id="__25"></a>二. 安装新系统</h2> 
<p>首先使用u盘制作一个ubuntu的安装盘，制作安装盘的软件可以选择ubuntu自带的<code>启动盘创建器</code>软件，或者 ultraISO， rufus 之类。启动电脑进入bios设置优先启动设置为 usb 设备， 然后进入安装盘系统，分区根据硬盘大小来设定，如2TB的SSD：</p> 
<pre><code class="prism language-bash">200M , unformatted， 无
20G , ext4， /boot
250G , ext4, /
16G, linux_swap, 无
剩下的全部， ext4， /home
</code></pre> 
<h2><a id="__36"></a>三. 迁移系统</h2> 
<p>然后将之前打包的压缩包解压到新硬盘中对应的分区中：</p> 
<pre><code class="prism language-bash"><span class="token function">tar</span> -xzvpf ubuntu_backup.tar.gz -C  <span class="token operator">&lt;</span><span class="token variable"><span class="token variable">`</span>新硬盘中被划分为/的分区位置<span class="token variable">`</span></span><span class="token operator">&gt;</span>
</code></pre> 
<h2><a id="__43"></a>四. 引导修复</h2> 
<h3><a id="41_Ubuntu_44"></a>4.1 Ubuntu引导修复</h3> 
<p>解压完成后， 新硬盘中已经有了原来的系统， 但是此时还不能正常引导启动， 使用U盘启动盘进入安装界面，选择<code>Try Ubuntu</code> ，然后进入系统下载 boot-repair 进行自动修复（本质是安装grub程序到硬盘首部的bios_grub分区， 然后修改/boot/grub/grub.cfg文件中/目录和/boot目录对应的UUID）:</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> add-apt-repository ppa:yannubuntu/boot-repair
<span class="token function">sudo</span> <span class="token function">apt-get</span> update
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> boot-repair
boot-repair
</code></pre> 
<p>点击执行进行修复，修复完成后可以进入Ubuntu系统。</p> 
<h3><a id="42_Win10_53"></a>4.2 Win10引导修复</h3> 
<p>下载并安装PE，在BIOS中使用UEFI方式启动，使用dism++进行引导修复，修复完成后，重启可以进入WIn10。</p> 
<h3><a id="43_grub_56"></a>4.3 双系统grub修复</h3> 
<p>BIOS确认为UEFI方式启动，后使用U盘启动盘进入安装界面，选择<code>Try Ubuntu</code>，再次进行boot-repair修复。修复完成后grub即可恢复，可以选择进入任何一个系统。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d3a0cf7e0b44e7169c834204830f3d8a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">9. docker的使用，docker管理，容器通信，bridge模式详解，pod是什么？和node之间的关系？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/61f040ce01180520037122942f206d13/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">知识蒸馏（Knowledge distillation）必读论文合集</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>