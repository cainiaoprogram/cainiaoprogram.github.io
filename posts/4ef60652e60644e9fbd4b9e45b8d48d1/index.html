<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL笔试经典50题及答案解析 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQL笔试经典50题及答案解析" />
<meta property="og:description" content="[转]SQL笔试经典50题及答案解析 建表语句
create table Student(sid varchar(10),sname varchar(10),sage datetime,ssex nvarchar(10));
insert into Student values(&#39;01&#39; , &#39;赵雷&#39; , &#39;1990-01-01&#39; , &#39;男&#39;);
insert into Student values(&#39;02&#39; , &#39;钱电&#39; , &#39;1990-12-21&#39; , &#39;男&#39;);
insert into Student values(&#39;03&#39; , &#39;孙风&#39; , &#39;1990-05-20&#39; , &#39;男&#39;);
insert into Student values(&#39;04&#39; , &#39;李云&#39; , &#39;1990-08-06&#39; , &#39;男&#39;);
insert into Student values(&#39;05&#39; , &#39;周梅&#39; , &#39;1991-12-01&#39; , &#39;女&#39;);
insert into Student values(&#39;06&#39; , &#39;吴兰&#39; , &#39;1992-03-01&#39; , &#39;女&#39;);" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4ef60652e60644e9fbd4b9e45b8d48d1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-03T12:23:28+08:00" />
<meta property="article:modified_time" content="2021-03-03T12:23:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL笔试经典50题及答案解析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3><a href="https://www.cnblogs.com/codetree/p/11974104.html" rel="nofollow" id="cb_post_title_url">[转]SQL笔试经典50题及答案解析 </a></h3> 
<p>建表语句</p> 
<p>create table Student(sid varchar(10),sname varchar(10),sage datetime,ssex nvarchar(10));<br> insert into Student values('01' , '赵雷' , '1990-01-01' , '男');<br> insert into Student values('02' , '钱电' , '1990-12-21' , '男');<br> insert into Student values('03' , '孙风' , '1990-05-20' , '男');<br> insert into Student values('04' , '李云' , '1990-08-06' , '男');<br> insert into Student values('05' , '周梅' , '1991-12-01' , '女');<br> insert into Student values('06' , '吴兰' , '1992-03-01' , '女');<br> insert into Student values('07' , '郑竹' , '1989-07-01' , '女');<br> insert into Student values('08' , '王菊' , '1990-01-20' , '女');<br> create table Course(cid varchar(10),cname varchar(10),tid varchar(10));<br> insert into Course values('01' , '语文' , '02');<br> insert into Course values('02' , '数学' , '01');<br> insert into Course values('03' , '英语' , '03');<br> create table Teacher(tid varchar(10),tname varchar(10));<br> insert into Teacher values('01' , '张三');<br> insert into Teacher values('02' , '李四');<br> insert into Teacher values('03' , '王五');<br> create table SC(sid varchar(10),cid varchar(10),score decimal(18,1));<br> insert into SC values('01' , '01' , 80);<br> insert into SC values('01' , '02' , 90);<br> insert into SC values('01' , '03' , 99);<br> insert into SC values('02' , '01' , 70);<br> insert into SC values('02' , '02' , 60);<br> insert into SC values('02' , '03' , 80);<br> insert into SC values('03' , '01' , 80);<br> insert into SC values('03' , '02' , 80);<br> insert into SC values('03' , '03' , 80);<br> insert into SC values('04' , '01' , 50);<br> insert into SC values('04' , '02' , 30);<br> insert into SC values('04' , '03' , 20);<br> insert into SC values('05' , '01' , 76);<br> insert into SC values('05' , '02' , 87);<br> insert into SC values('06' , '01' , 31);<br> insert into SC values('06' , '03' , 34);<br> insert into SC values('07' , '02' , 89);<br> insert into SC values('07' , '03' , 98);<br> 3、表结构预览</p> 
<p>--学生表<br> Student(SId,Sname,Sage,Ssex)<br> --SId 学生编号,Sname 学生姓名,Sage 出生年月,Ssex 学生性别<br> --课程表<br> Course(CId,Cname,TId)<br> --CId 课程编号,Cname 课程名称,TId 教师编号<br> --教师表<br> Teacher(TId,Tname)<br> --TId 教师编号,Tname 教师姓名<br> --成绩表<br> SC(SId,CId,score)<br> --SId 学生编号,CId 课程编号,score 分数</p> 
<p>题目<br> 1、查询“01”课程比“02”课程成绩高的所有学生的学号；<br> 2、查询平均成绩大于60分的同学的学号和平均成绩；<br> 3、查询所有同学的学号、姓名、选课数、总成绩<br> 4、查询姓“李”的老师的个数；<br> 5、查询没学过“张三”老师课的同学的学号、姓名；<br> 6、查询学过编号“01”并且也学过编号“02”课程的同学的学号、姓名；<br> 7、查询学过“张三”老师所教的课的同学的学号、姓名；<br> 8、查询课程编号“01”的成绩比课程编号“02”课程低的所有同学的学号、姓名；<br> 9、查询所有课程成绩小于60分的同学的学号、姓名；<br> 10、查询没有学全所有课的同学的学号、姓名；<br> 11、查询至少有一门课与学号为“01”的同学所学相同的同学的学号和姓名；<br> 12、查询和"01"号的同学学习的课程完全相同的其他同学的学号和姓名<br> 13、把“SC”表中“张三”老师教的课的成绩都更改为此课程的平均成绩；<br> 14、查询没学过"张三"老师讲授的任一门课程的学生姓名<br> 15、查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩<br> 16、检索"01"课程分数小于60，按分数降序排列的学生信息<br> 17、按平均成绩从高到低显示所有学生的平均成绩<br> 18、查询各科成绩最高分、最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率<br> 19、按各科平均成绩从低到高和及格率的百分数从高到低顺序<br> 20、查询学生的总成绩并进行排名<br> 21、查询不同老师所教不同课程平均分从高到低显示<br> 22、查询所有课程的成绩第2名到第3名的学生信息及该课程成绩<br> 23、统计各科成绩各分数段人数：课程编号,课程名称,[100-85],[85-70],[70-60],[0-60]及所占百分比<br> 24、查询学生平均成绩及其名次<br> 25、查询各科成绩前三名的记录<br> 26、查询每门课程被选修的学生数<br> 27、查询出只选修了一门课程的全部学生的学号和姓名<br> 28、查询男生、女生人数<br> 29、查询名字中含有"风"字的学生信息<br> 30、查询同名同性学生名单，并统计同名人数<br> 31、查询1990年出生的学生名单(注：Student表中Sage列的类型是datetime)<br> 32、查询每门课程的平均成绩，结果按平均成绩升序排列，平均成绩相同时，按课程号降序排列<br> 37、查询不及格的课程，并按课程号从大到小排列<br> 38、查询课程编号为"01"且课程成绩在60分以上的学生的学号和姓名；<br> 40、查询选修“张三”老师所授课程的学生中，成绩最高的学生姓名及其成绩<br> 42、查询每门功课成绩最好的前两名<br> 43、统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列<br> 44、检索至少选修两门课程的学生学号<br> 45、查询选修了全部课程的学生信息<br> 46、查询各学生的年龄<br> 47、查询本周过生日的学生<br> 48、查询下周过生日的学生<br> 49、查询本月过生日的学生<br> 50、查询下月过生日的学生</p> 
<p>答案<br> 1、查询“01”课程比“02”课程成绩高的所有学生的学号；</p> 
<p>select distinct t1.sid as sid<br> from<br> (select * from sc where cid='01')t1<br> left join<br> (select * from sc where cid='02')t2<br> on t1.sid=t2.sid<br> where t1.score&gt;t2.score<br> 2、查询平均成绩大于60分的同学的学号和平均成绩；</p> 
<p>select<br> sid<br> ,avg(score)<br> from sc<br> group by sid<br> having avg(score)&gt;60<br> 3、查询所有同学的学号、姓名、选课数、总成绩</p> 
<p>select<br> student.sid as sid<br> ,sname<br> ,count(distinct cid) course_cnt<br> ,sum(score) as total_score<br> from student<br> left join sc<br> on student.sid=sc.sid<br> group by sid,sname<br> 4、查询姓“李”的老师的个数；</p> 
<p>select<br> count(distinct tid) as teacher_cnt<br> from teacher<br> where tname like '李%'<br> 5、查询没学过“张三”老师课的同学的学号、姓名；</p> 
<p>select<br> sid,sname<br> from student<br> where sid not in<br> (<br> select<br> sc.sid<br> from teacher<br> left join course<br> on teacher.tid=course.tid<br> left join sc<br> on course.cid=sc.cid<br> where teacher.tname='张三'<br> )<br> 6、查询学过“01”并且也学过编号“02”课程的同学的学号、姓名；</p> 
<p>select<br> t.sid as sid<br> ,sname<br> from<br> (<br> select<br> sid<br> ,count(if(cid='01',score,null)) as count1<br> ,count(if(cid='02',score,null)) as count2<br> from sc<br> group by sid<br> having count(if(cid='01',score,null))&gt;0 and count(if(cid='02',score,null))&gt;0<br> )t<br> left join student<br> on t.sid=student.sid<br> 7、查询学过“张三”老师所教的课的同学的学号、姓名；</p> 
<p>select<br> student.sid<br> ,sname<br> from<br> (<br> select<br> distinct cid<br> from course<br> left join teacher<br> on course.tid=teacher.tid<br> where teacher.tname='张三'<br> )course<br> left join sc<br> on course.cid=sc.cid<br> left join student<br> on sc.sid=student.sid<br> group by student.sid,sname<br> 8、查询课程编号“01”的成绩比课程编号“02”课程低的所有同学的学号、姓名；</p> 
<p>select<br> t1.sid,sname<br> from<br> (<br> select distinct t1.sid as sid<br> from<br> (select * from sc where cid='01')t1<br> left join<br> (select * from sc where cid='02')t2<br> on t1.sid=t2.sid<br> where t1.score&gt;t2.score<br> )t1<br> left join student<br> on t1.sid=student.sid<br> 9、查询所有课程成绩小于60分的同学的学号、姓名；</p> 
<p>select<br> t1.sid,sname<br> from<br> (<br> select<br> sid,max(score)<br> from sc<br> group by sid<br> having max(score&lt;60)<br> )t1<br> left join student<br> on t1.sid=student.sid<br> 10、查询没有学全所有课的同学的学号、姓名；</p> 
<p>select<br> t1.sid,sname<br> from<br> (<br> select<br> count(cid),sid<br> from sc<br> group by sid<br> having count(cid) &lt; (select count(distinct cid) from course)<br> )t1<br> left join student<br> on t1.sid=student.sid<br> 11、查询至少有一门课与学号为“01”的同学所学相同的同学的学号和姓名；</p> 
<p>select<br> distinct sc.sid<br> from<br> (<br> select<br> cid<br> from sc<br> where sid='01'<br> )t1<br> left join sc<br> on t1.cid=sc.cid<br> 12、查询和"01"号的同学学习的课程完全相同的其他同学的学号和姓名</p> 
<h2 id="注意是和01号同学课程完全相同但非学习课程数相同的这里我用左连接解决这个问题">注意是和'01'号同学课程完全相同但非学习课程数相同的,这里我用左连接解决这个问题</h2> 
<p>select<br> t1.sid,sname<br> from<br> (<br> select<br> sc.sid<br> ,count(distinct sc.cid)<br> from<br> (<br> select<br> cid<br> from sc<br> where sid='01'<br> )t1 #选出01的同学所学的课程<br> left join sc<br> on t1.cid=sc.cid<br> group by sc.sid<br> having count(distinct sc.cid)= (select count(distinct cid) from sc where sid = '01')<br> )t1<br> left join student<br> on t1.sid=student.sid<br> where t1.sid!='01'<br> 13、把“SC”表中“张三”老师教的课的成绩都更改为此课程的平均成绩；</p> 
<h2 id="暂跳过update题目">暂跳过update题目</h2> 
<p>14、查询没学过"张三"老师讲授的任一门课程的学生姓名</p> 
<p>select<br> sname<br> from student<br> where sid not in<br> (<br> select<br> distinct sid<br> from sc<br> left join course<br> on sc.cid=course.cid<br> left join teacher<br> on course.tid=teacher.tid<br> where tname='张三'<br> )<br> 15、查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</p> 
<p>select<br> t1.sid,sname,avg_score<br> from<br> (<br> select<br> sid,count(if(score&lt;60,cid,null)),avg(score) as avg_score<br> from sc<br> group by sid<br> having count(if(score&lt;60,cid,null)) &gt;=2<br> )t1<br> left join student<br> on t1.sid=student.sid<br> 16、检索"01"课程分数小于60，按分数降序排列的学生信息</p> 
<p>select<br> sid,if(cid='01',score,100)<br> from sc<br> where if(cid='01',score,100)&lt;60<br> order by if(cid='01',score,100) desc<br> 17、按平均成绩从高到低显示所有学生的平均成绩</p> 
<p>select sid,avg(score)<br> from sc<br> group by sid<br> order by avg(score) desc<br> 18、查询各科成绩最高分、最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率</p> 
<p>select<br> sc.cid<br> ,cname<br> ,max(score) as max_score<br> ,min(score) as min_score<br> ,avg(score) as avg_score<br> ,count(if(score&gt;=60,sid,null))/count(sid) as pass_rate<br> from sc<br> left join course<br> on sc.cid=course.cid<br> group by sc.cid<br> 19、按各科平均成绩从低到高和及格率的百分数从高到低顺序</p> 
<h2 id="这里先按照平均成绩排序，再按照及格百分数排序，题目有点奇怪">这里先按照平均成绩排序，再按照及格百分数排序，题目有点奇怪</h2> 
<p>select<br> cid<br> ,avg(score) as avg_score<br> ,count(if(score&gt;=60,sid,null))/count(sid) as pass_rate<br> from sc<br> group by cid<br> order by avg_score,pass_rate desc<br> 20、查询学生的总成绩并进行排名</p> 
<p>select<br> sid<br> ,sum(score) as sum_score<br> from sc<br> group by sid<br> order by sum_score desc<br> 21、查询不同老师所教不同课程平均分从高到低显示</p> 
<p>select<br> tid<br> ,avg(score) as avg_score<br> from course<br> left join sc<br> on course.cid=sc.cid<br> group by tid<br> order by avg_score desc<br> 22、查询所有课程的成绩第2名到第3名的学生信息及该课程成绩</p> 
<p>select<br> sid,rank_num,score,cid<br> from<br> (<br> select<br> rank() over(partition by cid order by score desc) as rank_num<br> ,sid<br> ,score<br> ,cid<br> from sc<br> )t<br> where rank_num in (2,3)<br> 23、统计各科成绩各分数段人数：课程编号,课程名称,[100-85],[85-70],[70-60],[0-60]及所占百分比</p> 
<p>select<br> sc.cid<br> ,cname<br> ,count(if(score between 85 and 100,sid,null))/count(sid)<br> ,count(if(score between 70 and 85,sid,null))/count(sid)<br> ,count(if(score between 60 and 70,sid,null))/count(sid)<br> ,count(if(score between 0 and 60,sid,null))/count(sid)<br> from sc<br> left join course<br> on sc.cid=course.cid<br> group by sc.cid,cname<br> 24、查询学生平均成绩及其名次</p> 
<p>select<br> sid<br> ,avg_score<br> ,rank() over (order by avg_score desc)<br> from<br> (<br> select<br> sid<br> ,avg(score) as avg_score<br> from sc<br> group by sid<br> )t<br> 25、查询各科成绩前三名的记录</p> 
<p>select<br> sid,cid,rank1<br> from<br> (<br> select<br> cid<br> ,sid<br> ,rank() over(partition by cid order by score desc) as rank1<br> from sc<br> )t<br> where rank1&lt;=3<br> 26、查询每门课程被选修的学生数</p> 
<p>select<br> count(sid)<br> ,cid<br> from sc<br> group by cid<br> 27、查询出只选修了一门课程的全部学生的学号和姓名</p> 
<h2 id="只查出来sid即可，后面懒得交student表">只查出来sid即可，后面懒得交student表</h2> 
<p>select<br> sid<br> from sc<br> group by sid<br> having count(cid) =1<br> 28、查询男生、女生人数</p> 
<p>select<br> ssex<br> ,count(distinct sid)<br> from student<br> group by ssex<br> 29、查询名字中含有"风"字的学生信息</p> 
<p>select<br> sid,sname<br> from student<br> where sname like '%风%'<br> 30、查询同名同性学生名单，并统计同名人数</p> 
<h2 id="题目有歧义，这套题的质量感觉有点差">题目有歧义，这套题的质量感觉有点差</h2> 
<p>select<br> ssex<br> ,sname<br> ,count(sid)<br> from student<br> group by ssex,sname<br> having count(sid)&gt;=2<br> 31、查询1990年出生的学生名单(注：Student表中Sage列的类型是datetime)</p> 
<p>select<br> sid,sname,sage<br> from student<br> where year(sage)=1990<br> 32、查询每门课程的平均成绩，结果按平均成绩升序排列，平均成绩相同时，按课程号降序排列</p> 
<p>select<br> cid,avg(score) as avg_score<br> from sc<br> group by cid<br> order by avg_score,cid desc<br> 37、查询不及格的课程，并按课程号从大到小排列</p> 
<h2 id="有问题的题目">有问题的题目</h2> 
<p>select<br> cid,sid,score<br> from sc<br> where score&lt;60<br> order by cid desc,sid<br> 38、查询课程编号为"01"且课程成绩在60分以上的学生的学号和姓名；</p> 
<p>select<br> sid,cid,score<br> from sc<br> where cid='01' and score&gt;60<br> 40、查询选修“张三”老师所授课程的学生中，成绩最高的学生姓名及其成绩</p> 
<p>select<br> sc.sid,sname,cname,score<br> from sc<br> left join course<br> on sc.cid=course.cid<br> left join teacher<br> on course.tid=teacher.tid<br> left join student<br> on sc.sid=student.sid<br> where tname='张三'<br> order by score desc<br> limit 1;<br> 42、查询每门功课成绩最好的前两名</p> 
<h3 id="感觉题目重复了">感觉题目重复了</h3> 
<p>select<br> cid,sid,rank1<br> from<br> (<br> select<br> cid<br> ,sid<br> ,rank() over(partition by cid order by score desc) as rank1<br> from sc<br> )t<br> where rank1 &lt;=2<br> 43、统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</p> 
<p>select<br> cid<br> ,count(sid) as cnt<br> from sc<br> group by cid<br> having cnt&gt;=5<br> order by count(sid) desc,cid<br> 44、检索至少选修两门课程的学生学号</p> 
<p>select<br> sid<br> ,count(cid)<br> from sc<br> group by sid<br> having count(cid)&gt;=2<br> 45、查询选修了全部课程的学生信息</p> 
<h2 id="不太严谨，但实务中应该没问题，如需严谨见12题思路">不太严谨，但实务中应该没问题，如需严谨见12题思路</h2> 
<p>select<br> sid<br> ,count(cid)<br> from sc<br> group by sid<br> having count(cid)=(select count(distinct cid) from sc)<br> 46、查询各学生的年龄</p> 
<p>select<br> sid,sname,year(curdate())-year(sage) as sage<br> from student<br> 47、查询本周过生日的学生</p> 
<p>select<br> sid,sname,sage<br> from student<br> where weekofyear(sage)=weekofyear(curdate())<br> 48、查询下周过生日的学生</p> 
<p>select<br> sid,sname,sage<br> from student<br> where weekofyear(sage) = weekofyear(date_add(curdate(),interval 1 week))<br> 49、查询本月过生日的学生</p> 
<p>select<br> sid,sname,sage<br> from student<br> where month(sage) = month(curdate())<br> 50、查询下月过生日的学生</p> 
<p>select<br> sid,sname,sage<br> from student<br> where month(date_sub(sage,interval 1 month)) = month(curdate())</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/43be3ba79ec51636d062c81b80d47d19/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">解决zabbix5.0监控项 ICMP 报错问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a41f559d5c87f151311208fbe17aa584/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">GPIO的两种引脚规则：BCM与BOARD</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>