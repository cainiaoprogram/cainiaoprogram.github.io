<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>什么是TSN？ - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="什么是TSN？" />
<meta property="og:description" content="TSN（Time-Sensitive Networking）是在非确定的以太网中实现确定性的最小时延协议族，是IEEE 802.1开发的一套协议标准。为以太网协议的数据链路层提供一套通用的时间敏感机制，为标准以太网提供了确定性和可靠性，以确保数据实时、确定和可靠地传输，提高数据传输效率。此外，TSN能实现时间敏感性（对实时性要求高）数据和非时间敏感性数据在同一网络的传输。
什么是TSN? TSN的重要协议是什么？ - 华为 (huawei.com)
TSN的重要协议是什么？ 传统以太网会采用载波侦听多路访问/冲突检测（CSMA/CD)的机制，当两个工作站发生冲突时，必须延迟一定时间后重发报文。
发生堵塞时，有的报文可能长时间发布不出去，造成通信时间的不确定性。以往对实时性要求高的数据通过实时以太网去实现。故现在信息技术和运营技术融合过程中会遇到很大的困难，为了实现部分数据传输的实时、确定性需求，有实时性要求的数据和没有实时性要求的数据往往需要通过两个网络进行传输。所有的控制器都是两个网口，一个是实时以太网，一个是标准以太网。
而TSN不仅能确保数据的实时、确定性传输，还能实现时间敏感数据和非时间敏感性数据在同一网络的传输。
TSN通过一套协议标准（TSN协议族）来实现数据在同一网络的实时、确定性传输，保证对实时性要求高的信息在标准以太网的不同场景下的顺利传输。TSN协议族本身具有很高的灵活性，用户可以根据应用的具体需求来选择相应的协议组合。
TSN协议族包含了时钟同步、数据调度及流量整形、可靠性、资源管理这四个类别的子协议。
时钟同步 与IEEE 802.3 的标准以太网相比，时钟在TSN 网络中起着重要的作用。对于实时通信而言，端到端的传输延迟具有难以协商的时间界限，因此TSN 中的所有设备都需要具有共同的时间参考模型，因此需要彼此同步时钟。目前TSN采用IEEE 1588 协议和IEEE 802.1AS协议来实现时间同步。
IEEE 1588 协议是一个精密时间协议 (PTP)，用于同步计算机网络中的时钟。 在局域网中，它能将时钟精确度控制在亚微秒范围内，使其适用于测量和控制系统。
数据调度及流量整形 TSN通过定义不同的整形机制将数据流的时延限定在一定范围内，以此满足不同的低时延场景需求。在传统以太网中，数据流的通信时延是不确定的，由于这种不确定性，数据接收端通常需要预置大缓冲区来缓冲输出，但是这样会导致数据流，例如音视频流，缺失了实时方面的特性。
TSN不仅要保证时间敏感流的到达，同时也要保证这些数据流的低时延传输。通过优化控制时间敏感流和best-effort流、以及其它数据流在网络中的传输过程，来保证对数据流的传输时间要求，这个优化控制的方式就是整形。
TSN用于数据调度和流量整形的协议有IEEE 802.1Qav、IEEE 802.1Qbv、IEEE 802.1Qbu、IEEE 802.1Qch及IEEE 802.1Qcr。
其中，IEEE 802.1Qbv采用非抢占式的的数据调度，流量调度方式通过时隙进行控制，需要实时传输的数据流优先传输，同时为best-effort数据及预留数据预留带宽，允许时间敏感流和非时间敏感流在同一个网络中传输，并确保数据的实时传输。
如下图（IEEE 802.1Qbv时隙划分图），使用IEEE 802.1Qbv，数据包传输被安排在一个重复周期中端到端。
IEEE 802.1Qbv中定义了三种基本类型的流量：
时间敏感流best-effort流预留流量 时间敏感流适用于对实时性要求严格的关键消息， best-effort流是不需要任何QoS 的一般以太网流量。 此外，预留流量适用于需要预留特定带宽并具有软实时要求的帧。
IEEE 802.1Qbv定义了通过调度算法启用或禁用帧传输的门，将以太网通信划分为固定长度、连续重复的周期。这些周期被分成时隙，在每个时隙中，数据通过被赋予不同的优先级实现在指定时隙中的传输。由于此操作，时间敏感流可以拥有专用时隙，从而确保此流量在传统以太网网络上的确定性传输。另一方面，预留流量和best-effort流被容纳在每个周期的剩余时隙中。预留流量保证有专用带宽，而best-effort流可以使用剩余的带宽。
图中时隙1为时间敏感流预留，时隙期间不存在其他流量。另一方面，时隙2由best-effort流和预留流量使用，同时为预留流量预留专用带宽。
由于TSN的运行基于不同的时间时隙发送不同类型的流量，因此所有网络设备必须在纳秒级范围内同步。- 可靠性 对数据传输实时性要求高的应用除了需要保证数据传输的时效性，同时也需要高可靠的数据传输机制，以便应对网桥节点失效、线路断路和外部攻击带来的各种问题，来确保功能安全和网络安全。IEEE 802.1Qci、IEEE 802.1CB及IEEE 802.1Qca用于实现TSN这方面的性能。
IEEE 802.1CB为以太网提供双链冗余特性，通过在网络的源端系统和中继系统中对每个数据帧进行序列编号和复制，并在目标端系统和其他中继系统中消除这些复制帧，确保仅有一份数据帧被接收。可用来防止由于拥塞导致的丢包情况，也可以降低由于设备故障造成分组丢失的概率及故障恢复时间，提高网络可靠性。
资源管理 在TSN网络中，每一种实时应用都有特定的网络性能需求。使能TSN网络的某个特性是对可用的网络资源进行配置和管理的过程，其允许在同一网络中通过配置一系列TSN子协议，来合理分配网络路径上的资源，以确保它们能够按照预期正常运行。TSN资源管理子协议包括IEEE 802.1Qat协议和IEEE 802.1Qcc协议。IEEE 802.1Qcc协议是IEEE802.1Qat协议的增强。
IEEE802.1Qat即流预留协议。根据流的资源要求和可用的网络资源情况指定数据准入控制，保留资源并通告从数据源发送端至数据接收端之间的所有网络节点，确保指定流在整条传输路径上有充足的网络资源可用。
TSN的应用场景是什么？ TSN的典型应用就是工业互联网，传统的工业自动化实现通过在每个接入网侧均采用硬编码逻辑控制器（硬PLC）及人机交互界面（HMI）实现对机器人、夹具的控制来实现工业自动化。每个接入网侧都需要相应的硬PLC分散地处理业务，使得管理困难，运维复杂，如下图（传统工业园区解决方案）。而且生产线往往变更频繁，硬PLC由于采用硬编码，其生产扩展不灵活，生产线变更时需要耗费很大的资源去进行生产线的适配和调测。
若将PLC直接接入到工厂数据中心，就可以采用软件编码的虚拟PLC（vPLC），如下图（传统工业园区解决方案vs采用TSN网络园区工业解决方案）融合架构的IT基础设施平台（FushionCube）上的vPLC，一方面可实现对生产设备的远程集中处理。另一方面，vPLC通过软件编程就可以完成对生产线的适配，生产扩展灵活。但工厂数据中心往往统一纳管信息技术和运营技术，生产业务流和办公业务流及其它数据流均需通过同一网络上送到工厂数据中心，而且工业自动化控制对数据流的确定性到达有毫秒级的需求。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b62226ac28683bb433b6b7877fcada2e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-09T09:09:19+08:00" />
<meta property="article:modified_time" content="2024-01-09T09:09:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">什么是TSN？</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>TSN（Time-Sensitive Networking）是在<strong>非确定的以太网中实现确定性的最小时延协议族</strong>，是IEEE 802.1开发的一套协议标准。为以太网协议的数据链路层提供一套通用的时间敏感机制，为标准以太网<strong>提供了确定性和可靠性，以确保数据实时、确定和可靠地传输，提高数据传输效率</strong>。此外，TSN能实现时间敏感性（对实时性要求高）数据和非时间敏感性数据在同一网络的传输。</p> 
<p><a href="https://info.support.huawei.com/info-finder/encyclopedia/zh/TSN.html" rel="nofollow" title="什么是TSN? TSN的重要协议是什么？ - 华为 (huawei.com)">什么是TSN? TSN的重要协议是什么？ - 华为 (huawei.com)</a></p> 
<p> </p> 
<h3 id="content1">TSN的重要协议是什么？</h3> 
<p>传统以太网会采用载波侦听多路访问/冲突检测（CSMA/CD)的机制，当两个工作站发生冲突时，必须延迟一定时间后重发报文。</p> 
<p>发生堵塞时，有的报文可能长时间发布不出去，造成通信时间的不确定性。以往对实时性要求高的数据通过实时以太网去实现。故现在信息技术和运营技术融合过程中会遇到很大的困难，<span style="color:#fe2c24;">为了实现部分数据传输的实时、确定性需求，有实时性要求的数据</span>和<span style="color:#1a439c;">没有实时性要求的数据往往需要通过两个网络进行传输</span>。<strong>所有的控制器都是两个网口，一个是实时以太网，一个是标准以太网</strong>。</p> 
<p>而TSN不仅能确保数据的实时、确定性传输，还能实现时间敏感数据和非时间敏感性数据在同一网络的传输。</p> 
<p>TSN通过一套协议标准（TSN协议族）来实现数据在同一网络的实时、确定性传输，保证对实时性要求高的信息在标准以太网的不同场景下的顺利传输。TSN协议族本身具有很高的灵活性，用户可以根据应用的具体需求来选择相应的协议组合。</p> 
<p>TSN协议族包含了<span style="color:#1a439c;"><strong>时钟同步、数据调度及流量整形、可靠性、资源管理</strong></span>这四个类别的子协议。</p> 
<p><img alt="" height="545" src="https://images2.imgbox.com/4c/ec/wE3XVBH4_o.png" width="1200"></p> 
<p> </p> 
<h4>时钟同步</h4> 
<p>与IEEE 802.3 的标准以太网相比，时钟在TSN 网络中起着重要的作用。对于实时通信而言，端到端的传输延迟具有难以协商的时间界限，因此TSN 中的所有设备都需要具有共同的时间参考模型，因此需要彼此同步时钟。目前TSN采用IEEE 1588 协议和IEEE 802.1AS协议来实现时间同步。</p> 
<p>IEEE 1588 协议是一个精密时间协议 (PTP)，用于同步计算机网络中的时钟。 在局域网中，它能将时钟精确度控制在亚微秒范围内，使其适用于测量和控制系统。</p> 
<h4>数据调度及流量整形</h4> 
<p>TSN通过定义不同的整形机制将数据流的时延限定在一定范围内，以此满足不同的低时延场景需求。在传统以太网中，数据流的通信时延是不确定的，由于这种不确定性，数据接收端通常需要预置大缓冲区来缓冲输出，但是这样会导致数据流，例如音视频流，缺失了实时方面的特性。</p> 
<p><strong>TSN不仅要保证时间敏感流的到达，同时也要保证这些数据流的低时延传输</strong>。通过优化控制时间敏感流和<a href="https://info.support.huawei.com/info-finder/encyclopedia/zh/QoS.html" rel="nofollow" title="best-effort">best-effort</a>流、以及其它数据流在网络中的传输过程，来保证对数据流的传输时间要求，这个优化控制的方式就是整形。</p> 
<p><img alt="" height="532" src="https://images2.imgbox.com/a0/ad/lACm83MC_o.png" width="1041"> </p> 
<blockquote> 
 <p>TSN用于数据调度和流量整形的协议有IEEE 802.1Qav、IEEE 802.1Qbv、IEEE 802.1Qbu、IEEE 802.1Qch及IEEE 802.1Qcr。</p> 
 <p><span style="color:#fe2c24;">其中，IEEE 802.1Qbv采用非抢占式的的数据调度，流量调度方式通过时隙进行控制，需要实时传输的数据流优先传输，同时为best-effort数据及预留数据预留带宽，允许时间敏感流和非时间敏感流在同一个网络中传输，并确保数据的实时传输。</span></p> 
</blockquote> 
<p>如下图（IEEE 802.1Qbv时隙划分图），使用IEEE 802.1Qbv，数据包传输被安排在一个重复周期中端到端。</p> 
<blockquote> 
 <p>IEEE 802.1Qbv中定义了三种基本类型的流量：</p> 
 <ol><li>时间敏感流</li><li>best-effort流</li><li>预留流量</li></ol> 
</blockquote> 
<p>时间敏感流适用于对实时性要求严格的关键消息， best-effort流是不需要任何<a href="https://info.support.huawei.com/info-finder/encyclopedia/zh/QoS.html" rel="nofollow" title="QoS">QoS</a> 的一般以太网流量。 此外，预留流量适用于需要预留特定带宽并具有软实时要求的帧。</p> 
<p>IEEE 802.1Qbv定义了通过调度算法启用或禁用帧传输的门，将以太网通信划分为固定长度、连续重复的周期。这些周期被分成时隙，在每个时隙中，<strong>数据通过被赋予不同的优先级实现在指定时隙中的传输。</strong>由于此操作，时间敏感流可以拥有专用时隙，从而确保此流量在传统以太网网络上的确定性传输。另一方面，预留流量和best-effort流被容纳在每个周期的剩余时隙中。预留流量保证有专用带宽，而best-effort流可以使用剩余的带宽。</p> 
<p><img alt="" height="429" src="https://images2.imgbox.com/f3/f1/rqGCDVXb_o.png" width="1142"></p> 
<p>图中<span style="color:#fe2c24;">时隙1为时间敏感流预留</span>，时隙期间不存在其他流量。另一方面，时隙2由best-effort流和预留流量使用，同时为预留流量预留专用带宽。</p> 
<p>由于TSN的运行基于不同的时间时隙发送不同类型的流量，因此所有网络设备必须在纳秒级范围内同步。-        </p> 
<h4>可靠性</h4> 
<p>对数据传输实时性要求高的应用除了需要保证数据传输的时效性，同时也需要高可靠的数据传输机制，以便应对网桥节点失效、线路断路和外部攻击带来的各种问题，来确保功能安全和网络安全。IEEE 802.1Qci、IEEE 802.1CB及IEEE 802.1Qca用于实现TSN这方面的性能。</p> 
<p>IEEE 802.1CB为<span style="color:#1a439c;">以太网提供双链冗余特性，通过在网络的源端系统和中继系统中对每个数据帧进行序列编号和复制，并在目标端系统和其他中继系统中消除这些复制帧，确保仅有一份数据帧被接收。</span>可用来防止由于拥塞导致的丢包情况，也可以降低由于设备故障造成分组丢失的概率及故障恢复时间，提高网络可靠性。</p> 
<p><img alt="" height="326" src="https://images2.imgbox.com/77/4b/yMeZtLSl_o.png" width="472"></p> 
<p></p> 
<h4>资源管理</h4> 
<p>在TSN网络中，每一种实时应用都有特定的网络性能需求。使能TSN网络的某个特性是对可用的网络资源进行配置和管理的过程，其允许在同一网络中通过配置一系列TSN子协议，来合理分配网络路径上的资源，以确保它们能够按照预期正常运行。TSN资源管理子协议包括IEEE 802.1Qat协议和IEEE 802.1Qcc协议。IEEE 802.1Qcc协议是IEEE802.1Qat协议的增强。</p> 
<p>IEEE802.1Qat即流预留协议。根据流的资源要求和可用的网络资源情况指定数据准入控制，保留资源并通告从数据源发送端至数据接收端之间的所有网络节点，确保指定流在整条传输路径上有充足的网络资源可用。</p> 
<h3 id="content2">TSN的应用场景是什么？</h3> 
<p>TSN的典型应用就是<a href="https://info.support.huawei.com/info-finder/encyclopedia/zh/%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91.html" rel="nofollow" title="工业互联网">工业互联网</a>，传统的工业自动化实现通过在每个接入网侧均采用硬编码逻辑控制器（硬<a href="https://info.support.huawei.com/info-finder/encyclopedia/zh/PLC-IoT.html" rel="nofollow" title="PLC">PLC</a>）及人机交互界面（HMI）实现对机器人、夹具的控制来实现工业自动化。每个接入网侧都需要相应的硬PLC分散地处理业务，使得管理困难，运维复杂，如下图（传统工业园区解决方案）。而且生产线往往变更频繁，硬PLC由于采用硬编码，其生产扩展不灵活，生产线变更时需要耗费很大的资源去进行生产线的适配和调测。</p> 
<p>若将PLC直接接入到工厂数据中心，就可以采用软件编码的虚拟PLC（vPLC），如下图（传统工业园区解决方案vs采用TSN网络园区工业解决方案）融合架构的IT基础设施平台（FushionCube）上的vPLC，一方面可实现对生产设备的远程集中处理。另一方面，vPLC通过软件编程就可以完成对生产线的适配，生产扩展灵活。但工厂数据中心往往统一纳管信息技术和运营技术，生产业务流和办公业务流及其它数据流均需通过同一网络上送到工厂数据中心，而且工业自动化控制对数据流的确定性到达有毫秒级的需求。</p> 
<p>采用传统实时以太网难以满足实现确定性通信的同时实现时间敏感性数据和非时间敏感性数据在同一网络的传输，故不能实现vPLC在工厂数据中心处对生产机器（机器人、夹具）的集中管理，而TSN网络的出现可以解决这一难题。通过对vPLC和生产机器连接的网关均使能TSN的相关协议，可构建TSN网络，如下图（传统工业园区解决方案vs采用TSN网络园区工业解决方案），可实现时间敏感性数据和非时间敏感性数据在同一网络传输的同时实现数据在毫秒级乃至微秒级的确定性通信，从而实现vPLC的远程集中管理，使生产更加安全，维护更加方便，产线调整更加灵活。</p> 
<p><img alt="" height="467" src="https://images2.imgbox.com/4d/13/31EVOD5u_o.png" width="568"> </p> 
<p><img alt="" height="820" src="https://images2.imgbox.com/65/24/RPAOAeDD_o.png" width="1200"> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/66f61a25c158161261ebd32d9d6ac8b4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Saas整合ELK Stack</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2900eea4bf02ef565093b11d46ec3aac/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">PPT插件-大珩助手-倒计时增加姓名</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>