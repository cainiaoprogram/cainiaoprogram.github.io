<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>@Validated和@Valid的区别？教你使用它完成Controller参数校验（含级联属性校验）以及原理分析【享学Spring】 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="@Validated和@Valid的区别？教你使用它完成Controller参数校验（含级联属性校验）以及原理分析【享学Spring】" />
<meta property="og:description" content="每篇一句 NBA里有两大笑话：一是科比没天赋，二是詹姆斯没技术
前言 上篇文章 介绍了Spring环境下实现优雅的方法级别的数据校验，并且埋下一个伏笔：它在Spring MVC（Controller层）里怎么应用呢？本文为此继续展开讲解Spring MVC中的数据校验~
可能小伙伴能立马想到：这不一样吗？我们使用Controller就是方法级别的，所以它就是直接应用了方法级别的校验而已嘛~对于此疑问我先不解答，而是顺势再抛出两个问题你自己应该就能想明白了：
上文有说过，基于方法级别的校验Spring默认是并未开启的，但是为什么你在Spring MVC却可以直接使用@Valid完成校验呢？ 可能有的小伙伴说他用的是SpringBoot可能默认给开启了，其实不然。哪怕你用的传统Spring MVC你会发现也是直接可用的，不信你就试试 类比一下：Spring MVC的HandlerInterceptor是AOP思想的实现，但你有没有发现即使你没有启动@EnableAspectJAutoProxy的支持，它依旧好使~ 若你能想明白我提出的这两个问题，下文就非常不难理解了。当然即使你知道了这两个问题的答案，还是建议你读下去。毕竟：永远相信本文能给你带来意想不到的收获~
使用示例 关于数据校验这一块在Spring MVC中的使用案例，我相信但凡有点经验的Java程序员应该没有不会使用的，并且还不乏熟练的选手。在此之前我简单“采访”过，绝大多数程序员甚至一度认为Spring中的数据校验就是指的在Controller中使用@Validated校验入参JavaBean这一块~
因此下面这个例子，你应该一点都不陌生：
@Getter @Setter @ToString public class Person { @NotNull private String name; @NotNull @Positive private Integer age; @Valid // 让InnerChild的属性也参与校验 @NotNull private InnerChild child; @Getter @Setter @ToString public static class InnerChild { @NotNull private String name; @NotNull @Positive private Integer age; } } @RestController @RequestMapping public class HelloController { @PostMapping(&#34;/hello&#34;) public Object helloPost(@Valid @RequestBody Person person, BindingResult result) { System." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8180a47997f39dfc22c99b0ace23cfbc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-08-02T23:36:38+08:00" />
<meta property="article:modified_time" content="2019-08-02T23:36:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">@Validated和@Valid的区别？教你使用它完成Controller参数校验（含级联属性校验）以及原理分析【享学Spring】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h5><a id="_0"></a>每篇一句</h5> 
<blockquote> 
 <p>NBA里有两大笑话：一是科比没天赋，二是詹姆斯没技术</p> 
</blockquote> 
<h5><a id="_2"></a>前言</h5> 
<p><a href="https://blog.csdn.net/f641385712/article/details/97402946">上篇文章</a> 介绍了<code>Spring</code>环境下实现优雅的方法级别的数据校验，并且埋下一个伏笔：它在<code>Spring MVC</code>（<code>Controller</code>层）里怎么应用呢？本文为此继续展开讲解<code>Spring MVC</code>中的数据校验~</p> 
<p>可能小伙伴能立马想到：这不一样吗？我们使用<code>Controller</code>就是方法级别的，所以它就是直接应用了方法级别的校验而已嘛~对于此疑问我先不解答，而是顺势再抛出两个问题你自己应该就能想明白了：</p> 
<ol><li>上文有说过，基于方法级别的校验<code>Spring</code>默认是并<code>未开启</code>的，但是为什么你在<code>Spring MVC</code>却可以直接使用<code>@Valid</code>完成校验呢？ 
  <ol><li>可能有的小伙伴说他用的是<code>SpringBoot</code>可能默认给开启了，其实不然。哪怕你用的传统<code>Spring MVC</code>你会发现也是直接可用的，不信你就试试</li></ol> </li><li>类比一下：<code>Spring MVC</code>的<code>HandlerInterceptor</code>是<code>AOP</code>思想的实现，但你有没有发现即使你没有启动<code>@EnableAspectJAutoProxy</code>的支持，它依旧好使~</li></ol> 
<p>若你能想明白我提出的这两个问题，下文就非常不难理解了。当然即使你知道了这两个问题的答案，还是建议你读下去。毕竟：<strong>永远相信本文能给你带来意想不到的收获~</strong></p> 
<h5><a id="_12"></a>使用示例</h5> 
<p>关于数据校验这一块在<code>Spring MVC</code>中的使用案例，我相信但凡有点经验的Java程序员应该没有不会使用的，并且还不乏<strong>熟练的选手</strong>。在此之前我简单<code>“采访”</code>过，绝大多数程序员甚至一度认为Spring中的数据校验就是指的在<code>Controller</code>中使用<code>@Validated</code>校验入参<code>JavaBean</code>这一块~</p> 
<p>因此下面这个例子，你应该一点都不陌生：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@ToString</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@NotNull</span>
    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@NotNull</span>
    <span class="token annotation punctuation">@Positive</span>
    <span class="token keyword">private</span> Integer age<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Valid</span> <span class="token comment">// 让InnerChild的属性也参与校验</span>
    <span class="token annotation punctuation">@NotNull</span>
    <span class="token keyword">private</span> InnerChild child<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Getter</span>
    <span class="token annotation punctuation">@Setter</span>
    <span class="token annotation punctuation">@ToString</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">InnerChild</span> <span class="token punctuation">{<!-- --></span>
        <span class="token annotation punctuation">@NotNull</span>
        <span class="token keyword">private</span> String name<span class="token punctuation">;</span>
        <span class="token annotation punctuation">@NotNull</span>
        <span class="token annotation punctuation">@Positive</span>
        <span class="token keyword">private</span> Integer age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloController</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> Object <span class="token function">helloPost</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> Person person<span class="token punctuation">,</span> BindingResult result<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getErrorCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getAllErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> person<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>发送post请求：<code>/hello</code> <code>Content-Type=application/json</code>，传入的json串如下：</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"fsx"</span><span class="token punctuation">,</span>
  <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token string">"-1"</span><span class="token punctuation">,</span>
  <span class="token string">"child"</span> <span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>控制台有如下打印：</p> 
<pre><code class="prism language-java"><span class="token number">2</span>
<span class="token punctuation">[</span>Field error in object <span class="token string">'person'</span> on field <span class="token string">'child.name'</span><span class="token operator">:</span> rejected value <span class="token punctuation">[</span>null<span class="token punctuation">]</span><span class="token punctuation">;</span> codes <span class="token punctuation">[</span>NotNull<span class="token punctuation">.</span>person<span class="token punctuation">.</span>child<span class="token punctuation">.</span>name<span class="token punctuation">,</span>NotNull<span class="token punctuation">.</span>child<span class="token punctuation">.</span>name<span class="token punctuation">,</span>NotNull<span class="token punctuation">.</span>name<span class="token punctuation">,</span>NotNull<span class="token punctuation">.</span>java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>String<span class="token punctuation">,</span>NotNull<span class="token punctuation">]</span><span class="token punctuation">;</span> arguments <span class="token punctuation">[</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>support<span class="token punctuation">.</span>DefaultMessageSourceResolvable<span class="token operator">:</span> codes <span class="token punctuation">[</span>person<span class="token punctuation">.</span>child<span class="token punctuation">.</span>name<span class="token punctuation">,</span>child<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span> arguments <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">default</span> message <span class="token punctuation">[</span>child<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">default</span> message <span class="token punctuation">[</span>不能为null<span class="token punctuation">]</span><span class="token punctuation">,</span> Field error in object <span class="token string">'person'</span> on field <span class="token string">'age'</span><span class="token operator">:</span> rejected value <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> codes <span class="token punctuation">[</span>Positive<span class="token punctuation">.</span>person<span class="token punctuation">.</span>age<span class="token punctuation">,</span>Positive<span class="token punctuation">.</span>age<span class="token punctuation">,</span>Positive<span class="token punctuation">.</span>java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Integer<span class="token punctuation">,</span>Positive<span class="token punctuation">]</span><span class="token punctuation">;</span> arguments <span class="token punctuation">[</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>support<span class="token punctuation">.</span>DefaultMessageSourceResolvable<span class="token operator">:</span> codes <span class="token punctuation">[</span>person<span class="token punctuation">.</span>age<span class="token punctuation">,</span>age<span class="token punctuation">]</span><span class="token punctuation">;</span> arguments <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">default</span> message <span class="token punctuation">[</span>age<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">default</span> message <span class="token punctuation">[</span>必须是正数<span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<p>从打印上看：<strong>校验生效</strong>（拿着错误消息就可以返回前端展示，或者定位到错误页面都行）。</p> 
<p><strong>此例两个小细节务必注意：</strong></p> 
<ol><li><code>@RequestBody</code>注解不能省略，否则传入的json无法完成数据绑定（<strong>即使不绑定，校验也是生效的哦</strong>）~</li><li>若方法入参不写<code>BindingResult result</code>这个参数，请求得到的直接是400错误，因为若有校验失败的服务端会抛出异常<code>org.springframework.web.bind.MethodArgumentNotValidException</code>。若写了，那就调用者自己处理喽~</li></ol> 
<p>据我不完全和不成熟的统计，就这个案例就覆盖了小伙伴们实际使用中的<code>90%</code>以上的真实使用场景，使用起来确实非常的简单、优雅、高效~</p> 
<p>但是作为一个有丰富经验的程序员的你，虽然你使用了<code>@Valid</code>优雅的完成了数据校验，但回头是你是否还会发现你的代码里还是存在了大量的<code>if else</code>的基础的校验？什么原因？<strong>其实根本原因只有一个：很多case使用@Valid并不能覆盖，因为它只能校验JavaBean</strong><br> 我相信你是有这样那样的<strong>使用痛点</strong>的，本文先从原理层面分析，进而给出你所遇到的痛点问题的参考解决参考方案~</p> 
<h3><a id="_83"></a>原理分析</h3> 
<p><code>Controller</code>提供的使用<code>@Valid</code>便捷校验<code>JavaBean</code>的原理，和<strong>Spring方法级别的校验</strong>支持的原理是有很大差异的（可类比<code>Spring MVC</code>拦截器和<code>Spring AOP</code>的差异区别~），那么现在就看看这块吧</p> 
<blockquote> 
 <p>请不要忽视<code>优雅</code>代码的力量，它会成倍提升你的编码效率、成倍降低后期维护成本，甚至成倍提升你的扩展性和成倍降低你写bug的可能性~</p> 
</blockquote> 
<h5><a id="DataBinderWebDataBinder_87"></a>回忆<code>DataBinder</code>/<code>WebDataBinder</code></h5> 
<p>若对<code>Spring</code><strong>数据绑定模块</strong>不是很熟悉的（有阅读过我之前文章的可忽略），建议先补：</p> 
<ol><li><a href="https://blog.csdn.net/f641385712/article/details/96431460">【小家Spring】聊聊Spring中的数据绑定 — DataBinder本尊（源码分析）</a></li><li><a href="https://blog.csdn.net/f641385712/article/details/96450469">【小家Spring】聊聊Spring中的数据绑定 — WebDataBinder、ServletRequestDataBinder、WebBindingInitializer…</a></li></ol> 
<p><code>DataBinder</code>类名叫数据绑定，但它在<code>org.springframework.validation</code>这个包，可见Spring它把数据绑定和数据校验牢牢的放在了一起，并且内部<strong>弱化了数据校验</strong>的概念以及逻辑（<code>Spring</code>想让调用者无需关心<strong>数据校验</strong>的细节，全由它来自动完成，减少使用的成本）。</p> 
<p>我们知道<code>DataBinder</code>它主要对外提供了<code>bind(PropertyValues pvs)</code>和<code>validate()</code>方法，当然还有处理绑定/校验失败的相关（配置）组件：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataBinder</span> <span class="token keyword">implements</span> <span class="token class-name">PropertyEditorRegistry</span><span class="token punctuation">,</span> TypeConverter <span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> AbstractPropertyBindingResult bindingResult<span class="token punctuation">;</span> <span class="token comment">// 它是个BindingResult</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> MessageCodesResolver messageCodesResolver<span class="token punctuation">;</span>
	<span class="token keyword">private</span> BindingErrorProcessor bindingErrorProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultBindingErrorProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 最重要是它：它是org.springframework.validation.Validator</span>
	<span class="token comment">// 一个DataBinder 可以持有对个验证器。也就是说对于一个Bean，是可以交给多个验证器去验证的（当然一般都只有一个即可而已~~~）</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> List<span class="token generics function"><span class="token punctuation">&lt;</span>Validator<span class="token punctuation">&gt;</span></span> validators <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">bind</span><span class="token punctuation">(</span>PropertyValues pvs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		MutablePropertyValues mpvs <span class="token operator">=</span> <span class="token punctuation">(</span>pvs <span class="token keyword">instanceof</span> <span class="token class-name">MutablePropertyValues</span> <span class="token operator">?</span> <span class="token punctuation">(</span>MutablePropertyValues<span class="token punctuation">)</span> pvs <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">MutablePropertyValues</span><span class="token punctuation">(</span>pvs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">doBind</span><span class="token punctuation">(</span>mpvs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		Object target <span class="token operator">=</span> <span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Assert<span class="token punctuation">.</span><span class="token function">state</span><span class="token punctuation">(</span>target <span class="token operator">!=</span> null<span class="token punctuation">,</span> <span class="token string">"No target to validate"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		BindingResult bindingResult <span class="token operator">=</span> <span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
		<span class="token comment">// 拿到所有的验证器  一个个的对此target进行验证~~~</span>
		<span class="token comment">// Call each validator with the same binding result</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>Validator validator <span class="token operator">:</span> <span class="token function">getValidators</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			validator<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> bindingResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>DataBinder</code>提供了这两个非常独立的<strong>原子方法</strong>：绑定 + 校验。他俩结合完成了我们的数据绑定+数据校验，完全的和业务无关~</p> 
<blockquote> 
 <p>网上有很多文章说<code>DataBinder</code>完成数据绑定后继续校验，这种说法是不准确的呀，因为它并不处理这部分的组合逻辑，它只提供原始能力~</p> 
</blockquote> 
<h5><a id="Spring_MVC_129"></a><code>Spring MVC</code>处理入参的时机</h5> 
<p><code>Spring MVC</code>处理入参的逻辑是非常复杂的，前面花大篇幅讲了<code>Spring MVC</code>对返回值的处理器：<code>HandlerMethodReturnValueHandler</code>，详见：<br> <a href="https://blog.csdn.net/f641385712/article/details/90370542">【小家Spring】Spring MVC容器的web九大组件之—HandlerAdapter源码详解—一篇文章带你读懂返回值处理器HandlerMethodReturnValueHandler</a></p> 
<p>同样的，本文只关注它对<code>@RequestBody</code>这种类型的入参进行讲解~<br> 处理入参的处理器：<code>HandlerMethodArgumentResolver</code>，处理<code>@RequestBody</code>最终使用的实现类是：<code>RequestResponseBodyMethodProcessor</code>，<code>Spring</code>借助此处理器完成一系列的消息转换器、数据绑定、数据校验等工作~</p> 
<h6><a id="RequestResponseBodyMethodProcessor_135"></a>RequestResponseBodyMethodProcessor</h6> 
<p>这个类应该是陌生的，在上面推荐的<strong>处理MVC返回值</strong>的文章中有提到过它：它能够处理<code>@ResponseBody</code>注解返回值（请参考它的<code>supportsReturnType()</code>方法~）<br> 它还有另一个能力是：它能够处理请求参数（当然也是标注了<code>@RequestBody</code>它的~）<br> 所以它既是个处理返回值的<code>HandlerMethodReturnValueHandler</code>，有是一个处理入参的<code>HandlerMethodArgumentResolver</code>。所以它命名为<code>Processor</code>而不是<code>Resolver/Handler</code>嘛，这就是命名的艺术~</p> 
<pre><code class="prism language-java"><span class="token comment">// @since 3.1</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestResponseBodyMethodProcessor</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractMessageConverterMethodProcessor</span> <span class="token punctuation">{<!-- --></span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supportsParameter</span><span class="token punctuation">(</span>MethodParameter parameter<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> parameter<span class="token punctuation">.</span><span class="token function">hasParameterAnnotation</span><span class="token punctuation">(</span>RequestBody<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 类上或者方法上标注了@ResponseBody注解都行</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supportsReturnType</span><span class="token punctuation">(</span>MethodParameter returnType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span>AnnotatedElementUtils<span class="token punctuation">.</span><span class="token function">hasAnnotation</span><span class="token punctuation">(</span>returnType<span class="token punctuation">.</span><span class="token function">getContainingClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ResponseBody<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token operator">||</span> returnType<span class="token punctuation">.</span><span class="token function">hasMethodAnnotation</span><span class="token punctuation">(</span>ResponseBody<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 这是处理入参封装校验的入口，也是本文关注的焦点</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> Object <span class="token function">resolveArgument</span><span class="token punctuation">(</span>MethodParameter parameter<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> ModelAndViewContainer mavContainer<span class="token punctuation">,</span>
			NativeWebRequest webRequest<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> WebDataBinderFactory binderFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
		
		<span class="token comment">// 它是支持`Optional`容器的</span>
		parameter <span class="token operator">=</span> parameter<span class="token punctuation">.</span><span class="token function">nestedIfOptional</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 使用消息转换器HttpInputMessage把request请求转换出来，拿到值~~~</span>
		<span class="token comment">// 此处注意：比如本例入参是Person类，所以经过这里处理会生成一个空的Person对象出来（反射）</span>
		Object arg <span class="token operator">=</span> <span class="token function">readWithMessageConverters</span><span class="token punctuation">(</span>webRequest<span class="token punctuation">,</span> parameter<span class="token punctuation">,</span> parameter<span class="token punctuation">.</span><span class="token function">getNestedGenericParameterType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 获取到入参的名称,其实不叫形参名字，应该叫objectName给校验时用的</span>
		<span class="token comment">// 请注意：这里的名称是类名首字母小写，并不是你方法里写的名字。比如本利若形参名写为personAAA，但是name的值还是person</span>
		<span class="token comment">// 但是注意：`parameter.getParameterName()`的值可是personAAA</span>
		String name <span class="token operator">=</span> Conventions<span class="token punctuation">.</span><span class="token function">getVariableNameForParameter</span><span class="token punctuation">(</span>parameter<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 只有存在binderFactory才会去完成自动的绑定、校验~</span>
		<span class="token comment">// 此处web环境为：ServletRequestDataBinderFactory</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>binderFactory <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			WebDataBinder binder <span class="token operator">=</span> binderFactory<span class="token punctuation">.</span><span class="token function">createBinder</span><span class="token punctuation">(</span>webRequest<span class="token punctuation">,</span> arg<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">// 显然传了参数才需要去绑定校验嘛</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>arg <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

				<span class="token comment">// 这里完成数据绑定+数据校验~~~~~（绑定的错误和校验的错误都会放进Errors里）</span>
				<span class="token comment">// Applicable：适合</span>
				<span class="token function">validateIfApplicable</span><span class="token punctuation">(</span>binder<span class="token punctuation">,</span> parameter<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token comment">// 若有错误消息hasErrors()，并且仅跟着的一个参数不是Errors类型，Spring MVC会主动给你抛出MethodArgumentNotValidException异常</span>
				<span class="token comment">// 否则，调用者自行处理</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>binder<span class="token punctuation">.</span><span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isBindExceptionRequired</span><span class="token punctuation">(</span>binder<span class="token punctuation">,</span> parameter<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MethodArgumentNotValidException</span><span class="token punctuation">(</span>parameter<span class="token punctuation">,</span> binder<span class="token punctuation">.</span><span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		
			<span class="token comment">// 把错误消息放进去 证明已经校验出错误了~~~</span>
			<span class="token comment">// 后续逻辑会判断MODEL_KEY_PREFIX这个key的~~~~</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>mavContainer <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				mavContainer<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span>BindingResult<span class="token punctuation">.</span>MODEL_KEY_PREFIX <span class="token operator">+</span> name<span class="token punctuation">,</span> binder<span class="token punctuation">.</span><span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> <span class="token function">adaptArgumentIfNecessary</span><span class="token punctuation">(</span>arg<span class="token punctuation">,</span> parameter<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 校验，如果合适的话。使用WebDataBinder，失败信息最终也都是放在它身上~  本方法是本文关注的焦点</span>
	<span class="token comment">// 入参：MethodParameter parameter</span>
	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">validateIfApplicable</span><span class="token punctuation">(</span>WebDataBinder binder<span class="token punctuation">,</span> MethodParameter parameter<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 拿到标注在此参数上的所有注解们（比如此处有@Valid和@RequestBody两个注解）</span>
		Annotation<span class="token punctuation">[</span><span class="token punctuation">]</span> annotations <span class="token operator">=</span> parameter<span class="token punctuation">.</span><span class="token function">getParameterAnnotations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>Annotation ann <span class="token operator">:</span> annotations<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token comment">// 先看看有木有@Validated</span>
			Validated validatedAnn <span class="token operator">=</span> AnnotationUtils<span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span>ann<span class="token punctuation">,</span> Validated<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">// 这个里的判断是关键：可以看到标注了@Validated注解 或者注解名是以Valid打头的 都会有效哦</span>
			<span class="token comment">//注意：这里可没说必须是@Valid注解。实际上你自定义注解，名称只要一Valid开头都成~~~~~</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>validatedAnn <span class="token operator">!=</span> null <span class="token operator">||</span> ann<span class="token punctuation">.</span><span class="token function">annotationType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"Valid"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token comment">// 拿到分组group后，调用binder的validate()进行校验~~~~</span>
				<span class="token comment">// 可以看到：拿到一个合适的注解后，立马就break了~~~</span>
				<span class="token comment">// 所以若你两个主机都标注@Validated和@Valid，效果是一样滴~</span>
				Object hints <span class="token operator">=</span> <span class="token punctuation">(</span>validatedAnn <span class="token operator">!=</span> null <span class="token operator">?</span> validatedAnn<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> AnnotationUtils<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span>ann<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				Object<span class="token punctuation">[</span><span class="token punctuation">]</span> validationHints <span class="token operator">=</span> <span class="token punctuation">(</span>hints <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token punctuation">(</span>Object<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> hints <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>hints<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				binder<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>validationHints<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>此处有很有意思的两点我总结一下：</p> 
<ol><li><code>DataBinder</code>使传入的<code>objectName</code>并不是形参名（形参名Spring是有这能力可以获取到的），而是类名首字母小写</li><li>关于此处给入参<code>Person</code>类赋值这块，和<code>DataBinder</code>的bind方法没有半毛钱关系~（都是<code>MessageConverters</code>去把值从<code>Request</code>里解析出来封装成对象的）</li></ol> 
<blockquote> 
 <p>数据绑定的<code>bind</code>方法内建的只有一个地方用到了：<code>ServletModelAttributeMethodProcessor</code>。并且使用的还是子类<code>ServletRequestDataBinder</code>的<code>bind(ServletRequest request)</code>方法，父类的<code>bind(PropertyValues pvs)</code>内建都没有被调用过~~~</p> 
</blockquote> 
<p>本文我们只着眼于关注<code>@Valid</code>的数据校验这块，有几个相关的使用小细节，总结如下：</p> 
<ol><li>形参（<code>@RequestBody</code>标注的入参）的<code>name(形参名)</code>和你写什么无关，若是实体类名字就是类名首字母小写。（若是数组、集合等，都会有自己特定的名称）</li><li><code>@Validated</code>和<code>@Valid</code>都能使校验生效，<strong>但却不仅仅是它哥俩才能行</strong>：任何名称是"Valid"打头的<strong>注解</strong>都能使得数据校验生效<br> 1. 自定义注解名称以<code>Valid</code>开头，并且给个<code>value</code>属性同样能够指定<code>Group</code>分组<br> 2. 个人直接建议使用<code>@Validated</code>即可，而去使用<code>@Valid</code>了，更不用自己给自己找麻烦去自定义注解啥的了~</li><li>只有当<code>Errors(BindingResult)</code>入参是是仅跟着<code>@Valid</code>注解的实体，<code>Spring MVC</code>才会把错误消息<strong>放权交给调用者处理</strong>，否则（没有或者不是紧挨着）它会抛出<code>MethodArgumentNotValidException</code>异常~</li></ol> 
<p>这是使用<code>@RequestBody</code>结合<code>@Valid</code>完成数据校验的基本原理。其实当<code>Spring MVC</code>在处理<code>@RequestPart</code>注解入参数据时，也会执行绑定、校验的相关逻辑。对应处理器是<code>RequestPartMethodArgumentResolver</code>，原理大体上和这相似，它主要处理<code>Multipart</code>相关，本文忽略~</p> 
<hr> 
<p><mark>此处提示一个点，此文发出去后有一个好奇的小宝宝问我<strong>入参能使用多个对象并且都用<code>@RequestBody</code>标注吗？</strong></mark><br> 关于这个问题姑且先不考虑合理与否，我们这样做试试：</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> Object <span class="token function">helloPost</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> Person personAAA<span class="token punctuation">,</span> BindingResult result<span class="token punctuation">,</span> <span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> Person personBBB<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>请求却报错了：</p> 
<pre><code class="prism language-java">Resolved <span class="token punctuation">[</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>converter<span class="token punctuation">.</span>HttpMessageNotReadableException<span class="token operator">:</span> I<span class="token operator">/</span>O error <span class="token keyword">while</span> reading input message<span class="token punctuation">;</span> nested exception is java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token operator">:</span> Stream closed<span class="token punctuation">]</span>
</code></pre> 
<p>错误消息很好理解：<strong>请求域的Body体是只能被读取一次的（流只能被读取一次嘛）。</strong><br> 若你是好奇的，你可能还会问：URL参数呢？请求链接<code>?</code>后面的参数呢，如何封装？？？因为本部分内容不是本文的关注点，若有兴趣请出门左拐~</p> 
<blockquote> 
 <p>说明：关于使用Map、List、数组等接受<code>@RequestBody</code>参数的情况类似，区别在于绑定器上，对Map、List的校验前面文章有过讲解，此处就不展开了。</p> 
</blockquote> 
<blockquote> 
 <p>希望读者能掌握这部分内容，因为它和面向使用者比较重要的<code>@InitBinder</code>强关联~~~</p> 
</blockquote> 
<p>实际使用中一般使用<code>@Validated</code>分组校验（若需要），然后结合全局异常的处理方式来友好的对调用者展示错误消息~</p> 
<h5><a id="_261"></a>全局异常处理示例</h5> 
<p>当校验失败时，<code>Spring</code>会抛出<code>MethodArgumentNotValidException</code>异常，该异常会持有校验结果对象<code>BindingResult</code>，从而获得校验失败信息。本处只给示例，仅供参考：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@RestControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MethodArgumentNotValidExceptionHandler</span> <span class="token punctuation">{<!-- --></span>


    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>MethodArgumentNotValidException<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> Result <span class="token function">handleMethodArgumentNotValid</span><span class="token punctuation">(</span>MethodArgumentNotValidException ex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        BindingResult bindingResult <span class="token operator">=</span> ex<span class="token punctuation">.</span><span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        StringBuilder stringBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>FieldError error <span class="token operator">:</span> bindingResult<span class="token punctuation">.</span><span class="token function">getFieldErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            String field <span class="token operator">=</span> error<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Object value <span class="token operator">=</span> error<span class="token punctuation">.</span><span class="token function">getRejectedValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String msg <span class="token operator">=</span> error<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String message <span class="token operator">=</span> String<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"错误字段：%s，错误值：%s，原因：%s；"</span><span class="token punctuation">,</span> field<span class="token punctuation">,</span> value<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            stringBuilder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> Result<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>MsgDefinition<span class="token punctuation">.</span>ILLEGAL_ARGUMENTS<span class="token punctuation">.</span><span class="token function">codeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stringBuilder<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_284"></a>遗留痛点</h3> 
<p>你是否发现，虽然<code>Spring MVC</code>给我们提供了极其方便的数据校验方式，但是它还是有比较大的局限性的：<strong>它要求待校验的入参是JavaBean</strong></p> 
<blockquote> 
 <p>请注意：并不一样要求是请求Body体哦，比如get请求的入参若用JavaBean接收的话，依旧能启用校验</p> 
</blockquote> 
<p>但在实际应用中，其实我们非常多的<code>Controller</code>方法的方法入参是<code>平铺的</code>，也就是所谓的<code>平铺参数</code>，形如这样：</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span><span class="token string">"/hello/id/{id}/status/{status}"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> Object <span class="token function">helloGet</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> Integer id<span class="token punctuation">,</span> <span class="token annotation punctuation">@PathVariable</span> Integer status<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token keyword">return</span> <span class="token string">"hello world"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>其实，特别是get请求的case，<code>@RequestParam</code>入参一般是非常多的（比如分页查询），难道对于这种平铺参数的case，我们真的是能通过人肉<code>if else</code>的去校验吗？<br> 兴许你对此问题有兴趣，那就参阅本文吧，它能给你提供解决方案：<a href="https://blog.csdn.net/f641385712/article/details/97621755">【小家Spring】让Controller支持对平铺参数执行数据校验（默认Spring MVC使用@Valid只能对JavaBean进行校验）</a></p> 
<h5><a id="ValidatedValid_299"></a><mark>@Validated和@Valid的区别</mark></h5> 
<p>如题的问题，我相信是<strong>很多小伙伴都很关心的一个对比</strong>，若你把这个系列都有喵过，那么这个问题的答案就浮出水面了：</p> 
<ol><li><code>@Valid</code>：标准JSR-303规范的标记型注解，用来标记验证属性和方法返回值，进行级联和递归校验</li><li><code>@Validated</code>：<code>Spring</code>的注解，是标准<code>JSR-303</code>的一个变种（补充），提供了一个分组功能，可以在入参验证时，根据不同的分组采用不同的验证机制</li><li>在<code>Controller</code>中校验方法参数时，使用@Valid和@Validated并无特殊差异（若不需要分组校验的话）</li><li><code>@Validated</code>注解可以用于类级别，用于支持Spring进行方法级别的参数校验。<code>@Valid</code>可以用在属性级别约束，用来表示<strong>级联校验</strong>。</li><li><code>@Validated</code>只能用在类、方法和参数上，而<code>@Valid</code>可用于方法、<strong>字段、构造器</strong>和参数上</li></ol> 
<blockquote> 
 <p>最后提示一点：<code>Spring Boot</code>的<code>Web Starter</code>已经加入了<code>Bean Validation</code>以及实现的依赖，可以直接使用。但若是纯<code>Spring MVC</code>环境，请自行导入~</p> 
</blockquote> 
<h5><a id="_309"></a>总结</h5> 
<p>本文介绍的是我们平时使用得最多的数据校验场景：使用<code>@Validated</code>完成<code>Controller</code>的入参校验，实现优雅的处理数据校验。同时希望通过本文能让你彻底弄懂<code>@Validated和@Valid</code>使用上的区别以及联系，在实际生产使用中能够做到更加的得心应手~</p> 
<h5><a id="_311"></a>相关阅读</h5> 
<p><a href="https://blog.csdn.net/f641385712/article/details/96638596">深入了解数据校验：Java Bean Validation 2.0（JSR303、JSR349、JSR380）Hibernate-Validation 6.x使用案例【享学Java】</a><br> <a href="https://blog.csdn.net/f641385712/article/details/97621755">让Controller支持对平铺参数执行数据校验（默认Spring MVC使用@Valid只能对JavaBean进行校验）【享学Spring】</a><br> <a href="https://blog.csdn.net/f641385712/article/details/97402946">Spring方法级别数据校验：@Validated + MethodValidationPostProcessor优雅的完成数据校验动作【享学Spring】</a><br> <a href="https://blog.csdn.net/f641385712/article/details/97968775">Bean Validation完结篇：你必须关注的边边角角（约束级联、自定义约束、自定义校验器、国际化失败消息…）【享学Spring】</a></p> 
<hr> 
<h2><a id="A_318"></a>关注A哥</h2> 
<table><thead><tr><th>Author</th><th><a href="https://www.yourbatman.cn/about" rel="nofollow">A哥(YourBatman)</a></th></tr></thead><tbody><tr><td>个人站点</td><td><a href="https://www.yourbatman.cn" rel="nofollow">www.yourbatman.cn</a></td></tr><tr><td>E-mail</td><td>yourbatman@qq.com</td></tr><tr><td><strong>微 信</strong></td><td><a href="https://www.yourbatman.cn/images/wechat.png" rel="nofollow">fsx641385712</a></td></tr><tr><td><strong><code>活跃平台</code></strong></td><td><a href="https://www.yourbatman.cn" rel="nofollow"><img src="https://images2.imgbox.com/a8/33/yTeaK8M5_o.png" alt=""></a> <a href="https://fangshixiang.blog.csdn.net/" rel="nofollow"><img src="https://images2.imgbox.com/68/f2/5X2wEH5u_o.png" alt=""></a><a href="https://yourbatman.cnblogs.com" rel="nofollow"><img src="https://images2.imgbox.com/10/c4/TPMendkn_o.png" alt=""></a><a href="https://juejin.im/user/5b44d178f265da0fa1220efe/posts" rel="nofollow"><img src="https://images2.imgbox.com/05/25/WhKOCbCJ_o.png" alt=""></a><a href="https://www.zhihu.com/people/fangshixiang/posts" rel="nofollow"><img src="https://images2.imgbox.com/7d/d2/OCp2YKDd_o.png" alt=""></a><a href="https://www.jianshu.com/u/8740f1fdd684" rel="nofollow"><img src="https://images2.imgbox.com/ad/70/35u3iv5M_o.png" alt=""></a><a href="https://segmentfault.com/u/yourbatman/articles" rel="nofollow"><img src="https://images2.imgbox.com/0c/64/WkxjWXQO_o.png" alt=""></a><a href="https://github.com/yourbatman"><img src="https://images2.imgbox.com/ef/b1/yurDls0K_o.png" alt=""></a></td></tr><tr><td><strong>公众号</strong></td><td><a href="https://www.yourbatman.cn/images/wechat_channel.jpg" rel="nofollow">BAT的乌托邦（ID：BAT-utopia）</a></td></tr><tr><td>知识星球</td><td><a href="https://t.zsxq.com/nQBi66I" rel="nofollow">BAT的乌托邦</a></td></tr><tr><td>每日文章推荐</td><td><a href="https://github.com/yourbatman/reading/issues">每日文章推荐</a></td></tr></tbody></table> 
<p><img src="https://images2.imgbox.com/d7/6e/4t6EyNyg_o.gif" alt="BAT的乌托邦"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2234df3be494af894759527d04027131/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">管理系统：登录成功后可以选择自己的角色，并查看角色的工作任务（使用多态和抽象类来完成）...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8a7efc8150d0e7ff625c60a361332bb3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#使用NPOI实现Excel和DataTable的互转</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>