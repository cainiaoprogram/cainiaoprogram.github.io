<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一个奇怪的问题——ImportError: No module named google.protobuf.internal - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="一个奇怪的问题——ImportError: No module named google.protobuf.internal" />
<meta property="og:description" content="编译好pycaffe在import时遇到这个问题：ImportError: No module named google.protobuf.internal
解决方法：
没有anaconda: pip install protobuf （编译caffe就需要这个protobuf）
有anaconda: conda install protobuf (最后装了libprotobuf和protobuf 3.5.2)
======================================================
使用系统自带的python(root下的python，路径为/usr/bin/python)能import这个2.6.1版本的protobuf
使用anaconda自带的python（anaconda2/bin/python）则无法import这个版本的protobuf，可能和protobuf-2.6.1-py2.7-nspkg.pth这个文件有关，内容如下：
import sys, types, os; has_mfs = sys.version_info &gt; (3, 5); p = os.path.join(sys._getframe(1).f_locals[&#39;sitedir&#39;], *(&#39;google&#39;,)); importlib = has_mfs and __import__(&#39;importlib.util&#39;); has_mfs and __import__(&#39;importlib.machinery&#39;); m = has_mfs and sys.modules.setdefault(&#39;google&#39;, importlib.util.module_from_spec(importlib.machinery.PathFinder.find_spec(&#39;google&#39;, [os.path.dirname(p)]))); m = m or sys.modules.setdefault(&#39;google&#39;, types.ModuleType(&#39;google&#39;)); mp = (m or []) and m.__dict__.setdefault(&#39;__path__&#39;,[]); (p not in mp) and mp.append(p) 如果直接from google." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/83f1aafcf2b002e877af48792d5d7216/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-30T11:24:09+08:00" />
<meta property="article:modified_time" content="2018-10-30T11:24:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一个奇怪的问题——ImportError: No module named google.protobuf.internal</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>编译好pycaffe在import时遇到这个问题：ImportError: No module named google.protobuf.internal</p> 
<p>解决方法：</p> 
<p>没有anaconda: pip install protobuf （编译caffe就需要这个protobuf）</p> 
<p>有anaconda: conda install protobuf (最后装了libprotobuf和protobuf 3.5.2)</p> 
<p>======================================================</p> 
<p>使用系统自带的python(root下的python，路径为/usr/bin/python)能import这个2.6.1版本的protobuf</p> 
<p>使用anaconda自带的python（anaconda2/bin/python）则无法import这个版本的protobuf，可能和protobuf-2.6.1-py2.7-nspkg.pth这个文件有关，内容如下：</p> 
<pre class="has"><code class="language-python">import sys, types, os;
has_mfs = sys.version_info &gt; (3, 5);
p = os.path.join(sys._getframe(1).f_locals['sitedir'], *('google',));
importlib = has_mfs and __import__('importlib.util');
has_mfs and __import__('importlib.machinery');
m = has_mfs and sys.modules.setdefault('google', importlib.util.module_from_spec(importlib.machinery.PathFinder.find_spec('google', [os.path.dirname(p)])));
m = m or sys.modules.setdefault('google', types.ModuleType('google'));
mp = (m or []) and m.__dict__.setdefault('__path__',[]);
(p not in mp) and mp.append(p)</code></pre> 
<p>如果直接from google.protobuf.internal import enum_type_wrapper会ImportError: No module named google.protobuf.internal</p> 
<p>这个文件可能定义了import子包的规则，不过奇怪的是anaconda 自带python的pip也是安在这里，就算这样安装成功也没法import。只有用conda install protobuf才能成功import。</p> 
<p>Anaconda官网说：</p> 
<ul><li style="margin-left:0px;">You can download other packages using the <code>pip install</code> command that is installed with Anaconda. <a class="reference external url-external" href="https://conda.io/docs/user-guide/tasks/manage-pkgs.html#installing-non-conda-packages" rel="nofollow">Pip packages</a> provide many of the features of conda packages and in most cases they can work together.</li></ul> 
<p>通过sys.path可以看到protobuf3.5.2被装在anaconda2/lib/python2.7/site-packages里了。</p> 
<p>搞不懂anaconda怎么组织python环境的，就这时候会忽略通过pip安装的protobuf 2.6.1。</p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f646921b31dd08bfc1384c6d8f915bee/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Element-UI可编辑表格的实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/aea4b6e1acc893f6c6ae140af60f7792/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">FinalShell下载地址</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>