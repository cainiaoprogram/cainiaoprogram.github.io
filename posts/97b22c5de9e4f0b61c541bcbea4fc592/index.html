<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python数据分析 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python数据分析" />
<meta property="og:description" content="一、 目的 根据上课讲的吴迪老师的微信好友数据分析，请选择你的微信好友数据，或者你的qq好友数据，或者你的班级同学数据，或者其他你能获取的其他人物数据
作为分析对象。然后利用上课讲的技术，但不限于，对其进行数据分析。比如分析微信好友数据，可以可视化好友男女比例分布，可视化省份来源，可视化签名的情感强度值等等。
要求：1分析数据用xls或者csv格式存储。
2.代码用py文件附件形式上传，方便我的下载。
3.在作业里可以介绍你的主要功能和可视化截图。
4.根据功能完整性和结果的酷给分。
二、项目完成功能总结 1：饼状图统计好友男女比例
2：柱状图学生省份和城市分析
3：分析191,192学生情感
4：柱状图17·18·19级学生男女比例
5：关系图example
6：词云
7：好友省份地图可视化
8：好友城市地图分析
9：好友头像集成大图
10： 微信好友名称分析职业特点
三、前期准备 1、需要用到的库 import os
import math
from PIL import Image
from pyecharts.charts import Pie
from pyecharts.charts import Bar
from pyecharts.charts import WordCloud
#用于设值全局配置和系列配置
from pyecharts import options as opts
import csv
import xlrd
import re
import jieba
from snownlp import SnowNLP
import matplotlib.pyplot as plt
import numpy as np" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/97b22c5de9e4f0b61c541bcbea4fc592/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-18T10:56:56+08:00" />
<meta property="article:modified_time" content="2022-05-18T10:56:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python数据分析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="__0"></a>一、 目的</h2> 
<blockquote> 
 <p>根据上课讲的吴迪老师的微信好友数据分析，请选择你的微信好友数据，或者你的qq好友数据，或者你的班级同学数据，或者其他你能获取的其他人物数据<br> 作为分析对象。然后利用上课讲的技术，但不限于，对其进行数据分析。比如分析微信好友数据，可以可视化好友男女比例分布，可视化省份来源，可视化签名的情感强度值等等。<br> 要求：1分析数据用xls或者csv格式存储。<br> 2.代码用py文件附件形式上传，方便我的下载。<br> 3.在作业里可以介绍你的主要功能和可视化截图。<br> 4.根据功能完整性和结果的酷给分。</p> 
</blockquote> 
<h2><a id="_8"></a>二、项目完成功能总结</h2> 
<blockquote> 
 <p>1：饼状图统计好友男女比例<br> 2：柱状图学生省份和城市分析<br> 3：分析191,192学生情感<br> 4：柱状图17·18·19级学生男女比例<br> 5：关系图example<br> 6：词云<br> 7：好友省份地图可视化<br> 8：好友城市地图分析<br> 9：好友头像集成大图<br> 10： 微信好友名称分析职业特点</p> 
</blockquote> 
<h2><a id="_19"></a>三、前期准备</h2> 
<h3><a id="1_20"></a>1、需要用到的库</h3> 
<blockquote> 
 <p>import os<br> import math<br> from PIL import Image<br> from pyecharts.charts import Pie<br> from pyecharts.charts import Bar<br> from pyecharts.charts import WordCloud<br> #用于设值全局配置和系列配置<br> from pyecharts import options as opts<br> import csv<br> import xlrd<br> import re<br> import jieba<br> from snownlp import SnowNLP<br> import matplotlib.pyplot as plt<br> import numpy as np<br> from pyecharts.charts import Graph<br> from collections import Counter<br> from pyecharts.charts import Map<br> from pyecharts.charts import Geo<br> from pyecharts.charts import Gauge<br> from pyecharts.charts import Liquid</p> 
</blockquote> 
<h3><a id="2_42"></a>2、文档</h3> 
<p><img src="https://images2.imgbox.com/e1/29/DIzU48Sy_o.png" alt="请添加图片描述">提示：【qingxu.txt文本里就两个词语：积极（换行\n）消极；img文件夹里随便放微信头像或网上找的照片即可】</p> 
<h2><a id="_44"></a>四、代码展示</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
Autor: 何邦渊 
DateTime: 2022/4/22 22:08
IDE: PyCharm  
Function: 根据上课讲的吴迪老师的微信好友数据分析，请选择你的微信好友数据，或者你的qq好友数据，或者你的班级同学数据，或者其他你能获取的其他人物数据
          作为分析对象。然后利用上课讲的技术，但不限于，对其进行数据分析。比如分析微信好友数据，可以可视化好友男女比例分布，可视化省份来源，可视化签名的情感强度值等等。
          要求：1分析数据用xls或者csv格式存储。
          2.代码用py文件附件形式上传，方便我的下载。
          3.在作业里可以介绍你的主要功能和可视化截图。
          4.根据功能完整性和结果的酷给分。
'''</span>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> math
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Pie
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Bar
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> WordCloud
<span class="token comment">#用于设值全局配置和系列配置</span>
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts
<span class="token keyword">import</span> csv
<span class="token keyword">import</span> xlrd
<span class="token keyword">import</span> re
<span class="token keyword">import</span> jieba
<span class="token keyword">from</span> snownlp <span class="token keyword">import</span> SnowNLP
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Graph
<span class="token keyword">from</span> collections <span class="token keyword">import</span> Counter
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Map
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Geo
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Gauge
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Liquid
<span class="token triple-quoted-string string">'''
    例子1：饼状图统计好友男女比例
'''</span>
<span class="token comment"># 1.1 读取csv文件,把性别信息读取出来</span>
<span class="token keyword">def</span> <span class="token function">getSex</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstsex <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fr<span class="token punctuation">:</span>
        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>fr<span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
            lstsex<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> lstsex
<span class="token comment"># 1.2 性别pyecharts可视化</span>
<span class="token keyword">def</span> <span class="token function">VisualSexpyechart</span><span class="token punctuation">(</span>lstsex<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sex <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.1 提取好友性别信息,从1开始，因为第0个是自己</span>
    <span class="token keyword">for</span> f <span class="token keyword">in</span> lstsex<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> f <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token comment"># 男</span>
            sex<span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span> <span class="token operator">=</span> sex<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'man'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">elif</span> f<span class="token operator">==</span> <span class="token string">'2'</span><span class="token punctuation">:</span> <span class="token comment"># 女</span>
            sex<span class="token punctuation">[</span><span class="token string">'women'</span><span class="token punctuation">]</span> <span class="token operator">=</span> sex<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'women'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment"># 未知</span>
            sex<span class="token punctuation">[</span><span class="token string">'unknown'</span><span class="token punctuation">]</span> <span class="token operator">=</span> sex<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'unknown'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token comment"># 在屏幕上打印出来</span>
    total <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lstsex<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.2打印出自己的好友性别比例</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"男性好友：%.2f%%"</span> <span class="token operator">%</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>sex<span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> total<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span> <span class="token string">"女性好友：%.2f%%"</span> <span class="token operator">%</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>sex<span class="token punctuation">[</span><span class="token string">'women'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> total<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">+</span>
          <span class="token string">"不明性别好友：%.2f%%"</span> <span class="token operator">%</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>sex<span class="token punctuation">[</span><span class="token string">'unknown'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> total<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.3使用pyecharts饼状图</span>
    attr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'男性好友'</span><span class="token punctuation">,</span><span class="token string">'女性好友'</span><span class="token punctuation">,</span><span class="token string">'不明性别好友'</span><span class="token punctuation">]</span>
    value <span class="token operator">=</span> <span class="token punctuation">[</span>sex<span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sex<span class="token punctuation">[</span><span class="token string">'women'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sex<span class="token punctuation">[</span><span class="token string">'unknown'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token comment"># 饼图用的数据格式是[(key1,value1),(key2,value2)]，所以先使用 zip函数将二者进行组合</span>
    data_pair <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">list</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token keyword">for</span> z <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>attr<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token comment"># 初始化配置项，内部可设置颜色</span>
    <span class="token punctuation">(</span>
        Pie<span class="token punctuation">(</span>init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>bg_color<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add<span class="token punctuation">(</span>
            <span class="token comment"># 系列名称，即该饼图的名称</span>
            series_name<span class="token operator">=</span><span class="token string">"性别分析"</span><span class="token punctuation">,</span>
            <span class="token comment"># 系列数据项，格式为[(key1,value1),(key2,value2)]</span>
            data_pair<span class="token operator">=</span>data_pair<span class="token punctuation">,</span>
            <span class="token comment"># 通过半径区分数据大小 “radius” 和 “area” 两种</span>
            rosetype<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span>
            <span class="token comment"># 饼图的半径，设置成默认百分比，相对于容器高宽中较小的一项的一半</span>
            radius<span class="token operator">=</span><span class="token string">"55%"</span><span class="token punctuation">,</span>
            <span class="token comment"># 饼图的圆心，第一项是相对于容器的宽度，第二项是相对于容器的高度</span>
            center<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"50%"</span><span class="token punctuation">,</span> <span class="token string">"50%"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token comment"># 标签配置项</span>
            label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> position<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token comment"># 全局设置</span>
        <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
            <span class="token comment"># 设置标题</span>
            title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>
                <span class="token comment"># 名字</span>
                title<span class="token operator">=</span><span class="token string">"微信好友性别比例"</span><span class="token punctuation">,</span>
                <span class="token comment"># 组件距离容器左侧的位置</span>
                pos_left<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">,</span>
                <span class="token comment"># 组件距离容器上方的像素值</span>
                pos_top<span class="token operator">=</span><span class="token string">"20"</span><span class="token punctuation">,</span>
                <span class="token comment"># 设置标题颜色</span>
                title_textstyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TextStyleOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment"># 图例配置项，参数 是否显示图里组件</span>
            legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token comment"># 系列设置</span>
        <span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
            tooltip_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TooltipOpts<span class="token punctuation">(</span>
                trigger<span class="token operator">=</span><span class="token string">"item"</span><span class="token punctuation">,</span> formatter<span class="token operator">=</span><span class="token string">"{a} &lt;br/&gt;{b}: {c} ({d}%)"</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment"># 设置标签颜色</span>
            label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'好友性别比例.html'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token comment"># 1.3 性别pyecharts 柱状图可视化</span>
<span class="token keyword">def</span> <span class="token function">VisualSexpyechart2</span><span class="token punctuation">(</span>lstsex<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sex <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.1 提取好友性别信息,从1开始，因为第0个是自己</span>
    <span class="token keyword">for</span> f <span class="token keyword">in</span> lstsex<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> f <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>  <span class="token comment"># 男</span>
            sex<span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span> <span class="token operator">=</span> sex<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'man'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">elif</span> f <span class="token operator">==</span> <span class="token string">'2'</span><span class="token punctuation">:</span>  <span class="token comment"># 女</span>
            sex<span class="token punctuation">[</span><span class="token string">'women'</span><span class="token punctuation">]</span> <span class="token operator">=</span> sex<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'women'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># 未知</span>
            sex<span class="token punctuation">[</span><span class="token string">'unknown'</span><span class="token punctuation">]</span> <span class="token operator">=</span> sex<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'unknown'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token comment"># 在屏幕上打印出来</span>
    total <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lstsex<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.2打印出自己的好友性别比例</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>
        <span class="token string">"男性好友：%.2f%%"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>sex<span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> total <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span> <span class="token string">"女性好友：%.2f%%"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>
                <span class="token builtin">float</span><span class="token punctuation">(</span>sex<span class="token punctuation">[</span><span class="token string">'women'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> total <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span>
        <span class="token string">"不明性别好友：%.2f%%"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>sex<span class="token punctuation">[</span><span class="token string">'unknown'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> total <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.3使用pyecharts饼状图</span>
    attr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'男性好友'</span><span class="token punctuation">,</span> <span class="token string">'女性好友'</span><span class="token punctuation">,</span> <span class="token string">'不明性别好友'</span><span class="token punctuation">]</span>
    value <span class="token operator">=</span> <span class="token punctuation">[</span>sex<span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sex<span class="token punctuation">[</span><span class="token string">'women'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sex<span class="token punctuation">[</span><span class="token string">'unknown'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token comment"># # 饼图用的数据格式是[(key1,value1),(key2,value2)]，所以先使用 zip函数将二者进行组合</span>
    <span class="token comment"># data_pair = [list(z) for z in zip(attr, value)]</span>
    <span class="token comment"># 初始化配置项，内部可设置颜色</span>
    bar <span class="token operator">=</span> <span class="token punctuation">(</span>
        Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>attr<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">"amount"</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
            title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'微信数据分析'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            yaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"amount"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"sex"</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>

    <span class="token punctuation">)</span><span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'好友性别比例2.html'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
    例子2：柱状图学生省份和城市分析
'''</span>
<span class="token comment"># 2.1读取省份信息</span>
<span class="token keyword">def</span> <span class="token function">getProvince</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    Province1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    Province2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    Province3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    flag <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> filename_kid <span class="token keyword">in</span> filename<span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> <span class="token number">1</span>
        rd <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>filename_kid<span class="token punctuation">)</span>
        all_sheet <span class="token operator">=</span> rd<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> sheet_kid <span class="token keyword">in</span> all_sheet<span class="token punctuation">:</span>
            table <span class="token operator">=</span> rd<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span>sheet_kid<span class="token punctuation">)</span>
            nrows <span class="token operator">=</span> table<span class="token punctuation">.</span>nrows
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nrows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                province <span class="token operator">=</span> table<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
                <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                    Province1<span class="token punctuation">[</span>province<span class="token punctuation">]</span> <span class="token operator">=</span> Province1<span class="token punctuation">.</span>get<span class="token punctuation">(</span>province<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                    Province2<span class="token punctuation">[</span>province<span class="token punctuation">]</span> <span class="token operator">=</span> Province2<span class="token punctuation">.</span>get<span class="token punctuation">(</span>province<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    Province3<span class="token punctuation">[</span>province<span class="token punctuation">]</span> <span class="token operator">=</span> Province3<span class="token punctuation">.</span>get<span class="token punctuation">(</span>province<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Province1<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Province2<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Province3<span class="token punctuation">)</span>
    <span class="token keyword">return</span> a
<span class="token comment"># 2.2省份可视化</span>
<span class="token keyword">def</span> <span class="token function">Provincepyechart</span><span class="token punctuation">(</span>province_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    province_dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'黑龙江'</span><span class="token punctuation">,</span> <span class="token string">'四川'</span><span class="token punctuation">,</span> <span class="token string">'天津'</span><span class="token punctuation">,</span> <span class="token string">'内蒙古'</span><span class="token punctuation">,</span> <span class="token string">'江苏'</span><span class="token punctuation">,</span> <span class="token string">'海南'</span><span class="token punctuation">,</span> <span class="token string">'辽宁'</span><span class="token punctuation">,</span> <span class="token string">'陕西'</span><span class="token punctuation">,</span> <span class="token string">'浙江'</span><span class="token punctuation">,</span> <span class="token string">'河南'</span><span class="token punctuation">,</span> <span class="token string">'山西'</span><span class="token punctuation">,</span> <span class="token string">'湖北'</span><span class="token punctuation">,</span> <span class="token string">'广西'</span><span class="token punctuation">,</span> <span class="token string">'重庆'</span><span class="token punctuation">,</span> <span class="token string">'吉林'</span><span class="token punctuation">,</span> <span class="token string">'贵州'</span><span class="token punctuation">,</span>
                     <span class="token string">'云南'</span><span class="token punctuation">,</span> <span class="token string">'河北'</span><span class="token punctuation">,</span> <span class="token string">'山东'</span><span class="token punctuation">]</span>
    province1_dict <span class="token operator">=</span> province_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    province2_dict <span class="token operator">=</span> province_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    province3_dict <span class="token operator">=</span> province_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    province1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    province2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    province3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> province1_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        province1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> province2_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        province2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> province3_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        province3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>province1<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>province2<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>province3<span class="token punctuation">)</span>
    bar <span class="token operator">=</span> <span class="token punctuation">(</span>
        Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>province_dict<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件17学生'</span><span class="token punctuation">,</span> value1<span class="token punctuation">)</span>

            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件18学生'</span><span class="token punctuation">,</span> value2<span class="token punctuation">)</span>

            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件19学生'</span><span class="token punctuation">,</span> value3<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"17,18,19级学生省份分析"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                             xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>
                                 axislabel_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>
                                     rotate<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">,</span>  <span class="token comment"># Optional[Numeric]</span>
                                 <span class="token punctuation">)</span>
                             <span class="token punctuation">)</span>
                             <span class="token punctuation">)</span><span class="token punctuation">)</span>
    bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'17,18,19级学生省份分析.html'</span><span class="token punctuation">)</span>
<span class="token comment"># 2.3读取城市信息</span>
<span class="token keyword">def</span> <span class="token function">getCity</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    City1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    City2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    City3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    flag <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> filename_kid <span class="token keyword">in</span> filename<span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> <span class="token number">1</span>
        rd <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>filename_kid<span class="token punctuation">)</span>
        all_sheet <span class="token operator">=</span> rd<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> sheet_kid <span class="token keyword">in</span> all_sheet<span class="token punctuation">:</span>
            table <span class="token operator">=</span> rd<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span>sheet_kid<span class="token punctuation">)</span>
            nrows <span class="token operator">=</span> table<span class="token punctuation">.</span>nrows
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nrows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                City <span class="token operator">=</span> table<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
                <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                    City1<span class="token punctuation">[</span>City<span class="token punctuation">]</span> <span class="token operator">=</span> City1<span class="token punctuation">.</span>get<span class="token punctuation">(</span>City<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                    City2<span class="token punctuation">[</span>City<span class="token punctuation">]</span> <span class="token operator">=</span> City2<span class="token punctuation">.</span>get<span class="token punctuation">(</span>City<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    City3<span class="token punctuation">[</span>City<span class="token punctuation">]</span> <span class="token operator">=</span> City3<span class="token punctuation">.</span>get<span class="token punctuation">(</span>City<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>City1<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>City2<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>City3<span class="token punctuation">)</span>
    <span class="token keyword">return</span> a
<span class="token comment"># 2.4城市可视化</span>
<span class="token keyword">def</span> <span class="token function">cityPyechart</span><span class="token punctuation">(</span>city_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    city_dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'鸡西'</span><span class="token punctuation">,</span> <span class="token string">'泰安'</span><span class="token punctuation">,</span> <span class="token string">'阜阳'</span><span class="token punctuation">,</span> <span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token string">'兰州'</span><span class="token punctuation">,</span> <span class="token string">'深圳'</span><span class="token punctuation">,</span> <span class="token string">'阳春'</span><span class="token punctuation">,</span> <span class="token string">'开封'</span><span class="token punctuation">,</span> <span class="token string">'周口'</span><span class="token punctuation">,</span> <span class="token string">'哈尔滨'</span><span class="token punctuation">,</span> <span class="token string">'齐齐哈尔'</span><span class="token punctuation">,</span> <span class="token string">'鹤岗'</span><span class="token punctuation">,</span> <span class="token string">'大庆'</span><span class="token punctuation">,</span> <span class="token string">'佳木斯'</span><span class="token punctuation">,</span> <span class="token string">'宜昌'</span><span class="token punctuation">,</span> <span class="token string">'怀化'</span><span class="token punctuation">,</span>
                 <span class="token string">'常德'</span><span class="token punctuation">,</span> <span class="token string">'德州'</span><span class="token punctuation">,</span> <span class="token string">'临沂'</span><span class="token punctuation">,</span> <span class="token string">'朔州'</span><span class="token punctuation">,</span> <span class="token string">'临汾'</span><span class="token punctuation">,</span> <span class="token string">'天津'</span><span class="token punctuation">,</span> <span class="token string">'温州市'</span><span class="token punctuation">,</span> <span class="token string">'重庆'</span><span class="token punctuation">,</span> <span class="token string">'上饶'</span><span class="token punctuation">,</span> <span class="token string">'金华'</span><span class="token punctuation">,</span> <span class="token string">'石家庄'</span><span class="token punctuation">,</span> <span class="token string">'巴中'</span><span class="token punctuation">,</span> <span class="token string">'咸阳'</span><span class="token punctuation">,</span> <span class="token string">'信阳'</span><span class="token punctuation">]</span>
    city1_dict <span class="token operator">=</span> city_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    city2_dict <span class="token operator">=</span> city_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    city3_dict <span class="token operator">=</span> city_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    city1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    city2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    city3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> city1_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        city1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> city2_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        city2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> city3_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        city3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>city1<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>city2<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>city3<span class="token punctuation">)</span>
    bar <span class="token operator">=</span> <span class="token punctuation">(</span>
        Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>city_dict<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件17学生'</span><span class="token punctuation">,</span> value1<span class="token punctuation">)</span>

            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件18学生'</span><span class="token punctuation">,</span> value2<span class="token punctuation">)</span>

            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件19学生'</span><span class="token punctuation">,</span> value3<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"17,18,19级学生省份分析"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                             xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>
                                 axislabel_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>
                                     rotate<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">,</span>  <span class="token comment"># Optional[Numeric]</span>
                                 <span class="token punctuation">)</span>
                             <span class="token punctuation">)</span>
                             <span class="token punctuation">)</span><span class="token punctuation">)</span>
    bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'17,18,19级学生城市分析.html'</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
    例子3：分析191,192学生情感
'''</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token comment"># 3.1 读取Excel表格，保存txt文件词性，分析情感强度</span>
<span class="token keyword">def</span> <span class="token function">getStrong</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>save<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding_override<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    tables <span class="token operator">=</span> data<span class="token punctuation">.</span>sheets<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tables<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">list</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        rows <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">.</span>nrows
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> j<span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            name<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">.</span>row_values<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">.</span>row_values<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>save<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        i <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> ld <span class="token keyword">in</span> temp<span class="token punctuation">:</span>
            signature <span class="token operator">=</span> ld<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"emoji"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>
            rec <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">"lf\d+\w*|[&lt;&gt;/=]]"</span><span class="token punctuation">)</span>
            signature <span class="token operator">=</span> rec<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span>signature<span class="token punctuation">)</span>
            <span class="token keyword">if</span> signature <span class="token operator">!=</span> <span class="token string">""</span><span class="token punctuation">:</span>
                <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>name<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">" : "</span> <span class="token operator">+</span>signature<span class="token punctuation">)</span>
                s <span class="token operator">=</span> SnowNLP<span class="token punctuation">(</span>signature<span class="token punctuation">)</span>
                <span class="token keyword">if</span> s<span class="token punctuation">.</span>sentiments <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">:</span>
                    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">" : 积极！\n"</span><span class="token punctuation">)</span>
                <span class="token keyword">elif</span> s<span class="token punctuation">.</span>sentiments <span class="token operator">&lt;=</span> <span class="token number">0.5</span><span class="token punctuation">:</span>
                    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">" : 消极！\n"</span><span class="token punctuation">)</span>
                i<span class="token operator">+=</span><span class="token number">1</span>
<span class="token comment"># 3.2 统计两个班级积极与消极数量</span>
<span class="token keyword">def</span> <span class="token function">counter</span><span class="token punctuation">(</span>save<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># https://blog.csdn.net/weixin_38762584/article/details/115023975</span>
    <span class="token comment"># f’{}’ 用法等同于 format用法的简单使用，更加方便</span>
    txt <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>save<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    need_words <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./qingxu.txt"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    find <span class="token operator">=</span> need_words<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
    jieba<span class="token punctuation">.</span>load_userdict<span class="token punctuation">(</span><span class="token string">'./qingxu.txt'</span><span class="token punctuation">)</span>
    words <span class="token operator">=</span> jieba<span class="token punctuation">.</span>lcut<span class="token punctuation">(</span>txt<span class="token punctuation">)</span>
    counts <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> word <span class="token keyword">in</span> words<span class="token punctuation">:</span>
        counts<span class="token punctuation">[</span>word<span class="token punctuation">]</span> <span class="token operator">=</span> counts<span class="token punctuation">.</span>get<span class="token punctuation">(</span>word<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    lst<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>find<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span> <span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>find<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>counts<span class="token punctuation">[</span>find<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            lst<span class="token punctuation">.</span>append<span class="token punctuation">(</span>find<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    a <span class="token operator">=</span> counts<span class="token punctuation">[</span>find<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    b <span class="token operator">=</span> counts<span class="token punctuation">[</span>find<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> a<span class="token punctuation">,</span>b

<span class="token triple-quoted-string string">'''
    例子4：柱状图17·18·19级学生男女比例
'''</span>
<span class="token comment"># 4.1 读取xls文件,把性别信息读取出来</span>
<span class="token keyword">def</span> <span class="token function">getProvince1</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    Province1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    Province2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    Province3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    flag <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> filename_kid <span class="token keyword">in</span> filename<span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> <span class="token number">1</span>
        rd <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook_xls<span class="token punctuation">(</span>filename_kid<span class="token punctuation">)</span>   <span class="token comment">#xlrd.open_workbook()不支持xls文件</span>
        all_sheet <span class="token operator">=</span> rd<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> sheet_kid <span class="token keyword">in</span> all_sheet<span class="token punctuation">:</span>
            table <span class="token operator">=</span> rd<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span>sheet_kid<span class="token punctuation">)</span>
            nrows <span class="token operator">=</span> table<span class="token punctuation">.</span>nrows
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nrows<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                province <span class="token operator">=</span> table<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
                <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                    Province1<span class="token punctuation">[</span>province<span class="token punctuation">]</span> <span class="token operator">=</span> Province1<span class="token punctuation">.</span>get<span class="token punctuation">(</span>province<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                    Province2<span class="token punctuation">[</span>province<span class="token punctuation">]</span> <span class="token operator">=</span> Province2<span class="token punctuation">.</span>get<span class="token punctuation">(</span>province<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    Province3<span class="token punctuation">[</span>province<span class="token punctuation">]</span> <span class="token operator">=</span> Province3<span class="token punctuation">.</span>get<span class="token punctuation">(</span>province<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Province1<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Province2<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Province3<span class="token punctuation">)</span>
    <span class="token keyword">return</span> a

<span class="token comment"># 4.2 性别可视化</span>
<span class="token keyword">def</span> <span class="token function">VisualSexpyechart1</span><span class="token punctuation">(</span>province_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    province1_dict <span class="token operator">=</span> province_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    province2_dict <span class="token operator">=</span> province_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    province3_dict <span class="token operator">=</span> province_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    province1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    province2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    province3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span>value <span class="token keyword">in</span> province1_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        province1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span>value <span class="token keyword">in</span> province2_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        province2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span>value <span class="token keyword">in</span> province3_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        province3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>province1<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>province2<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>province3<span class="token punctuation">)</span>
    bar <span class="token operator">=</span> <span class="token punctuation">(</span>
        Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>province1<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件17学生'</span><span class="token punctuation">,</span> value1<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'lightblue'</span><span class="token punctuation">)</span>

            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件18学生'</span><span class="token punctuation">,</span> value2<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'lightgreen'</span><span class="token punctuation">)</span>

            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件19学生'</span><span class="token punctuation">,</span> value3<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'purple'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"17,18,19级学生性别分析"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'17,18,19级学生性别分析.html'</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
    例子5：关系图example
'''</span>
<span class="token comment"># 5.1 数据</span>
<span class="token keyword">def</span> <span class="token function">getRoom</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    Room<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    data<span class="token operator">=</span>xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding_override<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    table<span class="token operator">=</span>data<span class="token punctuation">.</span>sheets<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    rows<span class="token operator">=</span>table<span class="token punctuation">.</span>nrows
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
           <span class="token keyword">continue</span>
        Room<span class="token punctuation">[</span>table<span class="token punctuation">.</span>row_values<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span>table<span class="token punctuation">.</span>row_values<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>
    <span class="token comment">#print(Room)</span>
    <span class="token keyword">return</span> Room
<span class="token comment"># 5.2 关系图</span>
<span class="token keyword">def</span> <span class="token function">RoomSee</span><span class="token punctuation">(</span>Room<span class="token punctuation">)</span><span class="token punctuation">:</span>
    nodes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> Room<span class="token punctuation">:</span>
        nodes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span>i<span class="token punctuation">,</span><span class="token string">"symbolSize"</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment"># print(nodes)</span>
    links<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> Room<span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> Room<span class="token punctuation">:</span>
            <span class="token keyword">if</span> Room<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>Room<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>
               links<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"source"</span><span class="token punctuation">:</span>i<span class="token punctuation">,</span><span class="token string">"target"</span><span class="token punctuation">:</span>j<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>links<span class="token punctuation">)</span>
    c<span class="token operator">=</span> <span class="token punctuation">(</span>
        Graph<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> nodes<span class="token punctuation">,</span> links<span class="token punctuation">,</span>
             categories<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>  <span class="token comment"># 结点分类的类目，结点可以指定分类，也可以不指定。</span>
             is_focusnode<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 是否在鼠标移到节点上的时候突出显示节点以及节点的边和邻接节点。默认为 True</span>
             is_roam<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
             is_rotate_label<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 是否旋转标签，默认为 False</span>
             layout<span class="token operator">=</span><span class="token string">"force"</span><span class="token punctuation">,</span>  <span class="token comment"># 布局类型，默认force=力引导图，circular=环形布局</span>
             edge_length<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>  <span class="token comment"># 力布局下边的两个节点之间的距离，这个距离也会受 repulsion 影响。默认为 50，TODO 值越大则长度越长</span>
             gravity<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token comment"># 点受到的向中心的引力因子。TODO 该值越大节点越往中心点靠拢。默认为 0.2</span>
             repulsion<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>  <span class="token comment"># 节点之间的斥力因子。默认为 50，TODO 值越大则斥力越大</span>
             label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             linestyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LineStyleOpts<span class="token punctuation">(</span>curve<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 线的弯曲度</span>
             <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"Graph-基本示例"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"./关系图系列.html"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
    例子6：词云
'''</span>
<span class="token comment"># 6.1 数据</span>
<span class="token keyword">def</span> <span class="token function">getInfo</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstdata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fr<span class="token punctuation">:</span>
        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>fr<span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
            <span class="token keyword">if</span> i<span class="token operator">!=</span><span class="token string">''</span><span class="token punctuation">:</span>
                lstdata<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./sign.txt'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> ld <span class="token keyword">in</span> lstdata<span class="token punctuation">:</span>
            signature <span class="token operator">=</span> ld<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"emoji"</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
            rec <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">"lf\d+\w*|[&lt;&gt;/=]"</span><span class="token punctuation">)</span>
            signature <span class="token operator">=</span> rec<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span>signature<span class="token punctuation">)</span>
            <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>signature<span class="token operator">+</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
            <span class="token triple-quoted-string string">'''
            signature = rec.sub("", signature)
            if signature!="":
                s = SnowNLP(signature)
                if s.sentiments &gt; 0.6:
                    file.write('情感分析：积极!****')
                elif s.sentiments &lt; 0.4:
                    file.write('情感分析：消极!****')
                else:
                    file.write('情感分析：中性佛系!****')
                file.write(signature + "\n")
            '''</span>
<span class="token comment"># 6.2 生成云图</span>
<span class="token keyword">def</span> <span class="token function">create_word_cloud</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 读取文件内容</span>
    <span class="token triple-quoted-string string">'''在一个程序中，我想创建一个文本文件（.txt），文件名包含一个字符串（它被分配给一个名为FileName的变量）。除了文件名中的字符串外，还有一个前缀：“Special file:”。在代码中，我像平常一样写前缀，但是为了包含变量赋值字符串，我使用.format（）。在
        代码：
        FileName = 'XYZ'
        ActiveFile = open('Special File: {0}.txt'.format(FileName), 'a')'''</span>
    text <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./{}.txt"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 结巴分词,精确模式</span>
    wordlist <span class="token operator">=</span> jieba<span class="token punctuation">.</span>lcut<span class="token punctuation">(</span>text<span class="token punctuation">,</span>cut_all<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    counts <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> <span class="token comment"># 通过键值对的形式存储词语及其出现的次数</span>
    words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> word <span class="token keyword">in</span> wordlist<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token comment"># 单个词语不计算在内</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            counts<span class="token punctuation">[</span>word<span class="token punctuation">]</span> <span class="token operator">=</span> counts<span class="token punctuation">.</span>get<span class="token punctuation">(</span>word<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token comment"># 遍历所有词语，每出现一次其对应的值加1</span>

    <span class="token keyword">for</span> key<span class="token punctuation">,</span>value <span class="token keyword">in</span> counts<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        words<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token triple-quoted-string string">'''
    items = list(counts.item()) # 将键值对转化成列表
    print(items)
    items.sort(key = lambda x:x[1],reverse=True) # 根据词语出现的次数进行从小到大排序
    for i in range(5):
        word,count = items[i]
        print("{0:&lt;5}{1:&gt;5}".format(word,count))
    '''</span>
    <span class="token comment"># wordcloud2 = WordCloud(width = 1300,height = 620)</span>
    <span class="token comment"># wordcloud2.add("",name,value,word_size_range = [10,100],shape = 'diamond')</span>

    w <span class="token operator">=</span> <span class="token punctuation">(</span>
        WordCloud<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span>words<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"词云"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'./变形词云.html'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token comment"># wordcloud2.show_config()</span>
    <span class="token comment"># wordcloud2.render(path='./data/05=02变形词云.html')</span>

<span class="token triple-quoted-string string">'''
    例子7：好友省份地图可视化
'''</span>
<span class="token comment"># 7.1 获取数据</span>
<span class="token keyword">def</span> <span class="token function">getInfo1</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstdata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fr<span class="token punctuation">:</span>
        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>fr<span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
            lstdata<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> lstdata
<span class="token comment"># 7.2 根据数据生成省份地图</span>
<span class="token keyword">def</span> <span class="token function">province_Map</span><span class="token punctuation">(</span>lstprovince<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstprovincenew <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># 2.1 去掉空白的项</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> lstprovince<span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">" "</span><span class="token punctuation">:</span><span class="token keyword">pass</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span> lstprovincenew<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token comment"># 2.2 统计每个城市出现的次数</span>
    data <span class="token operator">=</span> Counter<span class="token punctuation">(</span>lstprovincenew<span class="token punctuation">)</span><span class="token punctuation">.</span>most_common<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token comment"># 使用Counter类统计出现的次数，并转换为元组列表</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token comment"># 2.3 根据省份数据生成地图</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token comment"># Map() 里通过添加 init_opts 参数可以配置初始化画布大小。</span>
        <span class="token comment"># Map(init_opts=opts.InitOpts(height="1000px", width="1500px"))</span>
        Map<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add<span class="token punctuation">(</span>
                series_name<span class="token operator">=</span><span class="token string">"好友省份"</span><span class="token punctuation">,</span>
                data_pair<span class="token operator">=</span>data<span class="token punctuation">,</span>
                maptype<span class="token operator">=</span><span class="token string">'china'</span><span class="token punctuation">,</span> <span class="token comment"># china-cities</span>
                is_selected<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                <span class="token comment"># 是否启用鼠标滚轮缩放和拖动平移，默认为True</span>
                is_roam<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                <span class="token comment"># 是否显示图形标记，默认为True</span>
                is_map_symbol_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                <span class="token comment"># 图元样式配置</span>
                <span class="token comment"># 图元样式配置的 areaColor 为区域颜色， borderColor 为边框颜色，</span>
                <span class="token comment"># 其中 normal 为常规模式下的，emphasis 为强调样式下的，即鼠标移动到区域上的显示。</span>
                itemstyle_opts<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
                    <span class="token comment"># 常规显示</span>
                    <span class="token string">"normal"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"areaColor"</span><span class="token punctuation">:</span> <span class="token string">"white"</span><span class="token punctuation">,</span> <span class="token string">"borderColor"</span><span class="token punctuation">:</span> <span class="token string">"red"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token comment"># 强调颜色</span>
                    <span class="token string">"emphasis"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"areaColor"</span><span class="token punctuation">:</span> <span class="token string">"rgba(0,0,0,1)"</span><span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
                <span class="token comment"># 设置标题</span>
                title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>
                    <span class="token comment"># 主标题</span>
                    title<span class="token operator">=</span><span class="token string">"省份地图"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 副标题</span>
                    subtitle<span class="token operator">=</span><span class="token string">"吴迪的好友省份数据"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 组件距离容器左侧的位置</span>
                    pos_left<span class="token operator">=</span><span class="token string">"left"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 组件距离容器上方的像素值</span>
                    pos_top<span class="token operator">=</span><span class="token string">"20"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 设置标题颜色</span>
                    title_textstyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TextStyleOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">"#404a59"</span><span class="token punctuation">,</span>font_size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token comment"># 图例配置项，参数 是否显示图里组件</span>
                legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token comment"># 设置分段显示</span>
                visualmap_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>VisualMapOpts<span class="token punctuation">(</span>max_<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">,</span> is_piecewise<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token comment"># 关闭标签(地图上的省份名称)名称显示,系列配置项里的标签加上color="bule" 参数可设置标签颜色为蓝色。</span>
            <span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
                label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>
                    is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                    color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"./吴迪好友省份分布.html"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
    例子8：好友城市地图分析
'''</span>
<span class="token comment"># 8.1 获取数据</span>
<span class="token keyword">def</span> <span class="token function">getInfo2</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstdata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fr<span class="token punctuation">:</span>
        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>fr<span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
            <span class="token keyword">if</span> i<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"City"</span><span class="token punctuation">:</span> <span class="token keyword">pass</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span> lstdata<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> lstdata

<span class="token comment"># 8.2 城市地图可视化</span>
<span class="token keyword">def</span> <span class="token function">city_Map</span><span class="token punctuation">(</span>lstcity<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstcitynew <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># 2.1 去掉空白的项</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> lstcity<span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">:</span><span class="token keyword">pass</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span> lstcitynew<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token comment"># 2.2 统计每个城市出现的次数</span>
    data <span class="token operator">=</span> Counter<span class="token punctuation">(</span>lstcitynew<span class="token punctuation">)</span><span class="token punctuation">.</span>most_common<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token comment"># 使用Counter类统计出现的次数，并转换为元组列表</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.3 根据省份数据生成地图</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token comment"># Geo() 里通过添加 init_opts 参数可以配置初始化画布大小。</span>
        <span class="token comment"># Geo(init_opts=opts.InitOpts(height="1000px", width="1500px"))</span>
        Geo<span class="token punctuation">(</span>init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token string">"1600px"</span><span class="token punctuation">,</span>
                                height<span class="token operator">=</span><span class="token string">"1000px"</span><span class="token punctuation">,</span>
                                page_title<span class="token operator">=</span><span class="token string">"wudi"</span><span class="token punctuation">,</span>  <span class="token comment"># 网页标题</span>
                                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_schema<span class="token punctuation">(</span>maptype<span class="token operator">=</span><span class="token string">"china"</span><span class="token punctuation">,</span> <span class="token comment"># china-cities</span>
                        label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                                  position<span class="token operator">=</span><span class="token string">'inside'</span><span class="token punctuation">,</span>  <span class="token comment"># 标签的位置。</span>
                                                  font_size<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>  <span class="token comment"># 文字的字体大小</span>
                                                  color<span class="token operator">=</span><span class="token string">"orange"</span><span class="token punctuation">,</span>  <span class="token comment"># 文字的颜色。如果设置为 'auto'，则为视觉映射得到的颜色，如系列色。</span>
                                                  font_style<span class="token operator">=</span><span class="token string">'italic'</span><span class="token punctuation">,</span>
                                                  font_weight<span class="token operator">=</span><span class="token string">'bold'</span><span class="token punctuation">,</span>
                                                  font_family<span class="token operator">=</span><span class="token string">'Arial'</span><span class="token punctuation">,</span>
                                                  rotate<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">,</span>  <span class="token comment"># 标签旋转。从 -90 度到 90 度。正值是逆时针。</span>
                                                  margin<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span>  <span class="token comment"># 刻度标签与轴线之间的距离。</span>
                                                  <span class="token punctuation">)</span>
                        <span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add<span class="token punctuation">(</span>
                series_name<span class="token operator">=</span><span class="token string">"好友城市"</span><span class="token punctuation">,</span>
                data_pair<span class="token operator">=</span>data<span class="token punctuation">,</span>
                <span class="token comment"># type_=ChartType.HEATMAP, # Geo 图类型,</span>
                symbol<span class="token operator">=</span><span class="token string">"circle"</span><span class="token punctuation">,</span> <span class="token comment"># 标记图形形状,提供的标记类型包括 'circle', 'rect', 'roundRect', 'triangle','diamond', 'pin', 'arrow', 'none'</span>
                symbol_size<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>  <span class="token comment"># 标记的大小</span>
                blur_size<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>  <span class="token comment"># 每个点的大小</span>
                point_size<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>  <span class="token comment"># 每个点模糊的大小，</span>
                color<span class="token operator">=</span><span class="token string">"blue"</span><span class="token punctuation">,</span>  <span class="token comment"># 系列 label 颜色</span>
                is_selected<span class="token operator">=</span><span class="token boolean">True</span>
            <span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
                <span class="token comment"># 设置标题</span>
                title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>
                    <span class="token comment"># 主标题</span>
                    title<span class="token operator">=</span><span class="token string">"城市地图"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 副标题</span>
                    subtitle<span class="token operator">=</span><span class="token string">"吴迪的好友城市数据"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 组件距离容器左侧的位置</span>
                    pos_left<span class="token operator">=</span><span class="token string">"left"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 组件距离容器上方的像素值</span>
                    pos_top<span class="token operator">=</span><span class="token string">"20"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 设置标题颜色</span>
                    title_textstyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TextStyleOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">"#404a59"</span><span class="token punctuation">,</span>font_size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token comment"># 图例配置项，参数 是否显示图里组件</span>
                legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token comment"># 设置分段显示</span>
                visualmap_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>VisualMapOpts<span class="token punctuation">(</span>max_<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">,</span> is_piecewise<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token comment"># 关闭标签(地图上的省份名称)名称显示,系列配置项里的标签加上color="bule" 参数可设置标签颜色为蓝色。</span>
            <span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
                label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>
                    is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                    color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"./吴迪好友城市分布.html"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
    例子9：好友头像集成大图
'''</span>
<span class="token comment"># 9.1 头像拼接大图</span>
<span class="token keyword">def</span> <span class="token function">createImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> <span class="token number">0</span>
    y <span class="token operator">=</span> <span class="token number">0</span>
    imgs <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">"./img"</span><span class="token punctuation">)</span>
    <span class="token comment"># random.shuffle(imgs)</span>
    <span class="token comment"># 创建640 * 640 的图片用于填充各小图片</span>
    newImg <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'RGBA'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token punctuation">,</span><span class="token number">640</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 以640 * 640 来拼接图片，math.sqrt()开平方根计算每张小图片的宽高</span>
    width <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">640</span><span class="token operator">*</span><span class="token number">640</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>imgs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 每行图片数</span>
    numLine <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token operator">/</span>width<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> imgs<span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./img/"</span><span class="token operator">+</span>i<span class="token punctuation">)</span>
        <span class="token comment"># 缩小图片</span>
            img <span class="token operator">=</span> img<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span>width<span class="token punctuation">)</span><span class="token punctuation">,</span>Image<span class="token punctuation">.</span>ANTIALIAS<span class="token punctuation">)</span>
        <span class="token comment"># 拼接图片，一行排满，换行拼接</span>
            newImg<span class="token punctuation">.</span>paste<span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token punctuation">(</span>x<span class="token operator">*</span>width<span class="token punctuation">,</span>y<span class="token operator">*</span>width<span class="token punctuation">)</span><span class="token punctuation">)</span>
            x<span class="token operator">+=</span><span class="token number">1</span>
            <span class="token keyword">if</span> x<span class="token operator">&gt;=</span>numLine<span class="token punctuation">:</span>
                x <span class="token operator">=</span> <span class="token number">0</span>
                y<span class="token operator">+=</span><span class="token number">1</span>
        <span class="token keyword">except</span> IOError<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"img/%s can not open"</span> <span class="token operator">%</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
    newImg<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"./all.png"</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
    例子10： 微信好友名称分析职业特点
'''</span>
<span class="token comment"># 10.1 打开xlsx</span>
workbook <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">'./coor.xls'</span><span class="token punctuation">)</span>
sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span><span class="token string">'Sheet1'</span><span class="token punctuation">)</span> <span class="token comment"># 这是好友信息表</span>
num_rows1 <span class="token operator">=</span> sheet1<span class="token punctuation">.</span>nrows
sheet2 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span><span class="token string">'Sheet2'</span><span class="token punctuation">)</span> <span class="token comment"># 这是职业广告对应表</span>
num_rows2 <span class="token operator">=</span> sheet2<span class="token punctuation">.</span>nrows
<span class="token comment"># 10.2 根据输入的词语检索职业特点</span>
<span class="token comment"># word 为待检索的词语，num_rows是excel表的行数目</span>
<span class="token keyword">def</span> <span class="token function">lexicon_deall</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span>num_rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> curr_row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cell <span class="token operator">=</span> sheet2<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span>curr_row<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> word <span class="token keyword">in</span> cell<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">return</span> <span class="token boolean">False</span>
<span class="token comment"># 10.3 获取好友昵称</span>
<span class="token keyword">def</span> <span class="token function">get_Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    NickName <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_rows1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        NickName<span class="token punctuation">.</span>append<span class="token punctuation">(</span>sheet1<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> NickName
<span class="token comment"># 10.4 定义一个函数，用来根据朋名称信息，并分析其职业特点</span>
<span class="token keyword">def</span> <span class="token function">create_nickname</span><span class="token punctuation">(</span>NickName<span class="token punctuation">)</span><span class="token punctuation">:</span>
    num_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 昵称中有手机号的朋友</span>
    advertise_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 宣传用昵称</span>
    temp <span class="token operator">=</span> <span class="token boolean">False</span>
    cop <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">"[^\u4e00-\u9fa5^.^a-z^A-Z^0-9]"</span><span class="token punctuation">)</span> <span class="token comment"># 去掉不必要的符号，只保留汉字，字母和数字</span>
    <span class="token comment"># 对好友的名称挨个分析</span>
    <span class="token keyword">for</span> sid<span class="token punctuation">,</span>val <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>NickName<span class="token punctuation">)</span><span class="token punctuation">:</span>
        v1 <span class="token operator">=</span> val<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"emoji"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>
        v2 <span class="token operator">=</span> cop<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span>v1<span class="token punctuation">)</span>
        <span class="token comment"># 判断是否包含手机号</span>
        <span class="token keyword">if</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r"1\d{10}"</span><span class="token punctuation">,</span>v2<span class="token punctuation">)</span><span class="token punctuation">:</span>
            num_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>NickName<span class="token punctuation">[</span>sid<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment"># 判断是否包含职业特点</span>
        cut <span class="token operator">=</span> jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>v2<span class="token punctuation">)</span>
        <span class="token comment"># print("".join(cut))</span>
        <span class="token keyword">for</span> c <span class="token keyword">in</span> cut<span class="token punctuation">:</span>
            <span class="token keyword">if</span> lexicon_deall<span class="token punctuation">(</span>c<span class="token punctuation">,</span>num_rows2<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
                temp <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token keyword">if</span> temp <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            advertise_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>NickName<span class="token punctuation">[</span>sid<span class="token punctuation">]</span><span class="token punctuation">)</span>
            temp <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token comment"># 把好友职业信息保存到文件中</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"昵称分析.txt"</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"以下是昵称中带手机号的好友：\n"</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>num_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"这部分好友有自己的生意，需要大家关注手机号，联系方便\n"</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"以下是昵称中带职业的好友：\n"</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>advertise_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"这部分好友有自己的事业\n"</span><span class="token punctuation">)</span>
    <span class="token comment"># 好友职业信息可视化，仪表盘和水球图展示</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span>
        Gauge<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add<span class="token punctuation">(</span>
            series_name <span class="token operator">=</span> <span class="token string">"广告好友指标"</span><span class="token punctuation">,</span>
            data_pair <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"所占比率"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>advertise_list<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>NickName<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            radius<span class="token operator">=</span><span class="token string">"100%"</span><span class="token punctuation">,</span>  <span class="token comment"># 设置比例大小</span>
            min_<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> max_<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>  <span class="token comment"># 设置起始、终止刻度</span>
            title_label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>GaugeTitleOpts<span class="token punctuation">(</span>
                font_size<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">,</span> font_family<span class="token operator">=</span><span class="token string">"Microsoft YaHei"</span>  <span class="token comment"># 设置字体、颜色、大小</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            axisline_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisLineOpts<span class="token punctuation">(</span>
                linestyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LineStyleOpts<span class="token punctuation">(</span>
                    color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token string">"#67e0e3"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token string">"#37a2da"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"#fd666d"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">30</span>  <span class="token comment"># 设置区间颜色、仪表宽度</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
            title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>
                title<span class="token operator">=</span><span class="token string">"广告好友比例"</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>
                is_show<span class="token operator">=</span><span class="token boolean">False</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"./仪表板广告好友比例.html"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span>
        Liquid<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">"广告好友"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>advertise_list<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>NickName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>advertise_list<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>NickName<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> is_outline_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"广告好友比例"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"./水球图广告好友比例.html"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># 1.4 例子1起点</span>
    lstsex <span class="token operator">=</span> getSex<span class="token punctuation">(</span><span class="token string">'./我的微信好友信息.csv'</span><span class="token punctuation">)</span>
    VisualSexpyechart<span class="token punctuation">(</span>lstsex<span class="token punctuation">)</span>
    VisualSexpyechart2<span class="token punctuation">(</span>lstsex<span class="token punctuation">)</span>
    <span class="token comment"># 2.5 例子2起点，偷个懒把19级放一起</span>
    province_list <span class="token operator">=</span> getProvince<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'软件17学生详细名单.xls'</span><span class="token punctuation">,</span> <span class="token string">'软件18学生详细名单.xls'</span><span class="token punctuation">,</span> <span class="token string">'软件19学生详细名单.xls'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Provincepyechart<span class="token punctuation">(</span>province_list<span class="token punctuation">)</span>
    City_list <span class="token operator">=</span> getCity<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'软件17学生详细名单.xls'</span><span class="token punctuation">,</span> <span class="token string">'软件18学生详细名单.xls'</span><span class="token punctuation">,</span> <span class="token string">'软件19学生详细名单.xls'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    cityPyechart<span class="token punctuation">(</span>City_list<span class="token punctuation">)</span>
    <span class="token comment"># 3.3 例子3起点</span>
    <span class="token comment"># 保存两个班级人生格言</span>
    getStrong<span class="token punctuation">(</span><span class="token string">"./软件191学生详细名单.xls"</span><span class="token punctuation">,</span> <span class="token string">"./191-Signature.txt"</span><span class="token punctuation">)</span>
    getStrong<span class="token punctuation">(</span><span class="token string">"./软件192学生详细名单.xls"</span><span class="token punctuation">,</span> <span class="token string">"./192-Signature.txt"</span><span class="token punctuation">)</span>
    <span class="token comment"># 获取两个班级格言积极与消极人数</span>
    a<span class="token punctuation">,</span> b <span class="token operator">=</span> counter<span class="token punctuation">(</span><span class="token string">"./191-Signature.txt"</span><span class="token punctuation">)</span>
    c<span class="token punctuation">,</span> d <span class="token operator">=</span> counter<span class="token punctuation">(</span><span class="token string">"./192-Signature.txt"</span><span class="token punctuation">)</span>
    <span class="token comment"># matplotlib绘图</span>
    x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'软件191积极'</span><span class="token punctuation">,</span> <span class="token string">'软件192积极'</span><span class="token punctuation">,</span> <span class="token string">'软件191消极'</span><span class="token punctuation">,</span> <span class="token string">'软件192消极'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> c<span class="token punctuation">,</span> b<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"hotpink"</span><span class="token punctuation">,</span> <span class="token string">"lightblue"</span><span class="token punctuation">,</span> <span class="token string">"hotpink"</span><span class="token punctuation">,</span> <span class="token string">"lightblue"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'191与192班签名情感强度分析对比'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 4.3 例子4起点</span>
    province_list1 <span class="token operator">=</span> getProvince1<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./软件17学生详细名单.xls'</span><span class="token punctuation">,</span> <span class="token string">'./软件18学生详细名单.xls'</span><span class="token punctuation">,</span> <span class="token string">'./软件19学生详细名单.xls'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    VisualSexpyechart1<span class="token punctuation">(</span>province_list1<span class="token punctuation">)</span>
    <span class="token comment"># 5.3 例子5起点</span>
    RoomSee<span class="token punctuation">(</span>getRoom<span class="token punctuation">(</span><span class="token string">"./软件19学生详细名单.xls"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 6.3 例子6起点</span>
    getInfo<span class="token punctuation">(</span><span class="token string">"./我的微信好友信息.csv"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
    create_word_cloud<span class="token punctuation">(</span><span class="token string">"sign"</span><span class="token punctuation">)</span>
    <span class="token comment"># 7 例子7起点</span>
    lstdata <span class="token operator">=</span> getInfo1<span class="token punctuation">(</span><span class="token string">"./我的微信好友信息.csv"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    province_Map<span class="token punctuation">(</span>lstdata<span class="token punctuation">)</span>
    <span class="token comment"># 8 例子8起点</span>
    lstdata <span class="token operator">=</span> getInfo2<span class="token punctuation">(</span><span class="token string">"./我的微信好友信息.csv"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    city_Map<span class="token punctuation">(</span>lstdata<span class="token punctuation">)</span>
    <span class="token comment"># 9 例子9起点</span>
    createImg<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 10.5 例子10起点</span>
    NickName <span class="token operator">=</span> get_Name<span class="token punctuation">(</span><span class="token punctuation">)</span>
    create_nickname<span class="token punctuation">(</span>NickName<span class="token punctuation">)</span>
</code></pre> 
<p>因为是10个功能结合在一起看起来十分臃肿，不利于理解，代码不美观，但是它能跑【哈哈哈哈】</p> 
<h2><a id="_888"></a>五、功能分析</h2> 
<h3><a id="1_889"></a>1、饼状图,柱状图统计好友男女比例</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Pie
<span class="token comment">#用于设值全局配置和系列配置</span>
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts
<span class="token keyword">import</span> csv

<span class="token comment"># 1.读取csv文件,把性别信息读取出来</span>
<span class="token keyword">def</span> <span class="token function">getSex</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstsex <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fr<span class="token punctuation">:</span>
        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>fr<span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
            lstsex<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> lstsex
<span class="token comment"># 2.性别pyecharts可视化</span>
<span class="token keyword">def</span> <span class="token function">VisualSexpyechart</span><span class="token punctuation">(</span>lstsex<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sex <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.1 提取好友性别信息,从1开始，因为第0个是自己</span>
    <span class="token keyword">for</span> f <span class="token keyword">in</span> lstsex<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> f <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token comment"># 男</span>
            sex<span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span> <span class="token operator">=</span> sex<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'man'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">elif</span> f<span class="token operator">==</span> <span class="token string">'2'</span><span class="token punctuation">:</span> <span class="token comment"># 女</span>
            sex<span class="token punctuation">[</span><span class="token string">'women'</span><span class="token punctuation">]</span> <span class="token operator">=</span> sex<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'women'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment"># 未知</span>
            sex<span class="token punctuation">[</span><span class="token string">'unknown'</span><span class="token punctuation">]</span> <span class="token operator">=</span> sex<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'unknown'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token comment"># 在屏幕上打印出来</span>
    total <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lstsex<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.2打印出自己的好友性别比例</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"男性好友：%.2f%%"</span> <span class="token operator">%</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>sex<span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> total<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span> <span class="token string">"女性好友：%.2f%%"</span> <span class="token operator">%</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>sex<span class="token punctuation">[</span><span class="token string">'women'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> total<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">+</span>
          <span class="token string">"不明性别好友：%.2f%%"</span> <span class="token operator">%</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>sex<span class="token punctuation">[</span><span class="token string">'unknown'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> total<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.3使用pyecharts饼状图</span>
    attr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'男性好友'</span><span class="token punctuation">,</span><span class="token string">'女性好友'</span><span class="token punctuation">,</span><span class="token string">'不明性别好友'</span><span class="token punctuation">]</span>
    value <span class="token operator">=</span> <span class="token punctuation">[</span>sex<span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sex<span class="token punctuation">[</span><span class="token string">'women'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sex<span class="token punctuation">[</span><span class="token string">'unknown'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token comment"># 饼图用的数据格式是[(key1,value1),(key2,value2)]，所以先使用 zip函数将二者进行组合</span>
    data_pair <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">list</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token keyword">for</span> z <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>attr<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token comment"># 初始化配置项，内部可设置颜色</span>
    <span class="token punctuation">(</span>
        Pie<span class="token punctuation">(</span>init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>bg_color<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add<span class="token punctuation">(</span>
            <span class="token comment"># 系列名称，即该饼图的名称</span>
            series_name<span class="token operator">=</span><span class="token string">"性别分析"</span><span class="token punctuation">,</span>
            <span class="token comment"># 系列数据项，格式为[(key1,value1),(key2,value2)]</span>
            data_pair<span class="token operator">=</span>data_pair<span class="token punctuation">,</span>
            <span class="token comment"># 通过半径区分数据大小 “radius” 和 “area” 两种</span>
            rosetype<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span>
            <span class="token comment"># 饼图的半径，设置成默认百分比，相对于容器高宽中较小的一项的一半</span>
            radius<span class="token operator">=</span><span class="token string">"55%"</span><span class="token punctuation">,</span>
            <span class="token comment"># 饼图的圆心，第一项是相对于容器的宽度，第二项是相对于容器的高度</span>
            center<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"50%"</span><span class="token punctuation">,</span> <span class="token string">"50%"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token comment"># 标签配置项</span>
            label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> position<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token comment"># 全局设置</span>
        <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
            <span class="token comment"># 设置标题</span>
            title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>
                <span class="token comment"># 名字</span>
                title<span class="token operator">=</span><span class="token string">"微信好友性别比例"</span><span class="token punctuation">,</span>
                <span class="token comment"># 组件距离容器左侧的位置</span>
                pos_left<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">,</span>
                <span class="token comment"># 组件距离容器上方的像素值</span>
                pos_top<span class="token operator">=</span><span class="token string">"20"</span><span class="token punctuation">,</span>
                <span class="token comment"># 设置标题颜色</span>
                title_textstyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TextStyleOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment"># 图例配置项，参数 是否显示图里组件</span>
            legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token comment"># 系列设置</span>
        <span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
            tooltip_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TooltipOpts<span class="token punctuation">(</span>
                trigger<span class="token operator">=</span><span class="token string">"item"</span><span class="token punctuation">,</span> formatter<span class="token operator">=</span><span class="token string">"{a} &lt;br/&gt;{b}: {c} ({d}%)"</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment"># 设置标签颜色</span>
            label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'好友性别比例.html'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token comment"># 3 性别pyecharts 柱状图可视化</span>
<span class="token keyword">def</span> <span class="token function">VisualSexpyechart2</span><span class="token punctuation">(</span>lstsex<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sex <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.1 提取好友性别信息,从1开始，因为第0个是自己</span>
    <span class="token keyword">for</span> f <span class="token keyword">in</span> lstsex<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> f <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>  <span class="token comment"># 男</span>
            sex<span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span> <span class="token operator">=</span> sex<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'man'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">elif</span> f <span class="token operator">==</span> <span class="token string">'2'</span><span class="token punctuation">:</span>  <span class="token comment"># 女</span>
            sex<span class="token punctuation">[</span><span class="token string">'women'</span><span class="token punctuation">]</span> <span class="token operator">=</span> sex<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'women'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># 未知</span>
            sex<span class="token punctuation">[</span><span class="token string">'unknown'</span><span class="token punctuation">]</span> <span class="token operator">=</span> sex<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'unknown'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token comment"># 在屏幕上打印出来</span>
    total <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lstsex<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.2打印出自己的好友性别比例</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>
        <span class="token string">"男性好友：%.2f%%"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>sex<span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> total <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span> <span class="token string">"女性好友：%.2f%%"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>
                <span class="token builtin">float</span><span class="token punctuation">(</span>sex<span class="token punctuation">[</span><span class="token string">'women'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> total <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span>
        <span class="token string">"不明性别好友：%.2f%%"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>sex<span class="token punctuation">[</span><span class="token string">'unknown'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> total <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.3使用pyecharts饼状图</span>
    attr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'男性好友'</span><span class="token punctuation">,</span> <span class="token string">'女性好友'</span><span class="token punctuation">,</span> <span class="token string">'不明性别好友'</span><span class="token punctuation">]</span>
    value <span class="token operator">=</span> <span class="token punctuation">[</span>sex<span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sex<span class="token punctuation">[</span><span class="token string">'women'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sex<span class="token punctuation">[</span><span class="token string">'unknown'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token comment"># # 饼图用的数据格式是[(key1,value1),(key2,value2)]，所以先使用 zip函数将二者进行组合</span>
    <span class="token comment"># data_pair = [list(z) for z in zip(attr, value)]</span>
    <span class="token comment"># 初始化配置项，内部可设置颜色</span>
    bar <span class="token operator">=</span> <span class="token punctuation">(</span>
        Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>attr<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">"amount"</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
            title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'微信数据分析'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            yaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"amount"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"sex"</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>

    <span class="token punctuation">)</span><span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'好友性别比例2.html'</span><span class="token punctuation">)</span>
    
lstsex <span class="token operator">=</span> getSex<span class="token punctuation">(</span><span class="token string">'./我的微信好友信息.csv'</span><span class="token punctuation">)</span>
VisualSexpyechart<span class="token punctuation">(</span>lstsex<span class="token punctuation">)</span>
VisualSexpyechart2<span class="token punctuation">(</span>lstsex<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0a/f6/VPoVNWeS_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3d/cb/dBslo9mt_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_1011"></a>2、柱状图学生省份和城市分析</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Bar
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts
<span class="token keyword">import</span> xlrd

<span class="token comment"># 读取省份信息</span>
<span class="token keyword">def</span> <span class="token function">getProvince</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    Province1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    Province2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    Province3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    flag <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> filename_kid <span class="token keyword">in</span> filename<span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> <span class="token number">1</span>
        rd <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>filename_kid<span class="token punctuation">)</span>
        all_sheet <span class="token operator">=</span> rd<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> sheet_kid <span class="token keyword">in</span> all_sheet<span class="token punctuation">:</span>
            table <span class="token operator">=</span> rd<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span>sheet_kid<span class="token punctuation">)</span>
            nrows <span class="token operator">=</span> table<span class="token punctuation">.</span>nrows
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nrows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                province <span class="token operator">=</span> table<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
                <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                    Province1<span class="token punctuation">[</span>province<span class="token punctuation">]</span> <span class="token operator">=</span> Province1<span class="token punctuation">.</span>get<span class="token punctuation">(</span>province<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                    Province2<span class="token punctuation">[</span>province<span class="token punctuation">]</span> <span class="token operator">=</span> Province2<span class="token punctuation">.</span>get<span class="token punctuation">(</span>province<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    Province3<span class="token punctuation">[</span>province<span class="token punctuation">]</span> <span class="token operator">=</span> Province3<span class="token punctuation">.</span>get<span class="token punctuation">(</span>province<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Province1<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Province2<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Province3<span class="token punctuation">)</span>
    <span class="token keyword">return</span> a


<span class="token comment"># 2.省份可视化</span>
<span class="token keyword">def</span> <span class="token function">Provincepyechart</span><span class="token punctuation">(</span>province_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    province_dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'黑龙江'</span><span class="token punctuation">,</span> <span class="token string">'四川'</span><span class="token punctuation">,</span> <span class="token string">'天津'</span><span class="token punctuation">,</span> <span class="token string">'内蒙古'</span><span class="token punctuation">,</span> <span class="token string">'江苏'</span><span class="token punctuation">,</span> <span class="token string">'海南'</span><span class="token punctuation">,</span> <span class="token string">'辽宁'</span><span class="token punctuation">,</span> <span class="token string">'陕西'</span><span class="token punctuation">,</span> <span class="token string">'浙江'</span><span class="token punctuation">,</span> <span class="token string">'河南'</span><span class="token punctuation">,</span> <span class="token string">'山西'</span><span class="token punctuation">,</span> <span class="token string">'湖北'</span><span class="token punctuation">,</span> <span class="token string">'广西'</span><span class="token punctuation">,</span> <span class="token string">'重庆'</span><span class="token punctuation">,</span> <span class="token string">'吉林'</span><span class="token punctuation">,</span> <span class="token string">'贵州'</span><span class="token punctuation">,</span>
                     <span class="token string">'云南'</span><span class="token punctuation">,</span> <span class="token string">'河北'</span><span class="token punctuation">,</span> <span class="token string">'山东'</span><span class="token punctuation">]</span>
    province1_dict <span class="token operator">=</span> province_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    province2_dict <span class="token operator">=</span> province_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    province3_dict <span class="token operator">=</span> province_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    province1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    province2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    province3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> province1_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        province1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> province2_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        province2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> province3_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        province3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>province1<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>province2<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>province3<span class="token punctuation">)</span>
    bar <span class="token operator">=</span> <span class="token punctuation">(</span>
        Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>province_dict<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件17学生'</span><span class="token punctuation">,</span> value1<span class="token punctuation">)</span>

            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件18学生'</span><span class="token punctuation">,</span> value2<span class="token punctuation">)</span>

            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件19学生'</span><span class="token punctuation">,</span> value3<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"17,18,19级学生省份分析"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                             xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>
                                 axislabel_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>
                                     rotate<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">,</span>  <span class="token comment"># Optional[Numeric]</span>
                                 <span class="token punctuation">)</span>
                             <span class="token punctuation">)</span>
                             <span class="token punctuation">)</span><span class="token punctuation">)</span>
    bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'17,18,19级学生省份分析.html'</span><span class="token punctuation">)</span>


<span class="token comment"># 1.读取城市信息</span>
<span class="token keyword">def</span> <span class="token function">getCity</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    City1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    City2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    City3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    flag <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> filename_kid <span class="token keyword">in</span> filename<span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> <span class="token number">1</span>
        rd <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>filename_kid<span class="token punctuation">)</span>
        all_sheet <span class="token operator">=</span> rd<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> sheet_kid <span class="token keyword">in</span> all_sheet<span class="token punctuation">:</span>
            table <span class="token operator">=</span> rd<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span>sheet_kid<span class="token punctuation">)</span>
            nrows <span class="token operator">=</span> table<span class="token punctuation">.</span>nrows
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nrows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                City <span class="token operator">=</span> table<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
                <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                    City1<span class="token punctuation">[</span>City<span class="token punctuation">]</span> <span class="token operator">=</span> City1<span class="token punctuation">.</span>get<span class="token punctuation">(</span>City<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                    City2<span class="token punctuation">[</span>City<span class="token punctuation">]</span> <span class="token operator">=</span> City2<span class="token punctuation">.</span>get<span class="token punctuation">(</span>City<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    City3<span class="token punctuation">[</span>City<span class="token punctuation">]</span> <span class="token operator">=</span> City3<span class="token punctuation">.</span>get<span class="token punctuation">(</span>City<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>City1<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>City2<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>City3<span class="token punctuation">)</span>
    <span class="token keyword">return</span> a


<span class="token comment"># 2.城市可视化</span>
<span class="token keyword">def</span> <span class="token function">cityPyechart</span><span class="token punctuation">(</span>city_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    city_dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'鸡西'</span><span class="token punctuation">,</span> <span class="token string">'泰安'</span><span class="token punctuation">,</span> <span class="token string">'阜阳'</span><span class="token punctuation">,</span> <span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token string">'兰州'</span><span class="token punctuation">,</span> <span class="token string">'深圳'</span><span class="token punctuation">,</span> <span class="token string">'阳春'</span><span class="token punctuation">,</span> <span class="token string">'开封'</span><span class="token punctuation">,</span> <span class="token string">'周口'</span><span class="token punctuation">,</span> <span class="token string">'哈尔滨'</span><span class="token punctuation">,</span> <span class="token string">'齐齐哈尔'</span><span class="token punctuation">,</span> <span class="token string">'鹤岗'</span><span class="token punctuation">,</span> <span class="token string">'大庆'</span><span class="token punctuation">,</span> <span class="token string">'佳木斯'</span><span class="token punctuation">,</span> <span class="token string">'宜昌'</span><span class="token punctuation">,</span> <span class="token string">'怀化'</span><span class="token punctuation">,</span>
                 <span class="token string">'常德'</span><span class="token punctuation">,</span> <span class="token string">'德州'</span><span class="token punctuation">,</span> <span class="token string">'临沂'</span><span class="token punctuation">,</span> <span class="token string">'朔州'</span><span class="token punctuation">,</span> <span class="token string">'临汾'</span><span class="token punctuation">,</span> <span class="token string">'天津'</span><span class="token punctuation">,</span> <span class="token string">'温州市'</span><span class="token punctuation">,</span> <span class="token string">'重庆'</span><span class="token punctuation">,</span> <span class="token string">'上饶'</span><span class="token punctuation">,</span> <span class="token string">'金华'</span><span class="token punctuation">,</span> <span class="token string">'石家庄'</span><span class="token punctuation">,</span> <span class="token string">'巴中'</span><span class="token punctuation">,</span> <span class="token string">'咸阳'</span><span class="token punctuation">,</span> <span class="token string">'信阳'</span><span class="token punctuation">]</span>
    city1_dict <span class="token operator">=</span> city_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    city2_dict <span class="token operator">=</span> city_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    city3_dict <span class="token operator">=</span> city_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    city1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    city2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    city3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> city1_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        city1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> city2_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        city2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> city3_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        city3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>city1<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>city2<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>city3<span class="token punctuation">)</span>
    bar <span class="token operator">=</span> <span class="token punctuation">(</span>
        Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>city_dict<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件17学生'</span><span class="token punctuation">,</span> value1<span class="token punctuation">)</span>

            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件18学生'</span><span class="token punctuation">,</span> value2<span class="token punctuation">)</span>

            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件19学生'</span><span class="token punctuation">,</span> value3<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"17,18,19级学生省份分析"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                             xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>
                                 axislabel_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>
                                     rotate<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">,</span>  <span class="token comment"># Optional[Numeric]</span>
                                 <span class="token punctuation">)</span>
                             <span class="token punctuation">)</span>
                             <span class="token punctuation">)</span><span class="token punctuation">)</span>
    bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'17,18,19级学生城市分析.html'</span><span class="token punctuation">)</span>


<span class="token comment"># 偷个懒把19级放一起</span>
province_list <span class="token operator">=</span> getProvince<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'软件17学生详细名单.xls'</span><span class="token punctuation">,</span> <span class="token string">'软件18学生详细名单.xls'</span><span class="token punctuation">,</span> <span class="token string">'软件19学生详细名单.xls'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Provincepyechart<span class="token punctuation">(</span>province_list<span class="token punctuation">)</span>

City_list <span class="token operator">=</span> getCity<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'软件17学生详细名单.xls'</span><span class="token punctuation">,</span> <span class="token string">'软件18学生详细名单.xls'</span><span class="token punctuation">,</span> <span class="token string">'软件19学生详细名单.xls'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cityPyechart<span class="token punctuation">(</span>City_list<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a7/af/lgokNpT6_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/70/47/bqzEU9nZ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3191192_1175"></a>3、分析191,192学生情感</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> re
<span class="token keyword">import</span> jieba
<span class="token keyword">import</span> xlrd
<span class="token keyword">from</span> snownlp <span class="token keyword">import</span> SnowNLP
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>

<span class="token comment">#读取Excel表格，保存txt文件词性，分析情感强度</span>
<span class="token keyword">def</span> <span class="token function">getStrong</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>save<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding_override<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    tables <span class="token operator">=</span> data<span class="token punctuation">.</span>sheets<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tables<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">list</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        rows <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">.</span>nrows
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> j<span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            name<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">.</span>row_values<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">.</span>row_values<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>save<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        i <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> ld <span class="token keyword">in</span> temp<span class="token punctuation">:</span>
            signature <span class="token operator">=</span> ld<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"emoji"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>
            rec <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">"lf\d+\w*|[&lt;&gt;/=]]"</span><span class="token punctuation">)</span>
            signature <span class="token operator">=</span> rec<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span>signature<span class="token punctuation">)</span>
            <span class="token keyword">if</span> signature <span class="token operator">!=</span> <span class="token string">""</span><span class="token punctuation">:</span>
                <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>name<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">" : "</span> <span class="token operator">+</span>signature<span class="token punctuation">)</span>
                s <span class="token operator">=</span> SnowNLP<span class="token punctuation">(</span>signature<span class="token punctuation">)</span>
                <span class="token keyword">if</span> s<span class="token punctuation">.</span>sentiments <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">:</span>
                    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">" : 积极！\n"</span><span class="token punctuation">)</span>
                <span class="token keyword">elif</span> s<span class="token punctuation">.</span>sentiments <span class="token operator">&lt;=</span> <span class="token number">0.5</span><span class="token punctuation">:</span>
                    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">" : 消极！\n"</span><span class="token punctuation">)</span>
                i<span class="token operator">+=</span><span class="token number">1</span>
<span class="token comment">#统计两个班级积极与消极数量</span>
<span class="token keyword">def</span> <span class="token function">counter</span><span class="token punctuation">(</span>save<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># https://blog.csdn.net/weixin_38762584/article/details/115023975</span>
    <span class="token comment"># f’{}’ 用法等同于 format用法的简单使用，更加方便</span>
    txt <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>save<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    need_words <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./qingxu.txt"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    find <span class="token operator">=</span> need_words<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
    jieba<span class="token punctuation">.</span>load_userdict<span class="token punctuation">(</span><span class="token string">'./qingxu.txt'</span><span class="token punctuation">)</span>
    words <span class="token operator">=</span> jieba<span class="token punctuation">.</span>lcut<span class="token punctuation">(</span>txt<span class="token punctuation">)</span>
    counts <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> word <span class="token keyword">in</span> words<span class="token punctuation">:</span>
        counts<span class="token punctuation">[</span>word<span class="token punctuation">]</span> <span class="token operator">=</span> counts<span class="token punctuation">.</span>get<span class="token punctuation">(</span>word<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    lst<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>find<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span> <span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>find<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>counts<span class="token punctuation">[</span>find<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            lst<span class="token punctuation">.</span>append<span class="token punctuation">(</span>find<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    a <span class="token operator">=</span> counts<span class="token punctuation">[</span>find<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    b <span class="token operator">=</span> counts<span class="token punctuation">[</span>find<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> a<span class="token punctuation">,</span>b

<span class="token comment">#保存两个班级人生格言</span>
getStrong<span class="token punctuation">(</span><span class="token string">"./软件191学生详细名单.xls"</span><span class="token punctuation">,</span><span class="token string">"./191-Signature.txt"</span><span class="token punctuation">)</span>
getStrong<span class="token punctuation">(</span><span class="token string">"./软件192学生详细名单.xls"</span><span class="token punctuation">,</span><span class="token string">"./192-Signature.txt"</span><span class="token punctuation">)</span>

<span class="token comment">#获取两个班级格言积极与消极人数</span>
a<span class="token punctuation">,</span>b<span class="token operator">=</span>counter<span class="token punctuation">(</span><span class="token string">"./191-Signature.txt"</span><span class="token punctuation">)</span>
c<span class="token punctuation">,</span>d<span class="token operator">=</span>counter<span class="token punctuation">(</span><span class="token string">"./192-Signature.txt"</span><span class="token punctuation">)</span>

<span class="token comment">#matplotlib绘图</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'软件191积极'</span><span class="token punctuation">,</span> <span class="token string">'软件192积极'</span><span class="token punctuation">,</span><span class="token string">'软件191消极'</span><span class="token punctuation">,</span><span class="token string">'软件192消极'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span>c<span class="token punctuation">,</span>b<span class="token punctuation">,</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> color <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"hotpink"</span><span class="token punctuation">,</span><span class="token string">"lightblue"</span><span class="token punctuation">,</span><span class="token string">"hotpink"</span><span class="token punctuation">,</span><span class="token string">"lightblue"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'191与192班签名情感强度分析对比'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6e/45/qtXk5yoa_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4171819_1254"></a>4、柱状图17·18·19级学生男女比例</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Bar
<span class="token comment"># 用于设值全局配置和系列配置</span>
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts
<span class="token keyword">import</span> xlrd

<span class="token comment"># 1.读取xls文件,把性别信息读取出来</span>
<span class="token keyword">def</span> <span class="token function">getProvince</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    Province1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    Province2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    Province3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    flag <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> filename_kid <span class="token keyword">in</span> filename<span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> <span class="token number">1</span>
        rd <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook_xls<span class="token punctuation">(</span>filename_kid<span class="token punctuation">)</span>   <span class="token comment">#xlrd.open_workbook()不支持xls文件</span>
        all_sheet <span class="token operator">=</span> rd<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> sheet_kid <span class="token keyword">in</span> all_sheet<span class="token punctuation">:</span>
            table <span class="token operator">=</span> rd<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span>sheet_kid<span class="token punctuation">)</span>
            nrows <span class="token operator">=</span> table<span class="token punctuation">.</span>nrows
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nrows<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                province <span class="token operator">=</span> table<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
                <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                    Province1<span class="token punctuation">[</span>province<span class="token punctuation">]</span> <span class="token operator">=</span> Province1<span class="token punctuation">.</span>get<span class="token punctuation">(</span>province<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                    Province2<span class="token punctuation">[</span>province<span class="token punctuation">]</span> <span class="token operator">=</span> Province2<span class="token punctuation">.</span>get<span class="token punctuation">(</span>province<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    Province3<span class="token punctuation">[</span>province<span class="token punctuation">]</span> <span class="token operator">=</span> Province3<span class="token punctuation">.</span>get<span class="token punctuation">(</span>province<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Province1<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Province2<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Province3<span class="token punctuation">)</span>
    <span class="token keyword">return</span> a

<span class="token comment"># 2.性别可视化</span>
<span class="token keyword">def</span> <span class="token function">VisualSexpyechart</span><span class="token punctuation">(</span>province_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    province1_dict <span class="token operator">=</span> province_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    province2_dict <span class="token operator">=</span> province_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    province3_dict <span class="token operator">=</span> province_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    province1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    province2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    province3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    value3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span>value <span class="token keyword">in</span> province1_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        province1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span>value <span class="token keyword">in</span> province2_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        province2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span>value <span class="token keyword">in</span> province3_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        province3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        value3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>province1<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>province2<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>province3<span class="token punctuation">)</span>
    bar <span class="token operator">=</span> <span class="token punctuation">(</span>
        Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>province1<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件17学生'</span><span class="token punctuation">,</span> value1<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'lightblue'</span><span class="token punctuation">)</span>

            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件18学生'</span><span class="token punctuation">,</span> value2<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'lightgreen'</span><span class="token punctuation">)</span>

            <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">'软件19学生'</span><span class="token punctuation">,</span> value3<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'purple'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"17,18,19级学生性别分析"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'17,18,19级学生性别分析.html'</span><span class="token punctuation">)</span>

province_list <span class="token operator">=</span> getProvince<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./软件17学生详细名单.xls'</span><span class="token punctuation">,</span><span class="token string">'./软件18学生详细名单.xls'</span><span class="token punctuation">,</span><span class="token string">'./软件19学生详细名单.xls'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
VisualSexpyechart<span class="token punctuation">(</span>province_list<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b2/68/C5nsmdHm_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5example_1331"></a>5、关系图example</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> xlrd
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Graph

<span class="token keyword">def</span> <span class="token function">getRoom</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    Room<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    data<span class="token operator">=</span>xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding_override<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    table<span class="token operator">=</span>data<span class="token punctuation">.</span>sheets<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    rows<span class="token operator">=</span>table<span class="token punctuation">.</span>nrows
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
           <span class="token keyword">continue</span>
        Room<span class="token punctuation">[</span>table<span class="token punctuation">.</span>row_values<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span>table<span class="token punctuation">.</span>row_values<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>
    <span class="token comment">#print(Room)</span>
    <span class="token keyword">return</span> Room

<span class="token keyword">def</span> <span class="token function">RoomSee</span><span class="token punctuation">(</span>Room<span class="token punctuation">)</span><span class="token punctuation">:</span>
    nodes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> Room<span class="token punctuation">:</span>
        nodes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span>i<span class="token punctuation">,</span><span class="token string">"symbolSize"</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment"># print(nodes)</span>
    links<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> Room<span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> Room<span class="token punctuation">:</span>
            <span class="token keyword">if</span> Room<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>Room<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>
               links<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"source"</span><span class="token punctuation">:</span>i<span class="token punctuation">,</span><span class="token string">"target"</span><span class="token punctuation">:</span>j<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>links<span class="token punctuation">)</span>
    c<span class="token operator">=</span> <span class="token punctuation">(</span>
        Graph<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> nodes<span class="token punctuation">,</span> links<span class="token punctuation">,</span>
             categories<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>  <span class="token comment"># 结点分类的类目，结点可以指定分类，也可以不指定。</span>
             is_focusnode<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 是否在鼠标移到节点上的时候突出显示节点以及节点的边和邻接节点。默认为 True</span>
             is_roam<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
             is_rotate_label<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 是否旋转标签，默认为 False</span>
             layout<span class="token operator">=</span><span class="token string">"force"</span><span class="token punctuation">,</span>  <span class="token comment"># 布局类型，默认force=力引导图，circular=环形布局</span>
             edge_length<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>  <span class="token comment"># 力布局下边的两个节点之间的距离，这个距离也会受 repulsion 影响。默认为 50，TODO 值越大则长度越长</span>
             gravity<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token comment"># 点受到的向中心的引力因子。TODO 该值越大节点越往中心点靠拢。默认为 0.2</span>
             repulsion<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>  <span class="token comment"># 节点之间的斥力因子。默认为 50，TODO 值越大则斥力越大</span>
             label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             linestyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LineStyleOpts<span class="token punctuation">(</span>curve<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 线的弯曲度</span>
             <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"Graph-基本示例"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"./关系图系列.html"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

RoomSee<span class="token punctuation">(</span>getRoom<span class="token punctuation">(</span><span class="token string">"./软件19学生详细名单.xls"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/b3/67/bFrJxcZF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/da/ae/jPIuMMRY_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="6pyecharts_1385"></a>6、pyecharts词云</h2> 
<pre><code class="prism language-python"><span class="token comment"># 1.读取csv文件，把签名信息读取出来</span>
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> WordCloud
<span class="token keyword">import</span> csv
<span class="token keyword">import</span> re
<span class="token keyword">import</span> jieba

<span class="token keyword">def</span> <span class="token function">getInfo</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstdata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fr<span class="token punctuation">:</span>
        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>fr<span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
            <span class="token keyword">if</span> i<span class="token operator">!=</span><span class="token string">''</span><span class="token punctuation">:</span>
                lstdata<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./sign.txt'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> ld <span class="token keyword">in</span> lstdata<span class="token punctuation">:</span>
            signature <span class="token operator">=</span> ld<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"emoji"</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
            rec <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">"lf\d+\w*|[&lt;&gt;/=]"</span><span class="token punctuation">)</span>
            signature <span class="token operator">=</span> rec<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span>signature<span class="token punctuation">)</span>
            <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>signature<span class="token operator">+</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
            <span class="token triple-quoted-string string">'''
            signature = rec.sub("", signature)
            if signature!="":
                s = SnowNLP(signature)
                if s.sentiments &gt; 0.6:
                    file.write('情感分析：积极!****')
                elif s.sentiments &lt; 0.4:
                    file.write('情感分析：消极!****')
                else:
                    file.write('情感分析：中性佛系!****')
                file.write(signature + "\n")
            '''</span>
<span class="token comment"># 2 生成云图</span>
<span class="token keyword">def</span> <span class="token function">create_word_cloud</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 读取文件内容</span>
    <span class="token triple-quoted-string string">'''在一个程序中，我想创建一个文本文件（.txt），文件名包含一个字符串（它被分配给一个名为FileName的变量）。除了文件名中的字符串外，还有一个前缀：“Special file:”。在代码中，我像平常一样写前缀，但是为了包含变量赋值字符串，我使用.format（）。在
        代码：
        FileName = 'XYZ'
        ActiveFile = open('Special File: {0}.txt'.format(FileName), 'a')'''</span>
    text <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./{}.txt"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 结巴分词,精确模式</span>
    wordlist <span class="token operator">=</span> jieba<span class="token punctuation">.</span>lcut<span class="token punctuation">(</span>text<span class="token punctuation">,</span>cut_all<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    counts <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> <span class="token comment"># 通过键值对的形式存储词语及其出现的次数</span>
    words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> word <span class="token keyword">in</span> wordlist<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token comment"># 单个词语不计算在内</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            counts<span class="token punctuation">[</span>word<span class="token punctuation">]</span> <span class="token operator">=</span> counts<span class="token punctuation">.</span>get<span class="token punctuation">(</span>word<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token comment"># 遍历所有词语，每出现一次其对应的值加1</span>

    <span class="token keyword">for</span> key<span class="token punctuation">,</span>value <span class="token keyword">in</span> counts<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        words<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token triple-quoted-string string">'''
    items = list(counts.item()) # 将键值对转化成列表
    print(items)
    items.sort(key = lambda x:x[1],reverse=True) # 根据词语出现的次数进行从小到大排序
    for i in range(5):
        word,count = items[i]
        print("{0:&lt;5}{1:&gt;5}".format(word,count))
    '''</span>
    <span class="token comment"># wordcloud2 = WordCloud(width = 1300,height = 620)</span>
    <span class="token comment"># wordcloud2.add("",name,value,word_size_range = [10,100],shape = 'diamond')</span>

    w <span class="token operator">=</span> <span class="token punctuation">(</span>
        WordCloud<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span>words<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>options<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"词云"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'./变形词云.html'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token comment"># wordcloud2.show_config()</span>
    <span class="token comment"># wordcloud2.render(path='./data/05=02变形词云.html')</span>


<span class="token comment"># 3 个性签名统计</span>
getInfo<span class="token punctuation">(</span><span class="token string">"./我的微信好友信息.csv"</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
create_word_cloud<span class="token punctuation">(</span><span class="token string">"sign"</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b4/78/24uFZU59_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="7_1466"></a>7、好友省份地图可视化</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> csv
<span class="token keyword">from</span> collections <span class="token keyword">import</span> Counter
<span class="token comment"># 1.读取csv文件，把性别信息读取出来</span>
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Map

<span class="token keyword">def</span> <span class="token function">getInfo</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstdata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fr<span class="token punctuation">:</span>
        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>fr<span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
            lstdata<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> lstdata

<span class="token comment"># 2.省份可视化</span>
<span class="token keyword">def</span> <span class="token function">province_Map</span><span class="token punctuation">(</span>lstprovince<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstprovincenew <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># 2.1 去掉空白的项</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> lstprovince<span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">" "</span><span class="token punctuation">:</span><span class="token keyword">pass</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span> lstprovincenew<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token comment"># 2.2 统计每个城市出现的次数</span>
    data <span class="token operator">=</span> Counter<span class="token punctuation">(</span>lstprovincenew<span class="token punctuation">)</span><span class="token punctuation">.</span>most_common<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token comment"># 使用Counter类统计出现的次数，并转换为元组列表</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token comment"># 2.3 根据省份数据生成地图</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token comment"># Map() 里通过添加 init_opts 参数可以配置初始化画布大小。</span>
        <span class="token comment"># Map(init_opts=opts.InitOpts(height="1000px", width="1500px"))</span>
        Map<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add<span class="token punctuation">(</span>
                series_name<span class="token operator">=</span><span class="token string">"好友省份"</span><span class="token punctuation">,</span>
                data_pair<span class="token operator">=</span>data<span class="token punctuation">,</span>
                maptype<span class="token operator">=</span><span class="token string">'china'</span><span class="token punctuation">,</span><span class="token comment"># china-cities</span>
                is_selected<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                <span class="token comment"># 是否启用鼠标滚轮缩放和拖动平移，默认为True</span>
                is_roam<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                <span class="token comment"># 是否显示图形标记，默认为True</span>
                is_map_symbol_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                <span class="token comment"># 图元样式配置</span>
                <span class="token comment"># 图元样式配置的 areaColor 为区域颜色， borderColor 为边框颜色，</span>
                <span class="token comment"># 其中 normal 为常规模式下的，emphasis 为强调样式下的，即鼠标移动到区域上的显示。</span>
                itemstyle_opts<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
                    <span class="token comment"># 常规显示</span>
                    <span class="token string">"normal"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"areaColor"</span><span class="token punctuation">:</span> <span class="token string">"white"</span><span class="token punctuation">,</span> <span class="token string">"borderColor"</span><span class="token punctuation">:</span> <span class="token string">"red"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token comment"># 强调颜色</span>
                    <span class="token string">"emphasis"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"areaColor"</span><span class="token punctuation">:</span> <span class="token string">"rgba(0,0,0,1)"</span><span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
                <span class="token comment"># 设置标题</span>
                title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>
                    <span class="token comment"># 主标题</span>
                    title<span class="token operator">=</span><span class="token string">"省份地图"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 副标题</span>
                    subtitle<span class="token operator">=</span><span class="token string">"吴迪的好友省份数据"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 组件距离容器左侧的位置</span>
                    pos_left<span class="token operator">=</span><span class="token string">"left"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 组件距离容器上方的像素值</span>
                    pos_top<span class="token operator">=</span><span class="token string">"20"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 设置标题颜色</span>
                    title_textstyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TextStyleOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">"#404a59"</span><span class="token punctuation">,</span>font_size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token comment"># 图例配置项，参数 是否显示图里组件</span>
                legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token comment"># 设置分段显示</span>
                visualmap_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>VisualMapOpts<span class="token punctuation">(</span>max_<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">,</span> is_piecewise<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token comment"># 关闭标签(地图上的省份名称)名称显示,系列配置项里的标签加上color="bule" 参数可设置标签颜色为蓝色。</span>
            <span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
                label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>
                    is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                    color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"./吴迪好友省份分布.html"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

lstdata <span class="token operator">=</span> getInfo<span class="token punctuation">(</span><span class="token string">"./我的微信好友信息.csv"</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
province_Map<span class="token punctuation">(</span>lstdata<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2b/b4/4SbGynwK_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="8_1549"></a>8、好友城市地图分析</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> csv
<span class="token keyword">from</span> collections <span class="token keyword">import</span> Counter
<span class="token comment"># 1.读取csv文件，把性别信息读取出来</span>
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Geo

<span class="token keyword">def</span> <span class="token function">getInfo</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstdata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fr<span class="token punctuation">:</span>
        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>fr<span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
            <span class="token keyword">if</span> i<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"City"</span><span class="token punctuation">:</span> <span class="token keyword">pass</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span> lstdata<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> lstdata

<span class="token comment"># 2.省份可视化</span>
<span class="token keyword">def</span> <span class="token function">VisualCitypyecharts</span><span class="token punctuation">(</span>lstcity<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstcitynew <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># 2.1 去掉空白的项</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> lstcity<span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">:</span><span class="token keyword">pass</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span> lstcitynew<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token comment"># 2.2 统计每个城市出现的次数</span>
    data <span class="token operator">=</span> Counter<span class="token punctuation">(</span>lstcitynew<span class="token punctuation">)</span><span class="token punctuation">.</span>most_common<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token comment"># 使用Counter类统计出现的次数，并转换为元组列表</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.3 根据省份数据生成地图</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token comment"># Geo() 里通过添加 init_opts 参数可以配置初始化画布大小。</span>
        <span class="token comment"># Geo(init_opts=opts.InitOpts(height="1000px", width="1500px"))</span>
        Geo<span class="token punctuation">(</span>init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token string">"1600px"</span><span class="token punctuation">,</span>
                                height<span class="token operator">=</span><span class="token string">"1000px"</span><span class="token punctuation">,</span>
                                page_title<span class="token operator">=</span><span class="token string">"wudi"</span><span class="token punctuation">,</span>  <span class="token comment"># 网页标题</span>
                                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add_schema<span class="token punctuation">(</span>maptype<span class="token operator">=</span><span class="token string">"china"</span><span class="token punctuation">,</span>
                        label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                                  position<span class="token operator">=</span><span class="token string">'inside'</span><span class="token punctuation">,</span>  <span class="token comment"># 标签的位置。</span>
                                                  font_size<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>  <span class="token comment"># 文字的字体大小</span>
                                                  color<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">,</span>  <span class="token comment"># 文字的颜色。如果设置为 'auto'，则为视觉映射得到的颜色，如系列色。</span>
                                                  font_style<span class="token operator">=</span><span class="token string">'italic'</span><span class="token punctuation">,</span>
                                                  font_weight<span class="token operator">=</span><span class="token string">'bold'</span><span class="token punctuation">,</span>
                                                  font_family<span class="token operator">=</span><span class="token string">'Arial'</span><span class="token punctuation">,</span>
                                                  rotate<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">,</span>  <span class="token comment"># 标签旋转。从 -90 度到 90 度。正值是逆时针。</span>
                                                  margin<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span>  <span class="token comment"># 刻度标签与轴线之间的距离。</span>
                                                  <span class="token punctuation">)</span>
                        <span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add<span class="token punctuation">(</span>
                series_name<span class="token operator">=</span><span class="token string">"好友城市"</span><span class="token punctuation">,</span>
                data_pair<span class="token operator">=</span>data<span class="token punctuation">,</span>
                <span class="token comment"># type_=ChartType.HEATMAP, # Geo 图类型,</span>
                symbol<span class="token operator">=</span><span class="token string">"triangle"</span><span class="token punctuation">,</span> <span class="token comment"># 标记图形形状,提供的标记类型包括 'circle', 'rect', 'roundRect', 'triangle','diamond', 'pin', 'arrow', 'none'</span>
                symbol_size<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>  <span class="token comment"># 标记的大小</span>
                blur_size<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>  <span class="token comment"># 每个点的大小</span>
                point_size<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>  <span class="token comment"># 每个点模糊的大小，</span>
                color<span class="token operator">=</span><span class="token string">"blue"</span><span class="token punctuation">,</span>  <span class="token comment"># 系列 label 颜色</span>
                is_selected<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                <span class="token comment"># 图元样式配置</span>
                <span class="token comment"># 图元样式配置的 areaColor 为区域颜色， borderColor 为边框颜色，</span>
                <span class="token comment"># 其中 normal 为常规模式下的，emphasis 为强调样式下的，即鼠标移动到区域上的显示。</span>
                itemstyle_opts<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
                    <span class="token comment"># 常规显示</span>
                    <span class="token string">"normal"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"areaColor"</span><span class="token punctuation">:</span> <span class="token string">"white"</span><span class="token punctuation">,</span> <span class="token string">"borderColor"</span><span class="token punctuation">:</span> <span class="token string">"red"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token comment"># 强调颜色</span>
                    <span class="token string">"emphasis"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"areaColor"</span><span class="token punctuation">:</span> <span class="token string">"rgba(0,0,0,1)"</span><span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
                <span class="token comment"># 设置标题</span>
                title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>
                    <span class="token comment"># 主标题</span>
                    title<span class="token operator">=</span><span class="token string">"城市地图"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 副标题</span>
                    subtitle<span class="token operator">=</span><span class="token string">"吴迪的好友城市数据"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 组件距离容器左侧的位置</span>
                    pos_left<span class="token operator">=</span><span class="token string">"left"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 组件距离容器上方的像素值</span>
                    pos_top<span class="token operator">=</span><span class="token string">"20"</span><span class="token punctuation">,</span>
                    <span class="token comment"># 设置标题颜色</span>
                    title_textstyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TextStyleOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">"#404a59"</span><span class="token punctuation">,</span>font_size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token comment"># 图例配置项，参数 是否显示图里组件</span>
                legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token comment"># 设置分段显示</span>
                visualmap_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>VisualMapOpts<span class="token punctuation">(</span>max_<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">,</span> is_piecewise<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token comment"># 关闭标签(地图上的省份名称)名称显示,系列配置项里的标签加上color="bule" 参数可设置标签颜色为蓝色。</span>
            <span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
                label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>
                    is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                    color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"./吴迪好友城市分布.html"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

lstdata <span class="token operator">=</span> getInfo<span class="token punctuation">(</span><span class="token string">"./我的微信好友信息.csv"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
VisualCitypyecharts<span class="token punctuation">(</span>lstdata<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ef/c0/IdSs4BXd_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="9_1650"></a>9、好友头像集成大图</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
<span class="token comment"># 头像拼接图</span>
<span class="token keyword">def</span> <span class="token function">createImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> <span class="token number">0</span>
    y <span class="token operator">=</span> <span class="token number">0</span>
    imgs <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">"./img"</span><span class="token punctuation">)</span>
    <span class="token comment"># random.shuffle(imgs)</span>
    <span class="token comment"># 创建640 * 640 的图片用于填充各小图片</span>
    newImg <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'RGBA'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token punctuation">,</span><span class="token number">640</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 以640 * 640 来拼接图片，math.sqrt()开平方根计算每张小图片的宽高</span>
    width <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">640</span><span class="token operator">*</span><span class="token number">640</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>imgs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 每行图片数</span>
    numLine <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token operator">/</span>width<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> imgs<span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./img/"</span><span class="token operator">+</span>i<span class="token punctuation">)</span>
        <span class="token comment"># 缩小图片</span>
            img <span class="token operator">=</span> img<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span>width<span class="token punctuation">)</span><span class="token punctuation">,</span>Image<span class="token punctuation">.</span>ANTIALIAS<span class="token punctuation">)</span>
        <span class="token comment"># 拼接图片，一行排满，换行拼接</span>
            newImg<span class="token punctuation">.</span>paste<span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token punctuation">(</span>x<span class="token operator">*</span>width<span class="token punctuation">,</span>y<span class="token operator">*</span>width<span class="token punctuation">)</span><span class="token punctuation">)</span>
            x<span class="token operator">+=</span><span class="token number">1</span>
            <span class="token keyword">if</span> x<span class="token operator">&gt;=</span>numLine<span class="token punctuation">:</span>
                x <span class="token operator">=</span> <span class="token number">0</span>
                y<span class="token operator">+=</span><span class="token number">1</span>
        <span class="token keyword">except</span> IOError<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"img/%s can not open"</span> <span class="token operator">%</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
    newImg<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"./all.png"</span><span class="token punctuation">)</span>
createImg<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6c/36/vTsDBJhj_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="10_1683"></a>10、微信好友名称分析职业特点，仪表板和水球图可视化</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> re
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts
<span class="token keyword">import</span> jieba
<span class="token keyword">import</span> xlrd
<span class="token comment"># 进行文本处理的库，可以分词，词性标注，情感分析，与jieba</span>
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Gauge
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Liquid
<span class="token comment"># 打开xlsx</span>
workbook <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">'./coor.xls'</span><span class="token punctuation">)</span>
sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span><span class="token string">'Sheet1'</span><span class="token punctuation">)</span> <span class="token comment"># 这是好友信息表</span>
num_rows1 <span class="token operator">=</span> sheet1<span class="token punctuation">.</span>nrows
sheet2 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span><span class="token string">'Sheet2'</span><span class="token punctuation">)</span> <span class="token comment"># 这是职业广告对应表</span>
num_rows2 <span class="token operator">=</span> sheet2<span class="token punctuation">.</span>nrows

<span class="token comment"># 根据输入的词语检索职业特点</span>
<span class="token comment"># word 为待检索的词语，num_rows是excel表的行数目</span>
<span class="token keyword">def</span> <span class="token function">lexicon_deall</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span>num_rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> curr_row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cell <span class="token operator">=</span> sheet2<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span>curr_row<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> word <span class="token keyword">in</span> cell<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token comment"># 获取好友昵称</span>
<span class="token keyword">def</span> <span class="token function">get_Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    NickName <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_rows1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        NickName<span class="token punctuation">.</span>append<span class="token punctuation">(</span>sheet1<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> NickName

<span class="token comment"># 定义一个函数，用来根据朋名称信息，并分析其职业特点</span>
<span class="token keyword">def</span> <span class="token function">create_nickname</span><span class="token punctuation">(</span>NickName<span class="token punctuation">)</span><span class="token punctuation">:</span>
    num_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 昵称中有手机号的朋友</span>
    advertise_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 宣传用昵称</span>
    temp <span class="token operator">=</span> <span class="token boolean">False</span>
    cop <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">"[^\u4e00-\u9fa5^.^a-z^A-Z^0-9]"</span><span class="token punctuation">)</span> <span class="token comment"># 去掉不必要的符号，只保留汉字，字母和数字</span>
    <span class="token comment"># 对好友的名称挨个分析</span>
    <span class="token keyword">for</span> sid<span class="token punctuation">,</span>val <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>NickName<span class="token punctuation">)</span><span class="token punctuation">:</span>
        v1 <span class="token operator">=</span> val<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"emoji"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>
        v2 <span class="token operator">=</span> cop<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span>v1<span class="token punctuation">)</span>
        <span class="token comment"># 判断是否包含手机号</span>
        <span class="token keyword">if</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r"1\d{10}"</span><span class="token punctuation">,</span>v2<span class="token punctuation">)</span><span class="token punctuation">:</span>
            num_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>NickName<span class="token punctuation">[</span>sid<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment"># 判断是否包含职业特点</span>
        cut <span class="token operator">=</span> jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>v2<span class="token punctuation">)</span>
        <span class="token comment"># print("".join(cut))</span>
        <span class="token keyword">for</span> c <span class="token keyword">in</span> cut<span class="token punctuation">:</span>
            <span class="token keyword">if</span> lexicon_deall<span class="token punctuation">(</span>c<span class="token punctuation">,</span>num_rows2<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
                temp <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token keyword">if</span> temp <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            advertise_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>NickName<span class="token punctuation">[</span>sid<span class="token punctuation">]</span><span class="token punctuation">)</span>
            temp <span class="token operator">=</span> <span class="token boolean">False</span>

    <span class="token comment"># 把好友职业信息保存到文件中</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"昵称分析.txt"</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"以下是昵称中带手机号的好友：\n"</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>num_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"这部分好友有自己的生意，需要大家关注手机号，联系方便\n"</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"以下是昵称中带职业的好友：\n"</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>advertise_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"这部分好友有自己的事业\n"</span><span class="token punctuation">)</span>

    <span class="token comment"># 好友职业信息可视化，仪表盘和水球图展示</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span>
        Gauge<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add<span class="token punctuation">(</span>
            series_name <span class="token operator">=</span> <span class="token string">"广告好友指标"</span><span class="token punctuation">,</span>
            data_pair <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"所占比率"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>advertise_list<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>NickName<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            radius<span class="token operator">=</span><span class="token string">"100%"</span><span class="token punctuation">,</span>  <span class="token comment"># 设置比例大小</span>
            min_<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> max_<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>  <span class="token comment"># 设置起始、终止刻度</span>
            title_label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>GaugeTitleOpts<span class="token punctuation">(</span>
                font_size<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">,</span> font_family<span class="token operator">=</span><span class="token string">"Microsoft YaHei"</span>  <span class="token comment"># 设置字体、颜色、大小</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            axisline_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisLineOpts<span class="token punctuation">(</span>
                linestyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LineStyleOpts<span class="token punctuation">(</span>
                    color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token string">"#67e0e3"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token string">"#37a2da"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"#fd666d"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">30</span>  <span class="token comment"># 设置区间颜色、仪表宽度</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
            title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>
                title<span class="token operator">=</span><span class="token string">"广告好友比例"</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>
                is_show<span class="token operator">=</span><span class="token boolean">False</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"./仪表板广告好友比例.html"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

    c <span class="token operator">=</span> <span class="token punctuation">(</span>
        Liquid<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">"广告好友"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>advertise_list<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>NickName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>advertise_list<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>NickName<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> is_outline_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"广告好友比例"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"./水球图广告好友比例.html"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

NickName <span class="token operator">=</span> get_Name<span class="token punctuation">(</span><span class="token punctuation">)</span>
create_nickname<span class="token punctuation">(</span>NickName<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/31/d7/nKVRVjix_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f2/7f/kdWawvdu_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d641b4e7d918387b1f8e1a2b2a72f58a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">IDEA中安装并使用JRebel热部署插件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7065f435fc89cd7721f24ccb4851a50c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ubuntu20显示未知dispaly</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>