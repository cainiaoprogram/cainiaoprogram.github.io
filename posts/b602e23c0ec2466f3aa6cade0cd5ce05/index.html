<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>KNN - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="KNN" />
<meta property="og:description" content="一、一个用于聚类的算法，咨询查询聚类的相关知识，可再去了解聚类与分类，监督式等等
二、思路
1.列出m个（x，y）需要分的点，初始化黑色，K=3，给出3个随机初始中心点，初始化3个颜色
2.计算距离，得到关于每个点最近的中心点，让颜色与中心点相同表示一类
3.更新中心点：选取该类的点中的平均值
4.重复2，3，直到中心点不会变化
三、代码
可用jupyter在线实现，有兴趣把代码copy上去感受感受
import pandas as pd import numpy as np import matplotlib.pyplot as plt df=pd.DataFrame({ &#39;x&#39;:[12, 20, 28, 18, 29, 33, 24, 45, 45, 52, 51, 52, 55, 53, 55, 61, 64, 69, 72], &#39;y&#39;:[39, 36, 30, 52, 54, 46, 55, 59, 63, 70, 66, 63, 58, 23, 14, 8, 19, 7, 24] }) print(df) k=3 np.random.seed(234) centroids={ i&#43;1:[np.random.randint(0,80),np.random.randint(0,80)] for i in range(k) } print(centroids) colmap={1:&#39;r&#39;,2:&#39;g&#39;,3:&#39;b&#39;} plt." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b602e23c0ec2466f3aa6cade0cd5ce05/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-11-24T18:52:21+08:00" />
<meta property="article:modified_time" content="2018-11-24T18:52:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">KNN</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>一、一个用于聚类的算法，咨询查询聚类的相关知识，可再去了解聚类与分类，监督式等等</p> 
<p>二、思路</p> 
<p>1.列出m个（x，y）需要分的点，初始化黑色，K=3，给出3个随机初始中心点，初始化3个颜色</p> 
<p>2.计算距离，得到关于每个点最近的中心点，让颜色与中心点相同表示一类</p> 
<p>3.更新中心点：选取该类的点中的平均值</p> 
<p>4.重复2，3，直到中心点不会变化</p> 
<p>三、代码</p> 
<p>可用jupyter在线实现，有兴趣把代码copy上去感受感受</p> 
<pre class="has"><code class="hljs language-python">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

df=pd.DataFrame({
    'x':[12, 20, 28, 18, 29, 33, 24, 45, 45, 52, 51, 52, 55, 53, 55, 61, 64, 69,
        72],
    'y':[39, 36, 30, 52, 54, 46, 55, 59, 63, 70, 66, 63, 58, 23, 14, 8, 19, 7, 24]
})
print(df)

k=3
np.random.seed(234)
centroids={
    i+1:[np.random.randint(0,80),np.random.randint(0,80)]
    for i in range(k)
}
print(centroids)

colmap={1:'r',2:'g',3:'b'}
plt.scatter(df['x'],df['y'],color='k')
for i in centroids.keys():
    plt.scatter(centroids[i][0],centroids[i][1],color=colmap[i])
plt.xlim(0,80)
plt.ylim(0,80)
plt.show()
#第一个图，初始图，随机中心点


def assignment(df,centroids):
    for i in centroids.keys():
        df['distance_from_{}'.format(i)]=np.sqrt(
        (df['x']-centroids[i][0])**2+(df['y']-centroids[i][1])**2
        )
        #往df里面加入算与3个中心点距离的数组
    
    name=['distance_from_{}'.format(i) for i in centroids ]
    df['closest']=df.loc[:,name].idxmin(axis=1)
    #这里closest这一列会显示distance_from_1/2/3
    df['closest']=df['closest'].map(lambda x:int(x.lstrip('distance_from_{}')))
    #改名
    df['color']=df['closest'].map(lambda x:colmap[x])
    return df
df = assignment(df,centroids)
print(df)

plt.scatter(df['x'],df['y'],color=df['color'],alpha=0.5)
#非中心点经过closest得到了颜色，透明度为0.5，浅一点
for i in centroids.keys():
    plt.scatter(centroids[i][0],centroids[i][1],color=colmap[i])
plt.xlim(0,80)
plt.ylim(0,80)
plt.show()

def update():
    for i in centroids.keys():
        centroids[i][0]=np.mean(df[df['closest']==i]['x'])
        #df['closest']==i之前和i归为一类的点，将x的平均值作为该类中心点的横坐标
        centroids[i][1]=np.mean(df[df['closest']==i]['y'])
update()
#更新中心点
plt.scatter(df['x'],df['y'],color=df['color'],alpha=0.5)
for i in centroids.keys():
    plt.scatter(centroids[i][0],centroids[i][1],color=colmap[i])
plt.xlim(0,80)
plt.ylim(0,80)
plt.show()

while True:
    old_closest=df['closest']
    update()
    df=assignment(df,centroids)
    if old_closest.equals(df['closest']):
        break
        
plt.scatter(df['x'],df['y'],color=df['color'],alpha=0.5)
for i in centroids.keys():
    plt.scatter(centroids[i][0],centroids[i][1],color=colmap[i])
plt.xlim(0,80)
plt.ylim(0,80)
plt.show()
        
        
        
        
        
        
        
        </code></pre> 
<pre>     x   y
0   12  39
1   20  36
2   28  30
3   18  52
4   29  54
5   33  46
6   24  55
7   45  59
8   45  63
9   52  70
10  51  66
11  52  63
12  55  58
13  53  23
14  55  14
15  61   8
16  64  19
17  69   7
18  72  24
{1: [72, 31], 2: [68, 57], 3: [33, 3]}
</pre> 
<p><img alt="" class="has" height="252" src="https://images2.imgbox.com/e9/ad/ILADxkDm_o.png" width="375"></p> 
<pre>     x   y  distance_from_1  distance_from_2  distance_from_3  closest color
0   12  39        60.530984        58.821765        41.677332        3     b
1   20  36        52.239832        52.392748        35.468296        3     b
2   28  30        44.011362        48.259714        27.459060        3     b
3   18  52        57.939624        50.249378        51.244512        2     g
4   29  54        48.764741        39.115214        51.156622        2     g
5   33  46        41.785165        36.687873        43.000000        2     g
6   24  55        53.665631        44.045431        52.773099        2     g
7   45  59        38.897301        23.086793        57.271284        2     g
8   45  63        41.868843        23.769729        61.188234        2     g
9   52  70        43.829214        20.615528        69.641941        2     g
10  51  66        40.816663        19.235384        65.520989        2     g
11  52  63        37.735925        17.088007        62.936476        2     g
12  55  58        31.906112        13.038405        59.236813        2     g
13  53  23        20.615528        37.161808        28.284271        1     r
14  55  14        24.041631        44.922155        24.596748        1     r
15  61   8        25.495098        49.497475        28.442925        1     r
16  64  19        14.422205        38.209946        34.885527        1     r
17  69   7        24.186773        50.009999        36.221541        1     r
18  72  24         7.000000        33.241540        44.294469        1     r
</pre> 
<p><img alt="" class="has" height="252" src="https://images2.imgbox.com/46/c1/SDZHIPUa_o.png" width="375"></p> 
<p><img alt="" class="has" height="252" src="https://images2.imgbox.com/a9/ab/Blq1h48R_o.png" width="375"></p> 
<p><img alt="" class="has" height="252" src="https://images2.imgbox.com/f9/8e/SBWd2VwG_o.png" width="375"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f5cf197b0024d785114d28625c3e1b0f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">internal_error:xst:cmain.c:3423:1.29</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/25ff91010ad4e9fca795a883f9163b08/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Freehosting服务器绑定域名流程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>