<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ERROR 1327 (42000): Undeclared variable: - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ERROR 1327 (42000): Undeclared variable:" />
<meta property="og:description" content="select into from 和 insert into select都是用来复制表的
两者的主要区别为： 1）select into from 要求目标表不存在，因为在插入时会自动创建。
2） insert into select from 要求目标表存在
一、INSERT INTO SELECT语句
1、语句形式为：
Insert into Table2(field1,field2,...) select value1,value2,... from Table1
2、注意地方：
（1）要求目标表Table2必须存在，并且字段field,field2...也必须存在
（2）注意Table2的主键约束，如果Table2有主键而且不为空，则 field1， field2...中必须包括主键
（3）注意语法，不要加values，和插入一条数据的sql混了，不要写成:
Insert into Table2(field1,field2,...) values (select value1,value2,... from Table1)
（4）由于目标表Table2已经存在，所以我们除了插入源表Table1的字段外，还可以插入常量。
二、SELECT INTO FROM语句
语句形式为：
SELECT vale1, value2 into Table2 from Table1
要求目标表Table2不存在，因为在插入时会自动创建表Table2，并将Table1中指定字段数据复制到Table2中 。
总结复制表的基本语句(从旧表复制到新表)：
1、create table newTable as select * from oldTabel; 既复制表结构，也复制表内容；
2、create table newTable as select * from oldTable where 1=2; 只复制表结构，不复制表内容；" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b41fe22ab61531c60889f6d4628cfb34/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-12T13:22:48+08:00" />
<meta property="article:modified_time" content="2020-05-12T13:22:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ERROR 1327 (42000): Undeclared variable:</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>select into from 和 insert into select都是用来复制表的</p> 
<p><strong>两者的主要区别为： </strong></p> 
<p>1）select into from 要求目标表不存在，因为在插入时会自动创建。</p> 
<p>2） insert into select from 要求目标表存在</p> 
<p><strong>一、INSERT INTO SELECT语句</strong><br><br> 1、语句形式为：<br><br> Insert into Table2(field1,field2,...) select value1,value2,... from Table1<br><br> 2、注意地方：<br><br> （1）要求目标表Table2必须存在，并且字段field,field2...也必须存在<br><br> （2）注意Table2的主键约束，如果Table2有主键而且不为空，则 field1， field2...中必须包括主键<br><br> （3）注意语法，不要加values，和插入一条数据的sql混了，不要写成:<br> Insert into Table2(field1,field2,...) values (select value1,value2,... from Table1)<br><br> （4）由于目标表Table2已经存在，所以我们除了插入源表Table1的字段外，还可以插入常量。</p> 
<p> </p> 
<p><strong>二、SELECT INTO FROM语句</strong><br> 语句形式为：<br> SELECT vale1, value2 into Table2 from Table1<br> 要求目标表Table2不存在，因为在插入时会自动创建表Table2，并将Table1中指定字段数据复制到Table2中 。</p> 
<p><span style="color:#f33b45;">总结复制表的基本语句(从旧表复制到新表)：</span></p> 
<p>1、create table newTable as select * from oldTabel; 既复制表结构，也复制表内容；</p> 
<p>2、create table newTable as select * from oldTable where 1=2; 只复制表结构，不复制表内容；</p> 
<p>3、insert into newTable select * form oldTable; 不复制表结构，只复制表内容</p> 
<p>或者 select value1,value2 into newTable form oldTable;</p> 
<p> </p> 
<p>ERROR 1327 (42000): Undeclared variable:</p> 
<h2><a href="https://www.cnblogs.com/bass6/p/5757357.html" rel="nofollow" id="cb_post_title_url">select into from 提示 Undeclared variable.....错误的解决办法 ＆＆ select into from 和 insert into select 的用法和区别</a></h2> 
<p>然而今天在使用 <span style="color:#f33b45;">SELECT INTO FROM 备份mysql数据表的时候，运行相关 sql 语句的时候却一直返回 [Err] 1327 - Undeclared variable: ...... 这种错误，实在不解，经过查询相关资料才知道，原来 mysql 数据库是不支持 SELECT INTO FROM 这种语句的，但是经过研究是可以通过另外一种变通的方法解决这个问题的，下面就来说说解决这个错误</span>！</p> 
<pre><code class="language-html">mysql&gt; select user,host into user2 from user;
ERROR 1327 (42000): Undeclared variable: user2</code></pre> 
<p>解决方法是:</p> 
<p><span style="color:#f33b45;"><code class="language-html">create table user2 (select * from user);</code>这种方法会将old_table中所有的内容都拷贝过来,用这种方法需要注意,new_table中没有了old_table中的primary key,Extra,auto_increment等属性,需要自己手动加,具体参看后面的修改表即字段属性.</span></p> 
<pre><code class="language-html">mysql&gt; create table user2 (select * from user);
Query OK, 6 rows affected (0.18 sec)
Records: 6  Duplicates: 0  Warnings: 0</code></pre> 
<pre><code class="language-html">mysql&gt; create table user01 (select user,password,host from user);
Query OK, 6 rows affected (0.20 sec)
Records: 6  Duplicates: 0  Warnings: 0

mysql&gt; select * from user01;
+------+----------+-----------+
| user | password | host      |
+------+----------+-----------+
| root |          | localhost |
| root |          | lmr       |
| root |          | 127.0.0.1 |
| root |          | ::1       |
|      |          | localhost |
|      |          | lmr       |
+------+----------+-----------+
6 rows in set (0.00 sec)

mysql&gt; desc user01;
+----------+----------+------+-----+---------+-------+
| Field    | Type     | Null | Key | Default | Extra |
+----------+----------+------+-----+---------+-------+
| user     | char(16) | NO   |     |         |       |
| password | char(41) | NO   |     |         |       |
| host     | char(60) | NO   |     |         |       |
+----------+----------+------+-----+---------+-------+
3 rows in set (0.00 sec)</code></pre> 
<pre><code class="language-html">注意： SELECT INTO 复制表或表结构的时候，只是得到了一个“外壳”，就像克隆人一样，只是得到了一个躯体，个人的意识、回忆都不会克隆的。像原表的主键、外键、约束、触发 器、索引都不会被复制过来</code></pre> 
<p>CREATE TABLE 表名 AS SELECT 语句</p> 
<p>1.新表不存在<br> create table new_table select * from old_talbe;</p> 
<p><span style="color:#f33b45;">这种方法会将old_table中所有的内容都拷贝过来,用这种方法需要注意,new_table中没有了old_table中的primary key,Extra,auto_increment等属性,需要自己手动加,具体参看后面的修改表即字段属性.</span><br> 只复制表结构到新表<br>     <br> # 第一种方法,和上面类似,只是数据记录为空,即给一个false条件<br> create table new_table select * from old_table where 1=2;<br>  <br> # 第二种方法<br><span style="color:#f33b45;">create table new_table like old_table;</span></p> 
<p>2.新表存在<br> 复制旧表数据到新表(假设两个表结构一样)    <br> insert into new_table select * from old_table;</p> 
<p>复制旧表数据到新表(假设两个表结构不一样)    <br> insert into new_table(field1,field2,.....) select field1,field2,field3 from old_table;</p> 
<p>复制全部数据    <br> select * into new_table from old_table;</p> 
<p>只复制表结构到新表    <br> select * into new_talble from old_table where 1=2;</p> 
<p>    <br> create table a like b;<br>  <br> create table c_relation as select c.memberId,m.merchantId,memb.phone from c_merchant as m inner join c_customer c on c.userId=m.userId inner join c_member memb on memb.id=c.memberId where memb.status=10;<br> 由上面的使用 CREATE TABLE 表名 AS SELECT 语句可以看出：<br>     1：只会复制表数据和表结构，不会有任何约束。<br>     2：当 where 条件不成立时，只复制表结构，没有任务数据</p> 
<h4>EG:</h4> 
<p>mysql&gt; create table  marketing_automation_preview_logs_new <span style="color:#f33b45;">like</span>  marketing_automation_preview_logs;</p> 
<p>mysql&gt; show index from  marketing_automation_preview_logs;<br><br> mysql&gt; show index from  marketing_automation_preview_logs_new;<br>  </p> 
<p>mysql&gt; insert into marketing_automation_preview_logs_new (select  *   from marketing_automation_preview_logs  where act_time&gt; '1588521600');</p> 
<p>mysql&gt; select count(*) from marketing_automation_preview_logs_new;<br>  </p> 
<p>mysql&gt; select  count(*)   from marketing_automation_preview_logs  where act_time&gt; '1588521600';</p> 
<p>mysql&gt; RENAME TABLE marketing_automation_preview_logs TO marketing_automation_preview_logs20200512_back;<br><br> mysql&gt; RENAME TABLE marketing_automation_preview_logs_new TO marketing_automation_preview_logs;</p> 
<p>mysql&gt; select count(*) from marketing_automation_preview_logs;</p> 
<p>总结：</p> 
<p><span style="color:#f33b45;">create table  marketing_automation_preview_logs_new like  marketing_automation_preview_logs;</span></p> 
<p><span style="color:#f33b45;">insert into marketing_automation_preview_logs_new (select  *   from marketing_automation_preview_logs  where act_time&gt; '1588521600');</span></p> 
<p><span style="color:#f33b45;">RENAME TABLE marketing_automation_preview_logs TO marketing_automation_preview_logs20200512_back;<br><br>  RENAME TABLE marketing_automation_preview_logs_new TO marketing_automation_preview_logs;</span></p> 
<p><span style="color:#f33b45;">show index from  marketing_automation_preview_logs;</span></p> 
<p><br><span style="color:#f33b45;">select count(*) from marketing_automation_preview_logs;</span></p> 
<p> </p> 
<p><img alt="" height="792" src="https://images2.imgbox.com/e6/37/DTiHwkoa_o.png" width="1200"></p> 
<h4><img alt="" height="784" src="https://images2.imgbox.com/2d/5e/iVOB2GML_o.png" width="1200"></h4> 
<h4> </h4> 
<h4><img alt="" height="314" src="https://images2.imgbox.com/31/3a/99tbJlHh_o.png" width="990"></h4> 
<h4>mysql8 参考手册--SELECT ... INTO语句</h4> 
<p>SELECT ... INTO形式SELECT 使查询结果存储在变量或将其写入文件：<br> SELECT ... INTO var_list 选择列值并将其存储到变量中。<br> SELECT ... INTO OUTFILE将选定的行写入文件。可以指定列和行终止符以生成特定的输出格式。<br> SELECT ... INTO DUMPFILE 将单行写入文件而没有任何格式。</p> 
<p> </p> 
<p><a href="https://dev.mysql.com/doc/refman/8.0/en/select-into.html" rel="nofollow">https://dev.mysql.com/doc/refman/8.0/en/select-into.html</a></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f475816e0700f5abc3655d904a4233bb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Python记事本】之tkinter模块及文件操作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d84062020cc07d9a298786ef670c944a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java周查询和mysql的yearWeek同步</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>