<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#连接sqlServer数据库详解 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#连接sqlServer数据库详解" />
<meta property="og:description" content="C# 是如何跟SQL Server进行连接的？ 在C#/.NET程序设计中，离不开ADO.NET。ADO.NET是.NET连接数据库的重要组件。使用其可以很方便地访问数据库，ADO.NET还可以访问Oracle数据库、Access数据库、SQL Server数据库等主流的数据库。使用ADO.NET连接数据库主要使用ADO.NET中的5个类。
数据库连接类Connection：如果连接SQLServer数据库，可以使用SqlConnetion类。在使用SqlConnection类是要引用一个System.Data.SqlClient的命名空间。
数据库命令类Command：如果连接的是SQLServer数据库，可以使用SqlCommand。数据库命令类主要执行对数据库的操作，比如插入、删除、修改等。
数据库读取类DataReader：如果连接SQLServer数据库，可以使用SqlDataReader。数据库读取类是数据库命令类在执行了查询操作后返回的结果的数据类型。数据库读取类只是数据库的连接状态处于打开状态时才能使用，当数据库关闭时数据库读取类中就不能够再取值了。
数据集类DataSet：数据集相当于一个虚拟数据库，每一个数据集中包括了多张数据表。即使数据库的连接处于断开状态，还是可以从数据集中继续存取记录，只是数据是存放在数据集中的，并没有存放在数据库中。
数据适配类DataAdapter：如果连接SQLServer数据库，可以使用SqlDataAdapter。数据适配器经常和数据集一起使用，通过数据适配器可以把数据库中的数据存放到数据集中，数据适配器可以说是数据集和数据库之间的一个桥梁。
连接数据库一般有两种方式： 1、使用SQL用户名、密码验证
Data Source = 服务器名；Initial Catalog = 数据库名；User ID = 用户名；Pwd = 密码（没有密码可以省略）
例如：public string connString = &#34;Data Source=xp;Initial Catalog=ExpressManager;User ID = sa;Pwd = 123&#34;;
2、使用windows身份验证
Data Source = 服务器名；Initial Catalog = 数据库名；Integrated Security = TRUE(或者：SSPI)
例如：public string connString = &#34;Data Source=xp;Initial Catalog=ExpressManager;Integrated Security=TRUE&#34;;
在身份验证可以选SQL 用户名、密码验证。
接下来就是在源文件里加入连接数据库的代码，首先得在xxx.cs源文件中加入以下语句
using System.Data; using System.Data.SqlClient;
接下来就是对数据库的操作类方法的实现：
[csharp] view plain copy print ? // 数据库操作类 class Express { public string connString = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4ec487afced7acf9ffe9496dbd670772/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-01-05T11:32:26+08:00" />
<meta property="article:modified_time" content="2018-01-05T11:32:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#连接sqlServer数据库详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <span style="font-size:18px"> </span> 
<span style="font-size:24px"> <strong>C# 是如何跟SQL Server进行连接的？</strong></span> 
<p><img alt="" src="https://images2.imgbox.com/de/eb/vfm0dRqS_o.png"><br> </p> 
<p></p> 
<p></p> 
<p><span style="font-size:18px">       在C#/.NET程序设计中，离不开ADO.NET。ADO.NET是.NET连接数据库的重要组件。使用其可以很方便地访问数据库，ADO.NET还可以访问Oracle数据库、Access数据库、SQL Server数据库等主流的数据库。使用ADO.NET连接数据库主要使用ADO.NET中的5个类。</span></p> 
<p><span style="font-size:18px">      <span style="color:#333333"> <strong>数据库连接类Connection：</strong></span>如果连接SQLServer数据库，可以使用SqlConnetion类。在使用SqlConnection类是要引用一个System.Data.SqlClient的命名空间。</span></p> 
<p><span style="font-size:18px">       <strong>数据库命令类Command：</strong>如果连接的是SQLServer数据库，可以使用SqlCommand。数据库命令类主要执行对数据库的操作，比如插入、删除、修改等。</span></p> 
<p><span style="font-size:18px">       <strong>数据库读取类DataReader：</strong>如果连接SQLServer数据库，可以使用SqlDataReader。数据库读取类是数据库命令类在执行了查询操作后返回的结果的数据类型。数据库读取类只是数据库的连接状态处于打开状态时才能使用，当数据库关闭时数据库读取类中就不能够再取值了。</span></p> 
<p><span style="font-size:18px">       <strong>数据集类DataSet：</strong>数据集相当于一个虚拟数据库，每一个数据集中包括了多张数据表。即使数据库的连接处于断开状态，还是可以从数据集中继续存取记录，只是数据是存放在数据集中的，并没有存放在数据库中。</span></p> 
<p><span style="font-size:18px">       <strong>数据适配类DataAdapter：</strong>如果连接SQLServer数据库，可以使用SqlDataAdapter。数据适配器经常和数据集一起使用，通过数据适配器可以把数据库中的数据存放到数据集中，数据适配器可以说是数据集和数据库之间的一个桥梁。</span></p> 
<p><span style="font-size:18px"><br> </span></p>             
<span style="font-size:18px">连接数据库一般有两种方式：</span> 
<p><span style="font-size:18px">       <strong><span style="color:#ff00">1、使用SQL用户名、密码验证</span></strong></span></p> 
<p><span style="font-size:18px">        Data Source = 服务器名；Initial Catalog = 数据库名；User ID = 用户名；Pwd = 密码（没有密码可以省略）</span></p> 
<p><span style="font-size:18px">                例如：</span><span style="font-size:18px">public string connString = "Data Source=xp;Initial Catalog=ExpressManager;User ID = sa;Pwd = 123"</span><span style="font-size:18px">;</span></p> 
<p><span style="font-size:18px">      <strong><span style="color:#ff00"> 2、使用windows身份验证</span></strong></span></p> 
<p><span style="font-size:18px">        Data Source = 服务器名；Initial Catalog = 数据库名；Integrated Security = TRUE(或者：SSPI)</span></p> 
<p><span style="font-size:18px">                例如：</span><span style="font-size:18px">public string connString = "Data Source=xp;Initial Catalog=ExpressManager;Integrated Security=TRUE";</span></p> 
<p><span style="font-size:18px"><img alt="" src="https://images2.imgbox.com/d9/05/3cTbJfTr_o.png"><br> </span></p> 
<p><span style="font-size:18px">      在身份验证可以选SQL 用户名、密码验证。</span></p> 
<p><span style="font-size:18px"><br> </span></p> 
<p><span style="font-size:18px">      接下来就是在源文件里加入连接数据库的代码，首先得在xxx.cs源文件中加入以下语句</span></p> 
<p><span style="font-size:18px">      </span><span style="font-size:18px">using System.Data;</span><span style="font-size:18px"> </span></p> 
<p><span style="font-size:18px">      using System.Data.SqlClient;</span></p> 
<p><span style="font-size:18px">      接下来就是对数据库的操作类方法的实现：</span></p> 
<p><span style="font-size:18px"></span></p> 
<div class="dp-highlighter bg_csharp"> 
 <div class="bar"> 
  <div class="tools"> 
   <strong>[csharp]</strong> 
   <a target="_blank" title="view plain" class="ViewSource" href="http://blog.csdn.net/w_x_p/article/details/27581621#" rel="noopener noreferrer"> view plain</a> 
    <a target="_blank" title="copy" class="CopyToClipboard" href="http://blog.csdn.net/w_x_p/article/details/27581621#" rel="noopener noreferrer"> copy</a> 
    <a target="_blank" title="print" class="PrintSource" href="http://blog.csdn.net/w_x_p/article/details/27581621#" rel="noopener noreferrer"> print</a> 
   <a target="_blank" title="?" class="About" href="http://blog.csdn.net/w_x_p/article/details/27581621#" rel="noopener noreferrer">?</a> 
  </div> 
 </div> 
 <ol class="dp-c"><li class="alt"><span class="comment">// 数据库操作类</span>  </li><li>   <span class="keyword">class</span> Express  </li><li class="alt">   {  </li><li>       <span class="keyword">public</span> <span class="keyword">string</span> connString = <span class="string">"Data Source=xp;Initial Catalog=ExpressManager;Integrated Security=TRUE"</span>;  </li><li class="alt">       <span class="comment">//创建连接对象的变量</span>  </li><li>       <span class="keyword">public</span> SqlConnection conn;  </li><li class="alt">       <span class="comment">// 执行对数据表中数据的增加、删除、修改操作</span>  </li><li>       <span class="keyword">public</span> <span class="keyword">int</span> NonQuery(<span class="keyword">string</span> sql)  </li><li class="alt">       {  </li><li>           conn = <span class="keyword">new</span> SqlConnection(connString);  </li><li class="alt">           <span class="keyword">int</span> a = -1;  </li><li>           <span class="keyword">try</span>  </li><li class="alt">           {  </li><li>               conn.Open();  <span class="comment">//打开数据库</span>  </li><li class="alt">               SqlCommand cmd = <span class="keyword">new</span> SqlCommand(sql, conn);  </li><li>               a = cmd.ExecuteNonQuery();  </li><li class="alt">           }  </li><li>           <span class="keyword">catch</span>  </li><li class="alt">           {  </li><li>  </li><li class="alt">           }  </li><li>           <span class="keyword">finally</span>  </li><li class="alt">           {  </li><li>               <span class="keyword">if</span> (conn.State == ConnectionState.Open)  </li><li class="alt">               {  </li><li>                   conn.Close();    <span class="comment">//关闭数据库</span>  </li><li class="alt">               }  </li><li>           }  </li><li class="alt">           <span class="keyword">return</span> a;  </li><li>  </li><li class="alt">       }  </li><li>       <span class="comment">// 执行对数据表中数据的查询操作</span>  </li><li class="alt">       <span class="keyword">public</span> DataSet Query(<span class="keyword">string</span> sql)  </li><li>       {  </li><li class="alt">           conn = <span class="keyword">new</span> SqlConnection(connString);  </li><li>           DataSet ds = <span class="keyword">new</span> DataSet();  </li><li class="alt">           <span class="keyword">try</span>  </li><li>           {  </li><li class="alt">               conn.Open();      <span class="comment">//打开数据库</span>  </li><li>               SqlDataAdapter adp = <span class="keyword">new</span> SqlDataAdapter(sql, conn);  </li><li class="alt">               adp.Fill(ds);  </li><li>           }  </li><li class="alt">           <span class="keyword">catch</span>  </li><li>           {  </li><li class="alt">  </li><li>           }  </li><li class="alt">           <span class="keyword">finally</span>  </li><li>           {  </li><li class="alt">               <span class="keyword">if</span>(conn.State== ConnectionState.Open)  </li><li>               conn.Close();      <span class="comment">//关闭数据库</span>  </li><li class="alt">           }  </li><li>           <span class="keyword">return</span> ds;  </li><li class="alt">       }  </li><li>   }  </li></ol> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/07282210afeda57867f96ae897af5fa9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">django2.x报错No module named &#39;django.core.urlresolvers&#39;</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a2d820ecf04a5115cd46cb8b2b54b9a6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用51单片机驱动舵机程序分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>