<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>51单片机-------实现数字时钟功能 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="51单片机-------实现数字时钟功能" />
<meta property="og:description" content="主函数 #include &lt;REGX52.H&gt; #include &#34;Delay.h&#34; #include &#34;LCD1602.h&#34; #include &#34;Timer0.h&#34; unsigned char Sec = 55,Min = 59,Hour = 23; void main() { LCD_Init(); //初始化LCD1602显示屏 Timer0Init(); //调用 Timer0Init() 函数初始化定时器0，并设置中断 LCD_ShowString(1,1,&#34;Clock:&#34;); /*使用 LCD_ShowString() 和 LCD_ShowNum() 函数在LCD上显示初始的时钟字符串和时间*/ LCD_ShowString(2,1,&#34; : :&#34;); while(1) //无限循环，在每次迭代中调用 LCD_ShowNum() //函数更新LCD上的时间显示。 { LCD_ShowNum(2,1,Hour,2); LCD_ShowNum(2,4,Min,2); LCD_ShowNum(2,7,Sec,2); } } void Time0_Routine() interrupt 1 { static unsigned int T0Count; TL0 = 0x18;	TH0 = 0Xfc;	//使用 TL0 和 TH0 设置定时器0的初始值 T0Count&#43;&#43;; //在每次中断中，T0Count 自增并进行判断 if(T0Count&gt;=1000) //如果 T0Count 达到 1000（约为1秒）， //则将其重置为 0，并进行时间递增操作。 { T0Count = 0; //时间递增的逻辑为：秒数 Sec 自增， //如果秒数超过等于 60，则秒数重置为 0， //分钟数 Min 自增，如果分钟数超过等于 60，则分钟数重置为 0， //小时数 Hour 自增，如果小时数超过等于 24，则小时数重置为 0 Sec&#43;&#43;; if(Sec&gt;=60) { Sec=0; Min&#43;&#43;; if(Min&gt;=60) { Min = 0; Hour&#43;&#43;; if(Hour&gt;=24) { Hour = 0; } } } } } 定时器初始化函数 #include &lt;REGX52." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ae7fb59f0341aa0bec142bc23c9db2db/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-18T21:33:47+08:00" />
<meta property="article:modified_time" content="2023-05-18T21:33:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">51单片机-------实现数字时钟功能</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>主函数</h2> 
<pre><code class="language-cpp">#include  &lt;REGX52.H&gt;
#include "Delay.h"
#include "LCD1602.h"
#include "Timer0.h"


unsigned char Sec = 55,Min = 59,Hour = 23;

void main()
{
	
	LCD_Init();  //初始化LCD1602显示屏
	Timer0Init(); //调用 Timer0Init() 函数初始化定时器0，并设置中断
	LCD_ShowString(1,1,"Clock:");  /*使用 LCD_ShowString() 和 LCD_ShowNum() 
	                               函数在LCD上显示初始的时钟字符串和时间*/
	LCD_ShowString(2,1,"  :  :");
	while(1)        //无限循环，在每次迭代中调用 LCD_ShowNum() 
		               //函数更新LCD上的时间显示。
	{
		LCD_ShowNum(2,1,Hour,2); 
		LCD_ShowNum(2,4,Min,2);
		LCD_ShowNum(2,7,Sec,2);
	}

}

void Time0_Routine() interrupt 1
{
	static unsigned int T0Count;
	TL0 = 0x18;		
	TH0 = 0Xfc;	//使用 TL0 和 TH0 设置定时器0的初始值
	T0Count++;  //在每次中断中，T0Count 自增并进行判断
	if(T0Count&gt;=1000)  //如果 T0Count 达到 1000（约为1秒），
		                 //则将其重置为 0，并进行时间递增操作。
	{
		T0Count = 0;      //时间递增的逻辑为：秒数 Sec 自增，
		                  //如果秒数超过等于 60，则秒数重置为 0，
		                  //分钟数 Min 自增，如果分钟数超过等于 60，则分钟数重置为 0，
		                  //小时数 Hour 自增，如果小时数超过等于 24，则小时数重置为 0
		Sec++;
		if(Sec&gt;=60)
		{
			Sec=0;
			Min++;
			if(Min&gt;=60)
			{
				Min = 0;
				Hour++;
					if(Hour&gt;=24)
					{
						Hour = 0;
					}
			}
		
		}
	}
}



</code></pre> 
<h2>定时器初始化函数</h2> 
<pre><code class="language-cpp">#include  &lt;REGX52.H&gt;

/*
*:定时器初始化 


*/


void Timer0Init(void)
{
	 //TMOD = 0X01; //0000 0001
	
	 TMOD = TMOD&amp;0xF0; //把低四位清0，高四位不变;配置 TMOD 寄存器：通过位运算清零低四位，保留高四位，并将最低位置1，以设置定时器0的工作方式
	 TMOD = TMOD|0x01;  //把最低位置1，高四位不变
	 TL0 = 0x18;		
	 TH0 = 0Xfc;	//设置定时初始值
	 TF0 = 0;
	 TR0 = 1;
	 ET0 =1;
	 EA=1;      //打开总中断开关
	 PT0=0;
	
}


/* 定时器模板
void Time0_Routine() interrupt 1
{
	static unsigned int T0Count;
	TL0 = 0x18;		
	TH0 = 0Xfc;	//设置定时初始值
	T0Count++;
	if(T0Count&gt;=1000) 
	{
		T0Count = 0;
		P2_0 = ~P2_0;
	}
}
*/</code></pre> 
<blockquote> 
 <p>代码解读：</p> 
 <p>这段代码是一个定时器初始化函数 <code>Timer0Init()</code> 的定义，用于初始化8051单片机的定时器0。</p> 
 <p>在函数内部的操作包括：</p> 
 <ol><li>配置 <code>TMOD</code> 寄存器：通过位运算清零低四位，保留高四位，并将最低位置1，以设置定时器0的工作方式。</li><li>设置 <code>TL0</code> 和 <code>TH0</code> 的初始值：将 <code>TL0</code> 设置为 0x18，将 <code>TH0</code> 设置为 0xFC，这是用来控制定时器0计数的初值。</li><li>清除定时器0溢出标志 <code>TF0</code>。</li><li>启动定时器0：将 <code>TR0</code> 设置为 1，启动定时器0的计数。</li><li>允许定时器0中断 <code>ET0</code>，使能定时器0中断。</li><li>打开总中断开关 <code>EA</code>，允许中断的触发。</li><li>设置定时器0中断的优先级 <code>PT0</code>。</li></ol> 
 <p>这段代码的作用是初始化定时器0，使其开始工作并能够触发中断。</p> 
 <p>在使用这段代码时，需要在主程序中调用 <code>Timer0Init()</code> 函数来初始化定时器0，以启动定时器的计数和中断功能。</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/442df3b09b1a107f0414e6a57acaf677/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">STM32-ADC多通道数据采集</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1d338f97449c142ebe1c0d32ef97afbd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">keil MDK5插件推荐-Clang-format代码格式化插件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>