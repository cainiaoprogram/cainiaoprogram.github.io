<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java http post数组参数_post请求参数Json字符串包含数组的校验和处理 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java http post数组参数_post请求参数Json字符串包含数组的校验和处理" />
<meta property="og:description" content="遍历importjava.io.BufferedReader;importjava.io.IOException;importjava.io.InputStream;importjava.io.InputStreamReader;importjava.io.PrintWriter;importjava.util.HashMap;importjava.util.Map;importorg.apache.log4j.Logger;importjavax.servlet.ServletException;importjavax.servlet.http.HttpServlet;importjavax.servlet.http.HttpServletRequest;importjavax.servlet.http.HttpServletResponse;importcom.alibaba.fastjson.JSON;importcom.alibaba.fastjson.JSONArray;importcom.alibaba.fastjson.JSONObject;importcom.xxx.live.core.util.others.ConfigUtil;importcom.xxxx.live.webapp.util.HttpClientUtil;importcom.xxxx.mobilevideo.core.util.StringUtil;/*** Servlet implementation class CloudCutStreamServlet*/
public class CloudCutStreamServlet extendsHttpServlet {private static final long serialVersionUID = 1L;
Logger log= Logger.getLogger(RecordFinishServlet.class);/***@seeHttpServlet#HttpServlet()*/
publicCloudCutStreamServlet() {super();
}/***@seeHttpServlet#doGet(HttpServletRequest request, HttpServletResponse
* response)*/
protected voiddoGet(HttpServletRequest req, HttpServletResponse resp)throwsServletException, IOException {//TODO Auto-generated method stub
this.doPost(req, resp);
}/***@seeHttpServlet#doPost(HttpServletRequest request, HttpServletResponse
* response)*/
protected voiddoPost(HttpServletRequest req, HttpServletResponse resp)throwsServletException, IOException {
//1.校验参数
JSONObject resultMap = this.getResutltMap(req);if (null ==resultMap) {
response(resp, getMsg(false, &#34;请求参数格式不正确&#34;, &#34;10002&#34;));return;
}
String liveName= resultMap.getString(&#34;liveName&#34;);
String masterUrl= resultMap.getString(&#34;masterUrl&#34;);" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/089b2133215d30079b9f54a159f1da1d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-27T08:51:13+08:00" />
<meta property="article:modified_time" content="2021-02-27T08:51:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java http post数组参数_post请求参数Json字符串包含数组的校验和处理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>遍历importjava.io.BufferedReader;importjava.io.IOException;importjava.io.InputStream;importjava.io.InputStreamReader;importjava.io.PrintWriter;importjava.util.HashMap;importjava.util.Map;importorg.apache.log4j.Logger;importjavax.servlet.ServletException;importjavax.servlet.http.HttpServlet;importjavax.servlet.http.HttpServletRequest;importjavax.servlet.http.HttpServletResponse;importcom.alibaba.fastjson.JSON;importcom.alibaba.fastjson.JSONArray;importcom.alibaba.fastjson.JSONObject;importcom.xxx.live.core.util.others.ConfigUtil;importcom.xxxx.live.webapp.util.HttpClientUtil;importcom.xxxx.mobilevideo.core.util.StringUtil;/*** Servlet implementation class CloudCutStreamServlet*/</p> 
 <p>public class CloudCutStreamServlet extendsHttpServlet {private static final long serialVersionUID = 1L;</p> 
 <p>Logger log= Logger.getLogger(RecordFinishServlet.class);/***@seeHttpServlet#HttpServlet()*/</p> 
 <p>publicCloudCutStreamServlet() {super();</p> 
 <p>}/***@seeHttpServlet#doGet(HttpServletRequest request, HttpServletResponse</p> 
 <p>* response)*/</p> 
 <p>protected voiddoGet(HttpServletRequest req, HttpServletResponse resp)throwsServletException, IOException {//TODO Auto-generated method stub</p> 
 <p>this.doPost(req, resp);</p> 
 <p>}/***@seeHttpServlet#doPost(HttpServletRequest request, HttpServletResponse</p> 
 <p>* response)*/</p> 
 <p>protected voiddoPost(HttpServletRequest req, HttpServletResponse resp)throwsServletException, IOException {<!-- --></p> 
 <p>//1.校验参数</p> 
 <p>JSONObject resultMap = this.getResutltMap(req);if (null ==resultMap) {<!-- --></p> 
 <p>response(resp, getMsg(false, "请求参数格式不正确", "10002"));return;</p> 
 <p>}</p> 
 <p>String liveName= resultMap.getString("liveName");</p> 
 <p>String masterUrl= resultMap.getString("masterUrl");</p> 
 <p>String slaveUrl= resultMap.getString("slaveUrl"); //可以为空</p> 
 <p>String reason=resultMap.getString("reason"); //切流原因不可以为空</p> 
 <p>JSONArray waterMark=resultMap.getJSONArray("waterMark"); //接收对象里的数组//判断水印是否为空，为空则使用默认水印，</p> 
 <p>if(waterMark.isEmpty()){//使用默认的水印</p> 
 <p>String waterMarkDefaultValue="[{'name':'默认name1','position':'默认地址1'},{'name':'默认name2','position':'默认地址2'}]";</p> 
 <p>resultMap.put("waterMark", waterMarkDefaultValue);</p> 
 <p>}else{//水印不为空判断数组中的json的key值是否为空</p> 
 <p>int jsonSize = waterMark.size(); //获取数组长度</p> 
 <p>for(int i=0;i</p> 
 <p>JSONObject jsonTemp=(JSONObject)waterMark.getJSONObject(i);</p> 
 <p>if(StringUtil.isNullStr(jsonTemp.getString("name"))||StringUtil.isNullStr(jsonTemp.getString("position"))){response(resp, getMsg(false, "参数为空", "10001"));return;</p> 
 <p>}</p> 
 <p>}</p> 
 <p>}//接受参数校验</p> 
 <p>if (StringUtil.isNullStr(liveName) || StringUtil.isNullStr(masterUrl)||StringUtil.isNullStr(reason)) {response(resp, getMsg(false, "参数为空", "10001"));return;</p> 
 <p>}//参数正常</p> 
 <p>try{<!-- --></p> 
 <p>String result="";</p> 
 <p>String change_source_url= ConfigUtil.getProperty("change_source_Url");response(resp, getMsg(true, "请求成功", "99999"));</p> 
 <p>}catch(Exception e) {<!-- --></p> 
 <p>e.printStackTrace();</p> 
 <p>}}publicJSONObject getResutltMap(HttpServletRequest req) {<!-- --></p> 
 <p>String requestStr= "";</p> 
 <p>StringBuilder sb= newStringBuilder();</p> 
 <p>InputStream is= null;</p> 
 <p>BufferedReader dis= null;try{<!-- --></p> 
 <p>is=req.getInputStream();</p> 
 <p>dis= new BufferedReader(new InputStreamReader(is, "utf-8"));</p> 
 <p>String str= "";while ((str = dis.readLine()) != null) {<!-- --></p> 
 <p>sb.append(str);</p> 
 <p>}</p> 
 <p>}catch(IOException e) {<!-- --></p> 
 <p>e.printStackTrace();</p> 
 <p>}finally{try{if (dis != null) {<!-- --></p> 
 <p>dis.close();</p> 
 <p>}if (is != null) {<!-- --></p> 
 <p>is.close();</p> 
 <p>}</p> 
 <p>}catch(IOException e) {<!-- --></p> 
 <p>e.printStackTrace();</p> 
 <p>}</p> 
 <p>}</p> 
 <p>requestStr=sb.toString();try{<!-- --></p> 
 <p>JSONObject json=JSON.parseObject(requestStr);returnjson;</p> 
 <p>}catch(Exception e) {}return null;</p> 
 <p>}private String getMsg(booleansuccess, String msg, String errCode) {<!-- --></p> 
 <p>Map returnMap = new HashMap();</p> 
 <p>returnMap.put("success", success);</p> 
 <p>returnMap.put("msg", msg);</p> 
 <p>returnMap.put("errCode", errCode);</p> 
 <p>String returnJson=JSON.toJSONString(returnMap);returnreturnJson;</p> 
 <p>}private voidresponse(HttpServletResponse resp, String msg) {try{<!-- --></p> 
 <p>resp.setContentType("text/html");</p> 
 <p>resp.setCharacterEncoding("UTF-8");</p> 
 <p>PrintWriter out=resp.getWriter();</p> 
 <p>out.println(msg);</p> 
 <p>out.close();</p> 
 <p>}catch(Exception e) {<!-- --></p> 
 <p>log.error(e.getMessage(), e);</p> 
 <p>}</p> 
 <p>}</p> 
 <p>}</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b797eda207da611ec2b1832aa7a8f2e8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">resourse rest java_java – 使用RepositoryRestResource注释来更改RESTful端点不工作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/00a556a8c307d9782d2548b9919af536/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Centos的环境变量的问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>