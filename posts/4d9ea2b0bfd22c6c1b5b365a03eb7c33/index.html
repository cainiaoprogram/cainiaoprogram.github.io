<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>WPF学习之资源-Resources - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="WPF学习之资源-Resources" />
<meta property="og:description" content="WPF通过资源来保存一些可以被重复利用的样式，对象定义以及一些传统的资源如二进制数据，图片等等，而在其支持上也更能体现出这些资源定义的优越性。比如通过ResourceDictionary的支持就可以通过资源来实现换肤功能，在ExpressionBlend中设计的酷炫造型也可以通过导出成资源来很容易的被程序员所引用，本地化的实现，访问另外程序集的嵌入式资源等等。这些都给我们提供了丰富的手段通过资源访问架构来构建丰富的富媒体应用程序。本文简单讲解了WPF Resources的分类及其常见用法，并简单触及用ResourceDictionary来管理多个Resources文件（这是换肤的基础）。
在WPF中的资源不仅依赖于核心.NET的资源系统，在其基础上也添加了对两种不同资源类型的支持：二进制资源和逻辑资源。而对于这些资源类型的构建动作也有了更多的支持选项。
1. 二进制资源
二进制资源其实是一些传统的资源项，比如位图，音频文件，视频文件，松散文件(Loose file)等等。对于这些资源项我们可以将其存储为松散文件，或者编译进程序集中。这与传统的.NET程序其实是相通的，但在WPF中提供了两种对二进制资源的构建选项：
· Resource: 将资源放入程序集中（如果是有本地化支持的话会编译到对应语言集的子程序集中。
· Content：将这个资源作为一个松散文件加入到程序集中，程序集会记录对应的文件是否存在及其路径。这就相当于我们web开发中常用的构建动作。
对于MSBuild来说这也是默认的构建类型，例如，
&lt;Content Include=&#34;Images\Go.ico&#34; /&gt;
&lt;Content Include=&#34;Images\Go.jpg&#34; /&gt;
&lt;Content Include=&#34;Images\Go2.gif&#34; /&gt;
&lt;Content Include=&#34;Images\Go2.jpg&#34; /&gt;
&lt;Content Include=&#34;Images\information16.png&#34; /&gt;
&lt;Content Include=&#34;Images\pass16.png&#34; /&gt;
&lt;Content Include=&#34;Images\pass32.png&#34; /&gt;
&lt;Content Include=&#34;Images\unknown16.png&#34; /&gt;
&lt;Content Include=&#34;Images\warning.gif&#34; /&gt;
&lt;Content Include=&#34;Images\warning16.png&#34; /&gt;
&lt;EmbeddedResource Include=&#34;LoginForm.resx&#34;&gt;
&lt;SubType&gt;Designer&lt;/SubType&gt;
&lt;DependentUpon&gt;LoginForm.cs&lt;/DependentUpon&gt;
&lt;/EmbeddedResource&gt;
&lt;EmbeddedResource Include=&#34;OptionsForm.resx&#34;&gt;
&lt;SubType&gt;Designer&lt;/SubType&gt;
&lt;DependentUpon&gt;OptionsForm.cs&lt;/DependentUpon&gt;
&lt;/EmbeddedResource&gt;
&lt;EmbeddedResource Include=&#34;PageHistory.resx&#34;&gt;
&lt;SubType&gt;Designer&lt;/SubType&gt;
&lt;DependentUpon&gt;PageHistory.cs&lt;/DependentUpon&gt;
&lt;/EmbeddedResource&gt;
上图所示是一个普通的WinForm应用程序的项目文件，对于添加到其内部的二进制资源文件其默认的构建动作便是Content-表明其作为一个松散文件存储，只要保证其对应路径的文件存在则可以自动加载（而无需再你的打包文件中必须包含）。而你也会看到EmbeddedResource构建动作，这是WinForm的构建动作，它和Resource构建动作很相似，会在程序集中嵌入一个二进制资源，但是WPF中因为嵌入式资源比WPF还要优先，所以需要尽量避免使用。
之所以推荐使用Resource和Content构建类型是因为这样嵌入的资源可以很容易的在XAML中被引用，而且对于WPF的统一资源识别符也是专门针对这两种构建动作而设计的。相反地，对于EmbeddedResource构建动作嵌入的资源是不能在XAML中被引用的，除非自定义代码。
· 访问二进制资源
访问二进制资源最普通的就是对松散文件的访问，这和普通的.NET应用程序没什么两样，直接看例子吧：
&lt;StackPanel Orientation=&#34;Horizontal&#34; HorizontalAlignment=&#34;Center&#34;&gt;
&lt;Button Background=&#34;Yellow&#34; BorderBrush=&#34;Red&#34; Margin=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4d9ea2b0bfd22c6c1b5b365a03eb7c33/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-05-14T14:15:31+08:00" />
<meta property="article:modified_time" content="2012-05-14T14:15:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">WPF学习之资源-Resources</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>WPF通过资源来保存一些可以被重复利用的样式，对象定义以及一些传统的资源如二进制数据，图片等等，而在其支持上也更能体现出这些资源定义的优越性。比如通过ResourceDictionary的支持就可以通过资源来实现换肤功能，在ExpressionBlend中设计的酷炫造型也可以通过导出成资源来很容易的被程序员所引用，本地化的实现，访问另外程序集的嵌入式资源等等。这些都给我们提供了丰富的手段通过资源访问架构来构建丰富的富媒体应用程序。本文简单讲解了WPF Resources的分类及其常见用法，并简单触及用ResourceDictionary来管理多个Resources文件（这是换肤的基础）。</p> 
<p><u> </u></p> 
<p>在WPF中的资源不仅依赖于核心.NET的资源系统，在其基础上也添加了对两种不同资源类型的支持：二进制资源和逻辑资源。而对于这些资源类型的构建动作也有了更多的支持选项。</p> 
<p> </p> 
<p><strong>1.     二进制资源</strong></p> 
<p> </p> 
<p>二进制资源其实是一些传统的资源项，比如位图，音频文件，视频文件，松散文件(Loose file)等等。对于这些资源项我们可以将其存储为松散文件，或者编译进程序集中。这与传统的.NET程序其实是相通的，但在WPF中提供了两种对二进制资源的构建选项：</p> 
<p>·         <strong>Resource</strong>: 将资源放入程序集中（如果是有本地化支持的话会编译到对应语言集的子程序集中。</p> 
<p>·         <strong>Content</strong>：将这个资源作为一个松散文件加入到程序集中，程序集会记录对应的文件是否存在及其路径。这就相当于我们web开发中常用的构建动作。</p> 
<p>对于MSBuild来说这也是默认的构建类型，例如，</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p>    &lt;Content Include="Images\Go.ico" /&gt;</p> <p>    &lt;Content Include="Images\Go.jpg" /&gt;</p> <p>    &lt;Content Include="Images\Go2.gif" /&gt;</p> <p>    &lt;Content Include="Images\Go2.jpg" /&gt;</p> <p>    &lt;Content Include="Images\information16.png" /&gt;</p> <p>    &lt;Content Include="Images\pass16.png" /&gt;</p> <p>    &lt;Content Include="Images\pass32.png" /&gt;</p> <p>    &lt;Content Include="Images\unknown16.png" /&gt;</p> <p>    &lt;Content Include="Images\warning.gif" /&gt;</p> <p>    &lt;Content Include="Images\warning16.png" /&gt;</p> <p>    &lt;EmbeddedResource Include="LoginForm.resx"&gt;</p> <p>      &lt;SubType&gt;Designer&lt;/SubType&gt;</p> <p>      &lt;DependentUpon&gt;LoginForm.cs&lt;/DependentUpon&gt;</p> <p>    &lt;/EmbeddedResource&gt;</p> <p>    &lt;EmbeddedResource Include="OptionsForm.resx"&gt;</p> <p>      &lt;SubType&gt;Designer&lt;/SubType&gt;</p> <p>      &lt;DependentUpon&gt;OptionsForm.cs&lt;/DependentUpon&gt;</p> <p>    &lt;/EmbeddedResource&gt;</p> <p>    &lt;EmbeddedResource Include="PageHistory.resx"&gt;</p> <p>      &lt;SubType&gt;Designer&lt;/SubType&gt;</p> <p>      &lt;DependentUpon&gt;PageHistory.cs&lt;/DependentUpon&gt;</p> <p>    &lt;/EmbeddedResource&gt;<strong></strong></p> </td></tr></tbody></table> 
<p> </p> 
<p>上图所示是一个普通的WinForm应用程序的项目文件，对于添加到其内部的二进制资源文件其默认的构建动作便是Content-表明其作为一个松散文件存储，只要保证其对应路径的文件存在则可以自动加载（而无需再你的打包文件中必须包含）。而你也会看到EmbeddedResource构建动作，这是WinForm的构建动作，它和Resource构建动作很相似，会在程序集中嵌入一个二进制资源，但是WPF中因为嵌入式资源比WPF还要优先，所以需要尽量避免使用。</p> 
<p>之所以推荐使用Resource和Content构建类型是因为这样嵌入的资源可以很容易的在XAML中被引用，而且对于WPF的统一资源识别符也是专门针对这两种构建动作而设计的。相反地，对于EmbeddedResource构建动作嵌入的资源是不能在XAML中被引用的，除非自定义代码。</p> 
<p> </p> 
<p>·         访问二进制资源</p> 
<p> </p> 
<p>访问二进制资源最普通的就是对松散文件的访问，这和普通的.NET应用程序没什么两样，直接看例子吧：</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">StackPanel</span><span style="color:red"> Orientation</span><span style="color:blue">="Horizontal"</span><span style="color:red"> HorizontalAlignment</span><span style="color:blue">="Center"&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> Background</span><span style="color:blue">="Yellow"</span><span style="color:red"> BorderBrush</span><span style="color:blue">="Red"</span><span style="color:red"> Margin</span><span style="color:blue">="5"&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Image</span><span style="color:red"> Height</span><span style="color:blue">="21"</span><span style="color:red"> Source</span><span style="color:blue">="zoom.gif"/&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Button</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> Background</span><span style="color:blue">="Yellow"</span><span style="color:red"> BorderBrush</span><span style="color:blue">="Red"</span><span style="color:red"> Margin</span><span style="color:blue">="5"&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Image</span><span style="color:red"> Height</span><span style="color:blue">="21"</span><span style="color:red"> Source</span><span style="color:blue">="defaultThumbnailSize.gif"/&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Button</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> Background</span><span style="color:blue">="Yellow"</span><span style="color:red"> BorderBrush</span><span style="color:blue">="Red"</span><span style="color:red"> Margin</span><span style="color:blue">="5"&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Image</span><span style="color:red"> Height</span><span style="color:blue">="21"</span><span style="color:red"> Source</span><span style="color:blue">="previous.gif"/&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Button</span><span style="color:blue">&gt;</span></p> <p><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">StackPanel</span><span style="color:blue">&gt;</span></p> </td></tr></tbody></table> 
<p> </p> 
<p>上述的的松散文件只需要以Content构建加入项目即可. 这只是普通的访问方式，当然也是我们常用的，但也有很多你可能需要用到哦，不妨看看：</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><strong>资源URI</strong></p> </td><td> <p><strong>资源</strong></p> </td></tr><tr><td> <p>zoom.gif</p> </td><td> <p>存放于当前程序集；或是添加到项目的松散文件。</p> </td></tr><tr><td> <p>Folder/zoom.gif</p> </td><td> <p>如果内部有目录结构时加入相对目录结构。</p> </td></tr><tr><td> <p>C:\Images\zoom.gif</p> <p><a href="http://www.cnblogs.com/zlgcool/admin/file:///C:/Images/zoom.gif" rel="nofollow" style="color:rgb(120,175,211)"><span style="color:#0000ff">file://C:/Images/zoom.gif</span></a></p> </td><td> <p>绝对路径的松散文件</p> </td></tr><tr><td> <p>\\FileServer\Images\zoom.gif</p> </td><td> <p>共享目录的松散文件</p> </td></tr><tr><td> <p>http://my.net/zoom.gif</p> </td><td> <p>位于某个站点上的松散文件</p> </td></tr><tr><td> <p>AssemblyReference;Component/ResourceName</p> </td><td> <p>访问嵌入到另外一个程序集或EXE文件内的资源。Component是关键字，必须写。例如：</p> <p>MyDll;Component/Images/zoom.gif;</p> </td></tr><tr><td> <p>pack://siteOfOrigin:,,,/Images/zoom.gif</p> </td><td> <p>访问位于部署位置的资源。</p> </td></tr></tbody></table> 
<p> </p> 
<p><strong>2.     逻辑资源</strong></p> 
<p>逻辑资源是WPF特有的资源类型，它是存储在元素的Resources属性中的.NET对象，通常需要共享给多个子元素。换句话说，你可以声明一个SolidColorBrush对象当作一个逻辑资源，你也可以声明一个Style，然后再后续的XAML中简单通过{StaticResource ResourceName}来使用。资源定义需要有一个在ResourceDictionary中唯一的关键字x:Key(单独的ResourceDictionary中的键名不可以重复，多个ResourceDictionary中键名可以重复，会根据在逻辑数上的lookup的顺序来就近生效)。例如下边的逻辑资源声明：</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Window</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Class</span><span style="color:blue">="WpfApplication1.Window2"</span></p> <p>   <span style="color:red"> xmlns</span><span style="color:blue">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></p> <p>   <span style="color:red"> xmlns</span><span style="color:blue">:</span><span style="color:red">x</span><span style="color:blue">="http://schemas.microsoft.com/winfx/2006/xaml"</span></p> <p>   <span style="color:red"> Title</span><span style="color:blue">="Window2"</span><span style="color:red"> Height</span><span style="color:blue">="300"</span><span style="color:red"> Width</span><span style="color:blue">="400"&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Window.Resources</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">SolidColorBrush</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="buttonBackground"&gt;</span><span style="color:rgb(163,21,21)">Yellow</span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">SolidColorBrush</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">SolidColorBrush</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="borderBrush"&gt;</span><span style="color:rgb(163,21,21)">Red</span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">SolidColorBrush</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">LinearGradientBrush</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="backgroundBrush"</span><span style="color:red"> StartPoint</span><span style="color:blue">="0,0"</span><span style="color:red"> EndPoint</span><span style="color:blue">="1,1"&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:red"> Color</span><span style="color:blue">="Blue"</span><span style="color:red"> Offset</span><span style="color:blue">="0"&gt;&lt;/</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:red"> Color</span><span style="color:blue">="White"</span><span style="color:red"> Offset</span><span style="color:blue">="0.5"&gt;&lt;/</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:red"> Color</span><span style="color:blue">="Red"</span><span style="color:red"> Offset</span><span style="color:blue">="1"&gt;&lt;/</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">LinearGradientBrush</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Window.Resources</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Window.Background</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> ResourceKey</span><span style="color:blue">="backgroundBrush" /&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Window.Background</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Grid</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">StackPanel</span><span style="color:red"> Orientation</span><span style="color:blue">="Horizontal"</span><span style="color:red"> HorizontalAlignment</span><span style="color:blue">="Center"&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> Background</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> buttonBackground</span><span style="color:blue">}"</span><span style="color:red"> BorderBrush</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> borderBrush</span><span style="color:blue">}"</span><span style="color:red"> Margin</span><span style="color:blue">="5"</span><span style="color:red"> Height</span><span style="color:blue">="28"&gt;</span></p> <p><span style="color:rgb(163,21,21)">                </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Image</span><span style="color:red"> Height</span><span style="color:blue">="21"</span><span style="color:red"> Source</span><span style="color:blue">="Images\zoom.gif"&gt;&lt;/</span><span style="color:rgb(163,21,21)">Image</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Button</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> Background</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> buttonBackground</span><span style="color:blue">}"</span><span style="color:red"> BorderBrush</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> borderBrush</span><span style="color:blue">}"</span><span style="color:red"> Margin</span><span style="color:blue">="5"</span><span style="color:red"> Height</span><span style="color:blue">="28"&gt;</span></p> <p><span style="color:rgb(163,21,21)">                </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Image</span><span style="color:red"> Height</span><span style="color:blue">="21"</span><span style="color:red"> Source</span><span style="color:blue">="Images\previous.gif"&gt;&lt;/</span><span style="color:rgb(163,21,21)">Image</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Button</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> Background</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> buttonBackground</span><span style="color:blue">}"</span><span style="color:red"> BorderBrush</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">DynamicResource</span><span style="color:red">borderBrush</span><span style="color:blue">}"</span> <span style="color:red"> Margin</span><span style="color:blue">="5"</span><span style="color:red"> Height</span><span style="color:blue">="28"&gt;</span></p> <p><span style="color:rgb(163,21,21)">                </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Image</span><span style="color:red"> Height</span><span style="color:blue">="21"</span><span style="color:red"> Source</span><span style="color:blue">="Images\next.gif"&gt;&lt;/</span><span style="color:rgb(163,21,21)">Image</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Button</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">StackPanel</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Grid</span><span style="color:blue">&gt;</span></p> <p><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Window</span><span style="color:blue">&gt;</span></p> </td></tr></tbody></table> 
<p> </p> 
<p>一个资源可以被以StaticResource或者DynamicResource的方式来引用，这是以标记扩展(StaticResource/DynamicResource Markup Extension)来标注的。去以StaticResource还是以DynamicResource来引用一个资源，这取决于：</p> 
<p>·         你是以什么样的方式来为你的应用创建资源的：每个Page?一个Application？一个松散XAML文件？还是一个只包含资源定义的程序集？</p> 
<p>·         需要在运行时更新你的资源吗？</p> 
<p>·         查找资源的行为—向前查询？</p> 
<p>·         资源本身的行为和属性</p> 
<p> </p> 
<p><strong>3.     Static Resource – 静态资源</strong></p> 
<p> </p> 
<p>StaticResource仅仅会被应用一次---在第一次需要资源时加载。而且这种引用方式不支持向前加载，所有的资源定义必须在引用之前定义。StaticResource通常用在：</p> 
<p>·         设计的APP是将所有的资源放入Page或者App这个级别的Resource Dictionary中的，而且不需要在运行时重新计算—例如只保存一些松散文件，逻辑资源的声明等。</p> 
<p>·         不需要给DependencyObject或者Freezable的对象设置属性。</p> 
<p>·         Resource Dictionary将被编译进DLL.</p> 
<p>·         需要给很多的Dependency Property赋值。</p> 
<p>将一个资源以Static Resource引用，需要用到Static Resource Markup Extension。 它在已经定义的资源中查询特定key的value为XAML的某个属性赋值。这个查询的行为与load-time查找类似，在当前Page的XAML中或者所有Application的Resources中查找，并在运生成运行时对象。</p> 
<p> </p> 
<p>XAML Attribute Usage</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p>&lt;object property=”StaticResource key}” … /&gt;</p> </td></tr></tbody></table> 
<p> </p> 
<p>XAML Object Element Usage</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p>&lt;object&gt;</p> <p>&lt;object.Property&gt;</p> <p>    &lt;StaticResource ResourceKey = “key” …/&gt;</p> <p>&lt;/object.Property&gt;</p> <p>&lt;/object&gt;</p> </td></tr></tbody></table> 
<p>前者是我们经常会用到的方式，比如给一个属性赋予一个早先定义的话刷格式：</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> Background</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> buttonBackground</span><span style="color:blue">}"</span><span style="color:red"> BorderBrush</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> borderBrush</span><span style="color:blue">}"</span><span style="color:red"> Margin</span><span style="color:blue">="5"</span><span style="color:red"> Height</span><span style="color:blue">="28"&gt;</span><strong></strong></p> </td></tr></tbody></table> 
<p>而后者我们在前面的例子中也看到了，用法稍微特殊，其实在这个情况下这个资源肯定是一个逻辑资源，相当于一段声明对象的代码。比如给window设背景：</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Window.Background</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> ResourceKey</span><span style="color:blue">="backgroundBrush" /&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Window.Background</span><span style="color:blue">&gt;</span><strong></strong></p> </td></tr></tbody></table> 
<p> </p> 
<p><strong><em>Static Resource的查找行为</em></strong></p> 
<p> </p> 
<p>·         首先检查此对象本身的Resources集合内是否有匹配值（根据ResourceKey）</p> 
<p>·         其次会在逻辑树中向上搜寻父元素的Resource Dictionary.</p> 
<p>·         最后会检查Root级别的比如Page,Window，Application等。</p> 
<p> </p> 
<p><strong>4.     Dynamic Resource – 动态资源</strong></p> 
<p> </p> 
<p>与Static Resource不同的是，Dynamic Resource可以在程序运行时重新评估/计算资源来生成对应的对象/值，它支持向前引用，只要请求的key在整个应用程序内的任何Resources Dictionary定义过就可以被加载。如果有多个相同的key存在，则最后搜索到的资源为有效。</p> 
<p> </p> 
<p>动态资源常用于以下情况：</p> 
<p>·         资源直到运行时才能被取定其值的。这些包含想系统资源，或者通过用户交互/用户可以设定的值。例如你可以用Setter Property语法来引用一些系统资源像SystemColors, SystemFonts等，这些是真正的Dynamic Resource，因为他们是来自用户的运行环境。</p> 
<p>·         在Custom control中有创建/引用主题风格的需求.</p> 
<p>·         在运行过程中调整（比如添加或者合并）ReourceDictionary.</p> 
<p>·         需要向前引用的场景。</p> 
<p>·         创建的Style的值与当前用户设定的主题或其他设定有关的。</p> 
<p>·         运行过程中可能更改逻辑树的次序的。</p> 
<p>下面的代码片段演示了如何在XAML中引用SystemFonts,这需要用DynamicResource标记：</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Style</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="SimpleFont"</span><span style="color:red"> TargetType</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">x</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">Type</span><span style="color:red"> Button</span><span style="color:blue">}"&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Setter</span><span style="color:red"> Property</span><span style="color:blue"> = "FontSize"</span><span style="color:red"> Value</span><span style="color:blue">= "{<!-- --></span><span style="color:rgb(163,21,21)">DynamicResource</span><span style="color:blue"> {<!-- --></span><span style="color:rgb(163,21,21)">x</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">Static</span><span style="color:red"> SystemFonts</span><span style="color:blue">.</span><span style="color:red">IconFontSizeKey</span><span style="color:blue">}}"/&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Setter</span><span style="color:red"> Property</span><span style="color:blue"> = "FontWeight"</span><span style="color:red"> Value</span><span style="color:blue">= "{<!-- --></span><span style="color:rgb(163,21,21)">DynamicResource</span><span style="color:blue"> {<!-- --></span><span style="color:rgb(163,21,21)">x</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">Static</span><span style="color:red"> SystemFonts</span><span style="color:blue">.</span><span style="color:red">MessageFontWeightKey</span><span style="color:blue">}}"/&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Setter</span><span style="color:red"> Property</span><span style="color:blue"> = "FontFamily"</span><span style="color:red"> Value</span><span style="color:blue">= "{<!-- --></span><span style="color:rgb(163,21,21)">DynamicResource</span><span style="color:blue"> {<!-- --></span><span style="color:rgb(163,21,21)">x</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">Static</span><span style="color:red"> SystemFonts</span><span style="color:blue">.</span><span style="color:red">CaptionFontFamilyKey</span><span style="color:blue">}}"/&gt;</span></p> <p><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Style</span><span style="color:blue">&gt;</span><strong></strong></p> </td></tr></tbody></table> 
<p> </p> 
<p><strong><em>Dynamic Resource的查找行为</em></strong></p> 
<p>·         首先遍历请求对象本身定义的Resources集合。</p> 
<p>·         然后遍历逻辑树上当前请求对象的父对象，直到遍历到Root（如Page.Reources, Window.Resources, UserControl.Resources等）</p> 
<p>·         随后会遍历应用程序的Resources(即Application.Resources)</p> 
<p>·         进而会Check当前激活的Theme的资源。</p> 
<p>·         最后才会去遍历System Resources.</p> 
<p>在程序中你可以通过myWindow.Resources[“key”]的方式来直接访问一个资源。另外，WPF还提供了TryFindResource(key)和FindResource(key)来支持资源搜索。FindResource方法在没找到资源的情况下会触发<a href="http://msdn.microsoft.com/en-us/library/system.windows.resourcereferencekeynotfoundexception.aspx" rel="nofollow" style="color:rgb(120,175,211)"><span style="font-family:Tahoma; color:#0000ff">ResourceReferenceKeyNotFoundException</span></a>异常。</p> 
<p> </p> 
<p>其实通过上边的示例我们可以很清楚的看到，在使用静态资源的地方我们往往都可以使用动态资源，他们并没有什么合适与否之说，而选择它们中的哪一个，完全取决于你是否需要资源的使用者发现更新。我们可以再来比较一下二者的区别：</p> 
<p> </p> 
<p>·         对于资源的更新会反映在那些使用了动态资源的元素上，这是他们最主要的区别。</p> 
<p>·         性能上：因为动态资源要跟踪变化，所以需要占用更多的资源。而静态资源往往是在window或page加载之后来引用，动态资源会改善加载时间。但静态资源在使用时却会有些许性能的提升。</p> 
<p>·         动态资源只能设置依赖属性只，而静态资源可以在任何地方使用。比如，我们可以声明一个逻辑资源把它当作一个元素来用，而动态资源却无法做到：</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Window</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Class</span><span style="color:blue">="WpfApplication1.Window3"</span>  <span style="color:red"> xmlns</span><span style="color:blue">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></p> <p>   <span style="color:red"> xmlns</span><span style="color:blue">:</span><span style="color:red">x</span><span style="color:blue">="http://schemas.microsoft.com/winfx/2006/xaml"</span></p> <p>   <span style="color:red"> Title</span><span style="color:blue">="Window3"</span><span style="color:red"> Height</span><span style="color:blue">="300"</span><span style="color:red"> Width</span><span style="color:blue">="300"&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Window.Resources</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> Background</span><span style="color:blue">="Blue"</span> <span style="color:red"> Margin</span><span style="color:blue">="5"</span><span style="color:red"> Height</span><span style="color:blue">="28"</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="prev"&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Image</span><span style="color:red"> Height</span><span style="color:blue">="21"</span><span style="color:red"> Source</span><span style="color:blue">="Images\previous.gif"&gt;&lt;/</span><span style="color:rgb(163,21,21)">Image</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Button</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Window.Resources</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Grid</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> Height</span><span style="color:blue">="20"</span><span style="color:red"> Width</span><span style="color:blue">="70"</span><span style="color:red"> Content</span><span style="color:blue">="Content" /&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> ResourceKey</span><span style="color:blue">="prev" /&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Grid</span><span style="color:blue">&gt;</span></p> <p><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Window</span><span style="color:blue">&gt;</span></p> </td></tr></tbody></table> 
<p>·         当你在XAML中使用StaticResource时，是不支持Forward Reference的，也就是说任何资源必须在XAML文件中声明之后才可以使用。如果是在同一个元素中定义，则只能使用Dynamic Resource。</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Window</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Class</span><span style="color:blue">="WpfApplication1.Window3"</span></p> <p>   <span style="color:red"> xmlns</span><span style="color:blue">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></p> <p>   <span style="color:red"> xmlns</span><span style="color:blue">:</span><span style="color:red">x</span><span style="color:blue">="http://schemas.microsoft.com/winfx/2006/xaml"</span></p> <p>   <span style="color:red"> Title</span><span style="color:blue">="Window3"</span><span style="color:red"> Height</span><span style="color:blue">="300"</span><span style="color:red"> Width</span><span style="color:blue">="300"</span><span style="color:red"> Background</span><span style="color:blue">="{<!-- --></span><u><span style="color:rgb(163,21,21)">DynamicResource</span><span style="color:red"> winBackground</span></u><span style="color:blue">}"&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Window.Resources</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> Background</span><span style="color:blue">="Blue"</span> <span style="color:red"> Margin</span><span style="color:blue">="5"</span><span style="color:red"> Height</span><span style="color:blue">="28"</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="prev"&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Image</span><span style="color:red"> Height</span><span style="color:blue">="21"</span><span style="color:red"> Source</span><span style="color:blue">="Images\previous.gif"&gt;&lt;/</span><span style="color:rgb(163,21,21)">Image</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Button</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><u><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">LinearGradientBrush</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="winBackground"</span><span style="color:red"> StartPoint</span><span style="color:blue">="0,0"</span><span style="color:red"> EndPoint</span><span style="color:blue">="1,1"&gt;</span></u></p> <p><u><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:red"> Color</span><span style="color:blue">="Blue"</span><span style="color:red"> Offset</span><span style="color:blue">="0"&gt;&lt;/</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:blue">&gt;</span></u></p> <p><u><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:red"> Color</span><span style="color:blue">="White"</span><span style="color:red"> Offset</span><span style="color:blue">="0.5"&gt;&lt;/</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:blue">&gt;</span></u></p> <p><u><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:red"> Color</span><span style="color:blue">="Red"</span><span style="color:red"> Offset</span><span style="color:blue">="1"&gt;&lt;/</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:blue">&gt;</span></u></p> <p><u><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">LinearGradientBrush</span><span style="color:blue">&gt;</span></u></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Window.Resources</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Grid</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> Height</span><span style="color:blue">="20"</span><span style="color:red"> Width</span><span style="color:blue">="70"</span><span style="color:red"> Content</span><span style="color:blue">="Content" /&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> ResourceKey</span><span style="color:blue">="prev" /&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Grid</span><span style="color:blue">&gt;</span></p> <p><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Window</span><span style="color:blue">&gt;</span></p> </td></tr></tbody></table> 
<p> </p> 
<p><strong>5.     资源的应用</strong></p> 
<p> </p> 
<p>前变也已经说过可以引用别的程序集的资源，那么到底如何引用呢？另外，我们都是在说XAML中引用资源，那么代码中又该如何去做呢？我们又通常会在什么地方定义资源呢？这里就来说一下这几个问题，以及某些特殊情况下的定义。</p> 
<p>·         共享资源</p> 
<p>默认情况下，当有一个资源被引用到多个地方是，使用的都是同一个对象实例，这通常是理想的行为。但你同样也可以把x:Shared=”False”来让每个引用资源的地方都生成一个不同的对象实例，这样可以独立进行修改。这通常用于多逻辑资源的声明。</p> 
<p> </p> 
<p>·         程序代码中定义和应用资源</p> 
<p>在代码中定义一个新的Resource，你需要首先得到一个ResourceDictionary的实例，然后再创建一个新的资源并将这个资源加入到ResourceDictionary的实例中。而在访问资源时，你需要用到myWindow.Resources[“key”]或者object.FindResource(key)函数。注意myWindows是你当前window的实例，而在用FindResource时，前边的object代表的是这个资源所在的ResourceDictionary的父对象。</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">private</span> <span style="color:blue">void</span> Window_Loaded(<span style="color:blue">object</span> sender, <span style="color:rgb(43,145,175)">RoutedEventArgs</span> e)</p> <p>{<!-- --></p> <p>    <span style="color:rgb(43,145,175)">Window3</span> window = <span style="color:blue">new</span> <span style="color:rgb(43,145,175)">Window3</span>();</p> <p>    window.Resources.Add(<span style="color:rgb(163,21,21)">"buttonBackground"</span>, <span style="color:blue">new</span> <span style="color:rgb(43,145,175)">SolidColorBrush</span>(<span style="color:rgb(43,145,175)">Color</span>.FromRgb(0,255,0)));</p> <p>    window.Resources.Add(<span style="color:rgb(163,21,21)">"borderBrush"</span>, <span style="color:blue">new</span> <span style="color:rgb(43,145,175)">SolidColorBrush</span>(<span style="color:rgb(43,145,175)">Color</span>.FromRgb(255, 0, 0)));</p> <p> </p> <p>    btnContent.Background = (<span style="color:rgb(43,145,175)">Brush</span>)window.FindResource(<span style="color:rgb(163,21,21)">"buttonBackground"</span>);</p> <p>    btnContent.BorderBrush = (<span style="color:rgb(43,145,175)">Brush</span>)window.FindResource(<span style="color:rgb(163,21,21)">"borderBrush"</span>);</p> <p>}<strong></strong></p> </td></tr></tbody></table> 
<p>注意在找不到资源时会抛出一个<a href="http://msdn.microsoft.com/en-us/library/system.windows.resourcereferencekeynotfoundexception.aspx" rel="nofollow" style="color:rgb(120,175,211)"><span style="font-family:Tahoma; color:#0000ff">ResourceReferenceKeyNotFoundException</span></a>异常，所以尽量调用TryFindResource方法更好些，如果失败将会返回null.</p> 
<p>上边的例子是针对StaticResource来说的，它就相当于这段代码：</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Name</span><span style="color:blue">="btnContent"</span><span style="color:red"> Canvas.Left</span><span style="color:blue">="50"</span></p> <p><span style="color:red">Background</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> buttonBackground</span><span style="color:blue">}"</span></p> <p> <span style="color:red">BorderBrush</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> borderBrush</span><span style="color:blue">}"</span><span style="color:red"> Content</span><span style="color:blue">="Content" /&gt;</span><strong></strong></p> </td></tr><tr><td> <p><strong><span style="color:blue"> </span></strong></p> </td></tr></tbody></table> 
<p>但对于DynamicResource来说，需要调用这个元素的SetResourceReference方法来更新依赖属性的绑定。下边的两端代码是相等的：</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Button</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Name</span><span style="color:blue">="btnContent"</span><span style="color:red"> Canvas.Left</span><span style="color:blue">="50"</span></p> <p><span style="color:red">Background</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">DynamicResource</span><span style="color:red"> buttonBackground</span><span style="color:blue">}"</span></p> <p> <span style="color:red">BorderBrush</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)"> DynamicResource</span><span style="color:red"> borderBrush</span><span style="color:blue">}"</span><span style="color:red"> Content</span><span style="color:blue">="Content" /&gt;</span><strong></strong></p> </td></tr></tbody></table> 
<p> </p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p>btnContent.SetResourceReference(<span style="color:rgb(43,145,175)">Button</span>.BackgroundProperty, <span style="color:rgb(163,21,21)">"buttonBackground"</span>);</p> <p>btnContent.SetResourceReference(<span style="color:rgb(43,145,175)">Button</span>.BorderBrushProperty, <span style="color:rgb(163,21,21)">"borderBrush"</span>);<strong></strong></p> </td></tr></tbody></table> 
<p> </p> 
<p>SetResourceReference是可以在资源被加载到某个Resource Dictionary之前调用的，即便是FindResource会失败，但引用的建立仍然有效。</p> 
<p> </p> 
<p>·         从另一个程序集中访问嵌入式资源</p> 
<p>除了可以用特定的URI来访问别的程序中的二进制资源外，WPF可以从另外一个程序集中获取逻辑资源，这得用到ComponentResourceKey标记。要使用ComponentResourceKey，每个资源都必须有一个键名。然后你可以通过这样的方式访问：</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p>&lt;Button Background=”{DynamicResource {x:Static otherAssembly: MyClass.MyClassBrushKey }}” /&gt;</p> </td></tr></tbody></table> 
<p> </p> 
<p>·         Styles 和 Implicit Keys</p> 
<p> </p> 
<p>样式是最常见的一种资源，而且它总是被定义在Resource Dictionary中，为了来重用。Style其实就是一系列分组的Setter的集合，用来设定逻辑资源的属性值，它有一种比较特殊的情形就是Implicit Keys，可以不声明一个x:Key的名字，而只设置x:TargetType的值，这样面对的就是对于所有这个类型的控件都使用这个样式。下边的示例中x:Key的值其实就是type-Button。</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Style</span><span style="color:red"> TargetType</span><span style="color:blue">="Button"&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Setter</span><span style="color:red"> Property</span><span style="color:blue">="Background"&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Setter.Value</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">LinearGradientBrush</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">                </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:red"> Offset</span><span style="color:blue">="0.0"</span><span style="color:red"> Color</span><span style="color:blue">="AliceBlue"/&gt;</span></p> <p><span style="color:rgb(163,21,21)">                </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">GradientStop</span><span style="color:red"> Offset</span><span style="color:blue">="1.0"</span><span style="color:red"> Color</span><span style="color:blue">="Salmon"/&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">LinearGradientBrush</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Setter.Value</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Setter</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Setter</span><span style="color:red"> Property</span><span style="color:blue">="FontSize"</span><span style="color:red"> Value</span><span style="color:blue">="18"/&gt;</span></p> <p><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Style</span><span style="color:blue">&gt;</span><strong></strong></p> </td></tr></tbody></table> 
<p>               </p> 
<p>Style也是资源的一种---从某种意义上来说，它很类似于我们给普通HTML中的元素建立CSS. 对于Designer来说可能轻松一些哦。</p> 
<p> </p> 
<p><strong>6.     Resource Dictionary –资源字典</strong></p> 
<p> </p> 
<p>所有的资源项在最终都会被整合到Resource Dictionary中的，也就是说无论是FrameworkElement的Resources,还是Window的Resources,还是Application的Resources，还是特定的ResourceDictionary中定义的resources在整个应用编译执行的时候实际上他们都在一起的作为可遍历集合共同存在于一个相对会话空间内的。</p> 
<p>我们也提到过Resource的key是可以被允许有相同的，这样在遍历不同相对地址的Resource Dictionary时会根据StaticResource或者DynamicResource的lookup behavior来确定哪个有效。通常为了维护和灵活性的考虑，我们通常会将Resource Dictionary文件分成好几个，但在某些场合下我们只需要用其中某些资源，那么我么可以将资源从几个独立的文件中提取并合并，那么可以这么做：</p> 
<p> </p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Window.Resources</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">ResourceDictionary.MergedDictionaries</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:red"> Source</span><span style="color:blue">="Diction1.xaml"&gt;&lt;/</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:red"> Source</span><span style="color:blue">="Diction2.xaml"&gt;&lt;/</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">ResourceDictionary.MergedDictionaries</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Window.Resources</span><span style="color:blue">&gt;</span><strong></strong></p> </td></tr></tbody></table> 
<p>注意，在资源合并后，仍然会出现重复值的情况，那么最后取出的资源获胜。</p> 
<p><strong>7.     Localization – 本地化</strong></p> 
<p> </p> 
<p>本地化和换肤其实都是在用ResourceDictionary来做文章的。说白了，Localization就是用不同语言下取不同事先设定好的资源来显示而已。要做到这些很容易，4步就可以轻松实现：</p> 
<p>·         定义Resource Dictionary来包含不同语言下要显示的资源项。</p> 
<p>创建单独的Resource Dictionary文件，并以语言本身名字来命名，并把en-US来作为默认语言环境（这里顺便就命名为default.xaml了）</p> 
<p>Default.xaml</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:red"> xmlns</span><span style="color:blue">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></p> <p>   <span style="color:red"> xmlns</span><span style="color:blue">:</span><span style="color:red">x</span><span style="color:blue">="http://schemas.microsoft.com/winfx/2006/xaml"</span></p> <p>   <span style="color:red"> xmlns</span><span style="color:blue">:</span><span style="color:red">sys</span><span style="color:blue">="clr-namespace:System;assembly=mscorlib"&gt;</span></p> <p><span style="color:rgb(163,21,21)">   </span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="Title_PM"&gt;</span><span style="color:rgb(163,21,21)">Project Manager</span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="Title_PL"&gt;</span><span style="color:rgb(163,21,21)">Project Lead</span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="Title_SD"&gt;</span><span style="color:rgb(163,21,21)">Senior Developer</span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="Title_SA"&gt;</span><span style="color:rgb(163,21,21)">System Architecture</span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">   </span></p> <p><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:blue">&gt;</span><strong></strong></p> </td></tr></tbody></table> 
<p> </p> 
<p>zh-CN.xaml (注意对.NET命名空间的引用)</p> 
<p>               </p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:red"> xmlns</span><span style="color:blue">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></p> <p>   <span style="color:red"> xmlns</span><span style="color:blue">:</span><span style="color:red">x</span><span style="color:blue">="http://schemas.microsoft.com/winfx/2006/xaml"</span></p> <p>   <span style="color:red"> xmlns</span><span style="color:blue">:</span><span style="color:red">sys</span><span style="color:blue">="clr-namespace:System;assembly=mscorlib"&gt;</span></p> <p><span style="color:blue"> </span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="Title_PM"&gt;</span><span style="color:rgb(163,21,21)">项目经理</span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="Title_PL"&gt;</span><span style="color:rgb(163,21,21)">项目主管</span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="Title_SD"&gt;</span><span style="color:rgb(163,21,21)">资深开发工程师</span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Key</span><span style="color:blue">="Title_SA"&gt;</span><span style="color:rgb(163,21,21)">系统架构师</span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">sys</span><span style="color:blue">:</span><span style="color:rgb(163,21,21)">String</span><span style="color:blue">&gt;</span></p> <p><span style="color:blue"> </span></p> <p><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:blue">&gt;</span></p> </td></tr></tbody></table> 
<p>·         给应用程序添加默认资源：其实就是将默认的Resource Dictionary加入到Application的全局Resource里边。</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Application</span><span style="color:red"> x</span><span style="color:blue">:</span><span style="color:red">Class</span><span style="color:blue">="WpfApplication1.App"</span></p> <p>   <span style="color:red"> xmlns</span><span style="color:blue">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></p> <p>   <span style="color:red"> xmlns</span><span style="color:blue">:</span><span style="color:red">x</span><span style="color:blue">="http://schemas.microsoft.com/winfx/2006/xaml"</span></p> <p>   <span style="color:red"> StartupUri</span><span style="color:blue">="Window1.xaml"&gt;</span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">Application.Resources</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">       </span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">ResourceDictionary.MergedDictionaries</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">                </span><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:red"> Source</span><span style="color:blue">="Language\default.xaml"/&gt;</span></p> <p><span style="color:rgb(163,21,21)">            </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">ResourceDictionary.MergedDictionaries</span><span style="color:blue">&gt;</span></p> <p><span style="color:rgb(163,21,21)">        </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">ResourceDictionary</span><span style="color:blue">&gt;</span></p> <p><span style="color:blue"> </span></p> <p><span style="color:rgb(163,21,21)">    </span><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Application.Resources</span><span style="color:blue">&gt;</span></p> <p><span style="color:blue">&lt;/</span><span style="color:rgb(163,21,21)">Application</span><span style="color:blue">&gt;</span><strong></strong></p> </td></tr></tbody></table> 
<p>·         在Application启动时根据不同语言来加载以语言命名的XAML文件(Resource Dictionary)。因为对于重名的资源，后来加载的资源将会胜出，所以以当前语言名加载的XAML文件中的资源项将会被引用。这就是多语言的本质！</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">public</span> <span style="color:blue">partial</span> <span style="color:blue">class</span> <span style="color:rgb(43,145,175)">App</span> : <span style="color:rgb(43,145,175)">Application</span></p> <p>    {<!-- --></p> <p>        <span style="color:blue">protected</span> <span style="color:blue">override</span> <span style="color:blue">void</span> OnStartup(<span style="color:rgb(43,145,175)">StartupEventArgs</span> e)</p> <p>        {<!-- --></p> <p>            <span style="color:blue">base</span>.OnStartup(e);</p> <p>           </p> <p>            LoadLanguage();</p> <p>        }</p> <p> </p> <p>        <span style="color:blue">private</span> <span style="color:blue">void</span> LoadLanguage()</p> <p>        {<!-- --></p> <p>            <span style="color:rgb(43,145,175)">CultureInfo</span> currentCultureInfo = <span style="color:rgb(43,145,175)">CultureInfo</span>.CurrentCulture;</p> <p>            <span style="color:rgb(43,145,175)">ResourceDictionary</span> langRd = <span style="color:blue">null</span>;</p> <p>            <span style="color:blue">try</span></p> <p>            {<!-- --></p> <p>                langRd = <span style="color:rgb(43,145,175)">Application</span>.LoadComponent(</p> <p>                <span style="color:blue">new</span> <span style="color:rgb(43,145,175)">Uri</span>(<span style="color:rgb(163,21,21)">@"Language\"</span> + currentCultureInfo.Name + <span style="color:rgb(163,21,21)">".xaml"</span>, <span style="color:rgb(43,145,175)">UriKind</span>.Relative)) <span style="color:blue">as</span> <span style="color:rgb(43,145,175)">ResourceDictionary</span>;</p> <p>            }</p> <p>            <span style="color:blue">catch</span></p> <p>            {<!-- --></p> <p>            }</p> <p> </p> <p>            <span style="color:blue">if</span> (langRd != <span style="color:blue">null</span>)</p> <p>            {<!-- --></p> <p>                <span style="color:blue">if</span> (<span style="color:blue">this</span>.Resources.MergedDictionaries.Count &gt; 0)</p> <p>                {<!-- --></p> <p>                    <span style="color:blue">this</span>.Resources.MergedDictionaries.Clear();</p> <p>                }</p> <p>                <span style="color:blue">this</span>.Resources.MergedDictionaries.Add(langRd);</p> <p>            }</p> <p>        }</p> <p>    }</p> </td></tr></tbody></table> 
<p>·         在XAML中引用资源。</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">&lt;</span><span style="color:rgb(163,21,21)">TextBlock</span><span style="color:red"> Canvas.Top</span><span style="color:blue">="50"</span><span style="color:red"> Width</span><span style="color:blue">="100"</span><span style="color:red"> Height</span><span style="color:blue">="24"</span><span style="color:red"> Text</span><span style="color:blue">="{<!-- --></span><span style="color:rgb(163,21,21)">StaticResource</span><span style="color:red"> Title_PM</span><span style="color:blue">}" /&gt;</span></p> </td></tr></tbody></table> 
<p>·         大功告成，运行程序你会看到默认的语言的显示：Project Manager.当然如果你的默认文化是英语的话。用程序换成中文试试结果？没问题，在LoadLanguage()之前更改语言即可：</p> 
<table cellspacing="0" cellpadding="0" border="1" style="color:rgb(0,0,0)"><tbody><tr><td> <p><span style="color:blue">base</span>.OnStartup(e);</p> <p><span style="color:rgb(43,145,175)">CultureInfo</span> info = <span style="color:blue">new</span> <span style="color:rgb(43,145,175)">CultureInfo</span>(<span style="color:rgb(163,21,21)">"zh-CN"</span>);</p> <p><span style="color:rgb(43,145,175)">Thread</span>.CurrentThread.CurrentCulture = info;</p> <p><span style="color:rgb(43,145,175)">Thread</span>.CurrentThread.CurrentUICulture = info;</p> <p>LoadLanguage();<strong></strong></p> </td></tr></tbody></table> 
<p> </p> 
<p>                简单吧？呵呵。有关Resource的东西基本上就这么多了，换肤我们再开辟另一个话题来谈吧。这可是WPF够炫的Feature之一哦。。。。</p> 
<p>               一些与本文有关的小代码片段及Localization的示例请点击<a title="Here" href="http://files.cnblogs.com/zlgcool/wpfApplication1.rar" rel="nofollow" style="color:rgb(120,175,211)">这里</a>下载。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/aa8680122e68c97d001327980c263ae5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">oracle性能调优之--Share Pool 调整与优化</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/655cef74f92fd7790856a96f1d47c9d5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">几个不错的国外免费虚拟主机 Free host</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>