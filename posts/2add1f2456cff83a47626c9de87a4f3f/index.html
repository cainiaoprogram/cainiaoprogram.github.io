<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java链接opc报异常org.jinterop.dcom.common.JIException: Access is denied解决 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java链接opc报异常org.jinterop.dcom.common.JIException: Access is denied解决" />
<meta property="og:description" content="记录一下这次从发现问题到解决问题的过程
项目是通过java链接OPC，读取数据，并且发送数据的
程序一直运行正常，最近客户反馈说无法读取数据，通过查看，发现访问异常了。花了2天的时间才解决了这个异常。
org.jinterop.dcom.common.JIException: Access is denied, please check whether the [domain-username-password] are correct. Also, if not already done please check the GETTING STARTED and FAQ sections in readme.htm. They provide information on how to correctly configure the Windows machine for DCOM access, so as to avoid such exceptions. [0x00000005] at org.jinterop.dcom.core.JIComServer.init(JIComServer.java:542) at org.jinterop.dcom.core.JIComServer.initialise(JIComServer.java:458) at org.jinterop.dcom.core.JIComServer.&lt;init&gt;(JIComServer.java:427) at org.openscada.opc.lib.da.Server.connect(Server.java:118) at opc.apply.threads.ReadDataThread.getServer(ReadDataThread.java:231) at opc.apply.threads.ReadDataThread.run(ReadDataThread.java:57) at java.lang.Thread.run(Thread.java:745) Caused by: rpc.FaultException: Received fault. (unknown) at rpc." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2add1f2456cff83a47626c9de87a4f3f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-06T14:00:14+08:00" />
<meta property="article:modified_time" content="2020-08-06T14:00:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java链接opc报异常org.jinterop.dcom.common.JIException: Access is denied解决</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>记录一下这次从发现问题到解决问题的过程<br> 项目是通过java链接OPC，读取数据，并且发送数据的<br> 程序一直运行正常，最近客户反馈说无法读取数据，通过查看，发现访问异常了。花了2天的时间才解决了这个异常。</p> 
<pre><code class="prism language-java">org<span class="token punctuation">.</span>jinterop<span class="token punctuation">.</span>dcom<span class="token punctuation">.</span>common<span class="token punctuation">.</span>JIException<span class="token operator">:</span> Access is denied<span class="token punctuation">,</span> please check whether the <span class="token punctuation">[</span>domain<span class="token operator">-</span>username<span class="token operator">-</span>password<span class="token punctuation">]</span> are correct<span class="token punctuation">.</span> Also<span class="token punctuation">,</span> <span class="token keyword">if</span> not already done please check the GETTING STARTED and FAQ sections in readme<span class="token punctuation">.</span>htm<span class="token punctuation">.</span> They provide information on how to correctly configure the Windows machine <span class="token keyword">for</span> DCOM access<span class="token punctuation">,</span> so as to avoid such exceptions<span class="token punctuation">.</span>  <span class="token punctuation">[</span><span class="token number">0x00000005</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>jinterop<span class="token punctuation">.</span>dcom<span class="token punctuation">.</span>core<span class="token punctuation">.</span>JIComServer<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>JIComServer<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">542</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>jinterop<span class="token punctuation">.</span>dcom<span class="token punctuation">.</span>core<span class="token punctuation">.</span>JIComServer<span class="token punctuation">.</span><span class="token function">initialise</span><span class="token punctuation">(</span>JIComServer<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">458</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>jinterop<span class="token punctuation">.</span>dcom<span class="token punctuation">.</span>core<span class="token punctuation">.</span>JIComServer<span class="token punctuation">.</span><span class="token generics function"><span class="token punctuation">&lt;</span>init<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>JIComServer<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">427</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>openscada<span class="token punctuation">.</span>opc<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>da<span class="token punctuation">.</span>Server<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>Server<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">118</span><span class="token punctuation">)</span>
	at opc<span class="token punctuation">.</span>apply<span class="token punctuation">.</span>threads<span class="token punctuation">.</span>ReadDataThread<span class="token punctuation">.</span><span class="token function">getServer</span><span class="token punctuation">(</span>ReadDataThread<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">231</span><span class="token punctuation">)</span>
	at opc<span class="token punctuation">.</span>apply<span class="token punctuation">.</span>threads<span class="token punctuation">.</span>ReadDataThread<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>ReadDataThread<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">57</span><span class="token punctuation">)</span>
	at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">745</span><span class="token punctuation">)</span>
Caused by<span class="token operator">:</span> rpc<span class="token punctuation">.</span>FaultException<span class="token operator">:</span> Received fault<span class="token punctuation">.</span> <span class="token punctuation">(</span>unknown<span class="token punctuation">)</span>
	at rpc<span class="token punctuation">.</span>ConnectionOrientedEndpoint<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>ConnectionOrientedEndpoint<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">142</span><span class="token punctuation">)</span>
	at rpc<span class="token punctuation">.</span>Stub<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>Stub<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">112</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>jinterop<span class="token punctuation">.</span>dcom<span class="token punctuation">.</span>core<span class="token punctuation">.</span>JIComServer<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>JIComServer<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">538</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">6</span> more
</code></pre> 
<p>通过看异常日志，发现是访问被拒绝了，百度查看资料，尝试了以下几种方案：<br> 1、修改注册表<a href="https://blog.csdn.net/yigerendengqingtian/article/details/84710809">https://blog.csdn.net/yigerendengqingtian/article/details/84710809</a><br> 2、添加一段代码</p> 
<pre><code class="prism language-java"><span class="token keyword">this</span><span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">useSessionSecurity</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p><a href="https://blog.csdn.net/hzf1993/article/details/81188538">https://blog.csdn.net/hzf1993/article/details/81188538</a><br> 3、配置DCOM<br> <a href="https://www.softwaretoolbox.com/dcom/html/configuring__opcenum1.html" rel="nofollow">https://www.softwaretoolbox.com/dcom/html/configuring__opcenum1.html</a><br> 4、查看windows日志，找问题<br> <img src="https://images2.imgbox.com/bc/95/5czynnMj_o.png" alt="查看windows安全日志，确认问题"><br> 通过查看日志，发现是帐户登录失败，具体分析是密码错误，尝试重新设置密码，解决了（其实密码并没有改变，但是不知道为什么会提示密码错误）</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2e3e516b3ddce963806ddf0001c0b7f5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">7. 主动信息收集-端口扫描</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f8076736add277e06213f62d6e235723/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">论文解读：Graph Convolutional Networks for Text Classifification</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>