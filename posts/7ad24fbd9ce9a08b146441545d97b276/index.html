<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>windows配置PointRCNN一系列问题——坑麻了(最终还是卡住了，未完成) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="windows配置PointRCNN一系列问题——坑麻了(最终还是卡住了，未完成)" />
<meta property="og:description" content="背景目标 最近在做项目，用到了PointRCNN模型，用于检测点云中的物体，github源码如下
https://github.com/sshaoshuai/PointRCNN
众所周知，这样的模型多半是跑在linux服务器上的，这个模型也不例外，但是我的项目运行在windows系统中，需要将这个模型集成进去，对于未来面对的无数bug虽说有了心里准备，但是就结果来看，准备依旧是不充分。。。
系列错误 所以先试着跑一跑呗，不幸中的万幸是学长之前接触过这方面的工作，并提供了我可以在ubuntu上跑通的该部分代码，我直接“拿来主义”，直接跑目录已经构建清晰的代码！！！噩梦开始啦！
先说结论：最终还是卡住了，未完成，之后打算乖乖在linux服务器跑吧，千万不要在windows上运行.sh格式脚本！！！
但是过程中解决bug的方式，诸位还是可以参考的~
Part I ‘CUDA_VISIBLE_DEVICES‘ 不是内部或外部命令，也不是可运行的程序或批处理文件
定位了一下，实在下图位置，CUDA_VISIBLE_DEVICES并不是系统变量导致问题的发生
遇到问题当然先浏览器-&gt;stackoverflow-&gt;github源码的问题区
谷歌浏览器很快找到了Solution，共有如下三种解决方案。
个人选择了第三种，当然了这里并不是CUDA_VISIBLE_DEVICES=0，要根据自己电脑的情况来看，如果是台式机当然就是0了，因为就那一块显卡，但是如果1是笔记本极有可能是集成显卡＋独立显卡的搭配，我的就是笔记本，所以我这里要设置成CUDA_VISIBLE_DEVICES=1。
然后将代码修改一下，将CUDA_VISIBLE_DEVICES=0注释掉，大功告成！
虽然成功解决了问题，但这也是后面一个重要问题的根源所在。
Part II 解决完一个bug后神清气爽，继续下一个！
ModuleNotFoundError: No module named ‘iou3d_cuda’
显示了一个模块找不到，继续搜！这次谷歌服务器帮我定位到了github源码的问题区
从其中得知，在跑这个项目的时候，需要先行跑一下 这个脚本：build_and_install.sh，其实这在PointRCNN的github仓库中的环境配置要求中已经提到，我没有注意去读Readme，也算是“拿来主义”的弊端吧~
Part III 但是windows下如何去运行sh文件呢？
直接开搜！答案也很快得出，需要借助一下git！直接开始运行！
Part IV 本以为可以顺利获得想要得到的结果，但是遇到了贼常见的一个问题，之前在pip安装包的时候对这个问题记忆犹新！
error: Microsoft Visual C&#43;&#43; 14.0 or greater is required. Get it with “Microsoft C&#43;&#43; Build Tools”: https://visualstudio.microsoft.com
直接放一个我这次解决问题的方案链接，根据依稀的记忆对比，这个Solution更加丝滑，轻便。
Part V 这次的问题没有那么直观的报错，是根据各种蛛丝马迹推出来的问题到底是什么，并进行了解决，耗时极长！！！
问题结论：cuda突然无法控制gpu了！！！
这次的bug的显现是一个普通的报错，根据报错定位在这里，大概分析一下是arch_list为空！导致arch_list[-1] &#43;= &#39;&#43;PTX’会报错，这时隐隐约约觉得是GPU的配置问题，但是没有朝着cuda没有办法控制GPU的方向思考。
仅仅针对这个问题，我首先想到的是arch_list到底是什么？如果从if分支转到else分支，会发生什么？_arch_list = os.environ.get(‘TORCH_CUDA_ARCH_LIST’, None)，所以搜的与此相关，最终千转轮回，寻找了许多的博客，最终得知print(torch.cuda.get_device_properties(torch.device(‘cuda’)))，这条命令可以获取到匹配该GPU的arch信息，顺便又加了一个常用的命令:torch.cuda.is_available()
尝试后发现，第二行返回的是False，第三行甚至直接报错——没有可用的GPU！！！
之后询问浏览器这个问题，产生了千奇百怪的原因了：
1.有人说重启
2.有人说重新配置cuda cudann torch版本环境" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/7ad24fbd9ce9a08b146441545d97b276/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-25T00:17:54+08:00" />
<meta property="article:modified_time" content="2023-10-25T00:17:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">windows配置PointRCNN一系列问题——坑麻了(最终还是卡住了，未完成)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>背景目标</h2> 
<p>最近在做项目，用到了PointRCNN模型，用于检测点云中的物体，github源码如下</p> 
<blockquote> 
 <p>https://github.com/sshaoshuai/PointRCNN</p> 
</blockquote> 
<p>众所周知，这样的模型多半是跑在linux服务器上的，这个模型也不例外，但是我的项目运行在windows系统中，需要将这个模型集成进去，对于未来面对的无数bug虽说有了心里准备，但是就结果来看，准备依旧是不充分。。。</p> 
<h2><a id="_6"></a>系列错误</h2> 
<p>所以先试着跑一跑呗，不幸中的万幸是学长之前接触过这方面的工作，并提供了我可以在ubuntu上跑通的该部分代码，我直接“拿来主义”，直接跑目录已经构建清晰的代码！！！噩梦开始啦！<br> <strong>先说结论：最终还是卡住了，未完成，之后打算乖乖在linux服务器跑吧，千万不要在windows上运行.sh格式脚本！！！</strong><br> 但是过程中解决bug的方式，诸位还是可以参考的~</p> 
<h3><a id="Part_I_10"></a>Part I</h3> 
<blockquote> 
 <p>‘CUDA_VISIBLE_DEVICES‘ 不是内部或外部命令，也不是可运行的程序或批处理文件</p> 
</blockquote> 
<p>定位了一下，实在下图位置，<strong>CUDA_VISIBLE_DEVICES</strong>并不是系统变量导致问题的发生<br> <img src="https://images2.imgbox.com/8c/a9/mYklkIKF_o.png" alt=""><strong>遇到问题当然先浏览器-&gt;stackoverflow-&gt;github源码的问题区</strong><br> 谷歌浏览器很快找到了<a href="https://blog.csdn.net/qq_40682833/article/details/119215398">Solution</a>，共有如下三种解决方案。<img src="https://images2.imgbox.com/14/01/I76ups5m_o.png" alt="在这里插入图片描述"><br> 个人选择了第三种，当然了这里并不是<strong>CUDA_VISIBLE_DEVICES=0</strong>，要根据自己电脑的情况来看，如果是台式机当然就是0了，因为就那一块显卡，但是如果1是笔记本极有可能是集成显卡＋独立显卡的搭配，我的就是笔记本，所以我这里要设置成<strong>CUDA_VISIBLE_DEVICES=1</strong>。<br> <img src="https://images2.imgbox.com/e0/f3/am35jl6j_o.png" alt="在这里插入图片描述"><br> 然后将代码修改一下，将<strong>CUDA_VISIBLE_DEVICES=0</strong>注释掉，大功告成！<br> <img src="https://images2.imgbox.com/b0/80/pFXBuelU_o.png" alt="在这里插入图片描述"></p> 
<p>虽然成功解决了问题，但这也是后面一个重要问题的根源所在。</p> 
<h3><a id="Part_II_22"></a>Part II</h3> 
<p>解决完一个bug后神清气爽，继续下一个！</p> 
<blockquote> 
 <p>ModuleNotFoundError: No module named ‘iou3d_cuda’</p> 
</blockquote> 
<p>显示了一个模块找不到，继续搜！这次谷歌服务器帮我定位到了<a href="https://github.com/sshaoshuai/PointRCNN/issues/137">github源码的问题区</a><br> 从其中得知，在跑这个项目的时候，需要先行跑一下 这个脚本：<strong>build_and_install.sh</strong>，其实这在PointRCNN的github仓库中的环境配置要求中已经提到，我没有注意去读Readme，也算是“拿来主义”的弊端吧~</p> 
<h3><a id="Part_III_29"></a>Part III</h3> 
<blockquote> 
 <p>但是windows下如何去运行sh文件呢？</p> 
</blockquote> 
<p>直接开搜！<a href="https://blog.csdn.net/qq_44696773/article/details/125615631?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-125615631-blog-131561214.235%5Ev38%5Epc_relevant_anti_vip_base&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3">答案</a>也很快得出，<strong>需要借助一下git</strong>！直接开始运行！</p> 
<h3><a id="Part_IV_34"></a>Part IV</h3> 
<p>本以为可以顺利获得想要得到的结果，但是遇到了贼常见的一个问题，之前在pip安装包的时候对这个问题记忆犹新！</p> 
<blockquote> 
 <p>error: Microsoft Visual C++ 14.0 or greater is required. Get it with “Microsoft C++ Build Tools”: https://visualstudio.microsoft.com</p> 
</blockquote> 
<p>直接放一个我这次解决问题的方案链接，根据依稀的记忆对比，这个<a href="https://zhuanlan.zhihu.com/p/471661231" rel="nofollow">Solution</a>更加丝滑，轻便。</p> 
<h3><a id="Part_V_40"></a>Part V</h3> 
<p>这次的问题没有那么直观的报错，是根据各种蛛丝马迹推出来的问题到底是什么，并进行了解决，耗时极长！！！</p> 
<blockquote> 
 <p>问题结论：cuda突然无法控制gpu了！！！</p> 
</blockquote> 
<p>这次的bug的显现是一个普通的报错，根据报错定位在这里，大概分析一下是<strong>arch_list为空！导致arch_list[-1] += '+PTX’会报错</strong>，这时隐隐约约觉得是GPU的配置问题，但是没有朝着cuda没有办法控制GPU的方向思考。<br> <img src="https://images2.imgbox.com/19/7d/BJ34HO1t_o.png" alt="在这里插入图片描述"><br> 仅仅针对这个问题，我首先想到的是<strong>arch_list到底是什么？如果从if分支转到else分支，会发生什么？_arch_list = os.environ.get(‘TORCH_CUDA_ARCH_LIST’, None)</strong>，所以搜的与此相关，最终千转轮回，寻找了许多的博客，最终得知<strong>print(torch.cuda.get_device_properties(torch.device(‘cuda’)))</strong>，这条命令可以获取到匹配该GPU的arch信息，顺便又加了一个常用的命令:<strong>torch.cuda.is_available()</strong><img src="https://images2.imgbox.com/1a/29/dxGntyMv_o.png" alt="在这里插入图片描述"><br> 尝试后发现，第二行返回的是False，<strong>第三行甚至直接报错——没有可用的GPU！！！</strong><br> 之后询问浏览器这个问题，产生了千奇百怪的原因了：</p> 
<blockquote> 
 <p>1.有人说重启<br> 2.有人说重新配置cuda cudann torch版本环境<br> ……</p> 
</blockquote> 
<p>第一二条都尝试过了，第一条期间偶然间成功了一次！差点喜极而泣，结果仅仅是昙花一现，后续依旧寸步难行。。。<br> 在频繁搜索与科学上网中，偶然间一个博客提到了，<strong>在windows系统变量中添加CUDA_VISIBLE_DEVICES=0后</strong>会出现cuda无法控制gpu的情况，因为反正运行<strong>build_and_install.sh</strong>是运行整个项目的前置条件，不妨先把这个环境变量删除重启！试一下！<br> 成功！！！纯纯是解决第一个BUG后埋下的雷啊！！！！</p> 
<p>ps：如果搜if中arch_list的相关函数<strong>torch.cuda.get_arch_list</strong>()的用途，想单独输出一下查看效果，最终也会发现是cuda控制不了GPU的原因。</p> 
<h3><a id="PART_VI_59"></a>PART VI</h3> 
<blockquote> 
 <p>最终局BUG——被击倒了！！！</p> 
</blockquote> 
<p>最后运行时，报了个错<br> <img src="https://images2.imgbox.com/4d/dd/cdNv2RIl_o.png" alt="在这里插入图片描述"><br> 逐步往上面查看，最终得到报错原因<br> <img src="https://images2.imgbox.com/99/10/9uky6TtW_o.png" alt="在这里插入图片描述"><br> 搜索报错原因</p> 
<blockquote> 
 <p>subprocess.CalledProcessError: Command ‘[‘ninja’, ‘-v’]’ returned non-zero exit status 1.</p> 
</blockquote> 
<p>网络上各种说法</p> 
<blockquote> 
 <p>1.pytorch版本过高，需要<a href="https://blog.csdn.net/qq_41452267/article/details/124087590">降级</a><br> 2.去<strong>cpp_extension.py</strong>中将“-v"修改为“–version"</p> 
</blockquote> 
<p>降级根本就是放弃了<br> 采纳其中一个去<strong>cpp_extension.py</strong>中将“-v"修改为“–version"，运行！继续报错。。。这个错误网络上根本搜不到靠谱的解决方案，最终选择放弃。。。。</p> 
<blockquote> 
 <p>error: command ‘c:\program files (x86)\microsoft visual studio 14.0\vc\bin\x86_amd64\link.exe’ failed with exit code 1181</p> 
</blockquote> 
<h2><a id="_80"></a>总结</h2> 
<blockquote> 
 <p>windows不要奢望运行.sh文件！<br> github源代码的issue区是个好东西！<br> stackoverflow是个好东西！<br> 某N同质化太严重了……</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dce658f2ab5b2061bb4a6d7c7c420fc7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">图像压缩（2）《数字图像处理》第八章 8.1节 基础知识</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d9e08cd24a1b96ec97b7406496508a06/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">恢复未保存或删除的 Word 文档的 5 种简单方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>