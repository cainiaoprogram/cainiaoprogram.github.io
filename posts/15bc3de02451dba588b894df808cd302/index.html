<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux GUI自动化测试工具 -- LDTP - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux GUI自动化测试工具 -- LDTP" />
<meta property="og:description" content="目录
1. 背景
2. 环境
3. 安装和使用
1）下载地址
2）Windows下的安装和使用
3）Linux下的安装和使用
4. 踩到的“坑”
5. 参考资料
1. 背景 项目需要，研究了一下Linux下的GUI测试工具：LDTP。GNU LDTP（Linux Desktop Testing Project） 是一个 GNU/ Linux/ Unix 下的 GUI 应用测试工具。支持系统包括：FreeBSD/ Fedora/ Mac/ OpenSUSE/ OpenSolaris/ Windows/ Ubuntu等。本文介绍一下LDTP2的环境搭建，基本使用以及在使用中踩的坑。
2. 环境 操作系统：Ubuntu 18.4/ Window7LDTP： ldtp2 v3.5.1语言：Python2 &gt;= 2.6; Python3 &gt;= 3.0 3. 安装和使用 1）下载地址 操作系统地址Linuxhttps://github.com/ldtp/ldtp2Windowshttps://github.com/ldtp/cobra/releases 2）Windows下的安装和使用 a.双击 CobraWinLDTP-4.0.0.msi，按照提示安装完即可。
b.在&lt;安装盘&gt;\Program Files (x86)\VMware\CobraWinLDTP目录下，双击 CobraWinLDTP.exe，启动Server端。
c. 运行-》cmd，输入 Python3，进入Python命令；输入如下命令，如果没有报错，则证明安装成功。
3）Linux下的安装和使用 这里有两种方法。
a. 度娘上都能查到的在线安装方法：
apt-get install ldtp 同样的，安装完成后，导入LDTP，如果没有报错则表示安装成功。
b. 源码安装（这里以作者环境和安装过程为例，均是亲验总结，如有其他环境或问题需要具体分析）：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/15bc3de02451dba588b894df808cd302/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-09-01T09:05:44+08:00" />
<meta property="article:modified_time" content="2020-09-01T09:05:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux GUI自动化测试工具 -- LDTP</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1.%20%E8%83%8C%E6%99%AF-toc" style="margin-left:40px;"><a href="#1.%20%E8%83%8C%E6%99%AF" rel="nofollow">1. 背景</a></p> 
<p id="2.%20%E7%8E%AF%E5%A2%83-toc" style="margin-left:40px;"><a href="#2.%20%E7%8E%AF%E5%A2%83" rel="nofollow">2. 环境</a></p> 
<p id="3.%20%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8-toc" style="margin-left:40px;"><a href="#3.%20%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8" rel="nofollow">3. 安装和使用</a></p> 
<p id="1%EF%BC%89%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80-toc" style="margin-left:80px;"><a href="#1%EF%BC%89%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80" rel="nofollow">1）下载地址</a></p> 
<p id="2%EF%BC%89Windows%E4%B8%8B%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8-toc" style="margin-left:80px;"><a href="#2%EF%BC%89Windows%E4%B8%8B%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8" rel="nofollow">2）Windows下的安装和使用</a></p> 
<p id="3%EF%BC%89Linux%E4%B8%8B%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8-toc" style="margin-left:80px;"><a href="#3%EF%BC%89Linux%E4%B8%8B%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8" rel="nofollow">3）Linux下的安装和使用</a></p> 
<p id="4.%20%E8%B8%A9%E5%88%B0%E7%9A%84%E2%80%9C%E5%9D%91%E2%80%9D-toc" style="margin-left:40px;"><a href="#4.%20%E8%B8%A9%E5%88%B0%E7%9A%84%E2%80%9C%E5%9D%91%E2%80%9D" rel="nofollow">4. 踩到的“坑”</a></p> 
<p id="5.%20%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99-toc" style="margin-left:40px;"><a href="#5.%20%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" rel="nofollow">5. 参考资料</a></p> 
<hr id="hr-toc"> 
<h3 id="1.%20%E8%83%8C%E6%99%AF">1. 背景</h3> 
<p>项目需要，研究了一下Linux下的GUI测试工具：LDTP。GNU LDTP（Linux Desktop Testing Project） 是一个 GNU/ Linux/ Unix 下的 GUI 应用测试工具。支持系统包括：FreeBSD/ Fedora/ Mac/ OpenSUSE/ OpenSolaris/ Windows/ Ubuntu等。本文介绍一下LDTP2的环境搭建，基本使用以及在使用中踩的坑。</p> 
<h3 id="2.%20%E7%8E%AF%E5%A2%83">2. 环境</h3> 
<ul><li>操作系统：Ubuntu 18.4/ Window7</li><li>LDTP： ldtp2 v3.5.1</li><li>语言：Python2 &gt;= 2.6; Python3 &gt;= 3.0</li></ul> 
<h3 id="3.%20%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8">3. 安装和使用</h3> 
<h4 id="1%EF%BC%89%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80">1）下载地址</h4> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td>操作系统</td><td>地址</td></tr><tr><td>Linux</td><td><a href="https://github.com/ldtp/ldtp2">https://github.com/ldtp/ldtp2</a></td></tr><tr><td>Windows</td><td><a href="https://github.com/ldtp/cobra/releases">https://github.com/ldtp/cobra/releases</a></td></tr></tbody></table> 
<p> </p> 
<h4 id="2%EF%BC%89Windows%E4%B8%8B%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8">2）Windows下的安装和使用</h4> 
<p>a.双击 <a href="https://github.com/ldtp/cobra/releases/download/cobra_4_0/CobraWinLDTP-4.0.0.msi">CobraWinLDTP-4.0.0.msi</a>，按照提示安装完即可。</p> 
<p>b.在&lt;安装盘&gt;\Program Files (x86)\VMware\CobraWinLDTP目录下，双击 <span style="color:#3399ea;">CobraWinLDTP.exe</span>，启动Server端。</p> 
<p>c. 运行-》cmd，输入 Python3，进入Python命令；输入如下命令，如果没有报错，则证明安装成功。</p> 
<p><img alt="" height="511" src="https://images2.imgbox.com/6c/0d/qCRgSOEH_o.png" width="1158"></p> 
<h4 id="3%EF%BC%89Linux%E4%B8%8B%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8">3）Linux下的安装和使用</h4> 
<p>这里有两种方法。</p> 
<p>a. 度娘上都能查到的在线安装方法：</p> 
<pre><code class="language-bash">apt-get install ldtp</code></pre> 
<p>同样的，安装完成后，导入LDTP，如果没有报错则表示安装成功。</p> 
<p>b. 源码安装（这里以作者环境和安装过程为例，均是亲验总结，如有其他环境或问题需要具体分析）：</p> 
<p>i. 安装完Ubuntu后，缺省无法ssh连接，会出现报错：Permission denied(publickey, password)。修改方法：</p> 
<ul><li>编辑ssh配置文件： # vi /etc/ssh/sshd_config。去掉如下两个参数的注释，修改参数值： 
  <ul><li>PermitRootLogin <span style="color:#f33b45;">yes</span></li><li>StrictModes <span style="color:#f33b45;">yes</span></li></ul></li><li>重启ssh服务。# /etc/init.d/ssh restart</li></ul> 
<p>ii. 修改apt源。这是由于作者的环境无法直接对接外网镜像源，若能直接连网则可以忽略该步骤。</p> 
<ul><li># vi /etc/apt/sources.list。全部替换为本地源，这里列举其中部分源信息</li></ul> 
<p>    deb [trusted=yes] http://本地源IP/本地源路径 bionic main restricted universe multiverse</p> 
<p>    deb-src [trusted=yes] http://本地源IP/本地源路径 bionic main restricted universe multiverse</p> 
<ul><li>更新源后升级apt。# apt update -y</li></ul> 
<p>iii. 修改gsettings。这里需要在Ubuntu系统中进行修改，不能直接ssh连接修改。</p> 
<pre><code class="language-bash"># gsettings set org.gnome.desktop.interface toolkit-accessibility true
# gsettings set org.gnome.desktop.a11y.applications screen-reader-enabled true</code></pre> 
<p>补充：gsettings的部分命令</p> 
<pre><code class="language-bash"># gsettings list-schemas | grep interface</code></pre> 
<pre><code class="language-bash"># gsettings list-keys org.gnome.desktop.interface | grep toolkit</code></pre> 
<pre><code class="language-bash"># gsettings get org.gnome.desktop.interface toolkit-accessibility</code></pre> 
<p>iv. 安装LDTP</p> 
<p>如若直接按照github上的安装过程，是无法使用的（这里被坑了好久），首先需要安装如下一些依赖包。</p> 
<pre><code class="language-bash"># apt install -y python3-pip
# apt install -y python3-setuptools
# pip3 install twisted -i &lt;本地源&gt; --trusted-host &lt;本地源IP&gt;
# apt install -y python-ldtp</code></pre> 
<p>v. 修改源码。这是因为Python3中已经没有unicode()这个方法了，而LDTP的部分源码是基于Python2进行开发的。为了解决这个兼容性，只能进行源码修改，否则无法获取中文字符。</p> 
<p># vi /usr/local/lib/python3.6/dist-packages/ldtp-3.5.1-py3.6.egg/ldtp/__init__.py</p> 
<p>将gettextvalue()的返回从unicode()改为str():</p> 
<p><img alt="" height="40" src="https://images2.imgbox.com/12/5e/xhhbJ1hU_o.png" width="749"></p> 
<p>vi. 重启Ubuntu。一定要记得做完上述的修改后，<span style="color:#f33b45;"><strong>重启操作系统</strong></span>哦~~~</p> 
<p>vii. 基本使用方法同windows。</p> 
<ul><li>mouseleftclick('frm0', 'btn关闭')              # 点击frm0中的“关闭”按钮</li><li>gettextvalue('frm0', 'txt0')                       # 获取frm0中文本框txt0中的文本</li><li>setcursorposition('frm0', 'txt0', 1)           # 将光标放在frm0中文本框txt0的首字符位置</li></ul> 
<h3 id="4.%20%E8%B8%A9%E5%88%B0%E7%9A%84%E2%80%9C%E5%9D%91%E2%80%9D">4. 踩到的“坑”</h3> 
<p>1）在Windows中没有启动Server端。出现报错：<u>ConnectionRefusedError: [WinError 10061]</u></p> 
<p><img alt="" height="564" src="https://images2.imgbox.com/dc/c3/jIcuttpr_o.png" width="667"></p> 
<p>2）在Windows缺省安装之后，导入LDTP包是正常的，但是使用方法getwindowlist()却出现如下报错：</p> 
<p><u>TypeError：unsupported operand type(s) for *: 'map' and 'list'</u></p> 
<p><img alt="" height="218" src="https://images2.imgbox.com/d9/93/R5S9tadn_o.png" width="1200"></p> 
<p>报错的代码只是一个日志记录，并不影响功能使用，所以将这里注释后，重新导入LDTP包即可。</p> 
<p><img alt="" height="196" src="https://images2.imgbox.com/3c/6f/rJ05CoYu_o.png" width="1200"></p> 
<p>3）部分方法在使用时出现有这样的报错：<u>Unable to get editable text</u> 和 <u>Text cannot be entered into object. </u>。暂时还没有找到解决方法，怀疑是由于元件有属性没有设置正确导致的。</p> 
<p><img alt="" height="43" src="https://images2.imgbox.com/3b/c5/KhQQRnb4_o.png" width="607"></p> 
<p><img alt="" height="43" src="https://images2.imgbox.com/02/a7/C0IwPjsa_o.png" width="645"></p> 
<p>4）按照说明文档中进行远程连接# ldtp -s 时，报错： <u>ModuleNotFoundError: No module named 'xmlrpc_daemon'</u>。暂时没有找到解决办法。不清楚是没有使用对远程连接场景还是确实有错误。</p> 
<p><img alt="" height="203" src="https://images2.imgbox.com/71/cb/vVJFod1X_o.png" width="804"></p> 
<h3 id="5.%20%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">5. 参考资料</h3> 
<p><a href="https://ldtp.freedesktop.org/ldtp-tutorial.pdf" rel="nofollow">https://ldtp.freedesktop.org/ldtp-tutorial.pdf</a></p> 
<p><a href="https://ldtp.freedesktop.org/user-doc/d7/d25/a00182.html#Syntax" rel="nofollow">https://ldtp.freedesktop.org/user-doc/d7/d25/a00182.html#Syntax</a></p> 
<p><a href="https://www.cnblogs.com/backpacker/p/10945514.html" rel="nofollow">https://www.cnblogs.com/backpacker/p/10945514.html</a></p> 
<p><a href="https://blog.csdn.net/amy0428/article/details/52041909?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~first_rank_v2~rank_v25-5-52041909.nonecase&amp;utm_term=linux%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AE%89%E8%A3%85%E5%B7%A5%E5%85%B7">https://blog.csdn.net/amy0428/article/details/52041909?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~first_rank_v2~rank_v25-5-52041909.nonecase&amp;utm_term=linux%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AE%89%E8%A3%85%E5%B7%A5%E5%85%B7  -- 其他工具</a></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9c9eb8a658ba2d435d0137b0c1183c0a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">roberta与albert</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a097435e190bd81ee353016023f5b9cd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">银联支付服务之公众号支付业务（二）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>