<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[Scrapy]模拟登陆并获取Cookie值 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[Scrapy]模拟登陆并获取Cookie值" />
<meta property="og:description" content="1.分析登陆网址的方式 1.1使用Firefox或者Chrom浏览器F12，以Firefox登陆广工图书馆为例（该网址设计使用Cookie来记录登陆状态） 1.2登陆前 1.3登陆后 1.4根据登陆后可见POST方法的参数
__EVENTTARGET: __EVENTARGUMENT: __VIEWSTATE:/wEPDwULLTE0MjY3MDAxNzcPZBYCZg9kFgoCAQ8PFgIeCEltYWdlVXJsBRt&#43;XGltYWdlc1xoZWFkZXJvcGFjNGdpZi5naWZkZAICDw8WAh4EVGV4dAUt5bm/5Lic5bel5Lia5aSn5a2m5Zu&#43;5Lmm6aaG5Lmm55uu5qOA57Si57O757ufZGQCAw8PFgIfAQUcMjAxNuW5tDEy5pyIMTPml6UgIOaYn&#43;acn&#43;S6jGRkAgQPZBYEZg9kFgQCAQ8WAh4LXyFJdGVtQ291bnQCCBYSAgEPZBYCZg8VAwtzZWFyY2guYXNweAAM55uu5b2V5qOA57SiZAICD2QWAmYPFQMTcGVyaV9uYXZfY2xhc3MuYXNweAAM5YiG57G75a&#43;86IiqZAIDD2QWAmYPFQMOYm9va19yYW5rLmFzcHgADOivu&#43;S5puaMh&#43;W8lWQCBA9kFgJmDxUDCXhzdGIuYXNweAAM5paw5Lmm6YCa5oqlZAIFD2QWAmYPFQMUcmVhZGVycmVjb21tZW5kLmFzcHgADOivu&#43;iAheiNkOi0rWQCBg9kFgJmDxUDE292ZXJkdWVib29rc19mLmFzcHgADOaPkOmGkuacjeWKoWQCBw9kFgJmDxUDEnVzZXIvdXNlcmluZm8uYXNweAAP5oiR55qE5Zu&#43;5Lmm6aaGZAIID2QWAmYPFQMbaHR0cDovL2xpYnJhcnkuZ2R1dC5lZHUuY24vAA/lm77kuabppobpppbpobVkAgkPZBYCAgEPFgIeB1Zpc2libGVoZAIDDxYCHwJmZAIBD2QWBAIDD2QWBAIBDw9kFgIeDGF1dG9jb21wbGV0ZQUDb2ZmZAIHDw8WAh8BZWRkAgUPZBYGAgEPEGRkFgFmZAIDDxBkZBYBZmQCBQ8PZBYCHwQFA29mZmQCBQ8PFgIfAQWlAUNvcHlyaWdodCAmY29weTsyMDA4LTIwMDkuIFNVTENNSVMgT1BBQyA0LjAxIG9mIFNoZW56aGVuIFVuaXZlcnNpdHkgTGlicmFyeS4gIEFsbCByaWdodHMgcmVzZXJ2ZWQuPGJyIC8&#43;54mI5p2D5omA5pyJ77ya5rex5Zyz5aSn5a2m5Zu&#43;5Lmm6aaGIEUtbWFpbDpzenVsaWJAc3p1LmVkdS5jbmRkZAg1DiqmaepeeQ7Rw6kLdb3ah3tb __EVENTVALIDATION:/wEWBQKNu6LYBwKOmK5RApX9wcYGAsP9wL8JAqW86pcI3FE0WSxHMScWQc3QHyrMix/0xmM= ctl00$ContentPlaceHolder1$txtlogintype:0 ctl00$ContentPlaceHolder1$txtUsername_Lib:账号 ctl00$ContentPlaceHolder1$txtPas_Lib:密码 ctl00$ContentPlaceHolder1$btnLogin_Lib:登录 1.5在登陆前界面（http://222.200.122.171:7771/login.aspx）寻找POST参数，后期使用正则表达式进行筛选 ①在登陆界面（http://222.200.122.171:7771/login.aspx）寻找POST参数： &lt;input name=&#34;__EVENTTARGET&#34; id=&#34;__EVENTTARGET&#34; value=&#34;&#34; type=&#34;hidden&#34;&gt; &lt;input name=&#34;__EVENTARGUMENT&#34; id=&#34;__EVENTARGUMENT&#34; value=&#34;&#34; type=&#34;hidden&#34;&gt; &lt;input name=&#34;__VIEWSTATE&#34; id=&#34;__VIEWSTATE&#34; value=&#34;/wEPDwULLTE0MjY3MDAxNzcPZBYCZg9kFgoCAQ8PFgIeCEltYWdlVXJsBRt&#43;XGltYWdlc1xoZWFkZXJvcGFjNGdpZi5naWZkZAICDw8WAh4EVGV4dAUt5bm/5Lic5bel5Lia5aSn5a2m5Zu&#43;5Lmm6aaG5Lmm55uu5qOA57Si57O757ufZGQCAw8PFgIfAQUcMjAxNuW5tDEy5pyIMTPml6UgIOaYn&#43;acn&#43;S6jGRkAgQPZBYEZg9kFgQCAQ8WAh4LXyFJdGVtQ291bnQCCBYSAgEPZBYCZg8VAwtzZWFyY2guYXNweAAM55uu5b2V5qOA57SiZAICD2QWAmYPFQMTcGVyaV9uYXZfY2xhc3MuYXNweAAM5YiG57G75a&#43;86IiqZAIDD2QWAmYPFQMOYm9va19yYW5rLmFzcHgADOivu&#43;S5puaMh&#43;W8lWQCBA9kFgJmDxUDCXhzdGIuYXNweAAM5paw5Lmm6YCa5oqlZAIFD2QWAmYPFQMUcmVhZGVycmVjb21tZW5kLmFzcHgADOivu&#43;iAheiNkOi0rWQCBg9kFgJmDxUDE292ZXJkdWVib29rc19mLmFzcHgADOaPkOmGkuacjeWKoWQCBw9kFgJmDxUDEnVzZXIvdXNlcmluZm8uYXNweAAP5oiR55qE5Zu&#43;5Lmm6aaGZAIID2QWAmYPFQMbaHR0cDovL2xpYnJhcnkuZ2R1dC5lZHUuY24vAA/lm77kuabppobpppbpobVkAgkPZBYCAgEPFgIeB1Zpc2libGVoZAIDDxYCHwJmZAIBD2QWBAIDD2QWBAIBDw9kFgIeDGF1dG9jb21wbGV0ZQUDb2ZmZAIHDw8WAh8BZWRkAgUPZBYGAgEPEGRkFgFmZAIDDxBkZBYBZmQCBQ8PZBYCHwQFA29mZmQCBQ8PFgIfAQWlAUNvcHlyaWdodCAmY29weTsyMDA4LTIwMDkuIFNVTENNSVMgT1BBQyA0LjAxIG9mIFNoZW56aGVuIFVuaXZlcnNpdHkgTGlicmFyeS4gIEFsbCByaWdodHMgcmVzZXJ2ZWQuPGJyIC8&#43;54mI5p2D5omA5pyJ77ya5rex5Zyz5aSn5a2m5Zu&#43;5Lmm6aaGIEUtbWFpbDpzenVsaWJAc3p1LmVkdS5jbmRkZAg1DiqmaepeeQ7Rw6kLdb3ah3tb&#34; type=&#34;hidden&#34;&gt; &lt;input type=&#34;hidden&#34; name=&#34;__EVENTVALIDATION&#34; id=&#34;__EVENTVALIDATION&#34; value=&#34;/wEWBQLL&#43;rWqAwKOmK5RApX9wcYGAsP9wL8JAqW86pcI3&#43;ohGVVAcOzsnECPPKNYB0mRpZ0=&#34;&gt; &lt;input name=&#34;ctl00$ContentPlaceHolder1$txtlogintype&#34; type=&#34;hidden&#34; id=&#34;ctl00_ContentPlaceHolder1_txtlogintype&#34; value=&#34;0&#34;&gt; &lt;input name=&#34;ctl00$ContentPlaceHolder1$btnLogin_Lib&#34; value=&#34;登录&#34; onclick=&#34;javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&amp;quot;ctl00$ContentPlaceHolder1$btnLogin_Lib&amp;quot;, &amp;quot;&amp;quot;, true, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, false, false))&#34; id=&#34;ctl00_ContentPlaceHolder1_btnLogin_Lib&#34; class=&#34;btn&#34; type=&#34;submit&#34;&gt; ②其中： ctl00$ContentPlaceHolder1$txtUsername_Lib是登陆账号 ctl00$ContentPlaceHolder1$txtPas_Lib是密码 2.编写程序 2.1创建myproject的Scrapy工程（参考） 2.2编写\myproject\myproject\spiders\LoginSpider.py
# -*- coding:utf-8 -*- import scrapy import re class LoginSpider(scrapy." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/89b2847464337daf115625355e83a96a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-12-17T15:57:18+08:00" />
<meta property="article:modified_time" content="2016-12-17T15:57:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[Scrapy]模拟登陆并获取Cookie值</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>1.分析登陆网址的方式 <br> 1.1使用Firefox或者Chrom浏览器F12，以Firefox登陆广工图书馆为例（该网址设计使用Cookie来记录登陆状态） <br> 1.2登陆前 <br> <img src="https://images2.imgbox.com/82/cd/4yJJWUUn_o.png" alt="这里写图片描述" title=""> <br> 1.3登陆后 <br> <img src="https://images2.imgbox.com/e6/79/t6YfeGt7_o.png" alt="这里写图片描述" title=""> <br> 1.4根据登陆后可见POST方法的参数</p> 
<pre class="prettyprint"><code class=" hljs bash">__EVENTTARGET:
__EVENTARGUMENT:
__VIEWSTATE:/wEPDwULLTE0MjY3MDAxNzcPZBYCZg9kFgoCAQ8PFgIeCEltYWdlVXJsBRt+XGltYWdlc1xoZWFkZXJvcGFjNGdpZi5naWZkZAICDw8WAh4EVGV4dAUt5bm/<span class="hljs-number">5</span>Lic5bel5Lia5aSn5a2m5Zu+<span class="hljs-number">5</span>Lmm6aaG5Lmm55uu5qOA57Si57O757ufZGQCAw8PFgIfAQUcMjAxNuW5tDEy5pyIMTPml6UgIOaYn+acn+S6jGRkAgQPZBYEZg9kFgQCAQ8WAh4LXyFJdGVtQ291bnQCCBYSAgEPZBYCZg8VAwtzZWFyY2guYXNweAAM55uu5b2V5qOA57SiZAICD2QWAmYPFQMTcGVyaV9uYXZfY2xhc3MuYXNweAAM5YiG57G75a+<span class="hljs-number">86</span>IiqZAIDD2QWAmYPFQMOYm9va19yYW5rLmFzcHgADOivu+S5puaMh+W8lWQCBA9kFgJmDxUDCXhzdGIuYXNweAAM5paw5Lmm6YCa5oqlZAIFD2QWAmYPFQMUcmVhZGVycmVjb21tZW5kLmFzcHgADOivu+iAheiNkOi0rWQCBg9kFgJmDxUDE292ZXJkdWVib29rc19mLmFzcHgADOaPkOmGkuacjeWKoWQCBw9kFgJmDxUDEnVzZXIvdXNlcmluZm8uYXNweAAP5oiR55qE5Zu+<span class="hljs-number">5</span>Lmm6aaGZAIID2QWAmYPFQMbaHR0cDovL2xpYnJhcnkuZ2R1dC5lZHUuY24vAA/lm77kuabppobpppbpobVkAgkPZBYCAgEPFgIeB1Zpc2libGVoZAIDDxYCHwJmZAIBD2QWBAIDD2QWBAIBDw9kFgIeDGF1dG9jb21wbGV0ZQUDb2ZmZAIHDw8WAh8BZWRkAgUPZBYGAgEPEGRkFgFmZAIDDxBkZBYBZmQCBQ8PZBYCHwQFA29mZmQCBQ8PFgIfAQWlAUNvcHlyaWdodCAmY29weTsyMDA4LTIwMDkuIFNVTENNSVMgT1BBQyA0LjAxIG9mIFNoZW56aGVuIFVuaXZlcnNpdHkgTGlicmFyeS4gIEFsbCByaWdodHMgcmVzZXJ2ZWQuPGJyIC8+<span class="hljs-number">54</span>mI5p2D5omA5pyJ77ya5rex5Zyz5aSn5a2m5Zu+<span class="hljs-number">5</span>Lmm6aaGIEUtbWFpbDpzenVsaWJAc3p1LmVkdS5jbmRkZAg1DiqmaepeeQ7Rw6kLdb3ah3tb
__EVENTVALIDATION:/wEWBQKNu6LYBwKOmK5RApX9wcYGAsP9wL8JAqW86pcI3FE0WSxHMScWQc3QHyrMix/<span class="hljs-number">0</span>xmM=
ctl00<span class="hljs-variable">$ContentPlaceHolder1</span><span class="hljs-variable">$txtlogintype</span>:<span class="hljs-number">0</span>
ctl00<span class="hljs-variable">$ContentPlaceHolder1</span><span class="hljs-variable">$txtUsername_Lib</span>:账号
ctl00<span class="hljs-variable">$ContentPlaceHolder1</span><span class="hljs-variable">$txtPas_Lib</span>:密码
ctl00<span class="hljs-variable">$ContentPlaceHolder1</span><span class="hljs-variable">$btnLogin_Lib</span>:登录</code></pre> 
<p>1.5在登陆前界面（<a href="http://222.200.122.171:7771/login.aspx" rel="nofollow">http://222.200.122.171:7771/login.aspx</a>）寻找POST参数，后期使用正则表达式进行筛选 <br> <img src="https://images2.imgbox.com/6d/53/qeY4tQV2_o.png" alt="这里写图片描述" title=""></p> 
<pre class="prettyprint"><code class=" hljs bash">①在登陆界面（http://<span class="hljs-number">222.200</span>.<span class="hljs-number">122.171</span>:<span class="hljs-number">7771</span>/login.aspx）寻找POST参数：
&lt;input name=<span class="hljs-string">"__EVENTTARGET"</span> id=<span class="hljs-string">"__EVENTTARGET"</span> value=<span class="hljs-string">""</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"hidden"</span>&gt;
&lt;input name=<span class="hljs-string">"__EVENTARGUMENT"</span> id=<span class="hljs-string">"__EVENTARGUMENT"</span> value=<span class="hljs-string">""</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"hidden"</span>&gt;
&lt;input name=<span class="hljs-string">"__VIEWSTATE"</span> id=<span class="hljs-string">"__VIEWSTATE"</span> value=<span class="hljs-string">"/wEPDwULLTE0MjY3MDAxNzcPZBYCZg9kFgoCAQ8PFgIeCEltYWdlVXJsBRt+XGltYWdlc1xoZWFkZXJvcGFjNGdpZi5naWZkZAICDw8WAh4EVGV4dAUt5bm/5Lic5bel5Lia5aSn5a2m5Zu+5Lmm6aaG5Lmm55uu5qOA57Si57O757ufZGQCAw8PFgIfAQUcMjAxNuW5tDEy5pyIMTPml6UgIOaYn+acn+S6jGRkAgQPZBYEZg9kFgQCAQ8WAh4LXyFJdGVtQ291bnQCCBYSAgEPZBYCZg8VAwtzZWFyY2guYXNweAAM55uu5b2V5qOA57SiZAICD2QWAmYPFQMTcGVyaV9uYXZfY2xhc3MuYXNweAAM5YiG57G75a+86IiqZAIDD2QWAmYPFQMOYm9va19yYW5rLmFzcHgADOivu+S5puaMh+W8lWQCBA9kFgJmDxUDCXhzdGIuYXNweAAM5paw5Lmm6YCa5oqlZAIFD2QWAmYPFQMUcmVhZGVycmVjb21tZW5kLmFzcHgADOivu+iAheiNkOi0rWQCBg9kFgJmDxUDE292ZXJkdWVib29rc19mLmFzcHgADOaPkOmGkuacjeWKoWQCBw9kFgJmDxUDEnVzZXIvdXNlcmluZm8uYXNweAAP5oiR55qE5Zu+5Lmm6aaGZAIID2QWAmYPFQMbaHR0cDovL2xpYnJhcnkuZ2R1dC5lZHUuY24vAA/lm77kuabppobpppbpobVkAgkPZBYCAgEPFgIeB1Zpc2libGVoZAIDDxYCHwJmZAIBD2QWBAIDD2QWBAIBDw9kFgIeDGF1dG9jb21wbGV0ZQUDb2ZmZAIHDw8WAh8BZWRkAgUPZBYGAgEPEGRkFgFmZAIDDxBkZBYBZmQCBQ8PZBYCHwQFA29mZmQCBQ8PFgIfAQWlAUNvcHlyaWdodCAmY29weTsyMDA4LTIwMDkuIFNVTENNSVMgT1BBQyA0LjAxIG9mIFNoZW56aGVuIFVuaXZlcnNpdHkgTGlicmFyeS4gIEFsbCByaWdodHMgcmVzZXJ2ZWQuPGJyIC8+54mI5p2D5omA5pyJ77ya5rex5Zyz5aSn5a2m5Zu+5Lmm6aaGIEUtbWFpbDpzenVsaWJAc3p1LmVkdS5jbmRkZAg1DiqmaepeeQ7Rw6kLdb3ah3tb"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"hidden"</span>&gt;
&lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">"hidden"</span> name=<span class="hljs-string">"__EVENTVALIDATION"</span> id=<span class="hljs-string">"__EVENTVALIDATION"</span> value=<span class="hljs-string">"/wEWBQLL+rWqAwKOmK5RApX9wcYGAsP9wL8JAqW86pcI3+ohGVVAcOzsnECPPKNYB0mRpZ0="</span>&gt;
&lt;input name=<span class="hljs-string">"ctl00<span class="hljs-variable">$ContentPlaceHolder1</span><span class="hljs-variable">$txtlogintype</span>"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"hidden"</span> id=<span class="hljs-string">"ctl00_ContentPlaceHolder1_txtlogintype"</span> value=<span class="hljs-string">"0"</span>&gt;
&lt;input name=<span class="hljs-string">"ctl00<span class="hljs-variable">$ContentPlaceHolder1</span><span class="hljs-variable">$btnLogin_Lib</span>"</span> value=<span class="hljs-string">"登录"</span> onclick=<span class="hljs-string">"javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&amp;quot;ctl00<span class="hljs-variable">$ContentPlaceHolder1</span><span class="hljs-variable">$btnLogin_Lib</span>&amp;quot;, &amp;quot;&amp;quot;, true, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, false, false))"</span> id=<span class="hljs-string">"ctl00_ContentPlaceHolder1_btnLogin_Lib"</span> class=<span class="hljs-string">"btn"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"submit"</span>&gt;
②其中：
ctl00<span class="hljs-variable">$ContentPlaceHolder1</span><span class="hljs-variable">$txtUsername_Lib</span>是登陆账号
ctl00<span class="hljs-variable">$ContentPlaceHolder1</span><span class="hljs-variable">$txtPas_Lib</span>是密码</code></pre> 
<p>2.编写程序 <br> 2.1创建myproject的Scrapy工程（<a href="http://blog.csdn.net/u014686875/article/details/53589248">参考</a>） <br> 2.2编写\myproject\myproject\spiders\LoginSpider.py</p> 
<pre class="prettyprint"><code class=" hljs python"><span class="hljs-comment"># -*- coding:utf-8 -*-</span>
<span class="hljs-keyword">import</span> scrapy
<span class="hljs-keyword">import</span> re

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginSpider</span><span class="hljs-params">(scrapy.Spider)</span>:</span>
    name = <span class="hljs-string">'login'</span>
    start_urls = [<span class="hljs-string">'http://222.200.122.171:7771/login.aspx'</span>]

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse</span><span class="hljs-params">(self, response)</span>:</span>
        <span class="hljs-keyword">print</span> <span class="hljs-string">'befor_login============'</span>
        pattern = re.compile(
                        <span class="hljs-string">'id="__EVENTTARGET" value="(.*?)"'</span> +
                         <span class="hljs-string">'.*?'</span> + 
                        <span class="hljs-string">'id="__EVENTARGUMENT" value="(.*?)"'</span> +
                        <span class="hljs-string">'.*?'</span> + 
                        <span class="hljs-string">'id="__VIEWSTATE" value="(.*?)"'</span> +
                        <span class="hljs-string">'.*?'</span> + 
                        <span class="hljs-string">'id="__EVENTVALIDATION" value="(.*?)"'</span>+
                        <span class="hljs-string">'.*?'</span> + 
                        <span class="hljs-string">'id="ctl00_ContentPlaceHolder1_txtlogintype" value="(.*?)"'</span> +
                        <span class="hljs-string">'.*?'</span> + 
                        <span class="hljs-string">'name="ctl00\$ContentPlaceHolder1\$btnLogin_Lib" value="(.*?)"'</span>
                        ,re.S)
        items = re.findall(pattern,response.body.decode(response.encoding))
        <span class="hljs-keyword">print</span> (<span class="hljs-string">"lin len: %d"</span>%(len(items)))
        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> items:         
            <span class="hljs-keyword">print</span> (<span class="hljs-string">"lin __EVENTTARGET: %s"</span>      %(item[<span class="hljs-number">0</span>]))
            <span class="hljs-keyword">print</span> (<span class="hljs-string">"lin __EVENTARGUMENT: %s"</span>    %(item[<span class="hljs-number">1</span>]))
            <span class="hljs-keyword">print</span> (<span class="hljs-string">"lin __VIEWSTATE: %s"</span>        %(item[<span class="hljs-number">2</span>]))
            <span class="hljs-keyword">print</span> (<span class="hljs-string">"lin __EVENTVALIDATION: %s"</span>  %(item[<span class="hljs-number">3</span>]))
            <span class="hljs-keyword">print</span> (<span class="hljs-string">"lin ctl00_ContentPlaceHolder1_txtlogintype: %s"</span>  %(item[<span class="hljs-number">4</span>]))
            <span class="hljs-keyword">print</span> (<span class="hljs-string">"lin ctl00$ContentPlaceHolder1$btnLogin_Lib: %s"</span>  %(item[<span class="hljs-number">5</span>]))

            <span class="hljs-keyword">yield</span> scrapy.FormRequest.from_response(
            response,
            formdata={
                    <span class="hljs-string">'__EVENTTARGET'</span>: item[<span class="hljs-number">0</span>],
                    <span class="hljs-string">'__EVENTARGUMENT'</span>: item[<span class="hljs-number">1</span>],
                    <span class="hljs-string">'__VIEWSTATE'</span>: item[<span class="hljs-number">2</span>],
                    <span class="hljs-string">'__EVENTVALIDATION'</span>: item[<span class="hljs-number">3</span>],
                    <span class="hljs-string">'ctl00$ContentPlaceHolder1$txtlogintype'</span>: item[<span class="hljs-number">4</span>],
                    <span class="hljs-string">'ctl00$ContentPlaceHolder1$txtUsername_Lib'</span>: 账号,
                    <span class="hljs-string">'ctl00$ContentPlaceHolder1$txtPas_Lib'</span>: 密码,
                    <span class="hljs-string">'ctl00$ContentPlaceHolder1$btnLogin_Lib'</span>: item[<span class="hljs-number">5</span>]},
            callback=self.after_login
            )

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">after_login</span><span class="hljs-params">(self, response)</span>:</span>
        <span class="hljs-keyword">print</span> <span class="hljs-string">'after_login============'</span>

        <span class="hljs-comment">#查询网址的Cookie</span>
        <span class="hljs-comment">#请求Cookie</span>
        Cookie = response.request.headers.getlist(<span class="hljs-string">'Cookie'</span>)
        <span class="hljs-keyword">print</span> <span class="hljs-string">'Cookie'</span>,Cookie       
        <span class="hljs-comment">#响应Cookie</span>
        Cookie = response.headers.getlist(<span class="hljs-string">'Set-Cookie'</span>)
        <span class="hljs-keyword">print</span> <span class="hljs-string">'Set-Cookie'</span>,Cookie

        <span class="hljs-comment">#打印原始数据</span>
        <span class="hljs-keyword">print</span> response.body.decode(response.encoding) 
        <span class="hljs-comment">#可以自定义Item进行数据处理</span></code></pre> 
<p>2.3设置\myproject\myproject\settings.py</p> 
<pre class="prettyprint"><code class=" hljs php"><span class="hljs-comment"># 自动传递cookies与打印cookies设置</span>
<span class="hljs-comment"># Disable cookies (enabled by default)  </span>
COOKIES_ENABLED = <span class="hljs-keyword">True</span>
COOKIES_DEBUG = <span class="hljs-keyword">True</span></code></pre> 
<p>2.4执行工程 <br> <img src="https://images2.imgbox.com/f7/f9/ILyf0YWG_o.png" alt="这里写图片描述" title=""> <br> 3.总结 <br> 3.1正则表达式注意特殊符号需要使用转义符号，如：$。 <br> 3.2获取Cookie值方法可在Scrapy框架源码中寻找到，使用Notepad++（一般编辑器都有这个搜索功能）在Scrapy框架源码文件夹（如：C:\Users\lin\AppData\Local\Temp\pip-build-jm266e\Scrapy\scrapy）中搜索字符串Sending cookies或Received cookies即可。 <br> <img src="https://images2.imgbox.com/7c/6e/ackK4Hrf_o.png" alt="这里写图片描述" title=""> <br> 3.3 Python爬虫之自动登录与验证码识别 <br> （<a href="http://blog.csdn.net/tobacco5648/article/details/50640691">http://blog.csdn.net/tobacco5648/article/details/50640691</a>）</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fff695322a5d4ea9543ccae4d1ae04cd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Entity FrameWork 6帮助类</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f277952687a8698ba119c68d10499dc8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43;基础知识点</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>