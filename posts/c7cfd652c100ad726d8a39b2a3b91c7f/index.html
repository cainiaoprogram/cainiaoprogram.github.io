<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>图像直方图正规化(Normalization)数学原理和纯C语言实现 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="图像直方图正规化(Normalization)数学原理和纯C语言实现" />
<meta property="og:description" content="图像处理入门系列文章 C语言生成RGB24格式图像纯C语言实现
图像缩放之最近邻内插法数学原理和纯C语言实现
图像直方图均衡化(Equalization)数学原理和纯C语言实现
图像直方图规定化(Specification)数学原理和纯C语言实现
图像直方图正规化(Normalization)数学原理和纯C语言实现
目录
图像处理入门系列文章
一、图像正规化数学原理
1.转化为数学问题
2.需要用到的知识
3.数学推理
二、程序实现
1.程序实现原理
2.代码实现
3.程序执行效果
4.图像正规化前后效果
总结
一、图像正规化数学原理 1.转化为数学问题 2.需要用到的知识 一维函数微积分
随机变量的概率分布
3.数学推理 ​​​​​​​
二、程序实现 1.程序实现原理 2.代码实现 代码如下（示例）：
#include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; #define PICT_WIDTH 90 #define PICT_HEIGHT 60 static unsigned int s_rgb[PICT_WIDTH][PICT_HEIGHT][3] = { 0 }; /** * rgb24 * r:203 g:64,173,38 b:142 */ int make_rgb24_colorbar(unsigned int rgb[90][60][3]) { int i = 0; int j = 0; unsigned char chr = 0; for (j = 0; j&lt;PICT_HEIGHT; j&#43;&#43;) { for (i = 0; i &lt; PICT_WIDTH; i&#43;&#43;) { if (i&lt;30) { chr = 203; } else if (i&lt;60) { chr = 64; } else { chr = 0; } rgb[i][j][0] = chr; if (i&lt;30) { chr = 0; } else if (i&lt;60) { chr = 173; } else { chr = 0; } rgb[i][j][1] = chr; if (i&lt;30) { chr = 0; } else if (i&lt;60) { chr = 38; } else { chr = 142; } rgb[i][j][2] = chr; } } return 0; } int generate_rgb24_file(unsigned int rgb[90][60][3],char *file_name) { char file_path[64] = {0}; if (file_name == NULL) { return 0; } snprintf(file_path,63,&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c7cfd652c100ad726d8a39b2a3b91c7f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-13T21:03:47+08:00" />
<meta property="article:modified_time" content="2021-07-13T21:03:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">图像直方图正规化(Normalization)数学原理和纯C语言实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 id="%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E5%85%A5%E9%97%A8">图像处理入门系列文章</h2> 
<p><a href="https://blog.csdn.net/xiaoshixiu/article/details/116141181">C语言生成RGB24格式图像</a><a href="https://blog.csdn.net/xiaoshixiu/article/details/118559610">纯C语言实现</a></p> 
<p><a href="https://blog.csdn.net/xiaoshixiu/article/details/118077228">图像缩放之最近邻内插法</a><a href="https://blog.csdn.net/xiaoshixiu/article/details/118559610">数学原理和纯C语言实现</a></p> 
<p><a href="https://blog.csdn.net/xiaoshixiu/article/details/118559610">图像直方图均衡化</a>(Equalization)<a href="https://blog.csdn.net/xiaoshixiu/article/details/118559610">数学原理和纯C语言实现</a></p> 
<p><a href="https://blog.csdn.net/xiaoshixiu/article/details/118606998">图像直方图规定化(Specification)数学原理和纯C语言实现</a></p> 
<p><a href="https://blog.csdn.net/xiaoshixiu/article/details/118707772">图像直方图正规化(Normalization)数学原理和纯C语言实现</a></p> 
<hr> 
<p id="main-toc"></p> 
<p><strong>目录</strong></p> 
<p id="%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E5%85%A5%E9%97%A8-toc"><a href="#%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E5%85%A5%E9%97%A8" rel="nofollow">图像处理入门系列文章</a></p> 
<p id="%E4%B8%80%E3%80%81%E5%9B%BE%E5%83%8F%E5%9D%87%E8%A1%A1%E5%8C%96%E6%95%B0%E5%AD%A6%E5%8E%9F%E7%90%86-toc"><a href="#%E4%B8%80%E3%80%81%E5%9B%BE%E5%83%8F%E5%9D%87%E8%A1%A1%E5%8C%96%E6%95%B0%E5%AD%A6%E5%8E%9F%E7%90%86" rel="nofollow">一、图像正规化数学原理</a></p> 
<p id="1.%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%95%B0%E5%AD%A6%E9%97%AE%E9%A2%98-toc"><a href="#1.%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%95%B0%E5%AD%A6%E9%97%AE%E9%A2%98" rel="nofollow">1.转化为数学问题</a></p> 
<p id="2.%E9%9C%80%E8%A6%81%E7%94%A8%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86-toc"><a href="#2.%E9%9C%80%E8%A6%81%E7%94%A8%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86" rel="nofollow">2.需要用到的知识</a></p> 
<p id="3.%E6%95%B0%E5%AD%A6%E6%8E%A8%E7%90%86-toc"><a href="#3.%E6%95%B0%E5%AD%A6%E6%8E%A8%E7%90%86" rel="nofollow">3.数学推理</a></p> 
<p id="%E4%BA%8C%E3%80%81%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0-toc"><a href="#%E4%BA%8C%E3%80%81%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0" rel="nofollow">二、程序实现</a></p> 
<p id="1.%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86-toc"><a href="#1.%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86" rel="nofollow">1.程序实现原理</a></p> 
<p id="2.%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-toc"><a href="#2.%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0" rel="nofollow">2.代码实现</a></p> 
<p id="3.%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%95%88%E6%9E%9C-toc"><a href="#3.%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%95%88%E6%9E%9C" rel="nofollow">3.程序执行效果</a></p> 
<p id="4.%E5%9B%BE%E5%83%8F%E5%9D%87%E8%A1%A1%E5%8C%96%E5%89%8D%E5%90%8E%E6%95%88%E6%9E%9C-toc"><a href="#4.%E5%9B%BE%E5%83%8F%E5%9D%87%E8%A1%A1%E5%8C%96%E5%89%8D%E5%90%8E%E6%95%88%E6%9E%9C" rel="nofollow">4.图像正规化前后效果</a></p> 
<p id="%E6%80%BB%E7%BB%93-toc"><a href="#%E6%80%BB%E7%BB%93" rel="nofollow">总结</a></p> 
<hr> 
<h2 id="%E4%B8%80%E3%80%81%E5%9B%BE%E5%83%8F%E5%9D%87%E8%A1%A1%E5%8C%96%E6%95%B0%E5%AD%A6%E5%8E%9F%E7%90%86"><strong>一、图像正规化数学原理</strong></h2> 
<h3 id="1.%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%95%B0%E5%AD%A6%E9%97%AE%E9%A2%98">1.转化为数学问题</h3> 
<p>        <img alt="" height="165" src="https://images2.imgbox.com/29/72/6Y5dObjw_o.png" width="910"></p> 
<p></p> 
<p></p> 
<h3 id="2.%E9%9C%80%E8%A6%81%E7%94%A8%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86">2.需要用到的知识</h3> 
<p>        一维函数微积分<br>         随机变量的概率分布</p> 
<h3 id="3.%E6%95%B0%E5%AD%A6%E6%8E%A8%E7%90%86">3.数学推理</h3> 
<p>  ​​​​​​​<img alt="" height="353" src="https://images2.imgbox.com/b5/88/SCUHObSD_o.png" width="514"></p> 
<p></p> 
<p></p> 
<h2 id="%E4%BA%8C%E3%80%81%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0"><a id="_30"></a>二、程序实现</h2> 
<h3 id="1.%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><a id="1_31"></a>1.程序实现原理</h3> 
<p><img alt="" height="151" src="https://images2.imgbox.com/5b/60/cy3EbZol_o.png" width="970"></p> 
<p></p> 
<p></p> 
<p></p> 
<h3 id="2.%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><a id="2_49"></a>2.代码实现</h3> 
<p>代码如下（示例）：</p> 
<pre><code class="language-c">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
 
 
#define PICT_WIDTH  90
#define PICT_HEIGHT  60
 
 
static unsigned int s_rgb[PICT_WIDTH][PICT_HEIGHT][3] = { 0 };
 
/**
* rgb24
* r:203 g:64,173,38 b:142
*/
int make_rgb24_colorbar(unsigned int rgb[90][60][3])
{
	int i = 0;
	int j = 0;
	unsigned char chr = 0;
 
	for (j = 0; j&lt;PICT_HEIGHT; j++)
	{
		for (i = 0; i &lt; PICT_WIDTH; i++)
		{
			if (i&lt;30) 
			{
				chr = 203;
			}
			else if (i&lt;60) 
			{
				chr = 64;
			}
			else 
			{
				chr = 0;
			}
			rgb[i][j][0] = chr;
 
			if (i&lt;30)
			{
				chr = 0;
			}
			else if (i&lt;60)
			{
				chr = 173;
			}
			else
			{
				chr = 0;
			}
			rgb[i][j][1] = chr;
 
			if (i&lt;30)
			{
				chr = 0;
			}
			else if (i&lt;60)
			{
				chr = 38;
			}
			else
			{
				chr = 142;
			}
			rgb[i][j][2] = chr;
		}
	}
	return 0;
}
 
int generate_rgb24_file(unsigned int rgb[90][60][3],char *file_name)
{
	char file_path[64] = {0};
	if (file_name == NULL) 
	{
		return 0;
	}
	snprintf(file_path,63,"rgb_%s_90_60.rgb24", file_name);
	FILE *fp = fopen(file_path, "wb+");
	int i = 0;
	int j = 0;
	unsigned char chr = 0;
 
	for (j = 0; j&lt; PICT_HEIGHT; j++)
	{
		for (i = 0; i &lt; PICT_WIDTH; i++)
		{
			chr = rgb[i][j][0];
			fwrite(&amp;chr, 1, 1, fp);
 
			chr = rgb[i][j][1];
			fwrite(&amp;chr, 1, 1, fp);
 
			chr = rgb[i][j][2];
			fwrite(&amp;chr, 1, 1, fp);
		}
	}
	fclose(fp);
	return 0;
}
 
#define IMAGE_COLOR_LEVEL 256
 
#define HISTOGRAM_HEIGHT_MAX 20
#define HISTOGRAM_WIDTH_MAX 128
 
#define STATISTIC_DEC_MAX 5
#define STATISTIC_HOR_AXS_NUM (HISTOGRAM_WIDTH_MAX / STATISTIC_DEC_MAX)
 
int print_histogram(int image_statistic[IMAGE_COLOR_LEVEL],char *name)
{
	int *image_point = image_statistic;
	char hist_char = '*';
	char hist_space_char = ' ';
	char disp_array[HISTOGRAM_HEIGHT_MAX][HISTOGRAM_WIDTH_MAX + 1] = {0};
	int hist_statistic[HISTOGRAM_WIDTH_MAX] = {0};
	int i = 0;
	int j = 0;
	int k = 0;
	int statistic_max = 0;
	int hist_hor_axis[STATISTIC_HOR_AXS_NUM] = { 0 };
 
	for (i = 0; i &lt; IMAGE_COLOR_LEVEL; i++)
	{
		hist_statistic[i * HISTOGRAM_WIDTH_MAX / IMAGE_COLOR_LEVEL] += image_statistic[i];
	}
 
	for (i = 0; i &lt; STATISTIC_HOR_AXS_NUM; i++)
	{
		hist_hor_axis[i] = 1.0 * STATISTIC_DEC_MAX * i * IMAGE_COLOR_LEVEL / HISTOGRAM_WIDTH_MAX;
	}
 
	for (i = 0; i &lt; HISTOGRAM_WIDTH_MAX; i++)
	{
		if (hist_statistic[i] &gt; statistic_max)
		{
			statistic_max = hist_statistic[i];
		}
	}
 
 
	for (i = 0; i &lt; HISTOGRAM_WIDTH_MAX;i++)
	{
		int hist_height = statistic_max == 0 ? 0 : hist_statistic[i] * HISTOGRAM_HEIGHT_MAX / statistic_max;
		for (j = 0; j &lt; HISTOGRAM_HEIGHT_MAX; j++)
		{
			if (j &lt; hist_height)
			{
				disp_array[j][i] = hist_char;
			}
			else
			{
				disp_array[j][i] = hist_space_char;
			}
		}
	}
 
	printf(
		"     y\n"
		"      \n"
		"     |\n"
		"%5d|\n", statistic_max);
	for (i = 0; i &lt; HISTOGRAM_HEIGHT_MAX; i++)
	{
		printf(
		"     |%s\n", disp_array[HISTOGRAM_HEIGHT_MAX - i - 1]);
	}
	printf(
		"     |---------------------------------------------------------------------------------------------------------------------------------&gt;x\n");
	printf(
		"     ");
	char dec_max[32] = { 0 };
	char format_str[32] = "%-";
	sprintf(dec_max, "%d", STATISTIC_DEC_MAX);
	strncat(format_str, dec_max,32);
	strncat(format_str, "d", 32);
	for (i = 0; i &lt; STATISTIC_HOR_AXS_NUM; i++)
	{
		printf(
			format_str, hist_hor_axis[i]);
	}
	printf(
		"\n");
		
	if(name != NULL)
	{
		int name_size = strlen(name);
		if(name_size &lt; HISTOGRAM_WIDTH_MAX)
		{
			int space = (HISTOGRAM_WIDTH_MAX - name_size) / 2;
			for (i = 0; i &lt; space; i++)
			{
				printf(" ");
			}
			printf("%s\n\n",name);
		}
		
	}	
	return 0;
}
 
int statistic_histogram(unsigned int rgb[90][60][3],int image_statistic[IMAGE_COLOR_LEVEL])
{
	int i = 0;
	int j = 0;
	int k = 0;
	for(i = 0; i &lt; 90; i++)
	{
		for (j = 0; j &lt; 60; j++) 
		{
			for (k = 0; k &lt; 3; k++)
			{
				image_statistic[rgb[i][j][k]]++;
			}
		}
	}
	return 0;
}


//直方图正规化
int histogram_normalization(unsigned int rgb[90][60][3], unsigned int result_rgb[90][60][3],int des_min,int des_max)
{
	int image_statistic[IMAGE_COLOR_LEVEL] = {0};
	int image_statistic2[IMAGE_COLOR_LEVEL] = {0};
	int i = 0;
	int j = 0;
	int k = 0;
	int tmp = 0;
	int src_min = IMAGE_COLOR_LEVEL - 1;
	int src_max = 0;
 
	statistic_histogram(rgb, image_statistic);
	
	for (i = 0; i &lt; IMAGE_COLOR_LEVEL; i++)
	{
		if(image_statistic[i] != 0)
		{
			printf("before,i:[%d],num:[%d]\n",i,image_statistic[i]);
		}
	}
	
	for (i = 0; i &lt; IMAGE_COLOR_LEVEL; i++)
	{
		if(image_statistic[i] != 0)
		{
			if(src_max &lt; i)
			{
				src_max = i;
			}
			
			if(src_min &gt; i)
			{
				src_min = i;
			}
		}
	}
	
	printf("src_min:[%d],src_max:[%d],des_min:[%d],des_max:[%d]\n",src_min,src_max,des_min,des_max);
	
	for (i = 0; i &lt; 90; i++)
	{
		for (j = 0; j &lt; 60; j++)
		{
			for (k = 0; k &lt; 3; k++)
			{
				result_rgb[i][j][k] = (unsigned int)(1.0 * rgb[i][j][k] * (des_max - des_min) / (src_max - src_min) 
					+ 1.0 * (src_max * des_min - src_min * des_max)/(src_max - src_min));
			}
		}
	}
 
	statistic_histogram(result_rgb, image_statistic2);
	
	for (i = 0; i &lt; IMAGE_COLOR_LEVEL; i++)
	{
		if(image_statistic2[i] != 0)
		{
			printf("after,i:[%d],num:[%d]\n",i,image_statistic2[i]);
		}
	}
	
	return 0;
}
 
int main()
{
	int image_statistic[IMAGE_COLOR_LEVEL] = {0};
	make_rgb24_colorbar(s_rgb);
	generate_rgb24_file(s_rgb, "colorbar");
	statistic_histogram(s_rgb, image_statistic);
	
	printf("\n ");
	print_histogram(image_statistic,"source image histogram");
 
	unsigned int result_rgb[90][60][3];
	int result_statistic[IMAGE_COLOR_LEVEL] = { 0 };
	
	histogram_normalization(s_rgb, result_rgb,0,255);
	statistic_histogram(result_rgb, result_statistic);
	print_histogram(result_statistic,"destination image histogram");
	generate_rgb24_file(result_rgb,"specification");
	sleep(100);;
    return 0;
}
 </code></pre> 
<h3></h3> 
<h3 id="3.%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%95%88%E6%9E%9C">3.程序执行效果</h3> 
<p><img alt="" height="948" src="https://images2.imgbox.com/73/fe/xZsf6nNh_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<h3 id="4.%E5%9B%BE%E5%83%8F%E5%9D%87%E8%A1%A1%E5%8C%96%E5%89%8D%E5%90%8E%E6%95%88%E6%9E%9C">4.图像正规化前后效果</h3> 
<p>正规化前：</p> 
<p><img alt="" height="146" src="https://images2.imgbox.com/57/7a/UySiokSP_o.png" width="176"></p> 
<p>正规化后：</p> 
<p><img alt="" height="147" src="https://images2.imgbox.com/44/a0/SSJdqlcJ_o.png" width="176"></p> 
<p></p> 
<p></p> 
<p></p> 
<hr> 
<h2 id="%E6%80%BB%E7%BB%93"><a id="_67"></a>总结</h2> 
<p>需要用实际图像测试。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3b33164c6ad4fb2c0626542451caa32d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue的属性赋值和事件绑定符号“：”和 “@”</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d9dc51fa852293680ac267ca4f2d2dd7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于Vue&#43;SpringCloudAlibaba微服务电商项目实战-016：构建微服务电商项目智能报警系统替代elk分布式日志收集</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>