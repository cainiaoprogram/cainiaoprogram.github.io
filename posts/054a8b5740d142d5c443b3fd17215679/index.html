<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PostgreSQL安装(Mac) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PostgreSQL安装(Mac)" />
<meta property="og:description" content="PostgreSQL安装(Mac) 文章目录 PostgreSQL安装(Mac)1. 简介2.参考文献3.开始安装4.数据库配置的初始化和修改5. 登录数据库6. 初始化数据库7. 常用控制台命令 好记性不如烂笔头啊，还是记录一下! 最近自己做的独立游戏需要对数据库选型，主要有两个选择：
1. MySQL号称最流行的数据库
2. PostgreSQL号称最先进的数据库
最后经过一番考量，最后选择了PostgreSQL，本篇博客主要记录的安装过程，可供同学们参考。
本篇博客介绍的是Mac下的安装过程
1. 简介 1.PostgreSQL: 是以加州大学伯克利分校计算机系开发的 POSTGRES，现在已经更名为PostgreSQL，版本 4.2为基础的对象关系型数据库管理系统（ORDBMS）。PostgreSQL支持大部分 SQL标准并且提供了许多其他现代特性：复杂查询、外键、触发器、视图、事务完整性、MVCC。同样，PostgreSQL 可以用许多方法扩展，比如， 通过增加新的数据类型、函数、操作符、聚集函数、索引。免费使用、修改、和分发 PostgreSQL，不管是私用、商用、还是学术研究使用。
2.参考文献 老习惯，列出本文参考和引用的文档和博客，致以崇高的敬意，感兴趣的可以去看看
http://postgresapp.com/http://postgresapp.com/documentation/cli-tools.htmlhttp://www.yiibai.com/postgresql/2013080439.html 3.开始安装 安装很简单，我是直接用brew安装的：
brew install postgresql 等待运行完后，就安装在了usr/local/Cellar/postgresql/目录下
# 配置一下环境变量： echo -e &#39;export POSTGRESQL_HOME=&#39;${POSTGRESQL_INSTALL_PATH}&#39;\nexport PATH=${POSTGRESQL_HOME}/bin:$PATH\nexport PGDATA=&#39;${POSTGRESQL_INSTALL_PATH}&#39;/data\n&#39;&gt;&gt; /etc/profile source /etc/profile POSTGRESQL_INSTALL_PATH为你的安装路径
4.数据库配置的初始化和修改 初始化数据库配置：
pg_ctl -D ${POSTGRESQL_DATABASE_PATH} initdb POSTGRESQL_DATABASE_PATH是我自动化安装脚本中的变量，可以改为你任何想初始化到的路径下，我用的是POSTGRESQL_DATABASE_PATH=&#39;/usr/local/data/postgres&#39;
然后进入初始化后的目录：
cd ${POSTGRESQL_DATABASE_PATH} 可以在这个目录下看到很多文件，需要修改的是pg_hba.conf和postgresql.conf
pg_hba.conf中主要是一些权限配置，就是配置了哪些IP用什么方式可以登录到数据库postgresql.conf主要就是一些数据库的细节配置。 pg_hba.conf我做了如下修改：
# 修改监听地址 sed -i &#34;s/#listen_addresses = &#39;localhost&#39;/listen_addresses = &#39;*&#39;/g&#34; postgresql.conf # 修改监听端口 sed -i &#39;s/#port = 5432/port = 5432/g&#39; postgresql." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/054a8b5740d142d5c443b3fd17215679/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-08-05T21:01:54+08:00" />
<meta property="article:modified_time" content="2019-08-05T21:01:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PostgreSQL安装(Mac)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="PostgreSQLMac_0"></a>PostgreSQL安装(Mac)</h2> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#PostgreSQLMac_0" rel="nofollow">PostgreSQL安装(Mac)</a></li><li><ul><li><a href="#1__15" rel="nofollow">1. 简介</a></li><li><a href="#2_20" rel="nofollow">2.参考文献</a></li><li><a href="#3_28" rel="nofollow">3.开始安装</a></li><li><a href="#4_45" rel="nofollow">4.数据库配置的初始化和修改</a></li><li><a href="#5__87" rel="nofollow">5. 登录数据库</a></li><li><a href="#6__106" rel="nofollow">6. 初始化数据库</a></li><li><a href="#7__130" rel="nofollow">7. 常用控制台命令</a></li></ul> 
 </li></ul> 
</div> 
<br> 好记性不如烂笔头啊，还是记录一下! 
<p></p> 
<hr> 
<p>最近自己做的独立游戏需要对数据库选型，主要有两个选择：<br> <code>1. MySQL号称最流行的数据库</code><br> <code>2. PostgreSQL号称最先进的数据库</code><br> 最后经过一番考量，最后选择了<code>PostgreSQL</code>，本篇博客主要记录的安装过程，可供同学们参考。</p> 
<p><code>本篇博客介绍的是Mac下的安装过程</code></p> 
<hr> 
<h3><a id="1__15"></a>1. 简介</h3> 
<p><strong>1.PostgreSQL</strong>: 是以<a href="https://link.jianshu.com?t=http://baike.baidu.com/view/182408.htm" rel="nofollow">加州大学</a>伯克利分校计算机系开发的 POSTGRES，现在已经更名为PostgreSQL，版本 4.2为基础的对象<a href="https://link.jianshu.com?t=http://baike.baidu.com/view/1450387.htm" rel="nofollow">关系型数据库管理系统</a>（ORDBMS）。PostgreSQL支持大部分 SQL标准并且提供了许多其他现代特性：复杂查询、<a href="https://link.jianshu.com?t=http://baike.baidu.com/view/68073.htm" rel="nofollow">外键</a>、<a href="https://link.jianshu.com?t=http://baike.baidu.com/view/71792.htm" rel="nofollow">触发器</a>、视图、<a href="https://link.jianshu.com?t=http://baike.baidu.com/view/121511.htm" rel="nofollow">事务</a>完整性、<a href="https://link.jianshu.com?t=http://baike.baidu.com/view/1887040.htm" rel="nofollow">MVCC</a>。同样，PostgreSQL 可以用许多方法扩展，比如， 通过增加新的数据类型、函数、操作符、<a href="https://link.jianshu.com?t=http://baike.baidu.com/view/2537411.htm" rel="nofollow">聚集函数</a>、索引。免费使用、修改、和分发 PostgreSQL，不管是私用、商用、还是学术研究使用。</p> 
<hr> 
<h3><a id="2_20"></a>2.参考文献</h3> 
<p>老习惯，列出本文参考和引用的文档和博客，致以崇高的敬意，感兴趣的可以去看看</p> 
<ol><li><a href="https://link.jianshu.com?t=http://postgresapp.com/" rel="nofollow">http://postgresapp.com/</a></li><li><a href="https://link.jianshu.com?t=http://postgresapp.com/documentation/cli-tools.html" rel="nofollow">http://postgresapp.com/documentation/cli-tools.html</a></li><li><a href="https://link.jianshu.com?t=http://www.yiibai.com/postgresql/2013080439.html" rel="nofollow">http://www.yiibai.com/postgresql/2013080439.html</a></li></ol> 
<hr> 
<h3><a id="3_28"></a>3.开始安装</h3> 
<p>安装很简单，我是直接用<code>brew</code>安装的：</p> 
<pre><code class="prism language-shell">brew <span class="token function">install</span> postgresql 
</code></pre> 
<p>等待运行完后，就安装在了<code>usr/local/Cellar/postgresql/</code>目录下</p> 
<pre><code class="prism language-shell"><span class="token comment"># 配置一下环境变量：</span>
<span class="token keyword">echo</span> -e <span class="token string">'export POSTGRESQL_HOME='</span><span class="token variable">${POSTGRESQL_INSTALL_PATH}</span><span class="token string">'\nexport PATH=<span class="token variable">${POSTGRESQL_HOME}</span>/bin:<span class="token variable">$PATH</span>\nexport PGDATA='</span><span class="token variable">${POSTGRESQL_INSTALL_PATH}</span><span class="token string">'/data\n'</span><span class="token operator">&gt;&gt;</span> /etc/profile
<span class="token function">source</span> /etc/profile
</code></pre> 
<blockquote> 
 <p><code>POSTGRESQL_INSTALL_PATH</code>为你的安装路径</p> 
</blockquote> 
<hr> 
<h3><a id="4_45"></a>4.数据库配置的初始化和修改</h3> 
<p>初始化数据库配置：</p> 
<pre><code class="prism language-bash">pg_ctl -D <span class="token variable">${POSTGRESQL_DATABASE_PATH}</span> initdb
</code></pre> 
<blockquote> 
 <p><code>POSTGRESQL_DATABASE_PATH</code>是我自动化安装脚本中的变量，可以改为你任何想初始化到的路径下，我用的是<code>POSTGRESQL_DATABASE_PATH='/usr/local/data/postgres'</code></p> 
</blockquote> 
<p>然后进入初始化后的目录：</p> 
<pre><code class="prism language-bash"><span class="token function">cd</span> <span class="token variable">${POSTGRESQL_DATABASE_PATH}</span>
</code></pre> 
<p>可以在这个目录下看到很多文件，需要修改的是<code>pg_hba.conf</code>和<code>postgresql.conf</code></p> 
<ol><li><code>pg_hba.conf</code>中主要是一些权限配置，就是配置了哪些IP用什么方式可以登录到数据库</li><li><code>postgresql.conf</code>主要就是一些数据库的细节配置。</li></ol> 
<p><code>pg_hba.conf</code>我做了如下修改：</p> 
<pre><code class="prism language-bash"><span class="token comment"># 修改监听地址</span>
<span class="token function">sed</span> -i <span class="token string">"s/#listen_addresses = 'localhost'/listen_addresses = '*'/g"</span> postgresql.conf
<span class="token comment"># 修改监听端口</span>
<span class="token function">sed</span> -i <span class="token string">'s/#port = 5432/port = 5432/g'</span> postgresql.conf
</code></pre> 
<blockquote> 
 <p>我比较懒，直接用的命令修改，方便自动话工具使用，同学们可以直接用编辑器打开找到对应的行进行修改。</p> 
</blockquote> 
<p><code>postgresql.conf</code>我做了如下修改：</p> 
<pre><code class="prism language-bash"><span class="token function">sed</span> -i <span class="token string">'s/#logging_collector = off/logging_collector = on/g'</span> postgresql.conf
<span class="token comment"># log地址，SERVER_PSQL_LOG为我的服务器LOG地址，可以改为你想放的位置</span>
<span class="token function">sed</span> -i <span class="token string">"s/#log_directory = 'log'/log_directory = '"</span><span class="token variable">${SERVER_PSQL_LOG//\//\\\/}</span><span class="token string">"'/g"</span> postgresql.conf
<span class="token comment"># log文件的名字，我格式化为了类似postgresql-2019-08-04_000000.log这样的名字</span>
<span class="token function">sed</span> -i <span class="token string">"s/#log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'/log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'/g"</span> postgresql.conf
<span class="token function">sed</span> -i <span class="token string">"s/#log_truncate_on_rotation = off/log_truncate_on_rotation = off/g"</span> postgresql.conf
<span class="token comment"># log每一天新建一个文件</span>
<span class="token function">sed</span> -i <span class="token string">"s/#log_rotation_age = 1d/log_rotation_age = 1d/g"</span> postgresql.conf
<span class="token comment"># log超过多大重新建立个新的文件，我用的10MB</span>
<span class="token function">sed</span> -i <span class="token string">"s/#log_rotation_size = 10MB/log_rotation_size = 10MB/g"</span> postgresql.conf
</code></pre> 
<blockquote> 
 <p><code>postgresql.conf</code>这个配置一般可以不改，因为我想改些日志方面的配置，所以也进行了修改，同学可以自行斟酌要不要修改。</p> 
</blockquote> 
<hr> 
<h3><a id="5__87"></a>5. 登录数据库</h3> 
<p>登录命令的格式为：</p> 
<pre><code class="prism language-cf">psql -U [user] -d [database] -h [host] -p [post]
</code></pre> 
<p><code>-U指定用户，-d指定数据库，-h指定服务器，-p指定端口</code><br> 直接使用psql登录控制台，实际上使用的是缺省数据</p> 
<pre><code class="prism language-cf">user:当前mac用户
database: 用户同名数据库
主机: localhost
端口号: 5432，postgresql的默认端口是5432
</code></pre> 
<p>完整的登录命令，比如使用postgres用户登录</p> 
<pre><code class="prism language-bash">psql -U postgres -d postgres
</code></pre> 
<hr> 
<h3><a id="6__106"></a>6. 初始化数据库</h3> 
<p>初始化数据库的方法是直接登入数据库：</p> 
<pre><code class="prism language-bash">psql -U <span class="token variable">${PSQL_USER}</span> -d postgres
</code></pre> 
<p>登录后，现在登录的<code>postgres</code>，这是默认的数据库，我们需要创建个自己的数据库：</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 创建的数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token string">'${PSQL_DBNAME}'</span><span class="token punctuation">;</span>
<span class="token comment">-- 修改用户密码</span>
<span class="token keyword">alter</span> <span class="token keyword">user</span> ${PSQL_USER} <span class="token keyword">with</span> password <span class="token string">'${PSQL_PASS}'</span><span class="token punctuation">;</span>
</code></pre> 
<p>我就更懒一些了，直接用命令行：</p> 
<pre><code class="prism language-bash">psql -U <span class="token variable">${PSQL_USER}</span> -d postgres -c <span class="token string">"CREATE DATABASE '<span class="token variable">${PSQL_DBNAME}</span>';"</span>
psql -U <span class="token variable">${PSQL_USER}</span> -d <span class="token variable">${PSQL_DBNAME}</span> -c <span class="token string">"alter user <span class="token variable">${PSQL_USER}</span> with password '<span class="token variable">${PSQL_PASS}</span>';"</span>
</code></pre> 
<blockquote> 
 <p><code>PSQL_DBNAME</code>为你任意想创建的数据名字<br> <code>PSQL_USER</code>为你<code>postgres</code>的用户名字<br> <code>PSQL_PASS</code>为你任意想更改的密码</p> 
</blockquote> 
<p>效果也是一样的</p> 
<hr> 
<h3><a id="7__130"></a>7. 常用控制台命令</h3> 
<pre><code class="prism language-cf">\password：设置当前登录用户的密码
\h：查看SQL命令的解释，比如\h select。
\?：查看psql命令列表。
\l：列出所有数据库。
\c [database_name]：连接其他数据库。
\d：列出当前数据库的所有表格。
\d [table_name]：列出某一张表格的结构。
\du：列出所有用户。
\e：打开文本编辑器。
\conninfo：列出当前数据库和连接的信息。
\password [user]: 修改用户密码
\q：退出
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/01cbe13f0d2c63adea749ecdfaf58a5e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">创建和使用画刷</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b2f3a5c4fba128118aadb0653ada9725/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">|220个遥感名词解释</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>