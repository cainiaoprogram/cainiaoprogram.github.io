<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>深度学习Batch Normalization - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="深度学习Batch Normalization" />
<meta property="og:description" content="批标准化（Batch Normalization，简称BN）是一种用于深度神经网络的技术，它的主要目的是解决深度学习模型训练过程中的内部协变量偏移问题。简单来说，当我们在训练深度神经网络时，每一层的输入分布都可能会随着前一层参数的更新而发生变化，这种变化会导致训练过程变得不稳定。BN通过对每一层的输入进行标准化，使其均值为0，方差为1，从而使得网络在每一层都能接收到相对稳定的数据分布。
BatchNorm1d 对2d或3d数据进行批标准化（Batch Normlization）操作:
class torch.nn.BatchNorm1d(num_features, eps=1e-05, momentum=0.1, affine=True): 参数：
1.num_features：特征的维度 ( N , L ) − &gt; L ; ( N , C , L ) − &gt; C (N,L) -&gt; L ;(N,C,L) -&gt; C (N,L)−&gt;L;(N,C,L)−&gt;C
2.eps：在分母上添加一个定值，不能趋近于0
3.momentum：动态均值和动态方差所使用的动量，这里的momentum是对均值和方差进行的滑动平均。即 μ 1 = （ 1 − m o m e n t u m ） ∗ μ l a s t &#43; m o m e n t u m ∗ μ μ_1 = （1 - momentum）* μ_{last} &#43; momentum * μ μ1​=（1−momentum）∗μlast​&#43;momentum∗μ，这里μ1为输出值，μ_last为上一次的计算值，μ为真实计算的值" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/7104e1bd78128f84b1f58b43b7688ddd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-15T22:29:52+08:00" />
<meta property="article:modified_time" content="2023-08-15T22:29:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">深度学习Batch Normalization</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>批标准化（Batch Normalization，简称BN）是一种用于深度神经网络的技术，它的主要目的是解决深度学习模型训练过程中的内部协变量偏移问题。简单来说，当我们在训练深度神经网络时，每一层的输入分布都可能会随着前一层参数的更新而发生变化，这种变化会导致训练过程变得不稳定。BN通过对每一层的输入进行标准化，使其均值为0，方差为1，从而使得网络在每一层都能接收到相对稳定的数据分布。</p> 
<h3><a id="BatchNorm1d_1"></a>BatchNorm1d</h3> 
<p>对2d或3d数据进行批标准化（Batch Normlization）操作:</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">torch</span><span class="token punctuation">.</span>nn<span class="token punctuation">.</span>BatchNorm1d<span class="token punctuation">(</span>num_features<span class="token punctuation">,</span> eps<span class="token operator">=</span><span class="token number">1e-05</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> affine<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</code></pre> 
<p>参数：</p> 
<blockquote> 
 <p>1.num_features：特征的维度 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ( 
         
        
          N 
         
        
          , 
         
        
          L 
         
        
          ) 
         
        
          − 
         
        
          &gt; 
         
        
          L 
         
        
          ; 
         
        
          ( 
         
        
          N 
         
        
          , 
         
        
          C 
         
        
          , 
         
        
          L 
         
        
          ) 
         
        
          − 
         
        
          &gt; 
         
        
          C 
         
        
       
         (N,L) -&gt; L ;(N,C,L) -&gt; C 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span><span class="mord">−</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">L</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span><span class="mord">−</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span></span></span></span></span></p> 
 <p>2.eps：在分母上添加一个定值，不能趋近于0</p> 
 <p>3.momentum：动态均值和动态方差所使用的动量，这里的momentum是对均值和方差进行的滑动平均。即 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           μ 
          
         
           1 
          
         
        
          = 
         
        
          （ 
         
        
          1 
         
        
          − 
         
        
          m 
         
        
          o 
         
        
          m 
         
        
          e 
         
        
          n 
         
        
          t 
         
        
          u 
         
        
          m 
         
        
          ） 
         
        
          ∗ 
         
         
         
           μ 
          
          
          
            l 
           
          
            a 
           
          
            s 
           
          
            t 
           
          
         
        
          + 
         
        
          m 
         
        
          o 
         
        
          m 
         
        
          e 
         
        
          n 
         
        
          t 
         
        
          u 
         
        
          m 
         
        
          ∗ 
         
        
          μ 
         
        
       
         μ_1 = （1 - momentum）* μ_{last} + momentum * μ 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord cjk_fallback">（</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord cjk_fallback">）</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span></span>，这里μ1为输出值，μ_last为上一次的计算值，μ为真实计算的值</p> 
 <p>4.affine：布尔变量，是否为该层添加可学习的仿设变换，仿射变换的系数即为下式的gamma和beta</p> 
</blockquote> 
<p>原理：</p> 
<blockquote> 
 <p>计算各个维度的均值和标准差:<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
         
          
          
            x 
           
          
            − 
           
          
            mean 
           
          
            ⁡ 
           
          
            [ 
           
          
            x 
           
          
            ] 
           
          
          
           
            
            
              Var 
             
            
              ⁡ 
             
            
              [ 
             
            
              x 
             
            
              ] 
             
            
           
          
            + 
           
          
            ϵ 
           
          
         
        
          ∗ 
         
        
          g 
         
        
          a 
         
        
          m 
         
        
          m 
         
        
          a 
         
        
          + 
         
        
           beta  
         
        
       
         y=\frac{x-\operatorname{mean}[x]}{\sqrt{\operatorname{Var}[x]}+\epsilon} * g a m m a+\text { beta } 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.8396em; vertical-align: -0.8296em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em;"><span class="" style="top: -2.4642em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0369em;"><span class="svg-align" style="top: -3.4286em;"><span class="pstrut" style="height: 3.4286em;"></span><span class="mord mtight" style="padding-left: 1.19em;"><span class="mop mtight"><span class="mord mathrm mtight">Var</span></span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">]</span></span></span><span class="" style="top: -3.0089em;"><span class="pstrut" style="height: 3.4286em;"></span><span class="hide-tail mtight" style="min-width: 0.853em; height: 1.5429em;"> 
                    <svg width="400em" height="1.5429em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> 
                     <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> 
                    </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4197em;"><span class=""></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">ϵ</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mop mtight"><span class="mord mathrm mtight">mean</span></span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.8296em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mord mathnormal">amma</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord"> beta </span></span></span></span></span></span></p> 
</blockquote> 
<pre><code class="prism language-python">m <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm1d<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> affine<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
m1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm1d<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> affine<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token builtin">input</span> <span class="token operator">=</span> autograd<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
output <span class="token operator">=</span> m<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span>
output1 <span class="token operator">=</span> m1<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">,</span>output<span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">,</span>output1<span class="token punctuation">)</span>

tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.6046</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.8939</span><span class="token punctuation">,</span>  <span class="token number">1.3246</span><span class="token punctuation">,</span>  <span class="token number">0.2621</span><span class="token punctuation">,</span>  <span class="token number">1.0777</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.9088</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6219</span><span class="token punctuation">,</span>  <span class="token number">0.9589</span><span class="token punctuation">,</span>  <span class="token number">0.7307</span><span class="token punctuation">,</span>  <span class="token number">0.5221</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">1.7435</span><span class="token punctuation">,</span>  <span class="token number">0.6662</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5827</span><span class="token punctuation">,</span>  <span class="token number">0.3325</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.8179</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.2250</span><span class="token punctuation">,</span>  <span class="token number">0.9930</span><span class="token punctuation">,</span>  <span class="token number">0.0504</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4509</span><span class="token punctuation">,</span>  <span class="token number">1.6605</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.5742</span><span class="token punctuation">,</span>  <span class="token number">1.6543</span><span class="token punctuation">,</span>  <span class="token number">0.6083</span><span class="token punctuation">,</span>  <span class="token number">0.5746</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3208</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
 tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.9212</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.2920</span><span class="token punctuation">,</span>  <span class="token number">1.2648</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0680</span><span class="token punctuation">,</span>  <span class="token number">0.7249</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.7107</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0117</span><span class="token punctuation">,</span>  <span class="token number">0.7224</span><span class="token punctuation">,</span>  <span class="token number">1.0842</span><span class="token punctuation">,</span>  <span class="token number">0.1085</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">1.6108</span><span class="token punctuation">,</span>  <span class="token number">0.3161</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.5642</span><span class="token punctuation">,</span>  <span class="token number">0.1049</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3780</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.5119</span><span class="token punctuation">,</span>  <span class="token number">0.6530</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6252</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.8215</span><span class="token punctuation">,</span>  <span class="token number">1.3713</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.8885</span><span class="token punctuation">,</span>  <span class="token number">1.3345</span><span class="token punctuation">,</span>  <span class="token number">0.2022</span><span class="token punctuation">,</span>  <span class="token number">0.7005</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.8266</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
 tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.9212</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.2920</span><span class="token punctuation">,</span>  <span class="token number">1.2648</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0680</span><span class="token punctuation">,</span>  <span class="token number">0.7249</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.7107</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0117</span><span class="token punctuation">,</span>  <span class="token number">0.7224</span><span class="token punctuation">,</span>  <span class="token number">1.0842</span><span class="token punctuation">,</span>  <span class="token number">0.1085</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">1.6108</span><span class="token punctuation">,</span>  <span class="token number">0.3161</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.5642</span><span class="token punctuation">,</span>  <span class="token number">0.1049</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3780</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.5119</span><span class="token punctuation">,</span>  <span class="token number">0.6530</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6252</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.8215</span><span class="token punctuation">,</span>  <span class="token number">1.3713</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.8885</span><span class="token punctuation">,</span>  <span class="token number">1.3345</span><span class="token punctuation">,</span>  <span class="token number">0.2022</span><span class="token punctuation">,</span>  <span class="token number">0.7005</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.8266</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       grad_fn<span class="token operator">=</span><span class="token operator">&lt;</span>NativeBatchNormBackward<span class="token operator">&gt;</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="BatchNorm2d_48"></a>BatchNorm2d</h3> 
<p>对小批量(mini-batch)3d数据组成的4d输入进行批标准化(Batch Normalization)操作</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">torch</span><span class="token punctuation">.</span>nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span>num_features<span class="token punctuation">,</span> eps<span class="token operator">=</span><span class="token number">1e-05</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> affine<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</code></pre> 
<blockquote> 
 <p>1.num_features： 来自期望输入的特征数，C from an expected input of size (N,C,H,W)</p> 
 <p>2.eps： 为保证数值稳定性（分母不能趋近或取0）,给分母加上的值。默认为1e-5.</p> 
 <p>3.momentum： 动态均值和动态方差所使用的动量。默认为0.1.</p> 
 <p>4.affine： 一个布尔值，当设为true，给该层添加可学习的仿射变换参数。</p> 
</blockquote> 
<p>原理：</p> 
<blockquote> 
 <p>计算各个维度的均值和标准差:<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
         
          
          
            x 
           
          
            − 
           
          
            mean 
           
          
            ⁡ 
           
          
            [ 
           
          
            x 
           
          
            ] 
           
          
          
           
            
            
              Var 
             
            
              ⁡ 
             
            
              [ 
             
            
              x 
             
            
              ] 
             
            
           
          
            + 
           
          
            ϵ 
           
          
         
        
          ∗ 
         
        
          g 
         
        
          a 
         
        
          m 
         
        
          m 
         
        
          a 
         
        
          + 
         
        
           beta  
         
        
       
         y=\frac{x-\operatorname{mean}[x]}{\sqrt{\operatorname{Var}[x]}+\epsilon} * g a m m a+\text { beta } 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.8396em; vertical-align: -0.8296em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em;"><span class="" style="top: -2.4642em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0369em;"><span class="svg-align" style="top: -3.4286em;"><span class="pstrut" style="height: 3.4286em;"></span><span class="mord mtight" style="padding-left: 1.19em;"><span class="mop mtight"><span class="mord mathrm mtight">Var</span></span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">]</span></span></span><span class="" style="top: -3.0089em;"><span class="pstrut" style="height: 3.4286em;"></span><span class="hide-tail mtight" style="min-width: 0.853em; height: 1.5429em;"> 
                    <svg width="400em" height="1.5429em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> 
                     <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> 
                    </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4197em;"><span class=""></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">ϵ</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mop mtight"><span class="mord mathrm mtight">mean</span></span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.8296em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mord mathnormal">amma</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord"> beta </span></span></span></span></span></span></p> 
</blockquote> 
<pre><code class="prism language-python">m <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> affine<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
m1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> affine<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token builtin">input</span> <span class="token operator">=</span> autograd<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
output <span class="token operator">=</span> m<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span>
output1 <span class="token operator">=</span> m1<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">,</span>output<span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">,</span>output1<span class="token punctuation">)</span>


tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.2606</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.8874</span><span class="token punctuation">,</span>  <span class="token number">0.8364</span><span class="token punctuation">,</span>  <span class="token number">0.0184</span><span class="token punctuation">,</span>  <span class="token number">0.8040</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">1.0593</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6811</span><span class="token punctuation">,</span>  <span class="token number">1.3497</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6840</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0859</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.5399</span><span class="token punctuation">,</span>  <span class="token number">1.3321</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6281</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9044</span><span class="token punctuation">,</span>  <span class="token number">1.7491</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">0.7559</span><span class="token punctuation">,</span>  <span class="token number">0.5607</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0447</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3868</span><span class="token punctuation">,</span>  <span class="token number">1.2404</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">1.2078</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9642</span><span class="token punctuation">,</span>  <span class="token number">0.3980</span><span class="token punctuation">,</span>  <span class="token number">0.2087</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3940</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

         <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.0493</span><span class="token punctuation">,</span>  <span class="token number">0.7372</span><span class="token punctuation">,</span>  <span class="token number">1.1964</span><span class="token punctuation">,</span>  <span class="token number">0.3862</span><span class="token punctuation">,</span>  <span class="token number">0.9900</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">0.3544</span><span class="token punctuation">,</span>  <span class="token number">0.1767</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.5780</span><span class="token punctuation">,</span>  <span class="token number">0.1642</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.1586</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.4891</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7272</span><span class="token punctuation">,</span>  <span class="token number">1.6860</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.6091</span><span class="token punctuation">,</span>  <span class="token number">0.9730</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2.4161</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.2096</span><span class="token punctuation">,</span>  <span class="token number">0.4617</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2965</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5663</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.0222</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7628</span><span class="token punctuation">,</span>  <span class="token number">0.6404</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.4428</span><span class="token punctuation">,</span>  <span class="token number">0.5750</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
 tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.3522</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9959</span><span class="token punctuation">,</span>  <span class="token number">0.7743</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0657</span><span class="token punctuation">,</span>  <span class="token number">0.7410</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">1.0032</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7840</span><span class="token punctuation">,</span>  <span class="token number">1.3015</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7870</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.2266</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.6390</span><span class="token punctuation">,</span>  <span class="token number">1.2833</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7296</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0134</span><span class="token punctuation">,</span>  <span class="token number">1.7116</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">0.6917</span><span class="token punctuation">,</span>  <span class="token number">0.4912</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1305</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4818</span><span class="token punctuation">,</span>  <span class="token number">1.1892</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">1.1557</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0748</span><span class="token punctuation">,</span>  <span class="token number">0.3242</span><span class="token punctuation">,</span>  <span class="token number">0.1298</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.5161</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

         <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.2560</span><span class="token punctuation">,</span>  <span class="token number">0.8743</span><span class="token punctuation">,</span>  <span class="token number">1.2870</span><span class="token punctuation">,</span>  <span class="token number">0.5588</span><span class="token punctuation">,</span>  <span class="token number">1.1015</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">0.5302</span><span class="token punctuation">,</span>  <span class="token number">0.3705</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.2066</span><span class="token punctuation">,</span>  <span class="token number">0.3593</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.7285</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.2280</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4420</span><span class="token punctuation">,</span>  <span class="token number">1.7271</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.2346</span><span class="token punctuation">,</span>  <span class="token number">1.0862</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.9599</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.7743</span><span class="token punctuation">,</span>  <span class="token number">0.6266</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0549</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2974</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">0.1917</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4739</span><span class="token punctuation">,</span>  <span class="token number">0.7873</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0852</span><span class="token punctuation">,</span>  <span class="token number">0.7285</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
 tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.3522</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9959</span><span class="token punctuation">,</span>  <span class="token number">0.7743</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0657</span><span class="token punctuation">,</span>  <span class="token number">0.7410</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">1.0032</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7840</span><span class="token punctuation">,</span>  <span class="token number">1.3015</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7870</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.2266</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.6390</span><span class="token punctuation">,</span>  <span class="token number">1.2833</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7296</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0134</span><span class="token punctuation">,</span>  <span class="token number">1.7116</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">0.6917</span><span class="token punctuation">,</span>  <span class="token number">0.4912</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1305</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4818</span><span class="token punctuation">,</span>  <span class="token number">1.1892</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">1.1557</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0748</span><span class="token punctuation">,</span>  <span class="token number">0.3242</span><span class="token punctuation">,</span>  <span class="token number">0.1298</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.5161</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

         <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.2560</span><span class="token punctuation">,</span>  <span class="token number">0.8743</span><span class="token punctuation">,</span>  <span class="token number">1.2870</span><span class="token punctuation">,</span>  <span class="token number">0.5588</span><span class="token punctuation">,</span>  <span class="token number">1.1015</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">0.5302</span><span class="token punctuation">,</span>  <span class="token number">0.3705</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.2066</span><span class="token punctuation">,</span>  <span class="token number">0.3593</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.7285</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.2280</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4420</span><span class="token punctuation">,</span>  <span class="token number">1.7271</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.2346</span><span class="token punctuation">,</span>  <span class="token number">1.0862</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.9599</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.7743</span><span class="token punctuation">,</span>  <span class="token number">0.6266</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0549</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2974</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">0.1917</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4739</span><span class="token punctuation">,</span>  <span class="token number">0.7873</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0852</span><span class="token punctuation">,</span>  <span class="token number">0.7285</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       grad_fn<span class="token operator">=</span><span class="token operator">&lt;</span>NativeBatchNormBackward<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_113"></a>使用</h3> 
<p>用的地方通常在一个全连接或者卷积层与激活函数中间，即 （全连接/卷积）—- BatchNorm —- 激活函数。但也有人说把 BatchNorm 放在激活函数后面效果更好，可以都试一下。</p> 
<h3><a id="BN_115"></a><strong>BN的作用</strong>：</h3> 
<ol><li><strong>加速训练</strong>：BN可以使得网络的训练速度更快。因为经过标准化后，权重的更新方向更加明确，可以使用更大的学习率进行训练。</li><li><strong>正则化效果</strong>：BN具有轻微的正则化效果，可以在一定程度上防止模型过拟合。</li><li><strong>允许使用各种激活函数</strong>：在没有BN之前，某些激活函数（如sigmoid和tanh）在深层网络中容易导致梯度消失或梯度爆炸。但使用BN后，这些问题得到了缓解，因为数据分布被标准化了。</li></ol> 
<h3><a id="_121"></a>为什么要用</h3> 
<p><strong>BN的作用</strong>：</p> 
<ol><li><strong>加速训练</strong>：BN可以使得网络的训练速度更快。因为经过标准化后，权重的更新方向更加明确，可以使用更大的学习率进行训练。</li><li><strong>正则化效果</strong>：BN具有轻微的正则化效果，可以在一定程度上防止模型过拟合。</li><li><strong>允许使用各种激活函数</strong>：在没有BN之前，某些激活函数（如sigmoid和tanh）在深层网络中容易导致梯度消失或梯度爆炸。但使用BN后，这些问题得到了缓解，因为数据分布被标准化了。</li></ol> 
<h3><a id="_127"></a>参考</h3> 
<p><a href="https://blog.csdn.net/qq_39777550/article/details/108038677?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-108038677-blog-91619977.pc_relevant_3mothn_strategy_recovery&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-108038677-blog-91619977.pc_relevant_3mothn_strategy_recovery&amp;utm_relevant_index=2">(31条消息) BatchNorm2d原理、作用及其pytorch中BatchNorm2d函数的参数讲解_LS_learner的博客-CSDN博客_batchnorm2d</a></p> 
<p><a href="https://blog.csdn.net/qq_24503095/article/details/103684069">(31条消息) pytorch中批量归一化BatchNorm1d和BatchNorm2d函数_小白827的博客-CSDN博客_batchnorm1d 2d</a></p> 
<p><a href="https://faiyer.gitee.io/post/ml-batchnormal.html#:~:text=%E6%94%B9%E8%BF%9B%E7%BD%91%E7%BB%9C%E6%AD%A3%E5%88%99%E5%8C%96%EF%BC%88Regularization%EF%BC%89%EF%BC%9A%E9%80%9A%E8%BF%87%20BatchNorm,%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%BD%91%E7%BB%9C%E5%9C%A8%E8%AE%AD%E7%BB%83%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E6%AF%8F%E4%B8%AA%20batch%20%E9%87%8C%E7%9A%84%E6%95%B0%E6%8D%AE%E8%A7%84%E8%8C%83%E5%8C%96%E9%83%BD%E6%98%AF%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%EF%BC%8C%E6%9C%89%E5%8A%A9%E4%BA%8E%E5%87%8F%E5%B0%91%E7%BD%91%E7%BB%9C%E8%BF%87%E6%8B%9F%E5%90%88%E3%80%82" rel="nofollow">BatchNorm 到底应该怎么用？ - 项脊轩的琵琶树 (gitee.io)</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f2ba0a03699ffb1b48b21c4ef510780d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">BGP知识</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5a9d71b9bed6d1a04a737561710985ab/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">llvm-dyn_cast模板函数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>