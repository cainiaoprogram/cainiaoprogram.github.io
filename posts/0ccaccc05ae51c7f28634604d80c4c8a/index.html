<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>solr8.4配置用户登录验证 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="solr8.4配置用户登录验证" />
<meta property="og:description" content="一、增加用户名称密码配置 进入目录：solr-8.4/server/etc目录下，增加user.properties文件。这个文件一会要配置到solr-jetty-context.xml文件中。
user.properties文件增加如下内容：
# 用户名：密码，权限 admin: admin123.,admin user: user123.,admin 二、配置solr-jetty-context.xml文件 在这个solr-8.4\server\contexts目录下只有一个文件，就是它了。打开文件，增加如下内容：
&lt;!-- 添加配置权限认证：在文件configure中添加获取用户文件的配置，内容如下： --&gt; &lt;Get name=&#34;securityHandler&#34;&gt; &lt;Set name=&#34;loginService&#34;&gt; &lt;New class=&#34;org.eclipse.jetty.security.HashLoginService&#34;&gt; &lt;!-- name与web.xml中realm-name一致即可 --&gt; &lt;Set name=&#34;name&#34;&gt;user-name&lt;/Set&gt; &lt;!-- user.properties与上面新建的文件保持同名即可 --&gt; &lt;Set name=&#34;config&#34;&gt;&lt;SystemProperty name=&#34;jetty.home&#34; default=&#34;.&#34;/&gt;/etc/user.properties&lt;/Set&gt; &lt;/New&gt; &lt;/Set&gt; &lt;/Get&gt; 添加后的整个文件内容如下：
&lt;?xml version=&#34;1.0&#34;?&gt; &lt;!DOCTYPE Configure PUBLIC &#34;-//Jetty//Configure//EN&#34; &#34;http://www.eclipse.org/jetty/configure_9_0.dtd&#34;&gt; &lt;Configure class=&#34;org.eclipse.jetty.webapp.WebAppContext&#34;&gt; &lt;Set name=&#34;contextPath&#34;&gt;&lt;Property name=&#34;hostContext&#34; default=&#34;/solr&#34;/&gt;&lt;/Set&gt; &lt;Set name=&#34;war&#34;&gt;&lt;Property name=&#34;jetty.base&#34;/&gt;/solr-webapp/webapp&lt;/Set&gt; &lt;Set name=&#34;defaultsDescriptor&#34;&gt;&lt;Property name=&#34;jetty.base&#34;/&gt;/etc/webdefault.xml&lt;/Set&gt; &lt;Set name=&#34;extractWAR&#34;&gt;false&lt;/Set&gt; &lt;!-- 添加配置权限认证：在文件configure中添加获取用户文件的配置，内容如下： --&gt; &lt;Get name=&#34;securityHandler&#34;&gt; &lt;Set name=&#34;loginService&#34;&gt; &lt;New class=&#34;org.eclipse.jetty.security.HashLoginService&#34;&gt; &lt;!-- name与web.xml中realm-name一致即可 --&gt; &lt;Set name=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0ccaccc05ae51c7f28634604d80c4c8a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-09T16:15:52+08:00" />
<meta property="article:modified_time" content="2024-01-09T16:15:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">solr8.4配置用户登录验证</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>一、增加用户名称密码配置</h4> 
<p>进入目录：<code>solr-8.4/server/etc</code>目录下，增加<code>user.properties</code>文件。这个文件一会要配置到<code>solr-jetty-context.xml</code>文件中。</p> 
<p>user.properties文件增加如下内容：</p> 
<blockquote> 
 <pre># 用户名：密码，权限
admin: admin123.,admin
user: user123.,admin</pre> 
</blockquote> 
<p></p> 
<h4>二、配置<code>solr-jetty-context.xml</code>文件</h4> 
<p>在这个<code>solr-8.4\server\contexts</code>目录下只有一个文件，就是它了。打开文件，增加如下内容：</p> 
<blockquote> 
 <pre>&lt;!-- 添加配置权限认证：在文件configure中添加获取用户文件的配置，内容如下： --&gt;
  &lt;Get name="securityHandler"&gt;
    &lt;Set name="loginService"&gt;
        &lt;New class="org.eclipse.jetty.security.HashLoginService"&gt;
            &lt;!-- name与web.xml中realm-name一致即可 --&gt;
            &lt;Set name="name"&gt;user-name&lt;/Set&gt;
            &lt;!-- user.properties与上面新建的文件保持同名即可 --&gt;
            &lt;Set name="config"&gt;&lt;SystemProperty name="jetty.home" default="."/&gt;/etc/user.properties&lt;/Set&gt;
        &lt;/New&gt;
    &lt;/Set&gt;
  &lt;/Get&gt;</pre> 
</blockquote> 
<p>添加后的整个文件内容如下：</p> 
<blockquote> 
 <pre>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure_9_0.dtd"&gt;
&lt;Configure class="org.eclipse.jetty.webapp.WebAppContext"&gt;
  &lt;Set name="contextPath"&gt;&lt;Property name="hostContext" default="/solr"/&gt;&lt;/Set&gt;
  &lt;Set name="war"&gt;&lt;Property name="jetty.base"/&gt;/solr-webapp/webapp&lt;/Set&gt;
  &lt;Set name="defaultsDescriptor"&gt;&lt;Property name="jetty.base"/&gt;/etc/webdefault.xml&lt;/Set&gt;
  &lt;Set name="extractWAR"&gt;false&lt;/Set&gt;
  
  &lt;!-- 添加配置权限认证：在文件configure中添加获取用户文件的配置，内容如下： --&gt;
  &lt;Get name="securityHandler"&gt;
    &lt;Set name="loginService"&gt;
        &lt;New class="org.eclipse.jetty.security.HashLoginService"&gt;
            &lt;!-- name与web.xml中realm-name一致即可 --&gt;
            &lt;Set name="name"&gt;user-name&lt;/Set&gt;
            &lt;!-- user.properties与上面新建的文件保持同名即可 --&gt;
            &lt;Set name="config"&gt;&lt;SystemProperty name="jetty.home" default="."/&gt;/etc/user.properties&lt;/Set&gt;
        &lt;/New&gt;
    &lt;/Set&gt;
  &lt;/Get&gt;
&lt;/Configure&gt;
​</pre> 
</blockquote> 
<p></p> 
<h4>三、配置<code>web.xml</code>文件</h4> 
<p>在这个<code>solr-8.4\server\solr-webapp\webapps\WEB-INF\</code>目录下的web.xml文件。</p> 
<p>找到<code>security-constraint</code>配置。内容如下：</p> 
<blockquote> 
 <pre>&lt;!-- Get rid of error message --&gt;
  &lt;security-constraint&gt;
    &lt;web-resource-collection&gt;
      &lt;web-resource-name&gt;Disable TRACE&lt;/web-resource-name&gt;
      &lt;url-pattern&gt;/&lt;/url-pattern&gt;
      &lt;http-method&gt;TRACE&lt;/http-method&gt;
    &lt;/web-resource-collection&gt;
    &lt;auth-constraint/&gt;
  &lt;/security-constraint&gt;
  &lt;security-constraint&gt;
    &lt;web-resource-collection&gt;
      &lt;web-resource-name&gt;Enable everything but TRACE&lt;/web-resource-name&gt;
      &lt;url-pattern&gt;/&lt;/url-pattern&gt;
      &lt;http-method-omission&gt;TRACE&lt;/http-method-omission&gt;
    &lt;/web-resource-collection&gt;
  &lt;/security-constraint&gt;</pre> 
</blockquote> 
<p>在这些内容后面新增加一些内容，原有内容不能删除，否则会导致登录的配置无效。增加的内容如下：</p> 
<blockquote> 
 <pre>  &lt;!--重新配置 security-resource-collection （删除之前的security-constraint，会导致登录的配置无效）--&gt;
  &lt;security-constraint&gt;
    &lt;web-resource-collection&gt;
      &lt;web-resource-name&gt;Solr&lt;/web-resource-name&gt;
      &lt;url-pattern&gt;/&lt;/url-pattern&gt;
    &lt;/web-resource-collection&gt;   
     &lt;auth-constraint&gt;
        &lt;role-name&gt;admin&lt;/role-name&gt; 
     &lt;/auth-constraint&gt; 
  &lt;/security-constraint&gt;
​
  &lt;login-config&gt;      
    &lt;auth-method&gt;BASIC&lt;/auth-method&gt; 
    &lt;realm-name&gt;user-name&lt;/realm-name&gt;   
  &lt;/login-config&gt;</pre> 
</blockquote> 
<p>到此就配置完成了。接下来启动solr，即可生效。启动命令如下<code>solr-8.4/bin/</code>：</p> 
<blockquote> 
 <pre>./solr start -force</pre> 
</blockquote> 
<p></p> 
<h4>四、项目调用修改配置</h4> 
<p>登录权限增加完之后，代码调用的url要做相应改变。增加用户名密码</p> 
<blockquote> 
 <pre># http://user:pass@localhost:8088/solr/
http://admin:admin123.@localhost:8088/solr/</pre> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/030f4b1656b5aa20f4f97cdfe7fed067/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SQL EXISTS 运算符</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9a222d3d3108871978e28c321af4dad6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL半同步复制</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>