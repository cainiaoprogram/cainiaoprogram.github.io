<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python中parsel模块的css解析 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python中parsel模块的css解析" />
<meta property="og:description" content="一、爬虫页面分类 1.想要爬取的内容全部在标签中，可以使用xpath去进行解析如下图 2.想要爬取的内容呈现json的数据特征，用.json()转换为字典格式 3.页面不规则，标签中包含大括号，如下面想要获取键值内容怎么做，先用re正则获取大括号内容，再转换为json格式 4.想要爬取的页面数据很零散，建议使用css选择器，如下图，想要猫咪的年龄，品种，是否接种疫苗，是否支持视频看猫等信息 二、css解析步骤： import parsel html_data = requests.get(url,headers).text selector = parsel.Selector(html_data) content = selector.css(&#39;css格式&#39;) 实例化一个selector对象 css格式总结：
.代表class #代表id ::text 表示输出文本（即尖括号里面的内容） nth-child(page)表示匹配第page项 例子：
div 返回的是全部div标签
div.content 返回的是class = &#39;content&#39;的整个div标签
div.content #su 返回的是class = &#39;content&#39;的整个div标签下id = &#39;su&#39;的标签
div.content li 返回的是class = &#39;content&#39;的整个div标签下的li标签
div.content li:nth-child(1)返回的是class = &#39;content&#39;的整个div标签下的li标签中的第一个li标签
div.content li:nth-child(1)::text返回的是class = &#39;content&#39;的整个div标签下的li标签中的第一个li标签中的文本数据
div.content li:nth-child(1)::attr(href)返回的是class = &#39;content&#39;的整个div标签下的li标签中的第一个li标签,其中的href所对应的属性值
selector.css(&#39;css样式&#39;).get() 获得一个匹配的
selector.css(&#39;css样式&#39;).getall()获得多个匹配的
可以在开发者工具中尝试：
定位要爬取的数据，在elements中ctrl&#43;f出现
如想爬取在售只数应该怎么写：
import parsel import requests url = &#39;http://maomijiaoyi.com/index.php?/chanpinxiangqing_1038711.html&#39; headers = {&#39;User-Agent&#39;: &#39;Mozilla/5." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ead6371f23d4a7ee4c19c5bd702a5a79/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-06T19:43:01+08:00" />
<meta property="article:modified_time" content="2024-01-06T19:43:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python中parsel模块的css解析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>一、爬虫页面分类</h3> 
<h5><br> 1.想要爬取的内容全部在标签中，可以使用xpath去进行解析如下图</h5> 
<p><img alt="" height="418" src="https://images2.imgbox.com/09/fa/6vYcpooN_o.png" width="634"></p> 
<h5>2.想要爬取的内容呈现json的数据特征，用.json()转换为字典格式</h5> 
<p><img alt="" height="328" src="https://images2.imgbox.com/9e/3a/mdq8TYAR_o.png" width="938"></p> 
<h5>3.页面不规则，标签中包含大括号，如下面想要获取键值内容怎么做，先用re正则获取大括号内容，再转换为json格式</h5> 
<p><img alt="" height="468" src="https://images2.imgbox.com/3a/fd/AKW1D5IJ_o.png" width="867"></p> 
<p><img alt="" height="260" src="https://images2.imgbox.com/76/3d/zeBUNWx6_o.png" width="812"></p> 
<h5>4.想要爬取的页面数据很零散，建议使用css选择器，如下图，想要猫咪的年龄，品种，是否接种疫苗，是否支持视频看猫等信息</h5> 
<p><img alt="" height="775" src="https://images2.imgbox.com/e3/7d/W3KfNdXE_o.png" width="1200"></p> 
<h3>二、css解析步骤：</h3> 
<pre><code class="language-python">import parsel
html_data = requests.get(url,headers).text
selector = parsel.Selector(html_data)
content = selector.css('css格式')
</code></pre> 
<p>实例化一个selector对象 </p> 
<p>css格式总结：</p> 
<p>.代表class  #代表id  ::text 表示输出文本（即尖括号里面的内容） nth-child(page)表示匹配第page项    </p> 
<p>例子：</p> 
<p>div 返回的是全部div标签</p> 
<p>div.content 返回的是class = 'content'的整个div标签</p> 
<p>div.content  #su 返回的是class = 'content'的整个div标签下id = 'su'的标签</p> 
<p>div.content li 返回的是class = 'content'的整个div标签下的li标签</p> 
<p>div.content li:nth-child(1)返回的是class = 'content'的整个div标签下的li标签中的第一个li标签</p> 
<p>div.content li:nth-child(1)::text返回的是class = 'content'的整个div标签下的li标签中的第一个li标签中的文本数据</p> 
<p>div.content li:nth-child(1)::attr(href)返回的是class = 'content'的整个div标签下的li标签中的第一个li标签,其中的href所对应的属性值</p> 
<p></p> 
<p>selector.css('css样式').get() 获得一个匹配的</p> 
<p>selector.css('css样式').getall()获得多个匹配的</p> 
<p>可以在开发者工具中尝试：</p> 
<p>定位要爬取的数据，在elements中ctrl+f出现</p> 
<p><img alt="" height="449" src="https://images2.imgbox.com/8d/5e/Lb0erdcw_o.png" width="1200"></p> 
<p>如想爬取在售只数应该怎么写：</p> 
<p><img alt="" height="156" src="https://images2.imgbox.com/88/f2/QgkUo0nC_o.png" width="467"></p> 
<pre><code class="language-python">import parsel
import requests
url = 'http://maomijiaoyi.com/index.php?/chanpinxiangqing_1038711.html'
headers = {'User-Agent':
                               'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36',
                           }
response = requests.get(url=url,headers=headers)
response.encoding = response.apparent_encoding

selector = parsel.Selector(response.text)
num = selector.css('.info2 div:nth-child(1) div.red::text').get()# 获取在售只数</code></pre> 
<p>获得下图src的属性值：</p> 
<p><img alt="" height="208" src="https://images2.imgbox.com/56/e6/sc5ptY0d_o.png" width="614"> </p> 
<pre><code class="language-python">src = selector.css('div.button div.tel img::attr(src)').get()</code></pre> 
<p> 注意，编写css时，要像树一样，一层一层找，不能跳的太远，否则会出错</p> 
<h3> 三、在selenimu中用css选择器：代码展现</h3> 
<pre><code class="language-python">from selenium import webdriver
import parsel
import requests
path = 'chromedriver.exe'
broswer = webdriver.Chrome(path)

url = 'http://maomijiaoyi.com/index.php?/chanpinliebiao_c_2.html'
headers = {'User-Agent':
                               'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36',
                           }
broswer.get(url)

for page in range(1,25):
    selector = broswer.find_element_by_css_selector(f'#content &gt; div.breeds_floor &gt; div &gt; div &gt; a:nth-child({page}) &gt; div.img &gt; img')
    url = selector.get_attribute('src')
    print(url)

'''
筛选标签，与css语法一致，不会可以复制，以selector方式复制。find_element_by_css_selector返回的是一个标签，find_elements_by_css_selector返回的是多个标签
获取标签的属性值用selector.get_attribute方法

'''
lis = browser.find_elements_by_css_selector('.Content li')  # 获取class=Content的ul的下面所有的li标签
for li in lis:
    bs = li.find_elements_by_css_selector('b') # 在li标签中找b标签
    for b in bs:
        print(bs.text)# 获取b标签的文本值</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/64783d9911e4dc30c89e10c686f434a3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于web3&#43;solidity的众筹项目</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/48c3f6f09bafbe81d189a333ce439ca7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2024年阿里云、腾讯云、华为云、LightNode、硅云服务器如何选？怎么买最划算？[最新价格表]</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>