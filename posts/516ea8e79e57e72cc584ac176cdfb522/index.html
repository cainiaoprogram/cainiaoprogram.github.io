<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python å®ç°ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œï¼ˆé™„ä»£ç ï¼‰ - èœé¸Ÿç¨‹åºå‘˜åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python å®ç°ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œï¼ˆé™„ä»£ç ï¼‰" />
<meta property="og:description" content="ç›®å½•
â­å‰è¨€â­
â­ç –å—ï¼šç¥ç»å…ƒâ­
ğŸ“Œä¸€ä¸ªç®€å•çš„ä¾‹å­ğŸ“Œ
ğŸ“Œç¼–ç ä¸€ä¸ªç¥ç»å…ƒ ğŸ“Œ
ğŸ“ŒæŠŠç¥ç»å…ƒç»„è£…æˆç½‘ç»œ ğŸ“Œ
ğŸ“Œä¾‹å­ï¼šå‰é¦ˆğŸ“Œ
ğŸ“Œç¼–ç ç¥ç»ç½‘ç»œï¼šå‰é¦ˆğŸ“Œ
ğŸ“Œè®­ç»ƒç¥ç»ç½‘ç»œ ç¬¬ä¸€éƒ¨åˆ†ğŸ“Œ
ğŸ“ŒæŸå¤±ğŸ“Œ
ğŸ“ŒæŸå¤±è®¡ç®—ä¾‹å­ğŸ“Œ
ğŸ“Œä»£ç ï¼šMSEæŸå¤±ğŸ“Œ
ğŸ“Œè®­ç»ƒç¥ç»ç½‘ç»œ ç¬¬äºŒéƒ¨åˆ†ğŸ“Œ
ğŸ“Œä¾‹å­ï¼šè®¡ç®—åå¯¼æ•°ğŸ“Œ
ğŸ“Œä»£ç ï¼šä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œğŸ“Œ
ğŸ“Œåè¯ğŸ“Œ
â­å‰è¨€â­ ä»¥ä¸‹å†…å®¹æˆ‘ä»¬ç”¨Pythonä»å¤´å®ç°ä¸€ä¸ªç¥ç»ç½‘ç»œæ¥ç†è§£ç¥ç»ç½‘ç»œçš„åŸç†ã€‚
é¦–å…ˆè®©æˆ‘ä»¬çœ‹çœ‹ç¥ç»ç½‘ç»œçš„åŸºæœ¬å•ä½ï¼Œç¥ç»å…ƒã€‚ç¥ç»å…ƒæ¥å—è¾“å…¥ï¼Œå¯¹å…¶åšä¸€äº›æ•°æ®æ“ä½œï¼Œç„¶åäº§ç”Ÿè¾“å‡ºã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯ä¸€ä¸ª2-è¾“å…¥ç¥ç»å…ƒï¼š
è¿™é‡Œå‘ç”Ÿäº†ä¸‰ä¸ªäº‹æƒ…ã€‚é¦–å…ˆï¼Œæ¯ä¸ªè¾“å…¥éƒ½è·Ÿä¸€ä¸ªæƒé‡ç›¸ä¹˜ï¼ˆçº¢è‰²ï¼‰ï¼š
ç„¶åï¼ŒåŠ æƒåçš„è¾“å…¥æ±‚å’Œï¼ŒåŠ ä¸Šä¸€ä¸ªåå·®bï¼ˆç»¿è‰²ï¼‰ï¼š
æœ€åï¼Œè¿™ä¸ªç»“æœä¼ é€’ç»™ä¸€ä¸ªæ¿€æ´»å‡½æ•°fï¼š
æ¿€æ´»å‡½æ•°çš„ç”¨é€”æ˜¯å°†ä¸€ä¸ªæ— è¾¹ç•Œçš„è¾“å…¥ï¼Œè½¬å˜æˆä¸€ä¸ªå¯é¢„æµ‹çš„å½¢å¼ã€‚å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°å°±å°±æ˜¯Så‹å‡½æ•°ï¼š
Så‹å‡½æ•°çš„å€¼åŸŸæ˜¯(0, 1)ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æŠŠ(âˆ’âˆ, &#43;âˆ)å‹ç¼©åˆ°(0, 1) ï¼Œå¾ˆå¤§çš„è´Ÿæ•°çº¦ç­‰äº0ï¼Œå¾ˆå¤§çš„æ­£æ•°çº¦ç­‰äº1ã€‚
ğŸ“Œä¸€ä¸ªç®€å•çš„ä¾‹å­ğŸ“Œ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç¥ç»å…ƒï¼Œæ¿€æ´»å‡½æ•°å°±æ˜¯Så‹å‡½æ•°ï¼Œå…¶å‚æ•°å¦‚ä¸‹ï¼š
w=[0,1]ï¼Œb=4
w=[0,1]å°±æ˜¯ä»¥å‘é‡çš„å½¢å¼è¡¨ç¤ºw1=0ï¼Œw2=1ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬ç»™è¿™ä¸ªç¥ç»å…ƒä¸€ä¸ªè¾“å…¥[2,3]ã€‚æˆ‘ä»¬ç”¨ç‚¹ç§¯æ¥è¡¨ç¤ºï¼š
å½“è¾“å…¥æ˜¯[2, 3]æ—¶ï¼Œè¿™ä¸ªç¥ç»å…ƒçš„è¾“å‡ºæ˜¯0.999ã€‚ç»™å®šè¾“å…¥ï¼Œå¾—åˆ°è¾“å‡ºçš„è¿‡ç¨‹è¢«ç§°ä¸ºå‰é¦ˆï¼ˆfeedforwardï¼‰ã€‚
ğŸ“Œç¼–ç ä¸€ä¸ªç¥ç»å…ƒ ğŸ“Œ è®©æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç¥ç»å…ƒï¼ç”¨Pythonçš„NumPyåº“æ¥å®Œæˆå…¶ä¸­çš„æ•°å­¦è®¡ç®—ï¼š
import numpy as np def sigmoid(x): # æˆ‘ä»¬çš„æ¿€æ´»å‡½æ•°: f(x) = 1 / (1 &#43; e^(-x)) return 1 / (1 &#43; np.exp(-x)) class Neuron: def __init__(self, weights, bias): self.weights = weights self." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/516ea8e79e57e72cc584ac176cdfb522/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-04T15:43:22+08:00" />
<meta property="article:modified_time" content="2022-07-04T15:43:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="èœé¸Ÿç¨‹åºå‘˜åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">èœé¸Ÿç¨‹åºå‘˜åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python å®ç°ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œï¼ˆé™„ä»£ç ï¼‰</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <hr> 
<p><strong>ç›®å½•</strong></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t0">â­å‰è¨€â­</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t1">â­ç –å—ï¼šç¥ç»å…ƒâ­</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t2">ğŸ“Œä¸€ä¸ªç®€å•çš„ä¾‹å­ğŸ“Œ</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t3">ğŸ“Œç¼–ç ä¸€ä¸ªç¥ç»å…ƒ ğŸ“Œ</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t4">ğŸ“ŒæŠŠç¥ç»å…ƒç»„è£…æˆç½‘ç»œ ğŸ“Œ</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t5">ğŸ“Œä¾‹å­ï¼šå‰é¦ˆğŸ“Œ</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t6">ğŸ“Œç¼–ç ç¥ç»ç½‘ç»œï¼šå‰é¦ˆğŸ“Œ</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t7">ğŸ“Œè®­ç»ƒç¥ç»ç½‘ç»œ ç¬¬ä¸€éƒ¨åˆ†ğŸ“Œ</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t8">ğŸ“ŒæŸå¤±ğŸ“Œ</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t9">ğŸ“ŒæŸå¤±è®¡ç®—ä¾‹å­ğŸ“Œ</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t10">ğŸ“Œä»£ç ï¼šMSEæŸå¤±ğŸ“Œ</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t11">ğŸ“Œè®­ç»ƒç¥ç»ç½‘ç»œ ç¬¬äºŒéƒ¨åˆ†ğŸ“Œ</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t12">ğŸ“Œä¾‹å­ï¼šè®¡ç®—åå¯¼æ•°ğŸ“Œ</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t13">ğŸ“Œä»£ç ï¼šä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œğŸ“Œ</a></p> 
<p><a href="https://blog.csdn.net/weixin_43734080/article/details/122212654#t14">ğŸ“Œåè¯ğŸ“Œ</a></p> 
<hr> 
<h3><a id="_37"></a>â­å‰è¨€â­</h3> 
<p>ä»¥ä¸‹å†…å®¹æˆ‘ä»¬ç”¨Pythonä»å¤´å®ç°ä¸€ä¸ª<a href="https://so.csdn.net/so/search?q=%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C&amp;spm=1001.2101.3001.7020">ç¥ç»ç½‘ç»œ</a>æ¥ç†è§£ç¥ç»ç½‘ç»œçš„åŸç†ã€‚</p> 
<p>é¦–å…ˆè®©æˆ‘ä»¬çœ‹çœ‹ç¥ç»ç½‘ç»œçš„åŸºæœ¬å•ä½ï¼Œ<a href="https://so.csdn.net/so/search?q=%E7%A5%9E%E7%BB%8F%E5%85%83&amp;spm=1001.2101.3001.7020">ç¥ç»å…ƒ</a>ã€‚ç¥ç»å…ƒæ¥å—è¾“å…¥ï¼Œå¯¹å…¶åšä¸€äº›æ•°æ®æ“ä½œï¼Œç„¶åäº§ç”Ÿè¾“å‡ºã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯ä¸€ä¸ª2-è¾“å…¥ç¥ç»å…ƒï¼š</p> 
<p><img src="https://images2.imgbox.com/9a/02/OOhvpVqP_o.png" alt="å›¾ç‰‡"></p> 
<p>è¿™é‡Œå‘ç”Ÿäº†ä¸‰ä¸ªäº‹æƒ…ã€‚é¦–å…ˆï¼Œæ¯ä¸ªè¾“å…¥éƒ½è·Ÿä¸€ä¸ªæƒé‡ç›¸ä¹˜ï¼ˆçº¢è‰²ï¼‰ï¼š</p> 
<p><img src="https://images2.imgbox.com/c6/3f/MZE2lqKW_o.png" alt="x_1\leftarrow x_1\times w_1"></p> 
<p><img src="https://images2.imgbox.com/76/11/Wf20cgaO_o.png" alt="x_2\leftarrow x_2\times w_2"></p> 
<p>ç„¶åï¼ŒåŠ æƒåçš„è¾“å…¥æ±‚å’Œï¼ŒåŠ ä¸Šä¸€ä¸ªåå·®bï¼ˆç»¿è‰²ï¼‰ï¼š</p> 
<p><img src="https://images2.imgbox.com/a4/3d/86hVsxXe_o.png" alt="(x_1\times w_1)+(x_2\times w_2)+b"></p> 
<p>æœ€åï¼Œè¿™ä¸ªç»“æœä¼ é€’ç»™ä¸€ä¸ªæ¿€æ´»å‡½æ•°fï¼š</p> 
<p><img src="https://images2.imgbox.com/e2/60/R9p3sp8o_o.png" alt="y=f(x_1\times w_1+x_2\times w_2+b)"></p> 
<p>æ¿€æ´»å‡½æ•°çš„ç”¨é€”æ˜¯å°†ä¸€ä¸ªæ— è¾¹ç•Œçš„è¾“å…¥ï¼Œè½¬å˜æˆä¸€ä¸ªå¯é¢„æµ‹çš„å½¢å¼ã€‚å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°å°±å°±æ˜¯Så‹å‡½æ•°ï¼š</p> 
<p><img src="https://images2.imgbox.com/92/ef/4l1grvnQ_o.png" alt="å›¾ç‰‡"></p> 
<p>Så‹å‡½æ•°çš„å€¼åŸŸæ˜¯(0, 1)ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æŠŠ(âˆ’âˆ, +âˆ)å‹ç¼©åˆ°(0, 1) ï¼Œå¾ˆå¤§çš„è´Ÿæ•°çº¦ç­‰äº0ï¼Œå¾ˆå¤§çš„æ­£æ•°çº¦ç­‰äº1ã€‚</p> 
<h3><a id="_65"></a>ğŸ“Œä¸€ä¸ªç®€å•çš„ä¾‹å­ğŸ“Œ</h3> 
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç¥ç»å…ƒï¼Œæ¿€æ´»å‡½æ•°å°±æ˜¯Så‹å‡½æ•°ï¼Œå…¶å‚æ•°å¦‚ä¸‹ï¼š</p> 
<p>w=[0,1]ï¼Œb=4</p> 
<p>w=[0,1]å°±æ˜¯ä»¥å‘é‡çš„å½¢å¼è¡¨ç¤ºw1=0ï¼Œw2=1ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬ç»™è¿™ä¸ªç¥ç»å…ƒä¸€ä¸ªè¾“å…¥[2,3]ã€‚æˆ‘ä»¬ç”¨ç‚¹ç§¯æ¥è¡¨ç¤ºï¼š</p> 
<p><img src="https://images2.imgbox.com/35/46/xd5q0Jjr_o.png" alt="y=f(w\cdot x+b)=f(7)=0.999"></p> 
<p>å½“è¾“å…¥æ˜¯[2, 3]æ—¶ï¼Œè¿™ä¸ªç¥ç»å…ƒçš„è¾“å‡ºæ˜¯0.999ã€‚ç»™å®šè¾“å…¥ï¼Œå¾—åˆ°è¾“å‡ºçš„è¿‡ç¨‹è¢«ç§°ä¸ºå‰é¦ˆï¼ˆfeedforwardï¼‰ã€‚</p> 
<h3><a id="__77"></a>ğŸ“Œç¼–ç ä¸€ä¸ªç¥ç»å…ƒ ğŸ“Œ</h3> 
<p>è®©æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç¥ç»å…ƒï¼ç”¨Pythonçš„NumPyåº“æ¥å®Œæˆå…¶ä¸­çš„æ•°å­¦è®¡ç®—ï¼š</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
 
<span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># æˆ‘ä»¬çš„æ¿€æ´»å‡½æ•°: f(x) = 1 / (1 + e^(-x))</span>
  <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token keyword">class</span> <span class="token class-name">Neuron</span><span class="token punctuation">:</span>
  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> bias<span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>weights <span class="token operator">=</span> weights
    self<span class="token punctuation">.</span>bias <span class="token operator">=</span> bias
 
  <span class="token keyword">def</span> <span class="token function">feedforward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># åŠ æƒè¾“å…¥ï¼ŒåŠ å…¥åç½®ï¼Œç„¶åä½¿ç”¨æ¿€æ´»å‡½æ•°</span>
    total <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>self<span class="token punctuation">.</span>weights<span class="token punctuation">,</span> inputs<span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>bias
    <span class="token keyword">return</span> sigmoid<span class="token punctuation">(</span>total<span class="token punctuation">)</span>
 
weights <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># w1 = 0, w2 = 1</span>
bias <span class="token operator">=</span> <span class="token number">4</span>                   <span class="token comment"># b = 4</span>
n <span class="token operator">=</span> Neuron<span class="token punctuation">(</span>weights<span class="token punctuation">,</span> bias<span class="token punctuation">)</span>
 
x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>       <span class="token comment"># x1 = 2, x2 = 3</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>feedforward<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># 0.9990889488055994</span>

</code></pre> 
<h3><a id="__107"></a>ğŸ“ŒæŠŠç¥ç»å…ƒç»„è£…æˆç½‘ç»œ ğŸ“Œ</h3> 
<p>æ‰€è°“çš„ç¥ç»ç½‘ç»œå°±æ˜¯ä¸€å †ç¥ç»å…ƒã€‚è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œï¼š</p> 
<p><img src="https://images2.imgbox.com/40/3a/PiFDTgwe_o.png" alt="å›¾ç‰‡"></p> 
<p>è¿™ä¸ªç½‘ç»œæœ‰ä¸¤ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªæœ‰ä¸¤ä¸ªç¥ç»å…ƒï¼ˆ <img src="https://images2.imgbox.com/6f/fb/wsIXbO9V_o.png" alt="h_1">å’Œ <img src="https://images2.imgbox.com/97/64/LUSOBBjT_o.png" alt="h_2">ï¼‰çš„éšè—å±‚ï¼Œä»¥åŠä¸€ä¸ªæœ‰ä¸€ä¸ªç¥ç»å…ƒï¼ˆ<img src="https://images2.imgbox.com/2e/a8/fGnKpt4q_o.png" alt="o_1"> ) ï¼‰çš„è¾“å‡ºå±‚ã€‚è¦æ³¨æ„ï¼Œ<img src="https://images2.imgbox.com/7b/1b/8q9eV1ds_o.png" alt="o_1">çš„è¾“å…¥å°±æ˜¯<img src="https://images2.imgbox.com/07/d5/v4oYjA28_o.png" alt="h_1">å’Œ<img src="https://images2.imgbox.com/66/a0/iLfMsUYt_o.png" alt="h_2">çš„è¾“å‡ºï¼Œè¿™æ ·å°±ç»„æˆäº†ä¸€ä¸ªç½‘ç»œã€‚</p> 
<blockquote> 
 <p>éšè—å±‚å°±æ˜¯è¾“å…¥å±‚å’Œè¾“å‡ºå±‚ä¹‹é—´çš„å±‚ï¼Œéšè—å±‚å¯ä»¥æ˜¯å¤šå±‚çš„ã€‚</p> 
</blockquote> 
<h3><a id="_117"></a>ğŸ“Œä¾‹å­ï¼šå‰é¦ˆğŸ“Œ</h3> 
<p>æˆ‘ä»¬ç»§ç»­ç”¨å‰é¢å›¾ä¸­çš„ç½‘ç»œï¼Œå‡è®¾æ¯ä¸ªç¥ç»å…ƒçš„æƒé‡éƒ½æ˜¯ ï¼Œæˆªè·é¡¹ä¹Ÿç›¸åŒ ï¼Œæ¿€æ´»å‡½æ•°ä¹Ÿéƒ½æ˜¯Så‹å‡½æ•°ã€‚åˆ†åˆ«ç”¨ è¡¨ç¤ºç›¸åº”çš„ç¥ç»å…ƒçš„è¾“å‡ºã€‚</p> 
<p>å½“è¾“å…¥ x=[2,3]æ—¶ï¼Œä¼šå¾—åˆ°ä»€ä¹ˆç»“æœï¼Ÿ</p> 
<p>è¿™ä¸ªç¥ç»ç½‘ç»œå¯¹è¾“å…¥[2,3]çš„è¾“å‡ºæ˜¯0.7216ï¼Œå¾ˆç®€å•ã€‚</p> 
<h3><a id="_125"></a>ğŸ“Œç¼–ç ç¥ç»ç½‘ç»œï¼šå‰é¦ˆğŸ“Œ</h3> 
<p><img src="https://images2.imgbox.com/ed/44/2wQCZhGu_o.png" alt="å›¾ç‰‡"></p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
 
<span class="token comment"># ... code from previous section here</span>
 
<span class="token keyword">class</span> <span class="token class-name">OurNeuralNetwork</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">'''
  A neural network with:
    - 2 inputs
    - a hidden layer with 2 neurons (h1, h2)
    - an output layer with 1 neuron (o1)
  Each neuron has the same weights and bias:
    - w = [0, 1]
    - b = 0
  '''</span>
  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    weights <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    bias <span class="token operator">=</span> <span class="token number">0</span>
 
    <span class="token comment"># è¿™é‡Œæ˜¯æ¥è‡ªå‰ä¸€èŠ‚çš„ç¥ç»å…ƒç±»</span>
    self<span class="token punctuation">.</span>h1 <span class="token operator">=</span> Neuron<span class="token punctuation">(</span>weights<span class="token punctuation">,</span> bias<span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>h2 <span class="token operator">=</span> Neuron<span class="token punctuation">(</span>weights<span class="token punctuation">,</span> bias<span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>o1 <span class="token operator">=</span> Neuron<span class="token punctuation">(</span>weights<span class="token punctuation">,</span> bias<span class="token punctuation">)</span>
 
  <span class="token keyword">def</span> <span class="token function">feedforward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    out_h1 <span class="token operator">=</span> self<span class="token punctuation">.</span>h1<span class="token punctuation">.</span>feedforward<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    out_h2 <span class="token operator">=</span> self<span class="token punctuation">.</span>h2<span class="token punctuation">.</span>feedforward<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
 
    <span class="token comment"># o1çš„è¾“å…¥æ˜¯h1å’Œh2çš„è¾“å‡º</span>
    out_o1 <span class="token operator">=</span> self<span class="token punctuation">.</span>o1<span class="token punctuation">.</span>feedforward<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>out_h1<span class="token punctuation">,</span> out_h2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
    <span class="token keyword">return</span> out_o1
 
network <span class="token operator">=</span> OurNeuralNetwork<span class="token punctuation">(</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>network<span class="token punctuation">.</span>feedforward<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 0.7216325609518421</span>
</code></pre> 
<p>ç»“æœæ­£ç¡®ï¼Œçœ‹ä¸Šå»æ²¡é—®é¢˜ã€‚</p> 
<h3><a id="__169"></a>ğŸ“Œè®­ç»ƒç¥ç»ç½‘ç»œ ç¬¬ä¸€éƒ¨åˆ†ğŸ“Œ</h3> 
<p>ç°åœ¨æœ‰è¿™æ ·çš„æ•°æ®ï¼š</p> 
<table><thead><tr><th>å§“å</th><th>ä½“é‡(ç£…)</th><th>èº«é«˜ (è‹±å¯¸)</th><th>æ€§åˆ«</th></tr></thead><tbody><tr><td>Alice</td><td>133</td><td>65</td><td>F</td></tr><tr><td>Bob</td><td>160</td><td>72</td><td>M</td></tr><tr><td>Charlie</td><td>152</td><td>70</td><td>M</td></tr><tr><td>Diana</td><td>120</td><td>60</td><td>F</td></tr></tbody></table> 
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨è¿™ä¸ªæ•°æ®æ¥è®­ç»ƒç¥ç»ç½‘ç»œçš„æƒé‡å’Œæˆªè·é¡¹ï¼Œä»è€Œå¯ä»¥æ ¹æ®èº«é«˜ä½“é‡é¢„æµ‹æ€§åˆ«ï¼š</p> 
<p><img src="https://images2.imgbox.com/ae/88/uucj2ppz_o.png" alt="å›¾ç‰‡"></p> 
<p>æˆ‘ä»¬ç”¨0å’Œ1åˆ†åˆ«è¡¨ç¤ºç”·æ€§ï¼ˆMï¼‰å’Œå¥³æ€§ï¼ˆFï¼‰ï¼Œå¹¶å¯¹æ•°å€¼åšäº†è½¬åŒ–ï¼š</p> 
<table><thead><tr><th>å§“å</th><th>ä½“é‡ (å‡ 135)</th><th>èº«é«˜ (å‡ 66)</th><th>æ€§åˆ«</th></tr></thead><tbody><tr><td>Alice</td><td>-2</td><td>-1</td><td>1</td></tr><tr><td>Bob</td><td>25</td><td>6</td><td>0</td></tr><tr><td>Charlie</td><td>17</td><td>4</td><td>0</td></tr><tr><td>Diana</td><td>-15</td><td>-6</td><td>1</td></tr></tbody></table> 
<blockquote> 
 <p>æˆ‘è¿™é‡Œæ˜¯éšæ„é€‰å–äº†135å’Œ66æ¥æ ‡å‡†åŒ–æ•°æ®ï¼Œé€šå¸¸ä¼šä½¿ç”¨å¹³å‡å€¼ã€‚</p> 
</blockquote> 
<h3><a id="_195"></a>ğŸ“ŒæŸå¤±ğŸ“Œ</h3> 
<p>åœ¨è®­ç»ƒç½‘ç»œä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦é‡åŒ–å½“å‰çš„ç½‘ç»œæ˜¯ã€å¥½ã€è¿˜æ˜¯ã€åã€ï¼Œä»è€Œå¯ä»¥å¯»æ‰¾æ›´å¥½çš„ç½‘ç»œã€‚è¿™å°±æ˜¯å®šä¹‰æŸå¤±çš„ç›®çš„ã€‚</p> 
<p>æˆ‘ä»¬åœ¨è¿™é‡Œç”¨å¹³å‡æ–¹å·®ï¼ˆMSEï¼‰æŸå¤±ï¼š ï¼Œè®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹ï¼š</p> 
<ul><li> <p>næ˜¯æ ·å“æ•°ï¼Œè¿™é‡Œç­‰äº4ï¼ˆAliceã€Bobã€Charlieå’ŒDianaï¼‰ã€‚</p> </li><li> <p>yè¡¨ç¤ºè¦é¢„æµ‹çš„å˜é‡ï¼Œè¿™é‡Œæ˜¯æ€§åˆ«ã€‚</p> </li><li> <p><img src="https://images2.imgbox.com/0f/c8/yiwCAaxV_o.png" alt="y_{true}">æ˜¯å˜é‡çš„çœŸå®å€¼ï¼ˆã€æ­£ç¡®ç­”æ¡ˆã€ï¼‰ã€‚ä¾‹å¦‚ï¼ŒAliceçš„<img src="https://images2.imgbox.com/1a/76/lc8N5QFj_o.png" alt="y_{true}">å°±æ˜¯1ï¼ˆç”·æ€§)ã€‚</p> </li><li> <p><img src="https://images2.imgbox.com/76/e2/R8UzDRpp_o.png" alt="y_{pred}">å˜é‡çš„é¢„æµ‹å€¼ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ç½‘ç»œçš„è¾“å‡ºã€‚</p> </li></ul> 
<p><img src="https://images2.imgbox.com/7a/14/IoDWoggv_o.png" alt="(y_{true}-y_{pred})^{2}">è¢«ç§°ä¸ºæ–¹å·®ï¼ˆsquared errorï¼‰ã€‚æˆ‘ä»¬çš„æŸå¤±å‡½æ•°å°±æ˜¯æ‰€æœ‰æ–¹å·®çš„å¹³å‡å€¼ã€‚é¢„æµ‹æ•ˆæœäºæµ©ï¼ŒæŸå¤±å°±è¶Šå°‘ã€‚</p> 
<p>æ›´å¥½çš„é¢„æµ‹ = æ›´å°‘çš„æŸå¤±ï¼</p> 
<p>è®­ç»ƒç½‘ç»œ = æœ€å°åŒ–å®ƒçš„æŸå¤±ã€‚</p> 
<h3><a id="_216"></a>ğŸ“ŒæŸå¤±è®¡ç®—ä¾‹å­ğŸ“Œ</h3> 
<p>å‡è®¾æˆ‘ä»¬çš„ç½‘ç»œæ€»æ˜¯è¾“å‡º0ï¼Œæ¢è¨€ä¹‹å°±æ˜¯è®¤ä¸ºæ‰€æœ‰äººéƒ½æ˜¯ç”·æ€§ã€‚æŸå¤±å¦‚ä½•ï¼Ÿ</p> 
<table><thead><tr><th>Name</th><th>y_true</th><th>y_pred</th><th>(y_true - y_pred)^2</th></tr></thead><tbody><tr><td>Alice</td><td>1</td><td>0</td><td>1</td></tr><tr><td>Bob</td><td>0</td><td>0</td><td>0</td></tr><tr><td>Charlie</td><td>0</td><td>0</td><td>0</td></tr><tr><td>Diana</td><td>1</td><td>0</td><td>1</td></tr></tbody></table> 
<p><img src="https://images2.imgbox.com/f2/d1/XhUud9jw_o.png" alt="MSE=\frac{1}{4}(1+0+0+1)=0.5"></p> 
<h3><a id="MSE_229"></a>ğŸ“Œä»£ç ï¼šMSEæŸå¤±ğŸ“Œ</h3> 
<p>ä¸‹é¢æ˜¯è®¡ç®—MSEæŸå¤±çš„ä»£ç ï¼š</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
 
<span class="token keyword">def</span> <span class="token function">mse_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># y_true and y_pred are numpy arrays of the same length.</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y_true <span class="token operator">-</span> y_pred<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
y_true <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
y_pred <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
 
<span class="token keyword">print</span><span class="token punctuation">(</span>mse_loss<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 0.5</span>

</code></pre> 
<blockquote> 
 <p>å¦‚æœä½ ä¸ç†è§£è¿™æ®µä»£ç ï¼Œå¯ä»¥çœ‹çœ‹NumPyçš„å¿«é€Ÿå…¥é—¨ä¸­å…³äºæ•°ç»„çš„æ“ä½œã€‚</p> 
</blockquote> 
<h3><a id="__249"></a>ğŸ“Œè®­ç»ƒç¥ç»ç½‘ç»œ ç¬¬äºŒéƒ¨åˆ†ğŸ“Œ</h3> 
<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ˜ç¡®çš„ç›®æ ‡ï¼š<strong>æœ€å°åŒ–ç¥ç»ç½‘ç»œçš„æŸå¤±</strong>ã€‚é€šè¿‡è°ƒæ•´ç½‘ç»œçš„æƒé‡å’Œæˆªè·é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜å…¶é¢„æµ‹ç»“æœï¼Œä½†å¦‚ä½•æ‰èƒ½é€æ­¥åœ°å‡å°‘æŸå¤±ï¼Ÿ</p> 
<blockquote> 
 <p>è¿™ä¸€æ®µå†…å®¹æ¶‰åŠåˆ°å¤šå…ƒå¾®ç§¯åˆ†ï¼Œå¦‚æœä¸ç†Ÿæ‚‰å¾®ç§¯åˆ†çš„è¯ï¼Œå¯ä»¥è·³è¿‡è¿™äº›æ•°å­¦å†…å®¹ã€‚</p> 
</blockquote> 
<p>è¿™ä¸€æ®µå†…å®¹æ¶‰åŠåˆ°å¤šå…ƒå¾®ç§¯åˆ†ï¼Œå¦‚æœä¸ç†Ÿæ‚‰å¾®ç§¯åˆ†çš„è¯ï¼Œå¯ä»¥è·³è¿‡è¿™äº›æ•°å­¦å†…å®¹ã€‚</p> 
<p>ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œå‡è®¾æ•°æ®é›†ä¸­åªæœ‰Aliceï¼Œé‚£å‡æ–¹å·®æŸå¤±å°±åªæ˜¯Aliceçš„æ–¹å·®ï¼š</p> 
<p><img src="https://images2.imgbox.com/d6/d5/PtS3Vjxh_o.png" alt="MSE=\frac{1}{1}\sum_{i=1}{1}(y_{true}-y_{pred}){2}=1"></p> 
<p>ä¹Ÿå¯ä»¥æŠŠæŸå¤±çœ‹æˆæ˜¯æƒé‡å’Œæˆªè·é¡¹çš„å‡½æ•°ã€‚è®©æˆ‘ä»¬ç»™ç½‘ç»œæ ‡ä¸Šæƒé‡å’Œæˆªè·é¡¹ï¼š</p> 
<p><img src="https://images2.imgbox.com/39/73/921IHGth_o.png" alt="å›¾ç‰‡"></p> 
<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠç½‘ç»œçš„æŸå¤±è¡¨ç¤ºä¸ºï¼š</p> 
<p><img src="https://images2.imgbox.com/f3/f4/wVYmn7z8_o.png" alt="L(w_1,w_2,w_3,w_4,w_5,w_6,b_1,b_2,b_3)"></p> 
<p>å‡è®¾æˆ‘ä»¬è¦ä¼˜åŒ– <img src="https://images2.imgbox.com/ae/a1/e3yyXXlO_o.png" alt="w_1">ï¼Œå½“æˆ‘ä»¬æ”¹å˜ <img src="https://images2.imgbox.com/e1/50/0h2aDeb1_o.png" alt="w_1">æ—¶ï¼ŒæŸå¤±<img src="https://images2.imgbox.com/fd/ce/GBXcUczX_o.png" alt="L">ä¼šæ€ä¹ˆå˜åŒ–ï¼Ÿå¯ä»¥ç”¨<img src="https://images2.imgbox.com/11/81/eAn7luYB_o.png" alt="\frac{\partial L}{\partial w_1}">æ¥å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæ€ä¹ˆè®¡ç®—ï¼Ÿ</p> 
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”¨<img src="https://images2.imgbox.com/9a/92/xTCZvBN6_o.png" alt="\frac{\partial y_{pred}}{\partial w_1}">æ¥æ”¹å†™è¿™ä¸ª<a href="https://so.csdn.net/so/search?q=%E5%81%8F%E5%AF%BC%E6%95%B0&amp;spm=1001.2101.3001.7020">åå¯¼æ•°</a>ï¼š</p> 
<p><img src="https://images2.imgbox.com/ac/4d/8hQJAv3F_o.png" alt="\frac{\partial L}{\partial w_1}=\frac{\partial L}{\partial y_{pred}}\ast \frac{\partial y_{pred}}{\partial w_1}"></p> 
<p>å› ä¸ºæˆ‘ä»¬å·²ç»çŸ¥é“ <img src="https://images2.imgbox.com/7d/d7/DljiUsTE_o.png" alt="L=(1-y_{pred})^{2}"> ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¡ç®— <img src="https://images2.imgbox.com/1d/c9/XFsNFN4k_o.png" alt="\frac{\partial L}{\partial y_{pred}}"></p> 
<p><img src="https://images2.imgbox.com/54/94/3RrOEaiC_o.png" alt="\frac{\partial L}{\partial y_{pred}}=\frac{\partial (1-y_{pred})^{2}}{\partial y_{pred}}=-2(1-y_{pred})"></p> 
<p>ç°åœ¨è®©æˆ‘ä»¬æ¥æå®š <img src="https://images2.imgbox.com/6e/7e/uCe72C5c_o.png" alt="\frac{\partial y_{pred}}{\partial w_1}"> ã€‚<img src="https://images2.imgbox.com/e0/5a/LyuY5cK9_o.png" alt="h_1,h_2,o_1">åˆ†åˆ«æ˜¯å…¶æ‰€è¡¨ç¤ºçš„ç¥ç»å…ƒçš„è¾“å‡ºï¼Œæˆ‘ä»¬æœ‰ï¼š</p> 
<p><img src="https://images2.imgbox.com/3a/9c/NgrdR4zi_o.png" alt="y_{pred}=o_1=f(w_5h_1+w_6h_2)+b_3"></p> 
<p>ç”±äº <img src="https://images2.imgbox.com/da/73/PqOWfVx2_o.png" alt="w_1"> åªä¼šå½±å“ <img src="https://images2.imgbox.com/22/68/ebTLbhUS_o.png" alt="h_1"> ï¼ˆä¸ä¼šå½±å“ <img src="https://images2.imgbox.com/ea/fc/JXmpcJsG_o.png" alt="h_2">)ï¼Œæ‰€ä»¥ï¼š</p> 
<p><img src="https://images2.imgbox.com/14/7b/QWeDMGIk_o.png" alt="\frac{\partial y_{pred}}{\partial w_1}=\frac{\partial y_{pred}}{\partial h_1}\ast \frac{\partial h_1}{\partial w_1}"></p> 
<p><img src="https://images2.imgbox.com/33/ca/Rh3TNHbb_o.png" alt="\frac{\partial y_{pred}}{\partial h_1}=w_5\ast f'{(w_5h_1+w_6h_2+b_3)}"></p> 
<p>å¯¹ <img src="https://images2.imgbox.com/ad/32/ru4OneNa_o.png" alt="\frac{\partial h_1}{\partial w_1}"> ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™ä¹ˆåšï¼š</p> 
<p><img src="https://images2.imgbox.com/16/3d/gUeb02Sp_o.png" alt="h_1=f(w_1x_1+w_2h_2+b_1)"></p> 
<p><img src="https://images2.imgbox.com/76/a6/7TpomHyA_o.png" alt="\frac{\partial h_1}{\partial w_1}=x_1\ast f'({w_1x_1+w_2x_2+b_1})"></p> 
<p>åœ¨è¿™é‡Œï¼Œ<img src="https://images2.imgbox.com/d3/53/gBYySuB6_o.png" alt="x_1"> æ˜¯èº«é«˜ï¼Œ<img src="https://images2.imgbox.com/05/7d/S1c64ZIh_o.png" alt="x_2"> æ˜¯ä½“é‡ã€‚è¿™æ˜¯æˆ‘ä»¬ç¬¬äºŒæ¬¡çœ‹åˆ° <img src="https://images2.imgbox.com/91/fa/gISXDVBA_o.png" alt="f{}'(x)"> ï¼ˆSå‹å‡½æ•°çš„å¯¼æ•°)äº†ã€‚æ±‚è§£ï¼š</p> 
<p><img src="https://images2.imgbox.com/d9/b4/k8lSJs0m_o.png" alt="f(x)=\frac{1}{1-e^{-x}}"></p> 
<p><img src="https://images2.imgbox.com/a1/e3/igAkHZy9_o.png" alt="f{}'(x)=\frac{e{-x}}{(1-e{-x})^{2}}=f(x)\ast (1-f(x))"></p> 
<p>æˆ‘ä»¬å·²ç»æŠŠ <img src="https://images2.imgbox.com/52/b8/fDIRSEs6_o.png" alt="\frac{\partial L}{\partial w_1}">åˆ†è§£æˆäº†å‡ ä¸ªæˆ‘ä»¬èƒ½è®¡ç®—çš„éƒ¨åˆ†ï¼š</p> 
<p><img src="https://images2.imgbox.com/0b/07/xLDFaUVV_o.png" alt="\frac{\partial L}{\partial w_1}=\frac{\partial L}{\partial y_{pred}}\frac{\partial y_{pred}}{\partial h_1}\frac{\partial h_1}{\partial w_1}"></p> 
<p>è¿™ç§è®¡ç®—åå¯¼çš„æ–¹æ³•å«ã€åå‘ä¼ æ’­ç®—æ³•ã€(backpropagation)ã€‚</p> 
<p>å¥½å¤šæ•°å­¦ç¬¦å·ï¼Œå¦‚æœä½ è¿˜æ²¡ææ˜ç™½çš„è¯ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®é™…ä¾‹å­ã€‚</p> 
<h3><a id="_309"></a>ğŸ“Œä¾‹å­ï¼šè®¡ç®—åå¯¼æ•°ğŸ“Œ</h3> 
<p>æˆ‘ä»¬è¿˜æ˜¯çœ‹æ•°æ®é›†ä¸­åªæœ‰Aliceçš„æƒ…å†µï¼š</p> 
<p>æŠŠæ‰€æœ‰çš„æƒé‡å’Œæˆªè·é¡¹éƒ½åˆ†åˆ«åˆå§‹åŒ–ä¸º1å’Œ0ã€‚åœ¨ç½‘ç»œä¸­åšå‰é¦ˆè®¡ç®—ï¼š</p> 
<p><img src="https://images2.imgbox.com/e3/38/onTjvd3Z_o.png" alt="h_1=f(w_1x_1+w_2x_2+b_1)=f(-2+-1+0)=0.0474"></p> 
<p><img src="https://images2.imgbox.com/2d/32/aiDHRLIf_o.png" alt="h_1=f(w_3x_1+w_4x_2+b_2)=f(-2+-1+0)=0.0474"></p> 
<p><img src="https://images2.imgbox.com/e0/1d/kwJ2zQkd_o.png" alt="o_1=f(w_5h_1+w_6h_2+b_3)=f(0.0474+0.0474+0)=0.524"></p> 
<p>ç½‘ç»œçš„è¾“å‡ºæ˜¯ <img src="https://images2.imgbox.com/aa/95/3w3LVI7y_o.png" alt="pred=0.524"> ï¼Œå¯¹äºMale(0)æˆ–è€…Female(1)éƒ½æ²¡æœ‰å¤ªå¼ºçš„å€¾å‘æ€§ã€‚ç®—ä¸€ä¸‹ <img src="https://images2.imgbox.com/9c/b1/2FTZrHLs_o.png" alt="\frac{\partial L}{\partial w_1}"></p> 
<p><img src="https://images2.imgbox.com/6a/f5/4RgtNDjV_o.png" alt="\frac{\partial L}{\partial w_1}=\frac{\partial L}{\partial y_{pred}}\frac{\partial y_{pred}}{\partial h_1}\frac{\partial h_1}{\partial w_1}"></p> 
<p><img src="https://images2.imgbox.com/d4/dd/9uW0MzdZ_o.png" alt="\frac{\partial L}{\partial y_{pred}}=\frac{\partial (1-y_{pred})^{2}}{\partial y_{pred}}=-2(1-y_{pred})=-2(1-0.524)=-0.952"></p> 
<p><img src="https://images2.imgbox.com/e7/15/SdVyoNpN_o.png" alt="\frac{\partial y_{pred}}{\partial h_1}=1\ast f'{(w_5h_1+w_6h_2+b_3)}=w_5\ast f'{(0.0474+0.0474+0)}"></p> 
<p><img src="https://images2.imgbox.com/d1/9e/vRhQNBqu_o.png" alt="=f(0.0948)f(1-f(0.0948))=0.249"></p> 
<p><img src="https://images2.imgbox.com/b7/5d/NHlbIunG_o.png" alt="\frac{\partial h_1}{\partial w_1}=x_1\ast f'({w_1x_1+w_2x_2+b_1})=-2f{}'({-2+-1+0})"></p> 
<p><img src="https://images2.imgbox.com/85/85/7E0OfGHt_o.png" alt="=-2f(-3)(1-f(-3))=-0.0904"></p> 
<p><img src="https://images2.imgbox.com/32/e5/UNSQsSh5_o.png" alt="\frac{\partial L}{\partial w_1}=-0.952\ast 0.249\ast (-0.0904)=0.0214"></p> 
<blockquote> 
 <p>æç¤ºï¼šå‰é¢å·²ç»å¾—åˆ°äº†Så‹æ¿€æ´»å‡½æ•°çš„å¯¼æ•° <img src="https://images2.imgbox.com/6c/29/lr8ChNRd_o.png" alt="f{}'(x)=f(x)\cdot (1-f(x))"> ã€‚</p> 
</blockquote> 
<p>æå®šï¼è¿™ä¸ªç»“æœçš„æ„æ€å°±æ˜¯å¢åŠ <img src="https://images2.imgbox.com/cc/a6/bTtGWRnC_o.png" alt="w_1">ï¼Œ<img src="https://images2.imgbox.com/11/bf/ONR67ra2_o.png" alt="L">ä¹Ÿä¼šéšä¹‹è½»å¾®ä¸Šå‡ã€‚</p> 
<p>ç°åœ¨è®­ç»ƒç¥ç»ç½‘ç»œå·²ç»ä¸‡äº‹ä¿±å¤‡äº†ï¼æˆ‘ä»¬ä¼šä½¿ç”¨åä¸ºéšæœºæ¢¯åº¦ä¸‹é™æ³•çš„ä¼˜åŒ–ç®—æ³•æ¥ä¼˜åŒ–ç½‘ç»œçš„æƒé‡å’Œæˆªè·é¡¹ï¼Œå®ç°æŸå¤±çš„æœ€å°åŒ–ã€‚æ ¸å¿ƒå°±æ˜¯è¿™ä¸ªæ›´æ–°å…¬å¼ï¼š</p> 
<p><img src="https://images2.imgbox.com/fd/01/81FoH6UL_o.png" alt="w_1\leftarrow w_1-\eta \frac{\partial L}{\partial w_1}"></p> 
<p><img src="https://images2.imgbox.com/17/58/4AttTvxP_o.png" alt="\eta">æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œè¢«ç§°ä¸ºå­¦ä¹ ç‡ï¼Œç”¨äºè°ƒæ•´è®­ç»ƒçš„é€Ÿåº¦ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯ç”¨ <img src="https://images2.imgbox.com/af/3f/obzFNBI5_o.png" alt="w_1">å‡å»<img src="https://images2.imgbox.com/a5/58/Q6PHkZiA_o.png" alt="\eta \frac{\partial L}{\partial w_1}"></p> 
<p>æˆ‘ä»¬çš„è®­ç»ƒè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p> 
<ol><li> <p>ä»æˆ‘ä»¬çš„æ•°æ®é›†ä¸­é€‰æ‹©ä¸€ä¸ªæ ·æœ¬ï¼Œç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•è¿›è¡Œä¼˜åŒ–â€”â€”æ¯æ¬¡æˆ‘ä»¬éƒ½åªé’ˆå¯¹ä¸€ä¸ªæ ·æœ¬è¿›è¡Œä¼˜åŒ–ï¼›</p> </li><li> <p>è®¡ç®—æ¯ä¸ªæƒé‡æˆ–æˆªè·é¡¹å¯¹æŸå¤±çš„åå¯¼ï¼ˆä¾‹å¦‚<img src="https://images2.imgbox.com/aa/49/Qg8kbAfA_o.png" alt="\frac{\partial L}{\partial w_1}"> ã€<img src="https://images2.imgbox.com/a2/47/6QfJMah8_o.png" alt="\frac{\partial L}{\partial w_2}">ç­‰)ï¼›</p> </li><li> <p>ç”¨æ›´æ–°ç­‰å¼æ›´æ–°æ¯ä¸ªæƒé‡å’Œæˆªè·é¡¹ï¼›</p> </li><li> <p>é‡å¤ç¬¬ä¸€æ­¥ï¼›</p> </li></ol> 
<h3><a id="_358"></a>ğŸ“Œä»£ç ï¼šä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œğŸ“Œ</h3> 
<p>æˆ‘ä»¬ç»ˆäºå¯ä»¥å®ç°ä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œäº†ï¼š</p> 
<table><thead><tr><th>å§“å</th><th>èº«é«˜ (å‡ 135)</th><th>ä½“é‡ (å‡ 66)</th><th>Gender</th></tr></thead><tbody><tr><td>Alice</td><td>-2</td><td>-1</td><td>1</td></tr><tr><td>Bob</td><td>25</td><td>6</td><td>0</td></tr><tr><td>Charlie</td><td>17</td><td>4</td><td>0</td></tr><tr><td>Diana</td><td>-15</td><td>-6</td><td>1</td></tr></tbody></table> 
<p><img src="https://images2.imgbox.com/23/a6/vMb9V75b_o.png" alt="å›¾ç‰‡"></p> 
<p>æ€»ä½“ä»£ç </p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
 
<span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># Sigmoid activation function: f(x) = 1 / (1 + e^(-x))</span>
  <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token keyword">def</span> <span class="token function">deriv_sigmoid</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># Derivative of sigmoid: f'(x) = f(x) * (1 - f(x))</span>
  fx <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
  <span class="token keyword">return</span> fx <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> fx<span class="token punctuation">)</span>
 
<span class="token keyword">def</span> <span class="token function">mse_loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># y_trueå’Œy_predæ˜¯ç›¸åŒé•¿åº¦çš„numpyæ•°ç»„ã€‚</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y_true <span class="token operator">-</span> y_pred<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token keyword">class</span> <span class="token class-name">OurNeuralNetwork</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">'''
  A neural network with:
    - 2 inputs
    - a hidden layer with 2 neurons (h1, h2)
    - an output layer with 1 neuron (o1)
  *** å…è´£å£°æ˜ ***:
    ä¸‹é¢çš„ä»£ç æ˜¯ä¸ºäº†ç®€å•å’Œæ¼”ç¤ºï¼Œè€Œä¸æ˜¯æœ€ä½³çš„ã€‚
    çœŸæ­£çš„ç¥ç»ç½‘ç»œä»£ç ä¸æ­¤å®Œå…¨ä¸åŒã€‚ä¸è¦ä½¿ç”¨æ­¤ä»£ç ã€‚
    ç›¸åï¼Œè¯»/è¿è¡Œå®ƒæ¥ç†è§£è¿™ä¸ªç‰¹å®šçš„ç½‘ç»œæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚
  '''</span>
  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># æƒé‡ï¼ŒWeights</span>
    self<span class="token punctuation">.</span>w1 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>w2 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>w3 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>w4 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>w5 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>w6 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
    <span class="token comment"># æˆªè·é¡¹ï¼ŒBiases</span>
    self<span class="token punctuation">.</span>b1 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>b2 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>b3 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
  <span class="token keyword">def</span> <span class="token function">feedforward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Xæ˜¯ä¸€ä¸ªæœ‰2ä¸ªå…ƒç´ çš„æ•°å­—æ•°ç»„ã€‚</span>
    h1 <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>w1 <span class="token operator">*</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>w2 <span class="token operator">*</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>b1<span class="token punctuation">)</span>
    h2 <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>w3 <span class="token operator">*</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>w4 <span class="token operator">*</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>b2<span class="token punctuation">)</span>
    o1 <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>w5 <span class="token operator">*</span> h1 <span class="token operator">+</span> self<span class="token punctuation">.</span>w6 <span class="token operator">*</span> h2 <span class="token operator">+</span> self<span class="token punctuation">.</span>b3<span class="token punctuation">)</span>
    <span class="token keyword">return</span> o1
 
  <span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> all_y_trues<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    - data is a (n x 2) numpy array, n = # of samples in the dataset.
    - all_y_trues is a numpy array with n elements.
      Elements in all_y_trues correspond to those in data.
    '''</span>
    learn_rate <span class="token operator">=</span> <span class="token number">0.1</span>
    epochs <span class="token operator">=</span> <span class="token number">1000</span> <span class="token comment"># éå†æ•´ä¸ªæ•°æ®é›†çš„æ¬¡æ•°</span>
 
    <span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">for</span> x<span class="token punctuation">,</span> y_true <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> all_y_trues<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># --- åšä¸€ä¸ªå‰é¦ˆ(ç¨åæˆ‘ä»¬å°†éœ€è¦è¿™äº›å€¼)</span>
        sum_h1 <span class="token operator">=</span> self<span class="token punctuation">.</span>w1 <span class="token operator">*</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>w2 <span class="token operator">*</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>b1
        h1 <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>sum_h1<span class="token punctuation">)</span>
 
        sum_h2 <span class="token operator">=</span> self<span class="token punctuation">.</span>w3 <span class="token operator">*</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>w4 <span class="token operator">*</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>b2
        h2 <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>sum_h2<span class="token punctuation">)</span>
 
        sum_o1 <span class="token operator">=</span> self<span class="token punctuation">.</span>w5 <span class="token operator">*</span> h1 <span class="token operator">+</span> self<span class="token punctuation">.</span>w6 <span class="token operator">*</span> h2 <span class="token operator">+</span> self<span class="token punctuation">.</span>b3
        o1 <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>sum_o1<span class="token punctuation">)</span>
        y_pred <span class="token operator">=</span> o1
 
        <span class="token comment"># --- è®¡ç®—åå¯¼æ•°ã€‚</span>
        <span class="token comment"># --- Naming: d_L_d_w1 represents "partial L / partial w1"</span>
        d_L_d_ypred <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y_true <span class="token operator">-</span> y_pred<span class="token punctuation">)</span>
 
        <span class="token comment"># Neuron o1</span>
        d_ypred_d_w5 <span class="token operator">=</span> h1 <span class="token operator">*</span> deriv_sigmoid<span class="token punctuation">(</span>sum_o1<span class="token punctuation">)</span>
        d_ypred_d_w6 <span class="token operator">=</span> h2 <span class="token operator">*</span> deriv_sigmoid<span class="token punctuation">(</span>sum_o1<span class="token punctuation">)</span>
        d_ypred_d_b3 <span class="token operator">=</span> deriv_sigmoid<span class="token punctuation">(</span>sum_o1<span class="token punctuation">)</span>
 
        d_ypred_d_h1 <span class="token operator">=</span> self<span class="token punctuation">.</span>w5 <span class="token operator">*</span> deriv_sigmoid<span class="token punctuation">(</span>sum_o1<span class="token punctuation">)</span>
        d_ypred_d_h2 <span class="token operator">=</span> self<span class="token punctuation">.</span>w6 <span class="token operator">*</span> deriv_sigmoid<span class="token punctuation">(</span>sum_o1<span class="token punctuation">)</span>
 
        <span class="token comment"># Neuron h1</span>
        d_h1_d_w1 <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> deriv_sigmoid<span class="token punctuation">(</span>sum_h1<span class="token punctuation">)</span>
        d_h1_d_w2 <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> deriv_sigmoid<span class="token punctuation">(</span>sum_h1<span class="token punctuation">)</span>
        d_h1_d_b1 <span class="token operator">=</span> deriv_sigmoid<span class="token punctuation">(</span>sum_h1<span class="token punctuation">)</span>
 
        <span class="token comment"># Neuron h2</span>
        d_h2_d_w3 <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> deriv_sigmoid<span class="token punctuation">(</span>sum_h2<span class="token punctuation">)</span>
        d_h2_d_w4 <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> deriv_sigmoid<span class="token punctuation">(</span>sum_h2<span class="token punctuation">)</span>
        d_h2_d_b2 <span class="token operator">=</span> deriv_sigmoid<span class="token punctuation">(</span>sum_h2<span class="token punctuation">)</span>
 
        <span class="token comment"># --- æ›´æ–°æƒé‡å’Œåå·®</span>
        <span class="token comment"># Neuron h1</span>
        self<span class="token punctuation">.</span>w1 <span class="token operator">-=</span> learn_rate <span class="token operator">*</span> d_L_d_ypred <span class="token operator">*</span> d_ypred_d_h1 <span class="token operator">*</span> d_h1_d_w1
        self<span class="token punctuation">.</span>w2 <span class="token operator">-=</span> learn_rate <span class="token operator">*</span> d_L_d_ypred <span class="token operator">*</span> d_ypred_d_h1 <span class="token operator">*</span> d_h1_d_w2
        self<span class="token punctuation">.</span>b1 <span class="token operator">-=</span> learn_rate <span class="token operator">*</span> d_L_d_ypred <span class="token operator">*</span> d_ypred_d_h1 <span class="token operator">*</span> d_h1_d_b1
 
        <span class="token comment"># Neuron h2</span>
        self<span class="token punctuation">.</span>w3 <span class="token operator">-=</span> learn_rate <span class="token operator">*</span> d_L_d_ypred <span class="token operator">*</span> d_ypred_d_h2 <span class="token operator">*</span> d_h2_d_w3
        self<span class="token punctuation">.</span>w4 <span class="token operator">-=</span> learn_rate <span class="token operator">*</span> d_L_d_ypred <span class="token operator">*</span> d_ypred_d_h2 <span class="token operator">*</span> d_h2_d_w4
        self<span class="token punctuation">.</span>b2 <span class="token operator">-=</span> learn_rate <span class="token operator">*</span> d_L_d_ypred <span class="token operator">*</span> d_ypred_d_h2 <span class="token operator">*</span> d_h2_d_b2
 
        <span class="token comment"># Neuron o1</span>
        self<span class="token punctuation">.</span>w5 <span class="token operator">-=</span> learn_rate <span class="token operator">*</span> d_L_d_ypred <span class="token operator">*</span> d_ypred_d_w5
        self<span class="token punctuation">.</span>w6 <span class="token operator">-=</span> learn_rate <span class="token operator">*</span> d_L_d_ypred <span class="token operator">*</span> d_ypred_d_w6
        self<span class="token punctuation">.</span>b3 <span class="token operator">-=</span> learn_rate <span class="token operator">*</span> d_L_d_ypred <span class="token operator">*</span> d_ypred_d_b3
 
      <span class="token comment"># --- åœ¨æ¯æ¬¡epochç»“æŸæ—¶è®¡ç®—æ€»æŸå¤± </span>
      <span class="token keyword">if</span> epoch <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        y_preds <span class="token operator">=</span> np<span class="token punctuation">.</span>apply_along_axis<span class="token punctuation">(</span>self<span class="token punctuation">.</span>feedforward<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
        loss <span class="token operator">=</span> mse_loss<span class="token punctuation">(</span>all_y_trues<span class="token punctuation">,</span> y_preds<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Epoch %d loss: %.3f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>epoch<span class="token punctuation">,</span> loss<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># å®šä¹‰æ•°æ®é›†</span>
data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># Alice</span>
  <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token comment"># Bob</span>
  <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token comment"># Charlie</span>
  <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># Diana</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
all_y_trues <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment"># Alice</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment"># Bob</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment"># Charlie</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment"># Diana</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
 
<span class="token comment"># è®­ç»ƒæˆ‘ä»¬çš„ç¥ç»ç½‘ç»œ!</span>
network <span class="token operator">=</span> OurNeuralNetwork<span class="token punctuation">(</span><span class="token punctuation">)</span>
network<span class="token punctuation">.</span>train<span class="token punctuation">(</span>data<span class="token punctuation">,</span> all_y_trues<span class="token punctuation">)</span>
</code></pre> 
<p>éšç€ç½‘ç»œçš„å­¦ä¹ ï¼ŒæŸå¤±åœ¨ç¨³æ­¥ä¸‹é™ã€‚</p> 
<p><img src="https://images2.imgbox.com/56/50/PlbxwVHD_o.png" alt="å›¾ç‰‡"></p> 
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªç½‘ç»œæ¥é¢„æµ‹æ€§åˆ«äº†ï¼š</p> 
<pre><code class="prism language-py"><span class="token comment"># åšä¸€äº›é¢„æµ‹</span>
emily <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 128 ç£…, 63 è‹±å¯¸</span>
frank <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 155 ç£…, 68 è‹±å¯¸</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Emily: %.3f"</span> <span class="token operator">%</span> network<span class="token punctuation">.</span>feedforward<span class="token punctuation">(</span>emily<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 0.951 - F</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Frank: %.3f"</span> <span class="token operator">%</span> network<span class="token punctuation">.</span>feedforward<span class="token punctuation">(</span>frank<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 0.039 - M</span>

</code></pre> 
<h3><a id="_521"></a>ğŸ“Œåè¯ğŸ“Œ</h3> 
<p>æå®šäº†ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œï¼Œå¿«é€Ÿå›é¡¾ä¸€ä¸‹ï¼š</p> 
<ul><li> <p>ä»‹ç»äº†ç¥ç»ç½‘ç»œçš„åŸºæœ¬ç»“æ„â€”â€”ç¥ç»å…ƒï¼›</p> </li><li> <p>åœ¨ç¥ç»å…ƒä¸­ä½¿ç”¨Så‹æ¿€æ´»å‡½æ•°ï¼›</p> </li><li> <p>ç¥ç»ç½‘ç»œå°±æ˜¯è¿æ¥åœ¨ä¸€èµ·çš„ç¥ç»å…ƒï¼›</p> </li><li> <p>æ„å»ºäº†ä¸€ä¸ªæ•°æ®é›†ï¼Œè¾“å…¥ï¼ˆæˆ–ç‰¹å¾ï¼‰æ˜¯ä½“é‡å’Œèº«é«˜ï¼Œè¾“å‡ºï¼ˆæˆ–æ ‡ç­¾ï¼‰æ˜¯æ€§åˆ«ï¼›</p> </li><li> <p>å­¦ä¹ äº†æŸå¤±å‡½æ•°å’Œå‡æ–¹å·®æŸå¤±ï¼›</p> </li><li> <p>è®­ç»ƒç½‘ç»œå°±æ˜¯æœ€å°åŒ–å…¶æŸå¤±ï¼›</p> </li><li> <p>ç”¨åå‘ä¼ æ’­æ–¹æ³•è®¡ç®—åå¯¼ï¼›</p> </li><li> <p>ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•è®­ç»ƒç½‘ç»œï¼›</p> </li></ul> 
<p>æ¥ä¸‹æ¥ä½ è¿˜å¯ä»¥ï¼š</p> 
<ul><li> <p>ç”¨æœºå™¨å­¦ä¹ åº“å®ç°æ›´å¤§æ›´å¥½çš„ç¥ç»ç½‘ç»œï¼Œä¾‹å¦‚TensorFlowã€Keraså’ŒPyTorchï¼›</p> </li><li> <p>åœ¨æµè§ˆå™¨ä¸­å®ç°ç¥ç»ç½‘ç»œï¼›</p> </li><li> <p>å…¶ä»–ç±»å‹çš„æ¿€æ´»å‡½æ•°ï¼›</p> </li><li> <p>å…¶ä»–ç±»å‹çš„ä¼˜åŒ–å™¨ï¼›</p> </li><li> <p>å­¦ä¹ å·ç§¯ç¥ç»ç½‘ç»œï¼Œè¿™ç»™è®¡ç®—æœºè§†è§‰é¢†åŸŸå¸¦æ¥äº†é©å‘½ï¼›</p> </li><li> <p>å­¦ä¹ é€’å½’ç¥ç»ç½‘ç»œï¼Œå¸¸ç”¨è¯­è‡ªç„¶è¯­è¨€å¤„ç†ï¼›</p> </li></ul> 
<p>é™„åŠ ä¸€æ®µä»£ç </p> 
<pre><code class="prism language-py"><span class="token comment">#!/usr/bin/pyton3</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
 
 
<span class="token comment"># Activation Function</span>
<span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
 
<span class="token comment"># Neural Unit</span>
<span class="token keyword">class</span> <span class="token class-name">Perceptron</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_size<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> initializer<span class="token punctuation">:</span> <span class="token builtin">list</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> activation_func<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># W[0] is the bias</span>
        self<span class="token punctuation">.</span>input_size <span class="token operator">=</span> input_size
        <span class="token comment"># W is parameters of Perceptron</span>
        self<span class="token punctuation">.</span>n_W <span class="token operator">=</span> self<span class="token punctuation">.</span>input_size <span class="token operator">+</span> <span class="token number">1</span>
        self<span class="token punctuation">.</span>W <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>low<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> high<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> size<span class="token operator">=</span>self<span class="token punctuation">.</span>n_W<span class="token punctuation">)</span>
        <span class="token comment"># X is the input vector of Perceptron</span>
        self<span class="token punctuation">.</span>X <span class="token operator">=</span> <span class="token boolean">None</span>
 
        self<span class="token punctuation">.</span>output <span class="token operator">=</span> <span class="token number">0.0</span>
        self<span class="token punctuation">.</span>delta_W <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>n_W<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>delta_X <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> input_size<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>activation_func <span class="token operator">=</span> activation_func
        <span class="token keyword">if</span> initializer<span class="token punctuation">:</span>
            <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>initializer<span class="token punctuation">)</span> <span class="token operator">==</span> self<span class="token punctuation">.</span>n_W
            self<span class="token punctuation">.</span>W <span class="token operator">=</span> initializer
 
    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token operator">==</span> self<span class="token punctuation">.</span>input_size
        self<span class="token punctuation">.</span>X <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>X<span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">float</span><span class="token punctuation">)</span>
        y <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>W<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>X<span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>W<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>activation_func <span class="token operator">==</span> <span class="token string">'sigmoid'</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>output <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>output <span class="token operator">=</span> y
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>output
 
    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> lr<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>W <span class="token operator">=</span> self<span class="token punctuation">.</span>W <span class="token operator">+</span> lr <span class="token operator">*</span> self<span class="token punctuation">.</span>delta_W
        self<span class="token punctuation">.</span>delta_W <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>n_W<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>forward<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
 
 
<span class="token comment"># Neural Layer</span>
<span class="token keyword">class</span> <span class="token class-name">Layer</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_size<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> output_size<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> activation_func<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>input_size <span class="token operator">=</span> input_size
        self<span class="token punctuation">.</span>output_size <span class="token operator">=</span> output_size
        self<span class="token punctuation">.</span>net <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>
            <span class="token punctuation">[</span>Perceptron<span class="token punctuation">(</span>input_size<span class="token operator">=</span>input_size<span class="token punctuation">,</span> activation_func<span class="token operator">=</span>activation_func<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>output_size<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>activation_func <span class="token operator">=</span> activation_func
        self<span class="token punctuation">.</span>inputs <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> input_size<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lr <span class="token operator">=</span> lr
        self<span class="token punctuation">.</span>outputs <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> output_size<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>inputs <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>X<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>outputs <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>p<span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token keyword">for</span> p <span class="token keyword">in</span> self<span class="token punctuation">.</span>net<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>outputs
 
    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>forward<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">backward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> delta_outputs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>delta_outputs<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>net<span class="token punctuation">)</span>
        <span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>output_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
            delta_output <span class="token operator">=</span> delta_outputs<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
            p <span class="token operator">=</span> self<span class="token punctuation">.</span>net<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
            o <span class="token operator">=</span> self<span class="token punctuation">.</span>outputs<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>activation_func <span class="token operator">==</span> <span class="token string">'sigmoid'</span><span class="token punctuation">:</span>
                <span class="token comment"># W0 is the bias</span>
                p<span class="token punctuation">.</span>delta_W <span class="token operator">=</span> delta_output <span class="token operator">*</span> o <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> o<span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># expand X for W_0</span>
                p<span class="token punctuation">.</span>delta_X <span class="token operator">=</span> delta_output <span class="token operator">*</span> o <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> o<span class="token punctuation">)</span> <span class="token operator">*</span> p<span class="token punctuation">.</span>W<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token comment"># linear</span>
                p<span class="token punctuation">.</span>delta_W <span class="token operator">=</span> delta_output <span class="token operator">*</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment"># W0 is the bias</span>
                p<span class="token punctuation">.</span>delta_X <span class="token operator">=</span> delta_output <span class="token operator">*</span> p<span class="token punctuation">.</span>W<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
 
    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> p <span class="token keyword">in</span> self<span class="token punctuation">.</span>net<span class="token punctuation">:</span>
            p<span class="token punctuation">.</span>update<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lr<span class="token punctuation">)</span>
 
 
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># standard version ============================</span>
    samples <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
 
    <span class="token comment"># training</span>
    layer1 <span class="token operator">=</span> Layer<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
    layer2 <span class="token operator">=</span> Layer<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> activation_func<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># iteration</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'iteration </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
        text_X <span class="token operator">=</span> samples<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        text_y_d <span class="token operator">=</span> samples<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        test_y <span class="token operator">=</span> layer2<span class="token punctuation">(</span>layer1<span class="token punctuation">(</span><span class="token punctuation">(</span>samples<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'X:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>text_X<span class="token punctuation">}</span></span><span class="token string">, y_d:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>text_y_d<span class="token punctuation">}</span></span><span class="token string">, y:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>test_y<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> X<span class="token punctuation">,</span> y_d <span class="token keyword">in</span> samples<span class="token punctuation">:</span>
            <span class="token comment"># forward</span>
            y <span class="token operator">=</span> layer2<span class="token punctuation">(</span>layer1<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token comment"># backward layer2 -&gt; layer1</span>
            err <span class="token operator">=</span> y_d <span class="token operator">-</span> y   <span class="token comment"># delta_outputs of layer 2</span>
            layer2<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">[</span>err<span class="token punctuation">]</span><span class="token punctuation">)</span>
 
            delta_outputs <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">]</span> <span class="token operator">*</span> layer2<span class="token punctuation">.</span>input_size<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">)</span>  <span class="token comment"># delta_outputs of layer 1</span>
            <span class="token keyword">for</span> p <span class="token keyword">in</span> layer2<span class="token punctuation">.</span>net<span class="token punctuation">:</span>
                delta_outputs <span class="token operator">+=</span> p<span class="token punctuation">.</span>delta_X
            layer1<span class="token punctuation">.</span>backward<span class="token punctuation">(</span>delta_outputs<span class="token punctuation">)</span>
 
            <span class="token comment"># update gradient</span>
            layer2<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>
            layer1<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
    <span class="token comment"># result</span>
    <span class="token keyword">for</span> X<span class="token punctuation">,</span> y_d <span class="token keyword">in</span> samples<span class="token punctuation">:</span>
        y <span class="token operator">=</span> layer2<span class="token punctuation">(</span>layer1<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'The final result: X:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>X<span class="token punctuation">}</span></span><span class="token string">, y_d:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>y_d<span class="token punctuation">}</span></span><span class="token string">, y:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>y<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
 
    <span class="token comment"># # simple version ============================</span>
    <span class="token comment"># samples = [[[0, 1], 1],</span>
    <span class="token comment">#            [[1, 0], -1]]</span>
    <span class="token comment"># # training</span>
    <span class="token comment"># layer1 = Layer(2, 1, activation_func='')</span>
    <span class="token comment"># for i in range(100):</span>
    <span class="token comment">#     # iteration</span>
    <span class="token comment">#     print(f'iteration {i}')</span>
    <span class="token comment">#     for X, y_d in samples:</span>
    <span class="token comment">#         # forward</span>
    <span class="token comment">#         y = layer1(X)[0]</span>
    <span class="token comment">#         # backward</span>
    <span class="token comment">#         err = y_d - y</span>
    <span class="token comment">#         layer1.backward([err])</span>
    <span class="token comment">#         print(f'Wï¼š{layer1.net[0].W}')</span>
    <span class="token comment">#         print(f'delta_Wï¼š{layer1.net[0].delta_W}')</span>
    <span class="token comment">#         layer1.update()</span>
    <span class="token comment">#         print(f'X:{X}, y_d:{y_d}, y:{y}')</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3786b082f265a193eb5c5e7b343049fa/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">ADC Driver test</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4b8fc1469a4b9dab19a523cd4dbab141/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">docker å®‰è£…rocketmqæœåŠ¡</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 èœé¸Ÿç¨‹åºå‘˜åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>