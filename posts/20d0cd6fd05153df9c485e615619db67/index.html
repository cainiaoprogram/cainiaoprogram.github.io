<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vivado硬件调试 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Vivado硬件调试" />
<meta property="og:description" content="Vivado硬件调试 ILA (Integrated Logic Analyzer) 集成逻辑分析仪：监控逻辑内部信号和端口信号。
一、例化ILA添加调试信号 添加IP核
​ 根据要观测信号的属性设置探针属性
创建完成
​ 例化模板
​ 例化;
​
综合实现，生成bit流;
下载bit文件至开发板;
​ 设置触发条件
​ 抓取结果
​ 抓取信号窗口的个数
​ 等待抓取
​ 抓取状态： 调试完后，删除例化的调试模块和IP核，重新生成bit文件。
二、综合后在网表里添加调试信号： 打开综合设计文件，调整窗口为Debug模式；
​ 在”Nets“中选择要调试的信号，右键选择”Mark Debug“；
​ 一些信号可能会被EDA优化，无法显示完整的数据位宽，此时需要在代码中修改，并重新综合。示例如下：
// 添加debug属性，此时EDA不会对该信号进行优化 (* mark_debug = &#34;true&#34; *)reg [24:0] counter; 单击”Set Up Debug“
​ ​ ​ ​ ​ // xdc文件中多出来的完整代码： set_property MARK_DEBUG true [get_nets {Led_OBUF[0]}] set_property MARK_DEBUG true [get_nets {Led_OBUF[1]}] set_property MARK_DEBUG true [get_nets {Led_OBUF[2]}] set_property MARK_DEBUG true [get_nets {Led_OBUF[3]}] set_property MARK_DEBUG true [get_nets Rst_n_IBUF] create_debug_core u_ila_0 ila set_property ALL_PROBE_SAME_MU true [get_debug_cores u_ila_0] set_property ALL_PROBE_SAME_MU_CNT 1 [get_debug_cores u_ila_0] set_property C_ADV_TRIGGER false [get_debug_cores u_ila_0] set_property C_DATA_DEPTH 1024 [get_debug_cores u_ila_0] set_property C_EN_STRG_QUAL false [get_debug_cores u_ila_0] set_property C_INPUT_PIPE_STAGES 0 [get_debug_cores u_ila_0] set_property C_TRIGIN_EN false [get_debug_cores u_ila_0] set_property C_TRIGOUT_EN false [get_debug_cores u_ila_0] set_property port_width 1 [get_debug_ports u_ila_0/clk] connect_debug_port u_ila_0/clk [get_nets [list Clk_IBUF_BUFG]] set_property PROBE_TYPE DATA_AND_TRIGGER [get_debug_ports u_ila_0/probe0] set_property port_width 4 [get_debug_ports u_ila_0/probe0] connect_debug_port u_ila_0/probe0 [get_nets [list {Led_OBUF[0]} {Led_OBUF[1]} {Led_OBUF[2]} {Led_OBUF[3]}]] create_debug_port u_ila_0 probe set_property PROBE_TYPE DATA_AND_TRIGGER [get_debug_ports u_ila_0/probe1] set_property port_width 25 [get_debug_ports u_ila_0/probe1] connect_debug_port u_ila_0/probe1 [get_nets [list {counter[0]} {counter[1]} {counter[2]} {counter[3]} {counter[4]} {counter[5]} {counter[6]} {counter[7]} {counter[8]} {counter[9]} {counter[10]} {counter[11]} {counter[12]} {counter[13]} {counter[14]} {counter[15]} {counter[16]} {counter[17]} {counter[18]} {counter[19]} {counter[20]} {counter[21]} {counter[22]} {counter[23]} {counter[24]}]] create_debug_port u_ila_0 probe set_property PROBE_TYPE DATA_AND_TRIGGER [get_debug_ports u_ila_0/probe2] set_property port_width 1 [get_debug_ports u_ila_0/probe2] connect_debug_port u_ila_0/probe2 [get_nets [list Rst_n_IBUF]] set_property C_CLK_INPUT_FREQ_HZ 300000000 [get_debug_cores dbg_hub] set_property C_ENABLE_CLK_DIVIDER false [get_debug_cores dbg_hub] set_property C_USER_SCAN_CHAIN 1 [get_debug_cores dbg_hub] connect_debug_port dbg_hub/clk [get_nets Clk_IBUF_BUFG] 可以直接在xdc文件中添加所要调试的信号探针。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/20d0cd6fd05153df9c485e615619db67/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-25T17:43:40+08:00" />
<meta property="article:modified_time" content="2023-04-25T17:43:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vivado硬件调试</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Vivado_0"></a>Vivado硬件调试</h2> 
<h3><a id="ILA_Integrated_Logic_Analyzer_2"></a>ILA (Integrated Logic Analyzer)</h3> 
<p>集成逻辑分析仪：监控逻辑内部信号和端口信号。</p> 
<hr> 
<h4><a id="ILA_8"></a>一、例化ILA添加调试信号</h4> 
<ol><li> <p>添加IP核</p> <p>​ <img src="https://images2.imgbox.com/5c/a3/QdwgUZPh_o.png" alt="在这里插入图片描述"></p> </li><li> <p>根据要观测信号的属性设置探针属性</p> <p><img src="https://images2.imgbox.com/fb/97/KB0hG0UH_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0f/c0/pgPh0jxv_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f8/bb/cNniylTF_o.png" alt="在这里插入图片描述"></p> </li><li> <p>创建完成</p> <p>​ <img src="https://images2.imgbox.com/dc/b7/IzntBM1Q_o.png" alt="在这里插入图片描述"></p> </li><li> <p>例化模板</p> <p>​ <img src="https://images2.imgbox.com/02/4f/TNcFrrbt_o.png" alt="在这里插入图片描述"></p> </li><li> <p>例化;</p> <p>​<img src="https://images2.imgbox.com/ba/7a/WcPXiRHC_o.png" alt="在这里插入图片描述"></p> </li><li> <p>综合实现，生成bit流;</p> </li><li> <p>下载bit文件至开发板;</p> <p>​ <img src="https://images2.imgbox.com/9e/ba/eQEnjlLh_o.png" alt="在这里插入图片描述"></p> </li><li> <p><mark>设置触发条件</mark></p> <p>​ <img src="https://images2.imgbox.com/a6/77/WiLZx1cs_o.png" alt="在这里插入图片描述"></p> </li><li> <p>抓取结果</p> <p>​ <img src="https://images2.imgbox.com/87/8e/Ix9RECAf_o.png" alt="在这里插入图片描述"></p> <p><mark>抓取信号窗口的个数</mark></p> <p>​ <img src="https://images2.imgbox.com/2e/51/agm6HOjS_o.png" alt="在这里插入图片描述"></p> <p>等待抓取</p> <p>​ <img src="https://images2.imgbox.com/d8/7c/1lN7fejo_o.png" alt="在这里插入图片描述"></p> <p>抓取状态： <br> <img src="https://images2.imgbox.com/42/e2/tirLekLb_o.png" alt="在这里插入图片描述"></p> </li><li> <p><mark>调试完后，删除例化的调试模块和IP核，重新生成bit文件。</mark></p> </li></ol> 
<h4><a id="_72"></a>二、综合后在网表里添加调试信号：</h4> 
<ol><li> <p>打开综合设计文件，调整窗口为Debug模式；</p> <p>​ <img src="https://images2.imgbox.com/5e/8e/A8gXUPrv_o.png" alt="在这里插入图片描述"></p> </li><li> <p>在”Nets“中选择要调试的信号，右键选择”Mark Debug“；</p> <p>​ <br> <img src="https://images2.imgbox.com/88/80/2oxJihkD_o.png" alt="在这里插入图片描述"></p> </li><li> <p>一些信号可能会被EDA优化，无法显示完整的数据位宽，此时需要在代码中修改，并<strong>重新综合</strong>。示例如下：</p> <pre><code class="prism language-verilog">// 添加debug属性，此时EDA不会对该信号进行优化
(* mark_debug = "true" *)reg [24:0] counter;
</code></pre> </li><li> <p>单击”Set Up Debug“</p> <p>​ <img src="https://images2.imgbox.com/63/2f/5DNmvikR_o.png" alt="在这里插入图片描述"></p> <p>​ <img src="https://images2.imgbox.com/48/eb/5zXEInxY_o.png" alt="在这里插入图片描述"></p> <p>​ <img src="https://images2.imgbox.com/b5/e3/C5NCs7ME_o.png" alt="在这里插入图片描述"></p> <p>​ <img src="https://images2.imgbox.com/06/9c/56gzxxoO_o.png" alt="在这里插入图片描述"></p> <p>​ <img src="https://images2.imgbox.com/72/a6/hphejwU6_o.png" alt="在这里插入图片描述"></p> <pre><code class="prism language-verilog">// xdc文件中多出来的完整代码：
set_property MARK_DEBUG true [get_nets {Led_OBUF[0]}]
set_property MARK_DEBUG true [get_nets {Led_OBUF[1]}]
set_property MARK_DEBUG true [get_nets {Led_OBUF[2]}]
set_property MARK_DEBUG true [get_nets {Led_OBUF[3]}]
set_property MARK_DEBUG true [get_nets Rst_n_IBUF]

create_debug_core u_ila_0 ila
set_property ALL_PROBE_SAME_MU true [get_debug_cores u_ila_0]
set_property ALL_PROBE_SAME_MU_CNT 1 [get_debug_cores u_ila_0]
set_property C_ADV_TRIGGER false [get_debug_cores u_ila_0]
set_property C_DATA_DEPTH 1024 [get_debug_cores u_ila_0]
set_property C_EN_STRG_QUAL false [get_debug_cores u_ila_0]
set_property C_INPUT_PIPE_STAGES 0 [get_debug_cores u_ila_0]
set_property C_TRIGIN_EN false [get_debug_cores u_ila_0]
set_property C_TRIGOUT_EN false [get_debug_cores u_ila_0]
set_property port_width 1 [get_debug_ports u_ila_0/clk]
connect_debug_port u_ila_0/clk [get_nets [list Clk_IBUF_BUFG]]
set_property PROBE_TYPE DATA_AND_TRIGGER [get_debug_ports u_ila_0/probe0]
set_property port_width 4 [get_debug_ports u_ila_0/probe0]
connect_debug_port u_ila_0/probe0 [get_nets [list {Led_OBUF[0]} {Led_OBUF[1]} {Led_OBUF[2]} {Led_OBUF[3]}]]
create_debug_port u_ila_0 probe
set_property PROBE_TYPE DATA_AND_TRIGGER [get_debug_ports u_ila_0/probe1]
set_property port_width 25 [get_debug_ports u_ila_0/probe1]
connect_debug_port u_ila_0/probe1 [get_nets [list {counter[0]} {counter[1]} {counter[2]} {counter[3]} {counter[4]} {counter[5]} {counter[6]} {counter[7]} {counter[8]} {counter[9]} {counter[10]} {counter[11]} {counter[12]} {counter[13]} {counter[14]} {counter[15]} {counter[16]} {counter[17]} {counter[18]} {counter[19]} {counter[20]} {counter[21]} {counter[22]} {counter[23]} {counter[24]}]]
create_debug_port u_ila_0 probe
set_property PROBE_TYPE DATA_AND_TRIGGER [get_debug_ports u_ila_0/probe2]
set_property port_width 1 [get_debug_ports u_ila_0/probe2]
connect_debug_port u_ila_0/probe2 [get_nets [list Rst_n_IBUF]]
set_property C_CLK_INPUT_FREQ_HZ 300000000 [get_debug_cores dbg_hub]
set_property C_ENABLE_CLK_DIVIDER false [get_debug_cores dbg_hub]
set_property C_USER_SCAN_CHAIN 1 [get_debug_cores dbg_hub]
connect_debug_port dbg_hub/clk [get_nets Clk_IBUF_BUFG]

</code></pre> <p>可以直接在xdc文件中添加所要调试的信号探针。</p> </li><li> <p>“Open Hardware Manager”，连接开发板并下载程序；</p> <p>​ <img src="https://images2.imgbox.com/a9/94/ohlZ8mKT_o.png" alt="在这里插入图片描述"></p> <p>​ <img src="https://images2.imgbox.com/67/0d/3PtQH3Kb_o.png" alt="在这里插入图片描述"></p> </li><li> <p>调试完毕删除 <mark>xdc</mark> 文件中多余的代码和 <mark>3</mark> 中添加的代码，重新生成bit流；</p> <p>下载bit文件时，清除Debug文件的路径（图示）；</p> <p>​ <img src="https://images2.imgbox.com/45/1e/rprNJRPL_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<hr> 
<h3><a id="VIO_Virtual_InputOutput_167"></a>VIO (Virtual Input/Output)</h3> 
<p>虚拟IO：实时监控和驱动逻辑内部信号和端口信号。</p> 
<p>VIO的使用参考Blog：<a href="https://blog.csdn.net/hy_520520/article/details/127239631">VIVADO关于VIO IP核（Virtual Input/Output）的使用</a></p> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c9ad87bc13b5daefe8bc268ec8baee41/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Docker-Compose部署ELK</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2fa41abafef8c7f6c449c46ace47f603/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AI视频智能分析系统方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>