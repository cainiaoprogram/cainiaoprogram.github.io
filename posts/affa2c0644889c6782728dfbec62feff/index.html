<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[UE4] C&#43;&#43;实现Delegate Event实例(例子、example、sample) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[UE4] C&#43;&#43;实现Delegate Event实例(例子、example、sample)" />
<meta property="og:description" content="相关文章：
如何用蓝图实现Delegate Event：
http://aigo.iteye.com/blog/2269663
原文作者：@玄冬Wong
转载请注明出处：http://aigo.iteye.com/blog/2301010
虽然官方doc上说Event的Binding方式跟Multi-Cast用法完全一样，Multi-Cast论坛上也有很多例子，但是实际是不一样。。而且论坛上找不到相关例子。后来看了下runtime/core的源码，Event的binging方式如下(附上完整步骤)：
1，先定义自定义Event，此例中我们定义在GameMode中，名字叫 MyInitEvent。例子中定义的是无参函数，如果需要带参数，官方doc讲的有
UCLASS() class MYPROJ_API AMyGameMode : public AGameMode { GENERATED_BODY() public: AHGameMode(); //定义Event DECLARE_EVENT(MyUObject, MyInitEvent) //用于获取Event引用的函数，方便在GameMode之外执行binding MyInitEvent&amp; OnInitialize() { return InitEvent; } private: //Event实例化 MyInitEvent InitEvent; //Event的binding指针 FDelegateHandle DHandle; } 2，执行Binding。MyUObject::TestFun是需要被触发的函数，这里假设是一个普通的无参成员函数：
MyUObject* MyObj = NULL;	//这里假设创建MyUObject if (MyObj) { DHandle = MyGameMode-&gt;OnInitialize().AddUObject(MyObj, &amp;MyUObject::TestFun); } 注：任何UObject的普通函数都可以被设置为Event的回调函数，但如果函数是UFUNCTION，那么需要将AddUObject替换为AddUFunction。
3，触发Event，这里假设在BeginPlay中触发：
void AMyGameMode::BeginPlay() { InitEvent.Broadcast(); } 4，移除Event，比如之前bingding的event不想再触发了：
MyGameMode-&gt;OnInitialize().Remove(DHandle); Event 和 Delegate 区别
Delegate 只能绑定一个回调函数，Delegate执行Execute()函数时，只会触发事先绑定的一个函数；Event可以绑定任意个函数，一旦执行Event的Broadcast()函数，所有回调函数按Add顺序依次执行。
Dynamic Multicast Delegate也可以同时绑定多个回调函数，但是其运行效率要比 Event 慢。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/affa2c0644889c6782728dfbec62feff/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-05-26T10:33:18+08:00" />
<meta property="article:modified_time" content="2016-05-26T10:33:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[UE4] C&#43;&#43;实现Delegate Event实例(例子、example、sample)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="iteye-blog-content-contain"> 
 <p style="font-size:14px;">相关文章：</p> 
 <p style="font-size:14px;"><strong>如何用蓝图实现Delegate Event：</strong></p> 
 <p><a href="/blog/2269663" rel="nofollow">http://aigo.iteye.com/blog/2269663</a></p> 
 <p style="font-size:14px;"> </p> 
 <p style="font-size:14px;">原文作者：@玄冬Wong</p> 
 <p style="font-size:14px;">转载请注明出处：<a href="/blog/2301010" rel="nofollow">http://aigo.iteye.com/blog/2301010</a></p> 
 <p style="font-size:14px;"> </p> 
 <p style="font-size:14px;">虽然官方doc上说Event的Binding方式跟Multi-Cast用法完全一样，Multi-Cast论坛上也有很多例子，但是实际是不一样。。而且论坛上找不到相关例子。后来看了下runtime/core的源码，Event的binging方式如下(附上完整步骤)：</p> 
 <p style="font-size:14px;"> </p> 
 <p style="font-size:14px;">1，先定义自定义Event，此例中我们定义在GameMode中，名字叫 MyInitEvent。例子中定义的是无参函数，如果需要带参数，官方doc讲的有</p> 
 <pre><code class="language-cpp">UCLASS()
class MYPROJ_API AMyGameMode : public AGameMode
{
	GENERATED_BODY()
	
public:

	AHGameMode();

	//定义Event
	DECLARE_EVENT(MyUObject, MyInitEvent)
	
	//用于获取Event引用的函数，方便在GameMode之外执行binding
	MyInitEvent&amp; OnInitialize() { return InitEvent; }
	
private:
	//Event实例化
	MyInitEvent InitEvent;
	
	//Event的binding指针
	FDelegateHandle DHandle;
}</code></pre> 
 <p style="font-size:14px;"> </p> 
 <p style="font-size:14px;">2，执行Binding。MyUObject::TestFun是需要被触发的函数，这里假设是一个普通的无参成员函数：</p> 
 <pre><code class="language-cpp">MyUObject* MyObj = NULL;	//这里假设创建MyUObject
if (MyObj)
{
	DHandle = MyGameMode-&gt;OnInitialize().AddUObject(MyObj, &amp;MyUObject::TestFun);
}</code></pre> 
 <p style="font-size:14px;"> </p> 
 <p style="font-size:14px;">注：任何UObject的普通函数都可以被设置为Event的回调函数，但如果函数是UFUNCTION，那么需要将AddUObject替换为<strong>AddUFunction</strong>。</p> 
 <p style="font-size:14px;"> </p> 
 <p style="font-size:14px;">3，触发Event，这里假设在BeginPlay中触发：</p> 
 <pre><code class="language-cpp">void AMyGameMode::BeginPlay()
{
	InitEvent.Broadcast();
}</code></pre> 
 <p style="font-size:14px;"> </p> 
 <p style="font-size:14px;">4，移除Event，比如之前bingding的event不想再触发了：</p> 
 <pre><code class="language-cpp">MyGameMode-&gt;OnInitialize().Remove(DHandle);</code></pre> 
 <p style="font-size:14px;"> </p> 
 <p style="font-size:14px;"><strong>Event 和 Delegate 区别</strong></p> 
 <p style="font-size:14px;">Delegate 只能绑定一个回调函数，Delegate执行Execute()函数时，只会触发事先绑定的一个函数；Event可以绑定任意个函数，一旦执行Event的Broadcast()函数，所有回调函数按Add顺序依次执行。</p> 
 <p style="font-size:14px;">Dynamic Multicast Delegate也可以同时绑定多个回调函数，但是其运行效率要比 Event 慢。</p> 
 <p style="font-size:14px;"> </p> 
 <p style="font-size:14px;"><strong>Event 和 Delegate 共同点</strong></p> 
 <p style="font-size:14px;">回调函数都不能有返回值。</p> 
 <p style="font-size:14px;"> </p> 
 <p style="font-size:14px;"><strong>Dynamic Delegate 与 常规 </strong><strong>Delegate 区别</strong></p> 
 <p style="font-size:14px;">Dynamic Delegates 可以被序列化：即他们的注册函数可以通过名称查找获取，相比普通Delegate，速度要慢。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f24b98f31f1afec4515f29da9d8f6d5e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[UE4]Fog Of War(战争迷雾)教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1769efd112c820ed4b494e9965b85fca/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[C&#43;&#43;]比memcpy快50%的FastMemcpy</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>