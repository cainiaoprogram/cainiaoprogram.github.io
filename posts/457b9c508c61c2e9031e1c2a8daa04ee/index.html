<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python爬虫app步骤_Python爬虫抓取手机APP的传输数据，python爬虫抓取app - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python爬虫app步骤_Python爬虫抓取手机APP的传输数据，python爬虫抓取app" />
<meta property="og:description" content="Python爬虫抓取手机APP的传输数据，python爬虫抓取app
大多数APP里面返回的是json格式数据，或者一堆加密过的数据 。这里以超级课程表APP为例，抓取超级课程表里用户发的话题。
1、抓取APP数据包
方法详细可以参考这篇博文：Fiddler如何抓取手机APP数据包
得到超级课程表登录的地址：http://120.55.151.61/V2/StudentSkip/loginCheckV4.action
表单：
表单中包括了用户名和密码，当然都是加密过了的，还有一个设备信息，直接post过去就是。
另外必须加header,一开始我没有加header得到的是登录错误，所以要带上header信息。
2、登录
登录代码：
import urllib2
from cookielib import CookieJar
loginUrl = &#39;http://120.55.151.61/V2/StudentSkip/loginCheckV4.action&#39;
headers = {
&#39;Content-Type&#39;: &#39;application/x-www-form-urlencoded; charset=UTF-8&#39;,
&#39;User-Agent&#39;: &#39;Dalvik/1.6.0 (Linux; U; Android 4.1.1; M040 Build/JRO03H)&#39;,
&#39;Host&#39;: &#39;120.55.151.61&#39;,
&#39;Connection&#39;: &#39;Keep-Alive&#39;,
&#39;Accept-Encoding&#39;: &#39;gzip&#39;,
&#39;Content-Length&#39;: &#39;207&#39;,
}
loginData = &#39;phoneBrand=Meizu&amp;platform=1&amp;deviceCode=868033014919494&amp;account=FCF030E1F2F6341C1C93BE5BBC422A3D&amp;phoneVersion=16&amp;password=A55B48BB75C79200379D82A18C5F47D6&amp;channel=MXMarket&amp;phoneModel=M040&amp;versionNumber=7.2.1&amp;&#39;
cookieJar = CookieJar()
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookieJar))
req = urllib2.Request(loginUrl, loginData, headers)
loginResult = opener.open(req).read()
print loginResult
登录成功 会返回一串账号信息的json数据
和抓包时返回数据一样，证明登录成功
3、抓取数据
用同样方法得到话题的url和post参数
做法就和模拟登录网站一样。详见：Python爬虫模拟登录带验证码网站
下见最终代码，有主页获取和下拉加载更新。可以无限加载话题内容。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/457b9c508c61c2e9031e1c2a8daa04ee/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-30T13:32:20+08:00" />
<meta property="article:modified_time" content="2020-12-30T13:32:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python爬虫app步骤_Python爬虫抓取手机APP的传输数据，python爬虫抓取app</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>Python爬虫抓取手机APP的传输数据，python爬虫抓取app</p> 
 <p>大多数APP里面返回的是json格式数据，或者一堆加密过的数据 。这里以超级课程表APP为例，抓取超级课程表里用户发的话题。</p> 
 <p>1、抓取APP数据包</p> 
 <p>方法详细可以参考这篇博文：Fiddler如何抓取手机APP数据包</p> 
 <p>得到超级课程表登录的地址：http://120.55.151.61/V2/StudentSkip/loginCheckV4.action</p> 
 <p>表单：</p> 
 <p align="center"><img src="" alt=""></p> 
 <p>表单中包括了用户名和密码，当然都是加密过了的，还有一个设备信息，直接post过去就是。</p> 
 <p>另外必须加header,一开始我没有加header得到的是登录错误，所以要带上header信息。</p> 
 <p align="center"><img src="" alt=""></p> 
 <p>2、登录</p> 
 <p>登录代码：</p> 
 <p>import urllib2</p> 
 <p>from cookielib import CookieJar</p> 
 <p>loginUrl = 'http://120.55.151.61/V2/StudentSkip/loginCheckV4.action'</p> 
 <p>headers = {<!-- --></p> 
 <p>'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',</p> 
 <p>'User-Agent': 'Dalvik/1.6.0 (Linux; U; Android 4.1.1; M040 Build/JRO03H)',</p> 
 <p>'Host': '120.55.151.61',</p> 
 <p>'Connection': 'Keep-Alive',</p> 
 <p>'Accept-Encoding': 'gzip',</p> 
 <p>'Content-Length': '207',</p> 
 <p>}</p> 
 <p>loginData = 'phoneBrand=Meizu&amp;platform=1&amp;deviceCode=868033014919494&amp;account=FCF030E1F2F6341C1C93BE5BBC422A3D&amp;phoneVersion=16&amp;password=A55B48BB75C79200379D82A18C5F47D6&amp;channel=MXMarket&amp;phoneModel=M040&amp;versionNumber=7.2.1&amp;'</p> 
 <p>cookieJar = CookieJar()</p> 
 <p>opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookieJar))</p> 
 <p>req = urllib2.Request(loginUrl, loginData, headers)</p> 
 <p>loginResult = opener.open(req).read()</p> 
 <p>print loginResult</p> 
 <p>登录成功 会返回一串账号信息的json数据</p> 
 <p align="center"><img src="" alt=""></p> 
 <p>和抓包时返回数据一样，证明登录成功</p> 
 <p align="center"><img src="" alt=""></p> 
 <p>3、抓取数据</p> 
 <p>用同样方法得到话题的url和post参数</p> 
 <p>做法就和模拟登录网站一样。详见：Python爬虫模拟登录带验证码网站</p> 
 <p>下见最终代码，有主页获取和下拉加载更新。可以无限加载话题内容。</p> 
 <p>#!/usr/local/bin/python2.7</p> 
 <p># -*- coding: utf8 -*-</p> 
 <p>"""</p> 
 <p>超级课程表话题抓取</p> 
 <p>"""</p> 
 <p>import urllib2</p> 
 <p>from cookielib import CookieJar</p> 
 <p>import json</p> 
 <p>''' 读Json数据 '''</p> 
 <p>def fetch_data(json_data):</p> 
 <p>data = json_data['data']</p> 
 <p>timestampLong = data['timestampLong']</p> 
 <p>messageBO = data['messageBOs']</p> 
 <p>topicList = []</p> 
 <p>for each in messageBO:</p> 
 <p>topicDict = {}</p> 
 <p>if each.get('content', False):</p> 
 <p>topicDict['content'] = each['content']</p> 
 <p>topicDict['schoolName'] = each['schoolName']</p> 
 <p>topicDict['messageId'] = each['messageId']</p> 
 <p>topicDict['gender'] = each['studentBO']['gender']</p> 
 <p>topicDict['time'] = each['issueTime']</p> 
 <p>print each['schoolName'],each['content']</p> 
 <p>topicList.append(topicDict)</p> 
 <p>return timestampLong, topicList</p> 
 <p>''' 加载更多 '''</p> 
 <p>def load(timestamp, headers, url):</p> 
 <p>headers['Content-Length'] = '159'</p> 
 <p>loadData = 'timestamp=%s&amp;phoneBrand=Meizu&amp;platform=1&amp;genderType=-1&amp;topicId=19&amp;phoneVersion=16&amp;selectType=3&amp;channel=MXMarket&amp;phoneModel=M040&amp;versionNumber=7.2.1&amp;' % timestamp</p> 
 <p>req = urllib2.Request(url, loadData, headers)</p> 
 <p>loadResult = opener.open(req).read()</p> 
 <p>loginStatus = json.loads(loadResult).get('status', False)</p> 
 <p>if loginStatus == 1:</p> 
 <p>print 'load successful!'</p> 
 <p>timestamp, topicList = fetch_data(json.loads(loadResult))</p> 
 <p>load(timestamp, headers, url)</p> 
 <p>else:</p> 
 <p>print 'load fail'</p> 
 <p>print loadResult</p> 
 <p>return False</p> 
 <p>loginUrl = 'http://120.55.151.61/V2/StudentSkip/loginCheckV4.action'</p> 
 <p>topicUrl = 'http://120.55.151.61/V2/Treehole/Message/getMessageByTopicIdV3.action'</p> 
 <p>headers = {<!-- --></p> 
 <p>'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',</p> 
 <p>'User-Agent': 'Dalvik/1.6.0 (Linux; U; Android 4.1.1; M040 Build/JRO03H)',</p> 
 <p>'Host': '120.55.151.61',</p> 
 <p>'Connection': 'Keep-Alive',</p> 
 <p>'Accept-Encoding': 'gzip',</p> 
 <p>'Content-Length': '207',</p> 
 <p>}</p> 
 <p>''' ---登录部分--- '''</p> 
 <p>loginData = 'phoneBrand=Meizu&amp;platform=1&amp;deviceCode=868033014919494&amp;account=FCF030E1F2F6341C1C93BE5BBC422A3D&amp;phoneVersion=16&amp;password=A55B48BB75C79200379D82A18C5F47D6&amp;channel=MXMarket&amp;phoneModel=M040&amp;versionNumber=7.2.1&amp;'</p> 
 <p>cookieJar = CookieJar()</p> 
 <p>opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookieJar))</p> 
 <p>req = urllib2.Request(loginUrl, loginData, headers)</p> 
 <p>loginResult = opener.open(req).read()</p> 
 <p>loginStatus = json.loads(loginResult).get('data', False)</p> 
 <p>if loginResult:</p> 
 <p>print 'login successful!'</p> 
 <p>else:</p> 
 <p>print 'login fail'</p> 
 <p>print loginResult</p> 
 <p>''' ---获取话题--- '''</p> 
 <p>topicData = 'timestamp=0&amp;phoneBrand=Meizu&amp;platform=1&amp;genderType=-1&amp;topicId=19&amp;phoneVersion=16&amp;selectType=3&amp;channel=MXMarket&amp;phoneModel=M040&amp;versionNumber=7.2.1&amp;'</p> 
 <p>headers['Content-Length'] = '147'</p> 
 <p>topicRequest = urllib2.Request(topicUrl, topicData, headers)</p> 
 <p>topicHtml = opener.open(topicRequest).read()</p> 
 <p>topicJson = json.loads(topicHtml)</p> 
 <p>topicStatus = topicJson.get('status', False)</p> 
 <p>print topicJson</p> 
 <p>if topicStatus == 1:</p> 
 <p>print 'fetch topic success!'</p> 
 <p>timestamp, topicList = fetch_data(topicJson)</p> 
 <p>load(timestamp, headers, topicUrl)</p> 
 <p>结果：</p> 
 <p align="center"><img src="" alt=""></p> 
 <p>您可能感兴趣的文章:Fiddler如何抓取手机APP数据包</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6236830de5d25dea29a6d535071a1ae0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">sas univariate 结果解释_SAS第四章</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f9f1c5b57ecbd9e1c09aaaec4732f23d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">的cipher加密原理_安全第12讲——PBE加密算法的介绍与使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>