<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>springboot学习3-1 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="springboot学习3-1" />
<meta property="og:description" content="全注解下的 spring IOC
BeanFactory 是一个顶层的接口，它的源码：
可以从IOC容器获取bean， 按类型或者名称获取bean；
默认bean都是单例存在；
ApplicationContext， BeanFactory的一个子接口；
大部分IOC容器都是ApplicationContext接口的实现类；
ApplicationContext接口在BeanFactory基础上，扩展了消息国际化接口（MessageSource），环境可配置接口（EnvironmentCapable），应用事件发布接口（ApplicationEventPublisher），资源模式解析接口（ResourcePatterResolver）；
Spring boot使用注解装配bean 到IOC容器中去，而不是通过xml，
AnnotationConfigApplicationContext， 基于注解的IOC容器；
使用注解@Bean注入Spring Ioc容器中， 在一个配置java类中定义这些bean，然后这个类作为new AnnotationConfigApplicationContext（）的参数，将定义的bean注入IOC容器中，但是这样主要一个个bean都使用@Bean注入，很麻烦；
但是spring允许扫描装配Bean 到IOC容器中，使用注解@Component, @ComponentScan , 前者表明哪个类扫描注入Spring IOC容器，后者表示何种策略去扫描装配Bean，
比如在loginServiceImpl类上面添加@Service注解，而在配置类（AppConfig）上面加上@ComponentScan注解；
在main中代码：
一般都是把这个注解直接加到springboot 的启动类上（这也是一个配置类）；
@Service注解 是@Component的一个语义化的注解形式，本质还是@Component，
@ComponentScan允许我们自定义扫描的包，它的源码：
上面这些是它的常用配置项，basePackages定义扫描的包名，没有定义，就只扫描当前包，其子包下的路径；
excludeFilters 定义那些需要排除的Bean，比如有的时候模块不需要数据库相关的Bean，就需要使用到该配置项，否则的话没有进行数据库相关的配置，启动spring boot之后就会报错；
下面这个就说明了Service.class 虽然声明了@Service， 但是不装配它，不将其注入spring IOC容器中：
关于@SpringBootApplication：
它是一个组合注解，@Configuration &#43; @EnableAutoConfiguration&#43;@ComponentScan，它的源码：
下面是一般开发用的多的排除一些类的写法： 3.2 自定义第三方Bean
加入第三方包的类对象到 IOC容器中， @Bean注解；
例如引入DBCP数据源， 首先pom.xml 中加入所需的DBCP包，数据库Mysql驱动程序的依赖；
接着使用DBCP生成数据源，再将其放入AppConfig.java 中；
实际开发中用的多的其实是在application.properties中来声明数据源相关的配置，使用jdbc.properties 来声明具体的配置值；
3.3 依赖注入
使用注解@Autowired ，默认使用类型进行匹配Bean；by type；
但是当 type匹配到不止一个时，会报错， 比如注入的是Animal接口， 而其实现类有Dog， Cat，那么就会报错；" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b3b210e97098423c65c71966f087033a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-10T17:18:05+08:00" />
<meta property="article:modified_time" content="2021-08-10T17:18:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">springboot学习3-1</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0;">全注解下的 spring IOC</p> 
<p style="margin-left:0;">BeanFactory 是一个顶层的接口，它的源码：<img alt="" height="520" src="https://images2.imgbox.com/a6/01/AZvatsIj_o.png" width="938"></p> 
<p> <img alt="" height="453" src="https://images2.imgbox.com/57/4b/0A975xTB_o.png" width="915"></p> 
<p style="margin-left:0;">可以从IOC容器获取bean， 按类型或者名称获取bean；</p> 
<p style="margin-left:0;">默认bean都是单例存在；</p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;">ApplicationContext， BeanFactory的一个子接口；</p> 
<p style="margin-left:0;">大部分IOC容器都是ApplicationContext接口的实现类；</p> 
<p style="margin-left:0;"><img alt="" height="509" src="https://images2.imgbox.com/95/d5/hELgMNbt_o.png" width="837"></p> 
<p style="margin-left:0;">ApplicationContext接口在BeanFactory基础上，扩展了消息国际化接口（MessageSource），环境可配置接口（EnvironmentCapable），应用事件发布接口（ApplicationEventPublisher），资源模式解析接口（ResourcePatterResolver）；</p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;">Spring boot使用注解装配bean 到IOC容器中去，而不是通过xml，</p> 
<p style="margin-left:0;">AnnotationConfigApplicationContext， 基于注解的IOC容器；</p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;">使用注解@Bean注入Spring Ioc容器中， 在一个配置java类中定义这些bean，然后这个类作为new AnnotationConfigApplicationContext（）的参数，将定义的bean注入IOC容器中，但是这样主要一个个bean都使用@Bean注入，很麻烦；</p> 
<p style="margin-left:0;">但是spring允许扫描装配Bean 到IOC容器中，使用注解@Component, @ComponentScan , 前者表明哪个类扫描注入Spring IOC容器，后者表示何种策略去扫描装配Bean，</p> 
<p style="margin-left:0;">比如在loginServiceImpl类上面添加@Service注解，而在配置类（AppConfig）上面加上@ComponentScan注解；</p> 
<p style="margin-left:0;">在main中代码：</p> 
<p style="margin-left:0;"><img alt="" height="114" src="https://images2.imgbox.com/8a/74/99xMRBKO_o.png" width="710"></p> 
<p style="margin-left:0;">一般都是把这个注解直接加到springboot 的启动类上（这也是一个配置类）；</p> 
<p style="margin-left:0;">@Service注解 是@Component的一个语义化的注解形式，本质还是@Component，</p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;">@ComponentScan允许我们自定义扫描的包，它的源码：<img alt="" height="472" src="https://images2.imgbox.com/75/c3/YWcEDsLL_o.png" width="735"></p> 
<p><img alt="" height="209" src="https://images2.imgbox.com/09/14/tMD8N5gg_o.png" width="529"> </p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;">上面这些是它的常用配置项，basePackages定义扫描的包名，没有定义，就只扫描当前包，其子包下的路径；</p> 
<p style="margin-left:0;">excludeFilters 定义那些需要排除的Bean，比如有的时候模块不需要数据库相关的Bean，就需要使用到该配置项，否则的话没有进行数据库相关的配置，启动spring boot之后就会报错；</p> 
<p style="margin-left:0;"><img alt="" height="184" src="https://images2.imgbox.com/db/0b/x9U6u4QO_o.png" width="759"></p> 
<p><img alt="" height="41" src="https://images2.imgbox.com/e5/1a/RFiyBFAx_o.png" width="617"> </p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;">下面这个就说明了Service.class 虽然声明了@Service， 但是不装配它，不将其注入spring IOC容器中：<img alt="" height="84" src="https://images2.imgbox.com/7f/72/ipxcY6Dy_o.png" width="795"></p> 
<p></p> 
<p></p> 
<p style="margin-left:0;">关于@SpringBootApplication：</p> 
<p style="margin-left:0;">它是一个组合注解，@Configuration + @EnableAutoConfiguration+@ComponentScan，它的源码：<img alt="" height="314" src="https://images2.imgbox.com/9d/d6/AZ2Y3F84_o.png" width="1002"></p> 
<p><img alt="" height="402" src="https://images2.imgbox.com/dc/56/2liTI8Q4_o.png" width="1015"> </p> 
<p>下面是一般开发用的多的排除一些类的写法：<img alt="" height="93" src="https://images2.imgbox.com/fe/91/7UKuERqb_o.png" width="702"> </p> 
<p style="margin-left:0;">3.2  自定义第三方Bean</p> 
<p style="margin-left:0;">加入第三方包的类对象到 IOC容器中， @Bean注解；</p> 
<p style="margin-left:0;">例如引入DBCP数据源， 首先pom.xml 中加入所需的DBCP包，数据库Mysql驱动程序的依赖；</p> 
<p style="margin-left:0;"><img alt="" height="193" src="https://images2.imgbox.com/a2/05/dPHrF8H0_o.png" width="610"></p> 
<p> </p> 
<p style="margin-left:0;">接着使用DBCP生成数据源，再将其放入AppConfig.java 中；</p> 
<p style="margin-left:0;"><img alt="" height="92" src="https://images2.imgbox.com/1c/5a/WQxDuJcy_o.png" width="477"></p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;"><img alt="" height="280" src="https://images2.imgbox.com/c9/d2/6HeVRWCE_o.png" width="816"></p> 
<p> </p> 
<p style="margin-left:0;">实际开发中用的多的其实是在application.properties中来声明数据源相关的配置，使用jdbc.properties 来声明具体的配置值；</p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;">3.3 依赖注入</p> 
<p style="margin-left:0;">使用注解@Autowired ，默认使用类型进行匹配Bean；by  type；</p> 
<p style="margin-left:0;">但是当 type匹配到不止一个时，会报错， 比如注入的是Animal接口， 而其实现类有Dog， Cat，那么就会报错；</p> 
<p style="margin-left:0;"><img alt="" height="70" src="https://images2.imgbox.com/27/9d/u7r8uqrR_o.png" width="379"></p> 
<p> 修改为：</p> 
<p><img alt="" height="65" src="https://images2.imgbox.com/ce/d3/JHXPfsTW_o.png" width="382"></p> 
<p style="margin-left:0;">根据属性名+Bean的名称来匹配；</p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;">当@Autowired 注解时，不能确定其标注的属性一定会存在，并允许这个被标注的属性为null， 可以配置如下：</p> 
<p style="margin-left:0;"><img alt="" height="38" src="https://images2.imgbox.com/7f/ec/lrLXs4Vd_o.png" width="359"></p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;">@Autowired 除了标注属性外，还可以标注方法，以及标注方法的参数；</p> 
<p style="margin-left:0;"><img alt="" height="126" src="https://images2.imgbox.com/e3/af/ZPi8buDY_o.png" width="483"></p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;"> 消除歧义性----@Primary和@Quelifier</p> 
<p style="margin-left:0;">上面的动物，和猫，狗的情况；</p> 
<p style="margin-left:0;">首先@Primary，优先权的注解，有猫有狗时，如果在猫类上加入这个注解，那么找到多个同类型的Bean时，会优先使用这个注解的类的实例；</p> 
<p style="margin-left:0;">但是多个类都可以标注这个注解， 猫和狗都标注，还是会不知道用哪个Bean，</p> 
<p style="margin-left:0;">这时使用@Quelifier，value需要一个字符串去定义，将与@Autowired组合到一起，通过类型和名称找到Bean；</p> 
<p style="margin-left:0;"><img alt="" height="86" src="https://images2.imgbox.com/ec/dc/5kzIpCRp_o.png" width="401"></p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;">上面的都基于一个默认情况，就是不带参数的构造方法实现依赖注入；</p> 
<p style="margin-left:0;">但是有的类只有有参数的构造方法，那上面的依赖注入方法就不可用了，</p> 
<p style="margin-left:0;">这时需要使用@Autowired注解对构造方法的参数进行注入，</p> 
<p> <img alt="" height="470" src="https://images2.imgbox.com/48/8b/kudsn3GU_o.png" width="913"></p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7d8a3e133c2fae4ba023b1ae80c28bee/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">springboot 学习2</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/562bef8801e6e73f65d3a992a092ccd3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">无限法则服务器错误代码,无限法则Error Report怎么办_无限法则Europa encountered 报错解决方法_游戏吧...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>