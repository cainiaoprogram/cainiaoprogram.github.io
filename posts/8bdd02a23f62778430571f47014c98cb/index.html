<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>20211008 FlinkSql测试-1.12版本 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="20211008 FlinkSql测试-1.12版本" />
<meta property="og:description" content="一、flinkSql-Client /mnt/flink-1.12.4/bin/start-cluster.sh --启动集群 /mnt/flink-1.12.4/bin/sql-client.sh embedded --进入sql客户端 二、FlinkSql函数 1、比较函数 = &lt;&gt; &gt; &gt;= &lt; &lt;= 注意：select null=null; 返回为null IS NULL 、 IS NOT NULL --非空判断 value1 IS DISTINCT FROM value2、value1 IS NOT DISTINCT FROM value2、 --不同于 value1 BETWEEN [ ASYMMETRIC | SYMMETRIC ] value2 AND value3、value1 NOT BETWEEN [ ASYMMETRIC | SYMMETRIC ] value2 AND value3、 --如：select 1 between 0 and 2; 返回true。默认ASYMMETRIC 表示value1在闭区间内 [value2,value3] string1 LIKE string2 、string1 NOT LIKE string2 --如：select &#39;abc&#39; like &#39;a%&#39;; 返回true，用 &#39;用%或_模糊数据&#39; string1 SIMILAR TO string2 、string1 NOT SIMILAR TO string2 --string2 为正则表达式." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8bdd02a23f62778430571f47014c98cb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-08T20:17:10+08:00" />
<meta property="article:modified_time" content="2021-10-08T20:17:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">20211008 FlinkSql测试-1.12版本</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="flinkSqlClient_0"></a>一、flinkSql-Client</h3> 
<pre><code class="prism language-shell">/mnt/flink-1.12.4/bin/start-cluster.sh  --启动集群
/mnt/flink-1.12.4/bin/sql-client.sh embedded  --进入sql客户端
</code></pre> 
<h3><a id="FlinkSql_7"></a>二、FlinkSql函数</h3> 
<h3><a id="1_9"></a>1、比较函数</h3> 
<pre><code class="prism language-shell">    <span class="token operator">=</span> <span class="token operator">&lt;&gt;</span> <span class="token operator">&gt;</span>  <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token operator">&lt;</span>  <span class="token operator">&lt;</span><span class="token operator">=</span>  
        注意：select <span class="token assign-left variable">null</span><span class="token operator">=</span>null<span class="token punctuation">;</span> 返回为null
    IS NULL 、 IS NOT NULL  
        --非空判断
    value1 IS DISTINCT FROM value2、value1 IS NOT DISTINCT FROM value2、  
        --不同于
    value1 BETWEEN <span class="token punctuation">[</span> ASYMMETRIC <span class="token operator">|</span> SYMMETRIC <span class="token punctuation">]</span> value2 AND value3、value1 NOT BETWEEN <span class="token punctuation">[</span> ASYMMETRIC <span class="token operator">|</span> SYMMETRIC <span class="token punctuation">]</span> value2 AND value3、 
        --如：select <span class="token number">1</span> between <span class="token number">0</span> and <span class="token number">2</span><span class="token punctuation">;</span> 返回true。默认ASYMMETRIC 表示value1在闭区间内 <span class="token punctuation">[</span>value2,value3<span class="token punctuation">]</span>
    string1 LIKE string2 、string1 NOT LIKE string2 
        --如：select <span class="token string">'abc'</span> like <span class="token string">'a%'</span><span class="token punctuation">;</span> 返回true，用 <span class="token string">'用%或_模糊数据'</span>
    string1 SIMILAR TO string2 、string1 NOT SIMILAR TO string2 
        --string2 为正则表达式. 但测试失败 <span class="token keyword">select</span> <span class="token string">'fgh34444'</span> SIMILAR TO  <span class="token string">'[a-z][0-9]*'</span><span class="token punctuation">;</span> 返回的false
    value1 IN <span class="token punctuation">(</span>value2 <span class="token punctuation">[</span>, value3<span class="token punctuation">]</span>* <span class="token punctuation">)</span>、value1 NOT IN <span class="token punctuation">(</span>value2 <span class="token punctuation">[</span>, value3<span class="token punctuation">]</span>* <span class="token punctuation">)</span>、
        -- <span class="token keyword">select</span> <span class="token string">'abc'</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'abc'</span>,<span class="token string">'e'</span>,<span class="token string">'f'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回true，要求类型必须一致<span class="token punctuation">(</span>都为字符串，或都为<span class="token punctuation">)</span>。select <span class="token for-or-select variable">1</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">1,2</span>,3,4<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    EXISTS <span class="token punctuation">(</span>sub-query<span class="token punctuation">)</span>、
        --select  EXISTS <span class="token punctuation">(</span>select <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回true（自查询至少返回一行时）
    value IN <span class="token punctuation">(</span>sub-query<span class="token punctuation">)</span>、value NOT IN <span class="token punctuation">(</span>sub-query<span class="token punctuation">)</span>
        --select <span class="token for-or-select variable">1</span> <span class="token keyword">in</span> <span class="token punctuation">(</span>select <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 值等于子查询返回的行<span class="token punctuation">(</span>只限于一个值<span class="token punctuation">)</span>，返回true. <span class="token keyword">select</span> <span class="token string">'abc'</span> <span class="token keyword">in</span> <span class="token punctuation">(</span>select <span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> 
<h3><a id="2_32"></a>2、逻辑函数</h3> 
<pre><code class="prism language-shell">    OR 、AND、NOT boolean、boolean IS FALSE、boolean IS NOT FALSE、boolean IS TRUE、boolean IS NOT TRUE、boolean IS UNKNOWN、boolean IS NOT UNKNOWN
        --select <span class="token assign-left variable">null</span><span class="token operator">=</span>null  IS UNKNOWN<span class="token punctuation">;</span> 返回true
</code></pre> 
<h3><a id="3_39"></a>3、算术函数</h3> 
<pre><code class="prism language-shell">    + numeric、- numeric --返回对应的正负数字
    + - * / 
    % 、MOD<span class="token punctuation">(</span>numeric1, numeric2<span class="token punctuation">)</span> 
    	-- <span class="token keyword">select</span> MOD<span class="token punctuation">(</span><span class="token number">3,2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token number">3</span>除以2的余数<span class="token operator">=</span><span class="token number">1</span>.仅当numeric1为负时结果为负
    POWER<span class="token punctuation">(</span>numeric1, numeric2<span class="token punctuation">)</span> 
    	--select POWER<span class="token punctuation">(</span><span class="token number">2,3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回2 的 <span class="token number">3</span>次幂<span class="token operator">=</span><span class="token number">8.0</span>
    ABS<span class="token punctuation">(</span>numeric<span class="token punctuation">)</span> 
    	--select ABS<span class="token punctuation">(</span>-1<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回绝对值1
    CEIL<span class="token punctuation">(</span>numeric<span class="token punctuation">)</span> --向上取整  <span class="token keyword">select</span> CEIL<span class="token punctuation">(</span><span class="token number">2.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回3.000000
    FLOOR<span class="token punctuation">(</span>numeric<span class="token punctuation">)</span> --向下取整 <span class="token keyword">select</span> FLOOR<span class="token punctuation">(</span><span class="token number">2.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回2.000000
    ROUND<span class="token punctuation">(</span>numeric, integer<span class="token punctuation">)</span> 取整
        --select ROUND<span class="token punctuation">(</span><span class="token number">2.3</span>,1<span class="token punctuation">)</span><span class="token punctuation">;</span> 保留1位小数2.30000。
        --select ROUND<span class="token punctuation">(</span><span class="token number">2.3</span>,0<span class="token punctuation">)</span><span class="token punctuation">;</span> 保留0位小数 <span class="token number">2.0000</span>
    TRUNCATE<span class="token punctuation">(</span>numeric1, integer2<span class="token punctuation">)</span> 
        --select TRUNCATE<span class="token punctuation">(</span><span class="token number">2.3</span>,1<span class="token punctuation">)</span><span class="token punctuation">;</span>保留1位小数2.30000  <span class="token keyword">select</span> TRUNCATE<span class="token punctuation">(</span><span class="token number">2.3</span>,0<span class="token punctuation">)</span> 保留0位小数 <span class="token number">2.0000</span>
    RAND<span class="token punctuation">(</span><span class="token punctuation">)</span> --介于 <span class="token number">0.0</span>（含）和 <span class="token number">1.0</span>（不含）之间的伪随机双精度值
    RAND<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> --介于 <span class="token number">0.0</span>（含）和 <span class="token number">1.0</span>（不含）之间的伪随机双精度值。两个 RAND 函数具有相同的初始种子，它们将返回相同的数字序列。
    RAND_INTEGER<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> --介于 <span class="token number">0</span>（含）和整数（不含）之间的伪随机整数值
     --使用初始种子返回 <span class="token number">0</span>（含）和指定值（不含）之间的伪随机整数值
    UUID<span class="token punctuation">(</span><span class="token punctuation">)</span> --返回 UUID（通用唯一标识符）字符串（例如，“3d3c68f7-f608-473f-b60c-b0c44ad4cc4e”）。UUID 是使用加密强的伪随机数生成器生成的。
    BIN<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> --以二进制格式返回整数的字符串表示形式。如果整数为 NULL，则返回NULL。例如，BIN<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>返回“100”并BIN<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>返回“1100”
    HEX<span class="token punctuation">(</span>numeric 或 string<span class="token punctuation">)</span> --以十六进制格式返回整数数值或字符串的字符串表示形式
</code></pre> 
<h3><a id="4_66"></a>4、字符串函数</h3> 
<pre><code class="prism language-shell">
    string1 <span class="token operator">||</span> string2  --拼接
        --select <span class="token string">'abc'</span> <span class="token operator">||</span> <span class="token string">'def'</span><span class="token punctuation">;</span> 返回abcdef
    CHAR_LENGTH<span class="token punctuation">(</span>string<span class="token punctuation">)</span>  --字符个数
        --select CHAR_LENGTH<span class="token punctuation">(</span><span class="token string">'abcdef'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">6</span> 
    UPPER<span class="token punctuation">(</span>string<span class="token punctuation">)</span> --转大写
        --select UPPER<span class="token punctuation">(</span><span class="token string">'aBc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 ABC
    LOWER<span class="token punctuation">(</span>string<span class="token punctuation">)</span> --转小写
        --select LOWER<span class="token punctuation">(</span><span class="token string">'aBc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回abc
    POSITION<span class="token punctuation">(</span>string1 IN string2<span class="token punctuation">)</span> --字串位置
        --select POSITION<span class="token punctuation">(</span><span class="token string">'ab'</span> <span class="token keyword">in</span> <span class="token string">'cdabcds'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回3
    TRIM<span class="token punctuation">(</span><span class="token punctuation">[</span> BOTH <span class="token operator">|</span> LEADING <span class="token operator">|</span> TRAILING <span class="token punctuation">]</span> string1 FROM string2<span class="token punctuation">)</span> --默认从两边去除第一个
        --select TRIM<span class="token punctuation">(</span><span class="token string">'  abc    '</span> from <span class="token string">'  abcdefabc  '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回def 。select TRIM<span class="token punctuation">(</span><span class="token string">'  abc    '</span><span class="token punctuation">)</span>； 返回abc  两边的空格都被删除
    LTRIM<span class="token punctuation">(</span>string<span class="token punctuation">)</span> --去除左边的空格
    RTRIM<span class="token punctuation">(</span>string<span class="token punctuation">)</span> --去除右边的空格
    REPEAT<span class="token punctuation">(</span>string, integer<span class="token punctuation">)</span> --重复字符串整数次
        --select REPEAT<span class="token punctuation">(</span><span class="token string">'ab'</span>,3<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 ababab
    REGEXP_REPLACE<span class="token punctuation">(</span>string1, string2, string3<span class="token punctuation">)</span> --将string1中符合正则表达式的 替换为 string3
        --select REGEXP_REPLACE<span class="token punctuation">(</span><span class="token string">'foobar'</span>, <span class="token string">'oo|ar'</span>, <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 fb  
    OVERLAY<span class="token punctuation">(</span>string1 PLACING string2 FROM integer1 <span class="token punctuation">[</span> FOR integer2 <span class="token punctuation">]</span><span class="token punctuation">)</span> --将指定位置的字符串替换
        --select OVERLAY<span class="token punctuation">(</span><span class="token string">'This is an old string'</span> PLACING <span class="token string">' new'</span> FROM <span class="token number">10</span> FOR <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  返回 This is a new string  --不含FROM <span class="token number">10</span>
    SUBSTRING<span class="token punctuation">(</span>string FROM integer1 <span class="token punctuation">[</span> FOR integer2 <span class="token punctuation">]</span><span class="token punctuation">)</span> --从指定位置截取指定长度的字串
        --select SUBSTRING<span class="token punctuation">(</span><span class="token string">'This is an old string'</span>FROM <span class="token number">10</span> FOR <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  返回 n old   --含FROM <span class="token number">10</span>
    REPLACE<span class="token punctuation">(</span>string1, string2, string3<span class="token punctuation">)</span> --替换
        --select REPLACE<span class="token punctuation">(</span><span class="token string">'ababab'</span>, <span class="token string">'abab'</span>, <span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  用z替换abab 返回zab
    REGEXP_EXTRACT<span class="token punctuation">(</span>string1, string2<span class="token punctuation">[</span>, integer<span class="token punctuation">]</span><span class="token punctuation">)</span> --？
        --select REGEXP_EXTRACT<span class="token punctuation">(</span><span class="token string">'foothebar'</span>, <span class="token string">'foo(.*?)(bar)'</span>, <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 bar  --正则表达式匹配组索引从 <span class="token number">1</span> 开始，0 表示匹配整个正则表达式
    INITCAP<span class="token punctuation">(</span>string<span class="token punctuation">)</span> --第一个字符转换为大写，其余字符转换为小写
        --select INITCAP<span class="token punctuation">(</span><span class="token string">'aBc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  返回 Abc
    CONCAT<span class="token punctuation">(</span>string1, string2,<span class="token punctuation">..</span>.<span class="token punctuation">)</span> --拼接，如果任何参数为 NULL，则返回 NULL。

    CONCAT_WS<span class="token punctuation">(</span>string1, string2, string3,<span class="token punctuation">..</span>.<span class="token punctuation">)</span> --拼接，第一个字符拼接符不为null则不为null
        --select CONCAT_WS<span class="token punctuation">(</span><span class="token string">'~'</span>, <span class="token string">'AA'</span>, NULL, <span class="token string">'BB'</span>, <span class="token string">''</span>, <span class="token string">'CC'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>会报错 Illegal use of <span class="token string">'NULL'</span>  --但官网说会跳过null
        --select CONCAT_WS<span class="token punctuation">(</span><span class="token string">'~'</span>, <span class="token string">'AA'</span>, <span class="token string">'BB'</span>, <span class="token string">''</span>, <span class="token string">'CC'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回“AA~BB~~CC”
    LPAD<span class="token punctuation">(</span>string1, integer, string2<span class="token punctuation">)</span> --从string1左边填充string2到整数字符的长度。如果string1的长度小于integer，则返回string1缩短为整数字符
        --LPAD<span class="token punctuation">(</span><span class="token string">'hi'</span>,4,<span class="token string">'??'</span><span class="token punctuation">)</span>返回“??hi”；LPAD<span class="token punctuation">(</span><span class="token string">'hi'</span>,1,<span class="token string">'??'</span><span class="token punctuation">)</span>返回“h”。 
    RPAD<span class="token punctuation">(</span>string1, integer, string2<span class="token punctuation">)</span> --从右边填充
        --RPAD<span class="token punctuation">(</span><span class="token string">'hi'</span>,4,<span class="token string">'??'</span><span class="token punctuation">)</span>返回“hi??”，RPAD<span class="token punctuation">(</span><span class="token string">'hi'</span>,1,<span class="token string">'??'</span><span class="token punctuation">)</span>返回“h”
    FROM_BASE64<span class="token punctuation">(</span>string<span class="token punctuation">)</span> --从string返回 base64 解码的结果；如果字符串为 NULL，则返回NULL。
        --FROM_BASE64<span class="token punctuation">(</span><span class="token string">'aGVsbG8gd29ybGQ='</span><span class="token punctuation">)</span>返回“hello world”。
    TO_BASE64<span class="token punctuation">(</span>string<span class="token punctuation">)</span> --从string返回 base64 编码的结果；如果字符串为 NULL，则返回NULL。
        --TO_BASE64<span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span>返回“aGVsbG8gd29ybGQ<span class="token operator">=</span>”。
    ASCII<span class="token punctuation">(</span>string<span class="token punctuation">)</span> --	返回string的第一个字符的数值
        --ascii<span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span>返回 <span class="token number">97</span> <span class="token punctuation">(</span>a的ascii码<span class="token punctuation">)</span>，并ascii<span class="token punctuation">(</span>CAST<span class="token punctuation">(</span>NULL AS VARCHAR<span class="token punctuation">))</span>返回 NULL。
    CHR<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> --返回二进制等效于integer的 ASCII 字符.如果整数大于 <span class="token number">255</span>，我们将先得到整数除以 <span class="token number">255</span>的模数，并返回模数的CHR。如果整数为 NULL，则返回NULL。
        --chr<span class="token punctuation">(</span><span class="token number">97</span><span class="token punctuation">)</span>返回a，chr<span class="token punctuation">(</span><span class="token number">353</span><span class="token punctuation">)</span>返回a
    DECODE<span class="token punctuation">(</span>binary, string<span class="token punctuation">)</span> ---使用提供的字符集（<span class="token string">'US-ASCII'</span>、<span class="token string">'ISO-8859-1'</span>、<span class="token string">'UTF-8'</span>、<span class="token string">'UTF-16BE'</span>、<span class="token string">'UTF-16LE'</span>、<span class="token string">'UTF- 16'</span><span class="token punctuation">)</span>
        --报错
    ENCODE<span class="token punctuation">(</span>string1, string2<span class="token punctuation">)</span><span class="token punctuation">;</span> --使用指定
        --select ENCODE<span class="token punctuation">(</span><span class="token string">'a'</span>, <span class="token string">'UTF-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   --报错
    INSTR<span class="token punctuation">(</span>string1, string2<span class="token punctuation">)</span>  --返回string2在string1 中第一次出现的位置
        --select INSTR<span class="token punctuation">(</span><span class="token string">'bcab'</span>,<span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回3
    LEFT<span class="token punctuation">(</span>string, integer<span class="token punctuation">)</span> --从左边截取
        --select LEFT<span class="token punctuation">(</span><span class="token string">'abc2awe'</span>,2<span class="token punctuation">)</span><span class="token punctuation">;</span>   返回ab
    RIGHT<span class="token punctuation">(</span>string, integer<span class="token punctuation">)</span> --从右边截取
        --select RIGHT<span class="token punctuation">(</span><span class="token string">'abcawe'</span>,3<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回awe 从右边截取3个
    LOCATE<span class="token punctuation">(</span>string1, string2<span class="token punctuation">[</span>, integer<span class="token punctuation">]</span><span class="token punctuation">)</span> --返回string2中string1在位置integer之后第一次出现的位置。如果未找到，则返回 <span class="token number">0</span>
        --select LOCATE<span class="token punctuation">(</span><span class="token string">'abcdefabc'</span>,<span class="token string">'a'</span>,3<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回0 --不符合预期
    PARSE_URL<span class="token punctuation">(</span>string1, string2<span class="token punctuation">[</span>, string3<span class="token punctuation">]</span><span class="token punctuation">)</span>
        --select parse_url<span class="token punctuation">(</span><span class="token string">'http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1'</span>, <span class="token string">'HOST'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 facebook.com
    REGEXP<span class="token punctuation">(</span>string1, string2<span class="token punctuation">)</span> --如果string1 的任何（可能为空）子字符串与 Java 正则表达式string2匹配，则返回 TRUE 
    REVERSE<span class="token punctuation">(</span>string<span class="token punctuation">)</span> --反转 
        --select REVERSE<span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回cba 
    SPLIT_INDEX<span class="token punctuation">(</span>string1, string2, integer1<span class="token punctuation">)</span> --用分割符分割后取第n个字串（从0开始）
        --select SPLIT_INDEX<span class="token punctuation">(</span><span class="token string">'abc|def|ghi'</span>,<span class="token string">'|'</span>,2<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回ghi 
    STR_TO_MAP<span class="token punctuation">(</span>string1<span class="token punctuation">[</span>, string2, string3<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> --使用分隔符将string1拆分为键/值对后返回一个映射。string2是对分隔符，默认为 <span class="token string">','</span>。而string3是键值分隔符，默认为 <span class="token string">'='</span>
        --select STR_TO_MAP<span class="token punctuation">(</span><span class="token string">'a=1,b=2,c=3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token punctuation">{<!-- --></span>a<span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">b</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">c</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">}</span>
        --select STR_TO_MAP<span class="token punctuation">(</span><span class="token string">'a:1|b:2|c:3'</span>,<span class="token string">'|'</span>,<span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回  的结果不符合预期   <span class="token punctuation">{<!-- --></span><span class="token operator">=</span>, <span class="token assign-left variable">a</span><span class="token operator">=</span>null, <span class="token assign-left variable">1</span><span class="token operator">=</span>null, <span class="token assign-left variable">b</span><span class="token operator">=</span>nu~
    SUBSTR<span class="token punctuation">(</span>string<span class="token punctuation">[</span>, integer1<span class="token punctuation">[</span>, integer2<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> --返回字符串的子字符串，从位置 integer1 开始，长度为 integer2（默认到末尾）。
        --select substr<span class="token punctuation">(</span><span class="token string">'abc'</span>,1,2<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回ab
</code></pre> 
<h3><a id="5_141"></a>5、时间函数（时间搓单位都是秒）</h3> 
<pre><code class="prism language-shell">            timeintervalunit时间单位：SECOND，MINUTE，HOUR，DAY，WEEK，MONTH，QUARTER，或YEAR。
            <span class="token keyword">select</span> REPLACE<span class="token punctuation">(</span><span class="token string">'hello world'</span>, <span class="token string">'world'</span>, <span class="token string">'flink'</span><span class="token punctuation">)</span> returns <span class="token string">"hello flink"</span><span class="token punctuation">;</span> REPLACE<span class="token punctuation">(</span><span class="token string">'ababab'</span>, <span class="token string">'abab'</span>, <span class="token string">'z'</span><span class="token punctuation">)</span> returns <span class="token string">"zab"</span><span class="token builtin class-name">.</span>
            <span class="token keyword">select</span> CONCAT<span class="token punctuation">(</span><span class="token string">'AA'</span>, <span class="token string">'BB'</span>, <span class="token string">'CC'</span><span class="token punctuation">)</span> returns <span class="token string">"AABBCC"</span><span class="token punctuation">;</span>
    DATE_FORMAT<span class="token punctuation">(</span>timestamp, string<span class="token punctuation">)</span> 此功能存在严重错误，暂时不要使用。
    INTERVAL string range   使用报错
        --select INTERVAL <span class="token string">'10 00:00:00.004'</span> DAY TO SECOND<span class="token punctuation">;</span>
        --select INTERVAL <span class="token string">'1'</span> HOUR<span class="token punctuation">;</span>  
        --select INTERVAL <span class="token string">'1'</span> MINUTE<span class="token punctuation">;</span>
    CURRENT_DATE        UTC 时区 系统日期
        --select CURRENT_DATE<span class="token punctuation">;</span> 返回 <span class="token number">2021</span>-10-08
    CURRENT_TIME        UTC 时区 系统时间
        --select CURRENT_TIME<span class="token punctuation">;</span> 返回 09:25:28.137
    CURRENT_TIMESTAMP  UTC 时区 系统时间搓，TIMESTAMP 类型
        --select CURRENT_TIMESTAMP<span class="token punctuation">;</span> 返回 <span class="token number">2021</span>-10-08T09:23:15.180  --数据不对，和时区有关系
    LOCALTIMESTAMP 本地时区系统时间， TIMESTAMP 类型
        --select LOCALTIMESTAMP<span class="token punctuation">;</span> 返回 <span class="token number">2021</span>-10-08T17:19:47.787 --时间对
    LOCALTIME 系统时间字符串（HH:mm:ss）
        --select LOCALTIME； 返回 <span class="token number">17</span>:22:16.212
    EXTRACT<span class="token punctuation">(</span>timeintervalunit FROM temporal<span class="token punctuation">)</span> 取日期中的年/月/日 返回整数
        --select EXTRACT<span class="token punctuation">(</span>DAY FROM DATE <span class="token string">'2006-06-05'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回  日 为 <span class="token number">5</span>
        --select EXTRACT<span class="token punctuation">(</span>MONTH FROM DATE <span class="token string">'2006-06-05'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回  月 为 <span class="token number">6</span>
        --select EXTRACT<span class="token punctuation">(</span>YEAR FROM DATE <span class="token string">'2006-06-05'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回  年 为 <span class="token number">2006</span>
    YEAR<span class="token punctuation">(</span>date<span class="token punctuation">)</span> 年份
        --select YEAR<span class="token punctuation">(</span>TO_DATE<span class="token punctuation">(</span><span class="token string">'2021-10-08 08:45:17'</span><span class="token punctuation">))</span><span class="token punctuation">;</span>  返回2021
    QUARTER<span class="token punctuation">(</span>date<span class="token punctuation">)</span> 几季度
        --select QUARTER<span class="token punctuation">(</span>TO_DATE<span class="token punctuation">(</span><span class="token string">'2021-10-08 08:45:17'</span><span class="token punctuation">))</span><span class="token punctuation">;</span>  返回4
    MONTH<span class="token punctuation">(</span>date<span class="token punctuation">)</span> 几月
        --select MONTH<span class="token punctuation">(</span>TO_DATE<span class="token punctuation">(</span><span class="token string">'2021-10-08 08:45:17'</span><span class="token punctuation">))</span><span class="token punctuation">;</span>  返回 <span class="token number">10</span>
    WEEK<span class="token punctuation">(</span>date<span class="token punctuation">)</span> 几周
        --select WEEK<span class="token punctuation">(</span>TO_DATE<span class="token punctuation">(</span><span class="token string">'2021-10-08 08:45:17'</span><span class="token punctuation">))</span><span class="token punctuation">;</span>  返回 <span class="token number">40</span>
    DAYOFYEAR<span class="token punctuation">(</span>date<span class="token punctuation">)</span> 一年中的第几天
        --select DAYOFYEAR<span class="token punctuation">(</span>TO_DATE<span class="token punctuation">(</span><span class="token string">'2021-10-08 08:45:17'</span><span class="token punctuation">))</span><span class="token punctuation">;</span>  返回281
    DAYOFMONTH<span class="token punctuation">(</span>date<span class="token punctuation">)</span> 一月中的第几天
        --select DAYOFMONTH<span class="token punctuation">(</span>TO_DATE<span class="token punctuation">(</span><span class="token string">'2021-10-08 08:45:17'</span><span class="token punctuation">))</span><span class="token punctuation">;</span> 返回8
        --select DAYOFMONTH<span class="token punctuation">(</span>TO_DATE<span class="token punctuation">(</span>FROM_UNIXTIME<span class="token punctuation">(</span><span class="token number">1631061917</span><span class="token punctuation">))</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  -- 结果：8
        --select DAYOFMONTH<span class="token punctuation">(</span>TO_DATE<span class="token punctuation">(</span>FROM_UNIXTIME<span class="token punctuation">(</span>UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">))</span><span class="token punctuation">;</span> --参数为DATE类型  当前时间为月份中的多少号  <span class="token number">14</span>号
    DAYOFWEEK<span class="token punctuation">(</span>date<span class="token punctuation">)</span> 一周中的第几天
        --select DAYOFWEEK<span class="token punctuation">(</span>TO_DATE<span class="token punctuation">(</span><span class="token string">'2021-10-08 08:45:17'</span><span class="token punctuation">))</span><span class="token punctuation">;</span>   返回6，实际是5
    HOUR<span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span> 返回小时数
        --select HOUR<span class="token punctuation">(</span>TIMESTAMP <span class="token string">'2021-09-08 08:45:17'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">8</span>
    MINUTE<span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span> 返回分钟数
        --select MINUTE<span class="token punctuation">(</span>TIMESTAMP <span class="token string">'2021-09-08 08:45:17'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回  <span class="token number">45</span>
    SECOND<span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span>  返回秒数
        --select SECOND<span class="token punctuation">(</span>TIMESTAMP <span class="token string">'2021-09-08 08:45:17'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">17</span>
    FLOOR<span class="token punctuation">(</span>timepoint TO timeintervalunit<span class="token punctuation">)</span> 向下取整分钟 
        --select FLOOR<span class="token punctuation">(</span>TIME <span class="token string">'12:44:31'</span> TO MINUTE<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">12</span>:44 
    CEIL<span class="token punctuation">(</span>timepoint TO timeintervalunit<span class="token punctuation">)</span>  向上取整分钟，回合时间点到时间单元timeintervalunit。
        -- <span class="token keyword">select</span> CEIL<span class="token punctuation">(</span>TIME <span class="token string">'12:44:31'</span> TO MINUTE<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">12</span>:45 
    <span class="token punctuation">(</span>timepoint1, temporal1<span class="token punctuation">)</span> OVERLAPS <span class="token punctuation">(</span>timepoint2, temporal2<span class="token punctuation">)</span>  由 <span class="token punctuation">(</span> timepoint1 , temporal1 <span class="token punctuation">)</span> 和 <span class="token punctuation">(</span> timepoint2 , temporal2 <span class="token punctuation">)</span>定义的两个时间间隔重叠，则返回 TRUE 
        --select <span class="token punctuation">(</span>TIME <span class="token string">'2:55:00'</span>, INTERVAL <span class="token string">'1'</span> HOUR<span class="token punctuation">)</span> OVERLAPS <span class="token punctuation">(</span>TIME <span class="token string">'3:30:00'</span>, INTERVAL <span class="token string">'2'</span> HOUR<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回true
        --select <span class="token punctuation">(</span>TIME <span class="token string">'9:00:00'</span>, TIME <span class="token string">'10:00:00'</span><span class="token punctuation">)</span> OVERLAPS <span class="token punctuation">(</span>TIME <span class="token string">'10:15:00'</span>, INTERVAL <span class="token string">'3'</span> HOUR<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回false
    DATE string  日期字符串（yyyy-MM-dd）转为 DATE 类型
        --select Date <span class="token string">'2021-09-08'</span><span class="token punctuation">;</span> 返回  <span class="token number">2021</span>-09-08
    TIME string  时间字符串转（HH:mm:ss）为 TIME 类型
        --select TIME <span class="token string">'08:45:17'</span><span class="token punctuation">;</span>  返回 08:45:17 

    TO_DATE<span class="token punctuation">(</span>string1<span class="token punctuation">[</span>, string2<span class="token punctuation">]</span><span class="token punctuation">)</span>  将日期时间字符串（yyyy-MM-dd HH:mm:ss）转为 DATE 类型
        --select TO_DATE<span class="token punctuation">(</span>FROM_UNIXTIME<span class="token punctuation">(</span><span class="token number">1631061917</span><span class="token punctuation">))</span> 结果为 <span class="token number">2021</span>-09-08 ，因 TO_DATE 是转为日
        --select TO_DATE<span class="token punctuation">(</span><span class="token string">'2021-09-08 08:45:17'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">2021</span>-09-08
    TO_TIMESTAMP<span class="token punctuation">(</span>string1<span class="token punctuation">[</span>, string2<span class="token punctuation">]</span><span class="token punctuation">)</span>  将时间字符串转为 TIMESTAMP 类型
        --select TO_TIMESTAMP<span class="token punctuation">(</span><span class="token string">'2021-09-08 08:45:17'</span>,<span class="token string">'yyyy-MM-dd HH:mm:ss'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">2021</span>-09-08T08:45:17  到秒
        --select TO_TIMESTAMP<span class="token punctuation">(</span><span class="token string">'2021-09-08 08:45'</span>,<span class="token string">'yyyy-MM-dd HH:mm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">2021</span>-09-08T08:45  到分钟
    TIMESTAMP string  将时间字符串（“yyyy-MM-dd HH:mm:ss<span class="token punctuation">[</span>.SSS<span class="token punctuation">]</span>”的形式）转为 TIMESTAMP 类型
        --select TIMESTAMP <span class="token string">'2021-09-08 08:45:17'</span><span class="token punctuation">;</span> 返回 <span class="token number">2021</span>-09-08T08:45:17
    NOW<span class="token punctuation">(</span><span class="token punctuation">)</span> 系统时间，返回 TIMESTAMP 类型
        --select NOW<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回  <span class="token number">2021</span>-10-08T08:50:01.486
    UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">)</span> 系统时间搓，返回整数
        --select UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">1633680986</span>
    UNIX_TIMESTAMP<span class="token punctuation">(</span>string1<span class="token punctuation">[</span>, string2<span class="token punctuation">]</span><span class="token punctuation">)</span> 返回整数，时间字符串（默认情况下：yyyy-MM-dd HH:mm:ss 如果未指定）转换为 Unix 时间戳（以秒为单位）。
        --select UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token string">'2021-09-08 08:45:17'</span>,<span class="token string">'yyyy-MM-dd HH:mm:ss'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">1631061917</span>
    FROM_UNIXTIME<span class="token punctuation">(</span>numeric<span class="token punctuation">[</span>, string<span class="token punctuation">]</span><span class="token punctuation">)</span>  将整数转为时间 字符串（默认为 <span class="token string">'yyyy-MM-dd HH:mm:ss'</span>） 类型
        --select FROM_UNIXTIME<span class="token punctuation">(</span>UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">)</span>,<span class="token string">'yyy-MM-dd HH:mm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  返回 <span class="token number">2021</span>-10-08 <span class="token number">16</span>:28  到分钟
        --select FROM_UNIXTIME<span class="token punctuation">(</span><span class="token number">1631061917</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    返回 <span class="token number">2021</span>-09-08 08:45:17 
        --select FROM_UNIXTIME<span class="token punctuation">(</span>UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">;</span> 返回当前日期  <span class="token number">2021</span>-10-08 <span class="token number">16</span>:18:32 
        --select FROM_UNIXTIME<span class="token punctuation">(</span><span class="token number">1631061917</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span>TIMESTAMPADD<span class="token punctuation">(</span>MINUTE, -5, NOW<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">;</span>  --结果： <span class="token boolean">false</span>
    TIMESTAMPDIFF<span class="token punctuation">(</span>timepointunit, timepoint1, timepoint2<span class="token punctuation">)</span>  时间搓差。
        --select TIMESTAMPDIFF<span class="token punctuation">(</span>MINUTE,TIMESTAMP FROM_UNIXTIME<span class="token punctuation">(</span>place_time/1000<span class="token punctuation">)</span>,  UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token operator">&lt;</span><span class="token number">5</span>  --近5分钟
        --select TIMESTAMPDIFF<span class="token punctuation">(</span>MINUTE, TIMESTAMP <span class="token string">'2003-01-03 10:10:00'</span>, TIMESTAMP <span class="token string">'2003-01-03 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  --结果为-10  后面-前面的 分钟差.
    TIMESTAMPADD<span class="token punctuation">(</span>timeintervalunit, interval, timepoint<span class="token punctuation">)</span>   向前/后推时间。timeintervalunit时间单位：SECOND，MINUTE，HOUR，DAY，WEEK，MONTH，QUARTER，或YEAR。
        --select TIMESTAMPADD<span class="token punctuation">(</span>MINUTE, -5, NOW<span class="token punctuation">(</span><span class="token punctuation">))</span> <span class="token punctuation">;</span>  --当前时间往前推5分钟: <span class="token number">2021</span>-10-08T08:33:48.108   ,但可能因时区原因有显示的时间有差异
        --select TIMESTAMPADD<span class="token punctuation">(</span>SECOND, -5, TO_DATE<span class="token punctuation">(</span>FROM_UNIXTIME<span class="token punctuation">(</span><span class="token number">1631061917</span><span class="token punctuation">))</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   --按 天取整后 往前推5秒结果：2021-09-07T23:59:55 .往前推5秒钟  <span class="token number">1631061917</span>为 <span class="token number">2021</span>-09-08 08:45:17

    CONVERT_TZ<span class="token punctuation">(</span>string1, string2, string3<span class="token punctuation">)</span> 将日期时间格式字符串 从时区string2转换为时区string3
        --select CONVERT_TZ<span class="token punctuation">(</span><span class="token string">'1970-01-01 00:00:00'</span>, <span class="token string">'UTC'</span>, <span class="token string">'America/Los_Angeles'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  返回 <span class="token number">1969</span>-12-31 <span class="token number">16</span>:00:00
</code></pre> 
<h3><a id="6_230"></a>6、条件函数</h3> 
<pre><code class="prism language-shell">
    CASE value WHEN value1_1  THEN result1 ELSE resultZ  END   满足某一个值 
        --select CASE <span class="token string">'a'</span> WHEN <span class="token string">'a'</span>  THEN <span class="token number">1</span> ELSE <span class="token number">0</span>  END<span class="token punctuation">;</span>  返回 <span class="token number">1</span> 
        --select CASE <span class="token string">'b'</span> WHEN <span class="token string">'a'</span>  THEN <span class="token number">1</span> ELSE <span class="token number">0</span>  END<span class="token punctuation">;</span>  返回 <span class="token number">0</span>
    CASE WHEN condition1 THEN result1 ELSE resultZ END  满足某一个条件时
        --select CASE  WHEN <span class="token number">1</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token number">5</span>  THEN <span class="token number">1</span> ELSE <span class="token number">0</span>  END<span class="token punctuation">;</span>  返回 <span class="token number">1</span>
        --select CASE  WHEN  <span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span><span class="token number">5</span>   THEN <span class="token number">1</span> ELSE <span class="token number">0</span>  END<span class="token punctuation">;</span>  返回 <span class="token number">0</span>
    NULLIF<span class="token punctuation">(</span>value1, value2<span class="token punctuation">)</span>  等值判断：如果value1等于value2则返回 NULL ；否则返回value1。
        --NULLIF<span class="token punctuation">(</span><span class="token number">5</span>, <span class="token number">5</span><span class="token punctuation">)</span>返回NULL；NULLIF<span class="token punctuation">(</span><span class="token number">5</span>, <span class="token number">0</span><span class="token punctuation">)</span>返回 <span class="token number">5</span>。
    COALESCE<span class="token punctuation">(</span>value1, value2 <span class="token punctuation">[</span>, value3 <span class="token punctuation">]</span>* <span class="token punctuation">)</span>  返回第一个不为 NULL 的值
        --select COALESCE<span class="token punctuation">(</span>NULL, <span class="token number">5,3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回5
    IF<span class="token punctuation">(</span>condition, true_value, false_value<span class="token punctuation">)</span> 
        --select IF<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token number">5,1</span>,0<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">1</span>
    IS_ALPHA<span class="token punctuation">(</span>string<span class="token punctuation">)</span>  字符串中的所有字符都是字母，则返回真，否则返回假。
        --select IS_ALPHA<span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回true
        --select IS_ALPHA<span class="token punctuation">(</span><span class="token string">'abc1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回false
    IS_DECIMAL<span class="token punctuation">(</span>string<span class="token punctuation">)</span> 如果string可以解析为有效数字，则返回 <span class="token boolean">true</span> ，否则返回 false。
        --select IS_DECIMAL<span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回true
        --select IS_DECIMAL<span class="token punctuation">(</span><span class="token string">'abc1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回false
    IS_DIGIT<span class="token punctuation">(</span>string<span class="token punctuation">)</span> 如果字符串中的所有字符都是数字，则返回真，否则返回假。
        --select IS_DIGIT<span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回true
        --select IS_DIGIT<span class="token punctuation">(</span><span class="token string">'abc1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回false
</code></pre> 
<h3><a id="7_257"></a>7、类型强转函数</h3> 
<pre><code class="prism language-shell">    CAST<span class="token punctuation">(</span>value AS <span class="token builtin class-name">type</span><span class="token punctuation">)</span> 强转
        --select CAST<span class="token punctuation">(</span><span class="token string">'42'</span> AS INT<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">42</span>；
        --select CAST<span class="token punctuation">(</span>NULL AS VARCHAR<span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 VARCHAR 类型的 NULL。
</code></pre> 
<h3><a id="8_265"></a>8、集合函数</h3> 
<pre><code class="prism language-shell">    array <span class="token punctuation">[</span> value1,value2<span class="token punctuation">..</span>. <span class="token punctuation">]</span> 构建 数组 
    数组名<span class="token punctuation">[</span>n<span class="token punctuation">]</span>  取数组的第n个元素。索引从 <span class="token number">1</span> 开始
        --select arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> from <span class="token punctuation">(</span>select array <span class="token punctuation">[</span><span class="token number">1,4</span>,5<span class="token punctuation">]</span> arr<span class="token punctuation">)</span>t<span class="token punctuation">;</span>  返回 <span class="token number">4</span>
        --select array <span class="token punctuation">[</span><span class="token string">'a'</span>,<span class="token string">'b'</span>,<span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 返回 <span class="token punctuation">[</span>a, b, c<span class="token punctuation">]</span>
    map <span class="token punctuation">[</span>key1,value1,key2,value2<span class="token punctuation">]</span>  构建map集合
    集合名<span class="token punctuation">[</span>key值<span class="token punctuation">]</span> 取key对应的value
        --select  mp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> from <span class="token punctuation">(</span>select map <span class="token punctuation">[</span><span class="token number">1</span>,<span class="token string">'a'</span>,2,<span class="token string">'b'</span><span class="token punctuation">]</span> mp<span class="token punctuation">)</span>t<span class="token punctuation">;</span> 返回 b
        --select map <span class="token punctuation">[</span><span class="token number">1</span>,<span class="token string">'a'</span>,2,<span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 返回   <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token operator">=</span>a, <span class="token assign-left variable">2</span><span class="token operator">=</span>b<span class="token punctuation">}</span> 
    CARDINALITY<span class="token punctuation">(</span>map<span class="token punctuation">)</span> 返回map 中的条目数 。
        --select CARDINALITY<span class="token punctuation">(</span>map <span class="token punctuation">[</span><span class="token number">1</span>,<span class="token string">'a'</span>,2,<span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回 <span class="token number">2</span>
    CARDINALITY<span class="token punctuation">(</span>array<span class="token punctuation">)</span> 返回array 中的元素个数。
       <span class="token keyword">select</span> CARDINALITY<span class="token punctuation">(</span>array <span class="token punctuation">[</span><span class="token number">1,2</span>,3,0,0<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 返回5
    ELEMENT<span class="token punctuation">(</span>array<span class="token punctuation">)</span> 返回数组的唯一元素（其基数应为 <span class="token number">1</span>）；如果数组为空，则返回 NULL 。如果数组有多个元素，则抛出异常。
        --select ELEMENT<span class="token punctuation">(</span>array <span class="token punctuation">[</span><span class="token number">1,2</span>,3,0,0<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>  --执行失败
        --select ELEMENT<span class="token punctuation">(</span>array <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> 返回2
</code></pre> 
<h3><a id="9_285"></a>9、值访问函数</h3> 
<pre><code class="prism language-sql">    tableName<span class="token punctuation">.</span>compositeType<span class="token punctuation">.</span>field  按名称从 Flink 复合类型（例如，Tuple、POJO）返回字段的值。
    tableName<span class="token punctuation">.</span>compositeType<span class="token punctuation">.</span><span class="token operator">*</span>  返回 Flink 复合类型（例如，Tuple、POJO）的平面表示，将其每个直接子类型转换为单独的字段。在大多数情况下，平面表示的字段与原始字段的命名类似，但使用美元分隔符（例如，mypojo$mytuple$f0）。
</code></pre> 
<h3><a id="10_292"></a>10、分组功能</h3> 
<pre><code class="prism language-sql">    GROUP_ID<span class="token punctuation">(</span><span class="token punctuation">)</span> 返回唯一标识分组键组合的整数。
    GROUPING<span class="token punctuation">(</span>expression1 <span class="token punctuation">[</span><span class="token punctuation">,</span> expression2<span class="token punctuation">]</span><span class="token operator">*</span> <span class="token punctuation">)</span>
    GROUPING_ID<span class="token punctuation">(</span>expression1 <span class="token punctuation">[</span><span class="token punctuation">,</span> expression2<span class="token punctuation">]</span><span class="token operator">*</span> <span class="token punctuation">)</span>
    返回给定分组表达式的位向量。
</code></pre> 
<h3><a id="11_301"></a>11、哈希函数</h3> 
<pre><code class="prism language-sql">    MD5<span class="token punctuation">(</span>string<span class="token punctuation">)</span> 以 <span class="token number">32</span> 个十六进制数字的字符串形式返回string的 MD5 哈希值；如果字符串为 <span class="token boolean">NULL</span>，则返回<span class="token boolean">NULL</span>。
    SHA1<span class="token punctuation">(</span>string<span class="token punctuation">)</span> 以 <span class="token number">40</span> 个十六进制数字的字符串形式返回string的 SHA<span class="token operator">-</span><span class="token number">1</span> 哈希值；如果字符串为 <span class="token boolean">NULL</span>，则返回<span class="token boolean">NULL</span>。
    SHA224<span class="token punctuation">(</span>string<span class="token punctuation">)</span> 以 <span class="token number">56</span> 个十六进制数字的字符串形式返回string的 SHA<span class="token operator">-</span><span class="token number">224</span> 哈希值；如果字符串为 <span class="token boolean">NULL</span>，则返回<span class="token boolean">NULL</span>。
    SHA256<span class="token punctuation">(</span>string<span class="token punctuation">)</span> 以 <span class="token number">64</span> 个十六进制数字的字符串形式返回string的 SHA<span class="token operator">-</span><span class="token number">256</span> 哈希值；如果字符串为 <span class="token boolean">NULL</span>，则返回<span class="token boolean">NULL</span>。
    SHA384<span class="token punctuation">(</span>string<span class="token punctuation">)</span> 以 <span class="token number">96</span> 个十六进制数字的字符串形式返回string的 SHA<span class="token operator">-</span><span class="token number">384</span> 哈希值；如果字符串为 <span class="token boolean">NULL</span>，则返回<span class="token boolean">NULL</span>。
    SHA512<span class="token punctuation">(</span>string<span class="token punctuation">)</span> 以 <span class="token number">128</span> 个十六进制数字的字符串形式返回string的 SHA<span class="token operator">-</span><span class="token number">512</span> 哈希值；如果字符串为 <span class="token boolean">NULL</span>，则返回<span class="token boolean">NULL</span>。
    SHA2<span class="token punctuation">(</span>string<span class="token punctuation">,</span> hashLength<span class="token punctuation">)</span> 使用 SHA<span class="token operator">-</span><span class="token number">2</span> 系列散列函数（SHA<span class="token operator">-</span><span class="token number">224</span>、SHA<span class="token operator">-</span><span class="token number">256</span>、SHA<span class="token operator">-</span><span class="token number">384</span> 或 SHA<span class="token operator">-</span><span class="token number">512</span>）返回散列。第一个参数字符串是要散列的字符串，第二个参数hashLength是结果的位长（<span class="token number">224</span>、<span class="token number">256</span>、<span class="token number">384</span>或 <span class="token number">512</span>）。如果string或hashLength为 <span class="token boolean">NULL</span>，则返回<span class="token boolean">NULL</span>
</code></pre> 
<h3><a id="12_313"></a>12、聚合函数</h3> 
<pre><code class="prism language-sql">    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token punctuation">]</span> expression <span class="token operator">|</span> <span class="token keyword">DISTINCT</span> expression1 <span class="token punctuation">[</span><span class="token punctuation">,</span> expression2<span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">)</span> 默认情况下或使用 <span class="token keyword">ALL</span>，返回表达式不为 <span class="token boolean">NULL</span>的输入行数。对每个值的一个唯一实例使用 <span class="token keyword">DISTINCT</span>。
    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> 返回输入行数。
    <span class="token function">AVG</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token operator">|</span> <span class="token keyword">DISTINCT</span> <span class="token punctuation">]</span> expression<span class="token punctuation">)</span> 默认情况下或使用关键字 <span class="token keyword">ALL</span>，返回所有输入行中表达式的平均值（算术平均值）。对每个值的一个唯一实例使用 <span class="token keyword">DISTINCT</span>。
    <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token operator">|</span> <span class="token keyword">DISTINCT</span> <span class="token punctuation">]</span> expression<span class="token punctuation">)</span> 默认情况下或使用关键字 <span class="token keyword">ALL</span>，返回所有输入行的表达式总和。对每个值的一个唯一实例使用 <span class="token keyword">DISTINCT</span>。
    <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token operator">|</span> <span class="token keyword">DISTINCT</span> <span class="token punctuation">]</span> expression<span class="token punctuation">)</span> 默认情况下或使用关键字 <span class="token keyword">ALL</span>，返回所有输入行中表达式的最大值。对每个值的一个唯一实例使用 <span class="token keyword">DISTINCT</span>。
    <span class="token function">MIN</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token operator">|</span> <span class="token keyword">DISTINCT</span> <span class="token punctuation">]</span> expression<span class="token punctuation">)</span> 默认情况下或使用关键字 <span class="token keyword">ALL</span>，返回所有输入行中表达式的最小值。对每个值的一个唯一实例使用 <span class="token keyword">DISTINCT</span>。
    STDDEV_POP<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token operator">|</span> <span class="token keyword">DISTINCT</span> <span class="token punctuation">]</span> expression<span class="token punctuation">)</span> 默认情况下或使用关键字 <span class="token keyword">ALL</span>，返回所有输入行中表达式的总体标准偏差。对每个值的一个唯一实例使用 <span class="token keyword">DISTINCT</span>。
    STDDEV_SAMP<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token operator">|</span> <span class="token keyword">DISTINCT</span> <span class="token punctuation">]</span> expression<span class="token punctuation">)</span> 默认情况下或使用关键字 <span class="token keyword">ALL</span>，返回所有输入行中表达式的样本标准偏差。对每个值的一个唯一实例使用 <span class="token keyword">DISTINCT</span>。
    VAR_POP<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token operator">|</span> <span class="token keyword">DISTINCT</span> <span class="token punctuation">]</span> expression<span class="token punctuation">)</span> 默认情况下或使用关键字 <span class="token keyword">ALL</span>，返回所有输入行中表达式的总体方差（总体标准差的平方）。对每个值的一个唯一实例使用 <span class="token keyword">DISTINCT</span>。
    VAR_SAMP<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token operator">|</span> <span class="token keyword">DISTINCT</span> <span class="token punctuation">]</span> expression<span class="token punctuation">)</span> 默认情况下或使用关键字 <span class="token keyword">ALL</span>，返回所有输入行中表达式的样本方差（样本标准差的平方）。对每个值的一个唯一实例使用 <span class="token keyword">DISTINCT</span>。
    COLLECT<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token operator">|</span> <span class="token keyword">DISTINCT</span> <span class="token punctuation">]</span> expression<span class="token punctuation">)</span> 默认情况下或使用关键字 <span class="token keyword">ALL</span>，返回跨所有输入行的多组表达式。<span class="token boolean">NULL</span> 值将被忽略。对每个值的一个唯一实例使用 <span class="token keyword">DISTINCT</span>。
    VARIANCE<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token operator">|</span> <span class="token keyword">DISTINCT</span> <span class="token punctuation">]</span> expression<span class="token punctuation">)</span> VAR_SAMP<span class="token punctuation">(</span><span class="token punctuation">)</span> 的同义词。仅在眨眼规划器中受支持。
    RANK<span class="token punctuation">(</span><span class="token punctuation">)</span> 返回值在一组值中的排名。结果是 <span class="token number">1</span> 加上分区顺序中当前行之前或等于当前行的行数。这些值将在序列中产生间隙。仅在眨眼规划器中受支持。
    DENSE_RANK<span class="token punctuation">(</span><span class="token punctuation">)</span> 返回值在一组值中的排名。结果是一加先前分配的等级值。与函数 rank 不同，dense_rank 不会在排名序列中产生间隙。仅在眨眼规划器中受支持。
    ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> 根据窗口分区内行的顺序，为每一行分配一个唯一的序列号，从一开始。
    ROW_NUMBER 和 RANK 相似。ROW_NUMBER 按顺序对所有行进行编号（例如 <span class="token number">1</span>、<span class="token number">2</span>、<span class="token number">3</span>、<span class="token number">4</span>、<span class="token number">5</span>）。RANK 为平局提供相同的数值（例如 <span class="token number">1</span>、<span class="token number">2</span>、<span class="token number">2</span>、<span class="token number">4</span>、<span class="token number">5</span>）。仅在眨眼规划器中受支持。
    LEAD<span class="token punctuation">(</span>expression <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">offset</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> 返回窗口中当前行之前偏移第 th 行处的expression值。的默认值的偏移是<span class="token number">1</span>和默认值默认为<span class="token boolean">NULL</span>。仅在眨眼规划器中受支持。
    LAG<span class="token punctuation">(</span>expression <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">offset</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 返回窗口中当前行后偏移第 th 行处的expression值。的默认值的偏移是<span class="token number">1</span>和默认值默认为<span class="token boolean">NULL</span>。 仅在眨眼规划器中受支持。
    FIRST_VALUE<span class="token punctuation">(</span>expression<span class="token punctuation">)</span> 返回一组有序值中的第一个值。 仅在眨眼规划器中受支持。
    LAST_VALUE<span class="token punctuation">(</span>expression<span class="token punctuation">)</span> 返回一组有序值中的最后一个值。仅在眨眼规划器中受支持。
    LISTAGG<span class="token punctuation">(</span>expression <span class="token punctuation">[</span><span class="token punctuation">,</span> separator<span class="token punctuation">]</span><span class="token punctuation">)</span> 连接字符串表达式的值并在它们之间放置分隔符值。字符串末尾不添加分隔符。分隔符的默认值为“<span class="token punctuation">,</span>”。仅在眨眼规划器中受支持。
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3d29783612c915dc2c0ccb6e552533f2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">element-ui 中使用svg-icon</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/832334be1c500aadd646c1b231dd893f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">pycharm无法输入中文注释解决办法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>