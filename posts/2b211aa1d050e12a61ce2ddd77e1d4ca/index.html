<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#与西门子PLC通讯——新手快速入门 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#与西门子PLC通讯——新手快速入门" />
<meta property="og:description" content="提示：参照本文，你可以完成从软件安装到第一个C#通讯实例的快速搭建，少踩一些坑。
关键词：C#，.Net Core，S7 Net Plus，TIA Portal V17，PLCSIM Advanced V4，S7-1500。
C#与西门子PLC通讯 系列文章目录 后续博客参考
如果您觉得新手入门还不过瘾，请继续阅读下面的文章。
C#与西门子PLC通讯——熟手快速入门
番外篇
C#与西门子PLC通讯——手搓S7通讯协议
文章目录 C#与西门子PLC通讯 系列文章目录前言一、环境准备1.1 PLC编程环境准备1.2 PLC仿真环境准备1.3 .Net Core编程环境准备1.4 仿真器网络环境配置 二、PLC创建2.1 运行博图软件2.2 创建一个新项目2.3 组态设备 添加S7-15002.4 属性设置2.4.1 设置项目支持仿真2.4.2 PLC网络设置 2.5 数据块添加2.5.1 添加新块2.5.2 添加数据块内容2.5.3 取消优化的块访问（可选） 三、仿真器创建3.1 运行博图仿真软件3.2 博图仿真软件参数设置 四、PLC程序下载到仿真器4.1 PLC程序装载4.2 监控仿真PLC数据 五、.Net Core读写仿真器5.1 新建项目5.2 安装S7netplus程序包5.3 连接仿真PLC5.4 读写仿真PLC5.5 使用Task多线程自动读写PLC数据 总结 前言 一日，吾遇一电气之士，闻其欲谋转开发之途，叹其敏而好学，故以吾之薄知相赠，遂有此记焉。
本文基于C# .Net Core和西门子博图TIA Portal V17搭建。由于手边没有西门子PLC实物，所以采用S7-PLCSIM Advanced V4.0作为模拟PLC，以实现0成本完成通讯测试实例。
整体架构示意图如下：
注：网络架构中的IP地址可以根据自己的实际情况进行调整。
一、环境准备 博图V17安装包资源：https://www.jb51.net/softs/777828.html
Visual Studio Community 开发工具：https://visualstudio.microsoft.com/zh-hans/vs/community/
注意：完成本章任务大约耗时半天，请合理安排时间。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2b211aa1d050e12a61ce2ddd77e1d4ca/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-11T12:26:20+08:00" />
<meta property="article:modified_time" content="2023-11-11T12:26:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#与西门子PLC通讯——新手快速入门</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>提示：参照本文，你可以完成从软件安装到第一个C#通讯实例的快速搭建，少踩一些坑。</p> 
</blockquote> 
<p>关键词：C#，.Net Core，S7 Net Plus，TIA Portal V17，PLCSIM Advanced V4，S7-1500。</p> 
<h2><a id="CPLC__4"></a>C#与西门子PLC通讯 系列文章目录</h2> 
<p><code> 后续博客参考</code><br> 如果您觉得新手入门还不过瘾，请继续阅读下面的文章。<br> <a href="https://blog.csdn.net/qq_31463571/article/details/134044687">C#与西门子PLC通讯——熟手快速入门</a></p> 
<p>番外篇<br> <a href="https://blog.csdn.net/qq_31463571/article/details/134088262">C#与西门子PLC通讯——手搓S7通讯协议</a></p> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#CPLC__4" rel="nofollow">C#与西门子PLC通讯 系列文章目录</a></li><li><a href="#_17" rel="nofollow">前言</a></li><li><a href="#_27" rel="nofollow">一、环境准备</a></li><li><ul><li><a href="#11_PLC_32" rel="nofollow">1.1 PLC编程环境准备</a></li><li><a href="#12_PLC_37" rel="nofollow">1.2 PLC仿真环境准备</a></li><li><a href="#13_Net_Core_41" rel="nofollow">1.3 .Net Core编程环境准备</a></li><li><a href="#14__46" rel="nofollow">1.4 仿真器网络环境配置</a></li></ul> 
  </li><li><a href="#PLC_56" rel="nofollow">二、PLC创建</a></li><li><ul><li><a href="#21__57" rel="nofollow">2.1 运行博图软件</a></li><li><a href="#22__59" rel="nofollow">2.2 创建一个新项目</a></li><li><a href="#23__S71500_62" rel="nofollow">2.3 组态设备 添加S7-1500</a></li><li><a href="#24__70" rel="nofollow">2.4 属性设置</a></li><li><ul><li><a href="#241__71" rel="nofollow">2.4.1 设置项目支持仿真</a></li><li><a href="#242_PLC_77" rel="nofollow">2.4.2 PLC网络设置</a></li></ul> 
   </li><li><a href="#25__93" rel="nofollow">2.5 数据块添加</a></li><li><ul><li><a href="#251__94" rel="nofollow">2.5.1 添加新块</a></li><li><a href="#252__101" rel="nofollow">2.5.2 添加数据块内容</a></li><li><a href="#253__108" rel="nofollow">2.5.3 取消优化的块访问（可选）</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_115" rel="nofollow">三、仿真器创建</a></li><li><ul><li><a href="#31__116" rel="nofollow">3.1 运行博图仿真软件</a></li><li><a href="#32__118" rel="nofollow">3.2 博图仿真软件参数设置</a></li></ul> 
  </li><li><a href="#PLC_128" rel="nofollow">四、PLC程序下载到仿真器</a></li><li><ul><li><a href="#41_PLC_129" rel="nofollow">4.1 PLC程序装载</a></li><li><a href="#42_PLC_143" rel="nofollow">4.2 监控仿真PLC数据</a></li></ul> 
  </li><li><a href="#Net_Core_149" rel="nofollow">五、.Net Core读写仿真器</a></li><li><ul><li><a href="#51__150" rel="nofollow">5.1 新建项目</a></li><li><a href="#52_S7netplus_165" rel="nofollow">5.2 安装S7netplus程序包</a></li><li><a href="#53_PLC_174" rel="nofollow">5.3 连接仿真PLC</a></li><li><a href="#54_PLC_209" rel="nofollow">5.4 读写仿真PLC</a></li><li><a href="#55_TaskPLC_280" rel="nofollow">5.5 使用Task多线程自动读写PLC数据</a></li></ul> 
  </li><li><a href="#_356" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_17"></a>前言</h2> 
<blockquote> 
 <p>一日，吾遇一电气之士，闻其欲谋转开发之途，叹其敏而好学，故以吾之薄知相赠，遂有此记焉。</p> 
</blockquote> 
<p>本文基于C# .Net Core和西门子博图TIA Portal V17搭建。由于手边没有西门子PLC实物，所以采用S7-PLCSIM Advanced V4.0作为模拟PLC，以实现0成本完成通讯测试实例。</p> 
<p>整体架构示意图如下：<br> <img src="https://images2.imgbox.com/fd/28/zjkZLfaQ_o.png" alt="上位机与PLC的网络架构示意图"><br> 注：网络架构中的IP地址可以根据自己的实际情况进行调整。</p> 
<hr> 
<h2><a id="_27"></a>一、环境准备</h2> 
<p>博图V17安装包资源：https://www.jb51.net/softs/777828.html<br> Visual Studio Community 开发工具：https://visualstudio.microsoft.com/zh-hans/vs/community/</p> 
<p><code>注意：完成本章任务大约耗时半天，请合理安排时间。</code></p> 
<h3><a id="11_PLC_32"></a>1.1 PLC编程环境准备</h3> 
<p><img src="https://images2.imgbox.com/44/24/lDgXQGXn_o.png" alt="博图安装包"><br> 首先，安装博图软件，双击运行Start.exe，安装前后都要求重启，一路点“下一步”，勾选条款和安全设置即可完成安装。<br> <img src="https://images2.imgbox.com/c5/d0/EFftAma1_o.png" alt="博图安装包文件"><br> <code>如果安装中出现问题，请自行搜索：西门子博图v17安装教程。</code></p> 
<h3><a id="12_PLC_37"></a>1.2 PLC仿真环境准备</h3> 
<p><img src="https://images2.imgbox.com/37/ea/DfBivKwB_o.png" alt="博图仿真安装包"><br> 其次，安装博图仿真软件，双击运行Start.exe，安装前后也是按要求重启，一路点“下一步”，勾选条款和安全设置即可完成安装。<img src="https://images2.imgbox.com/2a/79/rBrgpEw5_o.png" alt="博图仿真安装文件"><br> <code>如果安装中出现问题，请自行搜索：西门子博图 S7-PLCSIM Advanced V4安装教程。</code></p> 
<h3><a id="13_Net_Core_41"></a>1.3 .Net Core编程环境准备</h3> 
<p><img src="https://images2.imgbox.com/9c/42/p95i6wpR_o.png" alt="VisualStudio安装程序"><br> 然后，安装集成开发环境 (IDE)，双击运行VisualStudioSetup.exe，按需勾选C#相关的桌面应用开发。<br> <img src="https://images2.imgbox.com/fa/c0/Ti3wQG8H_o.png" alt="VisualStudio安装界面"><br> <code>如果安装中出现问题，请自行搜索：Visual Studio 2022 安装教程。</code></p> 
<h3><a id="14__46"></a>1.4 仿真器网络环境配置</h3> 
<p><img src="https://images2.imgbox.com/50/c4/yQkRzFnr_o.png" alt="以太网图例"><br> 最后，配置一下静态IP。安装博图软件之后，可以在网络连接中找到<code>Siemens PLCSIM Virtual Ethernet Adapter</code>。</p> 
<blockquote> 
 <ul><li>将IP地址手动设置为：192.168.0.200 ；</li><li>将子网掩码手动设置为：255.255.255.0。</li></ul> 
</blockquote> 
<p><img src="https://images2.imgbox.com/1f/77/sZjg6lRu_o.png" alt="网络IP地址设定"><br> 至此，环境准备部分完成。</p> 
<h2><a id="PLC_56"></a>二、PLC创建</h2> 
<h3><a id="21__57"></a>2.1 运行博图软件</h3> 
<p><img src="https://images2.imgbox.com/63/e6/74KLSyjs_o.png" alt="博图软件快捷方式"></p> 
<h3><a id="22__59"></a>2.2 创建一个新项目</h3> 
<p><img src="https://images2.imgbox.com/42/3b/kwcMM018_o.png" alt="创建新项目窗口"><br> 选择【创建新项目】，填写好项目名称（如：仿真PLC）后，点击【创建】按钮。</p> 
<h3><a id="23__S71500_62"></a>2.3 组态设备 添加S7-1500</h3> 
<p><img src="https://images2.imgbox.com/db/96/3aMAu7ej_o.png" alt="PLC组态"></p> 
<blockquote> 
 <p>操作步骤如下：</p> 
 <ol><li>选择【设备与网络】 ；</li><li>选择【添加设备】 ；</li><li>选择需要的PLC（以S7-1511为例 ）；</li><li>点击【添加】。</li></ol> 
</blockquote> 
<h3><a id="24__70"></a>2.4 属性设置</h3> 
<h4><a id="241__71"></a>2.4.1 设置项目支持仿真</h4> 
<p>右击项目名称（如：仿真PLC），选择【属性】。<br> <img src="https://images2.imgbox.com/87/a2/hR5OrXzL_o.png" alt="项目右击属性"></p> 
<p>找到【保护】页签，勾选√【块编译时支持仿真】，点击【确定】。<br> <img src="https://images2.imgbox.com/67/c2/ykeFmKAs_o.png" alt="项目保护设置"></p> 
<h4><a id="242_PLC_77"></a>2.4.2 PLC网络设置</h4> 
<blockquote> 
 <p>首先，设置PLC以太网为静态IP：</p> 
 <ol><li>选择【设备组态】 ；</li><li>选择对应的【PLC】图标；</li><li>选择【常规】；</li><li>选择【以太网地址】；</li><li>将PLC地址设为静态IP：192.168.0.100。</li></ol> 
</blockquote> 
<p><img src="https://images2.imgbox.com/ed/f9/RdrXYVfz_o.png" alt="PLC以太网地址"></p> 
<blockquote> 
 <p>然后，设置PLC允许PUT/GET：</p> 
 <ol><li>选择【防护与安全】-【连接机制】；</li><li>勾选√【允许来自远程对象的PUT/GET通信访问】。</li></ol> 
</blockquote> 
<p><img src="https://images2.imgbox.com/72/98/wqzYcox5_o.png" alt="设置PLC允许PUT/GET"></p> 
<h3><a id="25__93"></a>2.5 数据块添加</h3> 
<h4><a id="251__94"></a>2.5.1 添加新块</h4> 
<p><img src="https://images2.imgbox.com/be/1d/gzQ1utrE_o.png" alt="创建数据块"></p> 
<blockquote> 
 <p>给PLC添加仿真用的数据块 ：</p> 
 <ol><li>选择【添加新块】 ；</li><li>输入【名称】，如：仿真数据块 ；</li><li>选择【数据块】 ；</li><li>点击【确定】。</li></ol> 
</blockquote> 
<h4><a id="252__101"></a>2.5.2 添加数据块内容</h4> 
<blockquote> 
 <p>在数据块内添加内容如：</p> 
 <ul><li>布尔量 - Bool ；</li><li>整形量 - Int ；</li><li>数组字 - Array[0…9] of Word。</li></ul> 
</blockquote> 
<p><img src="https://images2.imgbox.com/56/66/pHKiO9rJ_o.png" alt="添加数据块内容"></p> 
<h4><a id="253__108"></a>2.5.3 取消优化的块访问（可选）</h4> 
<p>为了能够方便后续查看偏移量，取消勾选【优化的块访问】，具体操作如下：</p> 
<ol><li>右击数据块名称（如：仿真数据块），选择【属性】。<br> <img src="https://images2.imgbox.com/33/88/KdBT490K_o.png" alt="数据块属性"></li><li>选择【属性】-取消勾选【优化的块访问】-点击弹出窗口的【确定】-点击【确定】。<br> <img src="https://images2.imgbox.com/7a/0f/YwEZ2gJ9_o.png" alt="取消优化的块访问"></li></ol> 
<h2><a id="_115"></a>三、仿真器创建</h2> 
<h3><a id="31__116"></a>3.1 运行博图仿真软件</h3> 
<p><img src="https://images2.imgbox.com/68/1e/xjWzJWcp_o.png" alt="博图仿真软件"></p> 
<h3><a id="32__118"></a>3.2 博图仿真软件参数设置</h3> 
<p><img src="https://images2.imgbox.com/86/25/kHt1MtKi_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>操作步骤如下：</p> 
 <ol><li>将开关拨到【PLCSIM Virtual Eth. Adapter】；</li><li>展开【Start Virtual S7-1500 PLC】；</li><li>输入配置参数，name ：Sim1511；IP Address：192.168.0.100；Subnet mask：255.255.255.0；</li><li>点击【Start】。</li></ol> 
</blockquote> 
<p>操作完成后，仿真PLC将显示在清单中，此时可以看到有一个黄色小方块，表示仿真器还没有程序运行。<br> <img src="https://images2.imgbox.com/5b/b8/ybOzhRul_o.png" alt="仿真PLC清单"></p> 
<h2><a id="PLC_128"></a>四、PLC程序下载到仿真器</h2> 
<h3><a id="41_PLC_129"></a>4.1 PLC程序装载</h3> 
<ol><li>点击【下载到设备】- 【认为可信并建立连接】。<br> <img src="https://images2.imgbox.com/f9/3e/Y6kIeLUl_o.png" alt="下载到设备"></li><li>在弹出窗口中【开始搜索】仿真PLC。<br> <img src="https://images2.imgbox.com/2c/c3/sVn7tniQ_o.png" alt="开始搜索"></li><li>选择搜索到的PLC，点击【下载】。<br> <img src="https://images2.imgbox.com/50/fd/voezXNbF_o.png" alt="下载"></li><li>勾选【全部覆盖】- 点击【装载】。<br> <img src="https://images2.imgbox.com/1a/7c/vZHVzOFi_o.png" alt="全部覆盖"></li><li>选择【启动模块】-点击【完成】。<br> <img src="https://images2.imgbox.com/e4/ed/laoymFFi_o.png" alt="启动模块"></li><li>在仿真器中可以看到，原来黄色小方块变为了绿色小方块，表示下载成功。<br> <img src="https://images2.imgbox.com/f0/07/qP0kOcYo_o.png" alt="仿真器中可以看到绿色小方块"></li></ol> 
<h3><a id="42_PLC_143"></a>4.2 监控仿真PLC数据</h3> 
<blockquote> 
 <ol><li>点击【全部监视】 。</li><li>可以在【监视值】中任意修改PLC数值。</li></ol> 
</blockquote> 
<p><img src="https://images2.imgbox.com/82/31/f9T5M86f_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Net_Core_149"></a>五、.Net Core读写仿真器</h2> 
<h3><a id="51__150"></a>5.1 新建项目</h3> 
<ol><li> <p>找到VS2022 IDE，点击运行。<br> <img src="https://images2.imgbox.com/c1/be/E5c2HOdL_o.png" alt="VS2022"><br> <code>如果是其他版本，也可以参照操作，但不保证完全一致。</code></p> </li><li> <p>点击【创建新项目】。<br> <img src="https://images2.imgbox.com/0a/b6/nfn3rctn_o.png" alt="启动窗口"></p> </li><li> <p>选择【C#】- 选择【控制台】- 【控制台应用】-【下一步】。<br> <img src="https://images2.imgbox.com/57/bd/lnVrym48_o.png" alt="选择新项目"></p> </li><li> <p>填写【项目名称】- 选择项目文件夹 - 【下一步】。<br> <img src="https://images2.imgbox.com/17/90/VdoIxydO_o.png" alt="项目名称"></p> </li><li> <p>【下一步】。<br> <img src="https://images2.imgbox.com/54/74/FiVdbYRJ_o.png" alt="其他信息"></p> </li><li> <p>进入代码窗口。<br> <img src="https://images2.imgbox.com/b4/e3/6uKNRfx5_o.png" alt="代码窗口"></p> </li></ol> 
<h3><a id="52_S7netplus_165"></a>5.2 安装S7netplus程序包</h3> 
<ol><li>进入NuGet包管理界面（路径：【工具】-【NuGet包管理器】-【管理解决方案的NuGet程序包】）。<br> <img src="https://images2.imgbox.com/6c/d2/Sji5XVHC_o.png" alt="NuGet包管理路径"></li><li>选择【浏览】页签 - 搜索框输入“S7netplus” - 选择【S7netplus】-勾选项目-点击【安装】。<br> <img src="https://images2.imgbox.com/c7/87/QNkJtFRP_o.png" alt="NuGet包管理"></li><li>点击【OK】。<br> <img src="https://images2.imgbox.com/a5/2c/Z6d78zT3_o.png" alt="预览更改"></li><li>可以看到【解决方案资源管理器】中，【包】增加了【S7netplus】库。<br> <img src="https://images2.imgbox.com/4e/c1/RkqsehXW_o.png" alt="解决方案资源管理器"></li></ol> 
<h3><a id="53_PLC_174"></a>5.3 连接仿真PLC</h3> 
<p>回到Program代码窗口中。</p> 
<ol><li>在第一行引用S7netplus程序包：</li></ol> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">S7<span class="token punctuation">.</span>Net</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="2"><li>将Main函数修改为：</li></ol> 
<pre><code class="prism language-csharp">        <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Plc</span> plc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Plc</span><span class="token punctuation">(</span>CpuType<span class="token punctuation">.</span>S71500<span class="token punctuation">,</span> <span class="token string">"192.168.0.100"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            plc<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>plc<span class="token punctuation">.</span>IsConnected<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"连接成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            plc<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<ol start="3"><li>查看运行结果。<br> <img src="https://images2.imgbox.com/13/65/pWOjxjE8_o.png" alt="连接仿真PLC运行结果"></li><li>关于PLC连接字段的解析。</li></ol> 
<pre><code class="prism language-csharp"><span class="token class-name">Plc</span> plc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Plc</span><span class="token punctuation">(</span>CpuType<span class="token punctuation">.</span>S71500<span class="token punctuation">,</span> <span class="token string">"192.168.0.100"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th>变量</th><th>含义</th></tr></thead><tbody><tr><td>CpuType.S71500</td><td>PLC的类型</td></tr><tr><td>“192.168.0.100”</td><td>PLC IP地址</td></tr><tr><td>0</td><td>机架号</td></tr><tr><td>1</td><td>槽号</td></tr></tbody></table> 
<h3><a id="54_PLC_209"></a>5.4 读写仿真PLC</h3> 
<p>接下来，稍微改造一下连接PLC的代码，增加读写功能。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">S7<span class="token punctuation">.</span>Net</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">SimS71500</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">internal</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Plc</span> plc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Plc</span><span class="token punctuation">(</span>CpuType<span class="token punctuation">.</span>S71500<span class="token punctuation">,</span> <span class="token string">"192.168.0.100"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            plc<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 接收键入的值</span>
            <span class="token class-name"><span class="token keyword">string</span></span> inputKey <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">bool</span></span> boolFlag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">short</span></span> iCount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>plc<span class="token punctuation">.</span>IsConnected <span class="token operator">&amp;&amp;</span> inputKey <span class="token operator">!=</span> <span class="token string">"q"</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Console<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"连接成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 布尔量</span>
                plc<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"DB1.DBX0.0"</span><span class="token punctuation">,</span> boolFlag<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 整形量</span>
                plc<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"DB1.DBW2"</span><span class="token punctuation">,</span> iCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 数组字中的第一个元素</span>
                plc<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"DB1.DBW4"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span><span class="token punctuation">(</span>iCount <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 数组字中的剩余元素</span>
                <span class="token class-name"><span class="token keyword">short</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> arrValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">short</span></span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 你要写入的新值数组</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arrValues<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    arrValues<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span><span class="token punctuation">(</span>iCount <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                plc<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"DB1.DBW6"</span><span class="token punctuation">,</span> arrValues<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 布尔量</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>plc<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token string">"DB1.DBX0.0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 整形量</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>plc<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token string">"DB1.DBW2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 数组字中的第一个元素</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>plc<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token string">"DB1.DBW4"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 数组字中的剩余元素</span>
                <span class="token class-name"><span class="token keyword">short</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> remainArr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>plc<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>DataType<span class="token punctuation">.</span>DataBlock<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> VarType<span class="token punctuation">.</span>Word<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> remainArr<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>remainArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                iCount<span class="token operator">++</span><span class="token punctuation">;</span>
                boolFlag <span class="token operator">=</span> <span class="token operator">!</span>boolFlag<span class="token punctuation">;</span>
                inputKey <span class="token operator">=</span> Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            plc<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>代码解析：</p> 
 <ul><li>“DB1”表示PLC中的数据块编号。<br> <img src="https://images2.imgbox.com/e0/5d/5hmHdMAJ_o.png"></li><li>“DBX”和“DBW”表示读取的数据类型，这个影响数据截取的长度。<br> <img src="https://images2.imgbox.com/2e/d9/tVDnxxi9_o.png"></li><li>“DBX”和“DBW”后面紧跟着的数字表示偏移量，如：DBX0表示偏移量为0，DBW2表示偏移量为2。<br> <img src="https://images2.imgbox.com/c4/ba/9U8mPo8Z_o.png"></li><li>另外，“DB1.DBX0.0”中，最后一个0表示字节偏移量为0，这与PLC存储数据的格式有关。</li><li>plc.Read(DataType.DataBlock, 1, 6, VarType.Word, 9)是读取指定数据块、起始位置、数据类型和读取长度的方法。本篇文章不过多解释。</li></ul> 
</blockquote> 
<h3><a id="55_TaskPLC_280"></a>5.5 使用Task多线程自动读写PLC数据</h3> 
<p>继续改造一下代码，加入Task多线程，readPLCTask线程用于读取PLC，writePLCTask线程用于写入PLC。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">S7<span class="token punctuation">.</span>Net</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">SimS71500</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">internal</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Plc</span> plc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Plc</span><span class="token punctuation">(</span>CpuType<span class="token punctuation">.</span>S71500<span class="token punctuation">,</span> <span class="token string">"192.168.0.100"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            plc<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 接收键入的值</span>
            <span class="token class-name"><span class="token keyword">string</span></span> inputKey <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">bool</span></span> boolFlag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">short</span></span> iCount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

            <span class="token class-name">Task</span> readPLCTask <span class="token operator">=</span> Task<span class="token punctuation">.</span>Factory<span class="token punctuation">.</span><span class="token function">StartNew</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>plc<span class="token punctuation">.</span>IsConnected <span class="token operator">&amp;&amp;</span> inputKey <span class="token operator">!=</span> <span class="token string">"q"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    Console<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 布尔量</span>
                    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>plc<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token string">"DB1.DBX0.0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 整形量</span>
                    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>plc<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token string">"DB1.DBW2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 数组字中的第一个元素</span>
                    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>plc<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token string">"DB1.DBW4"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 数组字中的剩余元素</span>
                    <span class="token class-name"><span class="token keyword">short</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> remainArr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>plc<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>DataType<span class="token punctuation">.</span>DataBlock<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> VarType<span class="token punctuation">.</span>Word<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> remainArr<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>remainArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    Task<span class="token punctuation">.</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">Task</span> writePLCTask <span class="token operator">=</span> Task<span class="token punctuation">.</span>Factory<span class="token punctuation">.</span><span class="token function">StartNew</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>plc<span class="token punctuation">.</span>IsConnected <span class="token operator">&amp;&amp;</span> inputKey <span class="token operator">!=</span> <span class="token string">"q"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 布尔量</span>
                    plc<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"DB1.DBX0.0"</span><span class="token punctuation">,</span> boolFlag<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 整形量</span>
                    plc<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"DB1.DBW2"</span><span class="token punctuation">,</span> iCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 数组字中的第一个元素</span>
                    plc<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"DB1.DBW4"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span><span class="token punctuation">(</span>iCount <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 数组字中的剩余元素</span>
                    <span class="token class-name"><span class="token keyword">short</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> arrValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">short</span></span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 你要写入的新值数组</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arrValues<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        arrValues<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span><span class="token punctuation">(</span>iCount <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    plc<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"DB1.DBW6"</span><span class="token punctuation">,</span> arrValues<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    iCount<span class="token operator">++</span><span class="token punctuation">;</span>
                    boolFlag <span class="token operator">=</span> <span class="token operator">!</span>boolFlag<span class="token punctuation">;</span>
                    Task<span class="token punctuation">.</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            inputKey <span class="token operator">=</span> Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            plc<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Task<span class="token punctuation">.</span><span class="token function">WaitAll</span><span class="token punctuation">(</span>readPLCTask<span class="token punctuation">,</span> writePLCTask<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/af/ae/z273FBim_o.png" alt="自动读写PLC运行结果"></p> 
<hr> 
<h2><a id="_356"></a>总结</h2> 
<blockquote> 
 <p>这篇入门笔记解决了新手第一次上手实践时遇到的坑，并且有意忽略了实际项目中会遇到的逻辑交互和更多的数据格式问题。为新手上手建立信心，帮助新手建立起与Siemens S7-1500 PLC的仿真器连接和数据交互的基础。如果需要在实际项目中使用，还需要进一步学习和了解PLC编程、通信协议和C# .Net Core技术。</p> 
</blockquote> 
<p>这文档主要介绍了如何使用C# .Net Core和S7 Net Plus库连接到Siemens S7-1500 PLC的仿真器，并进行读写操作。<br> 以下是一些关键步骤和总结：</p> 
<ul><li><strong>环境准备</strong>：确保你已安装了TIA Portal V17、PLCSIM Advanced V4以及Visual Studio Community。另外，为仿真器的以太网端口配置静态IP地址，以便连接。</li><li><strong>PLC创建</strong>：在TIA Portal中创建一个新项目，然后添加S7-1500 PLC。设置项目支持仿真，并配置PLC的网络参数，包括IP地址和允许PUT/GET通信。</li><li><strong>数据块添加</strong>：创建一个数据块，定义其中包含的变量，包括布尔、整数和数组类型的数据。</li><li><strong>仿真器创建</strong>：在PLCSIM Advanced中创建仿真器，并设置参数，包括名称和IP地址。启动仿真器，确保它能被连接。</li><li><strong>PLC程序下载到仿真器</strong>：使用TIA Portal将PLC程序下载到仿真器中。可以在仿真器监视值中查看数据。</li><li><strong>.Net Core读写仿真器</strong>：创建一个C# .Net Core项目，引用S7 Net Plus库。使用库中的Plc类连接到仿真PLC，并进行读写操作。</li><li><strong>使用Task多线程自动读写PLC数据</strong>：将读和写PLC数据的操作放入不同的线程中，以实现并行操作。这样可以自动地定时读写PLC数据。</li></ul> 
<p>欢迎在评论区交流。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c54a4179627226083453a8bc1c944305/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python——列表推导式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/da24c1af942d49104144e943432bb698/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python opencv 读取文件夹下所有MP4文件并解析成jpg图像</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>