<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ODL中notification开发过程 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ODL中notification开发过程" />
<meta property="og:description" content="本文记录了ODL控制器中Notification的开发过程
1. Yang文件的编写
首先在api目录构建自己的yang文件：packetsend.yang
在yang文件里边编写notification服务
// Contents of &#34;packetsend&#34;
module packetsend {
namespace &#34;urn:opendaylight:packetsend&#34;;
prefix &#34;packetsend&#34;;
revision 2018-05-12 {
description &#34;Initial revision&#34;;
}
notification send-packet{
leaf name{
type string;
}
leaf content{
type string;
}
}
notification news{
leaf content{
type string;
}
}
}通过notification关键字来创建notification服务
编写完成后保存会自动问我们生成binding接口
每一个notification会对应一个接口和相应的builder，这里定义了两个notification所以会有两个builder，里边的成员变量就是我们在yang文件中定义的变量，比如SendPacket和SendPacketBuilder里边会有name和content变量，然后还会生成一个PacketsendListener接口在这个接口里边定义了两个方法，分别对应了我们在yang文件中定义的两个notification，这两天方法是：
void onSendPacket(SendPacket notification);
void onNews(News notification);
接听者需要implements这个接口并实现这两个方法
2. 创建发布者
发布-订阅模式中首先需要有一个发布者，在impl下创建一个发布类Radio类，具体代码如下：
public class Radio {
NotificationPublishService publishService;// 发布需要依赖这个服务，需要在blueprint里边注入
Timer timer1 = new Timer();" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/7d8c59d674d75d3c4c55f93d6270803f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-05-15T11:11:13+08:00" />
<meta property="article:modified_time" content="2018-05-15T11:11:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ODL中notification开发过程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="font-family:'宋体';">本文记录了</span>ODL<span style="font-family:'宋体';">控制器中</span><span style="font-family:Calibri;">Notification</span><span style="font-family:'宋体';">的开发过程</span></p> 
<p>1. Yang<span style="font-family:'宋体';">文件的编写</span></p> 
<p><span style="font-family:'宋体';">  首先在</span>api<span style="font-family:'宋体';">目录构建自己的</span><span style="font-family:Calibri;">yang</span><span style="font-family:'宋体';">文件：</span><span style="font-family:Calibri;">packetsend.yang</span></p> 
<p><span style="font-family:Calibri;"><img src="https://images2.imgbox.com/00/68/e6XZGyZ4_o.png" alt=""><br></span></p> 
<p>     在yang<span style="font-family:'宋体';">文件里边编写</span><span style="font-family:Calibri;">notification</span><span style="font-family:'宋体';">服务</span></p> 
<p><span style="color:rgb(128,32,32);">// Contents of "packetsend"</span></p> 
<p><span style="color:rgb(0,0,128);">module</span><span style="color:rgb(0,0,0);"> packetsend {<!-- --></span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,128);">namespace</span><span style="color:rgb(0,0,0);"> </span><span style="color:rgb(0,128,0);">"urn:opendaylight:packetsend"</span><span style="color:rgb(0,0,0);">;</span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,128);">prefix</span><span style="color:rgb(0,0,0);"> </span><span style="color:rgb(0,128,0);">"packetsend"</span><span style="color:rgb(0,0,0);">;</span></p> 
<p> </p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,128);">revision</span><span style="color:rgb(0,0,0);"> </span><span style="color:rgb(128,0,128);">2018</span><span style="color:rgb(0,0,0);">-</span><span style="color:rgb(128,0,128);">05</span><span style="color:rgb(0,0,0);">-</span><span style="color:rgb(128,0,128);">12</span><span style="color:rgb(0,0,0);"> {<!-- --></span></p> 
<p><span style="color:rgb(0,0,0);">        </span><span style="color:rgb(0,0,128);">description</span><span style="color:rgb(0,0,0);"> </span><span style="color:rgb(0,128,0);">"Initial revision"</span><span style="color:rgb(0,0,0);">;</span></p> 
<p><span style="color:rgb(0,0,0);">    }</span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,128);">notification</span><span style="color:rgb(0,0,0);"> send-packet{<!-- --></span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,128);">leaf</span><span style="color:rgb(0,0,0);"> name{<!-- --></span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,128);">type</span><span style="color:rgb(0,0,0);"> </span><span style="color:rgb(0,128,128);">string</span><span style="color:rgb(0,0,0);">;</span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,0);">}</span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,128);">leaf</span><span style="color:rgb(0,0,0);"> content{<!-- --></span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,128);">type</span><span style="color:rgb(0,0,0);"> </span><span style="color:rgb(0,128,128);">string</span><span style="color:rgb(0,0,0);">;</span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,0);">}</span></p> 
<p><span style="color:rgb(0,0,0);">    }</span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,128);">notification</span><span style="color:rgb(0,0,0);"> news{<!-- --></span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,128);">leaf</span><span style="color:rgb(0,0,0);"> content{<!-- --></span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,128);">type</span><span style="color:rgb(0,0,0);"> </span><span style="color:rgb(0,128,128);">string</span><span style="color:rgb(0,0,0);">;</span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,0);">}</span></p> 
<p><span style="color:rgb(0,0,0);">    }</span></p> 
<p><span style="color:rgb(0,0,0);">}</span><span style="font-family:'宋体';">通过</span>notification<span style="font-family:'宋体';">关键字来创建</span><span style="font-family:Calibri;">notification</span><span style="font-family:'宋体';">服务</span></p> 
<p><span style="font-family:'宋体';">  编写完成后保存会自动问我们生成</span>binding<span style="font-family:'宋体';">接口</span></p> 
<p> <img src="https://images2.imgbox.com/db/ff/6XVrEmGp_o.png" alt=""></p> 
<p><strong>      每一个notification<span style="font-family:'宋体';">会对应一个接口和相应的</span><span style="font-family:Calibri;">builder</span></strong><span style="font-family:'宋体';">，这里定义了两个</span>notification<span style="font-family:'宋体';">所以会有两个</span><span style="font-family:Calibri;">builder</span><span style="font-family:'宋体';">，里边的成员变量就是我们在</span><span style="font-family:Calibri;">yang</span><span style="font-family:'宋体';">文件中定义的变量，比如</span><span style="font-family:Calibri;">SendPacket</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">SendPacketBuilder</span><span style="font-family:'宋体';">里边会有</span><span style="font-family:Calibri;">name</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">content</span><span style="font-family:'宋体';">变量，然后还会</span><strong><span style="font-family:'宋体';">生成一个</span>PacketsendListener<span style="font-family:'宋体';">接口</span></strong>在这个接口里边定义了<strong>两个方法</strong><span style="font-family:'宋体';">，分别对应了我们在</span>yang<span style="font-family:'宋体';">文件中定义的</span><strong><span style="font-family:'宋体';">两个</span>notification</strong>，这两天方法是：</p> 
<p><span style="color:rgb(0,0,0);">    </span><strong><span style="color:rgb(127,0,85);">void</span></strong><span style="color:rgb(0,0,0);"> </span><span style="color:rgb(0,0,0);background:rgb(192,192,192);">onSendPacket</span><span style="color:rgb(0,0,0);">(SendPacket </span><span style="color:rgb(106,62,62);">notification</span><span style="color:rgb(0,0,0);">);</span></p> 
<p><span style="color:rgb(0,0,0);">    </span><strong><span style="color:rgb(127,0,85);">void</span></strong><span style="color:rgb(0,0,0);"> onNews(News </span><span style="color:rgb(106,62,62);">notification</span><span style="color:rgb(0,0,0);">);</span></p> 
<p><span style="font-family:'宋体';">接听者需要</span>implements<span style="font-family:'宋体';">这个接口并实现这两个方法</span></p> 
<p>2. 创建发布者</p> 
<p><span style="font-family:'宋体';">发布</span>-<span style="font-family:'宋体';">订阅模式中首先需要有一个发布者，在</span><span style="font-family:Calibri;">impl</span><span style="font-family:'宋体';">下创建一个发布类</span><span style="font-family:Calibri;">Radio</span><span style="font-family:'宋体';">类，具体代码如下：</span></p> 
<p><strong><span style="color:rgb(127,0,85);">public</span></strong><span style="color:rgb(0,0,0);"> </span><strong><span style="color:rgb(127,0,85);">class</span></strong><span style="color:rgb(0,0,0);"> Radio {<!-- --></span></p> 
<p> </p> 
<p><span style="color:rgb(0,0,0);">NotificationPublishService </span><span style="color:rgb(0,0,192);">publishService</span><span style="color:rgb(0,0,0);">;</span><span style="color:rgb(63,127,95);">// 发布需要依赖这个服务，需要在blueprint里边注入</span></p> 
<p><span style="color:rgb(0,0,0);">Timer </span><span style="color:rgb(0,0,192);">timer1</span><span style="color:rgb(0,0,0);"> = </span><strong><span style="color:rgb(127,0,85);">new</span></strong><span style="color:rgb(0,0,0);"> Timer();</span></p> 
<p><span style="color:rgb(0,0,0);">Timer </span><span style="color:rgb(0,0,192);">timer2</span><span style="color:rgb(0,0,0);"> = </span><strong><span style="color:rgb(127,0,85);">new</span></strong><span style="color:rgb(0,0,0);"> Timer();</span></p> 
<p></p> 
<p><strong><span style="color:rgb(127,0,85);">public</span></strong><span style="color:rgb(0,0,0);"> Radio(NotificationPublishService </span><span style="color:rgb(106,62,62);">publishService</span><span style="color:rgb(0,0,0);">) {<!-- --></span></p> 
<p><strong><span style="color:rgb(127,0,85);">this</span></strong><span style="color:rgb(0,0,0);">.</span><span style="color:rgb(0,0,192);">publishService</span><span style="color:rgb(0,0,0);"> = </span><span style="color:rgb(106,62,62);">publishService</span><span style="color:rgb(0,0,0);">;</span></p> 
<p><span style="color:rgb(0,0,0);">broadcast();</span></p> 
<p><span style="color:rgb(0,0,0);">}</span></p> 
<p><strong><span style="color:rgb(127,0,85);">private</span></strong><span style="color:rgb(0,0,0);"> </span><strong><span style="color:rgb(127,0,85);">void</span></strong><span style="color:rgb(0,0,0);"> broadcast() {<!-- --></span></p> 
<p><span style="color:rgb(0,0,192);">timer1</span><span style="color:rgb(0,0,0);">.schedule(</span><strong><span style="color:rgb(127,0,85);">new</span></strong><span style="color:rgb(0,0,0);"> TimerTask() {<!-- --></span></p> 
<p></p> 
<p><span style="color:rgb(100,100,100);">@Override</span></p> 
<p><strong><span style="color:rgb(127,0,85);">public</span></strong><span style="color:rgb(0,0,0);"> </span><strong><span style="color:rgb(127,0,85);">void</span></strong><span style="color:rgb(0,0,0);"> run() {<!-- --></span></p> 
<p></p> 
<p><span style="color:rgb(63,127,95);">//首先用notification的builder</span></p> 
<p><span style="color:rgb(0,0,0);">SendPacketBuilder </span><span style="color:rgb(106,62,62);">builder</span><span style="color:rgb(0,0,0);"> = </span><strong><span style="color:rgb(127,0,85);">new</span></strong><span style="color:rgb(0,0,0);"> SendPacketBuilder();</span></p> 
<p><span style="color:rgb(106,62,62);">builder</span><span style="color:rgb(0,0,0);">.setContent(</span><span style="color:rgb(42,0,255);">"test1"</span><span style="color:rgb(0,0,0);">);</span></p> 
<p><span style="color:rgb(106,62,62);">builder</span><span style="color:rgb(0,0,0);">.setName(</span><span style="color:rgb(42,0,255);">"test1"</span><span style="color:rgb(0,0,0);">);</span></p> 
<p><strong><span style="color:rgb(127,0,85);">try</span></strong><span style="color:rgb(0,0,0);"> {<!-- --></span></p> 
<p><span style="color:rgb(0,0,192);">publishService</span><span style="color:rgb(0,0,0);">.putNotification(</span><span style="color:rgb(106,62,62);">builder</span><span style="color:rgb(0,0,0);">.build());</span></p> 
<p><span style="color:rgb(0,0,0);">} </span><strong><span style="color:rgb(127,0,85);">catch</span></strong><span style="color:rgb(0,0,0);"> (InterruptedException </span><span style="color:rgb(106,62,62);">e</span><span style="color:rgb(0,0,0);">) {<!-- --></span></p> 
<p><span style="color:rgb(63,127,95);">// </span><strong><span style="color:rgb(127,159,191);">TODO</span></strong><span style="color:rgb(63,127,95);"> Auto-generated catch block</span></p> 
<p><span style="color:rgb(106,62,62);">e</span><span style="color:rgb(0,0,0);">.printStackTrace();</span></p> 
<p><span style="color:rgb(0,0,0);">}</span></p> 
<p><span style="color:rgb(0,0,0);">}</span></p> 
<p><span style="color:rgb(0,0,0);">}, 3000,5000);</span></p> 
<p><span style="color:rgb(0,0,192);">timer2</span><span style="color:rgb(0,0,0);">.schedule(</span><strong><span style="color:rgb(127,0,85);">new</span></strong><span style="color:rgb(0,0,0);"> TimerTask() {<!-- --></span></p> 
<p></p> 
<p><span style="color:rgb(100,100,100);">@Override</span></p> 
<p><strong><span style="color:rgb(127,0,85);">public</span></strong><span style="color:rgb(0,0,0);"> </span><strong><span style="color:rgb(127,0,85);">void</span></strong><span style="color:rgb(0,0,0);"> run() {<!-- --></span></p> 
<p></p> 
<p><span style="color:rgb(0,0,0);">NewsBuilder </span><span style="color:rgb(106,62,62);">builder</span><span style="color:rgb(0,0,0);"> = </span><strong><span style="color:rgb(127,0,85);">new</span></strong><span style="color:rgb(0,0,0);"> NewsBuilder();</span></p> 
<p><span style="color:rgb(106,62,62);">builder</span><span style="color:rgb(0,0,0);">.setContent(</span><span style="color:rgb(42,0,255);">"test2"</span><span style="color:rgb(0,0,0);">);</span></p> 
<p><span style="color:rgb(0,0,0);">ListenableFuture&lt;?&gt; </span><span style="color:rgb(106,62,62);">f</span><span style="color:rgb(0,0,0);"> = </span><span style="color:rgb(0,0,192);">publishService</span><span style="color:rgb(0,0,0);">.offerNotification(</span><span style="color:rgb(106,62,62);">builder</span><span style="color:rgb(0,0,0);">.build());</span></p> 
<p><span style="color:rgb(0,0,0);">Futures.</span><em><span style="color:rgb(0,0,0);">addCallback</span></em><span style="color:rgb(0,0,0);">(</span><span style="color:rgb(106,62,62);">f</span><span style="color:rgb(0,0,0);">,</span><strong><span style="color:rgb(127,0,85);">new</span></strong><span style="color:rgb(0,0,0);"> FutureCallback() {<!-- --></span></p> 
<p> </p> 
<p><span style="color:rgb(63,127,95);">// 新开一个线程异步的回调这两个方法</span></p> 
<p><span style="color:rgb(100,100,100);">@Override</span></p> 
<p><strong><span style="color:rgb(127,0,85);">public</span></strong><span style="color:rgb(0,0,0);"> </span><strong><span style="color:rgb(127,0,85);">void</span></strong><span style="color:rgb(0,0,0);"> onSuccess(Object </span><span style="color:rgb(106,62,62);">result</span><span style="color:rgb(0,0,0);">) {<!-- --></span></p> 
<p><span style="color:rgb(63,127,95);">// </span><strong><span style="color:rgb(127,159,191);">TODO</span></strong><span style="color:rgb(63,127,95);"> Auto-generated method stub</span></p> 
<p></p> 
<p><span style="color:rgb(0,0,0);">}</span></p> 
<p> </p> 
<p><span style="color:rgb(100,100,100);">@Override</span></p> 
<p><strong><span style="color:rgb(127,0,85);">public</span></strong><span style="color:rgb(0,0,0);"> </span><strong><span style="color:rgb(127,0,85);">void</span></strong><span style="color:rgb(0,0,0);"> onFailure(Throwable </span><span style="color:rgb(106,62,62);">t</span><span style="color:rgb(0,0,0);">) {<!-- --></span></p> 
<p><span style="color:rgb(63,127,95);">// </span><strong><span style="color:rgb(127,159,191);">TODO</span></strong><span style="color:rgb(63,127,95);"> Auto-generated method stub</span></p> 
<p></p> 
<p><span style="color:rgb(0,0,0);">}</span></p> 
<p><span style="color:rgb(0,0,0);">});</span></p> 
<p><span style="color:rgb(0,0,0);">}</span></p> 
<p><span style="color:rgb(0,0,0);">}, 1300,4500);</span></p> 
<p><span style="color:rgb(0,0,0);">}</span></p> 
<p></p> 
<p><span style="color:rgb(0,0,0);">}</span></p> 
<p><span style="font-family:'宋体';">  需要用到</span>NotificationPublishService<span style="font-family:'宋体';">，这里使用了</span><span style="font-family:Calibri;">Timer</span><span style="font-family:'宋体';">类来定时发送消息，通过相应的</span><span style="font-family:Calibri;">builder</span><span style="font-family:'宋体';">类来对属性赋值，最后是欧阳</span><span style="font-family:Calibri;">NotificationPublishService</span><span style="font-family:'宋体';">的</span><span style="font-family:Calibri;">putNotification</span><span style="font-family:'宋体';">方法来发送相应的</span><span style="font-family:Calibri;">notification</span><span style="font-family:'宋体';">，从这里也可以看到，发布者并不指定谁是具体的接收者，这种机制下，发布者是不关心接收者具体是谁。</span></p> 
<p><span style="font-family:'宋体';">打开</span>NotificationPublishService<span style="font-family:'宋体';">看到有三个方法： </span><span style="color:rgb(0,0,0);">    </span></p> 
<p><strong><span style="color:rgb(127,0,85);">void</span></strong><span style="color:rgb(0,0,0);"> </span><span style="color:rgb(0,0,0);background:rgb(192,192,192);">putNotification</span><span style="color:rgb(0,0,0);">(Notification </span><span style="color:rgb(106,62,62);">notification</span><span style="color:rgb(0,0,0);">) </span><strong><span style="color:rgb(127,0,85);">throws</span></strong><span style="color:rgb(0,0,0);"> InterruptedException;</span></p> 
<p><span style="color:rgb(0,0,0);"> </span></p> 
<p><span style="color:rgb(0,0,0);">ListenableFuture&lt;?&gt; offerNotification(Notification </span><span style="color:rgb(106,62,62);">notification</span><span style="color:rgb(0,0,0);">);</span></p> 
<p><span style="color:rgb(0,0,0);"> </span></p> 
<p><span style="color:rgb(0,0,0);">ListenableFuture&lt;?&gt; offerNotification(Notification </span><span style="color:rgb(106,62,62);">notification</span><span style="color:rgb(0,0,0);">, </span><strong><span style="color:rgb(127,0,85);">int</span></strong><span style="color:rgb(0,0,0);"> </span><span style="color:rgb(106,62,62);">timeout</span><span style="color:rgb(0,0,0);">, TimeUnit </span><span style="color:rgb(106,62,62);">unit</span><span style="color:rgb(0,0,0);">)</span><span style="color:rgb(0,0,0);"> </span><strong><span style="color:rgb(127,0,85);">throws</span></strong><span style="color:rgb(0,0,0);"> InterruptedException;</span></p> 
<p>      putNotification<span style="font-family:'宋体';">方法是一个同步的调用，调用的时候如果发布消息的队列是空闲的就直接发送，如果这个队列是满的这个方法就会阻塞在这里，直到发布消息队列有空闲时才会执行，后边两个方法是异步调用，调用的时候不管发布队列是否空闲都会直接返回一个</span><span style="font-family:Calibri;">ListenableFuture</span><span style="font-family:'宋体';">，通过这个</span><span style="font-family:Calibri;">Future</span><span style="font-family:'宋体';">来查看是否发布成功，区别是最后一个方法会定义一个超时时间，如果超过指定的时间，就会返回失败。</span></p> 
<p>3. 创建接收者</p> 
<p>    <span style="font-family:'宋体';">接收者需要实现相应的</span>PacketsendListener<span style="font-family:'宋体';">接口并实现接收到两个不同消息的相应处理的方法，具体如下，需要在两个方法中添加相应的处理逻辑</span></p> 
<p>    <strong><span style="color:rgb(127,0,85);">public</span></strong><span style="color:rgb(0,0,0);"> </span><strong><span style="color:rgb(127,0,85);">class</span></strong><span style="color:rgb(0,0,0);"> Subscriber </span><strong><span style="color:rgb(127,0,85);">implements</span></strong><span style="color:rgb(0,0,0);"> PacketsendListener{<!-- --></span></p> 
<p> </p> 
<p><span style="color:rgb(0,0,0);">Logger </span><span style="color:rgb(0,0,192);">LOG</span><span style="color:rgb(0,0,0);"> = LoggerFactory.</span><em><span style="color:rgb(0,0,0);">getLogger</span></em><span style="color:rgb(0,0,0);">(Subscriber.</span><strong><span style="color:rgb(127,0,85);">class</span></strong><span style="color:rgb(0,0,0);">);</span></p> 
<p></p> 
<p><span style="color:rgb(100,100,100);">@Override</span></p> 
<p><strong><span style="color:rgb(127,0,85);">public</span></strong><span style="color:rgb(0,0,0);"> </span><strong><span style="color:rgb(127,0,85);">void</span></strong><span style="color:rgb(0,0,0);"> onSendPacket(SendPacket </span><span style="color:rgb(106,62,62);">notification</span><span style="color:rgb(0,0,0);">) {<!-- --></span></p> 
<p><span style="color:rgb(0,0,192);">LOG</span><span style="color:rgb(0,0,0);">.info(</span><span style="color:rgb(42,0,255);">"Get:"</span><span style="color:rgb(0,0,0);">+</span><span style="color:rgb(106,62,62);">notification</span><span style="color:rgb(0,0,0);">.getName()+</span><span style="color:rgb(42,0,255);">","</span><span style="color:rgb(0,0,0);">+</span><span style="color:rgb(106,62,62);">notification</span><span style="color:rgb(0,0,0);">.getContent());</span></p> 
<p><span style="color:rgb(0,0,0);">}</span></p> 
<p> </p> 
<p><span style="color:rgb(100,100,100);">@Override</span></p> 
<p><strong><span style="color:rgb(127,0,85);">public</span></strong><span style="color:rgb(0,0,0);"> </span><strong><span style="color:rgb(127,0,85);">void</span></strong><span style="color:rgb(0,0,0);"> onNews(News </span><span style="color:rgb(106,62,62);">notification</span><span style="color:rgb(0,0,0);">) {<!-- --></span></p> 
<p><span style="color:rgb(0,0,192);">LOG</span><span style="color:rgb(0,0,0);">.info(</span><span style="color:rgb(42,0,255);">"Get:"</span><span style="color:rgb(0,0,0);">+</span><span style="color:rgb(106,62,62);">notification</span><span style="color:rgb(0,0,0);">.getContent());</span></p> 
<p><span style="color:rgb(0,0,0);">}</span></p> 
<p> </p> 
<p><span style="color:rgb(0,0,0);">}</span></p> 
<p><span style="color:rgb(0,0,0);"> </span></p> 
<p>4. blueprint<span style="font-family:'宋体';">文件填写</span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,0,0);">  </span><span style="color:rgb(63,95,191);">&lt;!-- 引用到服务 --&gt;</span></p> 
<p><span style="color:rgb(0,0,0);">  </span><span style="color:rgb(0,128,128);">&lt;</span><span style="color:rgb(63,127,127);">reference</span> <span style="color:rgb(127,0,127);">id</span><span style="color:rgb(0,0,0);">=</span><em><span style="color:rgb(42,0,255);">"notificationPublishService"</span></em></p> 
<p>    <span style="color:rgb(127,0,127);">interface</span><span style="color:rgb(0,0,0);">=</span><em><span style="color:rgb(42,0,255);">"org.opendaylight.controller.md.sal.binding.api.NotificationPublishService"</span></em></p> 
<p>  <span style="color:rgb(0,128,128);">/&gt;</span></p> 
<p><span style="color:rgb(0,0,0);">  </span></p> 
<p><span style="color:rgb(0,0,0);">  </span><span style="color:rgb(63,95,191);">&lt;!-- 创建bean把服务注入进去,需要在构造函数中有对应的赋值 --&gt;</span></p> 
<p><span style="color:rgb(0,0,0);">  </span><span style="color:rgb(0,128,128);">&lt;</span><span style="color:rgb(63,127,127);">bean</span> <span style="color:rgb(127,0,127);">id</span><span style="color:rgb(0,0,0);">=</span><em><span style="color:rgb(42,0,255);">"radio"</span></em> <span style="color:rgb(127,0,127);">class</span><span style="color:rgb(0,0,0);">=</span><em><span style="color:rgb(42,0,255);">"pub.Radio"</span></em><span style="color:rgb(0,128,128);">&gt;</span></p> 
<p><span style="color:rgb(0,0,0);">    </span><span style="color:rgb(0,128,128);">&lt;</span><span style="color:rgb(63,127,127);">argument</span> <span style="color:rgb(127,0,127);">ref</span><span style="color:rgb(0,0,0);">=</span><em><span style="color:rgb(42,0,255);">"notificationPublishService"</span></em><span style="color:rgb(0,128,128);">/&gt;</span><span style="color:rgb(0,0,0);">  </span></p> 
<p><span style="color:rgb(0,0,0);">  </span><span style="color:rgb(0,128,128);">&lt;/</span><span style="color:rgb(63,127,127);">bean</span><span style="color:rgb(0,128,128);">&gt;</span></p> 
<p><span style="color:rgb(0,0,0);">  </span></p> 
<p><span style="color:rgb(0,0,0);">  </span><span style="color:rgb(63,95,191);">&lt;!-- 注册接收者 --&gt;</span></p> 
<p><span style="color:rgb(0,0,0);">  </span><span style="color:rgb(0,128,128);">&lt;</span><span style="color:rgb(63,127,127);">bean</span> <span style="color:rgb(127,0,127);">id</span><span style="color:rgb(0,0,0);">=</span><em><span style="color:rgb(42,0,255);">"subscriber"</span></em> <span style="color:rgb(127,0,127);">class</span><span style="color:rgb(0,0,0);">=</span><em><span style="color:rgb(42,0,255);">"sub.Subscriber"</span></em><span style="color:rgb(0,128,128);">/&gt;</span></p> 
<p><span style="color:rgb(0,0,0);">  </span><span style="color:rgb(0,128,128);">&lt;</span><span style="color:rgb(63,127,127);">odl:notification-listener</span> <span style="color:rgb(127,0,127);">ref</span><span style="color:rgb(0,0,0);">=</span><em><span style="color:rgb(42,0,255);">"subscriber"</span></em><span style="color:rgb(0,128,128);">/&gt;</span></p> 
<p><span style="font-family:'宋体';">  在</span>blueprint<span style="font-family:'宋体';">文件中需要用</span><span style="font-family:Calibri;">reference</span><span style="font-family:'宋体';">标签引用到</span><span style="font-family:Calibri;">NotificationPublishService</span><span style="font-family:'宋体';">服务，然后用</span><span style="font-family:Calibri;">bean</span><span style="font-family:'宋体';">注册发布者，并通过</span><span style="font-family:Calibri;">argument</span><span style="font-family:'宋体';">标签将应用到的</span><span style="font-family:Calibri;">NotificationPublishService</span><span style="font-family:'宋体';">注入到发布者中，然后用</span><span style="font-family:Calibri;">bean</span><span style="font-family:'宋体';">注册接收者，并用</span><span style="font-family:Calibri;">odl:notification-listener</span><span style="font-family:'宋体';">标签来注册接收者。</span></p> 
<p>5. 编译和测试</p> 
<p><span style="font-family:'宋体';">  在工程根目录下输入</span>mvn clean install<span style="font-family:'宋体';">命令对其进行编译，然后通过</span><span style="font-family:Calibri;">karaf</span><span style="font-family:'宋体';">运行控制器，启动后输入</span><span style="font-family:Calibri;">log:display</span><span style="font-family:'宋体';">命令查看日志，可以看到输出了相应的日志信息，证明接收者收到了发布者的消息</span></p> 
<p><span style="font-family:'宋体';"><img src="https://images2.imgbox.com/92/fa/8zATomW9_o.png" alt=""><br></span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/211f399233ca6c42dd658d462d41a1b4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">centos7  启动流程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3cce670e93e3555fb87cfa9a291d549c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">linux下安装jdk(rpm版)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>