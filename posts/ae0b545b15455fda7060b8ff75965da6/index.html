<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>决策树系列(四)——基于决策树算法实现员工离职率预测 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="决策树系列(四)——基于决策树算法实现员工离职率预测" />
<meta property="og:description" content="文章目录 基于决策树算法实现员工离职率预测一、引入工具包二、数据加载三、数据预处理3.1 重复值处理3.2 缺失值处理3.3 异常值处理 四、特征选择4.1 删除明显无关特征4.2 查看数值型特征相关性4.3 类别型特征探索性分析 五、特征工程类别型特征转换 六、模型训练6.1 切分特征和标签6.2 样本不均衡问题6.3 切分训练集和测试集6.4 模型训练6.5 模型评估6.6 使用网格搜索寻找最优参数对模型进行优化6.7 使用最优参数建立模型 七、待补充 基于决策树算法实现员工离职率预测 问题描述：
我们有员工的各种统计信息，以及该员工是否已经离职，统计的信息包括了（工资、出差、工作环境满意度、工作投入度、是否加班、是否升职、工资提升比例等）现在需要你来通过训练数据得出 员工离职预测，并给出你在测试集上的预测结果。
数据集地址：https://www.kaggle.com/c/rs6-attrition-predict/data
数据说明：
训练数据和测试数据，保存在train.csv和test.csv文件中。训练集包括1176条记录，36个字段，字段说明如下：
字段说明字段说明user_id用户ID，无意义特征MaritalStatus员工婚姻状况，Single单身，Married已婚，Divorced离婚Age员工年龄MonthlyIncome员工月收入，范围在1009到19999之间Attrition员工是否已经离职，Yes表示离职，No表示未离职MonthlyRate员工月收入BusinessTravel商务差旅预测，Non-Travel不出差，TravelRarely不经常出差，TravelFrequently经常出差NumCompaniesWorked员工曾经工作过的公司数DailyRate平均每日工资Over18年龄是否超过18岁Department员工所在部门，Sales销售部，Research &amp; Development研发部，HumanOverTime是否加班，Yes表示加班，No表示不加班DistanceFromHome公司跟家庭住址的距离，从1到29，1表示最近，29表示最远PercentSalaryHike工资提高的百分比Education员工的教育程度，从1到5，5表示教育程度最高PerformanceRating绩效评估EducationField员工所学习的专业领域RelationshipSatisfaction关系满意度，从1到4，1表示满意度最低，4表示满意度最高EmployeeCount雇员人数StandardHours标准工时EmployeeNumber工号StockOptionLevel股票期权水平EnvironmentSatisfaction员工对于工作环境的满意程度，从1到4，1的满意程度最低，4的满意程度最高TotalWorkingYears总工龄Gender员工性别，Male表示男性，Female表示女性TrainingTimesLastYear上一年的培训时长，从0到6，0表示没有培训，6表示培训时间最长HourlyRate每小时收入WorkLifeBalance工作与生活平衡程度，从1到4，1表示平衡程度最低，4表示平衡程度最高JobInvolvement员工工作投入度，从1到4，1为投入度最低，4为投入度最高YearsAtCompany在目前公司工作年数JobLevel职业级别，从1到5，1为最低级别，5为最高级别YearsInCurrentRole在目前工作职责的工作年数JobRole工作角色YearsSinceLastPromotion距离上次升职时长JobSatisfaction工作满意度，从1到4，1代表满意度最低，4代表最高YearsWithCurrManager跟目前的管理者共事年数 评分标准：AUC
一、引入工具包 import pandas as pd import numpy as np import matplotlib.pyplot as plt import seaborn as sns from sklearn.tree import DecisionTreeClassifier from sklearn.model_selection import train_test_split,cross_val_score from sklearn.metrics import roc_auc_score from imblearn.over_sampling import SMOTE from sklearn.model_selection import GridSearchCV 二、数据加载 data = pd." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ae0b545b15455fda7060b8ff75965da6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-08T13:26:30+08:00" />
<meta property="article:modified_time" content="2021-02-08T13:26:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">决策树系列(四)——基于决策树算法实现员工离职率预测</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">基于决策树算法实现员工离职率预测</a></li><li><ul><li><a href="#_32" rel="nofollow">一、引入工具包</a></li><li><a href="#_45" rel="nofollow">二、数据加载</a></li><li><a href="#_51" rel="nofollow">三、数据预处理</a></li><li><ul><li><a href="#31__52" rel="nofollow">3.1 重复值处理</a></li><li><a href="#32__62" rel="nofollow">3.2 缺失值处理</a></li><li><a href="#33__72" rel="nofollow">3.3 异常值处理</a></li></ul> 
   </li><li><a href="#_98" rel="nofollow">四、特征选择</a></li><li><ul><li><a href="#41__99" rel="nofollow">4.1 删除明显无关特征</a></li><li><a href="#42__112" rel="nofollow">4.2 查看数值型特征相关性</a></li><li><a href="#43__145" rel="nofollow">4.3 类别型特征探索性分析</a></li></ul> 
   </li><li><a href="#_266" rel="nofollow">五、特征工程</a></li><li><ul><li><a href="#_267" rel="nofollow">类别型特征转换</a></li></ul> 
   </li><li><a href="#_283" rel="nofollow">六、模型训练</a></li><li><ul><li><a href="#61__284" rel="nofollow">6.1 切分特征和标签</a></li><li><a href="#62__290" rel="nofollow">6.2 样本不均衡问题</a></li><li><a href="#63__303" rel="nofollow">6.3 切分训练集和测试集</a></li><li><a href="#64__310" rel="nofollow">6.4 模型训练</a></li><li><a href="#65__316" rel="nofollow">6.5 模型评估</a></li><li><a href="#66__324" rel="nofollow">6.6 使用网格搜索寻找最优参数对模型进行优化</a></li><li><a href="#67__353" rel="nofollow">6.7 使用最优参数建立模型</a></li></ul> 
   </li><li><a href="#_369" rel="nofollow">七、待补充</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>基于决策树算法实现员工离职率预测</h2> 
<p><em><strong>问题描述：</strong></em><br>   我们有员工的各种统计信息，以及该员工是否已经离职，统计的信息包括了（工资、出差、工作环境满意度、工作投入度、是否加班、是否升职、工资提升比例等）现在需要你来通过训练数据得出 员工离职预测，并给出你在测试集上的预测结果。<br> 数据集地址：<a href="https://www.kaggle.com/c/rs6-attrition-predict/data" rel="nofollow">https://www.kaggle.com/c/rs6-attrition-predict/data</a></p> 
<p><em><strong>数据说明：</strong></em></p> 
<p>  训练数据和测试数据，保存在train.csv和test.csv文件中。训练集包括1176条记录，36个字段，字段说明如下：</p> 
<table><thead><tr><th>字段</th><th>说明</th><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>user_id</td><td>用户ID，无意义特征</td><td>MaritalStatus</td><td>员工婚姻状况，Single单身，Married已婚，Divorced离婚</td></tr><tr><td>Age</td><td>员工年龄</td><td>MonthlyIncome</td><td>员工月收入，范围在1009到19999之间</td></tr><tr><td>Attrition</td><td>员工是否已经离职，Yes表示离职，No表示未离职</td><td>MonthlyRate</td><td>员工月收入</td></tr><tr><td>BusinessTravel</td><td>商务差旅预测，Non-Travel不出差，TravelRarely不经常出差，TravelFrequently经常出差</td><td>NumCompaniesWorked</td><td>员工曾经工作过的公司数</td></tr><tr><td>DailyRate</td><td>平均每日工资</td><td>Over18</td><td>年龄是否超过18岁</td></tr><tr><td>Department</td><td>员工所在部门，Sales销售部，Research &amp; Development研发部，Human</td><td>OverTime</td><td>是否加班，Yes表示加班，No表示不加班</td></tr><tr><td>DistanceFromHome</td><td>公司跟家庭住址的距离，从1到29，1表示最近，29表示最远</td><td>PercentSalaryHike</td><td>工资提高的百分比</td></tr><tr><td>Education</td><td>员工的教育程度，从1到5，5表示教育程度最高</td><td>PerformanceRating</td><td>绩效评估</td></tr><tr><td>EducationField</td><td>员工所学习的专业领域</td><td>RelationshipSatisfaction</td><td>关系满意度，从1到4，1表示满意度最低，4表示满意度最高</td></tr><tr><td>EmployeeCount</td><td>雇员人数</td><td>StandardHours</td><td>标准工时</td></tr><tr><td>EmployeeNumber</td><td>工号</td><td>StockOptionLevel</td><td>股票期权水平</td></tr><tr><td>EnvironmentSatisfaction</td><td>员工对于工作环境的满意程度，从1到4，1的满意程度最低，4的满意程度最高</td><td>TotalWorkingYears</td><td>总工龄</td></tr><tr><td>Gender</td><td>员工性别，Male表示男性，Female表示女性</td><td>TrainingTimesLastYear</td><td>上一年的培训时长，从0到6，0表示没有培训，6表示培训时间最长</td></tr><tr><td>HourlyRate</td><td>每小时收入</td><td>WorkLifeBalance</td><td>工作与生活平衡程度，从1到4，1表示平衡程度最低，4表示平衡程度最高</td></tr><tr><td>JobInvolvement</td><td>员工工作投入度，从1到4，1为投入度最低，4为投入度最高</td><td>YearsAtCompany</td><td>在目前公司工作年数</td></tr><tr><td>JobLevel</td><td>职业级别，从1到5，1为最低级别，5为最高级别</td><td>YearsInCurrentRole</td><td>在目前工作职责的工作年数</td></tr><tr><td>JobRole</td><td>工作角色</td><td>YearsSinceLastPromotion</td><td>距离上次升职时长</td></tr><tr><td>JobSatisfaction</td><td>工作满意度，从1到4，1代表满意度最低，4代表最高</td><td>YearsWithCurrManager</td><td>跟目前的管理者共事年数</td></tr></tbody></table> 
<p><em><strong>评分标准</strong></em>：AUC</p> 
<h3><a id="_32"></a>一、引入工具包</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns

<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token punctuation">,</span>cross_val_score
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> roc_auc_score
<span class="token keyword">from</span> imblearn<span class="token punctuation">.</span>over_sampling <span class="token keyword">import</span> SMOTE
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> GridSearchCV 
</code></pre> 
<h3><a id="_45"></a>二、数据加载</h3> 
<pre><code class="prism language-python">data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../data/train.csv'</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_51"></a>三、数据预处理</h3> 
<h4><a id="31__52"></a>3.1 重复值处理</h4> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"样本去重前样本数量：{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"样本去重后样本数量：{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

样本去重前样本数量：<span class="token number">1176</span>
样本去重后样本数量：<span class="token number">1176</span>
</code></pre> 
<p>该数据集无重复数据</p> 
<h4><a id="32__62"></a>3.2 缺失值处理</h4> 
<pre><code class="prism language-python">missingDf <span class="token operator">=</span> data<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
missingDf<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'feature'</span><span class="token punctuation">,</span><span class="token string">'missing_num'</span><span class="token punctuation">]</span>
missingDf<span class="token punctuation">[</span><span class="token string">'missing_percentage'</span><span class="token punctuation">]</span> <span class="token operator">=</span> missingDf<span class="token punctuation">[</span><span class="token string">'missing_num'</span><span class="token punctuation">]</span> <span class="token operator">/</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
missingDf<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/53/d4/xqwD2O0P_o.png" alt="在这里插入图片描述"><br> 该数据集无缺失数据</p> 
<h4><a id="33__72"></a>3.3 异常值处理</h4> 
<p><strong>筛选数值型特征</strong></p> 
<pre><code class="prism language-python">numeric_columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
object_columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> c <span class="token keyword">in</span> data<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
    <span class="token keyword">if</span> data<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>dtype <span class="token operator">==</span> <span class="token string">'object'</span><span class="token punctuation">:</span>
        object_columns<span class="token punctuation">.</span>append<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        numeric_columns<span class="token punctuation">.</span>append<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
</code></pre> 
<p><strong>绘制箱型图查看异常值</strong></p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>col <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>numeric_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>data<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">,</span>orient<span class="token operator">=</span><span class="token string">'v'</span><span class="token punctuation">,</span>ax<span class="token operator">=</span>ax<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span>col<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ca/5c/O8L7haBL_o.png" alt="在这里插入图片描述"><br>   此处截取了一些可能存在异常值的数值型特征，经过观察后，发现EmployeeCount特征数据全为1，StandardHours特征数据全为80,这些特征对模型无影响，之后要删除掉。此外，其他特征检验后无明显异常。此处以TotalWorkingYears特征为例：</p> 
<pre><code class="prism language-python">data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'TotalWorkingYears'</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">,</span><span class="token string">'TotalWorkingYears'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c3/da/NJDJdKQa_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_98"></a>四、特征选择</h3> 
<h4><a id="41__99"></a>4.1 删除明显无关特征</h4> 
<pre><code class="prism language-python">data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e2/ff/uMPRgYAM_o.png" alt="在这里插入图片描述"><br>   特征数据中，</p> 
<ul><li>EmployeeCount和StandardHours方差都为0，符合异常值检测值中数据都一样的结论，需要删除</li><li>user_id特征对模型无意义，需要删除</li><li>Over18特征中数据值全为Yes，也予以删除。</li></ul> 
<pre><code class="prism language-python">data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">,</span><span class="token string">'EmployeeCount'</span><span class="token punctuation">,</span><span class="token string">'EmployeeNumber'</span><span class="token punctuation">,</span><span class="token string">'StandardHours'</span><span class="token punctuation">,</span><span class="token string">'Over18'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="42__112"></a>4.2 查看数值型特征相关性</h4> 
<pre><code class="prism language-python">pearson_mat <span class="token operator">=</span> data<span class="token punctuation">.</span>corr<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'spearman'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>pearson_mat<span class="token punctuation">,</span>square<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'YlGnBu'</span><span class="token punctuation">)</span>
bottom<span class="token punctuation">,</span> top <span class="token operator">=</span> ax<span class="token punctuation">.</span>get_ylim<span class="token punctuation">(</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span>bottom <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">,</span> top <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/61/41/Gq92erBM_o.png" alt="在这里插入图片描述"></p> 
<p>  从图中可以看出，<strong>TotalWorkingYears(总工龄)</strong> 和 <strong>MonthlyIncome</strong>(月收入)相关性达到0.72,<strong>JobLevel</strong>(职业级别)和<strong>MonthlyIncome</strong>(月收入)相关性达到0.92，相关性很高。我们从常识来判断，月收入对员工离职的重要性是要大于其他两个特征的。所以，可以删除JobLevel和TotalWorkingYears两个特征，并认为<strong>月收入越高，员工级别越高，总工龄越高</strong>；</p> 
<p>  其次，<strong>YearsAtCompany</strong>(在目前公司工作年数) 和<strong>YearsInCurrentRole</strong>(在目前工作职责的工作年数) 、<strong>YearsWithCurrManager</strong>(跟目前的管理者共事年数)相关性过高，删除YearsInCurrentRole和YearsWithCurrManager两个特征。</p> 
<p>  PerformanceRating 和PercentSalaryHike相关性也过高，且PerformanceRating不明显影响员工离职率,所以删除PerformanceRating特征。</p> 
<pre><code class="prism language-python"><span class="token comment"># PerformanceRating:绩效评估</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 建立图像</span>
L1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'PerformanceRating'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    p <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'PerformanceRating'</span><span class="token punctuation">]</span> <span class="token operator">==</span> c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Attrition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>p<span class="token punctuation">,</span>labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'No'</span><span class="token punctuation">,</span><span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>autopct<span class="token operator">=</span><span class="token string">'%1.2f%%'</span><span class="token punctuation">,</span>explode<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 展示饼状图</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/df/63/HTjavLmg_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'JobLevel'</span><span class="token punctuation">,</span><span class="token string">'TotalWorkingYears'</span><span class="token punctuation">,</span><span class="token string">'YearsInCurrentRole'</span><span class="token punctuation">,</span><span class="token string">'YearsWithCurrManager'</span><span class="token punctuation">,</span><span class="token string">'PerformanceRating'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="43__145"></a>4.3 类别型特征探索性分析</h4> 
<p> <br> <strong>商务差旅频率与是否离职的关系</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># BusinessTravel:商务差旅频率</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 建立图像</span>
L1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'BusinessTravel'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    p <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'BusinessTravel'</span><span class="token punctuation">]</span> <span class="token operator">==</span> c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Attrition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>p<span class="token punctuation">,</span>labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'No'</span><span class="token punctuation">,</span><span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>autopct<span class="token operator">=</span><span class="token string">'%1.2f%%'</span><span class="token punctuation">,</span>explode<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 展示饼状图</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/22/ed/BjGF5QlZ_o.png" alt="在这里插入图片描述"><br>   可以看出，商务差旅数次数的增多对职工离职的影响也随之增大。出差月频繁，离职率越高。</p> 
<p><strong>加班与是否离职的关系</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># OverTime</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 建立图像</span>
L1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'OverTime'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    p <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'OverTime'</span><span class="token punctuation">]</span> <span class="token operator">==</span> c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Attrition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>p<span class="token punctuation">,</span>labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'No'</span><span class="token punctuation">,</span><span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>autopct<span class="token operator">=</span><span class="token string">'%1.2f%%'</span><span class="token punctuation">,</span>explode<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 展示饼状图</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f9/f9/72daC3Zv_o.png" alt="在这里插入图片描述"><br>   可以看出，是否加班对员工离职率影响很大，心领神会。</p> 
<p><strong>工作满意度与是否离职的关系</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># JobSatisfaction:工作满意度</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 建立图像</span>
L1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'JobSatisfaction'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    p <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'JobSatisfaction'</span><span class="token punctuation">]</span> <span class="token operator">==</span> c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Attrition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>p<span class="token punctuation">,</span>labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'No'</span><span class="token punctuation">,</span><span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>autopct<span class="token operator">=</span><span class="token string">'%1.2f%%'</span><span class="token punctuation">,</span>explode<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 展示饼状图</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/90/7b/goHxg3uC_o.png" alt="在这里插入图片描述"><br>   可以看出，工作满意度越低，离职率越高。</p> 
<p><strong>性别与是否离职的关系</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># Gender</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 建立图像</span>
L1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'Gender'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    p <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'Gender'</span><span class="token punctuation">]</span> <span class="token operator">==</span> c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Attrition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>p<span class="token punctuation">,</span>labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'No'</span><span class="token punctuation">,</span><span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>autopct<span class="token operator">=</span><span class="token string">'%1.2f%%'</span><span class="token punctuation">,</span>explode<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 展示饼状图</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a4/69/qQsgvcjv_o.png" alt="在这里插入图片描述">  我认为性别可能对离职率有影响但是不大。女性员工离职率可能较大。</p> 
<p><strong>员工所在部门与是否离职的关系</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># Department 员工所在部门</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 建立图像</span>
L1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'Department'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    p <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'Department'</span><span class="token punctuation">]</span> <span class="token operator">==</span> c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Attrition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>p<span class="token punctuation">,</span>labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'No'</span><span class="token punctuation">,</span><span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>autopct<span class="token operator">=</span><span class="token string">'%1.2f%%'</span><span class="token punctuation">,</span>explode<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 展示饼状图</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b3/09/ie9q2n86_o.png" alt="在这里插入图片描述"><br>   销售部门和HR部门的离职率较高。如果HR部门离职率较高，那么公司也很难长久的维持其他部门员工。</p> 
<p><strong>员工所学习的专业领域与是否离职的关系</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># EducationField 员工所学习的专业领域</span>

fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 建立图像</span>
L1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'EducationField'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    p <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'EducationField'</span><span class="token punctuation">]</span> <span class="token operator">==</span> c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Attrition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>p<span class="token punctuation">,</span>labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'No'</span><span class="token punctuation">,</span><span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>autopct<span class="token operator">=</span><span class="token string">'%1.2f%%'</span><span class="token punctuation">,</span>explode<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 展示饼状图</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ec/32/hdCmtCTK_o.png" alt="在这里插入图片描述"><br> <strong>员工所学习的专业领域与是否离职的关系</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># JobRole</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 建立图像</span>
L1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'JobRole'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    p <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'JobRole'</span><span class="token punctuation">]</span> <span class="token operator">==</span> c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Attrition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>p<span class="token punctuation">,</span>labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'No'</span><span class="token punctuation">,</span><span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>autopct<span class="token operator">=</span><span class="token string">'%1.2f%%'</span><span class="token punctuation">,</span>explode<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 展示饼状图</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/75/fd/rAPdjy1R_o.png" alt="在这里插入图片描述"><br>   销售和HR的离职率还是最高的。</p> 
<p><strong>员工的婚姻状况与是否离职的关系</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># MaritalStatus</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 建立图像</span>
L1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'MaritalStatus'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    p <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'MaritalStatus'</span><span class="token punctuation">]</span> <span class="token operator">==</span> c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Attrition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>p<span class="token punctuation">,</span>labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'No'</span><span class="token punctuation">,</span><span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>autopct<span class="token operator">=</span><span class="token string">'%1.2f%%'</span><span class="token punctuation">,</span>explode<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 展示饼状图</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ba/11/qtEAoERp_o.png" alt="在这里插入图片描述"><br>   单身的员工离职率较高，也符合社会情况。</p> 
<h3><a id="_266"></a>五、特征工程</h3> 
<h4><a id="_267"></a>类别型特征转换</h4> 
<pre><code class="prism language-python"><span class="token comment"># Attrition</span>
data<span class="token punctuation">[</span><span class="token string">'Attrition'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'Attrition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span><span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token string">"Yes"</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># Gender</span>
data<span class="token punctuation">[</span><span class="token string">'Gender'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'Gender'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span><span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token string">"Male"</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># OverTime</span>
data<span class="token punctuation">[</span><span class="token string">'OverTime'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'OverTime'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span><span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token string">"Yes"</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">for</span> fea <span class="token keyword">in</span>  <span class="token punctuation">[</span><span class="token string">'BusinessTravel'</span><span class="token punctuation">,</span> <span class="token string">'Department'</span><span class="token punctuation">,</span> <span class="token string">'EducationField'</span><span class="token punctuation">,</span><span class="token string">'JobRole'</span><span class="token punctuation">,</span><span class="token string">'MaritalStatus'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    labels <span class="token operator">=</span> data<span class="token punctuation">[</span>fea<span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
    data<span class="token punctuation">[</span>fea<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>fea<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>labels<span class="token punctuation">.</span>index<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_283"></a>六、模型训练</h3> 
<h4><a id="61__284"></a>6.1 切分特征和标签</h4> 
<pre><code class="prism language-python">X <span class="token operator">=</span> data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>columns <span class="token operator">!=</span> <span class="token string">"Attrition"</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'Attrition'</span><span class="token punctuation">]</span>
</code></pre> 
<h4><a id="62__290"></a>6.2 样本不均衡问题</h4> 
<pre><code class="prism language-python">y<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>0 988<br> 1 188<br> Name: Attrition, dtype: int64</p> 
<p><em><strong>数据量过少，使用上采样处理</strong></em></p> 
<pre><code class="prism language-python">sm <span class="token operator">=</span> SMOTE<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> sm<span class="token punctuation">.</span>fit_sample<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="63__303"></a>6.3 切分训练集和测试集</h4> 
<pre><code class="prism language-python">X <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
y <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>y<span class="token punctuation">)</span>

Xtrain<span class="token punctuation">,</span>Xtest<span class="token punctuation">,</span>Ytrain<span class="token punctuation">,</span>Ytest <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y <span class="token punctuation">,</span>test_size <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="64__310"></a>6.4 模型训练</h4> 
<pre><code class="prism language-python">model <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>Xtrain<span class="token punctuation">,</span>Ytrain<span class="token punctuation">)</span>
pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>Xtest<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="65__316"></a>6.5 模型评估</h4> 
<pre><code class="prism language-python">y_pred_prob <span class="token operator">=</span> model<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>Xtest<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
auc_score <span class="token operator">=</span> roc_auc_score<span class="token punctuation">(</span>Ytest<span class="token punctuation">,</span>y_pred_prob<span class="token punctuation">)</span><span class="token comment">#验证集上的auc值</span>
auc_score
</code></pre> 
<p>0.838745131090408</p> 
<h4><a id="66__324"></a>6.6 使用网格搜索寻找最优参数对模型进行优化</h4> 
<pre><code class="prism language-python">gini_thresholds <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>

parameters <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'splitter'</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token string">'best'</span><span class="token punctuation">,</span><span class="token string">'random'</span><span class="token punctuation">)</span>
    <span class="token punctuation">,</span><span class="token string">'criterion'</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token string">"gini"</span><span class="token punctuation">,</span><span class="token string">"entropy"</span><span class="token punctuation">)</span>
    <span class="token punctuation">,</span><span class="token string">"max_depth"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token operator">*</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">,</span><span class="token string">'min_samples_leaf'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token operator">*</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">,</span><span class="token string">'min_impurity_decrease'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token operator">*</span>np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
clf <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>
GS <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span>clf<span class="token punctuation">,</span> parameters<span class="token punctuation">,</span> cv<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>scoring<span class="token operator">=</span><span class="token string">'roc_auc'</span><span class="token punctuation">)</span>
GS<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>Xtrain<span class="token punctuation">,</span>Ytrain<span class="token punctuation">)</span>
</code></pre> 
<p><strong>最优评分：</strong></p> 
<pre><code class="prism language-python">GS<span class="token punctuation">.</span>best_score_
</code></pre> 
<p>0.9235445387585528<br> <strong>最优参数：</strong></p> 
<pre><code class="prism language-python">GS<span class="token punctuation">.</span>best_params_
</code></pre> 
<p>{‘criterion’: ‘gini’,<br> ‘max_depth’: 9,<br> ‘min_impurity_decrease’: 0.0,<br> ‘min_samples_leaf’: 11,<br> ‘splitter’: ‘best’}</p> 
<h4><a id="67__353"></a>6.7 使用最优参数建立模型</h4> 
<pre><code class="prism language-python">model <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>criterion<span class="token operator">=</span><span class="token string">'gini'</span><span class="token punctuation">,</span>max_depth<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span>min_impurity_decrease<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>min_samples_leaf<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">,</span>splitter<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>Xtrain<span class="token punctuation">,</span>Ytrain<span class="token punctuation">)</span>
model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>Xtest<span class="token punctuation">,</span>Ytest<span class="token punctuation">)</span>
</code></pre> 
<p>0.8549747048903878</p> 
<pre><code class="prism language-python">pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>Xtest<span class="token punctuation">)</span>
y_pred_prob <span class="token operator">=</span> model<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>Xtest<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
auc_score <span class="token operator">=</span> roc_auc_score<span class="token punctuation">(</span>Ytest<span class="token punctuation">,</span>y_pred_prob<span class="token punctuation">)</span><span class="token comment">#验证集上的auc值</span>
auc_score
</code></pre> 
<p>0.9232078995922646</p> 
<h3><a id="_369"></a>七、待补充</h3> 
<ol><li>年龄、收入等连续型特征可以分箱处理</li><li>删除过多特征，可以尝试特征组合，是否会有更好的模型表现</li><li>根据分析结果进行业务决策支持</li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e5753175e414e456f8272009d3098815/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java方法的自动调用问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0edf3127893db0246b2d907e02ada8e3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">deeplabv3&#43;系列之deeplabv3网络搭建</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>