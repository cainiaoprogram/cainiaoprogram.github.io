<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>QT压缩和解压ZIP学习笔记二：编译quazip 32位和64位dll - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="QT压缩和解压ZIP学习笔记二：编译quazip 32位和64位dll" />
<meta property="og:description" content="一、前言 QuaZIP是使用Qt/C&#43;&#43;对ZLIB进行简单封装的用于压缩及解压缩ZIP的开源库。适用于多种平台，利用它可以很方便的将单个或多个文件打包为zip文件，且打包后的zip文件可以通过其它工具打开。
QuaZIP下载： https://github.com/stachenov/quazip
ZLIB编译方法： https://blog.csdn.net/yxy244/article/details/105024989
编译小知识： QT编译要注意编译器MinGW和MSVC链接上有点不同：
在MSVC下编程，当要使用DLL动态库文件时，必须要有导入库.lib文件才能编译链接通过。
在MinGW下编程，既可以与导入库.lib链接，也可以直接与.dll动态库链接。在大多数情况下，.MinGW的导入库.dll.a文件不起作用，这称为Direct linking to a dll技术。
二、编译QuaZIP 1.quazip目录下新建一个lib文件夹，把编译好的zlib动态库和导入库复制过来，这里有几点注意：
（1）如果开发的是32位应用程序，那就复制32位zlib1.dll和lib；开发64位程序就复制64位的dll，编译32位和64位的zlib方法上面的链接有。
（2）如果用MinGW编译器，那么前面的编译知识就知道了，链接dll或lib都可以；但是用MSVC编译器，只能用zdll.lib导入库，而不能直接用dll。这里两个都复制过来，其实只复制lib也可以。
2.quazip目录下新建一个include文件夹，复制zlib的头文件过来
3.打开quazip工程，在.pro文件文件里找到win32，在最后添加头文件和库文件路径：
LIBS &#43;= -L$$PWD/lib/ -lzdll INCLUDEPATH &#43;= $$PWD/include 注意网上有的教程是链接到zlib1.dll，如果这么写，一定要用MinGW编译才能通过的哦。
LIBS &#43;= -L$$PWD/lib -lzlib1 INCLUDEPATH &#43;= $$PWD/include 4. Debug和Release都编译一下，就会得到quazip的动态库和它的导入库了
二、测试例程 1.新建一个QT工程，在工程目录下新建文件夹lib，复制quazip的导入库进来
2.工程目录下新建一个include文件夹，将quazip和zlib的头文件都复制过来
3. pro文件里添加头文件和库文件路径：
CONFIG(release, debug|release): LIBS &#43;= -L$$PWD/lib -lquazip CONFIG(debug, debug|release): LIBS &#43;= -L$$PWD/lib -lquazipd INCLUDEPATH &#43;= $$PWD/include 4.测试代码
#include &#34;JlCompress.h&#34;
static bool compressDir(QString fileCompressed, QString dir=QString(), bool recursive = true)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/433fcf553131497e65a809212e0956be/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-22T17:28:35+08:00" />
<meta property="article:modified_time" content="2020-03-22T17:28:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">QT压缩和解压ZIP学习笔记二：编译quazip 32位和64位dll</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、前言</h2> 
<p style="text-indent:33px;">QuaZIP是使用Qt/C++对ZLIB进行简单封装的用于压缩及解压缩ZIP的开源库。适用于多种平台，利用它可以很方便的将单个或多个文件打包为zip文件，且打包后的zip文件可以通过其它工具打开。</p> 
<h4>QuaZIP下载：</h4> 
<p><a href="https://github.com/stachenov/quazip">https://github.com/stachenov/quazip</a></p> 
<h4>ZLIB编译方法：</h4> 
<p><a href="https://blog.csdn.net/yxy244/article/details/105024989">https://blog.csdn.net/yxy244/article/details/105024989</a></p> 
<h4>编译小知识：</h4> 
<p style="text-indent:33px;">QT编译要注意编译器MinGW和MSVC链接上有点不同：</p> 
<p style="text-indent:33px;">在MSVC下编程，当要使用DLL动态库文件时，必须要有导入库.lib文件才能编译链接通过。</p> 
<p style="text-indent:33px;">在MinGW下编程，既可以与导入库.lib链接，也可以直接与.dll动态库链接。在大多数情况下，.MinGW的导入库.dll.a文件不起作用，这称为Direct linking to a dll技术。</p> 
<p style="text-indent:33px;"> </p> 
<h2>二、编译QuaZIP</h2> 
<p><strong>1.</strong>quazip目录下新建一个lib文件夹，把编译好的zlib动态库和导入库复制过来，这里有几点注意：</p> 
<p><img alt="" height="159" src="https://images2.imgbox.com/85/be/Tv8PDUOy_o.png" width="840"></p> 
<p>（1）如果开发的是32位应用程序，那就复制32位zlib1.dll和lib；开发64位程序就复制64位的dll，编译32位和64位的zlib方法上面的链接有。</p> 
<p>（2）如果用MinGW编译器，那么前面的编译知识就知道了，链接dll或lib都可以；但是用MSVC编译器，只能用zdll.lib导入库，而不能直接用dll。这里两个都复制过来，其实只复制lib也可以。</p> 
<p> </p> 
<p><strong>2.</strong>quazip目录下新建一个include文件夹，复制zlib的头文件过来</p> 
<p><img alt="" height="182" src="https://images2.imgbox.com/02/a0/d3pHmjKz_o.png" width="831"></p> 
<p><strong>3.</strong>打开quazip工程，在.pro文件文件里找到win32，在最后添加头文件和库文件路径：</p> 
<pre><code>LIBS += -L$$PWD/lib/ -lzdll
INCLUDEPATH += $$PWD/include</code></pre> 
<p><img alt="" height="476" src="https://images2.imgbox.com/a3/1b/p5Y0htHc_o.png" width="581"></p> 
<p>注意网上有的教程是链接到zlib1.dll，如果这么写，一定要用MinGW编译才能通过的哦。</p> 
<pre><code>LIBS += -L$$PWD/lib -lzlib1
INCLUDEPATH += $$PWD/include
</code></pre> 
<p> </p> 
<p><strong>4. </strong>Debug和Release都编译一下，就会得到quazip的动态库和它的导入库了</p> 
<p><img alt="" height="68" src="https://images2.imgbox.com/90/9c/DUGPYLHC_o.png" width="765"></p> 
<p><img alt="" height="87" src="https://images2.imgbox.com/5f/6a/WACBoaBg_o.png" width="647"></p> 
<h2>二、测试例程</h2> 
<p><strong>1.</strong>新建一个QT工程，在工程目录下新建文件夹lib，复制quazip的导入库进来</p> 
<p><img alt="" height="202" src="https://images2.imgbox.com/ed/3e/kIg1GtN5_o.png" width="898"></p> 
<p><strong>2.</strong>工程目录下新建一个include文件夹，将quazip和zlib的头文件都复制过来</p> 
<p><img alt="" height="471" src="https://images2.imgbox.com/0d/4f/tnKoB0WC_o.png" width="820"></p> 
<p><strong>3.</strong> pro文件里添加头文件和库文件路径：</p> 
<pre><code>CONFIG(release, debug|release): LIBS += -L$$PWD/lib -lquazip
CONFIG(debug, debug|release): LIBS += -L$$PWD/lib -lquazipd
INCLUDEPATH += $$PWD/include</code></pre> 
<p><img alt="" height="89" src="https://images2.imgbox.com/bb/34/SWkxG0uj_o.png" width="705"></p> 
<p><strong>4.</strong>测试代码</p> 
<p>#include "JlCompress.h"</p> 
<p><strong>static bool compressDir(QString fileCompressed, QString dir=QString(), bool recursive = true)</strong></p> 
<p>第一个参数fileCompressed表示压缩后的文件</p> 
<p>第二个参数dir表示待压缩的目录</p> 
<p>第三个参数recursive表示是否递归</p> 
<p>解压缩用静态方法：extractDir</p> 
<p><strong>static QStringList extractDir(QString fileCompressed, QString dir=QString())</strong></p> 
<p>第一个参数fileCompressed表示待解压缩的文件</p> 
<p>第二个参数表示解压缩存放的目录</p> 
<pre><code>#include "mainwindow.h"
#include "ui_mainwindow.h"
#include "JlCompress.h"

MainWindow::MainWindow(QWidget *parent)
    : QMainWindow(parent)
    , ui(new Ui::MainWindow)
{
    ui-&gt;setupUi(this);

    JlCompress::compressDir("d:\\test.zip", "d:\\test1"); //压缩
       JlCompress::extractDir("d:\\test.zip", "d:\\test2");//解压
}

MainWindow::~MainWindow()
{
    delete ui;
}
</code></pre> 
<p><strong>5.</strong>编译生成exe，别忘了把quazip、zlib1动态库复制过来和exe放一起，才能运行哦。</p> 
<p><img alt="" height="264" src="https://images2.imgbox.com/6b/b0/5ns5riOp_o.png" width="728"></p> 
<h2>三、注意事项</h2> 
<p><strong>1.</strong>根据你要开发的应用程序，编译zlib、quazip的32位dll或者64位dll，别搞混了。</p> 
<p><strong>2.</strong>要注意编译器MinGW和MSVC上链接的区别。</p> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7626039a5e574f88f7c390724cfd7437/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">你真的会在Linux系统安装应用？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dad33573a5a8d8783dde8a2d95c63ab7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java Swing 进度条</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>