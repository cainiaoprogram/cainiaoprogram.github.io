<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>10分钟物联网设备接入阿里云IoT平台 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="10分钟物联网设备接入阿里云IoT平台" />
<meta property="og:description" content="前言
最近尝试了一下阿里云IoT物联网平台，还是蛮强大的。在此记录一下学习过程。
本教程不需要任何外围硬件，一台电脑和一根能上网的网线即可。算是一篇Hello World了。先上效果图
第一章 准备工作
1.1 注册阿里云账号
首先打开阿里云的官网并注册新用户，网址为：
https://www.aliyun.com/product/iot
1.2 注册完成后自动跳转到实名认证界面，可以通过支付宝授权快速完成认证。
1.3 开通物联网平台
在左边菜单选择《产品与服务》中的物联网平台，并激活开通此功能。
开通成功后，即可进入管理控制台
1.4 软件环境搭建
下载并安装编辑器VS Code（全称Visual Studio Code）
https://code.visualstudio.com/
1.5 下载并安装Nodejs
https://nodejs.org/en/download/
第二章 IoT云端开发
2.1 打开阿里云控制台
https://iot.console.aliyun.com
2.2 创建高级版产品
在产品管理界面点击 创建产品，并选择高级版
2.3 新增产品属性
在产品详情的功能定义中点击 新增，创建属性
新增 温度
新增 湿度
注意：标识符非常重要，是JSON里传递的属性！而且要区分大小写！
属性界面一览
2.4 创建设备
首先点击设备管理，并在下拉菜单中选择Demo产品
点击 添加设备，并命名Unit01
创建完成后获得该设备的重要数据——三元组
可以继续添加其他设备
云端的任务告一段落。
点击Unit01进入设备详情，可以看到运行状态中并无数据。
第三章 设备端开发
本教程用nodejs程序来模拟设备，建立连接，上报数据。无实际硬件。
3.1 在电脑桌面创建设备端项目
创建项目文件夹 aliyun-iot-demo，本Demo共需要2个文件和一个库
创建文件package.json，代码如下
{ &#34;name&#34;: &#34;aliyun-iot-demo&#34;, &#34;dependencies&#34;: { &#34;aliyun-iot-mqtt&#34;: &#34;^0.0.4&#34; }, &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f1e6da6dbba81686da5469b5f177e356/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-01-09T15:04:05+08:00" />
<meta property="article:modified_time" content="2019-01-09T15:04:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">10分钟物联网设备接入阿里云IoT平台</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>前言</strong><br><span style="color:#444444;">最近尝试了一下阿里云IoT物联网平台，还是蛮强大的。在此记录一下学习过程。</span><br><span style="color:#444444;">本教程不需要任何外围硬件，一台电脑和一根能上网的网线即可。算是一篇Hello World了。先上效果图</span><br><img alt="" class="zoom" height="285" id="aimg_43203" src="https://images2.imgbox.com/46/f8/5ZFEMOhR_o.jpg" width="600"> <br><br><strong>第一章 准备工作</strong><br><span style="color:#444444;">1.1 注册阿里云账号</span><br><span style="color:#444444;">首先打开阿里云的官网并注册新用户，网址为：</span><br><a href="https://www.aliyun.com/product/iot" rel="nofollow">https://www.aliyun.com/product/iot</a><br><img alt="" class="zoom" id="aimg_43176" src="https://images2.imgbox.com/27/7a/DtoyoESR_o.jpg" width="600"> <br><br><span style="color:#444444;">1.2 注册完成后自动跳转到实名认证界面，可以通过支付宝授权快速完成认证。</span><br><img alt="" class="zoom" id="aimg_43206" src="https://images2.imgbox.com/aa/14/oD9xJjTO_o.jpg" width="600"> <br><br><span style="color:#444444;">1.3 开通物联网平台</span><br><span style="color:#444444;">在左边菜单选择《产品与服务》中的物联网平台，并激活开通此功能。</span><br><img alt="" class="zoom" id="aimg_43207" src="https://images2.imgbox.com/97/4d/Eeb6mzaA_o.jpg" width="600"> <br><br><span style="color:#444444;">开通成功后，即可进入管理控制台</span><br><img alt="" class="zoom" id="aimg_43182" src="https://images2.imgbox.com/ee/52/JojnoGT0_o.jpg" width="600"> <br><br><span style="color:#444444;">1.4 软件环境搭建</span><br><span style="color:#444444;">下载并安装编辑器VS Code（全称Visual Studio Code）</span><br><a href="https://code.visualstudio.com/" rel="nofollow">https://code.visualstudio.com/</a><br><img alt="" class="zoom" id="aimg_43183" src="https://images2.imgbox.com/dc/1b/DLfj92ZG_o.jpg" width="600"> <br><br><span style="color:#444444;">1.5 下载并安装Nodejs</span><br><a href="https://nodejs.org/en/download/" rel="nofollow">https://nodejs.org/en/download/</a><br><img alt="" class="zoom" id="aimg_43184" src="https://images2.imgbox.com/7c/f7/mznTzw1Z_o.jpg" width="600"> <br><br><strong>第二章 IoT云端开发</strong><br><span style="color:#444444;">2.1 打开阿里云控制台</span><br><a href="https://iot.console.aliyun.com/" rel="nofollow">https://iot.console.aliyun.com</a><br><img alt="" class="zoom" id="aimg_43185" src="https://images2.imgbox.com/18/23/uMgsNV2q_o.jpg" width="600"> <br><br><span style="color:#444444;">2.2 创建高级版产品</span><br><span style="color:#444444;">在产品管理界面点击 创建产品，并选择高级版</span><br><img alt="" class="zoom" id="aimg_43186" src="https://images2.imgbox.com/90/7b/yrAmJuA3_o.jpg" width="600"> <br><br><span style="color:#444444;">2.3 新增产品属性</span><br><span style="color:#444444;">在产品详情的功能定义中点击 新增，创建属性</span><br><img alt="" class="zoom" id="aimg_43187" src="https://images2.imgbox.com/2b/56/NIRETcK0_o.jpg" width="600"> <br><br><span style="color:#444444;">新增 温度</span><br><img alt="" class="zoom" id="aimg_43188" src="https://images2.imgbox.com/6c/82/4ND2n5BJ_o.jpg" width="600"> <br><br><span style="color:#444444;">新增 湿度</span><br><img alt="" class="zoom" id="aimg_43189" src="https://images2.imgbox.com/e6/73/sEHtCBPI_o.jpg" width="600"> <br><br><span style="color:#ff0000;">注意：标识符非常重要，是JSON里传递的属性！而且要区分大小写！</span><br><br><span style="color:#444444;">属性界面一览</span><br><img alt="" class="zoom" id="aimg_43190" src="https://images2.imgbox.com/fe/73/kyt4adH4_o.jpg" width="600"> <br><br><span style="color:#444444;">2.4 创建设备</span><br><span style="color:#444444;">首先点击设备管理，并在下拉菜单中选择Demo产品</span><br><img alt="" class="zoom" id="aimg_43191" src="https://images2.imgbox.com/b6/b3/qda3ITGA_o.jpg" width="600"> <br><br><span style="color:#444444;">点击 添加设备，并命名Unit01</span><br><img alt="" class="zoom" id="aimg_43192" src="https://images2.imgbox.com/aa/5d/XaVpo4jF_o.jpg" width="600"> <br><br><span style="color:#444444;">创建完成后获得该设备的重要数据——三元组</span><br><img alt="" class="zoom" id="aimg_43193" src="https://images2.imgbox.com/f8/af/ZLMft87I_o.jpg" width="600"> <br><br><span style="color:#444444;">可以继续添加其他设备</span><br><img alt="" class="zoom" id="aimg_43194" src="https://images2.imgbox.com/08/63/jWfZGlMw_o.jpg" width="600"> <br><br><span style="color:#444444;">云端的任务告一段落。</span><br><span style="color:#444444;">点击Unit01进入设备详情，可以看到运行状态中并无数据。</span><br><img alt="" class="zoom" id="aimg_43195" src="https://images2.imgbox.com/42/2c/puGiZYeD_o.jpg" width="600"> <br><br><strong>第三章 设备端开发</strong><br><span style="color:#444444;">本教程用nodejs程序来模拟设备，建立连接，上报数据。无实际硬件。</span><br><span style="color:#444444;">3.1 在电脑桌面创建设备端项目</span><br><span style="color:#444444;">创建项目文件夹 aliyun-iot-demo，本Demo共需要2个文件和一个库</span><br><span style="color:#444444;">创建文件package.json，代码如下</span></p> 
<pre class="has"><code>{

  "name": "aliyun-iot-demo",

  "dependencies": {

    "aliyun-iot-mqtt": "^0.0.4"

  },

  "author": "wongxming",

  "license": "MIT"

}</code></pre> 
<p> </p> 
<p><br><br><span style="color:#444444;">注：代码中author是原作者</span><br><img alt="" class="zoom" id="aimg_43196" src="https://images2.imgbox.com/77/78/vE5yY9xC_o.jpg" width="600"> <br><br><span style="color:#444444;">3.2 下载阿里云物联网套件硬件端SDK</span><br><span style="color:#444444;">在VS Code中打开CMD界面</span><br><img alt="" class="zoom" id="aimg_43197" src="https://images2.imgbox.com/e2/c0/O94OMH6e_o.jpg" width="600"> <br><br><span style="color:#444444;">用CD指令找到项目所在路径</span><br><img alt="" class="zoom" id="aimg_43198" src="https://images2.imgbox.com/77/5f/SznyrAKc_o.jpg" width="600"> <br><br><span style="color:#444444;">用NPM指令下载阿里IoT的MQTT库，笔者的下载进度卡住过，重试很多次才成功。</span><br><span style="color:#444444;">文末有下载好的压缩包，复制到项目路径下即可。</span></p> 
<pre class="has"><code class="language-bash">npm install aliyun-iot-mqtt -S</code></pre> 
<p> </p> 
<p><br><img alt="" class="zoom" id="aimg_43199" src="https://images2.imgbox.com/23/96/QOX4sETE_o.jpg" width="600"> <br><br><span style="color:#444444;">3.3 创建Nodejs程序文件thermometer.js</span></p> 
<pre class="has"><code class="language-javascript">//1.引入阿里云IoT的sdk
const mqtt = require('aliyun-iot-mqtt');

//2.设备属性
const options = {
    productKey: "产品productKey，这里是a1wgoXxYRbs", 
    deviceName: "设备deviceName,这里是Unit01",
    deviceSecret: "设备的secret，AEU2vP略",
    regionId: "cn-shanghai"};

//3.建立连接
const client = mqtt.getAliyunIotMqttClient(options);

//4.属性数据上报
const topic = `/sys/${options.productKey}/${options.deviceName}/thing/event/property/post`;
setInterval(function() {
    //发布数据到topic
    client.publish(topic, getPostData());

}, 5 * 1000);

function getPostData(){
    const payloadJson = {
        id: Date.now(),
        params: {
            Temperature: Math.floor((Math.random() * 20) + 10),
            Humidity: Math.floor((Math.random() * 20) + 60)
        },
        method: "thing.event.property.post"
    }

    console.log("===postData topic=" + topic)
    console.log(payloadJson)

    return JSON.stringify(payloadJson);

}
复制代码</code></pre> 
<p> </p> 
<p><br><img alt="" class="zoom" id="aimg_43200" src="https://images2.imgbox.com/2f/f7/tP9ImtVO_o.jpg" width="600"> <br><br><span style="color:#444444;">3.4 运行程序</span><br><span style="color:#444444;">在CMD窗口输入指令，运行代码，启动设备终端</span></p> 
<pre class="has"><code class="language-bash">node thermometer.js</code></pre> 
<p> </p> 
<p><br><img alt="" class="zoom" id="aimg_43201" src="https://images2.imgbox.com/60/76/6lzdTWgi_o.jpg" width="600"> <br><br><span style="color:#444444;">程序会定期上传随机的温度和湿度数据</span><br><img alt="" class="zoom" id="aimg_43202" src="https://images2.imgbox.com/39/ec/6trsSsiE_o.jpg" width="600"> <br><br><strong>第四章 最终效果</strong><br><span style="color:#444444;">回到控制台，在运行状态页面，激活 实时刷新，就可以看到温度和湿度值了</span><br><img alt="" class="zoom" id="aimg_43211" src="https://images2.imgbox.com/f7/38/7ccbR1M1_o.jpg" width="600"> <br><br><span style="color:#444444;">回到设备管理界面，可以看到当前只有Unit01设备在线</span><br><img alt="" class="zoom" id="aimg_43204" src="https://images2.imgbox.com/8b/60/PVofXktX_o.jpg" width="600"> <br><br><span style="color:#444444;">本例框图</span><br><img alt="" class="zoom" id="aimg_43212" src="https://images2.imgbox.com/9e/d8/OEfiKYQQ_o.jpg" width="600"></p> 
<p>原文地址：<a href="https://www.geek-workshop.com/thread-37883-1-1.html" rel="nofollow">https://www.geek-workshop.com/thread-37883-1-1.html</a></p> 
<p><strong>更多工业交流和工作帮助可以订阅我的个人订阅号哦！</strong></p> 
<p><strong><img alt="" class="has" height="200" src="https://images2.imgbox.com/d9/ac/nU7bhEti_o.jpg" width="200"></strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/20f415ca4716faa3bfedbac5b93fd07e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VUE打包时候报错：code ELIFECYCLE，npm install 正常，npm run build 时报错：code ELIFECYCLE</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/73b2650e7bacc068c955dba0ebb3df23/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">gpon学习</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>