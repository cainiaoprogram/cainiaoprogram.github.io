<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>web打印实现几种方法 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="web打印实现几种方法" />
<meta property="og:description" content="在工作中出现web打印的情况是非常多的，其实这也是一个比较烦人的问题，这篇博客整理一下关于Web打印的一些方法或者方式。
1. window.print()
这个方法是用来打印网页的，页面上的其他的元素也会被打印处理，在打印的时候页眉页脚是不太好控制的。
所以如果使用这种方法的话最好将结果放到两个注释中间，之后通过JS来实现打印区域的功能。
具体做法： &lt;!--startprint--&gt; &lt;div align=&#34;center&#34;&gt; &lt;!--省略部分代码--&gt; &lt;/div&gt; &lt;!--endprint--&gt; bdhtml=window.document.body.innerHTML; sprnstr=&#34;&lt;!--startprint--&gt;&#34;; eprnstr=&#34;&lt;!--endprint--&gt;&#34;; prnhtml=bdhtml.substr(bdhtml.indexOf(sprnstr)&#43;17); prnhtml=prnhtml.substring(0,prnhtml.indexOf(eprnstr)); window.document.body.innerHTML=prnhtml; window.print(); 特别注意：使用window.print方法是不能够打印IE浏览器中的移动或者旋转的动画的，但是在非IE浏览器中是可以支持的。
2. DLPrinter控件
DLPrinter打印控件完全免费，界面大方、使用简单、但无签名，支持打印预览、直接打印，可设置页眉、页脚、页边距、打印份数、纸张大小等信息。 这个控件的下载地址为：http://files.cnblogs.com/panshenglu/DLPrinter.rar
调用方法：
&lt;OBJECT ID=&#34;DLPrinter&#34; CLASSID=&#34;CLSID:5C230622-45E5-4e3c-893C-3BFDDC4DB5E4&#34; codebase=&#34;DLPrinter.cab&#34; height=&#34;0&#34; width=&#34;0&#34; &gt;&lt;/OBJECT&gt; &lt;script&gt; DLPrinter.MarginLeft=20; DLPrinter.MarginRight=20; DLPrinter.MarginTop=20; DLPrinter.MarginBottom=20; DLPrinter.CopyCount=2; DLPrinter.PageHeader=&#34;这是测试的页眉&#34;; DLPrinter.PageFooter=&#34;这是测试的页脚&#34;; DLPrinter.IsLandScape=1; DLPrinter.ContentURL=&#34;www.baidu.com&#34;; &lt;/script&gt; &lt;input type=&#34;button&#34; id=&#34;btnPrint&#34; value=&#34;Print Preview&#34; οnclick=&#34;DLPrinter.PrintPreview()&#34; /&gt; &lt;input type=&#34;button&#34; id=&#34;btnPrint&#34; value=&#34;Print with prompt&#34; οnclick=&#34;DLPrinter.Print()&#34; /&gt; &lt;input type=&#34;button&#34; id=&#34;btnPrint&#34; value=&#34;Print without prompt&#34; οnclick=&#34;DLPrinter.PrintDirect()&#34; /&gt; 3. Lodop
对于这个打印控件，用一个词来形容：强大！不仅调用方便，而且功能比你想像中要强大得多。强烈推荐使用。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0743e7e113dbbae89292de82b9773743/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-11-30T12:42:22+08:00" />
<meta property="article:modified_time" content="2014-11-30T12:42:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">web打印实现几种方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在工作中出现<span style="font-family:Times New Roman;">web</span><span style="font-family:宋体;">打印的情况是非常多的，其实这也是一个比较烦人的问题，这篇博客整理一下关于</span><span style="font-family:Times New Roman;">Web</span><span style="font-family:宋体;">打印的一些方法或者方式。</span></p> 
<p> </p> 
<p>1. window.print()</p> 
<p>这个方法是用来打印网页的，页面上的其他的元素也会被打印处理，在打印的时候页眉页脚是不太好控制的。</p> 
<p>所以如果使用这种方法的话最好将结果放到两个注释中间，之后通过<span style="font-family:Times New Roman;">JS</span><span style="font-family:宋体;">来实现打印区域的功能。</span></p> 
<p></p> 
<pre><code class="language-html">具体做法：
&lt;!--startprint--&gt;
     &lt;div align="center"&gt;
         &lt;!--省略部分代码--&gt;
     &lt;/div&gt;
  &lt;!--endprint--&gt;
 
bdhtml=window.document.body.innerHTML;
sprnstr="&lt;!--startprint--&gt;";
eprnstr="&lt;!--endprint--&gt;";
prnhtml=bdhtml.substr(bdhtml.indexOf(sprnstr)+17);
prnhtml=prnhtml.substring(0,prnhtml.indexOf(eprnstr));
window.document.body.innerHTML=prnhtml;
window.print();</code></pre> 
<br> 
<br> 
<p></p> 
<p> </p> 
<p><span style="color:rgb(0,0,255);">特别注意：使用<span style="font-family:Times New Roman;">window.print</span><span style="font-family:宋体;">方法是不能够打印</span><span style="font-family:Times New Roman;">IE</span><span style="font-family:宋体;">浏览器中的移动或者旋转的动画的，但是在非</span><span style="font-family:Times New Roman;">IE</span><span style="font-family:宋体;">浏览器中是可以支持的。</span></span></p> 
<p>2. DLPrinter<span style="font-family:宋体;">控件</span></p> 
<p><span style="color:rgb(51, 51, 51);">DLPrinter</span><span style="color:rgb(51, 51, 51);">打印控件完全免费，界面大方、使用简单、但无签名，支持打印预览、直接打印，可设置页眉、页脚、页边距、打印份数、纸张大小等信息。</span> </p> 
<p>这个控件的下载地址为：<a target="_blank" href="http://files.cnblogs.com/panshenglu/DLPrinter.rar" rel="nofollow noopener noreferrer"><span style="color:rgb(128, 0, 128);">http://files.cnblogs.com/panshenglu/DLPrinter.rar</span></a></p> 
<p><span style="color:rgb(51, 51, 51);">调用方法：</span></p> 
<p></p> 
<pre><code class="language-html">&lt;OBJECT ID="DLPrinter" CLASSID="CLSID:5C230622-45E5-4e3c-893C-3BFDDC4DB5E4"  codebase="DLPrinter.cab" height="0" width="0" &gt;&lt;/OBJECT&gt;
&lt;script&gt;
  DLPrinter.MarginLeft=20;
  DLPrinter.MarginRight=20;
  DLPrinter.MarginTop=20;
  DLPrinter.MarginBottom=20;
  DLPrinter.CopyCount=2;
  DLPrinter.PageHeader="这是测试的页眉";
  DLPrinter.PageFooter="这是测试的页脚";
  DLPrinter.IsLandScape=1;
      DLPrinter.ContentURL="www.baidu.com";
&lt;/script&gt;
 
&lt;input type="button" id="btnPrint" value="Print Preview" οnclick="DLPrinter.PrintPreview()" /&gt;
&lt;input type="button" id="btnPrint" value="Print with prompt" οnclick="DLPrinter.Print()" /&gt;
&lt;input type="button" id="btnPrint" value="Print without prompt" οnclick="DLPrinter.PrintDirect()" /&gt;</code></pre> 
<br> 
<br> 
<p></p> 
<p>3. Lodop</p> 
<p><span style="color:rgb(51, 51, 51);">对于这个打印控件，用一个词来形容：强大！不仅调用方便，而且功能比你想像中要强大得多。</span><span style="color:rgb(51, 51, 51);">强烈推荐使用。</span></p> 
<p><span style="color:rgb(51, 51, 51);">下载地址：</span><a target="_blank" href="http://www.lodop.net/" rel="nofollow noopener noreferrer"><span style="color:rgb(0, 0, 255);">http://www.lodop.net/</span></a></p> 
<p><span style="color:rgb(51, 51, 51);">推荐去官网中的功能演示来学习一下这个打印空间。</span></p> 
<p style="text-align: center;"> <img src="https://images2.imgbox.com/51/31/OKynk5jC_o.png" alt=""></p> 
<p><br></p> 
<p>4. Jquery<span style="font-family:宋体;">打印</span></p> 
<p>下面一个是用<span style="font-family:Times New Roman;">Jquery</span><span style="font-family:宋体;">框架写的一个</span><span style="font-family:Times New Roman;">web</span><span style="font-family:宋体;">打印控件的功能。</span></p> 
<p>代码如下：</p> 
<p></p> 
<pre><code class="language-html">(function ($) {
    var printAreaCount = 0;
    $.fn.printArea = function () {
        var ele = $(this);
        var idPrefix = "printArea_";
        removePrintArea(idPrefix + printAreaCount);
        printAreaCount++;
        var iframeId = idPrefix + printAreaCount;
        var iframeStyle = 'position:absolute;width:0px;height:0px;left:-500px;top:-500px;';
        iframe = document.createElement('IFRAME');
        $(iframe).attr({
            style: iframeStyle,
            id: iframeId
        });
        document.body.appendChild(iframe);
        var doc = iframe.contentWindow.document;
        $(document).find("link").filter(function () {
            return $(this).attr("rel").toLowerCase() == "stylesheet";
        }).each(
                function () {
                    doc.write('&lt;link type="text/css" rel="stylesheet" href="'
                            + $(this).attr("href") + '" &gt;');
                });
        doc.write('&lt;div class="' + $(ele).attr("class") + '"&gt;' + $(ele).html()
                + '&lt;/div&gt;');
        doc.close();
        var frameWindow = iframe.contentWindow;
        frameWindow.close();
        frameWindow.focus();
        frameWindow.print();
    }
    var removePrintArea = function (id) {
        $("iframe#" + id).remove();
    };
})(jQuery);
 
 
&lt;input type="button" id="btnPrint" value="打印"/&gt;
&lt;div id="printContent"&gt;要打印的内容区域&lt;div&gt;
 
&lt;script type="text/javascript"&gt;
$(function(){
        $("#btnPrint").click(function(){ $("#printContent").printArea(); });
});
&lt;/script&gt;</code></pre> 
<br> 
<br> 
<p></p> 
<p> </p> 
<p>其实关于打印控件还有很多，找到自己最合适的才是硬道理，如果还有更多的<span style="font-family:Times New Roman;">web</span><span style="font-family:宋体;">打印实现方法，可以给我留言。</span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a682f983eb21c8ff2c2ed5296e60ac88/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Exporting Attachments</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/22903da36e51c941855fb42581e8b6e4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android – Google Play issue: “your device isn’t compatible with this version”</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>