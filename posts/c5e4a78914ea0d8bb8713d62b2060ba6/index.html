<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>泰坦尼克号 xgboost自定义损失 python - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="泰坦尼克号 xgboost自定义损失 python" />
<meta property="og:description" content="from sklearn.ensemble import AdaBoostClassifier, GradientBoostingRegressor, GradientBoostingClassifier, RandomForestRegressor from sklearn.metrics import recall_score, precision_score, accuracy_score, f1_score, mean_squared_error from sklearn.model_selection import train_test_split, GridSearchCV from sklearn.tree import DecisionTreeClassifier from xgboost import XGBClassifier import xgboost as xgb import numpy as np import pandas as pd import warnings import matplotlib.pyplot as plt import matplotlib as mpl def sigmoid(x): return 1 / (1 &#43; np.exp(-x)) # 定义f: theta * x def log_reg(y_hat, y): # 自定义损失函数，logistics回归的一阶导与二阶导 p = 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c5e4a78914ea0d8bb8713d62b2060ba6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-05-08T22:52:24+08:00" />
<meta property="article:modified_time" content="2021-05-08T22:52:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">泰坦尼克号 xgboost自定义损失 python</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> AdaBoostClassifier<span class="token punctuation">,</span> GradientBoostingRegressor<span class="token punctuation">,</span> GradientBoostingClassifier<span class="token punctuation">,</span> RandomForestRegressor
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> recall_score<span class="token punctuation">,</span> precision_score<span class="token punctuation">,</span> accuracy_score<span class="token punctuation">,</span> f1_score<span class="token punctuation">,</span> mean_squared_error
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token punctuation">,</span> GridSearchCV
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier

<span class="token keyword">from</span> xgboost <span class="token keyword">import</span> XGBClassifier
<span class="token keyword">import</span> xgboost <span class="token keyword">as</span> xgb


<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> warnings

<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> matplotlib <span class="token keyword">as</span> mpl

<span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 定义f: theta * x</span>
<span class="token keyword">def</span> <span class="token function">log_reg</span><span class="token punctuation">(</span>y_hat<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 自定义损失函数，logistics回归的一阶导与二阶导</span>
    p <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>y_hat<span class="token punctuation">)</span><span class="token punctuation">)</span>
    g <span class="token operator">=</span> p <span class="token operator">-</span> y<span class="token punctuation">.</span>get_label<span class="token punctuation">(</span><span class="token punctuation">)</span>
    h <span class="token operator">=</span> p <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">-</span>p<span class="token punctuation">)</span>
    <span class="token keyword">return</span> g<span class="token punctuation">,</span> h


<span class="token keyword">def</span> <span class="token function">error_rate</span><span class="token punctuation">(</span>y_hat<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#自定义错误率的计算方式</span>
    <span class="token keyword">return</span> <span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y<span class="token punctuation">.</span>get_label<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token punctuation">(</span>y_hat <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>y_hat<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    <span class="token comment"># print(df.isnull().sum())</span>

    df<span class="token punctuation">[</span><span class="token string">'Sex'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>Categorical<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Sex'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>codes
    df_embarked <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Embarked'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># df_embarked.rename(columns=lambda x: 'Embarked_' + str(x), inplace=True)</span>
    df_embarked<span class="token punctuation">.</span>columns <span class="token operator">=</span> df_embarked<span class="token punctuation">.</span>columns<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">'Embraked_'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
    df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Embarked'</span><span class="token punctuation">,</span> <span class="token string">'Ticket'</span><span class="token punctuation">,</span> <span class="token string">'Cabin'</span><span class="token punctuation">,</span> <span class="token string">'PassengerId'</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token comment"># df = df.join(df_embarked, how='left')</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df<span class="token punctuation">,</span> df_embarked<span class="token punctuation">,</span> right_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> left_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span>
    <span class="token triple-quoted-string string">'''Fare 不存在空值，就对age进行填充,利用GBDT进行填充'''</span>
    model_feature <span class="token operator">=</span> GradientBoostingRegressor<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> subsample<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>
    <span class="token comment"># model_feature = RandomForestRegressor(n_estimators=1000, max_depth=6, min_samples_split=2)</span>
    selected_feature <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Fare'</span><span class="token punctuation">,</span> <span class="token string">'Parch'</span><span class="token punctuation">,</span> <span class="token string">'SibSp'</span><span class="token punctuation">,</span> <span class="token string">'Pclass'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span>
    <span class="token comment"># selected_feature = ['Pclass', 'Sex', 'SibSp', 'Parch', 'Fare', 'Embarked', 'Age']</span>
    age_test <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">.</span>Age<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span>selected_feature<span class="token punctuation">]</span>
    age_train <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span>selected_feature<span class="token punctuation">]</span>
    x_train<span class="token punctuation">,</span> y_train <span class="token operator">=</span> age_train<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> age_train<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    x_test <span class="token operator">=</span> age_test<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    model_feature<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
    y_pred_train <span class="token operator">=</span> model_feature<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'train loss is '</span><span class="token punctuation">,</span> mean_squared_error<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> y_pred_train<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># age_test['Age'] = gbdt_feature.predict(x_test)</span>
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">.</span>Age<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> model_feature<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>

    <span class="token triple-quoted-string string">'''进行预测，通过adaboost, GBDT, xgboost进行比较'''</span>
    x<span class="token punctuation">,</span> y <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>columns <span class="token operator">!=</span> <span class="token string">'Survived'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'Survived'</span><span class="token punctuation">]</span>
    x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> train_size<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    ada_base_tree <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>max_depth<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> min_samples_split<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
    ada <span class="token operator">=</span> AdaBoostClassifier<span class="token punctuation">(</span>ada_base_tree<span class="token punctuation">)</span>
    para_ada <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'n_estimators'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
    scores <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'roc_auc'</span><span class="token punctuation">,</span> <span class="token string">'precision'</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> score <span class="token keyword">in</span> scores<span class="token punctuation">:</span>
        clf <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span>ada<span class="token punctuation">,</span> param_grid<span class="token operator">=</span>para_ada<span class="token punctuation">,</span> scoring<span class="token operator">=</span>score<span class="token punctuation">)</span>
        clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Best parameters set found on development set:"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>clf<span class="token punctuation">.</span>best_params_<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'best score '</span><span class="token punctuation">,</span> clf<span class="token punctuation">.</span>best_score_<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    ada_estimator <span class="token operator">=</span> AdaBoostClassifier<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    ada_estimator<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
    y_pred <span class="token operator">=</span> ada_estimator<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'accuracy '</span><span class="token punctuation">,</span> accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'f1 measure '</span><span class="token punctuation">,</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token triple-quoted-string string">'''xgboost'''</span>
    d_train <span class="token operator">=</span> xgb<span class="token punctuation">.</span>DMatrix<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> label<span class="token operator">=</span>y_train<span class="token punctuation">)</span>
    d_test <span class="token operator">=</span> xgb<span class="token punctuation">.</span>DMatrix<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> label<span class="token operator">=</span>y_test<span class="token punctuation">)</span>
    watch_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>d_test<span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>d_train<span class="token punctuation">,</span> <span class="token string">'train'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    param_xgboost <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'eta'</span><span class="token punctuation">:</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token string">'n_estimators'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'gamma'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'max_depth'</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'min_child_weight'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token string">'colsample_bytree'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'colsample_bylevel'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'subsample'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'reg_lambda'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'reg_alpha'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token string">'seed'</span><span class="token punctuation">:</span> <span class="token number">33</span><span class="token punctuation">}</span>

    xgboost_clf <span class="token operator">=</span> xgb<span class="token punctuation">.</span>train<span class="token punctuation">(</span>params<span class="token operator">=</span>param_xgboost<span class="token punctuation">,</span> dtrain<span class="token operator">=</span>d_train<span class="token punctuation">,</span> num_boost_round<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> evals<span class="token operator">=</span>watch_list<span class="token punctuation">,</span> obj<span class="token operator">=</span>log_reg<span class="token punctuation">,</span> feval<span class="token operator">=</span>error_rate<span class="token punctuation">)</span> <span class="token comment"># 自定义目标函数还有损失</span>
    y_pred_boost <span class="token operator">=</span> xgboost_clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>d_test<span class="token punctuation">)</span>
    <span class="token comment"># print(sigmoid(y_pred_boost))</span>
    <span class="token comment"># search_parm = [{'n_estimators': np.linspace(100, 1000, 10, dtype=int)}]</span>
    <span class="token comment"># xgb_classified = xgb.XGBClassifier(**param_xgboost)</span>
    <span class="token comment"># grid_xgboost = GridSearchCV(estimator=xgb_classified, param_grid=search_parm, cv=3, scoring='roc_auc')</span>
    <span class="token comment"># grid_xgboost.fit(x_train, y_train)</span>
    <span class="token comment"># print('best param: ', grid_xgboost.best_params_)</span>
    <span class="token comment"># print('best score: ', grid_xgboost.best_score_)</span>

    xgb_classified <span class="token operator">=</span> xgb<span class="token punctuation">.</span>XGBClassifier<span class="token punctuation">(</span><span class="token operator">**</span>param_xgboost<span class="token punctuation">)</span>
    xgb_classified<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> eval_set<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> eval_metric<span class="token operator">=</span><span class="token string">'auc'</span><span class="token punctuation">)</span>
    <span class="token comment"># y_pred_xgboost = xgb_classified.predict(x_test)    # 直接predict会默认0.5是分类的阈值,用predict_prob之后再进行阈值处理</span>
    y_pred_xgboost <span class="token operator">=</span> xgb_classified<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>   <span class="token comment"># 二分类是加了sigmoid函数再输出， 多分类用softmax函数</span>
    <span class="token comment"># print(y_pred_xgboost)</span>
    y_prob_pred <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>y_pred_xgboost<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 取索引最大作为标签</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'xbgoost accuracy: '</span><span class="token punctuation">,</span> accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_prob_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'xgboost f1 measure '</span><span class="token punctuation">,</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_prob_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>




<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>
    pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
    pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_rows'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
    np<span class="token punctuation">.</span>set_printoptions<span class="token punctuation">(</span>precision<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
    path <span class="token operator">=</span> r<span class="token string">'Titanic.train.csv'</span>
    load_data<span class="token punctuation">(</span>path<span class="token punctuation">)</span>


</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/30478394d4b151443db37be4661ba8b5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">页面设计思路</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6281e5479a6bbb7c3154b9d489cb96f0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python自然语言处理入门-词典分词</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>