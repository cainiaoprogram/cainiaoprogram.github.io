<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>zabbix部署监控mysql_部署zabbix监控mysql (一) 安装zabbix - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="zabbix部署监控mysql_部署zabbix监控mysql (一) 安装zabbix" />
<meta property="og:description" content="部署zabbix监控mysql
(1)安装LAMP环境
[root@localhost ~]# yum -y installmysql-server http php
(2)安装zabbix web所需要的依赖包
[root@localhost ~]# yum -y installmysql-dev gcc net-snmp-devel curl-devel perl-DBI php-gd php-mysql php-bcmathphp-mbstring php-xml
安装Fping：
[root@localhost zabbix]# tar xffping-3.13.tar.gz
[root@localhost zabbix]# cd fping-3.13
[root@localhost fping-3.13]# ./configure
[root@localhost fping-3.13]# make&amp;&amp; make install
(3)创建Zabbix运行的用户
[root@localhost fping-3.13]# groupaddzabbix
[root@localhost fping-3.13]# useradd -gzabbix zabbix
[root@localhost fping-3.13]# chownroot:zabbix /usr/local/sbin/fping
[root@localhost fping-3.13]# chmod 4710/usr/local/sbin/fping
(4)安装zabbix server：
[root@localhost zabbix]# tar xfzabbix-3.0.2.tar.gz
[root@localhost zabbix]# cd zabbix-3.0.2
[root@localhost zabbix-3." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/499725dd1bc6fcf7ecf1ea24aa80adea/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-05T02:25:13+08:00" />
<meta property="article:modified_time" content="2021-02-05T02:25:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">zabbix部署监控mysql_部署zabbix监控mysql (一) 安装zabbix</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>部署zabbix监控mysql</p> 
 <p>(1)安装LAMP环境</p> 
 <p>[root@localhost ~]# yum -y installmysql-server http php</p> 
 <p>(2)安装zabbix web所需要的依赖包</p> 
 <p>[root@localhost ~]# yum -y installmysql-dev gcc net-snmp-devel curl-devel perl-DBI php-gd php-mysql php-bcmathphp-mbstring php-xml</p> 
 <p>安装Fping：</p> 
 <p>[root@localhost zabbix]# tar xffping-3.13.tar.gz</p> 
 <p>[root@localhost zabbix]# cd fping-3.13</p> 
 <p>[root@localhost fping-3.13]# ./configure</p> 
 <p>[root@localhost fping-3.13]# make&amp;&amp; make install</p> 
 <p>(3)创建Zabbix运行的用户</p> 
 <p>[root@localhost fping-3.13]# groupaddzabbix</p> 
 <p>[root@localhost fping-3.13]# useradd -gzabbix zabbix</p> 
 <p>[root@localhost fping-3.13]# chownroot:zabbix /usr/local/sbin/fping</p> 
 <p>[root@localhost fping-3.13]# chmod 4710/usr/local/sbin/fping</p> 
 <p>(4)安装zabbix server：</p> 
 <p>[root@localhost zabbix]# tar xfzabbix-3.0.2.tar.gz</p> 
 <p>[root@localhost zabbix]# cd zabbix-3.0.2</p> 
 <p>[root@localhost zabbix-3.0.2]# ./configure--prefix=/usr/local/zabbix --enable-server --enable-agent --enable-proxy--with-mysql=/usr/bin/mysql_config --with-net-snmp --with-libcurl</p> 
 <p>[root@localhost zabbix-3.0.2]# make</p> 
 <p>[root@localhost zabbix-3.0.2]# make install</p> 
 <p>Zabbix server 配置与启动</p> 
 <p>(1)创建Zabbix数据库和Mysql用户</p> 
 <p>mysql&gt; create schema zabbix characterset utf8;</p> 
 <p>Query OK, 1 row affected (0.00 sec)</p> 
 <p>mysql&gt; create user"zabbix"@"%" identified by "123456";</p> 
 <p>Query OK, 0 rows affected (0.00 sec)</p> 
 <p>mysql&gt; grant all on zabbix.* to"zabbix"@"%";</p> 
 <p>Query OK, 0 rows affected (0.00 sec)</p> 
 <p>mysql&gt; grant all on zabbix.* to"zabbix"@localhost identified by "123456";</p> 
 <p>mysql&gt; flush privileges;</p> 
 <p>Query OK, 0 rows affected (0.00 sec)</p> 
 <p>(2)导入zabbix数据库初始数据</p> 
 <p>[root@localhost zabbix-3.0.2]# cddatabase/mysql/</p> 
 <p>[root@localhost mysql]# ll</p> 
 <p>总用量 3012</p> 
 <p>-rw-r--r-- 1 1000 1000  990351 4月  20 18:01 data.sql</p> 
 <p>-rw-r--r-- 1 1000 1000 1978341 4月  20 17:51 p_w_picpaths.sql</p> 
 <p>-rw-r--r-- 1 1000 1000  113197 4月  20 18:01 schema.sql</p> 
 <p>[root@localhost mysql]#</p> 
 <p>[root@localhost mysql]# mysql -u zabbix -p zabbix  </p> 
 <p>[root@localhost mysql]# mysql -u zabbix -p zabbix  </p> 
 <p>[root@localhost mysql]# mysql -u zabbix -p zabbix  </p> 
 <p>(3)配置zabbix配置文件</p> 
 <p>编辑zabbix server 的配置文件，修改以下参数：</p> 
 <p>[root@localhost mysql]# vim/usr/local/zabbix/etc/zabbix_server.conf</p> 
 <p>[root@localhost ~]# cat  /usr/local/zabbix/etc/zabbix_server.conf |egrep -v "^#|^$"</p> 
 <p>ListenPort=10051</p> 
 <p>LogFile=/usr/local/zabbix/logs/zabbix_server.log</p> 
 <p>PidFile=/usr/local/zabbix/logs/zabbix_server.pid</p> 
 <p>DBHost=127.0.0.1</p> 
 <p>DBName=zabbix</p> 
 <p>DBUser=zabbix</p> 
 <p>DBPassword=123456</p> 
 <p>DBSocket=/var/lib/mysql/mysql.sock</p> 
 <p>DBPort=3306</p> 
 <p>Timeout=4</p> 
 <p>FpingLocation=/usr/local/sbin/fping</p> 
 <p>LogSlowQueries=3000</p> 
 <p>[root@localhost ~]#</p> 
 <p>(4)配置zabbix服务</p> 
 <p>从安装目录复制zabbix_server脚本并编辑</p> 
 <p>[root@localhost ~]# cd zabbix/zabbix-3.0.2</p> 
 <p>[root@localhost zabbix-3.0.2]# cpmisc/init.d/fedora/core5/zabbix_server /etc/init.d/</p> 
 <p>[root@localhost zabbix-3.0.2]# mkdir/usr/local/zabbix/logs</p> 
 <p>[root@localhost zabbix-3.0.2]# chown -Rzabbix.zabbix /usr/local/zabbix</p> 
 <p>[root@localhost zabbix-3.0.2]# vim/etc/init.d/zabbix_server</p> 
 <p>[root@localhost zabbix-3.0.2]# cat  /etc/init.d/zabbix_server</p> 
 <p>ZABBIX_BIN="/usr/local/zabbix/sbin/zabbix_server"</p> 
 <p>CONF_FILE="/usr/local/zabbix/etc/zabbix_server.conf"</p> 
 <p>(5)开启zabbix安全限制</p> 
 <p>调整防火墙规则(开放端口10051)：</p> 
 <p>[root@localhost zabbix]# iptables -A INPUT-p tcp -m tcp --dport 10051 -j ACCEPT</p> 
 <p>[root@localhost zabbix]# service iptablessave</p> 
 <p>iptables：将防火墙规则保存到/etc/sysconfig/iptables：     [确定]</p> 
 <p>(6)启动zabbix server</p> 
 <p>[root@localhost zabbix]# servicezabbix_server start</p> 
 <p>正在启动 Zabbix Server：                                  [确定]</p> 
 <p>[root@localhost zabbix]#</p> 
 <p>(7)关闭zabbix server</p> 
 <p>[root@localhost zabbix]# servicezabbix_server stop</p> 
 <p>停止 Zabbix Server：                                       [确定]</p> 
 <p>[root@localhost zabbix]#</p> 
 <p>(8)配置zabbix server开机自启动：</p> 
 <p>[root@localhost zabbix]# chkconfig --addzabbix_server</p> 
 <p>[root@localhost zabbix]# chkconfig --level35 zabbix_server  on</p> 
 <p>[root@localhost zabbix]#</p> 
 <p>配置zabbix Web服务端</p> 
 <p>(1)将zabbix web 文件复制到Apache web 目录中</p> 
 <p>在安装目录将frontends复制到指定的web root 目录下：</p> 
 <p>[root@localhost zabbix]# cd zabbix-3.0.2</p> 
 <p>[root@localhost zabbix-3.0.2]# cp -rafrontends/php/*  /var/www/html/</p> 
 <p>(2)Apache的配置</p> 
 <p>[root@localhost ~]# vim/etc/httpd/conf/httpd.conf</p> 
 <p>ServerName192.168.1.214:80</p> 
 <p>(3)PHP配置</p> 
 <p>[root@localhost ~]# vim /etc/php.ini</p> 
 <p>date.timezone= Asia/Shanghai</p> 
 <p>memory_limit= 128M</p> 
 <p>post_max_size= 16M</p> 
 <p>max_execution_time= 300</p> 
 <p>max_input_time= 300</p> 
 <p>session.auto_start= 0</p> 
 <p>mbstring.func_overload= 1</p> 
 <p>(PHP string function overloading must be disabled. PHP字符串函数重载必须禁用。)</p> 
 <p>(4)zabbix web 安装</p> 
 <p>[root@localhost ~]# /etc/init.d/httpdrestart</p> 
 <p>停止 httpd：                                              [确定]</p> 
 <p>正在启动 httpd：                                           [确定]</p> 
 <p>[root@localhost ~]#</p> 
 <p># wget http://iweb.dl.sourceforge.net/project/zabbix/ZABBIX%20Latest%20Stable/2.4.8/zabbix-2.4.8.tar.gz</p> 
 <p>安装zabbix-3.0.2.tar.gz web端有问题报错“PHP Parseerror:  syntax error, unexpected '[' in/var/www/html/index.php on line 29”  从新下载zabbix-2.4.8.tar.gz把web端拷贝到网站根目录下。</p> 
 <p>欢迎界面：</p> 
 <p align="center"><img src="https://images2.imgbox.com/f3/dc/tAVp3aiw_o.png" alt="5ea718ba58dc2e68eb08d16001bf173d.png"></p> 
 <p>PHP字符串函数重载必须禁用</p> 
 <p align="center"><img src="https://images2.imgbox.com/f2/52/Aax0ByiE_o.png" alt="bd8cfb5044e3b02ae8f735ceaf7cb3b6.png"></p> 
 <p>[root@localhost ~]# vim /etc/php.ini</p> 
 <p>mbstring.func_overload= 1</p> 
 <p>[root@localhost ~]# /etc/init.d/httpdrestart</p> 
 <p>停止 httpd：                                              [确定]</p> 
 <p>正在启动 httpd：                                           [确定]</p> 
 <p>[root@localhost ~]#</p> 
 <p>重新检查：</p> 
 <p align="center"><img src="https://images2.imgbox.com/54/f0/zWYmmm7F_o.png" alt="8b8c0eccf6896b3704cf6ab6398163e1.png"></p> 
 <p>填写数据库信息：</p> 
 <p align="center"><img src="https://images2.imgbox.com/5c/6f/BL34Mvpp_o.png" alt="bbaa9f3e521bf15a2bc206cee3e83206.png"></p> 
 <p>出现错误：</p> 
 <p>[问题原因] Zabbix的数据库版本不对(因为导入的是Zabbix-3.2中的sql)</p> 
 <p>确认后重新导入一下Zabbix数据库的sql 这里先不导入，再把3.0.2的web在拷贝到web 根目录下，修改刚才报错的index.php，如果不可以在重新导入。</p> 
 <p>实验了下不行还得重新导入数据的。要替换的文件太多。</p> 
 <p align="center"><img src="https://images2.imgbox.com/67/d3/u6T6CmqR_o.png" alt="b9556abfbbdaf338e813846c90d6c008.png"></p> 
 <p>[root@localhost zabbix]# cd zabbix-2.4.8</p> 
 <p>[root@localhost zabbix-2.4.8]# cddatabase/mysql/</p> 
 <p>[root@localhost mysql]# ls</p> 
 <p>data.sql p_w_picpaths.sql  schema.sql</p> 
 <p>[root@localhost mysql]# mysql  -uzabbix -p123456 zabbix &lt; schema.sql</p> 
 <p>[root@localhost mysql]# mysql  -uzabbix -p123456 zabbix &lt; p_w_picpaths.sql</p> 
 <p>[root@localhost mysql]# mysql  -uzabbix -p123456 zabbix &lt; data.sql</p> 
 <p>[root@localhost mysql]#</p> 
 <p align="center"><img src="https://images2.imgbox.com/68/58/M3K6wfQO_o.png" alt="c302195f5a62c8cd3b074c2f44ca6cdd.png"></p> 
 <p align="center"><img src="https://images2.imgbox.com/28/da/As515Ka7_o.png" alt="acaf3acdc6b6b5bef92b759c9c005c7b.png"></p> 
 <p align="center"><img src="https://images2.imgbox.com/12/d7/DYi6o5Dj_o.png" alt="5734bbedf5d4516b774f58341ce25d15.png"></p> 
 <p>手动复制zabbix.conf.php到/var/www/html/zabbix/conf即可</p> 
 <p>[root@localhost html]# cpconf/zabbix.conf.php.example conf/zabbix.conf.php</p> 
 <p>zabbix.conf.php 文件格式内容如下：</p> 
 <p align="center"><img src="https://images2.imgbox.com/bb/e3/FinhLzXP_o.png" alt="f9bf5c66ddf056de0cce85915fadb58c.png"></p> 
 <p align="center"><img src="https://images2.imgbox.com/d3/87/w3tZMs8q_o.png" alt="4b7166414913bed7bf7d8b9e380607cd.png"></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7204c598f2737f2b036bcf062a897a94/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">kettle查询mysql获取uuid_kettle生成主鍵UUID和調用轉換作業</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3e01144bd1e4d905684aca56345ad6cd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mySQL 2008安装MOF无法连接_安装SQL2008R2时提示：MOF编译器无法连接WMI服务器？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>