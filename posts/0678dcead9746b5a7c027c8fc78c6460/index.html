<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Fabric:使用GoLand&#43;Fabric-SDK-Go操作Fabric网络 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Fabric:使用GoLand&#43;Fabric-SDK-Go操作Fabric网络" />
<meta property="og:description" content="遇到bug, 未完待续!!!
写在最前 前序博客已经介绍了使用命令的方式在Fabric上创建通道以及部署执行链码的方法，但这个过程太繁琐，尤其是当Fabric网络中peer节点和组织Org过多时，需要频繁的更改环境变量。
Hyperledger Fabric官方提供了Fabric-sdk-go(也有针对其他语言的sdk)使开发人员能够与Fabric网络进行交互，并且可基于此构建区块链技术的应用程序。本篇博客主要介绍Fabric-sdk-go的简单使用。
基本环境 本机操作系统为MAC系统，和Fabric运行在虚拟机中。Fabric的具体运行环境为：
操作系统：Ubuntu 16.04
版本：Hyperledger Fabric: V2.5.4
1 GoLand连接虚拟机 要使用ssh方式连虚拟机之前，需要在两个系统上安装ssh服务。无论是在MAC上安装ssh，还是在Ubuntu系统上安装ssh，网络上资料都很多，这里不在赘述。
1.1 在MAC上使用ssh连接虚拟机 为了保证后续能顺利使用Goland连接虚拟机，这里先在MAC上使用ssh连接虚拟机。首先要保证本机系统上和虚拟机上的Ubuntu系统上的ssh服务都是开启状态。接着本机系统的终端上尝试连接虚拟机，具体指令如下：
ssh sherry@172.16.8.129 其中@前的部分为Ubuntu系统的用户名。@后面的ip地址可以在Ubuntu系统上通过ifconfig命令进行查询，具体如下：
上述命令运行成功之后，将可以在MAC的终端上操作Ubuntu系统。具体如下：
1.2 GoLand连接Fabric网络 1.2.1 启动Fabric网络 Fabric-sdk-go不能创建Fabric网络，所以Fabric网络的创建过程仍然在Ubuntu系统中来创建。为了简便，使用fabric-samples提供的测试网络test-network，其创建如下。
sudo ./network.sh up docker ps -a 其结果如下：
1.2.2 Goland连接Fabric网络 使用Goland连接Fabric网络需要完成以下几件事情：
Goland连接虚拟机。
在Goland中，打开Tools-&gt;Deployment-&gt;configuration进入Deployment界面，这里要新建一个SFTP部署。具体如下：
connecton
其中ssh configuration的配置界面如下：
在Goland中配置Fabric网络文件映射目录。
这里的Deployment path即为Ubuntu系统上Fabric网络的相对路径地址(根路径为/home/sherry)。而local path即为Deployment path中的文件在本地系统上的映射地址。
接着启动ssh连接。具体如下：
之后便可以在Goland中操作Ubuntu系统了。具体如下：
接着为了能在GoLand中修改链码及编写代码。先将Fabric网络中的文件映射到本地系统上。具体如下：
Tips:在文件同步时可能会出错，可以先在Ubuntu系统上更改Fabric网络文件的权限，再重新进行同步。
2 使用Fabri-SDK-GO操作网络 2.1 准备工作 在Ubuntu系统上搭建finance网络。具体搭建过程可以参考博客：https://blog.csdn.net/yeshang_lady/article/details/134113296修改Goland的ssh部署。将finance网络所在的Ubuntu目录映射到GoLand的Fabric_GOPATH目录上，并将finance网络的所有文件下载到Fabric_GOPATH目录上。准备链码文件。在Fabric_GOPATH上创建usersChaincode/chaincode目录来保存链码文件asset-transfer.go。asset-transfer.go文件参考博客：https://blog.csdn.net/yeshang_lady/article/details/134801201配置相关包。在Fabric_GOPATH/userChaincode/下执行如下代码(在GoLand-&gt;Terminal-&gt;local中执行)： go mod init vim go.mod #这里要修改go.mod文件，将go语言版本修改为1.21 go get github.com/hyperledger/fabric-contract-api-go/contractapi go get github.com/hyperledger/fabric-sdk-go GO111MODULE=on go mod vendor 为了保证Fabric-sdk-go的顺利执行，进入如下vendor/github." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0678dcead9746b5a7c027c8fc78c6460/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-29T17:50:24+08:00" />
<meta property="article:modified_time" content="2023-12-29T17:50:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Fabric:使用GoLand&#43;Fabric-SDK-Go操作Fabric网络</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p><font color="red">遇到bug, 未完待续!!!</font></p> 
</blockquote> 
<h3><a id="_1"></a>写在最前</h3> 
<p>前序博客已经介绍了使用命令的方式在Fabric上创建通道以及部署执行链码的方法，但这个过程太繁琐，尤其是当Fabric网络中peer节点和组织Org过多时，需要频繁的更改环境变量。<br> Hyperledger Fabric官方提供了<code>Fabric-sdk-go</code>(也有针对其他语言的sdk)使开发人员能够与Fabric网络进行交互，并且可基于此构建区块链技术的应用程序。本篇博客主要介绍<code>Fabric-sdk-go</code>的简单使用。</p> 
<h3><a id="_4"></a>基本环境</h3> 
<p>本机操作系统为MAC系统，和Fabric运行在虚拟机中。Fabric的具体运行环境为：<br> 操作系统：Ubuntu 16.04<br> 版本：Hyperledger Fabric: V2.5.4</p> 
<h3><a id="1_GoLand_8"></a>1 GoLand连接虚拟机</h3> 
<p>要使用ssh方式连虚拟机之前，需要在两个系统上安装ssh服务。无论是在MAC上安装<code>ssh</code>，还是在Ubuntu系统上安装<code>ssh</code>，网络上资料都很多，这里不在赘述。</p> 
<h4><a id="11_MACssh_10"></a>1.1 在MAC上使用ssh连接虚拟机</h4> 
<p>为了保证后续能顺利使用Goland连接虚拟机，这里先在MAC上使用ssh连接虚拟机。首先要保证本机系统上和虚拟机上的Ubuntu系统上的<code>ssh</code>服务都是<strong>开启状态</strong>。接着本机系统的终端上尝试连接虚拟机，具体指令如下：</p> 
<pre><code class="prism language-bash"><span class="token function">ssh</span> sherry@172.16.8.129
</code></pre> 
<p>其中@前的部分为Ubuntu系统的用户名。@后面的ip地址可以在Ubuntu系统上通过<code>ifconfig</code>命令进行查询，具体如下：<br> <img src="https://images2.imgbox.com/66/cb/0rM2jEhk_o.png" alt="在这里插入图片描述" width="600"><br> 上述命令运行成功之后，将可以在MAC的终端上操作Ubuntu系统。具体如下：<br> <img src="https://images2.imgbox.com/83/15/Pp60ZpPx_o.png" alt="在这里插入图片描述" width="500"></p> 
<h4><a id="12_GoLandFabric_20"></a>1.2 GoLand连接Fabric网络</h4> 
<h5><a id="121_Fabric_21"></a>1.2.1 启动Fabric网络</h5> 
<p><code>Fabric-sdk-go</code>不能创建Fabric网络，所以Fabric网络的创建过程仍然在Ubuntu系统中来创建。为了简便，使用<code>fabric-samples</code>提供的测试网络<code>test-network</code>，其创建如下。</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> ./network.sh up
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span>
</code></pre> 
<p>其结果如下：<br> <img src="https://images2.imgbox.com/4b/66/n0I7kx8E_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="122_GolandFabric_29"></a>1.2.2 Goland连接Fabric网络</h5> 
<p>使用Goland连接Fabric网络需要完成以下几件事情：</p> 
<ul><li> <p>Goland连接虚拟机。<br> 在Goland中，打开Tools-&gt;Deployment-&gt;configuration进入Deployment界面，这里要新建一个SFTP部署。具体如下：<br> <strong>connecton</strong><br> <img src="https://images2.imgbox.com/87/ff/plwDTgmr_o.png" alt="在这里插入图片描述" width="600"><br> 其中<code>ssh configuration</code>的配置界面如下：<br> <img src="https://images2.imgbox.com/1a/92/sV9unq7z_o.png" alt="在这里插入图片描述" width="600"></p> </li><li> <p>在Goland中配置Fabric网络文件映射目录。<br> <img src="https://images2.imgbox.com/7e/42/OlK3pjgw_o.png" alt="在这里插入图片描述">这里的<code>Deployment path</code>即为Ubuntu系统上Fabric网络的相对路径地址(根路径为<code>/home/sherry</code>)。而<code>local path</code>即为<code>Deployment path</code>中的文件在本地系统上的映射地址。</p> </li><li> <p>接着启动ssh连接。具体如下：<br> <img src="https://images2.imgbox.com/82/11/b3L1fofP_o.png" alt="在这里插入图片描述" width="300"><br> 之后便可以在Goland中操作Ubuntu系统了。具体如下：<br> <img src="https://images2.imgbox.com/45/15/5uIFkd2E_o.png" alt="在这里插入图片描述" width="300"></p> </li><li> <p>接着为了能在GoLand中修改链码及编写代码。先将Fabric网络中的文件映射到本地系统上。具体如下：<br> <img src="https://images2.imgbox.com/f7/b9/9S1nKSKJ_o.png" alt="在这里插入图片描述" width="600"><br> <font color="red" size="1">Tips:在文件同步时可能会出错，可以先在Ubuntu系统上更改Fabric网络文件的权限，再重新进行同步。</font></p> </li></ul> 
<h3><a id="2_FabriSDKGO_48"></a>2 使用Fabri-SDK-GO操作网络</h3> 
<h4><a id="21__49"></a>2.1 准备工作</h4> 
<ul><li>在Ubuntu系统上搭建<code>finance</code>网络。具体搭建过程可以参考博客：<a href="https://blog.csdn.net/yeshang_lady/article/details/134113296">https://blog.csdn.net/yeshang_lady/article/details/134113296</a></li><li>修改Goland的ssh部署。将<code>finance</code>网络所在的Ubuntu目录映射到GoLand的<code>Fabric_GOPATH</code>目录上，并将<code>finance</code>网络的所有文件下载到<code>Fabric_GOPATH</code>目录上。</li><li>准备链码文件。在<code>Fabric_GOPATH</code>上创建<code>usersChaincode/chaincode</code>目录来保存链码文件<code>asset-transfer.go</code>。<code>asset-transfer.go</code>文件参考博客：<a href="https://blog.csdn.net/yeshang_lady/article/details/134801201">https://blog.csdn.net/yeshang_lady/article/details/134801201</a></li><li>配置相关包。在<code>Fabric_GOPATH/userChaincode/</code>下执行如下代码(在<code>GoLand-&gt;Terminal-&gt;local</code>中执行)：</li></ul> 
<pre><code class="prism language-bash">go mod init
<span class="token function">vim</span> go.mod <span class="token comment">#这里要修改go.mod文件，将go语言版本修改为1.21</span>
go get github.com/hyperledger/fabric-contract-api-go/contractapi
go get github.com/hyperledger/fabric-sdk-go
<span class="token assign-left variable">GO111MODULE</span><span class="token operator">=</span>on go mod vendor
</code></pre> 
<ul><li>为了保证Fabric-sdk-go的顺利执行，进入如下<code>vendor/github.com/hyperledger</code>目录，<code>git</code>命令下载<code>fabric-sdk-go</code>源文件。具体如下：</li></ul> 
<pre><code class="prism language-bash"><span class="token function">git</span> clone https://github.com/hyperledger/fabric-sdk-go.git
</code></pre> 
<p><img src="https://images2.imgbox.com/82/d3/5brN4dE2_o.png" alt="在这里插入图片描述" width="600"><br> 如果不进行这一步操作，后续使用fabric-sdk-go创建客户端的时候会可能会遇到如下错误：<br> <code>..\vendor\github.com\hyperledger\fabric-sdk-go\internal\github.com\hyperledger\fabric\discovery\client\api.go:47:38: undefined: discovery.ChaincodeCall</code></p> 
<ul><li>在<code>Fabric_GOPATH\usersChaincode</code>下创建<code>sdkInit</code>目录并创建<code>start.go</code>文件。后续所有与Fabric-SDK-GO操作相关的代码都存放在该文件中。</li><li>在<code>Fabric_GOPATH\usersChaincode</code>下闯将<code>main.go</code>文件作为主函数所在的文件。</li></ul> 
<h4><a id="22_Fabri_SDK_71"></a>2.2 实例化Fabri SDK</h4> 
<p>在实例化Fabric SDK之前，需要在<code>Fabric_GOPATH/usersChaincode</code>下生成<code>config.yaml</code>文件。<code>finance</code>网络对应的<code>config.yaml</code>文件如下(Fabric-sdk-go中给了一些样例文件可以参考)：</p> 
<pre><code class="prism language-yaml"><span class="token comment"># Copyright SecureKey Technologies Inc. All Rights Reserved.</span>
<span class="token comment"># SPDX-License-Identifier: Apache-2.0</span>
<span class="token key atrule">version</span><span class="token punctuation">:</span> 1.0.0
<span class="token key atrule">client</span><span class="token punctuation">:</span>
  <span class="token key atrule">organization</span><span class="token punctuation">:</span> org1 <span class="token comment">#此应用程序的所有者</span>
  <span class="token key atrule">logging</span><span class="token punctuation">:</span>
    <span class="token key atrule">level</span><span class="token punctuation">:</span> info
  <span class="token key atrule">cryptoconfig</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations
  <span class="token key atrule">credentialStore</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> <span class="token string">"/tmp/state-store"</span>
    <span class="token key atrule">cryptoStore</span><span class="token punctuation">:</span>
      <span class="token key atrule">path</span><span class="token punctuation">:</span> /tmp/msp
  <span class="token key atrule">BCCSP</span><span class="token punctuation">:</span>
    <span class="token key atrule">security</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">default</span><span class="token punctuation">:</span>
        <span class="token key atrule">provider</span><span class="token punctuation">:</span> <span class="token string">"SW"</span>
      <span class="token key atrule">hashAlgorithm</span><span class="token punctuation">:</span> <span class="token string">"SHA2"</span>
      <span class="token key atrule">softVerify</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">level</span><span class="token punctuation">:</span> <span class="token number">256</span>

  <span class="token key atrule">tlsCerts</span><span class="token punctuation">:</span>
    <span class="token key atrule">systemCertPool</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">client</span><span class="token punctuation">:</span>
      <span class="token key atrule">key</span><span class="token punctuation">:</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations/peerOrganizations/org1.finance.com/users/Admin@org1.finance.com/tls/client.key
      <span class="token key atrule">cert</span><span class="token punctuation">:</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations/peerOrganizations/org1.finance.com/users/Admin@org1.finance.com/tls/client.crt

<span class="token key atrule">channels</span><span class="token punctuation">:</span>
  <span class="token key atrule">channel1</span><span class="token punctuation">:</span>
    <span class="token key atrule">peers</span><span class="token punctuation">:</span>
      <span class="token key atrule">peer0.org1.finance.com</span><span class="token punctuation">:</span>
        <span class="token key atrule">endorsingPeer</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">chaincodeQuery</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">ledgerQuery</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">eventSource</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">peer1.org1.finance.com</span><span class="token punctuation">:</span>
        <span class="token key atrule">endorsingPeer</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">chaincodeQuery</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">ledgerQuery</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">eventSource</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">peer0.org2.finance.com</span><span class="token punctuation">:</span>
        <span class="token key atrule">endorsingPeer</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">chaincodeQuery</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">ledgerQuery</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">eventSource</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">policies</span><span class="token punctuation">:</span>
      <span class="token key atrule">queryChannelConfig</span><span class="token punctuation">:</span>
        <span class="token key atrule">minResponses</span><span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token key atrule">maxTargets</span><span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token key atrule">retryOpts</span><span class="token punctuation">:</span>
          <span class="token key atrule">attempts</span><span class="token punctuation">:</span> <span class="token number">5</span>
          <span class="token key atrule">initialBackoff</span><span class="token punctuation">:</span> 500ms
          <span class="token key atrule">maxBackoff</span><span class="token punctuation">:</span> 5s
          <span class="token key atrule">backoffFactor</span><span class="token punctuation">:</span> <span class="token number">2.0</span>
      <span class="token key atrule">selection</span><span class="token punctuation">:</span>
        <span class="token key atrule">SortingStrategy</span><span class="token punctuation">:</span> BlockHeightPriority
        <span class="token key atrule">Balancer</span><span class="token punctuation">:</span> RoundRobin
        <span class="token key atrule">BlockHeightLagThreshold</span><span class="token punctuation">:</span> <span class="token number">5</span>
      <span class="token key atrule">eventService</span><span class="token punctuation">:</span>
        <span class="token key atrule">resolverStrategy</span><span class="token punctuation">:</span> MinBlockHeight
        <span class="token key atrule">balancer</span><span class="token punctuation">:</span> RoundRobin
        <span class="token key atrule">blockHeightLagThreshold</span><span class="token punctuation">:</span> <span class="token number">4</span>
        <span class="token key atrule">reconnectBlockHeightLagThreshold</span><span class="token punctuation">:</span> <span class="token number">8</span>
        <span class="token key atrule">peerMonitorPeriod</span><span class="token punctuation">:</span> 6s
<span class="token key atrule">organizations</span><span class="token punctuation">:</span>
  <span class="token key atrule">org1</span><span class="token punctuation">:</span>
    <span class="token key atrule">mspid</span><span class="token punctuation">:</span> Org1MSP
    <span class="token key atrule">cryptoPath</span><span class="token punctuation">:</span>  peerOrganizations/org1.finance.com/users/<span class="token punctuation">{<!-- --></span>username<span class="token punctuation">}</span>@org1.finance.com/msp
    <span class="token key atrule">peers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> peer0.org1.finance.com
      <span class="token punctuation">-</span> peer1.org1.finance.com
    <span class="token key atrule">certificateAuthorities</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ca.org1.finance.com
  <span class="token key atrule">org2</span><span class="token punctuation">:</span>
    <span class="token key atrule">mspid</span><span class="token punctuation">:</span> Org2MSP
    <span class="token key atrule">cryptoPath</span><span class="token punctuation">:</span>  peerOrganizations/org2.finance.com/users/<span class="token punctuation">{<!-- --></span>username<span class="token punctuation">}</span>@org2.finance.com/msp
    <span class="token key atrule">peers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> peer0.org2.finance.com
    <span class="token key atrule">certificateAuthorities</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ca.org2.finance.com
  <span class="token key atrule">ordererorg</span><span class="token punctuation">:</span>
      <span class="token key atrule">mspID</span><span class="token punctuation">:</span> OrdererMSP
      <span class="token key atrule">cryptoPath</span><span class="token punctuation">:</span>  ordererOrganizations/finance.com/users/<span class="token punctuation">{<!-- --></span>username<span class="token punctuation">}</span>@finance.com/msp

<span class="token key atrule">orderers</span><span class="token punctuation">:</span>
  <span class="token key atrule">orderer.finance.com</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> orderer.finance.com<span class="token punctuation">:</span><span class="token number">7050</span>
    <span class="token key atrule">grpcOptions</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssl-target-name-override</span><span class="token punctuation">:</span> orderer.finance.com
      <span class="token key atrule">keep-alive-time</span><span class="token punctuation">:</span> 0s
      <span class="token key atrule">keep-alive-timeout</span><span class="token punctuation">:</span> 20s
      <span class="token key atrule">keep-alive-permit</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
      <span class="token key atrule">fail-fast</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
      <span class="token key atrule">allow-insecure</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">tlsCACerts</span><span class="token punctuation">:</span>
      <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations/ordererOrganizations/finance.com/tlsca/tlsca.finance.com<span class="token punctuation">-</span>cert.pem
<span class="token key atrule">peers</span><span class="token punctuation">:</span>
  <span class="token key atrule">-defaults</span><span class="token punctuation">:</span>
    <span class="token key atrule">grpcOptions</span><span class="token punctuation">:</span>
      <span class="token key atrule">keep-alive-time</span><span class="token punctuation">:</span> 0s
      <span class="token key atrule">keep-alive-timeout</span><span class="token punctuation">:</span> 20s
      <span class="token key atrule">keep-alive-permit</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
      <span class="token key atrule">fail-fast</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
      <span class="token key atrule">allow-insecure</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>

  <span class="token key atrule">peer0.org1.finance.com</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> peer0.org1.finance.com<span class="token punctuation">:</span><span class="token number">7051</span>
    <span class="token key atrule">grpcOptions</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssl-target-name-override</span><span class="token punctuation">:</span> peer0.org1.finance.com
    <span class="token key atrule">tlsCACerts</span><span class="token punctuation">:</span>
      <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations/peerOrganizations/org1.finance.com/tlsca/tlsca.org1.finance.com<span class="token punctuation">-</span>cert.pem
  <span class="token key atrule">peer1.org1.finance.com</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> peer1.org1.finance.com<span class="token punctuation">:</span><span class="token number">8051</span>
    <span class="token key atrule">grpcOptions</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssl-target-name-override</span><span class="token punctuation">:</span> peer1.org1.finance.com
    <span class="token key atrule">tlsCACerts</span><span class="token punctuation">:</span>
      <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations/peerOrganizations/org1.finance.com/tlsca/tlsca.org1.finance.com<span class="token punctuation">-</span>cert.pem
  <span class="token key atrule">peer0.org2.finance.com</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> peer0.org2.finance.com<span class="token punctuation">:</span><span class="token number">9051</span>
    <span class="token key atrule">grpcOptions</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssl-target-name-override</span><span class="token punctuation">:</span> peer0.org2.finance.com
    <span class="token key atrule">tlsCACerts</span><span class="token punctuation">:</span>
      <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations/peerOrganizations/org2.finance.com/tlsca/tlsca.org2.finance.com<span class="token punctuation">-</span>cert.pem

<span class="token key atrule">certificateAuthorities</span><span class="token punctuation">:</span>
  <span class="token key atrule">ca.org1.finance.com</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//ca.org1.finance.com<span class="token punctuation">:</span><span class="token number">7054</span>
    <span class="token key atrule">grpcOptions</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssl-target-name-override</span><span class="token punctuation">:</span> ca.org1.finance.com
    <span class="token key atrule">tlsCACerts</span><span class="token punctuation">:</span>
      <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations/peerOrganizations/org1.finance.com/tlsca/tlsca.org1.finance.com<span class="token punctuation">-</span>cert.pem
      <span class="token key atrule">client</span><span class="token punctuation">:</span>
        <span class="token key atrule">key</span><span class="token punctuation">:</span>
          <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations/peerOrganizations/org1.finance.com/users/Admin@org1.finance.com/tls/client.key
        <span class="token key atrule">cert</span><span class="token punctuation">:</span>
          <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations/peerOrganizations/org1.finance.com/users/Admin@org1.finance.com/tls/client.crt
    <span class="token key atrule">registrar</span><span class="token punctuation">:</span>
      <span class="token key atrule">enrollId</span><span class="token punctuation">:</span> admin
      <span class="token key atrule">enrollSecret</span><span class="token punctuation">:</span> adminpw
    <span class="token key atrule">caName</span><span class="token punctuation">:</span> ca.org1.finance.com
  <span class="token key atrule">ca.org2.finance.com</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//ca.org2.finance.com<span class="token punctuation">:</span><span class="token number">9054</span>
    <span class="token key atrule">grpcOptions</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssl-target-name-override</span><span class="token punctuation">:</span> ca.org2.finance.com
    <span class="token key atrule">tlsCACerts</span><span class="token punctuation">:</span>
      <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations/peerOrganizations/org2.finance.com/tlsca/tlsca.org2.finance.com<span class="token punctuation">-</span>cert.pem
      <span class="token key atrule">client</span><span class="token punctuation">:</span>
        <span class="token key atrule">key</span><span class="token punctuation">:</span>
          <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations/peerOrganizations/org2.finance.com/users/Admin@org2.finance.com/tls/client.key
        <span class="token key atrule">cert</span><span class="token punctuation">:</span>
          <span class="token key atrule">path</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>GOPATH<span class="token punctuation">}</span>/src/Fabric_GOPATH/organizations/peerOrganizations/org2.finance.com/users/Admin@org2.finance.com/tls/client.crt
    <span class="token key atrule">registrar</span><span class="token punctuation">:</span>
      <span class="token key atrule">enrollId</span><span class="token punctuation">:</span> admin
      <span class="token key atrule">enrollSecret</span><span class="token punctuation">:</span> adminpw
    <span class="token key atrule">caName</span><span class="token punctuation">:</span> ca.org2.finance.com
</code></pre> 
<p>在<code>start.go</code>文件中添加如下代码：</p> 
<pre><code class="prism language-go"><span class="token comment">/*代码的import部分会自己生成，这里为了节省空间就不在展示了*/</span>
<span class="token keyword">package</span> sdkInit
<span class="token keyword">func</span> <span class="token function">SetupSDK</span><span class="token punctuation">(</span>configFile <span class="token builtin">string</span><span class="token punctuation">,</span> initialized <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>fabsdk<span class="token punctuation">.</span>FabricSDK<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> initialized <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"Fabric SDK已经实例化"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	sdk<span class="token punctuation">,</span> err <span class="token operator">:=</span> fabsdk<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token function">FromFile</span><span class="token punctuation">(</span>configFile<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"实例化Fabric SDK失败: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Fabric SDK初始化成功"</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> sdk<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在<code>main.go</code>中添加如下代码，具体如下:</p> 
<pre><code class="prism language-go"><span class="token keyword">const</span> <span class="token punctuation">(</span>
	configFile  <span class="token operator">=</span> <span class="token string">"config.yaml"</span>
	initialized <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	sdk<span class="token punctuation">,</span> err <span class="token operator">:=</span> sdkInit<span class="token punctuation">.</span><span class="token function">SetupSDK</span><span class="token punctuation">(</span>configFile<span class="token punctuation">,</span> initialized<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">defer</span> sdk<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>运行<code>main.go</code>文件即可完成Fabric SDK的实例化。</p> 
<h4><a id="23__268"></a>2.3 创建和加入通道</h4> 
<p><font color="red"><strong>Fabric2.5.4中可以直接创建应用通道，但这种通道创建方法只能生成.block文件，而无法生成.tx形式的通道配置交易文件。目前的Fabric-SDK-GO@1.0.0版本中无法通过.block文件来创建通道，因此这里需要沿用传统的通道创建方法：先创建系统通道再创建应用通道。</strong></font></p> 
<h3><a id="_270"></a>参考资料</h3> 
<ol><li><a href="https://blog.csdn.net/lakersssss24/article/details/125645713">https://blog.csdn.net/lakersssss24/article/details/125645713</a></li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a45ac9de0b7433cb279e2c5814180f8e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【解决方式】远程目录共享</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/542c75de7dcfcab1e1fef057a0bbdc6f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Kotlin基础语法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>