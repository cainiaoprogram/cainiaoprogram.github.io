<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>爬虫项目五：最详细的京东商品、评价爬虫、词云展示 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="爬虫项目五：最详细的京东商品、评价爬虫、词云展示" />
<meta property="og:description" content="文章目录 前言一、京东商品信息爬虫1.分析URL2.实例化chrome3.加载完整数据4.实现翻页5.解析数据 二、京东商品评价爬虫1.找到接口2.分析url3.解析数据4.词云 前言 本文内容包含京东商品列表爬虫的详细教程以及商品评价数据的详细教程
提示：以下是本篇文章正文内容，下面案例可供参考
一、京东商品信息爬虫 我们要知道京东商品页的数据有一半是通过动态加载出现的，一页60条数据 一半是动态加载，也就是说我们如果单纯的用requests访问url的话只能拿到一半的数据，那另一半的数据拿到有两种方法：1.selenium 2.找到接口。这里以selenium为例。
1.分析URL 如果我们是通过selenium爬取的话，其实只需要循环点击下一页就可以了。下面我们来看一下url的构成
我们来看url，keyword就是商品关键词，我们把它换成中文也是可以的，page是页数，那剩下的一堆东西是没有用的我们可以把他们全部删除
https://search.jd.com/Search? keyword=%E7%BA%A2%E7%B1%B3K40 ==》查询的关键词 《===》红米K40 &amp;suggest=1.his.0.0 &amp;wq=%E7%BA%A2%E7%B1%B3K40 ==&gt;也是关键词 &amp;page=1 ==》页数 &amp;s=1 &amp;click=0 我们来看一下简化后的url
https://search.jd.com/Search?keyword=红米K40&amp;page=1 url对比，page规律：page等于当前页数×2-1
1：https://search.jd.com/Search?keyword=红米K40&amp;page=1 2：https://search.jd.com/Search?keyword=红米K40&amp;page=3 3：https://search.jd.com/Search?keyword=红米K40&amp;page=5 4：https://search.jd.com/Search?keyword=红米K40&amp;page=7 2.实例化chrome 我们明白了url的构成，首先我们用selenium实例化一个chrome，进而去获取数据了
写一下基本的配置
用input的方法交互式的输入你想采集的关键词，设置禁止图片的加载加快浏览器的速度，不想看到浏览器直接设置为无头浏览器，还有防规避检测（可能已失效）
代码如下（示例）：
key = input(&#34;请输入要采集商品的关键字：&#34;) # 商品的关键字 option = ChromeOptions() prefs = {&#39;profile.managed_default_content_settings.images&#39;: 2} option.add_experimental_option(&#39;prefs&#39;, prefs) # 禁止图片加载，加快速度 option.add_argument(&#39;--headless&#39;) option.add_argument(&#39;--disable-gpu&#39;) # 设置无头浏览器 bro=webdriver.Chrome(options=option) bro.execute_cdp_cmd(&#34;Page.addScriptToEvaluateOnNewDocument&#34;, { &#34;source&#34;: &#34;&#34;&#34; Object.defineProperty(navigator, &#39;webdriver&#39;, { get: () =&gt; undefined }) &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/804be268a821a4c8b6571d6fb283635c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-20T10:29:22+08:00" />
<meta property="article:modified_time" content="2021-03-20T10:29:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">爬虫项目五：最详细的京东商品、评价爬虫、词云展示</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_8" rel="nofollow">前言</a></li><li><a href="#_15" rel="nofollow">一、京东商品信息爬虫</a></li><li><ul><li><a href="#1URL_21" rel="nofollow">1.分析URL</a></li><li><a href="#2chrome_48" rel="nofollow">2.实例化chrome</a></li><li><a href="#3_73" rel="nofollow">3.加载完整数据</a></li><li><a href="#4_84" rel="nofollow">4.实现翻页</a></li><li><a href="#5_142" rel="nofollow">5.解析数据</a></li></ul> 
  </li><li><a href="#_163" rel="nofollow">二、京东商品评价爬虫</a></li><li><ul><li><a href="#1_170" rel="nofollow">1.找到接口</a></li><li><a href="#2url_176" rel="nofollow">2.分析url</a></li><li><a href="#3_217" rel="nofollow">3.解析数据</a></li><li><a href="#4_244" rel="nofollow">4.词云</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr color="#000000" size='1"'> 
<h2><a id="_8"></a>前言</h2> 
<p><font color="#999AAA">本文内容包含京东商品列表爬虫的详细教程以及商品评价数据的详细教程</font></p> 
<hr color="#000000" size='1"'> 
<p><font color="#999AAA">提示：以下是本篇文章正文内容，下面案例可供参考</font></p> 
<h2><a id="_15"></a>一、京东商品信息爬虫</h2> 
<p>我们要知道京东商品页的数据有一半是通过动态加载出现的，一页60条数据 一半是动态加载，也就是说我们如果单纯的用requests访问url的话只能拿到一半的数据，那另一半的数据拿到有两种方法：1.selenium 2.找到接口。这里以selenium为例。</p> 
<p><img src="https://images2.imgbox.com/5c/f3/i6Tdkxpw_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="1URL_21"></a>1.分析URL</h3> 
<p>如果我们是通过selenium爬取的话，其实只需要循环点击下一页就可以了。下面我们来看一下url的构成</p> 
<p>我们来看url，keyword就是商品关键词，我们把它换成中文也是可以的，page是页数，那剩下的一堆东西是没有用的我们可以把他们全部删除</p> 
<pre><code class="prism language-python">https<span class="token punctuation">:</span><span class="token operator">//</span>search<span class="token punctuation">.</span>jd<span class="token punctuation">.</span>com<span class="token operator">/</span>Search?
keyword<span class="token operator">=</span><span class="token operator">%</span>E7<span class="token operator">%</span>BA<span class="token operator">%</span>A2<span class="token operator">%</span>E7<span class="token operator">%</span>B1<span class="token operator">%</span>B3K40  <span class="token operator">==</span>》查询的关键词  《<span class="token operator">==</span><span class="token operator">=</span>》红米K40
<span class="token operator">&amp;</span>suggest<span class="token operator">=</span><span class="token number">1.</span>his<span class="token punctuation">.</span><span class="token number">0.0</span>
<span class="token operator">&amp;</span>wq<span class="token operator">=</span><span class="token operator">%</span>E7<span class="token operator">%</span>BA<span class="token operator">%</span>A2<span class="token operator">%</span>E7<span class="token operator">%</span>B1<span class="token operator">%</span>B3K40  <span class="token operator">==</span><span class="token operator">&gt;</span>也是关键词
<span class="token operator">&amp;</span>page<span class="token operator">=</span><span class="token number">1</span>  <span class="token operator">==</span>》页数
<span class="token operator">&amp;</span>s<span class="token operator">=</span><span class="token number">1</span>
<span class="token operator">&amp;</span>click<span class="token operator">=</span><span class="token number">0</span>
</code></pre> 
<p>我们来看一下简化后的url</p> 
<pre><code class="prism language-python">https<span class="token punctuation">:</span><span class="token operator">//</span>search<span class="token punctuation">.</span>jd<span class="token punctuation">.</span>com<span class="token operator">/</span>Search?keyword<span class="token operator">=</span>红米K40<span class="token operator">&amp;</span>page<span class="token operator">=</span><span class="token number">1</span>
</code></pre> 
<p>url对比，page规律：page等于当前页数×2-1</p> 
<pre><code class="prism language-python"><span class="token number">1</span>：https<span class="token punctuation">:</span><span class="token operator">//</span>search<span class="token punctuation">.</span>jd<span class="token punctuation">.</span>com<span class="token operator">/</span>Search?keyword<span class="token operator">=</span>红米K40<span class="token operator">&amp;</span>page<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">2</span>：https<span class="token punctuation">:</span><span class="token operator">//</span>search<span class="token punctuation">.</span>jd<span class="token punctuation">.</span>com<span class="token operator">/</span>Search?keyword<span class="token operator">=</span>红米K40<span class="token operator">&amp;</span>page<span class="token operator">=</span><span class="token number">3</span>
<span class="token number">3</span>：https<span class="token punctuation">:</span><span class="token operator">//</span>search<span class="token punctuation">.</span>jd<span class="token punctuation">.</span>com<span class="token operator">/</span>Search?keyword<span class="token operator">=</span>红米K40<span class="token operator">&amp;</span>page<span class="token operator">=</span><span class="token number">5</span>
<span class="token number">4</span>：https<span class="token punctuation">:</span><span class="token operator">//</span>search<span class="token punctuation">.</span>jd<span class="token punctuation">.</span>com<span class="token operator">/</span>Search?keyword<span class="token operator">=</span>红米K40<span class="token operator">&amp;</span>page<span class="token operator">=</span><span class="token number">7</span>
</code></pre> 
<h3><a id="2chrome_48"></a>2.实例化chrome</h3> 
<p>我们明白了url的构成，首先我们用selenium实例化一个chrome，进而去获取数据了</p> 
<p>写一下基本的配置</p> 
<p>用input的方法交互式的输入你想采集的关键词，设置禁止图片的加载加快浏览器的速度，不想看到浏览器直接设置为无头浏览器，还有防规避检测（可能已失效）</p> 
<p><font color="#999AAA">代码如下（示例）：</font></p> 
<pre><code class="prism language-python">   key <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请输入要采集商品的关键字："</span><span class="token punctuation">)</span>  <span class="token comment"># 商品的关键字</span>
   option <span class="token operator">=</span> ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>
   prefs <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'profile.managed_default_content_settings.images'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
   option<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span><span class="token string">'prefs'</span><span class="token punctuation">,</span> prefs<span class="token punctuation">)</span> <span class="token comment"># 禁止图片加载，加快速度</span>
   option<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--headless'</span><span class="token punctuation">)</span>
   option<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--disable-gpu'</span><span class="token punctuation">)</span> <span class="token comment"># 设置无头浏览器</span>
   bro<span class="token operator">=</span>webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>options<span class="token operator">=</span>option<span class="token punctuation">)</span>
   bro<span class="token punctuation">.</span>execute_cdp_cmd<span class="token punctuation">(</span><span class="token string">"Page.addScriptToEvaluateOnNewDocument"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
       <span class="token string">"source"</span><span class="token punctuation">:</span> <span class="token triple-quoted-string string">"""
       Object.defineProperty(navigator, 'webdriver', {
         get: () =&gt; undefined
       })
     """</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">=</span>》可能已失效
</code></pre> 
<h3><a id="3_73"></a>3.加载完整数据</h3> 
<p>最开始我们已经提到了京东有一般的数据是通过动态加载的那我们要获得这一半的数据就要让他加载出来，用的方法是让浏览器向下滚动一个屏幕</p> 
<p><font color="#999AAA">代码如下（示例）：</font></p> 
<pre><code class="prism language-python">   bro<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 最大化浏览器</span>
   url<span class="token operator">=</span><span class="token string">"https://search.jd.com/Search?keyword=%s"</span><span class="token operator">%</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
   bro<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>  <span class="token comment">#访问url</span>
   bro<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'window.scrollTo(0, document.body.scrollHeight)'</span><span class="token punctuation">)</span> <span class="token comment"># 向下滑动一屏</span>
</code></pre> 
<h3><a id="4_84"></a>4.实现翻页</h3> 
<p>方式一：对page循环访问(<strong>推荐</strong>)</p> 
<p>page就是页数为了获取一共有多少页可以通过定位下图的位置获取<br> <img src="https://images2.imgbox.com/52/46/PVwuC8hm_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">page<span class="token operator">=</span>bro<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//span[@class="p-skip"]/em/b'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
</code></pre> 
<p>我们知道了page变化的规律、知道了总页数那么就好写代码了</p> 
<p><font color="#999AAA">代码如下（示例）：</font></p> 
<pre><code class="prism language-python"> page<span class="token operator">=</span>bro<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//span[@class="p-skip"]/em/b'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
 <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
     sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">30</span> <span class="token operator">+</span> <span class="token string">"已获取第%s页数据"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">)</span>
     url <span class="token operator">=</span> <span class="token string">"https://search.jd.com/Search?keyword=%s&amp;page=%d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span>i<span class="token operator">*</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
     bro<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
     parser_data<span class="token punctuation">(</span>bro<span class="token punctuation">.</span>page_source<span class="token punctuation">)</span> <span class="token comment">#解析数据函数</span>
 bro<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>方式二：循环点击下一页（<strong>不推荐</strong>）</p> 
<p>因为我们用的是selenium 所以我们可以用循环点击下一页的方式实现翻页效果，写一个while循环</p> 
<p>while循环一直循环，当什么时候结束循环呢，当下一页元素的class属性是"pn-next disabled"时就结束循环，当其class属性是"pn-next disabled"就是到了最后一页了，就可以结束循环，反之就会一直点击下一页按钮实现翻页，因为在最后一个的class属性值和在其他页数的属性值是不一样的，所以可以利用这个因素制作循环</p> 
<p>最后一页的a标签class属性<br> <img src="https://images2.imgbox.com/29/c9/RRXgxHf3_o.png" alt="最后一页的a标签class属性"><br> 其他页a标签的class属性<br> <img src="https://images2.imgbox.com/25/71/pjvHsxhf_o.png" alt="其他页a标签的class属性"><br> 为了爬虫效果我们在爬虫过程中打印一下当前是第几页，所以用到了下图的按钮，利用这个元素 打印出当前是第几页，我们用xpath定位可知他的xpath：//span/input[@class=“input-txt”] 其中他的value属性就是当前页数，所以再用.get_attribute(“value”)获取当前页数<br> <img src="https://images2.imgbox.com/fc/1f/eSCWo2Mv_o.png" alt="在这里插入图片描述"><br> <font color="#999AAA">代码如下（示例）：</font></p> 
<pre><code class="prism language-python"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    sleep<span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">)</span>
    parser_data<span class="token punctuation">(</span>bro<span class="token punctuation">.</span>page_source<span class="token punctuation">)</span> <span class="token comment"># 解析数据函数</span>
    <span class="token comment"># 当到最后一页时停止循环</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> bro<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//span[@class="p-num"]/a[last()]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">"pn-next disabled"</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            page <span class="token operator">=</span> bro<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//span/input[@class="input-txt"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">"value"</span><span class="token punctuation">)</span>  <span class="token comment"># 获取当前为第几页</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">30</span> <span class="token operator">+</span> <span class="token string">"已获取第%s页数据"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">)</span>
            bro<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//span[@class="p-num"]/a[last()]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 点击下一页按钮</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            bro<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//span[@class="p-num"]/a[last()]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 点击下一页按钮</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"共获取%s页数据"</span><span class="token operator">%</span><span class="token punctuation">(</span>bro<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//span/input[@class="input-txt"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">"value"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>推荐使用方式一实现翻页，方式二会出现重复采集的现象，方式一相比更加稳定，也可能是我代码问题，方式二当时抛砖引玉 大家可以尝试修改使用</p> 
<h3><a id="5_142"></a>5.解析数据</h3> 
<p>我们懂得了url实现了翻页，最后就该是解析数据了，这就很简单了，利用chrome知道数据列表定位复制Xpath，制作一个循环 在利用Xpath提取数据 再把数据写成字典。我是在每一条数据现在写了一个csv保存实现边解析数据边保存的效果，可以根据自己需求来。</p> 
<p><font color="#999AAA">代码如下（示例）：</font></p> 
<pre><code class="prism language-python">   html<span class="token operator">=</span>etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
   li_list<span class="token operator">=</span>html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//ul[@class="gl-warp clearfix"]/li'</span><span class="token punctuation">)</span> <span class="token comment">#数据列表</span>
   <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>
       dic<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
       dic<span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">]</span><span class="token operator">=</span>li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div/div[@class="p-name p-name-type-2"]/a/em//text()'</span><span class="token punctuation">)</span>
       dic<span class="token punctuation">[</span><span class="token string">"commit"</span><span class="token punctuation">]</span><span class="token operator">=</span>li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div/div[@class="p-commit"]/strong/a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
       dic<span class="token punctuation">[</span><span class="token string">"shop"</span><span class="token punctuation">]</span><span class="token operator">=</span>li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div/div[@class="p-shop"]/span/a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
       dic<span class="token punctuation">[</span><span class="token string">"price"</span><span class="token punctuation">]</span><span class="token operator">=</span>li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div/div[@class="p-price"]/strong/i/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
       dic<span class="token punctuation">[</span><span class="token string">"details"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"https:"</span><span class="token operator">+</span>li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div/div[@class="p-name p-name-type-2"]/a/@href'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
       <span class="token comment">#保存数据</span>
       <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">".//jd.csv"</span><span class="token punctuation">,</span> <span class="token string">"a+"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
           writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>DictWriter<span class="token punctuation">(</span>f<span class="token punctuation">,</span> dic<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
           writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>
</code></pre> 
<p>到这里，京东商品信息爬虫就完成了</p> 
<h2><a id="_163"></a>二、京东商品评价爬虫</h2> 
<p>如果我们还是利用requests 访问详情页url 也是抓不到数据的</p> 
<p>京东商品评价的数据也是得通过点击”评价“这个按钮才可以加载出来</p> 
<p><img src="https://images2.imgbox.com/fe/81/uVd1D0ws_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="1_170"></a>1.找到接口</h3> 
<p>下面我们利用chrome的抓包工具来找到评价数据的接口</p> 
<p>我们点击商品评价后出现了很多的数据包，可以利用search功能查找一下，复制评价中一个人的昵称查找<br> <img src="https://images2.imgbox.com/62/27/twagvH99_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2url_176"></a>2.分析url</h3> 
<p>我们找到了数据包，现在我们来观察分析一下他的url</p> 
<pre><code class="prism language-python">https<span class="token punctuation">:</span><span class="token operator">//</span>club<span class="token punctuation">.</span>jd<span class="token punctuation">.</span>com<span class="token operator">/</span>comment<span class="token operator">/</span>productPageComments<span class="token punctuation">.</span>action?
callback<span class="token operator">=</span>fetchJSON_comment98
<span class="token operator">&amp;</span>productId<span class="token operator">=</span><span class="token number">100018642180</span>  <span class="token operator">==</span><span class="token operator">&gt;</span>商品ID
<span class="token operator">&amp;</span>score<span class="token operator">=</span><span class="token number">0</span>  <span class="token operator">==</span>》表示评价类型（<span class="token number">0</span>：全部评价  还有<span class="token number">1</span>、<span class="token number">2</span>、<span class="token number">3</span> 好评、中评、差评）
<span class="token operator">&amp;</span>sortType<span class="token operator">=</span><span class="token number">5</span>
<span class="token operator">&amp;</span>page<span class="token operator">=</span><span class="token number">0</span>  <span class="token operator">==</span>》页数
<span class="token operator">&amp;</span>pageSize<span class="token operator">=</span><span class="token number">10</span>  <span class="token operator">==</span>》每一页加载的数据个数
<span class="token operator">&amp;</span>isShadowSku<span class="token operator">=</span><span class="token number">0</span>
<span class="token operator">&amp;</span>fold<span class="token operator">=</span><span class="token number">1</span>
</code></pre> 
<p>现在我们来试着去除一些参数 简化url（<strong>callback必须去掉</strong>）</p> 
<pre><code class="prism language-python">https<span class="token punctuation">:</span><span class="token operator">//</span>club<span class="token punctuation">.</span>jd<span class="token punctuation">.</span>com<span class="token operator">/</span>comment<span class="token operator">/</span>productPageComments<span class="token punctuation">.</span>action?
<span class="token operator">&amp;</span>productId<span class="token operator">=</span><span class="token number">100018642180</span>
<span class="token operator">&amp;</span>score<span class="token operator">=</span><span class="token number">0</span>
<span class="token operator">&amp;</span>sortType<span class="token operator">=</span><span class="token number">5</span>
<span class="token operator">&amp;</span>page<span class="token operator">=</span><span class="token number">0</span>
<span class="token operator">&amp;</span>pageSize<span class="token operator">=</span><span class="token number">10</span>
</code></pre> 
<p>现在的url我们可以用添加params的方式访问url 通过改变params中的page来实现翻页效果 即：</p> 
<pre><code class="prism language-python">params<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">"productId"</span><span class="token punctuation">:</span> <span class="token number">100018642180</span><span class="token punctuation">,</span>
    <span class="token string">"score"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">"sortType"</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token string">"page"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">"pageSize"</span><span class="token punctuation">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
head<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
<span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36"</span>
<span class="token punctuation">}</span>
url<span class="token operator">=</span><span class="token string">"https://club.jd.com/comment/productPageComments.action?"</span>
requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>head<span class="token punctuation">,</span>params<span class="token operator">=</span>params<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="3_217"></a>3.解析数据</h3> 
<p>我们通过简化后的url进行访问，复制数据到json.cn 解析数据，对其折叠后我们可以看到 每一条数据都是再comments中的</p> 
<p><img src="https://images2.imgbox.com/65/7d/xWOlQoP1_o.png" alt="在这里插入图片描述"><br> 我们打开其中一条数据观察，可以找到评论内容、评论时间等数据<br> <img src="https://images2.imgbox.com/0d/bc/sXMtcjrj_o.png" alt="在这里插入图片描述"><br> 有了这些我们就可以写代码了，我们同访问返回的内容json化 拿到数据</p> 
<p><font color="#999AAA">代码如下（示例）：</font></p> 
<pre><code class="prism language-c"> text<span class="token operator">=</span>requests<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>head<span class="token punctuation">,</span>params<span class="token operator">=</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 data<span class="token operator">=</span>text<span class="token punctuation">[</span><span class="token string">"comments"</span><span class="token punctuation">]</span>
 <span class="token keyword">for</span> da in data<span class="token punctuation">:</span>
     dic<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
     dic<span class="token punctuation">[</span><span class="token string">"nickname"</span><span class="token punctuation">]</span> <span class="token operator">=</span> da<span class="token punctuation">[</span><span class="token string">"nickname"</span><span class="token punctuation">]</span>
     dic<span class="token punctuation">[</span><span class="token string">"productColor"</span><span class="token punctuation">]</span> <span class="token operator">=</span> da<span class="token punctuation">[</span><span class="token string">"productColor"</span><span class="token punctuation">]</span>
     dic<span class="token punctuation">[</span><span class="token string">"productSize"</span><span class="token punctuation">]</span> <span class="token operator">=</span> da<span class="token punctuation">[</span><span class="token string">"productSize"</span><span class="token punctuation">]</span>
     dic<span class="token punctuation">[</span><span class="token string">"replyCount"</span><span class="token punctuation">]</span><span class="token operator">=</span>da<span class="token punctuation">[</span><span class="token string">"replyCount"</span><span class="token punctuation">]</span>
     dic<span class="token punctuation">[</span><span class="token string">"usefulVoteCount"</span><span class="token punctuation">]</span><span class="token operator">=</span>da<span class="token punctuation">[</span><span class="token string">"usefulVoteCount"</span><span class="token punctuation">]</span>
     dic<span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span><span class="token operator">=</span>da<span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span>
     dic<span class="token punctuation">[</span><span class="token string">"creationTime"</span><span class="token punctuation">]</span><span class="token operator">=</span>da<span class="token punctuation">[</span><span class="token string">"creationTime"</span><span class="token punctuation">]</span>
     with <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">".//comments.csv"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> as f<span class="token punctuation">:</span>
         writer <span class="token operator">=</span> csv<span class="token punctuation">.</span><span class="token function">DictWriter</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> dic<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         writer<span class="token punctuation">.</span><span class="token function">writerow</span><span class="token punctuation">(</span>dic<span class="token punctuation">)</span>
</code></pre> 
<p>到这里，对商品评价数据的爬取就结束了</p> 
<h3><a id="4_244"></a>4.词云</h3> 
<p>既然都有了数据，那就来做个简单的词云展示吧，我采集的是 红米K40Pro的商品数据，现在看一下<br> <img src="https://images2.imgbox.com/17/76/BiWoGYK1_o.jpg" alt="在这里插入图片描述"><br> 可以看到对K40的评价中提到最多的是屏幕音效、外形外观、运行速度、拍照效果</p> 
<p><font color="#999AAA">代码如下（示例）：</font></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> wordcloud <span class="token keyword">import</span> WordCloud
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'fivethirtyeight'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>rc<span class="token punctuation">(</span><span class="token string">'figure'</span><span class="token punctuation">,</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">)</span>
names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'nickname'</span><span class="token punctuation">,</span><span class="token string">'productColor'</span><span class="token punctuation">,</span><span class="token string">'productSize'</span><span class="token punctuation">,</span><span class="token string">'replyCount'</span><span class="token punctuation">,</span><span class="token string">'usefulVoteCount'</span><span class="token punctuation">,</span><span class="token string">'content'</span><span class="token punctuation">,</span><span class="token string">'creationTime'</span><span class="token punctuation">]</span>
df<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'comments.csv'</span><span class="token punctuation">,</span>names<span class="token operator">=</span>names<span class="token punctuation">)</span>
font <span class="token operator">=</span> r<span class="token string">'C:\Windows\Fonts\simfang.ttf'</span>
wc <span class="token operator">=</span> WordCloud<span class="token punctuation">(</span>font_path<span class="token operator">=</span>font<span class="token punctuation">,</span> background_color<span class="token operator">=</span><span class="token string">'White'</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">1920</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">1080</span><span class="token punctuation">)</span><span class="token punctuation">.</span>generate<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>wc<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>好了，到这里这篇文章就结束了，如果觉得这篇文章不错 对你有帮助的话 就点个赞吧 关注我博客 持续更新爬虫项目</p> 
<p><strong>转载请标明出处</strong></p> 
<p>文章所用的爬虫源码在公众号”阿虚学Python“中，回复”京东“获取<br> <img src="https://images2.imgbox.com/39/85/SoktpStO_o.jpg" alt="在这里插入图片描述"><br> 最后谢谢大家的观看</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/687e17aa7efb91c3fcedeadb879fa393/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">react&#43;ts仿antd icon库</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f7343619bba217db291515725911e1ba/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">HDFS HA高可用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>