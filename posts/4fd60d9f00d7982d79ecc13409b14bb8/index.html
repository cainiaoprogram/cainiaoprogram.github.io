<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【MyBatis】MyBatis基础操作 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【MyBatis】MyBatis基础操作" />
<meta property="og:description" content="文章目录 前言注解方式书写 MyBatis打印 MyBatis 日志参数传递MyBatis 增加操作返回主键 MyBatis 删除操作MyBatis 修改操作MyBatis 查找操作1. 对查询结果进行别名2. @Results注解3. 开启驼峰命名（推荐） XML 配置文件方法书写 MyBatis配置数据库的相关配置指定XML的文件路径xml 实现增加操作删除操作修改操作查找操作1. 别名2. 定义 result3. 开启驼峰命名 前言 前面我们学习了什么是 MyBatis，为什么要使用 MyBatis，如何创建 MyBatis 环境，并且了解了使用单元测试对代码功能进行测试。那么今天这篇文章将为大家分享关于 MyBatis 的基础操作。
书写 MyBatis 的方法有两种：注解和XML的方法，这里我们两种方法都是给大家写到。
注解方式书写 MyBatis 打印 MyBatis 日志 前面文章中也提到了日志对于我们开发人员的重要性，在使用 MyBatis 框架的过程中，我们同样也可以看到执行 MyBatis 代码的过程中产生的日志。
那么如何打印出 MyBatis 日志呢？我们需要在配置文件中添加配置项来告知 Spring，我们需要知道 MyBatis 代码执行过程中产生的日志。
mybatis: configuration: # 配置打印 MyBatis⽇志 log-impl: org.apache.ibatis.logging.stdout.StdOutImpl 添加这个配置了之后，我们在启动项目就会发现，MyBatis 执行过程中的日志就可以看到了。
参数传递 假设我们需要查询 id 为 4 的用户的信息的时候，对应的 SQL 语句就是 select * from userinfo where id=4;，对应到我们的 MyBatis 就是这样的。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4fd60d9f00d7982d79ecc13409b14bb8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T12:20:14+08:00" />
<meta property="article:modified_time" content="2024-01-05T12:20:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【MyBatis】MyBatis基础操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/96/85/uvB61CRS_o.jpg" alt="在这里插入图片描述"><br> </p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">前言</a></li><li><a href="#_MyBatis_7" rel="nofollow">注解方式书写 MyBatis</a></li><li><ul><li><a href="#_MyBatis__8" rel="nofollow">打印 MyBatis 日志</a></li><li><a href="#_22" rel="nofollow">参数传递</a></li><li><a href="#MyBatis__69" rel="nofollow">MyBatis 增加操作</a></li><li><ul><li><a href="#_96" rel="nofollow">返回主键</a></li></ul> 
   </li><li><a href="#MyBatis__133" rel="nofollow">MyBatis 删除操作</a></li><li><a href="#MyBatis__149" rel="nofollow">MyBatis 修改操作</a></li><li><a href="#MyBatis__166" rel="nofollow">MyBatis 查找操作</a></li><li><ul><li><a href="#1__175" rel="nofollow">1. 对查询结果进行别名</a></li><li><a href="#2_Results_193" rel="nofollow">2. @Results注解</a></li><li><a href="#3__249" rel="nofollow">3. 开启驼峰命名（推荐）</a></li></ul> 
  </li></ul> 
  </li><li><a href="#XML__MyBatis_274" rel="nofollow">XML 配置文件方法书写 MyBatis</a></li><li><ul><li><a href="#_276" rel="nofollow">配置数据库的相关配置</a></li><li><a href="#XML_290" rel="nofollow">指定XML的文件路径</a></li><li><a href="#xml__303" rel="nofollow">xml 实现</a></li><li><ul><li><a href="#_360" rel="nofollow">增加操作</a></li><li><a href="#_416" rel="nofollow">删除操作</a></li><li><a href="#_436" rel="nofollow">修改操作</a></li><li><a href="#_456" rel="nofollow">查找操作</a></li><li><ul><li><a href="#1__459" rel="nofollow">1. 别名</a></li><li><a href="#2__result_481" rel="nofollow">2. 定义 result</a></li><li><a href="#3__511" rel="nofollow">3. 开启驼峰命名</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>前言</h2> 
<p>前面我们学习了什么是 MyBatis，为什么要使用 MyBatis，如何创建 MyBatis 环境，并且了解了使用单元测试对代码功能进行测试。那么今天这篇文章将为大家分享关于 MyBatis 的基础操作。</p> 
<p><font color="CC0000">书写 MyBatis 的方法有两种：注解和XML的方法，这里我们两种方法都是给大家写到。</font></p> 
<h2><a id="_MyBatis_7"></a>注解方式书写 MyBatis</h2> 
<h3><a id="_MyBatis__8"></a>打印 MyBatis 日志</h3> 
<p>前面文章中也提到了日志对于我们开发人员的重要性，在使用 MyBatis 框架的过程中，我们同样也可以看到执行 MyBatis 代码的过程中产生的日志。</p> 
<p>那么如何打印出 MyBatis 日志呢？我们需要在配置文件中添加配置项来告知 Spring，我们需要知道 MyBatis 代码执行过程中产生的日志。</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">configuration</span><span class="token punctuation">:</span> <span class="token comment"># 配置打印 MyBatis⽇志</span>
    <span class="token key atrule">log-impl</span><span class="token punctuation">:</span> org.apache.ibatis.logging.stdout.StdOutImpl
</code></pre> 
<p>添加这个配置了之后，我们在启动项目就会发现，MyBatis 执行过程中的日志就可以看到了。</p> 
<p><img src="https://images2.imgbox.com/59/c4/pVn1bw5I_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_22"></a>参数传递</h3> 
<p>假设我们需要查询 id 为 4 的用户的信息的时候，对应的 SQL 语句就是 <code>select * from userinfo where id=4;</code>，对应到我们的 MyBatis 就是这样的。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from userinfo where id=4"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">UserInfo</span> <span class="token function">getById</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/51/b1/I74x2tot_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/08/42/s8gjow8p_o.png" alt="在这里插入图片描述"><br> 但是可以发现，这样写 SQL 语句的话，这个查询的条件就写死了，那么是否有一种方法可以根据我们用户传递的参数查询指定条件的数据呢？答案是可以的，这就需要用到 MyBatis 中参数传递的知识了。</p> 
<p>MyBatis 中使用 <code>#{}</code> 来获取方法中的参数，当我们调用这个方法并且传入参数的时候通过这个 <code>#{}</code> 就能将传递过来的参数给 SQL 语句。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from userinfo where id=#{id}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">UserInfo</span> <span class="token function">getById1</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">getById1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">UserInfo</span> userInfo <span class="token operator">=</span> userInfoMapper<span class="token punctuation">.</span><span class="token function">getById1</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b0/63/k4woL14G_o.png" alt="在这里插入图片描述"><br> 如果 mapper 接口类型的方法只有一个普通类型的参数，#{…}里面的属性名可以随便写，但是还是建议和参数名保持一致。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from userinfo where id=#{userid}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">UserInfo</span> <span class="token function">getById1</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f1/85/HKaW0jfN_o.png" alt="在这里插入图片描述"><br> 当然，如果我们觉得方法参数的名字不好的话，我们也可以使用 <code>@Param</code> 对方法的参数进行重命名，但是如果使用 <code>@Param</code> 对参数进行重命名的话，#{…}里面的属性名必须和别名是相同的。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from userinfo where id=#{userid}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">UserInfo</span> <span class="token function">getById1</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"userid"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/29/b0/A7whS17z_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from userinfo where id=#{id}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">UserInfo</span> <span class="token function">getById1</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"userid"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/04/41/wR9hApSj_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="MyBatis__69"></a>MyBatis 增加操作</h3> 
<p>数据库的主要操作无非就是增删改查，那么我们使用 MyBatis 如何实现数据库的增删改查呢？</p> 
<p>MyBatis 增加操作需要使用到 <code>@Insert</code> 注解。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">"insert into userinfo (username, `password`, age, gender, phone)"</span> <span class="token operator">+</span>
            <span class="token string">"values (#{username}, #{password}, #{age}, #{gender}, #{phone})"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">UserInfo</span> userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">UserInfo</span> userInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userInfo<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"小美"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userInfo<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"小美"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userInfo<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userInfo<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userInfo<span class="token punctuation">.</span><span class="token function">setPhone</span><span class="token punctuation">(</span><span class="token string">"3139812381"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ret <span class="token operator">=</span> userInfoMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>ret <span class="token operator">+</span> <span class="token string">"行被更新"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这里可以选择将插入的数据封装成Java对象作为参数传入，也可以将这每个些信息当成一个参数进行传递。当以Java对象的形式作为参数进行传递的话，Java对象中的属性名需要保持和数据库中的列名相同，因为当传递的参数是对象的话，MyBatis 会进入到这个对象中，查看这个对象中的属性，然后与数据库中的列名做比较，如果相同就将Java对象中属性的值代入 SQL 语句中，不相同则不带入。</p> 
<p><img src="https://images2.imgbox.com/56/f4/lalQbNo8_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_96"></a>返回主键</h4> 
<p>Insert 语句默认返回的是受影响的行数，如果我们需要只需要将方法的返回类型声明为 int/Integer 就可以了，如果不需要，就将方法的返回类型声明为 void。</p> 
<p>但是有些时候，我们不仅仅需要 insert 语句影响的行数，可能还需要获取到其他的信息，比如自增主键的值，那么我们如何获取到 insert 之后自增主键的值呢？如果我们直接拿到Java对象中与自增主键列同名的属性，能拿到吗？</p> 
<pre><code class="prism language-java">log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>ret <span class="token operator">+</span> <span class="token string">"行被更新"</span> <span class="token operator">+</span> userInfo<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1c/d0/KJufnjJw_o.png" alt="在这里插入图片描述"><br> 按理来说这个自增主键应该是 5 了，但是拿到的确实 0，说明这个还是初始值，那么应该进行什么操作才能拿到这个 insert 的一行的自增主键的值呢？</p> 
<p>如果想要拿到自增主键的值，需要在 Mapper 接口的方法上添加一个 <code>@Options</code> 注解。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Options</span><span class="token punctuation">(</span>useGeneratedKeys <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> keyProperty <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">"insert into userinfo (username, `password`, age, gender, phone)"</span> <span class="token operator">+</span>
        <span class="token string">"values (#{username}, #{password}, #{age}, #{gender}, #{phone})"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">UserInfo</span> userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>useGeneratedKeys：这会令 MyBatis 使⽤ JDB 的 getGeneratedKeys ⽅法来取出由数据库内部⽣成的主键（⽐如：像 MySQL 和 SQL Server 这样的关系型数据库管理系统的⾃动递增字段），默认值：false</li><li>keyProperty：指定能够唯⼀识别对象的属性，MyBatis 会使⽤ getGeneratedKeys 的返回值或 insert 语句的 selectKey ⼦元素设置它的值，默认值：未设置（unset）</li></ul> 
<p>useGeneratedKeys 参数是是否需要使用到自增主键，然后 keyProperty 参数表示将获取到的自增主键的值赋值给 Java 的哪个属性，因为这里我们传递的参数是 Java 对象，所以当获取到 insert 插入的那行的自增主键赋值给 id 之后，MyBatis 就会去这个对象的属性去找有没有 id 这个属性，如果有就赋值给它。如果传递的参数是多个普通类型参数的话，那么 MyBatis 就会在这些传递的参数中找，看是否有相同名称的参数，然后赋值给它。</p> 
<p><img src="https://images2.imgbox.com/d2/5c/R0pkAeV8_o.png" alt="在这里插入图片描述"><br> 因为我这里为大家演示的时候，多次插入了，所以获取到的自增主键的值是8，这影响不大，我们关键看是否 insert 插入的这行的自增主键赋值给了 userInfo 对象中的 id 属性。</p> 
<p>如果传递的是对象，并且在接收参数的时候对这个参数进行了重命名的话，SQL 中的 #{} 参数就需要指定是哪个引用的哪个属性。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Options</span><span class="token punctuation">(</span>useGeneratedKeys <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> keyProperty <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">"insert into userinfo (username, `password`, age, gender, phone)"</span> <span class="token operator">+</span>
        <span class="token string">"values (#{user.username}, #{user.password}, #{user.age}, #{user.gender}, #{user.phone})"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span> <span class="token class-name">UserInfo</span> userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="MyBatis__133"></a>MyBatis 删除操作</h3> 
<p>使用 MyBatis 进行删除数据的操作需要使用到 <code>@Delete</code> 注解。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token string">"delete from userinfo where id=#{id}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    userInfoMapper<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ab/3b/4yhE6qPe_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ba/d5/UCzShKvx_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="MyBatis__149"></a>MyBatis 修改操作</h3> 
<p>MyBatis 实现修改操作需要使用到 <code>@Update</code> 注解。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Update</span><span class="token punctuation">(</span><span class="token string">"update userinfo set gender=#{gender} where id=#{id}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> gender<span class="token punctuation">,</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    userInfoMapper<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/58/31/udDrCt0f_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/53/e7/0p8WiYhH_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="MyBatis__166"></a>MyBatis 查找操作</h3> 
<p>查询操作不就是 <code>select </code>吗，还有什么需要讲的吗？</p> 
<p>通过前面的查询我们可以发现，我们 Java 的 userInfo 对象中的 <code>deleteFlag createTime updateTime</code> 都是初识值，也就是说，这些属性并没有被赋值，那么这是为什么呢？我的 select SQL 语句不是查询出结果了吗？</p> 
<p>还记得我们前面说了什么吗？需要保证 Java 中的属性名和数据库表中的列名保持一致，因为当 select 查询出结果之后，MyBatis 会根据方法的返回值类型，如果是普通类型的话，并且 select 查询出来的结果的类型和方法返回值的类型相同的话，那么就会直接将这个查询出来的结果进行返回；但是如果方法返回值的类型是 Java 对象的话，MyBatis 会将查询出来的结果按照列名与 Java 对象中的属性名进行匹配，如果相同就赋值给这个属性，没有相同的属性名，那么 Java 对象的这个属性就是初始值。</p> 
<p>虽然保证数据库表中的列名和 Java 对象中的属性名保持一致很重要，但是由于 SQL 和 Java 的变量名命名规则和习惯存在差异，比如：在 SQL 中，deletflg 就是这样表示——delete_flag，而在 Java 中是以小驼峰的习惯进行命名，也就是——deleteFlag，那么这样的话，就无法保证名称一致了，那么这样该怎么办呢？有三种解决方法：</p> 
<h4><a id="1__175"></a>1. 对查询结果进行别名</h4> 
<p>前面我们学习 SQL 的时候肯定学过对查询结果进行重命名吧，我们可以将列名与Java属性名不相同的列进行重命名。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select id, username, password, age, gender, delete_flag as deleteFlag,"</span> <span class="token operator">+</span>
        <span class="token string">"create_time as createTime, update_time as updateTime from userinfo"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectAll1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">selectAll1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userInfoMapper<span class="token punctuation">.</span><span class="token function">selectAll1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6d/c5/TSrvRhLx_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_Results_193"></a>2. @Results注解</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Results</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">String</span> <span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">""</span><span class="token punctuation">;</span>

    <span class="token class-name">Result</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>@Results 注解的参数有两个，一个是 String 类型，这个参数的用法稍后给大家讲，第二个参数就是 Result[] 一个数组，数组中的每个元素都是一个 Result 类型，而 Result 中也有很多参数，但是这里我们主要用到两个：</p> 
<p><img src="https://images2.imgbox.com/b2/75/YU5h6F4j_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Results</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>column <span class="token operator">=</span> <span class="token string">"delete_flag"</span><span class="token punctuation">,</span> property <span class="token operator">=</span> <span class="token string">"deleteFlag"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>column <span class="token operator">=</span> <span class="token string">"create_time"</span><span class="token punctuation">,</span> property <span class="token operator">=</span> <span class="token string">"createTime"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>column <span class="token operator">=</span> <span class="token string">"update_time"</span><span class="token punctuation">,</span> property <span class="token operator">=</span> <span class="token string">"updateTime"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select id, username, password, age, gender, delete_flag,"</span> <span class="token operator">+</span>
        <span class="token string">"create_time, update_time from userinfo"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectAll2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">selectAll2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userInfoMapper<span class="token punctuation">.</span><span class="token function">selectAll1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/79/25/H3CvfsQR_o.png" alt="在这里插入图片描述"><br> 如果我们又想根据给定的 id 进行查询的话，因为表的列名和Java的属性名不同，那么是否又需要写跟上面一样的 <code>@Results</code> 注解吗？不是的，这就需要用到 @Results 注解的第一个参数了，通过指定 @Results 的第一个参数，可以使得这个 @Results 注解可以重复使用。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Results</span><span class="token punctuation">(</span>id <span class="token operator">=</span> <span class="token string">"BaseMap"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>column <span class="token operator">=</span> <span class="token string">"delete_flag"</span><span class="token punctuation">,</span> property <span class="token operator">=</span> <span class="token string">"deleteFlag"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>column <span class="token operator">=</span> <span class="token string">"create_time"</span><span class="token punctuation">,</span> property <span class="token operator">=</span> <span class="token string">"createTme"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>column <span class="token operator">=</span> <span class="token string">"update_time"</span><span class="token punctuation">,</span> property <span class="token operator">=</span> <span class="token string">"updateTime"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>如果后面的方法也想使用和这个 @Results 注解相同的配置的话，只需要在方法上加上 <code>@ResultMap</code> 注解就可以了。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@ResultMap</span><span class="token punctuation">(</span><span class="token string">"BaseMap"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select id, username, password, age, gender, delete_flag,"</span> <span class="token operator">+</span>
        <span class="token string">"create_time, update_time from userinfo where id=#{id}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">UserInfo</span> <span class="token function">getById2</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>这个 @ResultMap 中的参数需要保证和 @Results 注解中的第一个参数 id 的值保持一致才可以使用该 @Results 的相同配置。</p> 
<p><img src="https://images2.imgbox.com/ee/03/DgZsPHH0_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3__249"></a>3. 开启驼峰命名（推荐）</h4> 
<p>通常数据库列使⽤蛇形命名法进⾏命名(下划线分割各个单词)，⽽ Java 属性⼀般遵循驼峰命名法约定。为了在这两种命名⽅式之间启⽤⾃动映射，需要将 mapUnderscoreToCamelCase 设置为 true。</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
	<span class="token key atrule">configuration</span><span class="token punctuation">:</span>
		<span class="token key atrule">map-underscore-to-camel-case</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#配置驼峰⾃动转换</span>
</code></pre> 
<p>当在配置文件添加这个配置之后，我们再试一次看看结果：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from userinfo"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectAll3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">selectAll3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userInfoMapper<span class="token punctuation">.</span><span class="token function">selectAll3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ab/f8/93VDKelw_o.png" alt="在这里插入图片描述"><br> 可以发现通过在配置文件中添加配置从而解决 SQL 和 Java 命名规则不同而导致的问题非常的方便，所以也建议大家使用这个做法。</p> 
<h2><a id="XML__MyBatis_274"></a>XML 配置文件方法书写 MyBatis</h2> 
<h3><a id="_276"></a>配置数据库的相关配置</h3> 
<p>不管使用什么方法书写 MyBatis，首先就是需要配置数据库相关的信息，这里 XML 配置数据库信息的方式跟注解配置数据库的方式是一样的，我这里就不过多介绍了。</p> 
<pre><code class="prism language-yaml"><span class="token comment"># 数据库连接配置</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
	<span class="token key atrule">datasource</span><span class="token punctuation">:</span>
		<span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>3306/mybatis_test<span class="token punctuation">?</span>
		characterEncoding=utf8<span class="token important">&amp;useSSL=false</span>
		<span class="token key atrule">username</span><span class="token punctuation">:</span> root
		<span class="token key atrule">password</span><span class="token punctuation">:</span> root
		<span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
</code></pre> 
<h3><a id="XML_290"></a>指定XML的文件路径</h3> 
<p>当配置完成数据库相关配置之后，还需要指定我们的 MyBatis XML 的文件路径。</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
	<span class="token key atrule">mapper-locations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mapper/<span class="token important">**Mapper.xml</span>
</code></pre> 
<p>这个路径在我们的项目中这样显示：</p> 
<p><img src="https://images2.imgbox.com/38/93/vMBFo3pE_o.png" alt="在这里插入图片描述"><br> classpath 就是我们项目的 resources 文件夹，mapper 是我们自己创建的用来操作 MyBatis 的文件夹，这个文件夹中存放的都是 xml 文件，而这个配置中的 <code>**Mapper.xml</code> 则表示所有以 Mapper.xml 结尾的文件，如果想表示以 <code>.xml</code> 结尾的文件，则用 <code>**.xml</code> 来表示。通常我们的操作 MyBatis 的 XML 文件都是以 Mapper.xml 作为后缀。这里的 <code>mapper</code> 文件夹和 <code>**Mapper.xml</code> 都是程序员自定义的，只要能够对上就可以了。</p> 
<h3><a id="xml__303"></a>xml 实现</h3> 
<p>首先我们需要在 xml 文件中添加固定格式：</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span>
<span class="token string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">&lt;mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.mybatis20231226.Mapper.UserInfoXMLMapper<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>这里 namespace 中的值是我们的要实现的接口的全限定类名。</p> 
<p><img src="https://images2.imgbox.com/b2/69/wwx8Ao1u_o.png" alt="在这里插入图片描述"></p> 
<p>这里的接口就正常写，主要的操作在我们的 xml 文件中。</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mybatis20231226<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mybatis20231226<span class="token punctuation">.</span></span><span class="token class-name">Model</span><span class="token punctuation">.</span><span class="token class-name">UserInfo</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserInfoXMLMapper</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>后面的实现就是写在 <code>&lt;mapper&gt;</code> 标签中的，假设我们这里还是查询，就可以这样写：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.mybatis20231226.Mapper.UserInfoXMLMapper<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectAll<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.mybatis20231226.Model.UserInfo<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        select * from userinfo
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>id 参数指定要实现的接口中的方法名称，resultType 指定该方法的返回的数据的类型的路径，这里不是 List，而是 List 中的元素的类型 UserInfo。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">UserInfoXMLMapperTest</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserInfoXMLMapper</span> userInfoXMLMapper<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userInfoXMLMapper<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ec/7b/LMheTLGZ_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_360"></a>增加操作</h4> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">UserInfo</span> userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>insert<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    insert into userinfo (username, password, age, gender, phone)
    values(#{username}, #{password}, #{age}, #{gender}, #{phone})
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">UserInfo</span> userInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userInfo<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"小帅"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userInfo<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"小帅"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userInfo<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userInfo<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userInfo<span class="token punctuation">.</span><span class="token function">setPhone</span><span class="token punctuation">(</span><span class="token string">"31737137128"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ret <span class="token operator">=</span> userInfoXMLMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>ret <span class="token operator">+</span> <span class="token string">"被更新"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/43/82/54RxnBoI_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/89/ca/4cOF3rvG_o.png" alt="在这里插入图片描述"></p> 
<p><font color="CC0000">获取插入数据的自增主键</font></p> 
<p>要想获取到插入数据的自增主键，需要在 <code>&lt;insert&gt;</code> 标签中配置 <code>userGenerateKeys</code> 参数和 <code>keyProperty</code> 参数。</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>insert id<span class="token operator">=</span><span class="token string">"insert"</span> useGeneratedKeys<span class="token operator">=</span><span class="token string">"true"</span> keyProperty<span class="token operator">=</span><span class="token string">"id"</span><span class="token operator">&gt;</span>
    insert into userinfo <span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> age<span class="token punctuation">,</span> gender<span class="token punctuation">,</span> phone<span class="token punctuation">)</span>
    <span class="token function">values</span><span class="token punctuation">(</span>#<span class="token punctuation">{<!-- --></span>username<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>password<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>age<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>gender<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>phone<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>insert<span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c8/3b/86C23EId_o.png" alt="在这里插入图片描述"></p> 
<p><font color="CC0000">别名</font></p> 
<p>xml 别名的操作和使用注解的操作是类似的。</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span> <span class="token class-name">UserInfo</span> userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>insert<span class="token punctuation">"</span></span> <span class="token attr-name">useGeneratedKeys</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">keyProperty</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    insert into userinfo (username, password, age, gender, phone)
    values(#{user.username}, #{user.password}, #{user.age}, #{user.gender}, #{user.phone})
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="_416"></a>删除操作</h4> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delete</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>delete<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    delete from userinfo where id=#{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>delete</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    userInfoXMLMapper<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8d/0a/BydhbuLI_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/64/c1/9VwWiH0G_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_436"></a>修改操作</h4> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> gender<span class="token punctuation">,</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>update<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    update userinfo set gender=#{gender} where id=#{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    userInfoXMLMapper<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/17/7f/sxOBIKz8_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/24/9b/1YUlUSF2_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_456"></a>查找操作</h4> 
<p>这里也是主要为了解决 SQL 命名规则和 Java 命名规则不同导致的问题，解决方法和通过注解是一样的。</p> 
<h5><a id="1__459"></a>1. 别名</h5> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectAll2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectAll2<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.mybatis20231226.Model.UserInfo<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    select id, username, password, age, gender, delete_flag as deleteFlag,
           create_time as createTime, update_time as updateTime from userinfo
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">selectAll2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userInfoXMLMapper<span class="token punctuation">.</span><span class="token function">selectAll1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2c/3d/yGszLOMy_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="2__result_481"></a>2. 定义 result</h5> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectAll1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>XmlBaseMap<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.mybatis20231226.Model.UserInfo<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>delete_flag<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deleteFlag<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>create_time<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>createTime<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>update_time<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>updateTime<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectAll1<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>XmlBaseMap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    select * from userinfo
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>id标签用于标识主键列和Java对象的对应关系，<code>&lt;result&gt;</code>标签则用于标识非主键列和Java对象的对应关系</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">selectAll1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userInfoXMLMapper<span class="token punctuation">.</span><span class="token function">selectAll1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6c/23/DWlaORIH_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="3__511"></a>3. 开启驼峰命名</h5> 
<p>这个和前面注解的做法是一样的，都是在配置文件中讲驼峰转换的配置的值设置为 true 就可以了。</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
	<span class="token key atrule">configuration</span><span class="token punctuation">:</span>
		<span class="token key atrule">map-underscore-to-camel-case</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#配置驼峰⾃动转换</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ebcd362eca38856701963500393579ff/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">git 常用命令 rebase发生冲突时 ☞ 撤销rebase</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d37d5cf6f3ab8eefe29644855a67ed35/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">kubernetes（二）创建集群</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>