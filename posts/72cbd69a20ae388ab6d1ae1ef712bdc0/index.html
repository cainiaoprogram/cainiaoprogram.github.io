<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Elasticsearch查询多个条件组合 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Elasticsearch查询多个条件组合" />
<meta property="og:description" content="在Elasticsearch（ES）中，你可以使用&#34;bool&#34;查询来组合多个条件。 下面是一个简单的例子，演示如何在一个查询中使用多个字段：
假设你有一个索引（Index）叫做&#34;my_index&#34;，里面包含了一个文档类型（Type）为&#34;my_type&#34;的文档。文档有两个字段，分别是&#34;title&#34;和&#34;content&#34;。现在，你想要在这两个字段中搜索包含特定关键字的文档。
以下是一个基本的例子：
jsonCopy code{ &#34;query&#34;: { &#34;bool&#34;: { &#34;should&#34;: [ { &#34;match&#34;: { &#34;title&#34;: &#34;关键字&#34; } }, { &#34;match&#34;: { &#34;content&#34;: &#34;关键字&#34; } } ] } } } 在上述查询中，&#34;bool&#34;查询使用了&#34;should&#34;子句，它表示其中的条件之一满足即可。在这个例子中，我们使用了两个&#34;match&#34;查询，分别对&#34;title&#34;和&#34;content&#34;字段执行搜索。
请根据你的实际需求调整查询条件和字段。这只是一个简单的示例，Elasticsearch提供了许多其他功能和查询类型，可以根据具体需求进行更复杂的查询。
在Elasticsearch中对同一个字段执行多个关键字搜索 在Elasticsearch中，你可以使用 “bool” 查询来执行对同一个字段的多个关键字搜索。以下是一个简单的例子，演示如何在同一个字段上执行多个关键字的搜索：
jsonCopy code{ &#34;query&#34;: { &#34;bool&#34;: { &#34;should&#34;: [ { &#34;match&#34;: { &#34;your_field&#34;: &#34;关键字1&#34; } }, { &#34;match&#34;: { &#34;your_field&#34;: &#34;关键字2&#34; } }, { &#34;match&#34;: { &#34;your_field&#34;: &#34;关键字3&#34; } } // 添加更多关键字的匹配条件 ] } } } 在上述查询中，“bool” 查询使用了 “should” 子句，表示其中的任何一个条件匹配即可。每个条件都是一个 “match” 查询，用于匹配相应的关键字。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/72cbd69a20ae388ab6d1ae1ef712bdc0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-04T22:14:07+08:00" />
<meta property="article:modified_time" content="2024-01-04T22:14:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Elasticsearch查询多个条件组合</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="ElasticsearchESbool_0"></a>在Elasticsearch（ES）中，你可以使用"bool"查询来组合多个条件。</h3> 
<p>下面是一个简单的例子，演示如何在一个查询中使用多个字段：</p> 
<p>假设你有一个索引（Index）叫做"my_index"，里面包含了一个文档类型（Type）为"my_type"的文档。文档有两个字段，分别是"title"和"content"。现在，你想要在这两个字段中搜索包含特定关键字的文档。</p> 
<p>以下是一个基本的例子：</p> 
<pre><code class="prism language-json">jsonCopy code<span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"query"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"should"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span> <span class="token string-property property">"match"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token string-property property">"title"</span><span class="token operator">:</span> <span class="token string">"关键字"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span> <span class="token string-property property">"match"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token string-property property">"content"</span><span class="token operator">:</span> <span class="token string">"关键字"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在上述查询中，"bool"查询使用了"should"子句，它表示其中的条件之一满足即可。在这个例子中，我们使用了两个"match"查询，分别对"title"和"content"字段执行搜索。</p> 
<p>请根据你的实际需求调整查询条件和字段。这只是一个简单的示例，Elasticsearch提供了许多其他功能和查询类型，可以根据具体需求进行更复杂的查询。</p> 
<h3><a id="Elasticsearch_31"></a>在Elasticsearch中对同一个字段执行多个关键字搜索</h3> 
<p>在Elasticsearch中，你可以使用 “bool” 查询来执行对同一个字段的多个关键字搜索。以下是一个简单的例子，演示如何在同一个字段上执行多个关键字的搜索：</p> 
<pre><code class="prism language-json">jsonCopy code<span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"query"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"should"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span> <span class="token string-property property">"match"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token string-property property">"your_field"</span><span class="token operator">:</span> <span class="token string">"关键字1"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span> <span class="token string-property property">"match"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token string-property property">"your_field"</span><span class="token operator">:</span> <span class="token string">"关键字2"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span> <span class="token string-property property">"match"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token string-property property">"your_field"</span><span class="token operator">:</span> <span class="token string">"关键字3"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
        <span class="token comment">// 添加更多关键字的匹配条件</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在上述查询中，“bool” 查询使用了 “should” 子句，表示其中的任何一个条件匹配即可。每个条件都是一个 “match” 查询，用于匹配相应的关键字。</p> 
<p>你可以根据需要添加更多的关键字到 “should” 数组中。这样，如果文档中的字段匹配数组中的任何一个关键字，该文档就会被检索出来。</p> 
<p>请注意，这只是一个简单的示例，实际上 Elasticsearch 提供了更多高级的查询功能，例如通配符查询、正则表达式查询等，你可以根据具体需求选择适当的查询类型。</p> 
<h3><a id="SpringBootElasticsearch_62"></a>SpringBoot操作在Elasticsearch中对同一个字段执行多个关键字搜索</h3> 
<p>在Spring Boot中，你可以使用Spring Data Elasticsearch来与Elasticsearch进行集成并执行查询。以下是一个简单的例子，演示如何在Spring Boot中对同一个字段执行多个关键字搜索：</p> 
<ol><li>首先，确保在<code>pom.xml</code>文件中添加Spring Data Elasticsearch的依赖：</li></ol> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ol><li>创建一个实体类，用于映射Elasticsearch中的文档：</li></ol> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Id</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>indexName <span class="token operator">=</span> <span class="token string">"your_index"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"your_type"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YourEntity</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> yourField<span class="token punctuation">;</span>

    <span class="token comment">// getters and setters</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>确保替换 “your_index” 和 “your_type” 为实际的索引和文档类型。</p> 
<ol><li>创建一个Spring Data Elasticsearch的Repository接口：</li></ol> 
<pre><code class="prism language-java">javaCopy codeimport <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span>ElasticsearchRepository</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">YourEntityRepository</span> <span class="token keyword">extends</span> <span class="token class-name">ElasticsearchRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">YourEntity</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">// 定义需要的查询方法</span>
<span class="token punctuation">}</span>
</code></pre> 
<ol><li>在Service或Controller中使用Repository执行查询：</li></ol> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YourService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">YourEntityRepository</span> yourEntityRepository<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ElasticsearchTemplate</span> elasticsearchTemplate<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">YourEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">searchByMultipleKeywords</span><span class="token punctuation">(</span><span class="token class-name">String</span> field<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> keywords<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 构建布尔查询</span>
        <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span>BoolQueryBuilder</span> boolQuery <span class="token operator">=</span> <span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">boolQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 添加多个关键字的匹配条件</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> keyword <span class="token operator">:</span> keywords<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            boolQuery<span class="token punctuation">.</span><span class="token function">should</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span> keyword<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 使用ElasticsearchTemplate执行查询</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">YourEntity</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> elasticsearchTemplate<span class="token punctuation">.</span><span class="token function">queryForList</span><span class="token punctuation">(</span>
                <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span>QueryBuilders</span><span class="token punctuation">.</span><span class="token function">wrapperQuery</span><span class="token punctuation">(</span>boolQuery<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">YourEntity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在上述代码中，<code>searchByMultipleKeywords</code> 方法接收字段名和关键字列表，并构建一个布尔查询，然后使用ElasticsearchTemplate执行查询。</p> 
<p>请确保替换 “your_index”、“your_type” 和实体类的字段名为你实际的索引、文档类型和字段名。这只是一个简单的示例，具体的实现可能需要根据你的数据结构和查询需求进行调整。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/92d3dd9613de86e5031636345755979b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用数据结构python写大数计算器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b2feae4adaa299983a3470fee6924c87/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Nodejs】基于node http模块的博客demo代码实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>