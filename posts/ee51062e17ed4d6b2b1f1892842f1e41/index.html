<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>opencv入门：矩特征，Hu矩 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="opencv入门：矩特征，Hu矩" />
<meta property="og:description" content="矩特征 比较两个轮廓最简单的方法是比较二者的轮廓矩，轮廓矩代表了一个轮廓，一副图像，一组点集的全局特征，矩信息包含了对应对象不同类型的集合特征，例如大小，位置，角度，形状等，矩特征广泛应用在模式识别，图像识别方面。
矩的计算：moments 函数 retval = cv2.moments( array[, binaryImage] ) 获取图像的 Moments特征，使用轮廓矩可以方便的比较两个轮廓
array 可以是点集 ，也可以是灰度图或二值图。当array 是点集时，函数会把这些点集当作轮廓中的顶点，将整个点集当作一条轮廓，而不是当作独立的点binaryImage True时，array 内所有非零值都处理为1，参数仅在array 是图像时有效。retval 返回的矩特征，主要包括 空间矩，零阶矩 m00 ，一阶矩：m10, m01，二阶矩：m20, m11, m02，三阶矩：m30, m21, m12, m03中心矩，二阶中心矩：mu20, mu11, mu02，三阶中心矩：mu30, mu21, mu12, mu03归一化中心矩，二阶 Hu 矩：nu20, nu11, nu02，三阶 Hu 矩：nu30, nu21, nu12, nu03 阿巴阿巴，，上面的啥矩 都是根据公式计算得到的，大多数矩都是通过数学公式得到的抽象特征，但是很明显，如果两个轮廓的矩一致，那么这两个轮廓就是一致的。m00 的含义就很直观，表示一个轮廓的面积。
cv2.moments 返回的特征值可以用来比较两个轮廓是否相似，例如 不管两个轮廓出现再那个位置，可以通过函数cv2.moments() 的m00 矩来判断面积是否一致。
当轮廓位置改变，虽然面积，周长等特征不会变，但是更高阶的特征会随位置而改变，中心矩通过减去均值而获取平移不变性，从而可以比较不同位置的两个对象是否一致。
归一化中心矩通过除以物体总尺寸而获得缩放不变性，通过计算提取对象的归一化中心矩属性值，该属性值不但拥有平移不变性，还有缩放不变性，也就从缩放前后的图像中提取稳定的特征值来比较轮廓。
再opencv 中cv2.moments() 会同时计算上述三种，，i了i了，Opencv就是为了让你忽略一些细节嘛，，，
o = cv2.imread(&#39;16.jpg&#39;) cv2.imshow(&#34;original&#34;,o) gray = cv2.cvtColor(o,cv2.COLOR_BGR2GRAY) ret, binary = cv2.threshold(gray,127,255,cv2.THRESH_BINARY) # 转成二值图 contours, hierarchy = cv2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ee51062e17ed4d6b2b1f1892842f1e41/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-09-21T21:51:08+08:00" />
<meta property="article:modified_time" content="2020-09-21T21:51:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">opencv入门：矩特征，Hu矩</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>矩特征</h3> 
<p>比较两个轮廓最简单的方法是比较二者的轮廓矩，<strong>轮廓矩代表了一个轮廓，一副图像，一组点集的全局特征</strong>，矩信息包含了对应对象不同类型的集合特征，例如大小，位置，角度，形状等，矩特征广泛应用在模式识别，图像识别方面。</p> 
<h5><a id="moments__3"></a>矩的计算：moments 函数</h5> 
<p><code>retval = cv2.moments( array[, binaryImage] )</code> 获取图像的 Moments特征，使用轮廓矩可以方便的比较两个轮廓</p> 
<ul><li>array 可以是点集 ，也可以是灰度图或二值图。当array 是点集时，函数会把这些点集当作轮廓中的顶点，将整个点集当作一条轮廓，而不是当作独立的点</li><li>binaryImage True时，array 内所有非零值都处理为1，参数仅在array 是图像时有效。</li><li>retval 返回的矩特征，主要包括</li></ul> 
<ol><li>空间矩，零阶矩 m00 ，一阶矩：m10, m01，二阶矩：m20, m11, m02，三阶矩：m30, m21, m12, m03</li><li>中心矩，二阶中心矩：mu20, mu11, mu02，三阶中心矩：mu30, mu21, mu12, mu03</li><li>归一化中心矩，二阶 Hu 矩：nu20, nu11, nu02，三阶 Hu 矩：nu30, nu21, nu12, nu03</li></ol> 
<p>阿巴阿巴，，上面的啥矩 都是根据公式计算得到的，大多数矩都是通过数学公式得到的抽象特征，但是很明显，如果两个轮廓的矩一致，那么这两个轮廓就是一致的。m00 的含义就很直观，表示一个轮廓的面积。</p> 
<p>cv2.moments 返回的特征值可以用来比较两个轮廓是否相似，例如 不管两个轮廓出现再那个位置，可以通过函数cv2.moments() 的m00 矩来判断面积是否一致。</p> 
<p>当轮廓位置改变，虽然面积，周长等特征不会变，但是更高阶的特征会随位置而改变，中心矩通过减去均值而获取平移不变性，从而可以比较不同位置的两个对象是否一致。</p> 
<p>归一化中心矩通过除以物体总尺寸而获得缩放不变性，通过计算提取对象的归一化中心矩属性值，该属性值不但拥有平移不变性，还有缩放不变性，也就从缩放前后的图像中提取稳定的特征值来比较轮廓。</p> 
<p>再opencv 中cv2.moments() 会同时计算上述三种，，i了i了，Opencv就是为了让你忽略一些细节嘛，，，</p> 
<pre><code class="prism language-python">o <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'16.jpg'</span><span class="token punctuation">)</span> 
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"original"</span><span class="token punctuation">,</span>o<span class="token punctuation">)</span>
gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span> 
ret<span class="token punctuation">,</span> binary <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>gray<span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">)</span> <span class="token comment"># 转成二值图 </span>
contours<span class="token punctuation">,</span> hierarchy <span class="token operator">=</span> cv2<span class="token punctuation">.</span>findContours<span class="token punctuation">(</span>binary<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>RETR_LIST<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>CHAIN_APPROX_SIMPLE<span class="token punctuation">)</span> 
n<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>contours<span class="token punctuation">)</span>
contoursImg<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>         <span class="token comment"># 分别展示轮廓</span>
     temp<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>o<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
     contoursImg<span class="token punctuation">.</span>append<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>
     contoursImg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>cv2<span class="token punctuation">.</span>drawContours<span class="token punctuation">(</span>contoursImg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>contours<span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> 
     cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"contours["</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"]"</span><span class="token punctuation">,</span>contoursImg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"观察各个轮廓的矩（moments）:"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"轮廓"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"的矩:\n"</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>contours<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"观察各个轮廓的面积:"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"轮廓"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"的面积:%d"</span> <span class="token operator">%</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>contours<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'m00'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span>

观察各个轮廓的矩（moments）<span class="token punctuation">:</span>
轮廓<span class="token number">0</span>的矩<span class="token punctuation">:</span>
 <span class="token punctuation">{<!-- --></span><span class="token string">'m00'</span><span class="token punctuation">:</span> <span class="token number">13120.0</span><span class="token punctuation">,</span> <span class="token string">'m10'</span><span class="token punctuation">:</span> <span class="token number">4473920.0</span><span class="token punctuation">,</span> <span class="token string">'m01'</span><span class="token punctuation">:</span> <span class="token number">4696960.0</span><span class="token punctuation">,</span> <span class="token string">'m20'</span><span class="token punctuation">:</span> <span class="token number">1553596053.3333333</span><span class="token punctuation">,</span> <span class="token string">'m11'</span><span class="token punctuation">:</span> <span class="token number">1601663360.0</span><span class="token punctuation">,</span> <span class="token string">'m02'</span><span class="token punctuation">:</span> <span class="token number">1688863253.3333333</span><span class="token punctuation">,</span> <span class="token string">'m30'</span><span class="token punctuation">:</span> <span class="token number">548864979520.0</span><span class="token punctuation">,</span> <span class="token string">'m21'</span><span class="token punctuation">:</span> <span class="token number">556187387093.3334</span><span class="token punctuation">,</span> <span class="token string">'m12'</span><span class="token punctuation">:</span> <span class="token number">575902369386.6666</span><span class="token punctuation">,</span> <span class="token string">'m03'</span><span class="token punctuation">:</span> <span class="token number">609876771200.0</span><span class="token punctuation">,</span> <span class="token string">'mu20'</span><span class="token punctuation">:</span> <span class="token number">27989333.333333254</span><span class="token punctuation">,</span> <span class="token string">'mu11'</span><span class="token punctuation">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token string">'mu02'</span><span class="token punctuation">:</span> <span class="token number">7351573.333333254</span><span class="token punctuation">,</span> <span class="token string">'mu30'</span><span class="token punctuation">:</span> <span class="token number">6.103515625e-05</span><span class="token punctuation">,</span> <span class="token string">'mu21'</span><span class="token punctuation">:</span> <span class="token number">6.866455078125e-05</span><span class="token punctuation">,</span> <span class="token string">'mu12'</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1.33514404296875e-05</span><span class="token punctuation">,</span> <span class="token string">'mu03'</span><span class="token punctuation">:</span> <span class="token number">0.0001220703125</span><span class="token punctuation">,</span> <span class="token string">'nu20'</span><span class="token punctuation">:</span> <span class="token number">0.16260162601625971</span><span class="token punctuation">,</span> <span class="token string">'nu11'</span><span class="token punctuation">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token string">'nu02'</span><span class="token punctuation">:</span> <span class="token number">0.042708333333332876</span><span class="token punctuation">,</span> <span class="token string">'nu30'</span><span class="token punctuation">:</span> <span class="token number">3.095604527046157e-15</span><span class="token punctuation">,</span> <span class="token string">'nu21'</span><span class="token punctuation">:</span> <span class="token number">3.4825550929269264e-15</span><span class="token punctuation">,</span> <span class="token string">'nu12'</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">6.771634902913468e-16</span><span class="token punctuation">,</span> <span class="token string">'nu03'</span><span class="token punctuation">:</span> <span class="token number">6.191209054092314e-15</span><span class="token punctuation">}</span>
轮廓<span class="token number">1</span>的矩<span class="token punctuation">:</span>
 <span class="token punctuation">{<!-- --></span><span class="token string">'m00'</span><span class="token punctuation">:</span> <span class="token number">18786.0</span><span class="token punctuation">,</span> <span class="token string">'m10'</span><span class="token punctuation">:</span> <span class="token number">3146685.0</span><span class="token punctuation">,</span> <span class="token string">'m01'</span><span class="token punctuation">:</span> <span class="token number">5044317.5</span><span class="token punctuation">,</span> <span class="token string">'m20'</span><span class="token punctuation">:</span> <span class="token number">555159008.0</span><span class="token punctuation">,</span> <span class="token string">'m11'</span><span class="token punctuation">:</span> <span class="token number">844939709.0</span><span class="token punctuation">,</span> <span class="token string">'m02'</span><span class="token punctuation">:</span> <span class="token number">1382559550.1666665</span><span class="token punctuation">,</span> <span class="token string">'m30'</span><span class="token punctuation">:</span> <span class="token number">102398186421.5</span><span class="token punctuation">,</span> <span class="token string">'m21'</span><span class="token punctuation">:</span> <span class="token number">149071547775.08334</span><span class="token punctuation">,</span> <span class="token string">'m12'</span><span class="token punctuation">:</span> <span class="token number">231585626560.58334</span><span class="token punctuation">,</span> <span class="token string">'m03'</span><span class="token punctuation">:</span> <span class="token number">386320282897.75</span><span class="token punctuation">,</span> <span class="token string">'mu20'</span><span class="token punctuation">:</span> <span class="token number">28084245.452091992</span><span class="token punctuation">,</span> <span class="token string">'mu11'</span><span class="token punctuation">:</span> <span class="token number">8472.30844771862</span><span class="token punctuation">,</span> <span class="token string">'mu02'</span><span class="token punctuation">:</span> <span class="token number">28086057.097026825</span><span class="token punctuation">,</span> <span class="token string">'mu30'</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">145894.54983520508</span><span class="token punctuation">,</span> <span class="token string">'mu21'</span><span class="token punctuation">:</span> <span class="token number">344820.28427505493</span><span class="token punctuation">,</span> <span class="token string">'mu12'</span><span class="token punctuation">:</span> <span class="token number">144172.43611335754</span><span class="token punctuation">,</span> <span class="token string">'mu03'</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">344821.7702636719</span><span class="token punctuation">,</span> <span class="token string">'nu20'</span><span class="token punctuation">:</span> <span class="token number">0.07957820229870524</span><span class="token punctuation">,</span> <span class="token string">'nu11'</span><span class="token punctuation">:</span> <span class="token number">2.400673632979375e-05</span><span class="token punctuation">,</span> <span class="token string">'nu02'</span><span class="token punctuation">:</span> <span class="token number">0.07958333569092557</span><span class="token punctuation">,</span> <span class="token string">'nu30'</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">3.0161523412948118e-06</span><span class="token punctuation">,</span> <span class="token string">'nu21'</span><span class="token punctuation">:</span> <span class="token number">7.128645373777938e-06</span><span class="token punctuation">,</span> <span class="token string">'nu12'</span><span class="token punctuation">:</span> <span class="token number">2.9805502071507094e-06</span><span class="token punctuation">,</span> <span class="token string">'nu03'</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">7.128676094377516e-06</span><span class="token punctuation">}</span>
轮廓<span class="token number">2</span>的矩<span class="token punctuation">:</span>
 <span class="token punctuation">{<!-- --></span><span class="token string">'m00'</span><span class="token punctuation">:</span> <span class="token number">14403.5</span><span class="token punctuation">,</span> <span class="token string">'m10'</span><span class="token punctuation">:</span> <span class="token number">4514816.666666666</span><span class="token punctuation">,</span> <span class="token string">'m01'</span><span class="token punctuation">:</span> <span class="token number">1937989.6666666665</span><span class="token punctuation">,</span> <span class="token string">'m20'</span><span class="token punctuation">:</span> <span class="token number">1431976362.4166665</span><span class="token punctuation">,</span> <span class="token string">'m11'</span><span class="token punctuation">:</span> <span class="token number">607478227.2083333</span><span class="token punctuation">,</span> <span class="token string">'m02'</span><span class="token punctuation">:</span> <span class="token number">277542370.4166666</span><span class="token punctuation">,</span> <span class="token string">'m30'</span><span class="token punctuation">:</span> <span class="token number">459385631581.7</span><span class="token punctuation">,</span> <span class="token string">'m21'</span><span class="token punctuation">:</span> <span class="token number">192678982549.58334</span><span class="token punctuation">,</span> <span class="token string">'m12'</span><span class="token punctuation">:</span> <span class="token number">86999188792.48334</span><span class="token punctuation">,</span> <span class="token string">'m03'</span><span class="token punctuation">:</span> <span class="token number">41860027704.0</span><span class="token punctuation">,</span> <span class="token string">'mu20'</span><span class="token punctuation">:</span> <span class="token number">16794668.13325596</span><span class="token punctuation">,</span> <span class="token string">'mu11'</span><span class="token punctuation">:</span> <span class="token number">10039.136375546455</span><span class="token punctuation">,</span> <span class="token string">'mu02'</span><span class="token punctuation">:</span> <span class="token number">16786030.075306743</span><span class="token punctuation">,</span> <span class="token string">'mu30'</span><span class="token punctuation">:</span> <span class="token number">34851.058837890625</span><span class="token punctuation">,</span> <span class="token string">'mu21'</span><span class="token punctuation">:</span> <span class="token number">394498.4239034653</span><span class="token punctuation">,</span> <span class="token string">'mu12'</span><span class="token punctuation">:</span> <span class="token number">68360.05676651001</span><span class="token punctuation">,</span> <span class="token string">'mu03'</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">391748.9297027588</span><span class="token punctuation">,</span> <span class="token string">'nu20'</span><span class="token punctuation">:</span> <span class="token number">0.08095344827348691</span><span class="token punctuation">,</span> <span class="token string">'nu11'</span><span class="token punctuation">:</span> <span class="token number">4.839051899328739e-05</span><span class="token punctuation">,</span> <span class="token string">'nu02'</span><span class="token punctuation">:</span> <span class="token number">0.08091181121511656</span><span class="token punctuation">,</span> <span class="token string">'nu30'</span><span class="token punctuation">:</span> <span class="token number">1.3997352022029674e-06</span><span class="token punctuation">,</span> <span class="token string">'nu21'</span><span class="token punctuation">:</span> <span class="token number">1.584437746123557e-05</span><span class="token punctuation">,</span> <span class="token string">'nu12'</span><span class="token punctuation">:</span> <span class="token number">2.7455687451494556e-06</span><span class="token punctuation">,</span> <span class="token string">'nu03'</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1.5733948568992055e-05</span><span class="token punctuation">}</span>
观察各个轮廓的面积<span class="token punctuation">:</span>        <span class="token comment"># 就是厉害啊，，，</span>
轮廓<span class="token number">0</span>的面积<span class="token punctuation">:</span><span class="token number">13120</span>
轮廓<span class="token number">1</span>的面积<span class="token punctuation">:</span><span class="token number">18786</span>
轮廓<span class="token number">2</span>的面积<span class="token punctuation">:</span><span class="token number">14403</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/10/26/zI1HI7HC_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_contourArea__60"></a>计算轮廓的面积: contourArea 函数</h5> 
<p>retval =cv2.contourArea(contour [, oriented] ))</p> 
<ul><li>retval 面积值</li><li>contour 轮廓</li><li>oriented 布尔值，True，返回值包含正负号，用来表示轮廓是顺时针 还是逆时针，默认False ，表示返回的retval 是一个绝对值</li></ul> 
<pre><code class="prism language-python">o <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'16.jpg'</span><span class="token punctuation">)</span> 
gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span> 
ret<span class="token punctuation">,</span> binary <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>gray<span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">)</span> 
contours<span class="token punctuation">,</span> hierarchy <span class="token operator">=</span> cv2<span class="token punctuation">.</span>findContours<span class="token punctuation">(</span>binary<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>RETR_LIST<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>CHAIN_APPROX_SIMPLE<span class="token punctuation">)</span> 
n<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>contours<span class="token punctuation">)</span>
contoursImg<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> cv2<span class="token punctuation">.</span>contourArea<span class="token punctuation">(</span>contours<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">15000</span><span class="token punctuation">:</span>             <span class="token comment"># 增加一个筛选</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"contours["</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"]面积="</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>contourArea<span class="token punctuation">(</span>contours<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

contours<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>面积<span class="token operator">=</span> <span class="token number">18786.0</span>
</code></pre> 
<h5><a id="arcLength__81"></a>计算轮廓的长度，arcLength 函数</h5> 
<p><code>retval = cv2.arcLength( curve, closed )</code> 计算轮廓的长度</p> 
<ul><li>curve轮廓</li><li>closed 布尔值，表示轮廓是否封闭</li></ul> 
<p><img src="https://images2.imgbox.com/bb/1f/2yL0ApGD_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/dc/a2/SSoYPNJ1_o.jpg" alt="在这里插入图片描述"></p> 
<h3><a id="Hu_88"></a>Hu矩</h3> 
<p>Hu矩是归一化中心矩的线性组合，Hu矩再图像旋转，缩放，平移等操作后，仍能保持矩的不变性，经常使用 Hu 矩来识别图像的特征。在 OpenCV 中，使用函数 cv2.HuMoments()可以得到 Hu 距。该函数使用 cv2.moments()函数的返回值作为参数，返回 7 个 Hu 矩值。</p> 
<h5><a id="_91"></a>函数</h5> 
<p><code>hu = cv2.HuMoments( m )</code> hu 表示返回的Hu 矩阵，参数m 是cv2.moments() 计算得到的矩特征值。</p> 
<p>Hu 矩是归一化中心矩的线性组合，每一个矩都是通过归一化中心矩的组合运算得到的，函数 cv2.moments()返回的归一化中心矩中包含：（为了表示方便，将 nu 表示为 v</p> 
<ul><li>二阶 Hu 矩：v20, v11, v02</li><li>三阶 Hu 矩：v30, v21, v12, v03<br> <img src="https://images2.imgbox.com/3e/ff/8FlIm98I_o.png" alt="在这里插入图片描述"><br> 贴上提醒我是一个渣渣，，，数学真是博大精深，，这谁想出来的。。</li></ul> 
<pre><code class="prism language-python"><span class="token comment"># 针对ℎ0 = 𝑛𝑢20 + 𝑛𝑢02 来验证一下</span>
o1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'16.jpg'</span><span class="token punctuation">)</span> 
gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o1<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span> 
HuM1<span class="token operator">=</span>cv2<span class="token punctuation">.</span>HuMoments<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>gray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># flatten 是把数组降成一维的。相关操作可以去看看https://www.cnblogs.com/yvonnes/p/10020926.html</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nHuM1=\n"</span><span class="token punctuation">,</span>HuM1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\ncv2.moments(gray)['nu20']+cv2.moments(gray)['nu02']=%f+%f=%f\n"</span> 
 <span class="token operator">%</span><span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>gray<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'nu20'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>gray<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'nu02'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>gray<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'nu20'</span><span class="token punctuation">]</span><span class="token operator">+</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>gray<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'nu02'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"HuM1[0]="</span><span class="token punctuation">,</span>HuM1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nHu[0]-(nu02+nu20)="</span><span class="token punctuation">,</span>
 HuM1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>gray<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'nu20'</span><span class="token punctuation">]</span><span class="token operator">+</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>gray<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'nu02'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


HuM1<span class="token operator">=</span>
 <span class="token punctuation">[</span> <span class="token number">1.38134402e-03</span>  <span class="token number">6.55976051e-09</span>  <span class="token number">1.54351609e-09</span>  <span class="token number">5.29039691e-11</span>
 <span class="token operator">-</span><span class="token number">1.50331297e-20</span> <span class="token operator">-</span><span class="token number">3.70483310e-15</span>  <span class="token number">1.59756875e-21</span><span class="token punctuation">]</span>

cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>gray<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'nu20'</span><span class="token punctuation">]</span><span class="token operator">+</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>gray<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'nu02'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0.000652</span><span class="token operator">+</span><span class="token number">0.000730</span><span class="token operator">=</span><span class="token number">0.001381</span>

HuM1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token number">0.0013813440210695568</span>

Hu<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>nu02<span class="token operator">+</span>nu20<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">0.0</span>   <span class="token comment"># 说明式子是合理的。。。</span>

<span class="token comment"># 第二个 小栗子</span>
o1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'12.jpg'</span><span class="token punctuation">)</span>          <span class="token comment"># 这里分别计算了三个图像的 Hu 矩</span>
gray1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o1<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span> 
HuM1<span class="token operator">=</span>cv2<span class="token punctuation">.</span>HuMoments<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>gray1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>

o2 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'18-1.jpg'</span><span class="token punctuation">)</span> 
gray2 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o2<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span> 
HuM2<span class="token operator">=</span>cv2<span class="token punctuation">.</span>HuMoments<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>gray2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>

o3 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'18-2.jpg'</span><span class="token punctuation">)</span> 
gray3 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o3<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span> 
HuM3<span class="token operator">=</span>cv2<span class="token punctuation">.</span>HuMoments<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>gray3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nHuM1-HuM2="</span><span class="token punctuation">,</span>HuM1<span class="token operator">-</span>HuM2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nHuM2-HuM3="</span><span class="token punctuation">,</span>HuM2<span class="token operator">-</span>HuM3<span class="token punctuation">)</span>      <span class="token comment"># 计算一下Hu 矩的差值</span>

cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"original1"</span><span class="token punctuation">,</span>o1<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"original2"</span><span class="token punctuation">,</span>o2<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"original3"</span><span class="token punctuation">,</span>o3<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span>


HuM1<span class="token operator">-</span>HuM2<span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">6.75354178e-04</span>  <span class="token number">1.31608683e-07</span>  <span class="token number">9.92863109e-10</span>  <span class="token number">2.15456221e-10</span>
 <span class="token operator">-</span><span class="token number">1.10706347e-20</span>  <span class="token number">9.76947585e-14</span>  <span class="token number">1.12568713e-19</span><span class="token punctuation">]</span>                 <span class="token comment"># 额，，差这么多是不是相似啊。。</span>

HuM2<span class="token operator">-</span>HuM3<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.27872218e-05</span> <span class="token operator">-</span><span class="token number">4.53260375e-09</span>  <span class="token number">2.65510725e-12</span> <span class="token operator">-</span><span class="token number">4.60117007e-12</span>
 <span class="token operator">-</span><span class="token number">1.00868574e-22</span> <span class="token operator">-</span><span class="token number">1.22339009e-15</span> <span class="token operator">-</span><span class="token number">2.49242170e-22</span><span class="token punctuation">]</span>   

<span class="token comment"># 反正展示了图像经过缩放，平移旋转等操作后Hu 矩基本保持稳定，，</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e4/2b/vglrNxsn_o.png" alt="在这里插入图片描述"><br> 感觉这个介绍胡矩（Hu矩）的文章挺好 <a href="https://zhuanlan.zhihu.com/p/117344473" rel="nofollow">脑补链接</a></p> 
<h5><a id="_158"></a>形状匹配</h5> 
<p>我们可以通过Hu 矩来判断两个对象的一致性。但是结果比较抽象，，确实，，但是我们亲爱的opencv 提供了 cv2.matchShapes() 对两个对象的Hu矩进行比较。<br> <code>retval = cv2.matchShapes( contour1, contour2, method, parameter )</code></p> 
<ul><li>contour1 第一个轮廓或者灰度图像</li><li>contour2 第二个灰度或轮廓图像 ，不管是什么，这个函数都会提前计算好对象的Hu矩。</li><li>method 比较两个对象的Hu 矩的方法，ℎ𝑖𝐴和ℎ𝑖𝐵分别是对象 A 和对象 B 的 Hu 矩。<br> <img src="https://images2.imgbox.com/68/d4/72TK8jz7_o.png" alt="在这里插入图片描述"></li><li>parameter 应用于mathod 的特定函数，4.5 了还没有支持</li></ul> 
<pre><code class="prism language-python">o1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'18-1.jpg'</span><span class="token punctuation">)</span>
o2 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'18-2.jpg'</span><span class="token punctuation">)</span>
o3 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'12.jpg'</span><span class="token punctuation">)</span> 
gray1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o1<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span> 
gray2 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o2<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span> 
gray3 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o3<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span> 
ret<span class="token punctuation">,</span> binary1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>gray1<span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">)</span> 
ret<span class="token punctuation">,</span> binary2 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>gray2<span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">)</span> 
ret<span class="token punctuation">,</span> binary3 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>gray3<span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">)</span> 
contours1<span class="token punctuation">,</span> hierarchy <span class="token operator">=</span> cv2<span class="token punctuation">.</span>findContours<span class="token punctuation">(</span>binary1<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>RETR_LIST<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>CHAIN_APPROX_SIMPLE<span class="token punctuation">)</span> 
contours2<span class="token punctuation">,</span> hierarchy <span class="token operator">=</span> cv2<span class="token punctuation">.</span>findContours<span class="token punctuation">(</span>binary2<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>RETR_LIST<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>CHAIN_APPROX_SIMPLE<span class="token punctuation">)</span> 
contours3<span class="token punctuation">,</span> hierarchy <span class="token operator">=</span> cv2<span class="token punctuation">.</span>findContours<span class="token punctuation">(</span>binary3<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>RETR_LIST<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>CHAIN_APPROX_SIMPLE<span class="token punctuation">)</span> 
cnt1 <span class="token operator">=</span> contours1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
cnt2 <span class="token operator">=</span> contours2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
cnt3 <span class="token operator">=</span> contours3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
ret0 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>matchShapes<span class="token punctuation">(</span>cnt1<span class="token punctuation">,</span>cnt1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">)</span>
ret1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>matchShapes<span class="token punctuation">(</span>cnt1<span class="token punctuation">,</span>cnt2<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">)</span>
ret2 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>matchShapes<span class="token punctuation">(</span>cnt1<span class="token punctuation">,</span>cnt3<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"相同图像的 matchShape="</span><span class="token punctuation">,</span>ret0<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"相似图像的 matchShape="</span><span class="token punctuation">,</span>ret1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"不相似图像的 matchShape="</span><span class="token punctuation">,</span>ret2<span class="token punctuation">)</span>

相同图像的 matchShape<span class="token operator">=</span> <span class="token number">0.0</span>
相似图像的 matchShape<span class="token operator">=</span> <span class="token number">0.12473414346068246</span>    <span class="token comment"># 比较相似的</span>
不相似图像的 matchShape<span class="token operator">=</span> <span class="token number">1.7976931348623157e+308</span>   <span class="token comment"># 可以看到差的非常大，，，真的很直观。。我感觉不应该差那么多啊</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/03c025e3ab45a292a2280164dab092e8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【总结】Apache Curator入门使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/78eabdcd38ac35443cb4f702dee808f4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">8种交叉验证类型的深入解释和可视化介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>