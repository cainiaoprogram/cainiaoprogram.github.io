<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>malloc函数的介绍 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="malloc函数的介绍" />
<meta property="og:description" content="malloc与new都可以分配空间，但却有很大的差别下面我将来介绍一下malloc函数。
定义 malloc动态内存分配函数，用于申请一块连续的指定大小的内存块区域以void*类型返回分配的内存区域地址。
malloc函数是一种分配长度为num_bytes字节的内存块的函数，可以向系统申请分配指定size个字节的内存空间。malloc的全称是memory allocation（动态内存分配），当无法知道内存具体位置的时候，想要绑定真正的内存空间，就需要用到动态的分配内存。返回类型是 void* 类型。void* 表示未确定类型的指针。C,C&#43;&#43;规定，void* 类型可以通过类型转换强制转换为任何其它类型的指针
malloc函数原型 void *malloc(int size); malloc 向系统申请分配指定size个字节的内存空间。返回类型是 void* 类型。void* 表示未确定类型的指针。C,C&#43;&#43;规定，void* 类型可以强制转换为任何其它类型的指针。
malloc的头文件 #include&lt;malloc.h&gt; malloc函数返回值 如果分配成功则返回指向被分配内存的指针，否则返回空指针NULL。
malloc与new的区别 从函数声明上可以看出。malloc 和 new 至少有两个不同: new 返回指定类型的指针，并且可以自动计算所需要大小。而 malloc 则必须由我们计算要字节数，并且在返回后强行转换为实际类型的指针。　#include&lt;iostream&gt; #include&lt;bits/stdc&#43;&#43;.h&gt; using namespace std; int main(){ int *p=new int;//new自动计算大小 int *str=(int *)malloc(sizeof(int));//自己计算大小 return 0; } malloc为数组分配空间 #include&lt;iostream&gt; #include&lt;bits/stdc&#43;&#43;.h&gt; using namespace std; int main(){ int n=10; int *arr=(int *)malloc(sizeof(int)*n); return 0; } malloc注意事项 关于malloc所开辟空间类型：malloc只开辟空间，不进行类型检查，只是在使用的时候进行类型的强转。
mallo函数返回的实际是一个无类型指针，必须在其前面加上指针类型强制转换才可以使用
指针自身 = (指针类型*）malloc（sizeof（指针类型）*数据数量）" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ee51c20324395700453483f32e2f1066/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-11T23:15:00+08:00" />
<meta property="article:modified_time" content="2023-02-11T23:15:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">malloc函数的介绍</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>malloc与<a class="link-info" href="https://blog.csdn.net/m0_72542983/article/details/128977214" title="new">new</a>都可以分配空间，但却有很大的差别下面我将来介绍一下malloc函数。</p> 
<h2>定义</h2> 
<p>malloc动态内存分配函数，用于申请一块连续的指定大小的内存块区域以void*类型返回分配的内存区域地址。</p> 
<p>malloc函数是一种分配长度为num_bytes字节的内存块的函数，可以向系统申请分配指定size个字节的内存空间。malloc的全称是memory allocation（动态内存分配），当无法知道内存具体位置的时候，想要绑定真正的内存空间，就需要用到动态的分配内存。返回类型是 void* 类型。void* 表示未确定类型的指针。C,C++规定，void* 类型可以通过类型转换强制转换为任何其它类型的指针</p> 
<h2>malloc函数原型</h2> 
<pre><code class="language-cpp">void *malloc(int size);</code></pre> 
<p>malloc 向系统申请分配指定size个字节的内存空间。返回类型是 void* 类型。void* 表示未确定类型的指针。C,C++规定，void* 类型可以强制转换为任何其它类型的指针。</p> 
<h2>malloc的头文件</h2> 
<pre><code class="language-cpp">#include&lt;malloc.h&gt;
</code></pre> 
<h2>malloc函数返回值</h2> 
<p>如果分配成功则返回指向被分配内存的指针，否则返回空指针NULL。</p> 
<h2>malloc与new的区别</h2> 
<p>从函数声明上可以看出。malloc 和 new 至少有两个不同: new 返回指定类型的指针，并且可以自动计算所需要大小。<span style="color:#4d4d4d;"><span style="background-color:#ffffff;">而<em> malloc </em>则必须由我们计算要字节数，并且在返回后强行转换为实际类型的指针。　</span></span></p> 
<pre><code class="language-cpp">#include&lt;iostream&gt;
#include&lt;bits/stdc++.h&gt;
using namespace std;
int main(){
	int *p=new int;//new自动计算大小
	int *str=(int *)malloc(sizeof(int));//自己计算大小 
	return 0; 
} </code></pre> 
<h2>malloc为数组分配空间</h2> 
<pre><code class="language-cpp">#include&lt;iostream&gt;
#include&lt;bits/stdc++.h&gt;
using namespace std;
int main(){
	int n=10;
	int *arr=(int *)malloc(sizeof(int)*n);
	return 0;
} </code></pre> 
<h2>malloc注意事项</h2> 
<p>关于malloc所开辟空间类型：malloc只开辟空间，不进行类型检查，只是在使用的时候进行类型的强转。</p> 
<p>mallo函数返回的实际是一个无类型指针，必须在其前面加上指针类型强制转换才可以使用<br> 指针自身 = (指针类型*）malloc（sizeof（指针类型）*数据数量）</p> 
<p>在使用malloc函数之前我们一定要<strong>计算字节数</strong>，malloc开辟的是用户所需求的字节数大小的空间。</p> 
<ul><li>A、申请了内存空间后，必须检查是否分配成功。</li><li>B、当不需要再使用申请的内存时，记得释放；释放后应该把指向这块内存的指针指向NULL，防止程序后面不小心使用了它。</li><li>C、这两个函数应该是配对。如果申请后不释放就是内存泄露；如果无故释放那就是什么也没有做。释放只能一次，如果释放两次及两次以上会</li><li>出现错误（释放空指针例外，释放空指针其实也等于啥也没做，所以释放空指针释放多少次都没有问题）。</li><li>D、虽然malloc()函数的类型是(void *),任何类型的指针都可以转换成(void *),但是最好还是在前面进行强制类型转换，因为这样可以躲过一些编译器的检查。</li></ul> 
<h2>free的介绍</h2> 
<p style="margin-left:0;"><span style="color:#4d4d4d;"><span style="background-color:#ffffff;">需要包含头文件</span></span></p> 
<pre><code class="language-cpp">
#include&lt;stdlib.h&gt;</code></pre> 
<h3 style="margin-left:0px;"><span style="color:#4d4d4d;"><span style="background-color:#ffffff;">函数声明：</span></span></h3> 
<pre><code class="language-cpp">void free(void *block);</code></pre> 
<p style="margin-left:0;"> free函数在释放空间之后，把内存前的标志变为0，且为了防止数据泄露，它会把所释放的空间用cd进行填充。</p> 
<h2 style="margin-left:0px;">总结</h2> 
<p>malloc函数的实质体现在，它有一个将可用的内存块连接为一个长长的列表的所谓空闲链表。调用malloc函数时，它沿连接表寻找一个大到足以满足用户请求所需要的内存块。然后，将该内存块一分为二（一块的大小与用户请求的大小相等，另一块的大小就是剩下的字节）。接下来，将分配给用户的那块内存传给用户，并将剩下的那块（如果有的话）返回到连接表上。<br>  </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fb0d84b6c0c480e98f1660f7470662b9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Win10系统Chrome浏览器启用独立显卡提升3D程序渲染性能</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/159c29db988d4ef03009b9876cf093f0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Pytorch 实现中文字的任意旋转的准确识别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>