<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Bat文件的创建及其命令大全 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Bat文件的创建及其命令大全" />
<meta property="og:description" content="Bat文件的创建及其命令大全 一、bat文件的创建 新建txt文本文件
向文本文件中输入命令
保存并修改文本文件后缀为.bat
双击保存后的bat文件，运行
二、bat命令大全 echo 和 @ @ #关闭单行回显 echo off #从下一行开始关闭回显 @echo off 1 echo 和 @ @ #关闭单行回显 echo off #从下一行开始关闭回显 @echo off #从本行开始关闭回显。一般批处理第一行都是这个 echo on #从下一行开始打开回显 echo #显示当前是 echo off 状态还是 echo on 状态 echo. #输出一个”回车换行”，空白行 #(同echo, echo; echo&#43; echo[ echo] echo/ echo\) errorlevel echo %errorlevel% 每个命令运行结束，可以用这个命令行格式查看返回码 默认值为0，一般命令执行出错会设 errorlevel 为1 dir dir #显示当前目录中的文件和子目录 dir /a #显示当前目录中的文件和子目录，包括隐藏文件和系统文件 dir c: /a:d #显示 C 盘当前目录中的目录 dir c: /a:-d #显示 C 盘根目录中的文件 dir c:\ /b/p #/b只显示文件名，/p分页显示 dir *." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e0e9631b1c43299f86109759dd95f3bf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-17T00:45:20+08:00" />
<meta property="article:modified_time" content="2022-04-17T00:45:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Bat文件的创建及其命令大全</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Bat_1"></a>Bat文件的创建及其命令大全</h2> 
<h3><a id="bat_2"></a>一、bat文件的创建</h3> 
<ol><li> <p>新建txt文本文件</p> </li><li> <p>向文本文件中输入命令</p> </li><li> <p>保存并修改文本文件后缀为.bat</p> </li><li> <p>双击保存后的bat文件，运行</p> </li></ol> 
<h3><a id="bat_12"></a>二、bat命令大全</h3> 
<ol><li><code>echo 和 @</code></li></ol> 
<pre><code class="prism language-bash">@                          <span class="token comment">#关闭单行回显</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> off                  <span class="token comment">#从下一行开始关闭回显</span>
</code></pre> 
<pre><code class="prism language-bash">@echo off  
</code></pre> 
<ul><li>1 echo 和 @</li></ul> 
<pre><code class="prism language-bash">@                          <span class="token comment">#关闭单行回显</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> off                  <span class="token comment">#从下一行开始关闭回显</span>
</code></pre> 
<pre><code class="prism language-bash">@echo off               <span class="token comment">#从本行开始关闭回显。一般批处理第一行都是这个</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> on                  <span class="token comment">#从下一行开始打开回显</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span>                      <span class="token comment">#显示当前是 echo off 状态还是 echo on 状态</span>
</code></pre> 
<pre><code class="prism language-bash">echo.                     <span class="token comment">#输出一个”回车换行”，空白行</span>
                             <span class="token comment">#(同echo, echo; echo+ echo[ echo] echo/ echo\)</span>
</code></pre> 
<ol start="2"><li><code>errorlevel</code></li></ol> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> %errorlevel%

每个命令运行结束，可以用这个命令行格式查看返回码

默认值为0，一般命令执行出错会设 errorlevel 为1
</code></pre> 
<ol start="3"><li><code>dir</code></li></ol> 
<pre><code class="prism language-bash"><span class="token function">dir</span>                       <span class="token comment">#显示当前目录中的文件和子目录</span>

<span class="token function">dir</span> /a                    <span class="token comment">#显示当前目录中的文件和子目录，包括隐藏文件和系统文件</span>

<span class="token function">dir</span> c: /a:d              <span class="token comment">#显示 C 盘当前目录中的目录</span>

<span class="token function">dir</span> c: /a:-d             <span class="token comment">#显示 C 盘根目录中的文件</span>

<span class="token function">dir</span> c:<span class="token punctuation">\</span> /b/p             <span class="token comment">#/b只显示文件名，/p分页显示</span>

<span class="token function">dir</span> *.exe /s             <span class="token comment">#显示当前目录和子目录里所有的.exe文件</span>
</code></pre> 
<ol start="4"><li><code>cd</code></li></ol> 
<pre><code class="prism language-bash">cd<span class="token punctuation">\</span>                       <span class="token comment">#进入根目录</span>

<span class="token builtin class-name">cd</span>                        <span class="token comment">#显示当前目录</span>

<span class="token builtin class-name">cd</span> /d d:<span class="token punctuation">\</span>sdk            <span class="token comment">#可以同时更改盘符和目录</span>
</code></pre> 
<ol start="5"><li><code>md</code></li></ol> 
<pre><code class="prism language-bash">md d:<span class="token punctuation">\</span>a<span class="token punctuation">\</span>b<span class="token punctuation">\</span>c               <span class="token comment">#如果 d:\a 不存在，将会自动创建中级目录</span>

<span class="token comment">#如果命令扩展名被停用，则需要键入 mkdir \a\b\c。</span>
</code></pre> 
<ol start="6"><li><code>rd</code></li></ol> 
<pre><code class="prism language-bash">rd abc                    <span class="token comment">#删除当前目录里的 abc 子目录，要求为空目录</span>

rd /s/q d:<span class="token punctuation">\</span>temp         <span class="token comment">#删除 d:\temp 文件夹及其子文件夹和文件，/q安静模式</span>
</code></pre> 
<ol start="7"><li><code>del</code></li></ol> 
<pre><code class="prism language-bash">del d:<span class="token punctuation">\</span>test.txt            <span class="token comment">#删除指定文件，不能是隐藏、系统、只读文件</span>

del /q/a/f d:<span class="token punctuation">\</span>temp<span class="token punctuation">\</span>*.*   <span class="token comment">#删除 d:\temp 文件夹里面的所有文件，包括隐藏、只读、系统文件，不包括子目录</span>

del /q/a/f/s d:<span class="token punctuation">\</span>temp<span class="token punctuation">\</span>*.*   <span class="token comment">#删除 d:\temp 及子文件夹里面的所有文件，包括隐藏、只读、系统文件，不包括子目录</span>
</code></pre> 
<ol start="8"><li><code>ren</code></li></ol> 
<pre><code class="prism language-bash">ren d:<span class="token punctuation">\</span>temp tmp           <span class="token comment">#支持对文件夹的重命名</span>
</code></pre> 
<ol start="9"><li><code>cls</code></li></ol> 
<pre><code class="prism language-bash">清屏
</code></pre> 
<ol start="10"><li><code>type</code></li></ol> 
<pre><code class="prism language-bash">显示文件内容

<span class="token builtin class-name">type</span> c:<span class="token punctuation">\</span>boot.ini          <span class="token comment">#显示指定文件的内容，程序文件一般会显示乱码</span>

<span class="token builtin class-name">type</span> *.txt                <span class="token comment">#显示当前目录里所有.txt文件的内容</span>
</code></pre> 
<ol start="11"><li><code>copy</code></li></ol> 
<pre><code class="prism language-bash">拷贝文件

copy c:<span class="token punctuation">\</span>test.txt d:<span class="token punctuation">\</span>test.bak

复制 c:<span class="token punctuation">\</span>test.txt 文件到 d:<span class="token punctuation">\</span> ，并重命名为 test.bak

copy con test.txt

从屏幕上等待输入，按 Ctrl+Z 结束输入，输入内容存为test.txt文件

con代表屏幕，prn代表打印机，nul代表空设备

copy <span class="token number">1</span>.txt + <span class="token number">2</span>.txt <span class="token number">3</span>.txt

合并 <span class="token number">1</span>.txt 和 <span class="token number">2</span>.txt 的内容，保存为 <span class="token number">3</span>.txt 文件

如果不指定 <span class="token number">3</span>.txt ，则保存到 <span class="token number">1</span>.txt

copy test.txt +

复制文件到自己，实际上是修改了文件日期
</code></pre> 
<ol start="12"><li><code>title</code></li></ol> 
<pre><code class="prism language-bash">设置cmd窗口的标题

title 新标题              <span class="token comment">#可以看到cmd窗口的标题栏变了</span>
</code></pre> 
<ol start="13"><li><code>ver</code></li></ol> 
<pre><code class="prism language-bash">显示系统版本
</code></pre> 
<ol start="14"><li><code>label 和 vol</code></li></ol> 
<pre><code class="prism language-bash">设置卷标

vol                       <span class="token comment">#显示卷标</span>

label                     <span class="token comment">#显示卷标，同时提示输入新卷标</span>

label c:system        <span class="token comment">#设置C盘的卷标为 system</span>
</code></pre> 
<ol start="15"><li><code>pause</code></li></ol> 
<pre><code class="prism language-bash">暂停命令
</code></pre> 
<ol start="16"><li><code>rem 和 ::</code></li></ol> 
<pre><code class="prism language-bash">注释命令

注释行不执行操作
</code></pre> 
<ol start="17"><li><code>date 和 time</code></li></ol> 
<pre><code class="prism language-bash">日期和时间

<span class="token function">date</span>                <span class="token comment">#显示当前日期，并提示输入新日期，按\"回车\"略过输入</span>

<span class="token function">date</span> /t              <span class="token comment">#只显示当前日期，不提示输入新日期</span>

<span class="token function">time</span>                <span class="token comment">#显示当前时间，并提示输入新时间，按\"回车\"略过输入</span>

<span class="token function">time</span> /t              <span class="token comment">#只显示当前时间，不提示输入新时间</span>
</code></pre> 
<ol start="18"><li><code>goto 和 :</code></li></ol> 
<pre><code class="prism language-bash">跳转命令

:label              <span class="token comment">#行首为:表示该行是标签行，标签行不执行操作</span>

goto label        <span class="token comment">#跳转到指定的标签那一行</span>
</code></pre> 
<ol start="19"><li><code>find (外部命令)</code></li></ol> 
<pre><code class="prism language-bash">查找命令

<span class="token function">find</span> <span class="token punctuation">\</span>"abc<span class="token punctuation">\</span>" c:<span class="token punctuation">\</span>test.txt

在 c:<span class="token punctuation">\</span>test.txt 文件里查找含 abc 字符串的行

如果找不到，将设 errorlevel 返回码为1

<span class="token function">find</span> /i “abc” c:<span class="token punctuation">\</span>test.txt

查找含 abc 的行，忽略大小写

<span class="token function">find</span> /c <span class="token punctuation">\</span>"abc<span class="token punctuation">\</span>" c:<span class="token punctuation">\</span>test.txt

显示含 abc 的行的行数
</code></pre> 
<ol start="20"><li><code>more (外部命令)</code></li></ol> 
<pre><code class="prism language-bash">逐屏显示

<span class="token function">more</span> c:<span class="token punctuation">\</span>test.txt          <span class="token comment">#逐屏显示 c:\test.txt 的文件内容</span>
</code></pre> 
<ol start="21"><li><code>tree</code></li></ol> 
<pre><code class="prism language-bash">显示目录结构

tree d:<span class="token punctuation">\</span>                  <span class="token comment">#显示D盘的文件目录结构</span>
</code></pre> 
<ol start="22"><li><code>&amp;</code></li></ol> 
<pre><code class="prism language-bash">顺序执行多条命令，而不管命令是否执行成功
</code></pre> 
<ol start="23"><li><code>&amp;&amp;</code></li></ol> 
<pre><code class="prism language-bash">顺序执行多条命令，当碰到执行出错的命令后将不执行后面的命令

<span class="token function">find</span> <span class="token punctuation">\</span>"ok<span class="token punctuation">\</span>" c:<span class="token punctuation">\</span>test.txt <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> 成功

如果找到了<span class="token punctuation">\</span>"ok<span class="token punctuation">\</span>"字样，就显示<span class="token punctuation">\</span>"成功<span class="token punctuation">\</span>"，找不到就不显示
</code></pre> 
<ol start="24"><li><code>||</code></li></ol> 
<pre><code class="prism language-bash">顺序执行多条命令，当碰到执行正确的命令后将不执行后面的命令

<span class="token function">find</span> <span class="token punctuation">\</span>"ok<span class="token punctuation">\</span>" c:<span class="token punctuation">\</span>test.txt <span class="token operator">||</span> <span class="token builtin class-name">echo</span> 不成功

如果找不到<span class="token punctuation">\</span>"ok<span class="token punctuation">\</span>"字样，就显示<span class="token punctuation">\</span>"不成功<span class="token punctuation">\</span>"，找到了就不显示
</code></pre> 
<ol start="25"><li><code>|</code></li></ol> 
<pre><code class="prism language-bash">管道命令

<span class="token function">dir</span> *.* /s/a <span class="token operator">|</span> <span class="token function">find</span> /c <span class="token punctuation">\</span>".exe<span class="token punctuation">\</span>"

管道命令表示先执行 <span class="token function">dir</span> 命令，对其输出的结果执行后面的 <span class="token function">find</span> 命令

该命令行结果：输出当前文件夹及所有子文件夹里的.exe文件的个数

<span class="token builtin class-name">type</span> c:<span class="token punctuation">\</span>test.txt<span class="token operator">|</span><span class="token function">more</span>

这个和 <span class="token function">more</span> c:<span class="token punctuation">\</span>test.txt 的效果是一样的
</code></pre> 
<ol start="26"><li><code>&gt; 和 &gt;&gt;</code></li></ol> 
<pre><code class="prism language-bash">输出重定向命令

<span class="token operator">&gt;</span> 清除文件中原有的内容后再写入

<span class="token operator">&gt;&gt;</span> 追加内容到文件末尾，而不会清除原有的内容

主要将本来显示在屏幕上的内容输出到指定文件中

指定文件如果不存在，则自动生成该文件

<span class="token builtin class-name">type</span> c:<span class="token punctuation">\</span>test.txt <span class="token operator">&gt;</span>prn

屏幕上不显示文件内容，转向输出到打印机

<span class="token builtin class-name">echo</span> hello world<span class="token operator">&gt;</span>con

在屏幕上显示hello world，实际上所有输出都是默认 <span class="token operator">&gt;</span>con 的

copy c:<span class="token punctuation">\</span>test.txt f: <span class="token operator">&gt;</span>nul

拷贝文件，并且不显示<span class="token punctuation">\</span>"文件复制成功<span class="token punctuation">\</span>"的提示信息，但如果f盘不存在，还是会显示出错信息

copy c:<span class="token punctuation">\</span>test.txt f: <span class="token operator">&gt;</span>nul <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>nul

不显示”文件复制成功”的提示信息，并且f盘不存在的话，也不显示错误提示信息Echo ^^W ^<span class="token operator">&gt;</span> ^W<span class="token operator">&gt;</span>c:<span class="token punctuation">\</span>test.txt

生成的文件内容为 ^W <span class="token operator">&gt;</span> W

^ 和 <span class="token operator">&gt;</span> 是控制命令，要把它们输出到文件，必须在前面加个 ^ 符号
</code></pre> 
<ol start="27"><li><code>&lt;</code></li></ol> 
<pre><code class="prism language-bash">从文件中获得输入信息，而不是从屏幕上

一般用于 <span class="token function">date</span> <span class="token function">time</span> label 等需要等待输入的命令

@echo off

<span class="token builtin class-name">echo</span> <span class="token number">2005</span>-05-0<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>temp.txt

<span class="token function">date</span> <span class="token operator">&lt;</span>temp.txt

del temp.txt

这样就可以不等待输入直接修改当前日期
</code></pre> 
<ol start="28"><li><code>%0 %1 %2 %3 %4 %5 %6 %7 %8 %9 %*</code></li></ol> 
<p>命令行传递给批处理的参数</p> 
<p><strong><code>%0</code> 批处理文件本身</strong></p> 
<p><strong><code>%1</code> 第一个参数</strong></p> 
<p><strong><code>%9</code> 第九个参数</strong></p> 
<p><strong><code>%*</code> 从第一个参数开始的所有参数</strong></p> 
<p>批参数(%n)的替代已被增强。您可以使用以下语法:</p> 
<pre><code class="prism language-bash"> 	  %~1               - 删除引号<span class="token punctuation">(</span><span class="token punctuation">\</span>"<span class="token punctuation">)</span>，扩充 %1

      %~f1              - 将 %1 扩充到一个完全合格的路径名

      %~d1              - 仅将 %1 扩充到一个驱动器号

      %~p1              - 仅将 %1 扩充到一个路径

      %~n1              - 仅将 %1 扩充到一个文件名

      %~x1              - 仅将 %1 扩充到一个文件扩展名

      %~s1              - 扩充的路径指含有短名

      %~a1              - 将 %1 扩充到文件属性

      %~t1              - 将 %1 扩充到文件的日期/时间

      %~z1              - 将 %1 扩充到文件的大小

      %~<span class="token environment constant">$PATH</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> - 查找列在 <span class="token environment constant">PATH</span> 环境变量的目录，并将 %1

                    扩充到找到的第一个完全合格的名称。如果环境

                    变量名未被定义，或者没有找到文件，此组合键会

                    扩充到空字符串
</code></pre> 
<p>可以组合修定符来取得多重结果:</p> 
<pre><code>     %~dp1             - 只将 %1 扩展到驱动器号和路径

     %~nx1             - 只将 %1 扩展到文件名和扩展名

     %~dp$PATH:1 - 在列在 PATH 环境变量中的目录里查找 %1，

                    并扩展到找到的第一个文件的驱动器号和路径。

     %~ftza1           - 将 %1 扩展到类似 DIR 的输出行。
</code></pre> 
<p>可以参照 call/? 或 for/? 看出每个参数的含意</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> load <span class="token punctuation">\</span>"%%1<span class="token punctuation">\</span>" <span class="token punctuation">\</span>"%%2<span class="token punctuation">\</span>"<span class="token operator">&gt;</span>c:<span class="token punctuation">\</span>test.txt
</code></pre> 
<p>生成的文件内容为 <code>load \"%1\" \"%2\"</code></p> 
<p>批处理文件里，用这个格式把命令行参数输出到文件</p> 
<ol start="29"><li><code>if</code></li></ol> 
<pre><code class="prism language-bash">判断命令

<span class="token keyword">if</span> <span class="token punctuation">\</span>"%1<span class="token punctuation">\</span>"<span class="token operator">==</span><span class="token punctuation">\</span>"/a<span class="token punctuation">\</span>" <span class="token builtin class-name">echo</span> 第一个参数是/a

<span class="token keyword">if</span> /i <span class="token punctuation">\</span>"%1<span class="token punctuation">\</span>" equ <span class="token punctuation">\</span>"/a<span class="token punctuation">\</span>" <span class="token builtin class-name">echo</span> 第一个参数是/a

/i 表示不区分大小写，equ 和 <span class="token operator">==</span> 是一样的，其它运算符参见 if/?

<span class="token keyword">if</span> exist c:<span class="token punctuation">\</span>test.bat <span class="token builtin class-name">echo</span> 存在c:<span class="token punctuation">\</span>test.bat文件

<span class="token keyword">if</span> not exist c:<span class="token punctuation">\</span>windows <span class="token punctuation">(</span>

          <span class="token builtin class-name">echo</span> 不存在c:<span class="token punctuation">\</span>windows文件夹

          <span class="token punctuation">)</span>

<span class="token keyword">if</span> exist c:<span class="token punctuation">\</span>test.bat <span class="token punctuation">(</span> <span class="token builtin class-name">echo</span> 存在c:<span class="token punctuation">\</span>test.bat <span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">(</span>  <span class="token builtin class-name">echo</span> 不存在c:<span class="token punctuation">\</span>test.bat  <span class="token punctuation">)</span>
</code></pre> 
<ol start="30"><li><code>setlocal 和 endlocal</code></li></ol> 
<p>设置”<code>命令扩展名</code>”和”<code>延缓环境变量扩充</code>”</p> 
<pre><code class="prism language-bash">SETLOCAL ENABLEEXTENSIONS                  <span class="token comment">#启用\"命令扩展名\"</span>

SETLOCAL DISABLEEXTENSIONS                 <span class="token comment">#停用\"命令扩展名\"</span>

SETLOCAL ENABLEDELAYEDEXPANSION            <span class="token comment">#启用\"延缓环境变量扩充\"</span>

SETLOCAL DISABLEDELAYEDEXPANSION           <span class="token comment">#停用\"延缓环境变量扩充\"</span>

ENDLOCAL                                   <span class="token comment">#恢复到使用SETLOCAL语句以前的状态</span>
</code></pre> 
<p><strong>“命令扩展名”默认为启用</strong></p> 
<p><strong>“延缓环境变量扩充”默认为停用</strong></p> 
<p><strong>批处理结束系统会自动恢复默认值</strong></p> 
<p>可以修改注册表以禁用"命令扩展名"，详见 <code>cmd /?</code> 。所以用到"命令扩展名"的程序，建议在开头和结尾加上 <code>SETLOCAL ENABLEEXTENSIONS</code> 和 <code>ENDLOCAL</code> 语句，以确保程序能在其它系统上正确运行"<code>延缓环境变量扩充</code>"主要用于 <code>if</code> 和 <code>for</code> 的符合语句，在 set 的说明里有其实用例程</p> 
<ol start="31"><li><code>set</code></li></ol> 
<p><strong>设置变量</strong></p> 
<p>引用变量可在变量名前后加 % ，即 <code>%变量名%</code></p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">set</span>                          <span class="token comment">#显示目前所有可用的变量，包括系统变量和自定义的变量</span>

<span class="token builtin class-name">echo</span> %SystemDrive%           <span class="token comment">#显示系统盘盘符。系统变量可以直接引用</span>

<span class="token builtin class-name">set</span> p                        <span class="token comment">#显示所有以p开头的变量，要是一个也没有就设errorlevel=1</span>

<span class="token builtin class-name">set</span> <span class="token assign-left variable">p</span><span class="token operator">=</span>aa1bb1aa2bb2           <span class="token comment">#设置变量p，并赋值为 = 后面的字符串，即aa1bb1aa2bb2</span>

<span class="token builtin class-name">echo</span> %p%                     <span class="token comment">#显示变量p代表的字符串，即aa1bb1aa2bb2</span>

<span class="token builtin class-name">echo</span> %p:~6%                  <span class="token comment">#显示变量p中第6个字符以后的所有字符，即aa2bb2</span>

<span class="token builtin class-name">echo</span> %p:~6,3%                <span class="token comment">#显示第6个字符以后的3个字符，即aa2</span>

<span class="token builtin class-name">echo</span> %p:~0,3%                <span class="token comment">#显示前3个字符，即aa1</span>

<span class="token builtin class-name">echo</span> %p:~-2%                 <span class="token comment">#显示最后面的2个字符，即b2</span>

<span class="token builtin class-name">echo</span> %p:~0,-2%               <span class="token comment">#显示除了最后2个字符以外的其它字符，即aa1bb1aa2b</span>

<span class="token builtin class-name">echo</span> %p:aa<span class="token operator">=</span>c%                <span class="token comment">#用c替换变量p中所有的aa，即显示c1bb1c2bb2</span>

<span class="token builtin class-name">echo</span> %p:aa<span class="token operator">=</span>%                 <span class="token comment">#将变量p中的所有aa字符串置换为空，即显示1bb12bb2</span>

<span class="token builtin class-name">echo</span> %p:*bb<span class="token operator">=</span>c%               <span class="token comment">#第一个bb及其之前的所有字符被替换为c，即显示c1aa2bb2</span>

<span class="token builtin class-name">set</span> <span class="token assign-left variable">p</span><span class="token operator">=</span>%p:*bb<span class="token operator">=</span>c%              <span class="token comment">#设置变量p，赋值为 %p:*bb=c% ，即c1aa2bb2</span>

<span class="token builtin class-name">set</span> /a <span class="token assign-left variable">p</span><span class="token operator">=</span><span class="token number">39</span>                  <span class="token comment">#设置p为数值型变量，值为39</span>

<span class="token builtin class-name">set</span> /a <span class="token assign-left variable">p</span><span class="token operator">=</span><span class="token number">39</span>/10               <span class="token comment">#支持运算符，有小数时用去尾法，39/10=3.9，去尾得3，p=3</span>

<span class="token builtin class-name">set</span> /a <span class="token assign-left variable">p</span><span class="token operator">=</span>p/10                <span class="token comment">#用 /a 参数时，在 = 后面的变量可以不加%直接引用</span>

<span class="token builtin class-name">set</span> /a <span class="token assign-left variable">p</span><span class="token operator">=</span>”1<span class="token operator">&amp;</span><span class="token number">0</span>″               <span class="token comment">#”与”运算，要加引号。其它支持的运算符参见set/?</span>

<span class="token builtin class-name">set</span> <span class="token assign-left variable">p</span><span class="token operator">=</span>                       <span class="token comment">#取消p变量</span>

<span class="token builtin class-name">set</span> /p <span class="token assign-left variable">p</span><span class="token operator">=</span>请输入
</code></pre> 
<p>屏幕上显示”请输入”，并会将输入的字符串赋值给变量p</p> 
<p>注意这条可以用来<code>取代 choice 命令</code></p> 
<p>注意变量在 <code>if</code> 和 <code>for</code> 的复合语句里是<strong>一次性全部替换</strong>的，如</p> 
<pre><code class="prism language-bash">@echo off

<span class="token builtin class-name">set</span> <span class="token assign-left variable">p</span><span class="token operator">=</span>aaa

<span class="token keyword">if</span> %p%<span class="token operator">==</span>aaa <span class="token punctuation">(</span>

          <span class="token builtin class-name">echo</span> %p%

          <span class="token builtin class-name">set</span> <span class="token assign-left variable">p</span><span class="token operator">=</span>bbb

          <span class="token builtin class-name">echo</span> %p%

          <span class="token punctuation">)</span>
</code></pre> 
<p>结果将显示</p> 
<pre><code class="prism language-bash">aaa

aaa
</code></pre> 
<p>因为在读取 <code>if</code> 语句时已经将所有 <code>%p%</code> 替换为aaa</p> 
<p>这里的"替换"，在 <code>/?</code> 帮助里就是指"扩充"、“环境变量扩充”</p> 
<p>可以启用”<code>延缓环境变量扩充”</code>，用 ! 来引用变量，即 !变量名!</p> 
<pre><code class="prism language-bash">@echo off

SETLOCAL ENABLEDELAYEDEXPANSION

<span class="token builtin class-name">set</span> <span class="token assign-left variable">p</span><span class="token operator">=</span>aaa

<span class="token keyword">if</span> %p%<span class="token operator">==</span>aaa <span class="token punctuation">(</span>

          <span class="token builtin class-name">echo</span> %p%

          <span class="token builtin class-name">set</span> <span class="token assign-left variable">p</span><span class="token operator">=</span>bbb

          <span class="token builtin class-name">echo</span> <span class="token operator">!</span>p<span class="token operator">!</span>

          <span class="token punctuation">)</span>

ENDLOCAL
</code></pre> 
<p>结果将显示</p> 
<pre><code class="prism language-bash">aaa

bbb
</code></pre> 
<p>还有几个<code>动态变量</code>，运行 <code>set</code> 看不到</p> 
<pre><code class="prism language-bash">%CD%                        <span class="token comment">#代表当前目录的字符串</span>

%DATE%                      <span class="token comment">#当前日期</span>

%TIME%                      <span class="token comment">#当前时间</span>

%<span class="token environment constant">RANDOM</span>%                    <span class="token comment">#随机整数，介于0~32767</span>

%ERRORLEVEL%                <span class="token comment">#当前 ERRORLEVEL 值</span>

%CMDEXTVERSION%             <span class="token comment">#当前命令处理器扩展名版本号</span>

%CMDCMDLINE%                <span class="token comment">#调用命令处理器的原始命令行</span>
</code></pre> 
<p>可以用echo命令查看每个变量值，如 echo %time%</p> 
<p>注意 %time% 精确到毫秒，在批处理需要延时处理时可以用到</p> 
<ol start="32"><li><code>start</code></li></ol> 
<pre><code class="prism language-bash">批处理中调用外部程序的命令，否则等外部程序完成后才继续执行剩下的指令
</code></pre> 
<ol start="33"><li><code>call</code></li></ol> 
<pre><code class="prism language-bash">批处理中调用另外一个批处理的命令，否则剩下的批处理指令将不会被执行

有时有的应用程序用<span class="token variable"><span class="token variable">`</span>start<span class="token variable">`</span></span>调用出错的，也可以<span class="token variable"><span class="token variable">`</span>call<span class="token variable">`</span></span>调用
</code></pre> 
<ol start="34"><li><code>choice (外部命令)</code></li></ol> 
<pre><code class="prism language-bash">选择命令

让用户输入一个字符，从而选择运行不同的命令，返回码errorlevel为1234……

win98里是choice.com

win2000pro里没有，可以从win98里拷过来

win2003里是choice.exe

choice /N /C y /T <span class="token number">5</span> /D y<span class="token operator">&gt;</span>nul

延时5秒
</code></pre> 
<ol start="35"><li><code>assoc 和 ftype</code></li></ol> 
<p><strong>文件关联</strong></p> 
<pre><code class="prism language-powershell">assoc 设置<span class="token string">'文件扩展名'</span>关联，关联到<span class="token string">'文件类型'</span>
</code></pre> 
<p><code>ftype</code> 设置’<strong>文件类型</strong>’关联，关联到’<strong>执行程序和参数</strong>’</p> 
<p>当你双击一个.txt文件时，windows并不是根据.txt直接判断用 <strong>notepad.exe</strong> 打开</p> 
<p>而是先判断<code>.txt</code>属于 <code>txtfile '</code>文件类型’</p> 
<p>再调用 <code>txtfile</code> 关联的命令行 <code>txtfile=%SystemRoot%\system32\NOTEPAD.EXE %1</code></p> 
<p>可以在"文件夹选项"→"文件类型"里修改这2种关联</p> 
<pre><code class="prism language-bash">assoc                 <span class="token comment">#显示所有'文件扩展名'关联</span>

assoc .txt            <span class="token comment">#显示.txt代表的'文件类型'，结果显示 .txt=txtfile</span>

assoc .doc            <span class="token comment">#显示.doc代表的'文件类型'，结果显示 .doc=Word.Document.8</span>

assoc .exe            <span class="token comment">#显示.exe代表的'文件类型'，结果显示 .exe=exefile</span>

ftype                 <span class="token comment">#显示所有'文件类型'关联</span>

ftype exefile         <span class="token comment">#显示exefile类型关联的命令行，结果显示 exefile=\"%1\" %*</span>

assoc .txt<span class="token operator">=</span>Word.Document.8

设置.txt为word类型的文档，可以看到.txt文件的图标都变了

assoc .txt<span class="token operator">=</span>txtfile

恢复.txt的正确关联

ftype <span class="token assign-left variable">exefile</span><span class="token operator">=</span><span class="token punctuation">\</span>"%1<span class="token punctuation">\</span>" %*

恢复 exefile 的正确关联

如果该关联已经被破坏，可以运行 command.com ，再输入这条命令
</code></pre> 
<ol start="36"><li><code>pushd 和 popd</code></li></ol> 
<pre><code class="prism language-bash">切换当前目录

@echo off

c: <span class="token operator">&amp;</span> cd<span class="token punctuation">\</span> <span class="token operator">&amp;</span> md mp3             <span class="token comment">#在 C:\ 建立 mp3 文件夹</span>

md d:<span class="token punctuation">\</span>mp4                     <span class="token comment">#在 D:\ 建立 mp4 文件夹</span>

<span class="token builtin class-name">cd</span> /d d:<span class="token punctuation">\</span>mp4                  <span class="token comment">#更改当前目录为 d:\mp4</span>

<span class="token function">pushd</span> c:<span class="token punctuation">\</span>mp3                  <span class="token comment">#保存当前目录，并切换当前目录为 c:\mp3</span>

<span class="token function">popd</span>                          <span class="token comment">#恢复当前目录为刚才保存的 d:\mp4</span>
</code></pre> 
<ol start="37"><li><code>for</code></li></ol> 
<p>循环命令</p> 
<p>这个比较复杂，请对照 for/? 来看</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> %%i <span class="token keyword">in</span> <span class="token punctuation">(</span>c: d: e: f:<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> %%i
</code></pre> 
<p>依次调用小括号里的每个字符串，执行 do 后面的命令</p> 
<p>注意%%i，在批处理中 for 语句调用参数用2个%</p> 
<p>默认的字符串分隔符是"<code>空格键</code>"，"<code>Tab键</code>"，"<code>回车键</code>"</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> %%i <span class="token keyword">in</span> <span class="token punctuation">(</span>*.txt<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">find</span> <span class="token punctuation">\</span>"abc<span class="token punctuation">\</span>" %%i
</code></pre> 
<p>对当前目录里所有的txt文件执行 find 命令</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> /r <span class="token builtin class-name">.</span> %%i <span class="token keyword">in</span> <span class="token punctuation">(</span>*.txt<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">find</span> <span class="token punctuation">\</span>"abc<span class="token punctuation">\</span>" %%i
</code></pre> 
<p>在当前目录和子目录里所有的<code>.txt</code>文件中搜索包含 <code>abc</code> 字符串的行</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> /r <span class="token builtin class-name">.</span> %%i <span class="token keyword">in</span> <span class="token punctuation">(</span>.<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> %%~pni
</code></pre> 
<p>显示当前目录名和所有子目录名，包括路径，不包括盘符</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> /r d:<span class="token punctuation">\</span>mp3 %%i <span class="token keyword">in</span> <span class="token punctuation">(</span>*.mp3<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> %%i<span class="token operator">&gt;&gt;</span>d:<span class="token punctuation">\</span>mp3.txt
</code></pre> 
<p>把 <code>d:\mp3</code> 及其子目录里的<code>mp3</code>文件的文件名都存到 <code>d:\mp3.txt</code> 里去</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> /l %%i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">2,1</span>,8<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> %%i
</code></pre> 
<p>生成2345678的一串数字，2是数字序列的开头，8是结尾，1表示每次加1</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> /f %%i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'set'</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> %%i
</code></pre> 
<p>对 set 命令的输出结果循环调用，每行一个</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> /f <span class="token punctuation">\</span>"eol<span class="token operator">=</span>P<span class="token punctuation">\</span>" %%i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'set'</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> %%i
</code></pre> 
<p>取 set 命令的输出结果，忽略以 P 开头的那几行</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> /f %%i <span class="token keyword">in</span> <span class="token punctuation">(</span>d:<span class="token punctuation">\</span>mp3.txt<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> %%i
</code></pre> 
<p>显示 <code>d:\mp3.txt</code> 里的每个文件名，每行一个，不支持带空格的名称</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> /f <span class="token punctuation">\</span>"delims<span class="token operator">=</span><span class="token punctuation">\</span>" %%i <span class="token keyword">in</span> <span class="token punctuation">(</span>d:<span class="token punctuation">\</span>mp3.txt<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> %%i
</code></pre> 
<p>显示 <code>d:\mp3.txt</code> 里的每个文件名，每行一个，支持带空格的名称</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> /f <span class="token punctuation">\</span>"skip<span class="token operator">=</span><span class="token number">5</span> <span class="token assign-left variable">tokens</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">\</span>" %%a <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'dir'</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> %%a
</code></pre> 
<p>对 <code>dir</code> 命令的结果，跳过前面5行，余下的每行取第4列</p> 
<p>每列之间的分隔符为默认的"<code>空格</code>"</p> 
<p>可以注意到 <code>dir</code> 命令输出的前5行是没有文件名的</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> /f <span class="token punctuation">\</span>"tokens<span class="token operator">=</span><span class="token number">1,2</span>,3 <span class="token assign-left variable">delims</span><span class="token operator">=</span>- <span class="token punctuation">\</span>" %%a <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'date /t'</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>

          <span class="token builtin class-name">echo</span> %%a

          <span class="token builtin class-name">echo</span> %%b

          <span class="token builtin class-name">echo</span> %%c

          <span class="token punctuation">)</span>
</code></pre> 
<p>对 <code>date /t</code> 的输出结果，每行取<code>1、2、3</code>列</p> 
<p>第一列对应指定的 <code>%%a</code> ，后面的 <code>%%b</code> 和 <code>%%c</code> 是派生出来的，对应其它列</p> 
<p>分隔符指定为 - 和"<code>空格</code>"，注意 <code>delims=-</code> 后面有个"<code>空格</code>"</p> 
<p>其中 <code>tokens=1,2,3</code> 若用 <code>tokens=1-3</code> 替换，效果是一样的</p> 
<pre><code class="prism language-bash"><span class="token keyword">for</span> /f <span class="token punctuation">\</span>"tokens<span class="token operator">=</span><span class="token number">2</span>* <span class="token assign-left variable">delims</span><span class="token operator">=</span>- <span class="token punctuation">\</span>" %%a <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'date /t'</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> %%b
</code></pre> 
<p>取第2列给 %%a ，其后的列都给 %%b</p> 
<ol start="32"><li><code>subst (外部命令)</code></li></ol> 
<p><strong>映射磁盘。</strong></p> 
<pre><code class="prism language-bash">subst z: <span class="token punctuation">\</span>server<span class="token punctuation">\</span>d           <span class="token comment">#这样输入z:就可以访问\server\d了</span>

subst z: /d                   <span class="token comment">#取消该映射</span>

subst                         <span class="token comment">#显示目前所有的映时</span>
</code></pre> 
<ol start="38"><li><code>xcopy (外部命令)</code></li></ol> 
<p><strong>文件拷贝</strong></p> 
<pre><code class="prism language-bash">xcopy d:<span class="token punctuation">\</span>mp3 e:<span class="token punctuation">\</span>mp3 /s/e/i/y
</code></pre> 
<p>复制 d:\mp3 文件夹、所有</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b0556d91366bd471f51a48d0fbfc344f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python-货币转换</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c4039d2dc77464cbc1b9dfb001c199b4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【静态时序分析】如何寻找时序分析的起点与终点</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>