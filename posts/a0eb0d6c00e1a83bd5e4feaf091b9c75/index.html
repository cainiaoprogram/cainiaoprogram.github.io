<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>银联 php hex2bin,php 实现银联商务H5支付 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="银联 php hex2bin,php 实现银联商务H5支付" />
<meta property="og:description" content="银联商务H5支付接口文档：文档地址
一：H5支付的接口地址:
1：支付宝支付
测试地址：http://58.247.0.18:29015/v1/netpay/trade/h5-pay
2：银联支付
测试地址：http://58.247.0.18:29015/v1/netpay/uac/order
二：接口需要的基本参数
接口使用的是get传参，直接将接口参数放到接口地址后,此接口是由浏览器直接跳转到接口
(1)authorization
认证方式，直接填入：OPEN-FORM-PARAM
(2)appId
银联商务用户H5支付产品的AppID
(3)timestamp
时间戳，格式为yyyyMMddHHmmss，如20191001121212
(4)nonce
随机数
(5)content
业务内容，为json格式，并且需要进行url编码，内部的具体信息下面介绍
(6)signature
签名,需要进行url编码,具体生成方式如：Base64_Encode(HmacSHA256(appId &#43; timestamp &#43; nonce &#43; SHA256_HEX(content), AppKey))
业务内容content参数内部具体参数说明：
1：requestTimestamp
报文请求时间，格式为yyyy-MM-dd HH:mm:ss，如2019-10-01 12:12:12
2：merOrderId
商户自己生成的订单号，这里注意：我们需要在我们自己生成的订单号前面加上1017前缀
3：mid
银联商务用户H5支付产品的商户号
4：tid
银联商务用户H5支付产品的终端号
5：instMid
业务类型，直接填入：H5DEFAULT
6：totalAmount
支付总金额，单位为分
7：expireTime
订单过期时间，格式为yyyy-MM-dd HH:mm:ss，如2019-10-02 12:12:12
8：notifyUrl
支付结果通知地址
9：returnUrl
网页跳转地址
三：H5支付的支付宝支付实例
$appId = &#39;10037e6f6a4e6da4016a670fd4530012&#39;;
$appKey = &#39;f7a74b6c02ae4e1e94aaba311c04acf2&#39;;
$mid = &#39;898310148160568&#39;;
$tid = &#39;88880001&#39;;
//业务内容
$time = time();
$content = [" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a0eb0d6c00e1a83bd5e4feaf091b9c75/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-10T00:03:09+08:00" />
<meta property="article:modified_time" content="2021-03-10T00:03:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">银联 php hex2bin,php 实现银联商务H5支付</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>银联商务H5支付接口文档：文档地址</p> 
 <p>一：H5支付的接口地址:</p> 
 <p>1：支付宝支付</p> 
 <p>测试地址：http://58.247.0.18:29015/v1/netpay/trade/h5-pay</p> 
 <p>2：银联支付</p> 
 <p>测试地址：http://58.247.0.18:29015/v1/netpay/uac/order</p> 
 <p>二：接口需要的基本参数</p> 
 <p>接口使用的是get传参，直接将接口参数放到接口地址后,此接口是由浏览器直接跳转到接口</p> 
 <p>(1)authorization</p> 
 <p>认证方式，直接填入：OPEN-FORM-PARAM</p> 
 <p>(2)appId</p> 
 <p>银联商务用户H5支付产品的AppID</p> 
 <p>(3)timestamp</p> 
 <p>时间戳，格式为yyyyMMddHHmmss，如20191001121212</p> 
 <p>(4)nonce</p> 
 <p>随机数</p> 
 <p>(5)content</p> 
 <p>业务内容，为json格式，并且需要进行url编码，内部的具体信息下面介绍</p> 
 <p>(6)signature</p> 
 <p>签名,需要进行url编码,具体生成方式如：Base64_Encode(HmacSHA256(appId + timestamp + nonce + SHA256_HEX(content), AppKey))</p> 
 <p>业务内容content参数内部具体参数说明：</p> 
 <p>1：requestTimestamp</p> 
 <p>报文请求时间，格式为yyyy-MM-dd HH:mm:ss，如2019-10-01 12:12:12</p> 
 <p>2：merOrderId</p> 
 <p>商户自己生成的订单号，这里注意：我们需要在我们自己生成的订单号前面加上1017前缀</p> 
 <p>3：mid</p> 
 <p>银联商务用户H5支付产品的商户号</p> 
 <p>4：tid</p> 
 <p>银联商务用户H5支付产品的终端号</p> 
 <p>5：instMid</p> 
 <p>业务类型，直接填入：H5DEFAULT</p> 
 <p>6：totalAmount</p> 
 <p>支付总金额，单位为分</p> 
 <p>7：expireTime</p> 
 <p>订单过期时间，格式为yyyy-MM-dd HH:mm:ss，如2019-10-02 12:12:12</p> 
 <p>8：notifyUrl</p> 
 <p>支付结果通知地址</p> 
 <p>9：returnUrl</p> 
 <p>网页跳转地址</p> 
 <p>三：H5支付的支付宝支付实例</p> 
 <p>$appId = '10037e6f6a4e6da4016a670fd4530012';</p> 
 <p>$appKey = 'f7a74b6c02ae4e1e94aaba311c04acf2';</p> 
 <p>$mid = '898310148160568';</p> 
 <p>$tid = '88880001';</p> 
 <p>//业务内容</p> 
 <p>$time = time();</p> 
 <p>$content = [</p> 
 <p>'requestTimestamp' =&gt; date('Y-m-d H:i:s', $time),//报文请求时间</p> 
 <p>'merOrderId' =&gt; '1017' . date('YmdHis'),//商户订单号</p> 
 <p>'mid' =&gt; $mid,//商户号</p> 
 <p>'tid' =&gt; $tid,//终端号</p> 
 <p>'instMid' =&gt; 'H5DEFAULT',//业务类型</p> 
 <p>'totalAmount' =&gt; '1',//支付总金额</p> 
 <p>'expireTime' =&gt; date('Y-m-d H:i:s', strtotime('+1 day', $time)),//过期时间</p> 
 <p>'notifyUrl' =&gt; '',//支付通知地址</p> 
 <p>'returnUrl' =&gt; ''//网页跳转地址</p> 
 <p>];</p> 
 <p>$timestamp = date('YmdHis', $time);</p> 
 <p>//随机数</p> 
 <p>$str = md5(uniqid(mt_rand(), true));</p> 
 <p>$uuid = substr($str, 0, 8) . '-';</p> 
 <p>$uuid .= substr($str, 8, 4) . '-';</p> 
 <p>$uuid .= substr($str, 12, 4) . '-';</p> 
 <p>$uuid .= substr($str, 16, 4) . '-';</p> 
 <p>$uuid .= substr($str, 20, 12);</p> 
 <p>$nonce = $uuid;</p> 
 <p>//签名</p> 
 <p>$hash = bin2hex(hash('sha256', json_encode($content), true));</p> 
 <p>$hashStr = $appId . $timestamp . $nonce . $hash;</p> 
 <p>$signature = base64_encode((hash_hmac('sha256', $hashStr, $appKey, true))); //$appKey银联商户H5支付产品的AppKey</p> 
 <p>$data = [</p> 
 <p>'timestamp' =&gt; $timestamp,//时间戳</p> 
 <p>'authorization' =&gt; 'OPEN-FORM-PARAM',//认证方式</p> 
 <p>'appId' =&gt; $appId,//APPID</p> 
 <p>'nonce' =&gt; $nonce,//随机数</p> 
 <p>'content' =&gt; urlencode(json_encode($content)),//业务内容</p> 
 <p>'signature' =&gt; urlencode($signature),//签名</p> 
 <p>];</p> 
 <p>//接口返回信息</p> 
 <p>//支付宝：http://58.247.0.18:29015/v1/netpay/trade/h5-pay</p> 
 <p>//银联在线无卡：http://58.247.0.18:29015/v1/netpay/qmf/h5-pay</p> 
 <p>//银联：http://58.247.0.18:29015/v1/netpay/uac/order</p> 
 <p>$options = '';</p> 
 <p>foreach ($data as $key =&gt; $value) {<!-- --></p> 
 <p>$options .= $key . '=' . $value .'&amp;';</p> 
 <p>}</p> 
 <p>$options = rtrim($options, '&amp;');</p> 
 <p>//存在转义字符，那么去掉转义</p> 
 <p>if(get_magic_quotes_gpc()){<!-- --></p> 
 <p>$options = stripslashes($options);</p> 
 <p>}</p> 
 <p>$url = 'http://58.247.0.18:29015/v1/netpay/trade/h5-pay?' . $options;</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cadcfa86c383dda2225a0682db8866cd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java高并发代码示例,Java使用代码模拟高并发操作的示例</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6430e0d745348648f659088b71b691ac/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">php中数字可以加字符吗,字母数字在PHP中增加一个字符串(到一定长度)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>