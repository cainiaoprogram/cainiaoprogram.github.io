<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【C&#43;&#43;】ifstream、file.good、 file.seekg、file.tellg、file.read详解 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【C&#43;&#43;】ifstream、file.good、 file.seekg、file.tellg、file.read详解" />
<meta property="og:description" content="本文主要对ifstream、file.good、 file.seekg、file.tellg、file.read等函数功能进行详细解析，包括原理和步骤，最后通过一个示例进行总结。
原理详解 std::ifstream file（） std::ifstream 是C&#43;&#43;中用于打开一个输入文件的语句。std::ifstream 是C&#43;&#43;标准库中的一个类，用于从文件进行输入。
std::ifstream file(file_name, std::ios::binary); 在这行代码中：
file_name 是一个字符串，表示要打开的文件的名称。
std::ios::binary 是一个打开模式，表示以二进制形式打开文件。这意味着你可以读取例如字节等二进制数据。如果不指定这个模式，文件将以文本模式打开，这意味着行尾字符可能会被处理（例如在Windows中，文本模式会将 “\r\n” 转换为 “\n”）。
file.good（） file.good() 是C&#43;&#43;中用来检查文件流是否处于良好状态的方法。如果文件流没有错误，那么 file.good() 将返回 true。否则，如果有错误发生，它将返回 false。
这个函数通常在读取或写入文件后被调用，以检查操作是否成功。例如：
std::ifstream file(&#34;example.txt&#34;); if (!file.good()) { std::cerr &lt;&lt; &#34;File operation failed!&#34; &lt;&lt; std::endl; return; } file.seekg() file.seekg(0, file.end); 是 C&#43;&#43; 中的一个文件操作函数，用于将文件读取指针移到文件的末尾。
这个函数的作用是将读取指针移动到文件的结尾，这样在下次读取文件时，将从文件的末尾开始读取。
file.seekg() 函数的第一个参数是一个整数，**表示偏移量，而第二个参数是一个枚举值，表示偏移的起始位置。**在这个例子中，起始位置是 file.end，表示从文件末尾开始计算偏移量。
file.seekg(0, file.beg); file.seekg(0, file.beg);它用于移动文件读取指针到文件的开始位置。
file.beg 是 std::istream 类的一个成员常量，表示从文件的开始位置开始偏移。
需要注意的是，file.seekg() 函数并不会改变文件中已经读过的内容，它只是改变了下一次读取操作的位置。此外，如果在打开文件时没有指定模式为 ‘r’（即只读模式），那么在执行 file.seekg() 时可能会抛出 IOError 异常。
file.tellg() size = file." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/643fcdc272a613c1988a0bc966771971/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-01T15:01:12+08:00" />
<meta property="article:modified_time" content="2023-11-01T15:01:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【C&#43;&#43;】ifstream、file.good、 file.seekg、file.tellg、file.read详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>本文主要对ifstream、file.good、 file.seekg、file.tellg、file.read等函数功能进行详细解析，包括原理和步骤，最后通过一个示例进行总结。</p> 
<h2><a id="_2"></a>原理详解</h2> 
<h3><a id="stdifstream_file_3"></a>std::ifstream file（）</h3> 
<p>std::ifstream 是C++中用于打开一个输入文件的语句。std::ifstream 是C++标准库中的一个类，用于从文件进行输入。</p> 
<pre><code class="prism language-bash">std::ifstream file<span class="token punctuation">(</span>file_name, std::ios::binary<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在这行代码中：</p> 
<p>file_name 是一个字符串，表示要打开的文件的名称。<br> std::ios::binary 是一个打开模式，表示以二进制形式打开文件。这意味着你可以读取例如字节等二进制数据。如果不指定这个模式，文件将以文本模式打开，这意味着行尾字符可能会被处理（例如在Windows中，文本模式会将 “\r\n” 转换为 “\n”）。</p> 
<h3><a id="filegood_13"></a>file.good（）</h3> 
<p>file.good() 是C++中用来检查文件流是否处于良好状态的方法。如果文件流没有错误，那么 file.good() 将返回 true。否则，如果有错误发生，它将返回 false。<br> 这个函数通常在读取或写入文件后被调用，以检查操作是否成功。例如：</p> 
<pre><code class="prism language-bash">std::ifstream file<span class="token punctuation">(</span><span class="token string">"example.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file.good<span class="token punctuation">(</span><span class="token punctuation">))</span> <span class="token punctuation">{<!-- --></span>
    std::cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"File operation failed!"</span> <span class="token operator">&lt;&lt;</span> std::endl<span class="token punctuation">;</span>
    <span class="token builtin class-name">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="fileseekg_25"></a>file.seekg()</h3> 
<pre><code class="prism language-bash">file.seekg<span class="token punctuation">(</span><span class="token number">0</span>, file.end<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> 
<p>是 C++ 中的一个文件操作函数，用于将文件读取指针移到文件的末尾。<br> 这个函数的作用是将读取指针移动到文件的结尾，这样在下次读取文件时，将从文件的末尾开始读取。<br> file.seekg() 函数的第一个参数是一个整数，**表示偏移量，而第二个参数是一个枚举值，表示偏移的起始位置。**在这个例子中，起始位置是 file.end，表示从文件末尾开始计算偏移量。</p> 
<pre><code class="prism language-bash">file.seekg<span class="token punctuation">(</span><span class="token number">0</span>, file.beg<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>file.seekg(0, file.beg);它用于移动文件读取指针到文件的开始位置。<br> file.beg 是 std::istream 类的一个成员常量，表示从文件的开始位置开始偏移。</p> 
<p>需要注意的是，file.seekg() 函数并不会改变文件中已经读过的内容，它只是改变了下一次读取操作的位置。此外，如果在打开文件时没有指定模式为 ‘r’（即只读模式），那么在执行 file.seekg() 时可能会抛出 IOError 异常。</p> 
<h3><a id="filetellg_41"></a>file.tellg()</h3> 
<pre><code class="prism language-bash"> size <span class="token operator">=</span> file.tellg<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>file.tellg() 是C++中的一个函数，它返回当前文件读取指针的位置。这个函数常被用于获取文件的大小。如上面file.seekg(0, file.end)，已经将指针位置放到了文件最后，所以读取的是文件大小。<br> 假设文件对象叫做 file，可以用 file.tellg() 来获取文件大小，并将结果存储在变量 size 中。<br> 这个方法通常用于二进制文件，因为文本文件中的换行符（‘\n’）在二进制文件中并不代表实际的数据，所以使用 tellg 获取的文件大小可能比实际文件内容大。如果你处理的是文本文件，可能需要考虑换行符的问题。</p> 
<h3><a id="fileread_48"></a>file.read()</h3> 
<pre><code class="prism language-bash">char *buffer <span class="token operator">=</span> new char<span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>
assert<span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
file.read<span class="token punctuation">(</span>buffer, size<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>第一行代码使用 new 关键字动态分配了一个大小为 size 的字符数组。**new 返回一个指向新分配的字符数组的指针，**该指针被存储在 buffer 变量中。</p> 
<p>第二行代码使用 assert() 函数来检查 buffer 是否不为 NULL。如果 buffer是 NULL，那么 assert() 函数将会抛出一个异常并终止程序。在这种情况下，由于我们已经分配了内存（第一行代码），判断是不为NULL的。</p> 
<p>第三行，使用 read() 函数从file中读取了size个字节的数据并存储到了 buffer 中。</p> 
<h3><a id="fileclose_61"></a>file.close()</h3> 
<pre><code class="prism language-bash">file.close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>该命令与std::ifstream file(）相对用，用于关闭文件，这将释放系统资源，以便其他程序或操作可以访问该文件。</p> 
<h2><a id="_67"></a>示例</h2> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;assert.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    std<span class="token double-colon punctuation">::</span>ifstream <span class="token function">file</span><span class="token punctuation">(</span><span class="token string">"example.txt"</span><span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span>ios<span class="token double-colon punctuation">::</span>binary<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打开文件 example.txt</span>
    <span class="token comment">//判断文件是否有问题</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">good</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//若文件有问题，输出错误信息</span>
        std<span class="token double-colon punctuation">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"read "</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"example.txt"</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" error!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    size_t size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">//</span>
    file<span class="token punctuation">.</span><span class="token function">seekg</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
    size <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">tellg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"File size is: "</span> <span class="token operator">&lt;&lt;</span> size <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes\n"</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"123"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    file<span class="token punctuation">.</span><span class="token function">seekg</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span>beg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span><span class="token operator">*</span> serialized_engine <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>serialized_engine<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//用于在file读取size个字节保存到serialized_engine中</span>
    file<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>serialized_engine<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token punctuation">}</span>

</code></pre> 
<p>运行上述示例，返回结果如下图。<br> <img src="https://images2.imgbox.com/f5/8b/QGDZCads_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/30/23/HTNcUcGc_o.png" alt="在这里插入图片描述"><br> 文本文件内容如上图，文本文件中只有14个数值，但字节是20个。这个原因是四行每行一个int类型，一共16个字节，还有三行换行符，3*2=6个字节，所以一共20个字节。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3aa270413a6a8d21c352956b3af346b3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C/C&#43;&#43;：gcc选项-fno-access-control的使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4103ee96af887c77ecb36ebaa3648dd1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Ubuntu 如何根据NVIDIA显卡型号确定对应的显卡驱动版本并安装</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>