<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux中lvdisplay命令的用法,lvdisplay - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux中lvdisplay命令的用法,lvdisplay" />
<meta property="og:description" content="磁盘信息[root@www ~]# fdisk -l
Disk /dev/hda: 41.1 GB, 41174138880 bytes
255 heads, 63 sectors/track, 5005 cylinders
Units = cylinders of 16065 * 512 = 8225280 bytes
Device Boot Start End Blocks Id System
/dev/hda1 * 1 13 104391 83 Linux
/dev/hda2 14 1288 10241437&#43; 83 Linux
/dev/hda3 1289 1925 5116702&#43; 83 Linux
/dev/hda4 1926 5005 24740100 5 Extended
/dev/hda5 1926 2052 1020096 82 Linux swap / Solaris
/dev/hda6 2053 2235 1469916 8e Linux LVM" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/d52607f533c088e1c235191981f7b1ac/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-30T04:41:12+08:00" />
<meta property="article:modified_time" content="2021-04-30T04:41:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux中lvdisplay命令的用法,lvdisplay</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>磁盘信息[root@www ~]# fdisk -l</p> 
 <p>Disk /dev/hda: 41.1 GB, 41174138880 bytes</p> 
 <p>255 heads, 63 sectors/track, 5005 cylinders</p> 
 <p>Units = cylinders of 16065 * 512 = 8225280 bytes</p> 
 <p>Device Boot Start End Blocks Id System</p> 
 <p>/dev/hda1 * 1 13 104391 83 Linux</p> 
 <p>/dev/hda2 14 1288 10241437+ 83 Linux</p> 
 <p>/dev/hda3 1289 1925 5116702+ 83 Linux</p> 
 <p>/dev/hda4 1926 5005 24740100 5 Extended</p> 
 <p>/dev/hda5 1926 2052 1020096 82 Linux swap / Solaris</p> 
 <p>/dev/hda6 2053 2235 1469916 8e Linux LVM</p> 
 <p>/dev/hda7 2236 2418 1469916 8e Linux LVM</p> 
 <p>/dev/hda8 2419 2601 1469916 8e Linux LVM</p> 
 <p>/dev/hda9 2602 2784 1469916 8e Linux LVM</p> 
 <p>LV阶段，逻辑卷操作[root@www ~]# pvscan #有三个 PV 被用去，剩下一个 /dev/hda9 的 PV 沒被用掉！</p> 
 <p>PV /dev/hda6 VG vbirdvg lvm2 [1.39 GB / 1.39 GB free]</p> 
 <p>PV /dev/hda7 VG vbirdvg lvm2 [1.39 GB / 1.39 GB free]</p> 
 <p>PV /dev/hda8 VG vbirdvg lvm2 [1.39 GB / 1.39 GB free]</p> 
 <p>PV /dev/hda9 lvm2 [1.40 GB]</p> 
 <p>Total: 4 [5.57 GB] / in use: 3 [4.17 GB] / in no VG: 1 [1.40 GB]</p> 
 <p>[root@www ~]# vgdisplay # 最后那三行指的就是 PE 能够使用的情況！由于尚未切出 LV，因此所有的 PE均可自由使用。</p> 
 <p>--- Volume group ---</p> 
 <p>VG Name vbirdvg</p> 
 <p>System ID</p> 
 <p>Format lvm2</p> 
 <p>Metadata Areas 3</p> 
 <p>Metadata Sequence No 1</p> 
 <p>VG Access read/write</p> 
 <p>VG Status resizable</p> 
 <p>MAX LV 0</p> 
 <p>Cur LV 0</p> 
 <p>Open LV 0</p> 
 <p>Max PV 0</p> 
 <p>Cur PV 3</p> 
 <p>Act PV 3</p> 
 <p>VG Size 4.17 GB #整个 VG 容量就这么大</p> 
 <p>PE Size 16.00 MB #內部每个 PE 的大小</p> 
 <p>Total PE 267 #总共的 PE 数量！</p> 
 <p>Alloc PE / Size 0 / 0</p> 
 <p>Free PE / Size 267 / 4.17 GB</p> 
 <p>VG UUID 4VU5Jr-gwOq-jkga-sUPx-vWPu-PmYm-dZH9EO</p> 
 <p>[root@www ~]# lvcreate -l 356 -n vbirdlv vbirdvg #将整个 vbirdvg 通通分配給 vbirdlv 啊，要注意， PE 共有 356 个</p> 
 <p>Logical volume "vbirdlv" created</p> 
 <p>[root@www ~]# ll /dev/vbirdvg/vbirdlv</p> 
 <p>lrwxrwxrwx 1 root root 27 Mar 11 16:49 /dev/vbirdvg/vbirdlv -&gt; /dev/mapper/vbirdvg-vbirdlv # 看见了沒有啊！这就是我们最重要的一步</p> 
 <p>[root@www ~]# lvdisplay</p> 
 <p>--- Logical volume ---</p> 
 <p>LV Name /dev/vbirdvg/vbirdlv #LV逻辑卷的名字</p> 
 <p>VG Name vbirdvg</p> 
 <p>LV UUID 8vFOPG-Jrw0-Runh-ug24-t2j7-i3nA-rPEyq0</p> 
 <p>LV Write Access read/write</p> 
 <p>LV Status available</p> 
 <p># open 0</p> 
 <p>LV Size 5.56 GB #LV的大小</p> 
 <p>Current LE 356</p> 
 <p>Segments 4</p> 
 <p>Allocation inherit</p> 
 <p>Read ahead sectors auto</p> 
 <p>- currently set to 256</p> 
 <p>Block device 253:0</p> 
 <p>格式化逻辑卷，并且挂载[root@www ~]# mkfs -t ext3 /dev/vbirdvg/vbirdlv #格式化</p> 
 <p>[root@www ~]# mkdir /mnt/lvm</p> 
 <p>[root@www ~]# mount /dev/vbirdvg/vbirdlv /mnt/lvm #挂载目录</p> 
 <p>[root@www ~]# df</p> 
 <p>Filesystem 1K-blocks Used Available Use% Mounted on</p> 
 <p>/dev/hda2 9920624 3858984 5549572 42% /</p> 
 <p>/dev/hda3 4956316 1056996 3643488 23% /home</p> 
 <p>/dev/hda1 101086 21408 74459 23% /boot</p> 
 <p>tmpfs 371332 0 371332 0% /dev/shm</p> 
 <p>/dev/mapper/vbirdvg-vbirdlv</p> 
 <p>5741020 142592 5306796 3% /mnt/lvm</p> 
 <p>增加 LV 容量[root@www ~]# fdisk -l</p> 
 <p>Device Boot Start End Blocks Id System</p> 
 <p>....(中间省略)....</p> 
 <p>/dev/hda10 2785 3150 2939863+ 8e Linux LVM #增加一下lvm /dev/hda10</p> 
 <p>[root@www ~]# pvcreate /dev/hda10 建立新的 PV</p> 
 <p>Physical volume "/dev/hda10" successfully created</p> 
 <p>[root@www ~]# pvscan #查看PG物理卷</p> 
 <p>PV /dev/hda6 VG vbirdvg lvm2 [1.39 GB / 0 free]</p> 
 <p>PV /dev/hda7 VG vbirdvg lvm2 [1.39 GB / 0 free]</p> 
 <p>PV /dev/hda8 VG vbirdvg lvm2 [1.39 GB / 0 free]</p> 
 <p>PV /dev/hda9 VG vbirdvg lvm2 [1.39 GB / 0 free]</p> 
 <p>PV /dev/hda10 lvm2 [2.80 GB] # 可以看到 /dev/hda10 是新加入，尚未使用</p> 
 <p>Total: 5 [8.37 GB] / in use: 4 [5.56 GB] / in no VG: 1 [2.80 GB]</p> 
 <p>[root@www ~]# vgextend vbirdvg /dev/hda10 #加大 VG ，利用 vgextend 功能</p> 
 <p>Volume group "vbirdvg" successfully extended</p> 
 <p>[root@www ~]# vgdisplay #查看VG逻辑卷组</p> 
 <p>--- Volume group ---</p> 
 <p>VG Name vbirdvg</p> 
 <p>System ID</p> 
 <p>Format lvm2</p> 
 <p>Metadata Areas 5</p> 
 <p>Metadata Sequence No 4</p> 
 <p>VG Access read/write</p> 
 <p>VG Status resizable</p> 
 <p>MAX LV 0</p> 
 <p>Cur LV 1</p> 
 <p>Open LV 1</p> 
 <p>Max PV 0</p> 
 <p>Cur PV 5</p> 
 <p>Act PV 5</p> 
 <p>VG Size 8.36 GB</p> 
 <p>PE Size 16.00 MB</p> 
 <p>Total PE 535</p> 
 <p>Alloc PE / Size 356 / 5.56 GB</p> 
 <p>Free PE / Size 179 / 2.80 GB</p> 
 <p>VG UUID 4VU5Jr-gwOq-jkga-sUPx-vWPu-PmYm-dZH9EO</p> 
 <p>[root@www ~]# lvresize -l +179 /dev/vbirdvg/vbirdlv #利用 lvresize 的功能來增加LV</p> 
 <p>Extending logical volume vbirdlv to 8.36 GB</p> 
 <p>Logical volume vbirdlv successfully resized</p> 
 <p>[root@www ~]# lvdisplay #显示LV逻辑卷</p> 
 <p>--- Logical volume ---</p> 
 <p>LV Name /dev/vbirdvg/vbirdlv</p> 
 <p>VG Name vbirdvg</p> 
 <p>LV UUID 8vFOPG-Jrw0-Runh-ug24-t2j7-i3nA-rPEyq0</p> 
 <p>LV Write Access read/write</p> 
 <p>LV Status available</p> 
 <p># open 1</p> 
 <p>LV Size 8.36 GB</p> 
 <p>Current LE 535</p> 
 <p>Segments 5</p> 
 <p>Allocation inherit</p> 
 <p>Read ahead sectors auto</p> 
 <p>- currently set to 256</p> 
 <p>Block device 253:0</p> 
 <p>[root@www ~]# df /mnt/lvm #查看大小</p> 
 <p>Filesystem 1K-blocks Used Available Use% Mounted on</p> 
 <p>/dev/mapper/vbirdvg-vbirdlv</p> 
 <p>5741020 261212 5188176 5% /mnt/lvm</p> 
 <p>[root@www ~]# resize2fs /dev/vbirdvg/vbirdlv #LV分区重设大小</p> 
 <p>resize2fs 1.39 (29-May-2006)</p> 
 <p>Filesystem at /dev/vbirdvg/vbirdlv is mounted on /mnt/lvm; on-line resizing</p> 
 <p>Performing an on-line resize of /dev/vbirdvg/vbirdlv to 2191360 (4k) blocks.</p> 
 <p>The filesystem on /dev/vbirdvg/vbirdlv is now 2191360 blocks long.</p> 
 <p>减小 LV 容量[root@www ~]# umount /mnt/lvm #取消挂载</p> 
 <p>[root@www ~]# e2fsck -f /dev/vbirdvg/vbirdlv #磁盘检测</p> 
 <p>e2fsck 1.39 (29-May-2006)</p> 
 <p>Pass 1: Checking inodes, blocks, and sizes</p> 
 <p>Pass 2: Checking directory structure</p> 
 <p>Pass 3: Checking directory connectivity</p> 
 <p>Pass 4: Checking reference counts</p> 
 <p>Pass 5: Checking group summary information</p> 
 <p>/dev/vbirdvg/vbirdlv: 2438/1087008 files (0.1% non-contiguous),</p> 
 <p>[root@www ~]# resize2fs /dev/vbirdvg/vbirdlv 6900M #重设大小</p> 
 <p>resize2fs 1.39 (29-May-2006)</p> 
 <p>Resizing the filesystem on /dev/vbirdvg/vbirdlv to 1766400 (4k) blocks.</p> 
 <p>The filesystem on /dev/vbirdvg/vbirdlv is now 1766400 blocks long.</p> 
 <p>[root@www ~]# mount /dev/vbirdvg/vbirdlv /mnt/lvm #挂载LVM</p> 
 <p>[root@www ~]# df /mnt/lvm</p> 
 <p>Filesystem 1K-blocks Used Available Use% Mounted on</p> 
 <p>/dev/mapper/vbirdvg-vbirdlv</p> 
 <p>6955584 262632 6410328 4% /mnt/lvm</p> 
 <p>[root@www ~]# lvresize -l -89 /dev/vbirdvg/vbirdlv #降低 LV 的容量</p> 
 <p>WARNING: Reducing active and open logical volume to 6.97 GB</p> 
 <p>THIS MAY DESTROY YOUR DATA (filesystem etc.)</p> 
 <p>Do you really want to reduce vbirdlv? [y/n]: y</p> 
 <p>Reducing logical volume vbirdlv to 6.97 GB</p> 
 <p>Logical volume vbirdlv successfully resized</p> 
 <p>[root@www ~]# lvdisplay #查看lv逻辑卷信息</p> 
 <p>--- Logical volume ---</p> 
 <p>LV Name /dev/vbirdvg/vbirdlv</p> 
 <p>VG Name vbirdvg</p> 
 <p>LV UUID 8vFOPG-Jrw0-Runh-ug24-t2j7-i3nA-rPEyq0</p> 
 <p>LV Write Access read/write</p> 
 <p>LV Status available</p> 
 <p># open 1</p> 
 <p>LV Size 6.97 GB</p> 
 <p>Current LE 446</p> 
 <p>Segments 5</p> 
 <p>Allocation inherit</p> 
 <p>Read ahead sectors auto</p> 
 <p>- currently set to 256</p> 
 <p>Block device 253:0</p> 
 <p>[root@www ~]# pvdisplay #先确认 /dev/hda6 是否將 PE 都移除了</p> 
 <p>--- Physical volume ---</p> 
 <p>PV Name /dev/hda6</p> 
 <p>VG Name vbirdvg</p> 
 <p>PV Size 1.40 GB / not usable 11.46 MB</p> 
 <p>Allocatable yes (but full)</p> 
 <p>PE Size (KByte) 16384</p> 
 <p>Total PE 89</p> 
 <p>Free PE 0</p> 
 <p>Allocated PE 89</p> 
 <p>PV UUID Z13Jk5-RCls-UJ8B-HzDa-Gesn-atku-rf2biN</p> 
 <p>....(中間省略)....</p> 
 <p>--- Physical volume ---</p> 
 <p>PV Name /dev/hda10</p> 
 <p>VG Name vbirdvg</p> 
 <p>PV Size 2.80 GB / not usable 6.96 MB</p> 
 <p>Allocatable yes</p> 
 <p>PE Size (KByte) 16384</p> 
 <p>Total PE 179</p> 
 <p>Free PE 89</p> 
 <p>Allocated PE 90</p> 
 <p>PV UUID 7MfcG7-y9or-0Jmb-H7RO-5Pa5-D3qB-G426Vq</p> 
 <p>[root@www ~]# pvmove /dev/hda6 /dev/hda10 #將 /dev/hda6 內的 PE 移动到 /dev/hda10</p> 
 <p>[root@www ~]# vgreduce vbirdvg /dev/hda6 #將 /dev/hda6从vbirdvg 移出</p> 
 <p>Removed "/dev/hda6" from volume group "vbirdvg"</p> 
 <p>[root@www ~]# pvscan</p> 
 <p>PV /dev/hda7 VG vbirdvg lvm2 [1.39 GB / 0 free]</p> 
 <p>PV /dev/hda8 VG vbirdvg lvm2 [1.39 GB / 0 free]</p> 
 <p>PV /dev/hda9 VG vbirdvg lvm2 [1.39 GB / 0 free]</p> 
 <p>PV /dev/hda10 VG vbirdvg lvm2 [2.80 GB / 0 free]</p> 
 <p>PV /dev/hda6 lvm2 [1.40 GB]</p> 
 <p>Total: 5 [8.37 GB] / in use: 4 [6.97 GB] / in no VG: 1 [1.40 GB]</p> 
 <p>[root@www ~]# pvremove /dev/hda6 #移出物理卷hda6</p> 
 <p>Labels on physical volume "/dev/hda6" successfully wiped</p> 
 <p>快照区的建立[root@www ~]# vgdisplay #查看VG容量</p> 
 <p>--- Volume group ---</p> 
 <p>VG Name vbirdvg</p> 
 <p>....(其他省略)....</p> 
 <p>VG Size 6.97 GB</p> 
 <p>PE Size 16.00 MB</p> 
 <p>Total PE 446</p> 
 <p>Alloc PE / Size 446 / 6.97 GB</p> 
 <p>Free PE / Size 0 / 0</p> 
 <p>[root@www ~]# pvcreate /dev/hda6 #创建PV物理卷</p> 
 <p>Physical volume "/dev/hda6" successfully created</p> 
 <p>[root@www ~]# vgextend vbirdvg /dev/hda6 #将刚刚移除的 /dev/hda6 加入這個 VG</p> 
 <p>Volume group "vbirdvg" successfully extended</p> 
 <p>[root@www ~]# vgdisplay #查看VG</p> 
 <p>--- Volume group ---</p> 
 <p>VG Name vbirdvg</p> 
 <p>....(其他省略)....</p> 
 <p>VG Size 8.36 GB</p> 
 <p>PE Size 16.00 MB</p> 
 <p>Total PE 535</p> 
 <p>Alloc PE / Size 446 / 6.97 GB</p> 
 <p>Free PE / Size 89 / 1.39 GB #多出了 89 个 可用PE</p> 
 <p>[root@www ~]# lvcreate -l 60 -s -n vbirdss /dev/vbirdvg/vbirdlv #利用 lvcreate 建立系统快照区，命名为vbirdss，且经于 60 个 PE</p> 
 <p>Logical volume "vbirdss" created</p> 
 <p>[root@www ~]# lvdisplay</p> 
 <p>--- Logical volume ---</p> 
 <p>LV Name /dev/vbirdvg/vbirdss</p> 
 <p>VG Name vbirdvg</p> 
 <p>LV UUID K2tJ5E-e9mI-89Gw-hKFd-4tRU-tRKF-oeB03a</p> 
 <p>LV Write Access read/write</p> 
 <p>LV snapshot status active destination for /dev/vbirdvg/vbirdlv</p> 
 <p>LV Status available</p> 
 <p># open 0</p> 
 <p>LV Size 6.97 GB #原LV的大小</p> 
 <p>Current LE 446</p> 
 <p>COW-table size 960.00 MB #新建快照区的实际大小</p> 
 <p>COW-table LE 60 #快照区占有的PE</p> 
 <p>Allocated to snapshot 0.00%</p> 
 <p>Snapshot chunk size 4.00 KB</p> 
 <p>Segments 1</p> 
 <p>Allocation inherit</p> 
 <p>Read ahead sectors auto</p> 
 <p>- currently set to 256</p> 
 <p>Block device 253:1</p> 
 <p>[root@www ~]# mkdir /mnt/snapshot</p> 
 <p>[root@www ~]# mount /dev/vbirdvg/vbirdss /mnt/snapshot</p> 
 <p>[root@www ~]# df</p> 
 <p>Filesystem 1K-blocks Used Available Use% Mounted on</p> 
 <p>/dev/hda2 9920624 3859032 5549524 42% /</p> 
 <p>/dev/hda3 4956316 1056996 3643488 23% /home</p> 
 <p>/dev/hda1 101086 21408 74459 23% /boot</p> 
 <p>tmpfs 371332 0 371332 0% /dev/shm</p> 
 <p>/dev/mapper/vbirdvg-vbirdlv</p> 
 <p>6955584 262632 6410328 4% /mnt/lvm #二个一样</p> 
 <p>/dev/mapper/vbirdvg-vbirdss</p> 
 <p>6955584 262632 6410328 4% /mnt/snapshot #二个一样</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4667ff7650af6a336f627c23e1a1e502/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">缺少linux内核,Linux内核缺页</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e539a2754f6ab4da23cb224c04ff1f90/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">linux服务器休眠怎么唤醒,海思的Linux方案中系统怎么待机和唤醒</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>