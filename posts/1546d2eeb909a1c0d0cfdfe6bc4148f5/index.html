<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于RK3588平台的机器学习模型部署 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于RK3588平台的机器学习模型部署" />
<meta property="og:description" content="目录 硬件平台介绍rk3588 NPU及开发工具介绍rknn-toolkit2安装测试连板运行 总结 硬件平台介绍 这次体验的硬件平台是来自飞凌嵌入式的OK3588-C开发板，该开发板基于Rockchip新一代旗舰 RK3588处理器开发，采用核心板&#43;底板的分体式设计，将FET3588-C核心板的全部功能引脚以最便利的方式引出，并针对不同的功能做了深度优化，方便用户二次开发的同时简化用户设计。
rk3588 NPU及开发工具介绍 rk3588专门针对机器学习模型部署的需求配置了性能强劲的NPU，rk3588配置的NPU不仅提供6TOPS的算力，还支持INT4/INT8/INT16/FP16格式的混合操作。除了非常不错的硬件支持之外，Rockchip公司还提供了便捷的开发工具rknn-toolkit2 和 rknpu2-api，让开发者可以方便的将自己的机器学习模型进行转换和部署。
rknn-toolkit2 根据rockchip提供的《Rockchip_User_Guide_RKNN_Toolkit2》开发文档介绍：
RKNN-Toolkit2 是为用户提供在 PC、Rockchip NPU 平台上进行模型转换、推理和性能评估的
开发套件，用户通过该工具提供的 Python 接口可以便捷地完成以下功能：
模型转换： 支持 Caffe、TensorFlow、TensorFlow Lite、ONNX、DarkNet、PyTorch 等模型
转为 RKNN 模型，并支持 RKNN 模型导入导出，RKNN 模型能够在 Rockchip NPU 平台
上加载使用。量 化 功 能 ： 支 持 将 浮 点 模 型 量 化 为 定 点 模 型 ， 目 前 支 持 的 量 化 方 法 为 非 对 称 量 化" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1546d2eeb909a1c0d0cfdfe6bc4148f5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-07T23:32:30+08:00" />
<meta property="article:modified_time" content="2023-10-07T23:32:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于RK3588平台的机器学习模型部署</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">硬件平台介绍</a></li><li><a href="#rk3588_NPU_9" rel="nofollow">rk3588 NPU及开发工具介绍</a></li><li><ul><li><a href="#rknntoolkit2_13" rel="nofollow">rknn-toolkit2</a></li><li><ul><li><a href="#_32" rel="nofollow">安装</a></li><li><a href="#_51" rel="nofollow">测试</a></li><li><a href="#_289" rel="nofollow">连板运行</a></li></ul> 
   </li></ul> 
   </li><li><a href="#_328" rel="nofollow">总结</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_2"></a>硬件平台介绍</h3> 
<p>这次体验的硬件平台是来自飞凌嵌入式的<a href="https://www.forlinx.com/product/rk3588-158.html" rel="nofollow">OK3588-C开发板</a>，该开发板基于Rockchip新一代旗舰 RK3588处理器开发，采用<a href="https://www.forlinx.com/" rel="nofollow">核心板</a>+底板的分体式设计，将FET3588-C核心板的全部功能引脚以最便利的方式引出，并针对不同的功能做了深度优化，方便用户二次开发的同时简化用户设计。<br> <img src="https://images2.imgbox.com/81/5a/pdlYWnZM_o.jpg" alt=""></p> 
<h3><a id="rk3588_NPU_9"></a>rk3588 NPU及开发工具介绍</h3> 
<p>rk3588专门针对机器学习模型部署的需求配置了性能强劲的NPU，rk3588配置的NPU不仅提供6TOPS的算力，还支持INT4/INT8/INT16/FP16格式的混合操作。除了非常不错的硬件支持之外，Rockchip公司还提供了便捷的开发工具rknn-toolkit2 和 rknpu2-api，让开发者可以方便的将自己的机器学习模型进行转换和部署。</p> 
<h4><a id="rknntoolkit2_13"></a>rknn-toolkit2</h4> 
<p>根据rockchip提供的《Rockchip_User_Guide_RKNN_Toolkit2》开发文档介绍：</p> 
<p>RKNN-Toolkit2 是为用户提供在 PC、Rockchip NPU 平台上进行模型转换、推理和性能评估的<br> 开发套件，用户通过该工具提供的 Python 接口可以便捷地完成以下功能：</p> 
<ul><li>模型转换： 支持 Caffe、TensorFlow、TensorFlow Lite、ONNX、DarkNet、PyTorch 等模型<br> 转为 RKNN 模型，并支持 RKNN 模型导入导出，RKNN 模型能够在 Rockchip NPU 平台<br> 上加载使用。</li><li>量 化 功 能 ： 支 持 将 浮 点 模 型 量 化 为 定 点 模 型 ， 目 前 支 持 的 量 化 方 法 为 非 对 称 量 化<br> （ asymmetric_quantized-8 ） ， 并 支 持 混 合 量 化 功 能 。</li><li>模型推理：能够在 PC 上模拟 Rockchip NPU 运行 RKNN 模型并获取推理结果；或将 RKNN<br> 模型分发到指定的 NPU 设备上进行推理并获取推理结果。</li><li>性能和内存评估：将 RKNN 模型分发到指定 NPU 设备上运行，以评估模型在实际设备上<br> 运行时的性能和内存占用情况。</li><li>量化精度分析：该功能将给出模型量化前后每一层推理结果与浮点模型推理结果的余弦距<br> 离，以便于分析量化误差是如何出现的，为提高量化模型的精度提供思路。</li></ul> 
<h5><a id="_32"></a>安装</h5> 
<p>可以从github上的rockchip官方仓库中下载最新的适合于本地python环境的<a href="https://github.com/rockchip-linux/rknn-toolkit2/blob/master/packages/rknn_toolkit2-1.5.2%2Bb642f30c-cp310-cp310-linux_x86_64.whl">rknn_toolkit2安装文件</a>，目前github上最新的版本已经支持python3.10了。下载完python安装文件后，可以用pip直接安装，这里以python3.10版本为例。需要注意的是rknn_toolkit2的安装是以来tensorflow2.8版本tf-estimator-nightly特定版本的。所以在安装rknn_toolkit2之前先利用pip安装tensorflow2.8版本，对于已经安装其他版本tensorflow的，要先进行卸载，再重新安装。</p> 
<pre><code class="prism language-shell">pip3 <span class="token function">install</span> <span class="token assign-left variable">tensorflow</span><span class="token operator">==</span><span class="token number">2.8</span>
pip3 <span class="token function">install</span> tf-estimator-nightly<span class="token operator">==</span><span class="token number">2.8</span>.0.dev2021122109 <span class="token parameter variable">-i</span> https://pypi.org/simple
</code></pre> 
<p>接着用pip安装刚下在的rknn_toolkit2安装包。</p> 
<pre><code class="prism language-python">pip3 install rknn_toolkit2<span class="token operator">-</span><span class="token number">1.5</span><span class="token number">.2</span><span class="token operator">%</span>2Bb642f30c<span class="token operator">-</span>cp310<span class="token operator">-</span>cp310<span class="token operator">-</span>linux_x86_64<span class="token punctuation">.</span>whl
</code></pre> 
<p>下图是安装完成后的提示信息：<br> <img src="https://images2.imgbox.com/28/ef/ll4XH4IC_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_51"></a>测试</h5> 
<p>在安装完成之后，可以直接使用rknn_toolkit2提供的demo程序进行测试。这里我们选择tensorflow构建的机器学习模型进行测试。</p> 
<p>官方提供的测试程序在rknn-toolkit2/examples/tensorflow/ssd_mobilenet_v1路径下。</p> 
<p>具体测试程序如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> re
<span class="token keyword">import</span> math
<span class="token keyword">import</span> random
<span class="token keyword">import</span> cv2

<span class="token keyword">from</span> rknn<span class="token punctuation">.</span>api <span class="token keyword">import</span> RKNN

INPUT_SIZE <span class="token operator">=</span> <span class="token number">300</span>

NUM_RESULTS <span class="token operator">=</span> <span class="token number">1917</span>
NUM_CLASSES <span class="token operator">=</span> <span class="token number">91</span>

Y_SCALE <span class="token operator">=</span> <span class="token number">10.0</span>
X_SCALE <span class="token operator">=</span> <span class="token number">10.0</span>
H_SCALE <span class="token operator">=</span> <span class="token number">5.0</span>
W_SCALE <span class="token operator">=</span> <span class="token number">5.0</span>

<span class="token keyword">def</span> <span class="token function">expit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token number">1.</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1.</span> <span class="token operator">+</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">unexpit</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1.0</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">/</span> y<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1.0</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">CalculateOverlap</span><span class="token punctuation">(</span>xmin0<span class="token punctuation">,</span> ymin0<span class="token punctuation">,</span> xmax0<span class="token punctuation">,</span> ymax0<span class="token punctuation">,</span> xmin1<span class="token punctuation">,</span> ymin1<span class="token punctuation">,</span> xmax1<span class="token punctuation">,</span> ymax1<span class="token punctuation">)</span><span class="token punctuation">:</span>
    w <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span>xmax0<span class="token punctuation">,</span> xmax1<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">max</span><span class="token punctuation">(</span>xmin0<span class="token punctuation">,</span> xmin1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    h <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span>ymax0<span class="token punctuation">,</span> ymax1<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">max</span><span class="token punctuation">(</span>ymin0<span class="token punctuation">,</span> ymin1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    i <span class="token operator">=</span> w <span class="token operator">*</span> h
    u <span class="token operator">=</span> <span class="token punctuation">(</span>xmax0 <span class="token operator">-</span> xmin0<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>ymax0 <span class="token operator">-</span> ymin0<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>xmax1 <span class="token operator">-</span> xmin1<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>ymax1 <span class="token operator">-</span> ymin1<span class="token punctuation">)</span> <span class="token operator">-</span> i

    <span class="token keyword">if</span> u <span class="token operator">&lt;=</span> <span class="token number">0.0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">0.0</span>

    <span class="token keyword">return</span> i <span class="token operator">/</span> u

<span class="token keyword">def</span> <span class="token function">load_box_priors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    box_priors_ <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    fp <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./box_priors.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>
    ls <span class="token operator">=</span> fp<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> s <span class="token keyword">in</span> ls<span class="token punctuation">:</span>
        aList <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'([-+]?\d+(\.\d*)?|\.\d+)([eE][-+]?\d+)?'</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>
        <span class="token keyword">for</span> ss <span class="token keyword">in</span> aList<span class="token punctuation">:</span>
            aNum <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ss<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>ss<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            box_priors_<span class="token punctuation">.</span>append<span class="token punctuation">(</span>aNum<span class="token punctuation">)</span>
    fp<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

    box_priors <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>box_priors_<span class="token punctuation">)</span>
    box_priors <span class="token operator">=</span> box_priors<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> NUM_RESULTS<span class="token punctuation">)</span>

    <span class="token keyword">return</span> box_priors

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>

    <span class="token comment"># Create RKNN object</span>
    rknn <span class="token operator">=</span> RKNN<span class="token punctuation">(</span>verbose<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token comment"># Pre-process config</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'--&gt; Config model'</span><span class="token punctuation">)</span>
    rknn<span class="token punctuation">.</span>config<span class="token punctuation">(</span>mean_values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">127.5</span><span class="token punctuation">,</span> <span class="token number">127.5</span><span class="token punctuation">,</span> <span class="token number">127.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> std_values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">127.5</span><span class="token punctuation">,</span> <span class="token number">127.5</span><span class="token punctuation">,</span> <span class="token number">127.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> target_platform<span class="token operator">=</span><span class="token string">'rk3566'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>

    <span class="token comment"># Load model (from https://github.com/fvmassoli/Deep-Learning-SSD-Object-Detection)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'--&gt; Loading model'</span><span class="token punctuation">)</span>
    ret <span class="token operator">=</span> rknn<span class="token punctuation">.</span>load_tensorflow<span class="token punctuation">(</span>tf_pb<span class="token operator">=</span><span class="token string">'./ssd_mobilenet_v1_coco_2017_11_17.pb'</span><span class="token punctuation">,</span>
                               inputs<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Preprocessor/sub'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                               outputs<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'concat'</span><span class="token punctuation">,</span> <span class="token string">'concat_1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                               input_size_list<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> INPUT_SIZE<span class="token punctuation">,</span> INPUT_SIZE<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Load model failed!'</span><span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>

    <span class="token comment"># Build Model</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'--&gt; Building model'</span><span class="token punctuation">)</span>
    ret <span class="token operator">=</span> rknn<span class="token punctuation">.</span>build<span class="token punctuation">(</span>do_quantization<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> dataset<span class="token operator">=</span><span class="token string">'./dataset.txt'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Build model failed!'</span><span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>

    <span class="token comment"># Export rknn model</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'--&gt; Export rknn model'</span><span class="token punctuation">)</span>
    ret <span class="token operator">=</span> rknn<span class="token punctuation">.</span>export_rknn<span class="token punctuation">(</span><span class="token string">'./ssd_mobilenet_v1_coco.rknn'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Export rknn model failed!'</span><span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>

    <span class="token comment"># Set inputs</span>
    orig_img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'./road.bmp'</span><span class="token punctuation">)</span>
    img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>orig_img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2RGB<span class="token punctuation">)</span>
    img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span>INPUT_SIZE<span class="token punctuation">,</span> INPUT_SIZE<span class="token punctuation">)</span><span class="token punctuation">,</span> interpolation<span class="token operator">=</span>cv2<span class="token punctuation">.</span>INTER_CUBIC<span class="token punctuation">)</span>

    <span class="token comment"># Init runtime environment</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'--&gt; Init runtime environment'</span><span class="token punctuation">)</span>
    ret <span class="token operator">=</span> rknn<span class="token punctuation">.</span>init_runtime<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Init runtime environment failed!'</span><span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>

    <span class="token comment"># Inference</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'--&gt; Running model'</span><span class="token punctuation">)</span>
    outputs <span class="token operator">=</span> rknn<span class="token punctuation">.</span>inference<span class="token punctuation">(</span>inputs<span class="token operator">=</span><span class="token punctuation">[</span>img<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>

    predictions <span class="token operator">=</span> outputs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> NUM_RESULTS<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'./tensorflow_ssd_mobilenet_v1_0.npy'</span><span class="token punctuation">,</span> outputs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    outputClasses <span class="token operator">=</span> outputs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> NUM_RESULTS<span class="token punctuation">,</span> NUM_CLASSES<span class="token punctuation">)</span><span class="token punctuation">)</span>
    np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'./tensorflow_ssd_mobilenet_v1_1.npy'</span><span class="token punctuation">,</span> outputs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    candidateBox <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> NUM_RESULTS<span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span>
    classScore <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1000.0</span><span class="token punctuation">]</span> <span class="token operator">*</span> NUM_RESULTS
    vaildCnt <span class="token operator">=</span> <span class="token number">0</span>

    box_priors <span class="token operator">=</span> load_box_priors<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># Post Process</span>
    <span class="token comment"># got valid candidate box</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> NUM_RESULTS<span class="token punctuation">)</span><span class="token punctuation">:</span>
        topClassScore <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1000</span>
        topClassScoreIndex <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>

        <span class="token comment"># Skip the first catch-all class.</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> NUM_CLASSES<span class="token punctuation">)</span><span class="token punctuation">:</span>
            score <span class="token operator">=</span> expit<span class="token punctuation">(</span>outputClasses<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>

            <span class="token keyword">if</span> score <span class="token operator">&gt;</span> topClassScore<span class="token punctuation">:</span>
                topClassScoreIndex <span class="token operator">=</span> j
                topClassScore <span class="token operator">=</span> score

        <span class="token keyword">if</span> topClassScore <span class="token operator">&gt;</span> <span class="token number">0.4</span><span class="token punctuation">:</span>
            candidateBox<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>vaildCnt<span class="token punctuation">]</span> <span class="token operator">=</span> i
            candidateBox<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>vaildCnt<span class="token punctuation">]</span> <span class="token operator">=</span> topClassScoreIndex
            classScore<span class="token punctuation">[</span>vaildCnt<span class="token punctuation">]</span> <span class="token operator">=</span> topClassScore
            vaildCnt <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token comment"># calc position</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> vaildCnt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> candidateBox<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>

        n <span class="token operator">=</span> candidateBox<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        ycenter <span class="token operator">=</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">/</span> Y_SCALE <span class="token operator">*</span> box_priors<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">+</span> box_priors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span>
        xcenter <span class="token operator">=</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> X_SCALE <span class="token operator">*</span> box_priors<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">+</span> box_priors<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span>
        h <span class="token operator">=</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">/</span> H_SCALE<span class="token punctuation">)</span> <span class="token operator">*</span> box_priors<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span>
        w <span class="token operator">=</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">/</span> W_SCALE<span class="token punctuation">)</span> <span class="token operator">*</span> box_priors<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span>

        ymin <span class="token operator">=</span> ycenter <span class="token operator">-</span> h <span class="token operator">/</span> <span class="token number">2.</span>
        xmin <span class="token operator">=</span> xcenter <span class="token operator">-</span> w <span class="token operator">/</span> <span class="token number">2.</span>
        ymax <span class="token operator">=</span> ycenter <span class="token operator">+</span> h <span class="token operator">/</span> <span class="token number">2.</span>
        xmax <span class="token operator">=</span> xcenter <span class="token operator">+</span> w <span class="token operator">/</span> <span class="token number">2.</span>

        predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> ymin
        predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> xmin
        predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> ymax
        predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> xmax

    <span class="token comment"># NMS</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> vaildCnt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> candidateBox<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>

        n <span class="token operator">=</span> candidateBox<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        xmin0 <span class="token operator">=</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        ymin0 <span class="token operator">=</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        xmax0 <span class="token operator">=</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
        ymax0 <span class="token operator">=</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>

        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> vaildCnt<span class="token punctuation">)</span><span class="token punctuation">:</span>
            m <span class="token operator">=</span> candidateBox<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>

            <span class="token keyword">if</span> m <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>

            xmin1 <span class="token operator">=</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            ymin1 <span class="token operator">=</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            xmax1 <span class="token operator">=</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
            ymax1 <span class="token operator">=</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>

            iou <span class="token operator">=</span> CalculateOverlap<span class="token punctuation">(</span>xmin0<span class="token punctuation">,</span> ymin0<span class="token punctuation">,</span> xmax0<span class="token punctuation">,</span> ymax0<span class="token punctuation">,</span> xmin1<span class="token punctuation">,</span> ymin1<span class="token punctuation">,</span> xmax1<span class="token punctuation">,</span> ymax1<span class="token punctuation">)</span>

            <span class="token keyword">if</span> iou <span class="token operator">&gt;=</span> <span class="token number">0.45</span><span class="token punctuation">:</span>
                candidateBox<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>

    <span class="token comment"># Draw result</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> vaildCnt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> candidateBox<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>

        n <span class="token operator">=</span> candidateBox<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>

        xmin <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> INPUT_SIZE
        ymin <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> INPUT_SIZE
        xmax <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> INPUT_SIZE
        ymax <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> INPUT_SIZE

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%d @ (%d, %d) (%d, %d) score=%f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>candidateBox<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> xmin<span class="token punctuation">,</span> ymin<span class="token punctuation">,</span> xmax<span class="token punctuation">,</span> ymax<span class="token punctuation">,</span> classScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>orig_img<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>xmin<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>ymin<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>xmax<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>ymax<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                      <span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">255</span><span class="token punctuation">,</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">255</span><span class="token punctuation">,</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span><span class="token string">"result.jpg"</span><span class="token punctuation">,</span> orig_img<span class="token punctuation">)</span>

    rknn<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>以上程序主要包括以下几个步骤和对应的接口（省略了参数调用）：</p> 
<ol><li>创建RKNN对象： rknn=RKNN()</li><li>模型输入的预处理配置: rknn.config()</li><li>加载tensorflow生成的pb模型：rknn.load_tensorflow()</li><li>构建rknn模型：rknn.build()</li><li>导出rknn模型：rknn.export_rknn()</li><li>初始化模型运行环境：rknn.init_runtime()</li><li>设置模型的输入：按照实际模型输入的要求准备好输入数据</li><li>利用rknn模型进行推理： rknn.inference()</li><li>模型推理结果的后处理：将模型输出的推理结果处理成方便理解和使用的形式</li></ol> 
<p>以上是针对tensorflow框架下的机器学习模型的转换和运行步骤，rknn-toolkit2还支持以下机器学习模型框架：</p> 
<table><thead><tr><th>机器学习模型框架</th><th>输入模型文件后缀</th><th>对应模型加载API</th></tr></thead><tbody><tr><td>Caffe</td><td>.prototxt</td><td>load_caffe</td></tr><tr><td>TensorFlow</td><td>.pb</td><td>load_tensorflow</td></tr><tr><td>TensorFlow Lite</td><td>.tflite</td><td>load_tflite</td></tr><tr><td>ONNX</td><td>.onnx</td><td>load_onnx</td></tr><tr><td>DarkNet</td><td>.cfg</td><td>load_darknet</td></tr><tr><td>PyTorch</td><td>.pt</td><td>load_pytorch</td></tr></tbody></table> 
<h5><a id="_289"></a>连板运行</h5> 
<p>rknn模型的推理运行有两种方式，一种是直接在PC上利用模拟环境调用rknn模型进行推理运算。还有一种是利用rk3588上的硬件NPU进行推理运算。第二种方式需要在PC和RK3588开发板之间进行数据传输，主要包括以下步骤：</p> 
<ol><li>用USB转typeC的线，将开发板上的TypeC0口和PC的USB口进行连接</li><li>在RK3588开发板上启动rknn_server。在终端中运行</li></ol> 
<pre><code class="prism language-shell">/usr/bin/rknn_server start
</code></pre> 
<p>rknn_server启动后会打印相关信息，并且在有PC端连接时也会打印相应信息，如下图所示：</p> 
<p><img src="https://images2.imgbox.com/e3/71/4XSIU4s2_o.jpg" alt=""></p> 
<ol start="3"><li>修改上面的测试程序，在运行环境初始化时指定运行的目标平台：</li></ol> 
<pre><code class="prism language-python">rknn<span class="token punctuation">.</span>init_runtime<span class="token punctuation">(</span>target<span class="token operator">=</span><span class="token string">'rk3588'</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="4"><li>运行测试程序得到推理结果</li></ol> 
<pre><code class="prism language-python">python3 test<span class="token punctuation">.</span>py
</code></pre> 
<p>得到输出结果如下：</p> 
<p><img src="https://images2.imgbox.com/84/92/bWRbmdgv_o.png" alt="res"></p> 
<p>从上面的打印信息可以看出， PC上的rknn-toolkit2成功与开发板上运行的rknn服务器连接成功，并且通过调用rk3588的硬件NPU进行模型的推理运算，得出运算结果。</p> 
<p>下图是通过连板运行模型推理得到的结果，可以看出目标检测模型成功检测出凸显各种的人，自行车，汽车等目标。</p> 
<p><img src="https://images2.imgbox.com/55/71/LWBggyP8_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_328"></a>总结</h3> 
<p>通过rknn-toolkit2开发工具，可以方便的将各种框架下得到的机器学习模型转化为rk3588需要的rknn模型，并且调用rk3588的NPU进行模型的推理运算。考虑到rk3588的NPU具有很强的运算能力(6TOPS)，将机器学习模型部署到rk3588上并由专用的NPU提供算力支持，可以大大提高模型的计算速度和能力，为机器学习模型的终端部署提供有效保证。</p> 
<p>当然，在实际产品开发中，如果是使用python环境，其实是通过在rk3588中调用rknn-lite工具包调用rknn模型进行推理计算。而更高效的方式则是利用rockchip公司提供的rknpu的C语言API对转换后的rknn模型进行调用和推理，关于这部分内容，有机会博主会在后续的文章中详细总结整理。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/498e6d295df6c8f870318ac73e3264ce/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JVM笔记 —— 垃圾回收（GC）详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6f2c06ba91db6abcd9b5c3b166f2a23e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AI创业，大龄程序员被逼的上路</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>