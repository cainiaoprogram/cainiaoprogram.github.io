<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>环境部署搭建 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="环境部署搭建" />
<meta property="og:description" content="一、 服务器 1.购买一个服务器，使用密钥登录
2.ssh远程连接
ssh连接的工具很多，这里推荐用的是xshell
登录成功，开始配置环境。
二、docker环境部署 1、下载docker
yum install docker 2、启动docker服务
service docker start chkconfig docker on 3、测试是否安装成功
docker version 4、设置国内镜像
vi /etc/docker/daemon.json #添加后 { &#34;registry-mirrors&#34;: [&#34;https://mirror.ccs.tencentyun.com&#34;], &#34;live-restore&#34;: true } 5、重新启动docker服务
systemctl daemon-reload service docker restart 6、 检查是否生效
docker info 三、Docker Compose的安装 1、安装中间件
下载地址：
https://github.com/docker/compose/releases/download/1.28.6/docker-compose-Linux-x86_64
2、导入文件
cd /usr/local/bin #打开文件夹 rz #选择本地文件到服务器 3、将可执行权限应用于二进制文件
sudo chmod &#43;x /usr/bin/docker/docker-compose 4、测试是否安装成功
docker-compose --version 四、docker常用命令 拉取docker镜像 docker pull image_name 查看宿主机上的镜像，Docker镜像保存在/var/lib/docker目录下: docker images 删除镜像 docker rmi docker." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c5c6fa64a33d06d1fadf24b59ac3e7e9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-22T13:19:33+08:00" />
<meta property="article:modified_time" content="2023-09-22T13:19:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">环境部署搭建</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="__0"></a>一、 服务器</h2> 
<p>1.购买一个服务器，使用密钥登录<br> <img src="https://images2.imgbox.com/76/9d/XuhXPlRS_o.png" alt="在这里插入图片描述"><br> 2.ssh远程连接<br> ssh连接的工具很多，这里推荐用的是xshell<br> <img src="https://images2.imgbox.com/9d/09/wxAj2poy_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/94/5f/8MD7ifwR_o.png" alt="在这里插入图片描述"><br> 登录成功，开始配置环境。</p> 
<h2><a id="docker_9"></a>二、docker环境部署</h2> 
<p>1、下载docker</p> 
<pre><code class="prism language-java">yum install docker
</code></pre> 
<p><img src="https://images2.imgbox.com/d2/ed/IbSFlKzs_o.png" alt="在这里插入图片描述"></p> 
<p>2、启动docker服务</p> 
<pre><code class="prism language-java">service docker start
chkconfig docker on
</code></pre> 
<p><img src="https://images2.imgbox.com/22/fa/fohVlbci_o.png" alt="在这里插入图片描述"></p> 
<p>3、测试是否安装成功</p> 
<pre><code class="prism language-java">docker version
</code></pre> 
<p><img src="https://images2.imgbox.com/fe/f3/1tpBCZBH_o.png" alt="在这里插入图片描述"></p> 
<p>4、设置国内镜像</p> 
<pre><code class="prism language-java">vi  <span class="token operator">/</span>etc<span class="token operator">/</span>docker<span class="token operator">/</span>daemon<span class="token punctuation">.</span>json

#添加后
<span class="token punctuation">{<!-- --></span>
    <span class="token string">"registry-mirrors"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"https://mirror.ccs.tencentyun.com"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"live-restore"</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>5、重新启动docker服务</p> 
<pre><code class="prism language-java">systemctl daemon<span class="token operator">-</span>reload
service docker restart
</code></pre> 
<p>6、 检查是否生效</p> 
<pre><code class="prism language-java">docker info
</code></pre> 
<p><img src="https://images2.imgbox.com/33/ba/QlAqFts6_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Docker_Compose_55"></a>三、Docker Compose的安装</h2> 
<p>1、安装中间件<br> 下载地址：<br> https://github.com/docker/compose/releases/download/1.28.6/docker-compose-Linux-x86_64<br> 2、导入文件</p> 
<pre><code class="prism language-java">cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin #打开文件夹
rz #选择本地文件到服务器
</code></pre> 
<p><img src="https://images2.imgbox.com/95/5c/tls67wVF_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/9d/47/3tn64HrZ_o.png" alt="在这里插入图片描述"></p> 
<p>3、将可执行权限应用于二进制文件</p> 
<pre><code class="prism language-java">sudo chmod <span class="token operator">+</span>x <span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>docker<span class="token operator">/</span>docker<span class="token operator">-</span>compose
</code></pre> 
<p>4、测试是否安装成功</p> 
<pre><code class="prism language-java">docker<span class="token operator">-</span>compose <span class="token operator">--</span>version
</code></pre> 
<p><img src="https://images2.imgbox.com/d2/56/3O2KFQ5r_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="docker_80"></a>四、docker常用命令</h2> 
<pre><code class="prism language-java">拉取docker镜像
docker pull image_name

查看宿主机上的镜像，<span class="token class-name">Docker</span>镜像保存在<span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>docker目录下<span class="token operator">:</span>
docker images

删除镜像
docker rmi docker<span class="token punctuation">.</span>io<span class="token operator">/</span>tomcat<span class="token operator">:</span><span class="token number">7.0</span><span class="token number">.77</span><span class="token operator">-</span>jre7 
或者 docker rmi b39c68b7af30

查看当前有哪些容器正在运行
docker ps

查看所有容器
docker ps <span class="token operator">-</span>a

启动、停止、重启容器命令：
docker start container_name<span class="token operator">/</span>container_id docker stop container_name<span class="token operator">/</span>container_id docker restart container_name<span class="token operator">/</span>container_id

后台启动一个容器后，如果想进入到这个容器，可以使用attach命令：
docker attach container_name<span class="token operator">/</span>container_id

删除容器的命令：
docker rm container_name<span class="token operator">/</span>container_id

删除所有停止的容器：
docker rm $<span class="token punctuation">(</span>docker ps <span class="token operator">-</span>a <span class="token operator">-</span>q<span class="token punctuation">)</span>

查看当前系统<span class="token class-name">Docker</span>信息
docker info

从<span class="token class-name">Docker</span> hub上下载某个镜像<span class="token operator">:</span>
docker pull centos<span class="token operator">:</span>latest docker pull centos<span class="token operator">:</span>latest

查找<span class="token class-name">Docker</span> <span class="token class-name">Hub</span>上的nginx镜像
docker search nginx
</code></pre> 
<h2><a id="MySQL_120"></a>五、MySQL部署</h2> 
<p>1、创建挂载目录</p> 
<pre><code class="prism language-java">#创建挂载目录
mkdir <span class="token operator">-</span>p <span class="token operator">/</span>data<span class="token operator">/</span>mysql<span class="token operator">/</span>data<span class="token punctuation">;</span>
mkdir <span class="token operator">-</span>p <span class="token operator">/</span>data<span class="token operator">/</span>mysql<span class="token operator">/</span>conf<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/62/0d/K3nANXHg_o.png" alt="在这里插入图片描述"></p> 
<p>2、创建yml文件</p> 
<pre><code class="prism language-java">vim <span class="token operator">/</span>data<span class="token operator">/</span>mysql<span class="token operator">/</span>docker<span class="token operator">-</span>compose<span class="token punctuation">.</span>yml
</code></pre> 
<pre><code class="prism language-java">#填入配置
version<span class="token operator">:</span> <span class="token char">'3'</span>
services<span class="token operator">:</span>
  mysql<span class="token operator">:</span>
    image<span class="token operator">:</span> mysql<span class="token operator">:</span><span class="token number">5.7</span> #mysql版本
    container_name<span class="token operator">:</span> mysql
    volumes<span class="token operator">:</span>
      <span class="token operator">-</span> <span class="token operator">/</span>data<span class="token operator">/</span>mysql<span class="token operator">/</span>data<span class="token operator">:</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>mysql
      <span class="token operator">-</span> <span class="token operator">/</span>data<span class="token operator">/</span>mysql<span class="token operator">/</span>conf<span class="token operator">/</span>my<span class="token punctuation">.</span>cnf<span class="token operator">:</span><span class="token operator">/</span>etc<span class="token operator">/</span>mysql<span class="token operator">/</span>mysql<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>d<span class="token operator">/</span>mysqld<span class="token punctuation">.</span>cnf
    restart<span class="token operator">:</span> always
    ports<span class="token operator">:</span>
      <span class="token operator">-</span> <span class="token number">3306</span><span class="token operator">:</span><span class="token number">3306</span>
    environment<span class="token operator">:</span>
      <span class="token constant">MYSQL_ROOT_PASSWORD</span><span class="token operator">:</span> <span class="token number">123456</span> #root用户密码
      <span class="token constant">TZ</span><span class="token operator">:</span> <span class="token class-name">Asia</span><span class="token operator">/</span><span class="token class-name">Shanghai</span>
    command<span class="token operator">:</span> <span class="token operator">--</span>character<span class="token operator">-</span>set<span class="token operator">-</span>server<span class="token operator">=</span>utf8mb4 <span class="token operator">--</span>collation<span class="token operator">-</span>server<span class="token operator">=</span>utf8mb4_unicode_ci
</code></pre> 
<p>3、创建配置文件<br> vim /data/mysql/conf/my.cnf</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
<span class="token keyword">default</span><span class="token operator">-</span>storage<span class="token operator">-</span>engine<span class="token operator">=</span><span class="token constant">INNODB</span>  # 创建新表时将使用的默认存储引擎
character<span class="token operator">-</span>set<span class="token operator">-</span>server<span class="token operator">=</span>utf8mb4      # 设置mysql服务端默认字符集
pid<span class="token operator">-</span>file        <span class="token operator">=</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>mysqld<span class="token operator">/</span>mysqld<span class="token punctuation">.</span>pid  # pid文件所在目录
socket          <span class="token operator">=</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>mysqld<span class="token operator">/</span>mysqld<span class="token punctuation">.</span>sock # 用于本地连接的socket套接字
datadir         <span class="token operator">=</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>mysql              # 数据文件存放的目录
symbolic<span class="token operator">-</span>links<span class="token operator">=</span><span class="token number">0</span>
sql_mode<span class="token operator">=</span><span class="token constant">STRICT_TRANS_TABLES</span><span class="token punctuation">,</span><span class="token constant">NO_ZERO_IN_DATE</span><span class="token punctuation">,</span><span class="token constant">NO_ZERO_DATE</span><span class="token punctuation">,</span><span class="token constant">ERROR_FOR_DIVISION_BY_ZERO</span><span class="token punctuation">,</span><span class="token constant">NO_ENGINE_SUBSTITUTION</span> # 定义mysql应该支持的sql语法，数据校验等<span class="token operator">!</span>

# 允许最大连接数
max_connections<span class="token operator">=</span><span class="token number">200</span>


# 同一局域网内注意要唯一
server<span class="token operator">-</span>id<span class="token operator">=</span><span class="token number">3306</span>
# 开启二进制日志功能 <span class="token operator">&amp;</span> 日志位置存放位置`<span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>mysql`
#log<span class="token operator">-</span>bin<span class="token operator">=</span>mysql<span class="token operator">-</span>bin
log<span class="token operator">-</span>bin<span class="token operator">=</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>mysql<span class="token operator">/</span>mysql<span class="token operator">-</span>bin
# binlog格式
# <span class="token number">1.</span> <span class="token constant">STATEMENT</span>：基于<span class="token constant">SQL</span>语句的模式，binlog 数据量小，但是某些语句和函数在复制过程可能导致数据不一致甚至出错；
# <span class="token number">2.</span> <span class="token constant">MIXED</span>：混合模式，根据语句来选用是 <span class="token constant">STATEMENT</span> 还是 <span class="token constant">ROW</span> 模式；
# <span class="token number">3.</span> <span class="token constant">ROW</span>：基于行的模式，记录的是行的完整变化。安全，但 binlog 会比其他两种模式大很多；
binlog_format<span class="token operator">=</span><span class="token constant">ROW</span>
# <span class="token constant">FULL</span>：binlog记录每一行的完整变更 <span class="token constant">MINIMAL</span>：只记录影响后的行
binlog_row_image<span class="token operator">=</span><span class="token constant">FULL</span>
# 日志文件大小
max_binlog_size<span class="token operator">=</span><span class="token number">100</span>M
# 定义清除过期日志的时间<span class="token punctuation">(</span>这里设置为<span class="token number">7</span>天<span class="token punctuation">)</span>
expire_logs_days<span class="token operator">=</span><span class="token number">7</span>

# <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> ↑↑↑ mysql主从同步配置end ↑↑↑ <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

<span class="token punctuation">[</span>mysql<span class="token punctuation">]</span>
<span class="token keyword">default</span><span class="token operator">-</span>character<span class="token operator">-</span>set<span class="token operator">=</span>utf8mb4

<span class="token punctuation">[</span>client<span class="token punctuation">]</span>
<span class="token keyword">default</span><span class="token operator">-</span>character<span class="token operator">-</span>set<span class="token operator">=</span>utf8mb4  # 设置mysql客户端默认字符集
</code></pre> 
<p>4、启动容器</p> 
<blockquote> 
 <p>注意：到对应目录文件下，记得服务器开防火墙</p> 
</blockquote> 
<pre><code class="prism language-java">cd <span class="token operator">/</span>data<span class="token operator">/</span>mysql
docker<span class="token operator">-</span>compose up <span class="token operator">-</span>d
</code></pre> 
<p><img src="https://images2.imgbox.com/93/6f/mGPqRxy4_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>Error:3306端口号被占用</p> 
</blockquote> 
<pre><code class="prism language-java">#错误信息

<span class="token punctuation">[</span>root<span class="token annotation punctuation">@VM</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>centos mysql<span class="token punctuation">]</span># docker<span class="token operator">-</span>compose up <span class="token operator">-</span>d
<span class="token class-name">Starting</span> mysql <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
<span class="token class-name">Starting</span> mysql <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> error

<span class="token constant">ERROR</span><span class="token operator">:</span> <span class="token keyword">for</span> mysql  <span class="token class-name">Cannot</span> start service mysql<span class="token operator">:</span> driver failed programming external connectivity on endpoint mysql <span class="token punctuation">(</span><span class="token number">719971d</span><span class="token number">0</span>ba14ce99914053128e9a8e92a268346e7d86eaa07ebcd9b005ea86a1<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Error</span> starting userland proxy<span class="token operator">:</span> listen tcp <span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span><span class="token operator">:</span><span class="token number">3306</span><span class="token operator">:</span> bind<span class="token operator">:</span> address already in use

<span class="token constant">ERROR</span><span class="token operator">:</span> <span class="token keyword">for</span> mysql  <span class="token class-name">Cannot</span> start service mysql<span class="token operator">:</span> driver failed programming external connectivity on endpoint mysql <span class="token punctuation">(</span><span class="token number">719971d</span><span class="token number">0</span>ba14ce99914053128e9a8e92a268346e7d86eaa07ebcd9b005ea86a1<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Error</span> starting userland proxy<span class="token operator">:</span> listen tcp <span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span><span class="token operator">:</span><span class="token number">3306</span><span class="token operator">:</span> bind<span class="token operator">:</span> address already in use
<span class="token constant">ERROR</span><span class="token operator">:</span> <span class="token class-name">Encountered</span> errors <span class="token keyword">while</span> bringing up the project<span class="token punctuation">.</span>

# 尝试解决手段，杀死占用对应端口进程
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@VM</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>centos mysql<span class="token punctuation">]</span>#  sudo netstat <span class="token operator">-</span>apn <span class="token operator">|</span> grep <span class="token number">3306</span>
tcp6       <span class="token number">0</span>      <span class="token number">0</span> <span class="token operator">::</span><span class="token operator">:</span><span class="token number">3306</span>                 <span class="token operator">::</span><span class="token operator">:</span><span class="token operator">*</span>                    <span class="token constant">LISTEN</span>      <span class="token number">17082</span><span class="token operator">/</span>mysqld        
unix  <span class="token number">2</span>      <span class="token punctuation">[</span> <span class="token punctuation">]</span>         <span class="token constant">DGRAM</span>                    <span class="token number">13306</span>    <span class="token number">566</span><span class="token operator">/</span>dbus<span class="token operator">-</span>daemon      
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@VM</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>centos mysql<span class="token punctuation">]</span># tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">3306</span>          <span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span><span class="token operator">:</span><span class="token operator">*</span>               <span class="token constant">LISTEN</span>      <span class="token number">9727</span><span class="token operator">/</span>mysqld  
<span class="token operator">-</span>bash<span class="token operator">:</span> tcp<span class="token operator">:</span> command not found
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@VM</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>centos mysql<span class="token punctuation">]</span># sudo netstat <span class="token operator">-</span>apn <span class="token operator">|</span> grep <span class="token number">3306</span>
tcp6       <span class="token number">0</span>      <span class="token number">0</span> <span class="token operator">::</span><span class="token operator">:</span><span class="token number">3306</span>                 <span class="token operator">::</span><span class="token operator">:</span><span class="token operator">*</span>                    <span class="token constant">LISTEN</span>      <span class="token number">17082</span><span class="token operator">/</span>mysqld        
unix  <span class="token number">2</span>      <span class="token punctuation">[</span> <span class="token punctuation">]</span>         <span class="token constant">DGRAM</span>                    <span class="token number">13306</span>    <span class="token number">566</span><span class="token operator">/</span>dbus<span class="token operator">-</span>daemon      
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@VM</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>centos mysql<span class="token punctuation">]</span># sudo kill <span class="token operator">-</span><span class="token number">9</span> <span class="token number">17082</span>
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@VM</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>centos mysql<span class="token punctuation">]</span># sudo netstat <span class="token operator">-</span>apn <span class="token operator">|</span> grep <span class="token number">3306</span>
tcp6       <span class="token number">0</span>      <span class="token number">0</span> <span class="token operator">::</span><span class="token operator">:</span><span class="token number">3306</span>                 <span class="token operator">::</span><span class="token operator">:</span><span class="token operator">*</span>                    <span class="token constant">LISTEN</span>      <span class="token number">6369</span><span class="token operator">/</span>mysqld         
unix  <span class="token number">2</span>      <span class="token punctuation">[</span> <span class="token punctuation">]</span>         <span class="token constant">DGRAM</span>                    <span class="token number">13306</span>    <span class="token number">566</span><span class="token operator">/</span>dbus<span class="token operator">-</span>daemon      

# 彻底解决手段
#<span class="token number">1</span>、查看mysql的进程<span class="token constant">PID</span><span class="token operator">:</span>  sudo lsof <span class="token operator">-</span>i <span class="token operator">:</span><span class="token number">3306</span>
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@VM</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>centos <span class="token operator">~</span><span class="token punctuation">]</span># sudo lsof <span class="token operator">-</span>i <span class="token operator">:</span><span class="token number">3306</span>
<span class="token constant">COMMAND</span>  <span class="token constant">PID</span>  <span class="token constant">USER</span>   <span class="token constant">FD</span>   <span class="token constant">TYPE</span>  <span class="token constant">DEVICE</span> <span class="token constant">SIZE</span><span class="token operator">/</span><span class="token constant">OFF</span> <span class="token constant">NODE</span> <span class="token constant">NAME</span>
mysqld  <span class="token number">6369</span> mysql   <span class="token number">17</span>u  <span class="token class-name">IPv6</span> <span class="token number">3392314</span>      <span class="token number">0</span>t0  <span class="token constant">TCP</span> <span class="token operator">*</span><span class="token operator">:</span>mysql <span class="token punctuation">(</span><span class="token constant">LISTEN</span><span class="token punctuation">)</span>

#<span class="token number">2</span>、 杀死进程<span class="token constant">PID</span>：  sudo kill <span class="token number">6369</span>
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@VM</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>centos <span class="token operator">~</span><span class="token punctuation">]</span># sudo kill <span class="token number">6369</span>

</code></pre> 
<pre><code class="prism language-java">#docker<span class="token operator">-</span>compose加载mysql
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@VM</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>centos mysql<span class="token punctuation">]</span># docker<span class="token operator">-</span>compose up <span class="token operator">-</span>d
<span class="token class-name">Starting</span> mysql <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> done
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@VM</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>centos mysql<span class="token punctuation">]</span># docker<span class="token operator">-</span>compose up <span class="token operator">-</span>d
mysql is up<span class="token operator">-</span><span class="token keyword">to</span><span class="token operator">-</span>date
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@VM</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span>centos mysql<span class="token punctuation">]</span># docker ps
<span class="token constant">CONTAINER</span> <span class="token constant">ID</span>        <span class="token constant">IMAGE</span>               <span class="token constant">COMMAND</span>                  <span class="token constant">CREATED</span>             <span class="token constant">STATUS</span>              <span class="token constant">PORTS</span>                               <span class="token constant">NAMES</span>
<span class="token number">275834062</span>b57        mysql<span class="token operator">:</span><span class="token number">5.7</span>           <span class="token string">"docker-entrypoint..."</span>   <span class="token number">20</span> minutes ago      <span class="token class-name">Up</span> <span class="token class-name">About</span> a minute   <span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span><span class="token operator">:</span><span class="token number">3306</span><span class="token operator">-&gt;</span><span class="token number">3306</span><span class="token operator">/</span>tcp<span class="token punctuation">,</span> <span class="token number">33060</span><span class="token operator">/</span>tcp   mysql

</code></pre> 
<p>5、navicate测试链接成功</p> 
<blockquote> 
 <p>注意：开启防火墙，3306<br> <img src="https://images2.imgbox.com/6a/11/GcChR0pe_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>创建数据库，编辑连接，只看自己需要的数据库。<br> <img src="https://images2.imgbox.com/e8/e1/d6PXgrkD_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/50/69/cxAIyacA_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Redis_267"></a>六、Redis部署</h2> 
<p>1、创建挂载目录</p> 
<pre><code class="prism language-java">#创建挂载目录
mkdir <span class="token operator">-</span>p <span class="token operator">/</span>data<span class="token operator">/</span>redis
</code></pre> 
<p>2、创建yml文件</p> 
<pre><code class="prism language-java">vim <span class="token operator">/</span>data<span class="token operator">/</span>redis<span class="token operator">/</span>docker<span class="token operator">-</span>compose<span class="token punctuation">.</span>yml
#填入配置
version<span class="token operator">:</span> <span class="token char">'3'</span>
services<span class="token operator">:</span>
  redis<span class="token operator">:</span>
    image<span class="token operator">:</span> redis<span class="token operator">:</span><span class="token number">6.2</span><span class="token number">.6</span>
    container_name<span class="token operator">:</span> redis
    restart<span class="token operator">:</span> always
    ports<span class="token operator">:</span>
      <span class="token operator">-</span> <span class="token number">6379</span><span class="token operator">:</span><span class="token number">6379</span>
    volumes<span class="token operator">:</span>
      <span class="token operator">-</span> <span class="token operator">/</span>data<span class="token operator">/</span>redis<span class="token operator">/</span>redis<span class="token punctuation">.</span>conf<span class="token operator">:</span><span class="token operator">/</span>etc<span class="token operator">/</span>redis<span class="token operator">/</span>redis<span class="token punctuation">.</span>conf
      <span class="token operator">-</span> <span class="token operator">/</span>data<span class="token operator">/</span>redis<span class="token operator">/</span>data<span class="token operator">:</span><span class="token operator">/</span>data
      <span class="token operator">-</span> <span class="token operator">/</span>data<span class="token operator">/</span>redis<span class="token operator">/</span>logs<span class="token operator">:</span><span class="token operator">/</span>logs
    command<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"redis-server"</span><span class="token punctuation">,</span><span class="token string">"/etc/redis/redis.conf"</span><span class="token punctuation">]</span>
</code></pre> 
<p>3、创建挂载的配置文件</p> 
<pre><code class="prism language-java">vim <span class="token operator">/</span>data<span class="token operator">/</span>redis<span class="token operator">/</span>redis<span class="token punctuation">.</span>conf

<span class="token keyword">protected</span><span class="token operator">-</span>mode no
port <span class="token number">6379</span>
timeout <span class="token number">0</span>
#rdb配置
save <span class="token number">900</span> <span class="token number">1</span>
save <span class="token number">300</span> <span class="token number">10</span>
save <span class="token number">60</span> <span class="token number">10000</span>
rdbcompression yes
dbfilename dump<span class="token punctuation">.</span>rdb
dir <span class="token operator">/</span>data
appendonly yes
appendfsync everysec
#设置你的redis密码
requirepass <span class="token number">123456</span>
</code></pre> 
<blockquote> 
 <p>protected-mode no不加，服务连不上redis的<br> 4、启动容器</p> 
</blockquote> 
<pre><code class="prism language-java">cd <span class="token operator">/</span>data<span class="token operator">/</span>redis
docker<span class="token operator">-</span>compose up <span class="token operator">-</span>d
#如果需要强制重新构建
docker<span class="token operator">-</span>compose up <span class="token operator">--</span>force<span class="token operator">-</span>recreate <span class="token operator">-</span>d
</code></pre> 
<blockquote> 
 <p>防火墙开端口号 6379</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/fe/26/hIfEeDYw_o.png" alt="在这里插入图片描述"></p> 
<p>5、AnotherRedis测试连接</p> 
<blockquote> 
 <p>注意：开启redis服务</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/10/4e/rwPuXLZZ_o.png" alt="在这里插入图片描述"><br> 测试成功<br> <img src="https://images2.imgbox.com/02/b2/ZtcXRZgf_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6f5bf9b02efb9286359634848acc4e1c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">docker中安装Ubuntu20，浏览器访问其图形界面</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a37215f019be26fe641eb80cc40088f0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">以root用户创建docker容器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>