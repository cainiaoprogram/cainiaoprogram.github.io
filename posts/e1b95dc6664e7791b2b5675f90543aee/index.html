<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux下搭建FTP服务器教程 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux下搭建FTP服务器教程" />
<meta property="og:description" content="一、基本安装
1.运行以下命令安装 vsftpd。
yum install -y vsftpd
2.运行以下命令打开及查看etc/vsftpd
cd /etc/vsftpd
ls
说明：
/etc/vsftpd/vsftpd.conf 是核心配置文件。
/etc/vsftpd/ftpusers 是黑名单文件，此文件里的用户不允许访问 FTP 服务器。
/etc/vsftpd/user_list 是白名单文件，是允许访问 FTP 服务器的用户列表。
/etc/vsftpd/vsftpd_conf_migrate.sh 是vsftpd操作的一些变量和设置
备注：使用命令 rpm -ql vsftpd 可列出vsftpd中包含的文件
3.运行以下命令设置开机自启动。
systemctl enable vsftpd
4.运行以下命令启动 FTP 服务。
systemctl start vsftpd
5.运行以下命令查看 FTP 服务端口。
netstat -antup | grep ftp
6.配置本地用户登录
本地用户登录就是指用户使用 Linux 操作系统中的用户账号和密码登录 FTP 服务器。
vsftpd 安装后默只支持匿名 FTP 登录，用户如果试图使用 Linux 操作系统中的账号登录服务器，将会被 vsftpd 拒绝，但可以在 vsftpd 里配置用户账号和密码登录。具体步骤如下：
a.运行以下命令创建 ftptest 用户。
useradd ftptest (删除用户命令：sudo userdel -r newuser)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e1b95dc6664e7791b2b5675f90543aee/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-05-10T23:18:49+08:00" />
<meta property="article:modified_time" content="2018-05-10T23:18:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux下搭建FTP服务器教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p></p> 
<p><span style="font-family:'Microsoft YaHei';color:#000000;"><span style="font-size:16px;"><strong>一、基本安装</strong></span></span></p> 
<span style="font-family:'Microsoft YaHei';color:#000000;"><span style="font-size:14px;"><strong>1.运行以下命令安装 vsftpd。</strong></span><br></span> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#ff0000;">yum install -y vsftpd</span></p> 
<span style="font-family:'Microsoft YaHei';font-size:14px;"><strong style="color:rgb(0,0,0);">2.运行以下命令打开及查看etc/vsftpd</strong><br><span style="color:#ff0000;">cd /etc/vsftpd<br>ls</span><br><span style="color:#000000;">说明：</span><br><span style="color:#000000;">/etc/vsftpd/vsftpd.conf 是核心配置文件。</span><br><span style="color:#000000;">/etc/vsftpd/ftpusers 是黑名单文件，此文件里的用户不允许访问 FTP 服务器。</span><br><span style="color:#000000;">/etc/vsftpd/user_list  是白名单文件，是允许访问 FTP 服务器的用户列表。</span><br><span style="color:#000000;">/etc/vsftpd/vsftpd_conf_migrate.sh  是vsftpd操作的一些变量和设置</span><br></span> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;">备注：使用命令 rpm -ql vsftpd  可列出vsftpd中包含的文件</span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;"><img src="https://images2.imgbox.com/ee/c9/vWsNmkx7_o.png" alt=""><br></span></span></p> 
<span style="font-family:'Microsoft YaHei';font-size:14px;"><br><span style="color:#000000;"><strong>3.运行以下命令设置开机自启动。</strong></span><br></span> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#ff0000;">systemctl enable vsftpd</span></span></p> 
<span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;"><strong>4.运行以下命令启动 FTP 服务。</strong></span><br></span> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#ff0000;">systemctl start vsftpd</span></p> 
<span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;"><strong>5.运行以下命令查看 FTP 服务端口。</strong></span><br></span> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#ff0000;">netstat -antup | grep ftp</span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#ff0000;"><img src="https://images2.imgbox.com/3c/f4/YjIWwkMd_o.png" alt=""><br></span></span></p> 
<span style="font-family:'Microsoft YaHei';font-size:14px;"><br><span style="color:#000000;"><strong>6.配置本地用户登录</strong></span><br><span style="color:#000000;">本地用户登录就是指用户使用 Linux 操作系统中的用户账号和密码登录 FTP 服务器。</span><br></span> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;">vsftpd 安装后默只支持匿名 FTP 登录，用户如果试图使用 Linux 操作系统中的账号登录服务器，将会被 vsftpd 拒绝，但可以在 vsftpd 里配置用户账号和密码登录。具体步骤如下：</span></span></p> 
<span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;">a.运行以下命令创建 ftptest 用户。</span><br><span style="color:#ff0000;">useradd ftptest   </span><br><span style="color:#000000;">(删除用户命令：sudo userdel -r newuser)</span><br><span style="color:#000000;">b.运行以下命令修改 ftptest 用户密码。</span><br></span> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#ff0000;">passwd ftptest</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#ff0000;"><img src="https://images2.imgbox.com/04/71/YYGe9tRJ_o.png" alt=""><br></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;"><strong>7.修改/etc/vsftpd/vsftpd.conf</strong><br>a.运行vim /etc/vsftpd/vsftpd.conf。<br>b.按键 “i” 进入编辑模式。<br>c.将是否允许匿名登录 FTP 的参数修改为anonymous enable=NO。<br>d.将是否允许本地用户登录 FTP 的参数修改为local_enable=YES。<br>e.按键 “Esc” 退出编辑模式，然后按键“：wq” 保存并退出文件。<br>f.运行命令 cat /etc/vsftpd/vsftpd.conf 查看配置文件内容。</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;"><img src="https://images2.imgbox.com/12/58/A7F9JLWq_o.png" alt=""><br></span></p> 
<span style="font-family:'Microsoft YaHei';"><br></span> 
<p><span style="font-family:'Microsoft YaHei';"><span style="font-size:16px;color:#000000;"><strong>二、基本配置</strong></span></span></p> 
<p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;color:#000000;">完成vsftpd安装后发现无法远程连接，仍需要完成以下配置。</span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">原因分析：</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">FTP连接方式分为：主动模式和被动模式。默认为被动模式。<br></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">如果为被动模式，服务器端必须监听至少一个额外的被动模式端口。所以，若只开通20和21端口是不够的，需要另外配置入站端口。</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">以下以阿里云服务器为例：</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;"><img src="https://images2.imgbox.com/9d/9a/o60qwaho_o.png" alt=""><br></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">在阿里云安全组中，开启8800/8899,20/21 端口 ，也可自定义（后面配置需要用到），仅做参考。</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">备注参考信息：</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">FTP的连接一般是有两个连接的，一个是客户程和服务器传输命令的，另一个是数据传送的连接。FTP服务程序一般会支持两种不同的模式，一种是Port模式，一种是Passive模式(Pasv Mode),我先说说这两种不同模式连接方式的分别。<br>先假设客户端为C,服务端为S.<br>Port模式:<br>当客户端C向服务端S连接后，使用的是Port模式,那么客户端C会发送一条命令告诉服务端S(客户端C在本地打开了一个端口N在等着你进行数据连接),当服务端S收到这个Port命令后 就会向客户端打开的那个端口N进行连接，这种数据连接就生成了。<br>Pasv模式:<br></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">当客户端C向服务端S连接后，服务端S会发信息给客户端C,这个信息是(服务端S在本地打开了一个端口M,你现在去连接我吧),当客户端C收到这个信息后，就可以向服务端S的M端口进行连接,连接成功后，数据连接也建立了。</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">参考链接：https://blog.csdn.net/binsoft/article/details/44595677 （貌似也是转载的，找不到原文...）</span></p> 
<p><strong><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">添加配置信息 修改配置文件 vim /etc/vsftpd/vsftpd.conf</span></strong></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">在文件末尾添加：<br>pasv_enable=YES       <br>pasv_min_port=8800<br>pasv_max_port=8899<br></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;">解释：</span><br><span style="color:#ff0000;">8800/8899 </span><span style="color:#000000;">为上面安全组添加的端口号</span><br><span style="color:#ff0000;">pasv_enable=YES|NO</span><br><span style="color:#000000;">YES，允许数据传输时使用PASV模式。NO，不允许使用PASV模式。默认值为YES。</span><br><span style="color:#ff0000;">pasv_min_port=port number <br>pasv_max_port=port number</span><br></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;">设定在PASV模式下，建立数据传输所可以使用port范围的下界和上界，0 表示任意。默认值为0。把端口范围设在比较高的一段范围内，比如50000-60000，将有助于安全性的提高。</span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;">完成以上配置，基本可以实现远程连接FTP。对了，配置完成记得重启服务器</span><span style="font-family:'Microsoft YaHei';"><span style="color:#ff0000;">systemctl restart vsftpd</span></span></span></p> 
<p><strong style="color:rgb(0,0,0);font-family:'Microsoft YaHei';font-size:18px;">三、配置 vsftpd 限制 FTP 账户访问其它目录</strong></p> 
<p></p> 
<p><span style="color:rgb(0,0,0);"><span style="font-family:'Microsoft YaHei';font-size:14px;">使用 vsftpd 搭建 FTP 服务，可以配置用户登录后，限制访问其它的目录，只能进它的主目录。 配置方法如下：</span></span></p> 
<span style="color:rgb(0,0,0);"><span style="font-family:'Microsoft YaHei';font-size:14px;">1、打开 vsftp 的配置文件 vim /etc/vsftpd/vsftpd.conf  找到 chroot Chroot_local_user<br></span></span> 
<p><span style="font-size:14px;"><span style="color:rgb(0,0,0);"><span style="font-family:'Microsoft YaHei';">     设置所有的本地用户都执行 chroot chroot_local_user=yes （本地所有帐户都只能在自家目录）</span></span><span style="font-family:'Microsoft YaHei';color:rgb(0,0,0);"> </span></span></p> 
<span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">2、设置指定用户执行 chroot<br></span> 
<p><span style="color:rgb(0,0,0);"><span style="font-family:'Microsoft YaHei';font-size:14px;">      找到并修改 chroot_list_enable=yes </span></span></p> 
<p><span style="font-size:14px;"><span style="font-family:'Microsoft YaHei';color:#000000;">3、chroot_list_file=/ 任意指定的路径 /chroot_list （文件中的名单可以调用）<br>注意：vsftpd.chroot_list 是没有创建的需要自己创建。若不想限制个别用户，将用户名添加到vsftpd.chroot_list文件中，每个用户名一行。</span></span></p> 
<p><img src="https://images2.imgbox.com/c4/36/VR5uvrPr_o.png" alt=""></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#ff0000;">4<span style="font-family:'Microsoft YaHei';font-size:14px;">、</span>在文件末尾添加 <br></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#ff0000;">allow_writeable_chroot=YES #对vsftpd有用，否则，因home目录权限为root权限而无法登录</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#ff0000;">5、为 /home/ftptest 添加权限</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#ff0000;"><img src="https://images2.imgbox.com/8e/7c/oETNIWgC_o.png" alt=""><br></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;">6.重启服务器</span><br></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#ff0000;">systemctl restart vsftpd</span></span></p> 
<p><span style="font-family:'Microsoft YaHei';"><span style="font-size:16px;color:#000000;"><strong>四、</strong></span><span style="background-color:rgb(255,255,255);"><span style="font-size:16px;color:#000000;"><strong>vsftpd修改默认端口</strong></span></span><br></span></p> 
<p></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">1、编辑/etc/vsftpd/vsftpd.conf 文件，在该配置文件末尾添加此行：listen_port=6709</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;"><img src="https://images2.imgbox.com/bc/7b/IGCb65Wv_o.png" alt=""><br></span></p> 
<span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">2、编辑/etc/services 文件，将其中的<br>ftp 21/tcp  改为 ftp 6709/tcp ,<br></span> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">ftp 21/udp  改为 ftp 6709/<span style="color:rgb(0,0,0);font-family:'Microsoft YaHei';font-size:14px;">udp</span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;"><span style="color:rgb(0,0,0);font-family:'Microsoft YaHei';font-size:14px;"><img src="https://images2.imgbox.com/f2/c7/nj8wAGlE_o.png" alt=""><br></span></span></p> 
<span style="font-family:'Microsoft YaHei';font-size:14px;color:#000000;">3、重新启动vsftpd 服务。<br>4、运行命令 </span> 
<span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#ff0000;">netstat -tnulp | grep vsftpd</span><br></span> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;">可以查看到现在系统现监听的vsftpd 的端口为6709</span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;"><img src="https://images2.imgbox.com/70/cf/WdrK9cuD_o.png" alt=""><br></span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;">5、最后不要忘记到阿里云安全组添加6709端口号</span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;"><span style="font-size:16px;color:#000000;font-family:'Microsoft YaHei';"><strong>五、<span style="background-color:rgb(255,255,255);">本文参考</span></strong></span><br></span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;"><span style="background-color:rgb(255,255,255);">1.<a href="https://help.aliyun.com/document_detail/51998.html?spm=5176.11065259.1996646101.searchclickresult.232f56b2leo5fC#h2-linux-ftp-2" rel="nofollow">https://help.aliyun.com/document_detail/51998.html?spm=5176.11065259.1996646101.searchclickresult.232f56b2leo5fC#h2-linux-ftp-2</a></span></span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;"><span style="background-color:rgb(255,255,255);">2.<a href="https://help.aliyun.com/knowledge_detail/41291.html?spm=a2c4g.11186623.4.5.jTvPdu" rel="nofollow">https://help.aliyun.com/knowledge_detail/41291.html?spm=a2c4g.11186623.4.5.jTvPdu</a></span></span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;"><span style="background-color:rgb(255,255,255);">3.<a href="https://blog.csdn.net/zhuixunhebe1/article/details/77651588">https://blog.csdn.net/zhuixunhebe1/article/details/77651588</a></span></span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;"><span style="background-color:rgb(255,255,255);">4.<a href="http://blog.51cto.com/mingxiaoming/1974715" rel="nofollow">http://blog.51cto.com/mingxiaoming/1974715</a></span></span></span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;"><span style="color:#000000;"><span style="background-color:rgb(255,255,255);">5.<a href="https://blog.csdn.net/binsoft/article/details/44595677">https://blog.csdn.net/binsoft/article/details/44595677</a></span></span></span></p> 
<p><br></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/343c5aa4e0949348ff8ca55b03ffc38f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">js保存文件流</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7de4d5fa537fdce535a631cd2843b4c7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">promise实现多个请求并行串行执行</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>