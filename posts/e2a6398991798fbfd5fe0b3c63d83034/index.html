<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>pandas之apply函数简介及用法详解 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="pandas之apply函数简介及用法详解" />
<meta property="og:description" content="1.基本信息 ​ Pandas 的 apply() 方法是用来调用一个函数(Python method)，让此函数对数据对象进行批量处理。Pandas 的很多对象都可以使用 apply() 来调用函数，如 Dataframe、Series、分组对象、各种时间序列等。
2.语法结构 ​ apply() 使用时，通常放入一个 lambda 函数表达式、或一个函数作为操作运算，官方上给出DataFrame的 apply() 用法：
DataFrame.apply(self, func, axis=0, raw=False, result_type=None, args=(), **kwargs) 参数：
func：函数或 lambda 表达式,应用于每行或者每列
axis：{0 or ‘index’, 1 or ‘columns’}, 默认为0
0 or ‘index’: 表示函数处理的是每一列1 or ‘columns’: 表示函数处理的是每一行 raw：bool 类型，默认为 False;
False ，表示把每一行或列作为 Series 传入函数中；True，表示接受的是 ndarray 数据类型； result_type：{‘expand’, ‘reduce’, ‘broadcast’, None}, default None
These only act when axis=1 (columns):
‘expand’ : 列表式的结果将被转化为列。‘reduce’ : 如果可能的话，返回一个 Series，而不是展开类似列表的结果。这与 expand 相反。‘broadcast’ : 结果将被广播到 DataFrame 的原始形状，原始索引和列将被保留。 args: func 的位置参数" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e2a6398991798fbfd5fe0b3c63d83034/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-07T14:50:37+08:00" />
<meta property="article:modified_time" content="2022-01-07T14:50:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">pandas之apply函数简介及用法详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1_0"></a>1.基本信息</h3> 
<p>​ Pandas 的 <code>apply()</code> 方法是用来调用一个函数(Python method)，让此函数对数据对象进行批量处理。Pandas 的很多对象都可以使用 <code>apply()</code> 来调用函数，如 Dataframe、Series、分组对象、各种时间序列等。</p> 
<h3><a id="2_6"></a>2.语法结构</h3> 
<p>​ <code>apply()</code> 使用时，通常放入一个 <code>lambda</code> 函数表达式、或一个函数作为操作运算，官方上给出DataFrame的 <code>apply()</code> 用法：</p> 
<pre><code class="prism language-python">DataFrame<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> func<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> raw<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> result_type<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p><strong>参数：</strong></p> 
 <ul><li> <p><code>func</code>：函数或 lambda 表达式,应用于每行或者每列</p> </li><li> <p><code>axis</code>：{0 or ‘index’, 1 or ‘columns’}, 默认为0</p> 
   <ul><li>0 or ‘index’: 表示函数处理的是每一列</li><li>1 or ‘columns’: 表示函数处理的是每一行</li></ul> </li><li> <p>raw：bool 类型，默认为 False;</p> 
   <ul><li>False ，表示把每一行或列作为 Series 传入函数中；</li><li>True，表示接受的是 ndarray 数据类型；</li></ul> </li><li> <p>result_type：{‘expand’, ‘reduce’, ‘broadcast’, None}, default None</p> <p>These only act when <code>axis=1</code> (columns):</p> </li><li> 
   <ul><li>‘expand’ : 列表式的结果将被转化为列。</li><li>‘reduce’ : 如果可能的话，返回一个 Series，而不是展开类似列表的结果。这与 <code>expand</code> 相反。</li><li>‘broadcast’ : 结果将被广播到 <code>DataFrame</code> 的原始形状，原始索引和列将被保留。</li></ul> </li><li> <p><code>args:</code> func 的位置参数</p> </li><li> <p><code>**kwargs</code>：要作为关键字参数传递给 func 的其他关键字参数，1.3.0 开始支持</p> </li></ul> 
 <p><strong>返回值：</strong></p> 
 <ul><li>Series 或者 DataFrame：沿数据的给定轴应用 func 的结果</li></ul> 
</blockquote> 
<pre><code class="prism language-markdown">	Objects passed to the function are Series objects whose index is either the DataFrame's index (``axis=0``) or the DataFrame's columns(``axis=1``). 
	传递给函数的对象是Series对象，其索引是DataFrame的索引(axis=0)或DataFrame的列(axis=1)。
	By default (``result_type=None``), the final return type is inferred from the return type of the applied function. Otherwise,it depends on the `result_type` argument.
	默认情况下( result_type=None)，最终的返回类型是从应用函数的返回类型推断出来的。否则，它取决于' result_type '参数。
</code></pre> 
<blockquote> 
 <p>注：DataFrame与Series的区别与联系：</p> 
 <p><strong>区别：</strong></p> 
 <ul><li>series，只是一个一维结构，它由index和value组成。</li><li>dataframe，是一个二维结构，除了拥有index和value之外，还拥有column。</li></ul> 
 <p><strong>联系：</strong></p> 
 <ul><li>dataframe由多个series组成，无论是行还是列，单独拆分出来都是一个series。</li></ul> 
</blockquote> 
<h3><a id="3_64"></a>3.使用案例</h3> 
<h4><a id="31_DataFrameapply_66"></a>3.1 DataFrame使用apply</h4> 
<p><strong>官方使用案例</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df
   A  B
<span class="token number">0</span>  <span class="token number">4</span>  <span class="token number">9</span>
<span class="token number">1</span>  <span class="token number">4</span>  <span class="token number">9</span>
<span class="token number">2</span>  <span class="token number">4</span>  <span class="token number">9</span>


<span class="token comment"># 使用numpy通用函数 (如 np.sqrt(df)),</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
     A    B
0  2.0  3.0
1  2.0  3.0
2  2.0  3.0
'''</span>

<span class="token comment"># 使用聚合功能</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
A    12
B    27
dtype: int64
'''</span>

df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
0    13
1    13
2    13
dtype: int64
'''</span>

<span class="token comment"># 在每行上返回类似列表的内容</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
0    [1, 2]
1    [1, 2]
2    [1, 2]
dtype: object
'''</span>

<span class="token comment"># result_type='expand' 将类似列表的结果扩展到数据的列</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> result_type<span class="token operator">=</span><span class="token string">'expand'</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
   0  1
0  1  2
1  1  2
2  1  2
'''</span>

<span class="token comment"># 在函数中返回一个序列，生成的列名将是序列索引。</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
   foo  bar
0    1    2
1    1    2
2    1    2
'''</span>

<span class="token comment"># result_type='broadcast' 将确保函数返回相同的形状结果</span>
<span class="token comment"># 无论是 list-like 还是 scalar，并沿轴进行广播</span>
<span class="token comment"># 生成的列名将是原始列名。</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> result_type<span class="token operator">=</span><span class="token string">'broadcast'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
A  B
0  1  2
1  1  2
2  1  2
'''</span>
</code></pre> 
<p><strong>其他案例：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df
	A	B	C
a	<span class="token number">1</span>	<span class="token number">4</span>	<span class="token number">7</span>
b	<span class="token number">2</span>	<span class="token number">5</span>	<span class="token number">8</span>
c	<span class="token number">3</span>	<span class="token number">6</span>	<span class="token number">9</span>

<span class="token comment"># 对各列应用函数 axis=0</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
A     <span class="token number">6</span>
B    <span class="token number">15</span>
C    <span class="token number">24</span>
dtype<span class="token punctuation">:</span> int64

<span class="token comment"># 对各行应用函数</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
a    <span class="token number">12</span>
b    <span class="token number">15</span>
c    <span class="token number">18</span>
dtype<span class="token punctuation">:</span> int64
</code></pre> 
<h4><a id="32_Seriesapply_183"></a>3.2 Series使用apply</h4> 
<p><strong>官网案例</strong></p> 
<pre><code class="prism language-python">s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'London'</span><span class="token punctuation">,</span> <span class="token string">'New York'</span><span class="token punctuation">,</span> <span class="token string">'Helsinki'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s
<span class="token triple-quoted-string string">'''
London      20
New York    21
Helsinki    12
dtype: int64
'''</span>

<span class="token comment"># 定义函数并将其作为参数传递给 apply，求值平方化。</span>
<span class="token keyword">def</span> <span class="token function">square</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token keyword">return</span> x <span class="token operator">**</span> <span class="token number">2</span>

s<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>square<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
London      400
New York    441
Helsinki    144
dtype: int64
'''</span>

<span class="token comment"># 通过将匿名函数作为参数传递给 apply</span>
s<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
London      400
New York    441
Helsinki    144
dtype: int64
'''</span>

<span class="token comment"># 定义一个需要附加位置参数的自定义函数</span>
<span class="token comment"># 并使用args关键字传递这些附加参数。</span>
<span class="token keyword">def</span> <span class="token function">subtract_custom_value</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> custom_value<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token keyword">return</span> x <span class="token operator">-</span> custom_value

s<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>subtract_custom_value<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
London      15
New York    16
Helsinki     7
dtype: int64
'''</span>

<span class="token comment"># 定义一个接受关键字参数并将这些参数传递</span>
<span class="token comment"># 给 apply 的自定义函数。</span>
<span class="token keyword">def</span> <span class="token function">add_custom_values</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token keyword">for</span> month <span class="token keyword">in</span> kwargs<span class="token punctuation">:</span>
         x <span class="token operator">+=</span> kwargs<span class="token punctuation">[</span>month<span class="token punctuation">]</span>
     <span class="token keyword">return</span> x

s<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>add_custom_values<span class="token punctuation">,</span> june<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> july<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> august<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
London      95
New York    96
Helsinki    87
dtype: int64
'''</span>

<span class="token comment"># 使用Numpy库中的函数</span>
s<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>log<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
London      2.995732
New York    3.044522
Helsinki    2.484907
dtype: float64
'''</span>
</code></pre> 
<h4><a id="33__258"></a>3.3 其他案例</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 显示所有列</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token comment"># 显示所有行</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_rows'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token comment"># 设置value的显示长度为100，默认为50</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'max_colwidth'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token comment"># 用来计算日期差的包</span>
<span class="token keyword">import</span> datetime


<span class="token keyword">def</span> <span class="token function">dataInterval</span><span class="token punctuation">(</span>data1<span class="token punctuation">,</span> data2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Args:
    :param data1: datetime
    :param data2: datetime
    :return: delta days
    """</span>
    d1 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>data1<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>
    d2 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>data2<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>
    delta <span class="token operator">=</span> d1 <span class="token operator">-</span> d2
    <span class="token keyword">return</span> delta<span class="token punctuation">.</span>days


<span class="token keyword">def</span> <span class="token function">getInterval</span><span class="token punctuation">(</span>arrLike<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token triple-quoted-string string">"""
    Args:
    :param arrLike: DataFrame 
    :return: delta days
    """</span>
    PublishedTime <span class="token operator">=</span> arrLike<span class="token punctuation">[</span><span class="token string">'PublishedTime'</span><span class="token punctuation">]</span>
    ReceivedTime <span class="token operator">=</span> arrLike<span class="token punctuation">[</span><span class="token string">'ReceivedTime'</span><span class="token punctuation">]</span>
    days <span class="token operator">=</span> dataInterval<span class="token punctuation">(</span>PublishedTime<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ReceivedTime<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    <span class="token keyword">return</span> days


<span class="token keyword">def</span> <span class="token function">getInterval_new</span><span class="token punctuation">(</span>arrLike<span class="token punctuation">,</span> before<span class="token punctuation">,</span> after<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    <span class="token triple-quoted-string string">"""
    Args:
    :param arrLike: DataFrame
    :param before: forward time
    :param after: backwar time
    :return: delta days
    """</span>
    before <span class="token operator">=</span> arrLike<span class="token punctuation">[</span>before<span class="token punctuation">]</span>
    after <span class="token operator">=</span> arrLike<span class="token punctuation">[</span>after<span class="token punctuation">]</span>
    days <span class="token operator">=</span> dataInterval<span class="token punctuation">(</span>after<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> before<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
    <span class="token keyword">return</span> days
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'./data/NS_info.xls'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># method 1</span>
    df<span class="token punctuation">[</span><span class="token string">'TimeInterval'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>getInterval<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># method 2</span>
    df<span class="token punctuation">[</span><span class="token string">'TimeInterval'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>getInterval_new<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> 
                                  args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'ReceivedTime'</span><span class="token punctuation">,</span> <span class="token string">'PublishedTime'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
	<span class="token comment"># method 3</span>
    df<span class="token punctuation">[</span><span class="token string">'TimeInterval'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>getInterval_new<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> 
                   <span class="token operator">**</span><span class="token punctuation">{<!-- --></span><span class="token string">'before'</span><span class="token punctuation">:</span> <span class="token string">'ReceivedTime'</span><span class="token punctuation">,</span> <span class="token string">'after'</span><span class="token punctuation">:</span> <span class="token string">'PublishedTime'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
	<span class="token comment"># method 4</span>
    df<span class="token punctuation">[</span><span class="token string">'TimeInterval'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>getInterval_new<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> before<span class="token operator">=</span><span class="token string">'ReceivedTime'</span><span class="token punctuation">,</span> after<span class="token operator">=</span><span class="token string">'PublishedTime'</span><span class="token punctuation">)</span> 
</code></pre> 
<p><img src="https://images2.imgbox.com/24/85/a4PcwDwC_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_332"></a>4.总结</h3> 
<p>1.apply方法都是通过传入一个函数或者lambda表达式对数据进行批量处理</p> 
<p>2.apply方法处理的都是一个Series对象</p> 
<p>参考链接：</p> 
<p>1.https://blog.csdn.net/missyougoon/article/details/83301712</p> 
<p>2.https://blog.csdn.net/qq_19528953/article/details/79348929</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bd5b65060f48c060f3c45ce1ab2733a1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">百度智能云OCR获取APIKey和SecretKey</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/77fd4833c7bd2947f10bfe7418c854ae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">pandas中的read_csv参数详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>