<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Moravec算子实现（C&#43;&#43;） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Moravec算子实现（C&#43;&#43;）" />
<meta property="og:description" content="Moravec算子实现（C&#43;&#43;） 一、Moravec算子原理二、实现代码三、结果及分析 一、Moravec算子原理 考虑某一点与周围像素间的灰度差，以四个方向上具有最小最大灰度方差的点作为特征点。
① 计算各像元的兴趣值IV（Interest Value）
② k值计算（w是窗口大小）及各个方向兴趣值计算
取四个方向中的最小者作为该像元的兴趣值：
③ 给定一经验阈值，将兴趣值大于阈值的点作为候选点
④ 选取候选点中的极值点作为特征点
在一定大小的窗口内，将候选点中兴趣值不是最大者均去掉，仅留下一个兴趣值最大者，该像素即为一个特征点
“抑制局部非最大”
二、实现代码 这是我根据Moravec算子原理写的代码，没有用到opencv里面的库函数，因此在各个方面（无论是运行效率还是效果）都感觉有些欠缺，欢迎批评指正。
#include &#34;gdal_priv.h&#34; #include &#34;cpl_conv.h&#34; #include &lt;iostream&gt; #include &lt;opencv2/highgui/highgui.hpp&gt; #include &lt;opencv2/opencv.hpp&gt; #include&lt;cmath&gt; #include &lt;string&gt; #include &lt;vector&gt; using namespace std; using namespace cv; //main(int argc, char *argv[ ], char **env)才是UNIX和Linux中的标准写法。 int main(int argc, char** argv) { void Moravec(Mat image); //将所有需要的库函数等，导入进来并改变位数为X64 //包括VC&#43;&#43;目录，C/C&#43;&#43;常规、连接器常规等，不同的库路径不同，引入的位置也不同 string filename = &#34;G:/myself/Major/MathPhotograph/Experiment/Picture02.jpg&#34;;//斜杠的方向不能反	//argc: 整数, 用来统计你运行程序时送给main函数的命令行参数的个数 //* argv[ ]: 指针数组，用来存放指向字符串参数的指针，每一个元素指向一个参数 //cout &lt;&lt; filename &lt;&lt; std::endl;	//测试语句 if (argc &gt; 1)	//如果参数比1大的话，就把第一个参数赋值给filename { filename = argv[1];	//将参数赋值给filename //cout &lt;&lt;&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ac5a6618f67c7b7c193fbf43f23578f1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-05T10:53:52+08:00" />
<meta property="article:modified_time" content="2020-12-05T10:53:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Moravec算子实现（C&#43;&#43;）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Moravec算子实现（C++）</h4> 
 <ul><li><a href="#Moravec_10" rel="nofollow">一、Moravec算子原理</a></li><li><a href="#_52" rel="nofollow">二、实现代码</a></li><li><a href="#_174" rel="nofollow">三、结果及分析</a></li></ul> 
</div> 
<p></p> 
<hr size='1"' color="#000000"> 
<h2><a id="Moravec_10"></a>一、Moravec算子原理</h2> 
<p>考虑某一点与周围像素间的灰度差，以四个方向上具有最小最大灰度方差的点作为特征点。<br> <img src="https://images2.imgbox.com/a6/de/fjBGogqt_o.png" alt="在这里插入图片描述"></p> 
<p>① 计算各像元的兴趣值IV（Interest Value）<br> ② k值计算（w是窗口大小）及各个方向兴趣值计算</p> 
<p><img src="https://images2.imgbox.com/48/db/yqCw29Ma_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c2/a0/s4Ud9Z4L_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/af/fe/gPiy8oqD_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e8/89/BE0euYX2_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/86/68/DMd96U9l_o.png" alt="在这里插入图片描述"></p> 
<p>取四个方向中的最小者作为该像元的兴趣值：</p> 
<p><img src="https://images2.imgbox.com/38/95/CNJBMtPF_o.png" alt="在这里插入图片描述"></p> 
<p>③ 给定一经验阈值，将兴趣值大于阈值的点作为候选点</p> 
<p><img src="https://images2.imgbox.com/75/77/MycAyah5_o.png" alt="在这里插入图片描述"></p> 
<p>④ 选取候选点中的极值点作为特征点</p> 
<p>在一定大小的窗口内，将候选点中兴趣值不是最大者均去掉，仅留下一个兴趣值最大者，该像素即为一个特征点<br> <strong>“抑制局部非最大”</strong></p> 
<h2><a id="_52"></a>二、实现代码</h2> 
<p><font color="#999AAA">这是我根据Moravec算子原理写的代码，没有用到opencv里面的库函数，因此在各个方面（无论是运行效率还是效果）都感觉有些欠缺，欢迎批评指正。</font></p> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"gdal_priv.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"cpl_conv.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;opencv2/opencv.hpp&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;cmath&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> cv<span class="token punctuation">;</span>

<span class="token comment">//main(int argc, char *argv[ ], char **env)才是UNIX和Linux中的标准写法。</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> argv<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">void</span> <span class="token function">Moravec</span><span class="token punctuation">(</span>Mat image<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//将所有需要的库函数等，导入进来并改变位数为X64</span>
	<span class="token comment">//包括VC++目录，C/C++常规、连接器常规等，不同的库路径不同，引入的位置也不同</span>
	string filename <span class="token operator">=</span> <span class="token string">"G:/myself/Major/MathPhotograph/Experiment/Picture02.jpg"</span><span class="token punctuation">;</span><span class="token comment">//斜杠的方向不能反	//argc: 整数, 用来统计你运行程序时送给main函数的命令行参数的个数</span>
	<span class="token comment">//* argv[ ]: 指针数组，用来存放指向字符串参数的指针，每一个元素指向一个参数</span>
	<span class="token comment">//cout &lt;&lt; filename &lt;&lt; std::endl;	//测试语句</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>	<span class="token comment">//如果参数比1大的话，就把第一个参数赋值给filename</span>
	<span class="token punctuation">{<!-- --></span>
		filename <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>	<span class="token comment">//将参数赋值给filename</span>
		<span class="token comment">//cout &lt;&lt;"Hey! I'm here."&lt;&lt; filename &lt;&lt; std::endl;  //测试语句</span>
	<span class="token punctuation">}</span>
	Mat image <span class="token operator">=</span> <span class="token function">imread</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> IMREAD_GRAYSCALE<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//灰色样式读取图像到Mat中IMREAD_COLOR//IMREAD_GRAYSCALE//IMREAD_UNCHANGED</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>image<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>	<span class="token comment">//如果为空</span>
	<span class="token punctuation">{<!-- --></span>
		std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not open or find the image."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//namedWindow("Display window", WINDOW_AUTOSIZE);	//建立大小固定的窗体显示图像,可删除</span>
	<span class="token comment">//imshow("Display window", image);</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"图像的类型编号为："</span> <span class="token operator">&lt;&lt;</span> image<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>	<span class="token comment">//网上有类型对应的编号</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"图像的通道数量为："</span> <span class="token operator">&lt;&lt;</span> image<span class="token punctuation">.</span><span class="token function">channels</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">//计算各个像元的兴趣值</span>
	<span class="token function">Moravec</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cv<span class="token operator">::</span><span class="token function">waitKey</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//等待用户需要多长时间毫秒,零意味着永远等待</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//共有两层窗口移动：候选窗口移动（整个）、待求窗口在候选窗口中移动（一行一行）</span>
<span class="token keyword">void</span> <span class="token function">Moravec</span><span class="token punctuation">(</span>Mat image<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> rows <span class="token operator">=</span> image<span class="token punctuation">.</span>rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> cols <span class="token operator">=</span> image<span class="token punctuation">.</span>cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> CandidateWin <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">,</span> window <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>	<span class="token comment">//候选区窗口大小，移动窗口大小</span>
	<span class="token keyword">int</span> candiPositionR <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> candiPositionC <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> g<span class="token punctuation">;</span>	<span class="token comment">//row行，col列，i候选区行，j候选区列</span>
	<span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">(</span>window <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//窗口中心像元</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span>candiPositionR <span class="token operator">+</span> CandidateWin <span class="token operator">&lt;</span> rows <span class="token operator">-</span> window <span class="token operator">||</span> candiPositionC <span class="token operator">&lt;</span> cols <span class="token operator">-</span> window<span class="token punctuation">)</span>	<span class="token comment">//当候选区窗口的坐标小于图像坐标时执行</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//---------------------------临界条件，比for循环多考虑了边缘-------------------------------</span>
		<span class="token comment">//临界条件，神志不清地写了个换行操作</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>candiPositionC <span class="token operator">==</span> cols <span class="token operator">-</span> window<span class="token punctuation">)</span>	<span class="token comment">//列到达边缘时，换行操作，这个要放在上面以免换行溢出</span>
		<span class="token punctuation">{<!-- --></span>
			candiPositionR <span class="token operator">=</span> candiPositionR <span class="token operator">+</span> CandidateWin <span class="token operator">-</span> window<span class="token punctuation">;</span>
			candiPositionC <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>candiPositionC <span class="token operator">+</span> CandidateWin  <span class="token operator">&gt;</span> cols <span class="token operator">&amp;&amp;</span> candiPositionC <span class="token operator">+</span> CandidateWin <span class="token operator">&lt;</span> cols <span class="token operator">+</span> CandidateWin<span class="token punctuation">)</span>		<span class="token comment">//列溢出时</span>
			candiPositionC <span class="token operator">=</span> cols <span class="token operator">-</span> CandidateWin<span class="token punctuation">;</span>	<span class="token comment">//退回相应的列数</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>candiPositionR <span class="token operator">+</span> CandidateWin  <span class="token operator">&gt;</span> rows <span class="token operator">&amp;&amp;</span> candiPositionR <span class="token operator">+</span> CandidateWin <span class="token operator">&lt;</span> rows <span class="token operator">+</span> CandidateWin<span class="token punctuation">)</span>		<span class="token comment">//当行溢出时</span>
			candiPositionR <span class="token operator">=</span> rows <span class="token operator">-</span> CandidateWin<span class="token punctuation">;</span>	<span class="token comment">//退回相应的行数</span>
		<span class="token comment">//--------------------------------------------------分界线---------------------------------------------------------------------	</span>

		<span class="token keyword">long</span> winMax <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>	<span class="token comment">//候选窗口最大值以及最大值坐标</span>
		<span class="token keyword">int</span> maxPositionR <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> maxPositionC <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

		<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> candiPositionR<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> candiPositionR <span class="token operator">+</span> CandidateWin <span class="token operator">-</span> window<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>	<span class="token comment">//i表示待求窗口在候选窗口中的移动位置</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//加上窗口大小减去待选窗口大小，只能在这里面蹦跶</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> candiPositionC<span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> candiPositionC <span class="token operator">+</span> CandidateWin <span class="token operator">-</span> window<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token comment">//计算V1</span>
				<span class="token keyword">int</span> V<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>	<span class="token comment">//四个方向</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span>g <span class="token operator">=</span> <span class="token operator">-</span>k<span class="token punctuation">;</span> g <span class="token operator">&lt;=</span> k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> g<span class="token operator">++</span><span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					V<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>at<span class="token operator">&lt;</span>uchar<span class="token operator">&gt;</span><span class="token punctuation">(</span>i <span class="token operator">+</span> k <span class="token operator">+</span> g<span class="token punctuation">,</span> j <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">-</span> image<span class="token punctuation">.</span>at<span class="token operator">&lt;</span>uchar<span class="token operator">&gt;</span><span class="token punctuation">(</span>i <span class="token operator">+</span> k <span class="token operator">+</span> g <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">//cout &lt;&lt; int(image.at&lt;uchar&gt;(i + k + g, j + k)) &lt;&lt; int(image.at&lt;uchar&gt;(i + k, j + k + g + 1)) &lt;&lt; endl;</span>
					V<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>at<span class="token operator">&lt;</span>uchar<span class="token operator">&gt;</span><span class="token punctuation">(</span>i <span class="token operator">+</span> k <span class="token operator">+</span> g<span class="token punctuation">,</span> j <span class="token operator">+</span> k <span class="token operator">+</span> g<span class="token punctuation">)</span> <span class="token operator">-</span> image<span class="token punctuation">.</span>at<span class="token operator">&lt;</span>uchar<span class="token operator">&gt;</span><span class="token punctuation">(</span>i <span class="token operator">+</span> k <span class="token operator">+</span> g <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> k <span class="token operator">+</span> g <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					V<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>at<span class="token operator">&lt;</span>uchar<span class="token operator">&gt;</span><span class="token punctuation">(</span>i <span class="token operator">+</span> k<span class="token punctuation">,</span> j <span class="token operator">+</span> k <span class="token operator">+</span> g<span class="token punctuation">)</span> <span class="token operator">-</span> image<span class="token punctuation">.</span>at<span class="token operator">&lt;</span>uchar<span class="token operator">&gt;</span><span class="token punctuation">(</span>i <span class="token operator">+</span> k<span class="token punctuation">,</span> j <span class="token operator">+</span> k <span class="token operator">+</span> g <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					V<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>at<span class="token operator">&lt;</span>uchar<span class="token operator">&gt;</span><span class="token punctuation">(</span>i <span class="token operator">+</span> k <span class="token operator">+</span> g<span class="token punctuation">,</span> j <span class="token operator">+</span> k <span class="token operator">-</span> g<span class="token punctuation">)</span> <span class="token operator">-</span> image<span class="token punctuation">.</span>at<span class="token operator">&lt;</span>uchar<span class="token operator">&gt;</span><span class="token punctuation">(</span>i <span class="token operator">+</span> k <span class="token operator">+</span> g <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> k <span class="token operator">-</span> g <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">//cout &lt;&lt; V1 &lt;&lt;V2&lt;&lt;V3&lt;&lt;V4&lt;&lt; endl;	//测试语句</span>
				<span class="token punctuation">}</span>

				<span class="token comment">//取四个方向中的最小者作为该像元的兴趣值</span>
				<span class="token keyword">int</span> Vmin <span class="token operator">=</span> V<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>V<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> Vmin<span class="token punctuation">)</span> Vmin <span class="token operator">=</span> V<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>V<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> Vmin<span class="token punctuation">)</span> Vmin <span class="token operator">=</span> V<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>V<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> Vmin<span class="token punctuation">)</span> Vmin <span class="token operator">=</span> V<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token comment">//找到整个候选窗口中最大的值</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>Vmin <span class="token operator">&gt;</span> winMax<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					winMax <span class="token operator">=</span> Vmin<span class="token punctuation">;</span>
					maxPositionR <span class="token operator">=</span> i <span class="token operator">+</span> k<span class="token punctuation">;</span>
					maxPositionC <span class="token operator">=</span> j <span class="token operator">+</span> k<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>winMax <span class="token operator">&gt;</span> <span class="token number">3000</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> maxPositionR <span class="token operator">&lt;&lt;</span> <span class="token string">"  "</span> <span class="token operator">&lt;&lt;</span> maxPositionC <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
			std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"winMax = "</span> <span class="token operator">&lt;&lt;</span> winMax <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
			Point pt <span class="token operator">=</span> <span class="token function">Point</span><span class="token punctuation">(</span>maxPositionC<span class="token punctuation">,</span> maxPositionR<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token function">circle</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> pt<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token function">Scalar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//候选窗口所在的位置加上窗口大小，减去代求窗口边长，原因：候选窗口最边上得几行几列覆盖不到</span>
		candiPositionC <span class="token operator">=</span> candiPositionC <span class="token operator">+</span> CandidateWin <span class="token operator">-</span> window<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">imshow</span><span class="token punctuation">(</span><span class="token string">"Moravec算子"</span><span class="token punctuation">,</span> image<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cv<span class="token operator">::</span><span class="token function">waitKey</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"执行完毕！"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_174"></a>三、结果及分析</h2> 
<p>代码结果如下（小窗口：7个像元； 大窗口：25个像元）：</p> 
<p><img src="https://images2.imgbox.com/d0/4f/L2BvJuBG_o.png" alt="小窗口：7；  大窗口：25"></p> 
<p>Moravec的代码的关键点是两个窗口的移动，大窗口作为候选窗口，小窗口作为匹配窗口。难点是窗口的边界区域的处理，我把边缘都包括进去了，并且变化设为零。也可以不管边缘，这样在窗口大的时候可能会忽略一些特征点。</p> 
<p><img src="https://images2.imgbox.com/29/2b/xd7mKFwd_o.png" alt="| 大窗口：13，小窗口：5 | 大窗口：13，小窗口：7 |大窗口：25，小窗口：7 |"></p> 
<p>另外，从结果上可以看出，Morevec得算子实现好坏不仅仅与窗口大小有关系，还与两个窗口的大小比例有关系。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/56546fb136c1c900a5d23ae323d7077c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">下载bert的预训练模型并加载训练</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/256827b87ea79c3279e5bfd2a3f61050/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ReflectionException: There is no getter for property named ‘XXX异常原因和解决</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>