<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>用 Python  分分钟让旧照片修复清晰 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="用 Python  分分钟让旧照片修复清晰" />
<meta property="og:description" content="翻开家里的的相片册，可以看到每张照片都是那么的弥足珍贵，特别是很久以前的照片，都是美好的回忆，还有那些年错过的场景，都被记录下来了，不过可惜的是，随着时间的流逝，照片可能泛黄，出现划痕，画质损失等等，那么这时候，如果可以让这些老旧的照片修复回来，那就忒棒啊！
如何使用呢？今天小编和你一起玩一下，把旧照片修复清晰。
在此之前，确保你的电脑有：
Python3的运行环境
GPU或着CPU
环境准备 首先将微软的「Bringing-Old-Photos-Back-to-Life」库 clone 到本地：
git clone https://github.com/microsoft/Bringing-Old-Photos-Back-to-Life.git
下载 Synchronized-BatchNorm-PyTorch 接着进入项目文件，进入 「Face_Enhancement/models/networks/」，把「Synchronized-BatchNorm-PyTorch」clone下来：
clone https://github.com/vacancy/Synchronized-BatchNorm-PyTorch
同样的，在「Global/detection_models」下同步下载 「Synchronized-BatchNorm-PyTorch」：
下载 landmark detection pretrained model 进入 「Face_Enhancement」，使用 wget 命令下载地标检测预训练模型：
wget http://dlib.net/files/shapepredictor68facelandmarks.dat.bz2
接着解压：
bzip2 -d shapepredictor68facelandmarks.dat.bz2
下载训练模块 进入「Face_Enhancement」，使用 wget 下载：
wget https://facevc.blob.core.windows.net/zhanbo/oldphoto/pretrain/FaceEnhancement/checkpoints.zip
接着解压一波：
unzip checkpoints.zip
进入 「Global」，下载：
wget https://facevc.blob.core.windows.net/zhanbo/old_photo/pretrain/Global/checkpoints.zip
同样解压一波：
unzip checkpoints.zip
创建 python3 虚拟环境 python3 -m venv .venv
source .venv/bin/activate
安装项目依赖库 pip3 install -r requirements.txt
至此，我们该安装都特么安装完成了，接下来就可以使用了。
修复没有划痕的老照片 我们可以创建两文件夹，分别用来存放旧照片和生成的修复照片：
比如你要修复这样的旧照片：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/7d5f69af9a06167dfcac701d5e80f235/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-14T09:30:00+08:00" />
<meta property="article:modified_time" content="2021-03-14T09:30:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">用 Python  分分钟让旧照片修复清晰</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p>翻开家里的的相片册，可以看到每张照片都是那么的弥足珍贵，特别是很久以前的照片，都是美好的回忆，还有那些年错过的场景，都被记录下来了，不过可惜的是，随着时间的流逝，照片可能泛黄，出现划痕，画质损失等等，那么这时候，如果可以让这些老旧的照片修复回来，那就忒棒啊！</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/bc/21/3em1KK5B_o.png"></p> 
 <p>如何使用呢？今天小编和你一起玩一下，把旧照片修复清晰。<br></p> 
 <p>在此之前，确保你的电脑有：</p> 
 <blockquote> 
  <ul><li><p>Python3的运行环境</p></li><li><p>GPU或着CPU</p></li></ul> 
 </blockquote> 
 <h2>环境准备</h2> 
 <p>首先将微软的「Bringing-Old-Photos-Back-to-Life」库 clone 到本地：</p> 
 <blockquote> 
  <p style="text-align: justify">git clone https://github.com/microsoft/Bringing-Old-Photos-Back-to-Life.git</p> 
 </blockquote> 
 <h3>下载 Synchronized-BatchNorm-PyTorch</h3> 
 <p>接着进入项目文件，进入 「Face_Enhancement/models/networks/」，把「Synchronized-BatchNorm-PyTorch」clone下来：</p> 
 <blockquote> 
  <p style="text-align: justify">clone https://github.com/vacancy/Synchronized-BatchNorm-PyTorch</p> 
 </blockquote> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/7f/4e/KsVDOC7i_o.png"></p> 
 <p>同样的，在「Global/detection_models」下同步下载 「Synchronized-BatchNorm-PyTorch」：</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/d3/d7/e4WYkoGX_o.png"></p> 
 <h3>下载 landmark detection pretrained model</h3> 
 <p>进入 「Face_Enhancement」，使用 wget 命令下载地标检测预训练模型：</p> 
 <blockquote> 
  <p style="text-align: justify">wget http://dlib.net/files/shape<em>predictor</em>68<em>face</em>landmarks.dat.bz2</p> 
 </blockquote> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/34/38/sPLeuBFe_o.png"></p> 
 <p>接着解压：</p> 
 <blockquote> 
  <p style="text-align: justify">bzip2 -d shape<em>predictor</em>68<em>face</em>landmarks.dat.bz2</p> 
 </blockquote> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/a6/2c/pZgaWP53_o.png"></p> 
 <h3>下载训练模块</h3> 
 <p>进入「Face_Enhancement」，使用 wget 下载：</p> 
 <blockquote> 
  <p style="text-align: justify">wget https://facevc.blob.core.windows.net/zhanbo/old<em>photo/pretrain/Face</em>Enhancement/checkpoints.zip</p> 
 </blockquote> 
 <p>接着解压一波：</p> 
 <blockquote> 
  <p style="text-align: justify">unzip checkpoints.zip</p> 
 </blockquote> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/b6/56/GajpPqTp_o.png"></p> 
 <p>进入 「Global」，下载：</p> 
 <blockquote> 
  <p style="text-align: justify">wget https://facevc.blob.core.windows.net/zhanbo/old_photo/pretrain/Global/checkpoints.zip</p> 
 </blockquote> 
 <p>同样解压一波：</p> 
 <blockquote> 
  <p style="text-align: justify">unzip checkpoints.zip</p> 
 </blockquote> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/db/f8/Hhrocaxi_o.png"></p> 
 <h3>创建 python3 虚拟环境</h3> 
 <blockquote> 
  <p style="text-align: justify">python3 -m venv .venv</p> 
  <p style="text-align: justify">source .venv/bin/activate</p> 
 </blockquote> 
 <h3>安装项目依赖库</h3> 
 <blockquote> 
  <p style="text-align: justify">pip3 install -r requirements.txt</p> 
 </blockquote> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/c3/a5/Y6XT1UV9_o.png"></p> 
 <p>至此，我们该安装都特么安装完成了，接下来就可以使用了。</p> 
 <h2>修复没有划痕的老照片</h2> 
 <p>我们可以创建两文件夹，分别用来存放旧照片和生成的修复照片：</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/b2/ab/wPR60ean_o.png"></p> 
 <p>比如你要修复这样的旧照片：</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/0d/e7/F6uwYXgB_o.png"></p> 
 <p>把它放进 「old」文件夹中，然后使用这样的命令进行修复：</p> 
 <blockquote> 
  <p style="text-align: justify">python run.py --input<em>folder [旧照片的文件夹路径] --output</em>folder [新照片的文件夹路径] --GPU 0</p> 
 </blockquote> 
 <p>像这样：</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/fd/38/hjEA1Ixg_o.png"></p> 
 <p>这时候在 「out」中就可以得到修复好的照片了：</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/02/61/k2AfykMX_o.png"></p> 
 <p>打开可以看到新的照片：</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/89/b9/00N4qXqM_o.png"></p> 
 <p>是不是清晰了很多？</p> 
 <p>当然你也可以批量修复，把旧照片都放入你创建的 old 文件夹就可以。</p> 
 <h2>修复有划痕的老照片</h2> 
 <p>使用方式和刚刚的命令一样，只不过我们需要在命令后面添加 「--with_scratch」。</p> 
 <blockquote> 
  <p style="text-align: justify">删除刚刚 out 下生成的文件：</p> 
  <p style="text-align: justify">rm -rf test/out/*</p> 
  <p style="text-align: justify">修复：</p> 
  <p style="text-align: justify">python run.py --input<em>folder [旧照片的文件夹路径] --output</em>folder [新照片的文件夹路径] --GPU 0 --with_scratch</p> 
 </blockquote> 
 <p>得到的效果就是这样的：</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/d0/ac/l9hOHt55_o.png"></p> 
 <p>写到这里，小编在淘宝搜了一下「老照片修复」，这...商机啊！</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/59/3a/S5XOs4nw_o.png"></p> 
 <p>Python还是很有趣的，赶紧一起来学吧！欢迎在留言区吱一声哦！</p> 
 <pre class="has"><code class="language-php">推荐阅读:
入门: 最全的零基础学Python的问题  | 零基础学了8个月的Python  | 实战项目 |学Python就是这条捷径
干货:爬取豆瓣短评，电影《后来的我们》 | 38年NBA最佳球员分析 |   从万众期待到口碑扑街！唐探3令人失望  | 笑看新倚天屠龙记 | 灯谜答题王 ｜用Python做个海量小姐姐素描图 ｜
趣味:弹球游戏  | 九宫格  | 漂亮的花 | 两百行Python《天天酷跑》游戏!
AI: 会做诗的机器人 | 给图片上色 | 预测收入 | 碟中谍这么火，我用机器学习做个迷你推荐系统电影
</code></pre> 
 <p style="text-align: left"><strong>年度爆款文案</strong></p> 
 <ul><li><p style="text-align: left">1).<a href="http://mp.weixin.qq.com/s?__biz=MzIxNjM4NDE2MA%3D%3D&amp;chksm=978b7da1a0fcf4b71ddd6feb34970893b75262c2b36dc5e078c6c60abe5995049f3a0bc39bd1&amp;idx=2&amp;mid=2247494254&amp;scene=21&amp;sn=cc7f4193c340f51e85513cf2a97d22f7#wechat_redirect" rel="nofollow">卧槽！Pdf转Word用Python轻松搞定</a>！</p></li><li><p style="text-align: left"><a href="http://mp.weixin.qq.com/s?__biz=MzIxNjM4NDE2MA%3D%3D&amp;chksm=978b7faca0fcf6baebd4c19f49a5ceb6f8b0b4782abb85dca1010e3b2d481da80bbf3da29029&amp;idx=1&amp;mid=2247493731&amp;scene=21&amp;sn=e73f5ce75271e6b347f67cee854ab663#wechat_redirect" rel="nofollow">2).学Python真香！我用100行代码做了个网站，帮人PS旅行图片，赚个鸡腿吃</a></p></li><li><p style="text-align: left"><a href="http://mp.weixin.qq.com/s?__biz=MzIxNjM4NDE2MA%3D%3D&amp;chksm=978b6602a0fcef14405e7e27adab6fb2f838a29007ee4959190c79ddc00288acdda48577db76&amp;idx=1&amp;mid=2247496141&amp;scene=21&amp;sn=28830eb1f91f03c22c4783a85a251f21#wechat_redirect" rel="nofollow">3).首播过亿，火爆全网，我分析了《乘风破浪的姐姐》，发现了这些秘密</a> </p></li><li><p style="text-align: left">4).<a href="http://mp.weixin.qq.com/s?__biz=MzIxNjM4NDE2MA%3D%3D&amp;chksm=978b7ac1a0fcf3d7eb2dbfaf0498185b598c217be32f86416d241cc2037cc22e68e9d8028eec&amp;idx=1&amp;mid=2247494926&amp;scene=21&amp;sn=dde832dd3ff9c88e134bef0d366ba5f0#wechat_redirect" rel="nofollow">80行代码！用Python做一个哆来A梦分身</a> </p></li><li><p style="text-align: left"><a href="http://mp.weixin.qq.com/s?__biz=MzIxNjM4NDE2MA%3D%3D&amp;chksm=978b7053a0fcf945f99bf224d7ec59a0def838cb24c8b169a1ece9cf9a9595052edb59f9d738&amp;idx=2&amp;mid=2247493532&amp;scene=21&amp;sn=bf8df1f1e2b97a17bf035a257e595f6a#wechat_redirect" rel="nofollow">5).你必须掌握的20个python代码，短小精悍，用处无穷</a> </p></li><li><p style="text-align: left">6).<a href="http://mp.weixin.qq.com/s?__biz=MzIxNjM4NDE2MA%3D%3D&amp;chksm=978b6279a0fceb6fa7a8bbf5e118d424fb12624b8e3da18bb4f4255a91da4eb657f166e00fe1&amp;idx=1&amp;mid=2247497142&amp;scene=21&amp;sn=10bb72761b6cc9cd9634a78e053060e9#wechat_redirect" rel="nofollow">30个Python奇淫技巧集</a> </p></li><li><p style="text-align: left">7).<a href="http://mp.weixin.qq.com/s?__biz=MzIxNjM4NDE2MA%3D%3D&amp;chksm=978b6a7fa0fce3690f3e1c6df203ed044c2c3aeb65d3f4247773549c761c5e6d48e1ddbfc925&amp;idx=2&amp;mid=2247499184&amp;scene=21&amp;sn=d6486b8a36a953c1c85124e8eaa3f4dd#wechat_redirect" rel="nofollow">我总结的80页《菜鸟学Python精选干货.pdf》,都是干货</a> </p></li><li><p style="text-align: left">8).<a href="http://mp.weixin.qq.com/s?__biz=MzIxNjM4NDE2MA%3D%3D&amp;chksm=978b5ca9a0fcd5bf256c921fd64fcc8b7dec1d6fb8f2d75f6c51036e76338a982ccecd008655&amp;idx=1&amp;mid=2247502694&amp;scene=21&amp;sn=f35acdfc86a05309395b1b29ad569ee0#wechat_redirect" rel="nofollow">再见Python！我要学Go了！2500字深度分析</a>！</p></li><li><p style="text-align: left"><a href="http://mp.weixin.qq.com/s?__biz=MzIxNjM4NDE2MA%3D%3D&amp;chksm=978b6a9ca0fce38a3c22059103b2b4abf0b4008db53b4aad418b45cf2e785f4d971767237d79&amp;idx=1&amp;mid=2247499091&amp;scene=21&amp;sn=15550f3afc5e1834a5f9d581416a47f8#wechat_redirect" rel="nofollow">9).发现一个舔狗福利！这个Python爬虫神器太爽了，自动下载妹子图片</a></p></li></ul> 
 <pre class="has"><code class="language-php">点这里，直达菜鸟学PythonB站！！
</code></pre> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ce9afa6ba7e0a9990adb9979b77b1289/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">无法部署应用目录 [D:\Tomcat\apache-tomcat-9.0.44\webapps\ROOT]java.lang.IllegalStateException: 启动子级时出错</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b28d814bade314e6702c1e698fab8617/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Windows更改鼠标滚轮方向</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>