<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Netplan介绍 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Netplan介绍" />
<meta property="og:description" content="1 介绍 1.1 简介 Netplan是一个抽象网络配置描述器。通过netplan命令，你只需用一个 YAML文件描述每个网络接口所需配置。netplan并不关系底层管理工具是NetworkManager还是networkd。
它是一个在 Linux 系统上进行网络配置的实用程序。您创建所需接口的描述并定义每个接口应该做什么。
Netplan 满足在 YAML 中跨一组多功能服务器、桌面、云或物联网安装进行简单、描述性网络配置的需求。
对于想要使用通用网络配置来控制不同后端（例如 NetworkManager 或 systemd-networkd）的 Linux 系统管理员来说，它非常有用。
Netplan 是 Ubuntu 家族的成员。这是一个开源项目。
Ubuntu 18.04开始，Ubuntu和Debian移除了以前的ifup/ifdown命令和/etc/network/interfaces配置文件，转而使用ip link set或者/etc/netplan/01-netcfg.yaml模板和sudo netplan apply命令实现网络管理。
ip link set为iproute2工具集命令，多用于临时配置，取代ifup和ifdown。
如果安装的是服务器版本，则默认使用networkd进行管理，并且不会安装NetworkManager和提供nmcli接口。
如果安装的是桌面版本，则默认使用NetworkManager进行管理。
Netplan 目前支持的网络管理工具:
NetworkManagerSystemd-networkd 1.2 Netplan、NetworkManager、Systemd-networkd 关系 Netplan 支持调用 NetworkManager 和 Systemd-networkd；
NetworkManager和systemd-networked可以理解为相互替代关系。
如果要禁用NetworkManager，则应启用systemd-networkd，而在systemd-networkd运行时最好禁用networkmanager。
1.3 命令 netplan 操作命令提供两个子命令：
netplan generate ：生成后端管理工具对应的配置；（/etc/netplan）netplan apply ：应用配置(以便生效)，必要时重启管理工具；netplan try ：在配置得到确认之后才应用，如果配置存在错误，则回滚，类似test；netplan get：获取当前netplan配置；netplan set：修改当前netplan配置。netplan --debug apply 返回错误信息。 辅助命令 networkctl 可以查看网络设备的汇总信息
networkctl status 可以查看详情状态。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/9201e79f7b49aef1ba8b3070be320e1c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-06T03:38:04+08:00" />
<meta property="article:modified_time" content="2024-01-06T03:38:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Netplan介绍</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1__0"></a>1 介绍</h2> 
<h3><a id="11__1"></a>1.1 简介</h3> 
<p>Netplan是一个抽象网络配置描述器。通过netplan命令，你只需用一个 YAML文件描述每个网络接口所需配置。netplan并不关系底层管理工具是NetworkManager还是networkd。</p> 
<p>它是一个在 Linux 系统上进行网络配置的实用程序。您创建所需接口的描述并定义每个接口应该做什么。<br> Netplan 满足在 YAML 中跨一组多功能服务器、桌面、云或物联网安装进行简单、描述性网络配置的需求。</p> 
<p>对于想要使用通用网络配置来控制不同后端（例如 NetworkManager 或 systemd-networkd）的 Linux 系统管理员来说，它非常有用。</p> 
<p>Netplan 是 Ubuntu 家族的成员。这是一个开源项目。</p> 
<p>Ubuntu 18.04开始，Ubuntu和Debian移除了以前的ifup/ifdown命令和/etc/network/interfaces配置文件，转而使用ip link set或者/etc/netplan/01-netcfg.yaml模板和sudo netplan apply命令实现网络管理。</p> 
<p>ip link set为iproute2工具集命令，多用于临时配置，取代ifup和ifdown。<br> 如果安装的是服务器版本，则默认使用networkd进行管理，并且不会安装NetworkManager和提供nmcli接口。<br> 如果安装的是桌面版本，则默认使用NetworkManager进行管理。</p> 
<p><img src="https://images2.imgbox.com/4d/6a/BYEydRtM_o.png" alt="在这里插入图片描述"></p> 
<p>Netplan 目前支持的网络管理工具:</p> 
<ul><li>NetworkManager</li><li>Systemd-networkd</li></ul> 
<h3><a id="12_NetplanNetworkManagerSystemdnetworkd__22"></a>1.2 Netplan、NetworkManager、Systemd-networkd 关系</h3> 
<p>Netplan 支持调用 NetworkManager 和 Systemd-networkd；<br> NetworkManager和systemd-networked可以理解为相互替代关系。<br> 如果要禁用NetworkManager，则应启用systemd-networkd，而在systemd-networkd运行时最好禁用networkmanager。</p> 
<h3><a id="13__26"></a>1.3 命令</h3> 
<p>netplan 操作命令提供两个子命令：</p> 
<ul><li>netplan generate ：生成后端管理工具对应的配置；（/etc/netplan）</li><li>netplan apply ：应用配置(以便生效)，必要时重启管理工具；</li><li>netplan try ：在配置得到确认之后才应用，如果配置存在错误，则回滚，类似test；</li><li>netplan get：获取当前netplan配置；</li><li>netplan set：修改当前netplan配置。</li><li>netplan --debug apply 返回错误信息。</li></ul> 
<h4><a id="_35"></a>辅助命令</h4> 
<p>networkctl 可以查看网络设备的汇总信息<br> networkctl status 可以查看详情状态。</p> 
<h4><a id="NetworkManager__39"></a>NetworkManager 命令</h4> 
<p>systemctl status NetworkManager 查看NetworkManager状态<br> systemctl start NetworkManager 开启Net<br> systemctl restart NetworkManager 重新启动Net（PID值会发生变化）<br> systemctl reload NetworkManager 重新启动Net（PID值不会发生变化）<br> systemctl is-enabled NetworkManager 查看Net是否开机自启动<br> systemctl enable NetworkManager 设置Net开机自启动</p> 
<h3><a id="14_YAML__47"></a>1.4 YAML 文件编写</h3> 
<p>YAML在Saltstack中使用两个空格进行缩进，一定不要使用Tab进行缩进。<br> YAML的冒号后边如果还要文本，需要一个空格。<br> 列表项的写法类似Markdown，-加上空格。</p> 
<h2><a id="2_Netplan_52"></a>2 常用的Netplan参数</h2> 
<ul><li>version：指定Netplan配置文件的版本号，默认值为2。</li><li>renderer：指定用于渲染网络接口配置的工具，常用的值为networkd（使用systemd-networkd）和NetworkManager（使用NetworkManager）。</li><li>ethernets：定义要配置的以太网接口及其属性，例如IP地址、子网掩码、网关、DNS等。</li><li>bridges：定义要配置的网桥及其属性，例如IP地址、子网掩码、网关、DNS等。</li><li>vlans：定义要配置的VLAN接口及其属性，例如ID、IP地址、子网掩码、网关、DNS等。</li><li>bonds：定义要配置的绑定接口及其属性，例如负载平衡算法、网卡状态检测机制等。</li><li>nameservers：指定要使用的DNS服务器列表。</li><li>routes：定义静态路由表，指定路由器及其下一跳地址和子网掩码。</li></ul> 
<h2><a id="3__61"></a>3 网络配置示例</h2> 
<p>Netplan支持两个网络后端:networkd和NetworkManager，一般为networkd</p> 
<pre><code>network:
  version: 2
  renderer: networkd
</code></pre> 
<p>如果networkd不存在，也可以使用NetworkManager。</p> 
<pre><code>network:
  version: 2
  renderer: NetworkManager
</code></pre> 
<h3><a id="IP_74"></a>以太网连接:动态IP</h3> 
<pre><code>network:
  version: 2
  renderer: networkd
  ethernets:
    eth0:
      dhcp4: yes
    eth1:
      dhcp4: yes
</code></pre> 
<h3><a id="IP_85"></a>以太网连接:静态IP</h3> 
<pre><code>network:
  version: 2
  renderer: networkd
  ethernets:
    eth0:
      addresses:
        - 10.10.10.3/24
      nameservers:
        addresses: [202.96.128.86]
      routes:
        - to: 0.0.0.0/0
          via: 10.10.10.1
    
    eth1:
      addresses:
        - 10.10.10.2/24
      nameservers:
        addresses: [202.96.128.86]
      routes:
        - to: 0.0.0.0/0
          via: 10.10.10.1
</code></pre> 
<h3><a id="WIFIIP_109"></a>WIFI连接:静态IP</h3> 
<pre><code>network:
  version: 2
  renderer: networkd
  wifi:
    wlan0:
      dhcp4: no
      dhcp6: no
      addresses: [192.168.1.200/24]
      nameservers:
        addresses: [202.96.128.86]
      access-points:
        "NETGEAR25":
            password: "ceshizhuanyong"
      routes:
        - to: 0.0.0.0/0
          via: 192.168.1.1
</code></pre> 
<h3><a id="WIFIIP_128"></a>WIFI连接:动态IP</h3> 
<pre><code>network:
  version: 2
  renderer: networkd
  wifi:
    wlan0:
      dhcp4: yes
      access-points:
        "NETGEAR25":
            password: "ceshizhuanyong"
</code></pre> 
<h2><a id="4__141"></a>4 操作流程</h2> 
<h3><a id="41__142"></a>4.1 修改配置文件</h3> 
<p>vim /etc/netplan/*.yaml</p> 
<h3><a id="42__144"></a>4.2 测试配置文件</h3> 
<p>netplan try</p> 
<h3><a id="43__146"></a>4.3 应用配置文件</h3> 
<p>netplan apply</p> 
<h3><a id="44__148"></a>4.4 重启网络服务</h3> 
<pre><code>sudo systemctl restart system-networkd
或者
sudo systemctl restart network-manager
</code></pre> 
<h2><a id="_155"></a>参考</h2> 
<p>1、<a href="https://netplan.readthedocs.io/en/stable/" rel="nofollow">Netplan documentation</a><br> 2、<a href="https://netplan.readthedocs.io/en/latest/netplan-yaml/" rel="nofollow">YAML configuration</a><br> 3、<a href="https://blog.csdn.net/bigbaojian/article/details/125396045">Netplan使用（高版本Ubuntu静态/动态IP设置方法）</a><br> 4、<a href="https://www.jb51.net/LINUXjishu/895582.html" rel="nofollow">Netplan新一代网络配置工具使用详解</a><br> 5、<a href="http://www.manongjc.com/detail/57-gdqdewbxawquhbn.html" rel="nofollow">Ubuntu 18.04 LTS 通过 Netplan 配置网络教程</a><br> 6、<a href="https://wiki.t-firefly.com/en/Firefly-Linux-Guide/first_use.html#network-configuration" rel="nofollow">Firefly-Linux-Guide/#network-configuration</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ed2de3ea4d358219fc7c5c740de46f2a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Protobuf 安装与使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/60118c6569ac3f065a2feaf7fd394d95/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">leetcode：908. 最小差值 I</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>