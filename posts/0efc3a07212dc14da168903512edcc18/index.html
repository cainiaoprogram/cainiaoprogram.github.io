<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>华为ensp单臂路由子接口实现不同vlan互通 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="华为ensp单臂路由子接口实现不同vlan互通" />
<meta property="og:description" content="实验拓扑：
提前配置好ip地址及端口地址
LSW1配置：
[LSW1]vlan batch 10 20 创建vlan [LSW1]interface GigabitEthernet 0/0/1 进入接口 [LSW1-GigabitEthernet0/0/1]port link-type access 修改链路 [LSW1-GigabitEthernet0/0/1]port default vlan 10 加入vlan [LSW1]interface GigabitEthernet 0/0/2 [LSW1-GigabitEthernet0/0/2]port link-type access [LSW1-GigabitEthernet0/0/2]port default vlan 20 [LSW1]interface GigabitEthernet 0/0/3 进入接口 [LSW1-GigabitEthernet0/0/3]port link-type trunk 修改链路 [LSW1-GigabitEthernet0/0/3]port trunk allow-pass vlan 10 20 加入vlan [LSW1]interface Vlanif 10 进入vlan [LSW1-Vlanif10]ip address 192.168.10.254 24 配置网关地址 [LSW1-Vlanif10]undo shutdown 开启 [LSW1]interface Vlanif 20 [LSW1-Vlanif20]ip address 192.168.20.254 24 [LSW1-Vlanif20]undo shutdown AR1配置：
[AR1]interface GigabitEthernet 0/0/0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0efc3a07212dc14da168903512edcc18/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-17T15:29:01+08:00" />
<meta property="article:modified_time" content="2021-08-17T15:29:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">华为ensp单臂路由子接口实现不同vlan互通</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>实验拓扑：</p> 
<p><img alt="" height="376" src="https://images2.imgbox.com/53/1f/nO0fqfG2_o.png" width="450"></p> 
<p><span style="color:#1c7331;">提前配置好ip地址及端口地址</span></p> 
<p><strong>LSW1配置：</strong></p> 
<pre><code>[LSW1]vlan batch 10 20  创建vlan
[LSW1]interface GigabitEthernet 0/0/1  进入接口
[LSW1-GigabitEthernet0/0/1]port link-type access   修改链路
[LSW1-GigabitEthernet0/0/1]port default vlan 10   加入vlan
[LSW1]interface GigabitEthernet 0/0/2
[LSW1-GigabitEthernet0/0/2]port link-type access
[LSW1-GigabitEthernet0/0/2]port default vlan 20
[LSW1]interface GigabitEthernet 0/0/3    进入接口
[LSW1-GigabitEthernet0/0/3]port link-type trunk    修改链路
[LSW1-GigabitEthernet0/0/3]port trunk allow-pass vlan 10 20    加入vlan
[LSW1]interface Vlanif 10    进入vlan
[LSW1-Vlanif10]ip address 192.168.10.254 24   配置网关地址
[LSW1-Vlanif10]undo shutdown    开启
[LSW1]interface Vlanif 20
[LSW1-Vlanif20]ip address 192.168.20.254 24
[LSW1-Vlanif20]undo shutdown
</code></pre> 
<p><strong>AR1配置：</strong></p> 
<pre><code>[AR1]interface GigabitEthernet 0/0/0.1   进入子接口
[AR1-GigabitEthernet0/0/0.1]ip address 192.168.10.254 24  配置网关地址
[AR1-GigabitEthernet0/0/0.1]dot1q termination vid 10    配置能识别的vlan标签
[AR1-GigabitEthernet0/0/0.1]arp broadcast enable    开启子接口的arp 广播功能
[AR1]interface GigabitEthernet 0/0/0.2
[AR1-GigabitEthernet0/0/0.2]ip address 192.168.20.254 24
[AR1-GigabitEthernet0/0/0.2]dot1q termination vid 20
[AR1-GigabitEthernet0/0/0.2]arp broadcast enable</code></pre> 
<p>&lt;AR1&gt;display ip routing-tale  查看路由表</p> 
<p><img alt="" height="398" src="https://images2.imgbox.com/e0/e8/Ou7pEKrF_o.png" width="658"></p> 
<p></p> 
<blockquote> 
 <p><span style="color:#1c7331;"><strong>备注：</strong></span></p> 
 <p><strong>arp broadcast enable</strong>命令用来使能终结子接口的ARP广播功能。</p> 
 <p><strong>undo arp broadcast enable</strong>命令用来取消终结子接口的ARP广播功能。</p> 
 <p>缺省情况下，终结子接口没有使能ARP广播功能。</p> 
 <p>只有配置了mode user-termination命令和control-vid命令后，才能在对应的子接口上配置<strong>arp broadcast enable</strong>命令。</p> 
 <p>当IP报文需要从终结子接口发出，但是没有相应的ARP表项时：</p> 
 <ul><li> <p>接入设备能够主动发送ARP报文，不需要配置终结子接口的ARP广播功能，就可以实现从该终结子接口的转发。</p> </li><li> <p>接入设备不能够主动发送ARP报文：</p> 
   <ul><li> <p>如果终结子接口上没有配置<strong>arp broadcast enable</strong>命令，那么系统会直接把该IP报文丢弃。此时该终结子接口的路由可以看作是黑洞路由。</p> </li><li> <p>如果终结子接口上配置了<strong>arp broadcast enable</strong>命令，那么系统会构造带Tag的ARP广播报文，然后再从该终结子接口发出。</p> </li></ul></li></ul> 
 <p>使能或去使能终结子接口的ARP广播功能，会使该终结子接口的路由状态发生一次先Down再Up的变化，从而可能导致整个网络的路由发生一次震荡，影响正在运行的业务。</p> 
</blockquote> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c6418247f106b7cf6dffe746a5fac4df/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">看完左耳朵耗子的116篇文章，我给自己定了个5年技术规划</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e44d34472727f8195acfaef20bb539e1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">yoloV5 使用——训练速度慢，加速训练</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>