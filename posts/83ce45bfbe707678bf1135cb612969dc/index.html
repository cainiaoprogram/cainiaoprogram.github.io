<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>STM32：TTL串口调试 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="STM32：TTL串口调试" />
<meta property="og:description" content="一.TTL串口概要 TTL只需要两个线就可以完成两个设备之间的双向通信，一个发送电平的I/O称之为TX，与另一个设备的接收I/O口RX相互连接。两设备之间还需要连接地线(GND)，这样两设备就有相同的0V参考电势。
二.TTL串口调试 实现电脑通过STM32发送指令来控制红绿小灯的亮灭。
电脑输入&#34;R0&#34;红灯灭，&#34;R1&#34;红灯亮；&#34;B0&#34;蓝灯灭，&#34;B1&#34;蓝灯亮；&#34;G0&#34;绿灯灭，&#34;G1&#34;绿灯亮
注：案例使用STM32F103CT6芯片，KEYSKING教程的开发板套件。开发板接口图如下
在CubeIDE中，设计面板-&gt;属性分类-&gt;connectivity中有3个USART。
意思为：Universal Synchronous/Asynchronous Receiver &amp; Transmitter 。 通用同步/异步收发器。其中TTL串口就用的是异步通信Asynchronous。因此可以也缩写成UART。
在设计面板中根据开发板说明找到串口TX，即PA2。设置串口通信，根据自身设置的属性在connectivity找到对应的USART并设置节点模式为异步。
我们可以在属性详情看到波特率(Baud Rate)为115200bits/s,意味着每秒可以发送 11520个字节。两个设备要相同的波特率才能正常通信。
因为字节长度(Word Length)有8个比特位bit，发送一个字节数据需要在字节开头和结尾分别增加一个起始位和停止位共10bit
其他属性校验位为NONE，停止位为1.保持默认即可。设置完成后可以在设计界面中看见另一个收/发串口也被默认复制成相同的配置了。同时根据开发板说明找到红绿蓝灯的接口，设置为GPIO_OUTPUT。保存生成新的代码：
其中示例关于：
MX_USART2_UART_Init(); //是系统自动生成的代码，用来初始化UART的
HAL_UART_Receive(huart, pData, Size, Timeout) //UART接收数据，参数串口类型，接收数据的变量地址，接收数据的变量的字节大小，最大延迟时间
HAL_UART_Transmit(huart, pData, Size, Timeout) //UART发送数据
关键代码main函数：
int main(void) { /* USER CODE BEGIN 1 */ /* USER CODE END 1 */ /* MCU Configuration--------------------------------------------------------*/ /* Reset of all peripherals, Initializes the Flash interface and the Systick. */ HAL_Init(); /* USER CODE BEGIN Init */ /* USER CODE END Init */ /* Configure the system clock */ SystemClock_Config(); /* USER CODE BEGIN SysInit */ /* USER CODE END SysInit */ /* Initialize all configured peripherals */ MX_GPIO_Init(); MX_USART2_UART_Init(); /* USER CODE BEGIN 2 */ uint8_t recvDate[2]; /* USER CODE END 2 */ /* Infinite loop */ /* USER CODE BEGIN WHILE */ while (1) { HAL_UART_Receive(&amp;huart2, recvDate, 2, HAL_MAX_DELAY); HAL_UART_Transmit(&amp;huart2,recvDate,2, 100); GPIO_PinState pinstate= GPIO_PIN_RESET; if(recvDate[1] == &#39;1&#39;){ pinstate = GPIO_PIN_SET; } //我把红绿蓝的接口标签命名为了redLED,greenLED,blueLED if(recvDate[0] == &#39;R&#39;){ HAL_GPIO_WritePin(redLED_GPIO_Port, redLED_Pin, pinstate); }else if(recvDate[0] == &#39;B&#39;){ HAL_GPIO_WritePin(blueLED_GPIO_Port,blueLED_Pin, pinstate); }else if(recvDate[0] == &#39;G&#39;){ HAL_GPIO_WritePin(greenLED_GPIO_Port,greenLED_Pin, pinstate); } /* USER CODE END WHILE */ /* USER CODE BEGIN 3 */ } /* USER CODE END 3 */ } 三." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/83ce45bfbe707678bf1135cb612969dc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-24T21:55:11+08:00" />
<meta property="article:modified_time" content="2023-10-24T21:55:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">STM32：TTL串口调试</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一.TTL串口概要</h2> 
<p><img alt="" height="310" src="https://images2.imgbox.com/73/9b/DiaM7i2Y_o.png" width="818"></p> 
<p>        TTL只需要两个线就可以完成两个设备之间的双向通信，一个发送电平的I/O称之为TX，与另一个设备的接收I/O口RX相互连接。两设备之间还需要连接地线(GND)，这样两设备就有相同的0V参考电势。</p> 
<h2>二.TTL串口调试</h2> 
<p>        实现电脑通过STM32发送指令来控制红绿小灯的亮灭。</p> 
<blockquote> 
 <p>        电脑输入"R0"红灯灭，"R1"红灯亮；"B0"蓝灯灭，"B1"蓝灯亮；"G0"绿灯灭，"G1"绿灯亮</p> 
</blockquote> 
<p> 注：案例使用STM32F103CT6芯片，KEYSKING教程的开发板套件。开发板接口图如下</p> 
<p><img alt="" height="427" src="https://images2.imgbox.com/6f/b6/cwbzyVxw_o.png" width="615"></p> 
<p></p> 
<p>在CubeIDE中，设计面板-&gt;属性分类-&gt;connectivity中有3个USART。</p> 
<blockquote> 
 <p>意思为：Universal Synchronous/Asynchronous  Receiver &amp; Transmitter 。 通用同步/异步收发器。其中<strong>TTL串口就用的是异步通信Asynchronous</strong>。因此可以也缩写成UART。</p> 
</blockquote> 
<p>在设计面板中根据开发板说明找到串口TX，即PA2。设置串口通信，根据自身设置的属性在connectivity找到对应的USART并设置节点模式为异步。</p> 
<p><img alt="" height="644" src="https://images2.imgbox.com/60/ca/DyD7A9z5_o.png" width="1200"></p> 
<p>我们可以在属性详情看到波特率(Baud Rate)为115200bits/s,意味着每秒可以发送 11520个字节。<strong>两个设备要相同的波特率才能正常通信</strong>。</p> 
<blockquote> 
 <p>因为字节长度(Word Length)有8个比特位bit，发送一个字节数据需要在字节开头和结尾分别增加一个起始位和停止位共10bit</p> 
</blockquote> 
<p>其他属性校验位为NONE，停止位为1.保持默认即可。设置完成后可以在设计界面中看见另一个收/发串口也被默认复制成相同的配置了。同时根据开发板说明找到红绿蓝灯的接口，设置为GPIO_OUTPUT。保存生成新的代码：</p> 
<p>其中示例关于：</p> 
<blockquote> 
 <p>  MX_USART2_UART_Init();  //是系统自动生成的代码，用来初始化UART的</p> 
 <p>  HAL_UART_Receive(huart, pData, Size, Timeout)  //UART接收数据，参数串口类型，接收数据的变量地址，接收数据的变量的字节大小，最大延迟时间<br>   HAL_UART_Transmit(huart, pData, Size, Timeout) //UART发送数据</p> 
</blockquote> 
<p></p> 
<p>关键代码main函数：</p> 
<pre><code class="language-cpp">int main(void)
{
  /* USER CODE BEGIN 1 */

  /* USER CODE END 1 */

  /* MCU Configuration--------------------------------------------------------*/

  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */
  HAL_Init();

  /* USER CODE BEGIN Init */

  /* USER CODE END Init */

  /* Configure the system clock */
  SystemClock_Config();

  /* USER CODE BEGIN SysInit */

  /* USER CODE END SysInit */

  /* Initialize all configured peripherals */
  MX_GPIO_Init();
  MX_USART2_UART_Init();
  /* USER CODE BEGIN 2 */
  uint8_t  recvDate[2];
  /* USER CODE END 2 */

  /* Infinite loop */
  /* USER CODE BEGIN WHILE */
  while (1)
  {

	  HAL_UART_Receive(&amp;huart2, recvDate, 2, HAL_MAX_DELAY);
	  HAL_UART_Transmit(&amp;huart2,recvDate,2, 100);
	  GPIO_PinState pinstate= GPIO_PIN_RESET;
	  if(recvDate[1] == '1'){
		  pinstate = GPIO_PIN_SET;
	  }
      //我把红绿蓝的接口标签命名为了redLED,greenLED,blueLED
	  if(recvDate[0] == 'R'){
		  HAL_GPIO_WritePin(redLED_GPIO_Port, redLED_Pin, pinstate);
	  }else if(recvDate[0] == 'B'){
		  HAL_GPIO_WritePin(blueLED_GPIO_Port,blueLED_Pin, pinstate);
	  }else if(recvDate[0] == 'G'){
		  HAL_GPIO_WritePin(greenLED_GPIO_Port,greenLED_Pin, pinstate);
	  }
    /* USER CODE END WHILE */

    /* USER CODE BEGIN 3 */
  }
  /* USER CODE END 3 */
}</code></pre> 
<h2>三.用开源网页进行调试验证</h2> 
<p>将代码build进单片机中。登录开源网址进行调试：<a href="https://serial.keysking.com/" rel="nofollow" title="波特律动 串口助手">波特律动 串口助手</a></p> 
<ol><li>登录网址，点击左下角的"选项"-&gt;常用驱动下载</li><li>根据自己的芯片类型下载驱动</li><li>根据代码中设置的串口属性，调整界面的串口属性面板，波特率特是要一致</li><li>点击串口连接，选择自己的需要连接的串口</li><li>发送数据，并将字符编码设置成ASCII码查看调试成果</li></ol> 
<p><img alt="" height="574" src="https://images2.imgbox.com/8d/27/54KKN0nS_o.png" width="1019"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d6d95e6a8e74446defdf97c8fecc837a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">05、Python -- 爬取ts文件格式视频思路</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dce658f2ab5b2061bb4a6d7c7c420fc7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">图像压缩（2）《数字图像处理》第八章 8.1节 基础知识</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>