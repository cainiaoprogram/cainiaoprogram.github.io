<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>脱敏工具类 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="脱敏工具类" />
<meta property="og:description" content="import cn.hutool.core.util.StrUtil; import org.apache.commons.lang3.StringUtils; /** * @author:BuBu * @Description 敏感信息屏蔽工具 * @Date: 2018年11月29日17:04:15 */ public final class DesensitizeUtil { public static void main(String[] args) { String name = &#34;陈文&#34;; String cer = &#34;410105192201010011&#34;; // System.out.println(chineseName(name)); // System.out.println(chineseName(&#34;陈一文&#34;)); // System.out.println(desStr(cer, 4, 11)); // System.out.println(mobilePhone(&#34;17600110011&#34;)); // System.out.println(identificationNum(&#34;410105192201010011&#34;)); System.out.println(bankCard(&#34;6222123456789234&#34;)); System.out.println(address(&#34;黑龙江省哈尔滨市松北区松浦街道教授家园&#34;)); System.out.println(address(&#34;浙江省杭州市西湖区文一路星光大道201B&#34;)); System.out.println(address(&#34;浙江省杭州市西湖区&#34;)); System.out.println(address(&#34;浙江杭州市西湖文一路星光大道201B&#34;)); System.out.println(address(&#34;黑龙江省哈尔滨市道里区新发镇机场路335号&#34;)); System.out.println(address(&#34;黑龙江省哈尔滨市双城区兰棱街道G1京哈高速&#34;)); System.out.println(address(&#34;吉林省长春市德惠市达家沟镇G1京哈高速&#34;)); System.out.println(address(&#34;吉林省长春市宽城区米沙子镇后石家&#34;)); System.out.println(address(&#34;吉林长春宽城米沙子后石家&#34;)); System.out.println(carPlateNumber(&#34;浙A12443&#34;)); System.out.println(businessLicense(&#34;1234567790099&#34;)); } public static String createStar(int num) { if (num &lt; 1) { return &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a82c43bd644686bb49abe7d3181d8867/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-14T10:36:25+08:00" />
<meta property="article:modified_time" content="2022-09-14T10:36:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">脱敏工具类</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code class="language-java">import cn.hutool.core.util.StrUtil;
import org.apache.commons.lang3.StringUtils;

/**
 * @author:BuBu
 * @Description 敏感信息屏蔽工具
 * @Date: 2018年11月29日17:04:15
 */
public final class DesensitizeUtil {

    public static void main(String[] args) {
        String name = "陈文";
        String cer = "410105192201010011";
//        System.out.println(chineseName(name));
//        System.out.println(chineseName("陈一文"));
//        System.out.println(desStr(cer, 4, 11));
//        System.out.println(mobilePhone("17600110011"));
//        System.out.println(identificationNum("410105192201010011"));
        System.out.println(bankCard("6222123456789234"));
        System.out.println(address("黑龙江省哈尔滨市松北区松浦街道教授家园"));
        System.out.println(address("浙江省杭州市西湖区文一路星光大道201B"));
        System.out.println(address("浙江省杭州市西湖区"));
        System.out.println(address("浙江杭州市西湖文一路星光大道201B"));
        System.out.println(address("黑龙江省哈尔滨市道里区新发镇机场路335号"));
        System.out.println(address("黑龙江省哈尔滨市双城区兰棱街道G1京哈高速"));
        System.out.println(address("吉林省长春市德惠市达家沟镇G1京哈高速"));
        System.out.println(address("吉林省长春市宽城区米沙子镇后石家"));
        System.out.println(address("吉林长春宽城米沙子后石家"));


        System.out.println(carPlateNumber("浙A12443"));
        System.out.println(businessLicense("1234567790099"));

    }

    public static String createStar(int num) {
        if (num &lt; 1) {
            return "";
        }
        StringBuffer sb = new StringBuffer();
        for (int i = 0; i &lt; num; i++) {
            sb.append("*");
        }
        return sb.toString();
    }

    /**
     * 自定义脱敏位置
     *
     * @param str
     * @param begin
     * @param size
     * @return
     */
    public static String desStr(String str, int begin, int size) {
        if (str == null) {
            return null;
        }
        if (StringUtils.isBlank(str)) {
            return "";
        }
        int end = str.length() - begin - size;
        String star = createStar(size);
        return StringUtils.left(str, begin).concat(star).concat(StringUtils.right(str, end));
    }

    /**
     * [中文姓名] 2个字人名：唐*,陈*。保留第一个字段,脱敏后面字段。
     * 3个/3个以上人名：陈*文，唐*问。保留第一个和最后一个字段。中间字段脱敏。
     *
     * @param fullName
     * @return
     */
    public static String chineseName(String fullName) {
        if (fullName == null) {
            return null;
        }
        if (StringUtils.isBlank(fullName)) {
            return "";
        }
        if (fullName.length() == 2) {
            return StringUtils.left(fullName, 1).concat("*");
        }
        return StringUtils.left(fullName, 1).concat(StringUtils.removeStart(StringUtils.leftPad(StringUtils.right(fullName, 1), StringUtils.length(fullName), "*"), "*"));
    }

    /**
     * [中文姓名] 只显示第一个汉字，其他隐藏为2个星号&lt;例子：李**&gt;
     *
     * @param familyName
     * @param givenName
     * @return
     */
    public static String chineseName(String familyName, String givenName) {
        if (familyName == null &amp;&amp; givenName == null) {
            return null;
        }
        if (StringUtils.isBlank(familyName) || StringUtils.isBlank(givenName)) {
            return "";
        }
        return chineseName(familyName + givenName);
    }

    /**
     * [身份证号] 1101****158，前面保留4位明文，后面保留3位明文
     *
     * @param id
     * @return
     */
    public static String identificationNum(String id) {
        if (id == null) {
            return null;
        }
        if (StringUtils.isBlank(id)) {
            return "";
        }
        return StringUtils.left(id, 4).concat(StringUtils.removeStart(StringUtils.leftPad(StringUtils.right(id, 3), StringUtils.length(id), "*"), "****"));
    }

    /**
     * [车牌号] 后面5位里面脱敏中间3位。 脱敏前：浙A12443 脱敏后：浙A1***3
     *
     * @param carPlateNumber
     * @return
     */
    public static String carPlateNumber(String carPlateNumber) {
        if (carPlateNumber == null) {
            return null;
        }
        if (StringUtils.isBlank(carPlateNumber)) {
            return "";
        }
        if (StrUtil.length(carPlateNumber) &lt; 5) {
            return carPlateNumber;
        }
        return desStr(carPlateNumber, carPlateNumber.length() - 4, 3);
    }

    /**
     * [营业执照] 1101****158，前面保留4位明文，后面保留3位明文
     *
     * @param businessLicense
     * @return
     */
    public static String businessLicense(String businessLicense) {
        if (businessLicense == null) {
            return null;
        }
        if (StringUtils.isBlank(businessLicense)) {
            return "";
        }
        return StringUtils.left(businessLicense, 4).concat(StringUtils.removeStart(StringUtils.leftPad(StringUtils.right(businessLicense, 3), StringUtils.length(businessLicense), "*"), "****"));
    }

    /**
     * [固定电话] 后四位，其他隐藏&lt;例子：****1234&gt;
     *
     * @param num
     * @return
     */
    public static String fixedPhone(String num) {
        if (num == null) {
            return null;
        }
        if (StringUtils.isBlank(num)) {
            return "";
        }
        return StringUtils.leftPad(StringUtils.right(num, 4), StringUtils.length(num), "*");
    }

    /**
     * [手机号码] 前三位，后四位，其他隐藏&lt;例子:1381***1234&gt;
     *
     * @param num
     * @return
     */
    public static String mobilePhone(String num) {
        if (num == null) {
            return null;
        }
        if (StringUtils.isBlank(num)) {
            return "";
        }
        return StringUtils.left(num, 3).concat(StringUtils.removeStart(StringUtils.leftPad(StringUtils.right(num, 4), StringUtils.length(num), "*"), "***"));
    }

    /**
     * [地址] 只显示到地区，不显示详细地址；我们要对个人信息增强保护&lt;例子：北京市海淀区****&gt;
     *
     * @param address
     * @param sensitiveSize 敏感信息长度
     * @return
     */
    public static String address(String address, int sensitiveSize) {
        if (address == null) {
            return null;
        }
        if (StringUtils.isBlank(address)) {
            return "";
        }
        int length = StringUtils.length(address);
        return StringUtils.rightPad(StringUtils.left(address, length - sensitiveSize), length, "*");
    }

    public static String[] arr = {"街道", "镇", "区", "市", "省"};

    public static String address(String address) {
        if (address == null) {
            return null;
        }
        if (StringUtils.isBlank(address)) {
            return "";
        }
        int length = StringUtils.length(address);
        for (int i = 0; i &lt; arr.length; i++) {
            int index = address.indexOf(arr[i]);
            int y = 1;
            if (i == 0) {
                y = 2;
            }
            if (index == length - y) {
                return address;
            }
            if (index &gt; 0) {
                return StringUtils.rightPad(StringUtils.left(address, index + y), length, "*");
            }
        }
        return StringUtils.left(address, 4).concat(StringUtils.removeStart(StringUtils.leftPad(StringUtils.right(address, 3), StringUtils.length(address), "*"), "****"));
    }

    /**
     * [电子邮箱] 邮箱前缀仅显示第一个字母，前缀其他隐藏，用星号代替，@及后面的地址显示&lt;例子:g**@163.com&gt;
     *
     * @param email
     * @return
     */
    public static String email(String email) {
        if (email == null) {
            return null;
        }
        if (StringUtils.isBlank(email)) {
            return "";
        }
        int index = StringUtils.indexOf(email, "@");
        if (index &lt;= 1) {
            return email;
        } else {
            return StringUtils.rightPad(StringUtils.left(email, 1), index, "*").concat(StringUtils.mid(email, index, StringUtils.length(email)));
        }
    }

    /**
     * [银行卡号] 前四位，后三位，其他用星号隐藏每位1个星号&lt;例子:6222*********234&gt;
     *
     * @param cardNum
     * @return
     */
    public static String bankCard(String cardNum) {
        if (cardNum == null) {
            return null;
        }
        if (StringUtils.isBlank(cardNum)) {
            return "";
        }
        return StringUtils.left(cardNum, 4).concat(StringUtils.removeStart(StringUtils.leftPad(StringUtils.right(cardNum, 3), StringUtils.length(cardNum), "*"), "****"));
    }

    /**
     * [公司开户银行联号] 公司开户银行联行号,显示前两位，其他用星号隐藏，每位1个星号&lt;例子:12********&gt;
     *
     * @param code
     * @return
     */
    public static String cnapsCode(String code) {
        if (code == null) {
            return null;
        }
        if (StringUtils.isBlank(code)) {
            return "";
        }
        return StringUtils.rightPad(StringUtils.left(code, 2), StringUtils.length(code), "*");
    }

    /**
     * 把所有信息都加*
     *
     * @param text
     * @return
     */
    public static String textAll(String text) {
        if (text == null) {
            return null;
        }
        if (StringUtils.isBlank(text)) {
            return "";
        }
        return StringUtils.rightPad(StringUtils.left(text, 0), StringUtils.length(text), "*");
    }

}
</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3c153a5847d7c73ffb23d3c94d5f72c7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">研一就成为Apache顶级项目的Committer，他们是这么做的</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/83c96a3fd754445a8346d0f9d2719aa2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">图解Spring AOP</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>