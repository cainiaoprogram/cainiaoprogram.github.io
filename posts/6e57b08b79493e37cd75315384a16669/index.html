<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Websocket原理 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Websocket原理" />
<meta property="og:description" content="文章目录 1.websocket简单介绍2. 为什么要用websocket3. websocket的自带演示例子4. 简单websocket连接5. 用webSocket实现一个简单的聊天室6. 用webSocket实现贪吃蛇 1.websocket简单介绍 WebSocket 是 HTML5 开始提供的一种在单个 TCP 连接上进行全双工通讯的协议。WebSocket 使得客户端和服务器之间的数据交换变得更加简单，允许服务端主动向客户端推送数据。在 WebSocket API 中，浏览器和服务器只需要完成一次握手，两者之间就直接可以创建持久性的连接，并进行双向数据传输。在 WebSocket API 中，浏览器和服务器只需要做一个握手的动作，然后，浏览器和服务器之间就形成了一条快速通道。两者之间就直接可以数据互相传送。 重点：1.全双工，客户端与服务端可以同时相互通信，就如同打电话一样，两边可以同时说话。 2.允许服务端主动向客户端发数据，在以往的通信中是客户端向服务端发送请求，服务端再回复给客户端，一切起源只能是客户端的request，服务端无法主动发送信息给客户端；在websocket中，则可以服务端主动给客户端发送信息。 3.持久性，当服务端跟客户端通信连接成功(即建立起一个管道),这个管道将会一直存在，随时可以传送数据，无需在request。 若没有说清楚，请再参考下面的文章，说的比较通俗易懂。
https://www.jianshu.com/p/d5c1f704fbc5 2. 为什么要用websocket 初次接触 WebSocket 的人，都会问同样的问题：我们已经有了 HTTP 协议，为什么还需要另一个协议？它能带来什么好处？答案很简单，因为 HTTP 协议有一个缺陷：通信只能由客户端发起。举例来说，我们想了解今天的天气，只能是客户端向服务器发出请求，服务器返回查询结果。HTTP 协议做不到服务器主动向客户端推送信息。 3. websocket的自带演示例子 现在演示下websocket自带的example
先启动Tomcat。
在Tomcat文件下bin文件里面，找到startup.bat 双击点击启动。
启动成功后，在浏览器中输入http://localhost:8080/，进入下面的界面。
点击example并且选着WebSocket Examples 4. 解释下（例子是从简单到难)：
Echo example ：简单的连接发送信息。
Chat example ：聊天系统室。
Multiplayer snake example ：多人对抗贪吃蛇
Multiplayer drawboard example：多人画布(同步的)
例子的参考代码是自带的，在tomcat文件夹内 1.class包 E:\apache-tomcat 9\apache-tomcat-9.0.22\webapps\examples\WEB-INF\classes\websocket 2.xhtml E:\apache-tomcat 9\apache-tomcat-9.0.22\webapps\examples\websocket ExamplesConfig.java 是websocket连接的配置文件 4." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6e57b08b79493e37cd75315384a16669/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-29T16:45:46+08:00" />
<meta property="article:modified_time" content="2020-03-29T16:45:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Websocket原理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1websocket_1" rel="nofollow">1.websocket简单介绍</a></li><li><a href="#2_websocket_16" rel="nofollow">2. 为什么要用websocket</a></li><li><a href="#3_websocket_20" rel="nofollow">3. websocket的自带演示例子</a></li><li><a href="#4_websocket_55" rel="nofollow">4. 简单websocket连接</a></li><li><a href="#5_webSocket_208" rel="nofollow">5. 用webSocket实现一个简单的聊天室</a></li><li><a href="#6_webSocket_210" rel="nofollow">6. 用webSocket实现贪吃蛇</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1websocket_1"></a>1.websocket简单介绍</h2> 
<ol><li>WebSocket 是 HTML5 开始提供的一种在单个 TCP 连接上进行<strong>全双工通讯</strong>的协议。</li><li>WebSocket 使得客户端和服务器之间的数据交换变得更加简单，<em><strong>允许服务端主动向客户端推送数据</strong></em>。在 WebSocket API 中，浏览器和服务器只需要完成一次握手，两者之间就直接可以创建<strong>持久性</strong>的连接，并进行双向数据传输。</li><li>在 WebSocket API 中，浏览器和服务器<strong>只需要做一个握手的动作</strong>，然后，浏览器和服务器之间就形成了<strong>一条快速通道</strong>。两者之间就直接可以数据互相传送。</li></ol> 
<pre><code>重点：1.全双工，客户端与服务端可以同时相互通信，就如同打电话一样，两边可以同时说话。
     2.允许服务端主动向客户端发数据，在以往的通信中是客户端向服务端发送请求，服务端再回复给客户端，一切起源只能是客户端的request，服务端无法主动发送信息给客户端；在websocket中，则可以服务端主动给客户端发送信息。
     3.持久性，当服务端跟客户端通信连接成功(即建立起一个管道),这个管道将会一直存在，随时可以传送数据，无需在request。
</code></pre> 
<p>若没有说清楚，请再参考下面的文章，说的比较通俗易懂。</p> 
<pre><code class="prism language-java"> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>jianshu<span class="token punctuation">.</span>com<span class="token operator">/</span>p<span class="token operator">/</span>d5c1f704fbc5</code></pre> 
<h2><a id="2_websocket_16"></a>2. 为什么要用websocket</h2> 
<ol><li>初次接触 WebSocket 的人，都会问同样的问题：我们已经有了 HTTP 协议，为什么还需要另一个协议？它能带来什么好处？答案很简单，因为 HTTP 协议有一个缺陷：通信只能由客户端发起。</li><li>举例来说，我们想了解今天的天气，只能是客户端向服务器发出请求，服务器返回查询结果。HTTP 协议做不到服务器主动向客户端推送信息。</li></ol> 
<h2><a id="3_websocket_20"></a>3. websocket的自带演示例子</h2> 
<p>现在演示下websocket自带的example</p> 
<ol><li>先启动Tomcat。<br> 在Tomcat文件下bin文件里面，找到startup.bat 双击点击启动。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/30/36/x7qNO2h3_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/c5/c9/5J9MHFAC_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/e6/62/LdmSZElM_o.png"></li><li>启动成功后，在浏览器中输入http://localhost:8080/，进入下面的界面。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/56/cd/28zxBdBD_o.png"></li><li>点击example并且选着WebSocket Examples</li></ol> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/ef/01/QtvzdN5C_o.png"><br> 4. 解释下（例子是从简单到难)：<br> Echo example ：简单的连接发送信息。</p> 
<p>Chat example ：聊天系统室。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/46/1f/RjKW609Y_o.png"><br> Multiplayer snake example ：多人对抗贪吃蛇<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/76/39/hVriU0gd_o.png"><br> Multiplayer drawboard example：多人画布(同步的)<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/ed/33/vE25sApt_o.png"></p> 
<ol start="5"><li>例子的参考代码是自带的，在tomcat文件夹内</li></ol> 
<pre><code class="prism language-java"><span class="token number">1.</span><span class="token keyword">class</span>包
E<span class="token operator">:</span>\apache<span class="token operator">-</span>tomcat <span class="token number">9</span>\apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.22</span>\webapps\examples\WEB<span class="token operator">-</span>INF\classes\websocket

<span class="token number">2.</span>xhtml
E<span class="token operator">:</span>\apache<span class="token operator">-</span>tomcat <span class="token number">9</span>\apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.22</span>\webapps\examples\websocket

ExamplesConfig<span class="token punctuation">.</span>java 是websocket连接的配置文件</code></pre> 
<h2><a id="4_websocket_55"></a>4. 简单websocket连接</h2> 
<ol><li> <p>先创建一个web项目(我的项目名:Bwebsocket_1)<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/35/49/N030J9oX_o.png"></p> </li><li> <p>导入需要的jar包，如下：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/09/0e/XyojuNpY_o.png"><br> tomcat-websocket.jar包是 tomcat服务器对于webSocket接口的实现。<br> websocket-api.jar包是定义webSocket应用程序开发接口。<br> (两个包，缺一不可)。这两个包在E:\apache-tomcat 9\apache-tomcat-9.0.22\lib中<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/3c/f7/Fza7IJMp_o.png"></p> </li><li> <p>建立启动类，是websocket连接的配置文件。<br> 启动类会在启动项目的时候，自动启动的。它需要实现ServerApplicationConfig接口。(具体在代码上说)<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/c9/fb/0D51fSzI_o.png"></p> </li></ol> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>config<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Set<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span>Endpoint<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span>server<span class="token punctuation">.</span>ServerApplicationConfig<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span>server<span class="token punctuation">.</span>ServerEndpointConfig<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Config</span> <span class="token keyword">implements</span> <span class="token class-name">ServerApplicationConfig</span><span class="token punctuation">{<!-- --></span>
 		<span class="token comment">/*
 		1.在ServerApplicationConfig接口中，需要实现两个方法，分别如下两个。
		2.通常我们用的是第一个函数(自动扫描)，是注解方式，启动时，会自动扫描src下是否有 @ServerEndpoint注解的类。
  		3.第二个函数是 用接口形式的，通常不用，想了解的人可以自行百度一下。
  */</span>
 		<span class="token annotation punctuation">@Override</span>
 		<span class="token keyword">public</span> Set<span class="token operator">&lt;</span>Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">&gt;&gt;</span> <span class="token function">getAnnotatedEndpointClasses</span><span class="token punctuation">(</span>Set<span class="token operator">&lt;</span>Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">&gt;&gt;</span> scans<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
 		 <span class="token comment">// TODO 自动生成的方法存根</span>
 		 System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"config....."</span> <span class="token operator">+</span> scans<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//用于第5步骤测试</span>
  		<span class="token keyword">return</span> scans<span class="token punctuation">;</span>
 		<span class="token punctuation">}</span>
  		<span class="token annotation punctuation">@Override</span>
 		<span class="token keyword">public</span> Set<span class="token generics function"><span class="token punctuation">&lt;</span>ServerEndpointConfig<span class="token punctuation">&gt;</span></span> <span class="token function">getEndpointConfigs</span><span class="token punctuation">(</span>Set<span class="token operator">&lt;</span>Class<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Endpoint</span><span class="token operator">&gt;&gt;</span> arg0<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  		<span class="token comment">// TODO 自动生成的方法存根</span>
  		<span class="token keyword">return</span> null<span class="token punctuation">;</span>
 		<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> 
<ol start="4"><li>建立服务器。<br> 先创建一个sockets包，并创建一个socket_1类。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/78/b5/69ahw0sY_o.png"><br> 在Socket_1.java中写下如下代码：</li></ol> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>sockets<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span>server<span class="token punctuation">.</span>ServerEndpoint<span class="token punctuation">;</span>

<span class="token annotation punctuation">@ServerEndpoint</span><span class="token punctuation">(</span><span class="token string">"/Socket_1"</span><span class="token punctuation">)</span>  <span class="token comment">//@ServerEndpoint()为注解，只有写了，启动类扫描时才会识别到，()里面可以随便写。</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Socket_1</span> <span class="token punctuation">{<!-- --></span>

<span class="token punctuation">}</span></code></pre> 
<ol start="5"><li> <p>测试是否可以扫描到相应的类。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/3b/58/UDfcHdop_o.png"><br> 这里可以看到scans.size()=1，即为一个。<br> 若我在sockets包中再创建一个socket_2类并且写上注解。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/04/e3/xcnSxsz1_o.png"><br> 再次启动web项目，结果如下：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/dc/25/RjvCb2RM_o.png"></p> </li><li> <p>建立一个首页<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/f8/07/P3eOagXZ_o.png"><br> 输入以下内容并可以生成相应的页面<img alt="在这里插入图片描述" src="https://images2.imgbox.com/f2/5d/DKrB2OfT_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/81/97/HQYW1wDQ_o.png"></p> </li><li> <p>在index.jsp页面中写入以下代码(创建连接)，<br> 即点下connect按钮，则会与服务器创建连接(这里的服务器是你的Socket_1类)</p> </li></ol> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">%</span>@ page language<span class="token operator">=</span><span class="token string">"java"</span> contentType<span class="token operator">=</span><span class="token string">"text/html; charset=UTF-8"</span>
    pageEncoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html PUBLIC <span class="token string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span> <span class="token string">"http://www.w3.org/TR/html4/loose.dtd"</span><span class="token operator">&gt;</span>
<span class="token generics function"><span class="token punctuation">&lt;</span>html<span class="token punctuation">&gt;</span></span>
<span class="token generics function"><span class="token punctuation">&lt;</span>head<span class="token punctuation">&gt;</span></span>
<span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">"Content-Type"</span> content<span class="token operator">=</span><span class="token string">"text/html; charset=UTF-8"</span><span class="token operator">&gt;</span>
<span class="token generics function"><span class="token punctuation">&lt;</span>title<span class="token punctuation">&gt;</span></span>Insert title here<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">&gt;</span>
	var ws<span class="token punctuation">;</span>   <span class="token comment">/* 创建全局Websocket对象 */</span>
 
 <span class="token comment">/* target 为地址，即跟谁建立起管道，Bwebsocket_1是项目名  、Socket_1必须跟注解@ServerEndpoint("")中的值一样 */</span>
 	var target <span class="token operator">=</span> <span class="token string">"ws://localhost:8080/Bwebsocket_1/Socket_1"</span><span class="token punctuation">;</span> 
 	function <span class="token function">subopen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">//这段代码是检查你的浏览器是否支持websocket协议</span>
 	  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'WebSocket'</span> in window<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          	  ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//创建管道</span>
		  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"启动了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       	 <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'MozWebSocket'</span> in window<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MozWebSocket</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'WebSocket is not supported by this browser.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span> 
   <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token generics function"><span class="token punctuation">&lt;</span>body<span class="token punctuation">&gt;</span></span>
 <span class="token operator">&lt;</span>button onclick<span class="token operator">=</span><span class="token string">"subopen()"</span><span class="token operator">&gt;</span>connect<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>input id <span class="token operator">=</span> <span class="token string">"msg"</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token generics function"><span class="token punctuation">&lt;</span>button<span class="token punctuation">&gt;</span></span>send<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"content"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span></code></pre> 
<ol start="8"><li>在Socket_1类中，写入以下代码。<br> 先科普个知识点<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/57/ed/fuTd8oy6_o.png"></li></ol> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>sockets<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span>OnOpen<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span>Session<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span>server<span class="token punctuation">.</span>ServerEndpoint<span class="token punctuation">;</span>

<span class="token annotation punctuation">@ServerEndpoint</span><span class="token punctuation">(</span><span class="token string">"/Socket_1"</span><span class="token punctuation">)</span>  <span class="token comment">//@ServerEndpoint()为注解，只有写了，启动类扫描时才会识别到，()里面可以随便写。</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Socket_1</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//连接时则会执行@OnOpen中的代码，这里只是让他输出，连接session个数。</span>
	 <span class="token annotation punctuation">@OnOpen</span>
	 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">open</span><span class="token punctuation">(</span>Session session<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
 	 System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Session......"</span> <span class="token operator">+</span> session<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> 
<ol start="9"><li>启动web项目<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/4d/05/Tkt5uTBR_o.png"><br> 点击connect按钮<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/5b/7e/tAcxqMnu_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/00/2b/g1s4EXSH_o.png"><br> 且在控制台会输出Socket_1中的代码，也可以看出连接成功，管道建立成功，此时我在开启一个网页并点击connect按钮。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/49/20/JLsKMF9z_o.png"><br> 则会又建立一个管道。一个session代表一个通信会话，10个session之间不冲突，即变量之间不影响。<br> 我们从网页上来看，<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/65/4c/b5KOQjry_o.png"></li><li>接下来我们来尝试发消息。先是客户端发信息，服务端收信息。</li></ol> 
<p>在服务端中我们加入下面代码(服务端要收消息)：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/b0/c4/KcMlFilB_o.png"><br> 在index.jsp页面中写入(客户端要发消息，即重要代码是：ws.send(a);a变量为需要发送的话)<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/a4/e6/yGJXFaow_o.png"><br> 点击运行，一定要先连接，后再发送消息。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/a8/af/I0rrMwJ0_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/98/83/qZBDFNtW_o.png"><br> 11. 现在是服务端收到消息，向客户端发送消息<br> 再客户端中写入(收消息的函数):<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/c8/09/lACjuVvq_o.png"><br> 在服务端中写入发送消息相关代码：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/68/38/ghP6R07c_o.png"><br> 红圈则是 服务端给客户端发送信息的代码。<br> 运行，一定要点击connect 先连接 先连接 先连接 再发送消息。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/8e/f9/JvRUifIu_o.png"><br> 若继续发信息，<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/a1/7a/CcfWB3YJ_o.png"></p> 
<h2><a id="5_webSocket_208"></a>5. 用webSocket实现一个简单的聊天室</h2> 
<p>由于写博客需要一定时间，作者最近身体有点虚，之后再补上，请大家耐心等待。不好意思了，各位。</p> 
<h2><a id="6_webSocket_210"></a>6. 用webSocket实现贪吃蛇</h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3fd377925a1e8c7eaf31ffe6400bf56c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">四元数</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4367cd10ea8d07cff169d0d8bdc0dd0a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">目标检测学习路线（精华版）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>