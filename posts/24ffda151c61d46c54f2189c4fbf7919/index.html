<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>sklearn库 bp神经网络[从原理到代码一篇搞定]（2） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="sklearn库 bp神经网络[从原理到代码一篇搞定]（2）" />
<meta property="og:description" content="什么是bp神经网络 BP神经网络，即反向传播神经网络（Backpropagation Neural Network），是一种广泛应用于分类、回归和聚类等任务的人工神经网络。
bp神经网络的结构 BP神经网络的基本结构包含三层：输入层、隐含层和输出层。其中，输入层接受输入数据，隐含层和输出层由若干个神经元组成。每个神经元与前一层的每个神经元相连，并带有权重。当输入数据通过神经网络时，每个神经元将加权输入相加，并通过一个激活函数进行非线性变换，然后将输出传递到下一层神经元。这样逐层传递后，最后输出层将产生一个输出结果。
BP神经网络的训练过程是基于误差反向传播算法(Backpropagation)，即通过反向传播误差来更新每个神经元的权重值，以减小网络输出与真实输出之间的误差。误差计算的目标函数通常是平方误差或交叉熵误差。
激活函数 在神经网络中，激活函数（Activation Function）是一种将输入信号转换为输出信号的非线性函数。它在神经元中起到非线性映射的作用，可以增强神经网络的表示能力和学习能力。
以下是常用的激活函数及其表达式：
sigmoid函数
f ( x ) = 1 1 &#43; e − x f(x) = \frac{1}{1&#43;e^{-x}} f(x)=1&#43;e−x1​
sigmoid函数的输出值在0到1之间，具有平滑的S形曲线。它在二元分类和神经网络中的某些层次中经常使用，但由于其存在梯度消失的问题，逐渐被ReLU等激活函数所取代。
tanh函数
f ( x ) = e x − e − x e x &#43; e − x f(x) = \frac{e^x - e^{-x}}{e^x &#43; e^{-x}} f(x)=ex&#43;e−xex−e−x​
tanh函数也是一种S形曲线函数，其输出值在**-1到1**之间。它相比sigmoid函数具有更大的梯度，但在面对大量输入时，tanh函数仍然存在梯度消失的问题。
ReLU函数
ReLU函数在输入为正数时直接输出该值，否则输出0。相较于sigmoid和tanh函数，ReLU函数的计算速度更快，且不存在梯度消失问题。因此，它被广泛应用于深度神经网络中。
损失函数 损失函数是用来衡量模型预测结果与实际结果之间的差异的函数。在神经网络中，损失函数通常用于评估模型的性能，从而优化模型参数以提高预测准确度。
不同的任务可能需要使用不同的损失函数。下面是一些常见的损失函数：
均方误差（Mean Squared Error，MSE）：适用于回归问题，表示预测值与真实值之间的平方差的平均值。表达式为：
其中 n n n 表示样本数量， y i y_i yi​ 表示真实值， y i ^ \hat{y_i} yi​^​ 表示模型的预测值。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/24ffda151c61d46c54f2189c4fbf7919/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-03T11:24:46+08:00" />
<meta property="article:modified_time" content="2023-04-03T11:24:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">sklearn库 bp神经网络[从原理到代码一篇搞定]（2）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="bp_0"></a>什么是bp神经网络</h2> 
<p>BP神经网络，即反向传播神经网络（Backpropagation Neural Network），是一种广泛应用于分类、回归和聚类等任务的人工神经网络。</p> 
<h2><a id="bp_2"></a>bp神经网络的结构</h2> 
<p>BP神经网络的基本结构包含三层：<strong>输入层</strong>、<strong>隐含层</strong>和<strong>输出层</strong>。其中，输入层接受输入数据，隐含层和输出层由若干个神经元组成。每个神经元与前一层的每个神经元相连，并带有权重。当输入数据通过神经网络时，每个神经元将加权输入相加，并通过一个<strong>激活函数</strong>进行非线性变换，然后将输出传递到下一层神经元。这样逐层传递后，最后输出层将产生一个输出结果。</p> 
<p>BP神经网络的训练过程是基于<strong>误差反向传播算法</strong>(Backpropagation)，即通过<mark>反向传播误差来更新每个神经元的权重值，以减小网络输出与真实输出之间的误差</mark>。误差计算的目标函数通常是平方误差或交叉熵误差。</p> 
<h3><a id="_6"></a>激活函数</h3> 
<p>在神经网络中，<strong>激活函数</strong>（Activation Function）是一种将<strong>输入信号转换为输出信号的非线性函数</strong>。它在神经元中起到非线性映射的作用，可以增强神经网络的表示能力和学习能力。<br> 以下是常用的激活函数及其表达式：</p> 
<p><mark>sigmoid函数</mark><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
         = 
        
        
        
          1 
         
         
         
           1 
          
         
           + 
          
          
          
            e 
           
           
           
             − 
            
           
             x 
            
           
          
         
        
       
      
        f(x) = \frac{1}{1+e^{-x}} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.2484em; vertical-align: -0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7027em;"><span class="" style="top: -2.786em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4033em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><br> sigmoid函数的输出值在0到1之间，具有平滑的S形曲线。它在<strong>二元分类</strong>和神经网络中的某些层次中经常使用，但由于其<strong>存在梯度消失的问题</strong>，逐渐被<strong>ReLU</strong>等激活函数所取代。</p> 
<p><mark>tanh函数</mark><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
         = 
        
        
         
          
          
            e 
           
          
            x 
           
          
         
           − 
          
          
          
            e 
           
           
           
             − 
            
           
             x 
            
           
          
         
         
          
          
            e 
           
          
            x 
           
          
         
           + 
          
          
          
            e 
           
           
           
             − 
            
           
             x 
            
           
          
         
        
       
      
        f(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.3907em; vertical-align: -0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9874em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.5935em;"><span class="" style="top: -2.786em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7027em;"><span class="" style="top: -2.786em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7385em;"><span class="" style="top: -2.931em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8477em;"><span class="" style="top: -2.931em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4033em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><br> tanh函数也是一种S形曲线函数，其输出值在**-1到1**之间。它相比sigmoid函数具有更大的梯度，但在面对大量输入时，<strong>tanh函数仍然存在梯度消失的问题。</strong></p> 
<p><mark>ReLU函数</mark><br> <img src="https://images2.imgbox.com/ad/52/s73sJtY8_o.png" alt="在这里插入图片描述"></p> 
<p>ReLU函数在输入为正数时直接输出该值，否则输出0。相较于sigmoid和tanh函数，ReLU函数的计算速度更快，<strong>且不存在梯度消失问题</strong>。因此，它被广泛应用于深度神经网络中。</p> 
<h3><a id="_22"></a>损失函数</h3> 
<p>损失函数是用来<strong>衡量模型预测结果与实际结果之间的差异的函数。<strong>在神经网络中，损失函数通常用于</strong>评估模型的性能，从而优化模型参数以提高预测准确度。</strong></p> 
<p>不同的任务可能需要使用不同的损失函数。下面是一些常见的损失函数：</p> 
<p><strong>均方误差</strong>（Mean Squared Error，MSE）：适用于回归问题，表示预测值与真实值之间的平方差的平均值。表达式为：<br> <img src="https://images2.imgbox.com/87/93/liY6LGa9_o.png" alt="在这里插入图片描述"><br> 其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
      
        n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> 表示样本数量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          y 
         
        
          i 
         
        
       
      
        y_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 表示真实值，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           y 
          
         
           i 
          
         
        
          ^ 
         
        
       
      
        \hat{y_i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span></span></span></span></span> 表示模型的预测值。</p> 
<p><strong>交叉熵</strong>（Cross Entropy，CE）：适用于<strong>分类问题</strong>，表示<strong>预测值与真实值之间的差异</strong>。表达式为：<br> <img src="https://images2.imgbox.com/a2/85/jXvovx67_o.png" alt="在这里插入图片描述"><br> 其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
      
        n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> 表示样本数量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         M 
        
       
      
        M 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">M</span></span></span></span></span> 表示类别数量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          y 
         
         
         
           i 
          
         
           j 
          
         
        
       
      
        y_{ij} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 表示第 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> 个样本的真实标签，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           y 
          
          
          
            i 
           
          
            j 
           
          
         
        
          ^ 
         
        
       
      
        \hat{y_{ij}} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span> 表示模型预测的第 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> 个样本属于第 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         j 
        
       
      
        j 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0572em;">j</span></span></span></span></span> 个类别的概率。</p> 
<p><strong>交叉熵的二分类形式</strong>（Binary Cross Entropy，BCE）：适用于<strong>二分类</strong>问题，表达式为：<br> <img src="https://images2.imgbox.com/1a/87/sDHpRHXK_o.png" alt="在这里插入图片描述"><br> 其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
      
        n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> 表示样本数量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          y 
         
        
          i 
         
        
       
      
        y_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 表示第 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> 个样本的真实标签（取值为 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         0 
        
       
      
        0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span> 或 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         1 
        
       
      
        1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>），<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           y 
          
         
           i 
          
         
        
          ^ 
         
        
       
      
        \hat{y_i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span></span></span></span></span> 表示模型预测的第 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> 个样本属于第一个类别（即标签为 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         1 
        
       
      
        1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>）的概率。</p> 
<h3><a id="_38"></a>模型的超参数</h3> 
<p>超参数是在训练神经网络模型时需要手动设置的参数，它们不是通过训练数据学习得到的。设置不当的超参数可能会导致模型表现不佳。以下是一些常见的超参数：</p> 
<p>1.<strong>学习率</strong>（Learning Rate）：指定每次更新模型参数时的步长大小，即模型参数在每次迭代中更新的幅度。<strong>学习率过小会导致模型收敛速度过慢，学习率过大可能会导致模型不稳定</strong>。</p> 
<p>2.<strong>批量大小</strong>（Batch Size）：<strong>指定每次更新模型参数时使用的样本数量。<strong>较</strong>小</strong>的批量大小可以使模型<strong>更快地收敛</strong>，但会<strong>增加模型的方差</strong>；较<strong>大</strong>的批量大小可以<strong>减少模型的方差</strong>，但会使模型<strong>收敛速度较慢</strong>。</p> 
<p>3.<strong>迭代次数</strong>（Number of Iterations）：<strong>指定训练模型时的迭代次数。<strong>迭代次数</strong>过少</strong>可能会导致模型<strong>欠拟合</strong>，迭代次数<strong>过多</strong>可能会导致模型<strong>过拟合</strong>。</p> 
<p>4.<strong>正则化系数</strong>（Regularization Coefficient）：指定用于控制模型复杂度的正则化系数。<strong>正则化可以有效减少过拟合问题，但正则化系数过大可能会导致欠拟合问题</strong>。</p> 
<p>5.<strong>隐藏层大小</strong>（Size of Hidden Layers）：指定**隐藏层中神经元的数量。**较大的隐藏层可以使模型更好地拟合训练数据，但也可能导致过拟合问题。</p> 
<p>6.<strong>优化算法</strong>（Optimization Algorithm）：指定用于更新模型参数的优化算法，如<strong>随机梯度下降</strong>（Stochastic Gradient Descent，SGD）、<strong>Adam、Adagrad</strong> 等。不同的优化算法对模型性能的影响不同，需要根据具体情况选择。</p> 
<h2><a id="bp_53"></a>bp神经网络的基本步骤</h2> 
<p><strong>1.前向传播</strong>：将训练数据输入神经网络，计算网络输出。</p> 
<p><strong>2.计算误差</strong>：将网络输出与真实输出比较，计算误差。</p> 
<p><strong>3.反向传播误差</strong>：从输出层开始，将误差反向传播回每个神经元，计算每个神经元的误差梯度。</p> 
<p><strong>4.更新权重</strong>：根据<strong>误差梯度和学习率</strong>更新每个神经元的<strong>权重值</strong>。</p> 
<p>重复以上步骤，直到网络的<strong>误差满足要求</strong>或达到<strong>最大训练次数</strong>。</p> 
<p>BP神经网络的优点是能够对非线性模式进行拟合，并且可以应用于多种任务。缺点是需要大量的训练数据和计算资源，并且<strong>容易过拟合</strong>。因此，在实际应用中，需要根据具体任务选择<strong>合适的网络结构</strong>、<strong>参数</strong>和<strong>优化算法</strong>，以提高网络的<strong>性能</strong>和<strong>泛化能力</strong>。</p> 
<h2><a id="sklearnbp_66"></a>基于sklearn库的bp神经网络具体案例</h2> 
<p>下面是基于bp神经网络的鸢尾花一例的代码：<br> 参数说明：<br> 其中隐藏层大小为10<br> 最大迭代次数为1000<br> 学习率为0.1（默认）<br> 样本数量自动调整批量大小。<br> 优化算法（solver）：默认为"adam"，即使用Adam优化算法。<br> 正则化系数（alpha）：默认值为0.0001，使用L2正则化。<br> 损失函数是均方误差（默认）</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neural_network <span class="token keyword">import</span> MLPClassifier
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score

<span class="token comment"># 加载鸢尾花数据集</span>
iris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 划分训练集和测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>data<span class="token punctuation">,</span> iris<span class="token punctuation">.</span>target<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 创建BP神经网络分类器</span>
mlp <span class="token operator">=</span> MLPClassifier<span class="token punctuation">(</span>hidden_layer_sizes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 训练模型</span>
mlp<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

<span class="token comment"># 预测测试集</span>
y_pred <span class="token operator">=</span> mlp<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

<span class="token comment"># 计算准确率</span>
accuracy <span class="token operator">=</span> accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Accuracy:"</span><span class="token punctuation">,</span> accuracy<span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/40292f5f3ccaaa26e99cba69945ab273/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python字典的增删改查（基础）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bbfc72789f5b06ba9d36cf8242cdea2f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Git如何查看分支列表？具体步骤是怎样的？底层原理是什么？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>