<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C&#43;&#43;哈希表 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C&#43;&#43;哈希表" />
<meta property="og:description" content="文章目录 一、哈希表1.1 哈希概念1.2 哈希冲突1.3 哈希函数1.4 载荷因子 二、解决哈希冲突2.1 闭散列2.2 闭散列代码实现2.3 开散列2.4 开散列代码实现 一、哈希表 1.1 哈希概念 顺序结构以及平衡树中，元素关键码与其存储位置之间没有对应的关系，因此在查找一个元素时，必须要经过关键码的多次比较。顺序查找时间复杂度为O(N)，平衡树中为树的高度，即O( logN)，搜索的效率取决于搜索过程中元素的比较次数。
理想的搜索方法：可以不经过任何比较，一次直接从表中得到要搜索的元素。 如果构造一种存储结构，通过某种函数(hashFunc)使元素的存储位置与它的关键码之间能够建立一一映射的关系，那么在查找时通过该函数可以很快找到该元素。
当向该结构中：
插入元素
根据待插入元素的关键码，以此函数计算出该元素的存储位置并按此位置进行存放搜索元素
对元素的关键码进行同样的计算，把求得的函数值当做元素的存储位置，在结构中按此位置取元素比较，若关键码相等，则搜索成功 该方式即为哈希(散列)方法，哈希方法中使用的转换函数称为哈希(散列)函数，构造出来的结构称为哈希表(Hash Table)(或者称散列表)
1.2 哈希冲突 对于两个数据元素的关键字ki 和 kj (i != j)，有ki != kj，但有：Hash(ki) == Hash(kj)，即：不同关键字通过相同哈希哈数计算出相同的哈希地址，该种现象称为哈希冲突或哈希碰撞。
把具有不同关键码而具有相同哈希地址的数据元素称为“同义词”。
1.3 哈希函数 引起哈希冲突的一个原因可能是：哈希函数设计不够合理。 哈希函数设计原则：
哈希函数的定义域必须包括需要存储的全部关键码，而如果散列表允许有m个地址时，其值域必须在0
到m-1之间.
哈希函数计算出来的地址能均匀分布在整个空间中,哈希函数应该比较简单。
常见哈希函数
直接定制法–(常用)
取关键字的某个线性函数为散列地址：Hash（Key）= A*Key &#43; B
优点：简单、均匀
缺点：需要事先知道关键字的分布情况 使用场景：适合查找比较小且连续的情况。除留余数法–(常用)
设散列表中允许的地址数为m，取一个不大于m，但最接近或者等于m的质数p作为除数，按照哈希函数：Hash(key) = key% p(p&lt;=m),将关键码转换成哈希地址。平方取中法–(了解)
假设关键字为1234，对它平方就是1522756，抽取中间的3位227作为哈希地址； 再比如关键字为4321，对它平方就是18671041，抽取中间的3位671(或710)作为哈希地址 平方取中法比较适合：不知道关键字的分布，而位数又不是很大的情况。折叠法–(了解)
折叠法是将关键字从左到右分割成位数相等的几部分(最后一部分位数可以短些)，然后将这几部分叠加求和，并按散列表表长，取后几位作为散列地址。
折叠法适合事先不需要知道关键字的分布，适合关键字位数比较多的情况。随机数法–(了解)
选择一个随机函数，取关键字的随机函数值为它的哈希地址，即H(key) = random(key),其中random为随机数函数。通常应用于关键字长度不等时采用此法。数学分析法–(了解)
设有n个d位数，每一位可能有r种不同的符号，这r种不同的符号在各位上出现的频率不一定相同，可能在某些位上分布比较均匀，每种符号出现的机会均等，在某些位上分布不均匀只有某几种符号经常出现。可根据散列表的大小，选择其中各种符号分布均匀的若干位作为散列地址。 哈希函数设计的越精妙，产生哈希冲突的可能性就越低，但是无法避免哈希冲突
1.4 载荷因子 散列表的载荷因子定义为：a = 填入表中的元素个数 / 散列表的长度" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/205cbd117ff31250e531c4459f054549/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-07T14:28:35+08:00" />
<meta property="article:modified_time" content="2022-08-07T14:28:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C&#43;&#43;哈希表</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_3" rel="nofollow">一、哈希表</a></li><li><ul><li><a href="#11__4" rel="nofollow">1.1 哈希概念</a></li><li><a href="#12__15" rel="nofollow">1.2 哈希冲突</a></li><li><a href="#13__22" rel="nofollow">1.3 哈希函数</a></li><li><a href="#14__49" rel="nofollow">1.4 载荷因子</a></li></ul> 
  </li><li><a href="#_55" rel="nofollow">二、解决哈希冲突</a></li><li><ul><li><a href="#21__58" rel="nofollow">2.1 闭散列</a></li><li><a href="#22__76" rel="nofollow">2.2 闭散列代码实现</a></li><li><a href="#23__304" rel="nofollow">2.3 开散列</a></li><li><a href="#24__312" rel="nofollow">2.4 开散列代码实现</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_3"></a>一、哈希表</h2> 
<h3><a id="11__4"></a>1.1 哈希概念</h3> 
<p>顺序结构以及平衡树中，元素关键码与其存储位置之间没有对应的关系，因此在查找一个元素时，必须要经过关键码的多次比较。顺序查找时间复杂度为O(N)，平衡树中为树的高度，即O( logN)，搜索的效率取决于搜索过程中元素的比较次数。<br> 理想的搜索方法：可以不经过任何比较，一次直接从表中得到要搜索的元素。 如果构造一种存储结构，通过某种函数(hashFunc)使元素的存储位置与它的关键码之间能够建立一一映射的关系，那么在查找时通过该函数可以很快找到该元素。</p> 
<p>当向该结构中：</p> 
<ul><li>插入元素<br> 根据待插入元素的关键码，以此函数计算出该元素的存储位置并按此位置进行存放</li><li>搜索元素<br> 对元素的关键码进行同样的计算，把求得的函数值当做元素的存储位置，在结构中按此位置取元素比较，若关键码相等，则搜索成功</li></ul> 
<p>该方式即为哈希(散列)方法，哈希方法中使用的转换函数称为哈希(散列)函数，构造出来的结构称为哈希表(Hash Table)(或者称散列表)</p> 
<h3><a id="12__15"></a>1.2 哈希冲突</h3> 
<p>对于两个数据元素的关键字k<sub>i</sub> 和 k<sub>j</sub> (i != j)，有k<sub>i</sub> != k<sub>j</sub>，但有：Hash(k<sub>i</sub>) == Hash(k<sub>j</sub>)，即：不同关键字通过相同哈希哈数计算出相同的哈希地址，该种现象称为哈希冲突或哈希碰撞。<br> 把具有不同关键码而具有相同哈希地址的数据元素称为“同义词”。</p> 
<p><img src="https://images2.imgbox.com/75/3f/Yez0aygw_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="13__22"></a>1.3 哈希函数</h3> 
<p>引起哈希冲突的一个原因可能是：哈希函数设计不够合理。 哈希函数设计原则：<br> 哈希函数的定义域必须包括需要存储的全部关键码，而如果散列表允许有m个地址时，其值域必须在0<br> 到m-1之间.</p> 
<p>哈希函数计算出来的地址能均匀分布在整个空间中,哈希函数应该比较简单。<br> <strong>常见哈希函数</strong></p> 
<ol><li>直接定制法–(常用)<br> 取关键字的某个线性函数为散列地址：Hash（Key）= A*Key + B<br> 优点：简单、均匀<br> 缺点：需要事先知道关键字的分布情况 使用场景：适合查找比较小且连续的情况。</li><li>除留余数法–(常用)<br> 设散列表中允许的地址数为m，取一个不大于m，但最接近或者等于m的质数p作为除数，按照哈希函数：Hash(key) = key% p(p&lt;=m),将关键码转换成哈希地址。</li><li>平方取中法–(了解)<br> 假设关键字为1234，对它平方就是1522756，抽取中间的3位227作为哈希地址； 再比如关键字为4321，对它平方就是18671041，抽取中间的3位671(或710)作为哈希地址 平方取中法比较适合：不知道关键字的分布，而位数又不是很大的情况。</li><li>折叠法–(了解)<br> 折叠法是将关键字从左到右分割成位数相等的几部分(最后一部分位数可以短些)，然后将这几部分叠加求和，并按散列表表长，取后几位作为散列地址。<br> 折叠法适合事先不需要知道关键字的分布，适合关键字位数比较多的情况。</li><li>随机数法–(了解)<br> 选择一个随机函数，取关键字的随机函数值为它的哈希地址，即H(key) = random(key),其中random为随机数函数。通常应用于关键字长度不等时采用此法。</li><li>数学分析法–(了解)<br> 设有n个d位数，每一位可能有r种不同的符号，这r种不同的符号在各位上出现的频率不一定相同，可能在某些位上分布比较均匀，每种符号出现的机会均等，在某些位上分布不均匀只有某几种符号经常出现。可根据散列表的大小，选择其中各种符号分布均匀的若干位作为散列地址。</li></ol> 
<p><mark>哈希函数设计的越精妙，产生哈希冲突的可能性就越低，但是无法避免哈希冲突</mark></p> 
<h3><a id="14__49"></a>1.4 载荷因子</h3> 
<p>散列表的载荷因子定义为：<code>a = 填入表中的元素个数 / 散列表的长度</code></p> 
<p>a 是散列表装满程度的标志因子。由于表长是定值，a 与“填入表中的元素个数”成正比，所以 a 越大，表明填入表中的元素越多，产生冲突的可能性就越大；反之，a 越小，标明填入表中的元素越少，产生冲突的可能性就越小。实际上，散列表的平均查找长度是载荷因子 a 的函数，只是不同处理冲突的方法有不同的函数。</p> 
<p>对于开放定址法，荷载因子是特别重要因素，应严格限制在0.7-0.8以下。超过0.8，查表时的CPU缓存不命中（cache missing）按照指数曲线上升。因此，一些采用开放定址法的hash库，如Java的系统库限制了荷载因子为0.75，超过此值将resize散列表。</p> 
<h2><a id="_55"></a>二、解决哈希冲突</h2> 
<p>解决哈希冲突两种常见的方法是：闭散列和开散列</p> 
<h3><a id="21__58"></a>2.1 闭散列</h3> 
<p>闭散列：也叫开放定址法，当发生哈希冲突时，如果哈希表未被装满，说明在哈希表中必然还有空位置，那么可以把key存放到冲突位置中的“下一个” 空位置中去。那如何寻找下一个空位置呢？</p> 
<ol><li>线性探测<br> <strong>从发生冲突的位置开始，依次向后探测，直到寻找到下一个空位置为止。</strong><br> 比如上面的冲突，首先5放在5下标位置，15映射后发生冲突，从5下标往后面找，找到一个空位置就可以放了。</li></ol> 
<ul><li>插入<br> 通过哈希函数获取待插入元素在哈希表中的位置，如果该位置中没有元素则直接插入新元素，如果该位置中有元素发生哈希冲突，使用线性探测找到下一个空位置，插入新元素</li><li>删除<br> 采用闭散列处理哈希冲突时，不能随便物理删除哈希表中已有的元素，若直接删除元素会影响其他元素的搜索。比如删除元素4，如果直接删除掉，44查找起来可能会受影响。因此线性探测采用标记的伪删除法来删除一个元素。</li></ul> 
<p>线性探测优点：实现非常简单<br> 线性探测缺点：一旦发生哈希冲突，所有的冲突连在一起，容易产生数据“堆积”，即：不同关键码占据了可利用的空位置，使得寻找某关键码的位置需要许多次比较，导致搜索效率降低。</p> 
<ol start="2"><li>二次探测<br> 线性探测的缺陷是产生冲突的数据堆积在一块，这与其找下一个空位置有关系，因为找空位置的方式就是挨着往后逐个去找，因此二次探测为了避免该问题，找下一个空位置的方法为：H<sub>i</sub>= (H<sub>0</sub> + i<sup>2</sup>)% m，或者：H<sub>i</sub> = (H<sub>0</sub> - i<sup>2</sup>)% m。其中：i = 1,2,3…， H<sub>0</sub>是通过散列函数Hash(x)对元素的关键码 key 进行计算得到的位置，m是表的大小。</li></ol> 
<h3><a id="22__76"></a>2.2 闭散列代码实现</h3> 
<ul><li>删除某一个数据会影响其他很多的（与之相关发生冲突的数据）数据，所以使用标记法，表示已被删除，这里使用枚举表示</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">enum</span> <span class="token class-name">Status</span>
<span class="token punctuation">{<!-- --></span>
	EXIST<span class="token punctuation">,</span>
	EMPTY<span class="token punctuation">,</span>
	DELETE
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>定义数据结点，这里存储的是键值对</li></ul> 
<pre><code class="prism language-cpp">
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">V</span><span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">HashData</span>
<span class="token punctuation">{<!-- --></span>
	pair<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span> _kv<span class="token punctuation">;</span>
	Status _status <span class="token operator">=</span> EMPTY<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>由于传入的key值可能不是自然数，比如常用的字符串类型，它是不能取模，需要使用字符串哈希，变成一个整数来取模。<br> 所以需要设计一个仿函数拿到对应的数值</li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">// 哈希表数据结构</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">V</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">HashFunc</span> <span class="token operator">=</span> Hash<span class="token operator">&lt;</span>K<span class="token operator">&gt;</span> <span class="token operator">&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">HashTable</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">private</span><span class="token operator">:</span>
	vector<span class="token operator">&lt;</span>HashData<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span> <span class="token operator">&gt;</span> _tables<span class="token punctuation">;</span>
	size_t _n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 哈希表中存放的个数</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-cpp"><span class="token comment">// 用于将整数转换成0到大于零的正整数，防止出现对负数取模</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">Hash</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 将整型转成正数</span>
	size_t <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> K<span class="token operator">&amp;</span> key<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> key<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 常用到字符串类型的key值，这是一个特化版本</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">Hash</span> <span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 字符串哈希</span>
	size_t <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		size_t value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">// 也可以乘以31、131、1313、13131、131313.. </span>
			<span class="token comment">// 乘上一个数，减少冲突的概率</span>
			value <span class="token operator">*=</span> <span class="token number">31</span><span class="token punctuation">;</span>
			value <span class="token operator">+=</span> ch<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> value<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>扩容<br> 当负载因子较大时要扩容，防止出现冲突聚集，效率下降</li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">// 扩容，负载因子大于7时</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>_tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> _n <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">/</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">7</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	size_t newSize <span class="token operator">=</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">10</span> <span class="token operator">:</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token comment">// 扩容有两种方法</span>
	<span class="token comment">// 1. 可以遍历一遍数组，并重新映射</span>
	<span class="token comment">// 2. 创建一个本类对象，调用它的插入函数，完成映射，再交换对象</span>
	HashTable<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">,</span> HashFunc<span class="token operator">&gt;</span> newHT<span class="token punctuation">;</span>
	newHT<span class="token punctuation">.</span>_tables<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>newSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_tables<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_status <span class="token operator">==</span> EXIST<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			newHT<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>_tables<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_kv<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 交换两个数组</span>
	_tables<span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>newHT<span class="token punctuation">.</span>_tables<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>完整实现</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">namespace</span> CloseHash
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">enum</span> <span class="token class-name">Status</span>
	<span class="token punctuation">{<!-- --></span>
		EXIST<span class="token punctuation">,</span>
		EMPTY<span class="token punctuation">,</span>
		DELETE
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">V</span><span class="token operator">&gt;</span>
	<span class="token keyword">struct</span> <span class="token class-name">HashData</span>
	<span class="token punctuation">{<!-- --></span>
		pair<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span> _kv<span class="token punctuation">;</span>
		Status _status <span class="token operator">=</span> EMPTY<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token comment">// 用于将整数转换成0到大于零的正整数，防止出现对负数取模</span>
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token operator">&gt;</span>
	<span class="token keyword">struct</span> <span class="token class-name">Hash</span>
	<span class="token punctuation">{<!-- --></span>
		size_t <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> K<span class="token operator">&amp;</span> key<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> key<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token comment">// 常用到字符串类型的key值，这是一个特化版本</span>
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span>
	<span class="token keyword">struct</span> <span class="token class-name">Hash</span> <span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 字符串哈希</span>
		size_t <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			size_t value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token comment">// 也可以乘以31、131、1313、13131、131313.. </span>
				<span class="token comment">// 乘上一个数，减少冲突的概率</span>
				value <span class="token operator">*=</span> <span class="token number">31</span><span class="token punctuation">;</span>
				value <span class="token operator">+=</span> ch<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> value<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">V</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">HashFunc</span> <span class="token operator">=</span> Hash<span class="token operator">&lt;</span>K<span class="token operator">&gt;</span> <span class="token operator">&gt;</span>
	<span class="token keyword">class</span> <span class="token class-name">HashTable</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">private</span><span class="token operator">:</span>
		vector<span class="token operator">&lt;</span>HashData<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span> <span class="token operator">&gt;</span> _tables<span class="token punctuation">;</span>
		size_t _n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span><span class="token operator">:</span>
		<span class="token keyword">bool</span> <span class="token function">Erase</span><span class="token punctuation">(</span><span class="token keyword">const</span> K<span class="token operator">&amp;</span> key<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			HashData<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span><span class="token operator">*</span> ret <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
				<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token operator">--</span>_n<span class="token punctuation">;</span>
				ret<span class="token operator">-&gt;</span>_status <span class="token operator">=</span> DELETE<span class="token punctuation">;</span>
				<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		HashData<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span><span class="token operator">*</span> <span class="token function">Find</span><span class="token punctuation">(</span><span class="token keyword">const</span> K<span class="token operator">&amp;</span> key<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			HashFunc hf<span class="token punctuation">;</span>
			<span class="token comment">// 线性探测 or 二次探查</span>
			<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token function">hf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">%</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> index <span class="token operator">=</span> start<span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>_tables<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>_status <span class="token operator">!=</span> EMPTY<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>_tables<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>_status <span class="token operator">==</span> EXIST <span class="token operator">&amp;&amp;</span> _tables<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>_kv<span class="token punctuation">.</span>first <span class="token operator">==</span> key<span class="token punctuation">)</span>
					<span class="token keyword">return</span> <span class="token operator">&amp;</span>_tables<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
				index<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// 线性探测</span>
				<span class="token comment">//index = start + i * i ++ ;// 二次探查</span>
				index <span class="token operator">%=</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>

		<span class="token punctuation">}</span>
		<span class="token keyword">bool</span> <span class="token function">Insert</span><span class="token punctuation">(</span><span class="token keyword">const</span> pair<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span><span class="token operator">&amp;</span> kv<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			HashData<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span><span class="token operator">*</span> ret <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>kv<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token comment">// 扩容，负载因子大于7时</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> _n <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">/</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">7</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				size_t newSize <span class="token operator">=</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">10</span> <span class="token operator">:</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
				<span class="token comment">// 扩容有两种方法</span>
				<span class="token comment">// 1. 可以遍历一遍数组，并重新映射</span>
				<span class="token comment">// 2. 创建一个本类对象，调用它的插入函数，完成映射，再交换对象</span>
				HashTable<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">,</span> HashFunc<span class="token operator">&gt;</span> newHT<span class="token punctuation">;</span>
				newHT<span class="token punctuation">.</span>_tables<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>newSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>_tables<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_status <span class="token operator">==</span> EXIST<span class="token punctuation">)</span>
					<span class="token punctuation">{<!-- --></span>
						newHT<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>_tables<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_kv<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				<span class="token comment">// 交换两个数组</span>
				_tables<span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>newHT<span class="token punctuation">.</span>_tables<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			HashFunc hf<span class="token punctuation">;</span>
			<span class="token comment">// 线性探测 or 二次探查</span>
			<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token function">hf</span><span class="token punctuation">(</span>kv<span class="token punctuation">.</span>first<span class="token punctuation">)</span> <span class="token operator">%</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> index <span class="token operator">=</span> start<span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>_tables<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>_status <span class="token operator">==</span> EXIST<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				index<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// 线性探测</span>
				<span class="token comment">//index = start + i * i ++ ;// 二次探查</span>
				index <span class="token operator">%=</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			_tables<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>_kv <span class="token operator">=</span> kv<span class="token punctuation">;</span>
			_tables<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>_status <span class="token operator">=</span> EXIST<span class="token punctuation">;</span>
			<span class="token operator">++</span>_n<span class="token punctuation">;</span>

			<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="23__304"></a>2.3 开散列</h3> 
<p>开散列</p> 
<ol><li>开散列概念<br> 开散列法又叫链地址法(拉链法)，首先对关键码集合用散列函数计算散列地址，具有相同地址的关键码归于同一子集合，每一个子集合称为一个桶，各个桶中的元素通过一个单链表链接起来，各链表的头结点存储在哈希表中。<br> <img src="https://images2.imgbox.com/c1/88/qOgwXTf2_o.png" alt="在这里插入图片描述"></li></ol> 
<p>开散列中每个桶中放的都是发生哈希冲突的元素。</p> 
<h3><a id="24__312"></a>2.4 开散列代码实现</h3> 
<ul><li>开散列数据结构<br> 可以是一个数组下面挂一个单链表</li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">// 单链表结点数据</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">V</span><span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">HashData</span>
<span class="token punctuation">{<!-- --></span>
	pair<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span> _kv<span class="token punctuation">;</span>
	HashData<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span><span class="token operator">*</span> _next<span class="token punctuation">;</span>

	<span class="token function">HashData</span><span class="token punctuation">(</span><span class="token keyword">const</span> pair<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span><span class="token operator">&amp;</span> kv<span class="token punctuation">)</span>
		<span class="token operator">:</span><span class="token function">_kv</span><span class="token punctuation">(</span>kv<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_next</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">V</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">HashFunc</span> <span class="token operator">=</span> Hash<span class="token operator">&lt;</span>K<span class="token operator">&gt;</span> <span class="token operator">&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">HashTable</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">typedef</span> HashData<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span> Node<span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	vector<span class="token operator">&lt;</span>Node<span class="token operator">*</span><span class="token operator">&gt;</span> _tables<span class="token punctuation">;</span>
	size_t _n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 有效数字个数</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>扩容</li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">// 载荷因子为1时扩容</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>_tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> _n <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">/</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 因为哈希表每个元素下挂一个单链表，它们的空间是动态申请的，只有指针管理</span>
	<span class="token comment">// 所以使用上面的方法（创建一个新大小的类，调用插入函数，最后交换）没有直接交换结点快，不用申请空间</span>
	size_t newSize <span class="token operator">=</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">10</span> <span class="token operator">:</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
	vector<span class="token operator">&lt;</span>Node<span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token function">newTables</span><span class="token punctuation">(</span>newSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		Node<span class="token operator">*</span> cur <span class="token operator">=</span> _tables<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			Node<span class="token operator">*</span> prev <span class="token operator">=</span> cur<span class="token punctuation">;</span>
			<span class="token comment">// 链接到新的表上</span>
			size_t newIndex <span class="token operator">=</span> <span class="token function">hf</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>_kv<span class="token punctuation">.</span>first<span class="token punctuation">)</span> <span class="token operator">%</span> newSize<span class="token punctuation">;</span>
			cur<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> newTables<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
			newTables<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span> <span class="token operator">=</span> cur<span class="token punctuation">;</span>
			cur <span class="token operator">=</span> prev<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		_tables<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	_tables<span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>newTables<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>完整代码</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">namespace</span> LinkHash
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">V</span><span class="token operator">&gt;</span>
	<span class="token keyword">struct</span> <span class="token class-name">HashData</span>
	<span class="token punctuation">{<!-- --></span>
		pair<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span> _kv<span class="token punctuation">;</span>
		HashData<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span><span class="token operator">*</span> _next<span class="token punctuation">;</span>

		<span class="token function">HashData</span><span class="token punctuation">(</span><span class="token keyword">const</span> pair<span class="token operator">&lt;</span>K<span class="token punctuation">,</span>V<span class="token operator">&gt;</span><span class="token operator">&amp;</span> kv<span class="token punctuation">)</span>
			<span class="token operator">:</span><span class="token function">_kv</span><span class="token punctuation">(</span>kv<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_next</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token comment">// 用于将整数转换成0到大于零的正整数，防止出现对负数取模</span>
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token operator">&gt;</span>
	<span class="token keyword">struct</span> <span class="token class-name">Hash</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 将整型转成正数</span>
		size_t <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> K<span class="token operator">&amp;</span> key<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> key<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token comment">// 常用到字符串类型的key值，这是一个特化版本</span>
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span>
	<span class="token keyword">struct</span> <span class="token class-name">Hash</span> <span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 字符串哈希</span>
		size_t <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			size_t value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token comment">// 也可以乘以31、131、1313、13131、131313.. </span>
				<span class="token comment">// 乘上一个数，减少冲突的概率</span>
				value <span class="token operator">*=</span> <span class="token number">31</span><span class="token punctuation">;</span>
				value <span class="token operator">+=</span> ch<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> value<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">V</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">HashFunc</span> <span class="token operator">=</span> Hash<span class="token operator">&lt;</span>K<span class="token operator">&gt;</span> <span class="token operator">&gt;</span>
	<span class="token keyword">class</span> <span class="token class-name">HashTable</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">typedef</span> HashData<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span> Node<span class="token punctuation">;</span>
	<span class="token keyword">private</span><span class="token operator">:</span>
		vector<span class="token operator">&lt;</span>Node<span class="token operator">*</span><span class="token operator">&gt;</span> _tables<span class="token punctuation">;</span>
		size_t _n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 有效数字个数</span>
	<span class="token keyword">public</span><span class="token operator">:</span>
		<span class="token keyword">bool</span> <span class="token function">Erase</span><span class="token punctuation">(</span><span class="token keyword">const</span> K<span class="token operator">&amp;</span> key<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			Node<span class="token operator">*</span> res <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

			HashFunc hf<span class="token punctuation">;</span>
			<span class="token comment">//用于单链表的删除，存储前一个结点的地址</span>
			<span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token function">hf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">%</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			Node<span class="token operator">*</span> cur <span class="token operator">=</span> _tables<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">*</span>prev <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>_kv<span class="token punctuation">.</span>first <span class="token operator">==</span> key<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>prev <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token comment">// 头删</span>
					<span class="token punctuation">{<!-- --></span>
						_tables<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">else</span> <span class="token comment">// 中间删</span>
					<span class="token punctuation">{<!-- --></span>
						prev<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
						
					<span class="token punctuation">}</span>
					<span class="token keyword">delete</span> cur<span class="token punctuation">;</span>

					<span class="token operator">--</span>_n<span class="token punctuation">;</span>
					<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span>
				<span class="token punctuation">{<!-- --></span>
					prev <span class="token operator">=</span> cur<span class="token punctuation">;</span>
					cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		Node<span class="token operator">*</span> <span class="token function">Find</span><span class="token punctuation">(</span><span class="token keyword">const</span> K<span class="token operator">&amp;</span> key<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
				<span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
			HashFunc hf<span class="token punctuation">;</span>
			<span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token function">hf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">%</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			Node<span class="token operator">*</span> cur <span class="token operator">=</span> _tables<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>_kv<span class="token punctuation">.</span>first <span class="token operator">==</span> key<span class="token punctuation">)</span> <span class="token keyword">return</span> cur<span class="token punctuation">;</span>
				<span class="token keyword">else</span> cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">bool</span> <span class="token function">Insert</span><span class="token punctuation">(</span><span class="token keyword">const</span> pair<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span><span class="token operator">&amp;</span> kv<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			Node<span class="token operator">*</span> res <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>kv<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">!=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
			HashFunc hf<span class="token punctuation">;</span>

			<span class="token comment">// 载荷因子为1时扩容</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> _n <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">/</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token comment">// 因为哈希表每个元素下挂一个单链表，它们的空间是动态申请的，只有指针管理</span>
				<span class="token comment">// 所以使用上面的方法（创建一个新大小的类，调用插入函数，最后交换）没有直接交换结点快，不用申请空间</span>
				size_t newSize <span class="token operator">=</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">10</span> <span class="token operator">:</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
				vector<span class="token operator">&lt;</span>Node<span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token function">newTables</span><span class="token punctuation">(</span>newSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					Node<span class="token operator">*</span> cur <span class="token operator">=</span> _tables<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
					<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
					<span class="token punctuation">{<!-- --></span>
						Node<span class="token operator">*</span> prev <span class="token operator">=</span> cur<span class="token punctuation">;</span> 
						<span class="token comment">// 链接到新的表上</span>
						size_t newIndex <span class="token operator">=</span> <span class="token function">hf</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>_kv<span class="token punctuation">.</span>first<span class="token punctuation">)</span> <span class="token operator">%</span> newSize<span class="token punctuation">;</span>
						cur<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> newTables<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
						newTables<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span> <span class="token operator">=</span> cur<span class="token punctuation">;</span>
						cur <span class="token operator">=</span> prev<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					_tables<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				_tables<span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>newTables<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			
			<span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token function">hf</span><span class="token punctuation">(</span>kv<span class="token punctuation">.</span>first<span class="token punctuation">)</span> <span class="token operator">%</span> _tables<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// 头插法</span>
			Node<span class="token operator">*</span> newNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Node</span><span class="token punctuation">(</span>kv<span class="token punctuation">)</span><span class="token punctuation">;</span>
			newNode<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> _tables<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
			_tables<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
			<span class="token operator">++</span>_n<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">TestHashTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">54</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
		HashTable<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span> ht<span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> e <span class="token operator">:</span> a<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ht<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token function">make_pair</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		ht<span class="token punctuation">.</span><span class="token function">Erase</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		ht<span class="token punctuation">.</span><span class="token function">Erase</span><span class="token punctuation">(</span><span class="token number">67</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		ht<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token function">make_pair</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a22fb7e555d40acd4df5d178ab8fe895/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Servlet获取请求参数</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d8df9fa94a4359fb0020abb5c6e4014e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">红外图像是什么？红外线与计算机视觉相关的研究方向？（Visible and infrared image fusion）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>