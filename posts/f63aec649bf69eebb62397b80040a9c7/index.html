<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PLUMED MetaDynamics Simulation 输入文件编写教程 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PLUMED MetaDynamics Simulation 输入文件编写教程" />
<meta property="og:description" content="本文翻译自 PLUMED 官方教程，旨在指导读者完成MetaDynamics Simulation 输入文件的编写，该文件可用于诸如 GROMACS 的gmx_mpi mdrun -plumed，以完成最终模拟。
文章目录 IntroductionDescription of ComponentsExamples Introduction 这是偏置模块的一部分，用于对一个或多个集合变量执行 MetaDynamics。在元动力学模拟中，由间歇性添加的高斯函数组成的历史相关偏置被添加到势能中：
V ( s ⃗ , t ) = ∑ k τ &lt; t W ( k τ ) exp ⁡ ( − ∑ i = 1 d ( s i − s i ( 0 ) ( k τ ) ) 2 2 σ i 2 ) . V(\vec{s},t) = \sum_{ k \tau &lt; t} W(k \tau) \exp\left( -\sum_{i=1}^{d} \frac{(s_i-s_i^{(0)}(k \tau))^2}{2\sigma_i^2} \right)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f63aec649bf69eebb62397b80040a9c7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-14T12:16:29+08:00" />
<meta property="article:modified_time" content="2023-12-14T12:16:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PLUMED MetaDynamics Simulation 输入文件编写教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>本文翻译自 <a href="https://www.plumed.org/doc-v2.4/user-doc/html/_m_e_t_a_d.html" rel="nofollow">PLUMED 官方教程</a>，旨在指导读者完成MetaDynamics Simulation 输入文件的编写，该文件可用于诸如 GROMACS 的<code>gmx_mpi mdrun -plumed</code>，以完成最终模拟。</p> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#Introduction_8" rel="nofollow">Introduction</a></li><li><a href="#Description_of_Components_39" rel="nofollow">Description of Components</a></li><li><a href="#Examples_119" rel="nofollow">Examples</a></li></ul> 
</div> 
<p></p> 
<h2><a id="Introduction_8"></a>Introduction</h2> 
<p>这是偏置模块的一部分，用于对一个或多个集合变量执行 MetaDynamics。在元动力学模拟中，由间歇性添加的高斯函数组成的历史相关偏置被添加到势能中：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          V 
         
        
          ( 
         
         
         
           s 
          
         
           ⃗ 
          
         
        
          , 
         
        
          t 
         
        
          ) 
         
        
          = 
         
         
         
           ∑ 
          
          
          
            k 
           
          
            τ 
           
          
            &lt; 
           
          
            t 
           
          
         
        
          W 
         
        
          ( 
         
        
          k 
         
        
          τ 
         
        
          ) 
         
        
          exp 
         
        
          ⁡ 
         
         
         
           ( 
          
         
           − 
          
          
          
            ∑ 
           
           
           
             i 
            
           
             = 
            
           
             1 
            
           
          
            d 
           
          
          
           
           
             ( 
            
            
            
              s 
             
            
              i 
             
            
           
             − 
            
            
            
              s 
             
            
              i 
             
             
             
               ( 
              
             
               0 
              
             
               ) 
              
             
            
           
             ( 
            
           
             k 
            
           
             τ 
            
           
             ) 
            
            
            
              ) 
             
            
              2 
             
            
           
           
           
             2 
            
            
            
              σ 
             
            
              i 
             
            
              2 
             
            
           
          
         
           ) 
          
         
        
          . 
         
        
       
         V(\vec{s},t) = \sum_{ k \tau &lt; t} W(k \tau) \exp\left( -\sum_{i=1}^{d} \frac{(s_i-s_i^{(0)}(k \tau))^2}{2\sigma_i^2} \right). 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">V</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">s</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1799em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
             <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
              <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
             </svg></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.1656em; vertical-align: -1.3295em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -1.8479em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span><span class="mord mathnormal mtight" style="margin-right: 0.1132em;">τ</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight">t</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.3295em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">W</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="mord mathnormal" style="margin-right: 0.1132em;">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size4">(</span></span><span class="mord">−</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.8361em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.7218em;"><span class="" style="top: -2.3588em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7959em;"><span class="" style="top: -2.4231em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span class="" style="top: -3.0448em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2769em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.2748em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.7218em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2769em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="mord mathnormal" style="margin-right: 0.1132em;">τ</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.9629em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size4">)</span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">.</span></span></span></span></span></span>这种势能迫使系统远离势能表面的动力学陷阱，进入能量景观中未探索的部分。关于构成该势的高斯函数的信息被输出到一个名为<code>HILLS</code>的文件，该文件用于重新开始计算和将自由能重建为 CV 的函数。自由能可以从元动力学计算中重建，因为最终偏差由下式给出：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          V 
         
        
          ( 
         
         
         
           s 
          
         
           ⃗ 
          
         
        
          ) 
         
        
          = 
         
        
          − 
         
        
          F 
         
        
          ( 
         
         
         
           ( 
          
         
           ⃗ 
          
         
        
          s 
         
        
          ) 
         
        
          ) 
         
        
          . 
         
        
       
         V(\vec{s}) = -F(\vec(s)). 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">V</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">s</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1799em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
             <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
              <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
             </svg></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.283em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.033em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mopen">(</span></span><span class="" style="top: -3.319em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.2355em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
             <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
              <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
             </svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.25em;"><span class=""></span></span></span></span></span><span class="mord mathnormal">s</span><span class="mclose">))</span><span class="mord">.</span></span></span></span></span></span>在后处理过程中，可以使用<code>sum_hills</code>程序以这种方式计算自由能。</p> 
<p>在最简单的元动力学计算实现中，元动力学计算的费用随着模拟的长度而增加，因为在每一步都必须评估越来越多的高斯值。为了避免这个问题，您可以将偏差存储在网格上。这种方法类似于<sup class="footnote-ref"><a href="#fn1" rel="nofollow" id="fnref1">1</a></sup>中提出的方法，具有网格间距与高斯宽度无关的优点。请注意，对于这种方法，您应该为每个集合变量（<code>GRID_BIN</code>）或所需的网格间距（<code>GRID_SPACING</code>）提供 bins 的数量。如果您同时提供这两个选项，则将对每个维度使用最保守的选择（二者中最大的 bins 数量值）。如果您没有提供任何关于 bins 大小的信息（既不是 <code>GRID_BIN</code> 也不是<code>GRID_SPACING</code>），并且如果高斯宽度是固定的，PLUMED 将使用高斯宽度的 1/5 作为网格间距。对于大多数程序来说，此默认选择应该是合理的。</p> 
<p>您可以从<code>HILLS</code>文件和<code>GRID</code>重新启动元动力学，在第二种情况下，可以首先使用<code>GRID_WFILE</code>（和<code>GRID_WSTRIDE</code>）保存 <code>GRID</code>，然后在稍后阶段使用 <code>GRID_RFILE</code> 读取它。</p> 
<p>在 PLUMED 中可用的另一个选项是回火元动力学（well-tempered metadynamics）<sup class="footnote-ref"><a href="#fn2" rel="nofollow" id="fnref2">2</a></sup>。在这种元动力学的变化中，高斯山丘的高度在每一步都会重新缩放，因此偏置现在由下式给出：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          V 
         
        
          ( 
         
        
          s 
         
        
          , 
         
        
          t 
         
        
          ) 
         
        
          = 
         
         
         
           ∑ 
          
          
           
           
             t 
            
           
             ′ 
            
           
          
            = 
           
          
            0 
           
          
            , 
           
           
           
             τ 
            
           
             G 
            
           
          
            , 
           
          
            2 
           
           
           
             τ 
            
           
             G 
            
           
          
            , 
           
          
            … 
           
          
          
           
           
             t 
            
           
             ′ 
            
           
          
            &lt; 
           
          
            t 
           
          
         
        
          W 
         
         
         
           e 
          
          
          
            − 
           
          
            V 
           
          
            ( 
           
          
            s 
           
          
            ( 
           
          
            q 
           
          
            ( 
           
           
           
             t 
            
           
             ′ 
            
           
          
            ) 
           
          
            , 
           
           
           
             t 
            
           
             ′ 
            
           
          
            ) 
           
          
            / 
           
          
            Δ 
           
          
            T 
           
          
         
        
          exp 
         
        
          ⁡ 
         
         
         
           ( 
          
         
           − 
          
          
          
            ∑ 
           
           
           
             i 
            
           
             = 
            
           
             1 
            
           
          
            d 
           
          
          
           
           
             ( 
            
            
            
              s 
             
            
              i 
             
            
           
             ( 
            
           
             q 
            
           
             ) 
            
           
             − 
            
            
            
              s 
             
            
              i 
             
            
           
             ( 
            
           
             q 
            
           
             ( 
            
            
            
              t 
             
            
              ′ 
             
            
           
             ) 
            
            
            
              ) 
             
            
              2 
             
            
           
           
           
             2 
            
            
            
              σ 
             
            
              i 
             
            
              2 
             
            
           
          
         
           ) 
          
         
        
       
         V({s},t)= \sum_{t'=0,\tau_G,2\tau_G,\dots}^{t'&lt;t} W e^{-V({s}({q}(t'),t')/\Delta T} \exp\left( -\sum_{i=1}^{d} \frac{(s_i({q})-s_i({q}(t'))^2}{2\sigma_i^2} \right) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.3596em; vertical-align: -1.4301em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.9295em;"><span class="" style="top: -1.856em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6828em;"><span class="" style="top: -2.786em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3567em; margin-left: -0.1132em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1433em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3567em; margin-left: -0.1132em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1433em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="minner mtight">…</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8278em;"><span class="" style="top: -2.931em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.4301em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">W</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9925em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right: 0.2222em;">V</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">q</span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8278em;"><span class="" style="top: -2.931em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8278em;"><span class="" style="top: -2.931em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mtight">/Δ</span><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">T</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size4">(</span></span><span class="mord">−</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.8361em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.4911em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7959em;"><span class="" style="top: -2.4231em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span class="" style="top: -3.0448em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2769em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">q</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">q</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.9629em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></span>这种方法可以确保偏差更平滑地收敛。应该注意的是，在回火元动力学的情况下，在输出中会使用偏置因子重新缩放高斯高度。还要注意的是，对于回火元动力学，<code>HILLS</code>文件不包含偏差，而是包含自由能估计的负值。这种选择的优点是可以使用不同的 <em>ΔT</em> 值重新启动模拟，所施加的偏置也将相应地缩放。</p> 
<p>请注意，您也可以在这里使用 flexible gaussian approach，在该方法中，您可以将高斯势调整为变量覆盖的笛卡尔空间的范围，或调整为给定时间内覆盖的 CV 中的空间。在这种情况下，沉积的高斯势的宽度仅由一个值表示，该值是笛卡尔空间（<code>ADAPTIVE=GEOM</code>）或时间（<code>ADAPTIVE=DIFF</code>）。请注意，在这种情况下，应使用沉积高斯的特定积分技术，具体请查看文档中的程序<code>sum_hills</code>。</p> 
<p>使用关键字<code>INTERVAL</code>，可以更改元动力学算法以设置偏置力为等于零的外部边界。例如，如果在 CV <em>s</em> 上执行元动力学，并且仅对 <em>s</em> &gt; <em>s</em><sub>w</sub> 的自由能感兴趣，则根据上述方程仍然更新<em>s</em> &gt; <em>s</em><sub>w</sub> 范围的历史相关势，但是对于 <em>s</em> &lt; <em>s</em><sub>w</sub>，元动力学偏置力被设置为零。请注意，如果 <em>s</em> &lt; <em>s</em><sub>w</sub>，也会添加高斯势，因为这些高斯势的尾部会影响相关区域 <em>s</em> &gt; <em>s</em><sub>w</sub> 中的 VG。这样，<em>s</em> &gt; <em>s</em><sub>w</sub> 区域系统上的力来自元动力学和常规力场，<em>s</em> &lt; <em>s</em><sub>w</sub> 区域仅来自后者。这种方法允许获得在稳定估计器周围波动的历史相关偏置势 VG，该势等于离边界足够远的自由能的负值。请注意：</p> 
<ul><li>它只适用于一维偏置；</li><li>它既可以使用<code>GRID</code>，也可以不使用<code>GRID</code>；</li><li>在自由能导数不大的区域中的区间极限 <em>s</em><sub>w</sub>；</li><li>如果在限制 <em>s</em><sub>w</sub> 之外的区域中，系统具有最小自由能，则<code>INTERVAL</code>关键字应与 <em>s</em><sub>w</sub> 处的<code>UPPER_WALLS</code>或<code>LOWER_WALLS</code>一起使用。</li></ul> 
<p>最后要注意的是，自2.0.2版本以来，当系统在所选间隔之外时，力设置为零，偏置值设置为相应边界处的值。这允许正确计算副本交换（replica exchange）方法的接受度。</p> 
<p>也可以使用多个walkers（可以理解成同时使用多个搜索点），请参阅后面的示例。</p> 
<p>c(t) 重加权因子也可以使用 <sup class="footnote-ref"><a href="#fn3" rel="nofollow" id="fnref3">3</a></sup> 中给出的方程实时计算。用于计算 c(t) 的表达式直接来自于上文的方程3中的方程12，并且给出了比该文中的等效方程13和方程14更平滑的结果。c(t) 由 rct 分量给出，而由c(t) 通过使用关键字<code>REWEIGHTING_NGRID</code>来启用 c(t) 的计算，其中指定了用于计算的网格。此网格的大小应等于或大于<code>GRID_BIN./</code>中给定的网格。默认情况下，c(t) 每50个高斯山丘更新一次，但这可以通过使用<code>REWEIGHTING_NHILLS</code>关键字来更改，此选项只能与回火元动力学模拟一起使用，并且需要使用网格。</p> 
<p><strong>请注意</strong>，与 PLUMED 1.3 不同的是，现在可以直接应用并行元动力学，这确实可以通过在同一输入文件中多次使用 METAD 操作来取得。</p> 
<h2><a id="Description_of_Components_39"></a>Description of Components</h2> 
<p>**默认情况下元动力学将计算以下量，**你可以通过在元动力学标签后面跟着一个点和下面列表中量的名称来引用相应的量（例如 <code>meta.bais</code> 表示标签为<code>meta</code>的元动力学的瞬时偏置势）。</p> 
<p><code>bais</code>：偏置势的瞬时值；<br> <code>work</code>：累计功；</p> 
<p><strong>此外，可以通过使用下面列出的关键字来计算以下量：</strong></p> 
<p><code>rbias</code>：使用<code>REWEIGHTING_NGRID</code>关键词。使用 c(t) 重加权因子 [ rbias＝bias-c(t) ] 归一化的偏置势的瞬时值。该分量可用于获得重新加权的直方图；<br> <code>rct</code>：使用<code>REWEIGHTING_NGRID</code>关键词。重加权因子 c(t) ；<br> <code>acc</code>：使用<code>ACCELERATION</code>关键词。元动力学加速度因子；<br> <code>maxbias</code>：使用<code>CALC_MAX_BIAS</code>关键词。元动力学 V(s，t) 的最大值；<br> <code>transbias</code>：使用<code>CALC_TRANSITION_BIAS</code>关键词。元动力学转变偏置 V*(t)；</p> 
<p><strong>以下为必填关键字（括号内为默认值）：</strong></p> 
<p><code>SIGMA</code>：高斯丘陵的宽度；<br> <code>PACE</code>：斜坡加法的频率；<br> <code>FILE</code>（=HILLS）：存储已添加山丘列表的文件；</p> 
<p><strong>以下为可选关键字（括号内为默认值）：</strong></p> 
<p><code>NUMERICAL_DERIVATIVES</code> ( default=off )：以数字方式计算这些量的导数；<br> <code>GRID_SPARSE</code> ( default=off )：使用稀疏栅格来存储山丘；<br> <code>GRID_NOSPLINE</code> ( default=off )：不将样条曲线插值与网格一起使用；<br> <code>STORE_GRIDS</code> ( default=off )：存储计算生成的所有网格文件。如果此关键字不存在，它们将被删除；<br> <code>WALKERS_MPI</code> ( default=off )：使用MPI版本的多个步行器。与<code>WALKERS_DIR</code>以外的<code>WALKERS_*</code>选项不兼容；<br> <code>ACCELERATION</code> ( default=off )：如果要计算元动力学加速度因子，请设置为TRUE；<br> <code>CALC_MAX_BIAS</code> ( default=off )：如果要计算元动力学 V(s，t) 的最大值，请设置为TRUE；<br> <code>CALC_TRANSITION_BIAS</code> ( default=off )：如果要计算元动力学转换偏置 V*(t)，请设置为TRUE；</p> 
<p><code>ARG</code>：此关键字的输入是其他标签的标量输出，您需要在<code>ARG</code>关键字后写明你希望使用的标量的标签。如果标签单独出现，则假定原标签计算单个标量值。如果出现<code>*</code>或<code>*.*</code>，则输入标签中所有计算的标量均作为输入；这种情况可能发生在某些标签具有多个输出，但一般输出的每个值都有一个额外的特定标签；例如，一个名为 dist 的<code>DISTANCE</code>标签可能有三个输出值x、y和z，如果你希望只使用x部分，您应该使用<code>dist.x</code>，如果您想同时使用这三个输出值，请使用<code>dist.*</code>。有关该标签的更多信息，请参阅手册的PLUMED入门部分。该标签的输入也可以使用<code>POSIX</code>的正则表达式，详见正则表达式一节。要使用此功能，您必须使用适当的标志编译PLUMED。您可以为该关键字添加多个输入，即 ARG1、ARG2、ARG3；</p> 
<p><code>HEIGHT</code>：高斯山丘的高度。必须选项，除非给出<code>TAU</code>和<code>BIASACTOR</code>或<code>DAMPACTOR</code>；</p> 
<p><code>FMT</code>：指定<code>HILLS</code>文件的格式（有助于减少regtest中的位数）；</p> 
<p><code>TARGET</code>：指向预定义的分布；</p> 
<p><code>RECT</code>：所有副本的偏置因子的列表；</p> 
<p><code>DAMPFACTOR</code>：以<code>exp(-max(V)/(kbT*DAMPFACTOR)</code>进行沉积；</p> 
<p><code>BIASFACTOR</code>：偏置因子，使用回火元动力学时启用的关键字。请注意，您还必须指定<code>TEMP</code>；<br> <code>TEMP</code>：系统温度，只有进行回火元动力学时才需要；<br> <code>TAU</code>：在回火元动力学中，设置高斯高度为<code>(kb*DeltaT*pace*timestep)/TAU</code></p> 
<p><code>TTBIASFACTOR</code>：偏置因子，使用转温元动力学（transition tempered metadynamics）时启用的关键字。请注意，您还必须指定<code>TEMP</code>；<br> <code>TTBIASTHRESHOLD</code>：偏置阈值，使用转温元动力学时启用的关键字。请注意，您还必须指定<code>TTBIASFACTOR</code>；<br> <code>TTALPHA</code>：山丘大小衰减指数，使用转温元动力学时启用的关键字。请注意，您还必须指定<code>TTBIASFACTOR</code>；<br> <code>TRANSITIONWELL</code>：在转温元动力学中使用，此关键字作为<code>TRANSITIONWELLx</code>重复出现，其中x=0,1,2，…，n；每个都指定了一个井的坐标，。必须至少提供一个。您可以使用此关键字的多个实例，即TRANSITIONWELL1、TRANSITIONWILL2、TRANSITION WELL3…</p> 
<p><code>GRID_MIN</code>：网格的最小边界；<br> <code>GRID_MAX</code>：网格的最大边界；<br> <code>GRID_BIN</code>：网格的窗口数量；<br> <code>GRID_SPACING</code>：网格的窗口大小，在效果上等效于<code>GRID_BIN</code>；<br> <code>REWEIGHTING_NGRID</code>：计算 c(t) 重加权因子，并使用该因子来获得归一化偏置 [ rbias＝bias-c(t) ]。在此，您应该指定每个维度中所需的网格的数量。网格点的数量应等于或大于<code>GRID_BIN</code>中给定的网格数量。此方法与不使用网格的元动力学不兼容。<br> <code>INTERVAL</code>：一维的下限和上限，超出该阈限系统将不会使用偏置；</p> 
<p><code>REWEIGHTING_NHILLS</code>：计算 c(t) 重新加权因子的高斯山丘间隔。默认情况下，每50个山丘执行一次此操作。<br> <code>GRID_WSTRIDE</code>：每隔N步将网格写入文件<br> <code>GRID_WFILE</code>：写入网格的文件<br> <code>GRID_RFILE</code>：一个网格文件，用于在模拟的初始步骤读取偏差</p> 
<p><code>ACCELERATION_RFILE</code>：在模拟的初始步骤读取加速度的数据文件；</p> 
<p><code>ADAPTIVE</code>：使用基于几何（=GEOM）或扩散（=DIFF）的山丘宽度方案。西格玛（标准差）是一个具有距离单位或时间步长维度的数字；<br> <code>SIGMA_MAX</code>：使用自适应山丘时SIGMA的上限（以CV为单位）。负数表示无边界<br> <code>SIGMA_MIN</code>：使用自适应山丘时SIGMA的下限（以CV为单位）。负数表示无边界</p> 
<p><code>WALKERS_ID</code>：walker ID；<br> <code>WALKERS_N</code>：walker 数量；<br> <code>WALKERS_DIR</code>：所有不同 walker 产生的 HILLS 文件的共享文件夹；<br> <code>WALKERS_RSTRIDE</code>：读取 HILLS 文件的步幅；</p> 
<p><code>RESTART</code>：模拟运行标签前的关键词，可设置是否为重新运行（可以理解为续跑）<br> <code>UPDATE_FROM</code>：仅更新此时间之前的模拟结果；<br> <code>UPDATE_UNTIL</code>：仅更新此时间之后的模拟结果；</p> 
<h2><a id="Examples_119"></a>Examples</h2> 
<p><strong>Examples 1.</strong></p> 
<p>以下输入用于使用原子3和5之间的距离以及原子2和4之间的距离作为集合变量（CV）的标准元动力学计算。CV 的值和元动力学偏置势每 100 步写入<code>COLVAR</code>文件：</p> 
<pre><code>DISTANCE ATOMS=3,5 LABEL=d1
DISTANCE ATOMS=2,4 LABEL=d2
METAD ARG=d1,d2 SIGMA=0.2,0.2 HEIGHT=0.3 PACE=500 LABEL=restraint
PRINT ARG=d1,d2,restraint.bias STRIDE=100  FILE=COLVAR
</code></pre> 
<p><strong>Examples 2.</strong></p> 
<p>如果你使用扩散方案的自适应高斯，高斯势应该覆盖集体变量中20个时间步长的空间。请注意，在这种情况下，对山丘求和时需要进行直方图校正：</p> 
<pre><code>DISTANCE ATOMS=3,5 LABEL=d1
DISTANCE ATOMS=2,4 LABEL=d2
METAD ARG=d1,d2 SIGMA=20 HEIGHT=0.3 PACE=500 LABEL=restraint ADAPTIVE=DIFF
PRINT ARG=d1,d2,restraint.bias STRIDE=100  FILE=COLVAR
</code></pre> 
<p>如果你使用几何方案的自适应高斯，高势斯应该覆盖笛卡尔空间中0.05nm的空间。请注意，在这种情况下，对山丘求和时需要进行直方图校正：</p> 
<pre><code>DISTANCE ATOMS=3,5 LABEL=d1
DISTANCE ATOMS=2,4 LABEL=d2
METAD ARG=d1,d2 SIGMA=0.05 HEIGHT=0.3 PACE=500 LABEL=restraint ADAPTIVE=GEOM
PRINT ARG=d1,d2,restraint.bias STRIDE=100  FILE=COLVAR
</code></pre> 
<p>使用自适应高斯时，可能需要限制山丘宽度的变化方式。您可以使用<code>SIGMA_MIN</code>和<code>SIGMA_MAX</code>关键字。应根据 CV 指定 sigmas，并使用 CV 的单位。请注意，如果使用负数，则表示不设置限制。还要注意的是，在这种情况下，对山丘求和时需要进行直方图校正：</p> 
<pre><code>DISTANCE ATOMS=3,5 LABEL=d1
DISTANCE ATOMS=2,4 LABEL=d2
METAD ...
  ARG=d1,d2 SIGMA=0.05 HEIGHT=0.3 PACE=500 LABEL=restraint ADAPTIVE=GEOM
  SIGMA_MIN=0.2,0.1 SIGMA_MAX=0.5,1.0
... METAD
PRINT ARG=d1,d2,restraint.bias STRIDE=100  FILE=COLVAR
</code></pre> 
<p><strong>Examples 3.</strong></p> 
<p>可以使用多个 walkers，如[75]中所述。通过设置使用的 walkers 数量、解释输入文件的当前 walkers 的id、包含文件的山丘所在的目录以及读取其他助行器时的频率，来启用这些助行器。下面是一个例子：</p> 
<pre><code>DISTANCE ATOMS=3,5 LABEL=d1
METAD ...
   ARG=d1 SIGMA=0.05 HEIGHT=0.3 PACE=500 LABEL=restraint
   WALKERS_N=10
   WALKERS_ID=3
   WALKERS_DIR=../
   WALKERS_RSTRIDE=100
... METAD
</code></pre> 
<p>其中<code>WALKERS_N</code>是 walkers 的总数，<code>WALKERS_ID</code>是当前步行者的ID（从0开始），<code>WALKERS_DIR</code>是所有 walkers 所在的目录。<code>WALKERS_RSTRIDE</code>是一次更新和另一次更新之间的步数。从2.2.5版本开始，hills 文件在<code>WALKERS_RSTRIDE</code>的每一步都会自动刷新。</p> 
<p><strong>Examples 4.</strong></p> 
<p>c(t) 重加权因子可以使用上述[85]中提出的方程动态计算。这是通过使用关键字<code>REWEIGHTING_NGRID</code>来启用的，其中设置了用于计算的网格。<code>REWEIGHTING_NGRID</code>中给出的格点数量应等于或大于<code>GRID_BIN</code>中给出的网格点数量。</p> 
<pre><code>phi: TORSION ATOMS=5,7,9,15
psi: TORSION ATOMS=7,9,15,17
METAD ...
 LABEL=metad
 ARG=phi,psi SIGMA=0.20,0.20 HEIGHT=1.20 BIASFACTOR=5 TEMP=300.0 PACE=500
 GRID_MIN=-pi,-pi GRID_MAX=pi,pi GRID_BIN=150,150
 REWEIGHTING_NGRID=150,150
 REWEIGHTING_NHILLS=20
... METAD
</code></pre> 
<p>在这里，我们要求使用<code>REWEIGHTING_NHILLS</code>关键字在每20个山丘进行一次计算。如果未给定此关键字，则默认情况下每50个山丘执行一次计算。c(t) 重加权因子将在 rct 分量中给出，而使用 c(t) 重新加权因子归一化的偏置势的瞬时值在 rbias 分量 [rbias=bias-c(t)] 中给出，该分量可用于 <code>HISTOGRAM</code> 分析获得重新加权的直方图或自由能面。</p> 
<p>盆地之间转换的动力学也可以像[84]中那样进行动态分析。标签<code>ACCELERATION</code>开启加速度因子的累积，然后可用于确定速率。该方法可与<code>COMMITTOR</code>分析一起使用，以在系统到达目标盆地时停止模拟。它必须与回火元动力学一起使用。</p> 
<p>您还可以使用关键字<code>TARGET</code>提供目标分发。<code>TARGET</code>应为包含自由能（即所需目标分布的 -kbT*log）的网格。然后，高斯将按该因子缩放<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           e 
          
          
          
            β 
           
          
            ( 
           
           
           
             F 
            
           
             ~ 
            
           
          
            ( 
           
          
            s 
           
          
            ) 
           
          
            − 
           
           
            
            
              F 
             
            
              ~ 
             
            
            
            
              m 
             
            
              a 
             
            
              x 
             
            
           
          
            ) 
           
          
         
        
       
         e^{\beta(\tilde{F}(s)-\tilde{F}_{max})} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0571em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.0571em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0528em;">β</span><span class="mopen mtight">(</span><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9202em;"><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">F</span></span><span class="" style="top: -3.3023em;"><span class="pstrut" style="height: 2.7em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord mtight">~</span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9202em;"><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">F</span></span><span class="" style="top: -3.3023em;"><span class="pstrut" style="height: 2.7em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord mtight">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1645em;"><span class="" style="top: -2.357em; margin-left: -0.1389em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span>这里，F 是在网格上定义的自由能，Fmax 是它的最大值。请注意，我们在这里使用了参考文献[46]中的最大值。这个选择可以避免添加过大的高斯势。然而，它可能会使高斯势过小。在这种情况下，您应该始终仔细选择<code>HEIGHT</code>参数。网格文件应与其他 PLUMED 网格文件类似，因为它应包含目标自由能及其导数。</p> 
<p>请注意，如果希望模拟收敛到目标自由能，则应使用<code>DAMPACTOR</code>命令提供全局回火。或者，如果使用<code>BIASACTOR</code>，则模拟将收敛到另一个自由能，该自由能是目标自由能和由原始力场确定的固有自由能的线性组合。</p> 
<pre><code>DISTANCE ATOMS=3,5 LABEL=d1
METAD ...
 LABEL=t1
 ARG=d1 SIGMA=0.05 TAU=200 DAMPFACTOR=100 PACE=250
 GRID_MIN=0 GRID_MAX=2 GRID_BIN=200
 TARGET=dist.dat
... METAD

PRINT ARG=d1,t1.bias STRIDE=100 FILE=COLVAR
</code></pre> 
<p>此计算的<code>dist.dat</code>文件中的标头将为：</p> 
<pre><code>#! FIELDS d1 t1.target der_d1
#! SET min_d1 0
#! SET max_d1 2
#! SET nbins_d1  200
#! SET periodic_d1 false
</code></pre> 
<p>请注意，<code>BIASACTOR</code>也可以选择为等于1。在这种情况下，将执行无偏采样。此时应使用<code>TAU</code>参数，而不是使用<code>HEIGHT</code>。例如：</p> 
<pre><code>d: DISTANCE ATOMS=3,5
METAD ARG=d SIGMA=0.1 TAU=4.0 TEMP=300 PACE=100 BIASFACTOR=1.0
</code></pre> 
<p>获得的<code>HILLS</code>文件仍像 PLUMED 的<code>sum_HILLS</code>同样可用，以便绘制自由能。有意义的情况可能是 RECT 模拟。而关于 RECT 模拟，您也可以使用<code>RECT</code>关键字，以避免使用多个输入文件。例如，单个输入文件的情况可能像这样，其中<code>RECT</code>后的元素个数应等于副本数：</p> 
<pre><code>d: DISTANCE ATOMS=3,5
METAD ARG=d SIGMA=0.1 TAU=4.0 TEMP=300 PACE=100 RECT=1.0,1.5,2.0,3.0
</code></pre> 
<p><img src="https://images2.imgbox.com/13/b9/6jxyOmB3_o.png" alt="在这里插入图片描述"></p> 
<hr class="footnotes-sep"> 
<section class="footnotes"> 
 <ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>V. Babin, C. Roland, and C. Sagui. Adaptively biased molecular dynamics for free energy calculations. J. Chem. Phys., 128:134101, 2008. <a href="#fnref1" rel="nofollow" class="footnote-backref">↩︎</a></p> </li><li id="fn2" class="footnote-item"><p>A Barducci, G Bussi, and M Parrinello. Well-tempered metadynamics: A smoothly converging and tunable free-energy method. Phys. Rev. Lett., 100(2):020603, Jan 2008. <a href="#fnref2" rel="nofollow" class="footnote-backref">↩︎</a></p> </li><li id="fn3" class="footnote-item"><p>Pratyush Tiwary and Michele Parrinello. A time-independent free energy estimator for metadynamics. The Journal of Physical Chemistry B, 119(3):736–742, Jan 2015. <a href="#fnref3" rel="nofollow" class="footnote-backref">↩︎</a></p> </li></ol> 
</section>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d50b0fc7fd820c65ea83eb37e9341e47/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">QT去除QString字符串中空格的方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2352ed4c149428b9aff5169d572bc092/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">TypeError: add_self_loops() got an unexpected keyword argument ‘edge_weight‘</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>