<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>张志晨VB实例教程之打开word方法种种 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="张志晨VB实例教程之打开word方法种种" />
<meta property="og:description" content="张志晨VB实例教程之打开word方法种种 2011年08月31日 张志晨VB实例教程之打开word方法种种 方法一： Dim mWordapp As Word.Application &#39;word 应用程序 Dim mobjDoc As Word.Document &#39;word 文档 Dim fullFileName As String &#39;文件路径 Private Sub Command1_Click() CommonDialog1.Filter = &#34;word文件|*.docx&#34; CommonDialog1.ShowOpen fullFileName = CommonDialog1.FileName Set mWordapp = CreateObject(&#34;Word.Application&#34;) Set mobjDoc = mWordapp.Documents.Add(fullFileName) mWordapp.Visible = True End Sub ................................................ 方法二： Dim fullFileName As String &#39;文件路径 Private Sub Command1_Click() CommonDialog1.Filter = &#34;word文件|*.docx&#34; CommonDialog1.ShowOpen fullFileName = CommonDialog1.FileName Shell &#34;cmd /c &#34; &amp; fullFileName, vbHide&#39;使用shell.exe与cdm.exe End Sub ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1a6e919a2b352bbc2cd79a728bcd94ca/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-01-17T06:10:43+08:00" />
<meta property="article:modified_time" content="2012-01-17T06:10:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">张志晨VB实例教程之打开word方法种种</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    张志晨VB实例教程之打开word方法种种 
<br>2011年08月31日 
<br>　　张志晨VB实例教程之打开word方法种种 
<br>　　方法一： 
<br>　　Dim mWordapp As Word.Application 'word 应用程序 
<br>　　Dim mobjDoc As Word.Document 'word 文档 
<br>　　Dim fullFileName As String '文件路径 
<br>　　Private Sub Command1_Click() 
<br>　　CommonDialog1.Filter = "word文件|*.docx" 
<br>　　CommonDialog1.ShowOpen 
<br>　　fullFileName = CommonDialog1.FileName 
<br>　　　　Set mWordapp = CreateObject("Word.Application") 
<br>　　　　Set mobjDoc = mWordapp.Documents.Add(fullFileName) 
<br>　　　　mWordapp.Visible = True 
<br>　　End Sub 
<br>　　................................................ 
<br>　　方法二： 
<br>　　Dim fullFileName As String '文件路径 
<br>　　Private Sub Command1_Click() 
<br>　　CommonDialog1.Filter = "word文件|*.docx" 
<br>　　CommonDialog1.ShowOpen 
<br>　　fullFileName = CommonDialog1.FileName 
<br>　　　Shell "cmd /c " &amp; fullFileName, vbHide'使用shell.exe与cdm.exe 
<br>　　End Sub 
<br>　　.................................................. 
<br>　　方法三： 
<br>　　Dim fullFileName As String '文件路径 
<br>　　Private Sub Command1_Click() 
<br>　　CommonDialog1.Filter = "word文件|*.docx" 
<br>　　CommonDialog1.ShowOpen 
<br>　　fullFileName = CommonDialog1.FileName 
<br>　　Shell "C:\Program Files\Microsoft Office\OFFICE11\WINWORD.EXE " &amp; fullFileName , vbNormalFocus 
<br>　　End Sub 
<br>　　........................................ 
<br>　　方法四： 
<br>　　Private Declare Function GetDesktopWindow Lib "user32" () As LongPrivate Declare Function ShellExecute Lib "shell32.dll" Alias "ShellExecuteA" (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long 
<br>　　Private Const SW_SHOWNORMAL = 1 
<br>　　'函数：OpenFile 
<br>　　'功能：打开文件或者打开网站或者打开邮件 
<br>　　'描述：asPath――文件位置或者网站地址或者对方邮件地址;Line――命令行 
<br>　　'备注：如果是邮件地址，请在地址前加mailto: 例如：mailto:53076924@qq.com 
<br>　　'返回值如果是2代表文件(夹)不存在，如果是33代表打开文件夹成功,42代表打开文件或网络地址成功,31代表没有文件与之关联 
<br>　　'**************************************************************************** 
<br>　　Public Function OpenFile(asPath As String, Optional Line As String = vbNullString, Optional ShowMode As Long = 1) As Long 
<br>　　Dim Scr_hDC As Long 
<br>　　Scr_hDC = GetDesktopWindow() 
<br>　　OpenFile = ShellExecute(Scr_hDC, "Open", asPath, Line, GetFileOfFolder(asPath), ShowMode) 
<br>　　End Function 
<br>　　Private Function GetFileOfFolder(FilePath As String) As String 
<br>　　Dim i As Integer 
<br>　　If FilePath = "" Then Exit Function 
<br>　　For i = Len(FilePath) To 1 Step -1 
<br>　　If Mid$(FilePath, i, 1) = "\" Then 
<br>　　GetFileOfFolder = Left$(FilePath, i - 1) 
<br>　　Exit For 
<br>　　End If 
<br>　　Next 
<br>　　End Function 
<br>　　上面的是函数的定义，下面的是第四种方法的使用(可以打开任何类型的文件、文件夹)： 
<br>　　Private Sub Command1_Click() 
<br>　　Dim fn As String 
<br>　　CommonDialog1.Filter = "word文件(*.docx)|*.docx|所有文件(*.*)|*.*" 
<br>　　CommonDialog1.ShowOpen 
<br>　　fn = CommonDialog1.FileName 
<br>　　OpenFile (fn)'只需要给函数一个file　path就可以了！！！ 
<br>　　End Sub 
<br>　　...............张志晨奉献............
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2b1ac420ce73bfe9960040546e8c4ce0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">AndroidManifest.xml文件解析(总有一个你不清楚)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/12e03e934afee554c5c6849377ff1c4f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ARM中B __Main和B Main的区别(好文)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>