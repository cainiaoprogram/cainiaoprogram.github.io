<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【java】读取、创建和修改Excel文件 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【java】读取、创建和修改Excel文件" />
<meta property="og:description" content="org.apache.poi.ss.usermodel.*是Apache POI库中的核心包，用于读取、创建和修改Excel文件。
目录
一、导入org.apache.poi.ss.usermodel.*包
二、使用步骤
1.引入库
2.读入数据
3.详解
一、导入org.apache.poi.ss.usermodel.*包 org.apache.poi.ss.usermodel.*是Apache POI库中的核心包，用于读取、创建和修改Excel文件。下面是该包中一些关键的使用方法：
Workbook：表示整个Excel工作簿，在一个工作簿中可以包含多个工作表（Sheet）。
Workbook workbook = WorkbookFactory.create(new File(&#34;path/to/your/excel/file.xls&#34;))：根据文件路径创建一个Workbook对象。Sheet sheet = workbook.getSheetAt(0)：获取第一个工作表。Sheet sheet = workbook.getSheet(&#34;SheetName&#34;)：根据名称获取指定的工作表。 Sheet：代表Excel工作表，包含行（Row）和单元格（Cell）。
Row row = sheet.getRow(rowIndex)：获取指定索引的行。Cell cell = row.getCell(cellIndex)：获取指定索引的单元格。 Row：表示Excel中的一行数据。
int lastRowNum = sheet.getLastRowNum()：获取最后一行的索引（注意索引从0开始）。 Cell：代表单元格，存储在行中，并包含数据和样式信息。
String value = cell.getStringCellValue()：获取单元格的字符串值。double value = cell.getNumericCellValue()：获取单元格的数值。boolean value = cell.getBooleanCellValue()：获取单元格的布尔值。 DataFormat：用于格式化单元格数据。
DataFormat dataFormat = workbook.createDataFormat()：创建一个DataFormat对象。 CellStyle：表示单元格的样式，包括字体、背景颜色、数据格式等。
CellStyle style = workbook.createCellStyle()：创建一个新的CellStyle对象。cell.setCellStyle(style)：为单元格设置样式。 以上仅是org.apache.poi.ss.usermodel.*包中的一些关键使用方法示例。根据具体需求可以进一步探索POI库提供的更多功能和方法。
二、使用步骤 1.引入库 要在Android Studio中导入org.apache.poi.ss.usermodel.*库，你需要进行以下步骤：
打开你的Android Studio项目。
在项目的根目录下找到build.gradle文件，它位于模块目录的顶层（不是项目的根目录）。
在dependencies部分添加POI库的依赖项。在此处添加以下依赖：
implementation &#39;org.apache.poi:poi:4.1.2&#39; implementation &#39;org." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a3a2b18329d5ba790f81936b5f2513cf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-27T17:18:25+08:00" />
<meta property="article:modified_time" content="2023-06-27T17:18:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【java】读取、创建和修改Excel文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p><code>org.apache.poi.ss.usermodel.*</code>是Apache POI库中的核心包，用于读取、创建和修改Excel文件。</p> 
</blockquote> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81pandas%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81pandas%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F" rel="nofollow">一、导入org.apache.poi.ss.usermodel.*包</a></p> 
<p id="%E4%BA%8C%E3%80%81%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4" rel="nofollow">二、使用步骤</a></p> 
<p id="1.%E5%BC%95%E5%85%A5%E5%BA%93-toc" style="margin-left:40px;"><a href="#1.%E5%BC%95%E5%85%A5%E5%BA%93" rel="nofollow">1.引入库</a></p> 
<p id="2.%E8%AF%BB%E5%85%A5%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#2.%E8%AF%BB%E5%85%A5%E6%95%B0%E6%8D%AE" rel="nofollow">2.读入数据</a></p> 
<p id="3.%E8%AF%A6%E8%A7%A3-toc" style="margin-left:40px;"><a href="#3.%E8%AF%A6%E8%A7%A3" rel="nofollow">3.详解</a></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<hr id="hr-toc"> 
<p></p> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81pandas%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><a id="pandas_16"></a>一、导入<code>org.apache.poi.ss.usermodel.*包</code></h2> 
<p><code>org.apache.poi.ss.usermodel.*</code>是Apache POI库中的核心包，用于读取、创建和修改Excel文件。下面是该包中一些关键的使用方法：</p> 
<ol><li> <p><strong>Workbook</strong>：表示整个Excel工作簿，在一个工作簿中可以包含多个工作表（Sheet）。</p> 
  <ul><li><code>Workbook workbook = WorkbookFactory.create(new File("path/to/your/excel/file.xls"))</code>：根据文件路径创建一个Workbook对象。</li><li><code>Sheet sheet = workbook.getSheetAt(0)</code>：获取第一个工作表。</li><li><code>Sheet sheet = workbook.getSheet("SheetName")</code>：根据名称获取指定的工作表。</li></ul></li><li> <p><strong>Sheet</strong>：代表Excel工作表，包含行（Row）和单元格（Cell）。</p> 
  <ul><li><code>Row row = sheet.getRow(rowIndex)</code>：获取指定索引的行。</li><li><code>Cell cell = row.getCell(cellIndex)</code>：获取指定索引的单元格。</li></ul></li><li> <p><strong>Row</strong>：表示Excel中的一行数据。</p> 
  <ul><li><code>int lastRowNum = sheet.getLastRowNum()</code>：获取最后一行的索引（注意索引从0开始）。</li></ul></li><li> <p><strong>Cell</strong>：代表单元格，存储在行中，并包含数据和样式信息。</p> 
  <ul><li><code>String value = cell.getStringCellValue()</code>：获取单元格的字符串值。</li><li><code>double value = cell.getNumericCellValue()</code>：获取单元格的数值。</li><li><code>boolean value = cell.getBooleanCellValue()</code>：获取单元格的布尔值。</li></ul></li><li> <p><strong>DataFormat</strong>：用于格式化单元格数据。</p> 
  <ul><li><code>DataFormat dataFormat = workbook.createDataFormat()</code>：创建一个DataFormat对象。</li></ul></li><li> <p><strong>CellStyle</strong>：表示单元格的样式，包括字体、背景颜色、数据格式等。</p> 
  <ul><li><code>CellStyle style = workbook.createCellStyle()</code>：创建一个新的CellStyle对象。</li><li><code>cell.setCellStyle(style)</code>：为单元格设置样式。</li></ul></li></ol> 
<p>以上仅是<code>org.apache.poi.ss.usermodel.*</code>包中的一些关键使用方法示例。根据具体需求可以进一步探索POI库提供的更多功能和方法。</p> 
<h2 id="%E4%BA%8C%E3%80%81%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><a id="_19"></a>二、使用步骤</h2> 
<h3 id="1.%E5%BC%95%E5%85%A5%E5%BA%93"><a id="1_20"></a>1.引入库</h3> 
<p>要在Android Studio中导入<code>org.apache.poi.ss.usermodel.*</code>库，你需要进行以下步骤：</p> 
<ol><li> <p>打开你的Android Studio项目。</p> </li><li> <p>在项目的根目录下找到<code>build.gradle</code>文件，它位于模块目录的顶层（不是项目的根目录）。</p> </li><li> <p>在<code>dependencies</code>部分添加POI库的依赖项。在此处添加以下依赖：</p> <pre><code class="language-java">implementation 'org.apache.poi:poi:4.1.2' 
implementation 'org.apache.poi:poi-ooxml:4.1.2'</code></pre> </li><li> <p>这将导入Apache POI库及其所需的相关依赖。</p> </li><li> <p>点击Android Studio工具栏上的“Sync Project with Gradle Files”按钮（或者使用快捷键Ctrl + Shift + O），以使更改生效并同步Gradle构建。</p> </li></ol> 
<p>完成以上步骤后，你就可以在Android Studio中使用<code>org.apache.poi.ss.usermodel.*</code>中的类和方法了。</p> 
<p>确保在代码中正确导入所需的类，例如：</p> 
<pre><code class="language-java">import org.apache.poi.ss.usermodel.*; // 其他必要的导入语句...</code></pre> 
<h3 id="2.%E8%AF%BB%E5%85%A5%E6%95%B0%E6%8D%AE"><a id="2_34"></a>2.读入数据</h3> 
<p>代码如下（示例）：<code class="language-c"> </code></p> 
<pre><code class="language-java">import java.io.FileInputStream;
import org.apache.poi.ss.usermodel.*;

public class ExcelReader {

    public static void main(String[] args) {
        try {
            // 创建输入流，指定要读取的Excel文件路径
            FileInputStream fis = new FileInputStream("path/to/your/excel/file.xls");
            
            // 根据文件后缀判断Excel版本
            Workbook workbook = WorkbookFactory.create(fis);
            
            // 获取第一个工作表（通常是默认的第一个工作表），也可以根据名称获取工作表
            Sheet sheet = workbook.getSheetAt(0);
            
            // 遍历每一行
            for (Row row : sheet) {
                // 遍历每个单元格
                for (Cell cell : row) {
                    // 根据单元格类型读取数据
                    switch (cell.getCellType()) {
                        case STRING:
                            System.out.print(cell.getStringCellValue() + "\t");
                            break;
                        case NUMERIC:
                            System.out.print(cell.getNumericCellValue() + "\t");
                            break;
                        case BOOLEAN:
                            System.out.print(cell.getBooleanCellValue() + "\t");
                            break;
                        default:
                            System.out.print("\t");
                    }
                }
                System.out.println();
            }
            
            // 关闭输入流
            fis.close();
            
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre> 
<p></p> 
<p></p> 
<h3 id="3.%E8%AF%A6%E8%A7%A3">3.详解</h3> 
<p><code>org.apache.poi.ss.usermodel.*</code>中的<code>Sheet</code>接口表示Excel工作表。以下是<code>Sheet</code>接口中常用的参数和方法的详解：</p> 
<ol><li> <p><strong>getRow(int rowIndex): Row</strong>：获取指定索引的行对象，索引从0开始。</p> </li><li> <p><strong>createRow(int rowIndex): Row</strong>：创建并返回指定索引的行对象，如果该行已存在，则返回已存在的行对象。</p> </li><li> <p><strong>removeRow(Row row): void</strong>：删除指定的行对象。</p> </li><li> <p><strong>getLastRowNum(): int</strong>：获取最后一行的索引（基于0），即工作表中行的数量减1。</p> </li><li> <p><strong>getFirstRowNum(): int</strong>：获取第一行的索引（基于0）。</p> </li><li> <p><strong>getRowIterator(): Iterator&lt;Row&gt;</strong>：获取一个迭代器，在工作表的所有行上进行迭代。</p> </li><li> <p><strong>getColumnWidth(int columnIndex): int</strong>：获取指定列的宽度（以字符数为单位）。</p> </li><li> <p><strong>setColumnWidth(int columnIndex, int width): void</strong>：设置指定列的宽度（以字符数为单位）。</p> </li><li> <p><strong>setDefaultColumnWidth(int width): void</strong>：设置默认列宽度（以字符数为单位）。</p> </li><li> <p><strong>autoSizeColumn(int columnIndex): void</strong>：根据内容自适应调整指定列的宽度。</p> </li><li> <p><strong>protectSheet(String password): void</strong>：保护工作表，并使用密码进行保护。需要提供一个密码字符串，如果不需要密码保护，则传递null或空字符串。</p> </li><li> <p><strong>isProtected(): boolean</strong>：检查工作表是否被保护。</p> </li><li> <p><strong>getSheetName(): String</strong>：获取工作表的名称。</p> </li><li> <p><strong>setSheetName(String sheetName): void</strong>：设置工作表的名称。</p> </li><li> <p><strong>getColumnStyle(int columnIndex): CellStyle</strong>：获取指定列的单元格样式。</p> </li><li> <p><strong>setDefaultColumnStyle(int columnIndex, CellStyle style): void</strong>：为指定列设置默认的单元格样式。</p> </li><li> <p><strong>protectSheet(String password, boolean shouldProtectObjects, boolean shouldProtectScenarios): void</strong>：保护工作表，可选择性地保护对象和场景，并提供密码进行保护。</p> </li></ol> 
<p></p> 
<h2><a id="_45"></a></h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/25b91d78719a206598d601e9ce30a2a1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">qt QPixmap适应QGraphicsView大小</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5254d04313c72ca8c24bd92951aaed8c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Oracle 分页更新数据</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>