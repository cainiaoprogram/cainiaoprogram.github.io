<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>路由器接口配置与管理——1 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="路由器接口配置与管理——1" />
<meta property="og:description" content="路由器的接口相对于交换机来说最大的特点就是接口类型和配置更为复杂，一般吧路由器上的接口分为三大类：一类用于局域网的LAN接口，一类用于广域网接入/互联的WAN接口，最后一类可以应用于LAN组网，或者WAN接入/互联网中的逻辑接口。最为复杂的就是各种WAN接口。
各种WAN接口有：Serial接口、Async接口（Async：异步）、CE1/PRT接口、E1-F接口、CT1/PRI接口、T1-F接口、3G Cellular接口（Cellular：蜂窝状）、POS接口、CPOS接口、PON接口、ADSL接口、VDSL接口和G.SHDSL接口等。
一、路由器接口基础及基本参数配置与管理
接口分类
接口是设备与网络中的其他设备交换数据并相互作用的部件。AR G3系列路由器中，所有接口共分为管理接口、物理接口和逻辑接口三大类。
1、管理接口
主要为用户提供配置管理支持，也就是通过此类接口可以登录到设备，并进行配置和管理操作，但管理接口不承担业务传输。
AR G3系列路由器支持Console和Mini-USB两种管理接口。
2、物理接口
物理接口是真实存在、有器件支持的接口，需要承担业务传输。物理接口有时也被称为端口。物理接口分为两种：
1）LAN接口：路由器可以通过它们与局域网中的网络设备交换数据。
2）WAN接口：路由器可以通过它们与局域网外的网络设备交换数据。
关于同步、异步传输概念：
异步传输
通常，异步传输是以字符为传输单位，每个字符都要附加 1 位起始位和 1 位停止位，以标记一个字符的开始和结束，并以此实现数据传输同步。所谓异步传输是指字符与字符(一个字符结束到下一个字符开始)之间的时间间隔是可变的，并不需要严格地限制它们的时间关系。起始位对应于二进制值 0，以低电平表示，占用 1 位宽度。停止位对应于二进制值 1，以高电平表示，占用 1~2 位宽度。一个字符占用 5~8位，具体取决于数据所采用的字符集。例如，电报码字符为 5 位、ASCII码字符为 7 位、汉字码则为8 位。此外，还要附加 1 位奇偶校验位，可以选择奇校验或偶校验方式对该字符实施简单的差错控制。发送端与接收端除了采用相同的数据格式(字符的位数、停止位的位数、有无校验位及校验方式等)外，还应当采用相同的传输速率。典型的速率有：9 600 b/s、19.2kb/s、56kb/s等。
异步传输又称为起止式异步通信方式，其优点是简单、可靠，适用于面向字符的、低速的异步通信场合。例如，计算机与Modem之间的通信就是采用这种方式。它的缺点是通信开销大，每传输一个字符都要额外附加2～3位，通信效率比较低。例如，在使用Modem上网时，普遍感觉速度很慢，除了传输速率低之外，与通信开销大、通信效率低也密切相关。
同步传输
通常，同步传输是以数据块为传输单位。每个数据块的头部和尾部都要附加一个特殊的字符或比特序列，标记一个数据块的开始和结束，一般还要附加一个校验序列 (如16位或32位CRC校验码)，以便对数据块进行差错控制。所谓同步传输是指数据块与数据块之间的时间间隔是固定的，必须严格地规定它们的时间关系。
3、逻辑接口
是指能够实现数据交换功能，承担业务传输，但物理上不存在，需要通过配置建立的虚拟接口。
物理接口编号规则
物理接口是实际存在的接口，这就需要为每个接口配置一个编号，以标识每个接口。AR G3系列路由器采用“槽位号/子卡号/接口序号”的格式来定义接口编号。
1）槽位号：表示接口所在的路由器单板所在的槽位号。
首先要明白两个概念：一是什么是“单板”，二是什么是“主控板”。
“单板”可以理解为单一功能板，是插在主控板上面，用于实现某种功能的电路板（也称为接口卡，或者模块），如我们插入一个功能模块（如各种类型以太网接口卡），则这个模块电路板就是一个单板。“主控板”是路由器系统控制和管理的核心，提供整个系统的控制平面，管理平面和业务交换平面，通常还包括电源和风扇模块。
（个人理解，主控板相当于PC机的主板，单板相当于其上的各种接口卡，如网卡、显卡等）。
一般来说，一台路由器设备只有一个主控板，但高端路由器可能有多个主控板，如NE40E。
AR系列路由器支持SIC/WSIC/XSIC/SRU类型的单板，SIC/WSIC/XSIC/SRU类型单板的结构相同，下面以WSIC类型单板举例说明。
SRU主控板是系统控制和管理核心，提供整个系统的控制平面，管理平面和业务交换平面。
-- 控制平面：完成系统的协议处理、业务处理、路由运算、转发控制、业务调度、流量统计、系统安全等功能。
-- 管理平面：完成系统的运行状态监控、环境监控、日志和告警信息处理、系统加载、系统升级等功能。
-- 业务交换平面：提供高速无阻塞数据通道，实现各个业务模块之间的业务交换功能。
SRU主控板包含10块不同型号的主控板
因为AR150/150-S/160/200/200-S系列、AR1200/AR1200-S系列、AR2201-48FE、AR2202-48FE、AR2204、AR2220L、AR2201-48FE-S、AR2204-S和AR2220-S和AR2220S的主控板是一体化的（没有单板），且只有一个主控板，所以其主控板物理槽位号统一取值为0。
其他系列的各单板槽位号参见说明，遇到槽位号合并时，物理槽位号取较大槽位编号，如槽位1和槽位2合并后，取新槽位号2。
2）子卡号：表示各单板上所插入的子卡编号。但因为AR G3系列路由器各单板都不支持子卡，因此统一取值为0。所以各接口编号中的第二位均为0。
3）接口序号：表示各主控板和单板上各接口的编排序号。
-- 接口板面板上只有一排接口
对于AR120&amp;AR160系列、AR1200系列、AR2200系列、AR3200和AR3600系列，最左侧接口从0起始编号，其他接口从左到右依次递增编号。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/aa9f7218c7f773dc88218f209966919e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-06-13T15:46:17+08:00" />
<meta property="article:modified_time" content="2016-06-13T15:46:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">路由器接口配置与管理——1</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>路由器的接口相对于交换机来说最大的特点就是接口类型和配置更为复杂，一般吧路由器上的接口分为三大类：一类用于局域网的LAN接口，一类用于广域网接入/互联的WAN接口，最后一类可以应用于LAN组网，或者WAN接入/互联网中的逻辑接口。<strong>最为复杂的就是各种WAN接口</strong>。</p> 
<p>各种WAN接口有：Serial接口、Async接口（Async：异步）、CE1/PRT接口、E1-F接口、CT1/PRI接口、T1-F接口、3G Cellular接口（Cellular：蜂窝状）、POS接口、CPOS接口、PON接口、ADSL接口、VDSL接口和G.SHDSL接口等。</p> 
<p><strong>一、路由器接口基础及基本参数配置与管理</strong></p> 
<p><strong>接口分类</strong></p> 
<p>接口是设备与网络中的其他设备交换数据并相互作用的部件。AR G3系列路由器中，所有接口共分为管理接口、物理接口和逻辑接口三大类。</p> 
<p>1、管理接口</p> 
<p>主要为用户提供配置管理支持，也就是通过此类接口可以登录到设备，并进行配置和管理操作，但<strong><span style="color:#ff0000">管理接口不承担业务传输</span></strong>。</p> 
<p>AR G3系列路由器支持Console和Mini-USB两种管理接口。</p> 
<p><img src="https://images2.imgbox.com/a2/05/qEjfDpNM_o.png" alt=""><br> </p> 
<p>2、物理接口</p> 
<p>物理接口是真实存在、有器件支持的接口，需要承担业务传输。物理接口有时也被称为端口。物理接口分为两种：</p> 
<p>1）LAN接口：路由器可以通过它们与局域网中的网络设备交换数据。</p> 
<p>2）WAN接口：路由器可以通过它们与局域网外的网络设备交换数据。</p> 
<p><img src="https://images2.imgbox.com/3e/85/lOBcsXGw_o.png" alt=""><br> </p> 
<p>关于同步、异步传输概念：</p> 
<p></p> 
<p align="left" style="color:rgb(102,102,102)">异步传输</p> 
<p align="left" style="color:rgb(102,102,102)">通常，异步传输是以字符为传输单位，每个字符都要附加 1 位起始位和 1 位停止位，以标记一个字符的开始和结束，并以此实现数据传输同步。所谓异步传输是指字符与字符(一个字符结束到下一个字符开始)之间的时间间隔是可变的，并不需要严格地限制它们的时间关系。起始位对应于二进制值 0，以低电平表示，占用 1 位宽度。停止位对应于二进制值 1，以高电平表示，占用 1~2 位宽度。一个字符占用 5~8位，具体取决于数据所采用的字符集。例如，电报码字符为 5 位、ASCII码字符为 7 位、汉字码则为8 位。此外，还要附加 1 位奇偶校验位，可以选择奇校验或偶校验方式对该字符实施简单的差错控制。发送端与接收端除了采用相同的数据格式(字符的位数、停止位的位数、有无校验位及校验方式等)外，还应当采用相同的传输速率。典型的速率有：9 600 b/s、19.2kb/s、56kb/s等。</p> 
<p align="left" style="color:rgb(102,102,102)">异步传输又称为起止式异步通信方式，其优点是简单、可靠，适用于面向字符的、低速的异步通信场合。例如，计算机与Modem之间的通信就是采用这种方式。它的缺点是通信开销大，每传输一个字符都要额外附加2～3位，通信效率比较低。例如，在使用Modem上网时，普遍感觉速度很慢，除了传输速率低之外，与通信开销大、通信效率低也密切相关。</p> 
<p align="left" style="color:rgb(102,102,102)"> 同步传输</p> 
<p align="left" style="color:rgb(102,102,102)">通常，同步传输是以数据块为传输单位。每个数据块的头部和尾部都要附加一个特殊的字符或比特序列，标记一个数据块的开始和结束，一般还要附加一个校验序列 (如16位或32位CRC校验码)，以便对数据块进行差错控制。所谓同步传输是指数据块与数据块之间的时间间隔是固定的，必须严格地规定它们的时间关系。</p> 
<br> 
<p>3、逻辑接口</p> 
<p>是指能够实现数据交换功能，承担业务传输，但物理上不存在，需要通过配置建立的虚拟接口。</p> 
<p><img src="https://images2.imgbox.com/d6/fd/30RwUYma_o.png" alt=""><br> </p> 
<p><strong>物理接口编号规则</strong></p> 
<p>物理接口是实际存在的接口，这就需要为每个接口配置一个编号，以标识每个接口。AR G3系列路由器采用“槽位号/子卡号/接口序号”的格式来定义接口编号。</p> 
<p>1）槽位号：表示接口所在的路由器单板所在的槽位号。</p> 
<p>首先要明白两个概念：一是什么是“<strong>单板</strong>”，二是什么是“<strong>主控板</strong>”。</p> 
<p>“单板”可以理解为单一功能板，是插在主控板上面，用于实现某种功能的电路板（也称为接口卡，或者模块），如我们插入一个功能模块（如各种类型以太网接口卡），则这个模块电路板就是一个单板。“主控板”是路由器系统控制和管理的核心，提供整个系统的控制平面，管理平面和业务交换平面，通常还包括电源和风扇模块。</p> 
<p>（个人理解，主控板相当于PC机的主板，单板相当于其上的各种接口卡，如网卡、显卡等）。</p> 
<p>一般来说，一台路由器设备只有一个主控板，但高端路由器可能有多个主控板，如NE40E。</p> 
<p>AR系列路由器支持SIC/WSIC/XSIC/SRU类型的单板，SIC/WSIC/XSIC/SRU类型单板的结构相同，下面以WSIC类型单板举例说明。<br> </p> 
<p><img src="https://images2.imgbox.com/92/cd/1Yelo5tB_o.png" alt=""><br> </p> 
<p><img src="https://images2.imgbox.com/10/ee/8zqTmLdB_o.png" alt=""><br> </p> 
<p>SRU主控板是系统控制和管理核心，提供整个系统的控制平面，管理平面和业务交换平面。<br>   -- 控制平面：完成系统的协议处理、业务处理、路由运算、转发控制、业务调度、流量统计、系统安全等功能。<br>   -- 管理平面：完成系统的运行状态监控、环境监控、日志和告警信息处理、系统加载、系统升级等功能。<br>   -- 业务交换平面：提供高速无阻塞数据通道，实现各个业务模块之间的业务交换功能。<br> SRU主控板包含10块不同型号的主控板<br> </p> 
<p><img src="https://images2.imgbox.com/34/67/lEyD7qGk_o.png" alt=""><br> </p> 
<p><img src="https://images2.imgbox.com/77/d1/wgr032PL_o.png" alt=""><br> </p> 
<p><img src="https://images2.imgbox.com/2c/73/VeGiIufA_o.png" alt=""><br> </p> 
<p>因为AR150/150-S/160/200/200-S系列、AR1200/AR1200-S系列、AR2201-48FE、AR2202-48FE、AR2204、AR2220L、AR2201-48FE-S、AR2204-S和AR2220-S和AR2220S的主控板是一体化的（没有单板），且只有一个主控板，所以其主控板物理槽位号统一取值为0。</p> 
<p>其他系列的各单板槽位号参见说明，遇到槽位号合并时，物理槽位号取较大槽位编号，如槽位1和槽位2合并后，取新槽位号2。</p> 
<p>2）子卡号：表示各单板上所插入的子卡编号。但因为AR G3系列路由器各单板都不支持子卡，因此统一取值为0。所以各接口编号中的第二位均为0。</p> 
<p>3）接口序号：表示各主控板和单板上各接口的编排序号。</p> 
<p>  -- 接口板面板上只有一排接口</p> 
<p>        对于AR120&amp;AR160系列、AR1200系列、AR2200系列、AR3200和AR3600系列，最左侧接口从0起始编号，其他接口从左到右依次递增编号。</p> 
<p><img src="https://images2.imgbox.com/69/96/FcRpMr1c_o.png" alt=""></p> 
<p>        对于AR150&amp;AR200系列，最右侧接口从0起始编号，其他接口从右到左依次递增编号。</p> 
<p><img src="https://images2.imgbox.com/e6/10/UCTQIG2B_o.png" alt=""></p> 
<p>  -- 接口板面板上有两排接口</p> 
<p>        对于AR160系列、AR1200系列、AR2200系列、AR3200和AR3600系列，左下接口从0起始编号，其他接口从下到上，再从左到右依次递增编号。</p> 
<p><img src="https://images2.imgbox.com/14/cb/HF9OLjHv_o.png" alt=""><br> </p> 
<p>        对于AR150&amp;AR200系列，右下接口从0起始编号，其他接口从下到上，再从右到左依次递增编号。</p> 
<p><img src="https://images2.imgbox.com/ce/a9/UcBExQuJ_o.png" alt=""><br> </p> 
<p><strong>接口基本参数配置</strong></p> 
<p>1）配置接口描述信息</p> 
<p>为方便管理和维护设备，可以配置接口的描述信息，<a target="_blank" href="" rel="nofollow noopener noreferrer"><strong>description</strong></a><em>description</em></p> 
<p>2）配置流量统计时间间隔</p> 
<p>通过配置接口的流量统计时间间隔功能，用户可以对感兴趣的报文进行统计与分析，及时采取流量控制的措施，可以避免网络拥塞和业务中断。<br> </p> 
<p>当用户发现网络有拥塞的情况时，可以将接口的流量统计时间间隔设置为小于300秒（拥塞加剧时，设置为30秒），观察接口在短时间内的流量分布情况。对于导致拥塞的数据报文，采取流量控制措施。<br> 当网络带宽充裕，业务运行正常时，可以将接口的流量统计时间间隔设置为大于300秒。一旦发现有流量参数异常的情况，及时修改流量统计时间间隔，便于更实时的观察该流量参数的趋势。<br> </p> 
<p>流量统计时间间隔可以在系统视图下对设备上的所有接口进行全局配置，也可在接口视图下单独为某个接口配置，仅对本接口生效。</p> 
<p>3）配置开启或关闭接口</p> 
<p>当修改了接口的工作参数配置，且新的配置未能立即生效时，可以依次执行shutdown和undo shutdown命令或restart命令关闭和重启接口，使新的配置生效。<br> 当接口闲置（即没有连接电缆或光纤）时，请使用shutdown命令关闭该接口，以防止由于干扰导致接口异常。<br> </p> 
<p>NULL接口一直处于Up状态，不能使用命令关闭或启动NULL接口。Loopback接口一旦被创建，也将一直保持UP状态，也不能关闭或启动Loopback接口。</p> 
<p><img src="https://images2.imgbox.com/78/1d/rQifYljU_o.png" alt=""><br> </p> 
<p><img src="https://images2.imgbox.com/ad/97/u0kfFOJ1_o.png" alt=""><br> </p> 
<p><strong>接口基本参数配置管理</strong></p> 
<p>可以通过display和reset进行查看和管理</p> 
<p>1）display interface [ interface-type [ interface-number ] ]，查看接口当前运行状态信息，包括：接口当前运行状态、接口基本配置和报文通过接口的转发情况。 </p> 
<p>2）display interface brief [ main ]，查看接口状态和配置的简要信息，包括：接口的物理状态、协议状态、接收方向最近一段时间的带宽利用率、发送方向最近一段时间的带宽利用率、接收的错误报文数和发送的错误报文数。</p> 
<p>3）display ip interface [ interface-type interface-number ]，查看接口的主要IP配置信息。</p> 
<p>4）display default-parameter interface interface-type interface-number，查看接口默认配置。</p> 
<p>5）display interface description [ interface-type [ interface-number ] ]，查看接口的描述信息。</p> 
<p>6）display interface [ interface-type ] counters { inbound | outbound }，查看物理接口发送或接收报文的统计信息。</p> 
<p>7）display transceiver [interface interface-type interface-number | controller controller-type controller-number | slot slot-id] [verbose]：查看所有或者指定接口上的光模块信息</p> 
<p>8）reset counters interface [ interface-type [  interface-number ] ] ：清除所有或指定接口的统计信息。</p> 
<p>9）reset counters if-mib interface [ interface-type [ interface-number]]：清除网管的接口流量统计信息。</p> 
<p>10）display interface ethernet brief：查看以太网接口的简要信息，包括接口的物理状态、自协商方式、双工模式、接口速率、接口接收方向和发送方向最近一段时间的平均带宽利用率。</p> 
<p>11）display error-down recovery 【interface interface-type 【interface-number】】：查看处于Error-down状态的接口信息。</p> 
<p><strong>二、以太网接口配置与管理</strong></p> 
<p>在AR G3系列路由器中都带有一定数量的LAN、WAN以太网接口，用于局域网的组网和以太广域网的连接。根据其使用的传输介质又分为<strong>以太网电接口和以太网光接口</strong>。</p> 
<p><strong><span style="color:#ff0000">以太网接口分类</span></strong></p> 
<p>根据其工作的网络体系架构层次可分为二层以太网接口和三层以太网接口两种。</p> 
<p>1）二层以太网接口：是一种物理接口，工作在数据链路层，不能配置IP地址。它可以对接收到的报文进行二层交换转发，也可以加入VLAN，通过VLANIF接口对接收到的报文进行三层路由转发。下面是二层以太网接口属性</p> 
<p> </p> 
<table id="dc_cfg_int_0071__tab_ar_01" border="1" cellspacing="0" cellpadding="4"><thead align="left"><tr><th id="mcps1.4.6.2.7.1.1" class="cellrowborder" width="16.63%"> <p>接口类型</p> </th><th id="mcps1.4.6.2.7.1.2" class="cellrowborder" width="16.63%"> <p>速率（Mbit/s）</p> </th><th id="mcps1.4.6.2.7.1.3" class="cellrowborder" width="16.63%"> <p>双工模式</p> </th><th id="mcps1.4.6.2.7.1.4" class="cellrowborder" width="16.8%"> <p>自协商模式</p> </th><th id="mcps1.4.6.2.7.1.5" class="cellrowborder" width="16.63%"> <p>流量控制</p> </th><th id="mcps1.4.6.2.7.1.6" class="cellrowborder" width="16.63%"> <p>流量控制自协商</p> </th></tr></thead><tbody><tr><td class="cellrowborder" rowspan="2" width="16.63%"> <p>FE电接口</p> </td><td class="cellrowborder" width="16.63%"> <p>10</p> </td><td class="cellrowborder" width="16.63%"> <p>全双工/半双工</p> </td><td class="cellrowborder" rowspan="2" width="16.8%"> <p>支持</p> </td><td class="cellrowborder" rowspan="2" width="16.63%"> <p>支持</p> </td><td class="cellrowborder" rowspan="2" width="16.63%"> <p>不支持</p> </td></tr><tr><td class="cellrowborder"> <p>100</p> </td><td class="cellrowborder"> <p>全双工/半双工</p> </td></tr><tr><td class="cellrowborder" rowspan="3" width="16.63%"> <p>GE电接口</p> </td><td class="cellrowborder" width="16.63%"> <p>10</p> </td><td class="cellrowborder" width="16.63%"> <p>全双工/半双工</p> </td><td class="cellrowborder" rowspan="3" width="16.8%"> <p>支持</p> </td><td class="cellrowborder" rowspan="3" width="16.63%"> <p>支持</p> </td><td class="cellrowborder" rowspan="3" width="16.63%"> <p>支持</p> </td></tr><tr><td class="cellrowborder"> <p>100</p> </td><td class="cellrowborder"> <p>全双工/半双工</p> </td></tr><tr><td class="cellrowborder"> <p>1000</p> </td><td class="cellrowborder"> <p>全双工</p> </td></tr><tr><td class="cellrowborder" rowspan="2" width="16.63%"> <p>GE光接口</p> 
    <div class="note"> 
     <span class="notetitle">说明： </span> 
     <div class="notebody">
       4GE-2S接口卡的光接口插入GE光电模块，接口属性同GE电接口一致。 
     </div> 
    </div> </td><td class="cellrowborder" width="16.63%"> <p>100</p> </td><td class="cellrowborder" width="16.63%"> <p>全双工</p> </td><td class="cellrowborder" rowspan="2" width="16.8%"> <p>支持</p> 
    <div id="dc_cfg_int_0071__note_01" class="note"> 
     <a target="_blank" name="dc_cfg_int_0071__note_01"></a> 
     <a target="_blank" name="note_01"></a> 
     <span class="notetitle">说明：</span> 
     <div class="notebody"> 
      <p>GE光接口插入FE光模块后不支持配置自协商功能。</p> 
     </div> 
    </div> </td><td class="cellrowborder" rowspan="2" width="16.63%"> <p>支持</p> </td><td class="cellrowborder" rowspan="2" width="16.63%"> <p>支持</p> </td></tr><tr><td class="cellrowborder"> <p>1000</p> </td><td class="cellrowborder"> <p>全双工</p> </td></tr></tbody></table> 二层以太网接口支持电接口和光接口，电接口包括FE电接口和GE电接口，光接口包括GE光接口。 
<br> 
<p></p> 
<p>2）三层以太网接口：是一种物理接口，工作在网络层，可以配置IP地址，它可以对接收到的报文进行三层路由转发。</p> 
<p> </p> 
<table id="dc_cfg_int_0071__tab_ar_02" border="1" cellspacing="0" cellpadding="4"><thead align="left"><tr><th id="mcps1.4.9.2.7.1.1" class="cellrowborder" width="16.52%"> <p>接口类型</p> </th><th id="mcps1.4.9.2.7.1.2" class="cellrowborder" width="16.69%"> <p>速率（Mbit/s）</p> </th><th id="mcps1.4.9.2.7.1.3" class="cellrowborder" width="16.69%"> <p>双工模式</p> </th><th id="mcps1.4.9.2.7.1.4" class="cellrowborder" width="16.69%"> <p>自协商模式</p> </th><th id="mcps1.4.9.2.7.1.5" class="cellrowborder" width="16.69%"> <p>流量控制</p> </th><th id="mcps1.4.9.2.7.1.6" class="cellrowborder" width="16.69%"> <p>流量控制自协商</p> </th></tr></thead><tbody><tr><td class="cellrowborder" rowspan="2" width="16.52%"> <p>FE电接口</p> </td><td class="cellrowborder" width="16.69%"> <p>10</p> </td><td class="cellrowborder" width="16.69%"> <p>全双工/半双工</p> </td><td class="cellrowborder" rowspan="2" width="16.69%"> <p>支持</p> </td><td class="cellrowborder" rowspan="2" width="16.69%"> <p>支持</p> </td><td class="cellrowborder" rowspan="2" width="16.69%"> <p>不支持</p> </td></tr><tr><td class="cellrowborder"> <p>100</p> </td><td class="cellrowborder"> <p>全双工/半双工</p> </td></tr><tr><td class="cellrowborder" rowspan="3" width="16.52%"> <p>GE电接口</p> </td><td class="cellrowborder" width="16.69%"> <p>10</p> </td><td class="cellrowborder" width="16.69%"> <p>全双工/半双工</p> </td><td class="cellrowborder" rowspan="3" width="16.69%"> <p>支持</p> </td><td class="cellrowborder" rowspan="3" width="16.69%"> <p>支持</p> </td><td class="cellrowborder" rowspan="3" width="16.69%"> <p>支持</p> </td></tr><tr><td class="cellrowborder"> <p>100</p> </td><td class="cellrowborder"> <p>全双工/半双工</p> </td></tr><tr><td class="cellrowborder"> <p>1000</p> </td><td class="cellrowborder"> <p>全双工</p> </td></tr><tr><td class="cellrowborder" rowspan="2" width="16.52%"> <p>GE光接口</p> 
    <div class="note"> 
     <span class="notetitle">说明： </span> 
     <div class="notebody">
       4GEW-S接口卡的光接口插入GE光电模块，接口属性同GE电接口一致。 
     </div> 
    </div> </td><td class="cellrowborder" width="16.69%"> <p>100</p> </td><td class="cellrowborder" width="16.69%"> <p>全双工</p> </td><td class="cellrowborder" rowspan="2" width="16.69%"> <p>支持</p> 
    <div class="note"> 
     <span class="notetitle">说明： </span> 
     <div class="notebody"> 
      <p>GE光接口插入FE光模块后不支持配置自协商功能。</p> 
     </div> 
    </div> </td><td class="cellrowborder" rowspan="2" width="16.69%"> <p>支持</p> </td><td class="cellrowborder" rowspan="2" width="16.69%"> <p>支持</p> </td></tr><tr><td class="cellrowborder"> <p>1000</p> </td><td class="cellrowborder"> <p>全双工</p> </td></tr><tr><td class="cellrowborder" rowspan="2" width="16.52%"> <p>XGE（10GE）光接口</p> 
    <div class="note"> 
     <span class="notetitle">说明： </span> 
     <div class="notebody"> 
      <p>对于AR2240和AR3260，只有SRU200和SRU400主控板支持10GE接口。</p> 
     </div> 
    </div> </td><td class="cellrowborder" width="16.69%"> <p>1000</p> </td><td class="cellrowborder" width="16.69%"> <p>全双工</p> </td><td class="cellrowborder" rowspan="2" width="16.69%"> <p>不支持</p> </td><td class="cellrowborder" rowspan="2" width="16.69%"> <p>支持</p> </td><td class="cellrowborder" rowspan="2" width="16.69%"> <p>不支持</p> </td></tr><tr><td class="cellrowborder"> <p>10000</p> </td><td class="cellrowborder"> <p>全双工</p> </td></tr></tbody></table> 三层以太网接口支持电接口和光接口，电接口包括FE电接口和GE电接口，光接口包括GE光接口和10GE接口。 
<br> 
<p></p> 
<p>路由器的某些端口（一般是第一个端口和最后一端口）默认均为二层模式（其他接口均为三层模式），支持通过undo portswitch命令从二层模式切换到三层模式，具体参阅具体路由器型号的说明。</p> 
<p><img src="https://images2.imgbox.com/0a/08/k4qYKn2Z_o.png" alt=""><br> </p> 
<p></p> 
<div class="reader-txt-layer" style="margin:0px; padding:0px; position:absolute; top:0px; left:0px; width:0px; height:0px; z-index:2; zoom:1; color:rgb(51,51,51); font-family:'Microsoft YaHei',微软雅黑,黑体,宋体; line-height:15.996px"> 
 <div class="ie-fix" style="margin:0px; padding:0px"> 
  <p class="reader-word-layer reader-word-s1-1" style=""><br> </p> 
 </div> 
</div> 【1】COMBO，在交换机是指光电复用的意思。  
<br>   Combo口是指交换机设备面板上的两个以太网端口（通常一个是光口一个是电口），而在设备内部只有一个转发端口。   
<br> Combo电口与其对应的光口在逻辑上是光电复用的，用户可根据实际组网情况选择其中的一个使用，但两者不能同时工作，当激活其中的一个端口时，另一个端口就自动处于禁用状态。  
<br>   为了方便管理，Combo口分为两种类型：  单Combo口：设备面板上的两个以太网端口只对应一个端口视图，用户在同一个端口视图完成对两个端口的状态切换操作。单Combo接口可以是二层以太网端口，也可以是三层以太网接口。  双Combo口：设备面板上的两个以太网端口对应两个interface视图，用户在光口或电口自己的端口视图上完成对两个端口的状态切换操作。双Combo接口只能是二层以太网端口。     
<p></p> 
<p>【2】combo口一光一电，只能用一个。。其他与普通口一样一样的。。。   是光电互斥的，光和电只能用上一个 </p> 
<p>【3】combo口一光一电，只能用一个，因为前面板上有两个端口，而机器内部设计只有一个通道，所以只能用一个！</p> 
<p><strong><span style="color:#ff0000">配置以太网接口基本属性</span></strong></p> 
<p>可配置的特性包括端口组、接口速率、MDI类型、双工模式、自动协商模式支持、流量控制和流量控制自动协商支持、环回测试、电缆检测、端口隔离等。</p> 
<p>1）端口组配置</p> 
<p>用户对多个以太网接口进行相同配置时，可以将这多个以太网接口加入端口组内，这样在端口组视图下，用户只需输入一次配置命令，该端口组内的所有以太网接口都会配置该功能，完成批量配置。可配置两种端口组：永久端口组和临时端口组。不同之处在于退出临时端口组后（临时端口组视图），该临时端口组将被系统自动删除，而永久端口组不会被删除。</p> 
<p>2）以太网接口基本属性配置</p> 
<p>主要包括以太网接口（二层以太网接口和三层以太网接口）的通用基本配置，如接口速率、自动协商、MDI类型、双工模式、电缆检测、流量控制等属性配置，还有一项“出/入带宽利用率日志和告警阈值”配置。</p> 
<p>因为交换机主要以以太网口为主，所以这里以交换机为例讲解以太网接口属性的配置，交换机的以太网接口配置相同。</p> 
<p><img src="https://images2.imgbox.com/dd/1c/CyN57wzO_o.png" alt=""><br> </p> 
<p><img src="https://images2.imgbox.com/f8/1d/qtRiwkbi_o.png" alt=""><br> </p> 
<p><strong>端口组</strong>：方便用户同时对端口组中的多个端口进行一次性配置。</p> 
<p><strong>自协商</strong>：主要功能就是使物理链路两端的端口通过协商能力信息交互来自动选择同样的工作参数。自协商端口发送本端的协商能力信息并检测对端的信息，一旦本端接收到对端的协商能力信息，并且得知对端也收到本端发送的协商信息时，就比较两端的能力来建立起<strong>双方都具有的共同最高性能</strong>的工作模式。自动协商的内容主要包括接入速率和流量控制参数。</p> 
<p><strong>流量控制</strong>：作用是用来<strong>控制发送端的</strong>数据发送速率，使接收端设备有能力及时处理来自发送端的数据。</p> 
<p>电缆检测：VCT（Virtual Cable Test，虚拟电缆检测）功能可用于检测接口所连的电缆是否存在故障。当电缆状态正常时显示该电缆的总长度；状态非正常时显示电缆的故障类型，并能够给出故障点的位置，便于定位和解决网线问题。VCT一般用于链路出现故障时检测是否是电缆故障，会导致业务中断。</p> 
<p><strong>环回测试</strong>：用户可以开启以太网接口的环回测试功能，检测以太网接口能否正常工作，用于定位芯片内与该接口相关的模块是否出现故障。测试时接口将不能正常转发数据包。S系列交换机支持内部环回测试模式，该模式在PHY芯片（物理层：<span style="color:rgb(51,51,51); font-family:arial,宋体,sans-serif; line-height:26px">Physical Layer芯片</span>）内部建立自环，端口产生一定数量的测试报文，这些报文通过PHY芯片内部建立的自环又返回到该端口。</p> 
<p><strong>端口隔离</strong>：为实现各接口发送的报文之间二层隔离，可将不同的以太网接口加入不同的VLAN，但会浪费有限的VLAN资源，采用端口隔离特性，可以实现同一VLAN内端口之间的隔离。而且这种隔离是双向的，即如果将端口A和B加入同一个隔离组，则从端口A发送的二层报文不能到达端口B，从端口B发送的报文也不能到达A。</p> 
<p><strong>40GE接口拆分</strong>：仅S7700\S9300\S9700系列支持，它们的40GE接口可以作为一个单独的接口使用，也可以拆分成4个10GE接口。</p> 
<p><img src="https://images2.imgbox.com/9b/28/cgo7wc22_o.png" alt=""><br> </p> 
<p>临时端口组配置：在系统视图下使用port-group group-member {interface-type interface-number1 【 to interface-type interface-number2】} &amp;&lt;1-10&gt;</p> 
<p><strong>以太网端口的基本属性配置步骤</strong>：</p> 
<p><img src="https://images2.imgbox.com/a5/e3/1A886UoK_o.png" alt=""><br> 下面是各以太网接口基本属性配置任务</p> 
<p><img src="https://images2.imgbox.com/0a/5f/r0N6P2lm_o.png" alt=""><br> </p> 
<p><img src="https://images2.imgbox.com/1f/4c/KDnux4W2_o.png" alt=""><br> </p> 
<p><img src="https://images2.imgbox.com/29/92/j5vTHiYe_o.png" alt=""><br> </p> 
<p><img src="https://images2.imgbox.com/d8/92/Md2jblBX_o.png" alt=""><br> </p> 
<p><img src="https://images2.imgbox.com/ad/6c/cUuk2twf_o.png" alt=""><br> </p> 
<p><img src="https://images2.imgbox.com/76/6b/Z1EIhjJ1_o.png" alt=""><br> </p> 
<p><img src="https://images2.imgbox.com/a8/b7/Ge25Y3lU_o.png" alt=""><br> </p> 
<p>对以太网电接口GE1/0/1连接电缆进行检测。</p> 
<p><img src="https://images2.imgbox.com/6f/63/rel8r42l_o.png" alt=""><br> </p> 
<p>接口频繁Up/Down故障分析与排除</p> 
<p>接口频繁Up/Down通常是由于链路两端接口的双工模式、速率、协商模式配置不一致造成的。可在交换机上执行display interface 【interface-type 【interface-number】】命令查看对应接口的信息。</p> 
<p>下图是在真实交换机上执行的结果H3C S3600：</p> 
<p><img src="https://images2.imgbox.com/15/72/CGRNnyDq_o.png" alt=""><br> </p> 
<p>下面是在eNSP上的S5700执行的结果</p> 
<p><img src="https://images2.imgbox.com/e1/86/Sh1tcgTb_o.png" alt=""><br> </p> 
<p>没有显示相关的接口基础配置信息（模拟器的问题吗？？？）</p> 
<p>下面是资料上的结果</p> 
<p><img src="https://images2.imgbox.com/e0/33/y4dwtODJ_o.png" alt=""><br> </p> 
<p>1）先查看输出信息中的negotiation字段，显示为ENABLE，表示该接口工作在自协商状态下，如果是DISABLE，可在接口视图下使用negotiation auto启用接口的自协商模式。</p> 
<p>2）查看输出信息的Speed字段，如果两端速录不同，可以使用speed {10 | 100 | 1000}调整。</p> 
<p>3）查看Duplex字段，如不一致，使用duplex {full | half}调整。</p> 
<p><strong>端口隔离</strong></p> 
<p>“端口隔离”就是隔离不同以太网接口的二层通信，传统的VLAN方法配置比较麻烦而且浪费有限的VLAN资源，另外，在同一个VLAN中各端口至少是二层互通的，也达不到完全的端口隔离目的，端口隔离可以实现同一VLAN内端口之间的二层隔离，<strong>仅适用于在同一交换机上不同端口间的隔离</strong>，且<strong>一个端口可以加入多个端口隔离组</strong>。有两种配置：“接口单向隔离”和“配置端口隔离组”。“端口单向隔离”可使当前端口与指定的以太网接口进行二层甚至三层隔离，但是<strong>单向的，即仅使当前端口不能发送数据给指定的接口，但不限制这些端口发送数据给当前端口</strong>；“端口隔离组”是把想要相互隔离的以太网接口加入同一个隔离组中，使得端口组中的这些以太网接口彼此二层甚至三层隔离。</p> 
<p>当希望同一隔离组内的用户之间不能二层互通，却可以通过交换机访问公共资源，可通过配置端口隔离模式为二层隔离三层互通来实现，当希望同一隔离组内的用户两两之间二、三层都不互通，隔离模式设为二层、三层都隔离。</p> 
<p><strong>配置端口单向隔离</strong>：</p> 
<p><img src="https://images2.imgbox.com/16/b6/Vw8cPUIl_o.png" alt=""><br> </p> 
<p><strong>配置端口隔离组</strong></p> 
<p>配置端口隔离组的方法只需要把想相互隔离的以太网接口加入同一个隔离组中即可。</p> 
<p><img src="https://images2.imgbox.com/2a/8f/Qpdwtl1G_o.png" alt=""><br> </p> 
<p><img src="https://images2.imgbox.com/8f/92/RpYKun6V_o.png" alt=""><br> </p> 
<p><strong>配置帧间隙</strong></p> 
<p>以太网帧与帧之间至少要有一定的帧间隙，以便区分两个数据帧，配置以太网帧之间的帧间隙，可以改变包转发率，调整设备接口上的数据包转发能力。使用<strong>ifg</strong> <em>ifg-value</em>命令配置。参数ifg-value用来指定以太网帧之间的帧间隙，取值范围（9~12）byte。缺省为12个字节，可用undo ifg命令恢复缺省值。</p> 
<p><strong>端口隔离配置示例</strong>：</p> 
<p><img src="https://images2.imgbox.com/90/10/33VqZZ88_o.png" alt=""><br> </p> 
<p>路由器的Ethernet 0/0/0~0/0/2同属vlan10，互相能够ping通。现在希望PC1与PC2之间不能二层互访，PC1与PC3以及PC2与PC3之间都可二层互访。</p> 
<p>只需将PC1和PC2所连接的端口（Ethernet0/0/0 和Ethernet0/0/1）加入隔离组就可以。</p> 
<p><img src="https://images2.imgbox.com/62/0a/bguz6sbJ_o.png" alt=""><br> </p> 
<p>看看从PC1执行ping的结果，</p> 
<p>未进行端口隔离<br> PC&gt;ping 10.10.10.2<br> <br> Ping 10.10.10.2: 32 data bytes, Press Ctrl_C to break<br> From 10.10.10.2: bytes=32 seq=1 ttl=128 time=15 ms<br> From 10.10.10.2: bytes=32 seq=2 ttl=128 time=15 ms<br> From 10.10.10.2: bytes=32 seq=3 ttl=128 time&lt;1 ms<br> From 10.10.10.2: bytes=32 seq=4 ttl=128 time&lt;1 ms<br> From 10.10.10.2: bytes=32 seq=5 ttl=128 time=16 ms<br> <br> --- 10.10.10.2 ping statistics ---<br>   5 packet(s) transmitted<br>   5 packet(s) received<br>   0.00% packet loss<br>   round-trip min/avg/max = 0/9/16 ms<br> <br> PC&gt;ping 10.10.10.3<br> <br> Ping 10.10.10.3: 32 data bytes, Press Ctrl_C to break<br> From 10.10.10.3: bytes=32 seq=1 ttl=128 time=15 ms<br> From 10.10.10.3: bytes=32 seq=2 ttl=128 time&lt;1 ms<br> From 10.10.10.3: bytes=32 seq=3 ttl=128 time&lt;1 ms<br> From 10.10.10.3: bytes=32 seq=4 ttl=128 time=16 ms<br> From 10.10.10.3: bytes=32 seq=5 ttl=128 time=16 ms<br> <br> --- 10.10.10.3 ping statistics ---<br>   5 packet(s) transmitted<br>   5 packet(s) received<br>   0.00% packet loss<br>   round-trip min/avg/max = 0/9/16 ms<br> <br> 进行端口隔离后<br> PC&gt;ping 10.10.10.3<br> <br> Ping 10.10.10.3: 32 data bytes, Press Ctrl_C to break<br> From 10.10.10.3: bytes=32 seq=1 ttl=128 time=15 ms<br> From 10.10.10.3: bytes=32 seq=2 ttl=128 time=15 ms<br> From 10.10.10.3: bytes=32 seq=3 ttl=128 time=15 ms<br> From 10.10.10.3: bytes=32 seq=4 ttl=128 time&lt;1 ms<br> From 10.10.10.3: bytes=32 seq=5 ttl=128 time&lt;1 ms<br> <br> --- 10.10.10.3 ping statistics ---<br>   5 packet(s) transmitted<br>   5 packet(s) received<br>   0.00% packet loss<br>   round-trip min/avg/max = 0/9/15 ms<br> <br> PC&gt;ping 10.10.10.2<br> <br> Ping 10.10.10.2: 32 data bytes, Press Ctrl_C to break<br> From 10.10.10.1: Destination host unreachable<br> From 10.10.10.1: Destination host unreachable<br> From 10.10.10.1: Destination host unreachable<br> From 10.10.10.1: Destination host unreachable<br> From 10.10.10.1: Destination host unreachable<br> <br> --- 10.10.10.2 ping statistics ---<br>   5 packet(s) transmitted<br>   0 packet(s) received<br>   100.00% packet loss<br> </p> 
<p>PC2ping不通了。</p> 
<p><strong><span style="color:#ff0000">配置三层以太网接口</span></strong></p> 
<p><strong>1、配置MTU（Maximum Transmission Unit</strong>）</p> 
<p>任何时候网络层接收到一份要发送的IP数据报文时，它要判断向本地哪个接口发送数据，并查询该接口获得其最大传输单元MTU，网络层把MTU值与要发送的IP数据报文长度进行比较，如果IP数据报文的长度比MTU值大，那么IP数据报文需要进行分片，分片后的数据报文长度小于等于MTU。</p> 
<p>MTU值其实与数据链路类型有关，因为不同数据链路中帧封装的“数据”字段（也就是上层数据包的整体大小）是有长度限制的，如以太网“数据”字段最大长度1500个字节。但现在一般都支持超长帧（Jumbo Frame），所以是加上的最大取值不一定等于数据帧中的数据字段的最大值。</p> 
<p>配置三层以太网接口的MTU方法，在以太网接口视图下，执行<strong>mtu</strong> <em>mtu</em>命令，参数<em>mtu</em>用来指定以太网接口的MTU值，单位是字节。不同以太网接口类型和不同路由器所支持的范围不同，这要查手册。</p> 
<p>缺省情况下，以太网接口的MTU值为1500字节，可用undo mtu恢复缺省。配置MTU后，需要端口restart。</p> 
<p><strong>2、配置Combo接口工作模式</strong></p> 
<p>上面讲过Combo口的概念了，这里不重复。配置方法是在对应的以太网接口视图下，使用combo-port { copper | fiber}命令配置，copper强制指定Combo接口的工作模式为电接口模式，即使用网线传输数据；fiber时，为光口模式，即使用光纤传输数据。<strong>但所选择的模式一定要与对端接口的模式一致</strong>，否则会导致连接失败。缺省为电口模式，使用undo combo-port恢复缺省。</p> 
<p><strong><span style="color:#ff0000">以太网接口管理</span></strong></p> 
<p>1、配置环回检测功能</p> 
<p>环回检测有两种方式：</p> 
<p>1）硬件环回：用硬件将收发端进行短接，使被测试设备接收自己发送出来的信号。</p> 
<p>2）软件环回：又分为“远端环回”（外环回）和“本地环回”（内环回）。“外环回”指对端向本端发出报文时，本端接收到报文后不按照报文的目的地址进行转发，而是直接将报文在发给对端。“内环回”是指本端发出的报文通过系统内部发回给本端，即接口对内自环。</p> 
<p><strong>以太网接口不支持外环回</strong>。</p> 
<p>配置以太网接口内环回检测功能的方法是在对应接口视图（或端口组视图）下使用loopback internal命令（路由器），前面交换机还有一个命令loopback-detect  enable，注意区别。</p> 
<p><br> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/32b23fdf9d815f3afa3a0423c4811852/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java开发 互联网校招 重点复习大纲</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c707251777b27addfe07c5a5bec0a8ab/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mac 装双系统后，怎么默认启动mac系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>