<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>非root权限scp免密传输文件 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="非root权限scp免密传输文件" />
<meta property="og:description" content="环境说明 有两台服务器，client端没有root权限，接收端server有root权限。现在需要从client端免密scp文件到server端。
因为client端没有.ssh文件夹的访问权限，所以不能直接使用client端的密钥，需要从server端生成密钥文件。
整个流程操作步骤如下：
1、server端生成密钥，并且把公钥添加到authorized_keys
2、把私钥上传到client端
3、使用scp -i指定密钥传输
server端配置 生成密钥对 执行ssh-keygen -t rsa，完成之后在/root/.ssh文件夹可以查看到密钥对id_rsa为密钥文件，id_rsa.pub为公钥文件；
执行cp -rf /root/.ssh/id_rsa.pub /root/.ssh/authorized_keys即可
client端配置 上传私钥 把server端的id_rsa上传至client端即可
使用scp传输 了解scp命令的可以直接跳过，看后面-i参数的使用方法
1．命令格式：
scp [参数] [原路径] [目标路径]
2．命令功能：
scp是 secure copy的缩写, scp是linux系统下基于ssh登陆进行安全的远程文件拷贝命令。linux的scp命令可以在linux服务器之间复制文件和目录。
3．命令参数：
-1 强制scp命令使用协议ssh1
-2 强制scp命令使用协议ssh2
-4 强制scp命令只使用IPv4寻址
-6 强制scp命令只使用IPv6寻址
-B 使用批处理模式（传输过程中不询问传输口令或短语）
-C 允许压缩。（将-C标志传递给ssh，从而打开压缩功能）
-p 保留原文件的修改时间，访问时间和访问权限。
-q 不显示传输进度条。
-r 递归复制整个目录。
-v 详细方式显示输出。scp和ssh(1)会显示出整个过程的调试信息。这些信息用于调试连接，验证和配置问题。
-c cipher 以cipher将数据传输进行加密，这个选项将直接传递给ssh。
-F ssh_config 指定一个替代的ssh配置文件，此参数直接传递给ssh。
-i identity_file 从指定文件中读取传输时使用的密钥文件，此参数直接传递给ssh。
-l limit 限定用户所能使用的带宽，以Kbit/s为单位。
-o ssh_option 如果习惯于使用ssh_config(5)中的参数传递方式，
-P port 注意是大写的P, port是指定数据传输用到的端口号" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/35a3db8981bb3493da0a91526e056513/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-03-22T11:49:13+08:00" />
<meta property="article:modified_time" content="2019-03-22T11:49:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">非root权限scp免密传输文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>环境说明</h2> 
<p>有两台服务器，client端没有root权限，接收端server有root权限。现在需要从client端免密scp文件到server端。<br> 因为client端没有.ssh文件夹的访问权限，所以不能直接使用client端的密钥，需要从server端生成密钥文件。<br> 整个流程操作步骤如下：<br> 1、server端生成密钥，并且把公钥添加到authorized_keys<br> 2、把私钥上传到client端<br> 3、使用scp -i指定密钥传输</p> 
<h2><a id="server_8"></a>server端配置</h2> 
<h3><a id="_9"></a>生成密钥对</h3> 
<p>执行ssh-keygen -t rsa，完成之后在/root/.ssh文件夹可以查看到密钥对id_rsa为密钥文件，id_rsa.pub为公钥文件；<br> 执行cp -rf /root/.ssh/id_rsa.pub /root/.ssh/authorized_keys即可</p> 
<h2><a id="client_15"></a>client端配置</h2> 
<h3><a id="_16"></a>上传私钥</h3> 
<p>把server端的id_rsa上传至client端即可</p> 
<h3><a id="scp_19"></a>使用scp传输</h3> 
<p><strong>了解scp命令的可以直接跳过，看后面-i参数的使用方法</strong></p> 
<p>1．命令格式：</p> 
<p>scp [参数] [原路径] [目标路径]</p> 
<p>2．命令功能：</p> 
<p>scp是 secure copy的缩写, scp是linux系统下基于ssh登陆进行安全的远程文件拷贝命令。linux的scp命令可以在linux服务器之间复制文件和目录。</p> 
<p>3．命令参数：</p> 
<p>-1 强制scp命令使用协议ssh1</p> 
<p>-2 强制scp命令使用协议ssh2</p> 
<p>-4 强制scp命令只使用IPv4寻址</p> 
<p>-6 强制scp命令只使用IPv6寻址</p> 
<p>-B 使用批处理模式（传输过程中不询问传输口令或短语）</p> 
<p>-C 允许压缩。（将-C标志传递给ssh，从而打开压缩功能）</p> 
<p>-p 保留原文件的修改时间，访问时间和访问权限。</p> 
<p>-q 不显示传输进度条。</p> 
<p>-r 递归复制整个目录。</p> 
<p>-v 详细方式显示输出。scp和ssh(1)会显示出整个过程的调试信息。这些信息用于调试连接，验证和配置问题。</p> 
<p>-c cipher 以cipher将数据传输进行加密，这个选项将直接传递给ssh。</p> 
<p>-F ssh_config 指定一个替代的ssh配置文件，此参数直接传递给ssh。</p> 
<p>-i identity_file 从指定文件中读取传输时使用的密钥文件，此参数直接传递给ssh。</p> 
<p>-l limit 限定用户所能使用的带宽，以Kbit/s为单位。</p> 
<p>-o ssh_option 如果习惯于使用ssh_config(5)中的参数传递方式，</p> 
<p>-P port 注意是大写的P, port是指定数据传输用到的端口号</p> 
<p>-S program 指定加密传输时所使用的程序。此程序必须能够理解ssh(1)的选项。</p> 
<p>此处用到的就是-i参数<br> 使用前记得把id_rsa权限改成600，权限太大会报错<br> scp -i id_rsa auto_feature/featurefile/特征库* <a href="mailto:root@172.16.16.199" rel="nofollow">root@172.16.16.199</a>:/HYTF/TD/特征库文件/第二代特征库/<br> 备注：<br> 1、此处id_rsa必须与server端的公钥配对<br> 2、如id_rsa文件放在其他目录，记得加上路径</p> 
<h2><a id="_75"></a>阿里云时间</h2> 
<p>通用1888：<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=n93xtdet" rel="nofollow">点击领取</a><br> Hi go季：<a href="https://www.aliyun.com/acts/product-section-2019/new-users?userCode=n93xtdet" rel="nofollow">爆款5折</a><br> 高性能服务器：<a href="https://promotion.aliyun.com/ntms/act/enterprise-discount.html?userCode=n93xtdet" rel="nofollow">2-5折</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/094c766f392d26bdb82b8acc6dad0b5f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Object Detection(目标检测神文)(二)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1dcc55d534f5617b62f807a7756ca3bf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">模式之间的关系</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>