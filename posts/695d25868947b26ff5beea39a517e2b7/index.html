<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>初始化安装K8s集群以及docker服务（附详细步骤和代码！） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="初始化安装K8s集群以及docker服务（附详细步骤和代码！）" />
<meta property="og:description" content="目录 一、什么是K8S？二、初始化安装k8s集群的实验环境1、配置好ip地址和设置对应的主机名2、关闭SELINUX和防火墙3、修改/etc/hosts文件，添加k8s集群里的主机和ip地址的映射关系4、互相之间建立免密通道（每台机器都要）5、关闭swap分区6、加载内核模块7、配置阿里云repo源8、配置安装k8s组件需要的阿里云的repo源9、配置时间同步 三、安装docker服务10、安装docker服务和开机启动11、配置docker镜像加速器和驱动12、安装初始化k8s需要的软件包13、kubeadm初始化k8s集群14、基于kubeadm.yaml文件初始化k8s15、配置kubectl的配置文件config16、扩容k8s集群，添加工作节点（在node1、2上输入命令）17、安装kubernetes网络组件-Calico 一、什么是K8S？ Kubernetes，也被称为K8s，是一个用于自动化部署、扩展和管理容器化应用程序的开源系统，是生产级别的容器编排系统.
二、初始化安装k8s集群的实验环境 环境介绍：3台全新的centos7.9系统、cpu2核、内存4G、磁盘20G
1、配置好ip地址和设置对应的主机名 控制节点 k8s-master 192.168.145.2213
工作节点 k8s-node1 192.168.145.222
工作节点 k8s-node2 192.168.145.223
（注意：以下操作三台服务器均要完成，可使用发送键输入到所有会话功能，然后在master一端输入即可，工作节点会同步进行）
2、关闭SELINUX和防火墙 [root@k8s-master ~]# sed -i &#39;s/SELINUX=enforcing/SELINUX=disabled/g&#39; /etc/selinux/config [root@k8s-master ~]# service firewalld stop Redirecting to /bin/systemctl stop firewalld.service [root@k8s-master ~]# systemctl disable firewalld Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service. Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service. ##重启 [root@k8s-master ~]# reboot 3、修改/etc/hosts文件，添加k8s集群里的主机和ip地址的映射关系 [root@localhost ~]# cat /etc/hosts 127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6 192.168.145.221 k8s-master 192.168.145.222 k8s-node1 192." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/695d25868947b26ff5beea39a517e2b7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-06T16:20:09+08:00" />
<meta property="article:modified_time" content="2023-07-06T16:20:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">初始化安装K8s集群以及docker服务（附详细步骤和代码！）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#K8S_2" rel="nofollow">一、什么是K8S？</a></li><li><a href="#k8s_4" rel="nofollow">二、初始化安装k8s集群的实验环境</a></li><li><ul><li><a href="#1ip_6" rel="nofollow">1、配置好ip地址和设置对应的主机名</a></li><li><a href="#2SELINUX_14" rel="nofollow">2、关闭SELINUX和防火墙</a></li><li><a href="#3etchostsk8sip_25" rel="nofollow">3、修改/etc/hosts文件，添加k8s集群里的主机和ip地址的映射关系</a></li><li><a href="#4_34" rel="nofollow">4、互相之间建立免密通道（每台机器都要）</a></li><li><a href="#5swap_57" rel="nofollow">5、关闭swap分区</a></li><li><a href="#6_63" rel="nofollow">6、加载内核模块</a></li><li><a href="#7repo_77" rel="nofollow">7、配置阿里云repo源</a></li><li><a href="#8k8srepo_83" rel="nofollow">8、配置安装k8s组件需要的阿里云的repo源</a></li><li><a href="#9_92" rel="nofollow">9、配置时间同步</a></li></ul> 
  </li><li><a href="#docker_102" rel="nofollow">三、安装docker服务</a></li><li><ul><li><a href="#10docker_103" rel="nofollow">10、安装docker服务和开机启动</a></li><li><a href="#11docker_108" rel="nofollow">11、配置docker镜像加速器和驱动</a></li><li><a href="#12k8s_122" rel="nofollow">12、安装初始化k8s需要的软件包</a></li><li><a href="#13kubeadmk8s_132" rel="nofollow">13、kubeadm初始化k8s集群</a></li><li><a href="#14kubeadmyamlk8s_195" rel="nofollow">14、基于kubeadm.yaml文件初始化k8s</a></li><li><a href="#15kubectlconfig_201" rel="nofollow">15、配置kubectl的配置文件config</a></li><li><a href="#16k8snode12_208" rel="nofollow">16、扩容k8s集群，添加工作节点（在node1、2上输入命令）</a></li><li><a href="#17kubernetesCalico_225" rel="nofollow">17、安装kubernetes网络组件-Calico</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="K8S_2"></a>一、什么是K8S？</h2> 
<p>Kubernetes，也被称为K8s，是一个用于自动化部署、扩展和管理容器化应用程序的开源系统，是生产级别的容器编排系统.</p> 
<h2><a id="k8s_4"></a>二、初始化安装k8s集群的实验环境</h2> 
<p>环境介绍：3台全新的centos7.9系统、cpu2核、内存4G、磁盘20G</p> 
<h3><a id="1ip_6"></a>1、配置好ip地址和设置对应的主机名</h3> 
<p>控制节点 k8s-master 192.168.145.2213<br> 工作节点 k8s-node1 192.168.145.222<br> 工作节点 k8s-node2 192.168.145.223<br> <strong>（注意：以下操作三台服务器均要完成，可使用发送键输入到所有会话功能，然后在master一端输入即可，工作节点会同步进行）</strong></p> 
<p><img src="https://images2.imgbox.com/cf/cb/9Q8Lk6IP_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2SELINUX_14"></a>2、关闭SELINUX和防火墙</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># sed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># service firewalld stop</span>
Redirecting to /bin/systemctl stop firewalld.service
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># systemctl disable firewalld</span>
Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.
Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.
<span class="token comment">##重启</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># reboot</span>
</code></pre> 
<h3><a id="3etchostsk8sip_25"></a>3、修改/etc/hosts文件，添加k8s集群里的主机和ip地址的映射关系</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/hosts</span>
<span class="token number">127.0</span>.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
<span class="token number">192.168</span>.145.221 k8s-master
<span class="token number">192.168</span>.145.222 k8s-node1
<span class="token number">192.168</span>.145.223 k8s-node2
</code></pre> 
<h3><a id="4_34"></a>4、互相之间建立免密通道（每台机器都要）</h3> 
<p>k8s-master：</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># ssh-keygen  #一路回车，不输入密码</span>
<span class="token comment">#把本地生成的密钥文件和私钥文件拷贝到远程主机</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># ssh-copy-id k8s-master</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># ssh-copy-id k8s-node1</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># ssh-copy-id k8s-node2</span>
</code></pre> 
<p>k8s-node1：</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-node1 ~<span class="token punctuation">]</span><span class="token comment"># ssh-keygen</span>
<span class="token punctuation">[</span>root@k8s-node1 ~<span class="token punctuation">]</span><span class="token comment"># ssh-copy-id k8s-node1</span>
<span class="token punctuation">[</span>root@k8s-node1 ~<span class="token punctuation">]</span><span class="token comment"># ssh-copy-id k8s-node2</span>
<span class="token punctuation">[</span>root@k8s-node1 ~<span class="token punctuation">]</span><span class="token comment"># ssh-copy-id k8s-master</span>
</code></pre> 
<p>k8s-node2：</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-node2 ~<span class="token punctuation">]</span><span class="token comment"># ssh-keygen</span>
<span class="token punctuation">[</span>root@k8s-node2 ~<span class="token punctuation">]</span><span class="token comment"># ssh-copy-id k8s-node2</span>
<span class="token punctuation">[</span>root@k8s-node2 ~<span class="token punctuation">]</span><span class="token comment"># ssh-copy-id k8s-node1</span>
<span class="token punctuation">[</span>root@k8s-node2 ~<span class="token punctuation">]</span><span class="token comment"># ssh-copy-id k8s-master</span>
</code></pre> 
<h3><a id="5swap_57"></a>5、关闭swap分区</h3> 
<p>临时关闭：<code>swapoff -a</code><br> 永久关闭：注释swap挂载 <code>vim /etc/fstab</code><br> <img src="https://images2.imgbox.com/74/ca/ijfmEGoX_o.png" alt="在这里插入图片描述"><br> <em><strong>为什么要注释swap分区？</strong></em><br> <em>因为机器内存不够的情况下，机器会使用swap交换分区，但swap分区的性能较低，k8s设计的时候为了提升性能，是默认不允许使用交换分区的。如果在k8s初始化失败，可能是因为swap分区没有关闭。</em></p> 
<h3><a id="6_63"></a>6、加载内核模块</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># modprobe br_netfilter`</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># echo "modprobe br_netfilter" &gt;&gt; /etc/profile</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># cat &gt; /etc/sysctl.d/k8s.conf &lt;&lt;EOF</span>
net.bridge.bridge-nf-call-ip6tables <span class="token operator">=</span> <span class="token number">1</span>
net.bridge.bridge-nf-call-iptables <span class="token operator">=</span> <span class="token number">1</span>
net.ipv4.ip_forward <span class="token operator">=</span> <span class="token number">1</span>
EOF
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment">#  sysctl -p /etc/sysctl.d/k8s.conf</span>
</code></pre> 
<p>sysctl是在运行时配置内核参数<br> -p 从指定的文件加载系统参数，如不指定即从/etc/sysctl.conf中加载</p> 
<h3><a id="7repo_77"></a>7、配置阿里云repo源</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># yum install -y yum-utils</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># yum install -y yum-utils device-mapper-persistent-data lvm2 wget net-tools nfs-utils lrzsz gcc gcc-c++ make cmake libxml2-devel openssl-devel curl curl-devel unzip sudo ntp libaio-devel wget vim ncurses-devel autoconf automake zlib-devel python-devel epel-release openssh-server socat ipvsadm conntrack ntpdate telnet ipvsadm</span>
</code></pre> 
<h3><a id="8k8srepo_83"></a>8、配置安装k8s组件需要的阿里云的repo源</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># vim /etc/yum.repos.d/kubernetes.repo</span>
<span class="token punctuation">[</span>kubernetes<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>Kubernetes
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">0</span>
</code></pre> 
<h3><a id="9_92"></a>9、配置时间同步</h3> 
<p>#安装ntpdate命令<br> <code>[root@k8s-master ~]# yum install ntpdate -y</code><br> #跟网络时间做同步<br> <code>[root@k8s-master ~]# ntpdate cn.pool.ntp.org</code><br> #把时间同步做成计划任务<br> <code>[root@k8s-master ~]# crontab -e</code><br> * */1 * * * /usr/sbin/ntpdate cn.pool.ntp.org<br> #重启crond服务<br> <code>[root@k8s-master ~]#service crond restart</code></p> 
<h2><a id="docker_102"></a>三、安装docker服务</h2> 
<h3><a id="10docker_103"></a>10、安装docker服务和开机启动</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># yum install docker-ce-20.10.6 -y</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># systemctl start docker &amp;&amp; systemctl enable docker.service</span>
</code></pre> 
<h3><a id="11docker_108"></a>11、配置docker镜像加速器和驱动</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># vim  /etc/docker/daemon.json</span>
<span class="token punctuation">{<!-- --></span>
 <span class="token string">"registry-mirrors"</span>:<span class="token punctuation">[</span><span class="token string">"https://rsbud4vc.mirror.aliyuncs.com"</span>,<span class="token string">"https://registry.docker-cn.com"</span>,<span class="token string">"https://docker.mirrors.ustc.edu.cn"</span>,<span class="token string">"https://dockerhub.azk8s.cn"</span>,<span class="token string">"http://hub-mirror.c.163.com"</span><span class="token punctuation">]</span>,
  <span class="token string">"exec-opts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">"native.cgroupdriver=systemd"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span> 
</code></pre> 
<p>#修改docker文件驱动为systemd，默认为cgroupfs，kubelet默认使用systemd，两者必须一致才可以</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># systemctl daemon-reload  &amp;&amp; systemctl restart docker</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># systemctl status docker</span>
</code></pre> 
<h3><a id="12k8s_122"></a>12、安装初始化k8s需要的软件包</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment">#  yum install -y kubelet-1.20.6 kubeadm-1.20.6 kubectl-1.20.6</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># systemctl enable kubelet</span>
</code></pre> 
<p><strong>每个软件包的作用：</strong></p> 
<ul><li>Kubeadm: kubeadm是一个工具，用来初始化k8s集群的</li><li>kubelet: 安装在集群所有节点上，用于启动Pod的</li><li>kubectl: 通过kubectl可以部署和管理应用，查看各种资源，创建、删除和更新各种组件</li></ul> 
<h3><a id="13kubeadmk8s_132"></a>13、kubeadm初始化k8s集群</h3> 
<p>#把初始化k8s集群需要的离线镜像包上传到k8s-master、node1、node2机器上(可以用scp给node节点传过去，提升速率）</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># docker load -i k8simage-1-20-6.tar.gz</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># scp k8simage-1-20-6.tar.gz k8s-node1:/root</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># scp k8simage-1-20-6.tar.gz k8s-node2:/root</span>
</code></pre> 
<p>使用kubeadm初始化k8s集群</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master~<span class="token punctuation">]</span><span class="token comment"># kubeadm config print init-defaults &gt; kubeadm.yaml</span>
</code></pre> 
<p>kubeadm.yaml配置如下：</p> 
<pre><code class="prism language-bash">apiVersion: kubeadm.k8s.io/v1beta2
bootstrapTokens:
- groups:
  - system:bootstrappers:kubeadm:default-node-token
  token: abcdef.0123456789abcdef
  ttl: 24h0m0s
  usages:
  - signing
  - authentication
kind: InitConfiguration
localAPIEndpoint:
  advertiseAddress: <span class="token number">192.168</span>.145.221 <span class="token comment">#控制节点（master）的ip</span>
  bindPort: <span class="token number">6443</span>
nodeRegistration:
  criSocket: /var/run/dockershim.sock
  name: xianchaomaster1 <span class="token comment">#控制节点主机名</span>
  taints:
  - effect: NoSchedule
    key: node-role.kubernetes.io/master
---
apiServer:
  timeoutForControlPlane: 4m0s
apiVersion: kubeadm.k8s.io/v1beta2
certificatesDir: /etc/kubernetes/pki
clusterName: kubernetes
controllerManager: <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
dns:
  type: CoreDNS
etcd:
  local:
    dataDir: /var/lib/etcd
imageRepository: registry.aliyuncs.com/google_containers
kind: ClusterConfiguration
kubernetesVersion: v1.20.6
networking:
  dnsDomain: cluster.local
  serviceSubnet: <span class="token number">10.96</span>.0.0/12
  podSubnet: <span class="token number">10.244</span>.0.0/16 <span class="token comment">#指定pod网段， 需要新增加这个</span>
scheduler: <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token comment">#追加如下几行</span>
---
apiVersion: kubeproxy.config.k8s.io/v1alpha1
kind: KubeProxyConfiguration
mode: ipvs
---
apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
cgroupDriver: systemd
</code></pre> 
<h3><a id="14kubeadmyamlk8s_195"></a>14、基于kubeadm.yaml文件初始化k8s</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master~<span class="token punctuation">]</span><span class="token comment"># kubeadm init --config=kubeadm.yaml --ignore-preflight-errors=SystemVerification</span>
</code></pre> 
<p>显示如下的结果，则说明安装完成：<br> <img src="https://images2.imgbox.com/a7/f2/8t06iC1l_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="15kubectlconfig_201"></a>15、配置kubectl的配置文件config</h3> 
<p>相当于对kubectl进行授权，这样kubectl命令可以使用这个证书对k8s集群进行管理</p> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> -p <span class="token environment constant">$HOME</span>/.kube
<span class="token function">sudo</span> <span class="token function">cp</span> -i /etc/kubernetes/admin.conf <span class="token environment constant">$HOME</span>/.kube/config
<span class="token function">sudo</span> <span class="token function">chown</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -u<span class="token variable">)</span></span><span class="token builtin class-name">:</span><span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -g<span class="token variable">)</span></span> <span class="token environment constant">$HOME</span>/.kube/config
</code></pre> 
<h3><a id="16k8snode12_208"></a>16、扩容k8s集群，添加工作节点（在node1、2上输入命令）</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># kubeadm join 192.168.145.221:6443 --token abcdef.0123456789abcdef \</span>
    --discovery-token-ca-cert-hash sha256:c7ccdd9cfd97afcf738bc47601d519c20d84a422738bc47601d519c20
</code></pre> 
<p>master查看集群节点状况</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get nodes</span>
</code></pre> 
<p>（下面状态都是NotReady状态，说明没有安装网络插件）<br> <img src="https://images2.imgbox.com/97/1e/MyBlo2WB_o.png" alt="在这里插入图片描述"><br> 可以看到node1、node2的ROLES角色为空，就表示这个节点是工作节点。<br> #可以把node1和node2的ROLES变成work，按照如下方法：</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment">#  kubectl label node k8s-node1 node-role.kubernetes.io/worker=worker</span>
</code></pre> 
<h3><a id="17kubernetesCalico_225"></a>17、安装kubernetes网络组件-Calico</h3> 
<p>注：在线下载配置文件地址是： https://docs.projectcalico.org/manifests/calico.yaml</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f  calico.yaml</span>
</code></pre> 
<p>再次查看集群状态，STATUS状态是Ready，说明k8s集群正常运行了<br> <img src="https://images2.imgbox.com/b2/10/BDNI8fFP_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4729bf18c10cf99de65b7c634105b246/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Linux配置Tomcat和JDK】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e9ca4a3af08be976f6330059d6d395aa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">二叉排序树、平衡二叉树、红黑树、B树、B&#43;树</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>