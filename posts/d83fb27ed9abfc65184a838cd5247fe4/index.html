<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>华为ensp OSPF单区域配置 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="华为ensp OSPF单区域配置" />
<meta property="og:description" content="OSPF的概述 OSPF（开放式最短路径优先），是我们常见的动态路由之一，也是应用比较广泛的一种路由协议。
OSPF区域 OSPF分为骨干区域和非骨干区域 （area 0 为骨干区域 ，area 1 2 3 为非骨干区域）
骨干区域（区域0）：骨干区域必须连接所有的非骨干区域，而且骨干区域不可分割，有且只有一个，一般情况下，骨干区域内没有终端用户。
非骨干区域（非0区域）：非骨干区域一般根据实际情况而划分，必须连接到骨干区域（不规则区域也需通过tunnel或virtual-link连接到骨干区域）。一般情况下，非骨干区域主要连接终端用户和资源。
注：处于两个区域的路由设备我们称作：边界路由器 ABR
ABR是位于一个或多个OSPF区域边界上，将这些区域连接到主干网络的路由器。
OSPF是一种基于链路状态的路由协议，链路状态时通过LSA来进行通告给网络中的其他路由器
OSPF 协议中规定在运行OSPF 的网络中必须有区域0吗？ 对于是否有区域0要看你的网络是多区域还是单区域了！
多区域时所有区域必须和区域0相连。所以区域0是必不可少的！
单区域时可以随意规划area0、area10、area11都可以，因为只有一个区域！
OSPF中消息中的报文分为： 1、Hello报文：路由器和路由器打招呼用的
2、DD报文：数据库描述，告诉对方当前设备存在哪一些链路信息
3、LSR报文：告诉网络中的设备，缺哪一些信息找我要
4、LSU报文：缺哪一些信息 我给你
5、LSAck报文：我已收到你给我的链路信息
Router-ID :是ospf网络中用于区分路由器的唯一标识，router-id遵循如下规则： 1、如果有手动配置，那么就优先使用手动配置的
2、如果1不满足，且配置有配置逻辑接口（回环口），那么就会默认使用该路由器上的逻辑口来作为router ID ，如果存在多个，那么根据数值最大的来作为router id
3、如果1 和 2 都不满足，那么路由器会选择所有活动的物理接口来作为router id 不论是否参加了ospf网络运算，一样安装数值最大的来作为router id
OSPF网络中的关系： 邻居关系： 1、在ospf协议中，每台路由器都会周期性的向外发送hello报文，如果相邻路由器发送给对方的hello报文完全一致，那么两台路由器就会彼此建立邻居路由关系 这就叫做邻居关系
邻接关系： LSDB (链路状态数据库) ：存放了各自路由表中的路由信息
1、在点对点或者P2MP二层网络类型中，两台互为邻居关系的路由器一定会同步彼此的LSDB (链路状态数据库)，如果两台同步成功后，就会建立了邻接关系
只有两个相邻的路由器才能够形成邻居关系
不相邻的两个路由器建立的关系叫做邻接关系
DR ：指定路由器
BDR ： 备份指定路由器
以上两种只适用与广播网络或非广播多路访问网络
DR 和 BDR 的选举规则 ： 由于在一个广播网络和NBNA 网络中，通过向网络中发送Hello 报文 报文中包含了 每一个路由器的router-ID 和优先级 ，路由器的优先级的取值范围是从0 - 255 取值越小优先级越高" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/d83fb27ed9abfc65184a838cd5247fe4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-20T23:38:43+08:00" />
<meta property="article:modified_time" content="2022-01-20T23:38:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">华为ensp OSPF单区域配置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>OSPF的概述</h2> 
<p>OSPF（<span style="color:#1c7331;">开放式最短路径优先</span>），是我们常见的动态路由之一，也是应用比较广泛的一种路由协议。</p> 
<h4 id="ospf区域">OSPF区域</h4> 
<p>OSPF分为骨干区域和非骨干区域 （<span style="color:#1c7331;">area 0 为骨干区域 ，area 1 2 3 为非骨干区域</span>）<br><strong>骨干区域（区域0）</strong>：骨干区域必须连接所有的非骨干区域，而且骨干区域不可分割，有且只有一个，一般情况下，骨干区域内没有终端用户。<br><strong>非骨干区域（非0区域）</strong>：非骨干区域一般根据实际情况而划分，必须连接到骨干区域（不规则区域也需通过tunnel或virtual-link连接到骨干区域）。一般情况下，非骨干区域主要连接终端用户和资源。<br><span style="color:#fe2c24;">注：处于两个区域的路由设备我们称作：边界路由器 ABR</span><br> ABR是位于一个或多个OSPF区域边界上，将这些区域连接到主干网络的<a href="https://baike.baidu.com/item/%E8%B7%AF%E7%94%B1%E5%99%A8/108294" rel="nofollow" title="路由器">路由器</a>。</p> 
<p>OSPF是一种基于链路状态的路由协议，链路状态时通过LSA来进行通告给网络中的其他路由器</p> 
<h4>OSPF 协议中规定在运行OSPF 的网络中必须有区域0吗？</h4> 
<p>对于是否有区域0要看你的网络是多区域还是单区域了！<br> 多区域时所有区域必须和区域0相连。所以区域0是必不可少的！<br> 单区域时可以随意规划area0、area10、area11都可以，因为只有一个区域！</p> 
<h3><strong>OSPF中消息中的报文分为：</strong></h3> 
<p>1、Hello报文：路由器和路由器打招呼用的<br> 2、DD报文：数据库描述，告诉对方当前设备存在哪一些链路信息<br> 3、LSR报文：告诉网络中的设备，缺哪一些信息找我要<br> 4、LSU报文：缺哪一些信息 我给你<br> 5、LSAck报文：我已收到你给我的链路信息</p> 
<h3>Router-ID :是ospf网络中用于区分路由器的唯一标识，router-id遵循如下规则：</h3> 
<p>1、如果有手动配置，那么就优先使用手动配置的<br> 2、如果1不满足，且配置有配置<span style="color:#1c7331;">逻辑接口（<strong>回环口</strong>）</span>，那么就会默认使用该路由器上的逻辑口来作为router ID ，如果存在多个，那么根据数值最大的来作为router id<br> 3、如果1 和 2 都不满足，那么路由器会选择所有活动的物理接口来作为router id 不论是否参加了ospf网络运算，一样安装数值最大的来作为router id</p> 
<h3>OSPF网络中的关系：</h3> 
<h4>邻居关系：</h4> 
<p>1、在ospf协议中，每台路由器都会周期性的向外发送hello报文，如果相邻路由器发送给对方的hello报文完全一致，那么两台路由器就会彼此建立邻居路由关系 这就叫做邻居关系</p> 
<h4>邻接关系：</h4> 
<p>LSDB (<span style="color:#1c7331;">链路状态数据库</span>) ：存放了各自路由表中的路由信息<br> 1、在点对点或者P2MP二层网络类型中，两台互为邻居关系的路由器一定会同步彼此的LSDB (链路状态数据库)，如果两台同步成功后，就会建立了邻接关系</p> 
<p><span style="color:#1c7331;">只有两个相邻的路由器才能够形成邻居关系<br> 不相邻的两个路由器建立的关系叫做邻接关系</span></p> 
<p>DR ：指定路由器<br> BDR ： 备份指定路由器<br> 以上两种只适用与广播网络或非广播多路访问网络</p> 
<p>DR 和 BDR 的选举规则 ： 由于在一个广播网络和NBNA 网络中，通过向网络中发送Hello 报文 报文中包含了 每一个路由器的router-ID 和优先级 ，<span style="color:#1c7331;">路由器的优先级的取值范围是从0 - 255 取值越小优先级越高</span></p> 
<p id="articleContentId"><span style="color:#0d0016;"><strong>display ospf peer的输出解释</strong></span></p> 
<table border="1" cellpadding="4" cellspacing="0"><tbody><tr><th> <p>项目</p> </th><th> <p>描述</p> </th></tr></tbody><tbody><tr><td> <p>Area</p> </td><td> <p>邻居所属的区域</p> </td></tr><tr><td> <p>interface</p> </td><td> <p>与邻居相连的接口</p> </td></tr><tr><td> <p>Router ID</p> </td><td> <p>邻居Router ID</p> </td></tr><tr><td> <p>Address</p> </td><td> <p>邻居接口地址</p> </td></tr><tr><td> <p>State</p> </td><td>邻居状态： 
    <ul><li> <p>Down：该状态为邻居的初始状态。表示没有邻居收到任何信息。在NBMA网络上，Hello报文在该状态时仍然可以收发，周期为Poll Interval（Hello Interval&lt;oll Interval）</p> </li><li> <p>Attempt：该状态只存在于NBMA网络上，表明正在尝试建立邻居关系。此时，Hello报文的收发周期为Hello Interval（Hello Interval&lt;oll Interval）</p> </li><li> <p>Init：该状态表明已经接收到了从邻居发送来的Hello报文</p> </li><li> <p>2-Way：该状态表明已经接收到了从邻居发送过来的Hello报文，并且该Hello报文的Neighbor List中包含本地Router ID，即双方可以互通</p> </li><li> <p>ExStart：该状态为建立Adjacency的第一步，进行主从关系、DD Sequence Number的协商</p> </li><li> <p>Exchange：从该状态开始，进行LSDB同步操作，交互的报文有DD报文、LSR报文、LSU报文</p> </li><li> <p>Loading：LSDB正在进行同步操作，交互的报文有LSR报文和LSU报文</p> </li><li> <p>Full：该状态说明，邻居的LSDB已经同步完成，双方建立了Full邻接关系</p> </li></ul></td></tr><tr><td> <p>Mode</p> </td><td>DD交换进程中的作用为Master或Slave： 
    <ul><li> <p>Nbr is Master：邻居是Master，主动发送DD报文</p> </li><li> <p>Nbr is Slave：邻居是Slave，配合Master发送DD报文</p> </li></ul></td></tr><tr><td> <p>Priority</p> </td><td> <p>邻居的优先级</p> </td></tr><tr><td> <p>DR</p> </td><td> <p>指定路由器</p> </td></tr><tr><td> <p>BDR</p> </td><td> <p>备份指定路由器</p> </td></tr><tr><td> <p>MTU</p> </td><td> <p>邻居接口MTU的值</p> </td></tr><tr><td> <p>Dead timer due in 35 sec</p> </td><td> <p>Dead定时器在35秒后到时</p> </td></tr><tr><td> <p>Retrans timer interval</p> </td><td> <p>重传LSA的时间间隔，单位为秒</p> </td></tr><tr><td> <p>Authentication Sequence</p> </td><td> <p>认证序列号                               </p> <p></p> </td></tr></tbody></table> 
<p></p> 
<h3>OSPF的单区域的配置</h3> 
<h3><strong>实例一：拓补图如下</strong></h3> 
<p><img alt="" height="423" src="https://images2.imgbox.com/f9/4b/SU3YWBC2_o.png" width="515"></p> 
<p><span style="color:#1c7331;">提前配置好主机IP地址以及端口IP地址</span></p> 
<p><span style="color:#1c7331;"><strong>OSPF的配置</strong></span><br><strong>AR2的配置</strong></p> 
<pre><code>[AR2]interface  LoopBack 1   配置逻辑口作为ospf的router id
[AR2-LoopBack1]ip address 1.1.1.1 24 
[AR2]ospf 1 router-id 1.1.1.1  
[AR2-ospf-1]area 0    （区域为0）
[AR2-ospf-1-area-0.0.0.0]network 192.168.100.0 0.0.0.255  
[AR2-ospf-1-area-0.0.0.0]network 192.168.1.0 0.0.0.255 
[AR2-ospf-1-area-0.0.0.0]network 1.1.1.1 0.0.0.255  （共享直连网段 网段+子网掩码的反码）</code></pre> 
<p><img alt="" height="135" src="https://images2.imgbox.com/d9/76/SBQpYyZ1_o.png" width="633"></p> 
<p> <strong>AR1的配置</strong></p> 
<pre><code>[Huawei]int LoopBack 1
[Huawei-LoopBack1]ip address 2.2.2.2 24 
[Huawei]ospf 1 router-id 2.2.2.2 
[Huawei-ospf-1]area 0
[Huawei-ospf-1-area-0.0.0.0]network 192.168.1.0 0.0.0.255 
[Huawei-ospf-1-area-0.0.0.0]network 192.168.2.0 0.0.0.255 
[Huawei-ospf-1-area-0.0.0.0]network 2.2.2.2 0.0.0.255</code></pre> 
<p><img alt="" height="143" src="https://images2.imgbox.com/74/b0/ctakovQD_o.png" width="631"></p> 
<p> <strong>AR3的配置</strong></p> 
<pre><code>[Huawei]int LoopBack 1
[Huawei-LoopBack1]ip address 3.3.3.3 24 
[Huawei]ospf 1 router-id 3.3.3.3
[Huawei-ospf-1]area 0 
[Huawei-ospf-1-area-0.0.0.0]network 192.168.200.0 0.0.0.255 
[Huawei-ospf-1-area-0.0.0.0]network 192.168.2.0 0.0.0.255 
[Huawei-ospf-1-area-0.0.0.0]network 3.3.3.3 0.0.0.255 </code></pre> 
<p><img alt="" height="128" src="https://images2.imgbox.com/fa/b5/iNFPPZmF_o.png" width="630"></p> 
<p> <strong>pc3ping pc4能够互通</strong><br><img alt="" height="338" src="https://images2.imgbox.com/e6/9a/0CywyO1W_o.png" width="525"></p> 
<h3><strong> 实例二：使用ospf协议 没有用interface loopback </strong></h3> 
<p><img alt="" height="296" src="https://images2.imgbox.com/95/c1/3VLX4Lfj_o.png" width="541"></p> 
<p> <span style="color:#1c7331;">提前配置好主机IP地址以及端口IP地址</span></p> 
<p><strong>R4的配置</strong></p> 
<pre><code>[Huawei]ospf 1
[Huawei-ospf-1]area 0
[Huawei-ospf-1-area-0.0.0.0]network 192.168.1.0 0.0.0.255   ##反子网掩码
[Huawei-ospf-1-area-0.0.0.0]network 192.168.2.0 0.0.0.255
</code></pre> 
<p><img alt="" height="128" src="https://images2.imgbox.com/65/f4/cCwVnECC_o.png" width="620"></p> 
<p><span style="color:#1c7331;">display ip routing-table protocol ospf</span></p> 
<p> <img alt="" height="405" src="https://images2.imgbox.com/0e/03/2xItVcTR_o.png" width="644"></p> 
<p> <strong>R5的配置</strong></p> 
<pre><code>[Huawei]ospf 1
[Huawei-ospf-1]area 0
[Huawei-ospf-1-area-0.0.0.0]network 192.168.2.0 0.0.0.255
[Huawei-ospf-1-area-0.0.0.0]network 192.168.3.0 0.0.0.255
[Huawei-ospf-1-area-0.0.0.0]network 192.168.4.0 0.0.0.255 
</code></pre> 
<p><img alt="" height="141" src="https://images2.imgbox.com/92/02/nNJoSeen_o.png" width="619"></p> 
<p> <strong>R6的配置</strong></p> 
<pre><code>[Huawei]ospf 1
[Huawei-ospf-1]area 0
[Huawei-ospf-1-area-0.0.0.0]network 192.168.3.0 0.0.0.255
[Huawei-ospf-1-area-0.0.0.0]network 192.168.5.0 0.0.0.255</code></pre> 
<p><img alt="" height="125" src="https://images2.imgbox.com/38/12/jEvv7pdp_o.png" width="625"></p> 
<p></p> 
<p><strong>pc5 ping pc6</strong></p> 
<p><img alt="" height="326" src="https://images2.imgbox.com/ad/b1/YXI5d1v1_o.png" width="594"></p> 
<p><strong>pc5 ping pc7</strong></p> 
<p><img alt="" height="320" src="https://images2.imgbox.com/67/5f/cnw8mMEc_o.png" width="631"></p> 
<p><strong> pc6 ping pc7</strong></p> 
<p><img alt="" height="326" src="https://images2.imgbox.com/04/c3/HEWJVhdm_o.png" width="565"></p> 
<h3><strong>实例三：</strong>拓扑图如下</h3> 
<p><img alt="" height="444" src="https://images2.imgbox.com/b4/b0/bsUlavyC_o.png" width="664"></p> 
<p>  <span style="color:#1c7331;">提前配置好主机IP地址以及端口IP地址</span></p> 
<p><strong>AR6的配置</strong></p> 
<pre><code>[AR6-GigabitEthernet0/0/2]ospf 1
[AR6-ospf-1]area 0
[AR6-ospf-1-area-0.0.0.0]network 172.16.10.0 0.0.0.255
[AR6-ospf-1-area-0.0.0.0]network 172.16.20.0 0.0.0.255
[AR6-ospf-1-area-0.0.0.0]network 172.16.1.0 0.0.0.255
</code></pre> 
<p>display ospf interface   查看与邻居相连的接口</p> 
<p><img alt="" height="178" src="https://images2.imgbox.com/8d/31/8JGInQQM_o.png" width="629"></p> 
<p>display ospf peer命令输出信息描述</p> 
<p><img alt="" height="401" src="https://images2.imgbox.com/79/a2/fCCU1nnQ_o.png" width="587"></p> 
<p></p> 
<p> <strong>AR7的配置</strong></p> 
<pre><code>[AR7]ospf 1
[AR7-ospf-1]area 0
[AR7-ospf-1-area-0.0.0.0]network 172.16.10.0 0.0.0.255
[AR7-ospf-1-area-0.0.0.0]network 172.16.30.0 0.0.0.255
[AR7-ospf-1-area-0.0.0.0]network 172.16.2.0 0.0.0.255
</code></pre> 
<p><strong>AR8的配置</strong></p> 
<pre><code>[AR8]ospf 1
[AR8-ospf-1]area 0
[AR8-ospf-1-area-0.0.0.0]network 172.16.20.0 0.0.0.255
[AR8-ospf-1-area-0.0.0.0]network 172.16.30.0 0.0.0.255
[AR8-ospf-1-area-0.0.0.0]network 172.16.3.0 0.0.0.255
</code></pre> 
<p>pc8 ping pc9</p> 
<p><img alt="" height="320" src="https://images2.imgbox.com/74/b6/ntWrD2UQ_o.png" width="635"></p> 
<p>pc8 ping pc10</p> 
<p><img alt="" height="311" src="https://images2.imgbox.com/60/45/kAKUQodg_o.png" width="573"></p> 
<p>pc9 ping pc10</p> 
<p><img alt="" height="321" src="https://images2.imgbox.com/b0/c9/thUkzIAi_o.png" width="584"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/064c99135a03ebdcce771a2ed55a11e4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Navicat连接Oracle</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6431afc7a282eaabeed3683682e6ea83/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android-第二节ConstraintLayout（约束布局）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>