<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>可编程计数器/定时器8253和8254 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="可编程计数器/定时器8253和8254" />
<meta property="og:description" content=" 计数器/定时器8253和8254 什么是计数和定时8253/8254的编程结构8253/8254的编程方法8253/8254的工作模式模式0——计数结束产生中断模式1——单负脉冲发生器（可编程单稳态触发器）模式2——频率发生器（分频器）模式3——方波发生器模式4——软件触发的选通信号发生器模式5——硬件触发的选通信号发生器8253/8254的工作模式小结 什么是计数和定时 对于计算机来说，定时就是计数。因为：数数的过程中，如果频率是固定的，时间就知道了两者在实际应用里又有区分。计数：指对外部的输入进行数数。减到0时，输出一个信号便结束。定时：减到0时，自动恢复初值重新计数，并不断产生信号。但从芯片内部来说，这两种情况下的工作过程没有本质差别，都是基于计数器的减1操作微机系统中经常用到定时信号。比如：DRAM刷新定时，多任务分时系统作中断信号实现程序切换，对外设信息进行采样，作为一个可编程波特率发生器，实现时间延迟8254是8253的改进型，体现在8254频率更高，功能更多。8253没有状态寄存器，8254有 8253/8254的编程结构 只有8254有状态寄存器核心是执行部件，执行部件实际上是一个16位的减法计数器 8253/8254的编程方法 8253/8254的控制寄存器和三个计数器具有独立的编程地址：A1A0=00时，选中计数器0；A1A0=01时，选中计数器1；A1A0=10时，选中计数器2；A1A0=11时，选中控制/状态端口控制字本身也会指明所控制的寄存器是哪一个由以上两点原因，对8253/8254的编程没有顺序规定。但有以下三条原则需遵守： 对计数器设初值前需先写控制字设置初值时要符合控制字的格式规定（即只写低位字节或只写高位字节或高低位都写）要读计数器的当前值或状态字，必须先锁存再读取 8253/8254的工作模式 8253/8254作为一个可编程计数器/定时器，可分别在6种不同模式下工作
不论哪种模式，都会遵守下面几条基本规则
写入控制字时，所有控制逻辑电路立即复位，输出端OUT进入初态（可能是高电平，也可能是低）初值写入后，要经过一个时钟周期，计数执行部件才开始计数在时钟脉冲CLK的上升沿，门控信号GATE被采样模式0、4，门控信号为电平触发；模式1、5，门控信号为上升沿触发；模式2、3，既可用电平触发，也可用上升沿触发时钟脉冲的下降沿，计数器作减1计数0是计数器所能容纳的最大初值。用二进制格式时，0相当于216;用BCD码格式时，0相当于104 模式0——计数结束产生中断 写入控制字后，输出端OUT以低电平为初始电平写入计数初值后，GATE=1时，开始计数，计到0时，OUT跳变为高电平，并一直保持（GATE=0时，暂停计数） 注意：
计数过程中，如果写入新初值，则立即将按新初值重新计数计到0时，不会自动装入初值重复计数，除非重新写入初值 模式1——单负脉冲发生器（可编程单稳态触发器） 写入控制字后，输出端OUT以高电平为起始电平写入计数初值N，且GATE受到上升沿触发后，输出端OUT变为低电平，计到0时，OUT跳变为高电平。于是就输出了一个宽度为N个时钟周期的负脉冲（触发后，GATE变为低电平也不会影响计数） 注意:
计数过程中或计数完毕后，若GATE又经历一个从低变高的跳变，那么立即会再次装入初值，重新计数计数过程中，写入新的计数值，当前计数和输出也不会受影响。要想重新计数，只会认准GATE的上升沿在提前触发（即单稳态受触发后未回到稳态而又受到触发）时，会使单稳态输出变宽 模式2——频率发生器（分频器） 写入控制字后，输出端OUT以高电平为起始电平写入初值N，并受到触发后，开始作减1计数，减到1时（注意，不是0），输出端OUT变为低电平，输出1个负脉冲，脉冲宽度为1个时钟周期。然后周期性重复，是个N分频器 注意：
对于计数初值N，输出端OUT用N个时钟周期作为1个周期，并在GATE为高电平时周而复始的重复计数过程中，如果写入新的计数初值，输出端OUT不会受影响。等计数器计到0后，按新的计数值进行计数计数过程中，若GATE变低，则停止计数，GATE变高后，从头开始计数 模式3——方波发生器 写入控制字后，输出端OUT以高电平为起始电平写入初值并受到触发后，开始计数。计数到一半时，输出变为低电平，到0时，又变为高电平，从而完成一个周期 注意：
模式2要注意的就是模式3要注意的 模式4——软件触发的选通信号发生器 写入控制字后，输出端OUT以高电平为起始电平写入初值并受到触发后，开始计数。计到0时，输出1个宽度为1个时钟周期的负脉冲。一般将此负脉冲作为选通信号 注意：
计数过程中，GATE变低电平时，停止计数。GATE变高后，从头开始计数计数过程中，若写入新初值，将立即按新初值从头计数。(这种情况叫软件再触发)无法自动周期性计数，必须靠软件再触发 模式5——硬件触发的选通信号发生器 食用方式同模式4 注意：
模式4是电平触发，模式5是上升沿触发计数过程中，GATE端变低电平不影响计数，若由低跳变到高，则将按计数初值从头计数(这种情况叫硬件再触发)计数过程中，写入新初值，在硬件再触发的条件下，按新初值从头计数与模式4的区别概括下来就是：模式4是软件触发，模式5是用外部电路产生的门控上升沿触发（硬件触发） 8253/8254的工作模式小结 对于方式0，写入控制字后OUT端变低，其余5种方式都是变高模式0、1、4、5是计数器：在GATE控制下进行减1计数，计到0时就停止模式2、3是定时器：在GATE控制下进行减1计数，计到0时，又自动装入初值，重头计数 " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b283fa3a3b83faddc9ef6d17e1cf973b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-28T16:29:24+08:00" />
<meta property="article:modified_time" content="2023-05-28T16:29:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">可编程计数器/定时器8253和8254</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>计数器/定时器8253和8254</h4> 
 <ul><li><a href="#_1" rel="nofollow">什么是计数和定时</a></li><li><a href="#82538254_6" rel="nofollow">8253/8254的编程结构</a></li><li><a href="#82538254_10" rel="nofollow">8253/8254的编程方法</a></li><li><a href="#82538254_17" rel="nofollow">8253/8254的工作模式</a></li><li><ul><li><a href="#0_26" rel="nofollow">模式0——计数结束产生中断</a></li><li><a href="#1_33" rel="nofollow">模式1——单负脉冲发生器（可编程单稳态触发器）</a></li><li><a href="#2_41" rel="nofollow">模式2——频率发生器（分频器）</a></li><li><a href="#3_49" rel="nofollow">模式3——方波发生器</a></li><li><a href="#4_55" rel="nofollow">模式4——软件触发的选通信号发生器</a></li><li><a href="#5_63" rel="nofollow">模式5——硬件触发的选通信号发生器</a></li><li><a href="#82538254_71" rel="nofollow">8253/8254的工作模式小结</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>什么是计数和定时</h2> 
<ul><li>对于计算机来说，定时就是计数。因为：数数的过程中，如果频率是固定的，时间就知道了</li><li>两者在实际应用里又有区分。计数：指对外部的输入进行数数。减到0时，输出一个信号便结束。定时：减到0时，自动恢复初值重新计数，并不断产生信号。但从芯片内部来说，这两种情况下的工作过程没有本质差别，都是基于计数器的减1操作</li><li>微机系统中经常用到定时信号。比如：DRAM刷新定时，多任务分时系统作中断信号实现程序切换，对外设信息进行采样，作为一个可编程波特率发生器，实现时间延迟</li><li>8254是8253的改进型，体现在8254频率更高，功能更多。8253没有状态寄存器，8254有</li></ul> 
<h2><a id="82538254_6"></a>8253/8254的编程结构</h2> 
<p><img src="https://images2.imgbox.com/ab/96/e0L4qpeh_o.png" alt="在这里插入图片描述"></p> 
<ul><li>只有8254有状态寄存器</li><li>核心是执行部件，执行部件实际上是一个16位的减法计数器</li></ul> 
<h2><a id="82538254_10"></a>8253/8254的编程方法</h2> 
<ul><li>8253/8254的控制寄存器和三个计数器具有独立的编程地址：A<sub>1</sub>A<sub>0</sub>=00时，选中计数器0；A<sub>1</sub>A<sub>0</sub>=01时，选中计数器1；A<sub>1</sub>A<sub>0</sub>=10时，选中计数器2；A<sub>1</sub>A<sub>0</sub>=11时，选中控制/状态端口</li><li>控制字本身也会指明所控制的寄存器是哪一个</li><li>由以上两点原因，对8253/8254的编程没有顺序规定。但有以下三条原则需遵守： 
  <ol><li>对计数器设初值前需先写控制字</li><li>设置初值时要符合控制字的格式规定（即只写低位字节或只写高位字节或高低位都写）</li><li>要读计数器的当前值或状态字，必须先锁存再读取</li></ol> </li></ul> 
<h2><a id="82538254_17"></a>8253/8254的工作模式</h2> 
<p>8253/8254作为一个可编程计数器/定时器，可分别在6种不同模式下工作<br> 不论哪种模式，都会遵守下面几条基本规则</p> 
<ul><li>写入控制字时，所有控制逻辑电路立即复位，输出端OUT进入初态（可能是高电平，也可能是低）</li><li><strong>初值写入后，要经过一个时钟周期，计数执行部件才开始计数</strong></li><li>在时钟脉冲CLK的上升沿，门控信号GATE被采样</li><li>模式0、4，门控信号为电平触发；模式1、5，门控信号为上升沿触发；模式2、3，既可用电平触发，也可用上升沿触发</li><li><strong>时钟脉冲的下降沿，计数器作减1计数</strong></li><li>0是计数器所能容纳的最大初值。用二进制格式时，0相当于2<sup>16</sup>;用BCD码格式时，0相当于10<sup>4</sup></li></ul> 
<h3><a id="0_26"></a>模式0——计数结束产生中断</h3> 
<ol><li>写入控制字后，输出端OUT以低电平为初始电平</li><li>写入计数初值后，GATE=1时，开始计数，计到0时，<strong>OUT跳变为高电平，并一直保持</strong>（GATE=0时，暂停计数）</li></ol> 
<p>注意：</p> 
<ul><li>计数过程中，如果写入新初值，则立即将按新初值重新计数</li><li>计到0时，不会自动装入初值重复计数，除非重新写入初值</li></ul> 
<h3><a id="1_33"></a>模式1——单负脉冲发生器（可编程单稳态触发器）</h3> 
<ol><li>写入控制字后，输出端OUT以高电平为起始电平</li><li>写入计数初值N，且GATE受到<strong>上升沿触发</strong>后，输出端OUT变为低电平，计到0时，OUT跳变为高电平。于是就<strong>输出了一个宽度为N个时钟周期的负脉冲</strong>（触发后，GATE变为低电平也不会影响计数）</li></ol> 
<p>注意:</p> 
<ul><li>计数过程中或计数完毕后，若GATE又经历一个从低变高的跳变，那么立即会再次装入初值，重新计数</li><li>计数过程中，写入新的计数值，当前计数和输出也不会受影响。要想重新计数，<strong>只会认准GATE的上升沿</strong></li><li>在提前触发（即单稳态受触发后未回到稳态而又受到触发）时，会使单稳态输出变宽</li></ul> 
<h3><a id="2_41"></a>模式2——频率发生器（分频器）</h3> 
<ol><li>写入控制字后，输出端OUT以高电平为起始电平</li><li>写入初值N，并受到触发后，开始作减1计数，减到1时（注意，不是0），输出端OUT变为低电平，<strong>输出1个负脉冲</strong>，脉冲宽度为1个时钟周期。然后周期性重复，是个N分频器</li></ol> 
<p>注意：</p> 
<ul><li>对于计数初值N，输出端OUT用N个时钟周期作为1个周期，并在GATE为高电平时<strong>周而复始的重复</strong></li><li>计数过程中，如果写入新的计数初值，输出端OUT不会受影响。等计数器计到0后，按新的计数值进行计数</li><li>计数过程中，若GATE变低，则停止计数，GATE变高后，从头开始计数</li></ul> 
<h3><a id="3_49"></a>模式3——方波发生器</h3> 
<ol><li>写入控制字后，输出端OUT以高电平为起始电平</li><li>写入初值并受到触发后，开始计数。计数到一半时，输出变为低电平，到0时，又变为高电平，从而完成一个周期</li></ol> 
<p>注意：</p> 
<ul><li>模式2要注意的就是模式3要注意的</li></ul> 
<h3><a id="4_55"></a>模式4——软件触发的选通信号发生器</h3> 
<ol><li>写入控制字后，输出端OUT以高电平为起始电平</li><li>写入初值并受到触发后，开始计数。计到0时，输出1个宽度为1个时钟周期的负脉冲。一般将此负脉冲作为选通信号</li></ol> 
<p>注意：</p> 
<ul><li>计数过程中，GATE变低电平时，停止计数。GATE变高后，从头开始计数</li><li>计数过程中，若写入新初值，将立即按新初值从头计数。(这种情况叫<strong>软件再触发</strong>)</li><li>无法自动周期性计数，必须靠软件再触发</li></ul> 
<h3><a id="5_63"></a>模式5——硬件触发的选通信号发生器</h3> 
<ol><li>食用方式同模式4</li></ol> 
<p>注意：</p> 
<ul><li>模式4是电平触发，模式5是上升沿触发</li><li>计数过程中，GATE端变低电平不影响计数，若由低跳变到高，则将按计数初值从头计数(这种情况叫<strong>硬件再触发</strong>)</li><li>计数过程中，写入新初值，在硬件再触发的条件下，按新初值从头计数</li><li>与模式4的区别概括下来就是：模式4是软件触发，模式5是用外部电路产生的门控上升沿触发（硬件触发）</li></ul> 
<h3><a id="82538254_71"></a>8253/8254的工作模式小结</h3> 
<ul><li>对于方式0，写入控制字后OUT端变低，其余5种方式都是变高</li><li>模式0、1、4、5是计数器：在GATE控制下进行减1计数，计到0时就停止</li><li>模式2、3是定时器：在GATE控制下进行减1计数，计到0时，又自动装入初值，重头计数</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3d8a360be8e995b810afaa2118e5b507/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于JavaWeb&#43;MySQL的企业员工信息管理系统（考勤、工资、岗位、奖惩等）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9b5498ddf98464b7164c6f117dbe0c34/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于tabular包的Latex表格尺寸设置方法（列宽和行高）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>