<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>单因素方差分析--R - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="单因素方差分析--R" />
<meta property="og:description" content="任务说明 三个剂量水平的药物处理受试者，每个剂量水平十个受试者，现在收集到数据后，问：
药物剂量水平显著影响受试者的response？
或者不同剂量药物处理受试者有显著效果的差异吗？
数据 library(tidyverse) library(reshape2) # install.packages(&#34;gplots&#34;) library(gplots) df &lt;- read.table(&#34;AUClast1.csv&#34;,header = T,sep=&#34;,&#34;) head(df) dose &lt;- c(0.2,0.6,1.8) fqr &lt;- as.data.frame(t(df[1:3,2:11])) rownames(fqr) &lt;- 1:nrow(fqr) colnames(fqr) &lt;- dose fqr &lt;- melt(fqr) fqr$variable &lt;- as.factor(fqr$variable) head(fqr) # variable value #1 0.2 24.9 #2 0.2 19.7 #3 0.2 27.3 #4 0.2 26.8 #5 0.2 30.8 #6 0.2 30.2 table(fqr$variable) # 0.2 0.6 1.8 # 10 10 10 代码 # anove单因素方差分析 fit &lt;- aov(value ~ variable,fqr) summary(fit) # Df Sum Sq Mean Sq F value Pr(&gt;F) # variable 2 593525 296762 45." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/919333e26b4dff29c2dc384f68897ce0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-11T10:14:59+08:00" />
<meta property="article:modified_time" content="2024-01-11T10:14:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">单因素方差分析--R</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>任务说明</h2> 
<p>三个剂量水平的药物处理受试者，每个剂量水平十个受试者，现在收集到数据后，问：<br> 药物剂量水平显著影响受试者的response？<br> 或者不同剂量药物处理受试者有显著效果的差异吗？</p> 
<h2><a id="_4"></a>数据</h2> 
<pre><code class="prism language-R">library(tidyverse)
library(reshape2)
# install.packages("gplots")
library(gplots)
df &lt;- read.table("AUClast1.csv",header = T,sep=",")
head(df)
dose &lt;- c(0.2,0.6,1.8)
fqr &lt;- as.data.frame(t(df[1:3,2:11]))
rownames(fqr) &lt;- 1:nrow(fqr)
colnames(fqr) &lt;- dose
fqr &lt;- melt(fqr)
fqr$variable &lt;- as.factor(fqr$variable)
head(fqr)
#    variable value
#1      0.2  24.9
#2      0.2  19.7
#3      0.2  27.3
#4      0.2  26.8
#5      0.2  30.8
#6      0.2  30.2

table(fqr$variable)
#  0.2 0.6 1.8 
#  10  10  10 
</code></pre> 
<h2><a id="_31"></a>代码</h2> 
<pre><code class="prism language-R"># anove单因素方差分析
fit &lt;- aov(value ~ variable,fqr)
summary(fit)
#  Df Sum Sq Mean Sq F value  Pr(&gt;F)
# variable     2 593525  296762    45.6 2.2e-09
# Residuals   27 175587    6503 
# 分组之间的均值差异显著

# 可视化
plotmeans(fqr$value ~ fqr$variable, xlab="Treatment", ylab="Response",
          main="Mean Plot\nwith 95% CI")
          
# 1.8的剂量分组 内部方差太大了，不过还是继续看看，后面做一下假设检验证实一下。
</code></pre> 
<p><img src="https://images2.imgbox.com/e6/9f/wmcHlIye_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-R"># 上述分析只知道组件均值差异大但是不知那几组之间差异大，需要多重比较才能知晓（杜肯法，最小极差法等等）
# 多重比较
library(multcomp)

# par语句扩大了图像的顶部面积
par(mar=c(5,4,6,2))
# 进行多重比较
tuk &lt;- glht(fit, linfct=mcp(variable="Tukey"))
# 图像展示
# 有相同字母的两组即为不显著差异
plot(cld(tuk, level=.05),col="lightgrey")

# 0.2剂量组和0.6剂量组的response均值无明显差异，图像顶部都是a
# 1.8剂量组和0.2剂量组或0.6剂量组的response均值相比较均有明显差异，图像顶部的字母不一致
</code></pre> 
<p><img src="https://images2.imgbox.com/df/71/pvQDZVsr_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-R"># 上面的boxplot可以明显看到1.8剂量组的组内方差很大的，到底是组内方差还是组间方差引起了显著性差异呢？
# 做一下 ”评估方差检验的假设条件“
# 1. 因变量的正态分布
library(car)

qqPlot(lm(value ~ variable, data=fqr),
       simulate=TRUE, main="Q-Q Plot", labels=FALSE)
# 不满足
</code></pre> 
<p><img src="https://images2.imgbox.com/a3/75/oJrS8hin_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-R"># 2.离群点检测
library(car)

outlierTest(fit)

# rstudent unadjusted p-value Bonferroni p
# 30    4.367          0.0001784     0.005352
# 第三十个数据点是离群点（去掉离群点后拟合还有可能出现离群点）
</code></pre> 
<pre><code class="prism language-R"># 3. 因变量的方差齐性
bartlett.test(value ~ variable, data=fqr)
# Bartlett检验表明三组的方差有明显的不同（p-value = 1e-13）
</code></pre> 
<h2><a id="_94"></a>结论</h2> 
<pre><code class="prism language-R"># 数据包含强影响点，而且因变量（误差）不满足正态分布
# 方差齐性分析也证实了 分组之间的组内放差有明显的不同
# 组内方差较大时，实验的结果无法解释，所以整个方差分析的结果也不可信。
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9ff7e46f5948f0d3627ab02f69a05027/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">网络安全等级保护测评方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4b6a42538050ceded95a39b7bfb1a7c7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JVM基础（6）——JVM垃圾回收器简介</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>