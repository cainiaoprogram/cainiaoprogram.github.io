<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CentOS 7部署达梦数据库 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CentOS 7部署达梦数据库" />
<meta property="og:description" content="1.安装前准备 1.1DM数据库信息 CPU架构
操作系统
数据库版本
iso镜像
x86
CentOS 7
DM8开发版
dm8_20230104_x86_rh6_64.iso
数据库下载地址
https://www.dameng.com/list_103.html
操作系统下载地址
http://mirrors.163.com/centos/7.9.2009/isos/x86_64/
1.2新建dmdba用户 安装前必须创建dmdba用户，禁止使用root用户安装。
创建用户组
groupadd dminstall
创建用户
useradd -g dminstall -m -d /home/dmdba -s /bin/bash dmdba
设置用户密码
设置dmdba 用户的密码，用来登录使用，这里设置密码为111111。
注意：为了系统安全起见，用户应该设置比较复杂的密码。输入的密码不显示在终端，请正确输入并牢记。
passwd dmdba
New password:111111
Re-enter new password:111111
1.3调整 limits.conf 参数 linux系统中，操作系统会默认对程序使用资源进行限制，我们需取消相应的限制来避免达梦数据库的性能被影响。
使用root用户修改，具体操作如下：
使用vim或vi编辑器来编辑limits.conf文件，具体命令如下：
vim /etc/security/limits.conf
按i进入编辑模式，将下列4句语句添加至limits.conf文件。
dmdba hard nofile 65536
dmdba soft nofile 65536
dmdba hard stack 32768
dmdba soft stack 16384
添加完成后按esc退出编辑模式，输入:wq进行保存。
切换dmdba用户查看是否生效，具体命令如下：
su - dmdba #切换dmdba用户" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/add5ffbda9f552a58311ed5f85510c0c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-09T10:36:15+08:00" />
<meta property="article:modified_time" content="2023-03-09T10:36:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CentOS 7部署达梦数据库</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">1.安装前准备</span></h3> 
 <hr> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">1.1DM数据库信息</span></h4> 
 <div style=""> 
  <table class="kdocs-table" border="1" cellpadding="1" cellspacing="1" style=""><tbody><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:184px;vertical-align:top;height:52px;"><p style="text-align:center;"><span class="kdocs-bold" style="font-weight:bold;">CPU架构</span></p></td><td class="kdocs-tableCell" style="width:184px;vertical-align:top;height:52px;"><p style="text-align:center;"><span class="kdocs-bold" style="font-weight:bold;">操作系统</span></p></td><td class="kdocs-tableCell" style="width:184px;vertical-align:top;height:52px;"><p style="text-align:center;"><span class="kdocs-bold" style="font-weight:bold;">数据库版本</span></p></td><td class="kdocs-tableCell" style="width:184px;vertical-align:top;height:52px;"><p style="text-align:center;"><span class="kdocs-bold" style="font-weight:bold;">iso镜像</span></p></td></tr><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:184px;vertical-align:top;height:52px;"><p style="text-align:center;">x86</p></td><td class="kdocs-tableCell" style="width:184px;vertical-align:top;height:52px;"><p style="text-align:center;">CentOS 7</p></td><td class="kdocs-tableCell" style="width:184px;vertical-align:top;height:52px;"><p style="text-align:center;">DM8开发版</p></td><td class="kdocs-tableCell" style="width:184px;vertical-align:top;height:52px;"><p style="text-align:center;">dm8_20230104_x86_rh6_64.iso</p></td></tr></tbody></table> 
 </div> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>数据库下载地址</p></li></ul> 
 <p style="text-align:left;"><a class="kdocs-link" style="color:#0A6CFF;" href="https://www.dameng.com/list_103.html" rel="nofollow noopener noreferrer" target="_blank">https://www.dameng.com/list_103.html</a></p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>操作系统下载地址</p></li></ul> 
 <p style="text-align:left;"><a class="kdocs-link" style="color:#0A6CFF;" href="http://mirrors.163.com/centos/7.9.2009/isos/x86_64/" rel="nofollow noopener noreferrer" target="_blank">http://mirrors.163.com/centos/7.9.2009/isos/x86_64/</a></p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">1.2新建dmdba用户</span></h4> 
 <p style="text-align:null;">安装前必须创建dmdba用户，禁止使用root用户安装。</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>创建用户组</p></li></ul> 
 <p style="text-align:left;">groupadd dminstall</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>创建用户</p></li></ul> 
 <p style="text-align:left;">useradd -g dminstall -m -d /home/dmdba -s /bin/bash dmdba</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>设置用户密码</p></li></ul> 
 <p style="text-align:null;">设置dmdba 用户的密码，用来登录使用，这里设置密码为111111。</p> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">注意</span>：为了系统安全起见，用户应该设置比较复杂的密码。输入的密码不显示在终端，请正确输入并牢记。</p> 
 <p style="text-align:left;">passwd dmdba</p> 
 <p style="text-align:left;">New password:111111</p> 
 <p style="text-align:left;">Re-enter new password:111111</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">1.3调整 limits.conf 参数</span></h4> 
 <p style="text-align:null;">linux系统中，操作系统会默认对程序使用资源进行限制，我们需取消相应的限制来避免达梦数据库的性能被影响。</p> 
 <p style="text-align:null;">使用root用户修改，具体操作如下：</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>使用vim或vi编辑器来编辑limits.conf文件，具体命令如下：</p></li></ul> 
 <p style="text-align:left;">vim /etc/security/limits.conf</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>按i进入编辑模式，将下列4句语句添加至limits.conf文件。</p></li></ul> 
 <p style="text-align:left;">dmdba hard nofile 65536</p> 
 <p style="text-align:left;">dmdba soft nofile 65536</p> 
 <p style="text-align:left;">dmdba hard stack 32768</p> 
 <p style="text-align:left;">dmdba soft stack 16384</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>添加完成后按esc退出编辑模式，输入:wq进行保存。</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>切换dmdba用户查看是否生效，具体命令如下：</p></li></ul> 
 <p style="text-align:left;">su - dmdba #切换dmdba用户</p> 
 <p style="text-align:left;">ulimit -a #查看是否生效</p> 
 <p style="text-align:null;">效果如图所示：</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:null;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:660px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:63.636364%;height:0;"> 
    <img src="https://images2.imgbox.com/1d/dd/7IJd3wov_o.png" style="margin-left:;display:block;width:660px;margin-top:-63.636364%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">1.4挂载镜像</span></h4> 
 <p style="text-align:null;">使用root用户，将DM数据库的iso镜像保存在任意位置，这里将iso镜像放入/opt目录下，执行如下命令来挂载镜像：</p> 
 <p style="text-align:left;">mount -o loop /opt/dm8_20230104_x86_rh6_64.iso /mnt</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">1.5新建安装目录</span></h4> 
 <p style="text-align:null;">使用root用户进行相关操作。</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>在根目录下创建 /dm8 文件夹，用来安装 DM 数据库，命令如下:</p></li></ul> 
 <p style="text-align:left;">mkdir /dm8</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>更改文件所有者为dmdba，所有组为dinstall，命令如下:</p></li></ul> 
 <p style="text-align:left;">chown dmdba:dminstall -R /dm8/</p> 
 <p style="text-align:null;">如果不把/dm8文件所有者更改为dmdba用户，DM数据库就无法安装到该目录下。</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>给安装路径下的文件设置 755 权限，命令如下:</p></li></ul> 
 <p style="text-align:left;">chmod -R 755 /dm8</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">2.数据库安装</span></h3> 
 <hr> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>切换到dmdba用户，在/mnt目录下执行安装程序。</p></li></ul> 
 <p style="text-align:left;">su - dmdba #切换dmdba用户</p> 
 <p style="text-align:left;">cd /mnt/ #进入mnt目录下</p> 
 <p style="text-align:left;">./DMInstall.bin -i #执行安装程序</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>根据提示进行安装，选择默认安装语言为中文，输入c后按回车。</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>不输入key文件路径输入n后按回车。</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>设置时区，输入y后按回车，选项21是中国标准时间，这里默认输入21后按回车。</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>选择【1-典型安装】，输入1后按回车。</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>设置安装目录 为/dm8 。输入 /dm8后按回车。</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>确认安装路径是否正确，准确无误后输入y，按回车。</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>确认安装，输入y后按回车。</p></li></ul> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:933px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:25.937834%;height:0;"> 
    <img src="https://images2.imgbox.com/5c/04/d3iK9qHf_o.png" style="margin-left:;display:block;width:933px;margin-top:-25.937834%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:917px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:37.29553%;height:0;"> 
    <img src="https://images2.imgbox.com/b3/8a/OAEednJs_o.png" style="margin-left:;display:block;width:917px;margin-top:-37.29553%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <p style=""></p> 
 <p style="">安装完成后会显示如下界面：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:588px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:23.469389%;height:0;"> 
    <img src="https://images2.imgbox.com/97/6d/Z3A6DiBK_o.png" style="margin-left:;display:block;width:588px;margin-top:-23.469389%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>安装结束后需要创建DmAPService，否则会影响数据库的备份。切换至root用户依次执行如下命令:</p></li></ul> 
 <p style="text-align:left;">su - root</p> 
 <p style="text-align:left;">/dm8/script/root/root_installer.sh</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">3.配置环境变量</span></h3> 
 <hr> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>使用root用户进入dmdba用户的根目录下，配置环境变量。效果如下所示:</p></li></ul> 
 <p style="text-align:left;">vim /home/dmdba/.bash_profile #执行此命令后按i进行编辑</p> 
 <p style="text-align:left;"> </p> 
 <p style="text-align:left;">export LD_LIBRARY_PATH="$LD_LIBRARY_PATH:/dm8/bin"</p> 
 <p style="text-align:left;">export DM_HOME="/dm8"</p> 
 <p style="text-align:left;">export PATH=$PATH:$DM_HOME/bin:$DM_HOME/tool</p> 
 <p style="text-align:left;"> #编辑后按esc退出编辑模式，输入：wq后按回车</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>切换dmdba用户，使环境变量生效，命令如下。</p></li></ul> 
 <p style="text-align:left;">su - dmdba #切换dmdba用户</p> 
 <p style="text-align:left;">source .bash_profile #使环境变量生效</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">4.配置实例</span></h3> 
 <hr> 
 <p style="text-align:null;">使用dmdba用户，进入安装目录下的bin目录中，执行dminit命令来配置实例。</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>进入bin目录。</p></li></ul> 
 <p style="text-align:left;">cd /dm8/bin</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>dminit 命令可设置多种参数，可执行如下命令查看可配置参数。</p></li></ul> 
 <p style="text-align:left;">./dminit help</p> 
 <p style="text-align:null;">需要注意的是<span class="kdocs-bold" style="font-weight:bold;">页大小 (page_size)、簇大小 (extent_size)、大小写敏感 (case_sensitive)、字符集 (charset)</span> 这四个参数，<span class="kdocs-bold" style="font-weight:bold;">一旦确定无法修改</span>，需谨慎设置。</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>以下命令是设置页大小为 32 KB，簇大小为 32 KB，大小写敏感，字符集为 utf_8，数据库名为 DMDB，实例名为 DBSERVER，端口为 5236。</p></li></ul> 
 <p style="text-align:left;">./dminit path=/dm8/data PAGE_SIZE=32 EXTENT_SIZE=32 CASE_SENSITIVE=y CHARSET=1 DB_NAME=DMDB INSTANCE_NAME=DBSERVER PORT_NUM=5236</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">5.注册服务</span></h3> 
 <hr> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>注册服务需使用root用户进行注册。注册命令脚本在/dm8/script/root目录下，执行如下命令：</p></li></ul> 
 <p style="text-align:left;">su - root #切换到root用户</p> 
 <p style="text-align:left;">cd /dm8/script/root #进入/dm8/script/root目录</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>注册服务，执行命令如下所示：</p></li></ul> 
 <p style="text-align:left;">./dm_service_installer.sh -t dmserver -dm_ini /dm8/data/DMDB/dm.ini -p DMSERVER</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">6.启动、停止数据库</span></h3> 
 <hr> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>服务注册成功后，启动数据库，如下所示：</p></li></ul> 
 <p style="text-align:left;">systemctl start DmServiceDMSERVER.service</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>停止数据库，如下所示：</p></li></ul> 
 <p style="text-align:left;">systemctl stop DmServiceDMSERVER.service</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>重启数据库，如下所示：</p></li></ul> 
 <p style="text-align:left;">systemctl restart DmServiceDMSERVER.service</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>查看数据库服务状态，如下所示：</p></li></ul> 
 <p style="text-align:left;">systemctl status DmServiceDMSERVER.service</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>设置数据库开机自启，如下所示：</p></li></ul> 
 <p style="text-align:left;">systemctl enable DmServiceDMSERVER.service</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">7.放开防火墙端口</span></h3> 
 <hr> 
 <p style="text-align:null;">防火墙可能会在保护你的计算机免受来自网络的攻击和入侵的同时，阻止某些网络连接。因此，确保开放的端口是必要的，且端口和服务只应在必要时开放。</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>查看防火墙已经开放的端口，命令如下：</p></li></ul> 
 <p style="text-align:left;">firewall-cmd --list-ports</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>开放DM数据库端口，命令如下：</p></li></ul> 
 <p style="text-align:left;">firewall-cmd --zone=public --add-port=5236/tcp --permanent</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>重新加载防火墙配置，命令如下：</p></li></ul> 
 <p style="text-align:left;">firewall-cmd --reload</p> 
 <p style=""></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0681ed5e4a8c5a6d5389049d84e15c57/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">登录ETCD容器，在容器内查询etcd信息并删除ETCD节点</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/35cd96bdb728a39ed9b2c02563463bb7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">element ui 的滚动条,Element UI 文档中没有被提到的滚动条</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>