<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Dockerå­¦ä¹ ï¼ˆåäºŒï¼‰docker-composeæ„å»º - èœé¸Ÿç¨‹åºå‘˜åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Dockerå­¦ä¹ ï¼ˆåäºŒï¼‰docker-composeæ„å»º" />
<meta property="og:description" content="ç›®å½• 1.ç®€ä»‹2.å®‰è£…3.ä½¿ç”¨æ–¹æ³•4.å¸¸ç”¨å‘½ä»¤ 1.ç®€ä»‹ docker-composeï¼š Composeå¯è¯‘ä¸ºç»„åˆç‰©ï¼Œdocker-compose é€‚ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šä¸ªDockerå®¹å™¨çš„å·¥å…·ã€‚é€šè¿‡docker-composeï¼Œä½ å¯ä»¥ä½¿ç”¨YAMLæ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰æœåŠ¡ï¼Œç„¶åé€šè¿‡ä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚
docker-compose å°†æ‰€ç®¡ç†çš„å®¹å™¨åˆ†ä¸ºä¸‰å±‚ï¼Œåˆ†åˆ«æ˜¯ å·¥ç¨‹ï¼ˆprojectï¼‰ï¼ŒæœåŠ¡ï¼ˆserviceï¼‰ä»¥åŠå®¹å™¨ï¼ˆcontainerï¼‰ã€‚
2.å®‰è£… å®˜æ–¹å®‰è£…æ–‡æ¡£ï¼šhttps://docs.docker.com/compose/install/
# ä¸‹è½½ sudo curl -L &#34;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)&#34; -o /usr/local/bin/docker-compose # å¢åŠ æ‰§è¡Œæƒé™ sudo chmod &#43;x /usr/local/bin/docker-compose # æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ docker-compose --version 3.ä½¿ç”¨æ–¹æ³• ç›®å½•åˆ†å¸ƒ
|- docker |- ---- docker-compose.yml |- ---- eureka-server |- ---- ---- eureka-server.jar |- ---- ---- Dockerfile |- ---- any-gateway |- ---- ---- any-gateway.jar |- ---- ---- Dockerfile Dockerfileï¼š
FROM openjdk:8-jdk-alpine VOLUME /tmp ENV LANG en_US.UTF-8 ENV LANGUAGE en_US:en ENV LC_ALL en_US." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/195953eaa5f452a7bd9890bd8b32d941/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-23T11:24:54+08:00" />
<meta property="article:modified_time" content="2023-02-23T11:24:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="èœé¸Ÿç¨‹åºå‘˜åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">èœé¸Ÿç¨‹åºå‘˜åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Dockerå­¦ä¹ ï¼ˆåäºŒï¼‰docker-composeæ„å»º</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>ç›®å½•</h4> 
 <ul><li><ul><li><a href="#1_2" rel="nofollow">1.ç®€ä»‹</a></li><li><a href="#2_8" rel="nofollow">2.å®‰è£…</a></li><li><a href="#3_22" rel="nofollow">3.ä½¿ç”¨æ–¹æ³•</a></li><li><a href="#4_125" rel="nofollow">4.å¸¸ç”¨å‘½ä»¤</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="1_2"></a>1.ç®€ä»‹</h3> 
<blockquote> 
 <ul><li> <p><strong>docker-composeï¼š</strong> Composeå¯è¯‘ä¸ºç»„åˆç‰©ï¼Œdocker-compose é€‚ç”¨äº<code>å®šä¹‰å’Œè¿è¡Œå¤šä¸ªDockerå®¹å™¨çš„å·¥å…·</code>ã€‚é€šè¿‡docker-composeï¼Œä½ å¯ä»¥ä½¿ç”¨YAMLæ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰æœåŠ¡ï¼Œç„¶åé€šè¿‡ä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚</p> </li><li> <p>docker-compose å°†æ‰€ç®¡ç†çš„å®¹å™¨åˆ†ä¸ºä¸‰å±‚ï¼Œåˆ†åˆ«æ˜¯ <strong>å·¥ç¨‹ï¼ˆprojectï¼‰</strong>ï¼Œ<strong>æœåŠ¡ï¼ˆserviceï¼‰<strong>ä»¥åŠ</strong>å®¹å™¨ï¼ˆcontainerï¼‰</strong>ã€‚</p> </li></ul> 
</blockquote> 
<h3><a id="2_8"></a>2.å®‰è£…</h3> 
<p>å®˜æ–¹å®‰è£…æ–‡æ¡£ï¼š<a href="https://docs.docker.com/compose/install/" rel="nofollow">https://docs.docker.com/compose/install/</a></p> 
<pre><code class="prism language-shell"><span class="token comment"># ä¸‹è½½</span>
<span class="token function">sudo</span> <span class="token function">curl</span> <span class="token parameter variable">-L</span> <span class="token string">"https://github.com/docker/compose/releases/download/1.29.2/docker-compose-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> <span class="token parameter variable">-s</span><span class="token variable">)</span></span>-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> <span class="token parameter variable">-m</span><span class="token variable">)</span></span>"</span> <span class="token parameter variable">-o</span> /usr/local/bin/docker-compose
<span class="token comment"># å¢åŠ æ‰§è¡Œæƒé™</span>
<span class="token function">sudo</span> <span class="token function">chmod</span> +x /usr/local/bin/docker-compose

<span class="token comment"># æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</span>
<span class="token function">docker-compose</span> <span class="token parameter variable">--version</span>
</code></pre> 
<h3><a id="3_22"></a>3.ä½¿ç”¨æ–¹æ³•</h3> 
<p>ç›®å½•åˆ†å¸ƒ</p> 
<pre><code class="prism language-shell"><span class="token operator">|</span>- <span class="token function">docker</span>
<span class="token operator">|</span>- ---- docker-compose.yml
<span class="token operator">|</span>- ---- eureka-server
<span class="token operator">|</span>- ---- ---- eureka-server.jar
<span class="token operator">|</span>- ---- ---- Dockerfile
<span class="token operator">|</span>- ---- any-gateway
<span class="token operator">|</span>- ---- ---- any-gateway.jar
<span class="token operator">|</span>- ---- ---- Dockerfile
</code></pre> 
<p>Dockerfileï¼š</p> 
<pre><code class="prism language-dockerfile">FROM openjdk:8-jdk-alpine
VOLUME /tmp
ENV LANG en_US.UTF-8
ENV LANGUAGE en_US:en
ENV LC_ALL en_US.UTF-8
ADD eureka-server.jar app.jar
ENTRYPOINT [ "java", "-Djava.security.egd=file:/dev/./urandom", "-jar", "/app.jar" ]
</code></pre> 
<p>docker-compose.yml</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3"</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">eureka-server</span><span class="token punctuation">:</span>
    <span class="token comment"># æŒ‡å®šå®¹å™¨åç§°</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> myProject<span class="token punctuation">-</span>eureka<span class="token punctuation">-</span>server
    <span class="token comment"># æŒ‡å®šä¸»æœºå</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> myProject
    <span class="token comment"># æŒ‡å®šé•œåƒ</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> myProject/eureka<span class="token punctuation">-</span>server<span class="token punctuation">:</span>0.0.1
    <span class="token comment"># æŒ‡å®šå®¿ä¸»æ˜ å°„ç«¯å£</span>
    <span class="token comment">#ports:</span>
      <span class="token comment">#- "6002:6002"</span>
    <span class="token comment"># ç»‘å®šå®¿ä¸»æœºç½‘ç»œ</span>
    <span class="token comment"># network_mode: "host"</span>
    <span class="token comment"># æŒ‡å®šå®¹å™¨IP</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token key atrule">mynet</span><span class="token punctuation">:</span>
        <span class="token comment"># å®¿ä¸»æœºä¼šè‡ªåŠ¨é…ç½®ç½‘å…³IPï¼š172.20.1.1</span>
        <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 172.20.1.2
    <span class="token comment"># æŒ‡å®šæ„å»º</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span> ./eureka<span class="token punctuation">-</span>server
    <span class="token comment"># é‡å¯æœºåˆ¶</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token comment"># å¯ä»¥åˆ›å»ºäº¤äº’å¼ä¼šè¯</span>
    <span class="token key atrule">tty</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">any-gateway</span><span class="token punctuation">:</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> myProject<span class="token punctuation">-</span>gateway
    <span class="token key atrule">image</span><span class="token punctuation">:</span> myProject/gateway<span class="token punctuation">:</span>0.0.1
    <span class="token key atrule">build</span><span class="token punctuation">:</span> ./any<span class="token punctuation">-</span>gateway
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> eureka<span class="token punctuation">-</span>server
    <span class="token key atrule">network_mode</span><span class="token punctuation">:</span> <span class="token string">"service:eureka-server"</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">tty</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>

<span class="token key atrule">networks</span><span class="token punctuation">:</span>
  <span class="token key atrule">mynet</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge
    <span class="token key atrule">ipam</span><span class="token punctuation">:</span>
      <span class="token comment"># è¿™é‡Œä¸ç”¨é…ç½®driver</span>
      <span class="token comment"># driver: default</span>
      <span class="token key atrule">config</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">subnet</span><span class="token punctuation">:</span> <span class="token string">"172.20.1.0/24"</span>
</code></pre> 
<p>éƒ¨ç½²æ­¥éª¤ï¼šï¼ˆä»¥ eureka-server.jar ä¸ºä¾‹ï¼‰</p> 
<ol><li> <p>å°†jaråŒ…æ”¾åˆ° docker/eureka-server/ ä¸‹ï¼›</p> </li><li> <p>åœ¨ docker/eureka-server/ æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œæ„å»ºé•œåƒ</p> <pre><code class="prism language-shell">$ <span class="token function">docker</span> build <span class="token parameter variable">-t</span> my/eureka-server:0.0.1 <span class="token builtin class-name">.</span>
</code></pre> </li><li> <p>æŸ¥çœ‹æ„å»ºå¥½çš„é•œåƒï¼š</p> <pre><code class="prism language-shell">$ <span class="token function">docker</span> images <span class="token operator">|</span> <span class="token function">grep</span> eureka-server
</code></pre> </li><li> <p>åœ¨ docker/ æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œåˆ›å»ºå¹¶åå°è¿è¡Œå®¹å™¨ï¼š</p> <pre><code class="prism language-shell">$ <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span>
</code></pre> </li><li> <p>æŸ¥çœ‹è¿è¡Œçš„å®¹å™¨ï¼š</p> <pre><code class="prism language-shell">$ <span class="token function">docker-compose</span> <span class="token function">ps</span> <span class="token operator">|</span> <span class="token function">grep</span> eureka-server
</code></pre> </li></ol> 
<h3><a id="4_125"></a>4.å¸¸ç”¨å‘½ä»¤</h3> 
<pre><code class="prism language-shell"><span class="token comment"># åˆ›å»ºå¹¶åå°å¯åŠ¨æ‰€æœ‰å®¹å™¨ï¼ˆ-f æŒ‡å®šé…ç½®æ–‡ä»¶ï¼‰</span>
$ <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span>
<span class="token comment"># åˆ›å»ºå¹¶åå°å¯åŠ¨å®¹å™¨ï¼ˆé•œåƒä¸å­˜åœ¨è‡ªåŠ¨buildï¼‰</span>
$ <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span> <span class="token punctuation">[</span>æœåŠ¡å<span class="token punctuation">]</span>

<span class="token comment"># æŸ¥çœ‹å¯åŠ¨å®¹å™¨åˆ—è¡¨ï¼ˆ-a æŸ¥çœ‹å…¨éƒ¨å®¹å™¨åˆ—è¡¨ï¼‰</span>
$ <span class="token function">docker-compose</span> <span class="token function">ps</span>

<span class="token comment"># æŸ¥çœ‹æ—¥å¿—</span>
$ <span class="token function">docker-compose</span> logs <span class="token parameter variable">-f</span> <span class="token parameter variable">--tail</span><span class="token operator">=</span><span class="token number">20</span> <span class="token punctuation">[</span>æœåŠ¡å<span class="token punctuation">]</span>

<span class="token comment"># è¿›å…¥å®¹å™¨ä¸­</span>
$ <span class="token function">docker-compose</span> <span class="token builtin class-name">exec</span> <span class="token punctuation">[</span>æœåŠ¡å<span class="token punctuation">]</span> <span class="token function">bash</span>

<span class="token comment"># åœæ­¢å®¹å™¨</span>
$ <span class="token function">docker-compose</span> stop <span class="token punctuation">[</span>æœåŠ¡å<span class="token punctuation">]</span>
<span class="token comment"># åˆ é™¤å®¹å™¨</span>
$ <span class="token function">docker-compose</span> <span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token punctuation">[</span>æœåŠ¡å<span class="token punctuation">]</span>
<span class="token comment"># æ„å»ºé•œåƒ</span>
$ <span class="token function">docker-compose</span> build <span class="token punctuation">[</span>æœåŠ¡å<span class="token punctuation">]</span>
<span class="token comment"># åˆ›å»ºå¹¶åå°å¯åŠ¨å®¹å™¨ï¼ˆé•œåƒä¸å­˜åœ¨è‡ªåŠ¨buildï¼‰</span>
$ <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span> <span class="token punctuation">[</span>æœåŠ¡å<span class="token punctuation">]</span>

<span class="token comment"># æ„å»ºé•œåƒ</span>
$ <span class="token function">docker-compose</span> build <span class="token punctuation">[</span>æœåŠ¡å<span class="token punctuation">]</span>
<span class="token comment"># å¯åŠ¨å®¹å™¨</span>
$ <span class="token function">docker-compose</span> start <span class="token punctuation">[</span>æœåŠ¡å<span class="token punctuation">]</span>
<span class="token comment"># é‡å¯å®¹å™¨</span>
$ <span class="token function">docker-compose</span> restart <span class="token punctuation">[</span>æœåŠ¡å<span class="token punctuation">]</span>

<span class="token comment"># åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼ˆ--rmi all åˆ é™¤é•œåƒï¼‰</span>
$ <span class="token function">docker-compose</span> down
</code></pre> 
<br> 
<p>æ•´ç†å®Œæ¯•ï¼Œå®Œç»“æ’’èŠ±~ ğŸŒ»</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b23e4d30742f903cbf61cebba7678793/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">MongoDBåœ¨javaä»£ç ä¸­çš„å¢åˆ æ”¹æŸ¥</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b6bda7f06125d7401087fdf834def637/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">mysqlä¸­ show index from tablenameåæ¯åˆ—çš„å«ä¹‰</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 èœé¸Ÿç¨‹åºå‘˜åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>