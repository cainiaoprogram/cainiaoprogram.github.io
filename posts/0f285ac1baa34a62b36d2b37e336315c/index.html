<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java将数据存入excel中并保存本地 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java将数据存入excel中并保存本地" />
<meta property="og:description" content="java将数据存入excel中并保存本地 下面将由方法分开展示步骤，以及合并方法展示步骤两部分组成。
可直接观看第二部分合并后的方法即可，便于快速使用
1，分开方法展示步骤 分开方法展示java将数据存入excel中的步骤 //创建sheet页
public static void setSheet(String sheetName) {
workbook = new XSSFWorkbook();
sheet = workbook.createSheet(sheetName);
}
//创建表头
public static void createHead(List&lt;String&gt; headList) {
//创建表头，也就是第一行
row = sheet.createRow(0);
for (int i = 0; i &lt; headList.size(); i&#43;&#43;) {
cell = row.createCell(i);
cell.setCellValue(headList.get(i));
}
} //创建表内容
public static void createContent(List&lt;List&lt;String&gt;&gt; contentList) {
//创建表内容，从第二行开始
for (int i = 0; i &lt; contentList.size(); i&#43;&#43;) {
row = sheet.createRow(i &#43; 1);" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0f285ac1baa34a62b36d2b37e336315c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-30T09:36:38+08:00" />
<meta property="article:modified_time" content="2023-06-30T09:36:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java将数据存入excel中并保存本地</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>java将数据存入excel中并保存本地</h4> 
<blockquote> 
 <p>下面将由方法分开展示步骤，以及合并方法展示步骤两部分组成。<br> 可直接观看第二部分合并后的方法即可，便于快速使用</p> 
</blockquote> 
<h3>1，分开方法展示步骤</h3> 
<h4> 分开方法展示java将数据存入excel中的步骤</h4> 
<blockquote> 
 <p>  //创建sheet页<br>     public static void setSheet(String sheetName) {<!-- --><br>         workbook = new XSSFWorkbook();<br>         sheet = workbook.createSheet(sheetName);<br>     }</p> 
</blockquote> 
<blockquote> 
 <p> //创建表头<br>     public static void createHead(List&lt;String&gt; headList) {<!-- --><br>         //创建表头，也就是第一行<br>         row = sheet.createRow(0);<br>         for (int i = 0; i &lt; headList.size(); i++) {<!-- --><br>             cell = row.createCell(i);<br>             cell.setCellValue(headList.get(i));<br>         }<br>     } </p> 
</blockquote> 
<blockquote> 
 <p>  //创建表内容<br>     public static void createContent(List&lt;List&lt;String&gt;&gt; contentList) {<!-- --><br>         //创建表内容，从第二行开始<br>         for (int i = 0; i &lt; contentList.size(); i++) {<!-- --><br>             row = sheet.createRow(i + 1);<br>             for (int j = 0; j &lt; contentList.get(i).size(); j++) {<!-- --><br>                 row.createCell(j).setCellValue(contentList.get(i).get(j));<br>             }<br>         }<br>     }</p> 
</blockquote> 
<blockquote> 
 <p>  //写入文件<br>     public static void writeToFile(String filePath){<!-- --><br>         file = new File(filePath);<br>         //将文件保存到指定的位置</p> 
 <p>        try {<!-- --><br>             workbook.write(new FileOutputStream(file));<br>             System.out.println("写入文件成功");<br>             //workbook.close();<br>         } catch (IOException e) {<!-- --><br>             e.printStackTrace();<br>         }<br>     }</p> 
</blockquote> 
<blockquote> 
 <p>  // 内容测试数据<br>     protected static List&lt;List&lt;String&gt;&gt; getContent() {<!-- --><br>         List&lt;List&lt;String&gt;&gt; contentList = new ArrayList&lt;&gt;();<br>         List&lt;String&gt; content1 = new ArrayList&lt;&gt;();<br>         content1.add("张三");<br>         content1.add("18");<br>         List&lt;String&gt; content2 = new ArrayList&lt;&gt;();<br>         content2.add("李四");<br>         content2.add("20");<br>         contentList.add(content1);<br>         contentList.add(content2);<br>         return contentList;<br>     }</p> 
</blockquote> 
<blockquote> 
 <p>  public static void main(String[] args) {<!-- --><br>         //表头测试数据<br>         List&lt;String&gt; headList = new ArrayList&lt;&gt;();<br>         headList.add("昵称");<br>         headList.add("年龄");<br>         List&lt;List&lt;String&gt;&gt; contentList = getContent();//内容测试数据<br>         setSheet("WorkSheet");                        //创建sheet页<br>         createHead(headList);                         //设置表头<br>         createContent(contentList);                   //设置内容<br>         writeToFile("D://work.xls");         //写入文件<br>     }</p> 
</blockquote> 
<h3> 2，进行方法的合并</h3> 
<p>2.1 合并方法，将java将数据存入excel中</p> 
<blockquote> 
 <p>import org.apache.poi.xssf.usermodel.XSSFCell;<br> import org.apache.poi.xssf.usermodel.XSSFRow;<br> import org.apache.poi.xssf.usermodel.XSSFSheet;<br> import org.apache.poi.xssf.usermodel.XSSFWorkbook;</p> 
 <p>import java.io.File;<br> import java.io.FileOutputStream;<br> import java.io.IOException;<br> import java.util.List;</p> 
 <p>public class Export {<!-- --></p> 
 <p>    /*<br>     * sheetName：表名<br>     * heaaList:表头<br>     * contentList:表内容<br>     * filePath：写入文件地址<br>     * */<br>     public void exportToExcel(String sheetName, List&lt;String&gt; heaList, List&lt;List&lt;String&gt;&gt; contentList, String filePath){<!-- --><br>         //创建sheet页<br>         XSSFWorkbook workbook = new XSSFWorkbook();<br>         XSSFSheet sheet = workbook.createSheet(sheetName);<br>         //创建表头（第一行）<br>         XSSFRow row = sheet.createRow(0);<br>         for (int i = 0; i &lt; heaList.size() ; i++) {<!-- --><br>             XSSFCell cell = row.createCell(i);<br>             cell.setCellValue(heaList.get(i));</p> 
 <p>        }<br>         //创建表内容<br>         //List&lt;List&lt;String&gt;&gt;,一条内容存储多个列表对象<br>         for (int i = 0; i &lt;contentList.size() ; i++) {<!-- --><br>             row = sheet.createRow(i+1);<br>             for (int j = 0; j &lt; contentList.get(i).size(); j++) {<!-- --><br> //                row.createCell(j).setCellValue(contentList.get(i).get(j);<br>                 row.createCell(j).setCellValue(contentList.get(i).get(j));<br>             }</p> 
 <p>        }<br> //        for (int i = 0; i &lt; contentList.size(); i++) {<!-- --><br> //            row = sheet.createRow(i+1);<br> //            row.createCell(i).setCellValue(String.valueOf(contentList.get(i)));<br> //        }</p> 
 <p>        //写入文件<br>         File file = new File(filePath);<br>         try {<!-- --><br>             //将文件保存到指定位置<br>             workbook.write(new FileOutputStream(file));<br>             System.out.println("写入文件成功");<br>         } catch (IOException e) {<!-- --><br>             e.printStackTrace();<br>         }</p> 
 <p>    }</p> 
 <p>}</p> 
</blockquote> 
<p> 2.2 进行测试</p> 
<blockquote> 
 <p></p> 
 <p>package output.WriteToExcel;</p> 
 <p>import java.util.ArrayList;<br> import java.util.List;</p> 
 <p>public class test {<!-- --><br>     public static void main(String[] args) {<!-- --><br>         Export export =  new Export();</p> 
 <p><br>         /*<br>          * sheetName：表名<br>          * heaaList:表头<br>          * contentList:表内容<br>          * filePath：写入文件地址<br>          * */</p> 
 <p>        //表名：<br>         String biaoming = "测试表";<br>         //表头：<br>         List&lt;String&gt; biaotou = new ArrayList&lt;&gt;();<br>         biaotou.add("姓名");<br>         biaotou.add("年龄");<br>         biaotou.add("职业");<br>         //表数据：<br>         List&lt;List&lt;String&gt;&gt; contentList = new ArrayList&lt;&gt;();<br>         List&lt;String&gt; content1 = new ArrayList&lt;&gt;();<br>         content1.add("张三");<br>         content1.add("20");<br>         List&lt;String&gt; content2 = new ArrayList&lt;&gt;();<br>         content2.add("李四");<br>         content2.add("20");<br>         contentList.add(content1);<br>         contentList.add(content2);<br>         //写入文件路径<br>         String path = "D:\\work.xls";<br>         export.exportToExcel(biaoming,biaotou,contentList,path);<br>     }<br> }</p> 
</blockquote> 
<h3> 3.改版代码</h3> 
<h4> 3.1 改版方法</h4> 
<blockquote> 
 <pre>import org.apache.poi.xssf.usermodel.XSSFCell;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.List;

public class Export {

    /*
     * sheetName：表名
     * heaaList:表头
     * contentList:表内容
     * filePath：写入文件地址
     * */
    public void exportToExcel(String sheetName, List&lt;String&gt; heaList, List&lt;String&gt; contentList, String filePath){
        //创建sheet页
        XSSFWorkbook workbook = new XSSFWorkbook();
        XSSFSheet sheet = workbook.createSheet(sheetName);
        //创建表头（第一行）
        XSSFRow row = sheet.createRow(0);
        for (int i = 0; i &lt; heaList.size() ; i++) {
            XSSFCell cell = row.createCell(i);
            cell.setCellValue(heaList.get(i));
        }
        //创建表内容
        //List&lt;List&lt;String&gt;&gt;,一条内容存储多个列表对象
//        for (int i = 0; i &lt;contentList.size() ; i++) {
//            row = sheet.createRow(i+1);
//            for (int j = 0; j &lt; contentList.get(i).size(); j++) {
                row.createCell(j).setCellValue(contentList.get(i).get(j);
//                row.createCell(j).setCellValue(contentList.get(i).get(j));
//            }
//        }
        XSSFRow row1 = sheet.createRow(1);
        for (int i = 0; i &lt; contentList.size(); i++) {
            XSSFCell cell = row1.createCell(i);
            cell.setCellValue(contentList.get(i));
        }
        //写入文件
        File file = new File(filePath);
        try {
            //将文件保存到指定位置
            workbook.write(new FileOutputStream(file));
            System.out.println("写入文件成功");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
</pre> 
</blockquote> 
<h4> 3.2 改版方法测试</h4> 
<blockquote> 
 <pre>public static void main(String[] args) {
    String uuid = UUIDUtil.uuid();
    //表数据:
    String[] arr01 = {"张三","18","120"};
    List&lt;String&gt; list = Arrays.asList(arr01);
    //表名:
    String biaoming = "数据元管理表"+uuid.substring(0,4);
    //表头:
    String[] arr02 = {"姓名","年龄","成绩"};
    List&lt;String&gt; biaotou = Arrays.asList(arr02);
    //写入文件路径:
    String filePath = "C:\\upload\\export\\"+uuid+".xlsx";
    export.exportToExcel(biaoming,biaotou,list,filePath);
}</pre> 
</blockquote> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f39b92c41710f33bbd48f2cd7fd678ea/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用POI实现EXcel表格的读写</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a4d18b4efff7946b574d139c3a077c65/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">交通灯电路及verilog实现（状态机）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>