<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>OpenCV(Scale Invariant Feature Transform（SIFT))尺度不变特征变换 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="OpenCV(Scale Invariant Feature Transform（SIFT))尺度不变特征变换" />
<meta property="og:description" content=" 咋一看这个名字，我也蒙了，这啥玩意？
其实在介绍这个之前，就是如果我们很远看一幅图就大概知道是什么，在不同尺度下，计算机可以提取出一个统一的特征，这就是SIFT
图像尺度空间：
在一定的范围内，无论物体是大还是小，人眼都可以分辨出来，然而计算机要有相同的能力却很难，所以要让机器能够对物体在不同尺度下有一个统一的认知，就需要考虑图像在不同的尺度下都存在的特点。
尺度空间的获取通常使用高斯模糊来实现
不同σ的高斯函数决定了对图像的平滑程度，越大的σ值对应的图像越模糊。
多分辨率金字塔
高斯差分金字塔
DoG空间极值检测
为了寻找尺度空间的极值点，每个像素点要和其图像域（同一尺度空间）和尺度域（相邻的尺度空间）的所有相邻点进行比较，当其大于（或者小于）所有相邻点时，该点就是极值点。如下图所示，中间的检测点要和其所在图像的3×3邻域8个像素点，以及其相邻的上下两层的3×3领域18个像素点，共26个像素点进行比较。
关键点的精确定位
这些候选关键点是DOG空间的局部极值点，而且这些极值点均为离散的点，精确定位极值点的一种方法是，对尺度空间DoG函数进行曲线拟合，计算其极值点，从而实现关键点的精确定位。
消除边界响应
特征点的主方向
每个特征点可以得到三个信息(x,y,σ,θ)，即位置、尺度和方向。具有多个方向的关键点可以被复制成多份，然后将方向值分别赋给复制后的特征点，一个特征点就产生了多个坐标、尺度相等，但是方向不同的特征点。
生成特征描述
在完成关键点的梯度计算后，使用直方图统计邻域内像素的梯度和方向。
为了保证特征矢量的旋转不变性，要以特征点为中心，在附近邻域内将坐标轴旋转θ角度，即将坐标轴旋转为特征点的主方向。
旋转之后的主方向为中心取8x8的窗口，求每个像素的梯度幅值和方向，箭头方向代表梯度方向，长度代表梯度幅值，然后利用高斯窗口对其进行加权运算，最后在每个4x4的小块上绘制8个方向的梯度直方图，计算每个梯度方向的累加值，即可形成一个种子点，即每个特征的由4个种子点组成，每个种子点有8个方向的向量信息。
论文中建议对每个关键点使用4x4共16个种子点来描述，这样一个关键点就会产生128维的SIFT特征向量。
opencv SIFT函数
import cv2 import numpy as np img = cv2.imread(&#39;test_1.jpg&#39;) gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY) sift = cv2.xfeatures2d.SIFT_create() kp = sift.detect(gray, None) img = cv2.drawKeypoints(gray, kp, img) cv2.imshow(&#39;drawKeypoints&#39;, img) cv2.waitKey(0) cv2.destroyAllWindows() " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f396eacb4cf5791c4cf6f126829632a5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-09T22:15:05+08:00" />
<meta property="article:modified_time" content="2020-02-09T22:15:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">OpenCV(Scale Invariant Feature Transform（SIFT))尺度不变特征变换</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>咋一看这个名字，我也蒙了，这啥玩意？<br> 其实在介绍这个之前，就是如果我们很远看一幅图就大概知道是什么，<strong>在不同尺度下，计算机可以提取出一个统一的特征，这就是SIFT</strong><br> <strong>图像尺度空间：</strong><br> 在一定的范围内，无论物体是大还是小，人眼都可以分辨出来，然而计算机要有相同的能力却很难，所以要让机器能够对物体在不同尺度下有一个统一的认知，就需要考虑图像在不同的尺度下都存在的特点。<br> 尺度空间的获取通常使用高斯模糊来实现<br> <img src="https://images2.imgbox.com/92/41/6dDAJbGJ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/41/f8/LafQXUIZ_o.png" alt="在这里插入图片描述"><br> 不同σ的高斯函数决定了对图像的平滑程度，越大的σ值对应的图像越模糊。<br> <strong>多分辨率金字塔</strong><br> <img src="https://images2.imgbox.com/a9/87/XNW6hq8t_o.png" alt="在这里插入图片描述"><br> <strong>高斯差分金字塔</strong><br> <img src="https://images2.imgbox.com/96/86/mMo87K94_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f4/c6/AbyeQay5_o.png" alt="在这里插入图片描述"><br> <strong>DoG空间极值检测</strong><br> 为了寻找尺度空间的极值点，每个像素点要和其图像域（同一尺度空间）和尺度域（相邻的尺度空间）的所有相邻点进行比较，当其大于（或者小于）所有相邻点时，该点就是极值点。如下图所示，中间的检测点要和其所在图像的3×3邻域8个像素点，以及其相邻的上下两层的3×3领域18个像素点，共26个像素点进行比较。<br> <img src="https://images2.imgbox.com/0a/57/haStz3LC_o.png" alt="在这里插入图片描述"><br> <strong>关键点的精确定位</strong><br> 这些候选关键点是DOG空间的局部极值点，而且这些极值点均为离散的点，精确定位极值点的一种方法是，对尺度空间DoG函数进行曲线拟合，计算其极值点，从而实现关键点的精确定位。<br> <img src="https://images2.imgbox.com/6b/ff/tE2xqyLm_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/39/9e/Q05CYhuq_o.png" alt="在这里插入图片描述"><br> <strong>消除边界响应</strong><br> <img src="https://images2.imgbox.com/23/46/6NlnMp7A_o.png" alt="在这里插入图片描述"><br> <strong>特征点的主方向</strong><br> <img src="https://images2.imgbox.com/3b/5a/JC5wnpZK_o.png" alt="在这里插入图片描述"><br> 每个特征点可以得到三个信息(x,y,σ,θ)，即位置、尺度和方向。具有多个方向的关键点可以被复制成多份，然后将方向值分别赋给复制后的特征点，一个特征点就产生了多个坐标、尺度相等，但是方向不同的特征点。<br> <strong>生成特征描述</strong><br> 在完成关键点的梯度计算后，使用直方图统计邻域内像素的梯度和方向。<br> <img src="https://images2.imgbox.com/3f/a2/dDkPCVkU_o.png" alt="在这里插入图片描述"><br> 为了保证特征矢量的旋转不变性，要以特征点为中心，在附近邻域内将坐标轴旋转θ角度，即将坐标轴旋转为特征点的主方向。<br> <img src="https://images2.imgbox.com/f4/71/e0VBm5b4_o.png" alt="在这里插入图片描述"><br> 旋转之后的主方向为中心取8x8的窗口，求每个像素的梯度幅值和方向，箭头方向代表梯度方向，长度代表梯度幅值，然后利用高斯窗口对其进行加权运算，最后在每个4x4的小块上绘制8个方向的梯度直方图，计算每个梯度方向的累加值，即可形成一个种子点，即每个特征的由4个种子点组成，每个种子点有8个方向的向量信息。<br> <img src="https://images2.imgbox.com/cf/16/6TR3584k_o.png" alt="在这里插入图片描述"><br> 论文中建议对每个关键点使用4x4共16个种子点来描述，这样一个关键点就会产生128维的SIFT特征向量。<br> <img src="https://images2.imgbox.com/65/d2/J2MAAOQd_o.png" alt="在这里插入图片描述"><br> <strong>opencv SIFT函数</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'test_1.jpg'</span><span class="token punctuation">)</span>
gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>

sift <span class="token operator">=</span> cv2<span class="token punctuation">.</span>xfeatures2d<span class="token punctuation">.</span>SIFT_create<span class="token punctuation">(</span><span class="token punctuation">)</span>
kp <span class="token operator">=</span> sift<span class="token punctuation">.</span>detect<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>

img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>drawKeypoints<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> kp<span class="token punctuation">,</span> img<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'drawKeypoints'</span><span class="token punctuation">,</span> img<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/04/6d/3Api3tER_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/282ace8816cc025830d7801a7a0ff340/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在Idea中为项目添加Tomcat配置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/14f82422e1e8a8075d6b9bfd2a9f462f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【unity】标准资源包里的第一人称角色控制器FPSController在手机端旋转视图</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>