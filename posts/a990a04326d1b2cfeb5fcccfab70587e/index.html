<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Using Ldp.exe to Find Data in the Active Directory - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Using Ldp.exe to Find Data in the Active Directory" />
<meta property="og:description" content="Using Ldp.exe to Find Data in the Active Directory This article applies to Windows 2000. Support for Windows 2000 ends on July 13, 2010. The Windows 2000 End-of-Support Solution Center (http://support.microsoft.com/?scid=http%3a%2f%2fsupport.microsoft.com%2fwin2000) is a starting point for planning your migration strategy from Windows 2000. For more information see the Microsoft Support Lifecycle Policy (http://support.microsoft.com/lifecycle/) . NoticeThis article applies to Windows 2000. Support for Windows 2000 ends on July 13, 2010. The Windows 2000 End-of-Support Solution Center (http://support." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a990a04326d1b2cfeb5fcccfab70587e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-02T22:54:39+08:00" />
<meta property="article:modified_time" content="2019-07-02T22:54:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Using Ldp.exe to Find Data in the Active Directory</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <h2 class="title"><span style="font-size:14pt;">Using Ldp.exe to Find Data in the Active Directory</span></h2> 
 <div class="appliesToLink">
   This article applies to Windows 2000. 
  <strong>Support for Windows 2000 ends on July 13, 2010.</strong> The 
  <a href="http://www.cnblogs.com/?scid=http%3A%2F%2Fsupport.microsoft.com%2Fwin2000" rel="nofollow">Windows 2000 End-of-Support Solution Center</a> 
  <span class="pLink"> (http://support.microsoft.com/?scid=http%3a%2f%2fsupport.microsoft.com%2fwin2000) </span> 
  <span class="kb_space"></span>is a starting point for planning your migration strategy from Windows 2000. For more information see the 
  <a href="http://www.cnblogs.com/lifecycle/" rel="nofollow">Microsoft Support Lifecycle Policy</a> 
  <span class="pLink"> (http://support.microsoft.com/lifecycle/) </span> 
  <span class="kb_space"></span>. 
 </div> 
 <div class="notice"></div> 
 <div class="notice"> 
  <h6 id="tocHeadRef">Notice</h6>This article applies to Windows 2000. 
  <strong>Support for Windows 2000 ends on July 13, 2010.</strong> The 
  <a href="http://www.cnblogs.com/?scid=http%3A%2F%2Fsupport.microsoft.com%2Fwin2000" rel="nofollow">Windows 2000 End-of-Support Solution Center</a> 
  <span class="pLink"> (http://support.microsoft.com/?scid=http%3a%2f%2fsupport.microsoft.com%2fwin2000) </span> 
  <span class="kb_space"></span>is a starting point for planning your migration strategy from Windows 2000. For more information see the 
  <a href="http://www.cnblogs.com/lifecycle/" rel="nofollow">Microsoft Support Lifecycle Policy</a> 
  <span class="pLink"> (http://support.microsoft.com/lifecycle/) </span> 
  <span class="kb_space"></span>. 
 </div> 
 <div id="kb_section" class="section"> 
  <h3 class="subTitle kb_tabs_hover"> </h3> 
  <div class="sectionpreview_closed"> 
   <span style="font-size:14pt;">Ldp.exe is a Windows 2000 Support Tools utility you can use to perform Lightweig...</span> 
  </div> 
  <div style="margin-left:195px;" class="sbody">
    Ldp.exe is a Windows 2000 Support Tools utility you can use to perform Lightweight Directory Access Protocol (LDAP) searches against the Active Directory for specific information given search criteria. This also allows administrators to query data that would otherwise not be visible through the Administrative tools included in the product. All data that is returned in LDP queries, however, is subject to security permissions. 
   <br> 
   <br>If you have already determined the name of the attribute to be used in the search, refer to the section "Searching the Active Directory for Specific Information" below. Otherwise, you need to determine the name of the attribute that correlates to the data to be used as the search criteria. To determine this, first follow the procedures in the section "Determining the Name of the Attribute to be Used in the Search". 
   <div class="kb_tabs_toggle kb_tabs_toggle_open"></div> 
   <u><font color="#0066cc"></font></u> 
  </div> 
  <h3 class="subTitle"> </h3> 
  <div class="sectionpreview_closed">
    Determining the Name of the Attribute to Be Used in the Search Insert the Window... 
  </div> 
  <div style="margin-left:195px;" class="sbody"> 
   <h4>Determining the Name of the Attribute to Be Used in the Search</h4> 
   <ol><li>Insert the Windows 2000 CD-ROM and open the Windows 2000 Support Tools kit. From \support\tools, run Setup.exe. This installs the Support Tools kit, which in turn installs LDP. </li><li>On the <strong>Connection</strong> menu, click <strong>Connect</strong>.</li><li>Type in the server name of a domain controller in the enterprise, verify that the <strong>port</strong> setting is set to 389, click to clear the <strong>Connectionless</strong> check box, and then click <strong>OK</strong>. Once the connection is complete, server-specific data is displayed in the right pane.</li><li>On the <strong>Connection</strong> menu, click <strong>Bind</strong>. Type the user name, password, and domain name (in DNS format) in the appropriate boxes (you may need to select the <strong>Domain</strong> check box), and then click <strong>OK</strong>. If the binding is successful, you should receive a message similar to "Authenticated as dn:'YourUserID'" in the right pane.</li><li>On the <strong>Browse</strong> menu, click <strong>Search</strong>.</li><li>The <strong>Base DN</strong> is the starting point in the Active Directory hierarchy at which your search will begin. In the <strong>Base DN</strong> box, type 
     <div class="indent"> 
      <strong>CN=Schema,CN=Configuration,dc=<var>mydomain</var>,dc=<var>com</var></strong> 
     </div>replacing <var>mydomain</var> and <var>com</var> with the appropriate domain name. NOTE: the domain name for the Base DN when searching the Schema will always be for the root domain of the forest.</li><li>In the <strong>Filter</strong> box, type 
     <div class="indent"> 
      <strong>(adminDescription=*<var>yourtexthere</var>*)</strong> 
     </div>replacing <var>yourtexthere</var> with a keyword that might describe the attribute you are looking for.<br><br>Or, type 
     <div class="indent"> 
      <strong>(adminDisplayName=*<var>yourtexthere</var>*)</strong> 
     </div>replacing <var>yourtexthere</var> with a part of the name of the attribute as it is displayed in the administrative tools (e.g. entering "office" would return the attribute "physicalDeliveryOfficeName".)<br><br>Or, type 
     <div class="indent"> 
      <strong>(ldapDisplayName=*<var>yourtexthere</var>*)</strong> 
     </div>replacing <var>yourtexthere</var> with a part of the name of the attribute as used in LDAP queries, if you know it.</li><li>In the <strong>Scope</strong> frame, click <strong>Subtree.</strong></li><li>Click <strong>Options</strong>. In the <strong>Attributes</strong> box, type <strong>ldapDisplayName</strong>.</li><li>Accept all other defaults, click <strong>OK</strong> and then click <strong>Run</strong>. After the query completes, the Distinguished Name (DN) of the object(s) found and the value of the <strong>ldapDisplayName</strong> attribute (now used in turn to search for data) of each are displayed in the right pane.<br><br>For example, doing a search on any attributes that have the text "office" in the "adminDisplayName" would yield the following output: 
     <div class="indent">
       ***Searching... ldap_search_s(ld, "cn=schema,cn=configuration,dc=mydomain,dc=com", 2, "(adminDisplayName=*office*)", attrList, 0, &amp;msg) 
      <br>Result &lt;0&gt;: (null) 
      <br>Matched DNs: 
      <br>Getting 3 entries: 
      <br>&gt;&gt; Dn: CN=Phone-Office-Other,CN=Schema,CN=Configuration,DC=mydomain,DC=com 
      <br> 
      <div class="indent">
        1&gt; lDAPDisplayName: otherTelephone; 
      </div>&gt;&gt; Dn: CN=Physical-Delivery-Office-Name,CN=Schema,CN=Configuration,DC=mydomain,DC=com 
      <br> 
      <div class="indent">
        1&gt; lDAPDisplayName: physicalDeliveryOfficeName; 
      </div>&gt;&gt; Dn: CN=Post-Office-Box,CN=Schema,CN=Configuration,DC=mydomain,DC=com 
      <br> 
      <div class="indent">
        1&gt; lDAPDisplayName: postOfficeBox; 
      </div> 
     </div></li></ol> 
   <h4>Searching the Active Directory for Specific Information</h4>Once the attribute name has been determined, either specified in documentation or by using the procedure outlined above in the section "Determining the Name of the Attribute to be Used in the Search", you can use the following steps to find objects in the Active Directory that meet the criteria you are looking for. 
   <br> 
   <br>The name of the attribute (ldapDisplayName) is used in queries to determine which objects should be returned based on meeting criteria supplied by the user. 
   <br> 
   <br> 
   <ol><li>Run Ldp.exe from the Support\Reskit\Netmgmt\Dstool folder on the retail Windows 2000 CD-ROM.</li><li>On the <strong>Connection</strong> menu, click <strong>Connect</strong>.</li><li>Type in the server name of a domain controller in the enterprise, verify that the <strong>port</strong> setting is set to 389, click to clear the <strong>Connectionless</strong> check box, and then click <strong>OK</strong>. Once the connection is complete, server-specific data is displayed in the right pane.</li><li>On the <strong>Connection</strong> menu, click <strong>Bind</strong>. Type the user name, password, and domain name (in DNS format) in the appropriate boxes (you may need to select the <strong>Domain</strong> check box), and then click <strong>OK</strong>. If the binding is successful, you should receive a message similar to "Authenticated as dn:'YourUserID'" in the right pane.</li><li>On the <strong>Browse</strong> menu, click <strong>Search</strong>.</li><li>The <strong>Base DN</strong> is the starting point in the Active Directory hierarchy at which your search will begin. In the <strong>Base DN</strong> box, type 
     <div class="indent"> 
      <strong>dc=<var>mydomain</var>,dc=<var>com</var></strong> 
     </div>replacing <var>mydomain</var> and <var>com</var> with the appropriate domain name to search for objects such as users, computers, contacts, groups, file volumes, and printers.<br><br>Or, type 
     <div class="indent"> 
      <strong>CN=Configuration,dc=<var>mydomain</var>,dc=<var>com</var></strong> 
     </div>replacing <var>mydomain</var> and <var>com</var> with the appropriate domain name to search the Configuration partition of the Active Directory which includes such objects such as Sites, Subnets, Site Links, Site Link Bridges, and Forest structure.<br><br>Or, type 
     <div class="indent"> 
      <strong>CN=Schema,CN=Configuration,dc=<var>mydomain</var>,dc=<var>com</var></strong> 
     </div>replacing <var>mydomain</var> and <var>com</var> with the appropriate domain name to search the Schema partition of the Active Directory which includes the classes and attributes defined for the Forest of which the domain controller is a member.<br><br></li><li>In the <strong>Filter</strong> box, type 
     <div class="indent"> 
      <strong>(<var>AttributeName</var>=*<var>yourtexthere</var>*)</strong> 
     </div>replacing <var>AttributeName</var> with the name of the attribute (as defined by ldapDisplayName) and replacing <var>yourtexthere</var> with the search criteria such as in the following examples:<br> 
     <div class="indent">
       (physicalDeliveryOfficeName=*Seattle*) 
     </div>Or,<br> 
     <div class="indent">
       (badPwdCount=1) 
     </div></li><li>In the <strong>Scope</strong> frame, click <strong>Subtree.</strong></li><li>Click <strong>Options</strong>. In the <strong>Attributes</strong> box, type the name of each of the attributes that should be displayed for each object found that meets the specified criteria separated by semicolons.<br><br>For example, by requesting that all objects (users intended in this example) whose "physicalDeliveryOfficename" contains "Seattle", display the User Profile Path and Logon Script path of each of the users (or other object types) found. The following would be entered in the Attributes box:<br> 
     <div class="indent">
       profilePath;scriptPath 
     </div></li><li>Accept all other defaults, click <strong>OK</strong> and then click <strong>Run</strong>. After the query completes, the Distinguished Name (DN) of the object(s) found and the value of the each of the attributes specified are displayed in the right pane.<br><br>An example of the output would be as follows: 
     <div class="indent">
       ***Searching... 
      <br>ldap_search_s(ld, "dc=mydomain,dc=com", 2, "(physicalDeliveryOfficeName=*Seattle*)", attrList, 0, &amp;msg) 
      <br>Result &lt;0&gt;: (null) 
      <br>Matched DNs: 
      <br>Getting 2 entries: 
      <br>&gt;&gt; Dn: CN=user1,CN=Users,DC=mydomain,DC=com 
      <br> 
      <div class="indent">
        1&gt; profilePath: \\w2k-dc-01\profiles\user1; 
       <br>1&gt; scriptPath: users.vbs; 
      </div>&gt;&gt; Dn: CN=user2,CN=Users,DC=mydomain,DC=com 
      <br> 
      <div class="indent">
        1&gt; profilePath: \\w2k-dc-01\profiles\user2; 
       <br>1&gt; scriptPath: users.vbs; 
      </div> 
     </div></li></ol> 
  </div> 
 </div> 
</div> 
<p>转载于:https://www.cnblogs.com/kungfupanda/archive/2011/11/29/2267730.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e66a31970b04ac960e62f0970ec02787/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ubuntu上架设PPPoE Server</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/917ec123ee4ff7dec02a0a8530d52f51/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux性能监测：磁盘IO篇</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>