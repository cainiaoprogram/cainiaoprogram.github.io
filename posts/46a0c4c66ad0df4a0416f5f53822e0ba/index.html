<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【本科生通信原理】【实验报告】【北京航空航天大学】实验一：通信原理初步 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【本科生通信原理】【实验报告】【北京航空航天大学】实验一：通信原理初步" />
<meta property="og:description" content="一、实验目的：
熟悉 MATLAB开发环境、掌握 MATLAB基本运算操作；熟悉和了解 MATLAB图形绘制基本指令；熟悉使用 MATLAB分析信号频谱的过程；掌握加性白高斯噪声信道模型 二、实验内容：
三、实验程序：
1、
function q1() x = 0 : 0.0001 : 2 * pi; y1 = 2 * exp(-0.5 * x); y2 = cos(4 * pi * x); figure; plot(x, y1); hold; plot(x, y2); xlabel(&#34;x&#34;, &#34;FontName&#34;, &#34;Times New Roman&#34;, &#34;FontSize&#34;, 12); ylabel(&#34;y&#34;, &#34;FontName&#34;, &#34;Times New Roman&#34;, &#34;FontSize&#34;, 12); legend(&#34;FontName&#34;,&#34;Times New Roman&#34;, &#34;FontSize&#34;, 10, &#34;LineWidth&#34;, 1.5); legend(&#34;y1&#34;, &#34;y2&#34;); title(&#34;q1&#34;); axis([0 2 * pi -1.1 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/46a0c4c66ad0df4a0416f5f53822e0ba/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T12:45:08+08:00" />
<meta property="article:modified_time" content="2024-01-05T12:45:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【本科生通信原理】【实验报告】【北京航空航天大学】实验一：通信原理初步</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>一、实验目的：</p> 
<ol><li>熟悉 MATLAB开发环境、掌握 MATLAB基本运算操作；</li><li>熟悉和了解 MATLAB图形绘制基本指令；</li><li>熟悉使用 MATLAB分析信号频谱的过程；</li><li>掌握加性白高斯噪声信道模型</li></ol> 
<p>二、实验内容：</p> 
<p><img src="https://images2.imgbox.com/14/29/VPu1h6L4_o.png" alt="在这里插入图片描述"></p> 
<p>三、实验程序：<br> 1、</p> 
<pre><code class="prism language-matlab"><span class="token keyword">function</span> <span class="token function">q1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">0.0001</span> <span class="token operator">:</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token keyword">pi</span><span class="token punctuation">;</span>
y1 <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.5</span> <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
y2 <span class="token operator">=</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
figure<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y1<span class="token punctuation">)</span><span class="token punctuation">;</span>
hold<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span>"x"<span class="token punctuation">,</span> "FontName"<span class="token punctuation">,</span> "Times New Roman"<span class="token punctuation">,</span> "FontSize"<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span>"y"<span class="token punctuation">,</span> "FontName"<span class="token punctuation">,</span> "Times New Roman"<span class="token punctuation">,</span> "FontSize"<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span>"FontName"<span class="token punctuation">,</span>"Times New Roman"<span class="token punctuation">,</span> "FontSize"<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> "LineWidth"<span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span>"y1"<span class="token punctuation">,</span> "y2"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>"q1"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">axis</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">-</span><span class="token number">1.1</span> <span class="token number">2.1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
grid<span class="token punctuation">;</span>
</code></pre> 
<p>2、</p> 
<pre><code class="prism language-matlab"><span class="token keyword">function</span> <span class="token function">q2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">0.01</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">;</span>  <span class="token comment">% 横坐标区间</span>
R <span class="token operator">=</span> <span class="token function">normrnd</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">% 生成1 * length(x)个正态随机数</span>
 
figure<span class="token punctuation">;</span>  <span class="token comment">% 画信号波形</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">;</span>
grid on<span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'White Gaussian Noise'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'N'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
figure<span class="token punctuation">;</span>  <span class="token comment">% 画序列柱状图</span>
<span class="token function">bar</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span>
grid on<span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'Bar Graph of Noise Sequence'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'N'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>3、</p> 
<pre><code class="prism language-matlab"><span class="token keyword">function</span> <span class="token function">q3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
N <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">;</span>  <span class="token comment">%采样点数</span>
ts <span class="token operator">=</span> <span class="token number">0.6</span> <span class="token operator">/</span> <span class="token number">1023</span><span class="token punctuation">;</span>  <span class="token comment">%系统时域采样间隔</span>
fs <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> ts<span class="token punctuation">;</span>  <span class="token comment">%系统采样频率</span>
df <span class="token operator">=</span> <span class="token number">0.001</span><span class="token punctuation">;</span>  <span class="token comment">%所需的频率分辨率</span>
t <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">:</span> ts<span class="token operator">:</span> <span class="token number">0.6</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> <span class="token number">0.4</span> <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">*</span> t<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.4</span> <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">640</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">*</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
n <span class="token operator">=</span> <span class="token function">randn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">% 噪声信号（噪声方差为1）</span>
y <span class="token operator">=</span> x <span class="token operator">+</span> n<span class="token punctuation">;</span>  <span class="token comment">% 原始信号叠加噪声信号</span>
<span class="token punctuation">[</span>Y<span class="token punctuation">,</span> m<span class="token punctuation">,</span> df1<span class="token punctuation">,</span> f<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">T2F</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> ts<span class="token punctuation">,</span> df<span class="token punctuation">,</span> fs<span class="token punctuation">)</span><span class="token punctuation">;</span>

figure<span class="token punctuation">;</span>  <span class="token comment">% 画信号时域波形图</span>
<span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
grid on<span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'信号时域波形图'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'t/s'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'y(t)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
figure<span class="token punctuation">;</span>  <span class="token comment">% 画信号频谱图</span>
<span class="token function">plot</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token function">abs</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
grid on<span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'信号频谱图'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Y(w)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>4、</p> 
<pre><code class="prism language-matlab"><span class="token keyword">function</span> <span class="token function">q4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">% AM调制解调</span>
echo on<span class="token punctuation">;</span>
N <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">;</span>  <span class="token comment">% 采样点数</span>
A <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>  <span class="token comment">% 直流分量</span>
fc <span class="token operator">=</span> <span class="token number">125</span><span class="token punctuation">;</span>  <span class="token comment">%载波频率</span>
t0 <span class="token operator">=</span> <span class="token number">0.6</span><span class="token punctuation">;</span>  <span class="token comment">%信号持续时间</span>
snr <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  <span class="token comment">%解调器输入信噪比dB</span>
dt <span class="token operator">=</span> <span class="token number">0.6</span> <span class="token operator">/</span> <span class="token number">1023</span><span class="token punctuation">;</span>  <span class="token comment">%系统时域采样间隔</span>
fs <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> dt<span class="token punctuation">;</span>  <span class="token comment">%系统采样频率</span>
df <span class="token operator">=</span> <span class="token number">0.001</span><span class="token punctuation">;</span>  <span class="token comment">%所需的频率分辨率</span>
t <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">:</span> dt <span class="token operator">:</span> t0<span class="token punctuation">;</span>
m <span class="token operator">=</span> <span class="token number">0.1</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">15</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">*</span> t<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1.5</span> <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">25</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">*</span> t<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">40</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">*</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%调制信号</span>
c <span class="token operator">=</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">250</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">*</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%载波</span>
Lt <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%仿真过程中，信号长度</span>
snr_lin <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">^</span> <span class="token punctuation">(</span>snr <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%信噪比</span>
L <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token function">min</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
R <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> A<span class="token punctuation">;</span>
<span class="token punctuation">[</span>M<span class="token punctuation">,</span> m<span class="token punctuation">,</span> df1<span class="token punctuation">,</span> f<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">T2F</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> df<span class="token punctuation">,</span> fs<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%求出调制信号频谱</span>
<span class="token punctuation">[</span>Bw_eq<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">signalband</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span> df<span class="token punctuation">,</span> t0<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%求出信号等效带宽</span>
u <span class="token operator">=</span> <span class="token punctuation">(</span>A <span class="token operator">+</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">:</span> Lt<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.*</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">:</span> Lt<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">% 已调信号</span>
<span class="token punctuation">[</span>U<span class="token punctuation">,</span> u<span class="token punctuation">,</span> df1<span class="token punctuation">,</span> f<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">T2F</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> df<span class="token punctuation">,</span> fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
signal_power <span class="token operator">=</span> <span class="token function">power_x</span><span class="token punctuation">(</span><span class="token function">u</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">:</span> Lt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%已调信号的平均功率</span>
noise_power <span class="token operator">=</span> <span class="token punctuation">(</span>signal_power <span class="token operator">*</span> fs<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>snr_lin <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> Bw_eq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%求出噪声方差（噪声均值为0）</span>
noise_std <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>noise_power<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%噪声标准差</span>
noise <span class="token operator">=</span> noise_std <span class="token operator">*</span> <span class="token function">randn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> Lt<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%产生噪声</span>
sam <span class="token operator">=</span> <span class="token function">u</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">:</span> Lt<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">noise</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">:</span> Lt<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%叠加了噪声的已调信号</span>
<span class="token punctuation">[</span>SAM<span class="token punctuation">,</span> sam<span class="token punctuation">,</span> df1<span class="token punctuation">,</span> f<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">T2F</span><span class="token punctuation">(</span>sam<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> df<span class="token punctuation">,</span> fs<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%求出叠加了噪声的已调信号频谱</span>
 
figure<span class="token punctuation">;</span>  <span class="token comment">% 画出经过信道前的已调信号时域波形</span>
<span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token function">u</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token function">length</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
grid on<span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'经过AWGN信道前的已调信号的时域波形图'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'u(t)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
figure<span class="token punctuation">;</span>  <span class="token comment">%画出经过信道前的已调信号频谱图</span>
<span class="token function">plot</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>U<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
grid on<span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'经过AWGN信道前的已调信号的频谱图'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'U(w)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
figure<span class="token punctuation">;</span>  <span class="token comment">%画出经过信道后的已调信号时域波形</span>
<span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token function">sam</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token function">length</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">axis</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span> t0 <span class="token operator">-</span><span class="token number">20</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
grid on<span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'经过AWGN信道后的已调信号的时域波形图'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'s(t)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
figure<span class="token punctuation">;</span>  <span class="token comment">%画出经过信道后的已调信号频谱图</span>
<span class="token function">plot</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>SAM<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
grid on<span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'经过AWGN信道后的已调信号的时域波形图'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'S(w)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>四、实验结果：<br> 1、<br> <img src="https://images2.imgbox.com/8b/db/egr32w6w_o.png" alt="在这里插入图片描述"></p> 
<p>2、<br> （1）、信号波形：<br> <img src="https://images2.imgbox.com/d8/15/4KXYyy98_o.png" alt="在这里插入图片描述"></p> 
<p>（2）、序列柱状图：<br> <img src="https://images2.imgbox.com/54/73/8Y2MzMcj_o.png" alt="在这里插入图片描述"></p> 
<p>3、<br> （1）、所得信号的时域波形图：<br> <img src="https://images2.imgbox.com/21/fa/wnfQ6kVb_o.png" alt="在这里插入图片描述"></p> 
<p>（2）、所得信号的频谱图：<br> <img src="https://images2.imgbox.com/d6/d5/X4GfeY8g_o.png" alt="在这里插入图片描述"></p> 
<p>4、<br> （1）、经过AWGN信道前的已调信号的时域波形图：<br> <img src="https://images2.imgbox.com/58/f7/1P9YRHBm_o.png" alt="在这里插入图片描述"></p> 
<p>（2）、经过AWGN信道前的已调信号的频谱：<br> <img src="https://images2.imgbox.com/a0/e1/gYkx4y6h_o.png" alt="在这里插入图片描述"></p> 
<p>（3）、经过AWGN信道后的已调信号的时域波形图：<br> <img src="https://images2.imgbox.com/fa/37/dG7nvi89_o.png" alt="在这里插入图片描述"></p> 
<p>（4）、经过AWGN信道后的已调信号的频谱图：<br> <img src="https://images2.imgbox.com/cd/30/lXcnHhzT_o.png" alt="在这里插入图片描述"></p> 
<p>五、实验分析：<br> 1、求离散时间信号傅里叶变换：</p> 
<pre><code class="prism language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>f<span class="token punctuation">,</span> sf<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">F</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> st<span class="token punctuation">)</span>
<span class="token comment">%利用fft,fftshift定义函数F计算信号的傅里叶变换</span>
<span class="token comment">%t-离散时间</span>
<span class="token comment">%st-离散信号</span>
dt <span class="token operator">=</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%时间分辨率</span>
T <span class="token operator">=</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
df <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> T<span class="token punctuation">;</span> <span class="token comment">%频率分辨率</span>
N <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%离散傅里叶变换长度</span>
f <span class="token operator">=</span> <span class="token operator">-</span>N <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> df <span class="token operator">:</span> df <span class="token operator">:</span> N <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> df <span class="token operator">-</span> df<span class="token punctuation">;</span>
sf <span class="token operator">=</span> <span class="token function">fft</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
sf <span class="token operator">=</span> T <span class="token operator">/</span> N <span class="token operator">*</span> <span class="token function">fftshift</span><span class="token punctuation">(</span>sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>2、求信号平均功率：</p> 
<pre><code class="prism language-matlab"><span class="token keyword">function</span> p <span class="token operator">=</span> <span class="token function">power_x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment">%x:输入信号</span>
<span class="token comment">%p:返回信号的x功率</span>
p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">norm</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">.^</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">./</span> <span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>3、求信号等效带宽：</p> 
<pre><code class="prism language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>Bw_eq<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">signalband</span><span class="token punctuation">(</span>sf<span class="token punctuation">,</span> df<span class="token punctuation">,</span> T<span class="token punctuation">)</span>
<span class="token comment">%计算信号等效带宽</span>
<span class="token comment">%sf:信号频谱</span>
<span class="token comment">%df:频谱分辨率</span>
<span class="token comment">%T:信号持续时间</span>
sf_max <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>sf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Bw_eq <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>sf<span class="token punctuation">)</span> <span class="token operator">.^</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> df <span class="token operator">/</span> T <span class="token operator">/</span> sf_max <span class="token operator">.^</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> 
<p>4、序列的傅里叶变换</p> 
<pre><code class="prism language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>M<span class="token punctuation">,</span> m<span class="token punctuation">,</span> df<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fftseq</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> ts<span class="token punctuation">,</span> df<span class="token punctuation">)</span>
 
fs <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> ts<span class="token punctuation">;</span>
<span class="token keyword">if</span> nargin <span class="token operator">==</span> <span class="token number">2</span>
    n1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">else</span>
    n1 <span class="token operator">=</span> fs <span class="token operator">/</span> df<span class="token punctuation">;</span>
<span class="token keyword">end</span>
n2 <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
n <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">nextpow2</span><span class="token punctuation">(</span>n1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">nextpow2</span><span class="token punctuation">(</span>n2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
M <span class="token operator">=</span> <span class="token function">fft</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
m <span class="token operator">=</span> <span class="token punctuation">[</span>m<span class="token punctuation">,</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">-</span> n2<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
df <span class="token operator">=</span> fs <span class="token operator">/</span> n<span class="token punctuation">;</span>
</code></pre> 
<p>5、信号从时域转换到频域</p> 
<pre><code class="prism language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>M<span class="token punctuation">,</span> m<span class="token punctuation">,</span> df1<span class="token punctuation">,</span> f<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">T2F</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> ts<span class="token punctuation">,</span> df<span class="token punctuation">,</span> fs<span class="token punctuation">)</span>
<span class="token comment">%-----------------输入参数</span>
<span class="token comment">%m: 信号</span>
<span class="token comment">%ts: 系统时域采样间隔</span>
<span class="token comment">%df: 所需的频率分辨率</span>
<span class="token comment">%fs: 系统采样频率</span>
 
<span class="token comment">%-----------------输出参数</span>
<span class="token comment">%M: 傅里叶变换后的频谱序列</span>
<span class="token comment">%m: 输入信号参与过傅里叶变换后对应的序列，补零后的输入信号，长度与M，f相同</span>
<span class="token comment">%df1: 返回的频率分辨率</span>
<span class="token comment">%f: 与M相对应的频率序列</span>
<span class="token punctuation">[</span>M<span class="token punctuation">,</span> m<span class="token punctuation">,</span> df1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fftseq</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> ts<span class="token punctuation">,</span> df<span class="token punctuation">)</span><span class="token punctuation">;</span>
f <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">:</span> df1 <span class="token operator">:</span> df1 <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> fs <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>  <span class="token comment">%频率向量</span>
M <span class="token operator">=</span> M <span class="token operator">/</span> fs<span class="token punctuation">;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/52b2cce4fbb6925cb900ccfd184bb1ba/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Codeforces Round 911 C. Anji‘s Binary Tree</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c06c2b83d51eb6b0980e3cc2a5e95def/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">IOS：Safari无法播放MP4（H.264编码）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>