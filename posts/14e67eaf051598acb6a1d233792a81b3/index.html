<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>数据分析新手必读！Python Pandas 分组和聚合操作详解 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="数据分析新手必读！Python Pandas 分组和聚合操作详解" />
<meta property="og:description" content="1.引言 在数据分析和数据科学领域，数据聚合和分组是非常常见的操作。它提供了大量的功能，用于读取，清洗和处理各种类型的数据。Pandas是一个流行的Python库，提供了丰富的数据分析和处理功能。本文将介绍如何使用Pandas进行数据分组和聚合，包括分组操作和聚合函数的使用，以及使用transform和apply方法进行数据变换。
2.分组操作基础讲解 Pandas的groupby方法是数据分组和聚合的核心。groupby方法可以对数据进行分组，并在每个组上应用聚合函数。下面是一个示例代码：
import pandas as pd df = pd.read\_csv(&#39;data.csv&#39;) grouped = df.groupby(&#39;column\_name&#39;) 上面的代码将数据框按照“column_name”列进行分组，并将结果保存在grouped对象中。现在，我们可以在每个组上应用聚合函数。
2.1聚合函数 Pandas提供了各种聚合函数，如mean，sum，max和min等。这些函数可以应用于groupby对象中的每个组。下面是一些常用的聚合函数：
grouped.mean() # 每个组的平均值 grouped.sum() # 每个组的总和 grouped.max() # 每个组的最大值 grouped.min() # 每个组的最小值 2.2使用transform进行数据变换 transform方法可以**在每个组上应用一个函数，并将结果广播回原始数据框中的每个元素。**这个函数必须返回与原始数据框具有相同大小的对象。下面是一个示例代码：
import pandas as pd df = pd.read\_csv(&#39;data.csv&#39;) grouped = df.groupby(&#39;column\_name&#39;) mean\_values = grouped.transform(lambda x: x.mean()) 上面的代码将数据框按照“column_name”列进行分组，并在每个组上应用mean函数。然后，mean函数的结果被广播回原始数据框中的每个元素。
2.3使用apply进行数据变换 apply方法可以在每个组上应用一个函数，并将结果作为新的数据框返回。这个函数可以返回任何大小的对象。下面是一个示例代码：
import pandas as pd df = pd.read\_csv(&#39;data.csv&#39;) grouped = df.groupby(&#39;column\_name&#39;) result = grouped.apply(lambda x: x &#43; 1) 上面的代码将数据框按照“column_name”列进行分组，并在每个组上应用一个函数。
3.具体例子、实例演示 当然，以下是一些使用Pandas进行数据分组和聚合的更具体的例子。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/14e67eaf051598acb6a1d233792a81b3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-06T22:07:23+08:00" />
<meta property="article:modified_time" content="2024-01-06T22:07:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">数据分析新手必读！Python Pandas 分组和聚合操作详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1_0"></a>1.引言</h2> 
<p>在数据分析和数据科学领域，数据聚合和分组是非常常见的操作。它提供了大量的功能，用于读取，清洗和处理各种类型的数据。Pandas是一个流行的Python库，提供了丰富的数据分析和处理功能。本文将介绍如何使用Pandas进行数据分组和聚合，包括分组操作和聚合函数的使用，以及使用transform和apply方法进行数据变换。</p> 
<h2><a id="2_5"></a><strong>2.分组操作基础讲解</strong></h2> 
<p>Pandas的groupby方法是数据分组和聚合的核心。groupby方法可以对数据进行分组，并在每个组上应用聚合函数。下面是一个示例代码：</p> 
<pre><code class="prism language-python">  <span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  
  df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read\_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">)</span>  
  grouped <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'column\_name'</span><span class="token punctuation">)</span>
</code></pre> 
<p>上面的代码将数据框按照“column_name”列进行分组，并将结果保存在grouped对象中。现在，我们可以在每个组上应用聚合函数。</p> 
<h2><a id="21_18"></a>2.1聚合函数</h2> 
<p>Pandas提供了各种聚合函数，如mean，sum，max和min等。这些函数可以应用于groupby对象中的每个组。下面是一些常用的聚合函数：</p> 
<pre><code class="prism language-python">  grouped<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 每个组的平均值  </span>
  grouped<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># 每个组的总和  </span>
  grouped<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># 每个组的最大值  </span>
  grouped<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># 每个组的最小值</span>
</code></pre> 
<h2><a id="22transform_30"></a>2.2使用transform进行数据变换</h2> 
<p>transform方法可以**在每个组上应用一个函数，并将结果广播回原始数据框中的每个元素。**这个函数必须返回与原始数据框具有相同大小的对象。下面是一个示例代码：</p> 
<pre><code class="prism language-python">  <span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  
  df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read\_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">)</span>  
  grouped <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'column\_name'</span><span class="token punctuation">)</span>  
  mean\_values <span class="token operator">=</span> grouped<span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>上面的代码将数据框按照“column_name”列进行分组，并在每个组上应用mean函数。然后，mean函数的结果被广播回原始数据框中的每个元素。</p> 
<h2><a id="23apply_44"></a><strong>2.3使用apply进行数据变换</strong></h2> 
<p>apply方法可以在每个组上应用一个函数，并将结果作为新的数据框返回。这个函数可以返回任何大小的对象。下面是一个示例代码：</p> 
<pre><code class="prism language-python">  <span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  
  df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read\_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">)</span>  
  grouped <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'column\_name'</span><span class="token punctuation">)</span>  
  result <span class="token operator">=</span> grouped<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>上面的代码将数据框按照“column_name”列进行分组，并在每个组上应用一个函数。</p> 
<h2><a id="3_58"></a>3.具体例子、实例演示</h2> 
<p>当然，以下是一些使用Pandas进行数据分组和聚合的更具体的例子。</p> 
<h3><a id="31__63"></a>3.1 对电影评分数据进行分组和聚合</h3> 
<p>考虑以下电影评分数据，其中包括用户ID，电影ID和评分。</p> 
<pre><code class="prism language-python">  <span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  
  \# 创建一个dataframe  
  data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'user\_id'</span><span class="token punctuation">:</span> \<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span>  
         <span class="token string">'movie\_id'</span><span class="token punctuation">:</span> \<span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">104</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span>  
         <span class="token string">'rating'</span><span class="token punctuation">:</span> \<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span>  
         <span class="token string">'rating2'</span><span class="token punctuation">:</span> \<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span>\<span class="token punctuation">]</span><span class="token punctuation">}</span>  
  df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre> 
<p>如上，这三个变量在示例中用于描述电影评分数据的结构。<code>user_id</code> 列表示哪个用户给电影打了分，<code>movie_id</code> 列表示哪部电影被打了分，<code>rating</code> 列则表示这个用户对这个电影的评分。通过这三个变量，我们可以对电影评分数据进行分组和聚合。<strong>例如，我们可以按照 <code>movie_id</code> 列对数据进行分组，然后计算我们可以使用groupby方法将数据按电影ID分组，并对每个组应用mean函数以计算每部电影的平均评分。</strong></p> 
<pre><code class="prism language-python">  grouped <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'movie\_id'</span><span class="token punctuation">)</span>  
  mean\_ratings <span class="token operator">=</span> grouped<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  
  <span class="token keyword">print</span><span class="token punctuation">(</span>mean\_ratings<span class="token punctuation">)</span>
</code></pre> 
<p>输出：<img src="https://images2.imgbox.com/b3/e6/Q1z5Ysx9_o.png" alt=""></p> 
<p><strong>对于user_id的值，在第二个例子中会好好进行理解。</strong> 查看具体的分组情况如下所示。主要调用grouped.group属性。</p> 
<p><img src="https://images2.imgbox.com/b4/7b/KguLgHST_o.png" alt=""></p> 
<h3><a id="32_transform_92"></a>3.2 使用transform进行分组和聚合</h3> 
<p>我们可以使用transform方法在每个电影ID分组上应用一个函数，并将结果广播回原始数据框中的每个元素。下面是一个示例代码：</p> 
<pre><code class="prism language-python">  <span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  
    
  data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'user\_id'</span><span class="token punctuation">:</span> \<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span>  
         <span class="token string">'movie\_id'</span><span class="token punctuation">:</span> \<span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">104</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span>  
         <span class="token string">'rating'</span><span class="token punctuation">:</span> \<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span>\<span class="token punctuation">]</span><span class="token punctuation">}</span>  
  df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>  
  df  
  grouped <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'movie\_id'</span><span class="token punctuation">)</span>  
  grouped<span class="token punctuation">.</span>groups  
  mean\_ratings <span class="token operator">=</span> grouped<span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
  <span class="token keyword">print</span><span class="token punctuation">(</span>mean\_ratings<span class="token punctuation">)</span>
</code></pre> 
<p>输出df和grouped值如下：</p> 
<p><img src="https://images2.imgbox.com/84/ac/bLuIfIL0_o.png" alt=""></p> 
<p>结果显示每个元素在其所属的组中的平均评分。</p> 
<p><img src="https://images2.imgbox.com/7e/1b/BePTyZ5Z_o.png" alt=""></p> 
<p>其中图中，红框值2.0计算过程：</p> 
<p>①按照movie_id分组后，对应电影101的用户平均id,(1+2+3)/3，<strong>即2.0</strong>。</p> 
<p>②但是user_id列的平均值没有实际意义。</p> 
<h3><a id="33_apply_125"></a>3.3 使用apply进行分组和聚合</h3> 
<p>使用<code>apply()</code>方法进行分组和聚合操作。假设你有一个包含多个电影评分的数据集，每个电影有多个用户对其进行评分，数据如下：</p> 
<pre><code>    
    MovieID  UserID  Rating  
  0        1       1       5  
  1        1       2       4  
  2        1       3       3  
  3        2       1       3  
  4        2       2       2  
  5        2       3       5  
  6        2       4       4  
  7        3       1       4  
  8        3       2       3  
  9        3       4       5
</code></pre> 
<p>现在我们想要找出每个电影的平均评分，以及评分最高的用户。我们可以使用<code>apply()</code>方法进行分组和聚合操作。首先，我们可以按照电影ID进行分组，然后对每个分组应用一个自定义函数，该函数将计算该分组的平均评分和评分最高的用户。</p> 
<p>下面是代码：</p> 
<pre><code class="prism language-python">  <span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  
    
  \# 创建示例数据  
  data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'MovieID'</span><span class="token punctuation">:</span> \<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span>  
         <span class="token string">'UserID'</span><span class="token punctuation">:</span> \<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span>  
         <span class="token string">'Rating'</span><span class="token punctuation">:</span> \<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span>\<span class="token punctuation">]</span><span class="token punctuation">}</span>  
  df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>  
  df  
  \# 定义自定义函数，计算每个分组的平均评分和评分最高的用户和评分最低的用户  
  <span class="token keyword">def</span> movie\_stats<span class="token punctuation">(</span>group<span class="token punctuation">)</span><span class="token punctuation">:</span>  
     avg\_rating <span class="token operator">=</span> group\<span class="token punctuation">[</span><span class="token string">'Rating'</span>\<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  
     <span class="token builtin">max</span>\_rating\_user <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>group<span class="token punctuation">.</span>loc\<span class="token punctuation">[</span>group\<span class="token punctuation">[</span><span class="token string">'Rating'</span>\<span class="token punctuation">]</span><span class="token punctuation">.</span>idxmax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'UserID'</span>\<span class="token punctuation">]</span><span class="token punctuation">)</span>  
     <span class="token builtin">min</span>\_rating\_user <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>group<span class="token punctuation">.</span>loc\<span class="token punctuation">[</span>group\<span class="token punctuation">[</span><span class="token string">'Rating'</span>\<span class="token punctuation">]</span><span class="token punctuation">.</span>idxmin<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'UserID'</span>\<span class="token punctuation">]</span><span class="token punctuation">)</span>  
     <span class="token keyword">return</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'AvgRating'</span><span class="token punctuation">:</span> avg\_rating<span class="token punctuation">,</span> <span class="token string">'MaxRatingUser'</span><span class="token punctuation">:</span> <span class="token builtin">max</span>\_rating\_user<span class="token punctuation">,</span> <span class="token string">'MinRatingUser'</span><span class="token punctuation">:</span><span class="token builtin">min</span>\_rating\_user<span class="token punctuation">}</span><span class="token punctuation">)</span>  
    
  \# 将数据按照MovieID列分组，并对每个组应用自定义函数  
  grouped <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'MovieID'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>movie\_stats<span class="token punctuation">)</span>  
    
  <span class="token keyword">print</span><span class="token punctuation">(</span>grouped<span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code>    
          AvgRating  MaxRatingUser  MinRatingUser  
  MovieID  
  1              4.0            1.0            3.0  
  2              3.5            3.0            2.0  
  3              4.0            4.0            2.0
</code></pre> 
<p><img src="https://images2.imgbox.com/ca/0e/Hz5sd2h5_o.png" alt=""></p> 
<p>这个例子的目的是计算每个电影的平均评分和评分最高的用户和最低的用户，然后将结果保存在<code>grouped</code>变量中。</p> 
<p>首先，我们使用<code>groupby()</code>方法将数据按照<code>MovieID</code>列进行分组，然后对每个组应用一个自定义函数<code>movie_stats()</code>。该函数计算每个分组的平均评分和评分最高和最低的用户，并将结果作为<code>Series</code>返回。最后，<code>apply()</code>方法将返回的<code>Series</code>合并成一个<code>DataFrame</code>，包含每个电影的平均评分和评分最高的用户。</p> 
<h3><a id="34__188"></a>3.4 对销售数据进行分组和聚合</h3> 
<p>假设你有一份销售数据，其中包括每个销售员的姓名、销售日期、销售金额等信息。你想知道每个销售员每个月的总销售额，可以使用Pandas进行分组和聚合来实现。输出：</p> 
<h2><a id="4_193"></a>4.总结</h2> 
<p>在数据分析中，经常需要对数据进行分组和聚合操作。Pandas 是一种常用的 Python 数据分析库，它提供了丰富的分组和聚合操作功能，方便我们对数据进行处理。</p> 
<p>Pandas 中的分组操作可以使用 <code>groupby()</code> 方法进行，该方法可以将数据按照指定的列或者函数进行分组。分组后，我们可以对分组后的数据进行聚合操作，例如计算分组后的平均值、最大值、最小值、中位数等等。</p> 
<p>Pandas 中的聚合操作可以使用 <code>agg()</code> 方法进行，该方法可以对分组后的数据进行多个聚合操作，同时也可以对不同的列进行不同的聚合操作。聚合操作可以使用内置的聚合函数，例如 <code>mean()</code>、<code>sum()</code>、<code>max()</code> 等等，也可以使用自定义的聚合函数。</p> 
<p>除了使用内置的聚合函数外，<strong>我们还可以使用 <code>apply()</code> 方法对分组后的数据进行自定义的操作。该方法可以传入一个函数或者 lambda 函数，对分组后的数据进行任意的操作</strong>， 例如计算多个列之间的相关性，或者将分组后的数据进行可视化等等。</p> 
<hr> 
<p>好了，今天的分享就到这里！</p> 
<p><strong>最后免费分享给大家一份Python全套学习资料，包含视频、源码，课件，希望能帮到那些不满现状，想提升自己却又没有方向的朋友。</strong> 整理不易，请多多点赞分享哦~</p> 
<p><strong>微信扫描下方CSDN官方认证二维码即可领取</strong></p> 
<p>😝朋友们如果有需要的话，可以<mark>V扫描下方二维码免费领取</mark>🆓</p> 
<p>学好 Python 不论是就业还是做副业赚钱都不错，但要学会 Python 还是要有一个学习规划。最后大家分享一份全套的 Python 学习资料，给那些想学习 Python 的小伙伴们一点帮助！</p> 
<img src="https://images2.imgbox.com/a9/74/3gncXXQn_o.png"> #### **一、Python学习路线** 
<p><img src="https://images2.imgbox.com/0f/fb/518YTf5x_o.png" alt="image-20230619144606466"></p> 
<p><img src="https://images2.imgbox.com/67/14/Gtymity5_o.png" alt="python学习路线图1"></p> 
<h5><a id="Python_226"></a><strong>二、Python基础学习</strong></h5> 
<h6><a id="1__228"></a>1. 开发工具</h6> 
<p><img src="https://images2.imgbox.com/96/b1/D0uuE6yi_o.png" alt=""></p> 
<h6><a id="2__232"></a>2. 学习笔记</h6> 
<p><img src="https://images2.imgbox.com/47/37/KYd2ku61_o.gif" alt="在这里插入图片描述"></p> 
<h6><a id="3__236"></a>3. 学习视频</h6> 
<p><img src="https://images2.imgbox.com/a0/eb/p8ar7shM_o.gif" alt="在这里插入图片描述"></p> 
<h5><a id="Python_240"></a><strong>三、Python小白必备手册</strong></h5> 
<p><img src="https://images2.imgbox.com/af/7a/E0UF2D7o_o.png" alt="图片"></p> 
<h5><a id="_244"></a>四、数据分析全套资源</h5> 
<p><img src="https://images2.imgbox.com/c4/80/R82Btg4M_o.gif" alt="在这里插入图片描述"></p> 
<h5><a id="Python_248"></a><strong>五、Python面试集锦</strong></h5> 
<h6><a id="1__250"></a>1. 面试资料</h6> 
<p><img src="https://images2.imgbox.com/d4/67/crd0MjHs_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/84/b0/qGm477Ve_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="2__256"></a><strong>2. 简历模板</strong></h6> 
<p><img src="https://images2.imgbox.com/91/78/UAooRFQd_o.png" alt="在这里插入图片描述"></p> 
<img src="https://images2.imgbox.com/41/55/GaKDVlF6_o.png"> ** 
<font color="red"> 因篇幅有限，仅展示部分资料，添加上方即可获取</font>**
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8a5885c424a33ae2196927088f8d6c42/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在 C&#43;&#43; 中实现子进程执行和管道通信：一个实用指南</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d58ae50dbbfac5270f34bb8401c485db/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">网络安全红队常用的攻击方法及路径</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>