<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>(转)解决Android Studio模拟器无法联网 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="(转)解决Android Studio模拟器无法联网" />
<meta property="og:description" content="目录
一：问题描述
二：原因
三：解决方法
3.1永久修改DNS
3.2命令启动模拟器
四：参考链接
一：问题描述 Google推出了Android Q以后，兴致勃勃的下载了android10的镜像，新建模拟器发现启动速度比以前快了简直不是一星半点，开机嗖嗖的。以前因为Android的模拟器实在是太慢了，都拿自己心爱的手机调试，时间长了，手机会变得特别卡，特别损真机，而且有时候因为真机不能做到运行各个版本的Android系统，尤其是Google新发布的android版本，导致一些bug无法用真机复现。现在终于可以用模拟器调试解决问题了。但是发现模拟器运行，应用无法连接网络，duang duang duang~~ 本来以为这个问题应该很容易解决，结果就去百度，搜出来全是下边的玩意儿！！！都是在胡扯，记录下来希望其他小伙伴不再采坑
看别人写的什么通过下边的adb shell命令就可以联网，全在胡扯！！！我用shell命令根本没有 [net.dns1] 这属性，另外shell命令设置dns也是提示failed（应该是需要root权限，但是我没找到怎么获取root权限，不知道其他小伙伴是否遇到跟我一样的问题）
Shit start-----------------------
adb shell
getprop
会列出系统当前的各项属性，可以看到下面格式的模拟器dns：
[net.dns1]: [10.0.2.3]
[net.dns2]: [10.0.2.4]
通过setprop net.dns1 192.168.1.1
Shit ending-----------------------
下边介绍我亲测的两种办法真实有效！！！
Android Studio新建模拟器，内置浏览器无法通过域名打开百度，但是通过IP可以打开百度。这导致我们调试代码特别不方便，看下图1-1的提示，猜测大致是因为dns的问题，图1-2可以通过ip访问百度印证了这个猜测
图1-1 图1-2 二：原因 查阅资料发现Android模拟器默认的地址是10.0.2.3，默认的DNS也是10.0.2.3。对于在家或者在公司运行Android模拟器来讲，家里的电脑IP都是192.168.1.112之类的，公司电脑IP类似172.30.14.249这样，我们可以通过dos命令ipconfig/all查看电脑的ip，一般情况下电脑和模拟器不在同一个网段，所以就会出现电脑可以上网但是模拟器不能上网的情况。我们只需要把模拟器的DNS和电脑的DNS改成一致，模拟器就可以正常上网了。下面是图2-1，模拟器的DNS和电脑不一致
图2-1 三：解决方法 3.1永久修改DNS 进入模拟器Setting-&gt;Network&amp;Internet-&gt;Wi-Fi-&gt;AndroidWifi-&gt;右上角修改，手动选择IP setting-&gt;static，ip地址和网关还是设置成DHCP动态分配的ip和网关地址(大家可以在Network details查看动态分配的ip，然后记住默认分配的动态ip和网关，如下图3-1)，我们只需要修改模拟器的dns，改为和电脑的dns一致就可以了，我这边dns和pc保持一致，改为了223.5.5.5、223.6.6.6。大家按照自己pc的dns设置保存，然后就可以愉快的联网了，如图3-2，你懂的！
图3-1 图3-2 3.2命令启动模拟器 1.找到你的模拟器名字，默认在C:\users\xx\.android\avd目录下，如图3-3。如果找不到可以在Android Studio-&gt;AVD Manager-&gt;show on disk定位到此目录如图3-4
​​​​图3-3​​​ 图3-4​ 2.找到SDK的emulator目录，目录如图3-5
图3-5 3.在dos命令窗口切换到SDK的emulator目录下运行命令，模拟器名字要对应上自己的模拟器名字，我的模拟器名字是Pixel_API_29
emulator -avd Pixel_API_29 -dns-server 8.8.8.8,114.114.114.114 回车之后，系统会帮你启动你电脑中名叫Pixel_API_29的模拟器，此时模拟器便可以上网了。这种方式最简单粗暴，但也最麻烦，因为这只是一次性的，如果下次不输入这行命令，模拟器还是不能上网，所以每次启动前都要输入这行命令。
四：参考链接 解决AndroidStudio 模拟器无网络连接" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c7b19bd89da477c25f89bb7fa949dca6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-25T16:20:04+08:00" />
<meta property="article:modified_time" content="2022-03-25T16:20:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">(转)解决Android Studio模拟器无法联网</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <div id="content_views" class="htmledit_views"> 
 <p id="main-toc"> </p> 
 <p><strong>目录</strong></p> 
 <p id=""><a href="#t0" rel="nofollow noopener noreferrer" target="_self">一：问题描述</a></p> 
 <p id=""><a href="#t1" rel="nofollow noopener noreferrer" target="_self">二：原因</a></p> 
 <p id=""><a href="#t2" rel="nofollow noopener noreferrer" target="_self">三：解决方法</a></p> 
 <p id=""><a href="#t3" rel="nofollow noopener noreferrer" target="_self">3.1永久修改DNS</a></p> 
 <p id=""><a href="#t4" rel="nofollow noopener noreferrer" target="_self">3.2命令启动模拟器</a></p> 
 <p id=""><a href="#t5" rel="nofollow noopener noreferrer" target="_self">四：参考链接</a></p> 
 <hr id="hr-toc"> 
 <h2>一：问题描述</h2> 
 <p>Google推出了Android Q以后，兴致勃勃的下载了android10的镜像，新建模拟器发现启动速度比以前快了简直不是一星半点，开机嗖嗖的。以前因为Android的模拟器实在是太慢了，都拿自己心爱的手机调试，时间长了，手机会变得特别卡，特别损真机，而且有时候因为真机不能做到运行各个版本的Android系统，尤其是Google新发布的android版本，导致一些bug无法用真机复现。现在终于可以用模拟器调试解决问题了。但是发现模拟器运行，应用无法连接网络，duang  duang duang~~ 本来以为这个问题应该很容易解决，结果就去百度，搜出来全是下边的玩意儿！！！都是在胡扯，记录下来希望其他小伙伴不再采坑</p> 
 <p>看别人写的什么通过下边的adb shell命令就可以联网，全在胡扯！！！我用shell命令根本没有 [net.dns1] 这属性，另外shell命令设置dns也是提示failed（应该是需要root权限，但是我没找到怎么获取root权限，不知道其他小伙伴是否遇到跟我一样的问题）</p> 
 <p><strong>Shit start-----------------------</strong></p> 
 <p><s>adb shell</s></p> 
 <p><s>getprop</s></p> 
 <p><s>会列出系统当前的各项属性，可以看到下面格式的模拟器dns：</s></p> 
 <p><s>[net.dns1]: [10.0.2.3]<br> [net.dns2]: [10.0.2.4]<br> 通过setprop net.dns1 192.168.1.1</s></p> 
 <p><strong>Shit ending-----------------------</strong></p> 
 <p><strong>下边介绍我亲测的两种办法真实有效！！！</strong></p> 
 <p>Android Studio新建模拟器，内置浏览器无法通过域名打开百度，但是通过IP可以打开百度。这导致我们调试代码特别不方便，看下图1-1的提示，猜测大致是因为dns的问题，图1-2可以通过ip访问百度印证了这个猜测</p> 
 <div class="table-box"> 
  <table align="center" border="1" cellpadding="1" cellspacing="1"><tbody><tr><td> 
      <figure class="image"> 
       <img alt="" height="960" src="https://images2.imgbox.com/62/89/vVMO1OlB_o.png" width="534"> 
       <figcaption>
         图1-1 
       </figcaption> 
      </figure></td><td> 
      <figure class="image"> 
       <img alt="" height="961" src="https://images2.imgbox.com/cb/69/EmSmMG7m_o.png" width="539"> 
       <figcaption>
         图1-2 
       </figcaption> 
      </figure></td></tr></tbody></table> 
 </div> 
 <h2 id="%E4%BA%8C%EF%BC%9A%E5%8E%9F%E5%9B%A0">二：原因</h2> 
 <p>查阅资料发现Android模拟器默认的地址是10.0.2.3，默认的DNS也是10.0.2.3。对于在家或者在公司运行Android模拟器来讲，家里的电脑IP都是192.168.1.112之类的，公司电脑IP类似172.30.14.249这样，我们可以通过dos命令ipconfig/all查看电脑的ip，一般情况下电脑和模拟器不在同一个网段，所以就会出现电脑可以上网但是模拟器不能上网的情况。我们只需要把模拟器的DNS和电脑的DNS改成一致，模拟器就可以正常上网了。下面是图2-1，模拟器的DNS和电脑不一致</p> 
 <figure class="image"> 
  <img alt="" height="873" src="https://images2.imgbox.com/12/cd/tL0YFI1L_o.png" width="1200"> 
  <figcaption>
    图2-1 
  </figcaption> 
 </figure> 
 <h2 id="%E4%B8%89%EF%BC%9A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">三：解决方法</h2> 
 <h3 id="3.1%E6%B0%B8%E4%B9%85%E4%BF%AE%E6%94%B9DNS">3.1永久修改DNS</h3> 
 <p>进入模拟器Setting-&gt;Network&amp;Internet-&gt;Wi-Fi-&gt;AndroidWifi-&gt;右上角修改，手动选择IP setting-&gt;static，ip地址和网关还是设置成DHCP动态分配的ip和网关地址(大家可以在Network details查看动态分配的ip，然后记住默认分配的动态ip和网关，如下图3-1)，我们只需要修改模拟器的dns，改为和电脑的dns一致就可以了，我这边dns和pc保持一致，改为了223.5.5.5、223.6.6.6。大家按照自己pc的dns设置保存，然后就可以愉快的联网了，如图3-2，你懂的！</p> 
 <div class="table-box"> 
  <table align="left" border="1" cellpadding="1" cellspacing="1"><tbody><tr><td> 
      <figure class="image"> 
       <img alt="" height="751" src="https://images2.imgbox.com/3f/53/eI8cmbAN_o.png" width="363"> 
       <figcaption>
         图3-1 
       </figcaption> 
      </figure></td><td> 
      <figure class="image"> 
       <img alt="" height="744" src="https://images2.imgbox.com/60/a2/6QLCN2NK_o.png" width="365"> 
       <figcaption>
         图3-2 
       </figcaption> 
      </figure></td></tr></tbody></table> 
 </div> 
 <p> </p> 
 <h3 id="3.2%E5%91%BD%E4%BB%A4%E5%90%AF%E5%8A%A8%E6%A8%A1%E6%8B%9F%E5%99%A8">3.2命令启动模拟器</h3> 
 <p>1.找到你的模拟器名字，默认在C:\users\xx\.android\avd目录下，如图3-3。如果找不到可以在Android Studio-&gt;AVD Manager-&gt;show on disk定位到此目录如图3-4</p> 
 <figure class="image"> 
  <img alt="" height="307" src="https://images2.imgbox.com/63/80/AI2PpcoJ_o.png" width="1200"> 
  <figcaption>
    ​​​​图3-3​​​ 
  </figcaption> 
 </figure> 
 <figure class="image"> 
  <img alt="" height="217" src="https://images2.imgbox.com/e0/8d/KaL0Ix0Y_o.png" width="857"> 
  <figcaption>
    图3-4​ 
  </figcaption> 
 </figure> 
 <p> 2.找到SDK的emulator目录，目录如图3-5</p> 
 <figure class="image"> 
  <img alt="" height="391" src="https://images2.imgbox.com/35/06/3piqoNuD_o.png" width="1200"> 
  <figcaption>
    图3-5 
  </figcaption> 
 </figure> 
 <p>3.在dos命令窗口切换到SDK的emulator目录下运行命令，模拟器名字要对应上自己的模拟器名字，我的模拟器名字是Pixel_API_29</p> 
 <pre><code class="hljs language-vbscript">emulator -avd Pixel_API_29 -dns-<span class="hljs-built_in">server</span> <span class="hljs-number">8.8</span><span class="hljs-number">.8</span><span class="hljs-number">.8</span>,<span class="hljs-number">114.114</span><span class="hljs-number">.114</span><span class="hljs-number">.114</span></code>
  
  <div class="hljs-button {2}"></div></pre> 
 <p> 回车之后，系统会帮你启动你电脑中名叫Pixel_API_29的模拟器，此时模拟器便可以上网了。这种方式最简单粗暴，但也最麻烦，因为这只是一次性的，如果下次不输入这行命令，模拟器还是不能上网，所以每次启动前都要输入这行命令。</p> 
 <h2 id="%E5%9B%9B%EF%BC%9A%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">四：参考链接</h2> 
 <p><a href="https://blog.csdn.net/Bibifeng/article/details/81317037">解决AndroidStudio 模拟器无网络连接</a></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cb9a52e2c38473418123d4d71fc59555/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vs-code插件 -- Preview on Web Server 插件 使用 及设置默认浏览器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e14956eaa2f1ea4ed831b18dc2a26337/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">PIL转tensor 以及 Torch.new()方法使用记录 to_Tensor（）和as_Tensor()的区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>