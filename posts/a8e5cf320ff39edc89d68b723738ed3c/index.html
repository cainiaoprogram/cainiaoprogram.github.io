<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java实现批量修改Excel表格内容 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java实现批量修改Excel表格内容" />
<meta property="og:description" content="java实现批量修改Excel表格内容 怎么快速修改Excel表格里的内容，肯定好多人直接在Excel表格里ctrl&#43;f查找替换了，如果需要改的很多，Excel表格里的数据很多几钱多条呢？这样的话半天就啥也变干了，搞数据吧。
一、导入依赖 &lt;dependency&gt; &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt; &lt;artifactId&gt;xdocreport&lt;/artifactId&gt; &lt;version&gt;2.0.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.xmlbeans&lt;/groupId&gt; &lt;artifactId&gt;xmlbeans&lt;/artifactId&gt; &lt;version&gt;5.0.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.xmlgraphics&lt;/groupId&gt; &lt;artifactId&gt;xmlgraphics-commons&lt;/artifactId&gt; &lt;version&gt;2.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi&lt;/artifactId&gt; &lt;version&gt;3.9&lt;/version&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.apache.xmlbeans&lt;/groupId&gt; &lt;artifactId&gt;xmlbeans&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt; &lt;version&gt;3.9&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi-examples&lt;/artifactId&gt; &lt;version&gt;3.9&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi-excelant&lt;/artifactId&gt; &lt;version&gt;3.9&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi-scratchpad&lt;/artifactId&gt; &lt;version&gt;3.9&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.cloudecho&lt;/groupId&gt; &lt;artifactId&gt;xmlbean&lt;/artifactId&gt; &lt;version&gt;1.5.5&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.dom4j&lt;/groupId&gt; &lt;artifactId&gt;dom4j&lt;/artifactId&gt; &lt;version&gt;2.1.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.xmlbeans&lt;/groupId&gt; &lt;artifactId&gt;xmlbeans&lt;/artifactId&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;/dependency&gt; 有些依赖是使用不到的，还有其他小工具的依赖，就没有删掉，实现这个功能还是不影响的 。
二、代码如下 import java.io.FileInputStream; import java." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a8e5cf320ff39edc89d68b723738ed3c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-29T15:42:25+08:00" />
<meta property="article:modified_time" content="2021-07-29T15:42:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java实现批量修改Excel表格内容</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="javaExcel_1"></a>java实现批量修改Excel表格内容</h2> 
<ul><li>怎么快速修改Excel表格里的内容，肯定好多人直接在Excel表格里ctrl+f查找替换了，如果需要改的很多，Excel表格里的数据很多几钱多条呢？这样的话半天就啥也变干了，搞数据吧。<br> <img src="https://images2.imgbox.com/a9/29/hWMbrpQl_o.png" alt="在这里插入图片描述"></li></ul> 
<h2><a id="_7"></a>一、导入依赖</h2> 
<pre><code> &lt;dependency&gt;
      &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
      &lt;artifactId&gt;xdocreport&lt;/artifactId&gt;
      &lt;version&gt;2.0.1&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.xmlbeans&lt;/groupId&gt;
      &lt;artifactId&gt;xmlbeans&lt;/artifactId&gt;
      &lt;version&gt;5.0.1&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.xmlgraphics&lt;/groupId&gt;
      &lt;artifactId&gt;xmlgraphics-commons&lt;/artifactId&gt;
      &lt;version&gt;2.2&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
      &lt;artifactId&gt;poi&lt;/artifactId&gt;
      &lt;version&gt;3.9&lt;/version&gt;
      &lt;exclusions&gt;
        &lt;exclusion&gt;
          &lt;groupId&gt;org.apache.xmlbeans&lt;/groupId&gt;
          &lt;artifactId&gt;xmlbeans&lt;/artifactId&gt;
        &lt;/exclusion&gt;
      &lt;/exclusions&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
      &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;
      &lt;version&gt;3.9&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
      &lt;artifactId&gt;poi-examples&lt;/artifactId&gt;
      &lt;version&gt;3.9&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
      &lt;artifactId&gt;poi-excelant&lt;/artifactId&gt;
      &lt;version&gt;3.9&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
      &lt;artifactId&gt;poi-scratchpad&lt;/artifactId&gt;
      &lt;version&gt;3.9&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.github.cloudecho&lt;/groupId&gt;
      &lt;artifactId&gt;xmlbean&lt;/artifactId&gt;
      &lt;version&gt;1.5.5&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.dom4j&lt;/groupId&gt;
      &lt;artifactId&gt;dom4j&lt;/artifactId&gt;
      &lt;version&gt;2.1.1&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.xmlbeans&lt;/groupId&gt;
      &lt;artifactId&gt;xmlbeans&lt;/artifactId&gt;
      &lt;version&gt;3.1.0&lt;/version&gt;
    &lt;/dependency&gt;
</code></pre> 
<p><font color="#999AAA">有些依赖是使用不到的，还有其他小工具的依赖，就没有删掉，实现这个功能还是不影响的 。</font></p> 
<h2><a id="_75"></a>二、代码如下</h2> 
<pre><code>import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.util.HashMap;
import java.util.Map;
import org.apache.poi.xssf.usermodel.XSSFCell;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

/**
 * @Author zhangdapao
 * @Date 2021/7/28 16:46
 */

public class ExcelPOI {

    public void excelPOI () {
    try {
        String fileName = "F:\\shu.xlsx";//修改f盘的.xlsx文件
        XSSFWorkbook xwb = new XSSFWorkbook(new FileInputStream(fileName));
        Map&lt;String, String&gt; fields = new HashMap&lt;String, String&gt;();
        fields = getFieldMap();  //获取要修改字段的集合
        String fillStr="";    //存储aaa文件里的数据
        String[] fillSplit=null;
        XSSFSheet xSheet = xwb.getSheetAt(0);  //获取excel表的第一个sheet
        for (int i = 0; i &lt;= xSheet.getLastRowNum(); i++) {  //遍历所有的行
            if(xSheet.getRow(i)==null){ //这行为空执行下次循环
                continue;
            }
            for (int j = 0; j &lt;=  xSheet.getRow(i).getPhysicalNumberOfCells(); j++) {  //遍历当前行的所有列
                StringBuffer sb =new StringBuffer();
                if(xSheet.getRow(i).getCell(j)==null){//为空跳出循环
                    continue;
                }
                fillStr = (xSheet.getRow(i)).getCell(j).toString();//获取当前单元格的数据
                fillSplit=fillStr.split(",");//切割，以","为分隔符的这个可以根据自己情况改变
                XSSFCell xCell=xSheet.getRow(i).getCell(j); //获取单元格对象
                String s = xCell.toString();
                fillSplit=s.split(",");
                for (int js = 0; js &lt; fillSplit.length; js++) {
                    fillSplit[js]=(fields.get(fillSplit[js].trim())==null?fillSplit[js]:fields.get(fillSplit[js].trim()));
                    if(js+1==fillSplit.length){
                        sb.append(fillSplit[js]+"。");
                    }else{
                        sb.append(fillSplit[js]+",");
                    }
                }
                String s1 = sb.toString();
                xCell.setCellValue(s1);
            }
            System.out.println("已经完成第"+(i+1)+"列");
        }
        FileOutputStream out = new FileOutputStream(fileName);
        xwb.write(out);
        out.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
}

    private Map&lt;String, String&gt; getFieldMap(){
        Map&lt;String, String&gt; fields = new HashMap&lt;String, String&gt;();
	        fields.put("A", "测试1");
	        fields.put("B", "测试2");
	        return fields;
	    }
	    public static void main(String[] args) {
	        ExcelPOI a = new ExcelPOI();
      	  a.excelPOI();
  	  }
}
</code></pre> 
<p> <br>  <br>  <br>  </p> 
<p><strong>看完如果对你有帮助，感谢点赞支持！</strong><br>                                            <img src="https://images2.imgbox.com/72/2a/cMcXqrzn_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/48e49d85480d0b6565ded41f4e6e5acc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">怎么用账号登陆公司服务器地址,大企业邮箱登录入口，如何在foxmail上设置企业邮箱账号？...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ca2603eec2649cd89e29180158b25eb1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">希望之春为何一直正在连接服务器,春之希望</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>