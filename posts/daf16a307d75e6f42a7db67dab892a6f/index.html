<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Visual Studio 2005 SP1 的安装问题(解决方案) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Visual Studio 2005 SP1 的安装问题(解决方案)" />
<meta property="og:description" content="装成功了，但是花费我好长的时间呀！我的本本安装不了，提示硬盘空间不够，我本本C盘都1G多空间，竟然说空间不足！幸好台式安装了成功！郁闷，MS的SP也太大了吧！动不动就几百兆的！ 该安装包安装过程极其漫长，我的闪龙2200&#43; 512M内存安装了近2个半小时，比VS2005安装时间还长，而且安装时CPU占用不低于90％，请安排空闲时间安装，因为在安装时你根本没法做其他事情，C盘未使用空间至少在3G以上，否则会出现意想不到的情况。 您尝试在 Windows Server 2003 或 WindowsXP 中安装大 WindowsInstaller 包或大型 WindowsInstaller 修补程序包时错误信息： &#34; Error 1718。 文件被数字签名策略拒绝 &#34; 原因 当计算机有连续不足用于 WindowsServer 2003 或 WindowsXP 来验证 .msi 程序包或 .msp 包正确签名发生此问题。 his problem occurs when the computer has insufficient contiguous memory for Windows Server 2003 or Windows XP to verify that the .msi package or the .msp package is correctly signed. WORKAROUND To work around this problem, follow these steps: 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/daf16a307d75e6f42a7db67dab892a6f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2008-02-19T13:46:00+08:00" />
<meta property="article:modified_time" content="2008-02-19T13:46:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Visual Studio 2005 SP1 的安装问题(解决方案)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    装成功了，但是花费我好长的时间呀！我的本本安装不了，提示硬盘空间不够，我本本C盘都1G多空间，竟然说空间不足！幸好台式安装了成功！郁闷，MS的SP也太大了吧！动不动就几百兆的！ 
<br>该安装包安装过程极其漫长，我的闪龙2200+ 512M内存安装了近2个半小时，比VS2005安装时间还长，而且安装时CPU占用不低于90％，请安排空闲时间安装，因为在安装时你根本没法做其他事情，C盘未使用空间至少在3G以上，否则会出现意想不到的情况。 
<br>您尝试在 Windows Server 2003 或 WindowsXP 中安装大 WindowsInstaller 包或大型 WindowsInstaller 修补程序包时错误信息： " Error 1718。 文件被数字签名策略拒绝 " 
<br>原因 
<br>当计算机有连续不足用于 WindowsServer 2003 或 WindowsXP 来验证 .msi 程序包或 .msp 包正确签名发生此问题。 
<br>his problem occurs when the computer has insufficient contiguous memory for Windows Server 2003 or Windows XP to verify that the .msi package or the .msp package is correctly signed. 
<br>WORKAROUND 
<br>To work around this problem, follow these steps: 
<br>1.    Click Start, click Run, type control admintools, and then click OK. 
<br>2.    Double-click Local Security Policy. 
<br>3.    Click Software Restriction Policies. 
<br> 
<br>Note If no software restrictions are listed, right-click Software Restriction Policies, and then click Create New Policy. 
<br>4.    Under Object Type, double-click Enforcement. 
<br>5.    Click All users except local administrators, and then click OK. 
<br>6.    Restart the computer. 
<br> 
<br> 
<font color="#ff0000">1.    单击 开始 单击 运行 ， 键入 控件 admintools , 然后单击 确定 。<br>2.    双击 本地安全策略 。<br>3.    单击 软件限制策略 。<br><br>注意 如果列出, 没有软件限制右键单击 软件限制策略 , 然后单击 新建策略 。<br>4.    在 对象类型 , 双击 强制 。<br>5.    单击 除本地管理员以外的所有用户 , 并单击 确定 。<br>6.    重新启动计算机。<br><br>首先,需要大于3G的硬盘空间(解压VS2005用),这个补丁只会应用到VS2005上,和我们的MSND是没有啥关系的.<br><br>1.解压VS2005.<br><br>首先需要把我们VS2005安装光盘内的安装文件解压在我们的硬盘上.使用如下命令:<br><br>程序代码 程序代码<br>msiexec.exe /a G:/VS/vs_setup.msi TARGETDIR=D:/VSSETUP /L*vx install.log<br><br><br>其中G:/VS/vs_setup.msi 　Ｇ：是我的光驱盘符，这个目录是我光盘的VS2005安装文件的路径.<br><br>TARGETDIR=D:/VSSETUP 这个是指定你要解压到的位置,我指定了D:/VSSETUP 这个目录,大概5分钟左右,解压出了3.11G的文件.<br><br>2.释放补丁包.<br><br>把我们下载到的补丁文件解压出来.使用如下命令:<br><br>程序代码 程序代码<br>VS80sp1-KB926604-X86-CHS.exe /extract "E:/vspatch/"<br><br><br>E:/vspatch/ 是我解压到的目录.解压出一个VS80sp1-KB926604-X86-CHS.msp的文件,注意,是以msp为后缀名.<br><br>3.应用补丁.<br><br>把我们解压出来的两个文件进行整合,使用如下命令:<br><br>程序代码 程序代码<br>msiexec.exe /a D:/VSSETUP/vs_setup.msi /p "E:/vspatch/VS80sp1-KB926604-X86-CHS.msp" /L*vx patch.log<br><br><br>剩下的就是漫长的等待了,花费的时间大概和你安装好VS2005应用补丁的时间差不多吧.<br><br>打完补丁以后,把你VS安装目录里的其他文件拷到D:/VSSSETUP里来了,但是,不要覆盖任何文件,还有.cab的压缩包也不用再拷了，刚才其实已经把cab里的东西在第一步的时候解压出来并应用补丁了.<br><br>现在,可以把这个应用补丁的版本重新做成一张你的VS2005(SP1)安装光盘了,下次进行VS2005的安装可省事了,呵呵 <br></font> 
<br>几个VS 2005 SP1连接和一些有用的信息 
<br> 
<br>【原文地址】 A few VS 2005 SP1 Links and Information Nuggets 
<br>【原文发表日期】 Monday, January 01, 2007 8:24 PM 
<br> 
<br>如果你在12月份的下半个月出去了，你也许错过了我早先写的几篇关于VS 2005 Service Pack 1的帖子： 
<br> 
<br>   * Visual Studio 2005 Service Pack 1 (SP1) 发布了 (英文) 
<br>   * 在Vista 上安装VS 2005 SP1(以及如何在Vista上卸载VS 2005 SP1 Beta)(英文) 
<br>   * VS 2005 SP1中HTML源码编辑的性能改进(英文) 
<br>   * 技巧和诀窍：如何在VS 2005 SP1中使用VS的web服务器运行一个相对于根目录“/”的网站(英文) 
<br> 
<br>下面是几个你也许会发现有用的关于VS 2005 SP1的比较近期的连接和一些有用的信息： 
<br> 
<br>1) VS 2005 SP1中针对web应用的一些缺陷修正和变动的细节 
<br> 
<br>VS 服务组正在编写一个你将来可以访问的网页，从上面可以获取 VS 2005 SP1 中所有的变动和修正的缺陷的完整清单。在那之前，你可以看一下这篇博客帖子，Visual Studio 2005 SP1 Released - details about changes for web tools。该文总结了负责面向 ASP.NET的设计器和项目系统的VS Web工具组在VS 2005 SP1中所做的许多变动。 
<br> 
<br>2) 如何确定你是否安装了VS 2005 SP1 
<br> 
<br>有几个人问我如何确定是否成功了VS 2005 SP1。有2个方法，你可以很快地检查是否安装了VS 2005 SP1： 
<br> 
<br>a) 在IDE里选择“帮助-&gt;关于Visual Studio 2005”菜单项，查看一下，确认SP1列为其中一个安装的产品： 
<br> 
<br>b) 在IDE里选择“文件-&gt;新项目”菜单项，查看一下，确认VS 2005 Web应用项目模型选项(是内置于SP1中的)被安装了，而且是起作用的： 
<br> 
<br>假如你要使用编程方法来检测的话， Heath Stewart 写了一篇很好的帖子，描述如何使用编程方法，通过检查一个注册表项，来检测是否安装了VS 2005 SP1。 
<br> 
<br>重要注意事项：VS 2005 SP1会为安装在你机器上的每一个Visual Studio实例都安装一遍，所以，如果你安装了Visual Web Developer Express， Visual Basic Express 和 Visual Studio Professional 的话，VS 2005 SP1会安装3次。如果你在安装中途取消安装的话，你也许会发现只有一些实例安装了SP1，而不是所有的实例。使用上面的步骤允许你检查并确认你正使用的实例成功地安装了SP1。如果没有成功安装的话，那么重新运行SP1安装程序来为你机器上的其他VS实例安装SP1。 
<br> 
<br>3) 安装VS 2005 SP1时都发生了什么? 
<br> 
<br>很多人问“为什么安装VS 2005 SP1要花如此长的时间，它背后都在做些什么？” 
<br> 
<br>VS Setup组的Heath Stewart撰写了一篇精彩的帖子，详细描述了 VS 2005 SP1 安装过程中发生的步骤。该文同时也详细描述了N个改进安装时性能的方法(以及为什么这些方法会改进安装性能的原因)。我绝对建议你去读读该文，假如你想理解在安装过程中实际发生的一切的话。 
<br> 
<br>4) 安装VS 2005 SP1时如何改进性能和节省硬盘空间 
<br> 
<br>一个非常重要的安装性能的技巧是确认你在启动VS 2005 SP1安装程序之前终止了抗病毒软件。因为抗病毒软件通常会在文件被读取之前扫描这些文件，而VS 2005 SP1补丁文件非常大，而且会被多次读取，如果抗病毒软件在运行的话，这会极大地影响你的安装性能。所以最好在运行SP1文件前关闭抗病毒软件，在SP1 结束后再重新启动抗病毒软件。 
<br> 
<br>想了解改进安装性能的其他技巧的话，阅读一下这里Heath的详细描述SP1安装过程的帖子。特别地，找一下如何禁止SAFER检查方面的建议，以及如何使用 /quiet 参数指令(flag)等。这2个技巧应该能够极大地改进VS 2005 SP1的安装性能。 
<br> 
<br>5) 在Windows Server 2003上安装时如何处理Error 1718. filename.msp was rejected by digital signature policy这个错误信息 
<br> 
<br>几个人在我关于SP1的第一个博客帖子 (中文)上留言说，他们在 Windows Server 2003 上安装VS 2005 SP1时遇到了一个错误消息，是关于 "数字签名策略(digital signature policy)"无法得到验证的。 
<br> 
<br>这篇KB文章 (中文)描述了如何处理这个问题。 
<br> 
<br>6) 如何把VS 2005 SP1补丁集成(Slipstream)到VS 2005安装文件里(以避免在新的机器上重新安装SP1) 
<br> 
<br>Heath 另撰有一篇精彩的帖子，是关于如何把SP1补丁自动集成(slip-stream,参考文后的译注)进改动过的VS 2005安装程序里去，这样，你就可以生成一个内含SP1补丁的VS 2005安装程序，为你自己或你的团队所用。这避免了将来在另一台机器上做全新安装时你需要安装VS 2005 ，然后运行SP1补丁。 
<br> 
<br>将来从MSDN下载的 VS 2005 将自动含有SP1补丁。在这发生之前，如果你想了解如何建立你自己的合成(slipstreamed)安装文件的话，你可以使用上面提到的这篇文章。 
<br> 
<br>希望本文对你有所帮助， 
<br> 
<br>Scott 
<br> 
<br>附注：有可能的话，请把关于SP1安装的问题发到上面的Heath的博客贴子上去，因为他是VS 2005 SP1安装过程方面的真正的专家。这个星期，我还在度假(本贴是从一个旅馆里发出的)，所以，我对博客评语和问题的回复会比较慢。因此，想得到回复的话，他的博客也许会比较快。 
<br> 
<br>【译注】根据the Free Online Dictionary, Thesaurus and Encyclopedia，slipstream 是"To fix a bug or add enhancements to software without identifying such inclusions by creating a new version number"的意思。根据wikipedia，"In computer jargon, to slipstream updates, patches or service packs means to integrate them into the installation files of their original software, so that the resulting files will allow a direct installation of the updated software"。说白了，在这里，其大概意思就是把修正缺陷和添加新功能的编码集成到原来的安装程序里的意思。 
<br>.Net Framework 2.0 安装时出现Error 25007错误问题的解决 
<br>Posted on 2007-01-05 23:41 网路冷眼 at 博客园 阅读(672) 评论(10)  编辑 收藏 引用 网摘 所属分类: dot Net   
<br>        看到Visual Studio 2005 SP1提供下载，把它下载了下来。准备对安装在电脑上的Visual Studio 2005进行升级。 
<br>        在Visual Studio 2005 SP1是一个漫长的过程，挺折磨人的，一会儿提示磁盘空间不足，一会儿内存不足。费了九牛二虎之力，仍然未搞定。更令人恼火的是，你猜怎么着，VS 2005启动不了。好吧，对VS2005进行恢复。恢复过后，情况依旧。咦，仍然无法启动。再退一步，怀疑是VS2005依赖的.Net Framework 2.0出了问题。果不其然，像Windows Live Wirter，Microsoft Expression Web等等之类的东东统统启动不了。那好，对.Net Framework 2.0恢复。过后，VS2005还是“外甥打灯笼－照旧”。一不做二不休，将.Net FX 2.0统统卸掉，重新安装。可怕的事情发生了！ 
<br>     乖乖！安装.Net FX的前段挺顺利，到要结束时，“嘭”弹出一个对话框。出现下来信息： 
<br>Product: Microsoft .NET Framework 2.0 -- Error 25007.Error occurred while initializing fusion. Setup could not load fusion with LoadLibraryShim(). Error: The handle is invalid. 
<br>      按“Retry”按钮n次，仍然无法继续。只好认熊，点击“Cancel”后，安装程序rollback后退出。折腾了数次安装（包括重新启动），仍旧无法安装成功。本想咬牙将OS一股脑做掉，但是考虑到机子上安装的一大堆基于.Net FX的东东，只好作罢。 
<br>     于是在网上一搜，发现有几个老外也遇到此类的问题。一个老兄提出了这样的建议: 
<br>     在Registry里面有fusion.dll和sfusion.dll 的登记项的C:由于变成了C?导致安装失败，将这个错误改掉就搞定。 
<br>     我照此打理，还是无法成功安装。 
<br>     在网上搜了又搜，装了有装。最后找到MSDN 一个Blogger，专门是关于.Net FX和VS 2005安装方面的文章。好家伙，原来在安装中可能出现这么多稀奇古怪的问题。其中一个将Error 25007的。仍然无法解决我的问题。不过，里面有一个能将.Net FX 1.0,1.1,2.0干净卸载的工具（清理工具）。赶紧download下来，立即运行，选中“Product to cleanup:"的列表框中选中“.Net Framework 2.0"的选项，点击“Cleanup Now"的按钮。如图1所示。 
<br> 
<br> 
<br> 
<br> 
<br>图1 运行dotFx清除工具 
<br> 
<br>       清除完毕过后，再行安装它一路顺风顺水，成功完成。VS 2005重装后可以启动。Windows Live Wirter，Microsoft Expression Web也可以运行。一切皆OK！ 
<br>     正如一个老外在Post说得好，“VS 2005 SP1 is a terrible tool provided by MS. ”所以，安装时要小心！ 
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9b4e69f20d9a49726284c0bb709249a8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Window上获取DC句柄的三种方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/398d46dc825960a6077698d4fa5dcce8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">discuz做整合的时候遇到的“ Illegal request”解决办法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>