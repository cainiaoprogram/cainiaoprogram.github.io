<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>7. read_excel()函数读取Excel文件 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="7. read_excel()函数读取Excel文件" />
<meta property="og:description" content="【目录】
文章目录 1. pandas库读取数据2. read_excel()函数读取Excel文件3. 准备工作4. 路径前的`r`是什么5. io参数 = 绝对路径6. io = 相对路径7. sheet_name：要读取的sheet的名称或索引7.1 sheet_name参数 = 名字7.2 sheet_name参数 = 顺序 8. index_col参数指定行索引9. header参数指定列索引10. usecols参数指定读取列11. names参数自定义列名（列表形式）12. 总结 【正文】 学习时间：30分钟。
1. pandas库读取数据 用Pandas里的read_x方法可以读取外部数据。
x表示要读取的文件的格式。
读取xlsx文件用read_excel方法。读取csv文件用read_csv方法。读取txt文件用read_table方法。 2. read_excel()函数读取Excel文件 read_excel()函数是pandas库中用于读取Excel文件的函数。
【语法】
pandas.read_excel(io, sheet_name=0, header=0, names=None, index_col=None, usecols=None) 这里用的语法是调用库的函数：
库名.函数名( ) pandas是库名，这里通常用的是它的简写pd。
read_excel是函数名，在Python中，读取通常都会用到跟read相关的函数。
excel表示要读取的文件类型。
【参数】
io：要读取的Excel文件的路径（字符串）或者可迭代对象，例如文件对象、Excel表格URL、Excel文件中的表名等。sheet_name：要读取的Sheet的名称或索引（默认为0）。header：指定列名所在的行数，默认为0，表示第一行。names：自定义列名（列表形式），如果不指定，则默认使用Excel文件中的列名。index_col：指定作为行索引的列，默认为None，表示不使用任何列作为索引。usecols：指定要读取的列（列表形式），可以是列名或列索引。 3. 准备工作 注意使用read_excel()函数前需先安装pandas库。
在读取文件时首先要确定文件路径，即要读取的文件存在电脑中的哪个文件夹下。
以读取示例.xlsx为列。
我的示例.xlsx的绝对路径如下：
D:\安迪笔记\4.数据分析\7\示例.xlsx 我的示例.xlsx的相对路径如下：
4.数据分析\7\示例.xlsx 注意你的路径和我的不同哦！！！
示例.xlsx文件里有两个表单。
示例.xlsx文件的第1个sheet如下所示：
示例.xlsx文件的第2个sheet如下所示：
4. 路径前的r是什么 file = r&#34;D:\安迪笔记\4.数据分析\7\示例.xlsx&#34; 电脑中的文件路径默认使用\。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a813230b13c255c43496f47f29564208/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-04T23:57:15+08:00" />
<meta property="article:modified_time" content="2023-09-04T23:57:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">7. read_excel()函数读取Excel文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>【目录】</p> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_5" rel="nofollow"></a></li><li><ul><li><a href="#1_pandas_9" rel="nofollow">1. pandas库读取数据</a></li><li><a href="#2_read_excelExcel_19" rel="nofollow">2. read_excel()函数读取Excel文件</a></li><li><a href="#3__52" rel="nofollow">3. 准备工作</a></li><li><a href="#4_r_88" rel="nofollow">4. 路径前的`r`是什么</a></li><li><a href="#5_io___105" rel="nofollow">5. io参数 = 绝对路径</a></li><li><a href="#6_io___140" rel="nofollow">6. io = 相对路径</a></li><li><a href="#7_sheet_namesheet_173" rel="nofollow">7. sheet_name：要读取的sheet的名称或索引</a></li><li><ul><li><a href="#71_sheet_name___185" rel="nofollow">7.1 sheet_name参数 = 名字</a></li><li><a href="#72_sheet_name___239" rel="nofollow">7.2 sheet_name参数 = 顺序</a></li></ul> 
   </li><li><a href="#8_index_col_293" rel="nofollow">8. index_col参数指定行索引</a></li><li><a href="#9_header_390" rel="nofollow">9. header参数指定列索引</a></li><li><a href="#10_usecols_477" rel="nofollow">10. usecols参数指定读取列</a></li><li><a href="#11_names_562" rel="nofollow">11. names参数自定义列名（列表形式）</a></li><li><a href="#12__591" rel="nofollow">12. 总结</a></li></ul> 
 </li></ul> 
</div> 
<br> 【正文】 
<p></p> 
<h2><a id="_5"></a></h2> 
<p>学习时间：30分钟。</p> 
<h3><a id="1_pandas_9"></a>1. pandas库读取数据</h3> 
<p>用<code>Pandas</code>里的<code>read_x</code>方法可以读取外部数据。</p> 
<p><code>x</code>表示要读取的文件的格式。</p> 
<ul><li>读取<code>xlsx</code>文件用<code>read_excel</code>方法。</li><li>读取<code>csv</code>文件用<code>read_csv</code>方法。</li><li>读取<code>txt</code>文件用<code>read_table</code>方法。</li></ul> 
<h3><a id="2_read_excelExcel_19"></a>2. read_excel()函数读取Excel文件</h3> 
<p><code>read_excel()</code>函数是pandas库中用于读取Excel文件的函数。</p> 
<p>【语法】</p> 
<pre><code class="prism language-python">pandas<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>io<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre> 
<p>这里用的语法是<code>调用库的函数</code>：</p> 
<pre><code class="prism language-python">库名<span class="token punctuation">.</span>函数名<span class="token punctuation">(</span> <span class="token punctuation">)</span>
</code></pre> 
<p>pandas是库名，这里通常用的是它的简写<code>pd</code>。</p> 
<p><code>read_excel</code>是函数名，在Python中，读取通常都会用到跟<code>read</code>相关的函数。</p> 
<p><code>excel</code>表示要读取的文件类型。</p> 
<p>【参数】</p> 
<ul><li>io：要读取的Excel文件的路径（字符串）或者可迭代对象，例如文件对象、Excel表格URL、Excel文件中的表名等。</li><li>sheet_name：要读取的Sheet的名称或索引（默认为0）。</li><li>header：指定列名所在的行数，默认为0，表示第一行。</li><li>names：自定义列名（列表形式），如果不指定，则默认使用Excel文件中的列名。</li><li>index_col：指定作为行索引的列，默认为None，表示不使用任何列作为索引。</li><li>usecols：指定要读取的列（列表形式），可以是列名或列索引。</li></ul> 
<h3><a id="3__52"></a>3. 准备工作</h3> 
<p>注意使用<code>read_excel()</code>函数前需先安装pandas库。</p> 
<p>在读取文件时首先要确定文件路径，即要读取的文件存在电脑中的哪个文件夹下。</p> 
<p>以读取<code>示例.xlsx</code>为列。</p> 
<p>我的<code>示例.xlsx</code>的绝对路径如下：</p> 
<pre><code class="prism language-python">D<span class="token punctuation">:</span>\安迪笔记\<span class="token number">4.</span>数据分析\<span class="token number">7</span>\示例<span class="token punctuation">.</span>xlsx
</code></pre> 
<p>我的<code>示例.xlsx</code>的相对路径如下：</p> 
<pre><code class="prism language-python"><span class="token number">4.</span>数据分析\<span class="token number">7</span>\示例<span class="token punctuation">.</span>xlsx
</code></pre> 
<p>注意你的路径和我的不同哦！！！</p> 
<p><code>示例.xlsx</code>文件里有两个表单。</p> 
<p><code>示例.xlsx</code>文件的第1个sheet如下所示：</p> 
<p><img src="https://images2.imgbox.com/03/91/qQoE6W2g_o.png" alt="在这里插入图片描述"></p> 
<p><code>示例.xlsx</code>文件的第2个sheet如下所示：</p> 
<p><img src="https://images2.imgbox.com/cd/2a/17D4yvnm_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_r_88"></a>4. 路径前的<code>r</code>是什么</h3> 
<pre><code class="prism language-python"><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">r"D:\安迪笔记\4.数据分析\7\示例.xlsx"</span>
</code></pre> 
<p>电脑中的文件路径默认使用<code>\</code>。</p> 
<p>Python中的转义字符通常以反斜杠<code>\</code>开头。</p> 
<p>如果路径中有<code>\</code>，且<code>\</code>后有转义字符时，程序会默认为是转义字符而报错。</p> 
<p>因此可以在路径前面加一个字符<code>r</code>，告知程序这是路径。</p> 
<p>如果不加<code>r</code>，可以把路径里面的所有<code>\</code>转换成<code>/</code>。</p> 
<h3><a id="5_io___105"></a>5. io参数 = 绝对路径</h3> 
<p>【代码示例】</p> 
<pre><code class="prism language-python"><span class="token comment"># 导入pandas库并简写为pd</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 文件的绝对路径</span>
<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">r"D:\安迪笔记\4.数据分析\7\示例.xlsx"</span>

<span class="token comment"># 调用函数：库名.函数名()</span>
<span class="token comment"># pd是库名</span>
<span class="token comment"># read_excel是函数名</span>
<span class="token comment"># io参数=file，file是路径</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>

<span class="token comment"># 输出读取到的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>【终端输出】</p> 
<pre><code>   序号       学号  籍贯 性别
0   1  2023001  广东  男
1   2  2023002  河南  男
2   3  2023003  湖北  男
3   4  2023004  河南  男
4   5  2023005  河南  男
5   6  2023006  其他  男
6   7  2023007  湖北  女
</code></pre> 
<p>输出的是<code>示例.xlsx</code>文件的中的第一个sheet<code>学生</code>里面的数据。</p> 
<h3><a id="6_io___140"></a>6. io = 相对路径</h3> 
<p>【代码示例】</p> 
<pre><code class="prism language-python"><span class="token comment"># 导入pandas库并简写为pd</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 文件的相对路径</span>
<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">r"4.数据分析\7\示例.xlsx"</span>

<span class="token comment"># 调用函数：库名.函数名()</span>
<span class="token comment"># pd是库名</span>
<span class="token comment"># read_excel是函数名</span>
<span class="token comment"># io参数=file，file是路径</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>

<span class="token comment"># 输出读取到的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>【终端输出】</p> 
<pre><code>   序号       学号  籍贯 性别
0   1  2023001  广东  男
1   2  2023002  河南  男
2   3  2023003  湖北  男
3   4  2023004  河南  男
4   5  2023005  河南  男
5   6  2023006  其他  男
6   7  2023007  湖北  女
</code></pre> 
<h3><a id="7_sheet_namesheet_173"></a>7. sheet_name：要读取的sheet的名称或索引</h3> 
<p><code>xlsx</code>格式的文件会有多个sheet。</p> 
<p>可以通过设定<code>sheet_name</code>参数指定要读取哪个sheet表。</p> 
<p>sheet_name参数有3种情况：</p> 
<ul><li>不指定sheet_name参数：默认读取第一个sheet文件。</li><li>sheet_name参数 = sheet名字</li><li>sheet_name参数 = sheet顺序</li></ul> 
<h4><a id="71_sheet_name___185"></a>7.1 sheet_name参数 = 名字</h4> 
<p>【sheet_name =“学生”】</p> 
<pre><code class="prism language-python"><span class="token comment"># 读取pandas库并简写为pd</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 文件的绝对路径</span>
<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">r"D:\安迪笔记\4.数据分析\7\示例.xlsx"</span>

<span class="token comment"># sheet_name ="学生"，读取学生sheet里的数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> sheet_name <span class="token operator">=</span><span class="token string">"学生"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>【终端输出】</p> 
<pre><code>   序号       学号  籍贯 性别
0   1  2023001  广东  男
1   2  2023002  河南  男
2   3  2023003  湖北  男
3   4  2023004  河南  男
4   5  2023005  河南  男
5   6  2023006  其他  男
6   7  2023007  湖北  女
</code></pre> 
<p>【sheet_name =“销售”】</p> 
<pre><code class="prism language-python"><span class="token comment"># 读取pandas库并简写为pd</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 文件的绝对路径</span>
<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">r"D:\安迪笔记\4.数据分析\7\示例.xlsx"</span>

<span class="token comment"># sheet_name ="销售"，读取销售sheet里的数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> sheet_name <span class="token operator">=</span><span class="token string">"销售"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>【终端输出】</p> 
<pre><code>   序号     日期  省份  订单量  单价  销售额
0   1  45170  广东    0  10    0
1   2  45171  河南    0  10    0
2   3  45172  湖北    1  10   30
3   4  45173  河南    0  10    0
4   5  45174  河南    0  10    0
</code></pre> 
<h4><a id="72_sheet_name___239"></a>7.2 sheet_name参数 = 顺序</h4> 
<p>注意顺序从0开始计数。</p> 
<p>【sheet_name=0，读取第1个sheet】</p> 
<pre><code class="prism language-python"><span class="token comment"># 读取pandas库并简写为pd</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">r"D:\安迪笔记\4.数据分析\7\示例.xlsx"</span>

<span class="token comment"># sheet_name=0，读取第1个sheet</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> sheet_name <span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>【终端输出】</p> 
<pre><code>   序号       学号  籍贯 性别
0   1  2023001  广东  男
1   2  2023002  河南  男
2   3  2023003  湖北  男
3   4  2023004  河南  男
4   5  2023005  河南  男
5   6  2023006  其他  男
6   7  2023007  湖北  女
</code></pre> 
<p>【sheet_name=1，读取第2个sheet】</p> 
<pre><code class="prism language-python"><span class="token comment"># 读取pandas库并简写为pd</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">r"D:\安迪笔记\4.数据分析\7\示例.xlsx"</span>

<span class="token comment"># sheet_name=1，读取第2个sheet</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> sheet_name <span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>【终端输出】</p> 
<pre><code>   序号     日期  省份  订单量  单价  销售额
0   1  45170  广东    0  10    0
1   2  45171  河南    0  10    0
2   3  45172  湖北    1  10   30
3   4  45173  河南    0  10    0
4   5  45174  河南    0  10    0
</code></pre> 
<h3><a id="8_index_col_293"></a>8. index_col参数指定行索引</h3> 
<p>【代码示例】</p> 
<pre><code class="prism language-python"><span class="token comment"># 读取pandas库并简写为pd</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">r"D:\安迪笔记\4.数据分析\7\示例.xlsx"</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********默认行索引**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********指定行索引为0**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********指定行索引为1**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********指定行索引为2**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********指定行索引为3**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>【终端输出】</p> 
<pre><code>**********默认行索引**********
   序号       学号  籍贯 性别
0   1  2023001  广东  男
1   2  2023002  河南  男
2   3  2023003  湖北  男
3   4  2023004  河南  男
4   5  2023005  河南  男
5   6  2023006  其他  男
6   7  2023007  湖北  女
**********指定行索引为0**********
         学号  籍贯 性别
序号                
1   2023001  广东  男
2   2023002  河南  男
3   2023003  湖北  男
4   2023004  河南  男
5   2023005  河南  男
6   2023006  其他  男
7   2023007  湖北  女
**********指定行索引为1**********
         序号  籍贯 性别
学号                
2023001   1  广东  男
2023002   2  河南  男
2023003   3  湖北  男
2023004   4  河南  男
2023005   5  河南  男
2023006   6  其他  男
2023007   7  湖北  女
**********指定行索引为2**********
    序号       学号 性别
籍贯                
广东   1  2023001  男
河南   2  2023002  男
湖北   3  2023003  男
河南   4  2023004  男
河南   5  2023005  男
其他   6  2023006  男
湖北   7  2023007  女
**********指定行索引为3**********
    序号       学号  籍贯
性别                 
男    1  2023001  广东
男    2  2023002  河南
男    3  2023003  湖北
男    4  2023004  河南
男    5  2023005  河南
男    6  2023006  其他
女    7  2023007  湖北
</code></pre> 
<p><font color="#FF000">index_col参数指定使用哪一列作为行索引。</font></p> 
<p>默认使用<code>0 1 2 3</code>作为行索引。</p> 
<p>因为参数从0开始计数。</p> 
<ul><li>当<code>index_col=0</code>时，即指定第1例<code>序号</code>作为行索引。</li><li>当<code>index_col=1</code>时，即指定第2例<code>学号</code>作为行索引。</li><li>当<code>index_col=2</code>时，即指定第3例<code>籍贯</code>作为行索引。</li><li>当<code>index_col=3</code>时，即指定第4例<code>性别</code>作为行索引。</li></ul> 
<p>当指定行索引时，输出的结果少一列，默认行索引列消失。</p> 
<h3><a id="9_header_390"></a>9. header参数指定列索引</h3> 
<p>【代码示例】</p> 
<pre><code class="prism language-python"><span class="token comment"># 读取pandas库并简写为pd</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">r"D:\安迪笔记\4.数据分析\7\示例.xlsx"</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********默认列索引**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********指定列索引为0**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span>  header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********指定列索引为1**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********指定列索引为2**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********指定列索引为3**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>【终端输出】</p> 
<pre><code>**********默认列索引**********
   序号       学号  籍贯 性别
0   1  2023001  广东  男
1   2  2023002  河南  男
2   3  2023003  湖北  男
3   4  2023004  河南  男
4   5  2023005  河南  男
5   6  2023006  其他  男
6   7  2023007  湖北  女
**********指定列索引为0**********
   序号       学号  籍贯 性别
0   1  2023001  广东  男
1   2  2023002  河南  男
2   3  2023003  湖北  男
3   4  2023004  河南  男
4   5  2023005  河南  男
5   6  2023006  其他  男
6   7  2023007  湖北  女
**********指定列索引为1**********
   1  2023001  广东  男
0  2  2023002  河南  男
1  3  2023003  湖北  男
2  4  2023004  河南  男
3  5  2023005  河南  男
4  6  2023006  其他  男
5  7  2023007  湖北  女
**********指定列索引为2**********
   2  2023002  河南  男
0  3  2023003  湖北  男
1  4  2023004  河南  男
2  5  2023005  河南  男
3  6  2023006  其他  男
4  7  2023007  湖北  女
**********指定列索引为3**********
   3  2023003  湖北  男
0  4  2023004  河南  男
1  5  2023005  河南  男
2  6  2023006  其他  男
3  7  2023007  湖北  女
</code></pre> 
<p><font color="#FF000">header参数指定使用哪一行作为列索引。</font></p> 
<p>默认使用第1行作为列索引。</p> 
<p>因为参数从0开始计数。</p> 
<ul><li>当<code>header=0</code>时，即指定第1行<code>序号 学号 籍贯 性别</code>作为列索引。</li><li>当<code>header=1</code>时，即指定第2行<code>1 2023001 广东 男</code>作为列索引。</li><li>当<code>header=2</code>时，即指定第3行<code>2 2023002 河南 男</code>作为列索引。</li><li>当<code>header=3</code>时，即指定第4行<code>3 2023003 湖北 男</code>作为列索引。</li></ul> 
<p>当设置列索引，输出的结果少一行，默认列索引消失。</p> 
<h3><a id="10_usecols_477"></a>10. usecols参数指定读取列</h3> 
<p>当表的列数太多，我们又不需要那么多列时，我们可以通过设定<code>usecols</code>参数来指定要读取的列。</p> 
<p><font color="#FF000">usecols的参数为列表。</font></p> 
<p>【代码示例】</p> 
<pre><code class="prism language-python"><span class="token comment"># 读取pandas库并简写为pd</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">r"D:\安迪笔记\4.数据分析\7\示例.xlsx"</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********读取第1例数据**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********读取第3例数据**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********读取第1例、第3列数据**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"**********读取第1例、第3列数据、第4列数据**********"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>【终端输出】</p> 
<pre><code>**********读取第1例数据**********
   序号
0   1
1   2
2   3
3   4
4   5
5   6
6   7
**********读取第3例数据**********
   籍贯
0  广东
1  河南
2  湖北
3  河南
4  河南
5  其他
6  湖北
**********读取第1例、第3列数据**********
   序号  籍贯
0   1  广东
1   2  河南
2   3  湖北
3   4  河南
4   5  河南
5   6  其他
6   7  湖北
**********读取第1例、第3列数据、第4列数据**********
   序号  籍贯 性别
0   1  广东  男
1   2  河南  男
2   3  湖北  男
3   4  河南  男
4   5  河南  男
5   6  其他  男
6   7  湖北  女
</code></pre> 
<p>【代码解析】</p> 
<pre><code class="prism language-python">usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
</code></pre> 
<p><code>usecols</code>参数存储的对象时列表。</p> 
<p>因为从<code>0</code>开始计数，当列表中只有一个数据<code>2</code>时，表示读取的是第<code>3</code>列。</p> 
<p>当列表中有多个数据时，表示读取多列。</p> 
<h3><a id="11_names_562"></a>11. names参数自定义列名（列表形式）</h3> 
<p><code>names</code>参数自定义列名（列表形式），如果不指定，则默认使用Excel文件中的列名。</p> 
<p>【代码示例】</p> 
<pre><code class="prism language-python"><span class="token comment"># 读取pandas库并简写为pd</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">r"D:\安迪笔记\4.数据分析\7\示例.xlsx"</span>

<span class="token comment"># names参数指定 A B C D 为列名</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"A"</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">,</span><span class="token string">"C"</span><span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>【终端输出】</p> 
<pre><code>   A        B   C  D
0  1  2023001  广东  男
1  2  2023002  河南  男
2  3  2023003  湖北  男
3  4  2023004  河南  男
4  5  2023005  河南  男
5  6  2023006  其他  男
6  7  2023007  湖北  女
</code></pre> 
<h3><a id="12__591"></a>12. 总结</h3> 
<p>【代码总结】</p> 
<pre><code class="prism language-python"><span class="token comment"># 导入pandas库并简写为pd</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 文件的绝对路径</span>
<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">r"D:\安迪笔记\4.数据分析\7\示例.xlsx"</span>

<span class="token comment"># 5. 读取文件</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>

<span class="token comment"># 7.1 sheet_name ="学生"，读取学生sheet里的数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> sheet_name <span class="token operator">=</span><span class="token string">"学生"</span><span class="token punctuation">)</span>

<span class="token comment"># 7.2 sheet_name=0，读取第1个sheet里的数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> sheet_name <span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">)</span>

<span class="token comment"># 8. index_col=1，指定第2例`学号`作为行索引。</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 9. header=2，指定第3行`2  2023002  河南  男`作为列索引</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 10. usecols=[0,2,3]读取第1例、第3列数据、第4列数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 11. names参指定 A B C D 为列名</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"A"</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">,</span><span class="token string">"C"</span><span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 输出读取到的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>【图片总结】</p> 
<p><img src="https://images2.imgbox.com/c1/23/XiLmBDO9_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c08d507b771f2c606484197526a36c4a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">yolov5训练加速--一个可能忽视的细节（mmdetection也一样），为什么显卡使用率老是为0？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eecf57e90709b50ad1e26b6df78b6455/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">linux复习笔记01（小滴课堂）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>