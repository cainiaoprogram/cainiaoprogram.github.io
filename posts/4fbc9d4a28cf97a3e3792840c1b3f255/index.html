<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>看图识熊（五） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="看图识熊（五）" />
<meta property="og:description" content="其它信息 点击界面右上角的齿轮，可以看到免费用户每个项目能够使用的服务额度：
一共可以上传5000张图片，创建50个不同标签，保存10次迭代的结果。
这十次迭代有什么用呢？当需要增删标签、给标签添加或删除训练图片时，这次再训练，就会花费掉一次迭代。
这些都是当前项目的总数而不是累计值。对于一般的免费用户，这基本上就相当于你可以随意使用这项服务了，如果有大量的训练数据，那么建议您还是订阅Azure云服务，Azure秉持着使用多少收费多少的原则，即使收费，也仍然良心。
导出模型 为了构建本地离线推理应用，我们需要下载模型。点击顶部Performance按钮回到训练结果页面并切换到要使用的Iteration，然后点击Export按钮，可以看到如下所示的导出页面。
定制化视觉服务一共提供了四种模型的导出，对三大操作系统都能支持，这里我们选择ONNX。
ONNX，全称Open Neural Network Exchange，即开放神经网络交换格式，是由微软、FaceBook等多个相关公司一起推动的深度学习模型标准。Microsoft Cognitive Toolkit、Caffe2、PyTorch等工具已经支持ONNX。
选择ONNX后，在Choose a version下拉框中选择ONNX1.2，点击Export，等待服务器把模型导出后，然后点击Download，即可下载模型，这里将名字改为BearModel.onnx。
注意，存放模型文件的路径不要包含中文。
查看模型 Netron是一个开源的模型信息的查看器，支持多种模型格式，可以下载安装使用，也可以在线查看模型信息。
Netron打开后，点击Open model选择打开之前下载的BearModel.onnx文件。然后点击左上角的汉堡菜单显示模型的输入输出。
上图中可以看到该模型需要的输入data是一个float数组，数组中要求依次放置227*227图片的所有蓝色分量、绿色分量和红色分量，后面程序中调用时要对输入图片做相应的处理。
上图中还可以看到输出有两个值，第一个值classLabel是确定的分类的标签，这里只需用到第二个输出即可，第二个值loss包含所有分类的得分。
构建应用 模型有了之后，这里就可着手构建应用程序来使用模型了。
这里以Windows平台为例，应用程序使用C#语言。我们有三种方案：
使用Windows Machine Learning加载模型并推理，这种方式要求系统必须是Windows 10，版本号大于等于17763，详细步骤在这个文档
使用ONNX Runtime加载模型并推理。这是微软开源项目，会持续更新，跨平台、跨语言，而且支持CPU、GPU推理，使用也十分方便。详细步骤在这个文档
不推荐使用 Tools for AI对模型进行封装，可以运行在 Windows 7 或 Windows 10，但目前仅支持x64平台，详细步骤在这个文档
小结 我们回顾一下本案例体验了哪些过程。首先，我们收集了一些数据，并给它们进行了分类。然后，使用定制化视觉服务训练并导出了模型。再然后就是代码部分，设计了界面、让它与代码能够联动。再然后就是代码中比较复杂的部分，即数据的规范化。最后的推理预测其实只有一行代码就够了。完成后，我们又添加新数据重新训练了一遍。
这个案例很简单，主要是希望大家体验一下AI应用开发。其实AI应用开发和我们传统的应用开发没有太大区别，可以认为就是调用了一个神奇的函数，给它一些数据，它就还给你一个答案。如果多有几个神奇的函数，那么就能做出更加智能的程序，就成为了真正的产品了。
最后，给大家留个小作业：大家可以用卡通熊或者毛绒熊玩具的照片测试一下，然后考虑如何能把这几种熊从真实熊的照片中区分出来。完成后可以找出一些新的卡通熊或毛绒熊图片进行测试，看看能否达到较好的分类效果。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4fbc9d4a28cf97a3e3792840c1b3f255/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-08T19:30:00+08:00" />
<meta property="article:modified_time" content="2024-01-08T19:30:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">看图识熊（五）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>其它信息</h4> 
<p>点击界面右上角的齿轮，可以看到免费用户每个项目能够使用的服务额度：</p> 
<p>一共可以上传5000张图片，创建50个不同标签，保存10次迭代的结果。<img alt="" height="219" src="https://images2.imgbox.com/ae/8b/SIYMp2x6_o.png" width="702"></p> 
<p>这十次迭代有什么用呢？当需要增删标签、给标签添加或删除训练图片时，这次再训练，就会花费掉一次迭代。</p> 
<p>这些都是当前项目的总数而不是累计值。对于一般的免费用户，这基本上就相当于你可以随意使用这项服务了，如果有大量的训练数据，那么建议您还是订阅Azure云服务，Azure秉持着使用多少收费多少的原则，即使收费，也仍然良心。</p> 
<h4>导出模型</h4> 
<p>为了构建本地离线推理应用，我们需要下载模型。点击顶部Performance按钮回到训练结果页面并切换到要使用的Iteration，然后点击Export按钮，可以看到如下所示的导出页面。<img alt="" height="998" src="https://images2.imgbox.com/cf/7e/UScLDoNY_o.png" width="385"></p> 
<p>定制化视觉服务一共提供了四种模型的导出，对三大操作系统都能支持，这里我们选择ONNX。</p> 
<p>ONNX，全称Open Neural Network Exchange，即开放神经网络交换格式，是由微软、FaceBook等多个相关公司一起推动的深度学习模型标准。Microsoft Cognitive Toolkit、Caffe2、PyTorch等工具已经支持ONNX。</p> 
<p>选择ONNX后，在Choose a version下拉框中选择ONNX1.2，点击Export，等待服务器把模型导出后，然后点击Download，即可下载模型，这里将名字改为BearModel.onnx。</p> 
<p>注意，存放模型文件的路径不要包含中文。</p> 
<h4>查看模型</h4> 
<p><a href="https://github.com/lutzroeder/netron" title="Netron">Netron</a>是一个开源的模型信息的查看器，支持多种模型格式，可以<a href="https://github.com/lutzroeder/netron/releases" title="下载">下载</a>安装使用，也可以<a href="https://lutzroeder.github.io/netron/" rel="nofollow" title="在线查看">在线查看</a>模型信息。</p> 
<p>Netron打开后，点击Open model选择打开之前下载的BearModel.onnx文件。然后点击左上角的汉堡菜单显示模型的输入输出。<img alt="" height="591" src="https://images2.imgbox.com/19/8b/E1ArQwQj_o.png" width="695"></p> 
<p>上图中可以看到该模型需要的输入data是一个float数组，数组中要求依次放置227*227图片的所有蓝色分量、绿色分量和红色分量，后面程序中调用时要对输入图片做相应的处理。</p> 
<p>上图中还可以看到输出有两个值，第一个值classLabel是确定的分类的标签，这里只需用到第二个输出即可，第二个值loss包含所有分类的得分。</p> 
<h2>构建应用</h2> 
<p>模型有了之后，这里就可着手构建应用程序来使用模型了。</p> 
<p>这里以Windows平台为例，应用程序使用C#语言。我们有三种方案：</p> 
<ol><li> <p>使用Windows <a href="https://docs.microsoft.com/zh-cn/windows/ai/" rel="nofollow" title="Machine Learning">Machine Learning</a>加载模型并推理，这种方式要求系统必须是Windows 10，版本号大于等于17763，详细步骤在这个<a href="https://github.com/microsoft/ai-edu/blob/master/%E5%AE%9E%E8%B7%B5%E6%A1%88%E4%BE%8B/B03-%E7%9C%8B%E5%9B%BE%E8%AF%86%E7%86%8A/OnnxWithWinML.md" title="文档">文档</a></p> </li><li> <p>使用<a href="https://github.com/microsoft/onnxruntime/" title="ONNX Runtime">ONNX Runtime</a>加载模型并推理。这是微软开源项目，会持续更新，跨平台、跨语言，而且支持CPU、GPU推理，使用也十分方便。详细步骤在这个<a href="https://github.com/microsoft/ai-edu/blob/master/%E5%AE%9E%E8%B7%B5%E6%A1%88%E4%BE%8B/B03-%E7%9C%8B%E5%9B%BE%E8%AF%86%E7%86%8A/OnnxWithRuntime.md" title="文档">文档</a></p> </li><li> <p><strong>不推荐使用</strong> Tools for AI对模型进行封装，可以运行在 Windows 7 或 Windows 10，但目前仅支持x64平台，详细步骤在这个<a href="https://github.com/microsoft/ai-edu/blob/master/%E5%AE%9E%E8%B7%B5%E6%A1%88%E4%BE%8B/B03-%E7%9C%8B%E5%9B%BE%E8%AF%86%E7%86%8A/OnnxWithToolsForAI.md" title="文档">文档</a></p> </li></ol> 
<h2>小结</h2> 
<p>我们回顾一下本案例体验了哪些过程。首先，我们收集了一些数据，并给它们进行了分类。然后，使用定制化视觉服务训练并导出了模型。再然后就是代码部分，设计了界面、让它与代码能够联动。再然后就是代码中比较复杂的部分，即数据的规范化。最后的推理预测其实只有一行代码就够了。完成后，我们又添加新数据重新训练了一遍。</p> 
<p>这个案例很简单，主要是希望大家体验一下AI应用开发。其实AI应用开发和我们传统的应用开发没有太大区别，可以认为就是调用了一个神奇的函数，给它一些数据，它就还给你一个答案。如果多有几个神奇的函数，那么就能做出更加智能的程序，就成为了真正的产品了。</p> 
<p>最后，给大家留个小作业：大家可以用卡通熊或者毛绒熊玩具的照片测试一下，然后考虑如何能把这几种熊从真实熊的照片中区分出来。完成后可以找出一些新的卡通熊或毛绒熊图片进行测试，看看能否达到较好的分类效果。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7e20ac8302415082a1e6ec215b5c78b3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">展开运算符（Spread Operator）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/337d0ec02b313ffca03c5b3c84f057e7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">回味2023</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>