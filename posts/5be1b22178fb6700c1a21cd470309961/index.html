<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>通过SQL语句直接实现Excel与数据库的导入导出 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="通过SQL语句直接实现Excel与数据库的导入导出" />
<meta property="og:description" content="导入/导出Excel 1.--从Excel文件中,导入数据到SQL数据库中,很简单,直接用下面的语句: /*===================================================================*/ --如果接受数据导入的表已经存在
insert into 表 select * from OPENROWSET ( &#39; MICROSOFT.JET.OLEDB.4.0 &#39; , &#39; Excel 5.0;HDR=YES;DATABASE=c: est.xls &#39; ,sheet1$) --如果导入数据并生成表 select * into 表 from OPENROWSET ( &#39; MICROSOFT.JET.OLEDB.4.0 &#39; , &#39; Excel 5.0;HDR=YES;DATABASE=c: est.xls &#39; ,sheet1$) /*===================================================================*/
2.--从SQL数据库中,导出数据到Excel: --如果从SQL数据库中,导出数据到Excel,如果Excel文件已经存在,而且已经按照要接收的数据创建好表头,就可以简单的用:
insert into OPENROWSET ( &#39; MICROSOFT.JET.OLEDB.4.0 &#39; , &#39; Excel 5.0;HDR=YES;DATABASE=c: est.xls &#39; ,sheet1$) select * from 表 --如果Excel文件不存在,也可以用BCP来导成类Excel的文件,注意大小写: --导出表的情况
EXEC master..xp_cmdshell &#39; bcp 数据库名.dbo.表名 out &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/5be1b22178fb6700c1a21cd470309961/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-03-04T21:38:46+08:00" />
<meta property="article:modified_time" content="2018-03-04T21:38:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">通过SQL语句直接实现Excel与数据库的导入导出</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="postText" style='margin:0px; padding:0px; color:rgb(69,69,69); font-family:"PingFang SC","Microsoft YaHei",SimHei,Arial,SimSun; font-size:16px'> 
 <p style="margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify"> 导入/导出Excel <br style=""> 1.--从Excel文件中,导入数据到SQL数据库中,很简单,直接用下面的语句:<br style=""> /*===================================================================*/<br style=""> --如果接受数据导入的表已经存在</p> 
 <div style="margin:0px; padding:4px 5.4pt; border-width:0.5pt; border-style:solid; border-color:initial; background:rgb(230,230,230)"> 
  <div style="margin:0px; padding:0px"> 
   <img alt="" align="top" src="https://images2.imgbox.com/c9/87/M1xMVkrb_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">insert</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">into</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> 表 </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">*</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">from</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/97/44/LXgtIbAT_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">OPENROWSET</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">MICROSOFT.JET.OLEDB.4.0</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/60/d8/kxmhztqq_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">Excel 5.0;HDR=YES;DATABASE=c: est.xls</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,sheet1$)</span> 
  </div> 
 </div> 
 <p style="margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify"> --如果导入数据并生成表<br style=""> </p> 
 <div style="margin:0px; padding:4px 5.4pt; border-width:0.5pt; border-style:solid; border-color:initial; background:rgb(230,230,230)"> 
  <div style="margin:0px; padding:0px"> 
   <img alt="" align="top" src="https://images2.imgbox.com/d9/05/GAS8dEHR_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">*</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">into</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> 表 </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">from</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/05/96/S58afPaS_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">OPENROWSET</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">MICROSOFT.JET.OLEDB.4.0</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ca/73/wN6BDMP7_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">Excel 5.0;HDR=YES;DATABASE=c: est.xls</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,sheet1$)</span> 
  </div> 
 </div> 
 <p style="margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify"> /*===================================================================*/</p> 
 <p style="margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify"> 2.--从SQL数据库中,导出数据到Excel:<br style=""> --如果从SQL数据库中,导出数据到Excel,如果Excel文件已经存在,而且已经按照要接收的数据创建好表头,就可以简单的用:</p> 
 <div style="margin:0px; padding:4px 5.4pt; border-width:0.5pt; border-style:solid; border-color:initial; background:rgb(230,230,230)"> 
  <div style="margin:0px; padding:0px"> 
   <img alt="" align="top" src="https://images2.imgbox.com/4f/b2/2ptAHCzA_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">insert</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">into</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">OPENROWSET</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">MICROSOFT.JET.OLEDB.4.0</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ee/60/oS0VhWW1_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">Excel 5.0;HDR=YES;DATABASE=c: est.xls</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,sheet1$)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/a9/05/y5wGbCyI_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">*</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">from</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> 表</span> 
  </div> 
 </div> 
 <p style="margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify"> <br style=""> --如果Excel文件不存在,也可以用BCP来导成类Excel的文件,注意大小写:<br style=""> --导出表的情况</p> 
 <div style="margin:0px; padding:4px 5.4pt; border-width:0.5pt; border-style:solid; border-color:initial; background:rgb(230,230,230)"> 
  <div style="margin:0px; padding:0px"> 
   <img alt="" align="top" src="https://images2.imgbox.com/07/07/x6oLrzcs_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">EXEC</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> master..xp_cmdshell </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">bcp 数据库名.dbo.表名 out "c: est.xls" /c -/S"服务器名" /U"用户名" -P"密码"</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
  </div> 
 </div> 
 <p style="margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify"> --导出查询的情况<br style=""> </p> 
 <div style="margin:0px; padding:4px 5.4pt; border-width:0.5pt; border-style:solid; border-color:initial; background:rgb(230,230,230)"> 
  <div style="margin:0px; padding:0px"> 
   <img alt="" align="top" src="https://images2.imgbox.com/a9/f9/FNsu8v8K_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">EXEC</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> master..xp_cmdshell </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">bcp "SELECT au_fname, au_lname FROM pubs..authors ORDER BY au_lname" queryout "c: est.xls" /c -/S"服务器名" /U"用户名" -P"密码"</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/a6/61/2CBzWcDJ_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
  </div> 
 </div> 
 <p style="margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify"> /*--说明:<br style=""> c:/test.xls  为导入/导出的Excel文件名.<br style=""> sheet1$      为Excel文件的工作表名,一般要加上$才能正常使用.<br style=""> --*/<br style="">  </p> 
 <p style="margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify"> 3.--建立存储过程，导出真正的Excel文件（用此方法导出的Excel文件在用于导入时不会报错）</p> 
 <div style="margin:0px; padding:4px 5.4pt; border-width:0.5pt; border-style:solid; border-color:initial; background:rgb(230,230,230)"> 
  <div style="margin:0px; padding:0px"> 
   <img alt="" align="top" src="https://images2.imgbox.com/e5/ef/8SfMaI0H_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">下面是导出真正Excel文件的方法:（请将一下所有代码复制到存储过程中）</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/31/32/pMizJZJY_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f0/e2/ApfAY8Y9_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">exists</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> (</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">*</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">from</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> dbo.sysobjects </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">where</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> id </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">object_id</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(N</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">[dbo].[p_exporttb]</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">) </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">and</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">OBJECTPROPERTY</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(id, N</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">IsProcedure</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">) </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>1</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e0/59/ww3i7nq9_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">drop</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">procedure</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">[</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">dbo</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">]</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">.</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">[</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">p_exporttb</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">]</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/61/4c/c8v9X91D_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">GO</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/65/12/FHYG3q4w_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/de/9d/gUFBs4Zx_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px; color:rgb(0,128,128)">/*</span><span style="margin:0px; padding:0px; color:rgb(0,128,128)">--数据导出EXCEL<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ff/c2/1FvV6eP0_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/bf/17/MIjVWFx1_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 导出表中的数据到Excel,包含字段名,文件为真正的Excel文件<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/7f/68/47U6R9as_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> ,如果文件不存在,将自动创建文件<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/89/08/ZA3wevYp_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> ,如果表不存在,将自动创建表<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/90/03/Ii0veZI4_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 基于通用性考虑,仅支持导出标准数据类型<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ee/af/WxWJZqqU_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/89/d9/5aNkk59a_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">--邹建 2003.10(引用请保留此信息)--</span><span style="margin:0px; padding:0px; color:rgb(0,128,128)">*/</span></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/4d/22/8v13truq_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/cc/84/woNzi7q5_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px; color:rgb(0,128,128)">/*</span><span style="margin:0px; padding:0px; color:rgb(0,128,128)">--调用示例<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/08/70/GJlvYbWU_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/4f/cd/I89qGPAq_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> p_exporttb @tbname='地区资料',@path='c:',@fname='aa.xls'<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/b4/ba/y3oxYpLo_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">--</span><span style="margin:0px; padding:0px; color:rgb(0,128,128)">*/</span></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/8b/91/YgbGXg2x_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">create</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">proc</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> p_exporttb<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/fa/7c/97T9rqpY_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@tbname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> sysname,    </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">要导出的表名</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/5b/4d/u3HLxFhU_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>nvarchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>1000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">文件存放目录</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/dd/50/mszMg20M_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>nvarchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>250</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">  </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">文件名,默认为表名</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e5/c7/UDfA075N_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">as</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/8d/c1/sop5uRzX_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">declare</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>int</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@src</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>nvarchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>255</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@desc</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>nvarchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>255</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@out</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>int</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/cd/2f/8axNz3LE_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">declare</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@obj</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>int</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@constr</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>nvarchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>1000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>varchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>8000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>varchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>8000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ba/9e/GhzkKasR_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/1e/c3/c9PZQe6b_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">参数检测</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/cb/85/d4Cj8MXC_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">isnull</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@tbname</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">.xls</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f0/b1/FZ3NXhwH_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/24/ee/vfISgZZF_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">检查文件是否已经存在</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/3e/63/fYrDfv9t_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">right</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>1</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">&lt;&gt;</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)"></span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)"></span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/c3/aa/hfX8xSjS_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">create</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">table</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> #tb(a </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>bit</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,b </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>bit</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,c </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>bit</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/90/38/uYjhReQb_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/b0/3c/ojE1Ia6h_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">insert</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">into</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> #tb </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> master..xp_fileexist </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/24/f9/0QOSSJPW_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/5b/72/lhFMPAC7_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">数据库创建语句</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/89/97/UScJkkec_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/d8/66/DrTb9F4g_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">exists</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>1</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">from</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> #tb </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">where</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> a</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>1</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/3b/f5/MZsYhclY_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@constr</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">DRIVER={Microsoft Excel Driver (*.xls)};DSN=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''''</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">;READONLY=FALSE</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/84/34/WHZVqGQj_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">       </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">;CREATE_DB="</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">";DBQ=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/36/93/WfDCrxgy_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">else</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/0a/92/bkouJ1if_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@constr</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">Provider=Microsoft.Jet.OLEDB.4.0;Extended Properties="Excel 8.0;HDR=YES</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/52/08/pJXpSokD_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">    </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">;DATABASE=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">"</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/1e/0c/S3E4C73z_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/a8/b9/AZBThRrn_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/9e/07/beJsEfZm_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">连接数据库</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/22/46/UrAGCKth_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">sp_oacreate </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">adodb.connection</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@obj</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> out<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/00/bb/l60sM3fc_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">&lt;&gt;</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>0</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">goto</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> lberr<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/6a/74/c5IIb93d_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/a3/a2/WcTdgflv_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">sp_oamethod </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@obj</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">open</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">null</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@constr</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f0/ce/f3GWEYXt_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">&lt;&gt;</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>0</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">goto</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> lberr<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/bb/65/l0ZL7T6l_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/1a/31/47Ruf8c7_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px; color:rgb(0,128,128)">/*</span><span style="margin:0px; padding:0px; color:rgb(0,128,128)">--如果覆盖已经存在的表,就加上下面的语句<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f9/6c/tA6am4HU_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">--创建之前先删除表/如果存在的话<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ed/b8/JXrtTO1a_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">select @sql='drop table ['+@tbname+']'<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e4/74/4lmmbfnn_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">exec @err=sp_oamethod @obj,'execute',@out out,@sql<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/9d/6c/2gIzGh4v_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">--</span><span style="margin:0px; padding:0px; color:rgb(0,128,128)">*/</span></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f4/a6/xjkMhHuM_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/3a/be/PwueocvS_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">创建表的SQL</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/2a/5f/JqMOF5oh_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/a6/dc/Jg7JR771_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">,[</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">a.name</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">]</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/a0/12/xQU9ZMGr_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> ,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">,[</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">a.name</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">] </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/03/42/RZHdRx2V_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">  </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">case</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/48/b1/cLy7kJAe_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">when</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">like</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">%char</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/d6/8c/6ghiCG1a_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">then</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">case</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">when</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> a.length</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">&gt;</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>255</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">then</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">memo</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/b5/1b/li6NBHDI_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">    </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">else</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">text(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">cast</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(a.length </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">as</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>varchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">end</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/37/bb/6St1m77C_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">when</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">like</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">%int</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">or</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">bit</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">then</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">int</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/fb/8b/2nFwlL4A_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">when</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">like</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">%datetime</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">then</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">datetime</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f6/7c/uGBjCQQ2_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">when</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">like</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">%money</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">then</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">money</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/07/d1/NfAkCnv3_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">when</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">like</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">%text</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">then</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">memo</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/c3/7c/9vCW7q1c_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">else</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">end</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/0c/b7/hKJBXm7T_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">FROM</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> syscolumns a </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">left</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">join</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> systypes b </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">on</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> a.xtype</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">b.xusertype<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/bc/c2/dEJUnFLM_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">where</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">not</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">in</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">image</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">uniqueidentifier</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">sql_variant</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">varbinary</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">binary</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">timestamp</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/99/2a/VjdzDEZe_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">and</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">object_id</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@tbname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">id<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e6/12/rHa3kW3t_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">create table [</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@tbname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/0c/c7/8PKff1at_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">](</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">substring</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>2</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>8000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/09/57/08Ir2jXH_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> ,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">substring</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>2</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>8000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/2a/96/QrLrnsoe_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">sp_oamethod </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@obj</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">execute</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@out</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> out,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/6f/63/YzmfwwHy_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">&lt;&gt;</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>0</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">goto</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> lberr<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/c9/44/iJYEUByN_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/7d/7f/sUrSslNz_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">sp_oadestroy </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@obj</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/9f/61/4HBwzPEV_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/1e/91/7O4Ikp6e_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">导入数据</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/48/0a/D5sAloVh_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">openrowset(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">MICROSOFT.JET.OLEDB.4.0</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">Excel 8.0;HDR=YES;IMEX=1<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/60/7b/ADN8svyO_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   ;DATABASE=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'''</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">,[</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@tbname</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">$])</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/78/90/Z0rQoflp_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/de/ca/qbVCBk5k_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">insert into </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">) select </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)"> from </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@tbname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/34/e4/t1trpclG_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/c0/c9/0LZ4S9CU_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">return</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/6a/c7/InposBtn_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/aa/6b/YDwyiOY4_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">lberr:<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/98/5d/gY8VKMcH_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> sp_oageterrorinfo </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>0</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@src</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> out,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@desc</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> out<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/77/ea/SpIDDBcN_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">lbexit:<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/27/16/VbZWU60V_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">cast</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">as</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>varbinary</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>4</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)) </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">as</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> 错误号<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/d5/38/5ftpCJDp_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">  ,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@src</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">as</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> 错误源,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@desc</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">as</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> 错误描述<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e6/c3/PBuJFLPz_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@constr</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/31/dd/ZblLxbtA_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">go</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e0/0a/Hnaxe8Tc_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/d3/29/BSNMuupa_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/3a/03/FtbFGmSh_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/d8/6e/67a9mp2j_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">exists</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> (</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">*</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">from</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> dbo.sysobjects </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">where</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> id </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">object_id</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(N</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">[dbo].[p_exporttb]</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">) </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">and</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">OBJECTPROPERTY</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(id, N</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">IsProcedure</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">) </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>1</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/33/2e/6zsRMZ2C_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">drop</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">procedure</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">[</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">dbo</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">]</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">.</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">[</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">p_exporttb</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">]</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/47/4a/X148Jlbc_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">GO</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ce/7b/mt89Klnn_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/66/0a/9FncUE4Y_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px; color:rgb(0,128,128)">/*</span><span style="margin:0px; padding:0px; color:rgb(0,128,128)">--数据导出EXCEL<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/01/12/i4wLGUrF_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/d6/14/5Vrt6vds_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 导出查询中的数据到Excel,包含字段名,文件为真正的Excel文件<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/cf/ab/SleTZjpZ_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 如果文件不存在,将自动创建文件<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/47/11/6mCgmDTR_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 如果表不存在,将自动创建表<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/93/04/P3S3bLTE_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 基于通用性考虑,仅支持导出标准数据类型<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ec/30/LMcdzv3C_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/69/4c/e7UBncOe_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">--邹建 2003.10(引用请保留此信息)--</span><span style="margin:0px; padding:0px; color:rgb(0,128,128)">*/</span></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/c6/a0/DAlE6Cc7_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/b9/79/XVYfb7zG_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px; color:rgb(0,128,128)">/*</span><span style="margin:0px; padding:0px; color:rgb(0,128,128)">--调用示例<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e1/8e/yG8y2yyx_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/5a/2f/kfNWFgH0_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> p_exporttb @sqlstr='select * from 地区资料'<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/7e/66/jGDUrmNa_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">  ,@path='c:',@fname='aa.xls',@sheetname='地区资料'<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/55/e0/SNDSQSh6_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">--</span><span style="margin:0px; padding:0px; color:rgb(0,128,128)">*/</span></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f4/b1/DMOaYwkM_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">create</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">proc</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> p_exporttb<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/da/ee/l7E6zvkR_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sqlstr</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>varchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>8000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">查询语句,如果查询语句中使用了order by ,请加上top 100 percent</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/82/85/ba6jdonV_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>nvarchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>1000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">文件存放目录</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/d7/e9/QQ1VAoSF_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>nvarchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>250</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">文件名</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/6a/fc/8CPYjJKg_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sheetname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>varchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>250</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">  </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">要创建的工作表名,默认为文件名</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ec/a3/yqvS04kg_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">as</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ed/42/gbLibPFC_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">declare</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>int</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@src</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>nvarchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>255</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@desc</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>nvarchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>255</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@out</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>int</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/83/df/1f6QB9aW_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">declare</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@obj</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>int</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@constr</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>nvarchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>1000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>varchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>8000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>varchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>8000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/4a/10/ANJesnRh_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/bd/b8/RU08INlc_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">参数检测</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/2d/11/lQ7HUEBT_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">isnull</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">temp.xls</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f7/6f/w9ntcggk_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">isnull</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sheetname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sheetname</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">replace</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">.</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">#</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e6/01/WjutEPGm_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/2b/3c/YHpsbbWT_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">检查文件是否已经存在</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/3b/9e/II4t2gbB_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">right</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>1</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">&lt;&gt;</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)"></span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)"></span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/d2/15/gu1CyNpv_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">create</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">table</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> #tb(a </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>bit</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,b </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>bit</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,c </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>bit</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/8e/ee/QSqlEyCx_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ec/d3/g5SmDPw6_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">insert</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">into</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> #tb </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> master..xp_fileexist </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/3c/0b/jyo6vxgg_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/95/13/TcqyY5wb_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">数据库创建语句</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/8d/ee/5WHtq7f1_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/55/05/pDYAJ610_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">exists</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>1</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">from</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> #tb </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">where</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> a</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>1</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/4d/cf/qxAJ7c8C_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@constr</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">DRIVER={Microsoft Excel Driver (*.xls)};DSN=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''''</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">;READONLY=FALSE</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/0e/7a/jrK9AZbs_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">       </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">;CREATE_DB="</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">";DBQ=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/2c/77/V5xZmCXr_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">else</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/a4/e2/NKBKsrlM_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@constr</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">Provider=Microsoft.Jet.OLEDB.4.0;Extended Properties="Excel 8.0;HDR=YES</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/6d/ae/tdC7TH6q_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">    </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">;DATABASE=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">"</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/0f/bd/jIeEls4d_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/97/41/rEmyPjqF_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">连接数据库</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/97/5a/uzBRRqQI_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">sp_oacreate </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">adodb.connection</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@obj</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> out<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/20/9f/IqjUmOAo_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">&lt;&gt;</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>0</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">goto</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> lberr<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/2f/7d/Mkq1ZKSw_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/cc/1d/z05WgWfX_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">sp_oamethod </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@obj</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">open</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">null</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@constr</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/64/2c/6DH5FhBQ_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">&lt;&gt;</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>0</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">goto</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> lberr<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/3d/2c/4Lm8zMr3_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/c1/af/jVIGcXCy_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">创建表的SQL</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/6e/cc/9iKxV4MF_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">declare</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@tbname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> sysname<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/50/e0/sDNVXb4K_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@tbname</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">##tmp_</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">convert</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>varchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>38</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">),</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">newid</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">())<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/fc/f4/TRokn5dY_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">select * into [</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@tbname</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">] from(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sqlstr</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">) a</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/cc/de/hX9h24kr_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/0c/ff/onkWNTaQ_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/db/ef/I6rF7nFu_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/63/7a/cKoWzm4x_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">,[</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">a.name</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">]</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/25/82/BlGMjTOZ_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> ,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">,[</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">a.name</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">] </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/59/b2/1oPFPoIR_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">  </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">case</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/41/0a/4GKpMLUE_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">when</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">like</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">%char</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/63/91/CBdkl2EU_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">then</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">case</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">when</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> a.length</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">&gt;</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>255</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">then</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">memo</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/81/28/cjjqopYS_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">    </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">else</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">text(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">cast</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(a.length </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">as</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>varchar</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">end</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/94/03/NEIHrbqO_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">when</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">like</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">%int</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">or</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">bit</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">then</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">int</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/19/bd/4yb6XzdO_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">when</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">like</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">%datetime</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">then</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">datetime</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/c2/00/RZJN0rOY_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">when</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">like</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">%money</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">then</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">money</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/b3/09/Kvr2LdIE_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">when</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">like</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">%text</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">then</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">memo</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/8d/bb/T3bVej70_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">else</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">end</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/3a/db/4Wmu1JEP_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">FROM</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> tempdb..syscolumns a </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">left</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">join</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> tempdb..systypes b </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">on</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> a.xtype</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">b.xusertype<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/6a/f4/D6epsRgJ_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">where</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> b.name </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">not</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">in</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">image</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">uniqueidentifier</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">sql_variant</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">varbinary</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">binary</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">timestamp</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/78/16/RgQF8jV8_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">and</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> a.id</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> id </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">from</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> tempdb..sysobjects </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">where</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> name</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@tbname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/69/ea/UeE18eRd_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/72/45/XrMVtKx3_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)"><strong>@@rowcount</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>0</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">return</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e1/7e/14fKrIOe_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e1/8f/3AmWSCa0_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">create table [</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sheetname</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/c3/3e/ZdSngECl_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">](</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">substring</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>2</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>8000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">)</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e0/0c/fqn0AJBe_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> ,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">substring</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>2</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>8000</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/06/a3/hIIPlCGS_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f6/c6/rhUO2hZB_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">sp_oamethod </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@obj</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">execute</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@out</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> out,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/b9/1f/jow2fMYI_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">if</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">&lt;&gt;</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>0</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">goto</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> lberr<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/04/22/U8x9c9EX_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/a9/98/Ji5scdy0_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">sp_oadestroy </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@obj</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/3b/ce/A9JcgkE9_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f2/78/Gt3O2LLI_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">--</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)">导入数据</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,128)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/7e/21/JjyUUzHX_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">openrowset(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">MICROSOFT.JET.OLEDB.4.0</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">''</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">Excel 8.0;HDR=YES<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/b8/e1/prfnIuYb_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   ;DATABASE=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@path</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fname</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'''</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">,[</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sheetname</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">$])</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/12/7e/1KzyOFt8_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/0c/e7/pmYOhwSR_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">insert into </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">) select </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)"> from [</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@tbname</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">]</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/78/b0/Yzti87vF_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/d2/d3/0bieW5Iw_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">set</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">=</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">drop table [</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@tbname</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,128,128)">+</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">]</span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,0)">'</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/39/2b/dPHvKVxx_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/b0/03/c1n1o6M7_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">return</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/05/78/JA77ypsv_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/bf/fb/zjOuN2Q2_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">lberr:<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/7c/70/KEACSFjS_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">exec</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> sp_oageterrorinfo </span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>0</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@src</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> out,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@desc</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> out<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/29/0b/HcBdkzBd_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">lbexit:<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/d5/64/xPJGxKiB_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(255,0,255)">cast</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@err</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">as</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><strong>varbinary</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">(</span> 
   <span style="margin:0px; padding:0px; color:rgb(128,0,0)"><strong>4</strong></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">)) </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">as</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> 错误号<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ee/a7/2xH9xpnR_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">  ,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@src</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">as</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> 错误源,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@desc</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">as</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> 错误描述<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ed/8e/Ct13oriK_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">select</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@sql</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@constr</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)">,</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,128,0)">@fdlist</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/c0/b6/NSi09N84_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,255)">go</span> 
   <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/de/57/JW2Vf6Yd_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
  </div> 
 </div> 
 <p style="margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify"> 4.--在.net中导出到Excel的简单实例.</p> 
</div> 
<p style='margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; font-size:16px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify; font-family:"PingFang SC","Microsoft YaHei",SimHei,Arial,SimSun'> (1).添加引用Microsoft Excel 11.0 Object Library (在COM中)</p> 
<p style='margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; font-size:16px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify; font-family:"PingFang SC","Microsoft YaHei",SimHei,Arial,SimSun'> (2).在web.config的上&lt;system.web&gt;里加</p> 
<div style='margin:0px; padding:4px 5.4pt; color:rgb(69,69,69); font-family:"PingFang SC","Microsoft YaHei",SimHei,Arial,SimSun; font-size:16px; border-width:0.5pt; border-style:solid; border-color:initial; background:rgb(230,230,230)'> 
 <div style="margin:0px; padding:0px"> 
  <img alt="" align="top" src="https://images2.imgbox.com/0b/34/7FwonSiS_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)">&lt;</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)">identity impersonate</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)">=</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)">"</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)">true</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)">"</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)">/&gt;</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/d5/2a/cABbwi8S_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/3a/72/2Nl71WUR_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
  <span style="margin:0px; padding:0px; color:rgb(0,128,0)">//</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,128,0)">此句为了使用户能在本地打开文档，identify属性规定了身份验证的模式，一般情况下为false，这样安全性较高<br style=""> <img alt="" align="top" src="https://images2.imgbox.com/00/71/83VHGjjS_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
 </div> 
</div> 
<p style='margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; font-size:16px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify; font-family:"PingFang SC","Microsoft YaHei",SimHei,Arial,SimSun'> (3).在Text.aspx上加Button1控件</p> 
<p style='margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; font-size:16px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify; font-family:"PingFang SC","Microsoft YaHei",SimHei,Arial,SimSun'> (4).在cs页面添加 using Microsoft.Office.Interop.Excel;</p> 
<p style='margin-top:0px; margin-bottom:16px; padding-top:0px; padding-bottom:0px; font-size:16px; color:rgb(79,79,79); line-height:26px; min-height:26px; text-align:justify; font-family:"PingFang SC","Microsoft YaHei",SimHei,Arial,SimSun'> (5).添加单击事件,在这里处理将数据库中的数据导入excel,代码如下:</p> 
<div style='margin:0px; padding:4px 5.4pt; color:rgb(69,69,69); font-family:"PingFang SC","Microsoft YaHei",SimHei,Arial,SimSun; font-size:16px; border-width:0.5pt; border-style:solid; border-color:initial; background:rgb(230,230,230)'> 
 <div style="margin:0px; padding:0px"> 
  <img alt="" align="top" src="https://images2.imgbox.com/85/10/EOOzgixR_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"> 
  <span style="margin:0px; padding:0px; color:rgb(0,128,0)">//</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,128,0)">定义方法GetData(),返回一个数据表 </span> 
  <span style="margin:0px; padding:0px; color:rgb(0,128,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/fa/79/JWmeaS0N_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,255)">private</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> System.Data.DataTable GetData() <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/9e/dc/aY5cdJLQ_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
  <span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px; color:rgb(0,0,0)">{ <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/a7/c5/xuv2hj0d_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      SqlConnection conn</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">=</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">new</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> SqlConnection(</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">@"</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">Server=XJIE;Initial Catalog=Northwind;Uid=sa;Pwd=xjie;</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">"</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">); <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f5/b4/p1ntoc1R_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      SqlDataAdapter adapter</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">=</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">new</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> SqlDataAdapter(</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">"</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">select  CompanyName 用户名,ContactTitle 联系主题,Address 住宅地址,ContactName 联系人,Phone 电话,City 城市 from Customers order by CustomerID desc</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">"</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">,conn); <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/07/d0/urU3Nif4_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      DataSet ds</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">=</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">new</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> DataSet(); <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f0/48/qG8RTHa7_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">try</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/2d/15/bMouVfrj_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      </span><span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px; color:rgb(0,0,0)">{ <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/78/41/pNLlE8fw_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   adapter.Fill(ds,</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">"</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">Customer</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">"</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">); <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/81/a8/yyQJbb0K_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      }</span></span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/84/19/R3hngoCg_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">catch</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">(Exception ex) <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/b6/e9/qJlZBE83_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      </span><span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px; color:rgb(0,0,0)">{ <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/54/53/bCEO48AE_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   MessageBox.Show(ex.ToString()); <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/1f/f1/2mj08uVZ_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      }</span></span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/34/41/ZxJF9OP1_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> ds.Tables[</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">0</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">]; <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/16/14/E5cSxBHK_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">}</span></span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/8e/bc/rn8jB3rq_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/37/8d/PcCa39y5_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ef/9f/gUQKNUpz_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,255)">private</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,255)">void</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> Button1_Click(</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,255)">object</span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> sender, System.EventArgs e) <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/23/84/Ck8AJQHa_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
  <span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px; color:rgb(0,0,0)">{ <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/91/dc/k9inFU6F_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      Application excel</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">=</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">new</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> Application(); <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/18/ba/3OyjdL98_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> rowIndex</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">=</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">1</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">; <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/83/aa/pyPCGIl7_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> colIndex</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">=</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">0</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">; <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/5b/78/ISmGDgNh_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/5a/38/bTokWjiJ_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      excel.Application.Workbooks.Add(</span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">true</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">); <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/5b/ec/5EW3iFib_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">     <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ef/54/lwtaNKWk_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      DataTable table</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">=</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">GetData(); <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/14/06/1BHVMKWt_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/8f/12/WFrTBEtJ_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      </span><span style="margin:0px; padding:0px; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; color:rgb(0,128,0)">将所得到的表的列名,赋值给单元格 </span><span style="margin:0px; padding:0px; color:rgb(0,128,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/61/e9/vRIAGQsO_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">      </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">foreach</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">(DataColumn col </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">in</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> table.Columns) <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/ff/2c/NIyeNkQr_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      </span><span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px; color:rgb(0,0,0)">{ <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/0d/b6/bQdgIW3P_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   colIndex</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">++</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">;  <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f1/cb/y9L8annO_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   excel.Cells[</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">1</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">,colIndex]</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">=</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">col.ColumnName;     <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e8/e7/VJslB61Q_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      }</span></span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/b9/09/EM6T8WwM_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/05/2d/rmnfIfPU_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      </span><span style="margin:0px; padding:0px; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; color:rgb(0,128,0)">同样方法处理数据 </span><span style="margin:0px; padding:0px; color:rgb(0,128,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/54/65/YP3jN1a8_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">      </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">foreach</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">(DataRow row </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">in</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> table.Rows) <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/e7/47/9V3YmtNV_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      </span><span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px; color:rgb(0,0,0)">{ <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/da/47/oWlPeG0Z_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   rowIndex</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">++</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">; <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/01/17/xczLmkp4_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   colIndex</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">=</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">0</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">; <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/55/94/ClbElzFC_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">foreach</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">(DataColumn col </span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">in</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> table.Columns) <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/11/a3/yUXXc61Y_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   </span><span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px; color:rgb(0,0,0)">{ <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/04/da/VQCPcVaN_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">         colIndex</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">++</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">; <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/a2/73/mg8zwBbH_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">         excel.Cells[rowIndex,colIndex]</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">=</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">row[col.ColumnName].ToString(); <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/fb/e9/hvbSoJwX_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">   }</span></span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/fc/11/cGMmBcud_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      }</span></span><span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/b1/3b/tz1fUzQf_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">      </span><span style="margin:0px; padding:0px; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; color:rgb(0,128,0)">不可见,即后台处理 </span><span style="margin:0px; padding:0px; color:rgb(0,128,0)"><br style=""> <img alt="" align="top" src="https://images2.imgbox.com/a0/3c/Hu4e9EU4_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">      excel.Visible</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">=</span><span style="margin:0px; padding:0px; color:rgb(0,0,255)">true</span><span style="margin:0px; padding:0px; color:rgb(0,0,0)">; <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/f6/b4/ujVHHDdH_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px">}</span></span> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)"> <br style=""> <img alt="" align="top" src="https://images2.imgbox.com/0e/7c/oYH6JIu1_o.gif" style="border:0px; outline:0px; max-width:100%; margin:0px 0px 24px"></span> 
 </div> 
 <div> 
  <span style="margin:0px; padding:0px; color:rgb(0,0,0)"><br> </span> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c5969b3466e7389b55911d6ac295ba68/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">级联MobileNet-V2实现CelebA人脸关键点检测（附训练源码）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e33b8d0b662b5da0092d0c4d933e8108/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">keepalived精编问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>