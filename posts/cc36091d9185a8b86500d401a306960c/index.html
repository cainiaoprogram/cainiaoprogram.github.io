<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>计网知识点3-数据链路层-4流量控制与可靠传输机制 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="计网知识点3-数据链路层-4流量控制与可靠传输机制" />
<meta property="og:description" content="了解数据链路层的基本概念和功能的基础上，重点掌握滑动窗口机制、三种可靠传输协议、各种MAC协议、HDLC协议和PPP协议，特别是CSMA/CD协议和以太网帧格式，以及局域网的争用期和最小帧长的概念、二进制指数退避算法。中继器、网卡、集线器、网桥和局域网交换机的原理及区别要重点掌握。
3.4流量控制与可靠传输机制 3.4.1流量控制、可靠传输与滑动窗口机制 流量控制涉及对链路上的帧的发送速率的控制，以使接收方有足够的缓冲空间来接收每个帧。例如在面向帧的自动重传请求系统中，当待确认帧的数量增加时，有可能超出缓冲存储空间而造成过载。流量控制的基本方法是由接收方控制发送方发送数据的速率，常见的方式有如下两种：
1.停止-等待流量控制基本原理 发送方每发送一帧，都要等待接收方的应答信号，才能发送下一帧；接收方每接收一帧，都要反馈一个应答信号，表示可接收下一帧。每次只发送一帧就要等待确认，传输效率很低。
2.滑动窗口流量控制基本原理 任意时刻，发送方都维持一组连续的允许发送的帧的序号，称发送窗口；同时接收方也维持一组连续的允许接收帧的序号，称接收窗口。发送窗口用来对发送方进行流量控制，而发送窗口的大小 WT代表在还未收到对方确认信息的情况下发送方最多还可以发送多少个数据帧。同理，接收端的接收窗口控制接收哪些数据帧。接收方收到的数据帧的序号落入接收窗口内时，才能接收，否则丢弃。
发送端每收到一个确认帧，发送窗口就向前滑动一个帧的位置，当发送窗口内没有可以发送的帧（即窗口内的帧全部是已发送但未收到确认的帧）时，发送方就会停止发送，直到收到接收方发送的确认帧使窗口移动，窗口内有可以发送的帧后，继续发送。
接收端收到数据帧后，将窗口向前移动一个位置，并发回确认帧，若收到的数据帧落在接收窗口之外，则一律丢弃。
滑动窗口有以下重要特性：
只有接收窗口向前滑动时，发送窗口才有可能向前滑动。从发送窗口的概念看，其他协议只在发送窗口和接收窗口上有差别：停止-等待协议是发送和接收窗口大小都为1；后退N帧协议是发送窗口大于1，接收窗口大小为1；选择重传协议是发送和接收窗口的大小都大于1.接收窗口的大小为1时，可保证帧的有序接收。数据链路层的滑动窗口协议中，窗口的大小在传输过程中是固定的。 3.可靠传输机制 数据链路层的可靠传输通常使用确认和超时传输两种机制来完成。确认是一种无数据的控制帧，这种控制帧使得接收方可以让发送方知道哪些内容被正确接收。有时为提高传输效率，将确认捎带在一个回复帧中，称为捎带确认。超时重传是指发送方在发送某个数据帧后就开启一个计时器，在一定时间内如果没有得到发送的数据帧的确认帧，那么就重新发送该数据帧，直到发送成功为止。
自动重传请求（Auto Repeat reQuest，ARQ）通过接收方请求发送方重传出错的数据帧来恢复出错的帧，是通信中用于处理信道所带来差错的方法之一。传统自动重传请求分为三种，即停止-等待（Stop-and-Wait）ARQ、后退N帧（Go-Back-N）ARQ和选择性重传（Selective Repeat）ARQ。后两种协议是滑动窗口技术与请求重发技术的结合，由于窗口尺寸开到足够大时，帧在线路上可以连续地流动，因此又称其为连续ARQ协议。在数据链路层中流量控制机制和可靠传输机制是交织在一起的。现有的实际有线网络的数据链路层很少采用可靠传输。
3.4.2单帧滑动窗口与停止-等待协议 在停止-等待协议中，源站发送单个帧后必须等待确认，在目的站的回答到达源站之前，源站不能发送其他的数据帧。从滑动窗口机制的角度看，停止-等待协议相当于发送窗口和接收窗口大小均为1的滑动窗口协议。
在停止-等待协议中，除数据帧丢失外，还可能出现以下两种差错。
到达目的站的帧可能已遭破坏，接收站利用前面讨论过的差错检测技术检出后，简单地将该帧丢弃。为了对付这种情况，源站装备了计时器。在一个帧发送之后，源站等待确认，如果计时器计满时仍未收到确认，那么再次发送相同的帧。如此重复，直到该数据帧正确到达。
数据帧正确而确认帧被破坏，此时接收方已收到正确的数据帧，但发送方收不到确认帧，就会重传数据帧，接收方收到重复的数据帧后会丢弃，并重传一个该帧对应的确认帧。发送的帧交替地用0和1来标识，肯定确认分别用ACK0和ACK1来表示，收到的确认有误时，重传已发送的帧。对于停止-等待协议，由于每发送一个数据帧就停止并等待，因此用1bit来编号就足够。在停止-等待协议中，若连续出现相同发送序号的数据帧，表明发送端进行了超时重传。连续出现相同序号的确认帧时，表明接收端收到了重复帧。
为了超时重发和判定重复帧的需要，发送方和接收方都要设置一个帧缓冲区。发送端在发送完数据帧时，必须在其发送缓存中保留此数据帧的副本，才能在出错时进行重传。只有收到对方发来的确认帧ACK时，方可清除此副本。
停止-等待协议通信信道的利用率很低，为克服这一缺点，就产生了后退N帧协议和选择重传协议。
3.4.3多帧滑动窗口与后退N帧协议（GBN） 在后退N帧式ARQ中，发送方无须在收到上一个帧的ACK后才能开始发送下一帧，而是可以连续发送帧。当接收方检测出失序的信息帧后，要求发送方重发最后一个正确接收的信息帧之后的所有未被确认的帧。当发送方发送了N个帧后，若发现该N个帧的前一个帧在计时器超时后仍未返回其确认信息，则该帧被判为出错或丢失，此时发送方就不得不重传该出错帧及随后的N个帧。即接收方只允许按顺序接收帧。
源站向目的站发送数据帧。当源站发完0号帧后，可以继续发送后续的1、2号帧等。源站每发送完一帧就要为该帧设置超时计时器。由于连续发送了许多帧，所以确认帧必须要指明是对哪一帧进行确认。为了减少开销，GBN协议还规定接收端不一定每收到一个正确的数据帧就必须立即发回一个确认帧，而可以在连续收到好几个正确的数据帧后，才对最后一个数据帧发确认消息，或者可在自己有数据要发送时才将对以前正确收到的帧加以捎带确认。即对某一数据帧的确认就表明该数据帧和此前所有的数据帧均已正确无误地收到。ACKn表示对第n号帧的确认，表示接收方已正确收到第n号帧及以前的所有帧，下一次期望收到第n&#43;1号帧（也可能是第0号帧）。接收端只按序接收数据帧。接收端对有差错帧后面的正确帧也要丢弃，而且重复发送已发送的最后一个确认帧ACK1，以防止它丢失了。
后退N帧协议的接收窗口为1，可以保证按序接收数据帧。若采用n比特对帧编号，则其发送窗口的尺寸WT应满足大于等于1且小于等于2的n次方-1。若发送窗口的尺寸大于2的n次方-1，则会造成接收方无法分辨新帧和旧帧。
后退N帧协议因连续发送数据帧而提高了信道的利用率，但在重传时又必须把原来已发送正确的数据帧重传，又使传送效率降低。若信道传输质量很差导致误码率较大时，它不一定优于停止-等待协议。
3.4.4多帧滑动窗口与选择重传协议（SR） 选择重传ARQ协议，为进一步提高信道的利用率，可设法只重传出现差错的数据帧或计时器超时的数据帧，但此时必须加大接收窗口，以便先收下发送序号不连续但仍处在接收窗口中的那些数据帧。等到所缺序号的数据帧收到后再一并送交主机。
在选择重传协议中，每个发送缓冲区对应一个计时器，当计时器超时时，缓冲区的帧就会重传。另外，该协议使用了比上述其他协议更有效的差错处理策略，即一旦接收方怀疑帧出错，就会发一个否定帧NAK给发送方，要求发送方对NAK中指定的帧进行重传。
选择重传协议的接收窗口尺寸WR和发送窗口尺寸WT都大于1，一次可以发送或接收多个帧。若采用n比特对帧编号，为了保证接收方向前移动窗口后，新窗口序号与旧窗口序号没有重叠部分，需要满足条件：接收窗口WR &#43; 发送窗口WT 小于等于2^n。假定仍然采用累计确认的方法，并且接收窗口要小于发送窗口，否则无意义，即接收窗口尺寸不应超过序号范围的一半。一般情况下在SR协议中，接收窗口和发送窗口的大小是相同的。
选择重传协议可避免重复发送那些本已正确到达接收端的数据帧，但在接收端要设置具有相当容量的缓冲区来暂存那些未按序正确收到的帧。接收端不能接收窗口下界以下或窗口上界以上的序号的帧，因此所需缓冲区的数目等于窗口的大小，而不是序号数目。
信道效率（信道利用率），从时间角度定义，信道效率是对发送方而言的，是指发送方在一个发送周期的时间内，有效地发送数据所需要的时间占整个发送周期的比率。
发送方从开始发送数据到收到第一个确认帧为止，称为一个发送周期T，发送方在这个周期内共发送L比特的数据，发送方的数据传输速率为C，则发送方用于发送有效数据的时间是L/C，信道利用率为（L/C）/T
信道吞吐率=信道利用率x发送方的发送速率
流量控制的三种滑动窗口协议的信道利用率是一个关键知识点。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/cc36091d9185a8b86500d401a306960c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-01T14:48:59+08:00" />
<meta property="article:modified_time" content="2023-03-01T14:48:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">计网知识点3-数据链路层-4流量控制与可靠传输机制</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>了解数据链路层的基本概念和功能的基础上，<strong>重点掌握</strong><span style="color:#fe2c24;">滑动窗口机制</span>、三种可靠传输协议、各种MAC协议、HDLC协议和PPP协议，特别是CSMA/CD协议和以太网帧格式，以及局域网的争用期和最小帧长的概念、二进制指数退避算法。中继器、网卡、集线器、网桥和局域网交换机的原理及区别要重点掌握。</p> 
<h2>3.4流量控制与可靠传输机制</h2> 
<h3>3.4.1流量控制、可靠传输与滑动窗口机制</h3> 
<p>流量控制涉及对链路上的帧的发送速率的控制，以使接收方有足够的缓冲空间来接收每个帧。例如在面向帧的自动重传请求系统中，当待确认帧的数量增加时，有可能超出缓冲存储空间而造成过载。流量控制的基本方法是由接收方控制发送方发送数据的速率，常见的方式有如下两种：</p> 
<h4>1.停止-等待流量控制基本原理</h4> 
<p>发送方每发送一帧，都要等待接收方的应答信号，才能发送下一帧；接收方每接收一帧，都要反馈一个应答信号，表示可接收下一帧。每次只发送一帧就要等待确认，传输效率很低。</p> 
<h4>2.滑动窗口流量控制基本原理</h4> 
<p>任意时刻，发送方都<strong>维持一组连续的允许发送的帧的序号</strong>，称<strong>发送窗口</strong>；同时接收方也<strong>维持一组连续的允许接收帧的序号</strong>，称<strong>接收窗口</strong>。发送窗口用来对发送方进行流量控制，而发送窗口的大小 WT代表在还未收到对方确认信息的情况下发送方最多还可以发送多少个数据帧。同理，接收端的接收窗口控制接收哪些数据帧。接收方收到的数据帧的序号落入接收窗口内时，才能接收，否则丢弃。</p> 
<p><strong>发送端每收到一个确认帧，发送窗口就向前滑动一个帧的位置，</strong>当发送窗口内没有可以发送的帧（即窗口内的帧全部是已发送但未收到确认的帧）时，发送方就会停止发送，直到收到接收方发送的确认帧使窗口移动，窗口内有可以发送的帧后，继续发送。</p> 
<p><strong>接收端收到数据帧后，将窗口向前移动一个位置，并发回确认帧</strong>，若收到的数据帧落在接收窗口之外，则一律丢弃。</p> 
<p>滑动窗口有以下重要特性：</p> 
<ol><li>只有接收窗口向前滑动时，发送窗口才有可能向前滑动。</li><li>从发送窗口的概念看，其他协议只在发送窗口和接收窗口上有差别：停止-等待协议是发送和接收窗口大小都为1；后退N帧协议是发送窗口大于1，接收窗口大小为1；选择重传协议是发送和接收窗口的大小都大于1.</li><li>接收窗口的大小为1时，可保证帧的有序接收。</li><li>数据链路层的滑动窗口协议中，窗口的大小在传输过程中是固定的。</li></ol> 
<h4>3.可靠传输机制</h4> 
<p><strong>数据链路层的可靠传输通常使用确认和超时传输两种机制来完成</strong>。<strong>确认是一种无数据的控制帧</strong>，这种控制帧使得接收方可以让发送方知道哪些内容被正确接收。有时为提高传输效率，将确认捎带在一个回复帧中，称为捎带确认。<strong>超时重传</strong>是指发送方在发送某个数据帧后就开启一个计时器，在一定时间内如果没有得到发送的数据帧的确认帧，那么就重新发送该数据帧，直到发送成功为止。</p> 
<p><strong>自动重传请求（Auto Repeat reQuest，ARQ）</strong>通过接收方请求发送方重传出错的数据帧来恢复出错的帧，是通信中用于处理信道所带来差错的方法之一。<strong>传统自动重传请求分为三种</strong>，即<strong>停止-等待（Stop-and-Wait）ARQ、后退N帧（Go-Back-N）ARQ和选择性重传（Selective Repeat）ARQ。</strong>后两种协议是滑动窗口技术与请求重发技术的结合，由于窗口尺寸开到足够大时，帧在线路上可以连续地流动，因此又称其为连续ARQ协议。在数据链路层中流量控制机制和可靠传输机制是交织在一起的。<strong>现有的实际有线网络的数据链路层很少采用可靠传输。</strong></p> 
<h3>3.4.2单帧滑动窗口与停止-等待协议</h3> 
<p>在停止-等待协议中，源站发送单个帧后必须等待确认，在目的站的回答到达源站之前，源站不能发送其他的数据帧。从滑动窗口机制的角度看，<strong>停止-等待协议相当于发送窗口和接收窗口大小均为1的滑动窗口协议。</strong></p> 
<p>在停止-等待协议中，除数据帧丢失外，还可能出现以下两种差错。</p> 
<p><strong>到达目的站的帧可能已遭破坏</strong>，接收站利用前面讨论过的差错检测技术检出后，简单地将该帧丢弃。为了对付这种情况，源站装备了计时器。在一个帧发送之后，源站等待确认，如果计时器计满时仍未收到确认，那么再次发送相同的帧。如此重复，直到该数据帧正确到达。</p> 
<p><strong>数据帧正确而确认帧被破坏</strong>，此时接收方已收到正确的数据帧，但发送方收不到确认帧，就会重传数据帧，接收方收到重复的数据帧后会丢弃，并重传一个该帧对应的确认帧。<strong>发送的帧交替地用0和1来标识，肯定确认分别用ACK0和ACK1来表示，收到的确认有误时，重传已发送的帧。</strong>对于停止-等待协议，由于每发送一个数据帧就停止并等待，因此用1bit来编号就足够。在停止-等待协议中，若连续出现相同发送序号的数据帧，表明发送端进行了超时重传。连续出现相同序号的确认帧时，表明接收端收到了重复帧。</p> 
<p>为了超时重发和判定重复帧的需要，<strong>发送方和接收方都要设置一个帧缓冲区</strong>。发送端在发送完数据帧时，必须在其发送缓存中保留此数据帧的副本，才能在出错时进行重传。只有收到对方发来的确认帧ACK时，方可清除此副本。</p> 
<p>停止-等待协议通信信道的利用率很低，为克服这一缺点，就产生了后退N帧协议和选择重传协议。</p> 
<h3>3.4.3多帧滑动窗口与后退N帧协议（GBN）</h3> 
<p>在后退N帧式ARQ中，发送方无须在收到上一个帧的ACK后才能开始发送下一帧，而是可以连续发送帧。当接收方检测出失序的信息帧后，要求发送方重发最后一个正确接收的信息帧之后的所有未被确认的帧。当发送方发送了N个帧后，若发现该N个帧的前一个帧在计时器超时后仍未返回其确认信息，则该帧被判为出错或丢失，此时发送方就不得不重传该出错帧及随后的N个帧。即接收方只允许按顺序接收帧。</p> 
<p>源站向目的站发送数据帧。当源站发完0号帧后，可以继续发送后续的1、2号帧等。源站每发送完一帧就要为该帧设置超时计时器。由于连续发送了许多帧，所以确认帧必须要指明是对哪一帧进行确认。为了减少开销，<strong>GBN协议还规定接收端不一定每收到一个正确的数据帧就必须立即发回一个确认帧，而可以在连续收到好几个正确的数据帧后，才对最后一个数据帧发确认消息，</strong>或者可在自己有数据要发送时才将对以前正确收到的帧加以捎带确认。<strong>即对某一数据帧的确认就表明该数据帧和此前所有的数据帧均已正确无误地收到。</strong>ACKn表示对第n号帧的确认，表示接收方已正确收到第n号帧及以前的所有帧，下一次期望收到第n+1号帧（也可能是第0号帧）。接收端只按序接收数据帧。接收端对有差错帧后面的正确帧也要丢弃，而且重复发送已发送的最后一个确认帧ACK1，以防止它丢失了。</p> 
<p>后退N帧协议的接收窗口为1，可以保证按序接收数据帧。<strong>若采用n比特对帧编号，则其发送窗口的尺寸WT应满足大于等于1且小于等于2的n次方-1。</strong>若发送窗口的尺寸大于2的n次方-1，则会造成接收方无法分辨新帧和旧帧。</p> 
<p>后退N帧协议因连续发送数据帧而提高了信道的利用率，但在重传时又必须把原来已发送正确的数据帧重传，又使传送效率降低。若信道传输质量很差导致误码率较大时，它不一定优于停止-等待协议。</p> 
<h3>3.4.4多帧滑动窗口与选择重传协议（SR）</h3> 
<p><strong>选择重传ARQ协议</strong>，为进一步提高信道的利用率，可设法只重传出现差错的数据帧或计时器超时的数据帧，但此时必须加大接收窗口，以便<strong>先收下发送序号不连续但仍处在接收窗口中的那些数据帧。等到所缺序号的数据帧收到后再一并送交主机</strong>。</p> 
<p>在选择重传协议中，每个发送缓冲区对应一个计时器，当计时器超时时，缓冲区的帧就会重传。另外，该协议使用了比上述其他协议更有效的差错处理策略，即一旦接收方怀疑帧出错，就会发一个否定帧NAK给发送方，要求发送方对NAK中指定的帧进行重传。</p> 
<p>选择重传协议的接收窗口尺寸WR和发送窗口尺寸WT都大于1，一次可以发送或接收多个帧。若采用n比特对帧编号，为了保证接收方向前移动窗口后，新窗口序号与旧窗口序号没有重叠部分，需要满足条件：接收窗口WR + 发送窗口WT 小于等于2^n。假定仍然采用累计确认的方法，并且接收窗口要小于发送窗口，否则无意义，即接收窗口尺寸不应超过序号范围的一半。<strong>一般情况下在SR协议中，接收窗口和发送窗口的大小是相同的</strong>。</p> 
<p>选择重传协议可避免重复发送那些本已正确到达接收端的数据帧，但在接收端要设置具有相当容量的缓冲区来暂存那些未按序正确收到的帧。接收端不能接收窗口下界以下或窗口上界以上的序号的帧，因此所需缓冲区的数目等于窗口的大小，而不是序号数目。</p> 
<p><strong>信道效率（信道利用率）</strong>，从时间角度定义，信道效率是对发送方而言的，是指发送方在一个发送周期的时间内，有效地发送数据所需要的时间占整个发送周期的比率。</p> 
<p>发送方从开始发送数据到收到第一个确认帧为止，称为一个发送周期T，发送方在这个周期内共发送L比特的数据，发送方的数据传输速率为C，则发送方用于发送有效数据的时间是L/C，信道利用率为（L/C）/T</p> 
<p><strong>信道吞吐率=信道利用率x发送方的发送速率</strong></p> 
<p>流量控制的三种滑动窗口协议的信道利用率是一个关键知识点。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4d0dce7b682d22bed60cb08e7665e911/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CUDA编程：tensorrt plugin实战 中</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d6bc21c55cbba33bea8693f57c2cad2d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">pytorch基于DistributedDataParallel进行单机多卡的分布式训练</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>