<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【逆向】前期准备 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【逆向】前期准备" />
<meta property="og:description" content="逆向前期准备工作 移动设备1. 设备解锁1.1 Redmi 12C更新驱动绑定设备解锁 2. Magisk2.1 前情提要2.2 安装流程2.3 Riru 模块安装2.4 FoxMagiskModuleManager.apk &amp; Move Certificates 模块安装2.5 LSPosed 模块安装 常用命令（后期迁移至其他地方）ADB 技巧利用 clash 进行抓包下载地址Android 流程 未完待续~ 移动设备 1. 设备解锁 1.1 Redmi 12C 参考： https://bbs.kanxue.com/thread-275982.htm
更新驱动 网址：https://www.mi.com/c/service/download/index.html【手机驱动】 =&gt; 【MIUI V4或V5版本的小米手机驱动】手机连接电脑后，【设备管理器】 =&gt; 【便携设备】 =&gt; 右键【Redmi 12C】 =&gt; 【更新驱动程序】 =&gt; 【浏览我的电脑以查找驱动程序】 绑定设备 绑定小米账号，【绑定账号和设备】【设置】 =&gt; 【我的设备】 =&gt; 【全部参数】 =&gt; 多次点击【MIUI版本】（7次左右） =&gt; 开启开发者模式【设置】 =&gt; 【更多设置】 =&gt; 【开发者选项】 =&gt; 【设备解锁状态】 =&gt; 【绑定账号和设备】 设备解锁_Redmi 12C_坑[1]： 操作不当会导致锁定 如果手机账号已绑定其余设备，然后 先在【设备解锁状态】中【绑定账号和设备】再去【小米账号】重绑手机号然后重新去【设备解锁状态】中【绑定账号和设备】设备锁定 7 天左右 解锁 下载官方工具： https://www." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/baae0f98aea37198417b056b906f7fcf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-05T23:37:47+08:00" />
<meta property="article:modified_time" content="2023-05-05T23:37:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【逆向】前期准备</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>逆向前期准备工作</h4> 
 <ul><li><a href="#_2" rel="nofollow">移动设备</a></li><li><ul><li><a href="#1__3" rel="nofollow">1. 设备解锁</a></li><li><ul><li><a href="#11_Redmi_12C_4" rel="nofollow">1.1 Redmi 12C</a></li><li><ul><li><a href="#_7" rel="nofollow">更新驱动</a></li><li><a href="#_12" rel="nofollow">绑定设备</a></li><li><a href="#_24" rel="nofollow">解锁</a></li></ul> 
   </li></ul> 
   </li><li><a href="#2_Magisk_32" rel="nofollow">2. Magisk</a></li><li><ul><li><a href="#21__39" rel="nofollow">2.1 前情提要</a></li><li><a href="#22__53" rel="nofollow">2.2 安装流程</a></li><li><a href="#23_Riru__113" rel="nofollow">2.3 Riru 模块安装</a></li><li><a href="#24_FoxMagiskModuleManagerapk__Move_Certificates__126" rel="nofollow">2.4 FoxMagiskModuleManager.apk &amp; Move Certificates 模块安装</a></li><li><a href="#25_LSPosed__153" rel="nofollow">2.5 LSPosed 模块安装</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_183" rel="nofollow">常用命令（后期迁移至其他地方）</a></li><li><ul><li><a href="#ADB_184" rel="nofollow">ADB</a></li></ul> 
  </li><li><a href="#_196" rel="nofollow">技巧</a></li><li><ul><li><a href="#_clash__197" rel="nofollow">利用 clash 进行抓包</a></li><li><ul><li><a href="#_199" rel="nofollow">下载地址</a></li><li><a href="#Android__203" rel="nofollow">Android 流程</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_249" rel="nofollow">未完待续~</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>移动设备</h2> 
<h3><a id="1__3"></a>1. 设备解锁</h3> 
<h4><a id="11_Redmi_12C_4"></a>1.1 Redmi 12C</h4> 
<blockquote> 
 <p>参考： <a href="https://bbs.kanxue.com/thread-275982.htm" rel="nofollow">https://bbs.kanxue.com/thread-275982.htm</a></p> 
</blockquote> 
<h5><a id="_7"></a>更新驱动</h5> 
<ol><li>网址：<a href="https://www.mi.com/c/service/download/index.html" rel="nofollow">https://www.mi.com/c/service/download/index.html</a></li><li>【手机驱动】 =&gt; 【MIUI V4或V5版本的小米手机驱动】</li><li>手机连接电脑后，【设备管理器】 =&gt; 【便携设备】 =&gt; 右键【Redmi 12C】 =&gt; 【更新驱动程序】 =&gt; 【浏览我的电脑以查找驱动程序】</li></ol> 
<h5><a id="_12"></a>绑定设备</h5> 
<ol><li>绑定小米账号，【绑定账号和设备】</li><li>【设置】 =&gt; 【我的设备】 =&gt; 【全部参数】 =&gt; 多次点击【MIUI版本】（7次左右） =&gt; 开启开发者模式</li><li>【设置】 =&gt; 【更多设置】 =&gt; 【开发者选项】 =&gt; 【设备解锁状态】 =&gt; 【绑定账号和设备】</li></ol> 
<ul><li><em><strong>设备解锁_Redmi 12C_坑[1]：</strong></em> 操作不当会导致锁定 
  <ul><li>如果手机账号已绑定其余设备，然后 
    <ol><li>先在【设备解锁状态】中【绑定账号和设备】</li><li>再去【小米账号】重绑手机号</li><li>然后重新去【设备解锁状态】中【绑定账号和设备】</li><li>设备锁定 7 天左右</li></ol> </li></ul> </li></ul> 
<h5><a id="_24"></a>解锁</h5> 
<ol><li>下载官方工具： <a href="https://www.miui.com/unlock/index.html" rel="nofollow">https://www.miui.com/unlock/index.html</a></li><li>运行 <code>miflash_unlock.exe</code>，登录小米账号</li><li>在关机状态下同时按住 <code>电源键</code> 和 <code>音量减键</code>，直到出现 <code>FASTBOOT</code> 界面。</li><li>连接至电脑，点击 【解锁】 =&gt; 【重启手机】</li></ol> 
<hr> 
<h3><a id="2_Magisk_32"></a>2. Magisk</h3> 
<blockquote> 
 <ul><li> <p>参考：</p> 
   <ul><li>看雪博客：<a href="https://bbs.kanxue.com/thread-275982.htm" rel="nofollow">https://bbs.kanxue.com/thread-275982.htm</a></li><li>Magisk 中文网：<a href="https://magiskcn.com/" rel="nofollow">https://magiskcn.com/</a></li></ul> </li><li> <p>前置条件：1. 手机必须解 BL 锁； 2. 电脑具备 ADB 环境</p> </li></ul> 
</blockquote> 
<h4><a id="21__39"></a>2.1 前情提要</h4> 
<ol><li> <p>Magisk 是什么？</p> 
  <ul><li>是由 <code>topjohnwu</code> 打造的开源框架软件，可以在修改系统功能的同时不会对系统本身造成破坏，但是 <code>Magisk</code> 更普遍的用途是作为获取和管理 <code>Root</code> 权限的工具。</li></ul> </li><li> <p>Magisk 与 Xposed 的异同</p> 
  <ul><li>二者的工作机制都是 <strong>拦截</strong> 
    <ul><li><code>Xposed</code> 通过劫持 Android 系统的 <code>zygote</code> 进程来加载自定义功能，这就像是半路截杀，在应用运行之前就已经将我们需要的自定义内容强加在了系统进程当中。</li><li><code>Magisk</code> 则另辟蹊径，通过挂载一个与系统文件相隔离的文件系统来加载自定义内容，为系统分区打开了一个通往平行世界的入口，所有改动在那个世界（<code>Magisk</code> 分区）里发生，在必要的时候却又可以被认为是（从系统分区的角度而言）没有发生过。</li></ul> </li><li>得益于独特的挂载机制，使用 <code>Magisk</code> 时我们可以有针对性地隐藏 <code>root</code>，甚至暂时隐藏 <code>Magisk</code> 本身。当被挂载的 <code>Magisk</code> 分区被隐藏甚至被取消挂载时，原有系统分区的完整性丝毫未损，玩需要 <code>root</code> 验证的游戏、运行对设备认证状态有要求的应用甚至进行需要验证系统完整性的 <code>OTA</code> 更新都没有任何问题。</li><li>因此严格来说 <code>Magisk</code> 可以被看作是一种文件系统，这种文件系统通过巧妙的实现方式避开了对系统文件的直接修改，从稳定性上来看要优于以往任何一种系统框架，这也是当前它在玩机社区广受认可和好评的原因所在。</li><li>由于挂载系统的存在，也让 Magisk 拥有了多样的模块化生态系统。 
    <ul><li><code>Magisk</code> 既可以独立使用，只安装面具模块。也可以和 <code>Xposed</code> 框架结合起来使用，发掘更多的功能。理论上两者功能可以相互替代，但由于两者侧重点不同以及模块开发难度等原因，<code>Magisk</code> 更多用于对 <strong>系统</strong> 的修改，而 <code>Xposed</code> 更多用于对 <strong>用户软件</strong> 的修改。</li></ul> </li></ul> </li></ol> 
<h4><a id="22__53"></a>2.2 安装流程</h4> 
<ol><li> <p>下载对应手机型号对应版本的官方镜像</p> 
  <ul><li> <p>Redmi 12C：</p> 
    <ol><li> <p>下载卡刷包，然后解压，把 <code>boot.img</code> 文件提取出来，并放到手机中。</p> 
      <ul><li> <p>卡刷包和线刷包</p> 
        <blockquote> 
         <p><a href="https://news.bangkaow.com/qyyw/202208/391338.html" rel="nofollow">https://news.bangkaow.com/qyyw/202208/391338.html</a></p> 
        </blockquote> 
        <ul><li> <p><strong>卡刷</strong> 的本质是对文件进行替换。不会重新刷新整个分区，只是替换部分文件。因此，卡刷包里面的内容实际上就是一些文件和目录。</p> 
          <ul><li>这个文件和目录里面的内容是原来机器上有的就替换掉原来的文件，如果没有的，就添加进去就行了，因此卡刷包的特点是扩展名为 <code>zip</code> 的一个压缩包，通常是放置到外置SD卡上，通过 <code>RECOVERY</code> 之类的引导程序在机器操作系统启动之前就将文件替换掉（因为手机系统一旦启动，一些系统文件你就无法替换了，这个和 <code>WINDOWS</code> 的系统文件替换过程其实类似的）。</li></ul> </li><li> <p><strong>线刷</strong> 的本质是对分区的全部内容的替换。原理和sx安装系统采用 <code>GHOTST</code> 克隆分区的道理一样。因此卡刷包里面的文件通常都是一个一个的img文件（分区映像文件）。</p> </li></ul> </li><li> <p>网址：<a href="https://web.vip.miui.com/page/info/mio/mio/detail?postId=40148484&amp;fromPathname=mioSingleBoard&amp;app_version=dev.20051" rel="nofollow">https://web.vip.miui.com/page/info/mio/mio/detail?postId=40148484&amp;fromPathname=mioSingleBoard&amp;app_version=dev.20051</a></p> 
        <ul><li>其余型号的相关链接：MIUI正式版刷机包汇总：<a href="https://web.vip.miui.com/page/info/mio/mio/detail?postId=37093637&amp;app_version=dev.20051" rel="nofollow">https://web.vip.miui.com/page/info/mio/mio/detail?postId=37093637&amp;app_version=dev.20051</a></li></ul> </li></ul> </li><li> <p>12C 的卡刷包中没有 <code>boot.img</code>，只有 <code>payload.bin</code> 文件</p> 
      <ul><li>相关链接： 
        <ul><li>教程：<a href="https://www.bilibili.com/video/BV1er4y1C7wU/?p=2" rel="nofollow">https://www.bilibili.com/video/BV1er4y1C7wU/?p=2</a></li><li>Magisk 中文网：<a href="https://magiskcn.com/" rel="nofollow">https://magiskcn.com/</a></li></ul> </li></ul> </li><li> <p>提取 <code>boot.img</code></p> 
      <ul><li>下载工具 <a href="https://mrzzoxo.lanzoub.com/b02plgdpi" rel="nofollow"><code>payload-dumper-go</code></a></li><li>解压后，将 <code>payload.bin</code> 复制到目录中</li><li><code>打开CMD命令行.bat</code></li><li>按照提示输入 <code>b</code></li><li>在 <code>./img</code> 路径下，有 <code>boot.img</code> 文件</li></ul> </li><li> <p>低版本的 Magisk 针对联发科的 CPU 需要关闭 AVB2.0 验证，最新版已修复联发科卡米问题</p> 
      <ul><li>相关网址：<a href="https://magiskcn.com/mediatek-vbmeta" rel="nofollow">https://magiskcn.com/mediatek-vbmeta</a></li></ul> </li></ol> </li></ul> 
  <ol start="2"><li> <p>将 <code>boot.img</code> 和 <code>卡刷包</code> <code>push</code> 到手机 Download 目录下</p> 
    <ul><li><code>adb push [] /storage/sdcard0/Download</code></li><li>卡刷包主要是为了让手机的版本与解压的 <code>boot.img</code> 版本相同</li></ul> </li><li> <p>手机下载 <a href="https://raw.iqiq.io/topjohnwu/magisk-files/26.1/app-release.apk" rel="nofollow">Magisk app</a></p> 
    <ul><li>网址：<a href="https://magiskcn.com/magisk-download" rel="nofollow">https://magiskcn.com/magisk-download</a></li><li><code>adb install []</code></li></ul> </li><li> <p>Magisk 安装</p> 
    <ul><li>打开 Magisk，<code>安装</code></li><li>如果有 <code>修补 boot 镜像中的 vbmeta</code>，不勾选，直接 <code>下一步</code></li><li><code>选择并修补一个文件</code></li><li>选中上传的 <code>boot.img</code> 文件，<code>开始</code></li><li>修补成功，输出到 <code>/stroage/emulated/0/Download/magisk_patched-[版本号]_[随机].img</code></li></ul> </li><li> <p>电脑下载 <a href="lanzoub.com/b02plghuh" rel="nofollow">adb-fastboot</a>，并解压</p> </li><li> <p>将 <code>boot.img</code> 和 生成的 <code>magisk_patched-xxxx.img</code> 复制到 <code>adb-fastboot/</code> 目录下</p> </li><li> <p>手机重启到 <code>fastboot</code> 模式</p> </li><li> <p>打开 <code>打开CMD命令行.bat</code></p> 
    <ul><li>输入 <code>fastboot flash boot [magisk_patched-xxxx.img]</code></li></ul> </li><li> <p>出现下面这三行代码，就算成功</p> <pre><code class="prism language-bash">Sending <span class="token string">'boot'</span> <span class="token punctuation">(</span><span class="token number">131072</span> KB<span class="token punctuation">)</span> OKAY <span class="token punctuation">[</span> <span class="token number">3</span>.311s<span class="token punctuation">]</span>
Writing <span class="token string">'boot'</span> OKAY <span class="token punctuation">[</span> <span class="token number">0</span>.441s<span class="token punctuation">]</span>
Finished. Total time: <span class="token number">3</span>.794s
</code></pre> </li><li> <p>重启手机，<code>Magisk</code> 显示版本，就算是成功</p> </li></ol> </li></ol> 
<h4><a id="23_Riru__113"></a>2.3 Riru 模块安装</h4> 
<ul><li><code>Riru</code> 并不是单独一个 <code>Magisk</code> 模块，而是由国内独立开发者 <code>Rikka</code> 开发的一套模块系列。<code>Riru</code> 神奇的地方在于，它部分地达成 <code>Xposed</code> 那样的功能，能够自定义到一部分的应用。 
  <ul><li><code>Android</code> 上所有正在运行的应用程序都是通过 <code>zygote</code> 创造出来的，而 <code>Riru</code> 正是通过替换一个会被 <code>zygote</code> 进程加载的共享库，来达到劫持应用、让应用进程执行模块代码的目的。</li></ul> </li><li>为什么是一套？ 
  <ul><li>为了避免一群模块都去抢占那个要被替换的共享库，先派遣一个模块(也是 Riru Core 核心)去负责替换，再由那个核心模块提供 API 给其他模块，以让其他那些有需要模块都能正常工作、顺利生效。</li><li>从这样的原理看，想要使用 Riru 系列模块，Riru Core 是必须安装的，然后需要用户按照自己的需求安装 Riru 系列的其他模块。</li></ul> </li><li>安装流程 
  <ol><li>下载 <a href="https://github.com/RikkaApps/Riru/releases">riru</a></li><li><code>push</code> 到手机中，并打开 <code>Magisk</code> 
    <ul><li><code>adb push [] /storage/sdcard0/Download</code></li></ul> </li><li><code>模块</code>，<code>从本地安装</code></li><li>选中对应文件，安装完成后，重启</li></ol> </li></ul> 
<h4><a id="24_FoxMagiskModuleManagerapk__Move_Certificates__126"></a>2.4 FoxMagiskModuleManager.apk &amp; Move Certificates 模块安装</h4> 
<ul><li> <p>用途：将用户证书移动到系统证书的根目录下。</p> </li><li> <p>高版本的 Magisk 已经不支持在线安装模块，使用 <a href="https://github.com/Fox2Code/FoxMagiskModuleManager/releases">FoxMagiskModuleManager</a> 替代</p> </li><li> <p><s>安装流程（删）</s></p> 
  <ol><li>查看手机版本，并下载对应的 <a href="https://github.com/Fox2Code/FoxMagiskModuleManager/releases">FoxMagiskModuleManager</a> 
    <ul><li>查看版本：<code>adb shell getprop ro.product.cpu.abi</code></li><li>安装 apk：<code>adb install -t []</code></li></ul> </li><li>首次启动设置完成后，<code>Online</code>，搜索 <code>Move Certificates</code>，下载/安装~</li><li>重启手机</li></ol> </li><li> <p><a id="bug_move_certificates"></a>目前（<code>2023.05.05</code>），<code>FoxMagiskModuleManager</code> 上下载的 <code>Move Certificates</code> 为 <a href="https://github.com/ys1231/MoveCertificate">ys1231</a> 的 <code>v1.3</code> 版本。Redmi 12C 上无效。</p> 
  <ul><li><a href="#bug_clash" rel="nofollow">跳转至 <code>技巧</code> - <code>利用 clash 进行抓包</code></a></li></ul> </li><li> <p>安装流程</p> 
  <ol><li>从 <code>Magisk-Modules-Repo</code> 上下载 <a href="https://github.com/Magisk-Modules-Repo/movecert">movecert</a></li><li>Releases 中有 <a href="https://github.com/Magisk-Modules-Repo/movecert/archive/refs/tags/v1.9.zip">v1.9</a> 版本，不过该版本有 Bug。 
    <ul><li>参考资料：<a href="https://blog.csdn.net/puppyinasock/article/details/130207403">https://blog.csdn.net/puppyinasock/article/details/130207403</a></li><li><code>Magisk</code> 安装该 <code>zip</code> 文件时，会出现 <code>unzip error</code> 
      <ul><li>该模块作者忘记更新该路径 <code>/META-INF/com/google/android/update-binary</code> 下的脚本文件。</li><li>需要将该文件替换为 <a href="https://github.com/topjohnwu/Magisk/blob/master/scripts/module_installer.sh">https://github.com/topjohnwu/Magisk/blob/master/scripts/module_installer.sh</a></li></ul> </li><li>解决方案：<a href="https://github.com/azio7/movecert">azio@github</a> 重写了正确的脚本 
      <ol><li><code>git clone git@github.com:azio7/movecert.git</code></li><li>进入 <code>movecert/</code> 目录</li><li><code>zip -r movecert.zip .</code> 生成正确的 <code>movecert.zip</code> 文件</li></ol> </li></ul> </li><li>将 <code>movecert.zip</code> 文件推送到手机中。</li><li>在 <code>Magisk</code> 上安装，重启。</li></ol> </li></ul> 
<h4><a id="25_LSPosed__153"></a>2.5 LSPosed 模块安装</h4> 
<blockquote> 
 <p>需求：1. 系统：<code>Android 8.1 - 12</code>； 2. 已安装 <code>v21</code> 以上版本的 <code>Magisk Manager</code>；3. <code>Riru</code> 模块 <code>v23+</code></p> 
</blockquote> 
<ul><li>前情提要 
  <ul><li><code>Xposed</code> 框架是一款可以在不修改 APK 的情况下影响程序运行（修改系统）的框架服务，基于它可以制作出许多功能强大的模块，且在功能不冲突的情况下同时运作。在这个框架下，我们可以加载很多插件 App（模块），这些插件 App 都有各自各种各样的功能。</li><li><code>Xposed</code> 停止更新了（安卓10及其以后的版本不支持），作者将该项目移交给了 <code>EdXpose</code> 继续维护</li></ul> </li><li><code>LSPosed</code> 和 <code>EdXposed</code> 
  <ul><li><code>LSPosed</code> 是 <code>Edxposed</code> 的一个分支，相比于 <code>EdXposed</code>，它精简了许多， 也要比后者流畅的多、省电的多。</li><li><code>Edxposed</code> 面临着停更的风险，且稳定性欠佳，<code>Lsposed</code> 则可以保证长期更新，并会持续加入新的功能。</li><li>它并不是一个传统的 <code>Xposed</code> 管理器，它作为一个 <code>Magisk</code> 模块刷入设备运行，安装风险也比传统 <code>Xposed</code> 管理器小很多。</li><li><code>LSPosed</code>继承了 <code>Xposed</code> 的模块仓库，仓库内模块都是开源模块,安全性有了保证。</li><li><code>LSPosed</code> 本身也与时俱进，使用了 <code>Material You</code> 设计语言，支持 安卓 12 的 Monet（莫奈）取色，更美观</li><li>模块可以针对单独软件开启稳定性更高：传统 <code>Xposed</code> 激活后会对所有应用生效，而 <code>LSPosed</code> 激活后只对选中应用生效</li><li>不要为一个应用启用太多模块，会拖累应用的运行速度，偶尔也会产生意想不到的 bug</li></ul> </li><li>安装流程 
  <ol><li>根据 Magisk 的版本下载对应的 <a href="https://github.com/LSPosed/LSPosed/releases">LSPosed</a> 
    <ul><li><code>riru</code> 版本对应 <code>riru</code> 版的 <code>Magisk</code>；<code>zygisk</code> 则对应 <code>zygisk</code> 版本的</li></ul> </li><li><code>push</code> 到手机中，并打开 <code>Magisk</code> 
    <ul><li><code>adb push [] /storage/sdcard0/Download</code></li></ul> </li><li><code>设置</code>，<code>不开启 Zygisk</code></li><li><code>模块</code>，<code>从本地安装</code></li><li>选中对应文件，安装完成后，重启</li><li>重启后，如果界面上没有对应的图标 
    <ol><li>拨号中输入：<code>*#*#5776733#*#*</code></li><li><code>LSPosed</code> 模块压缩包解压，直接安装 <code>LSPosed 管理器 APP</code></li></ol> </li></ol> </li><li>使用方法 
  <ul><li>下载安装需要的 apk 文件</li><li>打开 <code>LSPosed</code>，<code>模块</code>，<code>启用模块</code>，勾选需要起作用的<code>作用域</code></li><li>重启（部分模块需要重启）</li></ul> </li></ul> 
<h2><a id="_183"></a>常用命令（后期迁移至其他地方）</h2> 
<h3><a id="ADB_184"></a>ADB</h3> 
<ol><li>将文件推送至手机 
  <ul><li><code>adb push [文件] [路径]</code></li></ul> </li><li>安装 APK 文件 
  <ul><li><code>adb install -t [apk]</code></li><li><code>-t</code> 为强制安装</li></ul> </li><li>查看手机当前界面 
  <ul><li><code>adb shell</code> =&gt; <code>dumpsys window | grep mCurrentFocus</code></li></ul> </li><li>查看手机系统版本 
  <ul><li><code>adb shell getprop ro.product.cpu.abi</code></li></ul> </li></ol> 
<h2><a id="_196"></a>技巧</h2> 
<h3><a id="_clash__197"></a>利用 clash 进行抓包</h3> 
<blockquote> 
 <p><code>clash</code> + <code>Burp Suite</code></p> 
</blockquote> 
<h4><a id="_199"></a>下载地址</h4> 
<ul><li>Windows / Linux：<a href="https://github.com/Dreamacro/clash">https://github.com/Dreamacro/clash</a></li><li>Android：<a href="https://github.com/Kr328/ClashForAndroid">https://github.com/Kr328/ClashForAndroid</a></li></ul> 
<h4><a id="Android__203"></a>Android 流程</h4> 
<blockquote> 
 <p>前置条件：<code>Android</code> 设备需要有 <code>Magisk</code> 中的 <code>Move Certificates</code> 模块</p> 
</blockquote> 
<ul><li>原理 
  <ul><li>通过设置 clash 进行抓包，安卓设备可以通过 adb reverse 将电脑的某个端口映射到 Android 设备上。</li></ul> </li><li>流程 
  <ol><li><code>PC</code> 上启动 <code>Burp Suite</code> 
    <ol><li><code>Proxy</code>，<code>Proxy settings</code></li><li>在 <code>Proxy listeners</code> 中新增 <code>127.0.0.1:8084</code></li><li><code>Import / export CA certificate</code>，<code>Export</code> 下的 <code>Certificate in DER format</code>，保存至本地</li><li>推送到手机中</li><li><code>设置</code>，<code>安全</code>，<code>更多安全</code>，<code>加密与凭证</code>，<code>安装证书</code>，<code>CA 证书</code></li><li>添加完证书后，重启设备即可</li></ol> 
    <ul><li><a id="bug_clash"></a> <em><strong>技巧_利用 clash 进行抓包_坑[1]：</strong></em> <code>Redmi 12C</code> 上 <code>FoxMagiskModuleManager</code> 下载的 <code>Move Certificates</code> 证书迁移失败，<a href="#bug_move_certificates" rel="nofollow">跳转至详情</a></li></ul> </li><li>查看 <code>Android</code> 系统版本，<a href="https://github.com/Kr328/ClashForAndroid/releases">下载</a>对应的 <code>apk</code> 文件，<code>foss</code> 版本即可。 
    <ul><li><code>adb shell getprop ro.product.cpu.abi</code></li></ul> </li><li>编写 <code>clash</code> 的配置文件 <code>config.yaml</code>，并推送到 <code>sdcard/Donwload</code> 目录 
    <ul><li> <pre><code class="prism language-yaml">  <span class="token key atrule">mixed-port</span><span class="token punctuation">:</span> <span class="token number">7890</span>
  <span class="token key atrule">allow-lan</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
  <span class="token key atrule">mode</span><span class="token punctuation">:</span> global
  <span class="token key atrule">log-level</span><span class="token punctuation">:</span> info
  <span class="token key atrule">external-controller</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">9090</span>
  <span class="token key atrule">proxies</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"burp"</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> http
      <span class="token key atrule">server</span><span class="token punctuation">:</span> 127.0.0.1
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8084</span>
  <span class="token key atrule">proxy-groups</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Proxy
      <span class="token key atrule">type</span><span class="token punctuation">:</span> select
      <span class="token key atrule">proxies</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> burp
</code></pre> 
      <ul><li>由于最后将利用 <code>adb reverse</code> 将 PC 端口反向映射到 <code>Android</code>，因此 <code>proxies</code> 中的 <code>server</code> 为 <code>127.0.0.1</code></li><li>其余情况，可以根据具体需求修改对应的 <code>server</code> 和 <code>port</code></li></ul> </li><li><code>adb push config.yaml /storage/sdcard0/Download</code></li></ul> </li><li><code>Android</code> 打开 <code>clash</code> 
    <ol><li><code>配置</code>，<code>创建配置</code>，<code>从文件导入</code></li><li>修改 <code>名称</code> ， <code>浏览文件</code> 选中 <code>config.yaml</code></li><li><code>保存</code> 后，启用配置文件</li><li>启动代理后，选择 <code>GLOBAL</code> 下的 <code>burp</code></li></ol> </li><li><code>cmd.exe</code> 中开启反向映射，<code>Burp</code> 即可抓包 
    <ul><li><code>adb reverse tcp:8084 tcp8084</code></li></ul> </li></ol> </li></ul> 
<h2><a id="_249"></a>未完待续~</h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3cf4127a282543b3377fd47b42fe6c0f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ChatGPT最全提示词Prompts总结，看这一篇就够了！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2af1fbbcee3b3fcc2ca3878a93975610/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">queryWrapper写内联接，多表查询</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>