<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>react&#43;umi&#43;antd项目搭建配置 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="react&#43;umi&#43;antd项目搭建配置" />
<meta property="og:description" content="官方文档链接：
UmiJS官方文档
React官方文档
Ant Design官方文档
一、项目搭建 对于react umi项目搭建，umi官方文档已经写的很清晰了，具体请查看上面的umi官方文档链接。这里我不再详细说明，着重说明一些需要注意的地方。
1. 首先，确认是否已安装node和umi，本文umi版本使用3.0版本。
$ node -v $ umi -v 2. 可通过以下两种命令创建项目，但创建出来的项目umi版本不同
$ yarn create umi 说明： 使用此命令创建的项目，umi版本为2.x版本，如需使用3.x版本还需要手动升级，关于手动升级的操作umi官网也有详细步骤 除此之外，此命令可选择创建哪种项目，如需使用ant-design-pro框架可使用此法创建（如下图） $ yarn create @umijs/umi-app 说明： 此命令为umi官网提供的项目创建工具，创建完成umi项目即为3.x版本推荐使用 注意：以上两种创建方式都需要手动安装 antd 依赖，项目工程默认自带的是 @ant-design/pro-layout ，但pro-layout相关文档阅读体验不够好，个人比较推荐直接使用 antd （使用ant-design-pro框架除外）
二、ESLint相关配置 umi项目的lint相关配置使用 @umijs/fabric 就已经足够了，运行过程中如果有什么依赖找不到直接yarn安装就行。
1. 新增 .eslintrc.js、.eslintignore、.stylelintrc.js、.stylelintignore 配置文件
eslintrc.js
module.exports = { extends: [require.resolve(&#39;@umijs/fabric/dist/eslint&#39;)], rules: { &#39;no-unused-vars&#39;: &#39;warn&#39;, &#39;@typescript-eslint/no-unused-vars&#39;: &#39;warn&#39; }, } .stylelintrc.js
module.exports = { extends: [require.resolve(&#39;@umijs/fabric/dist/stylint&#39;)] }; prettierrc相关配置使用项目创建时默认的就行，不用修改。
2. 配置lint相关命令（仅供参考，可根据需求灵活配置）" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0d1638df2dee540f106ce263e014c955/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-02T19:29:47+08:00" />
<meta property="article:modified_time" content="2024-01-02T19:29:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">react&#43;umi&#43;antd项目搭建配置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>官方文档链接：<br><a href="https://umijs.org/zh-CN/docs/getting-started" rel="nofollow" title="UmiJS官方文档">UmiJS官方文档</a><br><a href="https://zh-hans.reactjs.org/docs/hooks-intro.html" rel="nofollow" title="React官方文档">React官方文档</a><br><a href="https://ant-design.gitee.io/components/overview-cn/" rel="nofollow" title="Ant Design官方文档">Ant Design官方文档</a></p> 
<h4>一、项目搭建</h4> 
<p>对于react umi项目搭建，umi官方文档已经写的很清晰了，具体请查看上面的umi官方文档链接。这里我不再详细说明，着重说明一些需要注意的地方。</p> 
<p>1. 首先，确认是否已安装node和umi，本文umi版本使用3.0版本。</p> 
<pre><code>$ node -v
$ umi -v</code></pre> 
<p>2. 可通过以下两种命令创建项目，但创建出来的项目umi版本不同</p> 
<pre><code>$ yarn create umi
说明：
使用此命令创建的项目，umi版本为2.x版本，如需使用3.x版本还需要手动升级，关于手动升级的操作umi官网也有详细步骤
除此之外，此命令可选择创建哪种项目，如需使用ant-design-pro框架可使用此法创建（如下图）

$ yarn create @umijs/umi-app
说明：
此命令为umi官网提供的项目创建工具，创建完成umi项目即为3.x版本推荐使用</code></pre> 
<p>注意：以上两种创建方式都需要手动安装 <code>antd</code> 依赖，项目工程默认自带的是 <code>@ant-design/pro-layout</code> ，但pro-layout相关文档阅读体验不够好，个人比较推荐直接使用 <code>antd</code> （使用ant-design-pro框架除外）</p> 
<h4>二、ESLint相关配置</h4> 
<p>umi项目的lint相关配置使用 <code>@umijs/fabric</code> 就已经足够了，运行过程中如果有什么依赖找不到直接yarn安装就行。</p> 
<p>1. 新增 <code>.eslintrc.js、.eslintignore、.stylelintrc.js、.stylelintignore</code> 配置文件</p> 
<p>eslintrc.js</p> 
<pre><code>module.exports = {
  extends: [require.resolve('@umijs/fabric/dist/eslint')],
  rules: {
    'no-unused-vars': 'warn',
    '@typescript-eslint/no-unused-vars': 'warn'
  },
}
</code></pre> 
<p>.stylelintrc.js</p> 
<pre><code>module.exports = {
  extends: [require.resolve('@umijs/fabric/dist/stylint')]
};
</code></pre> 
<p></p> 
<p>prettierrc相关配置使用项目创建时默认的就行，不用修改。</p> 
<p>2. 配置lint相关命令（仅供参考，可根据需求灵活配置）</p> 
<pre><code>"lint": "umi g tmp &amp;&amp; yarn lint:js &amp;&amp; yarn lint:style &amp;&amp; yarn lint:prettier",
"lint:prettier": "prettier --check \"**/*\" --end-of-line auto",
"lint:fix": "eslint --fix --cache --ext .js,.jsx,.ts,.tsx --format=pretty ./src &amp;&amp; npm run lint:style",
"lint:js": "eslint --cache --ext .js,.jsx,.ts,.tsx --format=pretty ./src",
"lint:style": "stylelint --fix \"src/**/*.less\""
</code></pre> 
<p></p> 
<h4>三、Umi项目配置</h4> 
<h5>1. 两种配置方式（推荐config方式）</h5> 
<p>详见：<a href="https://umijs.org/zh-CN/docs/config" rel="nofollow" title="https://umijs.org/zh-CN/docs/config">https://umijs.org/zh-CN/docs/config</a></p> 
<p>注意，使用config配置方式需注意config文件夹所在目录为根目录，不要配错到src目录之下了！</p> 
<h5><a id="2_75"></a>2. 两种路由配置方式（约定式路由与配置式路由）</h5> 
<p>详见：<a href="https://umijs.org/zh-CN/docs/convention-routing" rel="nofollow" title="https://umijs.org/zh-CN/docs/convention-routing">https://umijs.org/zh-CN/docs/convention-routing</a></p> 
<p>注意：如需配置不在 <code>/</code> 根路由下的独立路由页面（如登录页），避免访问此独立页面时，此页面嵌入到了 <code>layout</code> 中，可通过配置式路由将独立页面放到根路由配置到上方，路由时首先匹配到了独立页面就不会继续匹配根路由下的子页面，从而避免出现独立页面嵌套 <code>layout</code> 的情况。</p> 
<h5>3. 两种 <code>layout</code> 布局方式</h5> 
<p>1）config配置layout（不推荐）</p> 
<p>config/config.ts</p> 
<pre><code>import { defineConfig } from 'umi';

export default defineConfig({ 
 title: '管理系统', 
 layout: { name: '这是菜单', locale: false }
 routes: [
 	{
 		path: '/dashboard',
 		name: 'dashboard',
 		icon: 'dashboard',
 	}，
 	...
 ]
})</code></pre> 
<p>配置好 <code>layout</code> 和路由后，按照路由创建对应页面组件即可</p> 
<p>2） 在src目录下新增 <code>layouts</code> 布局文件夹配置（推荐）<br> 在项目src目录创建 <code>layouts</code> 文件夹，项目运行时会自动读取此文件路径下的布局组件。</p> 
<p>布局时，使用 <code>@ant-design/pro-layout</code> 或 <code>antd</code> 两种UI组件其中某一种皆可，我使用的是<code>antd</code>组件库的布局组件。</p> 
<p>详见：<a href="https://ant-design.gitee.io/components/layout-cn/" rel="nofollow" title="布局 Layout - Ant Design">布局 Layout - Ant Design</a></p> 
<h5>4. 全局配置</h5> 
<p>1）全局样式<br> 在<code>src</code>文件夹下创建<code>global.less</code>样式文件，此样式文件中设置的样式会全局生效，可将公共样式放到此文件中</p> 
<p>2）入口html文件<br> 在 <code>src/pages</code>目录下创建<code>document.ejs</code>文件，文件内容为html，此文件默认是umi的入口html文件，类似于Vue项目中<code>public/index.html</code>文件</p> 
<h5><a id="5Umi_118"></a>5. Umi的其他常用配置说明</h5> 
<p>1）devServer<br> 如果你想像Vue中，在vue.config.js配置服务器端口号之类的信息可以使用devServer配置。</p> 
<pre><code>import { defineConfig } from 'umi';

export default defineConfig({
	devServer: {
    	port: 3000,
 	}
})
</code></pre> 
<p>2）chainWebpack</p> 
<p>如果你想要修改webpack配置，或使用各种webpack插件，可通过此配置来实现</p> 
<pre><code>import { defineConfig } from 'umi';
import XXPlugin from 'xx-plugin'

export default defineConfig({
	chainWebpack(config, { webpack }) {
    	config.plugin('XXPlugin').use(XXPlugin);
  	}
})</code></pre> 
<p>3） dynamicImport<br> 启用按需加载</p> 
<p>4）hash</p> 
<p>如果配置了<code>hash: true</code> ， 会让dist目录下生成的文件包含 hash 后缀，如下<code>logo.[hash字符].png</code></p> 
<pre><code>+ dist
  - logo.sw892d.png
  - umi.df723s.js
  - umi.8sd8fw.css
  - index.html
</code></pre> 
<p>5）alias</p> 
<p>Vue:</p> 
<pre><code>chainWebpack: (config) =&gt; {
    config.entry('app').clear()
    config.entry('app').add('./src/main.js')
    config.resolve.alias
      .set('@', resolve('src'))
      .set('@utils', resolve('src/utils'))
      .set('@assets', resolve('src/assets'))
  }</code></pre> 
<p>Umi:</p> 
<pre><code>import { defineConfig } from 'umi';

export default defineConfig({
	// 配置别名，对引用路径进行映射。
	alias: {
	  '@utils': '/src/utils',
	  '@assets': '/src/assets'
	}
})</code></pre> 
<p>6）history<br> 可通过history配置哈希路由，注意不要和<code>hash</code>配置混淆。</p> 
<pre><code>import { defineConfig } from 'umi';

export default defineConfig({
	// 配置路由模式为hash模式，type可选 browser、hash 和 memory，默认browser
	history: { type: 'hash' }
})
</code></pre> 
<p>7） theme<br> 如果想要定制不同主题，可通过<code>theme</code>配置主题样式变量，变量为<code>less</code>变量</p> 
<pre><code>// config.ts
import { defineConfig } from 'umi';
import theme from './theme';

export default defineConfig({
	theme: theme
})
</code></pre> 
<pre><code>// theme.ts
export default {
  '@headerColor': '#0099FF',
  '@menuFontColor': '#001949',
};
</code></pre> 
<p>8）cssLoader<br> 若希望将 ClassName 类名变成驼峰命名形式，可设置</p> 
<pre><code>import { defineConfig } from 'umi';

export default defineConfig({
	cssLoader: {
	 localsConvention: 'camelCase',
	}
})
</code></pre> 
<p>设置之后，在具体页面中，className会被解析成驼峰形式</p> 
<pre><code>import React from 'react';

import styles from './index.less'; // .bar-foo { font-size: 16px; }

export default () =&gt; &lt;div className={styles.barFoo}&gt;Hello&lt;/div&gt;;
// =&gt; &lt;div class="bar-foo___{hash}"&gt;Hello&lt;/div&gt;
</code></pre> 
<p>9）外部<code>js</code>和<code>css</code>文件引入<br> 如果想要引入其他的外部css文件或js文件，如<code>iconfont</code>字体文件等，可通过<code>scripts</code>和<code>styles</code>配置进行设置</p> 
<pre><code>import { defineConfig } from 'umi';

export default defineConfig({
	scripts: ['//at.alicdn.com/t/font_XXXX.js'， 'XXX.js'],
 	styles: ['//at.alicdn.com/t/font_XXXX.css', 'XXX.css'],
})
</code></pre> 
<p>更多配置请参考官方文档配置说明：<a href="https://umijs.org/zh-CN/config" rel="nofollow" title="https://umijs.org/zh-CN/config">https://umijs.org/zh-CN/config</a></p> 
<p><strong>注意</strong>：若你在项目中进行了静态化配置，你会发现你在通过路由访问页面的时候无法访问到对应的页面，需要加一个<code>.html</code>后缀才能正常访问。如<code>http://127.0.0.1/login</code>路由页面需要访问<code>http://127.0.0.1/login.html</code>才能正常访问页面(坑～，初次配置的时候不小心加了这个配置，结果找了好久路由无法访问页面的问题！)</p> 
<pre><code>// 如果htmlSuffix为true，umi生成的路由文件会自动加上.html后缀
exportStatic: {
	htmlSuffix: true
},
</code></pre> 
<p>还有一点需要注意，如果你发现你的项目采用的是 <code>history</code> 模式，且部署到服务器上之后，刷新页面时路由地址会自动追加一个一个 <code>/</code> ，导致页面访问空白或重定向，但本地调试不会有问题，这也有可能是配置里配置了 <code>exportStatic</code> 的问题，需要注意的是，即使没有配置<code>htmlSuffix</code> 仅仅是空的 <code>exportStatic: {}</code> 配置也不行！</p> 
<p>具体问题参考umi的github issues： <a href="https://github.com/ant-design/ant-design-pro/issues/9140" title="项目部署后，浏览器刷新后，url pathname尾部会多出一个 / #9140">项目部署后，浏览器刷新后，url pathname尾部会多出一个 / #9140</a></p> 
<h4><a id="_272"></a>四、项目目录结构（参考）</h4> 
<pre><code>
├── config
    ├── config.ts
├── dist
├── mock
├── public
└── src
    ├── .umi
    ├── api
    ├── assets
    ├── components
    ├── utils
    ├── layouts
    	├── index.less
    	└── index.tsx
    ├── pages
        └── login
            ├── index.less
            └── index.tsx
    ├── app.ts
    └── global.less 
├── .env
├── .editorconfig
├── .eslintrc.js
├── .eslintignore
├── .stylelintrc.js
├── .stylelintignore
├── tsconfig.json
├── package.json
├── README.md
</code></pre> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/469dabd76ab6beda9d2fab37e3c735e3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【API调用gpt-4 (vision-preview)】基于微软的Azure OpenAI API</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b11bf1336581613c5bcc74171c6a66a1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">系统（嘀嗒）定时器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>