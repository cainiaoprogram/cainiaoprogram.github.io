<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【机器学习】对抗生成网络 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【机器学习】对抗生成网络" />
<meta property="og:description" content="一、随机数据生成
随机数据生成算法
随机数据生成的显示建模和隐式建模
二、生成对抗网络结构
生成对抗网络（GAN）中，生成模型（Generator）和判别模型（Discriminator）的任务和训练目标分别是：
生成模型的任务是从随机噪声中生成尽可能真实的数据，例如图像、文本、音频等。生成模型的训练目标是最小化生成数据被判别模型识别为假的概率，也就是最大化生成数据的真实性。
判别模型的任务是区分输入的数据是真实的还是生成模型生成的。判别模型的训练目标是最大化真实数据被识别为真的概率和生成数据被识别为假的概率，也就是最小化判别模型的误判率。
生成模型和判别模型的训练是一个对抗的过程，它们互相竞争，不断提高自己的能力，最终达到一个平衡点，使得生成模型生成的数据无法被判别模型区分。这样，生成模型就可以生成高质量的数据，判别模型就可以提高数据的鉴别能力。
生成对抗网络的原理
三、模型的训练
GAN的训练过程是怎样的？
# 初始化生成器G和判别器D G = Generator() D = Discriminator() # 设置优化器和超参数 optimizer_G = Optimizer(G.parameters(), ...) optimizer_D = Optimizer(D.parameters(), ...) epochs = ... batch_size = ... latent_dim = ... # 循环训练epochs次 for epoch in range(epochs): # 循环训练每个批次的数据 for x in data_loader(batch_size): # 训练判别器D optimizer_D.zero_grad() z = random_noise(latent_dim) fake_x = G(z) real_pred = D(x) fake_pred = D(fake_x.detach()) loss_D = binary_cross_entropy(real_pred, 1) &#43; binary_cross_entropy(fake_pred, 0) loss_D." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f2d9ed514cac9541e12870f3abc1e4ab/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-08T18:01:02+08:00" />
<meta property="article:modified_time" content="2024-01-08T18:01:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【机器学习】对抗生成网络</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/dc/4e/p2ThUkK1_o.png" alt="e499c31491d0805f8758c82b482dae48.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/6d/5e/6jw5UEqc_o.png" alt="6bb0ee8b15aa9b9c459d1c3eb0b37bc0.png"></p> 
 <p><strong>一、随机数据生成</strong><br></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/09/15/bg9cBr7x_o.png" alt="365a097e15910e7485c4c465b4a1f536.png"></p> 
 <p style="text-align:left;"><strong>随机数据生成算法</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/45/3d/SVgc2EAi_o.png" alt="c0ca391377032bc7a9d00b033b6d07bf.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/77/22/5ocoowHv_o.png" alt="a0277f1e9e03b4ea2e673df49dabff58.png"></p> 
 <p style="text-align:left;"><strong>随机数据生成的显示建模和隐式建模</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/45/3a/IgUVqDBk_o.png" alt="1dda46d769c6425afb1012ab6d99a0b8.png"></p> 
 <p><strong>二、生成对抗网络结构</strong><br></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/94/18/MFqLkPrX_o.png" alt="b9f8d7347953150df5aa19c520028d61.png"></p> 
 <p style="text-align:left;">生成对抗网络（GAN）中，生成模型（Generator）和判别模型（Discriminator）的任务和训练目标分别是：</p> 
 <ul><li><p>生成模型的任务是从随机噪声中生成尽可能真实的数据，例如图像、文本、音频等。生成模型的训练目标是最小化生成数据被判别模型识别为假的概率，也就是最大化生成数据的真实性。</p></li><li><p>判别模型的任务是区分输入的数据是真实的还是生成模型生成的。判别模型的训练目标是最大化真实数据被识别为真的概率和生成数据被识别为假的概率，也就是最小化判别模型的误判率。</p></li></ul> 
 <p>生成模型和判别模型的训练是一个对抗的过程，它们互相竞争，不断提高自己的能力，最终达到一个平衡点，使得生成模型生成的数据无法被判别模型区分。这样，生成模型就可以生成高质量的数据，判别模型就可以提高数据的鉴别能力。</p> 
 <p style="text-align:left;"><strong>生成对抗网络的原理</strong></p> 
 <p><img src="https://images2.imgbox.com/29/b2/GQKrj1KB_o.png" alt="861e1614346edf1f047018b99e83e85d.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/c6/d7/VnAvWDkL_o.png" alt="27e910394da50069af50a12ca433159a.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/da/f7/YGhLWKqm_o.png" alt="cdedf4d639b2553eadfd31d41347411e.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/bf/f8/QQRqOPrW_o.png" alt="113fb7aff3158702c168f3acd2621434.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/bb/19/w7r8eAwN_o.png" alt="bb7888077e2670cc1f313c0122352770.png"></p> 
 <p><strong>三、模型的训练</strong></p> 
 <p><img src="https://images2.imgbox.com/1c/16/z1JGu7RR_o.png" alt="76bfb3630b1ed4803bff65922470bd06.png"></p> 
 <p style="text-align:left;"><strong>GAN的训练过程是怎样的？</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/ba/8e/eZ9MhZU3_o.png" alt="4bd817ae387b407914ad81832e819607.png"></p> 
 <pre class="has"><code class="language-properties"># 初始化生成器G和判别器D
G = Generator()
D = Discriminator()


# 设置优化器和超参数
optimizer_G = Optimizer(G.parameters(), ...)
optimizer_D = Optimizer(D.parameters(), ...)
epochs = ...
batch_size = ...
latent_dim = ...


# 循环训练epochs次
for epoch in range(epochs):
  # 循环训练每个批次的数据
  for x in data_loader(batch_size):
    # 训练判别器D
    optimizer_D.zero_grad()
    z = random_noise(latent_dim)
    fake_x = G(z)
    real_pred = D(x)
    fake_pred = D(fake_x.detach())
    loss_D = binary_cross_entropy(real_pred, 1) + binary_cross_entropy(fake_pred, 0)
    loss_D.backward()
    optimizer_D.step()


    # 训练生成器G
    optimizer_G.zero_grad()
    fake_pred = D(fake_x)
    loss_G = binary_cross_entropy(fake_pred, 1)
    loss_G.backward()
    optimizer_G.step()


    # 打印训练信息
    print(f"Epoch {epoch}, Loss_D: {loss_D}, Loss_G: {loss_G}")</code></pre> 
 <p><strong>四、应用和改进</strong><br></p> 
 <p style="text-align:left;"><strong>GAN的变体</strong><br></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/1e/6a/uRahg6xr_o.png" alt="3faba4b99a9155c98c046bd8f994165a.png"></p> 
 <p style="text-align:left;"><strong>这些变体的原理和GAN有什么不同？</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/9a/72/dCTZyguf_o.png" alt="68a772bc1ab622500382a07b1d386a9b.png"></p> 
 <p style="text-align:left;"><strong>如何选择适合自己任务的GAN变体？</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/ec/74/J6TDsSLZ_o.png" alt="f90a1e484ccb5dc86e33cb970e9cb8a2.png"></p> 
 <p style="text-align:left;"><strong>4.1 改进方案</strong></p> 
 <p><strong>CGAN</strong><br></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/48/a7/R15F4x7V_o.png" alt="90e739b5c7275ab2ce1382e71ced8b3e.png"></p> 
 <p><strong>CGAN和GAN的训练过程有什么不同？</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/8c/42/6wkH3HJH_o.png" alt="4d0bf741bc818d450dd16d01d68246b7.png"></p> 
 <p><strong>DCGAN</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/70/37/iHszHG8u_o.png" alt="243d741f88742da818d187fc7d0599bc.png"></p> 
 <p><strong>拉普拉斯金字塔GAN</strong><br></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/28/b2/7cR5oT7A_o.png" alt="a07f29140032bb955ea7aeaaeda82927.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/3c/77/rW7QHU2w_o.png" alt="dedd5a398a9583d5e7f613d4e25485fb.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/e2/96/Qc4qRpKi_o.png" alt="025593c3429e64047c8359d8dee12e8b.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/00/ef/4g97xuGE_o.png" alt="1d6c0c664cacd194e20c6853cb377c5a.png"></p> 
 <p><strong>GRAN</strong><br></p> 
 <p style="text-align:left;">循环神经网络 (Recurrent Neural Networks, RNNs) 是一种深度学习的方法，它可以处理序列数据，如文本，语音，音乐等。RNNs 的特点是它们有一个内部状态，可以记住之前的信息，从而捕捉序列数据的长期依赖和结构。RNNs 可以用于生成对抗网络 (Generative Adversarial Networks, GANs) 的框架中，作为生成器或判别器，来生成或评估序列数据。这种结合了 RNNs 和 GANs 的方法称为生成循环对抗网络 (Generative Recurrent Adversarial Networks, GRANs)。GRANs 可以利用 RNNs 的能力来生成逼真和多样的序列数据，如文本，语音，音乐等。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/c9/4e/OkMfQggD_o.png" alt="328ef8d662e57217e5399f3589446210.png"></p> 
 <p><strong>InfoGAN</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/3e/54/f1RXzgg9_o.png" alt="20c06fdc75b8a1932a5eec4d45024cc9.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/80/bd/A73czZ0x_o.png" alt="1b54d3b76cd79a0e49732d1bdf209f2d.png"></p> 
 <p style="text-align:left;"><strong>4.2 典型应用</strong><br></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/35/b0/q52gi4FZ_o.png" alt="57074afdddabcd01d3155da19aa42303.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/93/3f/Axv6s5n5_o.png" alt="09384c5eee64ee4e4b8e0e896357b287.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/b5/ae/Jcaryfp6_o.png" alt="9f343f76a7e98489d3ae40cea31f4cd9.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/98/94/mv9ocp4M_o.png" alt="1df35d16e8506d4bc9c718636fbe89af.png"></p> 
 <p><strong>Real-ESRGAN 超分辨率图像示例：</strong><br></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/cb/22/4KUI5Arb_o.png" alt="206456f51decb798fd984d870e038c27.png"></p> 
 <p>从 https://github.com/ai-forever/Real-ESRGAN 下载源码，从</p> 
 <p>https://huggingface.co/ai-forever/Real-ESRGAN/tree/main 手动下载模型，放在weights文件夹中。 </p> 
 <p>主程序</p> 
 <pre class="has"><code class="language-python"># 导入os模块，用于操作系统相关的功能，如文件和目录的管理
import os 
# 导入torch模块，用于深度学习的计算和模型的构建
import torch
# 导入PIL模块，用于图像的处理和显示
from PIL import Image
# 导入numpy模块，用于科学计算和数组的操作
import numpy as np
# 导入RealESRGAN模块，这是一个基于生成对抗网络的超分辨率模型，可以将低分辨率的图像转换为高分辨率的图像
from RealESRGAN import RealESRGAN




# 定义一个主函数，返回值类型为整数
def main() -&gt; int:
    # 判断当前设备是否支持CUDA，如果支持，就使用CUDA作为设备类型，否则使用CPU
    device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
    # 创建一个RealESRGAN的实例，指定设备类型和放大倍数为4
    model = RealESRGAN(device, scale=4)
    # 加载预训练的模型权重，从本地目录中读取文件，不需要下载
    model.load_weights('Real-ESRGAN/weights/RealESRGAN_x4.pth', download=False)
    # 遍历输入目录中的所有图像文件，使用enumerate函数给每个文件编号
    for i, image in enumerate(os.listdir("Real-ESRGAN/inputs")):
        # 打开图像文件，并转换为RGB模式
        image = Image.open(f"Real-ESRGAN/inputs/{image}").convert('RGB')
        # 使用模型对图像进行预测，得到超分辨率的图像
        sr_image = model.predict(image)
        # 将超分辨率的图像保存到结果目录中，文件名为编号.png
        sr_image.save(f'Real-ESRGAN/results/{i}.png')
    # 返回0表示程序正常结束
    return 0




# 如果当前文件是作为主程序运行，而不是被其他文件导入，就执行主函数
if __name__ == '__main__':
    main()</code></pre> 
 <p>效果：<br></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/c3/fb/p9pjNigO_o.jpg" alt="d957d408e6283dbff6705758892084fa.jpeg"></p> 
 <p style="text-align:center;">原始图 650x650</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/72/1c/rYrG6O11_o.png" alt="8e4a0664ac25839cdbf50e62cd59d5ac.png"></p> 
 <p style="text-align:center;">超分辨率图 2600x2600<br></p> 
 <p><strong>参考网址：</strong><br></p> 
 <p>https://en.wikipedia.org/wiki/Generative_adversarial_network</p> 
 <p>https://github.com/pytorch/examples/tree/main</p> 
 <p>https://arxiv.org/abs/1406.2661</p> 
 <p>https://zhuanlan.zhihu.com/p/53473337 [GAN学习系列2] GAN的起源</p> 
 <p>https://mp.weixin.qq.com/s?__biz=MzA3MzI4MjgzMw==&amp;mid=2650730721&amp;idx=2&amp;sn=95b97b80188f507c409f4c72bd0a2767&amp;chksm=871b349fb06cbd891771f72d77563f77986afc9b144f42c8232db44c7c56c1d2bc019458c4e4&amp;scene=21#wechat_redirect</p> 
 <p>https://www.mindspore.cn/tutorials/application/zh-CN/r1.7/cv/dcgan.html 生成式对抗网络</p> 
 <p>https://pytorch.org/examples/</p> 
 <p>https://github.com/leftthomas/SRGAN</p> 
 <p>https://pytorch.org/hub/</p> 
 <p>https://github.com/xiong-jie-y/ml-examples/tree/master</p> 
 <p>https://huggingface.co/ai-forever/Real-ESRGAN/tree/main    模型下载Real-ESRGAN</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cf960ace451e20a6eef796917d630e97/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用python提取excel表格第一列汉字首字母到第二列</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ebe5b40df359cfe2e38e4a09417bd975/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">虚幻UE 材质-材质编辑器节点 1</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>