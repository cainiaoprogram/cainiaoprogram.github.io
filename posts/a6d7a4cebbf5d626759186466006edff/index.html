<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>lotus ubuntu 18.04 安装(当前版本Devnet 7) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="lotus ubuntu 18.04 安装(当前版本Devnet 7)" />
<meta property="og:description" content="ubuntu 18.04 安装 lotus 1，依赖安装1.1 go环境配置 2，终端代理3，克隆源码(当前版本Devnet 6)4，运行lotus5，lotus存储交易6，重新安装7，Devnet 6 升级 Devnet 7 1，依赖安装 apt install mesa-opencl-icd ocl-icd-opencl-dev -y add-apt-repository ppa:longsleep/golang-backports apt install golang-go gcc git bzr jq pkg-config mesa-opencl-icd ocl-icd-opencl-dev -y 安装go，需要使用1.13.3版本 apt install golang -y 卸载重新安装 # go version go version go1.10.4 linux/amd64 # apt remove -y golang # wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz # tar -zxvf go1.13.3.linux-amd64.tar.gz # mv go /usr/local/ # rm -rf /usr/bin/go # rm -rf /usr/bin/gofmt # ln -s /usr/local/go/bin/* /usr/bin/ # go version go version go1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a6d7a4cebbf5d626759186466006edff/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-10-31T18:15:06+08:00" />
<meta property="article:modified_time" content="2019-10-31T18:15:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">lotus ubuntu 18.04 安装(当前版本Devnet 7)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>ubuntu 18.04 安装 lotus</h4> 
 <ul><li><a href="#1_1" rel="nofollow">1，依赖安装</a></li><li><ul><li><a href="#11_go_60" rel="nofollow">1.1 go环境配置</a></li></ul> 
  </li><li><a href="#2_75" rel="nofollow">2，终端代理</a></li><li><a href="#3Devnet_6_103" rel="nofollow">3，克隆源码(当前版本Devnet 6)</a></li><li><a href="#4lotus_118" rel="nofollow">4，运行lotus</a></li><li><a href="#5lotus_323" rel="nofollow">5，lotus存储交易</a></li><li><a href="#6_375" rel="nofollow">6，重新安装</a></li><li><a href="#7Devnet_6__Devnet_7_385" rel="nofollow">7，Devnet 6 升级 Devnet 7</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1_1"></a>1，依赖安装</h2> 
<pre><code class="prism language-bash">apt <span class="token function">install</span> mesa-opencl-icd ocl-icd-opencl-dev -y
</code></pre> 
<pre><code class="prism language-bash">add-apt-repository ppa:longsleep/golang-backports
</code></pre> 
<pre><code class="prism language-bash">apt <span class="token function">install</span> golang-go gcc <span class="token function">git</span> bzr jq pkg-config mesa-opencl-icd ocl-icd-opencl-dev -y
</code></pre> 
<ul><li>安装go，需要使用1.13.3版本</li></ul> 
<pre><code class="prism language-bash">apt <span class="token function">install</span> golang -y
</code></pre> 
<ul><li>卸载重新安装</li></ul> 
<pre><code># go version
go version go1.10.4 linux/amd64
# apt remove -y golang
# wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz
# tar -zxvf go1.13.3.linux-amd64.tar.gz
# mv go /usr/local/
# rm -rf /usr/bin/go
# rm -rf /usr/bin/gofmt
# ln -s /usr/local/go/bin/* /usr/bin/
# go version
go version go1.13.3 linux/amd64
</code></pre> 
<ul><li>安装gcc</li></ul> 
<pre><code class="prism language-bash">apt <span class="token function">install</span> -y gcc
</code></pre> 
<ul><li>安装git</li></ul> 
<pre><code class="prism language-bash">apt <span class="token function">install</span> -y <span class="token function">git</span>
</code></pre> 
<ul><li>安装bzr</li></ul> 
<pre><code class="prism language-bash">apt <span class="token function">install</span> -y bzr
</code></pre> 
<ul><li>安装jq</li></ul> 
<pre><code class="prism language-bash">apt <span class="token function">install</span> -y jq
</code></pre> 
<ul><li>安装pkg-config</li></ul> 
<pre><code class="prism language-bash">apt <span class="token function">install</span> -y pkg-config
</code></pre> 
<ul><li>安装curl</li></ul> 
<pre><code class="prism language-bash">apt <span class="token function">install</span> -y <span class="token function">curl</span>
</code></pre> 
<h3><a id="11_go_60"></a>1.1 go环境配置</h3> 
<ul><li>go环境变量配置</li></ul> 
<pre><code class="prism language-go"># mkdir ~<span class="token operator">/</span><span class="token keyword">go</span>
# cd ~<span class="token operator">/</span><span class="token keyword">go</span><span class="token operator">/</span>
# mkdir bin src pkg
# vim <span class="token punctuation">.</span>profile
export GOROOT<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span><span class="token keyword">go</span><span class="token operator">/</span>
export GOPATH<span class="token operator">=</span><span class="token operator">/</span>root<span class="token operator">/</span>mygo
export GOBIN<span class="token operator">=</span>$GOPATH<span class="token operator">/</span>bin
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$GOROOT<span class="token operator">/</span>bin
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$GOPATH<span class="token operator">/</span>bin
# source <span class="token punctuation">.</span>profile
</code></pre> 
<h2><a id="2_75"></a>2，终端代理</h2> 
<ul><li>终端代理</li></ul> 
<pre><code class="prism language-bash">apt <span class="token function">install</span> s～s-libev -y
</code></pre> 
<ul><li>设置账号密码</li></ul> 
<pre><code class="prism language-ss"># cat /etc/s~s-libev/config.json
{
    "server":"服务器ip",
    "server_port":端口,
    "local_port":1080,
    "password":"密码",
    "timeout":60,
    "method":"chacha20-ietf-poly1305"
}
</code></pre> 
<ul><li>运行服务</li></ul> 
<pre><code class="prism language-ss"># systemctl enable s~ks-libev-local@config
# systemctl start s~s-libev-local@config
# systemctl status  s~s-libev-local@config
</code></pre> 
<ul><li>终端代理</li></ul> 
<pre><code class="prism language-terminal">export ALL_PROXY=socks5://127.0.0.1:1080
</code></pre> 
<h2><a id="3Devnet_6_103"></a>3，克隆源码(当前版本Devnet 6)</h2> 
<ul><li>下载源码</li></ul> 
<pre><code class="prism language-shell"><span class="token function">git</span> clone https://github.com/filecoin-project/lotus.git
</code></pre> 
<ul><li>设置GOPROXY</li></ul> 
<pre><code># cd lotus/
# export GO111MODULE=on
# export GOPROXY=https://goproxy.io
# make clean all
# make install
install -C ./lotus /usr/local/bin/lotus
install -C ./lotus-storage-miner /usr/local/bin/lotus-storage-miner
</code></pre> 
<h2><a id="4lotus_118"></a>4，运行lotus</h2> 
<ul><li>运行守护进程</li></ul> 
<pre><code class="prism language-shell">lotus daemon
</code></pre> 
<pre><code class="prism language-shell">lotus daemon <span class="token operator">&gt;&gt;</span> /var/log/lotus.log 2<span class="token operator">&gt;</span><span class="token operator">&amp;</span>1 <span class="token operator">&amp;</span>
</code></pre> 
<ul><li>日志报错</li></ul> 
<pre><code class="prism language-lotus">Get https://ipfs.io/ipfs/QmRssVAXRN3xp9VdSpTq1pNjkob3QiikoFZiM5hqrmh1VU: dial tcp 199.59.150.49:443: i/o timeout
</code></pre> 
<ul><li>修改 <code>const gateway = "https://ipfs.io/ipfs/"</code></li></ul> 
<p><a href="https://ipfs.github.io/public-gateway-checker/" rel="nofollow">Public IPFS Gateways</a></p> 
<pre><code class="prism language-lotus"># vim /root/lotus/build/paramfetch.go
//const gateway = "https://ipfs.io/ipfs/"
const gateway = "https://ipfs.globalupload.io/"
</code></pre> 
<ul><li>重新编译安装</li></ul> 
<pre><code># cd /root/lotus/
# systemctl status  shadowsocks-libev-local@config
# export ALL_PROXY=socks5://127.0.0.1:1080
# export GO111MODULE=on
# export GOPROXY=https://goproxy.io
# make clean all &amp;&amp; make install
install -C ./lotus /usr/local/bin/lotus
install -C ./lotus-storage-miner /usr/local/bin/lotus-storage-miner
</code></pre> 
<ul><li>运行守护进程</li></ul> 
<pre><code class="prism language-lotus"># lotus daemon &gt;&gt; /var/log/lotus.log 2&gt;&amp;1 &amp;
</code></pre> 
<ul><li>如果报错<code>bad handshake</code>,再打开一个终端运行守护进程</li></ul> 
<pre><code class="prism language-lotus"># lotus net peers 
websocket: bad handshake
</code></pre> 
<ul><li>连接节点数量</li></ul> 
<pre><code class="prism language-louts"># lotus net peers | wc -l
86
</code></pre> 
<ul><li>块同步高度</li></ul> 
<pre><code class="prism language-lotus"># lotus sync status
Height: 16088
</code></pre> 
<ul><li>实时看到同步区块高度</li></ul> 
<pre><code class="prism language-lotus"># lotus sync wait
</code></pre> 
<ul><li>区块高度同步完成退出</li></ul> 
<pre><code class="prism language-lotus"># lotus sync wait
Target: [bafy2bzacedm7m4gfctogyii7fzhn4a3n66x5v5kvee33z26pve63qup7bhuts]	State: complete	Height: 2594
Done
</code></pre> 
<p>~<s><code>watch -n 1 lotus sync status</code> <code>Stage: complete</code> 块高度同步完成</s>~</p> 
<pre><code class="prism language-lotus">Stage: complete
</code></pre> 
<ul><li>创建钱包地址</li></ul> 
<pre><code class="prism language-lotus"># lotus wallet list
# lotus wallet new bls
t3

</code></pre> 
<ul><li><s><a href="https://lotus-faucet.kittyhawk.wtf/" rel="nofollow">水龙头获取测试币</a></s></li></ul> 
<pre><code class="prism language-lotus"># lotus wallet balance
0.0000000005
</code></pre> 
<ul><li><s>抵押币</s></li></ul> 
<pre><code># lotus state pledge-collateral
17.932813648858594875
</code></pre> 
<ul><li>直接填写钱包地址创建矿工，选择256MB</li><li><a href="https://lotus-faucet.kittyhawk.wtf/miner.html" rel="nofollow">创建矿工</a></li></ul> 
<p><img src="https://images2.imgbox.com/b4/fd/F9ER0EFF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/72/af/mR8wvvFT_o.png" alt="在这里插入图片描述"></p> 
<ul><li>初始化</li></ul> 
<pre><code class="prism language-bash">lotus-storage-miner init --actor<span class="token operator">=</span>t0392 --owner<span class="token operator">=</span>t3vqiuqoyabieb5pcx74sc57pk4njnsleezmf4w26nfzi4vlynz3ecwnopgjwmwkdguvb2med6h5womtkmteqq
</code></pre> 
<p><img src="https://images2.imgbox.com/5b/96/34pc4dz6_o.png" alt="在这里插入图片描述"><br> ~<s>- web返回信息``</s>~</p> 
<pre><code class="prism language-lotus">New storage miners address is: t0
Run lotus-storage-miner init --actor=t0 -owner=t3
</code></pre> 
<ul><li><code>区块同步完成以后才能初始化，不然会报错``actor not found</code><br> ~<s>- 复制Run后面命令，在终端运行</s>~</li></ul> 
<pre><code class="prism language-lotus"># lotus-storage-miner init --actor=t0 -owner=t3
INFO	main	lotus-storage-miner/init.go:113	Storage miner successfully created, you can now start it with 'lotus-storage-miner run'
</code></pre> 
<p>~<s>- 报错``actor not found`，区块高度同步完成后初始化</s>~</p> 
<pre><code class="prism language-lotus">ERROR: failed to initialize lotus-storage-miner: failed to configure storage miner: failed to get worker address: call raw get actor: actor not found
# rm -rf .lotusstorage/
# lotus-storage-miner init --actor=t02 --owner=t3q
</code></pre> 
<ul><li>初始化过程会下载复制证明参数</li></ul> 
<pre><code class="prism language-lotus">build	build/paramfetch.go:79	checksum mismatch in param file /var/tmp/filecoin-proof-parameters/v14-proof-of-spacetime-rational-b99f15d0bdaaf4ffb68b2ca72b69ea8d915f66a2a56f667430ad69d87aa5febd.params, 88ae592f8051bc4db4c9947862880427 != ff77a5e270afc6e1c7fbc19e48348fac
 18.36 MiB / 2.43 GiB [&gt;-------------------------------------------------------------]   0.74% 192.42 KiB/s 3h38m42s 
 31.24 MiB / 2.43 GiB [&gt;-------------------------------------------------------------]   1.26% 202.79 KiB/s 3h26m09s 
 85.77 MiB / 2.43 GiB [==&gt;-----------------------------------------------------------]   3.45% 403.19 KiB/s 1h41m23s 
 165.93 MiB / 2.43 GiB [====&gt;--------------------------------------------------------]   6.68% 611.90 KiB/s 1h04m37s 
 266.78 MiB / 2.43 GiB [======&gt;--------------------------------------------------------]  10.74% 808.84 KiB/s 46m46s 
 391.20 MiB / 2.43 GiB [=========&gt;----------------------------------------------------]  15.75% 1007.00 KiB/s 35m26s 
 546.74 MiB / 2.43 GiB [==============&gt;--------------------------------------------------]  22.01% 1.19 MiB/s 27m01s
</code></pre> 
<ul><li>初始化存储库</li></ul> 
<pre><code class="prism language-lotus"># lotus-storage-miner init --actor=t0584 --owner=t3vqiuqoyabieb5pcx74sc57pk4njnsleezmf4w26nfzi4vlynz3ecwnopgjwmwkdguvb2med6h5womtkmteqq
2019-11-18T10:11:03.865+0800	INFO	main	lotus-storage-miner/init.go:59	Initializing lotus storage miner
2019-11-18T10:11:03.866+0800	INFO	main	lotus-storage-miner/init.go:61	Checking proof parameters
2019-11-18T10:11:03.871+0800	INFO	build	build/paramfetch.go:114	Parameter file /var/tmp/filecoin-proof-parameters/v15-stacked-proof-of-replication-d01cd22091627b721c60a3375b5219af653fb9f6928c70aa7400587d396bc07a.vk is ok
2019-11-18T10:11:03.871+0800	INFO	build	build/paramfetch.go:114	Parameter file /var/tmp/filecoin-proof-parameters/v15-proof-of-spacetime-rational-535d1050e3adca2a0dfe6c3c0c4fa12097c9a7835fb969042f82a507b13310e0.vk is ok
2019-11-18T10:11:03.871+0800	INFO	build	build/paramfetch.go:114	Parameter file /var/tmp/filecoin-proof-parameters/v15-stacked-proof-of-replication-967b11bb59be11b7dc6f2b627520ba450a3aa50846dbbf886cb8b735fe25c4e7.vk is ok
2019-11-18T10:11:03.871+0800	INFO	build	build/paramfetch.go:114	Parameter file /var/tmp/filecoin-proof-parameters/v15-stacked-proof-of-replication-0c0b444c6f31d11c8e98003cc99a3b938db26b77a296d4253cda8945c234266d.vk is ok
2019-11-18T10:11:03.871+0800	INFO	build	build/paramfetch.go:114	Parameter file /var/tmp/filecoin-proof-parameters/v15-proof-of-spacetime-rational-c2ae2b440e693ee69fd6da9e85c4294c5c70c1a46d5785ca5f2a676d6cd4c8de.vk is ok
2019-11-18T10:11:03.872+0800	INFO	build	build/paramfetch.go:114	Parameter file /var/tmp/filecoin-proof-parameters/v15-proof-of-spacetime-rational-b99f15d0bdaaf4ffb68b2ca72b69ea8d915f66a2a56f667430ad69d87aa5febd.vk is ok
2019-11-18T10:11:05.392+0800	INFO	build	build/paramfetch.go:114	Parameter file /var/tmp/filecoin-proof-parameters/v15-proof-of-spacetime-rational-535d1050e3adca2a0dfe6c3c0c4fa12097c9a7835fb969042f82a507b13310e0.params is ok
2019-11-18T10:11:05.542+0800	INFO	build	build/paramfetch.go:114	Parameter file /var/tmp/filecoin-proof-parameters/v15-proof-of-spacetime-rational-c2ae2b440e693ee69fd6da9e85c4294c5c70c1a46d5785ca5f2a676d6cd4c8de.params is ok
2019-11-18T10:11:06.062+0800	INFO	build	build/paramfetch.go:114	Parameter file /var/tmp/filecoin-proof-parameters/v15-proof-of-spacetime-rational-b99f15d0bdaaf4ffb68b2ca72b69ea8d915f66a2a56f667430ad69d87aa5febd.params is ok
2019-11-18T10:11:52.786+0800	INFO	build	build/paramfetch.go:114	Parameter file /var/tmp/filecoin-proof-parameters/v15-stacked-proof-of-replication-0c0b444c6f31d11c8e98003cc99a3b938db26b77a296d4253cda8945c234266d.params is ok
2019-11-18T10:12:03.891+0800	INFO	build	build/paramfetch.go:114	Parameter file /var/tmp/filecoin-proof-parameters/v15-stacked-proof-of-replication-967b11bb59be11b7dc6f2b627520ba450a3aa50846dbbf886cb8b735fe25c4e7.params is ok
2019-11-18T10:12:04.702+0800	INFO	build	build/paramfetch.go:114	Parameter file /var/tmp/filecoin-proof-parameters/v15-stacked-proof-of-replication-d01cd22091627b721c60a3375b5219af653fb9f6928c70aa7400587d396bc07a.params is ok
2019-11-18T10:12:04.702+0800	INFO	main	lotus-storage-miner/init.go:66	Checking if repo exists
2019-11-18T10:12:04.702+0800	INFO	main	lotus-storage-miner/init.go:82	Trying to connect to full node RPC
2019-11-18T10:12:04.711+0800	INFO	main	lotus-storage-miner/init.go:91	Checking full node version
2019-11-18T10:12:04.714+0800	INFO	main	lotus-storage-miner/init.go:102	Initializing repo
2019-11-18T10:12:04.714+0800	INFO	repo	repo/fsrepo.go:98	Initializing repo at '/root/.lotusstorage'
2019-11-18T10:12:04.715+0800	INFO	main	lotus-storage-miner/init.go:131	Initializing libp2p identity
2019-11-18T10:12:04.746+0800	INFO	main	lotus-storage-miner/init.go:258	Waiting for message: bafy2bzacea4gnyhzrenb37m7wwcsmqkqzu7odoyq6rapcluyckke3syadxgqq
+2019-11-18T10:12:27.475+0800	INFO	main	lotus-storage-miner/init.go:164	Created new storage miner: t0584
2019-11-18T10:12:27.486+0800	INFO	badger	badger@v1.6.0-rc1/logger.go:46	All 0 tables opened in 0s

2019-11-18T10:12:27.498+0800	INFO	main	lotus-storage-miner/init.go:118	Storage miner successfully created, you can now start it with 'lotus-storage-miner run'
</code></pre> 
<ul><li>运行矿工</li></ul> 
<pre><code class="prism language-lotus"># lotus-storage-miner run
</code></pre> 
<pre><code class="prism language-bash">lotus-storage-miner run <span class="token operator">&gt;&gt;</span> /var/log/miner.log 2<span class="token operator">&gt;</span><span class="token operator">&amp;</span>1 <span class="token operator">&amp;</span>
</code></pre> 
<ul><li>查看交易信息</li></ul> 
<pre><code class="prism language-lotus"># lotus-storage-miner info
Miner: t0
Power: 536870912 / 1529109025672 (0.00%)
Sealed Sectors:	 3
Sealing Sectors:	 0
Pending Sectors:	 0
Failed Sectors:	 0
</code></pre> 
<ul><li>生成PoSts</li></ul> 
<pre><code class="prism language-lotus"># lotus-storage-miner store-garbage
2
</code></pre> 
<pre><code class="prism language-lotus"># lotus-storage-miner state power
1530199544712
# lotus-storage-miner info
Miner: t03..
Power: 536870912 / 1530216321928 (0.00%)
Sealed Sectors:	 3
Sealing Sectors:	 2
Pending Sectors:	 0
Failed Sectors:	 0
# lotus-storage-miner state power t03..
536870912
# lotus-storage-miner state sectors t03..
1: dcf3407b9d80f50316751f1cd183d736d76c667b2a00ea75af58f9f7cdb0c464 197085d07c2b6f5872965c14ae98c5a24024a0a5117e0724063ed5c43d497f6a
2: 85990f7fb1d543b3d29a7b63f9f047debaf07236ea79fa787ba9aed18fcbcc2f 197085d07c2b6f5872965c14ae98c5a24024a0a5117e0724063ed5c43d497f6a
3: cc6edb05b3d8a0afd7732fb7331fdf868ccee8881b71d46b0f5e5e466618930b ae123b66a933bdc63e571a668cee757a877f4dd3f15048052cbbe538c456a14b
</code></pre> 
<h2><a id="5lotus_323"></a>5，lotus存储交易</h2> 
<ul><li>hello.txt 要和 .lotus在同一个目录，默认是root目录</li></ul> 
<pre><code class="prism language-lotus"># echo "hi my name is lotus03" &gt; hello.txt
# cat hello.txt
hi my name is lotus03
# lotus client import hello.txt
bafk

# lotus client local
bafkrei
</code></pre> 
<pre><code class="prism language-lotus"># echo "Hi my name is c" &gt; hello.txt
# mv /work/hello.txt /root/
# lotus client import hello.txt
bafkre
# lotus client local
bafkre
</code></pre> 
<pre><code class="prism language-lotus"># lotus state list-miners | wc -l
119
# lotus state list-miners | grep t03..
t03..
# lotus client query-ask t03..
Ask: t03..
Price per Byte: 0.0000000005
</code></pre> 
<pre><code class="prism language-lotus"># lotus client import /root/hello.txt
baf...
# lotus-storage-miner info
Miner: t03..
# lotus wallet balance
73.196131249635697369
</code></pre> 
<pre><code class="prism language-lotus"># lotus client deal baf... t03.. 0.001 12
bafyreievod3o3ksnipg6mchmmbq4iejbrsj56du4igi6nbuizuchvobwsy
</code></pre> 
<ul><li>deal 存储数据</li></ul> 
<pre><code class="prism language-lotus"># lotus client deal bafkreihlg4tsyuqoxpsg4pnq5qqfs3krbe7pbwkwudmjv4od3xaifus57q t0594 0.0000000005 12
bafyreif2fk53aselwv5n27es6yxlmnnddo3dfbmzp6p7cg5cnl2su5ydau
</code></pre> 
<h2><a id="6_375"></a>6，重新安装</h2> 
<ul><li>删除数据</li></ul> 
<pre><code class="prism language-lotus"># rm -rf /root/.lotus /root/.lotusstorage/
</code></pre> 
<ul><li>编译安装</li></ul> 
<pre><code>make &amp;&amp;  make install
</code></pre> 
<h2><a id="7Devnet_6__Devnet_7_385"></a>7，Devnet 6 升级 Devnet 7</h2> 
<ul><li>依赖安装</li></ul> 
<pre><code class="prism language-bash">apt <span class="token function">install</span> mesa-opencl-icd ocl-icd-opencl-dev -y
</code></pre> 
<pre><code class="prism language-bash">add-apt-repository ppa:longsleep/golang-backports
</code></pre> 
<pre><code class="prism language-bash">apt <span class="token function">install</span> golang-go gcc <span class="token function">git</span> bzr jq pkg-config mesa-opencl-icd ocl-icd-opencl-dev -y
</code></pre> 
<pre><code class="prism language-lotus"># git log
commit 981f10856516127f6f29037cc901cf4c401e2ace (HEAD -&gt; master, origin/master, origin/HEAD)
Merge: d080dbd bc97a73
Author: Łukasz Magiera &lt;magik6k@users.noreply.github.com&gt;
Date:   Wed Oct 30 08:29:56 2019 +0100

</code></pre> 
<ul><li>设置终端代理</li></ul> 
<pre><code class="prism language-lotus"># systemctl status ss-libev-local@config.service
# export ALL_PROXY=socks5://127.0.0.1:1080
</code></pre> 
<ul><li>更新源码</li></ul> 
<pre><code class="prism language-lotus"># git pull
新 981f108..aafccaf
error: 您对下列文件的本地修改将被合并操作覆盖：
	build/paramfetch.go
请在合并前提交或贮藏您的修改。
终止中
</code></pre> 
<ul><li>更新源码</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># git log</span>
<span class="token comment"># git fetch --all</span>
正在获取 origin
<span class="token comment"># git reset --hard origin/master</span>
HEAD 现在位于 aafccaf Merge pull request <span class="token comment">#488 from filecoin-project/feat/dt-skeleton</span>
</code></pre> 
<ul><li>配置终端代理</li></ul> 
<pre><code class="prism language-lotus"># make clean all
</code></pre> 
<ul><li><code>make clean all</code></li></ul> 
<pre><code class="prism language-lotus"># make clean all
rm -rf  build/.bls-install build/.sector-builder-install build/.update-modules lotus lotus-storage-miner
make -C extern/go-bls-sigs/ clean
make[1]: 进入目录“/root/lotus/extern/go-bls-sigs”
rm -rf libbls_signatures.h libbls_signatures.pc libbls_signatures.a .install-bls
make[1]: 离开目录“/root/lotus/extern/go-bls-sigs”
make -C extern/go-sectorbuilder/ clean
make[1]: 进入目录“/root/lotus/extern/go-sectorbuilder”
rm -rf sector_builder_ffi.h sector_builder_ffi.pc libsector_builder_ffi.a .install-rust-fil-sector-builder
make[1]: 离开目录“/root/lotus/extern/go-sectorbuilder”
git submodule update --init --recursive
touch build/.update-modules
make -C extern/go-bls-sigs/ libbls_signatures.a libbls_signatures.pc libbls_signatures.h
make[1]: 进入目录“/root/lotus/extern/go-bls-sigs”
./install-bls-signatures
acquiring release @ bb2cae2bde5aa285
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  5725  100  5725    0     0   4843      0  0:00:01  0:00:01 --:--:--  4847
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 2627k  100 2627k    0     0  43205      0  0:01:02  0:01:02 --:--:-- 34984
make[1]: “libbls_signatures.pc”已是最新。
make[1]: “libbls_signatures.h”已是最新。
make[1]: 离开目录“/root/lotus/extern/go-bls-sigs”
make -C extern/go-sectorbuilder/ libsector_builder_ffi.a sector_builder_ffi.pc sector_builder_ffi.h
make[1]: 进入目录“/root/lotus/extern/go-sectorbuilder”
./install-rust-fil-sector-builder
acquiring release @ 599e522acbe12656
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  5853  100  5853    0     0   7571      0 --:--:-- --:--:-- --:--:--  7571
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:--  0:00:04 --:--:--     0
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 17.3M  100 17.3M    0     0   161k      0  0:01:50  0:01:50 --:--:--  321k+
make[1]: “sector_builder_ffi.pc”已是最新。
make[1]: “sector_builder_ffi.h”已是最新。
make[1]: 离开目录“/root/lotus/extern/go-sectorbuilder”
rm -f lotus
go build -o lotus ./cmd/lotus
+go run github.com/GeertJohan/go.rice/rice append --exec lotus -i ./build
rm -f lotus-storage-miner
go build -o lotus-storage-miner ./cmd/lotus-storage-miner
go run github.com/GeertJohan/go.rice/rice append --exec lotus-storage-miner -i ./build

</code></pre> 
<ul><li><code># make clean all</code>报错</li></ul> 
<pre><code class="prism language-bash">go: github.com/Gurpartap/async@v0.0.0-20180927173644-4f7f499dd9ee: Get https://proxy.golang.org/github.com/%21gurpartap/async/@v/v0.0.0-20180927173644-4f7f499dd9ee.mod: dial tcp 172.217.24.17:443: i/o <span class="token function">timeout</span>
</code></pre> 
<ul><li>设置proxy</li></ul> 
<pre><code class="prism language-lotus"># export GO111MODULE=on
# export GOPROXY=https://goproxy.io
</code></pre> 
<ul><li>go版本必须为go1.13.3</li></ul> 
<pre><code class="prism language-bash">compile: version <span class="token string">"go1.13.3"</span> does not match go tool version <span class="token string">"go1.13.4"</span>
</code></pre> 
<ul><li><code>make install</code></li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># make install</span>
<span class="token function">install</span> -C ./lotus /usr/local/bin/lotus
<span class="token function">install</span> -C ./lotus-storage-miner /usr/local/bin/lotus-storage-miner
</code></pre> 
<ul><li>修改<code>const gateway = "https://ipfs.io/ipfs/"</code></li></ul> 
<pre><code class="prism language-lotus"># vim /root/lotus/build/paramfetch.go
//const gateway = "https://ipfs.io/ipfs/"
const gateway = "https://ipfs.globalupload.io/"
# make clean all
# make install
</code></pre> 
<pre><code class="prism language-bash"><span class="token comment"># lotus version</span>
0.7.0+api0.7.1793 <span class="token operator">&lt;</span>nil<span class="token operator">&gt;</span>
lotus version 0.7.0
</code></pre> 
<hr> 
<p>参考：</p> 
<ol><li><a href="https://github.com/filecoin-project/lotus">filecoin-project/lotus</a></li><li><a href="https://blog.csdn.net/gotofind/article/details/78961236">Git强制覆盖更新、commit 强行终止后如何操作</a></li><li><a href="http://www.r9it.com/20191020/start-mining-lotus.html" rel="nofollow">Filecoin 系列08-开始 Lotus 挖矿</a></li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a9b925762e71b036288354f6a6a64779/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Fwrite和fprintf之间的区别（总结）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7b69f6ebd467c1c0982fc7a550dbe6a8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">OBS源码分析二视频输出和画面显示流程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>