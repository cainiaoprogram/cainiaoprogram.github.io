<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Flutter dio Http请求之Cookie管理 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Flutter dio Http请求之Cookie管理" />
<meta property="og:description" content="在应用开发过程中，我们进行Http通讯时会使用Cookie进行验证，今天我们就着重讲解Flutter 网络请求插件dio的cookie使用。
首先，我们要进行插件引用
# HTTP 请求 dio: ^5.1.1 cookie_jar: ^4.0.8 dio_cookie_manager: ^3.0.0 # 获取沙盒路径 path_provider: ^2.1.1 这里为什么要使用path_provider这个插件呢，下面在cookie的储存时会做介绍。
引用完，我们执行以下命令
pub get dio的使用网上有很多详细资料，这里就不做过多介绍，这里着重讲解一下Cookie的使用。
首先，我们创建一个Cookie管理类CookieHandle，具体实现方式和解释会在代码中进行详解。
代码如下：
import &#39;dart:io&#39;; import &#39;package:cookie_jar/cookie_jar.dart&#39;; import &#39;package:path_provider/path_provider.dart&#39;; class CookieHandle { //改为使用 PersistCookieJar，在文档中有介绍，PersistCookieJar将 cookie保留在文件中，因此，如果应用程序退出，则cookie始终存在，除 非显式调用delete static PersistCookieJar? _cookieJar; /// cookie保存，url 为要储存cookie的某个url static Future&lt;void&gt; saveCookie(String url) async { Uri uri = Uri.parse(url); //获取cookies Future&lt;List&lt;Cookie&gt;&gt; cookies = (await CookieHandle.cookieJar).loadForRequest(uri); cookies.then((value) async { /// cookie的储存时存在沙盒路径下 (await CookieHandle.cookieJar).saveFromResponse(uri, value); }); } /// cookie获取 static Future&lt;PersistCookieJar&gt; get cookieJar async { if (_cookieJar == null) { Directory appDocDir = await getApplicationDocumentsDirectory(); _cookieJar = PersistCookieJar(storage: FileStorage(appDocDir." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b4b452d4954703844c25e8e53aa93d33/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-21T11:52:48+08:00" />
<meta property="article:modified_time" content="2023-11-21T11:52:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Flutter dio Http请求之Cookie管理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在应用开发过程中，我们进行Http通讯时会使用<strong>Cookie</strong>进行验证，今天我们就着重讲解Flutter 网络请求插件<strong>dio</strong>的<strong>cookie</strong>使用。</p> 
<p>首先，我们要进行插件引用</p> 
<pre><code class="language-Dart"># HTTP 请求
dio: ^5.1.1
cookie_jar: ^4.0.8
dio_cookie_manager: ^3.0.0

# 获取沙盒路径
path_provider: ^2.1.1</code></pre> 
<p>这里为什么要使用<strong>path_provider</strong>这个插件呢，下面在<strong>cookie</strong>的储存时会做介绍。</p> 
<p>引用完，我们执行以下命令</p> 
<pre><code class="language-Dart">pub get</code></pre> 
<p><strong>dio</strong>的使用网上有很多详细资料，这里就不做过多介绍，这里着重讲解一下<strong>Cookie</strong>的使用。</p> 
<p>首先，我们创建一个Cookie管理类CookieHandle，具体实现方式和解释会在代码中进行详解。</p> 
<p>代码如下：</p> 
<pre><code class="language-Dart">import 'dart:io';
import 'package:cookie_jar/cookie_jar.dart';
import 'package:path_provider/path_provider.dart';

class CookieHandle {
  //改为使用 PersistCookieJar，在文档中有介绍，PersistCookieJar将 cookie保留在文件中，因此，如果应用程序退出，则cookie始终存在，除             非显式调用delete
  static PersistCookieJar? _cookieJar;

  /// cookie保存，url 为要储存cookie的某个url
  static Future&lt;void&gt; saveCookie(String url) async {
    Uri uri = Uri.parse(url);
    //获取cookies
    Future&lt;List&lt;Cookie&gt;&gt; cookies =
        (await CookieHandle.cookieJar).loadForRequest(uri);
    cookies.then((value) async {
      /// cookie的储存时存在沙盒路径下
      (await CookieHandle.cookieJar).saveFromResponse(uri, value);
    });
  }

  /// cookie获取
  static Future&lt;PersistCookieJar&gt; get cookieJar async {
    if (_cookieJar == null) {
      Directory appDocDir = await getApplicationDocumentsDirectory();
      _cookieJar = PersistCookieJar(storage: FileStorage(appDocDir.path));
    }
    return _cookieJar!;
  }

  /// cookie删除
  static Future&lt;void&gt; delete() async {
    (await CookieHandle.cookieJar).deleteAll();
  }
}
</code></pre> 
<p>上述便是Cookie的保存、获取和删除。</p> 
<p></p> 
<p>那我们在dio中如何使用呢</p> 
<pre><code class="language-Dart">/// 创建Dio网络请求对象
Dio dio = Dio(baseOptions);
/// 获取Cookie，CookieManager 为插件cookie管理类，CookieHandle.cookieJar 是获取Cookie
dio.interceptors.add(CookieManager(await CookieHandle.cookieJar));</code></pre> 
<p>到此我们就完成了Cookie的所有用法。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0583f9e8153b36df40b21cd02123a0cd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vue3的升级及优化总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/31ec176731334cfaf91d7ed1bd205eef/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Sentinel-2 哨兵二号数据（Level-1C）下载及预处理教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>