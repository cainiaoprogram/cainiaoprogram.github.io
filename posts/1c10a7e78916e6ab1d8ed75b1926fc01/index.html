<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[excel]读取cell里数值的表现形式 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[excel]读取cell里数值的表现形式" />
<meta property="og:description" content="目前在JAVA上记取excl, 是通过 poi 的 hssf 和 jxl 在读取数值时, 有一个情况是经常遇到的, 就是我们需要数值的表现形式, 而不是数值本身 例如, 7 1/4, 它的真实数值是 7.25, 你在上面菜单左侧单元格编号右边, &#34;fx&#34; 后面可以看见这个真实的值, 只是, 也许是客户不熟excel, 也许是业务原因, 总之, 我们在后台需要获取 &#34;7 1/4&#34;, 而不是 &#34;7.25&#34;, hssf cell.getNumberValue() jxl cell.getContents() 或 numberCell.getValue() 都是得到&#34;7.25&#34; 如果强制转化成 label 单元格, 将会抛出异常 解决办法 其实excel的单元格表现形式, 是有格式的, 7.25 要表现成 7 1/4, 实际上是通过设计格式为 &#34;# ?/?&#34;, 只是excel&#34;人性化&#34;的自动帮我们做了这一步, 具体在: 单元格格式-&gt;数字-&gt;分类-&gt;自定义-&gt; # ?/? 另外, 也等价于, 分类-&gt;分数-&gt;分母为一位数(1/4) 所以, 我们可以通过dataformat获知这个数值的格式, 再人为转化出这个数值的表现形式 实例 jxl CellFormat cf=cell.getCellFormat(); Format f=cf.getFormat(); System.out.println(&#34;formula : &#34;&#43;f.getFormatString()); 结果是: formula : # ?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1c10a7e78916e6ab1d8ed75b1926fc01/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2009-06-02T12:17:58+08:00" />
<meta property="article:modified_time" content="2009-06-02T12:17:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[excel]读取cell里数值的表现形式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    目前在JAVA上记取excl, 是通过 poi 的 hssf 和 jxl 
<br>在读取数值时, 有一个情况是经常遇到的, 就是我们需要数值的表现形式, 而不是数值本身 
<br>例如, 7 1/4, 它的真实数值是 7.25, 你在上面菜单左侧单元格编号右边, "fx" 后面可以看见这个真实的值, 只是, 也许是客户不熟excel, 也许是业务原因, 总之, 我们在后台需要获取 "7 1/4", 而不是 "7.25", 
<br> 
<br>hssf 
<br> 
<br>cell.getNumberValue() 
<br> 
<br> 
<br>jxl 
<br> 
<br>cell.getContents() 
<br>或 
<br>numberCell.getValue() 
<br> 
<br>都是得到"7.25" 
<br> 
<br>如果强制转化成 label 单元格, 将会抛出异常 
<br> 
<br>解决办法 
<br> 
<br>其实excel的单元格表现形式, 是有格式的, 7.25 要表现成 7 1/4, 实际上是通过设计格式为 "# ?/?", 只是excel"人性化"的自动帮我们做了这一步, 具体在: 单元格格式-&gt;数字-&gt;分类-&gt;自定义-&gt; # ?/? 
<br> 
<br>另外, 也等价于, 分类-&gt;分数-&gt;分母为一位数(1/4) 
<br> 
<br>所以, 我们可以通过dataformat获知这个数值的格式, 再人为转化出这个数值的表现形式 
<br> 
<br>实例 
<br> 
<br>jxl 
<br> 
<br>CellFormat cf=cell.getCellFormat(); 
<br>Format f=cf.getFormat(); 
<br>System.out.println("formula : "+f.getFormatString()); 
<br> 
<br>结果是: formula : # ?/? 
<br> 
<br> 
<br>poi 
<br> 
<br>int df=cell.getCellStyle().getDataFormat(); 
<br>System.out.println("formula : "+df); 
<br> 
<br>结果是: formula : 12 
<br> 
<br>这个值参考 dataformat, 为方便浏览, 我贴出来: 
<br> 
<br> 0, "General" 
<br>1, "0" 
<br>2, "0.00" 
<br>3, "#,##0" 
<br>4, "#,##0.00" 
<br>5, "($#,##0_);($#,##0)" 
<br>6, "($#,##0_);[Red]($#,##0)" 
<br>7, "($#,##0.00);($#,##0.00)" 
<br>8, "($#,##0.00_);[Red]($#,##0.00)" 
<br>9, "0%" 
<br>0xa, "0.00%" 
<br>0xb, "0.00E+00" 
<br>0xc, "# ?/?" 
<br>0xd, "# ??/??" 
<br>0xe, "m/d/yy" 
<br>0xf, "d-mmm-yy" 
<br>0x10, "d-mmm" 
<br>0x11, "mmm-yy" 
<br>0x12, "h:mm AM/PM" 
<br>0x13, "h:mm:ss AM/PM" 
<br>0x14, "h:mm" 
<br>0x15, "h:mm:ss" 
<br>0x16, "m/d/yy h:mm" 
<br> 
<br>// 0x17 - 0x24 reserved for international and undocumented 0x25, "(#,##0_);(#,##0)" 
<br> 
<br>0x26, "(#,##0_);[Red](#,##0)" 
<br> 
<br>0x27, "(#,##0.00_);(#,##0.00)" 
<br> 
<br>0x28, "(#,##0.00_);[Red](#,##0.00)" 
<br> 
<br>0x29, "_(*#,##0_);_(*(#,##0);_(* \"-\"_);_(@_)" 
<br> 
<br>0x2a, "_($*#,##0_);_($*(#,##0);_($* \"-\"_);_(@_)" 
<br> 
<br>0x2b, "_(*#,##0.00_);_(*(#,##0.00);_(*\"-\"??_);_(@_)" 
<br> 
<br>0x2c, "_($*#,##0.00_);_($*(#,##0.00);_($*\"-\"??_);_(@_)" 
<br> 
<br>0x2d, "mm:ss" 
<br> 
<br>0x2e, "[h]:mm:ss" 
<br> 
<br>0x2f, "mm:ss.0" 
<br> 
<br>0x30, "##0.0E+0" 
<br> 
<br>0x31, "@" - This is text format. 
<br> 
<br>0x31 "text" - Alias for "@" 
<br> 
<br>在poi的doc上, 有hssfcellstyle有getDataFormatString方法, 估计就是直接给出"# ?/?"(单元格format), 但在我机子上的POI没有, 也许是我没有用最新的版本 
<br> 
<br>最后, 补充点 excel 知识, 在excel上, 要在excel指定"7 1/4"这种数值格式为文本, 可以直接指定"7 1/4"为文本格式, 又或者在常规格式下, 输入"'7 1/4", 这样也是它将也会是文本格式, 在单元格左上角会有一个小小的三角图标
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/47f79f4f9d7ed00c826407367a49e5df/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ipconfig /renew 和ipconfig /release命令详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c8b1e1e2dce8861e2dc903d7562a6511/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Windows 防火墙控制</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>