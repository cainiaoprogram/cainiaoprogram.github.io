<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>如何利用matlab自带的函数及工具箱对信号进行频谱分析 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="如何利用matlab自带的函数及工具箱对信号进行频谱分析" />
<meta property="og:description" content="主打一个用尽可能少的代码，达成我们的目的
频谱图 1.工具箱实现。想必电气小伙伴们一定（是吗？）了解powergui中的FFT analysis工具。注：R2022b（或其它较高版本）可以在命令行窗口用代码powerFFT 或 power_fftscope代码调出APP。
不了解怎么使用的小伙伴，请点击上图左上角的Help按钮查看官方详细帮助文档，下面展示一下使用效果：
2.代码实现。小伙伴们是否有过想把FFT分析结果图导出但奈何没有导出选项的苦恼（截图？？）。在较低matalb版本（比如2018版）中的FFT analysis工具箱中是有菜单栏的，里面就包括了导出功能，然而高版本（2022版）中就只剩光秃秃的一个Help选项。
看来只能用代码分析绘图了。
正确的matlab使用者应该具备 有，绝不自己写的“觉悟”，不然岂不是“辜负”了官方的“Less code. More research.”初衷
matlab的工具箱一般包括GUI（APP）和相关函数两块，一般GUI（APP）是基于相关函数开发的。而FFT Analyzer APP的主体分析功能就是基于power_fftscope函数实现的。
通过一个使用案例，介绍这个函数与APP使用的对应关系：
% 初始化操作 % 用函数默认设置对VIwave变量中的数据进行FFT分析，分析结果返回给FFTDdata [FFTdata] = power_fftscope(VIwave); FFTdata.input = 1; % 对应APP Signal FFTdata.signal = 1; % 对应APP Dimension FFTdata.startTime = 0.75; % 对应APP Start Time （s） FFTdata.cycles = 40; % 对应APP Number of cycles FFTdata.fundamental = 50; % 对应APP Fundamental frequency （Hz） FFTdata.maxFrequency = 100; % 对应APP Max frequency for THD computation % FFTdata." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1b64da2479737ef58aa5d90d4acee7b9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-28T15:34:40+08:00" />
<meta property="article:modified_time" content="2023-08-28T15:34:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">如何利用matlab自带的函数及工具箱对信号进行频谱分析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>主打一个用尽可能少的代码，达成我们的目的</p> 
<h2>频谱图</h2> 
<p><strong>1.工具箱实现。</strong>想必电气小伙伴们一定（是吗？）了解<strong>powergui</strong>中的<strong>FFT analysis</strong>工具。注：R2022b（或其它较高版本）可以在命令行窗口用代码<strong>powerFFT </strong>或<strong> power_fftscope</strong>代码调出APP。</p> 
<p><img alt="" height="541" src="https://images2.imgbox.com/f2/08/tkOap32S_o.png" width="624"></p> 
<p><img alt="" height="730" src="https://images2.imgbox.com/c5/87/S6v2rHZz_o.png" width="972">不了解怎么使用的小伙伴，请点击上图左上角的<strong>Help</strong>按钮查看官方详细帮助文档，下面展示一下使用效果：</p> 
<p><img alt="" height="730" src="https://images2.imgbox.com/17/d3/ZWKhyKv2_o.png" width="972"></p> 
<p><strong>2.代码实现。</strong>小伙伴们是否有过想把FFT分析结果图导出但奈何没有导出选项的苦恼（截图？？）。在较低matalb版本（比如2018版）中的<strong>FFT analysis</strong>工具箱中是有<strong>菜单栏的，</strong>里面就包括了导出功能，然而高版本（2022版）中就只剩光秃秃的一个<strong>Help</strong>选项。</p> 
<p>看来只能用代码分析绘图了。</p> 
<p>正确的matlab使用者应该具备 <strong>有，绝不自己写</strong>的“觉悟”，不然岂不是“辜负”了官方的“Less code. More research.”初衷</p> 
<p>matlab的工具箱一般包括<strong>GUI（APP）</strong>和<strong>相关函数</strong>两块，一般GUI（APP）是基于相关函数开发的。而<strong>FFT Analyzer </strong>APP的主体分析功能就是基于<strong>power_fftscope</strong>函数实现的。</p> 
<p><img alt="" height="1192" src="https://images2.imgbox.com/2c/48/5GWen84S_o.png" width="1200"></p> 
<p> 通过一个使用案例，介绍这个函数与APP使用的对应关系：</p> 
<pre><code class="language-Matlab">% 初始化操作
% 用函数默认设置对VIwave变量中的数据进行FFT分析，分析结果返回给FFTDdata
[FFTdata] = power_fftscope(VIwave); 
FFTdata.input = 1; % 对应APP Signal
FFTdata.signal = 1; % 对应APP Dimension

FFTdata.startTime = 0.75; % 对应APP Start Time （s）
FFTdata.cycles = 40; % 对应APP Number of cycles
FFTdata.fundamental = 50; % 对应APP Fundamental frequency （Hz）
FFTdata.maxFrequency = 100; % 对应APP Max frequency for THD computation
% FFTdata.THDmaxFrequency = Inf; % Inf 对应 'Nyquist frequency' 选项；默认值就是Inf
FFTdata.THDbase = 'fund'; % 设顶FFT分析的基准频率：'fund'对应基频，也是默认值；'DC'对应直流
FFTdata.freqAxis = 'hertz'; % 频率轴显示方式：'hertz'对应Hz，也是默认值；'harmonicorder'对应 基准频率的阶数

% 用自定义的设置，再次进行FFT分析
% 无返回值则直接绘制bar图
power_fftscope(FFTdata)

% 有返回值则返回分析得到的结构体，可查看分析得到的数据
[FFTdataed] = power_fftscope(FFTdata);
DC0 = FFTdataed.DCcomponent;
% ……</code></pre> 
<p>代码power_fftscope(FFTdata)分析结果与APP完全一致，通过代码绘制得到的<strong>.fig图</strong>就可以进行相应的<strong>格式</strong>调整，图像导出自然也水到渠成。</p> 
<p><img alt="" height="514" src="https://images2.imgbox.com/4c/65/mF1FV54E_o.png" width="576"></p> 
<p><strong> 3.小妙招。</strong>数据来源不是simulink的示波器，是否还能利用上面的APP或函数？</p> 
<p>用过以上APP和power_fftscope的小伙伴们肯定清楚，它们是针对simulink的示波器数据分析开发的。它们的<strong>数据输入格式（例子中的VIwave）</strong>需要是一种matlab自带的用于示波器数据存储的<strong>带时间的结构体。</strong></p> 
<p><img alt="" height="597" src="https://images2.imgbox.com/bc/5f/2zGRudc9_o.png" width="835"></p> 
<p> <img alt="" height="176" src="https://images2.imgbox.com/d3/13/djkHeBRY_o.png" width="308"><img alt="" height="110" src="https://images2.imgbox.com/1b/b9/gqSvrfs7_o.png" width="619"></p> 
<p> 注：APP或函数无法识别输入变量有两种可能：变量保存格式不对；simulink的所有数据导出被存放在一个变量（out）中了</p> 
<p><img alt="" height="717" src="https://images2.imgbox.com/9f/c7/ey1ehXXl_o.png" width="1160"></p> 
<p> 可以看到，VIwave存放了两组信号（VIwave.signals 大小1*2），每组信号又包括3个信号（VIwave.signals.values 有3列 或 VIwave.signals.dimensions 值为3 ），这两组信号共用了一个时间，被存放在VIwave.time中。相比小伙伴看到现在，对“数据来源不是simulink的示波器，是否还能利用上面的APP或函数？”应该有答案了，那就是<strong>把示波器输出的带时间的结构体变量当作一个模板，用自己的数据替换掉模板里对应的时间和信号数据即可。</strong>这样power_fftscope函数均能可以直接用于分析。</p> 
<p><strong>举个栗子：</strong></p> 
<p>用5sin(100Πt)+0.5sin(150Πt)替换掉第一组数据中的第一个信号，并进行FFT分析</p> 
<pre><code class="language-Matlab">VIwave.signals(1).values(:,1) = 5*sin(50*2*pi*VIwave.time)+0.5*sin(75*2*pi*VIwave.time);</code></pre> 
<p>工具箱分析结果：</p> 
<p><img alt="" height="730" src="https://images2.imgbox.com/3d/9b/7fumyHTT_o.png" width="972"></p> 
<p>函数分析结果：</p> 
<p><img alt="" height="514" src="https://images2.imgbox.com/3d/fc/oCEjp83G_o.png" width="576"> </p> 
<p>over... </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/48d798cc40d2363cc7cc998b36ea8504/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">FreeRTOS学习笔记（3、信号量、互斥量的使用）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d938582659510d1430449906ec74022a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JAVA宝典----多线程(理解记忆)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>