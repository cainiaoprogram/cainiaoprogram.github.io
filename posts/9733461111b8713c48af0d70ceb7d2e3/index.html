<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>移动端的AI部署 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="移动端的AI部署" />
<meta property="og:description" content="1、背景 移动设备相较于 PC ，携带便携，普及率高。近年来，随着移动设备的广泛普及与应用，在移动设备上使用深度学习技术的需求开始涌现。
手机作为最靠近用户、最普及的终端落地，越来越多的算法模型应用到移动端上面，如何高效的把模型部署在移动端成为了急需解决的问题。
1.1、在线模式 在移动端进行简单的预处理之后，然后上传用户数据(图片、文字、语音、视频等)至云端服务器，通过服务器强大的算力得到推理结果，随后将推理结果下发至端设备。
1.2、离线模式 服务器上训练好的模型经过移动端深度学习框架(TensorFlow Lite、NCNN、TNN、MNN、CoreML等)量化压缩、转化后，在移动端设备上进行预测。这种方式在无网络连接的情况下即可实现，保证用户的隐私性。
1.3、不同平台推断差异 在线模式和离线模式的推理平台有所不同，不同平台的推断差异如表1-1所示。
表1-1 不同平台的推断差异
问题维度基于端设备推断基于云端服务器推断延迟性低延时，实时体验由于存在异步通信和传输带宽的影响，有一定的延迟资源能力cpu/gpu处理能力，设备的算力有限，存储空间受限云端服务器的算力强大，储存空间充足网络连接网络不佳的或者没有的情况下，可以离线运行需要网络连接才可以运行成本问题电池电量、下载模型所需要的时间数据传输带宽，公司云端服务器的运营和服务成本隐私问题不需要上传用户数据(图片、视频、语音、文字等)到云端服务器用户数据上传云端服务器，隐私性无法保障 2、部分移动端AI推理框架 2.1、TensorFlowLite １、开源时间：2017年11月(持续更新)
２、开源用户：谷歌
３、GitHub地址
４、简介：
TensorFlow Lite是为了解决TensorFlow在移动平台和嵌入式端过于臃肿而定制开发的轻量级解决方案，是与TensorFlow完全独立的两个项目。TensorFlow Lite则实现了低能耗、低延迟的移动平台机器学习框架，并且使得编译之后的二进制发布版本更小。 TensorFlow Lite不仅支持传统的ARM加速，还为Android Neural Networks API提供了支持，在支持ANN的设备上能提供更好的性能表现。
5、架构
6、优缺点分析
优点
1)、支持Android&amp;ios，跨平台，得益于Tensorflow强大的生态
2)、容易扩展，TFLite增加Tensorflow的算子相对容易
3)、更小二进制文件库大小，依赖少缺点
1)、目前主要支持CNN网络相关算力，对RNN的模型算子的支持偏少
2)、对运算芯片的优化少，没有做针对性优化
3)、仅支持Tensorflow模型的转换，对其他框架训练的模型无法转换 2.2、NCNN 1、开源时间：2017年7月(持续更新)
2、开源用户：腾讯
3、GIthub地址
4、简介：ncnn 从设计之初深刻考虑手机端的部署和使用，无第三方依赖，跨平台，手机端 CPU 的速度快于目前所有已知的开源框架。基于 ncnn，开发者能够将深度学习算法轻松移植到手机端高效执行，开发出人工智能 App。ncnn 目前已在腾讯多款应用中使用，如 QQ、Qzone、微信等。
5、架构
6、优缺点分析
优点
1)、全部由C&#43;&#43;实现，无需任何第三方库依赖，跨平台支持Android&amp;ios
2)、优化内存管理和数据结构设计，内存占用低
3)、支持多核并行计算加速
4)、扩展模型设计，支持8bit量化和半精度浮点存储
5)、优化内存管理和数据结构设计，内存占用低缺点
1)、不支持pb模型转换为ncnn模型，只支持Caffe模型的转换
2)、不支持GPU加速 2.3、Paddle-Lite 1、开源时间：2019年8月(持续更新)
2、开源用户：百度
3、GIthub地址
4、简介：Paddle Lite是飞桨基于Paddle Mobile全新升级推出的端侧推理引擎，在多硬件、多平台以及硬件混合调度的支持上更加完备，为包括手机在内的端侧场景的AI应用提供高效轻量的推理能力，有效解决手机算力和内存限制等问题，致力于推动AI应用更广泛的落地。
5、架构
6、优缺点分析" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/9733461111b8713c48af0d70ceb7d2e3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-26T14:44:57+08:00" />
<meta property="article:modified_time" content="2022-09-26T14:44:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">移动端的AI部署</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1_0"></a>1、背景</h3> 
<p>移动设备相较于 PC ，携带便携，普及率高。近年来，随着移动设备的广泛普及与应用，在移动设备上使用深度学习技术的需求开始涌现。<br> 手机作为最靠近用户、最普及的终端落地，越来越多的算法模型应用到移动端上面，如何高效的把模型部署在移动端成为了急需解决的问题。</p> 
<h4><a id="11_3"></a>1.1、在线模式</h4> 
<p>在移动端进行简单的预处理之后，然后上传用户数据(图片、文字、语音、视频等)至云端服务器，通过服务器强大的算力得到推理结果，随后将推理结果下发至端设备。<br> <img src="https://images2.imgbox.com/60/75/8ulrd8Nw_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="12_6"></a>1.2、离线模式</h4> 
<p>服务器上训练好的模型经过移动端深度学习框架(TensorFlow Lite、NCNN、TNN、MNN、CoreML等)量化压缩、转化后，在移动端设备上进行预测。这种方式在无网络连接的情况下即可实现，保证用户的隐私性。<br> <img src="https://images2.imgbox.com/97/41/bIFWK71e_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="13_11"></a>1.3、不同平台推断差异</h4> 
<p>在线模式和离线模式的推理平台有所不同，不同平台的推断差异如表1-1所示。<br> 表1-1 不同平台的推断差异</p> 
<table><thead><tr><th>问题维度</th><th>基于端设备推断</th><th>基于云端服务器推断</th></tr></thead><tbody><tr><td>延迟性</td><td>低延时，实时体验</td><td>由于存在异步通信和传输带宽的影响，有一定的延迟</td></tr><tr><td>资源能力</td><td>cpu/gpu处理能力，设备的算力有限，存储空间受限</td><td>云端服务器的算力强大，储存空间充足</td></tr><tr><td>网络连接</td><td>网络不佳的或者没有的情况下，可以离线运行</td><td>需要网络连接才可以运行</td></tr><tr><td>成本问题</td><td>电池电量、下载模型所需要的时间</td><td>数据传输带宽，公司云端服务器的运营和服务成本</td></tr><tr><td>隐私问题</td><td>不需要上传用户数据(图片、视频、语音、文字等)到云端服务器</td><td>用户数据上传云端服务器，隐私性无法保障</td></tr></tbody></table> 
<h3><a id="2AI_22"></a>2、部分移动端AI推理框架</h3> 
<h4><a id="21TensorFlowLite_23"></a>2.1、TensorFlowLite</h4> 
<p>１、开源时间：2017年11月(持续更新)<br> ２、开源用户：谷歌<br> ３、<a href="https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/lite">GitHub地址</a><br> ４、简介：<br> TensorFlow Lite是为了解决TensorFlow在移动平台和嵌入式端过于臃肿而定制开发的轻量级解决方案，是与TensorFlow完全独立的两个项目。TensorFlow Lite则实现了低能耗、低延迟的移动平台机器学习框架，并且使得编译之后的二进制发布版本更小。 TensorFlow Lite不仅支持传统的ARM加速，还为Android Neural Networks API提供了支持，在支持ANN的设备上能提供更好的性能表现。<br> 5、<em>架构</em><br> <img src="https://images2.imgbox.com/cb/3e/E0DKoR3G_o.png" alt="在这里插入图片描述"></p> 
<p>6、<mark>优缺点分析</mark></p> 
<ul><li>优点<br> 1)、支持Android&amp;ios，跨平台，得益于Tensorflow强大的生态<br> 2)、容易扩展，TFLite增加Tensorflow的算子相对容易<br> 3)、更小二进制文件库大小，依赖少</li><li>缺点<br> 1)、目前主要支持CNN网络相关算力，对RNN的模型算子的支持偏少<br> 2)、对运算芯片的优化少，没有做针对性优化<br> 3)、仅支持Tensorflow模型的转换，对其他框架训练的模型无法转换</li></ul> 
<h4><a id="22NCNN_41"></a>2.2、NCNN</h4> 
<p>1、开源时间：2017年7月(持续更新)<br> 2、开源用户：腾讯<br> 3、<a href="https://github.com/Tencent/ncnn">GIthub地址</a><br> 4、简介：ncnn 从设计之初深刻考虑手机端的部署和使用，无第三方依赖，跨平台，手机端 CPU 的速度快于目前所有已知的开源框架。基于 ncnn，开发者能够将深度学习算法轻松移植到手机端高效执行，开发出人工智能 App。ncnn 目前已在腾讯多款应用中使用，如 QQ、Qzone、微信等。<br> 5、<em>架构</em><br> <img src="https://images2.imgbox.com/c3/94/QzN8ZIU6_o.png" alt="在这里插入图片描述"></p> 
<p>6、<mark>优缺点分析</mark></p> 
<ul><li>优点<br> 1)、全部由C++实现，无需任何第三方库依赖，跨平台支持Android&amp;ios<br> 2)、优化内存管理和数据结构设计，内存占用低<br> 3)、支持多核并行计算加速<br> 4)、扩展模型设计，支持8bit量化和半精度浮点存储<br> 5)、优化内存管理和数据结构设计，内存占用低</li><li>缺点<br> 1)、不支持pb模型转换为ncnn模型，只支持Caffe模型的转换<br> 2)、不支持GPU加速</li></ul> 
<h4><a id="23PaddleLite_59"></a>2.3、Paddle-Lite</h4> 
<p>1、开源时间：2019年8月(持续更新)<br> 2、开源用户：百度<br> 3、<a href="https://github.com/PaddlePaddle/Paddle-Lite">GIthub地址</a><br> 4、简介：Paddle Lite是飞桨基于Paddle Mobile全新升级推出的端侧推理引擎，在多硬件、多平台以及硬件混合调度的支持上更加完备，为包括手机在内的端侧场景的AI应用提供高效轻量的推理能力，有效解决手机算力和内存限制等问题，致力于推动AI应用更广泛的落地。<br> 5、<em>架构</em><br> <img src="https://images2.imgbox.com/55/19/7CbJilOS_o.png" alt="在这里插入图片描述"></p> 
<p>6、<mark>优缺点分析</mark></p> 
<ul><li>优点<br> 1)、多模型算子，覆盖分类、检测、定位、OCR多个场景的支持<br> 2)、高性能，针对不同处理器架构特点实现kernel的定制<br> 3)、轻量级部署，对模型可以裁剪预测库进一步减小大小<br> 4)、扩展模型设计，支持8bit量化和半精度浮点存储<br> 5)、多硬件平台支持，ARM CPU、NVIDIA GPU、苹果GPU、华为NPU、FPGA等</li><li>缺点<br> 1)、代码逻辑复杂，不便于进一步修改复用<br> 2)、编译过程容易引发崩溃，框架不够成熟<br> 3)、模型转换十分复杂</li></ul> 
<h4><a id="24MACE_78"></a>2.4、MACE</h4> 
<p>1、开源时间：2018年6月<br> 2、开源用户：小米<br> 3、<a href="https://github.com/XiaoMi/mace">GIthub地址</a><br> 4、简介：一个专为移动端异构计算设备优化的深度学习前向预测框架。 MACE覆盖了常见的移动端计算设备（CPU，GPU和DSP），并且提供了完整的工具链和文档，用户借助MACE能够很方便地在移动端部署深度学习模型。MACE已经在小米内部广泛使用并且被充分验证具有业界领先的性能和稳定性。<br> 5、<em>架构</em><br> <img src="https://images2.imgbox.com/be/6c/TPl5gGRA_o.png" alt="在这里插入图片描述"></p> 
<p>6、<mark>优缺点分析</mark></p> 
<ul><li>优点<br> 1)、支持芯片的功耗管理<br> 2)、通过内存依赖分析技术，减少内存占用<br> 3)、支持高通、联发科、松果系列芯片的CPU、GPU、DSP计算加速<br> 4)、支持Tensorflow、Caffe、ONNX等模型格式的转换</li><li>缺点<br> 1)、OP算子相对较少，场景受限<br> 2)、不支持ios端<br> 3)、环境要求苛刻，编译容易出现问题</li></ul> 
<h4><a id="25MNN_96"></a>2.5、MNN</h4> 
<p>1、开源时间：2019年5月<br> 2、开源用户：阿里<br> 3、<a href="https://github.com/alibaba/MNN">GIthub地址</a><br> 4、简介：轻量级的深度神经网络推理引擎，在端侧加载深度神经网络模型进行推理预测。目前，MNN已经在阿里巴巴的手机淘宝、手机天猫、优酷等20多个App中使用，覆盖直播、短视频、搜索推荐、商品图像搜索、互动营销、权益发放、安全风控等场景<br> 5、<em>架构</em><br> <img src="https://images2.imgbox.com/a0/65/oTYF3nzj_o.png" alt="在这里插入图片描述"></p> 
<p>6、<mark>优缺点分析</mark></p> 
<ul><li> <p>优点<br> 1)、支持多个OP算子，跨平台<br> 2)、针对端侧设备特点深度定制和裁剪，无任何依赖<br> 3)、不依赖任何第三方计算库，依靠大量手写汇编实现核心运算，充分发挥 ARM CPU 的算力<br> 4)、针对主流模型进行深度调优，满足多种设备需求</p> </li><li> <p>待提升<br> 1)、优化量化的卷积、矩阵乘法<br> 2)、分步实现端侧训练和边缘学习</p> </li></ul> 
<h3><a id="3_114"></a>3、性能对比</h3> 
<p><img src="https://images2.imgbox.com/8f/67/ZFFnhBY5_o.png" alt="在这里插入图片描述"></p> 
<p>MobileNet V2，在 OPPO r17 和 iPhone 7Plus 上做了一系列的性能对比，MNN在端推理、模型的扩展性、CPU和GPU算子上做出了优化，MNN性能胜出。</p> 
<h4><a id="4demo_118"></a>4、demo演示</h4> 
<p><img src="https://images2.imgbox.com/9a/95/r7yjYrR0_o.gif" alt="使用NCNN推理框架"></p> 
<h4><a id="_120"></a>参考博客</h4> 
<p><a href="https://developer.android.com/ml?hl=zh-cn" rel="nofollow">Android机器学习文档</a><br> <a href="https://www.infoq.cn/article/9rl6omaepssjxh8*h48v" rel="nofollow">淘宝在移动 AI 上的实践</a><br> <a href="https://toutiao.io/posts/8250zb/preview" rel="nofollow">淘宝轻量级的深度学习端侧推理引擎 MNN 开源</a><br> <a href="https://www.cnblogs.com/LXP-Never/p/14840535.html#blogTitle3" rel="nofollow">移动端深度学习开源框架及部署</a><br> <a href="https://github.com/scutan90/DeepLearning-500-questions">深度学习500问</a><br> <a href="https://cloud.tencent.com/developer/article/1514908" rel="nofollow">Paddle Lite推理引擎</a><br> <a href="https://cloud.tencent.com/developer/article/1764487" rel="nofollow">NCNN推理框架</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7789a9a88add456871a3265bd5ff76bd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">什么是图神经网络GNN？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5413a2ebb6f76399fe0f3284e3cadd2d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【笔记】Canny算法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>