<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>uniapp打开第三方 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="uniapp打开第三方" />
<meta property="og:description" content="&lt;template&gt; &lt;view&gt; &lt;view class=&#34;header border-bottom&#34;&gt; &lt;view :style=&#34;{height: systemBarHeight}&#34;&gt;&lt;/view&gt; &lt;view class=&#34;headertop px-2 d-flex a-center j-sb&#34;&gt; &lt;view class=&#34;mr-5&#34; @click=&#34;nextBack&#34;&gt; &lt;image style=&#34;width: 45rpx;height: 45rpx;&#34; src=&#34;../../static/back.png&#34; mode=&#34;&#34;&gt;&lt;/image&gt; &lt;/view&gt; &lt;view class=&#34;wrapInput py-1 px-3 flex-1&#34;&gt; &lt;input v-model=&#34;keyword&#34; type=&#34;text&#34; placeholder=&#39;请输入关键字&#39;&gt; &lt;/view&gt; &lt;view class=&#34;ml-4 search&#34; @click=&#34;searchBtn&#34;&gt;搜索&lt;/view&gt; &lt;/view&gt; &lt;view class=&#34;d-flex a-center bg-white&#34;&gt; &lt;view class=&#34;flex-1&#34;&gt; &lt;uni-data-select v-model=&#34;subId&#34; :localdata=&#34;SubCategoryList&#34; placeholder=&#34;请选择标准&#34;&gt;&lt;/uni-data-select&gt; &lt;/view&gt; &lt;view class=&#34;flex-1&#34;&gt; &lt;uni-data-select v-model=&#34;status&#34; :localdata=&#34;range&#34;&gt;&lt;/uni-data-select&gt; &lt;/view&gt; &lt;/view&gt; &lt;/view&gt; &lt;view :style=&#34;{height: fixedHeight}&#34;&gt;&lt;/view&gt; &lt;view class=&#34;p-2&#34;&gt; &lt;view class=&#34;wrap p-2 mb-2&#34; v-for=&#34;(item,index) in tableData&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/18c871cf52951aeb799946d9eea30ca4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-14T10:19:31+08:00" />
<meta property="article:modified_time" content="2023-11-14T10:19:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">uniapp打开第三方</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code class="language-javascript">&lt;template&gt;
	&lt;view&gt;
		&lt;view class="header border-bottom"&gt;
			&lt;view :style="{height: systemBarHeight}"&gt;&lt;/view&gt;
			&lt;view class="headertop px-2 d-flex a-center j-sb"&gt;
				&lt;view class="mr-5" @click="nextBack"&gt;
					&lt;image style="width: 45rpx;height: 45rpx;" src="../../static/back.png" mode=""&gt;&lt;/image&gt;
				&lt;/view&gt;
				&lt;view class="wrapInput py-1 px-3 flex-1"&gt;
					&lt;input v-model="keyword" type="text" placeholder='请输入关键字'&gt;
				&lt;/view&gt;
				&lt;view class="ml-4 search" @click="searchBtn"&gt;搜索&lt;/view&gt;
			&lt;/view&gt;
			&lt;view class="d-flex a-center bg-white"&gt;
				&lt;view class="flex-1"&gt;
					&lt;uni-data-select v-model="subId" :localdata="SubCategoryList" placeholder="请选择标准"&gt;&lt;/uni-data-select&gt;
				&lt;/view&gt;
				&lt;view class="flex-1"&gt;
					&lt;uni-data-select v-model="status" :localdata="range"&gt;&lt;/uni-data-select&gt;
				&lt;/view&gt;
			&lt;/view&gt;
		&lt;/view&gt;
		&lt;view :style="{height: fixedHeight}"&gt;&lt;/view&gt;
		&lt;view class="p-2"&gt;
			&lt;view class="wrap p-2 mb-2" v-for="(item,index) in tableData" :key="index" @click="nextTo(item)"&gt;
				&lt;view class="mb-1 font-weight"&gt;{<!-- -->{item.FileName}}&lt;/view&gt;
				&lt;view class="d-flex"&gt;
					&lt;view class="flex-1 text-one-line"&gt;文号:{<!-- -->{item.WenHao}}&lt;/view&gt;
					&lt;view class="flex-1 text-one-line ml-3"&gt;实施日期: {<!-- -->{item.ExecDate}}&lt;/view&gt;
				&lt;/view&gt;
				&lt;view class="d-flex"&gt;
					&lt;view class="flex-1 text-one-line"&gt;{<!-- -->{item.SubCategory}}&lt;/view&gt;
					&lt;view class="flex-1 text-one-line ml-3 d-flex"&gt;
						&lt;view&gt;{<!-- -->{item.DeptName}}&lt;/view&gt;
						&lt;view class="ml-2"&gt;{<!-- -->{item.StatusText}}&lt;/view&gt;
					&lt;/view&gt;
				&lt;/view&gt;
			&lt;/view&gt;
			&lt;u-modal showCancelButton @cancel="show=false" @confirm="openFile" :show="show" :title="title" :content='content'&gt;&lt;/u-modal&gt;
			&lt;u-loadmore class="mt-1" :status="status" :loading-text="loadingText" :loadmore-text="loadmoreText"
				:nomore-text="nomoreText" :line="true" /&gt;
		&lt;/view&gt;
	&lt;/view&gt;
&lt;/template&gt;

&lt;script&gt;
	export default {
		data() {
			return {
				// 系统状态栏的高度
				systemBarHeight: 0,
				fixedHeight: 0,
				categoryId: 0,
				keyword: '',
				page: 1,
				pageSize: 10,
				totalPages: null,
				tableData: [],
				show:false,
				title:'浏览文件',
				content:'文件需要通过第三方软件打开，是否继续？',
				openUrl:'',
				status: 'nomore',
				loadingText: '努力加载中',
				loadmoreText: '',
				nomoreText: '已加载全部数据',
				SubCategoryList: [],
				subId: '',
				status: '',
				range: [{
						value: '',
						text: "全部"
					},
					{
						value: '1',
						text: "现行"
					},
					{
						value: '0',
						text: "废止"
					},
				],
			}
		},
		onLoad(opt) {
			this.getSysteminfo()
			console.log(JSON.parse(opt.data));
			this.categoryId = JSON.parse(opt.data).id
			this.getSubCategoryList()
			this.getFileList()
		},
		onReachBottom() {
			if (this.page &gt;= this.totalPages) {
				this.status = 'nomore'
				return;
			}
			this.page++;
			this.getFileList()
		},
		methods: {
			nextTo(item) {
				console.log(item.FilePath);
				console.log(this.$http.pdfUrl);
				var filename = item.FilePath;
				var extension = filename.split('.').pop();
				let url = this.$http.pdfUrl + item.FilePath
				this.openUrl=url
				console.log(extension);
				if (extension == 'pdf') {
					// let url = 'http://192.168.0.3:9996' + item.FilePath
					uni.navigateTo({
						url: '/pages/officefile/officefile?url=' + url
					})
				} else {
					this.show=true
					
				}
				// let url = 'http://192.168.0.3:9996' + item.FilePath
				// uni.navigateTo({
				// 	url: '/pages/officefile/officefile?url=' + url
				// })
			},
			openFile(){
				var dtask = plus.downloader.createDownload(this.openUrl, {}, function(d, status) {
					if (status == 200) {
						var fileUrl = d.filename;
						plus.runtime.openFile(fileUrl, {}, function(e) {
							plus.nativeUI.alert("打开失败！");
						});
				
					} else {
						alert("Download failed: " + status);
					}
				});
				dtask.start();
				this.show=false
			},
			searchBtn() {
				this.page = 1,
					this.pageSize = 10,
					this.totalPages = null,
					this.tableData = [],
					this.getFileList()
			},
			getFileList() {
				let data = {
					categoryId: this.categoryId,
					keyword: this.keyword,
					subId: this.subId,
					status: this.status,
					page: this.page,
					pageSize: this.pageSize
				}
				this.$http.get('App2/GetFileList', data).then(res =&gt; {
					console.log(res, '11111111');
					this.totalPages = res.TotalPages
					this.tableData = this.tableData.concat(res.data)
				})
			},
			getSysteminfo() {
				uni.getSystemInfo({
					success: res =&gt; {
						this.systemBarHeight = res.statusBarHeight + 'px';
						this.fixedHeight = res.statusBarHeight + 88 + 'px'
					}
				});
			},
			getSubCategoryList() {
				this.$http.get('App2/GetSubCategoryList?categoryId=' + this.categoryId).then(res =&gt; {
					console.log(res);
					this.SubCategoryList = res.map(item =&gt; {
						return {
							value: item.ID,
							text: item.Name
						}
					})
				})
			},
			nextBack() {
				uni.navigateBack()
			}
		}
	}
&lt;/script&gt;

&lt;style lang="scss"&gt;
	.header {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		background-color: #fff;
		z-index: 999;
		background-color: #3d7eff;
	}

	.headertop {
		height: 88rpx;
		width: 100%;
		background-color: #3d7eff;
	}

	.wrapInput {
		// background-color: rgba(0, 0, 0, 0.2);
		background-color: #fff;
		border-radius: 10rpx;
	}

	.search {
		color: #fff;
		font-size: 14px;
	}

	.wrap {
		background-color: #fff;
		border-radius: 15rpx;
		box-shadow: 0 5rpx 10rpx rgba(0, 0, 0, .2);
	}
&lt;/style&gt;</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a200bfadb590ce92ec61050b76b2cc6d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Win10通用串行总线usb控制器有感叹号的解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5acaf589ad8a1aa7fcec8c342c7e9359/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">uniapp推送PUSH1.0的</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>