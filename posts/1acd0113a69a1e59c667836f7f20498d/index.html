<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>android蚂蚁金服支付宝支付集成步骤 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="android蚂蚁金服支付宝支付集成步骤" />
<meta property="og:description" content="此篇仅限于android客户端集成步骤,查看全部的请转https://docs.open.alipay.com/204/105296/
自支付宝 SDK 15.5.7 开始,打包方式更换为 AAR，替代之前的 JAR 打包，SDK 支付接口部分不变.现在就基于支付宝SDK15.5.7集成支付宝支付
首先下载新的AAR的SDK包:https://download.csdn.net/download/lanrenxiaowen/10811584
一.下载完将里面的AAR格式包放入到项目的libs里面 二.在您主项目的 build.gradle 中，添加下面的内容，将 libs 目录作为依赖仓库： allprojects { repositories { google() jcenter() maven { url &#39;https://www.jitpack.io&#39; } flatDir { dirs &#39;libs&#39; } } } 三.在您 App Module 的 build.gradle 中，添加下面的内容，将支付宝 SDK 作为项目依赖： //支付宝支付 implementation (name: &#39;alipaySdk-15.5.7-20181023110917&#39;, ext: &#39;aar&#39;) 权限配置: &lt;!-- 访问网络，网络定位需要上网 --&gt; &lt;uses-permission android:name=&#34;android.permission.INTERNET&#34; /&gt; &lt;!-- 获取运营商信息，用于支持提供运营商信息相关的接口 --&gt; &lt;uses-permission android:name=&#34;android.permission.ACCESS_NETWORK_STATE&#34; /&gt; &lt;!-- 用于访问wifi网络信息，wifi信息会用于进行网络定位 --&gt; &lt;uses-permission android:name=&#34;android.permission.ACCESS_WIFI_STATE&#34; /&gt; &lt;!-- 用于读取手机当前的状态 --&gt; &lt;uses-permission android:name=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1acd0113a69a1e59c667836f7f20498d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-11-27T21:17:04+08:00" />
<meta property="article:modified_time" content="2018-11-27T21:17:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">android蚂蚁金服支付宝支付集成步骤</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>此篇仅限于android客户端集成步骤,查看全部的请转</strong><a href="https://docs.open.alipay.com/204/105296/" rel="nofollow">https://docs.open.alipay.com/204/105296/</a></p> 
<p><strong>自支付宝 SDK  15.5.7 开始,打包方式更换为 AAR，替代之前的 JAR 打包，SDK 支付接口部分不变.现在就基于支付宝SDK15.5.7集成支付宝支付</strong></p> 
<p><strong>首先下载新的AAR的SDK包</strong>:<a href="https://download.csdn.net/download/lanrenxiaowen/10811584">https://download.csdn.net/download/lanrenxiaowen/10811584</a></p> 
<h4><span style="color:#7c79e5;">一.下载完将里面的AAR格式包放入到项目的libs里面</span></h4> 
<p><img alt="" class="has" src="https://images2.imgbox.com/2f/4f/1cvv07px_o.png"></p> 
<h4><span style="color:#7c79e5;">二.在您主项目的 <code>build.gradle</code> 中，添加下面的内容，将 <code>libs</code> 目录作为依赖仓库：</span></h4> 
<p><img alt="" class="has" src="https://images2.imgbox.com/10/42/N0w9fzeE_o.png"></p> 
<pre class="has"><code>allprojects {
    repositories {
        google()
        jcenter()
        maven { url 'https://www.jitpack.io' }
        flatDir {
            dirs 'libs'
        }
    }
}</code></pre> 
<h4> <span style="color:#7c79e5;">三.在您 App Module 的 build.gradle 中，添加下面的内容，将支付宝 SDK 作为项目依赖：</span></h4> 
<p><img alt="" class="has" src="https://images2.imgbox.com/de/bc/hbJyTAN2_o.png"></p> 
<pre class="has"><code>//支付宝支付
implementation (name: 'alipaySdk-15.5.7-20181023110917', ext: 'aar')</code></pre> 
<h4>权限配置:</h4> 
<pre class="has"><code>    &lt;!-- 访问网络，网络定位需要上网 --&gt;
    &lt;uses-permission android:name="android.permission.INTERNET" /&gt;
    &lt;!-- 获取运营商信息，用于支持提供运营商信息相关的接口 --&gt;
    &lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /&gt;
    &lt;!-- 用于访问wifi网络信息，wifi信息会用于进行网络定位 --&gt;
    &lt;uses-permission android:name="android.permission.ACCESS_WIFI_STATE" /&gt;
    &lt;!-- 用于读取手机当前的状态 --&gt;
    &lt;uses-permission android:name="android.permission.READ_PHONE_STATE" /&gt;
    &lt;!-- 写入扩展存储，向扩展卡写入数据，用于写入离线定位数据 --&gt;
    &lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /&gt;</code></pre> 
<p><strong>如果您的应用已经升级 <code>targetSdk</code> 到 23 及以上，则需要在运行时向用户申请 <code>WRITE_EXTERNAL_STORAGE</code> 和 <code>READ_PHONE_STATE</code> 这两项权限。</strong></p> 
<h3>到这里咱们的资源和配置工作已经准备完成,接下来就是调起支付宝了</h3> 
<h4><span style="color:#7c79e5;">调起支付宝只需要一个参数就是订单的签名,就是后台返回给你的一个字符串,假装咱们已经有了这个字符串</span></h4> 
<pre class="has"><code>String qianming = "后台返回过来的签名";
例如:
{
    "code": 800,
    "msg": "成功",
    "obj": "alipay_sdk=alipay-sdk-java-dynamicVersionNo&amp;app_id=2016120103702677&amp;biz_content=%7B%22out_trade_no%22%3A%22R42581972062%22%2C%22product_code%22%3A%22QUICK_WAP_PAY%22%2C%22subject%22%3A%22%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%AF%E4%BB%98%22%2C%22total_amount%22%3A%220.01%22%7D&amp;charset=utf-8&amp;format=json&amp;method=alipay.trade.app.pay&amp;notify_url=http%3A%2F%2F%E5%B7%A5%E7%A8%8B%E5%85%AC%E7%BD%91%E8%AE%BF%E9%97%AE%E5%9C%B0%E5%9D%80%2Falipay.trade.page.pay-JAVA-UTF-8%2Fnotify_url.jsp&amp;sign=II53m99LCRlE%2BTnpYg6UzZa0TOmLdWXjb60ikkvkozgPHzwhtYsi4e%2B3gBw%2FaD7NtyURsxaXTmsEzwDB2D99oXzZbuWAOTQtRPLoaNXNu%2FouZqXmZ71aQ1llYpt1o%2FYe2YpUTO2cvQHLgBSC%2FBOK55avlm9LwEK4BkZVyz8qTLg%3D&amp;sign_type=RSA&amp;timestamp=2018-11-27+21%3A32%3A26&amp;version=1.0"
}
其中obj字段就是咱们需要用到的签名</code></pre> 
<h4><span style="color:#7c79e5;">然后就是根据这个签名调起支付宝进行支付,订单的信息全部都在这个签名里面,在你的获取签名的请求成功方法里面加入</span></h4> 
<pre class="has"><code>//支付
PayUtils pay = new PayUtils(ConfirmOrderActivity.this, mHandler);
pay.ZFB_PAY(qianming, ConfirmOrderActivity.this);</code></pre> 
<pre class="has"><code>private static final int SDK_PAY_FLAG = 1; 
private Handler mHandler = new Handler() {
        @Override
        public void handleMessage(Message msg) {
            switch (msg.what) {
                case SDK_PAY_FLAG: {
                    PayResult payResult = new PayResult((String) msg.obj);
                    /**
                     * 同步返回的结果必须放置到服务端进行验证（验证的规则请看https://doc.open.alipay.com/doc2/
                     * detail.htm?spm=0.0.0.0.xdvAU6&amp;treeId=59&amp;articleId=103665&amp;
                     * docType=1) 建议商户依赖异步通知
                     */
                    String resultInfo = payResult.getResult();// 同步返回需要验证的信息

                    String resultStatus = payResult.getResultStatus();
                    Log.e("alicode", resultStatus + "");
                    // 判断resultStatus 为“9000”则代表支付成功，具体状态码代表含义可参考接口文档
                    if (TextUtils.equals(resultStatus, "9000")) {
                        Toast.makeText(ConfirmOrderActivity.this, "支付成功",
                                Toast.LENGTH_SHORT).show();
                    } else {
                        // 判断resultStatus 为非"9000"则代表可能支付失败
                        // "8000"代表支付结果因为支付渠道原因或者系统原因还在等待支付结果确认，最终交易是否成功以服务端异步通知为准（小概率状态）
                        if (TextUtils.equals(resultStatus, "8000")) {
                            Toast.makeText(ConfirmOrderActivity.this, "支付结果确认中",
                                    Toast.LENGTH_SHORT).show();
                        } else {
                            // 其他值就可以判断为支付失败，包括用户主动取消支付，或者系统返回的错误
                            Toast.makeText(ConfirmOrderActivity.this,
                                    "支付失败" + resultStatus, Toast.LENGTH_SHORT)
                                    .show();
                        }
                    }
                    break;
                }
            }
        }

        ;
    };</code></pre> 
<p>至此,android支付宝支付就集成完毕了,如果不成功,就请你们的后台同事调参数吧</p> 
<h4>微信支付参考:<a href="https://blog.csdn.net/lanrenxiaowen/article/details/84589592">https://blog.csdn.net/lanrenxiaowen/article/details/84589592</a></h4>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8df9ea3bff64088e94dba241de09eea9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">openssl/ssl.h  file not found   mac 完美解决</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8849ad59a5a1eae4143e2899c7b1e1dd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">R语言学习(五)——聚类分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>