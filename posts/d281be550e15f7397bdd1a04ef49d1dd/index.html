<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Docker安装Jenkins打包Maven项目为Docker镜像并运行【保姆级图文教学】 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Docker安装Jenkins打包Maven项目为Docker镜像并运行【保姆级图文教学】" />
<meta property="og:description" content="一、前言 Jenkins作为CI、CD的先驱者，虽然现在的风头没有Gitlab强了，但是还是老当益壮，很多中小公司还是使用比较广泛的。最近小编经历了一次Jenkins发包，感觉还不错，所以自己学习了一下。网上比较多的教程都是在Linux上搭建Jenkins，小编经过一个星期的探索终于完成了在docker中进行搭建。
最终版就是：通过git上传代码—&gt;使用Jenkins构建自动打包—&gt;把jar包打成docker镜像，运行在docker中，Windows下进行访问
主要记录一下一些踩过的坑和注意点，让后来人能够跟着小编一次完成！！
二、安装Docker 安装Docker
三、linux安装jdk和maven 1、下载JDK8Linux版本 官网下载太慢了，小编这里为大家下载好了：
链接：百度网盘地址
提取码：ov24
2、下载Maven maven3.8.5下载链接
3、使用xftp上传到linux上 4、解压 解压maven
tar -zxvf apache-maven-3.8.5-bin.tar.gz 重命名maven
mv apache-maven-3.8.5-bin.tar.gz apache-maven-3.8.5 解压jdk
tar -zxvf jdk-8u333-linux-x64.tar.gz 重命名jdk
mv jdk-8u333-linux-x64.tar.gz jdk1.8 5、配置环境变量 进入环境变量文件
vim /etc/profile 添加jdk和manven配置
输入i，进入输入模式
注意自己的安装目录，放在文件最上面就行
JAVA_HOME=/usr/local/java/jdk1.8 CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar PATH=$JAVA_HOME/bin:$PATH export JAVA_HOME CLASSPATH PATH export MAVEN_HOME=/usr/local/java/apache-maven-3.8.5 export PATH=${MAVEN_HOME}/bin:${PATH} 按下esc ，输入:wq保存退出。
查看是否安装成功
java -version mvn -v 6、配置Maven加速镜像 cd apache-maven-3.8.5/conf/ vim settings.xml 输入i，进入输入模式
&lt;mirrors&gt; &lt;mirror&gt; &lt;id&gt;alimaven&lt;/id&gt; &lt;name&gt;aliyun maven&lt;/name&gt; &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt; &lt;mirrorOf&gt;central&lt;/mirrorOf&gt; &lt;/mirror&gt; &lt;/mirrors&gt; 按下esc ，输入:wq保存退出。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/d281be550e15f7397bdd1a04ef49d1dd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-08T15:06:34+08:00" />
<meta property="article:modified_time" content="2022-06-08T15:06:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Docker安装Jenkins打包Maven项目为Docker镜像并运行【保姆级图文教学】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>一、前言</h3> 
<p>Jenkins作为CI、CD的先驱者，虽然现在的风头没有Gitlab强了，但是还是老当益壮，很多中小公司还是使用比较广泛的。最近小编经历了一次Jenkins发包，感觉还不错，所以自己学习了一下。网上比较多的教程都是在Linux上搭建Jenkins，小编经过一个星期的探索终于完成了在docker中进行搭建。</p> 
<p><strong>最终版就是：通过git上传代码—&gt;使用Jenkins构建自动打包—&gt;把jar包打成docker镜像，运行在docker中，Windows下进行访问</strong></p> 
<p>主要记录一下一些踩过的坑和注意点，让后来人能够跟着小编一次完成！！</p> 
<h3><a id="Docker_7"></a>二、安装Docker</h3> 
<p><a href="https://blog.csdn.net/qq_52423918/article/details/120560581">安装Docker</a></p> 
<h3><a id="linuxjdkmaven_10"></a>三、linux安装jdk和maven</h3> 
<h4><a id="1JDK8Linux_12"></a>1、下载JDK8Linux版本</h4> 
<p>官网下载太慢了，小编这里为大家下载好了：</p> 
<p>链接：<a href="https://pan.baidu.com/s/1nlfc2gwL0Ho_wWbVuJiG4g" rel="nofollow">百度网盘地址</a><br> 提取码：ov24</p> 
<h4><a id="2Maven_18"></a>2、下载Maven</h4> 
<p><a href="https://dlcdn.apache.org/maven/maven-3/3.8.5/binaries/apache-maven-3.8.5-bin.tar.gz" rel="nofollow">maven3.8.5下载链接</a></p> 
<h4><a id="3xftplinux_21"></a>3、使用xftp上传到linux上</h4> 
<p><img src="https://images2.imgbox.com/a0/66/ihESU3tn_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="4_23"></a>4、解压</h4> 
<p><strong>解压maven</strong></p> 
<pre><code class="prism language-shell"><span class="token function">tar</span> -zxvf apache-maven-3.8.5-bin.tar.gz
</code></pre> 
<p><strong>重命名maven</strong></p> 
<pre><code class="prism language-shell"><span class="token function">mv</span> apache-maven-3.8.5-bin.tar.gz apache-maven-3.8.5
</code></pre> 
<p><strong>解压jdk</strong></p> 
<pre><code class="prism language-shell"><span class="token function">tar</span> -zxvf jdk-8u333-linux-x64.tar.gz
</code></pre> 
<p><strong>重命名jdk</strong></p> 
<pre><code class="prism language-shell"><span class="token function">mv</span> jdk-8u333-linux-x64.tar.gz jdk1.8
</code></pre> 
<h4><a id="5_43"></a>5、配置环境变量</h4> 
<p><strong>进入环境变量文件</strong></p> 
<pre><code class="prism language-bash"><span class="token function">vim</span> /etc/profile
</code></pre> 
<p><strong>添加jdk和manven配置</strong><br> 输入<code>i</code>，进入输入模式</p> 
<p>注意自己的安装目录，放在文件最上面就行</p> 
<pre><code class="prism language-bash"><span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/local/java/jdk1.8
<span class="token assign-left variable">CLASSPATH</span><span class="token operator">=</span>.:<span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar
<span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">$JAVA_HOME</span>/bin:<span class="token environment constant">$PATH</span>
<span class="token builtin class-name">export</span> JAVA_HOME CLASSPATH <span class="token environment constant">PATH</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">MAVEN_HOME</span><span class="token operator">=</span>/usr/local/java/apache-maven-3.8.5
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">${MAVEN_HOME}</span>/bin:<span class="token variable">${<!-- --><span class="token environment constant">PATH</span>}</span>
</code></pre> 
<p>按下<code>esc</code> ，输入<code>:wq</code>保存退出。</p> 
<p><img src="https://images2.imgbox.com/e1/f0/P7sPAdCD_o.png" alt="在这里插入图片描述"></p> 
<p><strong>查看是否安装成功</strong></p> 
<pre><code class="prism language-bash">java -version
</code></pre> 
<pre><code class="prism language-bash">mvn -v
</code></pre> 
<p><img src="https://images2.imgbox.com/31/55/YITtwl4g_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="6Maven_78"></a>6、配置Maven加速镜像</h4> 
<pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> apache-maven-3.8.5/conf/
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">vim</span> settings.xml
</code></pre> 
<p>输入<code>i</code>，进入输入模式</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrors</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirror</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>alimaven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>aliyun maven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">&gt;</span></span>http://maven.aliyun.com/nexus/content/groups/public/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrorOf</span><span class="token punctuation">&gt;</span></span>central<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrorOf</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirror</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrors</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>按下<code>esc</code> ，输入<code>:wq</code>保存退出。</p> 
<p><img src="https://images2.imgbox.com/71/cb/SPIVasoi_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="DockerJenkins_102"></a>四、Docker安装Jenkins</h3> 
<h4><a id="1_103"></a>1.准备挂载目录</h4> 
<pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> home/
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> jenkins_home
</code></pre> 
<p>一定要赋予修改权限，不然挂载会失败，我们这里给最高权限。</p> 
<pre><code class="prism language-bash"><span class="token function">chmod</span> -R <span class="token number">777</span> jenkins_home
</code></pre> 
<p><img src="https://images2.imgbox.com/85/d6/skz7B1FN_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_docker_117"></a>2. 执行docker命令</h4> 
<pre><code class="prism language-bash"><span class="token function">docker</span> run -di --name<span class="token operator">=</span>myjenkins -p <span class="token number">8080</span>:8080 -v /home/jenkins_home:/var/jenkins_home <span class="token punctuation">\</span>
-v /usr/local/java/jdk:/usr/local/jdk1.8 <span class="token punctuation">\</span>
-v /usr/local/java/apache-maven-3.8.5:/usr/local/apache-maven-3.8.5 <span class="token punctuation">\</span>
-v <span class="token variable"><span class="token variable">$(</span><span class="token function">which</span> <span class="token function">docker</span><span class="token variable">)</span></span>:/usr/bin/docker <span class="token punctuation">\</span>
-v /var/run/docker.sock:/var/run/docker.sock jenkins/jenkins:lts
</code></pre> 
<p><code>-v /home/jenkins_home:/var/jenkins_home</code>：是对容器内存储Jenkins的一些配置信息的文件夹<br> <code>-v /usr/local/java/jdk:/usr/local/jdk1.8</code>：是把linux下的jdk和容器内的关联（配置Jenkins时使用）<br> <code>-v /usr/local/java/apache-maven-3.8.5:/usr/local/apache-maven-3.8.5</code>：是把linux下的maven和容器内的关联（配置Jenkins时使用）</p> 
<p><code>-v $(which docker):/usr/bin/docker -v /var/run/docker.sock:/var/run/docker.sock</code>：是可以在Jenkins容器里使用我们Linux下的docker。</p> 
<h3><a id="Jenkins_132"></a>五、配置Jenkins</h3> 
<h4><a id="1_Jenkins_133"></a>1. 进入Jenkins</h4> 
<p>输入：<code>http://192.168.84.133:8080/</code>（ip+端口号）<br> <img src="https://images2.imgbox.com/e5/62/J5cyZR86_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2__136"></a>2. 获取密码</h4> 
<pre><code class="prism language-bash"><span class="token function">docker</span> logs 容器id
</code></pre> 
<p><img src="https://images2.imgbox.com/fe/73/az3ul4ZY_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/61/49/MRs6HsYy_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/32/98/c6OSRfrw_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3__144"></a>3. 安装插件</h4> 
<p><img src="https://images2.imgbox.com/cf/ca/ne7061gF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/01/a8/SOExIilP_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="4__148"></a>4. 创建用户</h4> 
<p><img src="https://images2.imgbox.com/37/9c/Fk6kwQa0_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="5__150"></a>5. 保存配置地址</h4> 
<p><img src="https://images2.imgbox.com/74/98/QR8egn1q_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="6__152"></a>6. 配置插件镜像</h4> 
<p><img src="https://images2.imgbox.com/5b/27/gntF6atF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/85/c0/oWXfMnnV_o.png" alt="在这里插入图片描述"><br> 输入：<code>https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</code></p> 
<p>点击提交<br> <img src="https://images2.imgbox.com/fa/3f/KC3i2tZQ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/14/07/VzHBnCvl_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="7_ssh_160"></a>7. 安装ssh插件</h4> 
<p><img src="https://images2.imgbox.com/7c/40/mcPtqo3S_o.png" alt="在这里插入图片描述"><br> <mark>安装完成重启一下Jenkins</mark></p> 
<h4><a id="8_ssh_164"></a>8. 添加ssh登录账号凭据</h4> 
<p>点击<code>系统管理</code>，找到下图点击<br> <img src="https://images2.imgbox.com/33/9b/bRrmOUUF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/38/c0/JfYsQbsV_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/df/b3/U4K41Ek5_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="9_ssh_170"></a>9. 配置全局ssh</h4> 
<p>点击<code>系统管理</code>，找到<code>系统配置</code></p> 
<p><img src="https://images2.imgbox.com/c8/5e/wMHdyWsI_o.png" alt="在这里插入图片描述"><br> 点击新增：</p> 
<p><img src="https://images2.imgbox.com/33/f5/TvJ7x7RU_o.png" alt="在这里插入图片描述"><br> 点击保存：<br> <img src="https://images2.imgbox.com/c3/bf/h4BDvur9_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="10_jdkmaven_180"></a>10. 配置jdk和maven</h4> 
<p>点击<code>系统管理</code>，找到<code>全局工具配置</code>：<br> <img src="https://images2.imgbox.com/6b/14/AxkCH2Qb_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/64/62/m0JGD7cV_o.png" alt="在这里插入图片描述"><br> 点击保存</p> 
<h3><a id="Springbootgit_188"></a>六、准备Springboot项目到git</h3> 
<h4><a id="1__189"></a>1. 核心代码</h4> 
<p>我们看到只是一个请求打印，我们最后访问有<code>docker成功</code>，代表我们构建发包成功！</p> 
<p><img src="https://images2.imgbox.com/78/94/Hm7N76rf_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_pom_193"></a>2. pom内容</h4> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">&gt;</span></span>repackage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includeSystemScope</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includeSystemScope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="3_yml_215"></a>3. yml文件</h4> 
<p>这里只指定了端口号</p> 
<pre><code class="prism language-yaml">server.port=8081
</code></pre> 
<h4><a id="4_Dockerfile_221"></a>4. Dockerfile</h4> 
<p><mark>和pom文件同级</mark></p> 
<pre><code class="prism language-bash">FROM java:8

COPY *.jar /app.jar

CMD <span class="token punctuation">[</span><span class="token string">"--server.port=8080"</span><span class="token punctuation">]</span>

EXPOSE <span class="token number">8080</span>

ENTRYPOINT <span class="token punctuation">[</span><span class="token string">"java"</span>, <span class="token string">"-jar"</span>, <span class="token string">"/app.jar"</span><span class="token punctuation">]</span>
</code></pre> 
<h4><a id="5_git_234"></a>5. 上传git仓库</h4> 
<p><img src="https://images2.imgbox.com/2a/0e/5WPhmjiN_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="Jenkins_236"></a>七、使用Jenkins部署项目</h3> 
<h4><a id="1__237"></a>1. 新建任务</h4> 
<p><img src="https://images2.imgbox.com/69/72/TK8DckM5_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d7/9b/4H9G5m6c_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_git_240"></a>2. 添加git凭据</h4> 
<p><img src="https://images2.imgbox.com/73/c9/xeb3Dnbv_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/70/9a/FIKHsjM1_o.png" alt="在这里插入图片描述"><br> <mark>选择刚刚添加的凭据报错信息消失</mark><br> <img src="https://images2.imgbox.com/b4/d1/G4M4t43R_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3_maven_245"></a>3. 添加maven构建</h4> 
<p><img src="https://images2.imgbox.com/ea/2f/4ddSmZiL_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b3/29/uX4gHapG_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="4_shell_248"></a>4. 增加构建执行shell</h4> 
<p><img src="https://images2.imgbox.com/95/64/cigW2Sv8_o.png" alt="在这里插入图片描述"><br> shell脚本：</p> 
<pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># 服务名称</span>
<span class="token assign-left variable">SERVER_NAME</span><span class="token operator">=</span>jenkins

<span class="token comment"># 源jar名称，mvn打包之后，target目录下的jar包名称</span>
<span class="token assign-left variable">JAR_NAME</span><span class="token operator">=</span>demo-0.0.1-SNAPSHOT

<span class="token comment"># jenkins下的目录</span>
<span class="token assign-left variable">JENKINS_HOME</span><span class="token operator">=</span>/var/jenkins_home/workspace/jenkins

<span class="token comment"># 等待三秒</span>
<span class="token builtin class-name">echo</span> <span class="token function">sleep</span> 3s
<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token builtin class-name">echo</span> <span class="token function">sleep</span> 2s
<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token builtin class-name">echo</span> <span class="token function">sleep</span> 1s
<span class="token function">sleep</span> <span class="token number">1</span>
      
<span class="token builtin class-name">echo</span> <span class="token string">"结束进程完成"</span>

<span class="token builtin class-name">cd</span> <span class="token variable">$JENKINS_HOME</span>/target

<span class="token function">cp</span> <span class="token variable">$JENKINS_HOME</span>/Dockerfile <span class="token variable">$JENKINS_HOME</span>/target

<span class="token comment"># 修改文件权限</span>
<span class="token function">chmod</span> <span class="token number">755</span> <span class="token variable">$JAR_NAME</span>.jar

<span class="token builtin class-name">echo</span> <span class="token string">"看看docker能不能用"</span>
<span class="token function">docker</span> -v

<span class="token builtin class-name">echo</span> <span class="token string">"停止容器"</span>
<span class="token comment"># 停止容器</span>
<span class="token function">docker</span> stop springboot

<span class="token builtin class-name">echo</span> <span class="token string">"删除容器"</span>
<span class="token comment"># 删除容器</span>
<span class="token function">docker</span> <span class="token function">rm</span> springboot
<span class="token builtin class-name">echo</span> <span class="token string">"删除镜像"</span>
<span class="token comment"># 删除镜像</span>
<span class="token function">docker</span> rmi springboot
<span class="token builtin class-name">echo</span> <span class="token string">"打包镜像"</span>
<span class="token comment"># 打包镜像</span>
<span class="token function">docker</span> build -t springboot <span class="token builtin class-name">.</span>
<span class="token builtin class-name">echo</span> <span class="token string">"运行镜像"</span>
<span class="token comment"># 运行镜像</span>
<span class="token function">docker</span> run -d -p <span class="token number">8081</span>:8081 --name springboot springboot
</code></pre> 
<p><img src="https://images2.imgbox.com/38/fe/vzUyblJT_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="5__303"></a>5. 立即构建</h4> 
<p><img src="https://images2.imgbox.com/61/d7/o1QoZSiI_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="6__305"></a>6. 控制台输出报错</h4> 
<p><img src="https://images2.imgbox.com/cc/b7/DnHlyrMi_o.png" alt="在这里插入图片描述"><br> 我们看到打包成功了，就是在使用docker命令的时候出现权限问题，这是我们要给docker.sock权限就可以解决了！！</p> 
<p>报错信息：</p> 
<pre><code class="prism language-bash">Got permission denied <span class="token keyword">while</span> trying to connect to the Docker daemon socket at
 unix:///var/run/docker.sock: Post 
 <span class="token string">"http://%2Fvar%2Frun%2Fdocker.sock/v1.24/containers/springboot/stop"</span><span class="token builtin class-name">:</span> dial unix 
 /var/run/docker.sock: connect: permission denied
</code></pre> 
<p><mark>解决方案：</mark></p> 
<pre><code class="prism language-bash"><span class="token function">chmod</span> a+rw /var/run/docker.sock
</code></pre> 
<h4><a id="7_322"></a>7.在次构建</h4> 
<p>我们发现没有报错，也看到了容器的id</p> 
<p><img src="https://images2.imgbox.com/6b/0c/SCk8wE5v_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="8_docker_327"></a>8. 查询docker镜像是否启动</h4> 
<pre><code class="prism language-bash"><span class="token function">docker</span> images
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">docker</span> <span class="token function">ps</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ec/33/gp6NrlB3_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="9_Win10_339"></a>9. Win10进行访问测试</h4> 
<p>输入地址：<code>http://192.168.84.133:8081/test/docker</code><br> <img src="https://images2.imgbox.com/f6/81/hZFNZXVg_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_343"></a>七、总结</h3> 
<p>小编断断续续研究了一星期，太不容易了，中间也是遇到很多坑，只要是跟着小编走下去的基本都可以跑出来的！<br> 看到这里还不给小编一键三连起来！！谢谢大家了哦~</p> 
<hr> 有缘人才可以看得到的哦！！！ 
<p><a href="https://wangzhenjun.xyz" rel="nofollow">点击访问！小编自己的网站，里面也是有很多好的文章哦！</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e34db6e41e252b5920270385c4286794/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">正确性与健壮性概述</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4d4b799bfa892bc6f21f931089af7d45/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">oralce 处理列转行的三种方式 最后生成表格样式数据</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>