<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>第八章（无人售货机零售项目实战） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="第八章（无人售货机零售项目实战）" />
<meta property="og:description" content="分组聚合客户订单
无人售货机客户订单信息表记录着有关客户的订单信息。
从客户的角度出发，分析客户订单信息表中的数据，了解客户订单状况，按照客户订单数据进行聚合计算，对客户订单消费金额从高到低进行排序，了解哪些客户的消费金额较多，并为这些客户提供更好的服务。
数据准备
聚合客户订单数据，需要在订单信息表“order_list.csv”文件中抽取以下字段数据。
（1） customerid（客户ID）：客户的唯一标识号，以该标识号聚合数据，因此客户ID不能为空，否则客户ID为空的数据将被过滤掉。
（2） customermobile（客户手机号码）：客户支付费用时所使用的手机号码。
（3） ordernum（订单号）：客户购买商品时生成的订单号。
（4） paytotalprice（订单实际支付金额）：客户订单实际支付金额。
（5） status（订单状态）：客户订单状态，只需抽取订单状态为“支付成功”的数据，而其他订单状态的数据将被过滤掉。
创建转换
（1）创建CSV文件输入组件和获取订单数据。创建CSV文件输入组件（组件命名为“CSV文件输入(订单)”），如图所示。设置参数，导入“order_list.csv”文件，并设置好字段参数。
（2）建立过滤和抽取数据组件和连接。创建过滤记录组件（组件命名为“过滤记录(客户ID非空和支付成功)”）、字段选择组件，用于筛选和抽取数据，并建立组件之间的连接，如图所示。 （3)进行字段选择，保留需要的字段，去除多余的字段。在【字段选择】组件中，设置参数，仅保留customerid、customermobile、ordernum和paytotalprice等字段，并分别改名为“客户ID”“客户手机号码”“order_num”和“pay_totalprice”，如图所示，丢弃其他与聚合客户订单无关的字段。
（4）对客户ID进行排序。因为是分组聚合客户订单，所以必须对客户ID进行排序，即同一个客户ID的数据要连在一起，否则数据可能不正确。在【排序记录】组件中，设置客户ID字段按照升序进行排序。
（5）对客户的订单数和商品实际支付金额等字段进行分组聚合，统计各个客户的订单。设置【分组】组件参数，在下图所示的【分组】对话框的【构成分组的字段】表中，设置【分组字段】为“客户ID”“客户手机号码”，即按照“客户ID”“客户手机号码”统计客户订单；在【聚合】表中，设置的参数如图所示。 （6）根据客户订单消费金额进行排序。在【排序记录(按客户销售金额排序)】组件中，设置客户消费金额字段按降序进行排序。
（7）将经过排序的各客户订单数据输出并装载至Excel文件中。在【Excel输出(客户订单)】组件中，设置参数，输出的Excel文件名为“无人售货机分组聚合客户订单.xls”，输出的字段参数设置如表所示。
运行
计算各个商品的消费金额
无人售货机客户订单的详情数据，记录着订单中的每种商品销售的数量、价格等数据。
从商品销售的角度出发，分析商品的销售数据，计算各种商品的销售金额，以便了解商品的销售情况，分析哪些商品属于热销或滞销商品，为商品的销售提供更好的运营决策。
创建转换
（1） 创建CSV文件输入组件和获取数据。创建CSV文件输入组件，组件命名为【CSV文件输入(订单)】，如图所示。设置组件参数，导入“order_details.csv”文件，并设置好字段参数，订单生成时间createdtime字段的字段类型需要设置为String。 （2）过滤掉售货机ID为空和支付失败的订单。在【过滤记录(售货机ID非空和支付成功)】组件中，设置参数，保留售货机ID非空和支付成功的订单，过滤掉售货机ID为空和支付不成功的订单.
（3）进行字段选择，保留需要的字段，去除多余的字段。在【字段选择】组件中，设置参数，仅保留productname、amount、productpaytotalprice等字段，并分别改名为“商品名称”“product_number”“product_paytotalprice”，如图所示，丢弃其他与计算各商品销售金额无关的字段。
（4）对商品名称进行排序。因为需要计算各商品的销售金额，所以必须对商品名称进行排序，在【排序记录】组件中，对商品名称字段按照升序进行排序。
（5）对购买商品数量和商品实际支付总金额等字段进行聚合计算，统计各个商品的销售金额。在【分组(按商品名称统计)】组件中，有关参数设置如图所示。 （6）根据商品销售金额进行排序。在【排序记录(按销售金额排序)】组件中，设置商品销售金额字段按照降序排序。
（7）将经过排序的各商品销售金额数据输出并装载至Excel文件中。在【Excel输出(各商品销售金额)】组件中，设置参数，输出的Excel文件名为“无人售货机各商品销售金额.xls”，输出的字段参数如表所示。
运行 品销售金额商品销售金
计算各商品销售金额
计算各商品销额" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ba0dddb70340bcb400ae5c68d4800bd3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-02T11:51:15+08:00" />
<meta property="article:modified_time" content="2022-11-02T11:51:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">第八章（无人售货机零售项目实战）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0in;text-align:left;"><strong>分组聚合客户订单</strong></p> 
<p style="margin-left:0in;text-align:left;"><span style="color:#000000;">无人售货机客户订单信息表记录着有关客户的订单信息。</span></p> 
<p style="margin-left:0in;text-align:left;"><span style="color:#000000;">从客户的角度出发，分析客户订单信息表中的数据，了解客户订单状况，按照客户订单数据进行聚合计算，对客户订单消费金额从高到低进行排序，了解哪些客户的消费金额较多，并为这些客户提供更好的服务。</span></p> 
<p><strong>数据准备</strong></p> 
<p style="margin-left:0in;text-align:justify;"><span style="color:#000000;">聚合客户订单数据，需要在订单信息表“</span><span style="color:#000000;">order_list.csv”</span><span style="color:#000000;">文件中抽取以下字段数据。</span></p> 
<p style="margin-left:0in;text-align:justify;"><span style="color:#000000;">（</span><span style="color:#000000;">1</span><span style="color:#000000;">） </span><span style="color:#000000;">customerid</span><span style="color:#000000;">（客户</span><span style="color:#000000;">ID</span><span style="color:#000000;">）：客户的唯一标识号，以该标识号聚合数据，因此客户</span><span style="color:#000000;">ID</span><span style="color:#000000;">不能为空，否则客户</span><span style="color:#000000;">ID</span><span style="color:#000000;">为空的数据将被过滤掉。</span></p> 
<p style="margin-left:0in;text-align:justify;"><span style="color:#000000;">（</span><span style="color:#000000;">2</span><span style="color:#000000;">） </span><span style="color:#000000;">customermobile</span><span style="color:#000000;">（客户手机号码）：客户支付费用时所使用的手机号码。</span></p> 
<p style="margin-left:0in;text-align:justify;"><span style="color:#000000;">（</span><span style="color:#000000;">3</span><span style="color:#000000;">） </span><span style="color:#000000;">ordernum</span><span style="color:#000000;">（订单号）：客户购买商品时生成的订单号。</span></p> 
<p style="margin-left:0in;text-align:justify;"><span style="color:#000000;">（</span><span style="color:#000000;">4</span><span style="color:#000000;">） </span><span style="color:#000000;">paytotalprice</span><span style="color:#000000;">（订单实际支付金额）：客户订单实际支付金额。</span></p> 
<p style="margin-left:0in;text-align:justify;"><span style="color:#000000;">（</span><span style="color:#000000;">5</span><span style="color:#000000;">） </span><span style="color:#000000;">status</span><span style="color:#000000;">（订单状态）：客户订单状态，只需抽取订单状态为“支付成功”的数据，而其他订单状态的数据将被过滤掉。</span></p> 
<p style="margin-left:0in;text-align:justify;"><strong>创建转换</strong></p> 
<p style="margin-left:0in;text-align:justify;"><img alt="" height="495" src="https://images2.imgbox.com/cc/91/jgdpjW7y_o.png" width="619"> </p> 
<p style="margin-left:0in;text-align:left;"><span style="color:#000000;">（1）创建</span><span style="color:#000000;">CSV</span><span style="color:#000000;">文件输入组件和获取订单数据。创建</span><span style="color:#000000;">CSV</span><span style="color:#000000;">文件输入组件（组件命名为“</span><span style="color:#000000;">CSV</span><span style="color:#000000;">文件输入</span><span style="color:#000000;">(</span><span style="color:#000000;">订单</span><span style="color:#000000;">)</span><span style="color:#000000;">”），如</span><span style="color:#000000;">图</span><span style="color:#000000;">所示。设置参数，导入“</span><span style="color:#000000;">order_list.csv</span><span style="color:#000000;">”文件，并设置好字段参数。</span></p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="713" src="https://images2.imgbox.com/89/cc/7HRhffUY_o.png" width="996"></p> 
<p><img alt="" height="947" src="https://images2.imgbox.com/69/ec/MdLybHyz_o.png" width="1200"></p> 
<p><span style="color:#000000;">（2）建立</span><span style="color:#000000;">过滤和抽取数据组件和连接。创建过滤记录组件（组件命名为“过滤记录</span><span style="color:#000000;">(</span><span style="color:#000000;">客户</span><span style="color:#000000;">ID</span><span style="color:#000000;">非空和支付成功</span><span style="color:#000000;">)</span><span style="color:#000000;">”）、字段选择组件，用于筛选和抽取数据，并建立组件之间的连接，如图所示。</span> </p> 
<p><img alt="" height="454" src="https://images2.imgbox.com/6b/c2/z2eor6L2_o.png" width="1200"></p> 
<p><span style="color:#000000;">（3)进行</span><span style="color:#000000;">字段选择，保留需要的字段，去除多余的字段。在</span><span style="color:#000000;">【</span><span style="color:#000000;">字段选择</span><span style="color:#000000;">】</span><span style="color:#000000;">组件中，设置参数，仅保留</span><span style="color:#000000;">customerid</span><span style="color:#000000;">、</span><span style="color:#000000;">customermobile</span><span style="color:#000000;">、</span><span style="color:#000000;">ordernum</span><span style="color:#000000;">和</span><span style="color:#000000;">paytotalprice</span><span style="color:#000000;">等字段，并分别改名为“客户</span><span style="color:#000000;">ID”“</span><span style="color:#000000;">客户手机号码”“</span><span style="color:#000000;">order_num</span><span style="color:#000000;">”</span><span style="color:#000000;">和“</span><span style="color:#000000;">pay_totalprice</span><span style="color:#000000;">”</span><span style="color:#000000;">，如图所示，丢弃其他与聚合客户订单无关的字段。</span></p> 
<p><img alt="" height="619" src="https://images2.imgbox.com/44/4d/hNlypeBK_o.png" width="1200"> <span style="color:#000000;">（4</span><span style="color:#000000;">）</span><span style="color:#000000;">对</span><span style="color:#000000;">客户</span><span style="color:#000000;">ID</span><span style="color:#000000;">进行排序。因为是分组聚合客户订单，所以必须对客户</span><span style="color:#000000;">ID</span><span style="color:#000000;">进行排序，即同一个客户</span><span style="color:#000000;">ID</span><span style="color:#000000;">的数据要连在一起，否则数据可能不正确。在【排序记录】组件中，设置客户</span><span style="color:#000000;">ID</span><span style="color:#000000;">字段按照升序进行排序。</span></p> 
<p><img alt="" height="481" src="https://images2.imgbox.com/8d/de/G1A9Z7e5_o.png" width="1011"></p> 
<p><span style="color:#000000;">（5</span><span style="color:#000000;">）</span><span style="color:#000000;">对客户的订单数和商品实际支付金额等字段进行分组聚合，统计各个客户的订单。设置【分组】组件参数，在</span><span style="color:#000000;">下</span><span style="color:#000000;">图所示的【分组】对话框的【构成分组的字段】表中，设置【分组字段】为“客户</span><span style="color:#000000;">ID</span><span style="color:#000000;">”“客户手机号码”，即按照“客户</span><span style="color:#000000;">ID</span><span style="color:#000000;">”“客户手机号码”统计客户订单；在【聚合】表中，设置的参数如图所示。</span> </p> 
<p><img alt="" height="905" src="https://images2.imgbox.com/d1/4a/DDtYh49L_o.png" width="845"></p> 
<p><span style="color:#000000;">（6</span><span style="color:#000000;">）</span><span style="color:#000000;">根据客户订单消费金额进行排序。在【排序记录</span><span style="color:#000000;">(</span><span style="color:#000000;">按客户销售金额排序</span><span style="color:#000000;">)</span><span style="color:#000000;">】组件中，设置客户消费金额字段按降序进行排序。</span></p> 
<p><img alt="" height="468" src="https://images2.imgbox.com/47/9f/kw8DfFHP_o.png" width="989"> <span style="color:#000000;">（7</span><span style="color:#000000;">）</span><span style="color:#000000;">将经过排序的各客户订单数据输出并装载至</span><span style="color:#000000;">Excel</span><span style="color:#000000;">文件中。在【</span><span style="color:#000000;">Excel</span><span style="color:#000000;">输出</span><span style="color:#000000;">(</span><span style="color:#000000;">客户订单</span><span style="color:#000000;">)</span><span style="color:#000000;">】组件中，设置参数，输出的</span><span style="color:#000000;">Excel</span><span style="color:#000000;">文件名为“无人售货机分组聚合客户订单</span><span style="color:#000000;">.</span><span style="color:#000000;">xls</span><span style="color:#000000;">”，输出的字段参数设置如表所示。</span></p> 
<p><img alt="" height="880" src="https://images2.imgbox.com/b3/1e/Lx1wC61U_o.png" width="706"></p> 
<p><strong><span style="color:#000000;">运行</span></strong></p> 
<p><img alt="" height="1052" src="https://images2.imgbox.com/a1/4b/TzUqJ8rq_o.png" width="885"></p> 
<p> </p> 
<p><strong>计算各个商品的消费金额</strong></p> 
<p><span style="color:#000000;">无人售货机客户订单的详情数据，记录着订单中的每种商品销售的数量、价格等数据。</span></p> 
<p style="margin-left:0in;text-align:left;"><span style="color:#000000;">从商品销售的角度出发，分析商品的销售数据，计算各种商品的销售金额，以便了解商品的销售情况，分析哪些商品属于热销或滞销商品，为商品的销售提供更好的运营决策。</span></p> 
<p style="margin-left:0in;text-align:left;">创建转换</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="573" src="https://images2.imgbox.com/b3/40/I2wjbeZE_o.png" width="709"></p> 
<p><span style="color:#000000;">（1</span><span style="color:#000000;">） 创建</span><span style="color:#000000;">CSV</span><span style="color:#000000;">文件输入组件和获取数据。创建</span><span style="color:#000000;">CSV</span><span style="color:#000000;">文件输入组件，组件命名为</span><span style="color:#000000;">【CSV</span><span style="color:#000000;">文件输入</span><span style="color:#000000;">(</span><span style="color:#000000;">订单</span><span style="color:#000000;">)】</span><span style="color:#000000;">，如图所示。设置组件参数，导入“</span><span style="color:#000000;">order_details.csv”</span><span style="color:#000000;">文件，并设置好字段参数，订单生成时间</span><span style="color:#000000;">createdtime</span><span style="color:#000000;">字段的字段类型需要设置为</span><span style="color:#000000;">String</span><span style="color:#000000;">。</span> </p> 
<p><img alt="" height="723" src="https://images2.imgbox.com/24/0b/hDPKgFgo_o.png" width="997"></p> 
<p><img alt="" height="931" src="https://images2.imgbox.com/1c/ee/uXUl49jC_o.png" width="1200"></p> 
<p><span style="color:#000000;">（</span><span style="color:#000000;">2</span><span style="color:#000000;">）</span><span style="color:#000000;">过滤掉售货机</span><span style="color:#000000;">ID</span><span style="color:#000000;">为空和支付失败的订单。在【过滤记录</span><span style="color:#000000;">(</span><span style="color:#000000;">售货机</span><span style="color:#000000;">ID</span><span style="color:#000000;">非空和支付成功</span><span style="color:#000000;">)</span><span style="color:#000000;">】组件中，设置参数，保留售货机</span><span style="color:#000000;">ID</span><span style="color:#000000;">非空和支付成功的订单，过滤掉售货机</span><span style="color:#000000;">ID</span><span style="color:#000000;">为空和支付不成功的订单.</span></p> 
<p><img alt="" height="453" src="https://images2.imgbox.com/3c/66/GO1hWlLo_o.png" width="1200"> <span style="color:#000000;">（</span><span style="color:#000000;">3）进行字段选择，保留需要的字段，去除多余的字段。在【字段选择】组件中，设置参数，仅保留</span><span style="color:#000000;">productname</span><span style="color:#000000;">、</span><span style="color:#000000;">amount</span><span style="color:#000000;">、</span><span style="color:#000000;">productpaytotalprice</span><span style="color:#000000;">等字段，并分别改名为“商品名称”“</span><span style="color:#000000;">product_number</span><span style="color:#000000;">”“</span><span style="color:#000000;">product_paytotalprice</span><span style="color:#000000;">”，如图所示，丢弃其他与计算各商品销售金额无关的字段。</span></p> 
<p><img alt="" height="620" src="https://images2.imgbox.com/da/56/h7E213SL_o.png" width="1200"></p> 
<p> <span style="color:#000000;">（4</span><span style="color:#000000;">）</span><span style="color:#000000;">对商品名称进行排序。因为需要计算各商品的销售金额，所以必须对商品名称进行排序，在【排序记录】组件中，对商品名称字段按照升序进行排序。</span></p> 
<p><img alt="" height="466" src="https://images2.imgbox.com/cb/89/sEOlPjZq_o.png" width="983"></p> 
<p><span style="color:#000000;">（5</span><span style="color:#000000;">）</span><span style="color:#000000;">对购买商品数量和商品实际支付总金额等字段进行聚合计算，统计各个商品的销售金额。在【分组</span><span style="color:#000000;">(</span><span style="color:#000000;">按商品名称统计</span><span style="color:#000000;">)</span><span style="color:#000000;">】组件中，有关参数设置如图所示。</span> </p> 
<p><img alt="" height="890" src="https://images2.imgbox.com/20/72/adhQizUt_o.png" width="812"></p> 
<p style="margin-left:0in;text-align:left;"><span style="color:#000000;">（6</span><span style="color:#000000;">）</span><span style="color:#000000;">根据商品销售金额进行排序。在【排序记录</span><span style="color:#000000;">(</span><span style="color:#000000;">按销售金额排序</span><span style="color:#000000;">)</span><span style="color:#000000;">】组件中，设置商品销售金额字段按照降序排序。</span></p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="467" src="https://images2.imgbox.com/60/87/TIvgYbns_o.png" width="1004"></p> 
<p style="margin-left:0in;text-align:left;"><span style="color:#000000;">（7</span><span style="color:#000000;">）</span><span style="color:#000000;">将经过排序的各商品销售金额数据输出并装载至</span><span style="color:#000000;">Excel</span><span style="color:#000000;">文件中。在【</span><span style="color:#000000;">Excel</span><span style="color:#000000;">输出</span><span style="color:#000000;">(</span><span style="color:#000000;">各商品销售金额</span><span style="color:#000000;">)</span><span style="color:#000000;">】组件中，设置参数，输出的</span><span style="color:#000000;">Excel</span><span style="color:#000000;">文件名为“无人售货机各商品销售金额</span><span style="color:#000000;">.</span><span style="color:#000000;">xls</span><span style="color:#000000;">”，输出的字段参数如表所示。</span></p> 
<p> <img alt="" height="867" src="https://images2.imgbox.com/a8/98/h48Iii2m_o.png" width="663"></p> 
<p><strong>运行 </strong></p> 
<p><img alt="" height="1152" src="https://images2.imgbox.com/7b/af/fDr8oOUv_o.png" width="1001"></p> 
<p><span style="color:#FFFFFF;">品销售金额商品销售金</span></p> 
<p><span style="color:#FFFFFF;">计算各商品销售金额</span></p> 
<p> <span style="color:#FFFFFF;">计算各商品销额</span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bffe64cff0f923696813ed3c9a932268/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">常用巡检命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5afd4d6492ea5d743c9ea12523ce584f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何生成流程引擎activiti数据库表</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>