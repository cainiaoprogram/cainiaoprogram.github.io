<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>安信安睿终端V7.11自动下载日线与1分钟5分钟K线脚本 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="安信安睿终端V7.11自动下载日线与1分钟5分钟K线脚本" />
<meta property="og:description" content="下载安装autoit脚本中替换通达信路径 ，运行命 &#34;C:\Program Files (x86)\AutoIt3\autoit3.exe&#34; /ErrorStdOut &#34;D:\run_tdx.au3&#34; ，可以用schedule程序自动调用。淘宝上通达信脚本居然卖近300块，真无耻，这绝本不难写，不过我这两三天都一点时间抽出时间调试，今晚终于成功。家中电脑win10上成功，办公室win7弹出窗口后还需随便点一下才行。
;#RequireAdmin,这会导致阻塞模式没了
; 在云服务器上运行时，远程桌面关闭会导致autoit3的鼠标和键盘操作失效，请改用RealVNC
#Include &lt;GuiTab.au3&gt;
#include &lt;GuiButton.au3&gt;
Func RunMain()
; 请配置通达信软件的主程序
Local $iPID = Run(&#34;D:\axzq_v6\TdxW.exe&#34;, &#34;&#34;)
; 请配置通达信软件的标题
Local $title = &#34;[TITLE:安信安睿终端V7.11; CLASS:#32770]&#34;
WinActivate($title)
Local $hLoginWnd = WinWaitActive($title)
; 开始下载数据
Sleep(500)
ControlClick($hLoginWnd, &#34;&#34;, &#34;[CLASS:AfxWnd42; INSTANCE:12]&#34;)
EndFunc
Func PopDownloadDlg()
; 找到主窗口，并弹出下载对话框
Local $title = &#34;[CLASS:TdxW_MainFrame_Class]&#34;
WinActivate($title)
Local $hMainWnd = WinWaitActive($title)
SendKeepActive($hMainWnd)
WinMove($hMainWnd, &#34;&#34;, 0, 0, 300, 600)
;在本地居然不能用，不然会出错
;Sleep(2000)
;WinClose(&#34;[TITLE:即时播报; CLASS:#32770]&#34;)
; 点击到盘后数据下载" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ddf29dae1edc5e1abfa3f2d8c8bbc618/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-04-18T22:58:07+08:00" />
<meta property="article:modified_time" content="2018-04-18T22:58:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">安信安睿终端V7.11自动下载日线与1分钟5分钟K线脚本</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>下载安装autoit脚本中替换通达信路径 ，运行命  <span style="color:#032f62;">"C:\Program Files (x86)\AutoIt3\autoit3.exe"</span><span style="color:#24292e;"> /ErrorStdOut </span><span style="color:#032f62;">"<span style="color:#005cc5;">D:</span>\run_tdx.au3"</span><span style="color:#24292e;"> ，可以用schedule程序自动调用。淘宝上通达信脚本居然卖近300块，真无耻</span><span style="color:#24292e;">，这绝本不难写，不过我这两三天都一点时间抽出时间调试，今晚终于成功。家中电脑win10上成功，办公室win7弹出窗口后还需随便点一下才行。</span></p> 
<p>;#RequireAdmin,这会导致阻塞模式没了</p> 
<p>; 在云服务器上运行时，远程桌面关闭会导致autoit3的鼠标和键盘操作失效，请改用RealVNC<br> #Include &lt;GuiTab.au3&gt;<br> #include &lt;GuiButton.au3&gt;<br><br><br> Func RunMain()<br>    ; 请配置通达信软件的主程序<br>    Local $iPID = Run("D:\axzq_v6\TdxW.exe", "")<br>    ; 请配置通达信软件的标题<br>    Local $title = "[TITLE:安信安睿终端V7.11; CLASS:#32770]"<br>    WinActivate($title)<br>    Local $hLoginWnd = WinWaitActive($title)<br><br><br>    ; 开始下载数据<br>    Sleep(500)<br>    ControlClick($hLoginWnd, "", "[CLASS:AfxWnd42; INSTANCE:12]")<br> EndFunc<br><br><br> Func PopDownloadDlg()<br>    ; 找到主窗口，并弹出下载对话框<br>    Local $title = "[CLASS:TdxW_MainFrame_Class]"<br>    WinActivate($title)<br>    Local $hMainWnd = WinWaitActive($title)<br>    SendKeepActive($hMainWnd)<br>    WinMove($hMainWnd, "", 0, 0, 300, 600)<br><br><br>    ;在本地居然不能用，不然会出错<br>    ;Sleep(2000)<br>    ;WinClose("[TITLE:即时播报; CLASS:#32770]")<br><br><br>    ; 点击到盘后数据下载<br>    ; 如果使用Mouse without Borders这个软件进行多台电脑会出错<br>    ControlClick($hMainWnd, "", 3000)<br>    ControlClick($hMainWnd, "", "[CLASS:AfxWnd42; INSTANCE:7]")<br>    Send('{DOWN 11}{ENTER}')<br> EndFunc<br><br><br> Func SetCheckDownloadDlg()<br>    ; 点击进行下载<br>    Local $title = "[TITLE:盘后数据下载; CLASS:#32770]"<br>    WinActivate($title)<br>    Local $hDlgWnd = WinWaitActive($title)<br><br><br><br><br>    ; 将第一页的日线数据选上<br>    Sleep(500)<br>    Local $idRdo1 = ControlGetHandle($hDlgWnd,"","[TEXT:日线和实时行情数据]")<br>    Local $idRdo2 = ControlGetHandle($hDlgWnd,"","[TEXT:5分钟线数据]")<br>    Local $idRdo3 = ControlGetHandle($hDlgWnd,"","[TEXT:1分钟线数据]")<br>    _GUICtrlButton_SetCheck($idRdo1)<br>    ; 将第二页的5分钟数据选上</p> 
<p>   _GUICtrlButton_SetCheck($idRdo2)</p> 
<p>   ; 将第二页的1分钟数据选上</p> 
<p>   _GUICtrlButton_SetCheck($idRdo3)<br><br>    ; 激活各页，需要设置的时间进行切换<br>    Local $idTab = ControlGetHandle($hDlgWnd,"","[CLASS:SysTabControl32; INSTANCE:1]")<br>    _GUICtrlTab_SetCurFocus($idTab, 1)<br>    _GUICtrlTab_SetCurFocus($idTab, 0)<br>    _GUICtrlTab_SetCurFocus($idTab, 1)<br> EndFunc<br><br><br> Func ClickDownloadDlg()<br>    Local $title = "[TITLE:盘后数据下载; CLASS:#32770]"<br>    WinActivate($title)<br>    Local $hDlgWnd = WinWaitActive($title)<br><br><br>    ; 开始下载数据<br>    Sleep(500)<br>    ControlClick($hDlgWnd, "", "[TEXT:开始下载]")<br> EndFunc<br><br><br><br><br> Func WaitDownloadDlg()<br>    ; 开始下载数据<br>    Sleep(500)<br>    Local $title = "[TITLE:盘后数据下载; CLASS:#32770]"<br>    WinActivate($title)<br>    Local $hDlgWnd = WinWaitActive($title)<br><br><br>    Local $idtext = ''<br>    Do<br>   Sleep(2000)<br>   $idtext = ControlGetText($hDlgWnd,"","[CLASS:Static; INSTANCE:2]")<br>    Until '下载完毕.' = $idtext<br>    ;Until '下载被取消.' = $idtext<br>    ; 找到下载完毕.<br>   <br> EndFunc<br><br><br> Func ExitMain()<br>    ; 需要退出下载对话框，否则程序没有完全退出<br>    Local $title = "[TITLE:盘后数据下载; CLASS:#32770]"<br>    WinActivate($title)<br>    Local $hDlgWnd = WinWaitActive($title)</p> 
<p>   WinClose($hDlgWnd)</p> 
<p>  ControlClick($hDlgWnd, "", "[TEXT:关闭]")</p> 
<p>   Sleep(500)<br><br><br>    ; 关闭主窗口<br>    Local $title = "[CLASS:TdxW_MainFrame_Class]"<br>    WinActivate($title)<br>    Local $hMainWnd = WinWaitActive($title)<br>    WinClose($hMainWnd)<br><br><br>    ; 确认退出<br>    Local $hMainWnd = WinWaitActive("[TITLE:退出确认; CLASS:#32770]")<br>    ControlClick($hMainWnd, "", "[TEXT:退出]")<br> EndFunc<br><br><br><br><br> RunMain()<br> PopDownloadDlg()<br> SetCheckDownloadDlg()<br> ClickDownloadDlg()<br> WaitDownloadDlg()<br> ExitMain()<br><br><br> Exit(1)</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8c6adc2d36abaa0c3d95a6315fc550cf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">图像拐点检测-原理以及代码实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6d9415b6dbae0fb26f84c8c3beabe336/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python count（）函数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>