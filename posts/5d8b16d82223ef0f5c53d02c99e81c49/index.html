<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>嵌入式大赛初探之-（1）CH32V307介绍 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="嵌入式大赛初探之-（1）CH32V307介绍" />
<meta property="og:description" content="作为记录贴，记录下本次参加嵌入式大赛的经过，关于RISC-V架构与沁恒系列芯片，新的知识，从最基础学起。 一、沁恒微电子及赤菟开发板 本次嵌入式大赛我选择的是沁恒赛道，利用赤菟CH32V307开发板完成项目。 产品特点
青稞V4F处理器，最高144MHz系统主频
支持单周期乘法和硬件除法，支持硬件浮点运算(FPU)
64KB SRAM，256KB Flash
供电电压：2.5/3.3V，GPIO单元独立供电
多种低功耗模式：睡眠、停止、待机
上/下电复位、可编程电压检测器
2组18路通用DMA
4组运放比较器
1个随机数发生器TRNG
2组12位DAC转换
2单元16通道12位ADC转换，16路触摸按键TouchKey
10组定时器
USB2.0全速OTG接口
USB2.0高速主机/设备接口（480Mbps 内置PHY）
3个USART接口和5个UART接口
2个CAN接口（2.0B主动）
SDIO接口、FSMC接口、DVP数字图像接口
2组IIC接口、3组SPI接口、2组IIS接口
千兆以太网控制器ETH（内置10M PHY）
80个I/O口，可以映射到16外部中断
CRC计算单元，96位芯片唯一ID
串行2线调试接口
封装形式：LQFP64M、LQFP100
性能分析
赤菟CH32V307是沁恒开发的一款基于32位RISC-V指令集的互联型微控制器，外设丰富，用途广泛。可以看到，青稞处理器最高支持144MHz主频，性能对标STM32F4系列，同时比STM系列更加有性价比。
赤菟CH32V307采用沁恒微电子自研的RISC-V青稞内核。赤菟是三国中的一匹战马，像老虎一样凶猛的神驹。兔取菟字意思，解释为老虎，乃是马中的皇者，渡水登山，辅佐英雄；青稞这种植物极其耐寒、适应性广，生命力旺盛，是战马的饲料。
不同于CH32V103系列开发板（几乎是裸板，各类引脚外设需要自行外接设备及定义），赤菟开发板加入丰富的板载外设，可以应用于人机交互，无线传输，工业控制，AIoT等领域。这颗芯片及这块开发板，能带给用户战马般的速度和力量，提升开发体验，作为通用MCU，赋能社区和开发者。
图片：
二、编译环境介绍：MounRiver Studio MRS既可以编译ARM架构，也可以编译RISC-V架构，其内部集成了多种型号芯片的示例代码，因此不需要像keil一样完成复杂的初始化各类文件，直接按照教程即可建立工程。
（1）首先下载安装开发环境-MRS
进入官网下载页面(http://mounriver.com/download)） 下载，具体安装过程省略。注意可以将语言设置为中文。
（2）建立第一个工程
①点击 创建MounRiver Studio
②选择工程所用芯片 CH32V307
③选择 CH32V307VCT6
④编辑工程名
⑤选择工程存放路径
⑥点击 完成
三、MounRiver Studio实例项目分析 #include &#34;debug.h&#34;//包含ch32库文件 接下来是最简单的点灯程序，首先初始化GPIO，如下图，格式类似于STM32标准库，初始化引脚PA0，输出模式为上拉输出。
void GPIO_Toggle_INIT(void) { GPIO_InitTypeDef GPIO_InitStructure = {0}; RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA, ENABLE); GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0; GPIO_InitStructure." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/5d8b16d82223ef0f5c53d02c99e81c49/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-11T20:34:03+08:00" />
<meta property="article:modified_time" content="2023-04-11T20:34:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">嵌入式大赛初探之-（1）CH32V307介绍</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code>   作为记录贴，记录下本次参加嵌入式大赛的经过，关于RISC-V架构与沁恒系列芯片，新的知识，从最基础学起。
</code></pre> 
<h2><a id="_1"></a>一、沁恒微电子及赤菟开发板</h2> 
<pre><code>本次嵌入式大赛我选择的是沁恒赛道，利用赤菟CH32V307开发板完成项目。
</code></pre> 
<p><strong>产品特点</strong></p> 
<blockquote> 
 <p>青稞V4F处理器，最高144MHz系统主频<br> 支持单周期乘法和硬件除法，支持硬件浮点运算(FPU)<br> 64KB SRAM，256KB Flash<br> 供电电压：2.5/3.3V，GPIO单元独立供电<br> 多种低功耗模式：睡眠、停止、待机<br> 上/下电复位、可编程电压检测器<br> 2组18路通用DMA<br> 4组运放比较器<br> 1个随机数发生器TRNG<br> 2组12位DAC转换<br> 2单元16通道12位ADC转换，16路触摸按键TouchKey<br> 10组定时器<br> USB2.0全速OTG接口<br> USB2.0高速主机/设备接口（480Mbps 内置PHY）<br> 3个USART接口和5个UART接口<br> 2个CAN接口（2.0B主动）<br> SDIO接口、FSMC接口、DVP数字图像接口<br> 2组IIC接口、3组SPI接口、2组IIS接口<br> 千兆以太网控制器ETH（内置10M PHY）<br> 80个I/O口，可以映射到16外部中断<br> CRC计算单元，96位芯片唯一ID<br> 串行2线调试接口<br> 封装形式：LQFP64M、LQFP100</p> 
</blockquote> 
<p><strong>性能分析</strong><br> 赤菟CH32V307是沁恒开发的一款基于32位RISC-V指令集的互联型微控制器，外设丰富，用途广泛。可以看到，青稞处理器最高支持144MHz主频，性能对标STM32F4系列，同时比STM系列更加有性价比。<br> 赤菟CH32V307采用沁恒微电子自研的RISC-V青稞内核。赤菟是三国中的一匹战马，像老虎一样凶猛的神驹。兔取菟字意思，解释为老虎，乃是马中的皇者，渡水登山，辅佐英雄；青稞这种植物极其耐寒、适应性广，生命力旺盛，是战马的饲料。<br> 不同于CH32V103系列开发板（几乎是裸板，各类引脚外设需要自行外接设备及定义），<strong>赤菟开发板加入丰富的板载外设，可以应用于人机交互，无线传输，工业控制，AIoT等领域</strong>。这颗芯片及这块开发板，能带给用户战马般的速度和力量，提升开发体验，作为通用MCU，赋能社区和开发者。<br> 图片：<img src="https://images2.imgbox.com/c9/e9/K4FEOLbC_o.png" alt="赤菟开发板"><br> <img src="https://images2.imgbox.com/9b/9e/OAAgEFfH_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="MounRiver_Studio_34"></a>二、编译环境介绍：MounRiver Studio</h3> 
<p>MRS既可以编译ARM架构，也可以编译RISC-V架构，<strong>其内部集成了多种型号芯片的示例代码</strong>，因此不需要像keil一样完成复杂的初始化各类文件，直接按照教程即可建立工程。<br> （1）首先下载安装开发环境-MRS<br> 进入官网下载页面(http://mounriver.com/download)） 下载，具体安装过程省略。注意可以将语言设置为中文。<br> （2）建立第一个工程<br> ①点击 创建MounRiver Studio<br> <img src="https://images2.imgbox.com/0e/31/0vH54wCi_o.png" alt="在这里插入图片描述"><br> ②选择工程所用芯片 CH32V307<br> ③选择 CH32V307VCT6<br> ④编辑工程名<br> ⑤选择工程存放路径<br> ⑥点击 完成</p> 
<h3><a id="MounRiver_Studio_46"></a>三、MounRiver Studio实例项目分析</h3> 
<pre><code class="prism language-javascript">#include <span class="token string">"debug.h"</span><span class="token comment">//包含ch32库文件</span>
</code></pre> 
<p>接下来是最简单的点灯程序，首先初始化GPIO，如下图，格式类似于STM32标准库，初始化引脚PA0，输出模式为上拉输出。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">void</span> <span class="token function">GPIO_Toggle_INIT</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">void</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    GPIO_InitTypeDef GPIO_InitStructure <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">RCC_APB2PeriphClockCmd</span><span class="token punctuation">(</span>RCC_APB2Periph_GPIOA<span class="token punctuation">,</span> <span class="token constant">ENABLE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    GPIO_InitStructure<span class="token punctuation">.</span>GPIO_Pin <span class="token operator">=</span> GPIO_Pin_0<span class="token punctuation">;</span>
    GPIO_InitStructure<span class="token punctuation">.</span>GPIO_Mode <span class="token operator">=</span> GPIO_Mode_Out_PP<span class="token punctuation">;</span>
    GPIO_InitStructure<span class="token punctuation">.</span>GPIO_Speed <span class="token operator">=</span> GPIO_Speed_50MHz<span class="token punctuation">;</span>
    <span class="token function">GPIO_Init</span><span class="token punctuation">(</span><span class="token constant">GPIOA</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>GPIO_InitStructure<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>主函数主要是对中断、系统时钟、延时、串口、GPIO初始化。<br> SystemCoreClockUpdate()：更新SystemCoreClock的值，与系统频率一致。<br> while循环里，执行的是对PA0的LED间断闪烁的功能，一开始是低电平，然后是高电平，这样循环往复。</p> 
<pre><code class="prism language-javascript">int <span class="token function">main</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">void</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    u8 i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token function">NVIC_PriorityGroupConfig</span><span class="token punctuation">(</span>NVIC_PriorityGroup_2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">SystemCoreClockUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">Delay_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">USART_Printf_Init</span><span class="token punctuation">(</span><span class="token number">115200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"SystemClk:%d\r\n"</span><span class="token punctuation">,</span> SystemCoreClock<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span> <span class="token string">"ChipID:%08x\r\n"</span><span class="token punctuation">,</span> <span class="token function">DBGMCU_GetCHIPID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"GPIO Toggle TEST\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">GPIO_Toggle_INIT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">Delay_Ms</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">GPIO_WriteBit</span><span class="token punctuation">(</span><span class="token constant">GPIOA</span><span class="token punctuation">,</span> GPIO_Pin_0<span class="token punctuation">,</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> Bit_SET<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> Bit_RESET<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="MounRiver_Studio_88"></a>四、MounRiver Studio其他说明</h3> 
<p>（1）WCH LINK烧录下载功能<br> 由于赤菟开发板板载WCH一键下载功能，因此当使用编译成功后，左侧管理器栏目会在obj目录生成.hex文件。<br> <img src="https://images2.imgbox.com/61/ea/obWZnu3T_o.png" alt="在这里插入图片描述"><br> 右键hex文件，进入下载配置，在下载配置菜单下，可以配置下载的芯片型号、编程地址、目标文件,还可以对芯片的读保护进行加密和解密操作。对于下载的过程可以选择全片擦除、校验、复位(复位勾选即表示在下载完成后芯片会自动复位)。<br> <img src="https://images2.imgbox.com/1b/c9/g7lgrksr_o.png" alt="在这里插入图片描述"><br> （2）关于Debug功能，后期将补充。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/92126ea5811d359ceb725bc815671bf9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">matlab进行傅里叶分析</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4eb718489395eae866af0257544800d1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue中添加在标签上增加动态属性</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>