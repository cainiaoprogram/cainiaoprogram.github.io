<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Activiti入门创建25张表 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Activiti入门创建25张表" />
<meta property="og:description" content="Activiti支持的数据库 Activiti的运行需要数据库支撑，需要安装activiti数据库，支持如下版本：
创建Maven工程，目录结构如下
创建 mysql 数据库 本教程使用mysql数据库。
创建 mysql数据库 activiti（名字任意）：
CREATE DATABASE activiti DEFAULT CHARACTER SET utf8; 创建表方式 通过运行 java程序创建表。
创建 java 工程 使用 eclipse 或 idea 创建 maven 的 java 工程。
加入 maven 依赖的坐标（jar 包） 首先需要在 java 工程中加入ProcessEngine 所需要的 jar包，
包括：
activiti-engine-7.0.0.beta1.jaractiviti依赖的 jar 包：mybatis、alf4j、log4j 等activiti依赖的 spring包数据库驱动第三方数据连接池 dbcp单元测试 Junit-4.12.jar 我们使用 maven 来实现项目的构建，所以应当导入这些 jar所对应的坐标到pom.xml文件中。 &lt;properties&gt; &lt;slf4j.version&gt;1.6.6&lt;/slf4j.version&gt; &lt;log4j.version&gt;1.2.12&lt;/log4j.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.activiti&lt;/groupId&gt; &lt;artifactId&gt;activiti-engine&lt;/artifactId&gt; &lt;version&gt;7.0.0.Beta1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.activiti&lt;/groupId&gt; &lt;artifactId&gt;activiti-spring&lt;/artifactId&gt; &lt;version&gt;7.0.0.Beta1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a93d1d9ee36ada0beb215271d0743462/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-02-19T20:20:16+08:00" />
<meta property="article:modified_time" content="2019-02-19T20:20:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Activiti入门创建25张表</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Activiti_0"></a>Activiti支持的数据库</h2> 
<p>Activiti的运行需要数据库支撑，需要安装activiti数据库，支持如下版本：<br> <img src="https://images2.imgbox.com/a0/ca/kWjWgVbR_o.png" alt="在这里插入图片描述"><br> 创建Maven工程，目录结构如下<br> <img src="https://images2.imgbox.com/6b/e2/4ueoxrG9_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_mysql__5"></a>创建 mysql 数据库</h2> 
<p>本教程使用mysql数据库。</p> 
<p>创建 mysql数据库 activiti（名字任意）：</p> 
<pre><code>CREATE DATABASE activiti  DEFAULT CHARACTER SET utf8; 
</code></pre> 
<h2><a id="_14"></a>创建表方式</h2> 
<p>通过运行 java程序创建表。</p> 
<h3><a id="_java__16"></a>创建 java 工程</h3> 
<p>使用 eclipse 或 idea 创建 maven 的 java 工程。</p> 
<h3><a id="_maven_jar__18"></a>加入 maven 依赖的坐标（jar 包）</h3> 
<p>首先需要在 java 工程中加入ProcessEngine 所需要的 jar包，<br> 包括：</p> 
<ol><li>activiti-engine-7.0.0.beta1.jar</li><li>activiti依赖的 jar 包：mybatis、alf4j、log4j 等</li><li>activiti依赖的 spring包</li><li>数据库驱动</li><li>第三方数据连接池 dbcp</li><li>单元测试 Junit-4.12.jar 我们使用 maven 来实现项目的构建，所以应当导入这些 jar所对应的坐标到pom.xml文件中。</li></ol> 
<pre><code class="prism language-s">&lt;properties&gt;
        &lt;slf4j.version&gt;1.6.6&lt;/slf4j.version&gt;
        &lt;log4j.version&gt;1.2.12&lt;/log4j.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.activiti&lt;/groupId&gt;
            &lt;artifactId&gt;activiti-engine&lt;/artifactId&gt;
            &lt;version&gt;7.0.0.Beta1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.activiti&lt;/groupId&gt;
            &lt;artifactId&gt;activiti-spring&lt;/artifactId&gt;
            &lt;version&gt;7.0.0.Beta1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.activiti&lt;/groupId&gt;
            &lt;artifactId&gt;activiti-bpmn-model&lt;/artifactId&gt;
            &lt;version&gt;7.0.0.Beta1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.activiti&lt;/groupId&gt;
            &lt;artifactId&gt;activiti-bpmn-converter&lt;/artifactId&gt;
            &lt;version&gt;7.0.0.Beta1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.activiti&lt;/groupId&gt;
            &lt;artifactId&gt;activiti-json-converter&lt;/artifactId&gt;
            &lt;version&gt;7.0.0.Beta1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.activiti&lt;/groupId&gt;
            &lt;artifactId&gt;activiti-bpmn-layout&lt;/artifactId&gt;
            &lt;version&gt;7.0.0.Beta1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.activiti.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;activiti-cloud-services-api&lt;/artifactId&gt;
            &lt;version&gt;7.0.0.Beta1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
            &lt;version&gt;5.1.40&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- log start --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j&lt;/artifactId&gt;
            &lt;version&gt;${log4j.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
            &lt;version&gt;${slf4j.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
            &lt;version&gt;${slf4j.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!-- log end --&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
            &lt;version&gt;3.4.5&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;commons-dbcp&lt;/groupId&gt;
            &lt;artifactId&gt;commons-dbcp&lt;/artifactId&gt;
            &lt;version&gt;1.4&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!--文件读写操作--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;commons-io&lt;/groupId&gt;
            &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
            &lt;version&gt;2.0&lt;/version&gt;
        &lt;/dependency&gt;


    &lt;/dependencies&gt;
</code></pre> 
<h2><a id="log4jproperties_129"></a>log4j.properties</h2> 
<pre><code class="prism language-s"># Set root category priority to INFO and its only appender to CONSOLE.
#log4j.rootCategory=INFO, CONSOLE            debug   info   warn error fatal
log4j.rootCategory=debug, CONSOLE, LOGFILE

# Set the enterprise logger category to FATAL and its only appender to CONSOLE.
log4j.logger.org.apache.axis.enterprise=FATAL, CONSOLE

# CONSOLE is set to be a ConsoleAppender using a PatternLayout.
log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender
log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout
log4j.appender.CONSOLE.layout.ConversionPattern=%d{ISO8601} %-6r [%15.15t] %-5p %30.30c %x - %m\n

# LOGFILE is set to be a File appender using a PatternLayout.
log4j.appender.LOGFILE=org.apache.log4j.FileAppender
log4j.appender.LOGFILE.File=d:\axis.log
log4j.appender.LOGFILE.Append=true
log4j.appender.LOGFILE.layout=org.apache.log4j.PatternLayout
log4j.appender.LOGFILE.layout.ConversionPattern=%d{ISO8601} %-6r [%15.15t] %-5p %30.30c %x - %m\n


</code></pre> 
<h2><a id="activiticfgxml_153"></a>activiti.cfg.xml</h2> 
<p>在 classpath 下创建 activiti.cgf.xml文件:<br> 注：数据库修改为自己的用户名和密码</p> 
<pre><code class="prism language-s">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                        http://www.springframework.org/schema/beans/spring-beans.xsd
						http://www.springframework.org/schema/contex http://www.springframework.org/schema/context/spring-context.xsd
						http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd"&gt;

    &lt;!--配置数据源，dbcp--&gt;
    &lt;bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource"&gt;
        &lt;property name="driverClassName" value="com.mysql.jdbc.Driver" /&gt;
        &lt;property name="url" value="jdbc:mysql://localhost:3306/activiti" /&gt;
        &lt;property name="username" value="root" /&gt;
        &lt;property name="password" value="root" /&gt;
        &lt;property name="maxActive" value="3" /&gt;
        &lt;property name="maxIdle" value="1" /&gt;
    &lt;/bean&gt;

    &lt;!--activiti单独运行的processEngine配置，获取processEngineConfiguration对象--&gt;
    &lt;bean id="processEngineConfiguration" class="org.activiti.engine.impl.cfg.StandaloneProcessEngineConfiguration"&gt;
        &lt;property name="dataSource" ref="dataSource"&gt;&lt;/property&gt;
        &lt;property name="databaseSchemaUpdate" value="true"/&gt;
    &lt;/bean&gt;

	&lt;!--配置数据源的另一种方式--&gt;
    &lt;!--&lt;bean id="processEngineConfiguration" class="org.activiti.engine.impl.cfg.StandaloneProcessEngineConfiguration"&gt;
        &lt;property name="jdbcDriver" value="com.mysql.jdbc.Driver"/&gt;
        &lt;property name="jdbcUrl" value="jdbc:mysql://localhost:3306/itcast0711activiti"/&gt;
        &lt;property name="jdbcUsername" value="root"/&gt;
        &lt;property name="jdbcPassword" value="root"/&gt;
        &lt;property name="databaseSchemaUpdate" value="true"/&gt;
    &lt;/bean&gt;--&gt;
&lt;/beans&gt;
</code></pre> 
<p>关于 processEngineConfiguration 中的 databaseSchemaUpdate 参数，通过此参数设计 activiti 数据表的处理策略，参数如下：</p> 
<p>false（默认）：检查数据库表的版本和依赖库的版本， 如果版本不匹配就抛出异常。 true: 构建流程引擎时，执行检查，如果需要就执行更新。 如果表不存在，就创建。 create-drop: 构建流程引擎时创建数据库表， 关闭流程引擎时删除这些表。 drop-create：先删除表再创建表。 create: 构建流程引擎时创建数据库表， 关闭流程引擎时不删除这些表。</p> 
<h3><a id="_activiticfgxml__dataSource__processEngineConfiguration___197"></a>注意：在 activiti.cfg.xml 配置文件中的 dataSource 和 processEngineConfiguration 也可以使用一次 性配置出来。</h3> 
<pre><code class="prism language-s">&lt;!--配置数据源的另一种方式,随自己喜好--&gt;
    &lt;bean id="processEngineConfiguration" class="org.activiti.engine.impl.cfg.StandaloneProcessEngineConfiguration"&gt;
        &lt;property name="jdbcDriver" value="com.mysql.jdbc.Driver"/&gt;
        &lt;property name="jdbcUrl" value="jdbc:mysql://localhost:3306/activiti"/&gt;
        &lt;property name="jdbcUsername" value="root"/&gt;
        &lt;property name="jdbcPassword" value="root"/&gt;
        &lt;property name="databaseSchemaUpdate" value="true"/&gt;
    &lt;/bean&gt;
</code></pre> 
<h2><a id="_209"></a>编写测试程序</h2> 
<p>创建 ProcessEngineConfiguration，通过 ProcessEngineConfiguration 创建 ProcessEngine，在创建 ProcessEngine 时会自动创建数据库</p> 
<pre><code class="prism language-s">package com.test;

import org.activiti.engine.ProcessEngine;
import org.activiti.engine.ProcessEngineConfiguration;

/**
 * 测试类
 * 作用：测试activiti所需的25张表的生成
 */
public class ActivitiTest {
    public static void main(String[] args) {
        //1.创建processEngineConfiguration对象
        ProcessEngineConfiguration configuration = ProcessEngineConfiguration.createProcessEngineConfigurationFromResource("activiti.cfg.xml");
        //2.创建processengine对象；
        ProcessEngine processEngine = configuration.buildProcessEngine();
        System.out.println(processEngine);
        String name = processEngine.getName();
        System.out.println(name);

    }

}

</code></pre> 
<p>查看数据库，创建成功<br> <img src="https://images2.imgbox.com/e1/ce/8qBldaxD_o.png" alt="在这里插入图片描述"><br> 说明：<br> 1、运行以上程序段即可完成 activiti数据库创建，通过改变 activiti.cfg.xml中 databaseSchemaUpdate 参数的值执行不同的数据表处理策略。</p> 
<p>2、上边的方法 createProcessEngineConfigurationFromResource<br> 在执行时在<br> activiti.cfg.xml<br> 中找固定的名称 processEngineConfiguration 也可以使用重载方法调用，这时可以不用限定 processEngineConfiguration名称<br> <img src="https://images2.imgbox.com/ce/33/OHVfIQuy_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="processEngine_249"></a>processEngine的简单创建</h3> 
<p>要求<br> 将 activiti.cfg.xml文件名及路径固定，且 activiti.cfg.xml文件中有 processEngineConfiguration 的配置，必须满足这两个条件才可以使用如下代码创建 processEngine:</p> 
<pre><code class="prism language-s">ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();
        System.out.println(processEngine);
</code></pre> 
<h3><a id="_257"></a>数据库表的命名规则</h3> 
<p>Activiti 的表都以ACT_开头。 第二部分是表示表的用途的两个字母标识。 用途也和服务的 API 对 应。</p> 
<ul><li>ACT_RE_*: 'RE’表示 repository。 这个前缀的表包含了流程定义和流程静态资源 （图片， 规则，等等）。</li><li>ACT_RU_*: 'RU’表示 runtime。 这些运行时的表，包含流程实例，任务，变量，异步任务， 等运行中的数据。 Activiti只在流程实例执行过程中保存这些数据， 在流程结束时就会删 除这些记录。 这样运行时表可以一直很小速度很快。</li><li>ACT_HI_*: 'HI’表示 history。 这些表包含历史数据，比如历史流程实例， 变量，任务等 等。</li><li>ACT_GE_*: GE表示 general。通用数据， 用于不同场景下。</li></ul> 
<h2><a id="Service_265"></a>Service</h2> 
<p>Service 创建方式<br> 通过 ProcessEngine 创建 Service，Service 是工作流引擎提供用于进行工作流部署、执行、管理的服 务接口。 方式如下：</p> 
<pre><code>RuntimeService runtimeService = processEngine.getRuntimeService(); 
RepositoryService repositoryService = processEngine.getRepositoryService(); 
TaskService taskService = processEngine.getTaskService(); 
…… 
</code></pre> 
<p><img src="https://images2.imgbox.com/2b/cf/2e8TyOFd_o.png" alt="在这里插入图片描述"><br> 注：红色标注为常用 service。</p> 
<h3><a id="RepositoryService_277"></a>RepositoryService</h3> 
<p>是 activiti的资源管理类，提供了管理和控制流程发布包和流程定义的操作。使用工作流建模工 具设计的业务流程图需要使用此 service 将流程定义文件的内容部署到计算机。 除了部署流程定义以外还可以： 查询引擎中的发布包和流程定义。 暂停或激活发布包，对应全部和特定流程定义。 暂停意味着它们不能再执行任何操作了，激活 是对应的反向操作。 获得多种资源，像是包含在发布包里的文件， 或引擎自动生成的流程图。 获得流程定义的 pojo 版本， 可以用来通过 java 解析流程，而不必通过 xml。</p> 
<h3><a id="RuntimeService_280"></a>RuntimeService</h3> 
<p>它是 activiti的流程运行管理类。可以从这个服务类中获取很多关于流程执行相关的信息</p> 
<h3><a id="TaskService_282"></a>TaskService</h3> 
<p>是 activiti的任务管理类。可以从这个类中获取任务的信息。</p> 
<h3><a id="HistoryService_285"></a>HistoryService</h3> 
<p>是 activiti 的历史管理类，可以查询历史信息，执行流程时，引擎会保存很多数据（根据配置），比 如流程实例启动时间，任务的参与者， 完成任务的时间，每个流程实例的执行路径，等等。 这个 服务主要通过查询功能来获得这些数据。</p> 
<h3><a id="ManagementService_287"></a>ManagementService</h3> 
<p>是 activiti的引擎管理类，提供了对 Activiti 流程引擎的管理和维护功能，这些功能不在工作流驱动 的应用程序中使用，主要用于 Activiti 系统的日常维护。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8185186ae05151bcd5a196a5509f8555/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">全国失信被执行人名单爬虫</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3a90c5d4d886dc1901248c4e34702d7f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">智慧教育开放知识数据集</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>