<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>VC&#43;&#43;学习-数据库篇（记录集recordset常用操作代码） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="VC&#43;&#43;学习-数据库篇（记录集recordset常用操作代码）" />
<meta property="og:description" content="编程环境：VS2013，MFC
要搞清楚:数据库和ADO的记录集是两个不同的概念, 是存在于不同物理位置的两个存储空间。 记录集相当于是实际数据的一份拷贝。 正因为记录集是相对脱离数据库而存在的, 所以才存在后面将要介绍的Open方法中涉及的光标类型和锁定类型这两个问题。
在ADO程序中，**记录集（Recordset）**对象代表一个表的记录集合或者是一个SQL命令或存储过程执行结果。简单地说：记录集实际上缓存了从数据库获得的记录，应用程序可以从记录集中获得每条记录的字段。
使用记录集的具体方法：
定义_RecordsetPtr型变量，然后通过它调用Recordset对象的Open方法，即可打开一个数据集，然后可以使用GetCollet方法获取记录的字段值，使用Move系列函数实现记录集的遍历，最后关闭记录集。
&lt;pre name=&#34;code&#34; class=&#34;cpp&#34;&gt; _RecordsetPtr智能指针，它是专门为通过记录集操作数据库而设立的指针，通过该接口可以对数据库的表内的记录、字段等进行各种操作。 Recordset对象的常用属性和方法：
**RecordCount属性：**返回Recordset对象中记录的当前数目
**BOF,EOF属性：**BOF指示当前记录位置的第一记录的前一个，EOF指示当前记录的最后一个记录的后一个。如果打开没有记录的Recordset对象，则BOF,EOF都为true，如果打开的记录集中包含记录，则BOF,EOF都为false
**AbsolutePosition属性：**指定Recordset对象当前记录的序号位置
**ActiveConnection属性：**该属性指定Recordset当前所属的Connection对象。
ADO连接ACCESS 打开并连接数据库 _variant_t vUsername,vID,vname; //变量声明 _RecordsetPtr m_pRecordset; //记录集 CString strid; _ConnectionPtr connection; m_pRecordset.CreateInstance(__uuidof( Recordset )); //创建实例 m_pRecordset-&gt;Open(&#34;SELECT * FROM users&#34;,connection.GetInterfacePtr (),adOpenStatic,adLockOptimistic,adCmdText);//执行SQL语句，得到记录集, connection必须已和数据库连接 原型
Open方法的原型是这样的:
HRESULT Recordset15::Open ( const _variant_t &amp; Source, const _variant_t &amp; ActiveConnection, enum CursorTypeEnum CursorType, enum LockTypeEnum LockType, long Options ) ①Source参数：为记录源，是数据查询字符串，它可以是下列内容之一：Command对象变量，SQL语句，存储过程，表名或完整的路径名。
②ActiveConnection：是已经建立好的连接（我们需要用Connection对象指针来构造一个_variant_t对象) ，对应于ActiveConnection属性，指定在哪个连接中打开该记录集，常用_ConnectionPtr.GetInfaceterPtr()指定
③CursorType光标类型：指定打开Recordset时使用的游标，它的取值可以是CursorTypeEnum枚举型中的常量，adOpenStatic（静态游标），adOpenDynamic（动态游标）,adOpenForwardOnly(默认，前向游标)，adOpenKeyset（键集游标）.请看这个枚举结构:
enum CursorTypeEnum { adOpenUnspecified = -1,///不作特别指定 adOpenForwardOnly = 0,///前滚静态光标。这种光标只能向前浏览记录集，比如用MoveNext向前滚动,这 种方式可以提高浏览速度。但诸如BookMark,RecordCount,AbsolutePosition,AbsolutePage都不能使用 adOpenKeyset = 1,///采用这种光标的记录集看不到其它用户的新增、删除操作，但对于更新原有记录的 操作对你是可见的。 adOpenDynamic = 2,///动态光标。所有数据库的操作都会立即在各用户记录集上反应出来。 adOpenStatic = 3///静态光标。它为你的记录集产生一个静态备份，但其它用户的新增、删除、更新操作对你的记录集来说是不可见的。 }; ④LockType：指定打开记录集时应该使用的锁定类型，LockType取值为LockTypeEnum枚举型的值，它可以是以下值之一，请看如下枚举结构：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3a4cb2aa58bd3332a64bf77a83ec7582/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-04-10T23:42:32+08:00" />
<meta property="article:modified_time" content="2019-04-10T23:42:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">VC&#43;&#43;学习-数据库篇（记录集recordset常用操作代码）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>编程环境：VS2013，MFC<br> 要搞清楚:数据库和ADO的记录集是两个不同的概念, 是存在于不同物理位置的两个存储空间。 记录集相当于是实际数据的一份拷贝。 正因为记录集是相对脱离数据库而存在的, 所以才存在后面将要介绍的Open方法中涉及的光标类型和锁定类型这两个问题。<br> 在ADO程序中，**记录集（Recordset）**对象代表一个表的记录集合或者是一个SQL命令或存储过程执行结果。简单地说：记录集实际上缓存了从数据库获得的记录，应用程序可以从记录集中获得每条记录的字段。</p> 
<p><font color="Crimson">使用记录集的具体方法：</font><br> 定义_RecordsetPtr型变量，然后通过它调用Recordset对象的Open方法，即可打开一个数据集，然后可以使用GetCollet方法获取记录的字段值，使用Move系列函数实现记录集的遍历，最后关闭记录集。</p> 
<pre><code>&lt;pre name="code" class="cpp"&gt;
_RecordsetPtr智能指针，它是专门为通过记录集操作数据库而设立的指针，通过该接口可以对数据库的表内的记录、字段等进行各种操作。
</code></pre> 
<p><font color="Chartreuse"><strong>Recordset对象的常用属性和方法：</strong></font><br> **RecordCount属性：**返回Recordset对象中记录的当前数目<br> **BOF,EOF属性：**BOF指示当前记录位置的第一记录的前一个，EOF指示当前记录的最后一个记录的后一个。如果打开没有记录的Recordset对象，则BOF,EOF都为true，如果打开的记录集中包含记录，则BOF,EOF都为false<br> **AbsolutePosition属性：**指定Recordset对象当前记录的序号位置<br> **ActiveConnection属性：**该属性指定Recordset当前所属的Connection对象。</p> 
<h2><a id="ADOACCESS_17"></a>ADO连接ACCESS</h2> 
<h3><a id="_18"></a>打开并连接数据库</h3> 
<pre><code class="prism language-javascript">_variant_t vUsername<span class="token punctuation">,</span>vID<span class="token punctuation">,</span>vname<span class="token punctuation">;</span> <span class="token comment">//变量声明</span>
_RecordsetPtr m_pRecordset<span class="token punctuation">;</span>     <span class="token comment">//记录集</span>
CString strid<span class="token punctuation">;</span>
_ConnectionPtr connection<span class="token punctuation">;</span>
m_pRecordset<span class="token punctuation">.</span><span class="token function">CreateInstance</span><span class="token punctuation">(</span><span class="token function">__uuidof</span><span class="token punctuation">(</span> Recordset <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建实例</span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">"SELECT * FROM users"</span><span class="token punctuation">,</span>connection<span class="token punctuation">.</span><span class="token function">GetInterfacePtr</span>
<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>adOpenStatic<span class="token punctuation">,</span>adLockOptimistic<span class="token punctuation">,</span>adCmdText<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行SQL语句，得到记录集, connection必须已和数据库连接</span>
</code></pre> 
<p><em><strong>原型</strong></em><br> <mark>Open</mark>方法的原型是这样的:</p> 
<pre><code>HRESULT Recordset15::Open ( const _variant_t &amp; Source, 
const _variant_t &amp; ActiveConnection,
enum CursorTypeEnum CursorType, 
enum LockTypeEnum LockType,
long Options )
</code></pre> 
<p>①Source参数：为记录源，是数据查询字符串，它可以是下列内容之一：Command对象变量，SQL语句，存储过程，表名或完整的路径名。<br> ②ActiveConnection：是已经建立好的连接（我们需要用Connection对象指针来构造一个_variant_t对象) ，对应于ActiveConnection属性，指定在哪个连接中打开该记录集，常用_ConnectionPtr.GetInfaceterPtr()指定<br> ③CursorType光标类型：指定打开Recordset时使用的游标，它的取值可以是CursorTypeEnum枚举型中的常量，adOpenStatic（静态游标），adOpenDynamic（动态游标）,adOpenForwardOnly(默认，前向游标)，adOpenKeyset（键集游标）.请看这个枚举结构:</p> 
<pre><code>enum CursorTypeEnum
{
adOpenUnspecified = -1,///不作特别指定
adOpenForwardOnly = 0,///前滚静态光标。这种光标只能向前浏览记录集，比如用MoveNext向前滚动,这
种方式可以提高浏览速度。但诸如BookMark,RecordCount,AbsolutePosition,AbsolutePage都不能使用
adOpenKeyset = 1,///采用这种光标的记录集看不到其它用户的新增、删除操作，但对于更新原有记录的
操作对你是可见的。
adOpenDynamic = 2,///动态光标。所有数据库的操作都会立即在各用户记录集上反应出来。
adOpenStatic = 3///静态光标。它为你的记录集产生一个静态备份，但其它用户的新增、删除、更新操作对你的记录集来说是不可见的。
};
</code></pre> 
<p>④LockType：指定打开记录集时应该使用的锁定类型，LockType取值为LockTypeEnum枚举型的值，它可以是以下值之一，请看如下枚举结构：</p> 
<pre><code>enum LockTypeEnum
{
adLockUnspecified = -1;//未指定
adLockReadOnly = 1;//默认值，只读：不能改变数据；
adLockPessimistic = 2;/保守式锁定（逐个），数据提供者完成确保成功编辑记录所需的工作，通常通过在编辑时立即锁定数据源的记录。数据在更新时锁定其它所有动作，这是最安全的锁定机制。
adLockOptimistic = 3;//开发式锁定（逐个），数据提供者使用开放式锁定，只在调用Update()方法时才锁定记录。只有在你调用Update方法时才锁定记录。在此之前仍然可以做数据的更新、插入、删除等动作。
adLockBatchOptimistic = 4;//开发式批更新：用于批更新模式编辑时记录不会锁定，更改、插入及删除是在批处理模式下完成。
};
</code></pre> 
<p>⑤option：该参数类型为长整型值，它指定参数Source的种类，可以取以下值<br> adCmdText:表明CommandText是文本命令，指示提供者应该将Source作为命令的文本定义来计算<br> adCmdTable:表明CommandText是一个表名，指示ADO生成SQL查询以便从在Source中命名的表中返回所有行<br> adCmdTableDirect：指示提供者更改从Source中命名的表中返回所有行<br> adCmdProc:表明CommandText是一个存储过程，指示提供者应该将Source视为存储过程<br> adCmdUnknown:指示Source参数的命令类型为未知。</p> 
<h3><a id="m_pRecordsetPtr_72"></a>记录集m_pRecordsetPtr操作</h3> 
<pre><code class="prism language-javascript">_RecordsetPtr m_pRecordset<span class="token punctuation">;</span> <span class="token comment">//为了取得结果记录集，定义一个指向Recordset对象的指针:</span>
m_pRecordset<span class="token punctuation">.</span><span class="token function">CreateInstance</span><span class="token punctuation">(</span><span class="token string">"ADODB.Recordset"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//并为其创建Recordset对象的实例: </span>
</code></pre> 
<pre><code class="prism language-javascript"><span class="token comment">//制定数据库位置用</span>
m_pRecordsetPtr<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">MoveFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//移动到记录集最前面</span>
m_pRecordsetPtr<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">MovePrevious</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//移动到前一条</span>
m_pRecordsetPtr<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">MoveNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//移动到后一条</span>
m_pRecordsetPtr<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">MoveLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//移动到记录集最后</span>
<span class="token comment">//添加记录用</span>
m_pRecordsetPtr<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">AddNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//向记录集中添加一条</span>
m_pRecordsetPtr<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">PutCollect</span><span class="token punctuation">(</span><span class="token string">"ItemName"</span><span class="token punctuation">,</span>ItemNameData<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//向记录集中ItemName字段添加ItemNameData</span>
m_pRecordsetPtr<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//更新记录集</span>
</code></pre> 
<p><font color="Chartreuse">MoveFirst，MoveLast，MoveNext，MovePrevious方法</font>：这些方法可以对记录集的游标进行移动操作<br> <font color="Chartreuse">GetCollect方法</font>：用于取得字段的值，参数Index可以是字符串表明字段名，也可以是整型数，表示字段的序号。<br> _variant_t GetCollect(const _variant_t &amp;Index);<br> <font color="Chartreuse">PutColloct方法</font>：用于向记录字段中写入值，pvar参数表示要写入的变量值</p> 
<pre><code>void PutCollect (const _variant_t &amp;Index,const _variant_t &amp;pvar);
</code></pre> 
<p><font color="Chartreuse">AddNew()方法</font>：使用该方法创建和初始化新记录，该方法可以使用参数，在参数中指定要添加的新纪录，也可以不使用参数，而在后面使用PutCollect方法修改新记录，使用Update函数保存新纪录<br> <font color="Chartreuse">Update()方法</font>：该方法保存从调用AddNew方法以来或更改现有记录中的任何字段值以来所做的所有更改。</p> 
<h4><a id="_100"></a>记录集操作实例代码</h4> 
<pre><code class="prism language-javascript"><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span>adoEOF<span class="token punctuation">)</span><span class="token comment">///这里为什么是adoEOF而不是EOF呢?还记得rename("EOF","adoEOF")这一句吗?</span>
<span class="token punctuation">{<!-- --></span>
  vID <span class="token operator">=</span> m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">GetFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">GetItem</span><span class="token punctuation">(</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value<span class="token punctuation">;</span><span class="token comment">///取得第1列的值,从0开始计数，</span>
  strid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">TCHAR</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_bstr_t<span class="token punctuation">)</span>vID <span class="token comment">//转换为字符串</span>
  vname <span class="token operator">=</span> m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">GetFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">GetItem</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span><span class="token comment">//取得第一列属性名，以直接给出列的名称，如下一行</span>
  vUsername <span class="token operator">=</span> m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">GetCollect</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">///取得username字段的值</span>
  m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">MoveNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">///移到下一条记录</span>
<span class="token punctuation">}</span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">GetFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span>Count<span class="token comment">//获得一条记录的字段数</span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">MoveFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//移到首条记录</span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Delete</span><span class="token punctuation">(</span>adAffectCurrent<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//删除当前记录</span>
<span class="token comment">///添加三条新记录并赋值</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>int i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">AddNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">///添加新记录</span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">PutCollect</span><span class="token punctuation">(</span><span class="token string">"ID"</span><span class="token punctuation">,</span><span class="token function">_variant_t</span><span class="token punctuation">(</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">PutCollect</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token function">_variant_t</span><span class="token punctuation">(</span><span class="token string">"haiyan"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">PutCollect</span><span class="token punctuation">(</span><span class="token string">"old"</span><span class="token punctuation">,</span><span class="token function">_variant_t</span><span class="token punctuation">(</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token number">71</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">PutCollect</span><span class="token punctuation">(</span><span class="token string">"birthday"</span><span class="token punctuation">,</span><span class="token function">_variant_t</span><span class="token punctuation">(</span><span class="token string">"1930-3-15"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Move</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">_variant_t</span><span class="token punctuation">(</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span>adBookmarkFirst<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">///从第一条记录往下移动一条记录,即移动到第二条记录处</span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">PutCollect</span><span class="token punctuation">(</span><span class="token function">_variant_t</span><span class="token punctuation">(</span><span class="token string">"old"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">_variant_t</span><span class="token punctuation">(</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">///修改其年龄</span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">///保存到库中</span>
</code></pre> 
<p>**在这说明一下:**在我的一个.NET数据库连接程序中,出现一个问题,每次初始化打开数据集时程序报错说"数据库打开错误,无效指针",让我郁闷好几个小时,后来发现,当我在创建数据库连接对象前加入函数CoInitialize(NULL)后,错误解决,源码如下:</p> 
<pre><code>CoInitialize(NULL);
hr=m_pConnection.CreateInstance(_uuidof(Connection));
</code></pre> 
<p>MSDC说明如下:<br> You need to initialize the COM library on an apartment before you call any of the<br> library functions except CoGetMalloc,to get a pointer to the standard allocator,<br> and the memory allocation functions</p> 
<h2><a id="_138"></a>获取数据库表名</h2> 
<p>先声明变量，这里我是放在了extern的全局变量类中<br> <img src="https://images2.imgbox.com/b7/94/p7lRV79B_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-javascript">CStringArray strArryTable<span class="token punctuation">;</span><span class="token comment">//某个数据库中表的名称集合</span>
CStringArray strArryField<span class="token punctuation">;</span><span class="token comment">//某个数据库中表字段的名称集合</span>
</code></pre> 
<pre><code class="prism language-javascript"><span class="token comment">///获取数据库内的表名///</span>
bool CADOConn<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetTableName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	strArryTable<span class="token punctuation">.</span><span class="token function">RemoveAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//初始化strArry</span>
	<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CoInitialize</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//初始化OLE/COM库环境</span>
	_ConnectionPtr m_gtnpConnection<span class="token punctuation">;</span><span class="token comment">//数据库连接类，-&gt;是重载符</span>
	<span class="token keyword">try</span>
	<span class="token punctuation">{<!-- --></span><span class="token comment">//创建connection对象</span>
		m_gtnpConnection<span class="token punctuation">.</span><span class="token function">CreateInstance</span><span class="token punctuation">(</span><span class="token string">"ADODB.Connection"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建connection连接对象  </span>
		m_gtnpConnection<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_bstr_t<span class="token punctuation">)</span>strConnect<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> adModeUnknown<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//SERVER和UID、PWD的设置根据实际情况来设置</span>
		_RecordsetPtr pRstSchema <span class="token operator">=</span> m_gtnpConnection<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">OpenSchema</span><span class="token punctuation">(</span>adSchemaTables<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>pRstSchema<span class="token operator">-</span><span class="token operator">&gt;</span>adoEOF<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_bstr_t table_name <span class="token operator">=</span> pRstSchema<span class="token operator">-</span><span class="token operator">&gt;</span>Fields<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">GetItem</span><span class="token punctuation">(</span><span class="token string">"TABLE_NAME"</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span>Value<span class="token punctuation">;</span><span class="token comment">//获取表格</span>
			_bstr_t table_type <span class="token operator">=</span> pRstSchema<span class="token operator">-</span><span class="token operator">&gt;</span>Fields<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">GetItem</span><span class="token punctuation">(</span><span class="token string">"TABLE_TYPE"</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span>Value<span class="token punctuation">;</span><span class="token comment">//获取表格类型</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">LPCSTR</span><span class="token punctuation">)</span>table_type<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"TABLE"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token comment">//m_cmbTable.AddString((LPCTSTR)table_name);</span>
				strArryTable<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">LPCTSTR</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_bstr_t<span class="token punctuation">)</span>pRstSchema<span class="token operator">-</span><span class="token operator">&gt;</span>Fields<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">GetItem</span><span class="token punctuation">(</span><span class="token string">"TABLE_NAME"</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			pRstSchema<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">MoveNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		pRstSchema<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">_com_error</span> e<span class="token punctuation">)</span><span class="token comment">//捕捉异常</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">AfxMessageBox</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//显示错误信息</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>m_gtnpConnection <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		m_gtnpConnection<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_gtnpConnection<span class="token punctuation">.</span><span class="token function">Release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CoUninitialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//释放环境</span>
	<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_186"></a>获取数据库表的字段名</h2> 
<p>使用集合Fields获取字段值</p> 
<pre><code>_variant_t var=pRecordset-&gt;Fields-&gt;GetItem(long(0))-&gt;GetValue();
</code></pre> 
<pre><code class="prism language-javascript"><span class="token comment">获取表的字段名</span>
bool CADOConn<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetTableField</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 得到所有字段</span>
	strArryField<span class="token punctuation">.</span><span class="token function">RemoveAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//初始化清空strArryField</span>
	FieldsPtr fields <span class="token operator">=</span> g_pRdset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">GetFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>long i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fields<span class="token operator">-</span><span class="token operator">&gt;</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		FieldPtr field <span class="token operator">=</span> fields<span class="token operator">-</span><span class="token operator">&gt;</span>Item<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		CString strFieldName <span class="token operator">=</span> field<span class="token operator">-</span><span class="token operator">&gt;</span>Name<span class="token punctuation">;</span><span class="token comment">//字段名</span>
		strArryField<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>strFieldName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>**下面是参考的资料<br> 获取access数据库的Data.mdb数据库里面的表名，将获取的表名存储到了strArray_1里面了。<br> strArray的定义在头文件里定义</p> 
<pre><code>CArray&lt;CString,CString&gt; strArry_1; 
</code></pre> 
<pre><code>case 1:
	{
	    datamdbbase(); //调用连接 Mdb 数据库的类
	    _ConnectionPtr m_pConnection;
	    m_pConnection = getconePtr();
	    _RecordsetPtr pRstSchema = m_pConnection-&gt;OpenSchema(adSchemaTables);
	    while(!(pRstSchema-&gt;adoEOF))
	    {
            strArry_1.Add((LPCTSTR)(_bstr_t)pRstSchema-&gt;Fields-&gt;GetItem("TABLE_NAME")-&gt;Value);
	    pRstSchema-&gt;MoveNext();
	    }
	}
	break;

</code></pre> 
<pre><code>struct TableField
{
    TableField()
        : strFieldName(_T(""))
        , nFieldType(0)
        , nFieldLength(0)
    {
    }
    CString strFieldName; // 字段名称
    int nFieldType; // 字段类型
    int nFieldLength; //字段大小
};
 
/*
@brief 获取表的所有字段
@param[in] pConnPtr 数据库连接
@param[in] strTableName 表名称
@param[out] vTableFields 字段列表
@return 获取是否成功
*/
bool GetTableField(_ConnectionPtr&amp; pConnPtr, const CString&amp; strTableName, vector&lt;TableField&gt;&amp; vTableFields)
{
    CString strSql = _T("");
    strSql.Format(_T("select * from %s"), strTableName);
 
    _RecordsetPtr pRecordsetOrig;
    pRecordsetOrig.CreateInstance(__uuidof(Recordset));
    HRESULT = pRecordsetOrig-&gt;Open(_bstr_t(strSql), _variant_t(pConnPtr.GetInterfacePtr()),
        adOpenDynamic, adLockOptimistic, adCmdText);
 
    // 得到所有字段
    FieldsPtr fields = pRecordsetOrig-&gt;GetFields();
    for (long i = 0; i &lt; fields-&gt;Count; i++)
    {
        FieldPtr field = fields-&gt;Item[i];
 
        TableField curField;
        curField.strFieldName = field-&gt;Name;//字段名
        curField.nFieldType = field-&gt;Type;//字段类型
        curField.nFieldLength = field-&gt;NumericScale;
 
        vTableFields.push_back(curField);
    }
    pRecordsetOrig-&gt;Close();
    return true;
}

</code></pre> 
<h3><a id="SQL_284"></a>SQL命令的执行可以采用多种形式</h3> 
<h4><a id="1ConnectionExecuteSQL_285"></a>(1)利用Connection对象的Execute方法执行SQL命令</h4> 
<p>Execute方法的原型如下所示:</p> 
<pre><code>_RecordsetPtr Connection15::Execute ( _bstr_t CommandText, VARIANT * RecordsAffected, long Options ) 
{
//添加代码
}
</code></pre> 
<p>其中<strong>CommandText</strong>是命令字串，通常是SQL命令；<br> 参数<strong>RecordsAffected</strong>是操作完成后所影响的行数；<br> 参数<strong>Options</strong>表示CommandText中内容的类型，Options可以取如下值之一：<br> adCmdText:表明CommandText是文本命令<br> adCmdTable:表明CommandText是一个表名<br> adCmdProc:表明CommandText是一个存储过程<br> adCmdUnknown:未知</p> 
<p>Execute执行完后返回一个指向记录集的指针，下面我们给出具体代码并作说明。</p> 
<pre><code class="prism language-javascript">_variant_t RecordsAffected<span class="token punctuation">;</span> 
<span class="token comment">///执行SQL命令</span>
m_pConnection<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token string">"CREATE TABLE users(ID INTEGER,username TEXT,old INTEGER,birthday DATETIME)"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>RecordsAffected<span class="token punctuation">,</span>adCmdText<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//CREATE TABLE创建表格users,users包含四个字段:整形ID,字符串username,整形old,日期型birthday </span>
<span class="token comment">///往表格里面添加记录 </span>
m_pConnection<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token string">"INSERT INTO users(ID,username,old,birthday) valueS (1, nullnullnullnullnullnullnullnullWashingtonnullnullnullnullnullnullnullnull,25,nullnullnullnullnullnullnullnull1970/1/1nullnullnullnullnullnullnullnull)"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>RecordsAffected<span class="token punctuation">,</span>adCmdText<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">///将所有记录old字段的值加一 </span>
m_pConnection<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token string">"UPDATE users SET old = old+1"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>RecordsAffected<span class="token punctuation">,</span>adCmdText<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">///执行SQL统计命令得到包含记录条数的记录集 </span>
m_pRecordset <span class="token operator">=</span> m_pConnection<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token string">"SELECT COUNT(*) FROM users"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>RecordsAffected<span class="token punctuation">,</span>adCmdText<span class="token punctuation">)</span><span class="token punctuation">;</span> 
_variant_t vIndex <span class="token operator">=</span> <span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">;</span> 
_variant_t vCount <span class="token operator">=</span> m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">GetCollect</span><span class="token punctuation">(</span>vIndex<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">///取得第一个字段的值放入vCount变量 </span>
m_pRecordset<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">///关闭记录集 </span>
CString message<span class="token punctuation">;</span> 
message<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"共有%d条记录"</span><span class="token punctuation">,</span>vCount<span class="token punctuation">.</span>lVal<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">AfxMessageBox</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">///显示当前记录条数 </span>
</code></pre> 
<h4><a id="2CommandSQL_320"></a>(2)利用Command对象来执行SQL命令</h4> 
<pre><code class="prism language-javascript">_CommandPtr m_pCommand<span class="token punctuation">;</span> 
m_pCommand<span class="token punctuation">.</span><span class="token function">CreateInstance</span><span class="token punctuation">(</span><span class="token string">"ADODB.Command"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
_variant_t vNULL<span class="token punctuation">;</span> 
vNULL<span class="token punctuation">.</span>vt <span class="token operator">=</span> <span class="token constant">VT_ERROR</span><span class="token punctuation">;</span> 
vNULL<span class="token punctuation">.</span>scode <span class="token operator">=</span> <span class="token constant">DISP_E_PARAMNOTFOUND</span><span class="token punctuation">;</span><span class="token comment">///定义为无参数 </span>
m_pCommand<span class="token operator">-</span><span class="token operator">&gt;</span>ActiveConnection <span class="token operator">=</span> m_pConnection<span class="token punctuation">;</span><span class="token comment">///非常关键的一句，将建立的连接赋值给它 </span>
m_pCommand<span class="token operator">-</span><span class="token operator">&gt;</span>CommandText <span class="token operator">=</span> <span class="token string">"SELECT * FROM users"</span><span class="token punctuation">;</span><span class="token comment">///命令字串 </span>
m_pRecordset <span class="token operator">=</span> m_pCommand<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>vNULL<span class="token punctuation">,</span><span class="token operator">&amp;</span>vNULL<span class="token punctuation">,</span>adCmdText<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">///执行命令，取得记录集 </span>
</code></pre> 
<p>在这段代码中我们只是用Command对象来执行了SELECT查询语句，Command对象在进行存储过程的调用中能真正体现它的作用。下次我们将详细介绍。</p> 
<h4><a id="ACCESS_sql_332"></a>ACCESS sql语句</h4> 
<pre><code>string sql = "select top 5 * from Dcms_Intro where Intro_CateId=931 order by cint(Intro_ExFlag5) desc " ;// 这样才能正确排序
cint(Intro_ExFlag5) //文本类型转换为数字类型
</code></pre> 
<h2><a id="ASPAccess_338"></a>ASP连接Access数据库</h2> 
<p>一、ASP连接Access数据库：</p> 
<pre><code>dim conn,mdbfile
mdbfile=server.mappath("数据库名称.mdb")
set conn=server.createobject("adodb.connection")
conn.open "driver={microsoft access driver(*.mdb)};uid=admin;pwd=数据库密码;dbq="&amp;mdbfile
</code></pre> 
<p>二、ASP连接SQLServer数据库：</p> 
<pre><code>dim conn
set conn=server.createobject("ADODB.connection")
con.open "PROVIDER=SQLOLEDB;DATASOURCE=SQL服务器名称或IP地址;UID=sa;PWD=数据库密码;DATABASE=数据库名称
</code></pre> 
<p>建立记录集对象：</p> 
<pre><code>set rs=server.createobject("adodb.recordset")
rs.open SQL语句,conn,3,2
</code></pre> 
<p>其他</p> 
<pre><code>m_pRset-&gt;Open(_bstr_t(SELECT * FROM tablename ORDER BY ‘列名'),....)//导入到记录集
m_newpRecordset-&gt;Delete(adAffectCurrent);//删除当前记录
m_newpRecordset-&gt;Delete(adAffectAll);//删除所有记录
m_newpRecordset-&gt;AddNew();//添加新行  
</code></pre> 
<p>关于 conn,3,2的说明，一般情况下用1,1 读数据，如果你的操作包括写入,修改,删除数据，那么使用conn,1,3就可以了。</p> 
<p>三、一些常用的SQL命令集锦：<br> (1) 数据记录筛选：<br> sql=“select * from 数据表 where 字段名=字段值 order by 字段名 [desc]”<br> sql=“select top 10 * from 数据表 where 字段名 order by 字段名 [desc]”<br> sql=“select * from 数据表 where 字段名 in (‘值1’,‘值2’,‘值3’)”<br> sql=“select * from 数据表 where 字段名 like ‘%字段值%’ order by 字段名 [desc]”<br> sql=“select * from 数据表 where 字段名 between 值1 and 值2”</p> 
<p>(2) 更新数据记录：<br> sql=“update 数据表 set 字段名=字段值 where 条件表达式”<br> sql=“update 数据表 set 字段1=值1,字段2=值2 …… 字段n=值n where 条件表达式”</p> 
<p>(3) 添加数据记录：<br> sql=“insert into 数据表 (字段1,字段2,字段3 …) values (值1,值2,值3 …)”<br> sql=“insert into 目标数据表 select * from 源数据表” (把源数据表的记录添加到目标数据表)</p> 
<p>(4) 删除数据记录：<br> sql=“delete from 数据表 where 条件表达式”<br> sql=“delete from 数据表” (将数据表所有记录删除)</p> 
<p>(5) 数据记录统计函数：<br> AVG(字段名) 得出一个表格栏平均值<br> COUNT(*¦字段名) 对数据行数的统计或对某一栏有值的数据行数统计<br> MAX(字段名) 取得一个表格栏最大的值<br> MIN(字段名) 取得一个表格栏最小的值<br> SUM(字段名) 把数据栏的值相加<br> 引用以上函数的方法：<br> sql=“select sum(字段名) as 别名 from 数据表 where 条件表达式”<br> set rs=conn.excute(sql)<br> 用 rs(“别名”) 获取统的计值，其它函数运用同上。</p> 
<p>(6) 数据表的建立和删除：<br> 生成数据表：CREATE TABLE 数据表名称(字段1 类型1(长度),字段2 类型2(长度) …… )，例：CREATE TABLE tab01(name varchar(50),datetime default now())<br> 删除数据表：DROP TABLE 表名</p> 
<p>四. 记录集对象的方法：<br> rs.absolutepage=N 将记录指针移到第N页的第一行<br> rs.pagesize=N 设置每页为N条记录<br> rs.pagecount 根据 pagesize 的设置返回总页数<br> rs.movelast 将记录指针移到数据表最后一行<br> rs.absoluteposition=N 将记录指针移到数据表第N行<br> rs.bof 返回记录指针是否超出数据表首端，true表示是，false为否<br> rs.eof 返回记录指针是否超出数据表末端，true表示是，false为否<br> rs.delete 删除当前记录，但记录指针不会向下移动<br> rs.addnew 添加记录到数据表末端<br> rs.update 更新数据表记录<br> rs.recordcount 返回记录总数<br> rs.movenext 将记录指针从当前的位置向下移一行<br> rs.moveprevious 将记录指针从当前的位置向上移一行<br> rs.movefirst 将记录指针移到数据表第一行</p> 
<p>转载自：<br> <a href="https://blog.csdn.net/fearlessxjdx/article/details/53469995">https://blog.csdn.net/fearlessxjdx/article/details/53469995</a><br> 原文：<a href="https://blog.csdn.net/niushitang/article/details/8270325">https://blog.csdn.net/niushitang/article/details/8270325</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/64292903922bb4728890de21f0e54d28/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">XGBoost</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/361375643a0ca46e762864cb42bf5ae5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MVG读书笔记——单应矩阵估计这件小事（一）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>