<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一、docker部署nginx和自家官网 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="一、docker部署nginx和自家官网" />
<meta property="og:description" content="一、docker部署nginx 1.1 docker安装配置nginx 1.1.1 总体步骤 #总体步骤 ·	搜索镜像 ·	拉取镜像 ·	查看镜像 ·	启动容器 ·	服务端口映射 ·	停止容器 ·	移除容器 1.1.2 基础操作 1、搜索nginx镜像 [root@docker ~]# docker search nginx --limit 10	#查询nginx的镜像前10份 2、拉取nginx镜像 [root@docker ~]# docker pull nginx:latest	#拉取最新版本的nginx。 #其他版本可以查看https://hub.docker.com/_/nginx/tags。 3、查看镜像 [root@docker ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE nginx latest 605c77e624dd 18 months ago 141MB 4、镜像改名 [root@docker ~]# docker image tag nginx:latest xxqops.icu/nginx:latest	#把nginx镜像复制改名为xxqops.icu/nginx:latest。必须加上对应的版本。 [root@docker ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE nginx latest 605c77e624dd 18 months ago 141MB xxqops." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/14e6a18edbe5955e87ef95a9b242762d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-14T22:11:41+08:00" />
<meta property="article:modified_time" content="2023-07-14T22:11:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一、docker部署nginx和自家官网</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="dockernginx_0"></a>一、docker部署nginx</h2> 
<h3><a id="11_dockernginx_2"></a>1.1 docker安装配置nginx</h3> 
<h4><a id="111__4"></a>1.1.1 总体步骤</h4> 
<pre><code class="prism language-bash"><span class="token comment">#总体步骤</span>
·	搜索镜像
·	拉取镜像
·	查看镜像
·	启动容器
·	服务端口映射
·	停止容器
·	移除容器
</code></pre> 
<h4><a id="112__17"></a>1.1.2 基础操作</h4> 
<pre><code class="prism language-bash"><span class="token number">1</span>、搜索nginx镜像
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker search nginx --limit 10			#查询nginx的镜像前10份</span>
<span class="token number">2</span>、拉取nginx镜像
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker pull nginx:latest				#拉取最新版本的nginx。</span>
<span class="token comment">#其他版本可以查看https://hub.docker.com/_/nginx/tags。</span>
<span class="token number">3</span>、查看镜像
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
nginx               latest              605c77e624dd        <span class="token number">18</span> months ago       141MB
<span class="token number">4</span>、镜像改名
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker image tag nginx:latest xxqops.icu/nginx:latest		</span>
<span class="token comment">#把nginx镜像复制改名为xxqops.icu/nginx:latest。必须加上对应的版本。</span>
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
nginx               latest              605c77e624dd        <span class="token number">18</span> months ago       141MB
xxqops.icu/nginx    latest              605c77e624dd        <span class="token number">18</span> months ago       141MB
<span class="token number">5</span>、删除旧镜像
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker image rm nginx:latest				#删除nginx:latest镜像</span>
Untagged: nginx:latest
Untagged: nginx@sha256:0d17b565c37bcbd895e9d92315a05c1c3c9a29f762b011a10c54a66cd53c9b31
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker image ls</span>
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
xxqops.icu/nginx    latest              605c77e624dd        <span class="token number">18</span> months ago       141MB

</code></pre> 
<h4><a id="113__46"></a>1.1.3 启动容器</h4> 
<pre><code class="prism language-bash"><span class="token number">1</span>、启动容器依赖目前的镜像
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># mkdir -p  /data/nginx/var/www/index         #创建静态资源映射目录</span>
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># mkdir -p /data/nginx/log				    #创建日志映射目录</span>
<span class="token punctuation">[</span>root@docker data<span class="token punctuation">]</span><span class="token comment"># docker run -itd --name webserver -p 80:80 -v /data/nginx/var/www/index:/usr/share/nginx/html -v /data/nginx/log:/var/log/nginx xxqops.icu/nginx:latest			#运行容器</span>
8ee4e3736f622541657fcd32db144b5621bc8f1abcc5d7976e07853a61f7609d
启动参数：
<span class="token comment">#-d: 后台运行容器并返回容器ID，也即启动守护式容器(后台运行)；</span>
<span class="token comment">#-i：以交互模式运行容器，通常与 -t 同时使用；     -i::interactive(交互)  -t:tty终端</span>
<span class="token comment">#-t：为容器重新分配一个伪输入终端，通常与 -i 同时使用；</span>
<span class="token comment">#--name:容器名称</span>
<span class="token comment">#-p：宿主机端口映射容器端口</span>
<span class="token comment">#-v: 卷的映射。目录映射</span>
<span class="token number">2</span>、查看映射是否正确
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># ll /data/nginx/log/				#映射的目录正确</span>
total <span class="token number">4</span>
-rw-r--r-- <span class="token number">1</span> root root   <span class="token number">0</span> Jul <span class="token number">14</span> <span class="token number">16</span>:34 access.log
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">626</span> Jul <span class="token number">14</span> <span class="token number">16</span>:34 error.log
<span class="token number">3</span>、访问nginx
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># echo "hello world docker world" &gt;&gt; /data/nginx/var/www/index/index.html		#自己写web页面</span>
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker inspect webserver | grep -i "IPADDRESS"								#过滤出容器的ip</span>
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker inspect webserver | grep -i "IPADDRESS" | tail -n 1</span>
                    <span class="token string">"IPAddress"</span><span class="token builtin class-name">:</span> <span class="token string">"172.17.0.2"</span>,
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># curl 172.17.0.2:80								#访问主页</span>
hello world <span class="token function">docker</span> world
<span class="token number">4</span>、进入容器
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it webserver bash					#容器</span>
root@8ee4e3736f62:~<span class="token comment"># cat /usr/share/nginx/html/index.html 				#宿主机操作容器没有问题！！！</span>
hello world <span class="token function">docker</span> world
</code></pre> 
<p><img src="https://images2.imgbox.com/e9/cd/jamEjjMO_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-JTAw9ysI-1689343749455)(E:\教学资料\docker&amp;k8s学习\assets\image-20230714165121703.png)]"></p> 
<h2><a id="docker1_82"></a>二、docker部署自家官网-1</h2> 
<h3><a id="11_nginxdocker_84"></a>1.1 同步nginx的配置到docker服务器</h3> 
<pre><code class="prism language-bash"><span class="token comment">#第一种方式通过-v卷的方式进行映射</span>
<span class="token punctuation">[</span>root@nginx-server ~<span class="token punctuation">]</span><span class="token comment"># tar -zcf nginx.tar.gz nginx/</span>
<span class="token punctuation">[</span>root@nginx-server ~<span class="token punctuation">]</span><span class="token comment"># scp -r  nginx.tar.gz root@192.168.222.140:/root		#同步到docker服务器</span>
</code></pre> 
<h3><a id="12_webhp_92"></a>1.2 同步webhp项目</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@nginx-server ~<span class="token punctuation">]</span><span class="token comment"># scp -r  webhp root@192.168.222.140:/root				#同步前端项目到docker服务器</span>
</code></pre> 
<h3><a id="13_webhp_98"></a>1.3 查看webhp项目的配置</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/nginx/proxy_webhp					#说明需要映射8000端口</span>
 server <span class="token punctuation">{<!-- --></span>
        listen       <span class="token number">8000</span><span class="token punctuation">;</span>
        listen       <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:8000<span class="token punctuation">;</span>
        server_name  _<span class="token punctuation">;</span>
        root         /root/webhp/<span class="token punctuation">;</span>						<span class="token comment">#说明访问的资源是此路径下的内容</span>
        index     index.html<span class="token punctuation">;</span>
        access_log    /data/log/nginx/www_access.log<span class="token punctuation">;</span>
        error_log     /data/log/nginx/www_error.log<span class="token punctuation">;</span>
        location / <span class="token punctuation">{<!-- --></span>
            try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        location <span class="token operator">=</span> /HCIP.jpg <span class="token punctuation">{<!-- --></span>
        <span class="token comment"># 空的配置块，表示直接返回该文件</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="14__119"></a>1.4 启动容器</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker ps -a</span>
CONTAINER ID        IMAGE                     COMMAND                  CREATED             STATUS                     PORTS               NAMES
abc4b0ff2df0        xxqops.icu/nginx:latest   <span class="token string">"/docker-entrypoint.…"</span>   <span class="token number">5</span> seconds ago       Exited <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">4</span> seconds ago                       nginx-webhp					<span class="token comment">#启动失败了需要查看日志</span>
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker logs -f nginx-webhp			#动态查看容器的运行日志</span>
<span class="token number">2023</span>/07/14 09:24:30 <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: mkdir() "/data/www/proxy_temp_dir" failed (2: No such file or directory)</span>
nginx: <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> mkdir<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token string">"/data/www/proxy_temp_dir"</span> failed <span class="token punctuation">(</span><span class="token number">2</span>: No such <span class="token function">file</span> or directory<span class="token punctuation">)</span>
<span class="token comment">##需要创建对应的映射目录。这是因为nginx的http.conf开启了缓存</span>
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker run -itd --name nginx-webhp -p 8000:8000 -v /root/webhp:/root/webhp -v /data/nginx/log:/data/log/nginx -v /etc/nginx:/etc/nginx -v /data/nginx/www/proxy_temp_dir:/data/www/proxy_temp_dir xxqops.icu/nginx:latest</span>
</code></pre> 
<h3><a id="15__132"></a>1.5 访问前端</h3> 
<pre><code class="prism language-bash"><span class="token number">1</span>、查看容器状态
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker ps -a</span>
CONTAINER ID        IMAGE                     COMMAND                  CREATED             STATUS              PORTS                            NAMES
e26ae699ffce        xxqops.icu/nginx:latest   <span class="token string">"/docker-entrypoint.…"</span>   <span class="token number">17</span> seconds ago      Up <span class="token number">17</span> seconds       <span class="token number">80</span>/tcp, <span class="token number">0.0</span>.0.0:8000-<span class="token operator">&gt;</span><span class="token number">8000</span>/tcp   nginx-webhp				<span class="token comment">#运行正常</span>
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># netstat -tnlp | grep "docker"				#端口启动正常</span>
tcp6       <span class="token number">0</span>      <span class="token number">0</span> :::8000                 :::*                    LISTEN      <span class="token number">3330</span>/docker-proxy   
<span class="token number">2</span>、访问页面
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># curl -I localhost:8000</span>
HTTP/1.1 <span class="token number">200</span> OK
Server: nginx
Date: Fri, <span class="token number">14</span> Jul <span class="token number">2023</span> 09:28:32 GMT
Content-Type: text/html<span class="token punctuation">;</span> <span class="token assign-left variable">charset</span><span class="token operator">=</span>utf-8
Content-Length: <span class="token number">8109</span>
Last-Modified: Fri, <span class="token number">14</span> Jul <span class="token number">2023</span> 09:09:42 GMT
Connection: keep-alive
Vary: Accept-Encoding
ETag: <span class="token string">"64b110d6-1fad"</span>
Accept-Ranges: bytes
</code></pre> 
<p><img src="https://images2.imgbox.com/d1/8a/yoYvZKPt_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-E1c12VvV-1689343749456)(E:\教学资料\docker&amp;k8s学习\assets\image-20230714172842293.png)]"></p> 
<h3><a id="16_webhp_158"></a>1.6 基于webhp创建新镜像</h3> 
<pre><code class="prism language-bash"><span class="token number">1</span>、基于webhp前端容器创建新的镜像
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker commit -m "webhp容器镜像" -a "运维神经科主任" e26ae699ffce xxqops.icu/nginx:v1.0</span>
sha256:9502210494f14ff510843fc8a66349f3dc77a5231b4754383f67cf675ccb55ff
<span class="token comment">#-m="提交的描述信息" -a="作者" 容器ID 要创建的目标镜像名:[标签名] </span>
<span class="token number">2</span>、基于构建的新的image创建新的容器
<span class="token comment">#通过 docker commit 创建的容器镜像只包含静态的文件系统和元数据，不包含容器的运行状态和数据。因此，任何动态的或实时的更改，例如运行中的进程状态或数据库的动态数据，都不会包含在新镜像中。</span>
<span class="token comment">#所以持久化的卷不会再镜像中。需要自己创建并且同步文件</span>
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker run -itd --name nginx-webhp-test -p 8001:80  xxqops.icu/nginx:v1.0</span>
<span class="token comment">#因为上方的nginx都是通过-v卷挂载的方式运行的nginx</span>
<span class="token comment">#commit又不会同步卷的内容。所以不会存在之前的nginx的配置等.-v /root/webhp:/root/webhp。此目录因为nginx本身不存在所以会创建。说明commit封装了创建webhp目录的层！！！</span>
</code></pre> 
<h2><a id="docker2_173"></a>三、docker部署自家官网-2</h2> 
<h3><a id="11_nginx_175"></a>1.1 运行新的空白的nginx容器</h3> 
<pre><code class="prism language-bash"><span class="token comment">#第一种方式通过-v卷映射的方式进行nginx的配置。commit后不能恢复直接使用而是需要进行卷的映射等！！！</span>
<span class="token comment">#第二种方式直接进行容器的封装把映射的目录都打入到nginx中。进行二次封装。直接可以运行webhp的项目！！！</span>
<span class="token number">1</span>、运行新的空白的nginx容器
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker run -itd --name nginx-webhp-test -p 8001:80  xxqops.icu/nginx:latest	</span>
1d8b95b9ca60fea36f104f1ad7ac14c268a52f871bbc8ec971d5ffe737214193
<span class="token comment">#运行新的空的nginx容器</span>
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># curl  -s localhost:8001 | awk 'NR==4{print $0}'</span>
<span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">&gt;</span>				<span class="token comment">#说明是一个全新的nginx</span>
</code></pre> 
<h3><a id="12_copywebhp_188"></a>1.2 通过copy的方式把配置和webhp弄进去</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker cp webhp/ nginx-webhp-test:/root		#拷贝webhp项目到容器中</span>
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker cp  nginx/ nginx-webhp-test:/etc/		#拷贝nginx配置进入到容器中</span>
</code></pre> 
<h3><a id="13_copy_195"></a>1.3 进入容器查看copy是否成功</h3> 
<pre><code class="prism language-bash">root@1d8b95b9ca60:~/webhp<span class="token comment"># ls -l /root/webhp/</span>
ls: cannot access <span class="token string">'/root/webhp/'</span><span class="token builtin class-name">:</span> Operation not permitted		<span class="token comment">#遇到这种错误说明容器需要开启特权模式</span>
<span class="token comment">#可以进入目录通过ls查看</span>
root@1d8b95b9ca60:~/webhp<span class="token comment"># du -sh ./*				#通过du命令可以直接查看</span>
164K    ./HCIP.jpg
<span class="token number">4</span>.0K    ./README.md
<span class="token number">8</span>.0K    ./index.html
776K    ./static
<span class="token number">4</span>.0K    ./学习css.html
<span class="token number">4</span>.0K    ./学习html.html
<span class="token number">4</span>.0K    ./学习表格和表单.html
<span class="token number">4</span>.0K    ./模板css.css
root@1d8b95b9ca60:~/webhp<span class="token comment"># du -sh /etc/nginx/*			#说明copy成功</span>
<span class="token number">4</span>.0K    /etc/nginx/conf.d
<span class="token number">0</span>       /etc/nginx/default.d
<span class="token number">4</span>.0K    /etc/nginx/fastcgi.conf
<span class="token number">4</span>.0K    /etc/nginx/fastcgi.conf.default
<span class="token number">4</span>.0K    /etc/nginx/fastcgi_params
<span class="token number">4</span>.0K    /etc/nginx/fastcgi_params.default
<span class="token number">4</span>.0K    /etc/nginx/http.conf
<span class="token number">4</span>.0K    /etc/nginx/koi-utf
<span class="token number">4</span>.0K    /etc/nginx/koi-win
<span class="token number">8</span>.0K    /etc/nginx/mime.types
<span class="token number">8</span>.0K    /etc/nginx/mime.types.default
<span class="token number">0</span>       /etc/nginx/modules
<span class="token number">4</span>.0K    /etc/nginx/nginx.conf
<span class="token number">4</span>.0K    /etc/nginx/nginx.conf.bak
<span class="token number">4</span>.0K    /etc/nginx/nginx.conf.default
<span class="token number">4</span>.0K    /etc/nginx/proxy_webhp
<span class="token number">4</span>.0K    /etc/nginx/proxy_webhp.bak
<span class="token number">4</span>.0K    /etc/nginx/scgi_params
<span class="token number">4</span>.0K    /etc/nginx/scgi_params.default
<span class="token number">4</span>.0K    /etc/nginx/uwsgi_params
<span class="token number">4</span>.0K    /etc/nginx/uwsgi_params.default
<span class="token number">4</span>.0K    /etc/nginx/win-utf
</code></pre> 
<h3><a id="14_nginx_235"></a>1.4 重启nginx</h3> 
<pre><code class="prism language-bash">root@1d8b95b9ca60:~/webhp<span class="token comment"># nginx -t</span>
nginx: the configuration <span class="token function">file</span> /etc/nginx/nginx.conf syntax is ok		<span class="token comment">#开启了缓存需要创建目录进行缓存的存储</span>
<span class="token number">2023</span>/07/14 <span class="token number">12</span>:55:20 <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> <span class="token number">59</span><span class="token comment">#59: mkdir() "/data/www/proxy_temp_dir" failed (2: No such file or directory)</span>
nginx: <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> mkdir<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token string">"/data/www/proxy_temp_dir"</span> failed <span class="token punctuation">(</span><span class="token number">2</span>: No such <span class="token function">file</span> or directory<span class="token punctuation">)</span>
root@1d8b95b9ca60:~/webhp<span class="token comment"># mkdir -p /data/www/proxy_temp_dir</span>
root@1d8b95b9ca60:~/webhp<span class="token comment"># mkdir -p /data/log/nginx</span>
root@1d8b95b9ca60:~/webhp<span class="token comment"># nginx -t									#nginx校验成功</span>
nginx: the configuration <span class="token function">file</span> /etc/nginx/nginx.conf syntax is ok
nginx: configuration <span class="token function">file</span> /etc/nginx/nginx.conf <span class="token builtin class-name">test</span> is successful
root@1d8b95b9ca60:/etc/nginx<span class="token comment"># nginx -s reload</span>
<span class="token comment">#2023/07/14 12:59:55 [notice] 352#352: signal process started			#正在启动新的进程！！！</span>
root@1d8b95b9ca60:/etc/nginx<span class="token comment"># curl -I localhost:8000</span>
HTTP/1.1 <span class="token number">200</span> OK
</code></pre> 
<h3><a id="15__253"></a>1.5 封装成新的镜像</h3> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker commit -m "webhp容器镜像" -a "运维神经科主任" 1d8b95b9ca60  xxqops.icu/nginx:v1.0</span>
sha256:4617b729de6518b4ccb9ab1547341caeda42f8d4405b60ce6ab4bf4f34eebbaa
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker images | grep "nginx"				#比最基础的镜像大了6MB</span>
xxqops.icu/nginx    v1.0                4617b729de65        <span class="token number">3</span> minutes ago       147MB
xxqops.icu/nginx    latest              605c77e624dd        <span class="token number">18</span> months ago       141MB
</code></pre> 
<h3><a id="16__263"></a>1.6 利用新镜像直接启动前端服务器</h3> 
<pre><code class="prism language-bash"><span class="token number">1</span>、启动容器
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># mkdir -p /root/log/nginx					#创建一个映射日志的目录</span>
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker run -itd --name nginx-webhp-server -p 8888:8000 -v /root/log/nginx:/data/log/nginx xxqops.icu/nginx:v1.0</span>
<span class="token comment">#这样的构建方式方便快速搭建一台自己的webhp服务器。非常的适合生产！！</span>
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># ll log/nginx/							#只需要映射个日志多好！！！</span>
total <span class="token number">4</span>
-rw-r--r-- <span class="token number">1</span> root root    <span class="token number">0</span> Jul <span class="token number">14</span> <span class="token number">21</span>:05 access.log
-rw-r--r-- <span class="token number">1</span> root root    <span class="token number">0</span> Jul <span class="token number">14</span> <span class="token number">21</span>:05 error.log
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">1244</span> Jul <span class="token number">14</span> <span class="token number">21</span>:05 www_access.log
-rw-r--r-- <span class="token number">1</span> root root    <span class="token number">0</span> Jul <span class="token number">14</span> <span class="token number">21</span>:05 www_error.log
<span class="token number">2</span>、查看镜像的层数
<span class="token punctuation">[</span>root@docker ~<span class="token punctuation">]</span><span class="token comment"># docker history xxqops.icu/nginx:v1.0</span>
<span class="token comment">#要查看一个镜像有多少层，可以使用 docker history 命令。该命令可以显示镜像的构建历史，包括每个构建步骤所添加的层。</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/59/38/yMIIDVxx_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/42381a5a722dac1baa7fe3b140ea4541/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">智能优化算法-理论</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f294f7fa99386c298b2ba211c4dfbd96/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ubuntu中安装cmake</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>