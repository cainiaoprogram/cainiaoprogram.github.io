<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>datagrid系列之-加入快捷键 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="datagrid系列之-加入快捷键" />
<meta property="og:description" content="function onBeginEdit(index,row){ var flag = false; var subj = $(&#34;#subjCode&#34;).val(); var subjCode = new Array(); subjCode.push(subj.split(&#34;,&#34;)); var subjRow= row.pkAccsubj.subjcode; for(var j=0;j&lt;subjCode[0].length;j&#43;&#43;){ if(subjRow==subjCode[0][j]){ flag = true; break; } } // 摘要 ed = $(this).datagrid(&#39;getEditor&#39;, { index: index, field: &#39;explanation&#39; }); if(flag){ if(ed == null){ $(this).datagrid(&#39;endEdit&#39;,index); //结束编辑 return false; } } if(ed != null){ document.onkeydown=function(event){ var e = event || window.event || arguments.callee.caller.arguments[0]; if(e &amp;&amp; e.keyCode==13){ $(&#39;#contentTable&#39;).datagrid(&#39;endEdit&#39;, index); $(&#39;#contentTable&#39;).datagrid(&#39;selectRow&#39;, index).datagrid(&#39;editCell&#39;, { index: index, field: &#39;pkAccsubj." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/82ceeacf0b5ab73e86db944fc72a6644/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-04-15T11:53:54+08:00" />
<meta property="article:modified_time" content="2017-04-15T11:53:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">datagrid系列之-加入快捷键</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre class="has"><code class="language-javascript">function onBeginEdit(index,row){
		var flag = false;
		var subj = $("#subjCode").val();
		var subjCode = new Array();
		subjCode.push(subj.split(","));
		var subjRow= row.pkAccsubj.subjcode;
		for(var j=0;j&lt;subjCode[0].length;j++){
			if(subjRow==subjCode[0][j]){
				flag = true;
				break;
			}
		}
		
		// 摘要
		ed = $(this).datagrid('getEditor', {
    		index: index,
    		field: 'explanation'
    	});
		
    	if(flag){
    		if(ed == null){
   			 $(this).datagrid('endEdit',index); //结束编辑
   			 return false;
   			}
    	}
    	
   		if(ed != null){
   			document.onkeydown=function(event){
				var e = event || window.event || arguments.callee.caller.arguments[0];
				if(e &amp;&amp; e.keyCode==13){
					$('#contentTable').datagrid('endEdit', index);
					$('#contentTable').datagrid('selectRow', index).datagrid('editCell', {
		                index: index,
		                field: 'pkAccsubj.dispname'
		            });
				}
	        }; 
   		}
    	
    	// 科目
    	var ed = $(this).datagrid('getEditor', {
			index: index,
			field: 'pkAccsubj.dispname'
		});
		if(ed != null){
			if(row.pkAccsubj!= null&amp;&amp;row.pkAccsubj!= ''){
				if(typeof(row.pkAccsubj.dispname) != "undefined"){
					var obj = new Object();
		    		obj.dispname = row.pkAccsubj.dispname;
		    		obj.pkAccsubj =row.pkAccsubj.pkAccsubj;
		    		row.pkAccsubj = obj;
		    		$('#autocom').combobox('setValue', row.pkAccsubj.dispname);
				}
			}
    		document.onkeydown=function(event){
				var e = event || window.event || arguments.callee.caller.arguments[0];
				if(e &amp;&amp; e.keyCode==13){ // 按 回车
					$('#contentTable').datagrid('endEdit', index);
					$('#contentTable').datagrid('selectRow', index).datagrid('editCell', {
		                index: index,
		                field: 'valueName'
		            });
				}
	        }; 
		}
		
		// 辅助核算
		ed = $(this).datagrid('getEditor', {
    		index: index,
    		field: 'valueName'
    	});
    	if(ed!=null){
    		document.onkeydown=function(event){
				var e = event || window.event || arguments.callee.caller.arguments[0];
				if(e &amp;&amp; e.keyCode==13){ // 按 回车
					$('#contentTable').datagrid('endEdit', index);
					$('#contentTable').datagrid('selectRow', index).datagrid('editCell', {
		                index: index,
		                field: 'pkCurrtype.currtypecode'
		            });
				}
	        }; 
    	}
    	
    	// 币种
    	var ed = $(this).datagrid('getEditor', {
    		index: index,
    		field: 'pkCurrtype.currtypecode'
    	});
    	if(ed!=null){
    		document.onkeydown=function(event){
				var e = event || window.event || arguments.callee.caller.arguments[0];
				if(e &amp;&amp; e.keyCode==13){ // 按 回车
					$('#contentTable').datagrid('endEdit', index);
					$('#contentTable').datagrid('selectRow', index).datagrid('editCell', {
		                index: index,
		                field: 'localdebitamount'
		            });
				}
	        }; 
    		var obj = new Object();
    		obj.pkCurrtype = row.pkCurrtype.pkCurrtype;
    		obj.currtypecode =row.pkCurrtype.currtypecode;
    		row.pkCurrtype = obj;
    		$(ed.target).combobox('setValue',obj.currtypecode);
    	}
    	
    	// 借方
    	ed = $(this).datagrid('getEditor', {
    		index: index,
    		field: 'localdebitamount'
    	});
    	if(ed!=null){
    		document.onkeydown=function(event){
				var e = event || window.event || arguments.callee.caller.arguments[0];
				if(e &amp;&amp; e.keyCode==13){ // 按 回车
					$('#contentTable').datagrid('endEdit', index);
					$('#addRow').click();
					$('#contentTable').datagrid('selectRow', index).datagrid('editCell', {
		                index: index,
		                field: 'localcreditamount'
		            });
				}
				if(e &amp;&amp; e.keyCode==32){ // 按 空格
					var rows = $('#contentTable').datagrid('getRows');
					for(var i=0;i&lt;rows.length;i++){
						if(i==index&amp;&amp;rows[i].localdebitamount!=0){
							row.localcreditamount = parseFloat(rows[i].localdebitamount);
							row.localdebitamount = 0;
							$('#localdebitamountId').val("");
							$('#contentTable').datagrid('loadData',{"total":rows.length,"rows":rows});
							$('#contentTable').datagrid('selectRow', index).datagrid('editCell', {
				                index: index,
				                field: 'localdebitamount'
				            });
						}else if(i==index&amp;&amp;rows[i].localcreditamount!=0){
							row.localdebitamount = parseFloat(rows[i].localcreditamount);
							row.localcreditamount = 0;
							$('#localdebitamountId').val("");
							$('#contentTable').datagrid('loadData',{"total":rows.length,"rows":rows});
							$('#contentTable').datagrid('selectRow', index).datagrid('editCell', {
				                index: index,
				                field: 'localdebitamount'
				            });
						}
					}
				}
    		}; 
			document.onkeyup=function(event){	
				var e = event || window.event || arguments.callee.caller.arguments[0];
				if(e &amp;&amp; (e.keyCode==187||e.keyCode==229)){ // 按 等号
					var rows = $('#contentTable').datagrid('getRows');
					var debit =0;
					var credit= 0;
					for(var i=0;i&lt;rows.length;i++){
						if(i!=index&amp;&amp;rows[i].localdebitamount!=0){
							debit += parseFloat(rows[i].localdebitamount);
						}
						if(i!=index&amp;&amp;rows[i].localcreditamount!=0){
							credit += parseFloat(rows[i].localcreditamount);
						}
					}
					row.localdebitamount = (credit-debit).toFixed(2);
					$('#localdebitamountId').val((credit-debit).toFixed(2));
				}
	        }; 
    		if(row.localdebitamount==0){
    			$('#localdebitamountId').val("");
    		}
    	}
    	
    	// 贷方
    	ed = $(this).datagrid('getEditor', {
    		index: index,
    		field: 'localcreditamount'
    	});
    	if(ed!=null){
    		document.onkeydown=function(event){
				var e = event || window.event || arguments.callee.caller.arguments[0];
				if(e &amp;&amp; e.keyCode==13){ // 按 回车
					if($('#contentTable').datagrid('getRows').length==index+1){
						$('#addRow').click();
					}
					$('#contentTable').datagrid('endEdit', index);
					$('#contentTable').datagrid('selectRow', index+1).datagrid('editCell', {
		                index: index+1,
		                field: 'explanation'
		            });
				}
				
				if(e &amp;&amp; e.keyCode==32){ // 按 空格
					var rows = $('#contentTable').datagrid('getRows');
					for(var i=0;i&lt;rows.length;i++){
						if(i==index&amp;&amp;rows[i].localdebitamount!=0){
							row.localcreditamount = parseFloat(rows[i].localdebitamount);
							row.localdebitamount = 0;
							$('#localcreditamountId').val("");
							$('#contentTable').datagrid('loadData',{"total":rows.length,"rows":rows});
							$('#contentTable').datagrid('selectRow', index).datagrid('editCell', {
				                index: index,
				                field: 'localcreditamount'
				            });
						}else if(i==index&amp;&amp;rows[i].localcreditamount!=0){
							row.localdebitamount = parseFloat(rows[i].localcreditamount);
							row.localcreditamount = 0;
							$('#localcreditamountId').val("");
							$('#contentTable').datagrid('loadData',{"total":rows.length,"rows":rows});
							$('#contentTable').datagrid('selectRow', index).datagrid('editCell', {
				                index: index,
				                field: 'localcreditamount'
				            });
						}
					}
				}
    		};
			document.onkeyup=function(event){
				var e = event || window.event || arguments.callee.caller.arguments[0];
				if(e &amp;&amp; (e.keyCode==187||e.keyCode==229)){ // 按 等号
					var rows = $('#contentTable').datagrid('getRows');
					var debit =0;
					var credit= 0;
					for(var i=0;i&lt;rows.length;i++){
						if(i!=index&amp;&amp;rows[i].localdebitamount!=0){
							debit += parseFloat(rows[i].localdebitamount);
						}
						if(i!=index&amp;&amp;rows[i].localcreditamount!=0){
							credit += parseFloat(rows[i].localcreditamount);
						}
					}
					row.localcreditamount = (debit-credit).toFixed(2);
					$('#localcreditamountId').val((debit-credit).toFixed(2));
				}
	        }; 
    		if(row.localcreditamount==0){
    			$('#localcreditamountId').val("");
    		}
    	}
    	
	}</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/086206d017400692b15b373cf3bb9889/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">EXCEL 汉字转拼音</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2d917d9bda096dfa0ae08cb5b9caea56/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ADG732: 32通道、串行控制、3.5 Ω、1.8 V至5.5 V/±2.5 V、模拟多路复用器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>