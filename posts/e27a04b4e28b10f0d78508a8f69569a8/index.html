<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>eNSP：mplsvpn综合实验 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="eNSP：mplsvpn综合实验" />
<meta property="og:description" content="&lt;Huawei&gt;sys
[Huawei]sys r1
[r1]int lo0
[r1-LoopBack0]ip add 192.168.1.1 24
[r1-LoopBack0]int g 0/0/0
[r1-GigabitEthernet0/0/0]ip add 192.168.2.1 30
[r1]ip route-static 192.168.3.0 30 192.168.2.2
[r1]ip route-static 192.168.4.0 24 192.168.2.2
[Huawei]sys r2
[r2-GigabitEthernet0/0/1]int g 0/0/0
[r2-GigabitEthernet0/0/0]ip add 23.1.1.1 30
[r2-GigabitEthernet0/0/1]int lo0 [r2-LoopBack0]ip add 2.2.2.2 24
[r2]ospf 1 rout 2.2.2.2
[r2-ospf-1]ar 0
[r2-ospf-1-area-0.0.0.0]net 2.2.2.2 0.0.0.0 [r2-ospf-1-area-0.0.0.0]network 23.1.1.1 0.0.0.0
[r2]mpls lsr-id 2.2.2.2
[r2]mpls
[r2-mpls]mpls ldp
[r2-mpls-ldp]q
[r2]int g 0/0/0
[r2-GigabitEthernet0/0/0]mpls
[r2-GigabitEthernet0/0/0]mpls ldp [r2]ip vpn-instance B1" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e27a04b4e28b10f0d78508a8f69569a8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-15T21:53:25+08:00" />
<meta property="article:modified_time" content="2023-08-15T21:53:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">eNSP：mplsvpn综合实验</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/67/9b/wBrnhA9K_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/55/b5/x1lmLaq4_o.png"> </p> 
<p> </p> 
<p>&lt;Huawei&gt;sys<br> [Huawei]sys r1<br> [r1]int lo0<br> [r1-LoopBack0]ip add 192.168.1.1 24<br> [r1-LoopBack0]int g 0/0/0<br> [r1-GigabitEthernet0/0/0]ip add 192.168.2.1 30</p> 
<p>[r1]ip route-static 192.168.3.0 30 192.168.2.2<br> [r1]ip route-static 192.168.4.0 24 192.168.2.2</p> 
<p>[Huawei]sys r2<br> [r2-GigabitEthernet0/0/1]int g 0/0/0<br> [r2-GigabitEthernet0/0/0]ip add 23.1.1.1 30<br> [r2-GigabitEthernet0/0/1]int lo0 <br> [r2-LoopBack0]ip add 2.2.2.2 24</p> 
<p>[r2]ospf 1 rout 2.2.2.2<br> [r2-ospf-1]ar 0<br> [r2-ospf-1-area-0.0.0.0]net 2.2.2.2 0.0.0.0 <br> [r2-ospf-1-area-0.0.0.0]network 23.1.1.1 0.0.0.0</p> 
<p>[r2]mpls lsr-id 2.2.2.2<br> [r2]mpls<br> [r2-mpls]mpls ldp<br> [r2-mpls-ldp]q<br> [r2]int g 0/0/0<br> [r2-GigabitEthernet0/0/0]mpls<br> [r2-GigabitEthernet0/0/0]mpls ldp </p> 
<p>[r2]ip vpn-instance B1<br> [r2-vpn-instance-B1]ipv4-family <br> [r2-vpn-instance-B1-af-ipv4]route-distinguisher 1:1<br> [r2-vpn-instance-B1-af-ipv4]vpn-target 1:1<br> [r2-vpn-instance-B1-af-ipv4]int g 0/0/1<br> [r2-GigabitEthernet0/0/1]ip binding vpn-instance B1<br> [r2-GigabitEthernet0/0/1]ip add 192.168.2.2 30</p> 
<p>[r2]ip vpn-instance A1<br> [r2-vpn-instance-A1]ipv4-family <br> [r2-vpn-instance-A1-af-ipv4]route-distinguisher 2:2<br> [r2-vpn-instance-A1-af-ipv4]vpn-target 2:2<br> [r2-vpn-instance-A1-af-ipv4]int g 0/0/2<br> [r2-GigabitEthernet0/0/2]ip binding vpn-instance A1<br> [r2-GigabitEthernet0/0/2]ip add 192.168.2.2 30</p> 
<p>[r2]bgp 1<br> [r2-bgp]router-id 2.2.2.2<br> [r2-bgp]peer 4.4.4.4 as-number 1<br> [r2-bgp]peer 4.4.4.4 connect-interface LoopBack 0<br> [r2-bgp]ipv4-family vpnv4<br> [r2-bgp-af-vpnv4]peer 4.4.4.4 enable </p> 
<p>[r2-bgp]peer 4.4.4.4 next-hop-local</p> 
<p>[r2]rip 1 vpn    <br> [r2]rip 1 vpn-instance A1<br> [r2-rip-1]ver 2<br> [r2-rip-1]network 192.168.2.0</p> 
<p>[r2]bgp 1<br> [r2-bgp]ipv4-family vpn-instance A1<br> [r2-bgp-A1]import-route  rip 1</p> 
<p><br> [r2]rip 1 vpn-instance A1<br> [r2-rip-1]import-route bgp</p> 
<p>[r2]ip route-static vpn-instance B1 192.168.1.0 24 192.168.2.1</p> 
<p>[r2]bgp 1    <br> [r2-bgp]ipv4-family vpn-instance B1<br> [r2-bgp-B1]import-route direct <br> [r2-bgp-B1]import-route static </p> 
<p>&lt;Huawei&gt;sys<br> [Huawei]sys r3<br> [r3]int lo0<br> [r3-LoopBack0]ip add 3.3.3.3 24<br> [r3-LoopBack0]int g 0/0/1<br> [r3-GigabitEthernet0/0/1]ip add 23.1.1.2 30<br> [r3-GigabitEthernet0/0/1]int g 0/0/0 <br> [r3-GigabitEthernet0/0/0]ip add 34.1.1.1 30</p> 
<p>[r3]ospf 1 router-id 3.3.3.3<br> [r3-ospf-1]area 0<br> [r3-ospf-1-area-0.0.0.0]network 3.3.3.3 0.0.0.0<br> [r3-ospf-1-area-0.0.0.0]network 23.1.1.2 0.0.0.0<br> [r3-ospf-1-area-0.0.0.0]network 34.1.1.1 0.0.0.0</p> 
<p>[r3]mpls lsr-id 3.3.3.3<br> [r3]mpls<br> [r3-mpls]mpls ldp<br> [r3-mpls-ldp]q<br> [r3]int g  0/0/1<br> [r3-GigabitEthernet0/0/1]mpls<br> [r3-GigabitEthernet0/0/1]mpls ldp <br> [r3-GigabitEthernet0/0/1]int g  0/0/0<br> [r3-GigabitEthernet0/0/0]mpls<br> [r3-GigabitEthernet0/0/0]mpls ldp<br>  </p> 
<p>[Huawei]sys r4<br> [r4]int lo0<br> [r4-LoopBack0]ip add 4.4.4.4 24<br> [r4-LoopBack0]int g 0/0/1<br> [r4-GigabitEthernet0/0/1]ip add 34.1.1.2 30<br> [r4-GigabitEthernet0/0/1]int g 0/0/2<br> [r4-GigabitEthernet0/0/2]ip add 47.1.1.2 30</p> 
<p>[r4]ospf 1 router-id 4.4.4.4<br> [r4-ospf-1]ar 0<br> [r4-ospf-1-area-0.0.0.0]network 34.1.1.2 0.0.0.0<br> [r4-ospf-1-area-0.0.0.0]network 4.4.4.4 0.0.0.0<br> [r4-ospf-1-area-0.0.0.0]network 47.1.1.2 0.0.0.0</p> 
<p>[r4]mpls lsr-id 4.4.4.4<br> [r4]mpls<br> [r4-mpls]mpls ldp<br> [r4-mpls-ldp]q<br> [r4]int g 0/0/1<br> [r4-GigabitEthernet0/0/1]mpls<br> [r4-GigabitEthernet0/0/1]mpls ldp</p> 
<p>[r4]ip vpn-instance B2<br> [r4-vpn-instance-B2]ipv4-family <br> [r4-vpn-instance-B2-af-ipv4]route-distinguisher 1:1<br> [r4-vpn-instance-B2-af-ipv4]vpn-target 1:1<br> [r4-vpn-instance-B2-af-ipv4]int  g 0/0/0<br> [r4-GigabitEthernet0/0/0]ip binding vpn-instance B2<br> [r4-GigabitEthernet0/0/0]ip add 192.168.3.2 30</p> 
<p>[r4]ip vpn-instance A2<br> [r4-vpn-instance-A2]ipv4    <br> [r4-vpn-instance-A2]ipv4-family <br> [r4-vpn-instance-A2-af-ipv4]route-distinguisher 2:2<br> [r4-vpn-instance-A2-af-ipv4]vpn-target 2:2<br> [r4-GigabitEthernet0/0/2]int g 4/0/0<br> [r4-GigabitEthernet4/0/0]ip binding vpn-instance A2<br> [r4-GigabitEthernet4/0/0]ip add 192.168.3.2 30</p> 
<p>[r4]bgp 1<br> [r4-bgp]router-id 4.4.4.4<br> [r4-bgp]peer 2.2.2.2 as-number 1    <br> [r4-bgp]peer 2.2.2.2 connect-interface lo 0<br> [r4-bgp]ipv4-family vpnv4<br> [r4-bgp-af-vpnv4]peer 2.2.2.2 enable </p> 
<p>[r4-bgp]peer 2.2.2.2 next-hop-local</p> 
<p>[r4]ospf 2 vpn-instance A2<br> [r4-ospf-2]ar 1<br> [r4-ospf-2-area-0.0.0.1]network 192.168.3.2 0.0.0.0</p> 
<p>[r4]bgp 1<br> [r4-bgp]ipv4-family vpn-instance A2<br> [r4-bgp-A2]import-route ospf 2</p> 
<p><br> [r4]ospf 2 vpn-instance A2<br> [r4-ospf-2]import-route bgp</p> 
<p>[r4]ip route-static vpn-instance B2 192.168.4.0 24 192.168.3.1</p> 
<p>[r4]bgp 1<br> [r4-bgp]ipv4-family vpn-instance B2<br> [r4-bgp-B2]import-route direct <br> [r4-bgp-B2]import-route static <br>  </p> 
<p>&lt;Huawei&gt;sys<br> [Huawei]sys r5<br> [r5]int lo0<br> [r5-LoopBack0]ip add 192.168.4.1 24<br> [r5-LoopBack0]int g 0/0/0<br> [r5-GigabitEthernet0/0/0]ip add 192.168.3.1 30</p> 
<p>[r5]ip route-static 192.168.2.0 30 192.168.3.2<br> [r5]ip route-static 192.168.1.0 24 192.168.3.2<br>  </p> 
<p>&lt;Huawei&gt;sys<br> [Huawei]sys r6<br> [r6]int lo0<br> [r6-LoopBack0]ip add 192.168.1.1 24<br> [r6-LoopBack0]int g 0/0/0<br> [r6-GigabitEthernet0/0/0]ip add 192.168.2.1 30</p> 
<p>[r6]rip 1<br> [r6-rip-1]version 2    <br> [r6-rip-1]network 192.168.1.0<br> [r6-rip-1]network 192.168.2.0<br>  </p> 
<p>[Huawei]sys r7<br> [r7]int g 0/0/0<br> [r7-GigabitEthernet0/0/0]ip add 47.1.1.1 30<br> [r7-GigabitEthernet0/0/0]int lo0<br> [r7-LoopBack0]ip add 192.168.4.2 24<br> [r7-LoopBack0]int g 0/0/1<br> [r7-GigabitEthernet0/0/1]ip add 192.168.3.1 30</p> 
<p><br> [r7]ospf 2 router-id 7.7.7.7<br> [r7-ospf-2]area 1<br> [r7-ospf-2-area-0.0.0.1]network 192.168.4.2 0.0.0.0<br> [r7-ospf-2-area-0.0.0.1]network 192.168.3.1 0.0.0.0</p> 
<p>[r7]ip  route-static 0.0.0.0 0 47.1.1.2</p> 
<p>[r7]acl 2000<br> [r7-acl-basic-2000]rule permit source 192.168.4.0 0.0.0.255</p> 
<p style="text-align:center;">[r7-GigabitEthernet0/0/0]nat outbound 2000<br><br><img alt="" src="https://images2.imgbox.com/1a/de/UNulQ1Ud_o.png"></p> 
<p style="text-align:center;"> <img alt="" src="https://images2.imgbox.com/29/1e/VlkOnG7c_o.png"></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c585d9918848795ad7a8d5e02d9baec6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">深度学习中，什么是batch-size？如何设置？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f2ba0a03699ffb1b48b21c4ef510780d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">BGP知识</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>