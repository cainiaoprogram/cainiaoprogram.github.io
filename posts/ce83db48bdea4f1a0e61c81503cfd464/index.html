<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HTML5唤起高德地图APP示例 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="HTML5唤起高德地图APP示例" />
<meta property="og:description" content="一、高德地图唤起链接
高德地图APP唤起链接(ios)：
iosamap://path?sourceApplication=&amp;slat=&amp;slon=&amp;sname=&amp;dlat=&amp;dlon=&amp;dname=&amp;dev=&amp;t= 高德地图APP唤起链接(android)：
amapuri://route/plan/?sourceApplication=&amp;slat=&amp;slon=&amp;sname=&amp;dlat=&amp;dlon=&amp;dname=&amp;dev=&amp;t= 高德地图WEB版链接：
https://uri.amap.com/navigation?from=&amp;to=&amp;mode=&amp;policy=&amp;src=&amp;callnative= 二、HTML5唤起高德地图APP示例
实现思路：先用高德地图APP链接尝试唤起APP，如果唤起失败，则打开高德地图WEB版代替，具体代码如下(安全密钥和key需替换成自己的)：
&lt;!doctype html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=&#34;utf-8&#34;&gt; &lt;title&gt;HTML5唤起高德地图APP示例&lt;/title&gt; &lt;meta name=&#34;viewport&#34; content=&#34;initial-scale=1.0, user-scalable=no&#34;&gt; &lt;!-- 高德地图安全密钥，必须在JSAPI脚本加载之前进行设置，否则设置无效。 --&gt; &lt;script type=&#34;text/javascript&#34;&gt; window._AMapSecurityConfig = { securityJsCode:&#39;b*********************d&#39;, } &lt;/script&gt; &lt;script src=&#34;https://webapi.amap.com/maps?v=2.0&amp;key=f**********************25&amp;plugin=AMap.Geolocation&#34; type=&#34;text/javascript&#34;&gt;&lt;/script&gt; &lt;script src=&#34;https://libs.baidu.com/jquery/1.9.0/jquery.min.js&#34;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;script type=&#34;text/javascript&#34;&gt; $(document).ready(function(){ //根据手机系统获取scheme function getScheme(){ let agent = navigator.userAgent.toLowerCase(); if(agent.indexOf(&#34;iphone&#34;) != -1 || agent.indexOf(&#34;ipad&#34;) != -1){ return &#34;iosamap://path&#34;; }else{ return &#34;amapuri://route/plan&#34;; } } //唤起高德地图APP(注意url需要plugin参数) function openAMap(lng, lat, address) { let geolocation = new AMap." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ce83db48bdea4f1a0e61c81503cfd464/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-10T09:12:54+08:00" />
<meta property="article:modified_time" content="2023-03-10T09:12:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">HTML5唤起高德地图APP示例</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <p style=""><span class="kdocs-bold" style="font-weight:bold;">一、高德地图唤起链接</span></p> 
 <p style=""></p> 
 <p style="">高德地图APP唤起链接(ios)：</p> 
 <pre class="kdocs-javascript"><code class="language-javascript">iosamap://path?sourceApplication=&amp;slat=&amp;slon=&amp;sname=&amp;dlat=&amp;dlon=&amp;dname=&amp;dev=&amp;t=</code></pre> 
 <p style="">高德地图APP唤起链接(android)：</p> 
 <pre class="kdocs-javascript"><code class="language-javascript">amapuri://route/plan/?sourceApplication=&amp;slat=&amp;slon=&amp;sname=&amp;dlat=&amp;dlon=&amp;dname=&amp;dev=&amp;t=</code></pre> 
 <p style=""></p> 
 <p style="">高德地图WEB版链接：</p> 
 <pre class="kdocs-javascript"><code class="language-javascript">https://uri.amap.com/navigation?from=&amp;to=&amp;mode=&amp;policy=&amp;src=&amp;callnative=</code></pre> 
 <p style=""><span class="kdocs-bold" style="font-weight:bold;">二、HTML5唤起高德地图APP示例</span></p> 
 <p style=""></p> 
 <p style="">实现思路：先用高德地图APP链接尝试唤起APP，如果唤起失败，则打开高德地图WEB版代替，具体代码如下(安全密钥和key需替换成自己的)：</p> 
 <pre class="kdocs-javascript"><code class="language-javascript">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;HTML5唤起高德地图APP示例&lt;/title&gt;
    &lt;meta name="viewport" content="initial-scale=1.0, user-scalable=no"&gt;
    &lt;!-- 高德地图安全密钥，必须在JSAPI脚本加载之前进行设置，否则设置无效。 --&gt;
    &lt;script type="text/javascript"&gt;
        window._AMapSecurityConfig = {
            securityJsCode:'b*********************d',
        }
    &lt;/script&gt;
    &lt;script src="https://webapi.amap.com/maps?v=2.0&amp;key=f**********************25&amp;plugin=AMap.Geolocation" type="text/javascript"&gt;&lt;/script&gt;
    &lt;script src="https://libs.baidu.com/jquery/1.9.0/jquery.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;script type="text/javascript"&gt;
        $(document).ready(function(){
            //根据手机系统获取scheme
            function getScheme(){
                let agent = navigator.userAgent.toLowerCase();
                if(agent.indexOf("iphone") != -1 || agent.indexOf("ipad") != -1){
                    return "iosamap://path";
                }else{
                    return "amapuri://route/plan";
                }
            }
            //唤起高德地图APP(注意url需要plugin参数)
            function openAMap(lng, lat, address) {
                let geolocation = new AMap.Geolocation();
                geolocation.getCurrentPosition(function(status,result){
                    if(status=="complete"){
                        let app_url = `${getScheme()}?sourceApplication=com.mzwu.www&amp;slat=${result.position.lat}&amp;slon=${result.position.lng}&amp;sname=我的位置&amp;dlat=${lat}&amp;dlon=${lng}&amp;dname=${address}&amp;dev=0&amp;t=0`;
                        let web_url = `https://uri.amap.com/navigation?from=${result.position.lng},${result.position.lat},我的位置&amp;to=${lng},${lat},${address}&amp;mode=car&amp;policy=1&amp;src=com.mzwu.www&amp;callnative=0`;

                        //尝试唤起高德地图App
                        window.location.href = app_url;

                        //唤起失败打开Web高德地图
                        var startTime = Date.now();                            
                        var count = 0;

                        var t = setInterval(function () {
                            if (++count &lt; 30) {
                                return;
                            }
                            if (Date.now() - startTime &gt; 800) {
                                clearInterval(t);
                            }
                            if (!(document.hidden || document.webkitHidden)) {
                                window.location.href = web_url;
                            }
                        }, 20);

                        window.onblur = function () {
                            clearInterval(t);
                        };
                    }else{
                        alert("获取不到定位，请检查手机设置！");
                    }
                });
            }

            openAMap(120.149027,30.255584,'西湖断桥');
        });            
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
 <p style="">高德地图WEB版链接的callnative参数也具有唤起APP的功能，所以可以利用WEB版间接唤起APP，openAMap方法修改如下：</p> 
 <pre class="kdocs-javascript"><code class="language-javascript">function openAMap(lng, lat, address) {
    var geolocation = new AMap.Geolocation();
    geolocation.getCurrentPosition(function(status,result){
        if(status=="complete"){
            let web_url = `https://uri.amap.com/navigation?from=${result.position.lng},${result.position.lat},我的位置&amp;to=${lng},${lat},${address}&amp;mode=car&amp;policy=1&amp;src=com.mzwu.www&amp;callnative=1`;
            window.location.href = web_url;
        }else{
            alert("获取不到定位，请检查手机设置！");
        }
    });
}</code></pre> 
 <p style="">以上方法需要目标地点的经纬度，这里附上经纬度获取方法，key自己去高德官网申请</p> 
 <pre class="kdocs-javascript"><code class="language-javascript">function getLocation(address) {
            let data = {
                key: '8***********************4',
                address: '北京市昌平区'
            };
            $.ajax({
                url: 'https://restapi.amap.com/v3/geocode/geo',
                type: 'get',
                dataType: 'jsonp',
                data,
                success: function (data) {
                    //console.log(data.geocodes[0].location)//获取到的经纬度
                    console.log(data)
                    const locationUrl = data.geocodes[0].location;
                    console.log(locationUrl.split(",")[0])
                    openAMap(locationUrl.split(",")[0] , locationUrl.split(",")[1], address)
                }
            })
        }</code></pre> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c9d86b61db48dfee43c831ce5c36fb2e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue中使用jsp页面问题（vue与iframe相互传值问题）解决，将jsp页面移植到vue项目中的问题解决</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ba52b275e973b76646fd0ab8d8891aa0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">econgnition选择面向对象的样本，输出shp并在arcmap里打开，随机平均分为训练样本和测试样本</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>