<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MyBatis-Plus 还手写 Join 联表查询？一个依赖轻松搞定，真香！ - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MyBatis-Plus 还手写 Join 联表查询？一个依赖轻松搞定，真香！" />
<meta property="og:description" content="点击上方“Java基基”，选择“设为星标”
做积极的人，而不是积极废人！
每天 14:00 更新文章，每天掉亿点点头发...
源码精品专栏
原创 | Java 2021 超神之路，很肝~
中文详细注释的开源项目
RPC 框架 Dubbo 源码解析
网络应用框架 Netty 源码解析
消息中间件 RocketMQ 源码解析
数据库中间件 Sharding-JDBC 和 MyCAT 源码解析
作业调度中间件 Elastic-Job 源码解析
分布式事务中间件 TCC-Transaction 源码解析
Eureka 和 Hystrix 源码解析
Java 并发源码
来源：网络
使用方法
仓库地址
安装
使用
核心类MPJLambdaWrapper和MPJQueryWrapper
MPJLambdaWrapper用法
String形式用法（MPJQueryWrapper）
众所周知，Mybatis Plus 封装的 mapper 不支持 join，如果需要支持就必须自己去实现。但是对于大部分的业务场景来说，都需要多表 join，要不然就没必要采用关系型数据库了。
那么有没有一种不通过硬 SQL 的形式，通过框架提供 join 能力呢？答案是，可以有，今天专门拉出来再说一下，确实能提高不少的开发效率！
使用方法 仓库地址 https://gitee.com/best_handsome/mybatis-plus-join
安装 Maven
&lt;dependency&gt; &lt;groupId&gt;com.github.yulichang&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-join-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.4.4&lt;/version&gt; &lt;/dependency&gt;Gradle" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e7fce00466b1bf64b47c65f36de9d9a9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-15T17:39:25+08:00" />
<meta property="article:modified_time" content="2023-04-15T17:39:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MyBatis-Plus 还手写 Join 联表查询？一个依赖轻松搞定，真香！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p style="text-align:center;">点击上方“Java基基”，选择“设为星标”</p> 
 <p style="text-align:center;">做积极的人，而不是积极废人！</p> 
 <p style="text-align:center;">每天 <strong>14:00</strong> 更新文章，每天掉亿点点头发...</p> 
 <p style="text-align:center;"></p> 
 <p>源码精品专栏</p>  
 <ul><li><p><a href="" rel="nofollow">原创 | Java 2021 超神之路，很肝~</a><br></p></li><li><p><a href="" rel="nofollow">中文详细注释的开源项目</a><br></p></li><li><p><a href="" rel="nofollow">RPC 框架 Dubbo 源码解析</a></p></li><li><p><a href="" rel="nofollow">网络应用框架 Netty 源码解析</a></p></li><li><p><a href="" rel="nofollow">消息中间件 RocketMQ 源码解析</a><br></p></li><li><p><a href="" rel="nofollow">数据库中间件 Sharding-JDBC 和 MyCAT 源码解析</a></p></li><li><p><a href="" rel="nofollow">作业调度中间件 Elastic-Job 源码解析</a></p></li><li><p><a href="" rel="nofollow">分布式事务中间件 TCC-Transaction 源码解析</a></p></li><li><p><a href="" rel="nofollow">Eureka 和 Hystrix 源码解析</a></p></li><li><p><a href="" rel="nofollow">Java 并发源码</a></p></li></ul> 
 <p style="text-align:right;"><a href="" rel="nofollow">来源：网络</a></p> 
 <ul><li><p><a href="" rel="nofollow">使用方法</a></p> 
   <ul><li><p><a href="" rel="nofollow">仓库地址</a></p></li><li><p><a href="" rel="nofollow">安装</a></p></li><li><p><a href="" rel="nofollow">使用</a></p></li></ul></li><li><p><a href="" rel="nofollow">核心类MPJLambdaWrapper和MPJQueryWrapper</a></p> 
   <ul><li><p><a href="" rel="nofollow">MPJLambdaWrapper用法</a></p></li><li><p><a href="" rel="nofollow">String形式用法（MPJQueryWrapper）</a></p></li></ul></li></ul> 
 <p><a href="" rel="nofollow"><img src="https://images2.imgbox.com/6b/62/D2Lezlfb_o.jpg" alt="245cbb9cf9bef8c83d695a64c09f7c8f.jpeg"></a></p> 
 <hr> 
 <p>众所周知，Mybatis Plus 封装的 mapper 不支持 join，如果需要支持就必须自己去实现。但是对于大部分的业务场景来说，都需要多表 join，要不然就没必要采用关系型数据库了。</p> 
 <p>那么有没有一种不通过硬 SQL 的形式，通过框架提供 join 能力呢？答案是，可以有，今天专门拉出来再说一下，确实能提高不少的开发效率！</p> 
 <h3><a href="" rel="nofollow">使用方法</a></h3> 
 <h4><a href="" rel="nofollow">仓库地址</a></h4> 
 <p>https://gitee.com/best_handsome/mybatis-plus-join</p> 
 <h4><a href="" rel="nofollow">安装</a></h4> 
 <ul><li><p>Maven</p><pre class="has"><code class="language-go">&lt;dependency&gt;
    &lt;groupId&gt;com.github.yulichang&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-plus-join-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;1.4.4&lt;/version&gt;
&lt;/dependency&gt;</code></pre></li><li><p>Gradle</p><pre class="has"><code class="language-go">implementation 'com.github.yulichang:mybatis-plus-join-boot-starter:1.4.4'</code></pre></li></ul> 
 <p>或者 clone 代码到本地执行 mvn install，再引入以上依赖。</p> 
 <p>注意：mybatis plus version &gt;= 3.4.0。</p> 
 <h4><a href="" rel="nofollow">使用</a></h4> 
 <ul><li><p>mapper继承MPJBaseMapper (必选)</p></li><li><p>service继承MPJBaseService (可选)</p></li><li><p>serviceImpl继承MPJBaseServiceImpl (可选)</p></li></ul> 
 <blockquote> 
  <p>基于 Spring Boot + MyBatis Plus + Vue &amp; Element 实现的后台管理系统 + 用户小程序，支持 RBAC 动态权限、多租户、数据权限、工作流、三方登录、支付、短信、商城等功能</p> 
  <ul><li><p>项目地址：https://github.com/YunaiV/ruoyi-vue-pro</p></li><li><p>视频教程：https://doc.iocoder.cn/video/</p></li></ul> 
 </blockquote> 
 <h3><a href="" rel="nofollow">核心类MPJLambdaWrapper和MPJQueryWrapper</a></h3> 
 <h4><a href="" rel="nofollow">MPJLambdaWrapper用法</a></h4> 
 <h5><a href="" rel="nofollow">简单的三表查询</a></h5> 
 <pre class="has"><code class="language-go">class test {
    @Resource
    private UserMapper userMapper;

    void testJoin() {
        //和Mybatis plus一致，MPJLambdaWrapper的泛型必须是主表的泛型，并且要用主表的Mapper来调用
        MPJLambdaWrapper&lt;UserDO&gt; wrapper = new MPJLambdaWrapper&lt;UserDO&gt;()
                .selectAll(UserDO.class)//查询user表全部字段
                .select(UserAddressDO::getTel)//查询user_address tel 字段
                .selectAs(UserAddressDO::getAddress, UserDTO::getUserAddress)//别名 t.address AS userAddress
                .select(AreaDO::getProvince, AreaDO::getCity)
                .leftJoin(UserAddressDO.class, UserAddressDO::getUserId, UserDO::getId)
                .leftJoin(AreaDO.class, AreaDO::getId, UserAddressDO::getAreaId)
                .eq(UserDO::getId, 1)
                .like(UserAddressDO::getTel, "1")
                .gt(UserDO::getId, 5);

        //连表查询 返回自定义ResultType
        List&lt;UserDTO&gt; list = userMapper.selectJoinList(UserDTO.class, wrapper);

        //分页查询 （需要启用 mybatis plus 分页插件）
        Page&lt;UserDTO&gt; listPage = userMapper.selectJoinPage(new Page&lt;&gt;(2, 10), UserDTO.class, wrapper);
    }
}</code></pre> 
 <p>对应sql</p> 
 <pre class="has"><code class="language-go">SELECT  
    t.id, t.name, t.sex, t.head_img, 
    t1.tel, t1.address AS userAddress,
    t2.province, t2.city 
FROM 
    user t 
    LEFT JOIN user_address t1 ON t1.user_id = t.id 
    LEFT JOIN area t2 ON t2.id = t1.area_id 
WHERE (
    t.id = ? 
    AND t1.tel LIKE ? 
    AND t.id &gt; ?)</code></pre> 
 <p>说明:</p> 
 <ul><li><p>UserDTO.class 查询结果返回类(resultType)</p></li><li><p>selectAll() 查询指定实体类的全部字段</p></li><li><p>select() 查询指定的字段,支持可变参数,同一个select只能查询相同表的字段</p></li><li><p>selectAs() 字段别名查询,用于数据库字段与业务实体类属性名不一致时使用</p></li><li><p>leftJoin() 参数说明；第一个参数: 参与连表的实体类class 第二个参数: 连表的ON字段,这个属性必须是第一个参数实体类的属性 第三个参数: 参与连表的ON的另一个实体类属性</p></li><li><p>默认主表别名是t,其他的表别名以先后调用的顺序使用t1,t2,t3....</p></li><li><p>条件查询,可以查询主表以及参与连接的所有表的字段,全部调用mp原生的方法,正常使用没有sql注入风险</p></li></ul> 
 <p>MPJLambdaWrapper 还有很多其他的功能</p> 
 <ul><li><p>简单的SQL函数使用：<code>https://gitee.com/best_handsome/mybatis-plus-join/wikis/selectFunc()?sort_id=4082479</code></p></li><li><p>ON语句多条件支持：<code>https://gitee.com/best_handsome/mybatis-plus-join/wikis/leftJoin?sort_id=3496671</code></p></li></ul> 
 <p>等效于ResultMap</p> 
 <pre class="has"><code class="language-go">&lt;resultMap id="xxxxxxxx" type="com.github.yulichang.join.dto.UserDTO"&gt;
    &lt;result property="id" column="id"/&gt;
    &lt;result property="name" column="name"/&gt;
    &lt;!--其他属性省略--&gt;
    &lt;collection property="addressList" javaType="java.util.List"
                ofType="com.github.yulichang.join.entity.UserAddressDO"&gt;
        &lt;id property="id" column="mpj_id"/&gt;
        &lt;result property="address" column="address"/&gt;
        &lt;result property="userId" column="user_id"/&gt;
        &lt;!--其他属性省略--&gt;
    &lt;/collection&gt;
&lt;/resultMap&gt;</code></pre> 
 <p>MPJLambdaWrapper其他功能</p> 
 <ul><li><p>一对一，一对多使用：https://ylctmh.com/pages/core/lambda/select/selectCollection.html</p></li><li><p>简单的SQL函数使用：https://ylctmh.com/pages/core/lambda/select/selectFunc.html</p></li><li><p>ON语句多条件支持：https://ylctmh.com/pages/core/lambda/join/leftJoin.html</p></li></ul> 
 <h4><a href="" rel="nofollow">String形式用法（MPJQueryWrapper）</a></h4> 
 <h5><a href="" rel="nofollow">简单的连表查询</a></h5> 
 <pre class="has"><code class="language-go">class test {
    @Resource
    private UserMapper userMapper;

    void testJoin() {
        MPJQueryWrapper wrapper = new MPJQueryWrapper&lt;UserDO&gt;()
                .selectAll(UserDO.class)
                .select("addr.tel", "addr.address", "a.province")
                .leftJoin("user_address addr on t.id = addr.user_id")
                .rightJoin("area a on addr.area_id = a.id")
                .like("addr.tel", "1")
                .le("a.province", "1");

        //列表查询
        List&lt;UserDTO&gt; list = userMapper.selectJoinList(UserDTO.class, wrapper);

        //分页查询 （需要启用 mybatis plus 分页插件）
        Page&lt;UserDTO&gt; listPage = userMapper.selectJoinPage(new Page&lt;&gt;(1, 10), UserDTO.class, wrapper);
    }
}</code></pre> 
 <p>对应sql</p> 
 <pre class="has"><code class="language-go">SELECT 
    t.id,
    t.name,
    t.sex,
    t.head_img,
    addr.tel,
    addr.address,
    a.province
FROM 
    user t
    LEFT JOIN user_address addr on t.id = addr.user_id
    RIGHT JOIN area a on addr.area_id = a.id
WHERE (
    addr.tel LIKE ?
    AND a.province &lt;= ?)</code></pre> 
 <p>说明:</p> 
 <ul><li><p>UserDTO.class 查询结果类(resultType)</p></li><li><p>selectAll(UserDO.class) 查询主表全部字段(主表实体类)默认主表别名 "t"</p></li><li><p>select() mp的select策略是覆盖,以最后一次为准,这里的策略是追加,可以一直select 主表字段可以用lambda,会自动添加表别名,主表别名默认是 t ,非主表字段必须带别名查询</p></li><li><p>leftJoin() rightJoin() innerJoin() 传sql片段 格式 (表 + 别名 + 关联条件)</p></li><li><p>条件查询,可以查询主表以及参与连接的所有表的字段,全部调用mp原生的方法,正常使用没有sql注入风险</p></li></ul> 
 <h5><a href="" rel="nofollow">还可以这么操作,但不建议</a></h5> 
 <pre class="has"><code class="language-go">class test {
    @Resource
    private UserMapper userMapper;

    void testJoin() {
        List&lt;UserDTO&gt; list = userMapper.selectJoinList(UserDTO.class,
                new MPJQueryWrapper&lt;UserDO&gt;()
                        .selectAll(UserDO.class)
                        .select("addr.tel", "addr.address")
                        //行列转换
                        .select("CASE t.sex WHEN '男' THEN '1' ELSE '0' END AS sex")
                        //求和函数
                        .select("sum(a.province) AS province")
                        //自定义数据集
                        .leftJoin("(select * from user_address) addr on t.id = addr.user_id")
                        .rightJoin("area a on addr.area_id = a.id")
                        .like("addr.tel", "1")
                        .le("a.province", "1")
                        .orderByDesc("addr.id"));
    }
}</code></pre> 
 <p>对应sql</p> 
 <pre class="has"><code class="language-go">SELECT 
    t.id,
    t.name,
    t.sex,
    t.head_img,
    addr.tel,
    addr.address,
    CASE t.sex WHEN '男' THEN '1' ELSE '0' END AS sex,
    sum(a.province) AS province
FROM 
    user t
    LEFT JOIN (select * from user_address) addr on t.id = addr.user_id
    RIGHT JOIN area a on addr.area_id = a.id
WHERE (
    addr.tel LIKE ?
    AND a.province &lt;= ?)
ORDER BY
    addr.id DESC</code></pre> 
 <p>这样，我们就能和使用 Mybatis Plus 一样进行表关联操作了！</p> 
 <hr> 
 <hr> 
 <p>欢迎加入我的知识星球，一起探讨架构，交流源码。加入方式，<strong>长按下方二维码噢</strong>：<br></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/d8/c9/Y2wAz4vg_o.png" alt="1778b93f9ac922f67af41ea3f8b40193.png"></p> 
 <p style="text-align:left;">已在知识星球更新源码解析如下：<br></p> 
 <p style="text-align:center;"><a href="" rel="nofollow"><img src="https://images2.imgbox.com/9a/bd/1GvDWiIy_o.jpg" alt="7f0c16a1f4d9262d120c3daf431fd5a8.jpeg"></a></p> 
 <p style="text-align:center;"><a href="" rel="nofollow"><img src="https://images2.imgbox.com/5f/78/20IZa5qS_o.jpg" alt="021367fde9e55ed46a43f5f17edfeae5.jpeg"></a></p> 
 <p style="text-align:center;"><a href="" rel="nofollow"><img src="https://images2.imgbox.com/09/be/f9GScOIx_o.jpg" alt="074a35d88e1f165690e4d1ed187f6872.jpeg"></a></p> 
 <p style="text-align:center;"><a href="" rel="nofollow"><img src="https://images2.imgbox.com/26/9c/DCpjYe1o_o.jpg" alt="b6aa1c65fd2013da6417b1e633e2fb05.jpeg"></a></p> 
 <p>最近更新《芋道 SpringBoot 2.X 入门》系列，已经 101 余篇，覆盖了 MyBatis、Redis、MongoDB、ES、分库分表、读写分离、SpringMVC、Webflux、权限、WebSocket、Dubbo、RabbitMQ、RocketMQ、Kafka、性能测试等等内容。<br></p> 
 <p>提供近 3W 行代码的 SpringBoot 示例，以及超 6W 行代码的电商微服务项目。</p> 
 <p>获取方式：点“<strong>在看</strong>”，关注公众号并回复 <strong>666</strong> 领取，更多内容陆续奉上。</p> 
 <pre class="has"><code class="language-go">文章有帮助的话，在看，转发吧。
谢谢支持哟 (*^__^*）</code></pre> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6643b5c87855130ab340ec6bfc05ac1e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Centos7部署torch环境 配合pyCharm远程调试开发</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/351fa0134434f4a66d17576e1cee9d13/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ssh链接 git@github.com: Permission denied (publickey).</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>