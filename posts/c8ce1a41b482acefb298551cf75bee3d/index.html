<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HCIA基础（4） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="HCIA基础（4）" />
<meta property="og:description" content="目录
交换技术
VLAN---虚拟局域网
VLAN的基本原理
VLAN帧格式 VLAN的类型
端口类型
VLAN的配置
VLAN之间的通讯
三层交换机的SVI接口
ACL技术---访问控制列表
ACL原理
ACL功能
ACL的匹配规则
ACL分类
NAT技术---网络地址转换
NAT的分类
静态NAT
动态NAT
NAPT
园区网组网 什么是园区网
园区网络分类
园区网络的构成 园区网的发展历程
交换技术 垃圾流浪问题 安全问题
VLAN---虚拟局域网 VLAN技术通过在交换机上配置VLAN机制，将一个大的交换网络在逻辑上划分成多个小的交换网 络。 VLAN的基本原理 VLAN帧格式 VLAN的类型 基于端口的VLAN---一层VLAN
在接口进行配置，将VLAN编号映射到交换机物理接口
该接口进入的帧都将被认为是该VLAN
最常用的方法
基于MAC地址的VLAN---二层VLAN
配置一个vlan和mac地址的映射关系，当数据帧进入交换机时，交换机会查询该映射关系表，根据不同的源mac地址来划分不同的vlan
一般用于pc接入交换机的端口会发送变化的情况
基于协议的VLAN---三层VLAN
根据帧中的不同协议来划分
端口类型 Access端口 一般用于交换机与终端设备相连的接口 假设此时有一个Access端口，其VID为2，从这个端口进入的数据包，都会被规划到vlan2，而 从这个端口发出的vlan则必须是vlan2的数据包，并且删除vlan的字段Trunk端口 一般用于交换机与交换机相连的接口Hybrid端口 同时具备Access和Trunk端口的功能，是一种工作机制及其灵活的端口 VLAN的配置 第一步，在交换机上创建VLAN
配置命令
[sw1]vlan 2-----创建vlan2；默认情况下交换机存在vlan1，并且所有接口属于vlan1
VID
取值范围0-4095；其中，0和4095保留不能使用，可使用范围是1-4094
VLAN ID：用来标识和区分VLAN
[sw1]vlan batch 4 10 20 ----同时批量的创建vlan4、10、20
[sw1]vlan batch 30 to 60 ---同时批量的创建vlan30到vlan60" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c8ce1a41b482acefb298551cf75bee3d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-26T18:13:25+08:00" />
<meta property="article:modified_time" content="2022-10-26T18:13:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">HCIA基础（4）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%BA%A4%E6%8D%A2%E6%8A%80%E6%9C%AF-toc" style="margin-left:0px;"><a href="#%E4%BA%A4%E6%8D%A2%E6%8A%80%E6%9C%AF" rel="nofollow">交换技术</a></p> 
<p id="VLAN---%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91-toc" style="margin-left:0px;"><a href="#VLAN---%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91" rel="nofollow">VLAN---虚拟局域网</a></p> 
<p id="VLAN%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86-toc" style="margin-left:40px;"><a href="#VLAN%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86" rel="nofollow">VLAN的基本原理</a></p> 
<p id="VLAN%E5%B8%A7%E6%A0%BC%E5%BC%8F%C2%A0-toc" style="margin-left:40px;"><a href="#VLAN%E5%B8%A7%E6%A0%BC%E5%BC%8F%C2%A0" rel="nofollow">VLAN帧格式 </a></p> 
<p id="VLAN%E7%9A%84%E7%B1%BB%E5%9E%8B-toc" style="margin-left:40px;"><a href="#VLAN%E7%9A%84%E7%B1%BB%E5%9E%8B" rel="nofollow">VLAN的类型</a></p> 
<p id="%E7%AB%AF%E5%8F%A3%E7%B1%BB%E5%9E%8B-toc" style="margin-left:40px;"><a href="#%E7%AB%AF%E5%8F%A3%E7%B1%BB%E5%9E%8B" rel="nofollow">端口类型</a></p> 
<p id="VLAN%E7%9A%84%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px;"><a href="#VLAN%E7%9A%84%E9%85%8D%E7%BD%AE" rel="nofollow">VLAN的配置</a></p> 
<p id="VLAN%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E8%AE%AF-toc" style="margin-left:40px;"><a href="#VLAN%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E8%AE%AF" rel="nofollow">VLAN之间的通讯</a></p> 
<p id="%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84SVI%E6%8E%A5%E5%8F%A3-toc" style="margin-left:40px;"><a href="#%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84SVI%E6%8E%A5%E5%8F%A3" rel="nofollow">三层交换机的SVI接口</a></p> 
<p id="ACL%E6%8A%80%E6%9C%AF---%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8-toc" style="margin-left:0px;"><a href="#ACL%E6%8A%80%E6%9C%AF---%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8" rel="nofollow">ACL技术---访问控制列表</a></p> 
<p id="ACL%E5%8E%9F%E7%90%86-toc" style="margin-left:40px;"><a href="#ACL%E5%8E%9F%E7%90%86" rel="nofollow">ACL原理</a></p> 
<p id="ACL%E5%8A%9F%E8%83%BD-toc" style="margin-left:40px;"><a href="#ACL%E5%8A%9F%E8%83%BD" rel="nofollow">ACL功能</a></p> 
<p id="ACL%E7%9A%84%E5%8C%B9%E9%85%8D%E8%A7%84%E5%88%99-toc" style="margin-left:40px;"><a href="#ACL%E7%9A%84%E5%8C%B9%E9%85%8D%E8%A7%84%E5%88%99" rel="nofollow">ACL的匹配规则</a></p> 
<p id="ACL%E5%88%86%E7%B1%BB-toc" style="margin-left:40px;"><a href="#ACL%E5%88%86%E7%B1%BB" rel="nofollow">ACL分类</a></p> 
<p id="NAT%E6%8A%80%E6%9C%AF---%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2-toc" style="margin-left:0px;"><a href="#NAT%E6%8A%80%E6%9C%AF---%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2" rel="nofollow">NAT技术---网络地址转换</a></p> 
<p id="NAT%E7%9A%84%E5%88%86%E7%B1%BB-toc" style="margin-left:40px;"><a href="#NAT%E7%9A%84%E5%88%86%E7%B1%BB" rel="nofollow">NAT的分类</a></p> 
<p id="%E9%9D%99%E6%80%81NAT-toc" style="margin-left:80px;"><a href="#%E9%9D%99%E6%80%81NAT" rel="nofollow">静态NAT</a></p> 
<p id="%E5%8A%A8%E6%80%81NAT-toc" style="margin-left:80px;"><a href="#%E5%8A%A8%E6%80%81NAT" rel="nofollow">动态NAT</a></p> 
<p id="NAPT-toc" style="margin-left:80px;"><a href="#NAPT" rel="nofollow">NAPT</a></p> 
<p id="%E5%9B%AD%E5%8C%BA%E7%BD%91%E7%BB%84%E7%BD%91%C2%A0-toc" style="margin-left:0px;"><a href="#%E5%9B%AD%E5%8C%BA%E7%BD%91%E7%BB%84%E7%BD%91%C2%A0" rel="nofollow">园区网组网 </a></p> 
<p id="%C2%A0%E4%BB%80%E4%B9%88%E6%98%AF%E5%9B%AD%E5%8C%BA%E7%BD%91-toc" style="margin-left:40px;"><a href="#%C2%A0%E4%BB%80%E4%B9%88%E6%98%AF%E5%9B%AD%E5%8C%BA%E7%BD%91" rel="nofollow"> 什么是园区网</a></p> 
<p id="%C2%A0%E5%9B%AD%E5%8C%BA%E7%BD%91%E7%BB%9C%E5%88%86%E7%B1%BB-toc" style="margin-left:40px;"><a href="#%C2%A0%E5%9B%AD%E5%8C%BA%E7%BD%91%E7%BB%9C%E5%88%86%E7%B1%BB" rel="nofollow"> 园区网络分类</a></p> 
<p id="%E5%9B%AD%E5%8C%BA%E7%BD%91%E7%BB%9C%E7%9A%84%E6%9E%84%E6%88%90%C2%A0-toc" style="margin-left:40px;"><a href="#%E5%9B%AD%E5%8C%BA%E7%BD%91%E7%BB%9C%E7%9A%84%E6%9E%84%E6%88%90%C2%A0" rel="nofollow">园区网络的构成 </a></p> 
<p id="%C2%A0%E5%9B%AD%E5%8C%BA%E7%BD%91%E7%9A%84%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B-toc" style="margin-left:40px;"><a href="#%C2%A0%E5%9B%AD%E5%8C%BA%E7%BD%91%E7%9A%84%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B" rel="nofollow"> 园区网的发展历程</a></p> 
<hr id="hr-toc"> 
<h2>交换技术</h2> 
<p><img alt="" height="592" src="https://images2.imgbox.com/ad/b1/Y9R6kCL1_o.png" width="927"></p> 
<ul><li> <p>垃圾流浪问题 </p> </li><li> <p>安全问题</p> </li></ul> 
<h2 id="VLAN---%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91">VLAN---虚拟局域网</h2> 
<ul><li> VLAN技术通过在交换机上配置VLAN机制，将一个大的交换网络在逻辑上划分成多个小的交换网 络。</li></ul> 
<h3 id="VLAN%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86">VLAN的基本原理</h3> 
<p><img alt="" height="664" src="https://images2.imgbox.com/bb/41/t4eVV4Sk_o.png" width="927"></p> 
<p></p> 
<p> <img alt="" height="447" src="https://images2.imgbox.com/e8/2d/q13KWMKE_o.png" width="927"></p> 
<h3 id="VLAN%E5%B8%A7%E6%A0%BC%E5%BC%8F%C2%A0">VLAN帧格式 </h3> 
<p><img alt="" height="339" src="https://images2.imgbox.com/37/c9/iYVKBMLe_o.png" width="807"></p> 
<h3 id="VLAN%E7%9A%84%E7%B1%BB%E5%9E%8B">VLAN的类型</h3> 
<ul><li> <p>基于端口的VLAN---一层VLAN</p> 
  <ul><li> <p>在接口进行配置，将VLAN编号映射到交换机物理接口</p> </li><li> <p>该接口进入的帧都将被认为是该VLAN</p> </li><li> <p><strong>最常用的方法</strong></p> </li></ul></li><li> <p>基于MAC地址的VLAN---二层VLAN</p> 
  <ul><li> <p>配置一个vlan和mac地址的映射关系，当数据帧进入交换机时，交换机会查询该映射关系表，根据不同的源mac地址来划分不同的vlan</p> </li><li> <p><strong>一般用于pc接入交换机的端口会发送变化的情况</strong></p> </li></ul></li><li> <p>基于协议的VLAN---三层VLAN</p> 
  <ul><li> <p>根据帧中的不同协议来划分</p> </li></ul></li></ul> 
<h3 id="%E7%AB%AF%E5%8F%A3%E7%B1%BB%E5%9E%8B">端口类型</h3> 
<ul><li>Access端口 
  <ul><li>一般用于交换机与终端设备相连的接口 假设此时有一个Access端口，其VID为2，从这个端口进入的数据包，都会被规划到vlan2，而 从这个端口发出的vlan则必须是vlan2的数据包，并且删除vlan的字段</li></ul></li><li>Trunk端口 
  <ul><li>一般用于交换机与交换机相连的接口</li></ul></li><li>Hybrid端口 
  <ul><li>同时具备Access和Trunk端口的功能，是一种工作机制及其灵活的端口</li></ul></li></ul> 
<p></p> 
<h3 id="VLAN%E7%9A%84%E9%85%8D%E7%BD%AE">VLAN的配置</h3> 
<p><img alt="" height="553" src="https://images2.imgbox.com/39/c4/kxx1UZln_o.png" width="927"></p> 
<ul><li> <p>第一步，在交换机上创建VLAN</p> 
  <ul><li> <p>配置命令</p> 
    <ul><li> <p>[sw1]vlan 2-----创建vlan2；默认情况下交换机存在vlan1，并且所有接口属于vlan1</p> </li><li> <p>VID</p> 
      <ul><li> <p>取值范围0-4095；其中，0和4095保留不能使用，可使用范围是1-4094</p> </li><li> <p>VLAN ID：用来标识和区分VLAN</p> </li></ul></li><li> <p>[sw1]vlan batch 4 10 20 ----同时批量的创建vlan4、10、20</p> </li><li> <p>[sw1]vlan batch 30 to 60 ---同时批量的创建vlan30到vlan60</p> </li></ul></li></ul></li><li> <p>第二步，将接口划入VLAN</p> </li></ul> 
<blockquote> 
 <p>[sw1]interface GigabitEthernet 0/0/1 //进入接口</p> 
 <p>[sw1-GigabitEthernet0/0/1]port link-type access //将接口类型更改为access</p> 
 <p>[sw1-GigabitEthernet0/0/1]port default vlan 2 //将接口划分给vlan 2</p> 
</blockquote> 
<blockquote> 
 <p>[sw1]display vlan summary //查看vlan简表</p> 
 <p>[sw1]display vlan //查看vlan表 </p> 
</blockquote> 
<p><img alt="" height="555" src="https://images2.imgbox.com/1d/0d/l5NqC0zp_o.png" width="927"></p> 
<ul><li> <p>第三步，配置Trunk干道</p> 
  <ul><li> <p>配置位置，交换机与交换机相连的接口</p> </li><li> <p>配置命令</p> </li><li> 
    <blockquote> 
     <p>[sw1]interface GigabitEthernet 0/0/3    //进入与其他交换机相连的接口</p> 
     <p>[sw1-GigabitEthernet0/0/3]port link-type trunk    //修改接口类型为 trunk</p> 
     <p>[sw1-GigabitEthernet0/0/3]port trunk allow-pass vlan 2 3      //在trunk 的允许通过列表中加入vlan2和vlan3 注意：不再trunk的允许列表中的vlan不允许通过该接口，并且，trunk的配置是双向的。</p> 
     <p>[sw1-GigabitEthernet0/0/3]port trunk allow-pass vlan all      //代表放通 所有vlan</p> 
    </blockquote> </li></ul></li></ul> 
<h3 id="VLAN%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E8%AE%AF">VLAN之间的通讯</h3> 
<ul><li> <p>多臂路由实现VLAN间的通讯</p> </li><li> <p>单臂路由实现VLAN间的通讯</p> 
  <ul><li> <p>单臂路由就是通过对路由器的物理接口划分<strong>子接口</strong>的方式进行数据转发</p> </li><li> <p>子接口是基于路由器以太网接口所创建的逻辑接口，以物理接口ID+子接口ID进行标识，子接 口具备同物理接口一样的三层路由转发功能</p> </li><li> <p>子接口不同于物理接口，子接口可以处理携带VLAN Tag的数据帧</p> 
    <ul><li> <p>当收到携带与自己相同属性的VLAN Tag的数据包时，将剥离该标签</p> </li><li> <p>当需要发送一个数据时，则会将自己所属的VLAN Tag加入到该数据包中</p> </li><li> <p>基于一个物理接口所创建的子接口，可以有多个。该物理接口所连接的交换机的Trunk 接口，需要放通多个VLAN</p> </li></ul></li></ul></li></ul> 
<p><img alt="" height="664" src="https://images2.imgbox.com/90/51/R6nrXivg_o.png" width="833"></p> 
<ul><li> 配置 
  <ul><li>第四步，针对于三层设备</li></ul></li></ul> 
<blockquote> 
 <p>[r1]interface GigabitEthernet 0/0/0.1      //创建子接口</p> 
 <p>[r1-GigabitEthernet0/0/0.1]ip address 192.168.1.254 24      //配置网关IP 地址</p> 
 <p>[r1-GigabitEthernet0/0/0.1]dot1q termination vid 2      //开启路由器子接口 处理vlan标签的功能，并定义其处理的vlan为2，默认不开启</p> 
 <p>[r1-GigabitEthernet0/0/0.1]arp broadcast enable      //开启子接口的ARP功 能，因为我们的PC在第一次通讯的时候需要请求网关的MAC地址，而子接口（虚拟接口）默认 不进行ARP应答。</p> 
</blockquote> 
<ul><li> <p>三层交换机（具备路由功能的交换机）实现VLAN间的通</p> </li></ul> 
<p></p> 
<h3 id="%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84SVI%E6%8E%A5%E5%8F%A3">三层交换机的SVI接口</h3> 
<ul><li> <p>二层交换机指的是仅具备二层交换机功能的交换机</p> </li><li> <p>三层交换机，除了具备二层交换机所有功能外，还支持三层接口实现路由转发的功能</p> </li></ul> 
<p><img alt="" height="513" src="https://images2.imgbox.com/46/09/vOPhrLxJ_o.png" width="708"></p> 
<ul><li> <p>三层交换机对于vlan数据包的通讯经过了四个接口</p> </li><li> <p>VLANif接口是一种三层逻辑接口，支持VLAN Tag的剥离和添加草做，因此可以通过VLANif接口实现VLAN间通讯</p> </li><li> <p>子接口与SVI接口对比</p> 
  <ul><li> <p>子接口本身并不具备对标签的处理功能，而SVI接口具备</p> </li><li> <p>子接口本身通讯需要开启ARP功能，而SVI接口不需要</p> </li></ul></li><li> <p>VLANif接口编号与所对应的VLAN ID相同</p> </li></ul> 
<p><img alt="" height="699" src="https://images2.imgbox.com/06/66/zDm5CuZg_o.png" width="927"></p> 
<blockquote> 
 <p>[sw3]vlan batch 2 3 //创建vlan</p> 
 <p>[sw3-GigabitEthernet0/0/1]port link-type trunk</p> 
 <p>[sw3-GigabitEthernet0/0/1]port trunk allow-pass vlan 2 3</p> 
 <p></p> 
 <p>[sw3]interface Vlanif 2 //创建VLANif接口，且编号为2.该接口可以处理vlan2的标签。</p> 
 <p>[sw3-Vlanif2]ip address 192.168.1.254 24</p> 
</blockquote> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/65/29/rp7AWygL_o.png" width="927"><img alt="" height="864" src="https://images2.imgbox.com/7c/09/3G4mVOTl_o.png" width="927"></p> 
<h2 id="ACL%E6%8A%80%E6%9C%AF---%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8">ACL技术---访问控制列表</h2> 
<ul><li> <p>网络安全</p> </li><li> <p>网络管理---SNMP协议</p> </li></ul> 
<h3 id="ACL%E5%8E%9F%E7%90%86">ACL原理</h3> 
<ul><li> <p>设置了ACL的网络设备会根据事先设定好的报文进行匹配，然后对报文执行预先设定好的处理动作</p> </li><li> <p>ACL是一张表，就是一系列规则的集合</p> </li></ul> 
<h3 id="ACL%E5%8A%9F%E8%83%BD">ACL功能</h3> 
<ul><li> <p>访问控制：在设备的流入或流出接口上，匹配流量，然后执行设定动作 </p> 
  <ul><li> <p>流量的流入或者流出是一个相对的概念</p> </li><li> <p>动作</p> 
    <ul><li> <p>permit----允许</p> </li><li> <p>deny---拒绝</p> </li></ul></li></ul></li><li> <p>抓取流量</p> 
  <ul><li> <p>因为ACL经常与其他协议共同使用，所以ACL一般只做匹配流量的作用，而对应的动作由其他 协议完成。</p> </li><li> <p>路由策略、策略路由、防火墙、QoS技术</p> </li></ul></li></ul> 
<h3 id="ACL%E7%9A%84%E5%8C%B9%E9%85%8D%E8%A7%84%E5%88%99">ACL的匹配规则</h3> 
<ul><li> <p>自上而下，逐一匹配</p> 
  <ul><li> <p>匹配上按照该规则进行执行，不再向下匹配</p> </li><li> <p>未匹配上，则执行默认规则</p> 
    <ul><li> <p>在思科设备上，ACL访问控制列表的最后隐含条件：<strong>拒绝所有规则</strong></p> </li><li> <p>在华为设备上，ACL访问控制列表的最后隐含条件：<strong>允许所有规则</strong></p> </li></ul></li></ul></li></ul> 
<h3 id="ACL%E5%88%86%E7%B1%BB">ACL分类</h3> 
<ul><li> <p><strong>基本ACL</strong></p> 
  <ul><li> <p>只能基于IP报文的源IP地址、报文分片标记和时间段信息来定义规则</p> </li><li> <p>编号：2000-2999（用于区分不同的列表）</p> </li></ul></li><li> <p><strong>高级ACL</strong></p> 
  <ul><li> <p>可以基于IP报文的源目IP地址、源目端口号、协议字段、IP报文优先级、报文长度等信息来定义规则</p> </li><li> <p>编号：3000-3999</p> </li></ul></li><li> <p>二层ACL</p> 
  <ul><li> <p>使用报文的以太网帧头信息来定义规则</p> </li><li> <p>编号：4000-4999</p> </li></ul></li><li> <p>用户自定义ACL</p> 
  <ul><li> <p>即可以使用IPV4报文的IP地址，也可以使用目的IP地址、协议类型</p> </li><li> <p>编号：5000-5999</p> </li></ul></li></ul> 
<p><img alt="" height="497" src="https://images2.imgbox.com/42/72/Tg5X8WLl_o.png" width="927"></p> 
<ul><li><strong> 需求一</strong>：PC1可以访问192.168.2.0网段，而PC2不行</li><li>分析结果 
  <ul><li>仅对源有要求，配置基本ACL即可。</li></ul></li><li>基本ACL配置位置 
  <ul><li>由于基本ACL仅关注数据包中的源IP地址，故配置时需尽量靠近目标，避免对其他地址访问误 伤；</li><li>假设此时，在R1上配置，那么它不仅仅是无法到达192.168.2.0网段，其余网段也不可以</li></ul></li><li>配置</li></ul> 
<blockquote> 
 <p>[r2]acl 2000         //创建基本acl列表</p> 
 <p>[r2-acl-basic-2000]rule deny source 192.168.1.2 0.0.0.0         //配置规则，拒绝 源IP地址为192.168.1.2的地址通过</p> 
 <p>0.0.0.0这个字符串---&gt;通配符（0代表不可变，1代表可变）</p> 
 <p></p> 
 <p>[r2-acl-basic-2000]rule 8 permit source any             //允许所有 该数字是规则的序列号，华为默认步长为5，如果未指定规则的序列号，则每条规则都是从前 一条规则的序列号+5得出，方便后期在任意两条规则中间加入或者删除规则。</p> 
 <p></p> 
 <p>[r2-GigabitEthernet0/0/1]traffic-filter outbound acl 2000         //在0/0/1接口 调用ACL2000，且方向为出方向。        一个接口的一个方向只能调用一张ACL列表；但是一张ACL列表可以在不同的地方多次调用。</p> 
 <p></p> 
 <p>[r2]display acl 2000 //查看ACL列表 [r2-acl-basic-2000]undo rule 8 //删除已存在的ACL规则</p> 
</blockquote> 
<ul><li> <p><strong>需求二</strong>：要求PC1可以访问PC3，但不能访问PC4</p> 
  <ul><li> <p>分析：对目标有要求，需要使用高级ACL技术</p> </li><li> <p>高级ACL的配置位置</p> 
    <ul><li> <p>由于高级ACL对流量进行了精准匹配，可以避免误伤，所以调用时应当尽量靠近源，减少链路资源的占用</p> </li></ul></li><li> <p>配置</p> 
    <ul><li> 
      <blockquote> 
       <p>[r1]acl 3100       //创建高级ACL列表</p> 
       <p>[r1-acl-adv-3100]rule 5 deny ip source 192.168.1.1 0 destination 192.168.2.2 0                                                   //设置检测IP报文的源目地址</p> 
       <p>[r1-GigabitEthernet0/0/1]traffic-filter inbound acl 3100      //调用</p> 
      </blockquote> </li></ul></li></ul></li><li><strong>需求三</strong>：要求PC1可以ping通R2，但是不能telnet R2 </li></ul> 
<p><img alt="" height="483" src="https://images2.imgbox.com/24/4f/jocMdl4n_o.png" width="927"></p> 
<ul><li>分析 
  <ul><li>需求中包含telnet，也就是涉及了TCP或UDP的端口。使用高级ACL</li></ul></li><li>配置 </li></ul> 
<blockquote> 
 <p>[r1]acl 3000</p> 
 <p>[r1-acl-adv-3000]rule deny tcp source 192.168.1.1 0 destination 2.2.2.2 0 destin ation-port eq 23                   //拒绝TCP协议，源为192.168.1.1 目的1.1.1.1，端口号为23的数据流量</p> 
 <p></p> 
 <p>[r1-acl-adv-3000]rule 10 deny tcp source 192.168.1.1 0 destination 2.2.2.2 0 des tination-port eq telnet                     //两种方式二选一</p> 
 <p></p> 
 <p>[r1-GigabitEthernet0/0/1]traffic-filter inbound acl 3000                            //调用</p> 
</blockquote> 
<h2 id="NAT%E6%8A%80%E6%9C%AF---%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2">NAT技术---网络地址转换</h2> 
<p><img alt="" height="277" src="https://images2.imgbox.com/50/3c/LcQJSJSC_o.png" width="927"> </p> 
<ul><li> <p>NAT一般用于内网的出口路由器或者防火墙上</p> </li><li> <p>NAT技术，对于从内到外的流量，设备会通过NAT将数据包的源地址进行转换（转换成特定的公网 地址）；而对于从外到内的流量，则对数据包的目的地址进行转换</p> </li></ul> 
<h3 id="NAT%E7%9A%84%E5%88%86%E7%B1%BB">NAT的分类</h3> 
<ul><li> <h4 id="%E9%9D%99%E6%80%81NAT">静态NAT</h4> 
  <ul><li> <p>在边界路由器上建立并维护了一张静态地址映射表。表中记录了公有IP地址和私有IP地址之间 的对应关系。</p> </li><li> <p>静态NAT是一个一对一的NAT</p> </li><li> <p>工作过程</p> 
    <ul><li> <p>当内网数据包来到边界路由器上，会先检查其目的IP地址是不是公网IP地址。</p> </li><li> <p>如果是公网地址，则会根据事先配置好的静态地址映射表查找该源IP对应的公网IP地 址。</p> 
      <ul><li> <p>如果有记录，则将源IP地址转换为对应的公网IP地址，然后将数据包转发至公网。</p> </li><li> <p>若没有记录，则丢弃数据包。</p> </li></ul></li><li> <p>如果是私网地址，则根据自身路由表向内网进行转发。</p> </li></ul></li><li> <p>配置</p> </li></ul></li></ul> 
<p><img alt="" height="397" src="https://images2.imgbox.com/31/bf/wE8djMiY_o.png" width="786"></p> 
<blockquote> 
 <p> [r1-GigabitEthernet0/0/0]nat static global 12.1.1.10 inside 192.168.1.1</p> 
 <p>公网地址：12.1.1.10；私网地址：192.168.1.1；</p> 
 <p>注意：不允许使用出接口地址作为公网转换IP地址（NAT地址）</p> 
 <p>需要使用漂浮IP：12.1.1.10</p> 
 <p>          必须与出接口地址处于同一网段</p> 
 <p>          并且这个IP地址是从运营商买来的合法的公网IP地址</p> 
 <p>[r1]display nat static //查询静态地址映射表</p> 
</blockquote> 
<ul><li> <h4 id="%E5%8A%A8%E6%80%81NAT">动态NAT</h4> 
  <ul><li>动态NAT技术的地址映射表内容可变。</li><li>一对多、多对多</li></ul></li><li>动态NAT在同时间内，还是一个公网IP对应一个私网IP。 
  <ul><li>也就是说，当上一个流量回来后，下一个流量才能转换IP地址并转发数据。 </li></ul></li></ul> 
<p><img alt="" height="583" src="https://images2.imgbox.com/de/85/YZkPGhjv_o.png" width="833"> </p> 
<ul><li> 配置 </li></ul> 
<blockquote> 
 <p>[r1]nat address-group 1 12.1.1.10 12.1.1.15           //配置公网IP组</p> 
 <p>                必须是真实购买的IP地址</p> 
 <p>                必须是连续的</p> 
 <p>                与出接口IP处于同网段，且非出接口IP地址</p> 
 <p>[r1]acl 2000 [r1-acl-basic-2000]rule permit source 192.168.1.1 0         //抓取PC1流量</p> 
 <p>[r1-acl-basic-2000]rule permit source 192.168.1.2 0         //抓取PC2流量</p> 
 <p>[r1-GigabitEthernet0/0/0]nat outbound 2000 address-group 1 no-pat         //将ACL与公网IP组进行绑定</p> 
 <p>               no-pat：只能进行IP地址转换，而不进行端口转换</p> 
 <p>[r1]display nat address-group 1 </p> 
</blockquote> 
<ul><li> <h4 id="NAPT">NAPT</h4> 
  <ul><li>网络地址端口转换技术</li><li>是在路由器上维护一张源端口号和私网IP地址的映射关系表 
    <ul><li>1-65535</li></ul></li><li>EASY IP-----华为私有技术---一对多的NAPT 
    <ul><li>使用的公网地址池是边界路由器的出接口IP地址</li></ul></li><li>配置命令 </li></ul></li></ul> 
<blockquote> 
 <p>[r1-acl-basic-2000]rule permit source 192.168.1.0 0.0.0.255                 //抓取流量</p> 
 <p>[r1-GigabitEthernet0/0/0]nat outbound 2000                 //接口调用</p> 
 <p></p> 
 <p>[r1]display nat outbound                 //查看NAT配置信息 </p> 
</blockquote> 
<ul><li>端口映射（服务映射） 
  <ul><li>将企业内部的服务器映射到公网，供外部人员访问</li><li>配置 </li></ul></li></ul> 
<blockquote> 
 <p>[r1-GigabitEthernet0/0/0]nat server protocol tcp global current-interface 23 inside 192.168.1.100 telnet</p> 
 <p></p> 
 <p>[r1-GigabitEthernet0/0/0]nat server protocol tcp global currentinterface 8888 inside 192.168.1.100 telne </p> 
</blockquote> 
<h2 id="%E5%9B%AD%E5%8C%BA%E7%BD%91%E7%BB%84%E7%BD%91%C2%A0">园区网组网 </h2> 
<ul><li>园区网：我们在生活与工作的园区内使用的网络 </li></ul> 
<p><img alt="" height="452" src="https://images2.imgbox.com/6d/30/WopyihVN_o.png" width="927"></p> 
<h3 id="%C2%A0%E4%BB%80%E4%B9%88%E6%98%AF%E5%9B%AD%E5%8C%BA%E7%BD%91"> 什么是园区网</h3> 
<ul><li>IEEE802.3标准、IEEE802.11标准</li></ul> 
<h3 id="%C2%A0%E5%9B%AD%E5%8C%BA%E7%BD%91%E7%BB%9C%E5%88%86%E7%B1%BB"> 园区网络分类</h3> 
<p><strong>从规模分</strong></p> 
<ul><li>按照终端用户数量或者网元（网络中的设备）来分 
  <ul><li>大型园区网：终端超过2000或者网元超过100</li><li>中型园区网：终端在200-2000或者网元在25-100之间</li><li>小型园区网：终端小于200或者网元小于25</li></ul></li></ul> 
<p><strong>从服务对象分</strong></p> 
<ul><li>封闭园区网</li><li>开放园区网</li></ul> 
<p><strong>从承载业务分</strong></p> 
<ul><li>单业务园区网</li><li>多业务园区网</li></ul> 
<p><strong>从接入方式分</strong></p> 
<ul><li>有线园区网</li><li>无线园区网</li></ul> 
<p><strong>从不同行业分</strong></p> 
<ul><li>企业园区网络</li><li>校园网</li><li>商业园区网</li><li>政府园区网</li></ul> 
<h3 id="%E5%9B%AD%E5%8C%BA%E7%BD%91%E7%BB%9C%E7%9A%84%E6%9E%84%E6%88%90%C2%A0">园区网络的构成 </h3> 
<p><img alt="" height="879" src="https://images2.imgbox.com/60/13/zpLRB4eG_o.png" width="927"> </p> 
<h3 id="%C2%A0%E5%9B%AD%E5%8C%BA%E7%BD%91%E7%9A%84%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B"> 园区网的发展历程</h3> 
<ul><li>第一代园区网 
  <ul><li>早期使用集线器，园区网被分成多个局域网，局域网之间使用路由器</li><li>二层交换机--&gt;解决了冲突---&gt;BD广播域太大</li></ul></li><li>第二代园区网 
  <ul><li>万维网、即时通讯</li><li>三层交换机（路由式交换机）---&gt;三层架构（核心层、汇聚层、接入层）组网方式</li><li>802.3u（快速以太网）---&gt;100Mbps ; 802.3ab(吉比特以太网)---&gt;1Gbps 
    <ul><li>淘汰了同样具备竞争力的ATM技术</li><li>以太网带宽的发展超过了园区网络业务需求的发展</li><li>SNMP（简单网络管理协议）</li></ul></li></ul></li><li>第三代园区网 
  <ul><li>2007年---&gt;智能移动终端的元年</li><li>引入wifi网络 
    <ul><li>需求不足</li><li>安全威胁 
      <ul><li>NAC（思科网络准入控制系统）</li></ul></li><li>传统网络架构不利于wifi部署 
      <ul><li>早期wifi部署，是对有线网络的延伸，直接挂载胖AP（提供射频信号、认证、管理 等）</li><li>WAC-AP部署模式 
        <ul><li>瘦AP（仅具备提供射频信号功能）</li><li>所有的管理统一由WAC（无线接入控制器）进行管理</li></ul></li></ul></li></ul></li><li>华为推出“敏捷园区网络”</li></ul></li><li>第四代园区网</li></ul> 
<p><img alt="" height="431" src="https://images2.imgbox.com/93/c8/0zA5l1iG_o.png" width="927"> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/882769778b92669ee218e24cec2352f2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">shp文件和geojson实现互转</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fccef2edfaca88ffc9e47faf840b7639/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux系统部署多个tomcat</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>