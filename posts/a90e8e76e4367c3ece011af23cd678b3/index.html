<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ajax轮询jsp,AJAX&#43;JSP实现基于WEB的文件上传的进度控制.doc - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ajax轮询jsp,AJAX&#43;JSP实现基于WEB的文件上传的进度控制.doc" />
<meta property="og:description" content="AJAX&#43;JSP实现基于WEB的文件上传的进度控制.doc
1.引言
2.实现代码
2.1.服务器端代码
2.1.1. 文件上传状态类(FileUploadStatus)
2.1.2. 文件上传状态侦听类(FileUploadListener)
2.1.3. 后台服务类(BackGroundService)
2.1.4. 文件上传状态控制类(BeanControler)
2.2. 客户端代码
2.2.1. AjaxWrapper.js
2.2.2. fileUpload.html
2.2.3. result.jsp
2.2.4. fileUpload.css
2.3. 配置文件
3. 结语 ?1.?引言
基于浏览器的文件上传，特别是对于通过标签来实现上传的情况， 存在着严重的性能问题，因为用户提交了文件之后，在浏览器把文件上传到服务器的过程中，界面看上去似乎是静止的，如果是小文件还好些，如果不幸需要上传的是几兆、几十兆甚至上百兆的文件，我相信那是一种非常痛苦的体验，我们中间的很多人应该都有过此种不堪的经历。(一笑)
现在我就针对这个问题给出一个解决方案，我们将实现一个具有监控能力的WEB上传的程序——它不仅把文件上传到服务器，而且&#34;实时地&#34;监视文件上传的实际过程。
解决方案的基本思路是这样的：
在Form提交上传文件同时，使用AJAX周期性地从Servlet轮询上传状态信息
然后，根据此信息更新进度条和相关文字，及时反映文件传输状态
如果用户取消上传操作，则进行相应的现场清理工作：删除已经上传的文件，在Form提交页面中显示相关信息
如果上传完毕，显示已经上传的文件内容(或链接)
在介绍源代码之前，我们先来看看程序运行界面：
?2.?实现代码
实现代码想当然的有服务器端代码和客户端代码(呵呵)，我们先从服务器端开始。
?2.1.?服务器端代码
??2.1.1.?文件上传状态类(FileUploadStatus)
使用FileUploadStatus这个类记录文件上传状态，并将其作为服务器端与web客户端之间通信的媒介，通过对这个类对象提供上传状态作为服务器回应发送给web客户端， web客户端使用JavaScript获得文件上传状态。源代码如下：
/**
* 本例程演示了通过Web上传文件过程中的进度显示。您可以对本例程进行任何修改和使用。
* 如果需要转载本例程，请您注明作者。
*
* 作者： 刘作晨
* EMail:liuzuochen@
*/
package liuzuochen.sample.upload;
import java.util.*;
public class FileUploadStatus {
//上传用户地址
private String uploadAddr;
//上传总量
private long uploadTotalSize = 0;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a90e8e76e4367c3ece011af23cd678b3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-05T17:19:15+08:00" />
<meta property="article:modified_time" content="2021-08-05T17:19:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ajax轮询jsp,AJAX&#43;JSP实现基于WEB的文件上传的进度控制.doc</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>AJAX+JSP实现基于WEB的文件上传的进度控制.doc</p> 
 <p>1.引言</p> 
 <p>2.实现代码</p> 
 <p>2.1.服务器端代码</p> 
 <p>2.1.1. 文件上传状态类(FileUploadStatus)</p> 
 <p>2.1.2. 文件上传状态侦听类(FileUploadListener)</p> 
 <p>2.1.3. 后台服务类(BackGroundService)</p> 
 <p>2.1.4. 文件上传状态控制类(BeanControler)</p> 
 <p>2.2. 客户端代码</p> 
 <p>2.2.1. AjaxWrapper.js</p> 
 <p>2.2.2. fileUpload.html</p> 
 <p>2.2.3. result.jsp</p> 
 <p>2.2.4. fileUpload.css</p> 
 <p>2.3. 配置文件</p> 
 <p>3. 结语 ?1.?引言</p> 
 <p>基于浏览器的文件上传，特别是对于通过标签来实现上传的情况， 存在着严重的性能问题，因为用户提交了文件之后，在浏览器把文件上传到服务器的过程中，界面看上去似乎是静止的，如果是小文件还好些，如果不幸需要上传的是几兆、几十兆甚至上百兆的文件，我相信那是一种非常痛苦的体验，我们中间的很多人应该都有过此种不堪的经历。(一笑)</p> 
 <p>现在我就针对这个问题给出一个解决方案，我们将实现一个具有监控能力的WEB上传的程序——它不仅把文件上传到服务器，而且"实时地"监视文件上传的实际过程。</p> 
 <p>解决方案的基本思路是这样的：</p> 
 <p>在Form提交上传文件同时，使用AJAX周期性地从Servlet轮询上传状态信息</p> 
 <p>然后，根据此信息更新进度条和相关文字，及时反映文件传输状态</p> 
 <p>如果用户取消上传操作，则进行相应的现场清理工作：删除已经上传的文件，在Form提交页面中显示相关信息</p> 
 <p>如果上传完毕，显示已经上传的文件内容(或链接)</p> 
 <p>在介绍源代码之前，我们先来看看程序运行界面：</p> 
 <p>?2.?实现代码</p> 
 <p>实现代码想当然的有服务器端代码和客户端代码(呵呵)，我们先从服务器端开始。</p> 
 <p>?2.1.?服务器端代码</p> 
 <p>??2.1.1.?文件上传状态类(FileUploadStatus)</p> 
 <p>使用FileUploadStatus这个类记录文件上传状态，并将其作为服务器端与web客户端之间通信的媒介，通过对这个类对象提供上传状态作为服务器回应发送给web客户端， web客户端使用JavaScript获得文件上传状态。源代码如下：</p> 
 <p>/**</p> 
 <p>* 本例程演示了通过Web上传文件过程中的进度显示。您可以对本例程进行任何修改和使用。</p> 
 <p>* 如果需要转载本例程，请您注明作者。</p> 
 <p>*</p> 
 <p>* 作者： 刘作晨</p> 
 <p>* EMail:liuzuochen@</p> 
 <p>*/</p> 
 <p>package liuzuochen.sample.upload;</p> 
 <p>import java.util.*;</p> 
 <p>public class FileUploadStatus {<!-- --></p> 
 <p>//上传用户地址</p> 
 <p>private String uploadAddr;</p> 
 <p>//上传总量</p> 
 <p>private long uploadTotalSize = 0;</p> 
 <p>//读取上传总量</p> 
 <p>private long readTotalSize = 0;</p> 
 <p>//当前上传文件号</p> 
 <p>private int currentUploadFileNum = 0;</p> 
 <p>//成功读取上传文件数</p> 
 <p>private int successUploadFileCount = 0;</p> 
 <p>//状态</p> 
 <p>private String status = "";</p> 
 <p>//处理起始时间</p> 
 <p>private long processStartTime = 0l;</p> 
 <p>//处理终止时间</p> 
 <p>private long processEndTime = 0l;</p> 
 <p>//处理执行时间</p> 
 <p>private long processRunningTime = 0l;</p> 
 <p>//上传文件URL列表</p> 
 <p>private List uploadFileUrlList = new ArrayList();</p> 
 <p>//取消上传</p> 
 <p>private boolean cancel = false;</p> 
 <p>//上传base目录</p> 
 <p>private String baseDir = "";</p> 
 <p>public FileUploadStatus() {<!-- --></p> 
 <p>}</p> 
 <p>public String getBaseDir() {<!-- --></p> 
 <p>return baseDir;</p> 
 <p>}</p> 
 <p>public void setBaseDir(String baseDir) {<!-- --></p> 
 <p>this.baseDir = baseDir;</p> 
 <p>}</p> 
 <p>public boolean getCance</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/34c3cd6b946f690a2fbfcfc5752b6d40/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">spring mvc ajax 提交,SpringMVC的Ajax提交</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ea3be2eeef8f297ffc4d027b997826e4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">用ajax实现行置顶,[置顶] Ajax实战篇</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>