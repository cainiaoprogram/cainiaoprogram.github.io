<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CS224n_2019_Assignment1: Exploring Word Vectors Coding Solution - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CS224n_2019_Assignment1: Exploring Word Vectors Coding Solution" />
<meta property="og:description" content="A1不難，當熱身作業。
Word Vectors Part 1: Count-Based Word Vectors (10 points) Co-Occurrence Question 1.1: Implement distinct_words [code] (2 points) def distinct_words(corpus): &#34;&#34;&#34; Determine a list of distinct words for the corpus. Params: corpus (list of list of strings): corpus of documents Return: corpus_words (list of strings): list of distinct words across the corpus, sorted (using python &#39;sorted&#39; function) num_corpus_words (integer): number of distinct words across the corpus &#34;&#34;&#34; corpus_words = [] num_corpus_words = -1 # ------------------ # Write your implementation here." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3bd6fc83b619a986a36f72434667633e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-11-26T20:19:45+08:00" />
<meta property="article:modified_time" content="2019-11-26T20:19:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CS224n_2019_Assignment1: Exploring Word Vectors Coding Solution</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>A1不難，當熱身作業。</p> 
<h3><a id="Word_Vectors_5"></a>Word Vectors</h3> 
<h3><a id="Part_1_CountBased_Word_Vectors_10_points_7"></a>Part 1: Count-Based Word Vectors (10 points)</h3> 
<h4><a id="CoOccurrence_11"></a>Co-Occurrence</h4> 
<h4><a id="Question_11_Implement_distinct_words_code_2_points_12"></a>Question 1.1: Implement <code>distinct_words</code> [code] (2 points)</h4> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">distinct_words</span><span class="token punctuation">(</span>corpus<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" Determine a list of distinct words for the corpus.
        Params:
            corpus (list of list of strings): corpus of documents
        Return:
            corpus_words (list of strings): list of distinct words across the corpus, sorted (using python 'sorted' function)
            num_corpus_words (integer): number of distinct words across the corpus
    """</span>
    corpus_words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    num_corpus_words <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
    
    <span class="token comment"># ------------------</span>
    <span class="token comment"># Write your implementation here.</span>
    
    corpus_words <span class="token operator">=</span> <span class="token punctuation">[</span>word <span class="token keyword">for</span> corpus_list <span class="token keyword">in</span> corpus <span class="token keyword">for</span> word <span class="token keyword">in</span> corpus_list<span class="token punctuation">]</span>  <span class="token comment">#[if word not in corpus_words] can replace set()</span>
    corpus_words <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>corpus_words<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   
    num_corpus_words <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>corpus_words<span class="token punctuation">)</span>
    
    <span class="token comment"># ------------------</span>

    <span class="token keyword">return</span> corpus_words<span class="token punctuation">,</span> num_corpus_words
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># ---------------------</span>
<span class="token comment"># Run this sanity check</span>
<span class="token comment"># Note that this not an exhaustive check for correctness.</span>
<span class="token comment"># ---------------------</span>

<span class="token comment"># Define toy corpus</span>
test_corpus <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"START All that glitters isn't gold END"</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"START All's well that ends well END"</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
test_corpus_words<span class="token punctuation">,</span> num_corpus_words <span class="token operator">=</span> distinct_words<span class="token punctuation">(</span>test_corpus<span class="token punctuation">)</span>

<span class="token comment"># Correct answers</span>
ans_test_corpus_words <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"START"</span><span class="token punctuation">,</span> <span class="token string">"All"</span><span class="token punctuation">,</span> <span class="token string">"ends"</span><span class="token punctuation">,</span> <span class="token string">"that"</span><span class="token punctuation">,</span> <span class="token string">"gold"</span><span class="token punctuation">,</span> <span class="token string">"All's"</span><span class="token punctuation">,</span> <span class="token string">"glitters"</span><span class="token punctuation">,</span> <span class="token string">"isn't"</span><span class="token punctuation">,</span> <span class="token string">"well"</span><span class="token punctuation">,</span> <span class="token string">"END"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ans_num_corpus_words <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ans_test_corpus_words<span class="token punctuation">)</span>

<span class="token comment"># Test correct number of words</span>
<span class="token keyword">assert</span><span class="token punctuation">(</span>num_corpus_words <span class="token operator">==</span> ans_num_corpus_words<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Incorrect number of distinct words. Correct: {}. Yours: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ans_num_corpus_words<span class="token punctuation">,</span> num_corpus_words<span class="token punctuation">)</span>

<span class="token comment"># Test correct words</span>
<span class="token keyword">assert</span> <span class="token punctuation">(</span>test_corpus_words <span class="token operator">==</span> ans_test_corpus_words<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Incorrect corpus_words.\nCorrect: {}\nYours:   {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ans_test_corpus_words<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>test_corpus_words<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Print Success</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Passed All Tests!"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">80</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>--------------------------------------------------------------------------------
Passed All Tests!
--------------------------------------------------------------------------------
</code></pre> 
<h4><a id="Question_12_Implement_compute_co_occurrence_matrix_code_3_points_73"></a>Question 1.2: Implement <code>compute_co_occurrence_matrix</code> [code] (3 points)</h4> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">compute_co_occurrence_matrix</span><span class="token punctuation">(</span>corpus<span class="token punctuation">,</span> window_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" Compute co-occurrence matrix for the given corpus and window_size (default of 4).
    
        Note: Each word in a document should be at the center of a window. Words near edges will have a smaller
              number of co-occurring words.
              
              For example, if we take the document "START All that glitters is not gold END" with window size of 4,
              "All" will co-occur with "START", "that", "glitters", "is", and "not".
    
        Params:
            corpus (list of list of strings): corpus of documents
            window_size (int): size of context window
        Return:
            M (numpy matrix of shape (number of corpus words, number of corpus words)): 
                Co-occurence matrix of word counts. 
                The ordering of the words in the rows/columns should be the same as the ordering of the words given by the distinct_words function.
            word2Ind (dict): dictionary that maps word to index (i.e. row/column number) for matrix M.
    """</span>
    words<span class="token punctuation">,</span> num_words <span class="token operator">=</span> distinct_words<span class="token punctuation">(</span>corpus<span class="token punctuation">)</span>
    M <span class="token operator">=</span> <span class="token boolean">None</span>
    word2Ind <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    
    <span class="token comment"># ------------------</span>
    <span class="token comment"># Write your implementation here.</span>
    
    M <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>num_words<span class="token punctuation">,</span> num_words<span class="token punctuation">)</span><span class="token punctuation">)</span>
    word2Ind <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>word<span class="token punctuation">:</span> index <span class="token keyword">for</span> index<span class="token punctuation">,</span> word <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span><span class="token punctuation">}</span>
    
    <span class="token keyword">for</span> list_of_word <span class="token keyword">in</span> corpus<span class="token punctuation">:</span>
        <span class="token keyword">for</span> i<span class="token punctuation">,</span>word <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>list_of_word<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>i<span class="token operator">-</span>window_size<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">:</span>
                M<span class="token punctuation">[</span>word2Ind<span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">,</span> word2Ind<span class="token punctuation">[</span>list_of_word<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span>window_size<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_of_word<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                M<span class="token punctuation">[</span>word2Ind<span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">,</span> word2Ind<span class="token punctuation">[</span>list_of_word<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
                
    <span class="token comment"># ------------------</span>

    <span class="token keyword">return</span> M<span class="token punctuation">,</span> word2Ind
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># ---------------------</span>
<span class="token comment"># Run this sanity check</span>
<span class="token comment"># Note that this is not an exhaustive check for correctness.</span>
<span class="token comment"># ---------------------</span>

<span class="token comment"># Define toy corpus and get student's co-occurrence matrix</span>
test_corpus <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"START All that glitters isn't gold END"</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"START All's well that ends well END"</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
M_test<span class="token punctuation">,</span> word2Ind_test <span class="token operator">=</span> compute_co_occurrence_matrix<span class="token punctuation">(</span>test_corpus<span class="token punctuation">,</span> window_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> 

<span class="token comment"># Correct M and word2Ind</span>
M_test_ans <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span> 
    <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>
word2Ind_ans <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'All'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"All's"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'END'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'START'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'ends'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'glitters'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'gold'</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"isn't"</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'that'</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'well'</span><span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">}</span>

<span class="token comment"># Test correct word2Ind</span>
<span class="token keyword">assert</span> <span class="token punctuation">(</span>word2Ind_ans <span class="token operator">==</span> word2Ind_test<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Your word2Ind is incorrect:\nCorrect: {}\nYours: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>word2Ind_ans<span class="token punctuation">,</span> word2Ind_test<span class="token punctuation">)</span>

<span class="token comment"># Test correct M shape</span>
<span class="token keyword">assert</span> <span class="token punctuation">(</span>M_test<span class="token punctuation">.</span>shape <span class="token operator">==</span> M_test_ans<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"M matrix has incorrect shape.\nCorrect: {}\nYours: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>M_test<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> M_test_ans<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

<span class="token comment"># Test correct M values</span>
<span class="token keyword">for</span> w1 <span class="token keyword">in</span> word2Ind_ans<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx1 <span class="token operator">=</span> word2Ind_ans<span class="token punctuation">[</span>w1<span class="token punctuation">]</span>
    <span class="token keyword">for</span> w2 <span class="token keyword">in</span> word2Ind_ans<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        idx2 <span class="token operator">=</span> word2Ind_ans<span class="token punctuation">[</span>w2<span class="token punctuation">]</span>
        student <span class="token operator">=</span> M_test<span class="token punctuation">[</span>idx1<span class="token punctuation">,</span> idx2<span class="token punctuation">]</span>
        correct <span class="token operator">=</span> M_test_ans<span class="token punctuation">[</span>idx1<span class="token punctuation">,</span> idx2<span class="token punctuation">]</span>
        <span class="token keyword">if</span> student <span class="token operator">!=</span> correct<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Correct M:"</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>M_test_ans<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Your M: "</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>M_test<span class="token punctuation">)</span>
            <span class="token keyword">raise</span> AssertionError<span class="token punctuation">(</span><span class="token string">"Incorrect count at index ({}, {})=({}, {}) in matrix M. Yours has {} but should have {}."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>idx1<span class="token punctuation">,</span> idx2<span class="token punctuation">,</span> w1<span class="token punctuation">,</span> w2<span class="token punctuation">,</span> student<span class="token punctuation">,</span> correct<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Print Success</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Passed All Tests!"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">80</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>--------------------------------------------------------------------------------
Passed All Tests!
--------------------------------------------------------------------------------
</code></pre> 
<h4><a id="Question_13_Implement_reduce_to_k_dim_code_1_point_176"></a>Question 1.3: Implement <code>reduce_to_k_dim</code> [code] (1 point)</h4> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">reduce_to_k_dim</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" Reduce a co-occurence count matrix of dimensionality (num_corpus_words, num_corpus_words)
        to a matrix of dimensionality (num_corpus_words, k) using the following SVD function from Scikit-Learn:
            - http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.TruncatedSVD.html
    
        Params:
            M (numpy matrix of shape (number of corpus words, number of corpus words)): co-occurence matrix of word counts
            k (int): embedding size of each word after dimension reduction
        Return:
            M_reduced (numpy matrix of shape (number of corpus words, k)): matrix of k-dimensioal word embeddings.
                    In terms of the SVD from math class, this actually returns U * S
    """</span>    
    n_iters <span class="token operator">=</span> <span class="token number">10</span>     <span class="token comment"># Use this parameter in your call to `TruncatedSVD`</span>
    M_reduced <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Running Truncated SVD over %i words..."</span> <span class="token operator">%</span> <span class="token punctuation">(</span>M<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
        <span class="token comment"># ------------------</span>
        <span class="token comment"># Write your implementation here.</span>
        
    svd <span class="token operator">=</span> TruncatedSVD<span class="token punctuation">(</span>n_components<span class="token operator">=</span>k<span class="token punctuation">,</span> n_iter<span class="token operator">=</span>n_iters<span class="token punctuation">)</span>
    M_reduced <span class="token operator">=</span> svd<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
    
        <span class="token comment"># ------------------</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Done."</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> M_reduced
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># ---------------------</span>
<span class="token comment"># Run this sanity check</span>
<span class="token comment"># Note that this not an exhaustive check for correctness </span>
<span class="token comment"># In fact we only check that your M_reduced has the right dimensions.</span>
<span class="token comment"># ---------------------</span>

<span class="token comment"># Define toy corpus and run student code</span>
test_corpus <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"START All that glitters isn't gold END"</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"START All's well that ends well END"</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
M_test<span class="token punctuation">,</span> word2Ind_test <span class="token operator">=</span> compute_co_occurrence_matrix<span class="token punctuation">(</span>test_corpus<span class="token punctuation">,</span> window_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
M_test_reduced <span class="token operator">=</span> reduce_to_k_dim<span class="token punctuation">(</span>M_test<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># Test proper dimensions</span>
<span class="token keyword">assert</span> <span class="token punctuation">(</span>M_test_reduced<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"M_reduced has {} rows; should have {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>M_test_reduced<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token punctuation">(</span>M_test_reduced<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"M_reduced has {} columns; should have {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>M_test_reduced<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># Print Success</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Passed All Tests!"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">80</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>Running Truncated SVD over 10 words...
Done.
--------------------------------------------------------------------------------
Passed All Tests!
--------------------------------------------------------------------------------
</code></pre> 
<h4><a id="Question_14_Implement_plot_embeddings_code_1_point_237"></a>Question 1.4: Implement <code>plot_embeddings</code> [code] (1 point)</h4> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">plot_embeddings</span><span class="token punctuation">(</span>M_reduced<span class="token punctuation">,</span> word2Ind<span class="token punctuation">,</span> words<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" Plot in a scatterplot the embeddings of the words specified in the list "words".
        NOTE: do not plot all the words listed in M_reduced / word2Ind.
        Include a label next to each point.
        
        Params:
            M_reduced (numpy matrix of shape (number of unique words in the corpus , k)): matrix of k-dimensioal word embeddings
            word2Ind (dict): dictionary that maps word to indices for matrix M
            words (list of strings): words whose embeddings we want to visualize
    """</span>

    <span class="token comment"># ------------------</span>
    <span class="token comment"># Write your implementation here.</span>
    <span class="token comment"># simulating a pandas df['type'] column</span>

    <span class="token keyword">for</span> word <span class="token keyword">in</span> words<span class="token punctuation">:</span>
        x <span class="token operator">=</span> M_reduced<span class="token punctuation">[</span>word2Ind<span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
        y <span class="token operator">=</span> M_reduced<span class="token punctuation">[</span>word2Ind<span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> word<span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># ------------------</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># ---------------------</span>
<span class="token comment"># Run this sanity check</span>
<span class="token comment"># Note that this not an exhaustive check for correctness.</span>
<span class="token comment"># The plot produced should look like the "test solution plot" depicted below. </span>
<span class="token comment"># ---------------------</span>

<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"Outputted Plot:"</span><span class="token punctuation">)</span>

M_reduced_plot_test <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
word2Ind_plot_test <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'test1'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'test2'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'test3'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'test4'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'test5'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">}</span>
words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'test1'</span><span class="token punctuation">,</span> <span class="token string">'test2'</span><span class="token punctuation">,</span> <span class="token string">'test3'</span><span class="token punctuation">,</span> <span class="token string">'test4'</span><span class="token punctuation">,</span> <span class="token string">'test5'</span><span class="token punctuation">]</span>
plot_embeddings<span class="token punctuation">(</span>M_reduced_plot_test<span class="token punctuation">,</span> word2Ind_plot_test<span class="token punctuation">,</span> words<span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">80</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>--------------------------------------------------------------------------------
Outputted Plot:
</code></pre> 
<p><img src="https://images2.imgbox.com/1b/7e/Cll4B5jJ_o.png" alt="在这里插入图片描述"></p> 
<pre><code>--------------------------------------------------------------------------------
</code></pre> 
<h4><a id="Question_15_CoOccurrence_Plot_Analysis_written_3_points_294"></a>Question 1.5: Co-Occurrence Plot Analysis [written] (3 points)</h4> 
<p><img src="https://images2.imgbox.com/8b/ef/hCO0ephq_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="font_colorredWrite_your_answer_herefont_298"></a><font color="red">Write your answer here.</font></h5> 
<p>The graph is in the shape of a curve. And the distances between each word represent the closenesses.</p> 
<h5><a id="_What_clusters_together_in_2dimensional_embedding_space_303"></a>- What clusters together in 2-dimensional embedding space?</h5> 
<p>‘petroleum’ and ‘industry’ cluster together because their meanings are correlated.<br> ‘energy’ and ‘oil’ cluster together because oil is a type of energy.<br> ‘ecuador’, ‘kuwait’ and ‘venezuela’ cluster because they are all country names.<br> ‘output’ , ‘barrels’ and 'bpd’because both ‘barrels’ and ‘barrels per day’ measure the quantity of ‘output’.</p> 
<h5><a id="_What_doesnt_cluster_together_that_you_might_think_should_have_309"></a>- What doesn’t cluster together that you might think should have?</h5> 
<p>Cluster of ‘output’ , ‘barrels’ and ‘bpd’ are relatively far away from cluster of ‘energy’ and ‘oil’ or cluster of ‘petroleum’ and ‘industry’, which have related meaning of ‘oil’.</p> 
<h3><a id="Part_2_PredictionBased_Word_Vectors_15_points_313"></a>Part 2: Prediction-Based Word Vectors (15 points)</h3> 
<h4><a id="Question_21_Word2Vec_Plot_Analysis_written_4_points_316"></a>Question 2.1: Word2Vec Plot Analysis [written] (4 points)</h4> 
<p><img src="https://images2.imgbox.com/24/c2/AlXLUUii_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="font_colorredWrite_your_answer_herefont_320"></a><font color="red">Write your answer here.</font></h5> 
<h5><a id="_What_clusters_together_in_2dimensional_embedding_space_322"></a>- What clusters together in 2-dimensional embedding space?</h5> 
<p>‘barrels’ and ‘bpd’;<br> ‘energy’ ,‘industry’, ‘kuwait’, ‘oil’, ‘petroleum’;<br> ‘venezuela’,‘ecuador’ and ‘output’;</p> 
<h5><a id="_What_doesnt_cluster_together_that_you_might_think_should_have_327"></a>- What doesn’t cluster together that you might think should have?</h5> 
<p>‘oil’, ‘energy’ and ‘barrels’, ‘bpd’;<br> ‘venezuela’, ‘ecuador’ and ‘kuwait’;</p> 
<h5><a id="_How_is_the_plot_different_from_the_one_generated_earlier_from_the_cooccurrence_matrix_331"></a>- How is the plot different from the one generated earlier from the co-occurrence matrix?</h5> 
<p>The distances of words in the plot do not represent the real correlations compared to those of the co-occurrence matrix. This may be caused by distortion of conpressing the high-dimensional space into 2-D dimension.</p> 
<h4><a id="Cosine_Similarity_335"></a>Cosine Similarity</h4> 
<h4><a id="Question_22_Polysemous_Words_2_points_code__written_337"></a>Question 2.2: Polysemous Words (2 points) [code + written]</h4> 
<pre><code class="prism language-python"><span class="token comment"># ------------------</span>
<span class="token comment"># Write your polysemous word exploration code here.</span>
wv_from_bin<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span><span class="token string">"bank"</span><span class="token punctuation">)</span>

<span class="token comment"># ------------------</span>
</code></pre> 
<pre><code>[('banks', 0.7440759539604187),
 ('banking', 0.690161406993866),
 ('Bank', 0.6698698997497559),
 ('lender', 0.6342284679412842),
 ('banker', 0.6092953681945801),
 ('depositors', 0.6031531691551208),
 ('mortgage_lender', 0.5797975659370422),
 ('depositor', 0.5716428160667419),
 ('BofA', 0.5714625120162964),
 ('Citibank', 0.5589520335197449)]
</code></pre> 
<pre><code class="prism language-python">wv_from_bin<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span><span class="token string">"glass"</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>[('R._Mazzei_fused', 0.6665399074554443),
 ('Christian_Audigier_nightclub', 0.6632694602012634),
 ('copper_alloy_garnets', 0.6343655586242676),
 ('Nelmeus', 0.6274422407150269),
 ('fiber_fusion_splicing', 0.6229820251464844),
 ('Plexiglass', 0.585858941078186),
 ('slashing_Leonardo_DiCaprio', 0.5850011110305786),
 ('plexiglass', 0.5823023319244385),
 ('Plexiglas', 0.5803930759429932),
 ("#Q'##_unaudited", 0.5798528790473938)]
</code></pre> 
<pre><code class="prism language-python">wv_from_bin<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span><span class="token string">"fall"</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>[('falling', 0.6371318101882935),
 ('falls', 0.6107184290885925),
 ('drop', 0.5912517309188843),
 ('tumble', 0.569644570350647),
 ('rise', 0.5596301555633545),
 ('plummet', 0.5581283569335938),
 ('fell', 0.5548586845397949),
 ('spring', 0.541506826877594),
 ('Fall', 0.5406967401504517),
 ('sag', 0.5160202383995056)]
</code></pre> 
<pre><code class="prism language-python">wv_from_bin<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span><span class="token string">"green"</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>[('wearin_o', 0.57559734582901),
 ('greener', 0.5499471426010132),
 ('workers_differently_Corenthal', 0.5424154996871948),
 ('QEII_TJ_Marta', 0.5406073331832886),
 ('red', 0.5360240936279297),
 ('Leyritz_Ford_Expedition', 0.5289624929428101),
 ('greening', 0.5261998176574707),
 ('Pentwater_Civic', 0.5239853858947754),
 ('Kimmie_Mi_Hyun_Kim', 0.5214661955833435),
 ('eco_friendly', 0.5156992077827454)]
</code></pre> 
<h5><a id="font_colorredWrite_your_answer_herefont_426"></a><font color="red">Write your answer here.</font></h5> 
<p>state the polysemous word you discover and the multiple meanings that occur in the top 10.</p> 
<h5><a id="_Why_do_you_think_many_of_the_polysemous_words_you_tried_didnt_work_431"></a>- Why do you think many of the polysemous words you tried didn’t work?</h5> 
<p>Because the vocabulary we use is from a news document and it does not cover a wide range of the words.</p> 
<h4><a id="Question_23_Synonyms__Antonyms_2_points_code__written_434"></a>Question 2.3: Synonyms &amp; Antonyms (2 points) [code + written]</h4> 
<pre><code class="prism language-python"><span class="token comment"># ------------------</span>
<span class="token comment"># Write your synonym &amp; antonym exploration code here.</span>

w1 <span class="token operator">=</span> <span class="token string">"true"</span>
w2 <span class="token operator">=</span> <span class="token string">"really"</span>
w3 <span class="token operator">=</span> <span class="token string">"false"</span>
w1_w2_dist <span class="token operator">=</span> wv_from_bin<span class="token punctuation">.</span>distance<span class="token punctuation">(</span>w1<span class="token punctuation">,</span> w2<span class="token punctuation">)</span>
w1_w3_dist <span class="token operator">=</span> wv_from_bin<span class="token punctuation">.</span>distance<span class="token punctuation">(</span>w1<span class="token punctuation">,</span> w3<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Synonyms {}, {} have cosine distance: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>w1<span class="token punctuation">,</span> w2<span class="token punctuation">,</span> w1_w2_dist<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Antonyms {}, {} have cosine distance: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>w1<span class="token punctuation">,</span> w3<span class="token punctuation">,</span> w1_w3_dist<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># ------------------</span>
</code></pre> 
<pre><code>Synonyms true, really have cosine distance: 0.6886207759380341
Antonyms true, false have cosine distance: 0.6290567219257355
</code></pre> 
<h5><a id="font_colorredWrite_your_answer_herefont_458"></a><font color="red">Write your answer here.</font></h5> 
<p>the difference of degrees of word meaning may enlarge the cosine distance.</p> 
<h4><a id="Solving_Analogies_with_Word_Vectors_462"></a>Solving Analogies with Word Vectors</h4> 
<pre><code class="prism language-python"><span class="token comment"># Run this cell to answer the analogy -- man : king :: woman : x</span>
pprint<span class="token punctuation">.</span>pprint<span class="token punctuation">(</span>wv_from_bin<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span>positive<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'woman'</span><span class="token punctuation">,</span> <span class="token string">'king'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> negative<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>[('queen', 0.7118192911148071),
 ('monarch', 0.6189674139022827),
 ('princess', 0.5902431011199951),
 ('crown_prince', 0.5499460697174072),
 ('prince', 0.5377321243286133),
 ('kings', 0.5236844420433044),
 ('Queen_Consort', 0.5235945582389832),
 ('queens', 0.518113374710083),
 ('sultan', 0.5098593235015869),
 ('monarchy', 0.5087411999702454)]
</code></pre> 
<h4><a id="Question_24_Finding_Analogies_code__written__2_Points_482"></a>Question 2.4: Finding Analogies [code + written] (2 Points)</h4> 
<pre><code class="prism language-python"><span class="token comment"># ------------------</span>
<span class="token comment"># Write your analogy exploration code here.</span>

<span class="token comment"># the analogy -- gymnastics : gymnast :: piano : x</span>
pprint<span class="token punctuation">.</span>pprint<span class="token punctuation">(</span>wv_from_bin<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span>positive<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'gymnast'</span><span class="token punctuation">,</span> <span class="token string">'piano'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> negative<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'gymnastics'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># ------------------</span>
</code></pre> 
<pre><code>[('pianist', 0.7164468169212341),
 ('violin', 0.7020024061203003),
 ('violinist', 0.681442379951477),
 ('cello', 0.6716278791427612),
 ('cellist', 0.6693906784057617),
 ('saxophone', 0.6536856889724731),
 ('clarinet', 0.6517087817192078),
 ('alto_saxophone', 0.6199961304664612),
 ('alto_sax', 0.6194193363189697),
 ('trombone', 0.6166050434112549)]
</code></pre> 
<h5><a id="font_colorredWrite_your_answer_herefont_506"></a><font color="red">Write your answer here.</font></h5> 
<h4><a id="Question_25_Incorrect_Analogy_code__written_1_point_508"></a>Question 2.5: Incorrect Analogy [code + written] (1 point)</h4> 
<pre><code class="prism language-python"><span class="token comment"># ------------------</span>
<span class="token comment"># Write your incorrect analogy exploration code here.</span>

<span class="token comment"># the analogy -- tomato : vegetable :: grape : x</span>
pprint<span class="token punctuation">.</span>pprint<span class="token punctuation">(</span>wv_from_bin<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span>positive<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'grape'</span><span class="token punctuation">,</span> <span class="token string">'vegetable'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> negative<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'tomato'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># ------------------</span>
</code></pre> 
<pre><code>[('grapes', 0.5778293013572693),
 ('Thompson_seedless_grapes', 0.5553233027458191),
 ('grape_cultivation', 0.5311552286148071),
 ('winegrapes', 0.5253068208694458),
 ('wine_grapes', 0.5252600908279419),
 ('winegrape', 0.5084421038627625),
 ('varietal', 0.5068702697753906),
 ('Bordeaux_grape_varieties', 0.5039265751838684),
 ('almond', 0.4998564124107361),
 ('Cabernet_Sauvignon_grapes', 0.49503305554389954)]
</code></pre> 
<h5><a id="font_colorredWrite_your_answer_herefont_532"></a><font color="red">Write your answer here.</font></h5> 
<h4><a id="Question_26_Guided_Analysis_of_Bias_in_Word_Vectors_written_1_point_534"></a>Question 2.6: Guided Analysis of Bias in Word Vectors [written] (1 point)</h4> 
<pre><code class="prism language-python"><span class="token comment"># Run this cell</span>
<span class="token comment"># Here `positive` indicates the list of words to be similar to and `negative` indicates the list of words to be</span>
<span class="token comment"># most dissimilar from.</span>
pprint<span class="token punctuation">.</span>pprint<span class="token punctuation">(</span>wv_from_bin<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span>positive<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'woman'</span><span class="token punctuation">,</span> <span class="token string">'boss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> negative<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
pprint<span class="token punctuation">.</span>pprint<span class="token punctuation">(</span>wv_from_bin<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span>positive<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">,</span> <span class="token string">'boss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> negative<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'woman'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>[('bosses', 0.5522644519805908),
 ('manageress', 0.49151360988616943),
 ('exec', 0.459408164024353),
 ('Manageress', 0.45598435401916504),
 ('receptionist', 0.4474116861820221),
 ('Jane_Danson', 0.44480547308921814),
 ('Fiz_Jennie_McAlpine', 0.44275766611099243),
 ('Coronation_Street_actress', 0.44275569915771484),
 ('supremo', 0.4409852921962738),
 ('coworker', 0.4398624897003174)]

[('supremo', 0.6097397804260254),
 ('MOTHERWELL_boss', 0.5489562153816223),
 ('CARETAKER_boss', 0.5375303626060486),
 ('Bully_Wee_boss', 0.5333974361419678),
 ('YEOVIL_Town_boss', 0.5321705341339111),
 ('head_honcho', 0.5281980037689209),
 ('manager_Stan_Ternent', 0.525971531867981),
 ('Viv_Busby', 0.5256163477897644),
 ('striker_Gabby_Agbonlahor', 0.5250812768936157),
 ('BARNSLEY_boss', 0.5238943099975586)]
</code></pre> 
<h5><a id="font_colorredWrite_your_answer_herefont_569"></a><font color="red">Write your answer here.</font></h5> 
<p>Gender biases does appear in the word embeddings:<br> a) contains some jobs like ‘receptionist’ and ‘coworker’ which are not related to the same level of ‘boss’ title while most words in b) are related to ‘boss’, ‘head’, and ‘manager’.</p> 
<h4><a id="Question_27_Independent_Analysis_of_Bias_in_Word_Vectors_code__written__2_points_573"></a>Question 2.7: Independent Analysis of Bias in Word Vectors [code + written] (2 points)</h4> 
<pre><code class="prism language-python"><span class="token comment"># ------------------</span>
<span class="token comment"># Write your bias exploration code here.</span>

pprint<span class="token punctuation">.</span>pprint<span class="token punctuation">(</span>wv_from_bin<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span>positive<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'american'</span><span class="token punctuation">,</span> <span class="token string">'manager'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> negative<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'chinese'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
pprint<span class="token punctuation">.</span>pprint<span class="token punctuation">(</span>wv_from_bin<span class="token punctuation">.</span>most_similar<span class="token punctuation">(</span>positive<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'chinese'</span><span class="token punctuation">,</span> <span class="token string">'manager'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> negative<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'american'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># ------------------</span>
</code></pre> 
<pre><code>[('vice_president', 0.5888485908508301),
 ('vp', 0.5321600437164307),
 ('director', 0.5288139581680298),
 ('manger', 0.5164791941642761),
 ('mananger', 0.4895482063293457),
 ('vicepresident', 0.4752706289291382),
 ('coordinator', 0.4739943742752075),
 ('administrator', 0.4649930000305176),
 ('senior_vp', 0.46086063981056213),
 ('svp', 0.4597167670726776)]

[('manger', 0.5492449998855591),
 ('managing_director', 0.514661431312561),
 ('Manager', 0.509232759475708),
 ('General_Manager', 0.4886166453361511),
 ('supervisor', 0.48655033111572266),
 ('mananger', 0.47807249426841736),
 ('director', 0.4770866930484772),
 ('vice_president', 0.4578412175178528),
 ('General_Manger', 0.4420962929725647),
 ('Jialin', 0.42849200963974)]
</code></pre> 
<h5><a id="font_colorredWrite_your_answer_herefont_610"></a><font color="red">Write your answer here.</font></h5> 
<p>Race biases does appear in the word embeddings:<br> a) contains 5 ‘vice_president’ and 3 ‘manager’(‘supervisor’/‘director’) while b) contains 7 ‘manager’(‘supervisor’/‘director’) and only 1 ‘vice_president’. It indicates that in this embedding american managers are more likely to be regarded as title with a high position like vice president than chinese managers.</p> 
<h4><a id="Question_28_Thinking_About_Bias_written_1_point_614"></a>Question 2.8: Thinking About Bias [written] (1 point)</h4> 
<p>What might be the cause of these biases in the word vectors?</p> 
<h5><a id="font_colorredWrite_your_answer_herefont_618"></a><font color="red">Write your answer here.</font></h5>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e18b8eb446af4ea88f93db0529663a1b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">IDEA修改及设置快捷键</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a389bd0f696bf4cca96c662163d21c04/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">图像透视变换应用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>