<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python案例分析｜使用Python图像处理库Pillow处理图像文件 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python案例分析｜使用Python图像处理库Pillow处理图像文件" />
<meta property="og:description" content="本案例通过使用Python图像处理库Pillow，帮助大家进一步了解Python的基本概念：模块、对象、方法和函数的使用
使用Python语言解决实际问题时，往往需要使用由第三方开发的开源Python软件库。
本案例使用图像处理库Pillow中的模块、对象来处理图像：实现读取图像、获取图像信息、调整图像大小、旋转图像、平滑图像、剪切图像等基本图像处理任务。
01、安装Pillow Pillow是Python中的图像处理库（PIL，Python Image Library），提供了了广泛的文件格式支持，强大的图像处理能力，主要包括图像储存、图像显示、格式转换以及基本的图像处理操作等。
Pillow位于Python包索引（PyPI）中，可以使用pip来安装。注意，Anaconda包含了Pillow库。
【例1】使用pip安装Pillow库。
以管理员身份运行命令行提示符，输入命令pip3 install Pillow，安装Pillow库。如图1所示。
■ 图1 使用pip安装Pillow库
02、打开和显示图像 Pillow库包含几十个模块，组织在名为PIL的包中。PIL包中的一个模块是Image。PIL.Image提供了一些包括从文件中加载图像和创建新图像的函数，其中的Image用于表示图像对象。
【例2】打开和显示图像。
使用PIL.Image模块的open()函数可以打开一个图像，返回一个图像对象，然后调用图像对象的show()方法，可以在屏幕上显示图像。
&gt;&gt;&gt; import PIL; from PIL import Image &gt;&gt;&gt; im = PIL.Image.open(&#34;c:/pythonpa/cs/img/mandrill.jpg&#34;) &gt;&gt;&gt; im.show() &gt;&gt;&gt; print(im.format, im.size, im.mode) #显示图像的格式、大小和模式信息 JPEG (298, 298) RGB 说明/
（1）im.format返回包含图像格式的字符串（JPEG、GIF、TIFF、BMP、PNG、…）。
（2）im.size返回包含图像宽度和高度的元组，单位为像素。与每个像素相关的是一对坐标(i, j)，用于标识像素的列i和行j。列从左到右编号，从0开始；行从上到下编号，也从0开始。
（3）im.mode返回包含图像模式的字符串（RGB、CYMK、Grayscale、…）。
03、图像的基本操作 图像对象的copy()方法用于拷贝图像；crop()方法用于剪裁图像；paste()方法用于将一个图像粘贴（覆盖）在另一个图像上面；resize()方法用于调整图像大小；rotate()方法用于旋转和翻转图像；filter()方法用于图像过滤。
Pillow提供的图像处理工具包括其它众多模块。有关Pillow的更多信息，请查阅在线文档http://pillow.readthedocs.org。
使用PIL.Image模块中的函数new()可以创建一个给定模式和大小的新图像对象。例如，创建一个新的大小为800×600的RGB图像的代码如下：
&gt;&gt;&gt; im2 = PIL.Image.new(&#39;RGB&#39;, (800,600)) 【例3】图像的基本操作示例。
把一幅图像的4个副本排列成2×2网格：在左上方的副本是原始图像，而画面右上方、左下方、右下方则分别使用模块PIL.ImageFilter中定义的内置过滤器CONTOUR、EMBOSS、FIND_EDGES进行过滤。
#模块：c:\pythonpa\cs\image_test.py #命令行：python image_test.py c:\pythonpa\cs\img\mandrill.jpg #功能：把c:\pythonpa\cs\img\mandrill.jpg的4个副本排列成2×2网格并显示 import sys import os import PIL.Image import PIL." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3164073141384b656d1612d0526929bd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-17T08:19:31+08:00" />
<meta property="article:modified_time" content="2023-07-17T08:19:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python案例分析｜使用Python图像处理库Pillow处理图像文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p class="img-center"><img alt="图片" height="721" src="https://images2.imgbox.com/91/7e/N1O7HDEE_o.jpg" width="1080"></p> 
<p>本案例通过使用Python图像处理库Pillow，帮助大家进一步了解Python的基本概念：模块、对象、方法和函数的使用</p> 
<p>使用Python语言解决实际问题时，往往需要使用由第三方开发的开源Python软件库。</p> 
<p>本案例使用图像处理库Pillow中的模块、对象来处理图像：实现读取图像、获取图像信息、调整图像大小、旋转图像、平滑图像、剪切图像等基本图像处理任务。</p> 
<p> </p> 
<h2>01、<strong>安装Pillow</strong></h2> 
<p>Pillow是Python中的图像处理库（PIL，Python Image Library），提供了了广泛的文件格式支持，强大的图像处理能力，主要包括图像储存、图像显示、格式转换以及基本的图像处理操作等。</p> 
<p>Pillow位于Python包索引（PyPI）中，可以使用pip来安装。注意，Anaconda包含了Pillow库。</p> 
<p><strong>【例1】</strong>使用pip安装Pillow库。</p> 
<p>以管理员身份运行命令行提示符，输入命令pip3 install Pillow，安装Pillow库。如图1所示。</p> 
<p class="img-center"><img alt="图片" height="192" src="https://images2.imgbox.com/a9/ce/NhUnjyNa_o.png" width="607"></p> 
<p style="text-align:center;">■ 图1  使用pip安装Pillow库</p> 
<p></p> 
<h2>02、<strong>打开和显示图像</strong></h2> 
<p>Pillow库包含几十个模块，组织在名为PIL的包中。PIL包中的一个模块是Image。PIL.Image提供了一些包括从文件中加载图像和创建新图像的函数，其中的Image用于表示图像对象。</p> 
<p><strong>【例2】</strong>打开和显示图像。</p> 
<p>使用PIL.Image模块的open()函数可以打开一个图像，返回一个图像对象，然后调用图像对象的show()方法，可以在屏幕上显示图像。</p> 
<pre><code>&gt;&gt;&gt; import PIL; from PIL import Image
&gt;&gt;&gt; im = PIL.Image.open("c:/pythonpa/cs/img/mandrill.jpg")
&gt;&gt;&gt; im.show()
&gt;&gt;&gt; print(im.format, im.size, im.mode) #显示图像的格式、大小和模式信息
JPEG (298, 298) RGB</code></pre> 
<blockquote> 
 <p><strong>说明</strong>/</p> 
 <p></p> 
 <p>（1）im.format返回包含图像格式的字符串（JPEG、GIF、TIFF、BMP、PNG、…）。</p> 
 <p>（2）im.size返回包含图像宽度和高度的元组，单位为像素。与每个像素相关的是一对坐标(i, j)，用于标识像素的列i和行j。列从左到右编号，从0开始；行从上到下编号，也从0开始。</p> 
 <p>（3）im.mode返回包含图像模式的字符串（RGB、CYMK、Grayscale、…）。</p> 
</blockquote> 
<h2>03、<strong>图像的基本操作</strong></h2> 
<p>图像对象的copy()方法用于拷贝图像；crop()方法用于剪裁图像；paste()方法用于将一个图像粘贴（覆盖）在另一个图像上面；resize()方法用于调整图像大小；rotate()方法用于旋转和翻转图像；filter()方法用于图像过滤。</p> 
<p>Pillow提供的图像处理工具包括其它众多模块。有关Pillow的更多信息，请查阅在线文档<a class="link-info" href="http://pillow.readthedocs.org" rel="nofollow" title="http://pillow.readthedocs.org">http://pillow.readthedocs.org</a>。</p> 
<p>使用PIL.Image模块中的函数new()可以创建一个给定模式和大小的新图像对象。例如，创建一个新的大小为800×600的RGB图像的代码如下：</p> 
<pre><code>&gt;&gt;&gt; im2 = PIL.Image.new('RGB', (800,600))</code></pre> 
<p><strong>【例3】</strong>图像的基本操作示例。</p> 
<p>把一幅图像的4个副本排列成2×2网格：在左上方的副本是原始图像，而画面右上方、左下方、右下方则分别使用模块PIL.ImageFilter中定义的内置过滤器CONTOUR、EMBOSS、FIND_EDGES进行过滤。</p> 
<pre><code>#模块：c:\pythonpa\cs\image_test.py
#命令行：python image_test.py c:\pythonpa\cs\img\mandrill.jpg
#功能：把c:\pythonpa\cs\img\mandrill.jpg的4个副本排列成2×2网格并显示
import sys
import os
import PIL.Image
import PIL.ImageFilter
im = PIL.Image.open(sys.argv[1])
width, height = im.size
# 创建新图像，大小为原始图像的4倍
res = PIL.Image.new(im.mode, (2*width, 2*height))
# 把原始图像放置在左上角
res.paste(im, (0, 0, width, height))
# 把轮廓过滤CONTOUR的图像放置在右上角
contour = im.filter(PIL.ImageFilter.CONTOUR)
res.paste(contour, (width, 0, 2*width, height))
# 把浮雕过滤EMBOSS的图像放置在左下角
emboss = im.filter(PIL.ImageFilter.EMBOSS)
res.paste(emboss, (0, height, width, 2*height))
# 把边缘过滤FIND_EDGES的图像放置在右下角
edges = im.filter(PIL.ImageFilter.FIND_EDGES)
res.paste(edges, (width, height, 2*width, 2*height))
# 显示结果图像
res.show()</code></pre> 
<h2>04、<strong>批量图像格式转换</strong></h2> 
<p>使用PIL.Image模块的open()函数打开磁盘图像文件时，会根据文件内容自动确定文件格式。使用Image对象的save()方法保存图像时，可以指定格式，从而实现格式转换。</p> 
<p><strong>【例4】</strong>批量图像格式转换。</p> 
<pre><code class="language-python">#模块：c:\pythonpa\cs\image_convert.py
#命令行：python image_convert.py c:\pythonpa\cs\img jpg png
#功能：把c:\pythonpa\cs\img下的所有jpg文件转换为png文件
import sys
import glob
import os
import PIL.Image
img_path = sys.argv[1] + "/*." + sys.argv[2]
for infile in glob.glob(img_path):
    f,e = os.path.splitext(infile)
    outfile = f + "." + sys.argv[3]
    PIL.Image.open(infile).save(outfile)
</code></pre> 
<blockquote> 
 <p><strong>说明</strong>/</p> 
 <p></p> 
 <p>（1）glob模块可以使用通配符匹配文件名。例如glob.glob("c:\tmp\*.jpg")，可以返回c:\tmp下的所有后缀为jpg的文件列表。</p> 
 <p>（2）os.path.splitext(p)可以拆分文件名和后缀。</p> 
</blockquote> 
<p> </p> 
<h2>05、<strong>批量创建缩略图</strong></h2> 
<p>缩略图是网络开发或图像软件预览常用的一种基本技术，使用Python的Pillow图像库中Image模块中的Image对象的thumbnail()方法，可以很方便地建立缩略图。</p> 
<p><strong>【例5】</strong>批量创建缩略图。</p> 
<pre><code class="language-python">#模块：c:\pythonpa\cs\ image_thumbnail.py
#命令行：python image_thumbnail.py c:\pythonpa\cs\img jpg
#功能：把c:\pythonpa\cs\img下的所有*.jpg文件转换为*_s.jpg缩略图
import sys
import os
import glob
import PIL.Image
img_path = sys.argv[1] + "/*." + sys.argv[2]
size = (128,128)
for infile in glob.glob(img_path):
    f,e = os.path.splitext(infile)
    outfile = f + "_s." + sys.argv[2]
    img = PIL.Image.open(infile)
    img.thumbnail(size, PIL.Image.ANTIALIAS)
    img.save(outfile)</code></pre> 
<blockquote> 
 <p><strong>说明</strong>/</p> 
 <p></p> 
 <p>（1）glob模块可以使用通配符匹配文件名。例如glob.glob("c:\tmp\*.jpg")，可以返回c:/tmp下的所有后缀为jpg的文件列表。</p> 
 <p>（2）os.path.splitext(p)可以拆分文件名和后缀。</p> 
</blockquote> 
<p> </p> 
<h2>06、<strong>批量图像加文字水印</strong></h2> 
<p>图片加水印是防止盗版的有效方式之一。首先使用Python的Pillow图像库中的Image模块的new函数可以创建水印图像对象，并使用ImageDraw模块在水印图像上绘制文字，最后通过Image模块的composite函数合成水印图像和原图像。</p> 
<p><strong>【例6】批量图像加文字水印。</strong></p> 
<pre><code class="language-python">#模块：c:\pythonpa\cs\image_watermark1.py
#命令行：python image_watermark1.py c:\pythonpa\cs\img jpg "Python"
#功能：把c:\pythonpa\cs\img下的所有*.jpg文件加"Python"水印并另存为*_w.jpg
import sys
import os
import glob
from PIL import Image, ImageDraw, ImageFont
img_path = sys.argv[1] + "/*." + sys.argv[2]
img_suffix = sys.argv[2]
txt_log = sys.argv[3]
for infile in glob.glob(img_path):
    f, e = os.path.splitext(infile)
    outfile = f + "_w." + img_suffix
    im = Image.open(infile)
    im_log = Image.new('RGBA', im.size)
    fnt = ImageFont.truetype("c:/Windows/fonts/Tahoma.ttf", 20)
    d = ImageDraw.ImageDraw(im_log)
    d.text((0, 0), txt_log, font = fnt)
    im_out = Image.composite(im_log, im, im_log)
    im_out.save(outfile)</code></pre> 
<h2>07、<strong>批量图像加图片水印</strong></h2> 
<p>加图片水印的原理和加文字水印相同，首先使用Python的Pillow图像库中的Image模块的new函数可以创建水印图像对象，并使用图像对象的paste方法把log图像粘贴到水印图像，最后通过Image模块的composite函数合成水印图像和原图像。</p> 
<p><strong>【例7】</strong>批量图像加图片水印。</p> 
<pre><code class="language-python">#模块：c:\pythonpa\cs\image_watermark2.py
#命令行：python image_watermark2.py c:\pythonpa\cs\img jpg c:\pythonpa\cs\img\python-logo.png
#功能：把c:\pythonpa\cs\img下的所有*.jpg文件加水印python-logo.png并另存为*_w.jpg
import sys
import os
import glob
from PIL import Image, ImageDraw, ImageFont
img_path = sys.argv[1] + "/*." + sys.argv[2]
img_suffix = sys.argv[2]
log_file = sys.argv[3]
for infile in glob.glob(img_path):
    f, e = os.path.splitext(infile)
    outfile = f + "_w." + img_suffix
    im = Image.open(infile)
    im_log = Image.open(log_file)
    im_mark = Image.new('RGBA', im.size)
    im_mark.paste(im_log, (0, 0))
    im_out = Image.composite(im_mark, im, im_mark)
    im_out.save(outfile)</code></pre> 
<p> </p> 
<h2>08、<strong>批量调整图像大小</strong></h2> 
<p>调整图像大小也是网络开发或图像软件预览常用的一种基本技术。使用Image对象的resize()方法可以调整图像大小。</p> 
<p><strong>【例8】</strong>批量调整图像大小。</p> 
<pre><code class="language-python">#模块：c:\pythonpa\cs\image_resize.py
#命令行：python image_resize.py c:\pythonpa\cs\img jpg 640 480
#功能：把c:\pythonpa\cs\img下的所有*.jpg文件大小调整为640*480并另存为*_640.jpg
import sys
import os
import glob
import PIL.Image
img_path = sys.argv[1] + "/*." + sys.argv[2]
img_suffix = sys.argv[2]
img_size_width = int(sys.argv[3])
img_size_height = int(sys.argv[4])
for infile in glob.glob(img_path):
    f, e = os.path.splitext(infile)
    outfile = f + "_" + str(img_size_width) + "." + img_suffix
    im = PIL.Image.open(infile)
    im_out = im.resize((img_size_width, img_size_height))
    im_out.save(outfile)</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/19b061dd5a6b3ee17ddd20a8709165dd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">PoolFormer实战：使用PoolFormer实现图像分类任务（二）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/86ff4890ed62527e564ac4e69b138520/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">聚水潭对接打通金蝶云星空销售出库查询接口与销售出库新增接口</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>