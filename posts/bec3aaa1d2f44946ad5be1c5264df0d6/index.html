<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#调用OCX控件 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#调用OCX控件" />
<meta property="og:description" content="之前写了一个调用OCX的winfrom程序，之前运行一直好使，但是突然一天，初始化控件报错，找不到指定模块。。。。。
尝试重新下载ocx，加载ocx，失败。
尝试使用之前程序生成的dll文件失败。
最后发现电脑没有注册ocx，好吧下载去注册一下吧！
以前在web端读取pdf格式都是在客户端安装adobe软件，现在为了满足不在客户端安装adobe软件也可以读取pdf格式文件，所以就用了金格的一款ocx组件，解决了客户端不安装pdf格式软件也可以读取pdf格式文件。下面就说说支持ocx组件的环境。
一、如果你是win7 64位操作系统 找到 C盘-----&gt;Windows文件夹----&gt;system32 并且system64文件夹,把命名为ocx（此demo是iwebpdf.ocx）的文件放入system32 并且system64下即可。
二、如果你是win7 32 或者windowsxp系统 找到 C盘-----&gt;Windows文件夹----&gt;system32 ，把命名为ocx（此demo是iwebpdf.ocx）的文件放入system32即可。
三、把文件夹放入上述路径下，然后wins&#43;R 打开命令窗体，开始执行&#34;regsvr32 iWebPDF.ocx&#34;此命令，此时会提示注册组件成功。
四、ocx组件注册成功后 执行一遍第三方提供的&#34;IEExecute.exe&#34;文件，该文件执行成功后进入下一步。
五、exe执行成功后，然后wins&#43;R 打开命令窗体，输入&#34;regedit&#34;命令，打开注册表，找到&#34;HKEY_CLASSES_ROOT---&gt;CLSID&#34;，查看CLSID下是否有一个节点与第三方提供的那个节点一致，如果有的话就证明ocx组件是真正的注册成功已写入注册表里，如果没有找到不用担心，可以手动加一个节点，需要注意到是手动加节点路径要与之前所放文件路径一致，否则会找不到。
完成上述我所说的基本就不会有什么问题，但是我最近还是因为环境问题那个ocx组件一直不成功，因为在xp系统里系统不升级到sp3会一直有问题，所以建议大家如果是xp系统的话尽量升级到sp3。环境成功后，用第三方提供的一些属性及方法就轻松无压力了。
这是一个示例说明，记录一下。 下面也记录一下如何使用ocx吧，
在工具箱邮件，选择&#34;选择项&#34;，选择com组件，浏览路径添加。
在from加载需要实例化ocx的组件信息。
private AxOPERATIONCARDLib.AxOperationCard _operation;
_operation = new AxOperationCard();
_operation.BeginInit();
this.Controls.Add(_operation);//add test
_operation.Visible = false;
_operation.EndInit();
_operation.CreateControl();
}
OCX使用命令生成dll文件
1、启动VS开发人员命令面板/
2、切换到ocx文件目录
3、aximp name.ocx
则会在响应目录下生成两个dll文件。
如果需要注册
regsvr 32 name.ocx" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/bec3aaa1d2f44946ad5be1c5264df0d6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-07-17T08:44:12+08:00" />
<meta property="article:modified_time" content="2017-07-17T08:44:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#调用OCX控件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>之前写了一个调用OCX的winfrom程序，之前运行一直好使，但是突然一天，初始化控件报错，找不到指定模块。。。。。</p> 
<p>尝试重新下载ocx，加载ocx，失败。</p> 
<p>尝试使用之前程序生成的dll文件失败。</p> 
<p>最后发现电脑没有注册ocx，好吧下载去注册一下吧！</p> 
<p></p> 
<p style='margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:21px; color:rgb(70,70,70); font-family:"Microsoft YaHei","Helvetica Neue",SimSun; font-size:14px; background-color:rgb(188,211,229)'> 以前在web端读取pdf格式都是在客户端安装adobe软件，现在为了满足不在客户端安装adobe软件也可以读取pdf格式文件，所以就用了金格的一款ocx组件，解决了客户端不安装pdf格式软件也可以读取pdf格式文件。下面就说说支持ocx组件的环境。</p> 
<p style='margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:21px; color:rgb(70,70,70); font-family:"Microsoft YaHei","Helvetica Neue",SimSun; font-size:14px; background-color:rgb(188,211,229)'> 一、如果你是win7 64位操作系统 找到 C盘-----&gt;Windows文件夹----&gt;system32 并且system64文件夹,把命名为ocx（此demo是iwebpdf.ocx）的文件放入system32 并且system64下即可。</p> 
<p style='margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:21px; color:rgb(70,70,70); font-family:"Microsoft YaHei","Helvetica Neue",SimSun; font-size:14px; background-color:rgb(188,211,229)'> 二、如果你是win7 32 或者windowsxp系统 找到 C盘-----&gt;Windows文件夹----&gt;system32 ，把命名为ocx（此demo是iwebpdf.ocx）的文件放入system32即可。</p> 
<p style='margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:21px; color:rgb(70,70,70); font-family:"Microsoft YaHei","Helvetica Neue",SimSun; font-size:14px; background-color:rgb(188,211,229)'> 三、把文件夹放入上述路径下，然后wins+R 打开命令窗体，开始执行"regsvr32 iWebPDF.ocx"此命令，此时会提示注册组件成功。</p> 
<p style='margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:21px; color:rgb(70,70,70); font-family:"Microsoft YaHei","Helvetica Neue",SimSun; font-size:14px; background-color:rgb(188,211,229)'> 四、ocx组件注册成功后 执行一遍第三方提供的"IEExecute.exe"文件，该文件执行成功后进入下一步。</p> 
<p style='margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:21px; color:rgb(70,70,70); font-family:"Microsoft YaHei","Helvetica Neue",SimSun; font-size:14px; background-color:rgb(188,211,229)'> 五、exe执行成功后，然后wins+R 打开命令窗体，输入"regedit"命令，打开注册表，找到"HKEY_CLASSES_ROOT---&gt;CLSID"，查看CLSID下是否有一个节点与第三方提供的那个节点一致，如果有的话就证明ocx组件是真正的注册成功已写入注册表里，如果没有找到不用担心，可以手动加一个节点，需要注意到是手动加节点路径要与之前所放文件路径一致，否则会找不到。</p> 
<p style='margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:21px; color:rgb(70,70,70); font-family:"Microsoft YaHei","Helvetica Neue",SimSun; font-size:14px; background-color:rgb(188,211,229)'>  <wbr></wbr> <wbr></wbr> <wbr></wbr> 完成上述我所说的基本就不会有什么问题，但是我最近还是因为环境问题那个ocx组件一直不成功，因为在xp系统里系统不升级到sp3会一直有问题，所以建议大家如果是xp系统的话尽量升级到sp3。环境成功后，用第三方提供的一些属性及方法就轻松无压力了。</p> 这是一个示例说明，记录一下。 
<p>下面也记录一下如何使用ocx吧，</p> 
<p>在工具箱邮件，选择"选择项"，选择com组件，浏览路径添加。</p> 
<p>在from加载需要实例化ocx的组件信息。</p> 
<p>   private AxOPERATIONCARDLib.AxOperationCard _operation;<br> </p> 
<p> _operation = new AxOperationCard();<br>             _operation.BeginInit();<br>             this.Controls.Add(_operation);//add test<br>             _operation.Visible = false;<br>             _operation.EndInit();<br>             _operation.CreateControl();</p> 
<p>}<br> </p> 
<p>OCX使用命令生成dll文件</p> 
<p>1、启动VS开发人员命令面板/</p> 
<p>2、切换到ocx文件目录</p> 
<p>3、aximp name.ocx</p> 
<p>则会在响应目录下生成两个dll文件。</p> 
<p>如果需要注册</p> 
<p>regsvr 32 name.ocx</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e2b0e36d5c988b2a27bdeec5d9313d5c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">第一个Python CGI编程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/98554e829e0a4b4e0990b485db3aa9d4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">NRL: network representation learning &amp; NE: network embedding. 相关论文总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>