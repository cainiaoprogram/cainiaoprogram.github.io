<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CASA方法估算NPP（IDL&#43;ENVI） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CASA方法估算NPP（IDL&#43;ENVI）" />
<meta property="og:description" content="CASA方法估算NPP（IDL&#43;ENVI） 一、NPP的定义二、估算流程三、实现代码 （IDL) 一、NPP的定义 NPP是什么：净第一性生产力，又称净初级生产力，是指从绿色植物在单位时间内单位面积上能固定的总能量中除去其自身呼吸消耗掉的部分，单位为焦耳/厘米2/年或克/米2/年。
可表示为：NPP = GPP - Ra
在上式中Ra表示自养呼吸的消耗量、GPP表示总初级生产力。
意义：NPP反映着植物固定和转化光合作用产物的效率，也决定了可供利用的物质和能量。是人类生活所需食物、原料及燃料的来源。植物通过光合作用将太阳能固定并转化为植物生物量。
以上摘自百度百科
二、估算流程 CASA模型反演NPP流程图：
1、温度胁迫因子1
Topt(x,y) 为某一区域一年内 NDVI 值到达最高时的当月平均气温（单位℃），当某个月的平均气温低于或等于-10℃，Tε1(x,y) 取值为0，此时不会发生光合作用。
2、温度胁迫因子2
当某个月平均温度 T(x,y,t) 比适宜温度 Topt(x,y) 高10℃或者低13℃时，该月的 Tε2(x,y,t) 等于月平均温度为最适宜温度 Topt(x,y) 时 Tε2(x,y,t) 的一半。
3、水分胁迫因子
EET(x,y,t) 表示(x,y)处像元t月份的实际蒸散发量（单位mm），PET(x,y,t) 表示(x,y)处像元t月份的潜在蒸散发量（单位mm）。
P(x,y,t)表示(x,y)处像元 t月份的降水（单位mm），Rn(x,y,t) 表示(x,y)处像元t月份的地表净辐射量（单位MJ/m2）。
Ep0(x,y,t) 表示局地潜在蒸发量（单位mm）。
a(x,y) 为因地而异的常数。
I(x,y) 代表12个月总和热量指标。
T(x,y,t) 为 (x,y) 处像元 t 月份的平均温度。
4、实际光能利用率
式中，Tε1(x,y) 和 Tε2(x,y) 为温度胁迫因子，Wε(x,y) 为水分胁迫因子，εMAX 为最大光能利用率。
5、植被层对入射光和有效辐射的吸收比例
NDVImax 和 NDVImin 代表草地的 NDVI 最大值和最小值，FPARmin 和 FPARmax 的取值与植被类型无关，分别为0.001 和0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/63707ad69955524082ba703bd73a1e8b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-16T09:33:13+08:00" />
<meta property="article:modified_time" content="2020-12-16T09:33:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CASA方法估算NPP（IDL&#43;ENVI）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>CASA方法估算NPP（IDL+ENVI）</h4> 
 <ul><li><a href="#NPP_8" rel="nofollow">一、NPP的定义</a></li><li><a href="#_24" rel="nofollow">二、估算流程</a></li><li><a href="#_IDL_112" rel="nofollow">三、实现代码 （IDL)</a></li></ul> 
</div> 
<p></p> 
<hr size='1"' color="#000000"> 
<h2><a id="NPP_8"></a>一、NPP的定义</h2> 
<p><strong>NPP</strong>是什么：净第一性生产力，又称<strong>净初级生产力</strong>，是指从绿色植物在单位时间内单位面积上能固定的总能量中除去其自身呼吸消耗掉的部分，单位为焦耳/厘米2/年或克/米2/年。</p> 
<p>可表示为：<strong>NPP = GPP - Ra</strong></p> 
<p>在上式中<strong>Ra</strong>表示自养呼吸的消耗量、<strong>GPP</strong>表示总初级生产力。</p> 
<p>意义：NPP反映着植物固定和转化光合作用产物的效率，也决定了可供利用的物质和能量。是人类生活所需食物、原料及燃料的来源。植物通过光合作用将太阳能固定并转化为植物生物量。</p> 
<p><font color="#999AAA">以上摘自百度百科</font></p> 
<hr size='1"' color="#000000"> 
<h2><a id="_24"></a>二、估算流程</h2> 
<p>CASA模型反演NPP流程图：</p> 
<p><img src="https://images2.imgbox.com/51/c6/J1rzXdnN_o.png" alt="在这里插入图片描述"></p> 
<p><strong>1、温度胁迫因子1</strong></p> 
<p><img src="https://images2.imgbox.com/83/e5/kW6LbaXH_o.png" alt="在这里插入图片描述"></p> 
<p><strong>Topt</strong>(x,y) 为某一区域一年内 <strong>NDVI</strong> 值到达最高时的当月平均气温（单位℃），当某个月的平均气温低于或等于-10℃，<strong>Tε1</strong>(x,y) 取值为0，此时不会发生光合作用。</p> 
<p><strong>2、温度胁迫因子2</strong></p> 
<p><img src="https://images2.imgbox.com/0c/d2/kRQhEsez_o.png" alt="***Tε2(x,y,t)=1.18141/(1+e^(0.2*[Topt(x,y)-10-T(x,y,t)]) )*1/(1+e^(0.3×[-Topt(x,y)-10+T(x,y,t)] ) )***	(2-2)"></p> 
<p>当某个月平均温度 <strong>T</strong>(x,y,t) 比适宜温度 <strong>Topt</strong>(x,y) 高10℃或者低13℃时，该月的 <strong>Tε2</strong>(x,y,t) 等于月平均温度为最适宜温度 <strong>Topt</strong>(x,y) 时 <strong>Tε2</strong>(x,y,t) 的一半。</p> 
<p><strong>3、水分胁迫因子</strong></p> 
<p><img src="https://images2.imgbox.com/5b/89/LGqQ7UIn_o.png" alt="在这里插入图片描述"></p> 
<p><strong>EET</strong>(x,y,t) 表示(x,y)处像元t月份的实际蒸散发量（单位mm），<strong>PET</strong>(x,y,t) 表示(x,y)处像元t月份的潜在蒸散发量（单位mm）。</p> 
<p><img src="https://images2.imgbox.com/66/b0/7WVpAslw_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/49/1d/Hy8scxJx_o.png" alt="在这里插入图片描述"></p> 
<p><strong>P</strong>(x,y,t)表示(x,y)处像元 t月份的降水（单位mm），<strong>Rn</strong>(x,y,t) 表示(x,y)处像元t月份的地表净辐射量（单位MJ/m2）。</p> 
<p><img src="https://images2.imgbox.com/68/67/SYo9XDJi_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/95/76/Qu206MP3_o.png" alt="在这里插入图片描述"></p> 
<p><strong>Ep0</strong>(x,y,t) 表示局地潜在蒸发量（单位mm）。</p> 
<p><img src="https://images2.imgbox.com/f4/8a/tsnBIVCo_o.png" alt="在这里插入图片描述"></p> 
<p><strong>a</strong>(x,y) 为因地而异的常数。</p> 
<p><img src="https://images2.imgbox.com/0b/e2/rXhWNJWv_o.png" alt="在这里插入图片描述"></p> 
<p><strong>I</strong>(x,y) 代表12个月总和热量指标。<br> <img src="https://images2.imgbox.com/42/5e/wVADdjJx_o.png" alt="在这里插入图片描述"></p> 
<p><strong>T</strong>(x,y,t) 为 (x,y) 处像元 t 月份的平均温度。</p> 
<p><strong>4、实际光能利用率</strong></p> 
<p><img src="https://images2.imgbox.com/09/c3/Jsb3CZaO_o.png" alt="在这里插入图片描述"><br> 式中，<strong>Tε1</strong>(x,y) 和 <strong>Tε2</strong>(x,y) 为温度胁迫因子，<strong>Wε</strong>(x,y) 为水分胁迫因子，<strong>εMAX</strong> 为最大光能利用率。</p> 
<p><strong>5、植被层对入射光和有效辐射的吸收比例</strong></p> 
<p><img src="https://images2.imgbox.com/9f/ea/oUPuAuhY_o.png" alt="在这里插入图片描述"></p> 
<p><strong>NDVImax</strong> 和 <strong>NDVImin</strong> 代表草地的 <strong>NDVI</strong> 最大值和最小值，<strong>FPARmin</strong> 和 <strong>FPARmax</strong> 的取值与植被类型无关，分别为0.001 和0.95。</p> 
<p><img src="https://images2.imgbox.com/50/c0/kpEZf4GD_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/a7/71/51ZwFokF_o.png" alt="在这里插入图片描述"></p> 
<p><strong>6、光合有效辐射</strong></p> 
<p><img src="https://images2.imgbox.com/6c/88/efrGjzdI_o.png" alt="在这里插入图片描述"></p> 
<p><strong>SOL</strong>(x,y,t) 表示在 t月份空间位置 (x,y) 处的像元的太阳总辐射能量（单位MJ/m2）；<strong>FAPAR</strong>(x,y,t)表示植被层对入射光和有效辐射的吸收比例。</p> 
<p><strong>7、净初级生产力</strong></p> 
<p><img src="https://images2.imgbox.com/d1/85/XEKHGEUg_o.png" alt="在这里插入图片描述"></p> 
<p><strong>APAR</strong>(x,y,t) 表示在空间位置 (x,y) 处的像元在 t月份吸收的光合有效辐射（单位MJ/m2/月），<strong>ε</strong>(x,y,t) 表示在空间位置 (x,y) 处的像元在 t月份的实际光能利用率（单位g.C/MJ）。</p> 
<h2><a id="_IDL_112"></a>三、实现代码 （IDL)</h2> 
<pre><code class="prism language-cpp"><span class="token punctuation">;</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>
<span class="token punctuation">;</span>   基于MODIS数据计算NPP（CASA<span class="token punctuation">)</span>
<span class="token punctuation">;</span>   
<span class="token punctuation">;</span>   将插值后的数据（包括温度、降水、辐射）放入同一个文件夹并命名为Rain_XX<span class="token punctuation">,</span>Temp_XX<span class="token punctuation">,</span>Radiate_XX<span class="token punctuation">,</span>格式为<span class="token punctuation">.</span>tif
<span class="token punctuation">;</span>   将裁剪后的NDVI数据放入一个文件夹下，文件格式变为<span class="token punctuation">.</span>dat
<span class="token punctuation">;</span>   
<span class="token punctuation">;</span>   编写：鸽子
<span class="token punctuation">;</span>   日期：<span class="token number">2020</span><span class="token operator">/</span><span class="token number">7</span><span class="token operator">/</span><span class="token number">14</span>
<span class="token punctuation">;</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>

PRO cal_NPP

  e<span class="token operator">=</span><span class="token function">ENVI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">;</span>读取数据
  work_dir<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'请选择文件路径'</span><span class="token punctuation">,</span><span class="token operator">/</span>directory<span class="token punctuation">)</span><span class="token punctuation">;</span>获取文件路径
  CD<span class="token punctuation">,</span>work_dir
  fns <span class="token operator">=</span> <span class="token function">FILE_SEARCH</span><span class="token punctuation">(</span>work_dir<span class="token punctuation">,</span><span class="token string">'*.tif'</span><span class="token punctuation">,</span>count <span class="token operator">=</span> fnums<span class="token punctuation">)</span>
  
  <span class="token punctuation">;</span>获取文件大小
  data<span class="token operator">=</span><span class="token function">READ_TIFF</span><span class="token punctuation">(</span>fns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  data_size<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>

  <span class="token punctuation">;</span>读取太阳净辐射数据
  data_radiate<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  PRINT<span class="token punctuation">,</span><span class="token function">SIZE</span><span class="token punctuation">(</span>data_radiate<span class="token punctuation">)</span>
  FOR i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">1</span> DO BEGIN
    ENVI_OPEN_FILE<span class="token punctuation">,</span>fns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>r_fid<span class="token operator">=</span>fid
    ENVI_FILE_QUERY<span class="token punctuation">,</span>fid<span class="token punctuation">,</span>dims<span class="token operator">=</span>dims<span class="token punctuation">,</span>interleave<span class="token operator">=</span>interleave<span class="token punctuation">,</span>offset<span class="token operator">=</span>offset
    map_info<span class="token operator">=</span><span class="token function">ENVI_GET_MAP_INFO</span><span class="token punctuation">(</span>fid<span class="token operator">=</span>fid<span class="token punctuation">)</span>
    data_radiate<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">ENVI_GET_DATA</span><span class="token punctuation">(</span>fid<span class="token operator">=</span>fid<span class="token punctuation">,</span>dims<span class="token operator">=</span>dims<span class="token punctuation">,</span>pos<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">;</span>data_radiate<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">read_tiff</span><span class="token punctuation">(</span>fns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">;</span>HELP<span class="token punctuation">,</span>data_radiate<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span>
    ENVI_FILE_MNG<span class="token punctuation">,</span>id<span class="token operator">=</span>fid<span class="token punctuation">,</span><span class="token operator">/</span>remove
  ENDFOR
  data_radiate <span class="token operator">=</span> data_radiate<span class="token operator">/</span><span class="token number">100</span> <span class="token punctuation">;</span>单位转换
  radiate_6_10<span class="token operator">=</span><span class="token function">total</span><span class="token punctuation">(</span>data_radiate<span class="token punctuation">[</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">/</span>NAN<span class="token punctuation">)</span>
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'radiate_6_10s计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>radiate_6_10<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>dsta_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info

  <span class="token punctuation">;</span>读取降雨量数据
  data_rain <span class="token operator">=</span> <span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">;</span>全年总降水量
  rain_year <span class="token operator">=</span> <span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  PRINT<span class="token punctuation">,</span><span class="token function">SIZE</span><span class="token punctuation">(</span>data_rain<span class="token punctuation">)</span>
  FOR i<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token operator">-</span><span class="token number">1</span> DO BEGIN
    ENVI_OPEN_FILE<span class="token punctuation">,</span>fns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>r_fid<span class="token operator">=</span>fid
    ENVI_FILE_QUERY<span class="token punctuation">,</span>fid<span class="token punctuation">,</span>dims<span class="token operator">=</span>dims
    data_rain<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ENVI_GET_DATA</span><span class="token punctuation">(</span>fid<span class="token operator">=</span>fid<span class="token punctuation">,</span>dims<span class="token operator">=</span>dims<span class="token punctuation">,</span>pos<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    rain_year <span class="token operator">+</span><span class="token operator">=</span> data_rain<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span>
    ENVI_FILE_MNG<span class="token punctuation">,</span>id<span class="token operator">=</span>fid<span class="token punctuation">,</span><span class="token operator">/</span>remove
  ENDFOR
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'rain_year计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>rain_year<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>dsta_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info

  <span class="token punctuation">;</span>读取平均气温数据并计算每个月的平均气温
  data_temp <span class="token operator">=</span> <span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  temp_ave <span class="token operator">=</span> <span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  PRINT<span class="token punctuation">,</span><span class="token function">SIZE</span><span class="token punctuation">(</span>data_temp<span class="token punctuation">)</span>
  temp_average<span class="token operator">=</span><span class="token function">FLTARR</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
  FOR i<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token operator">-</span><span class="token number">1</span> DO BEGIN
    ENVI_OPEN_FILE<span class="token punctuation">,</span>fns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>r_fid<span class="token operator">=</span>fid
    ENVI_FILE_QUERY<span class="token punctuation">,</span>fid<span class="token punctuation">,</span>dims<span class="token operator">=</span>dims
    data_temp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">ENVI_GET_DATA</span><span class="token punctuation">(</span>fid<span class="token operator">=</span>fid<span class="token punctuation">,</span>dims<span class="token operator">=</span>dims<span class="token punctuation">,</span>pos<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    temp_ave <span class="token operator">+</span><span class="token operator">=</span> data_temp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>每个像素一年的总温度
    r<span class="token operator">=</span><span class="token function">REFORM</span><span class="token punctuation">(</span>data_temp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    r1<span class="token operator">=</span><span class="token function">WHERE</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r GT <span class="token operator">-</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token function">AND</span><span class="token punctuation">(</span>r LE <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    r2<span class="token operator">=</span>r<span class="token punctuation">[</span>r1<span class="token punctuation">]</span>
    temp_average<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">mean</span><span class="token punctuation">(</span>r2<span class="token punctuation">,</span><span class="token operator">/</span><span class="token keyword">double</span><span class="token punctuation">,</span><span class="token operator">/</span>NAN<span class="token punctuation">)</span>  <span class="token punctuation">;</span>每个月的平均温度
    ENVI_FILE_MNG<span class="token punctuation">,</span>id<span class="token operator">=</span>fid<span class="token punctuation">,</span><span class="token operator">/</span>remove
  ENDFOR
  temp_ave<span class="token operator">/</span><span class="token operator">=</span><span class="token number">12</span>
  temp_ave_6_10<span class="token operator">=</span><span class="token function">mean</span><span class="token punctuation">(</span>data_temp<span class="token punctuation">[</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dimension<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">/</span>NAN<span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token number">6</span>至<span class="token number">10</span>月的平均气温
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'temp_ave计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>temp_ave_6_10<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
     nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>dsta_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info

  <span class="token punctuation">;</span>读取NDVI平均值数据<span class="token punctuation">,</span>并获取NDVI最大值月份
  work_dir1<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'请选择NDVI文件路径'</span><span class="token punctuation">,</span><span class="token operator">/</span>directory<span class="token punctuation">)</span><span class="token punctuation">;</span>获取文件路径
  CD<span class="token punctuation">,</span>work_dir1
  fns_NDVI <span class="token operator">=</span> <span class="token function">FILE_SEARCH</span><span class="token punctuation">(</span>work_dir1<span class="token punctuation">,</span><span class="token string">'*.dat'</span><span class="token punctuation">,</span>count <span class="token operator">=</span> fnums_NDVI<span class="token punctuation">)</span>
  <span class="token punctuation">;</span>PRINT<span class="token punctuation">,</span>fns_NDVI<span class="token punctuation">,</span>fnums_NDVI

  data_NDVI<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  FVC<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  PRINT<span class="token punctuation">,</span><span class="token function">SIZE</span><span class="token punctuation">(</span>data_NDVI<span class="token punctuation">)</span>
  NDVI_average<span class="token operator">=</span><span class="token function">FLTARR</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
  NDVI_min<span class="token operator">=</span><span class="token function">FLTARR</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
  NDVI_max<span class="token operator">=</span><span class="token function">FLTARR</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
  NDVI_ave_max <span class="token operator">=</span><span class="token number">0.0</span>
  FOR i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">1</span> DO BEGIN
    ENVI_OPEN_FILE<span class="token punctuation">,</span>fns_NDVI<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>r_fid<span class="token operator">=</span>fid
    ENVI_FILE_QUERY<span class="token punctuation">,</span>fid<span class="token punctuation">,</span>dims<span class="token operator">=</span>dims
    data_NDVI<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">ENVI_GET_DATA</span><span class="token punctuation">(</span>fid<span class="token operator">=</span>fid<span class="token punctuation">,</span>dims<span class="token operator">=</span>dims<span class="token punctuation">,</span>pos<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">;</span>    print<span class="token punctuation">,</span>data_NDVI<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">]</span>
    r<span class="token operator">=</span><span class="token function">REFORM</span><span class="token punctuation">(</span><span class="token function">REFORM</span><span class="token punctuation">(</span>data_NDVI<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    a<span class="token operator">=</span><span class="token function">WHERE</span><span class="token punctuation">(</span><span class="token function">FINITE</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span>
    r1<span class="token operator">=</span>r<span class="token punctuation">[</span>a<span class="token punctuation">]</span>
    b<span class="token operator">=</span><span class="token function">WHERE</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r1 LT <span class="token number">1</span><span class="token punctuation">)</span> AND <span class="token punctuation">(</span>r1 GT <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    r2<span class="token operator">=</span>r1<span class="token punctuation">[</span>b<span class="token punctuation">]</span>
    NDVI_average<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">mean</span><span class="token punctuation">(</span>r2<span class="token punctuation">,</span><span class="token operator">/</span>NAN<span class="token punctuation">)</span>
    NDVI_min<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">MIN</span><span class="token punctuation">(</span>r2<span class="token punctuation">,</span><span class="token operator">/</span>NAN<span class="token punctuation">)</span>
    NDVI_max<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">MAX</span><span class="token punctuation">(</span>r2<span class="token punctuation">,</span><span class="token operator">/</span>NAN<span class="token punctuation">)</span>
    <span class="token punctuation">;</span>计算植被覆盖度
    FVC<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>data_NDVI<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">-</span>NDVI_min<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>NDVI_max<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>NDVI_min<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    IF NDVI_average<span class="token punctuation">[</span>i<span class="token punctuation">]</span> GT NDVI_ave_max THEN BEGIN
      NDVI_ave_max <span class="token operator">=</span> NDVI_average<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
      NDVI_max_mouth <span class="token operator">=</span> i<span class="token operator">+</span><span class="token number">1</span>
    ENDIF
    ENVI_FILE_MNG<span class="token punctuation">,</span>id<span class="token operator">=</span>fid<span class="token punctuation">,</span><span class="token operator">/</span>remove
  ENDFOR
  PRINT<span class="token punctuation">,</span><span class="token string">'NDVI_max_mouth='</span><span class="token punctuation">,</span>NDVI_max_mouth

  <span class="token punctuation">;</span>NDVI和FVC最大值合成
  ANDVI<span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>data_NDVI<span class="token punctuation">,</span>dimension<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">/</span>NAN<span class="token punctuation">)</span>
  ANDVI<span class="token operator">=</span><span class="token punctuation">(</span>ANDVI <span class="token operator">&lt;</span> <span class="token number">1.1</span><span class="token punctuation">)</span>
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'ANDVI计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>ANDVI<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>dsta_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info
    
  AFVC<span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>FVC<span class="token punctuation">,</span>dimension<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">/</span>NAN<span class="token punctuation">)</span>
  AFVC<span class="token operator">=</span><span class="token punctuation">(</span>ANDVI <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'AFVC计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>AFVC<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>dsta_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info
    
  <span class="token punctuation">;</span>释放空间
  r<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  r1<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  a<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  r2<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  b<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>

  <span class="token punctuation">;</span>温度胁迫因子<span class="token number">1</span>
  <span class="token punctuation">;</span>temp_stress1<span class="token operator">=</span><span class="token function">cal_temp_stress1</span><span class="token punctuation">(</span>data_temp<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  temp_stress1<span class="token operator">=</span> <span class="token number">0.8</span><span class="token operator">+</span><span class="token number">0.02</span><span class="token operator">*</span>data_temp<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">0.0005</span><span class="token operator">*</span>data_temp<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span>
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'温度胁迫因子1计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>temp_stress1<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>dsta_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info

  <span class="token punctuation">;</span>温度胁迫因子<span class="token number">2</span>
  temp_stress2 <span class="token operator">=</span> <span class="token function">cal_temp_stress2</span><span class="token punctuation">(</span>data_temp<span class="token punctuation">,</span>temp_average<span class="token punctuation">,</span>NDVI_max_mouth<span class="token punctuation">)</span>
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'温度胁迫因子2计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>temp_stress2<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>dsta_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info

  <span class="token punctuation">;</span>计算水分胁迫因子
  W<span class="token operator">=</span><span class="token function">cal_water_stress</span><span class="token punctuation">(</span>data_temp<span class="token punctuation">,</span>data_rain<span class="token punctuation">)</span>
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'水分胁迫银因子计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>W<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>dsta_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info

  <span class="token punctuation">;</span>计算FPAR
  FPAR<span class="token operator">=</span><span class="token function">cal_FPAR</span><span class="token punctuation">(</span>data_NDVI<span class="token punctuation">,</span>NDVI_min<span class="token punctuation">,</span>NDVI_max<span class="token punctuation">)</span>
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'FPAR计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>FPAR<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>dsta_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info

  data_temp<span class="token operator">=</span><span class="token operator">!</span>null
  data_rain<span class="token operator">=</span><span class="token operator">!</span>null
  
  <span class="token punctuation">;</span>创建数组计算NPP
  real_use_rate<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  APAR<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  NPP<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  ANPP<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  FOR i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">11</span> DO BEGIN

    <span class="token punctuation">;</span>实际光能利用率
    max_use_rate<span class="token operator">=</span><span class="token number">0.389</span>
    <span class="token punctuation">;</span>植被层对入射光合有效辐射吸收比例
    real_use_rate<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp_stress1<span class="token operator">*</span>temp_stress2<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">*</span>W<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">*</span>max_use_rate
    <span class="token punctuation">;</span>光和有效辐射
    APAR<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span>data_radiate<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">*</span>FPAR<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">0.5</span>    
    <span class="token punctuation">;</span>净初级生产力
    NPP<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span>APAR<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">*</span>real_use_rate<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span>
    <span class="token punctuation">;</span>全年累计净初级生产力
    IF NPP<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">]</span> GE <span class="token number">0</span> THEN BEGIN
      ANPP <span class="token operator">+</span><span class="token operator">=</span> NPP<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span>
    ENDIF
    
  ENDFOR

  <span class="token punctuation">;</span>保存输出结果
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'real_use_rate计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>real_use_rate<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>data_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info
    
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'APAR计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span> APAR<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>data_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info
    
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'NPP计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>NPP<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>data_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info
    
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'ANPP计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>ANPP<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>data_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info
 
END

<span class="token punctuation">;</span>计算温度胁迫因子<span class="token number">1</span>
FUNCTION cal_temp_stress1<span class="token punctuation">,</span>data
  temp_stress1 <span class="token operator">=</span> <span class="token number">0.8</span><span class="token operator">+</span><span class="token number">0.02</span><span class="token operator">*</span>data<span class="token operator">-</span><span class="token number">0.0005</span><span class="token operator">*</span>data<span class="token operator">^</span><span class="token number">2</span>
  w<span class="token operator">=</span><span class="token function">WHERE</span><span class="token punctuation">(</span>data LE <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span>
  temp_stress1<span class="token punctuation">[</span>w<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0.0</span>
  RETURN<span class="token punctuation">,</span>temp_stress1
END

<span class="token punctuation">;</span>计算温度胁迫因子<span class="token number">2</span>
FUNCTION cal_temp_stress2<span class="token punctuation">,</span>data_temp<span class="token punctuation">,</span>temp_average<span class="token punctuation">,</span>NDVI_max_mouth

  data_size<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>data_temp<span class="token punctuation">)</span>
  temp_stress2<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token punctuation">;</span>计算最大气温月份的温度胁迫因子
  before <span class="token operator">=</span> <span class="token number">1.1814</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token function">EXP</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token operator">*</span><span class="token punctuation">(</span>data_temp<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span>data_temp<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  after <span class="token operator">=</span> <span class="token number">1.0</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token function">EXP</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">-</span>data_temp<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">+</span>data_temp<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  temp_stress2<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">=</span> before<span class="token operator">*</span>after

  FOR i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">1</span> DO BEGIN
    IF <span class="token punctuation">(</span><span class="token punctuation">(</span>temp_average<span class="token punctuation">[</span>i<span class="token punctuation">]</span> GT temp_average<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span>$
      <span class="token function">OR</span><span class="token punctuation">(</span>temp_average<span class="token punctuation">[</span>i<span class="token punctuation">]</span> LT temp_average<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span> THEN BEGIN
      temp_stress2<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0.5</span><span class="token operator">*</span>  temp_stress2<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span>
    ENDIF ELSE BEGIN
      before<span class="token operator">=</span><span class="token number">1.1814</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token function">EXP</span><span class="token punctuation">(</span>data_temp<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span>data_temp<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      after<span class="token operator">=</span><span class="token number">1.0</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token function">EXP</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">-</span>data_temp<span class="token punctuation">[</span>NDVI_max_mouth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span>data_temp<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      temp_stress2<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span>before<span class="token operator">+</span>after
    ENDELSE
  ENDFOR

  before<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  after<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  RETURN<span class="token punctuation">,</span>temp_stress2
END

<span class="token punctuation">;</span>计算水分胁迫因子
FUNCTION cal_water_stress<span class="token punctuation">,</span>data_temp<span class="token punctuation">,</span>data_rain

  <span class="token punctuation">;</span>十二个月总和热量指标
  I <span class="token operator">=</span> <span class="token function">total</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data_temp<span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">1.514</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">/</span>NAN<span class="token punctuation">)</span>
  data_size <span class="token operator">=</span> <span class="token function">SIZE</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span>
 
  <span class="token punctuation">;</span>因地而异的常数
  a<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.6751</span><span class="token operator">*</span>I<span class="token operator">^</span><span class="token number">3</span><span class="token operator">-</span><span class="token number">77.1</span><span class="token operator">*</span>I<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">17920</span><span class="token operator">*</span>I<span class="token operator">+</span><span class="token number">482390</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1000000</span>
  data_size<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>data_temp<span class="token punctuation">)</span>

  <span class="token punctuation">;</span>开辟空间
  Ep0<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  Rn<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  EET<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  PET<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  W<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  FOR k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">11</span> DO BEGIN
    <span class="token punctuation">;</span>局地潜在蒸发量
    Ep0<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">16</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span>data_temp<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">/</span>I<span class="token punctuation">)</span><span class="token operator">^</span>a
    <span class="token punctuation">;</span>像元此月份的地表净辐射量
    Rn<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Ep0<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">*</span>data_rain<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0.369</span><span class="token operator">+</span><span class="token number">0.598</span><span class="token operator">*</span><span class="token punctuation">(</span>Ep0<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">/</span>data_rain<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    <span class="token punctuation">;</span>此月份的实际蒸散发量
    EET<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data_rain<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">*</span> Rn<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>data_rain<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> Rn<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> data_rain<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">*</span> Rn<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>$
      <span class="token punctuation">(</span><span class="token punctuation">(</span>data_rain<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">+</span> Rn<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>data_rain<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> Rn<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">;</span>此月份的潜在蒸散量
    PET<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>EET<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">+</span> Ep0<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
    <span class="token punctuation">;</span>水分胁迫因子
    W<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.5</span><span class="token operator">+</span><span class="token number">0.5</span><span class="token operator">*</span>EET<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">/</span>PET<span class="token punctuation">[</span>k<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span>
  ENDFOR

  I<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  a<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  Ep0<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  Rn<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  EET<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  PET<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  RETURN<span class="token punctuation">,</span>W
END

<span class="token punctuation">;</span>计算FPAR
FUNCTION cal_FPAR<span class="token punctuation">,</span>data_NDVI<span class="token punctuation">,</span>NDVI_min<span class="token punctuation">,</span>NDVI_max

  data_size<span class="token operator">=</span><span class="token function">SIZE</span><span class="token punctuation">(</span>data_NDVI<span class="token punctuation">)</span>

  <span class="token punctuation">;</span>开辟空间
  SR<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  FPAR_NDVI<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  FPAR_SR<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  FPAR<span class="token operator">=</span><span class="token function">MAKE_ARRAY</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>type<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  SR_min<span class="token operator">=</span><span class="token function">FLTARR</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> SR_max<span class="token operator">=</span><span class="token function">FLTARR</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>

  <span class="token punctuation">;</span>参数设置
  FPAR_min<span class="token operator">=</span><span class="token number">0.001</span> <span class="token operator">&amp;</span> FPAR_max<span class="token operator">=</span><span class="token number">0.95</span>

  <span class="token punctuation">;</span>循环计算
  FOR i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">11</span> DO BEGIN
    SR<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>data_NDVI<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>data_NDVI<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    SR_min<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">MIN</span><span class="token punctuation">(</span>SR<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">/</span>NAN<span class="token punctuation">)</span>
    SR_max<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">MAX</span><span class="token punctuation">(</span>SR<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">/</span>NAN<span class="token punctuation">)</span>
    FPAR_NDVI<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>data_NDVI<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">-</span>NDVI_min<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>FPAR_max<span class="token operator">-</span>FPAR_min<span class="token punctuation">)</span>$
      <span class="token operator">/</span><span class="token punctuation">(</span>NDVI_max<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>NDVI_min<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>FPAR_min
    FPAR_SR<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>SR<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">-</span>SR_min<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>FPAR_max<span class="token operator">-</span>FPAR_min<span class="token punctuation">)</span>$
      <span class="token operator">/</span><span class="token punctuation">(</span>SR_max<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>SR_min<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>FPAR_min
    FPAR<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>FPAR_NDVI<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">+</span>FPAR_SR<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">0.5</span>
  ENDFOR
    <span class="token punctuation">;</span>保存文件
  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'FPAR_NDVI计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span>FPAR_NDVI<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>data_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info

  o_fn<span class="token operator">=</span><span class="token function">DIALOG_PICKFILE</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'FPAR_SR计算结果保存为'</span><span class="token punctuation">)</span>
  ENVI_WRITE_ENVI_FILE<span class="token punctuation">,</span> FPAR_SR<span class="token punctuation">,</span>out_name<span class="token operator">=</span>o_fn<span class="token punctuation">,</span><span class="token operator">/</span>no_copy<span class="token punctuation">,</span>ns<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$
    nl<span class="token operator">=</span>data_size<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nb<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>data_type<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>interleave<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>offset<span class="token operator">=</span>offset<span class="token punctuation">,</span>map_info<span class="token operator">=</span>map_info
    
  <span class="token punctuation">;</span>释放空间
  SR<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  FPAR_NDVI<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>
  FPAR_SR<span class="token operator">=</span><span class="token operator">!</span><span class="token constant">NULL</span>

  RETURN<span class="token punctuation">,</span>FPAR
END

</code></pre> 
<font color="#999AAA"> </font>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f7a72abbfe768586b31bcd4992a6b7f7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">canny算子图像处理实现（C&#43;&#43;）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/78aa73a2098f283402bcf94182a8a4b3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">软件开发面试题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>