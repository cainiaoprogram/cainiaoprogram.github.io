<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MT6580 Android N camera调试 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MT6580 Android N camera调试" />
<meta property="og:description" content="MT6580 Android N camera调试 1.硬件原理2.平台配置3.kernel配置3.1config配置3.2 dts3.3driver code3.4 闪光的控制 4.hal配置4.1camera配置4.2闪光的效果调试 5.Android层配置6.DEBUG6.1成像方向的修改6.2 成像效果调试6.3压力测试概率黑屏卡死等问题6.4前置 camera 没有搭配闪光灯,如何关闭闪光灯图标6.5打开 EIS 录像变暗6.6关闭闪光灯白平衡以改良拍照效果6.7修改闪光灯阀值 1.硬件原理 如下图所示，以后单摄为例：
备注：camera的上电部分很重要，要分清楚几路上电的电压，理解上电时序控制。比如对于格科微的camera芯片来说，有些是1.8V，有些是1.2V。这个调试上电时序的时候要和FAE咨询清楚，不然会导致一些不可预测的后果，比如画面绿屏等。
2.平台配置 alps/device/zechin/zechin6580_we_m$ vim ProjectConfig.mk 添加 HAL and KERNEL 摄像头驱动模组 CUSTOM_HAL_IMGSENSOR = gc8024mipi_raw gc5005_mipi_raw gc2365_mipi_raw gc030amipi_raw CUSTOM_HAL_MAIN_IMGSENSOR = gc8024mipi_raw gc5005_mipi_raw CUSTOM_HAL_SUB_IMGSENSOR = gc2365_mipi_raw gc030amipi_raw CUSTOM_KERNEL_IMGSENSOR= gc8024mipi_raw gc5005_mipi_raw gc2365_mipi_raw gc030amipi_raw CUSTOM_KERNEL_MAIN_IMGSENSOR = gc8024mipi_raw gc5005_mipi_raw CUSTOM_KERNEL_SUB_IMGSENSOR = gc2365_mipi_raw gc030amipi_raw CUSTOM_HAL_FLASHLIGHT = constant_flashlight 3.kernel配置 3.1config配置 alps/kernel-3.18/arch/arm/configs$ vim zechin6580_we_m_debug_defconfig alps/kernel-3.18/arch/arm/configs$ vim zechin6580_we_m_defconfig CONFIG_CUSTOM_KERNEL_IMGSENSOR=&#34;gc8024mipi_raw gc5005_mipi_raw gc2365_mipi_raw gc030amipi_raw&#34; CONFIG_CUSTOM_KERNEL_FLASHLIGHT=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/acae94c329bd3b9bd1e3abae6ee8bc14/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-29T01:59:42+08:00" />
<meta property="article:modified_time" content="2020-03-29T01:59:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MT6580 Android N camera调试</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>MT6580 Android N camera调试</h4> 
 <ul><li><a href="#1_1" rel="nofollow">1.硬件原理</a></li><li><a href="#2_6" rel="nofollow">2.平台配置</a></li><li><a href="#3kernel_20" rel="nofollow">3.kernel配置</a></li><li><ul><li><a href="#31config_21" rel="nofollow">3.1config配置</a></li><li><a href="#32_dts_28" rel="nofollow">3.2 dts</a></li><li><a href="#33driver_code_111" rel="nofollow">3.3driver code</a></li><li><a href="#34__319" rel="nofollow">3.4 闪光的控制</a></li></ul> 
  </li><li><a href="#4hal_352" rel="nofollow">4.hal配置</a></li><li><ul><li><a href="#41camera_353" rel="nofollow">4.1camera配置</a></li><li><a href="#42_373" rel="nofollow">4.2闪光的效果调试</a></li></ul> 
  </li><li><a href="#5Android_379" rel="nofollow">5.Android层配置</a></li><li><a href="#6DEBUG_390" rel="nofollow">6.DEBUG</a></li><li><ul><li><a href="#61_391" rel="nofollow">6.1成像方向的修改</a></li><li><a href="#62__405" rel="nofollow">6.2 成像效果调试</a></li><li><a href="#63_408" rel="nofollow">6.3压力测试概率黑屏卡死等问题</a></li><li><a href="#64_camera__417" rel="nofollow">6.4前置 camera 没有搭配闪光灯,如何关闭闪光灯图标</a></li><li><a href="#65_EIS__424" rel="nofollow">6.5打开 EIS 录像变暗</a></li><li><a href="#66_437" rel="nofollow">6.6关闭闪光灯白平衡以改良拍照效果</a></li><li><a href="#67_449" rel="nofollow">6.7修改闪光灯阀值</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1_1"></a>1.硬件原理</h2> 
<p>如下图所示，以后单摄为例：<br> <img src="https://images2.imgbox.com/27/32/qU76X330_o.png" alt="后单摄连接，多摄暂时不考虑"><br> <img src="https://images2.imgbox.com/96/6b/4JeIVfX8_o.png" alt="闪光灯控制原理"><br> 备注：camera的上电部分很重要，要分清楚几路上电的电压，理解上电时序控制。比如对于格科微的camera芯片来说，有些是1.8V，有些是1.2V。这个调试上电时序的时候要和FAE咨询清楚，不然会导致一些不可预测的后果，比如画面绿屏等。</p> 
<h2><a id="2_6"></a>2.平台配置</h2> 
<pre><code class="prism language-c">alps<span class="token operator">/</span>device<span class="token operator">/</span>zechin<span class="token operator">/</span>zechin6580_we_m$ vim ProjectConfig<span class="token punctuation">.</span>mk
添加 HAL and KERNEL 摄像头驱动模组
CUSTOM_HAL_IMGSENSOR <span class="token operator">=</span> gc8024mipi_raw gc5005_mipi_raw gc2365_mipi_raw gc030amipi_raw
CUSTOM_HAL_MAIN_IMGSENSOR <span class="token operator">=</span> gc8024mipi_raw gc5005_mipi_raw
CUSTOM_HAL_SUB_IMGSENSOR <span class="token operator">=</span> gc2365_mipi_raw gc030amipi_raw
CUSTOM_KERNEL_IMGSENSOR<span class="token operator">=</span> gc8024mipi_raw gc5005_mipi_raw gc2365_mipi_raw gc030amipi_raw
CUSTOM_KERNEL_MAIN_IMGSENSOR <span class="token operator">=</span> gc8024mipi_raw gc5005_mipi_raw
CUSTOM_KERNEL_SUB_IMGSENSOR <span class="token operator">=</span> gc2365_mipi_raw gc030amipi_raw

CUSTOM_HAL_FLASHLIGHT <span class="token operator">=</span> constant_flashlight 
</code></pre> 
<h2><a id="3kernel_20"></a>3.kernel配置</h2> 
<h3><a id="31config_21"></a>3.1config配置</h3> 
<pre><code class="prism language-c">alps<span class="token operator">/</span>kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>arch<span class="token operator">/</span>arm<span class="token operator">/</span>configs$ vim zechin6580_we_m_debug_defconfig alps<span class="token operator">/</span>kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>arch<span class="token operator">/</span>arm<span class="token operator">/</span>configs$ vim zechin6580_we_m_defconfig
CONFIG_CUSTOM_KERNEL_IMGSENSOR<span class="token operator">=</span><span class="token string">"gc8024mipi_raw gc5005_mipi_raw gc2365_mipi_raw gc030amipi_raw"</span>
CONFIG_CUSTOM_KERNEL_FLASHLIGHT<span class="token operator">=</span><span class="token string">"constant_flashlight"</span>
</code></pre> 
<h3><a id="32_dts_28"></a>3.2 dts</h3> 
<pre><code class="prism language-c">alps<span class="token operator">/</span>kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>arch<span class="token operator">/</span>arm<span class="token operator">/</span>boot<span class="token operator">/</span>dts<span class="token operator">/</span>cust_i2c<span class="token punctuation">.</span>dtsi
<span class="token operator">&amp;</span>i2c0 <span class="token punctuation">{<!-- --></span>
	camera_main@<span class="token number">10</span> <span class="token punctuation">{<!-- --></span>
		compatible <span class="token operator">=</span> <span class="token string">"mediatek,camera_main"</span><span class="token punctuation">;</span>
		reg <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">0x10</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	camera_main_af@<span class="token number">0</span>c <span class="token punctuation">{<!-- --></span>
		compatible <span class="token operator">=</span> <span class="token string">"mediatek,camera_main_af"</span><span class="token punctuation">;</span>
		reg <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">0x0c</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	camera_sub@<span class="token number">3</span>c <span class="token punctuation">{<!-- --></span>
		compatible <span class="token operator">=</span> <span class="token string">"mediatek,camera_sub"</span><span class="token punctuation">;</span>
		reg <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">0x3c</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

A、根据原理图配置引脚，注意，引脚有两个，后摄、手电筒的控制引脚。
GPIO7 <span class="token operator">&amp;</span>GPIO8 方向为输出，引脚悬空状态
B、DTS 的配置，包括平台 dtsi 和项目 dts 的配置。
alps<span class="token operator">/</span>kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>arch<span class="token operator">/</span>arm<span class="token operator">/</span>boot<span class="token operator">/</span>dts<span class="token operator">/</span>mt6580<span class="token punctuation">.</span>dtsi 
strobe<span class="token punctuation">:</span> strobe@<span class="token number">0</span> <span class="token punctuation">{<!-- --></span> 
	compatible <span class="token operator">=</span> <span class="token string">"mediatek,strobe_gpio"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> 

vim kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>arch<span class="token operator">/</span>arm<span class="token operator">/</span>boot<span class="token operator">/</span>dts<span class="token operator">/</span>zechin6580_we_n<span class="token punctuation">.</span>dts
<span class="token comment">/* strobe start */</span>
<span class="token operator">&amp;</span>pio <span class="token punctuation">{<!-- --></span> 
	strobe_intpin_strobe_stb_h<span class="token punctuation">:</span> stb@<span class="token number">0</span> <span class="token punctuation">{<!-- --></span>
		pins_cmd_dat <span class="token punctuation">{<!-- --></span>
			pins <span class="token operator">=</span> <span class="token operator">&lt;</span>PINMUX_GPIO7__FUNC_GPIO7<span class="token operator">&gt;</span><span class="token punctuation">;</span> slew<span class="token operator">-</span>rate <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
			bias<span class="token operator">-</span>pull<span class="token operator">-</span>up <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">00</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> output<span class="token operator">-</span>high<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	strobe_intpin_strobe_stb_l<span class="token punctuation">:</span> stb@<span class="token number">1</span> <span class="token punctuation">{<!-- --></span>
		pins_cmd_dat <span class="token punctuation">{<!-- --></span>
			pins <span class="token operator">=</span> <span class="token operator">&lt;</span>PINMUX_GPIO7__FUNC_GPIO7<span class="token operator">&gt;</span><span class="token punctuation">;</span> slew<span class="token operator">-</span>rate <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
			bias<span class="token operator">-</span>pull<span class="token operator">-</span>up <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">00</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> output<span class="token operator">-</span>low<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	strobe_intpin_strobe_en_h<span class="token punctuation">:</span> en@<span class="token number">0</span> <span class="token punctuation">{<!-- --></span>
		pins_cmd_dat <span class="token punctuation">{<!-- --></span>
			pins <span class="token operator">=</span> <span class="token operator">&lt;</span>PINMUX_GPIO8__FUNC_GPIO8<span class="token operator">&gt;</span><span class="token punctuation">;</span> slew<span class="token operator">-</span>rate <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
			bias<span class="token operator">-</span>pull<span class="token operator">-</span>up <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">00</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> output<span class="token operator">-</span>high<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	strobe_intpin_strobe_en_l<span class="token punctuation">:</span> en@<span class="token number">1</span> <span class="token punctuation">{<!-- --></span>
		pins_cmd_dat <span class="token punctuation">{<!-- --></span>
			pins <span class="token operator">=</span> <span class="token operator">&lt;</span>PINMUX_GPIO8__FUNC_GPIO8<span class="token operator">&gt;</span><span class="token punctuation">;</span> slew<span class="token operator">-</span>rate <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
			bias<span class="token operator">-</span>pull<span class="token operator">-</span>up <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">00</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> output<span class="token operator">-</span>low<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	sub_strobe_intpin_strobe_en_h<span class="token punctuation">:</span> sub_en@<span class="token number">0</span> <span class="token punctuation">{<!-- --></span>
		pins_cmd_dat <span class="token punctuation">{<!-- --></span>
			pins <span class="token operator">=</span> <span class="token operator">&lt;</span>PINMUX_GPIO21__FUNC_GPIO21<span class="token operator">&gt;</span><span class="token punctuation">;</span> slew<span class="token operator">-</span>rate <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
			bias<span class="token operator">-</span>pull<span class="token operator">-</span>up <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">00</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> output<span class="token operator">-</span>high<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>	
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	sub_strobe_intpin_strobe_en_l<span class="token punctuation">:</span> sub_en@<span class="token number">1</span> <span class="token punctuation">{<!-- --></span>
		pins_cmd_dat <span class="token punctuation">{<!-- --></span>
			pins <span class="token operator">=</span> <span class="token operator">&lt;</span>PINMUX_GPIO21__FUNC_GPIO21<span class="token operator">&gt;</span><span class="token punctuation">;</span> slew<span class="token operator">-</span>rate <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
			bias<span class="token operator">-</span>pull<span class="token operator">-</span>up <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">00</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> output<span class="token operator">-</span>low<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	strobe_intpin_default<span class="token punctuation">:</span> strobedefaultcfg <span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&amp;</span>strobe <span class="token punctuation">{<!-- --></span>
	pinctrl<span class="token operator">-</span>names <span class="token operator">=</span> <span class="token string">"pin_default"</span><span class="token punctuation">,</span> <span class="token string">"strobe_stb_h"</span><span class="token punctuation">,</span> <span class="token string">"strobe_stb_l"</span><span class="token punctuation">,</span> <span class="token string">"strobe_en_h"</span><span class="token punctuation">,</span> <span class="token string">"strobe_en_l"</span><span class="token punctuation">,</span> <span class="token string">"sub_strobe_en_h"</span><span class="token punctuation">,</span> <span class="token string">"sub_strobe_en_l"</span><span class="token punctuation">;</span>
	pinctrl<span class="token operator">-</span><span class="token number">0</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&amp;</span>strobe_intpin_default<span class="token operator">&gt;</span><span class="token punctuation">;</span>
	pinctrl<span class="token operator">-</span><span class="token number">1</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&amp;</span>strobe_intpin_strobe_stb_h<span class="token operator">&gt;</span><span class="token punctuation">;</span>
	pinctrl<span class="token operator">-</span><span class="token number">2</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&amp;</span>strobe_intpin_strobe_stb_l<span class="token operator">&gt;</span><span class="token punctuation">;</span>
	pinctrl<span class="token operator">-</span><span class="token number">3</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&amp;</span>strobe_intpin_strobe_en_h<span class="token operator">&gt;</span><span class="token punctuation">;</span>
	pinctrl<span class="token operator">-</span><span class="token number">4</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&amp;</span>strobe_intpin_strobe_en_l<span class="token operator">&gt;</span><span class="token punctuation">;</span>
	pinctrl<span class="token operator">-</span><span class="token number">5</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&amp;</span>sub_strobe_intpin_strobe_en_h<span class="token operator">&gt;</span><span class="token punctuation">;</span>
	pinctrl<span class="token operator">-</span><span class="token number">6</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&amp;</span>sub_strobe_intpin_strobe_en_l<span class="token operator">&gt;</span><span class="token punctuation">;</span> 
	status <span class="token operator">=</span> <span class="token string">"okay"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/* strobe end */</span>
</code></pre> 
<h3><a id="33driver_code_111"></a>3.3driver code</h3> 
<pre><code class="prism language-c">alps<span class="token operator">/</span>kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>drivers<span class="token operator">/</span>misc<span class="token operator">/</span>mediatek<span class="token operator">/</span>imgsensor<span class="token operator">/</span>src<span class="token operator">/</span>mt6580$
增加对应驱动，把驱动源码 kernel 目录中所有文件 copy进来
gc8024mipi_raw
gc2365_mipi_raw
gc030amipi_raw<span class="token operator">/</span>
gc5005_mipi_raw<span class="token operator">/</span>

sdk<span class="token operator">/</span>alps<span class="token operator">/</span>kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>drivers<span class="token operator">/</span>misc<span class="token operator">/</span>mediatek<span class="token operator">/</span>imgsensor<span class="token operator">/</span>src<span class="token operator">/</span>mt6580$ 
vim kd_sensorlist<span class="token punctuation">.</span>h
增加对应驱动 Iinit 函数声明
在 kdSensorList 数组中增加对应驱动的配置
UINT32 <span class="token function">GC2365_MIPI_RAW_SensorInit</span><span class="token punctuation">(</span>PSENSOR_FUNCTION_STRUCT <span class="token operator">*</span>pfFunc<span class="token punctuation">)</span><span class="token punctuation">;</span>
UINT32 <span class="token function">GC030AMIPI_RAW_SensorInit</span><span class="token punctuation">(</span>PSENSOR_FUNCTION_STRUCT <span class="token operator">*</span>pfFunc<span class="token punctuation">)</span><span class="token punctuation">;</span>
UINT32 <span class="token function">GC5005MIPI_RAW_SensorInit</span><span class="token punctuation">(</span>PSENSOR_FUNCTION_STRUCT <span class="token operator">*</span>pfFunc<span class="token punctuation">)</span><span class="token punctuation">;</span>
UINT32 <span class="token function">GC8024MIPI_RAW_SensorInit</span><span class="token punctuation">(</span>PSENSOR_FUNCTION_STRUCT <span class="token operator">*</span>pfFunc<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token macro property">#<span class="token directive keyword">if</span> defined(GC2365_MIPI_RAW)</span>
<span class="token punctuation">{<!-- --></span>GC2365_SENSOR_ID<span class="token punctuation">,</span>SENSOR_DRVNAME_GC2365_MIPI_RAW<span class="token punctuation">,</span>GC2365_MIPI_RAW_SensorInt<span class="token punctuation">}</span><span class="token punctuation">,</span> 
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
<span class="token macro property">#<span class="token directive keyword">if</span> defined(GC030AMIPI_RAW)</span>
<span class="token punctuation">{<!-- --></span>GC030AMIPI_SENSOR_ID<span class="token punctuation">,</span> SENSOR_DRVNAME_GC030AMIPI_RAW<span class="token punctuation">,</span>GC030AMIPI_RAW_SensorInit<span class="token punctuation">}</span><span class="token punctuation">,</span> 
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
<span class="token macro property">#<span class="token directive keyword">if</span> defined(GC8024MIPI_RAW)</span>
<span class="token punctuation">{<!-- --></span>GC8024MIPI_SENSOR_ID<span class="token punctuation">,</span> SENSOR_DRVNAME_GC8024MIPI_RAW<span class="token punctuation">,</span>GC8024MIPI_RAW_SensorInit<span class="token punctuation">}</span><span class="token punctuation">,</span> 
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
<span class="token macro property">#<span class="token directive keyword">if</span> defined(GC5005_MIPI_RAW)</span>
<span class="token punctuation">{<!-- --></span>GC5005MIPI_SENSOR_ID<span class="token punctuation">,</span> SENSOR_DRVNAME_GC5005MIPI_RAW<span class="token punctuation">,</span>GC5005MIPI_RAW_SensorInit<span class="token punctuation">}</span><span class="token punctuation">,</span> 
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

alps<span class="token operator">/</span>kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>drivers<span class="token operator">/</span>misc<span class="token operator">/</span>mediatek<span class="token operator">/</span>imgsensor<span class="token operator">/</span>inc$ vim kd_imgsensor<span class="token punctuation">.</span>h
增加对应驱动的 SENSOR_ID 和 SENSOR_DRVNAME 定义
<span class="token macro property">#<span class="token directive keyword">define</span> GC2365_SENSOR_ID 0x2365</span>
<span class="token macro property">#<span class="token directive keyword">define</span> GC030AMIPI_SENSOR_ID 0x30A</span>
<span class="token macro property">#<span class="token directive keyword">define</span> GC5005MIPI_SENSOR_ID 0x5005</span>
<span class="token macro property">#<span class="token directive keyword">define</span> GC8024MIPI_SENSOR_ID 0x8024</span>
<span class="token macro property">#<span class="token directive keyword">define</span> SENSOR_DRVNAME_GC2365_MIPI_RAW "gc2365mipiraw" #<span class="token directive keyword">define</span> SENSOR_DRVNAME_GC030AMIPI_RAW "gc030amipiraw" #<span class="token directive keyword">define</span> SENSOR_DRVNAME_GC5005MIPI_RAW "gc5005mipiraw" #<span class="token directive keyword">define</span> SENSOR_DRVNAME_GC8024MIPI_RAW "gc8024mipiraw"</span>

alps<span class="token operator">/</span>kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>drivers<span class="token operator">/</span>misc<span class="token operator">/</span>mediatek<span class="token operator">/</span>imgsensor<span class="token operator">/</span>src<span class="token operator">/</span>mt6580<span class="token operator">/</span>camera_hw$ vim kd_camera_hw<span class="token punctuation">.</span>c
增加对应驱动的上电时序
电源部分：
VCAMD<span class="token punctuation">:</span>就是 DVDD 供电，主要给 ISP 供电，
VCAMD_IO：就是 VDDIO 数字 IO 电源，主要给 IIC 部分供电，
VCAMA<span class="token punctuation">:</span>就是 AVDD 模拟供电，主要给光感区和 ADC 部分供电
VCAM_AF<span class="token punctuation">:</span>是对 camera 自动对焦马达的供电
管脚部分：
reset 管脚
powerdown 管脚

上电时序：
<span class="token keyword">int</span> <span class="token function">kdCISModulePowerOn</span><span class="token punctuation">(</span>CAMERA_DUAL_CAMERA_SENSOR_ENUM SensorIdx<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>currSensorName<span class="token punctuation">,</span> BOOL On<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>mode_name<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span> 
	u32 pinSetIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* default main sensor */</span>
	<span class="token macro property">#<span class="token directive keyword">define</span> IDX_PS_CMRST 0</span>
	<span class="token macro property">#<span class="token directive keyword">define</span> IDX_PS_CMPDN 4</span>
	<span class="token macro property">#<span class="token directive keyword">define</span> IDX_PS_MODE 1</span>
	<span class="token macro property">#<span class="token directive keyword">define</span> IDX_PS_ON 2</span>
	<span class="token macro property">#<span class="token directive keyword">define</span> IDX_PS_OFF 3</span>
	<span class="token macro property">#<span class="token directive keyword">define</span> VOL_2800 2800000</span>
	<span class="token macro property">#<span class="token directive keyword">define</span> VOL_1800 1800000</span>
	<span class="token macro property">#<span class="token directive keyword">define</span> VOL_1500 1500000</span>
	<span class="token macro property">#<span class="token directive keyword">define</span> VOL_1200 1200000</span>
	<span class="token macro property">#<span class="token directive keyword">define</span> VOL_1000 1000000 </span>
	
	u32 pinSet<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span>
	
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">/* for main sensor */</span>
		<span class="token punctuation">{<!-- --></span> 
			<span class="token comment">/* The reset pin of main sensor uses GPIO10 of mt6306, please call mt6306 API to set */</span>
			CAMERA_CMRST_PIN<span class="token punctuation">,</span> 
			CAMERA_CMRST_PIN_M_GPIO<span class="token punctuation">,</span> <span class="token comment">/* mode */</span>
			GPIO_OUT_ONE<span class="token punctuation">,</span> <span class="token comment">/* ON state */</span>
			GPIO_OUT_ZERO<span class="token punctuation">,</span> <span class="token comment">/* OFF state */</span>
			CAMERA_CMPDN_PIN<span class="token punctuation">,</span> 
			CAMERA_CMPDN_PIN_M_GPIO<span class="token punctuation">,</span> 
			GPIO_OUT_ZERO<span class="token punctuation">,</span>
			GPIO_OUT_ONE<span class="token punctuation">,</span> 
		<span class="token punctuation">}</span><span class="token punctuation">,</span> 
		
		<span class="token comment">/* for sub sensor */</span>	
		<span class="token punctuation">{<!-- --></span>
			CAMERA_CMRST1_PIN<span class="token punctuation">,</span> 
			CAMERA_CMRST1_PIN_M_GPIO<span class="token punctuation">,</span> 
			GPIO_OUT_ONE<span class="token punctuation">,</span> 
			GPIO_OUT_ZERO<span class="token punctuation">,</span>
			CAMERA_CMPDN1_PIN<span class="token punctuation">,</span> 
			CAMERA_CMPDN1_PIN_M_GPIO<span class="token punctuation">,</span> 
			GPIO_OUT_ZERO<span class="token punctuation">,</span> 
			GPIO_OUT_ONE<span class="token punctuation">,</span> 
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span> <span class="token punctuation">(</span>DUAL_CAMERA_MAIN_SENSOR <span class="token operator">==</span> SensorIdx<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		pinSetIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> 
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>DUAL_CAMERA_SUB_SENSOR <span class="token operator">==</span> SensorIdx<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		pinSetIdx <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> 
	<span class="token keyword">else</span>	
	<span class="token punctuation">{<!-- --></span> 
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">/* power ON */</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>On<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">PK_DBG</span><span class="token punctuation">(</span><span class="token string">"[PowerON]pinSetIdx:%d, currSensorName: %s\n"</span><span class="token punctuation">,</span> pinSetIdx<span class="token punctuation">,</span> currSensorName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>SENSOR_DRVNAME_GC8024MIPI_RAW<span class="token punctuation">,</span> currSensorName<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">/*According to GC8024 sequence chart modify position*/</span>
			<span class="token comment">/* First Power Pin low and Reset Pin Low */</span> 
			<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMPDN<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMPDN <span class="token operator">+</span> IDX_PS_OFF<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMRST<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMRST <span class="token operator">+</span> IDX_PS_OFF<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">_hwPowerOn</span><span class="token punctuation">(</span>VCAMIO<span class="token punctuation">,</span> VOL_1800<span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">_hwPowerOn</span><span class="token punctuation">(</span>VCAMD<span class="token punctuation">,</span> VOL_1200<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">_hwPowerOn</span><span class="token punctuation">(</span>VCAMA<span class="token punctuation">,</span> VOL_2800<span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">_hwPowerOn</span><span class="token punctuation">(</span>VCAMAF<span class="token punctuation">,</span> VOL_2800<span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			pinSetIdx <span class="token operator">?</span> <span class="token function">ISP_MCLK2_EN</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">ISP_MCLK1_EN</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">/* enable active sensor */</span> 
			<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMPDN<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMPDN <span class="token operator">+</span> IDX_PS_ON<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMRST<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMRST <span class="token operator">+</span> IDX_PS_ON<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			pinSetIdx <span class="token operator">?</span> <span class="token function">ISP_MCLK2_EN</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">ISP_MCLK1_EN</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">/* First Power Pin low and Reset Pin Low */</span> 
			<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMPDN<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMPDN <span class="token operator">+</span> IDX_PS_OFF<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMRST<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMRST <span class="token operator">+</span> IDX_PS_OFF<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">_hwPowerOn</span><span class="token punctuation">(</span>VCAMA<span class="token punctuation">,</span> VOL_2800<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">_hwPowerOn</span><span class="token punctuation">(</span>VCAMIO<span class="token punctuation">,</span> VOL_1800<span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>SENSOR_DRVNAME_GC5005MIPI_RAW<span class="token punctuation">,</span> currSensorName<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span> 
				<span class="token function">_hwPowerOn</span><span class="token punctuation">(</span>VCAMD<span class="token punctuation">,</span> VOL_1200<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">_hwPowerOn</span><span class="token punctuation">(</span>VCAMD<span class="token punctuation">,</span> VOL_1800<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">_hwPowerOn</span><span class="token punctuation">(</span>VCAMAF<span class="token punctuation">,</span> VOL_2800<span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">/* enable active sensor */</span> 
			<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMPDN<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMPDN <span class="token operator">+</span> IDX_PS_ON<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMRST<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMRST <span class="token operator">+</span> IDX_PS_ON<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		pinSetIdx <span class="token operator">=</span> pinSetIdx <span class="token operator">?</span> <span class="token number">0</span> <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMPDN<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMPDN <span class="token operator">+</span> IDX_PS_OFF<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
		<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
		<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMRST<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMRST <span class="token operator">+</span> IDX_PS_OFF<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">/* power OFF */</span>
		<span class="token function">PK_DBG</span><span class="token punctuation">(</span><span class="token string">"[PowerOFF]pinSetIdx:%d\n"</span><span class="token punctuation">,</span> pinSetIdx<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>SENSOR_DRVNAME_GC8024MIPI_RAW<span class="token punctuation">,</span> currSensorName<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">/* Set Power Pin low and Reset Pin Low */</span> 
			<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMPDN<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMPDN <span class="token operator">+</span> IDX_PS_OFF<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMRST<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMRST <span class="token operator">+</span> IDX_PS_OFF<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			pinSetIdx <span class="token operator">?</span> <span class="token function">ISP_MCLK2_EN</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">ISP_MCLK1_EN</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">_hwPowerDown</span><span class="token punctuation">(</span>VCAMAF<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">_hwPowerDown</span><span class="token punctuation">(</span>VCAMA<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">_hwPowerDown</span><span class="token punctuation">(</span>VCAMD<span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">_hwPowerDown</span><span class="token punctuation">(</span>VCAMIO<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			pinSetIdx <span class="token operator">?</span> <span class="token function">ISP_MCLK2_EN</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">ISP_MCLK1_EN</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">/* Set Power Pin low and Reset Pin Low */</span> 
			<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMPDN<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMPDN <span class="token operator">+</span> IDX_PS_OFF<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mtkcam_gpio_set</span><span class="token punctuation">(</span>pinSetIdx<span class="token punctuation">,</span> CAMRST<span class="token punctuation">,</span>pinSet<span class="token punctuation">[</span>pinSetIdx<span class="token punctuation">]</span><span class="token punctuation">[</span>IDX_PS_CMRST <span class="token operator">+</span> IDX_PS_OFF<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">_hwPowerDown</span><span class="token punctuation">(</span>VCAMD<span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">_hwPowerDown</span><span class="token punctuation">(</span>VCAMA<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">_hwPowerDown</span><span class="token punctuation">(</span>VCAMIO<span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token function">_hwPowerDown</span><span class="token punctuation">(</span>VCAMAF<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//_kdCISModulePowerOn_exit_: // return -EIO;</span>
<span class="token punctuation">}</span>
这边的 pinSetIdx 可以反过来，这样就默认打开前摄了，现在是
rear camera 优先。
其次，上电时序，参考各 sensor 的 datasheet 来
</code></pre> 
<h3><a id="34__319"></a>3.4 闪光的控制</h3> 
<pre><code class="prism language-c">alps<span class="token operator">/</span>kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>drivers<span class="token operator">/</span>misc<span class="token operator">/</span>mediatek<span class="token operator">/</span>flashlight<span class="token operator">/</span>src<span class="token operator">/</span>mt6580<span class="token operator">/</span>constant_flashlight<span class="token operator">/</span>leds_strobe<span class="token punctuation">.</span>c 
alps<span class="token operator">/</span>kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>drivers<span class="token operator">/</span>misc<span class="token operator">/</span>mediatek<span class="token operator">/</span>flashlight<span class="token operator">/</span>src<span class="token operator">/</span>mt6580<span class="token operator">/</span>sub_strobe<span class="token punctuation">.</span>c 
alps<span class="token operator">/</span>kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>drivers<span class="token operator">/</span>misc<span class="token operator">/</span>mediatek<span class="token operator">/</span>flashlight<span class="token operator">/</span>src<span class="token operator">/</span>mt6580<span class="token operator">/</span>kd_flashlightlist<span class="token punctuation">.</span>c 
@@ <span class="token operator">-</span><span class="token number">713</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">713</span><span class="token punctuation">,</span><span class="token number">8</span> @@ <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">flashlight_probe</span><span class="token punctuation">(</span><span class="token keyword">struct</span> platform_device <span class="token operator">*</span>dev<span class="token punctuation">)</span>
<span class="token comment">/* init_MUTEX(&amp;flashlight_private.sem); */</span> <span class="token function">sema_init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>flashlight_private<span class="token punctuation">.</span>sem<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token operator">+</span> <span class="token function">strobe_gpio_init</span><span class="token punctuation">(</span>dev<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">+</span> <span class="token function">sub_strobe_gpio_init</span><span class="token punctuation">(</span>dev<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">logI</span><span class="token punctuation">(</span><span class="token string">"[flashlight_probe] Done ~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
@@ <span class="token operator">-</span><span class="token number">755</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">757</span><span class="token punctuation">,</span><span class="token number">13</span> @@ <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">flashlight_shutdown</span><span class="token punctuation">(</span><span class="token keyword">struct</span> platform_device <span class="token operator">*</span>dev<span class="token punctuation">)</span>
<span class="token function">logI</span><span class="token punctuation">(</span><span class="token string">"[flashlight_shutdown] Done ~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
<span class="token operator">+</span>#ifdef CONFIG_OF
<span class="token operator">+</span>	<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> of_device_id strobe_of_ids<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> 
<span class="token operator">+</span>	 	<span class="token punctuation">{<!-- --></span><span class="token punctuation">.</span>compatible <span class="token operator">=</span> <span class="token string">"mediatek,strobe_gpio"</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
<span class="token operator">+</span>	 	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> 
<span class="token operator">+</span>	<span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token operator">+</span>#endif <span class="token operator">+</span>
<span class="token keyword">static</span> <span class="token keyword">struct</span> platform_driver flashlight_platform_driver <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">.</span>probe <span class="token operator">=</span> flashlight_probe<span class="token punctuation">,</span> 
<span class="token punctuation">.</span>remove <span class="token operator">=</span> flashlight_remove<span class="token punctuation">,</span> 
@@ <span class="token operator">-</span><span class="token number">762</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">771</span><span class="token punctuation">,</span><span class="token number">9</span> @@ <span class="token keyword">static</span> <span class="token keyword">struct</span> platform_driver flashlight_platform_driver <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">.</span>driver <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">.</span>name <span class="token operator">=</span> FLASHLIGHT_DEVNAME<span class="token punctuation">,</span> 
<span class="token punctuation">.</span>owner <span class="token operator">=</span> THIS_MODULE<span class="token punctuation">,</span> 

alps<span class="token operator">/</span>kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>drivers<span class="token operator">/</span>misc<span class="token operator">/</span>mediatek<span class="token operator">/</span>flashlight<span class="token operator">/</span>inc<span class="token operator">/</span>kd_flashlight<span class="token punctuation">.</span>h
<span class="token keyword">void</span> <span class="token function">strobe_gpio_init</span><span class="token punctuation">(</span><span class="token keyword">struct</span> platform_device <span class="token operator">*</span>pdev<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">void</span> <span class="token function">sub_strobe_gpio_init</span><span class="token punctuation">(</span><span class="token keyword">struct</span> platform_device <span class="token operator">*</span>pdev<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="4hal_352"></a>4.hal配置</h2> 
<h3><a id="41camera_353"></a>4.1camera配置</h3> 
<pre><code class="prism language-c">sdk<span class="token operator">/</span>alps<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>custom<span class="token operator">/</span>mt6580<span class="token operator">/</span>hal<span class="token operator">/</span>imgsensor$
	增加对应camera的效果调试文件夹
	gc030amipi_raw<span class="token operator">/</span>
	gc5005_mipi_raw<span class="token operator">/</span> 
sdk<span class="token operator">/</span>alps<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>custom<span class="token operator">/</span>mt6580<span class="token operator">/</span>hal<span class="token operator">/</span>imgsensor_src$ vim sensorlist<span class="token punctuation">.</span>cpp
增加对应驱动的 SensorList 描述项，添加 Sensor 列表的定义：

添加对应驱动 SensorList<span class="token punctuation">[</span><span class="token punctuation">]</span>数组中增加对应驱动的配置；

alps<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>custom<span class="token operator">/</span>mt6580<span class="token operator">/</span>hal<span class="token operator">/</span>sendepfeature$
对应驱动定义的我们的相机支持哪些情景模式，有了这个
后，android framework 会根据这些做相应的处理， 然后传入到上层， 上层 java
就可以判断我们是否能支持该模式，

vim gc5005_mipi_raw<span class="token operator">/</span>config<span class="token punctuation">.</span>ftbl<span class="token punctuation">.</span>gc5005_mipi_raw<span class="token punctuation">.</span>

im gc030amipi_raw<span class="token operator">/</span>config<span class="token punctuation">.</span>ftbl<span class="token punctuation">.</span>gc030amipi_raw<span class="token punctuation">.</span>h
</code></pre> 
<h3><a id="42_373"></a>4.2闪光的效果调试</h3> 
<pre><code class="prism language-c">alps<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>custom<span class="token operator">/</span>mt6580<span class="token operator">/</span>hal<span class="token operator">/</span>flashlight<span class="token operator">/</span>flash_tuning_custom_cct<span class="token punctuation">.</span>cpp
</code></pre> 
<h2><a id="5Android_379"></a>5.Android层配置</h2> 
<pre><code class="prism language-c">增加对应驱动的 SENSOR_ID 和 SENSOR_DRVNAME 定义
alps\device\mediatek\common\kernel<span class="token operator">-</span>headers\kd_imgsensor<span class="token punctuation">.</span>h
<span class="token macro property">#<span class="token directive keyword">define</span> GC5005MIPI_SENSOR_ID 							0x5005</span>
<span class="token macro property">#<span class="token directive keyword">define</span> GC030AMIPI_SENSOR_ID 							0x30A</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token macro property">#<span class="token directive keyword">define</span> SENSOR_DRVNAME_GC5005MIPI_RAW					"gc5005mipiraw"</span>
<span class="token macro property">#<span class="token directive keyword">define</span> SENSOR_DRVNAME_GC030AMIPI_RAW					"gc030amipiraw" </span>
</code></pre> 
<h2><a id="6DEBUG_390"></a>6.DEBUG</h2> 
<h3><a id="61_391"></a>6.1成像方向的修改</h3> 
<pre><code class="prism language-c">尽量不要修改平台的方向，以免影响其他模组的调试，通常在driver里面都会有对应成像方向的宏定义，修改driver的宏定义就好
kernel<span class="token operator">-</span><span class="token number">3.18</span><span class="token operator">/</span>drivers<span class="token operator">/</span>misc<span class="token operator">/</span>mediatek<span class="token operator">/</span>imgsensor<span class="token operator">/</span>src<span class="token operator">/</span>mt6580<span class="token operator">/</span>gc5005_mipi_raw<span class="token operator">/</span>gc5005mipi_Sensor<span class="token punctuation">.</span>h
<span class="token operator">*</span> CMOS sensor header file <span class="token operator">*</span>
<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">/</span>
<span class="token comment">//#define IMAGE_NORMAL_MIRROR</span>
<span class="token macro property">#<span class="token directive keyword">define</span> IMAGE_H_MIRROR</span>
<span class="token comment">//#define IMAGE_V_MIRROR</span>
<span class="token comment">//#define IMAGE_HV_MIRROR</span>
<span class="token macro property">#<span class="token directive keyword">ifdef</span> IMAGE_NORMAL_MIRROR</span>
</code></pre> 
<h3><a id="62__405"></a>6.2 成像效果调试</h3> 
<p>这一部风交个FAE来调试，fae会有对应的工具调试。</p> 
<h3><a id="63_408"></a>6.3压力测试概率黑屏卡死等问题</h3> 
<pre><code class="prism language-c">在对应驱动里修改
由 于 timing 的 问 题 ， 先 下 shutter 再 去 调 用
set_max_framerate_by_scenario 函数后
set_max_framerate_by_scenario 里注释：
<span class="token comment">//set_dummy();</span>
</code></pre> 
<h3><a id="64_camera__417"></a>6.4前置 camera 没有搭配闪光灯,如何关闭闪光灯图标</h3> 
<pre><code class="prism language-c">alps<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>custom<span class="token operator">/</span>mt6580<span class="token operator">/</span>halinc<span class="token operator">/</span>aaa<span class="token operator">/</span>flash_tuning_custom2<span class="token punctuation">.</span>h
<span class="token macro property">#<span class="token directive keyword">define</span> SUB_FLASH_SUPPORT 0</span>
</code></pre> 
<h3><a id="65_EIS__424"></a>6.5打开 EIS 录像变暗</h3> 
<pre><code class="prism language-c"><span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>alps<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>hardware<span class="token operator">/</span>mtkcam<span class="token operator">/</span>legacy<span class="token operator">/</span>platform<span class="token operator">/</span>mt6580<span class="token operator">/</span>v1<span class="token operator">/</span>hal<span class="token operator">/</span>adapter<span class="token operator">/</span>MtkDefault<span class="token operator">/</span>MtkDefaultCamParameter<span class="token punctuation">.</span>cpp
@@ <span class="token operator">-</span><span class="token number">247</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">247</span><span class="token punctuation">,</span><span class="token number">7</span> @@ <span class="token function">setParameters</span><span class="token punctuation">(</span><span class="token punctuation">)</span> cam3aParam<span class="token punctuation">.</span>u4ShotMode <span class="token operator">=</span> mpParamsMgr<span class="token operator">-&gt;</span><span class="token function">getShotMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cam3aParam<span class="token punctuation">.</span>u4CamMode <span class="token operator">=</span> mpParamsMgr<span class="token operator">-&gt;</span><span class="token function">getHalAppMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
cam3aParam<span class="token punctuation">.</span>i4RotateDegree <span class="token operator">=</span> mpParamsMgr<span class="token operator">-&gt;</span><span class="token function">getInt</span><span class="token punctuation">(</span>MtkCameraParameters<span class="token punctuation">:</span><span class="token punctuation">:</span>KEY_ROTATION<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token operator">-</span> cam3aParam<span class="token punctuation">.</span>bVideoStabilization <span class="token operator">=</span> mpParamsMgr<span class="token operator">-&gt;</span><span class="token function">getVideoStabilization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token operator">+</span> cam3aParam<span class="token punctuation">.</span>bVideoStabilization <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//mpParamsMgr-&gt;getVideoStabilization();</span>
<span class="token comment">//</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span> p3AHal<span class="token operator">-&gt;</span><span class="token function">setParams</span><span class="token punctuation">(</span>cam3aParam<span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
</code></pre> 
<h3><a id="66_437"></a>6.6关闭闪光灯白平衡以改良拍照效果</h3> 
<pre><code class="prism language-c"><span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>alps<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>custom<span class="token operator">/</span>mt6580<span class="token operator">/</span>hal<span class="token operator">/</span>camera_3a<span class="token operator">/</span>flashawb_tuning_custom<span class="token punctuation">.</span>cpp
@@ <span class="token operator">-</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">5</span> <span class="token operator">+</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">5</span> @@
MBOOL
<span class="token function">isFlashAWBv2Enabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token operator">-</span> <span class="token keyword">return</span> MTRUE<span class="token punctuation">;</span> <span class="token operator">+</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//MTRUE</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="67_449"></a>6.7修改闪光灯阀值</h3> 
<pre><code class="prism language-c">Z<span class="token punctuation">:</span>\ztg\<span class="token number">80</span>m0\s5073\alps\vendor\mediatek\proprietary\custom\mt6580\hal\imgsensor\gc5025mipi_raw\ca mera_AE_PLineTable_gc5025mipi_raw<span class="token punctuation">.</span>h
AETABLE_RPEVIEW_AUTO<span class="token punctuation">,</span> <span class="token comment">//eAETableID</span>
<span class="token number">123</span><span class="token punctuation">,</span> <span class="token comment">//u4TotalIndex</span>
<span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token comment">//u4StrobeTrigerBV</span>
<span class="token operator">+</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token comment">//u4StrobeTrigerBV</span>
<span class="token number">106</span><span class="token punctuation">,</span> <span class="token comment">//i4MaxBV</span>
<span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token comment">//i4MinBV</span>
<span class="token number">90</span><span class="token punctuation">,</span> <span class="token comment">//i4EffectiveMaxBV</span>
备注：阀值：<span class="token number">20</span>、<span class="token number">0</span>、<span class="token operator">-</span><span class="token number">20</span> <span class="token punctuation">.</span>替换代码中所有<span class="token comment">//u4StrobeTrigerBV 项的值。大部分后摄 -20，前摄 0</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e0a214edf25c0ed132dc5f5ff41d6617/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">无线通信信道的衰落特性（大尺度衰落和小尺度衰落）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1e43c6589dcac1413a461f18522e6bd4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">pytorch torchvision.datasets.CIFAR10 读入的数据集的数据类型</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>