<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>YOCTO编译环境的搭建 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="YOCTO编译环境的搭建" />
<meta property="og:description" content="以下内容为原创，欢迎转载，转载请说明来源：http://blog.csdn.net/masterbee/article/details/78687653
一、YOCTO编译环境的搭建
参照《freescale_imx6_yocto.pdf》文档P14-P16页构建yocto编译环境。同时可参考https://linux.cn/article-8268-1.html?amputm_medium=rss。
具体操作步骤如下(有些命令需要su权限，视具体情况而定)：
以下操作基于ubuntu 16.04 64bit系统，预留至少120G硬盘空间，推荐2G内存。
1、apt-get update
2、apt-get install wget git-core unzip make gcc g&#43;&#43; build-essentialsubversion sed autoconf automake texi2html texinfo coreutils diffstatpython-pysqlite2 docbook-utils libsdl1.2-dev libxml-parser-perl libgl1-mesa-devlibglu1-mesa-dev xsltproc desktop-file-utils chrpath groff libtool xterm gawkfop
3、copy poky 的 morty 稳定分支:
git clone -b mortygit://git.yoctoproject.org/poky.git
4、进入poky目录，然后运行下面的命令为 Yocto 开发环境设置（设置/导出）一些环境变量：
source oe-init-build-env
5、若正常，则如下图所示，会自动进入build目录：
6、修改build/conf/local.conf文件，如提供的local.conf文件所示。
7、编译：
bitbake core-image-minimal
一般要编译几个小时，电脑配置不高时，有可能要编译一天。
8、编译完成后，
runqemu qemux86-64为运行新的基于 Yocto 的 Linux 发行版的 qemu 打开一个新屏幕，则表示安装完成。
二、YOCTO BSP编译：
参考http://blog.csdn.net/wince_lover/article/details/51456745来编译yocto的BSP。具体步骤如下：
1、 下载repo：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/44ebe3ec0c13827f83eed185a16489a8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-12-01T15:59:43+08:00" />
<meta property="article:modified_time" content="2017-12-01T15:59:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">YOCTO编译环境的搭建</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong><span style="color:#ff0000;">以下内容为原创，欢迎转载，转载请说明来源：<a href="http://blog.csdn.net/masterbee/article/details/78687653">http://blog.csdn.net/masterbee/article/details/78687653</a></span></strong></p> 
<p><strong>一、YOCTO编译环境的搭建</strong></p> 
<p>参照《freescale_imx6_yocto.pdf》文档P14-P16页构建yocto编译环境。同时可参考<a href="https://linux.cn/article-8268-1.html?amputm_medium=rss" rel="nofollow">https://linux.cn/article-8268-1.html?amputm_medium=rss</a>。</p> 
<p>具体操作步骤如下(有些命令需要su权限，视具体情况而定)：</p> 
<p>以下操作基于ubuntu 16.04 64bit系统，预留至少120G硬盘空间，推荐2G内存。</p> 
<p>1、apt-get update</p> 
<p>2、apt-get install wget git-core unzip make gcc g++ build-essentialsubversion sed autoconf automake texi2html texinfo coreutils diffstatpython-pysqlite2 docbook-utils libsdl1.2-dev libxml-parser-perl libgl1-mesa-devlibglu1-mesa-dev xsltproc desktop-file-utils chrpath groff libtool xterm gawkfop</p> 
<p>3、copy poky 的 morty 稳定分支:</p> 
<p>git clone -b mortygit://git.yoctoproject.org/poky.git</p> 
<p> </p> 
<p>4、进入poky目录，然后运行下面的命令为 Yocto 开发环境设置（设置/导出）一些环境变量：</p> 
<p>source oe-init-build-env</p> 
<p> </p> 
<p>5、若正常，则如下图所示，会自动进入build目录：</p> 
<p> </p> 
<p> <img alt="" class="has" src="https://images2.imgbox.com/ff/ea/DmUpYFpb_o.png"></p> 
<p>6、修改build/conf/local.conf文件，如提供的local.conf文件所示。</p> 
<p> </p> 
<p>7、编译：</p> 
<p>bitbake core-image-minimal</p> 
<p>一般要编译几个小时，电脑配置不高时，有可能要编译一天。</p> 
<p> </p> 
<p>8、编译完成后，</p> 
<p>runqemu qemux86-64为运行新的基于 Yocto 的 Linux 发行版的 qemu 打开一个新屏幕，则表示安装完成。</p> 
<p> </p> 
<p><strong>二、YOCTO BSP编译：</strong></p> 
<p> </p> 
<p>参考<a href="http://blog.csdn.net/wince_lover/article/details/51456745">http://blog.csdn.net/wince_lover/article/details/51456745</a>来编译yocto的BSP。具体步骤如下：</p> 
<p> </p> 
<p>1、  下载repo：</p> 
<p><span style="color:#333333;">mkdir ~/bin (this step may not be needed if the bin folderalready exists)</span><br><span style="color:#333333;">curlhttp://commondatastorage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo</span><br> chmod a+x ~/bin/repo</p> 
<p>2、设置搜索路径：</p> 
<p>export PATH=~/bin:$PATH</p> 
<p> </p> 
<p>3、设置用户名和邮箱</p> 
<p>  gitconfig --global user.name "Your Name"</p> 
<p>  gitconfig --global user.email "Your Email"</p> 
<p>  gitconfig –list</p> 
<p> </p> 
<p>4、获取linux BSP:</p> 
<p>mkdir fsl-release-bsp</p> 
<p>cd fsl-release-bsp</p> 
<p>repo init -ugit://git.freescale.com/imx/fsl-arm-yocto-bsp.git -b imx-3.14.52-1.1.0_ga</p> 
<p>repo sync</p> 
<p>说明：</p> 
<p>    reposync 将会是一个漫长的等待过程，中间可能会出错。如果出错了就重新repo sync，直到成功为止。另外有的时候可能会很长时间不动了，看下载的流量也一直是0，也可以ctrl+C终止，然后重新repo sync。</p> 
<p>    注意在yocto下，我们下载BSP实际上只是一些配置文件，实际编译的时候边编译边下载的，所以在我们下载的BSP里面是找不到代码的。</p> 
<p> </p> 
<p>5、编译BSP前的准备工作：</p> 
<p>格式：</p> 
<p>DISTRO=&lt;distro name&gt;MACHINE=&lt;machine name&gt; source fsl-setup-release.sh -b &lt;build dir&gt;</p> 
<p> </p> 
<p> distro name有下面4个值</p> 
<p> fsl-imx-x11       说明只支持X11 graphics</p> 
<p> fsl-imx-wayland   说明只支持Wayland weston graphics</p> 
<p> fsl-imx-xwayland  说明支持 Wayland graphics 和 X11. </p> 
<p> fsl-imx-fb        说明只支持Frame Buffer graphics 不支持   X11 和 Wayland</p> 
<p> </p> 
<p> machine name 对应我们的开发板的类型，有下面的值</p> 
<p> imx6qpsabreauto 、 imx6qpsabresd、 imx6ulevk 、imx6dlsabreauto</p> 
<p> imx6dlsabresd  、  imx6qsabreauto 、 imx6qsabresd 、 imx6slevk 、 imx6solosabreauto</p> 
<p> imx6solosabresd 、 imx6sxsabresd 、 imx6sxsabreauto 、 imx7dsabresd</p> 
<p> </p> 
<p> build dir 是编译的目录，我们可以任意指定一个目录名，编译的时候将在当前目录下新建这个目录。</p> 
<p> </p> 
<p>  例如我是这样设置的</p> 
<p> MACHINE=imx6qsabresd DISTRO=fsl-imx-x11 source ./fsl-setup-release.sh -bimx6q-x11</p> 
<p>  首次运行这个命令的时候会提示时候遵循EULA协议，我们选y就好了。</p> 
<p> </p> 
<p>6、编译BSP：</p> 
<p>设置好后开始编译。</p> 
<p>  我们用bitbake来编译的。</p> 
<p>  格式是 bitbake &lt;project name&gt;</p> 
<p> project name有下面的选项</p> 
<p> core-image-minimal  这个是构建一个能启动的最小的系统</p> 
<p> core-image-base     这个是构建一个只有命令行的系统</p> 
<p> core-image-sato     这个是一个支持X11图形界面的系统</p> 
<p> fsl-image-machine-test 这个imx内核的只有命令行的系统</p> 
<p> fsl-image-gui          这个是IMX内核的不支持qt的图形界面的系统</p> 
<p> fsl-image-qt5          这个是支持qt5的图形界面的系统</p> 
<p>  例如我运行的命令是</p> 
<p> bitbake fsl-image-qt5</p> 
<p> </p> 
<p>7、</p> 
<p>编译过程中，有可能会产生错误，产生错误的时候先尝试再次编译，如果还有相同的错误，再解决。</p> 
<p>编译完成后，在fsl-release-bsp/imx6q-x11/tmp/deploy/images/imx6qsabresd目录下会产生uboot,zImage,rootfs等映象文件。</p> 
<p> </p> 
<p><strong>三、工具链的制作：</strong></p> 
<p>1、  GCC工具链安装包的制作：</p> 
<p>bitbakemeta-toolchain</p> 
<p>编译完成后，在imx6q-x11/tmp/deploy/sdk/目录下生成一个可执行的sh文件。在别的PC上安装即可。</p> 
<p>2、  QT工具链安装包的制作：</p> 
<p>bitbakemeta-toolchain-qt5</p> 
<p> </p> 
<p>注意事项：</p> 
<p>1、使用ubuntu 16.04 64bit，不要使用ubuntu12.04，避免出现一些无法解决的错误。</p> 
<p>2、在编译过程中，有可能有些错误，一般在NXP论坛上都能找到解决方法，视具体问题而定。</p> 
<p>如果我有帮助到您，也欢迎您能帮助我。一个人能够走多远，关键是看他与谁同行。谢谢赞赏。</p> 
<p><img alt="" class="has" height="436" src="https://images2.imgbox.com/b1/b7/gaA5oEJD_o.png" width="413"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7fa4d15e17f73390613125a396328c0a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">oracle查看执行最慢与查询次数最多的sql语句</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bc990dfae1259b9eefc30908b1da7d49/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[微信小程序]聊天对话(文本,图片)的功能(完整代码附效果图)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>