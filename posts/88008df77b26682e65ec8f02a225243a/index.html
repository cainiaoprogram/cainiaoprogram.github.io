<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Nuxt3项目配置项整理 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Nuxt3项目配置项整理" />
<meta property="og:description" content="文章目录 前言一、使用Sass(Scss)二、配置Pinia及持久化存储1. Pinia2. 使用插件为 Pinia Store 提供持久化存储3.使用demo 三、配置Vant及移动端适配1. Vant 42. Viewport 布局3. Rem 布局适配 四、使用head标签与SEO优化五、定义公共变量与环境变量1. 公共变量2. 环境变量3. 运行不同环境 六、Nuxt 开发工具（Nuxt DevTools）七、打包分析八、移除调试代码九、开启gzip或brotli压缩十、本地代理跨域总结 前言 这篇文章介绍一下 Nuxt 3 搭建项目时常用的配置项，包括一些移动端专属的配置项，Nuxt配置写在根目录的nuxt.config文件里，看了这篇文章，相信有助于大家对Vue项目的迁移，尝鲜Nuxt3。
Nuxt可以用一个nuxt.config文件轻松配置，该文件可以有js, ts or mjs扩展名。如果配置中有更改时，Nuxt将完全重新启动，所以无需手动重启服务或刷新浏览器，确实方便了不少。
一、使用Sass(Scss) npm i -D sass （可选）将 assets/css 目录里的scss文件引入全局使用（包含在每个页面中）。
export default defineNuxtConfig({ //... css: [&#39;~/assets/css/app.scss&#39;, &#39;~/assets/css/main.scss&#39;], }); 二、配置Pinia及持久化存储 1. Pinia npm install pinia @pinia/nuxt export default defineNuxtConfig({ // ... modules: [ &#39;@pinia/nuxt&#39;, { autoImports: [ // 自动引入 `defineStore()` &#39;defineStore&#39;, //（可选）自动引入 `defineStore()` 并重命名为 `definePiniaStore()` [&#39;defineStore&#39;, &#39;definePiniaStore&#39;], ], }, ], }) 更多配置参考官方文档：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/88008df77b26682e65ec8f02a225243a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-27T18:30:21+08:00" />
<meta property="article:modified_time" content="2023-07-27T18:30:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Nuxt3项目配置项整理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_4" rel="nofollow">前言</a></li><li><a href="#SassScss_12" rel="nofollow">一、使用Sass(Scss)</a></li><li><a href="#Pinia_27" rel="nofollow">二、配置Pinia及持久化存储</a></li><li><ul><li><a href="#1_Pinia_28" rel="nofollow">1. Pinia</a></li><li><a href="#2__Pinia_Store__56" rel="nofollow">2. 使用插件为 Pinia Store 提供持久化存储</a></li><li><a href="#3demo_75" rel="nofollow">3.使用demo</a></li></ul> 
  </li><li><a href="#Vant_105" rel="nofollow">三、配置Vant及移动端适配</a></li><li><ul><li><a href="#1_Vant_4_106" rel="nofollow">1. Vant 4</a></li><li><a href="#2_Viewport__129" rel="nofollow">2. Viewport 布局</a></li><li><a href="#3_Rem__168" rel="nofollow">3. Rem 布局适配</a></li></ul> 
  </li><li><a href="#headSEO_173" rel="nofollow">四、使用head标签与SEO优化</a></li><li><a href="#_218" rel="nofollow">五、定义公共变量与环境变量</a></li><li><ul><li><a href="#1__219" rel="nofollow">1. 公共变量</a></li><li><a href="#2__240" rel="nofollow">2. 环境变量</a></li><li><a href="#3__253" rel="nofollow">3. 运行不同环境</a></li></ul> 
  </li><li><a href="#Nuxt_Nuxt_DevTools_273" rel="nofollow">六、Nuxt 开发工具（Nuxt DevTools）</a></li><li><a href="#_294" rel="nofollow">七、打包分析</a></li><li><a href="#_324" rel="nofollow">八、移除调试代码</a></li><li><a href="#gzipbrotli_336" rel="nofollow">九、开启gzip或brotli压缩</a></li><li><a href="#_349" rel="nofollow">十、本地代理跨域</a></li><li><a href="#_373" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_4"></a>前言</h2> 
<p>这篇文章介绍一下 Nuxt 3 搭建项目时常用的配置项，包括一些移动端专属的配置项，Nuxt配置写在根目录的nuxt.config文件里，看了这篇文章，相信有助于大家对Vue项目的迁移，尝鲜Nuxt3。</p> 
<hr> 
<blockquote> 
 <p>Nuxt可以用一个nuxt.config文件轻松配置，该文件可以有js, ts or mjs扩展名。如果配置中有更改时，Nuxt将完全重新启动，所以无需手动重启服务或刷新浏览器，确实方便了不少。</p> 
</blockquote> 
<h2><a id="SassScss_12"></a>一、使用Sass(Scss)</h2> 
<pre><code class="prism language-bash"><span class="token function">npm</span> i <span class="token parameter variable">-D</span> sass
</code></pre> 
<p>（可选）将 assets/css 目录里的scss文件引入全局使用（包含在每个页面中）。</p> 
<pre><code class="prism language-typescript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
	<span class="token comment">//...</span>
	css<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'~/assets/css/app.scss'</span><span class="token punctuation">,</span> <span class="token string">'~/assets/css/main.scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="Pinia_27"></a>二、配置Pinia及持久化存储</h2> 
<h3><a id="1_Pinia_28"></a>1. Pinia</h3> 
<pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> pinia @pinia/nuxt
</code></pre> 
<pre><code class="prism language-typescript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// ... </span>
  modules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@pinia/nuxt'</span><span class="token punctuation">,</span>
   	  <span class="token punctuation">{<!-- --></span>
        autoImports<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token comment">// 自动引入 `defineStore()`</span>
          <span class="token string">'defineStore'</span><span class="token punctuation">,</span>
          <span class="token comment">//（可选）自动引入 `defineStore()` 并重命名为 `definePiniaStore()`</span>
          <span class="token punctuation">[</span><span class="token string">'defineStore'</span><span class="token punctuation">,</span> <span class="token string">'definePiniaStore'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>更多配置参考官方文档：</p> 
<ul><li><a href="https://pinia.vuejs.org/zh/ssr/nuxt.html" rel="nofollow">https://pinia.vuejs.org/zh/ssr/nuxt.html</a></li></ul> 
<h3><a id="2__Pinia_Store__56"></a>2. 使用插件为 Pinia Store 提供持久化存储</h3> 
<pre><code class="prism language-bash"><span class="token function">npm</span> i <span class="token parameter variable">-D</span> @pinia-plugin-persistedstate/nuxt
</code></pre> 
<pre><code class="prism language-typescript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// ... </span>
  modules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// ... </span>
    <span class="token string">'@pinia-plugin-persistedstate/nuxt'</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>更多配置参考官方文档：</p> 
<ul><li><a href="https://prazdevs.github.io/pinia-plugin-persistedstate/zh/frameworks/nuxt-3.html" rel="nofollow">https://prazdevs.github.io/pinia-plugin-persistedstate/zh/frameworks/nuxt-3.html</a></li></ul> 
<h3><a id="3demo_75"></a>3.使用demo</h3> 
<pre><code class="prism language-typescript"><span class="token comment">// stores/counter.ts</span>
<span class="token keyword">const</span> <span class="token function-variable function">delay</span> <span class="token operator">=</span> <span class="token punctuation">(</span>t<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> useCounterStore <span class="token operator">=</span> <span class="token function">definePiniaStore</span><span class="token punctuation">(</span><span class="token string">'state'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      n<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      numbers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  getters<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function-variable function">double</span><span class="token operator">:</span> state <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>n <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  actions<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">async</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> n <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>n<span class="token punctuation">;</span>
      <span class="token keyword">await</span> <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>numbers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 持久化存储</span>
  persist<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="Vant_105"></a>三、配置Vant及移动端适配</h2> 
<h3><a id="1_Vant_4_106"></a>1. Vant 4</h3> 
<pre><code class="prism language-bash"><span class="token function">npm</span> i vant @vant/nuxt <span class="token parameter variable">-D</span>
</code></pre> 
<pre><code class="prism language-typescript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// ... </span>
  modules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@vant/nuxt'</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  vant<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
 	<span class="token comment">// ... </span>
 	<span class="token comment">// 懒加载指令依赖此配置</span>
    lazyload<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>更多配置参考官方文档：</p> 
<ul><li><a href="https://vant-contrib.gitee.io/vant/#/zh-CN" rel="nofollow">https://vant-contrib.gitee.io/vant/#/zh-CN</a></li><li><a href="https://github.com/vant-ui/vant-nuxt">https://github.com/vant-ui/vant-nuxt</a></li></ul> 
<h3><a id="2_Viewport__129"></a>2. Viewport 布局</h3> 
<p>以750px的尺寸做为设计稿参考值，兼容Vant 375px视口宽度，使用插件将CSS中的px单位自动转化为vw。<br> 本来是使用<code>postcss-px-to-viewport</code>插件的，但是显示 postcss.plugin was deprecated，查了一下是PostCSS更新到第 8 版，插件的api还没更新过来导致报错。所以换了个插件，使用<code>postcss-px-to-viewport-8-plugin</code>。</p> 
<pre><code class="prism language-bash"><span class="token function">npm</span> i postcss-px-to-viewport-8-plugin <span class="token parameter variable">-D</span>
</code></pre> 
<pre><code class="prism language-typescript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// ... </span>
  postcss<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    plugins<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">'postcss-px-to-viewport-8-plugin'</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        unitToConvert<span class="token operator">:</span> <span class="token string">'px'</span><span class="token punctuation">,</span> <span class="token comment">// 需要转换的单位，默认为"px"</span>
        <span class="token function-variable function">viewportWidth</span><span class="token operator">:</span> <span class="token punctuation">(</span>file<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token comment">// 兼容vant 375px的默认值</span>
          <span class="token keyword">return</span> file<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'vant'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> <span class="token number">375</span> <span class="token operator">:</span> <span class="token number">750</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 设计稿的视口宽度</span>
        unitPrecision<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// 单位转换后保留的精度</span>
        propList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'*'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 能转化为vw的属性列表</span>
        viewportUnit<span class="token operator">:</span> <span class="token string">'vw'</span><span class="token punctuation">,</span> <span class="token comment">// 希望使用的视口单位</span>
        fontViewportUnit<span class="token operator">:</span> <span class="token string">'vw'</span><span class="token punctuation">,</span> <span class="token comment">// 字体使用的视口单位</span>
        selectorBlackList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 需要忽略的CSS选择器，不会转为视口单位，使用原有的px等单位。</span>
        minPixelValue<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 设置最小的转换数值，如果为1的话，只有大于1的值会被转换</span>
        mediaQuery<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 媒体查询里的单位是否需要转换单位</span>
        replace<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//  是否直接更换属性值，而不添加备用属性</span>
        exclude<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token comment">// 忽略某些文件夹下的文件或特定文件，例如 'node_modules' 下的文件</span>
        include<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token comment">// 如果设置了include，那将只有匹配到的文件才会被转换</span>
        landscape<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否添加根据 landscapeWidth 生成的媒体查询条件</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>更多配置参考官方文档：</p> 
<ul><li><a href="https://www.npmjs.com/package/postcss-px-to-viewport-8-plugin" rel="nofollow">https://www.npmjs.com/package/postcss-px-to-viewport-8-plugin</a></li></ul> 
<h3><a id="3_Rem__168"></a>3. Rem 布局适配</h3> 
<p>目前没尝试过，不过找到了一篇好文推荐给大家参考</p> 
<ul><li><a href="https://www.imwty.com/nuxt3/vant-pxtorem/" rel="nofollow">https://www.imwty.com/nuxt3/vant-pxtorem/</a></li></ul> 
<h2><a id="headSEO_173"></a>四、使用head标签与SEO优化</h2> 
<p>在html模板的标签里面定义的内容可以在此处全局设置，即所有页面默认使用该处的配置，以下这些都是常见的配置属性，其中meta属性对SEO(Search Engine Optimization)（搜索引擎优化）比较关键。</p> 
<pre><code class="prism language-typescript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// ... </span>
  app<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    head<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      title<span class="token operator">:</span> <span class="token string">'My First Nuxt Application'</span><span class="token punctuation">,</span>
      viewport<span class="token operator">:</span> <span class="token string">'width=device-width,initial-scale=1,maximum-scale=1'</span><span class="token punctuation">,</span>
      charset<span class="token operator">:</span> <span class="token string">'utf-8'</span><span class="token punctuation">,</span>
      htmlAttrs<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        lang<span class="token operator">:</span> <span class="token string">'en'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      meta<span class="token operator">:</span> <span class="token punctuation">[</span>
      	<span class="token comment">// 页面描述</span>
        <span class="token punctuation">{<!-- --></span> name<span class="token operator">:</span> <span class="token string">'description'</span><span class="token punctuation">,</span> content<span class="token operator">:</span> <span class="token string">'Nuxt前端网站'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 关键词，页面的一个关键词</span>
        <span class="token punctuation">{<!-- --></span> name<span class="token operator">:</span> <span class="token string">'keywords'</span><span class="token punctuation">,</span> content<span class="token operator">:</span> <span class="token string">'Nuxt'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 记录打包时间</span>
        <span class="token punctuation">{<!-- --></span> name<span class="token operator">:</span> <span class="token string">'buildDate'</span><span class="token punctuation">,</span> content<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>另外为了能够更好的处理每个页面，我们可以通过 useHead 这个标签。</p> 
<pre><code class="prism language-typescript"><span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
<span class="token function">useHead</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  title<span class="token operator">:</span> <span class="token string">"我的博客"</span><span class="token punctuation">,</span>
  meta<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span> name<span class="token operator">:</span> <span class="token string">"description"</span><span class="token punctuation">,</span> content<span class="token operator">:</span> <span class="token string">"我的前端博客"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span> name<span class="token operator">:</span> <span class="token string">"keywords"</span><span class="token punctuation">,</span> content<span class="token operator">:</span> <span class="token string">"Hello"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p>更多head配置参考官方文档：</p> 
<ul><li><a href="https://nuxt.com/docs/api/configuration/nuxt-config#head" rel="nofollow">https://nuxt.com/docs/api/configuration/nuxt-config#head</a></li><li><a href="https://nuxt.com/docs/api/composables/use-head" rel="nofollow">https://nuxt.com/docs/api/composables/use-head</a></li></ul> 
<h2><a id="_218"></a>五、定义公共变量与环境变量</h2> 
<h3><a id="1__219"></a>1. 公共变量</h3> 
<p>如果您希望在 Nuxt 3 应用程序中引用环境变量，则需要使用运行时配置（Runtime Config）。</p> 
<pre><code class="prism language-typescript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// ... </span>
  runtimeConfig<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// apiSecret 只能在服务器端上访问</span>
    apiSecret<span class="token operator">:</span> <span class="token string">'123'</span><span class="token punctuation">,</span>
    <span class="token comment">// public 命名空间中定义的，在服务器端和客户端都可以普遍访问</span>
    <span class="token keyword">public</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      apiBase<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NUXT_PUBLIC_API_BASE</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>使用方式：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">useRuntimeConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> baseURL <span class="token operator">=</span> config<span class="token punctuation">.</span>public<span class="token punctuation">.</span>apiBase<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="2__240"></a>2. 环境变量</h3> 
<p>使用前缀为<code>NUXT_</code>的匹配环境变量名来更新运行时配置值。</p> 
<pre><code class="prism language-javascript"><span class="token comment">//.env.development</span>
<span class="token constant">NUXT_PUBLIC_API_BASE</span> <span class="token operator">=</span> <span class="token string">'https://api-test.com'</span>
<span class="token constant">NUXT_API_ENV</span> <span class="token operator">=</span> <span class="token string">'dev'</span>
</code></pre> 
<pre><code class="prism language-javascript"><span class="token comment">//.env.production</span>
<span class="token constant">NUXT_PUBLIC_API_BASE</span> <span class="token operator">=</span> <span class="token string">'https://api.com'</span>
<span class="token constant">NUXT_API_ENV</span> <span class="token operator">=</span> <span class="token string">'prod'</span>
</code></pre> 
<h3><a id="3__253"></a>3. 运行不同环境</h3> 
<blockquote> 
 <p>Nuxt CLI在开发模式下以及运行nuxi build和nuxi generate时内置了dotenv支持。<br> 在开发模式下更新.env文件时，Nuxt实例会自动重新启动以将新值应用于process.env。</p> 
</blockquote> 
<p>dotenv已内置，通过添加 <code>--dotenv</code> + .env文件的命令，能指定不同运行指令运行在不同环境下。</p> 
<pre><code class="prism language-bash">  <span class="token string">"scripts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"build"</span><span class="token builtin class-name">:</span> <span class="token string">"nuxt build --dotenv .env.production"</span>,
    <span class="token string">"dev"</span><span class="token builtin class-name">:</span> <span class="token string">"nuxt dev --dotenv .env.development"</span>,
    <span class="token string">"generate"</span><span class="token builtin class-name">:</span> <span class="token string">"nuxt generate --dotenv .env.production"</span>,
    <span class="token string">"preview"</span><span class="token builtin class-name">:</span> <span class="token string">"nuxt preview"</span>,
    <span class="token string">"postinstall"</span><span class="token builtin class-name">:</span> <span class="token string">"nuxt prepare"</span>
  <span class="token punctuation">}</span>,
</code></pre> 
<p>更多配置参考官方文档：</p> 
<ul><li><a href="https://nuxt.com/docs/api/composables/use-runtime-config" rel="nofollow">https://nuxt.com/docs/api/composables/use-runtime-config</a></li></ul> 
<h2><a id="Nuxt_Nuxt_DevTools_273"></a>六、Nuxt 开发工具（Nuxt DevTools）</h2> 
<p>开启：</p> 
<pre><code class="prism language-bash">npx nuxi devtools <span class="token builtin class-name">enable</span>
</code></pre> 
<p>关闭：</p> 
<pre><code class="prism language-bash">npx nuxi devtools disable
</code></pre> 
<p>配置成开发环境专属：</p> 
<pre><code class="prism language-typescript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// ... </span>
  devtools<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    enabled<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NUXT_API_ENV</span> <span class="token operator">===</span> <span class="token string">'dev'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>更多配置参考官方文档：</p> 
<ul><li><a href="https://github.com/nuxt/devtools">https://github.com/nuxt/devtools</a></li></ul> 
<h2><a id="_294"></a>七、打包分析</h2> 
<p>Nuxt3 集成了Webpack 和 Vite，可以分别对应直接使用 webpack-bundle-analyzer 或 rollup-plugin-visualizer 插件进行可视化依赖包的大小分析，我采用了Vite方案。</p> 
<pre><code class="prism language-typescript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// ... </span>
  build<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    analyze<span class="token operator">:</span>
      <span class="token comment">// 对应需要创建‘analyzer’环境变量相关的配置</span>
      process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NUXT_API_ENV</span> <span class="token operator">===</span> <span class="token string">'analyzer'</span>
        <span class="token operator">?</span> <span class="token punctuation">{<!-- --></span>
            filename<span class="token operator">:</span> <span class="token string">'stats.html'</span><span class="token punctuation">,</span> <span class="token comment">//生成分析网页文件名</span>
            title<span class="token operator">:</span> <span class="token string">'Rollup Visualizer'</span><span class="token punctuation">,</span>
            template<span class="token operator">:</span> <span class="token string">'treemap'</span><span class="token punctuation">,</span>
            <span class="token comment">// template 图表类型 (string, default treemap) - Which diagram type to use: sunburst, treemap, network, raw-data, list.</span>
            open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//在默认用户代理中打开生成的文件</span>
            gzipSize<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//从源代码中收集 gzip 大小并将其显示在图表中</span>
            brotliSize<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//从源代码中收集 brotli 大小并将其显示在图表中</span>
          <span class="token punctuation">}</span>
        <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token comment">// transpile specific dependencies with Babel</span>
    <span class="token comment">// transpile: [],</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>更多配置参考官方文档：</p> 
<ul><li><a href="https://nuxt.com/docs/api/configuration/nuxt-config#analyze" rel="nofollow">https://nuxt.com/docs/api/configuration/nuxt-config#analyze</a></li></ul> 
<h2><a id="_324"></a>八、移除调试代码</h2> 
<pre><code class="prism language-typescript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// ... </span>
  vite<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    esbuild<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      drop<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NUXT_API_ENV</span> <span class="token operator">!==</span> <span class="token string">'dev'</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token string">'console'</span><span class="token punctuation">,</span> <span class="token string">'debugger'</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//移除console与debugger</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="gzipbrotli_336"></a>九、开启gzip或brotli压缩</h2> 
<pre><code class="prism language-typescript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// ... </span>
  nitro<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    compressPublicAssets<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      gzip<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      brotli<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_349"></a>十、本地代理跨域</h2> 
<pre><code class="prism language-typescript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// ... </span>
nitro<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 客户端渲染时</span>
    devProxy<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"/api"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        target<span class="token operator">:</span> <span class="token string">"http://localhost:3001"</span><span class="token punctuation">,</span> <span class="token comment">// 这里是接口地址</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        prependPath<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>更多配置参考官方文档：</p> 
<ul><li><a href="https://nitro.unjs.io/config#devproxy" rel="nofollow">https://nitro.unjs.io/config#devproxy</a></li></ul> 
<hr> 
<h2><a id="_373"></a>总结</h2> 
<p>以上就是全部内容，文章基于Nuxt3最新的3.6版本，也是我最近开发的一些实践，经历了迁移自己的Vue老项目总结归纳而成，也尝鲜过一些好玩的模块功能，学无止境还需要后续多多尝试。总体来说，熟悉了这种约定式编程，使用自动导入的 Nuxt3 开发体验还是很不错的，在调整好配置项后也能让我们放心大胆地进行后续的开发工作。<br> 如果此篇文章对您有帮助，欢迎您【点赞】、【收藏】！也欢迎您【评论】留下宝贵意见，共同探讨一起学习~</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7e16d3c6fd40592b17ac68284f8de843/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">项目文档管理的基本指南</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a7081c9239d4800750db0f8bc9329256/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何用 Nginx 代理 MySQL 连接，并限制可访问IP？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>