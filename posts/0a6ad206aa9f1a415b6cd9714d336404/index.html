<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C语言大作业 俄罗斯方块（一）主界面和排行榜界面 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C语言大作业 俄罗斯方块（一）主界面和排行榜界面" />
<meta property="og:description" content="目录
主界面
排行榜界面
主界面 1.创建绘图窗口，大小为640x360像素
initgraph(640, 360, SHOWCONSOLE); setbkmode(TRANSPARENT); SHOWCONSOLE 显示控制台窗口；
TRANSPARENT 背景是透明的；
2.打开音乐，循环播放音乐
mciSendString(&#34;open BGM.mp3&#34;, NULL, 0, NULL); mciSendString(&#34;play BGM.mp3 repeat&#34;, NULL, 0, NULL); open 打开音乐；
play 播放音乐，repeat 重复播放；
stop 关闭音乐；
3.设置背景图片，文字，声音图标
//背景图片 IMAGE background; loadimage(&amp;background, &#34;background.jpg&#34;, 640, 360); putimage(0, 0, &amp;background); //字体 settextstyle(70, 0, FONT); settextcolor(RGB(65, 105, 225)); outtextxy(160, 50, &#34;俄罗斯方块&#34;); //声音图片 IMAGE sound; loadimage(&amp;sound, &#34;sound.png&#34;, 40, 40); putimage(600, 0, &amp;sound); 4.设置按钮（圆角矩形&#43;文字）
void button(int x, int y, int w, int h, const char* text) { setfillcolor(RGB(240, 248, 255)); fillroundrect(x, y, x &#43; w, y &#43; h, 10, 10); settextstyle(20, 0, FONT); settextcolor(RGB(105, 147, 211)); int tx = x &#43; (w - textwidth(text)) / 2; int ty = y &#43; (h - textheight(text)) / 2; outtextxy(tx, ty, text); } 5." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0a6ad206aa9f1a415b6cd9714d336404/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-04T13:35:44+08:00" />
<meta property="article:modified_time" content="2022-06-04T13:35:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C语言大作业 俄罗斯方块（一）主界面和排行榜界面</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc" style="text-align:left;"><strong>目录</strong></p> 
<p id="%E4%B8%BB%E7%95%8C%E9%9D%A2-toc" style="margin-left:0px;text-align:left;"><a href="#%E4%B8%BB%E7%95%8C%E9%9D%A2" rel="nofollow">主界面</a></p> 
<p id="%E6%8E%92%E8%A1%8C%E6%A6%9C%E7%95%8C%E9%9D%A2-toc" style="margin-left:0px;text-align:left;"><a href="#%E6%8E%92%E8%A1%8C%E6%A6%9C%E7%95%8C%E9%9D%A2" rel="nofollow">排行榜界面</a></p> 
<hr id="hr-toc"> 
<p><img alt="" height="494" src="https://images2.imgbox.com/1b/fe/4MjvbAKP_o.png" width="803"><img alt="" src="https://images2.imgbox.com/ac/5d/L4wWALFB_o.png">       </p> 
<h2 id="%E4%B8%BB%E7%95%8C%E9%9D%A2" style="text-align:left;">主界面</h2> 
<p style="text-align:left;"><strong>1</strong>.创建绘图窗口，大小为640x360像素</p> 
<pre><code>	initgraph(640, 360, SHOWCONSOLE);
	setbkmode(TRANSPARENT);</code></pre> 
<p style="text-align:left;">SHOWCONSOLE 显示控制台窗口；</p> 
<p style="text-align:left;">TRANSPARENT 背景是透明的；</p> 
<p><strong>2</strong>.打开音乐，循环播放音乐</p> 
<pre><code class="language-cpp">	mciSendString("open BGM.mp3", NULL, 0, NULL);

	mciSendString("play BGM.mp3 repeat", NULL, 0, NULL);</code></pre> 
<p>open 打开音乐；</p> 
<p>play   播放音乐，repeat   重复播放；</p> 
<p>stop   关闭音乐；</p> 
<p><strong>3</strong>.设置背景图片，文字，声音图标</p> 
<pre><code class="language-cpp">//背景图片
IMAGE background;
loadimage(&amp;background, "background.jpg", 640, 360);
putimage(0, 0, &amp;background);
//字体
settextstyle(70, 0, FONT);
settextcolor(RGB(65, 105, 225));
outtextxy(160, 50, "俄罗斯方块");
//声音图片
IMAGE sound;
loadimage(&amp;sound, "sound.png", 40, 40);
putimage(600, 0, &amp;sound);</code></pre> 
<p><strong>4</strong>.设置按钮（圆角矩形+文字）</p> 
<pre><code class="language-cpp">void button(int x, int y, int w, int h, const char* text)
{
	setfillcolor(RGB(240, 248, 255));
	fillroundrect(x, y, x + w, y + h, 10, 10);
	settextstyle(20, 0, FONT);
	settextcolor(RGB(105, 147, 211));
	int tx = x + (w - textwidth(text)) / 2;
	int ty = y + (h - textheight(text)) / 2;
	outtextxy(tx, ty, text);
}</code></pre> 
<p><strong>5</strong>.按钮点击（关闭和暂停音乐）</p> 
<pre><code class="language-cpp">void buttonhit()
{
	int flag = 1;//flag为0时为mute，为1时为sound
	//FlushBatchDraw();
	ExMessage msg;
	while (true)
	{
		if (peekmessage(&amp;msg, EM_MOUSE))
		{
			if (msg.message == WM_LBUTTONDOWN &amp;&amp; msg.x &gt; 242 &amp;&amp; msg.y &gt; 150 &amp;&amp; msg.x &lt; 392 &amp;&amp; msg.y &lt; 190)
			{
				BOOL flag1 = newcontinue();
				//背景
				initgraph(640, 720, SHOWCONSOLE);
				setbkmode(TRANSPARENT);
				setbkcolor(WHITE);
				clearcliprgn();
				singlemode();
				singlemodeoperate(flag1);
				return;
			}
			else if (msg.message == WM_LBUTTONDOWN &amp;&amp; msg.x &gt; 242 &amp;&amp; msg.y &gt; 200 &amp;&amp; msg.x &lt; 392 &amp;&amp; msg.y &lt; 240)
			{
				//背景
				initgraph(1280, 720, SHOWCONSOLE);
				setbkmode(TRANSPARENT);
				setbkcolor(WHITE);
				clearcliprgn();
				doublemode();
				doublemodeoperate();
				IMAGE victory, failure;
				loadimage(&amp;victory, "VICTORY.jpg", 350, 200);
				loadimage(&amp;failure, "FAILURE.jpg", 350, 200);
				if (winflag == 1)
				{
					doublemode();
					doubledrawgrid();
					putimage(40, 260, &amp;victory);
					putimage(890, 260, &amp;failure);
					Sleep(3000);
				}
				else if (winflag == 2)
				{
					doublemode();
					doubledrawgrid();
					putimage(40, 260, &amp;failure);
					putimage(890, 260, &amp;victory);
					Sleep(3000);
				}
				return;
			}
			else if (msg.message == WM_LBUTTONDOWN &amp;&amp; msg.x &gt; 242 &amp;&amp; msg.y &gt; 250 &amp;&amp; msg.x &lt; 392 &amp;&amp; msg.y &lt; 290)
			{
				initgraph(320, 720, SHOWCONSOLE);
				setbkmode(TRANSPARENT);
				setbkcolor(WHITE);
				clearcliprgn();
				list();
				listoperate();
				return;
			}
			else if (msg.message == WM_LBUTTONDOWN &amp;&amp; msg.x &gt; 580 &amp;&amp; msg.y &gt; 0 &amp;&amp; msg.x &lt; 640 &amp;&amp; msg.y &lt; 60 &amp;&amp; flag == 1)
			{
				mciSendString("stop BGM.mp3", NULL, 0, NULL);
				IMAGE mute;
				loadimage(&amp;mute, "mute.png", 40, 40);
				putimage(600, 0, &amp;mute);
				flag = 0;
			}
			else if (msg.message == WM_LBUTTONDOWN &amp;&amp; msg.x &gt; 580 &amp;&amp; msg.y &gt; 0 &amp;&amp; msg.x &lt; 640 &amp;&amp; msg.y &lt; 60 &amp;&amp; flag == 0)
			{
				mciSendString("play BGM.mp3 repeat", NULL, 0, NULL);
				IMAGE sound;
				loadimage(&amp;sound, "sound.png", 40, 40);
				putimage(600, 0, &amp;sound);
				flag = 1;
			}
		}
	}
}</code></pre> 
<p> WM_LBUTTONDOWN   左键按下；</p> 
<h2 id="%E6%8E%92%E8%A1%8C%E6%A6%9C%E7%95%8C%E9%9D%A2">排行榜界面</h2> 
<p><strong> 1</strong>.排行榜界面</p> 
<pre><code class="language-cpp">void list()
{
	HWND hwnd = GetHWnd();
	SetWindowText(hwnd, "排行榜");
	IMAGE background;
	loadimage(&amp;background, "background4.jpg", 320, 720);
	putimage(0, 0, &amp;background);
	settextstyle(80, 0, FONT);
	settextcolor(RGB(240, 248, 255));
	int tx = 160 - textwidth("排行榜") / 2;
	outtextxy(tx, 20, "排行榜");
	settextstyle(30, 0, FONT);
	outtextxy(20, 100, "排名");
	outtextxy(135, 100, "名称");
	outtextxy(250, 100, "分数");
	IMAGE backimage1, backimage2;
	loadimage(&amp;backimage1, "back1.png", 50, 50);
	loadimage(&amp;backimage2, "back2.png", 50, 50);
	putimage(0, 0, &amp;backimage2, SRCAND);
	putimage(0, 0, &amp;backimage1, SRCPAINT);
}</code></pre> 
<p> SRCAND，SRCPAINT涉及位运算；<a href="https://blog.csdn.net/m0_60777643/article/details/122833558?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165432034116781432996950%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=165432034116781432996950&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-4-122833558-null-null.142%5Ev11%5Epc_search_result_control_group,157%5Ev13%5Enew_style2&amp;utm_term=easyx%E9%80%8F%E6%98%8E%E5%9B%BE%E7%89%87&amp;spm=1018.2226.3001.4187" title="关于Easyx如何显示透明无背景贴图_Brokenrivers的博客-CSDN博客_easyx透明图片">关于Easyx如何显示透明无背景贴图_Brokenrivers的博客-CSDN博客_easyx透明图片</a></p> 
<p> <strong>2</strong>.排行榜界面操作（从文件中读取，用动态数组储层，排序）</p> 
<pre><code class="language-cpp">int readrank()
{
	info temp;
	int n = 0;
	FILE* fp;
	int flag = 0;
	//计算行数
	char buf[100];
	FILE* p;
	flag = fopen_s(&amp;p, "rank.txt", "rb");
	if (flag != 0)
	{
		printf("cannot open the files\n");
		system("pause");
		return -1;
	}
	else {
		while (!feof(p))
		{
			memset(buf, 0, sizeof(buf));//每次读取一行之前都把这个buf清空
			fgets(buf, sizeof(buf), p);//从文件中读取一行
			n++;
		}
		fclose(p);
	}
	n /= 2;
	info* array = (info*)malloc(n * sizeof(temp));//建立一个动态数组，动态数组的成员数量和.txt文件的行一样多
	flag = fopen_s(&amp;fp, "rank.txt", "rb");
	if (flag != 0)
	{
		printf("cannot open rank.txt\n");
		system("pause");
		return -1;
	}
	for (int i = 0;i &lt; n;i++)
	{
		fgets(array[i].name, 30, fp);
		char* tmp = NULL;
		if ((tmp = strstr(array[i].name, "\n")))
		{
			*tmp = '\0';
		}
		fscanf_s(fp, "%d", &amp;array[i].score);
		fgets(buf, sizeof(buf), fp);//读取完分数这一行
	}
	for (int i = 0;i &lt; n - 1;i++)
	{
		int k = i;
		for (int j = i + 1;j &lt; n;j++)
		{
			if (array[j].score &gt; array[i].score)
			{
				k = j;
				temp = array[i];
				array[i] = array[j];
				array[j] = temp;
			}
		}
	}
	fclose(fp);
	for (int i = 0;i &lt; n;i++)
	{
		char str1[30];
		sprintf_s(str1, "%d", i + 1);//将数字格式化输出为字符串
		outtextxy(20 + textwidth("排名") / 2 - textwidth(str1) / 2, 130 + i * textheight(str1), str1);
		outtextxy(135 + textwidth("名称") / 2 - textwidth(array[i].name) / 2, 130 + i * textheight(array[i].name), array[i].name);
		char str2[30];
		sprintf_s(str2, "%d", array[i].score);//将数字格式化输出为字符串
		outtextxy(250 + textwidth("得分") / 2 - textwidth(str2) / 2, 130 + i * textheight(str2), str2);
	}
	free(array);
	return 0;
}</code></pre> 
<p><strong>3</strong>.返回主界面</p> 
<pre><code class="language-cpp">void listoperate() 
{
	readrank();
	ExMessage msg;
	while (true)
	{
		if(peekmessage(&amp;msg, EM_MOUSE) &amp;&amp; msg.message == WM_LBUTTONDOWN &amp;&amp; msg.x &gt; 0 &amp;&amp; msg.y &gt; 0 &amp;&amp; msg.x &lt; 55 &amp;&amp; msg.y &lt; 55)
		{
			return;
		}
	}
}</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fb0461a065717a96b04944decc016d08/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">juc之CurrentHashMap (二)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/53b487116a26358a8423b4c13a3018fc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Abaqus CPU并行计算 加速计算信息汇总</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>