<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ios 后台任务_iOS后台任务 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ios 后台任务_iOS后台任务" />
<meta property="og:description" content="ios 后台任务
As an iOS Developer, i always find that background execution is a limitation we have learned to live with while designing and implementing apps. There are several use cases which can benefit with apps allowed to execute in background.
作为iOS开发人员，我总是发现后台执行是我们在设计和实现应用程序时学会的一个限制。 在允许在后台执行的应用程序中，有几种使用案例会受益。 With the introduction with iOS 13, Apple introduced the Background Tasks framework. This allows our apps to refresh content and perform small tasks while the app is in background." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/90b74cc0b218d3d4a911ba35d4a24b0c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-26T18:13:09+08:00" />
<meta property="article:modified_time" content="2020-08-26T18:13:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ios 后台任务_iOS后台任务</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <article style="font-size: 16px;"> 
 <p>ios 后台任务</p> 
 <div> 
  <section> 
   <div> 
    <div> 
     <p>As an iOS Developer, i always find that background execution is a limitation we have learned to live with while designing and implementing apps. There are several use cases which can benefit with apps allowed to execute in background.</p> 
     <p> 作为iOS开发人员，我总是发现后台执行是我们在设计和实现应用程序时学会的一个限制。 在允许在后台执行的应用程序中，有几种使用案例会受益。 </p> 
     <p>With the introduction with iOS 13, Apple introduced the <a href="https://developer.apple.com/documentation/backgroundtasks" rel="noopener nofollow noopener noreferrer" target="_blank"><em>Background Tasks</em></a> framework. This allows our apps to refresh content and perform small tasks while the app is in background.</p> 
     <p> 随着iOS 13的引入，Apple引入了<a href="https://developer.apple.com/documentation/backgroundtasks" rel="noopener nofollow noopener noreferrer" target="_blank"><em>Background Tasks</em></a>框架。 这允许我们的应用在后台运行时刷新内容并执行小任务。 </p> 
     <p>Some important considerations while implementing Background Tasks are:</p> 
     <p> 实施后台任务时，一些重要的注意事项是： </p> 
     <blockquote> 
      <p><strong>Power</strong>: The device battery level is a primary factor for backgroud tasks to be triggered. Also, while implementing our task, we should ensure that its informs the system of completion. This ensures that our task doesn’t drain power unnecessarily.</p> 
      <p> <strong>功率</strong> ：设备电池电量是触发后台任务的主要因素。 另外，在执行任务时，我们应确保其将完成情况告知系统。 这样可以确保我们的任务不会不必要地消耗电力。 </p> 
      <p><strong>Performance: </strong>Our task should be efficient and guarantee high performance. Avoid implementing unnecessary work in background and use GCD to</p> 
      <p> <strong>绩效：</strong>我们的任务应该高效并保证高性能。 避免在后台执行不必要的工作，并使用GCD </p> 
     </blockquote> 
     <p>Let’s see how we can request background tasks execution for our apps:</p> 
     <p> 让我们看看如何请求应用程序执行后台任务： </p> 
     <p><strong>Step 1: Enable Background Processing capability for our app</strong></p> 
     <p> <strong>步骤1：为我们的应用启用后台处理功能</strong> </p> 
     <p>Firstly, we need to enable Background Processing capability for our app. This is available under the Background Modes capability for the app</p> 
     <p> 首先，我们需要为我们的应用启用后台处理功能。 在应用程序的“后台模式”功能下可用 </p> 
     <figure style="display:block;text-align:center;"> 
      <div> 
       <div> 
        <div> 
         <div> 
          <div style="text-align: center;"> 
           <img alt="Image for post" src="https://images2.imgbox.com/4c/e2/Af0oBq4x_o.png" width="2508" height="456" style="outline: none;"> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <figcaption>
        Step 2: Enable Background Processing in App Scheme 
      </figcaption> 
      <figcaption>
        步骤2：在App Scheme中启用后台处理 
      </figcaption> 
     </figure> 
     <p><strong>Step 2: Add the Background Task Identifiers to info.plist</strong></p> 
     <p> <strong>步骤2：将后台任务标识符添加到info.plist</strong> </p> 
     <p>We need to provide a unique identifier for our tasks and we have to specify the task identifiers in the <strong>info.plist</strong> under the Key <em>Permitted background task scheduler identifiers</em></p> 
     <p> 我们需要为任务提供唯一的标识符，并且必须在“ <em>允许</em>的密钥” <em>后台任务计划程序标识符</em>下的<strong>info.plist中</strong>指定<em>任务标识符</em> </p> 
     <figure style="display:block;text-align:center;"> 
      <div> 
       <div> 
        <div> 
         <div> 
          <div style="text-align: center;"> 
           <img alt="Image for post" src="https://images2.imgbox.com/6a/b1/pAQF5bO7_o.png" width="1594" height="112" style="outline: none;"> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <figcaption>
        Step 2: Add task identifier to info.plist 
      </figcaption> 
      <figcaption>
        步骤2：将任务标识符添加到info.plist 
      </figcaption> 
     </figure> 
     <p><strong>Step 3: Register the app for Background Processing</strong></p> 
     <p> <strong>步骤3：注册应用以进行后台处理</strong> </p> 
     <p>We need to register our app for background tasks. There are two types of background tasks namely</p> 
     <p> 我们需要为后台任务注册我们的应用程序。 有两种类型的后台任务，即 </p> 
     <ul><li><p><em>A </em><a href="https://developer.apple.com/documentation/backgroundtasks/bgprocessingtask" rel="noopener nofollow noopener noreferrer" target="_blank"><em>BGProcessingTask</em></a> is typically a time consuming task which is expected to take time to complete.</p><p> <em>一个</em> <a href="https://developer.apple.com/documentation/backgroundtasks/bgprocessingtask" rel="noopener nofollow noopener noreferrer" target="_blank"><em>BGProcessingTask</em></a>通常是一个耗时的任务，预计将需要一段时间才能完成。 </p></li><li><p>A <a href="https://developer.apple.com/documentation/backgroundtasks/bgapprefreshtask" rel="noopener nofollow noopener noreferrer" target="_blank"><em>BGAppRefreshTask</em></a><em> </em>is typically a short task for performing actions that can be completed quickly.</p><p> <a href="https://developer.apple.com/documentation/backgroundtasks/bgapprefreshtask" rel="noopener nofollow noopener noreferrer" target="_blank"><em>BGAppRefreshTask</em></a> <em> </em> 通常是执行可以快速完成的动作的简短任务。 </p></li></ul> 
     <figure style="display:block;text-align:center;"> 
      <div> 
       <div> 
        <div> 
         <div> 
          <div style="text-align: center;"> 
           <img alt="Image for post" src="https://images2.imgbox.com/1c/da/HqNfdnaO_o.png" width="2316" height="470" style="outline: none;"> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </figure> 
     <p>To register our tasks, we need to specify the identifiers and a task block which will call a code that we want to execute in the background.</p> 
     <p> 要注册我们的任务，我们需要指定标识符和一个任务块，该块将调用我们要在后台执行的代码。 </p> 
     <p>The method <em>handleAppRefresh(:)</em> is called when the system runs a task with the specified identifier “<em>com.amitthakur.sampleapp.refresh</em>”</p> 
     <p> 当系统运行带有指定标识符“ <em>com.amitthakur.sampleapp.refresh</em> ”的任务时，将调用<em>handleAppRefresh(:)</em>方法 </p> 
     <p>The method <em>handleDataProcessing(:)</em> is called when the system runs a task with the specified identifier “<em>com.amitthakur.sampleapp.dataprocessing</em>”</p> 
     <p> 当系统运行带有指定标识符“ <em>com.amitthakur.sampleapp.dataprocessing</em> ”的任务时，将调用<em>handleDataProcessing(:)</em>方法 </p> 
     <p><strong>Step 4: Submit task for execution</strong></p> 
     <p> <strong>步骤4：提交执行任务</strong> </p> 
     <p>The next step is to <em>submit()</em> the task when the app goes to background. To do this, we fetch the request with the identifier specified.</p> 
     <p> 下一步是当应用程序进入后台时，将任务<em>提交()</em> 。 为此，我们使用指定的标识符获取请求。 </p> 
     <p>With a <em>BGAppRefreshTask</em>, we need to specify an <em>earliestBeginDate</em> which tells the system when to execute the task.</p> 
     <p> 随着<em>BGAppRefreshTask，</em>我们需要指定一个<em>earliestBeginDate</em>它告诉系统何时执行任务。 </p> 
     <figure style="display:block;text-align:center;"> 
      <div> 
       <div> 
        <div> 
         <div> 
          <div style="text-align: center;"> 
           <img alt="Image for post" src="https://images2.imgbox.com/ef/35/5YsWjkkc_o.png" width="1758" height="358" style="outline: none;"> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <figcaption>
        Submit BGAppRefreshTask 
      </figcaption> 
      <figcaption>
        提交BGAppRefreshTask 
      </figcaption> 
     </figure> 
     <p>With a <em>BGProcessingTask</em>, we should specify whether it <em>requiresNetworkConnectivity</em> and <em>requiresExternalPower. </em>These act as a pre-condition for our task execution and should be specified based on our task needs.</p> 
     <p> 对于<em>BGProcessingTask</em> ，我们应该指定它是否<em>需要</em> <em>NetworkConnectivity和requireExternalPower</em> <em>。</em> 这些是我们执行任务的前提，应根据我们的任务需求进行指定。 </p> 
     <figure style="display:block;text-align:center;"> 
      <div> 
       <div> 
        <div> 
         <div> 
          <div style="text-align: center;"> 
           <img alt="Image for post" src="https://images2.imgbox.com/6f/bd/g7mjGFWL_o.png" width="1770" height="390" style="outline: none;"> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <figcaption>
        Submit BGProcessingTask 
      </figcaption> 
      <figcaption>
        提交BGProcessingTask 
      </figcaption> 
     </figure> 
     <p><strong>Step 5: Implement Task handler</strong></p> 
     <p> <strong>步骤5：实施任务处理程序</strong> </p> 
     <p>Now that we have registered our tasks, lets have a looks at how they work. Firstly, we reschedule our tasks so that we have another such task in the queue. This depends on whether your app expects periodic updates.</p> 
     <p> 现在我们已经注册了任务，让我们看一下它们的工作方式。 首先，我们重新计划任务，以便队列中还有另一个此类任务。 这取决于您的应用是否期望定期更新。 </p> 
     <figure style="display:block;text-align:center;"> 
      <div> 
       <div> 
        <div> 
         <div> 
          <div style="text-align: center;"> 
           <img alt="Image for post" src="https://images2.imgbox.com/33/24/xOq8vnsj_o.png" width="1600" height="468" style="outline: none;"> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <figcaption>
        Handle BGAppRefreshTask with expirationHandler 
      </figcaption> 
      <figcaption>
        使用expirationHandler处理BGAppRefreshTask 
      </figcaption> 
     </figure> 
     <figure style="display:block;text-align:center;"> 
      <div> 
       <div> 
        <div> 
         <div> 
          <div style="text-align: center;"> 
           <img alt="Image for post" src="https://images2.imgbox.com/78/22/7K08zA1F_o.png" width="1718" height="490" style="outline: none;"> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <figcaption>
        Handle BGProcessingTask with expirationHandler 
      </figcaption> 
      <figcaption>
        使用expirationHandler处理BGProcessingTask 
      </figcaption> 
     </figure> 
     <p>With every task execution we must specify a few things:</p> 
     <p> 在执行每个任务时，我们必须指定一些事项： </p> 
     <blockquote> 
      <p><strong>setTaskCompleted(success:)</strong> : <em>Use this to mark the task execution as complete.</em></p> 
      <p> <strong>setTaskCompleted(success :)</strong> ： <em>使用它可以将任务执行标记为完成。</em> </p> 
      <p><strong>expirationHandler:</strong> <em>Use this to gracefully handle our task execution being terminated. Use this to perform cleanup or wrap up the task</em></p> 
      <p> <strong>expirationHandler：</strong> <em>使用它来优雅地处理我们终止的任务执行。</em> <em>使用它执行清理或完成任务</em> </p> 
     </blockquote> 
     <p><strong>Step 5: Schedule tasks when our app enters background</strong></p> 
     <p> <strong>步骤5：在我们的应用进入后台时安排任务</strong> </p> 
     <p>Finally, don’t forget to schedule the tasks when our app enters background</p> 
     <p> 最后，当我们的应用进入后台时，别忘了安排任务 </p> 
     <figure style="display:block;text-align:center;"> 
      <div> 
       <div> 
        <div> 
         <div> 
          <div style="text-align: center;"> 
           <img alt="Image for post" src="https://images2.imgbox.com/14/35/nX4vMrz7_o.png" width="1614" height="152" style="outline: none;"> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </figure> 
     <p>This should submit our tasks for execution in background.</p> 
     <p> 这应该提交我们的任务以在后台执行。 </p> 
     <p>In conclusion, having implemented background task execution in a few apps, it has definitely improved the app performance. However, triggering of the task is quite unpredictable. Apple has provided a way to invoke the task in debug mode, but more of that in the next blog on Background Tasks.</p> 
     <p> 总而言之，在一些应用程序中实现了后台任务执行后，绝对可以提高应用程序的性能。 但是，任务的触发是非常不可预测的。 Apple提供了一种在调试模式下调用任务的方法，但在背景任务的下一个博客中提供了更多方法。 </p> 
     <p>Hope this was helpful. Thanks for reading.</p> 
     <p> 希望这会有所帮助。 谢谢阅读。 </p> 
    </div> 
   </div> 
  </section> 
 </div> 
 <blockquote> 
  <p>翻译自: <a href="https://medium.com/@i.m.amit.k.thakur/ios-backgroundtasks-435a8e58b9e0" rel="nofollow">https://medium.com/@i.m.amit.k.thakur/ios-backgroundtasks-435a8e58b9e0</a></p> 
 </blockquote> 
 <p>ios 后台任务</p> 
</article>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/68ff870afd20efcd468788592425fd1a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">lombok  Error:(32, 14) java: 找不到符号   符号:   方法 setUserName(java.lang.String)   位置: 类型为com.wtf.domain.</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/716756d75e0fecca7e03c82089641f87/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">LeetCode第 787 题：K 站中转内最便宜的航班(C&#43;&#43;)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>