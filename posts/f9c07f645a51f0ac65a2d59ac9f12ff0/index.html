<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Restormer: Efficient Transformer for High-Resolution Image Restoration 论文笔记 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Restormer: Efficient Transformer for High-Resolution Image Restoration 论文笔记" />
<meta property="og:description" content="前言 本文也是结合Transformer设计出来的网络结构用作图像恢复领域，主要包括图像去雨、运动去模糊、失焦去模糊和图像降噪（其中又包括了高斯彩色/灰度图的降噪、真是图像降噪）。
创新点：①提出一种基于编码器-解码器的Restormer网络。
②提出了一种新的局部transformer模块MDTA，可以加强局部和非局部有关联像素之间的联系。
③一种新的门控前向传递网络。
网络结构 总体来看整体网络结构其实也是借鉴编码器-解码器的结构，而且仔细看中间下凸的那部分其实也就是Unet的网络结构，而且很凑巧的是最后实验出来的效果也是四层的网络效果最好，跟Uformer不谋而合。
首先，一幅H×W×3的图像经过卷积层生成H×W×C的特征图。然后经过4层编码器-解码器结构网络，每一层都是由一个Transformer模块和一个下采样层组成，通过四层transformer模块和下采样层之后，再经过解码器也是跟前面一样的模块，只是改成了上采样，并且和之前下采样得到的特征图经过一个1×1的卷积核按比例相加进行输出，最后经过一个transformer模块对特征进行改进，再进入一个卷积层还原回恢复后的图像。
MDTA 在这个模块中，先经过一个1×1的卷积结合通道之间的信息，然后通过一个3×3的卷积结合单个通道的空间信息，然后才是SA的流程，在这之中没有使用偏置，这样既结合了通道之间的信息又结合了局部的空间信息。
Gated-Dconv Feed-Forward Network 门控前向网络主要由两条路组成，都分别由一个1×1和3×3的卷积层组成，门控的关键点在于下面那条支流会通过一个非线性的GELU函数，可以将比较好的特征得以保留，然后通过与上面那个直流得到的原特征图相乘从而达到加强较好特征部分的目的。
实验 去雨 运动去模糊 失焦去模糊 降噪 消融实验 主要是对网络结构进行研究，看看哪个结构效果比较好。
总结 总体来看的话，Restormer和Uformer其实设计出来的网络结构也是相似的，都是基Transformer、编码器-解码器、Unet的结构，而且网络层数做出来的结果都一样，并且都自己设计了一个transformer模块和一个前向传递网络。个人认为，编码器和解码器结构上是不是可以向着不一样的结构发展一下会不会有更好的效果。其次是，最后出来的实验效果对比来看，各有所长吧，但是restormer上比如去雨部分就没有拿Uformer来做对比，不知道为什么，我看了下Uformer的效果在论文里面是要比它高很多的在这项任务上。最后，个人看来的亮点就是设计的时候不仅仅关注了空间上的局部信息，还关注了通道间的信息，通过一个1×1的卷积层来实现，这个想法还是不错。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f9c07f645a51f0ac65a2d59ac9f12ff0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-29T11:50:10+08:00" />
<meta property="article:modified_time" content="2022-12-29T11:50:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Restormer: Efficient Transformer for High-Resolution Image Restoration 论文笔记</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>前言</h2> 
<p>本文也是结合Transformer设计出来的网络结构用作图像恢复领域，主要包括图像去雨、运动去模糊、失焦去模糊和图像降噪（其中又包括了高斯彩色/灰度图的降噪、真是图像降噪）。</p> 
<p>创新点：①提出一种基于编码器-解码器的Restormer网络。</p> 
<p>②提出了一种新的局部transformer模块MDTA，可以加强局部和非局部有关联像素之间的联系。</p> 
<p>③一种新的门控前向传递网络。</p> 
<h2>网络结构</h2> 
<p><img alt="" height="615" src="https://images2.imgbox.com/aa/ef/PLJwO9Tv_o.png" width="1200"></p> 
<p>总体来看整体网络结构其实也是借鉴编码器-解码器的结构，而且仔细看中间下凸的那部分其实也就是Unet的网络结构，而且很凑巧的是最后实验出来的效果也是四层的网络效果最好，跟Uformer不谋而合。</p> 
<p>首先，一幅H×W×3的图像经过卷积层生成H×W×C的特征图。然后经过4层编码器-解码器结构网络，每一层都是由一个Transformer模块和一个下采样层组成，通过四层transformer模块和下采样层之后，再经过解码器也是跟前面一样的模块，只是改成了上采样，并且和之前下采样得到的特征图经过一个1×1的卷积核按比例相加进行输出，最后经过一个transformer模块对特征进行改进，再进入一个卷积层还原回恢复后的图像。</p> 
<h4>MDTA</h4> 
<p class="img-center"><img alt="" height="169" src="https://images2.imgbox.com/65/fd/RmiOsgAP_o.png" width="437"></p> 
<p> 在这个模块中，先经过一个1×1的卷积结合通道之间的信息，然后通过一个3×3的卷积结合单个通道的空间信息，然后才是SA的流程，在这之中没有使用偏置，这样既结合了通道之间的信息又结合了局部的空间信息。</p> 
<h4>Gated-Dconv Feed-Forward Network</h4> 
<p class="img-center"><img alt="" height="170" src="https://images2.imgbox.com/75/6b/fzWItyaL_o.png" width="550"></p> 
<p> 门控前向网络主要由两条路组成，都分别由一个1×1和3×3的卷积层组成，门控的关键点在于下面那条支流会通过一个非线性的GELU函数，可以将比较好的特征得以保留，然后通过与上面那个直流得到的原特征图相乘从而达到加强较好特征部分的目的。</p> 
<h2>实验</h2> 
<h4>去雨</h4> 
<p><img alt="" height="861" src="https://images2.imgbox.com/99/02/SpTQZPVb_o.png" width="1200"></p> 
<h4>运动去模糊</h4> 
<p class="img-center"><img alt="" height="460" src="https://images2.imgbox.com/9c/62/UxSKBtv5_o.png" width="507"></p> 
<h4> 失焦去模糊</h4> 
<p><img alt="" height="922" src="https://images2.imgbox.com/d5/9e/xpEHWZ5S_o.png" width="1200"></p> 
<h4>降噪</h4> 
<p><img alt="" height="557" src="https://images2.imgbox.com/6c/3b/9KOwgsc4_o.png" width="1200"></p> 
<p><img alt="" height="943" src="https://images2.imgbox.com/40/f3/fy9dUIzE_o.png" width="1200"> </p> 
<h4>消融实验</h4> 
<p> 主要是对网络结构进行研究，看看哪个结构效果比较好。</p> 
<p class="img-center"><img alt="" height="251" src="https://images2.imgbox.com/d5/53/FvEpbAln_o.png" width="458"></p> 
<p> <img alt="" height="308" src="https://images2.imgbox.com/62/13/EwDpwIss_o.png" width="1200"></p> 
<h2>总结</h2> 
<p>总体来看的话，Restormer和Uformer其实设计出来的网络结构也是相似的，都是基Transformer、编码器-解码器、Unet的结构，而且网络层数做出来的结果都一样，并且都自己设计了一个transformer模块和一个前向传递网络。个人认为，编码器和解码器结构上是不是可以向着不一样的结构发展一下会不会有更好的效果。其次是，最后出来的实验效果对比来看，各有所长吧，但是restormer上比如去雨部分就没有拿Uformer来做对比，不知道为什么，我看了下Uformer的效果在论文里面是要比它高很多的在这项任务上。最后，个人看来的亮点就是设计的时候不仅仅关注了空间上的局部信息，还关注了通道间的信息，通过一个1×1的卷积层来实现，这个想法还是不错。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f7542f06c81f780d5b0de4b038047d8b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Cadence17.4操作经验</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/54e98cc7db9c2b407465908b593217dc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据结构-图</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>