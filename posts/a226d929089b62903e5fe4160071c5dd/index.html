<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>统计24小时内每个小时最后一条数据_如你所愿，一篇文章搞定8种Excel多表统计... - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="统计24小时内每个小时最后一条数据_如你所愿，一篇文章搞定8种Excel多表统计..." />
<meta property="og:description" content="原创作者： 卢子 转自：Excel不加班
同样一个任务，一个人花了5小时，吃了很多苦，做到60分；另一个人花了5分钟，轻轻松松，做到了80分。你会给第一个人点赞，夸她棒吗？
在职场，过程不重要，结果才是最重要的。
1.格式相同的表格，要在第一个表汇总后面所有表格D列的总量。
格式相同的表，多少个都一样，一个SUM函数就秒杀了。
=SUM(&#39;4.1:4.7&#39;!D3)
语法：
SUM(起始表格名称:结束表格名称!单元格)
表格名称没有规律也可以，在有特殊字符的情况下需要加单引号&#39;。
我们知道*是通配符，代表所有的意思，在这里也可以用*来实现统计。
=SUM(&#39;*&#39;!D3)
2.同样也是格式相同，但要汇总的形式不一样，要汇总每一个月份的总销量。
这里是用SUM&#43;INDIRECT函数的组合实现。
可能很多人一开始直接就用SUM，可惜得到的是错误值。A2&amp;&#34;!C:C&#34;被当成文本处理，而不是区域。
=SUM(A2&amp;&#34;!C:C&#34;)
我们正常的引用都是直接引用，如区域C:C。间接引用就是通过第三者才能获得的，如INDIRECT(&#34;C:C&#34;)。也就是说，只要嵌套个INDIRECT函数就可以。
3.跟上一个例子很像，唯一的差别就是最后多一个合计的实发数量，而每一个表格的行数不确定。现在要获取每个表合计的实发数量。
这种有很多种处理方法，最简单的办法有两种
01 查找每个表，最后一个数量。
=LOOKUP(9E&#43;307,INDIRECT(A2&amp;&#34;!B:B&#34;))
02 统计每个表的数量后再除以2。
=SUM(INDIRECT(A2&amp;&#34;!B:B&#34;))/2
4.现在换成统计商品的销售量。
明细表
汇总表
难度瞬间就上来了，要结合好多函数。
=SUMPRODUCT(SUMIF(INDIRECT(ROW($1:$6)&amp;&#34;月!B:B&#34;),A2,INDIRECT(ROW($1:$6)&amp;&#34;月!C:C&#34;)))
看起来很复杂，但实际上也不是太难理解。
INDIRECT(ROW($1:$6)&amp;&#34;月!B:B&#34;)这部分就是获取1-6月的B列
INDIRECT(ROW($1:$6)&amp;&#34;月!C:C&#34;)这部分就是获取1-6月的C列
SUMIF(1-6月的B列,A2,1-6月的C列)就是分别统计这6个表
SUMPRODUCT(SUMIF())就是将最终这6个表进行求和
如果不会也没事，下面还有技巧法。
5.格式相同的多个表格，现在要统计所有人员的工资数据。
Step 01 新建一个空白的汇总表，点击汇总表任意空白单元格，再点击数据→合并计算，这时会弹出合并计算对话框。
Step 02 鼠标引用第一个表的区域，点击添加。
Step 03 重复添加剩下的所有表格，添加完毕以后，勾选首行和最左列，点击确定。
瞬间就统计出来，非常快。
Step 04 统一格式，搞定收工。
6.格式相同的12个表格，现在要统计每个销售人员销售的产品对应的总数量。
关于多表统计，高手可以借助VBA和SQL，普通人也有非常方便的方法。一起来看看超级透视表如何进行统计的？
Step 01 新建一个工作簿，点击数据→新建查询→从文件→从工作簿。
Step 02 浏览到工作簿所在位置，点击导入。
Step 03 选择整个工作簿，点击编辑。
Step 04 删除不需要的列，展开Data获取所有数据。
Step 05 将第一行作用作标题，取消多余的标题筛选，关闭并上载。
Step 06 根据合并后的数据创建数据透视表统计。不包含空格的数据，可以直接用勾选而不需要用拖拉字段，更方便。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a226d929089b62903e5fe4160071c5dd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-20T08:52:32+08:00" />
<meta property="article:modified_time" content="2020-11-20T08:52:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">统计24小时内每个小时最后一条数据_如你所愿，一篇文章搞定8种Excel多表统计...</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>原创作者： 卢子 转自：Excel不加班</p> 
 <p>同样一个任务，一个人花了5小时，吃了很多苦，做到60分；另一个人花了5分钟，轻轻松松，做到了80分。你会给第一个人点赞，夸她棒吗？</p> 
 <p><strong>在职场，过程不重要，结果才是最重要的。</strong></p> 
 <p><strong>1.</strong>格式相同的表格，要在第一个表汇总后面所有表格D列的总量。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/eb/4c/Hz12EjdL_o.png" alt="e812e1153021dba83a3eea719c5d2c35.png"> 
 </div> 
 <p>格式相同的表，多少个都一样，一个SUM函数就秒杀了。</p> 
 <blockquote> 
  <p>=SUM('4.1:4.7'!D3)</p> 
 </blockquote> 
 <p>语法：</p> 
 <blockquote> 
  <p>SUM(起始表格名称:结束表格名称!单元格)</p> 
 </blockquote> 
 <p>表格名称没有规律也可以，在有特殊字符的情况下需要加单引号'。</p> 
 <p>我们知道*是通配符，代表所有的意思，在这里也可以用*来实现统计。</p> 
 <blockquote> 
  <p>=SUM('*'!D3)</p> 
 </blockquote> 
 <p><strong>2.</strong>同样也是格式相同，但要汇总的形式不一样，要汇总每一个月份的总销量。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/68/a7/9mTC1ZTT_o.png" alt="0aa38a6b672900c810dc210baa3e5821.png"> 
 </div> 
 <p>这里是用SUM+INDIRECT函数的组合实现。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/35/cf/5bUUqMkN_o.png" alt="1418385f137085a56654b4de37649f1e.png"> 
 </div> 
 <p>可能很多人一开始直接就用SUM，可惜得到的是错误值。A2&amp;"!C:C"被当成文本处理，而不是区域。</p> 
 <blockquote> 
  <p>=SUM(A2&amp;"!C:C")</p> 
 </blockquote> 
 <p>我们正常的引用都是直接引用，如区域C:C。间接引用就是通过第三者才能获得的，如INDIRECT("C:C")。也就是说，只要嵌套个INDIRECT函数就可以。</p> 
 <p><strong>3.</strong>跟上一个例子很像，唯一的差别就是最后多一个合计的实发数量，而每一个表格的行数不确定。现在要获取每个表合计的实发数量。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/1b/38/ItucxIxj_o.png" alt="e71f169970bdd6615625e88efe9d7c28.png"> 
 </div> 
 <p>这种有很多种处理方法，最简单的办法有两种</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/24/34/bL6Efgkp_o.png" alt="e9fa41b290fad79f7a599930f68247cd.png"> 
 </div> 
 <p>01 查找每个表，最后一个数量。</p> 
 <blockquote> 
  <p>=LOOKUP(9E+307,INDIRECT(A2&amp;"!B:B"))</p> 
 </blockquote> 
 <p>02 统计每个表的数量后再除以2。</p> 
 <blockquote> 
  <p>=SUM(INDIRECT(A2&amp;"!B:B"))/2</p> 
 </blockquote> 
 <p><strong>4.</strong>现在换成统计商品的销售量。</p> 
 <p>明细表</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/0b/9f/6vhCm4y7_o.png" alt="7da6117fea3654187df89cea3a111b44.png"> 
 </div> 
 <p>汇总表</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/2c/be/QCDeUi29_o.png" alt="b3ac2c663b13846a38b0b05b7428a81a.png"> 
 </div> 
 <p>难度瞬间就上来了，要结合好多函数。</p> 
 <blockquote> 
  <p>=SUMPRODUCT(SUMIF(INDIRECT(ROW($1:$6)&amp;"月!B:B"),A2,INDIRECT(ROW($1:$6)&amp;"月!C:C")))</p> 
 </blockquote> 
 <p>看起来很复杂，但实际上也不是太难理解。</p> 
 <p>INDIRECT(ROW($1:$6)&amp;"月!B:B")这部分就是获取1-6月的B列</p> 
 <p>INDIRECT(ROW($1:$6)&amp;"月!C:C")这部分就是获取1-6月的C列</p> 
 <p>SUMIF(1-6月的B列,A2,1-6月的C列)就是分别统计这6个表</p> 
 <p>SUMPRODUCT(SUMIF())就是将最终这6个表进行求和</p> 
 <p>如果不会也没事，下面还有技巧法。</p> 
 <p><strong>5.</strong>格式相同的多个表格，现在要统计所有人员的工资数据。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/80/bc/oZfYHKz1_o.png" alt="29230c48139e2148ce2bcbdcfade9c57.png"> 
 </div> 
 <p>Step 01 新建一个空白的汇总表，点击汇总表任意空白单元格，再点击数据→合并计算，这时会弹出合并计算对话框。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/d6/f7/pt7gQFSQ_o.png" alt="d5be1d066eea4e9ae34b2410df781e0f.png"> 
 </div> 
 <p>Step 02 鼠标引用第一个表的区域，点击添加。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/8a/f4/ZIG8Pmam_o.png" alt="35fd2e10d2acac10db61bdb9867dd603.png"> 
 </div> 
 <p>Step 03 重复添加剩下的所有表格，添加完毕以后，勾选首行和最左列，点击确定。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/a9/e0/nxV2BTGB_o.png" alt="3bdd597688dc6fd9b9fa2b71f01b61c1.png"> 
 </div> 
 <p>瞬间就统计出来，非常快。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/d3/af/cG6QPy2k_o.png" alt="36099e782de55c54fab4d9f40d4fd0b7.png"> 
 </div> 
 <p>Step 04 统一格式，搞定收工。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/32/ce/4Wsl1Y2r_o.png" alt="43387435e6350c0967e334770b4d4b22.png"> 
 </div> 
 <p><strong>6.</strong>格式相同的12个表格，现在要统计每个销售人员销售的产品对应的总数量。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/c9/84/1fE43Uhn_o.png" alt="8b0e4fdc5b992864dafb0abf5088c0cf.png"> 
 </div> 
 <p>关于多表统计，高手可以借助VBA和SQL，普通人也有非常方便的方法。一起来看看超级透视表如何进行统计的？</p> 
 <p>Step 01 新建一个工作簿，点击数据→新建查询→从文件→从工作簿。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/bd/08/KkH4wlwL_o.png" alt="d470bb3adb7e3400b76b8fb36a714374.png"> 
 </div> 
 <p>Step 02 浏览到工作簿所在位置，点击导入。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/ed/ab/S1hiHA4M_o.png" alt="58d4225f1cb406fcd3e771afd07aa86f.png"> 
 </div> 
 <p>Step 03 选择整个工作簿，点击编辑。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/7f/37/R76PgLH5_o.png" alt="6641c8cc9e32421fcdff3d395449cfda.png"> 
 </div> 
 <p>Step 04 删除不需要的列，展开Data获取所有数据。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/83/16/HqCR2AZT_o.gif" alt="3dfd94cec54a4d8fb1971687477a9e2d.gif"> 
 </div> 
 <p>Step 05 将第一行作用作标题，取消多余的标题筛选，关闭并上载。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/d7/b4/P1dxKIRs_o.gif" alt="543172531f236857d4f7fd99538dac07.gif"> 
 </div> 
 <p>Step 06 根据合并后的数据创建数据透视表统计。不包含空格的数据，可以直接用勾选而不需要用拖拉字段，更方便。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/81/c7/OrZ13RfM_o.gif" alt="1fbfc0a127f8fc10450c39a001f6cc57.gif"> 
 </div> 
 <p>Step 07 布局以表格形式显示，并对销售量进行降序。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/62/e0/dehHvAaj_o.gif" alt="b0084ad4870c6a488db8dbba0b3c7c21.gif"> 
 </div> 
 <p>这样一份年度数据统计表就完成了。</p> 
 <p><strong>7.</strong>格式相同的多个表格，如何快速合并？</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/ab/ff/Lc6hUQwR_o.png" alt="ae20aed87226d4419ea21d783c68257a.png"> 
 </div> 
 <p>复制表头到汇总表，点击二维码运行即可搞定。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/35/f3/reZLk5PM_o.png" alt="b1d42ad15d25513eff7df03f9136832c.png"> 
 </div> 
 <p>源代码：</p> 
 <blockquote> 
  <p>Sub 合并()</p> 
  <p>Dim sht As Worksheet, arr</p> 
  <p>For Each sht In Worksheets</p> 
  <p>If sht.Name &lt;&gt; "汇总" Then</p> 
  <p>i = sht.Range("b65536").End(xlUp).Row</p> 
  <p>j = Sheets("汇总").Range("b65536").End(3).Row + 1</p> 
  <p>arr = sht.Range("a2:f" &amp; i)</p> 
  <p>Sheets("汇总").Range("a" &amp; j).Resize(UBound(arr), 6) = arr</p> 
  <p>End If</p> 
  <p>Next</p> 
  <p>End Sub</p> 
 </blockquote> 
 <p><strong>8.</strong>如何合并同一个文件夹内所有工作簿的所有工作表？</p> 
 <p>同一个文件夹，里面存着N个工作簿。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/4d/05/PuLqx5bG_o.png" alt="3acde6bb3b3bde830f6794b65a1569ad.png"> 
 </div> 
 <p>每一个工作簿，里面有N个工作表，全部需要合并起来。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/e1/72/yfymawhl_o.png" alt="70c770298e58b3d174a481603ab84926.png"> 
 </div> 
 <p>将代码所在工作簿放在同一个文件夹。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6f97682fe9953f358a36abf15f5a9cbf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue @input带参数_重读 VUE 官方文档 &amp;lt;2&amp;gt;</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e0f4e2a0ef2d089029a70d077306079b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[转载] 基于LSTM的股票预测模型_python实现_超详细</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>