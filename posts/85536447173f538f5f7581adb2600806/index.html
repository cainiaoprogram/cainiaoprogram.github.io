<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>abaqus与matlab联合仿真 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="abaqus与matlab联合仿真" />
<meta property="og:description" content="abaqus与matlab联合仿真 取材于2020.11的资料，文档整理于2021.2.7
引：启动abaqus license 如果运行abaqus报错如下图：
则点击abaqus licensing，选择第四个【Start/Stop/Reread】，点击第一个按钮【Start Server】，下方显示框中显示【Server Start Successful.】，再次打开abaqus ACE即可，如果还是报错就再开一次。
abaqus licensing界面：
正常打开的abaqus提示框：
联合编程思路 注：本文所用的接口函数runabaqus.m、get_history_output.m、odbHistoyOutput.py与这篇博客相同。
一、abaqus中完成有限元建模，得到模型文件，进行一次仿真，得到自动生成的.inp文件。
​ 具体建模方法在前两篇博客里已有详细描述。
二、matlab调用abaqus引擎进行仿真
根据需要的参数修改.inp文件
选本次模型用abaqus仿真时自动生成的.inp文件作为初始文件进行修改比较省事。一般是根据要求修改载荷力和分析步长，注意matlab代码中的具体修改的是inp文件的哪行要打开inp文件进行确认，改错行结果肯定凉凉。
根据需要读取的结果设置req.txt
%e.g. req=&#39;PART-1-1,Node PART-1-1.11,U2&#39;; %指定部件名，节点名和读取的结果 部件名即inp文件中的实例名*Instance, name=Part-1-1, part=Part-1，每个inp文件内容会略有差别，我这个在第51行。节点名一定要大写，不管你在abaqus里命名的大写还是小写这里都必须大写。
matlab调用abaqus引擎的接口runabaqus.m，提交inp文件运行，得到.odb结果文件。
matlab调用python脚本odbHistoyOutput.py，根据req.txt的要求，从.odb文件中读取仿真结果数据并存入结果txt。
matlab读取结果txt中的数据并绘图。
利用matlab调用abaqus引擎获取变载荷的仿真过程变量（例如端点位移量）的原理是，多次调用abaqus进行仿真，每次只仿真分析步长的时间，获取本次仿真中最后一个时刻变量值，再进行下一次仿真。例如仿真时长为 0.4 s 0.4s 0.4s，分析步长为 0.01 s 0.01s 0.01s，则要进行 0.4 / 0.01 = 40 0.4/0.01=40 0.4/0.01=40次仿真。两次仿真之间可以通过修改inp文件修改载荷力，即可实现变载荷力仿真，如正弦载荷。
所以运行一次仿真的时间都比较长，需要根据仿真结果调pid参数的时候可以酌情减少仿真时长阶节约时间，毕竟pid参数好不好前两次超调的一小段就已经能说明很多问题了。
报错：未找到匹配的文件。 我进行软体手指的受力位移仿真时，报错：
&gt;&gt; finger Abaqus License Manager checked out the following license(s): &#34;cae&#34; release 6.12 from DESKTOP-8I4F446 &lt;1022 out of 1024 licenses remain available&gt;." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/85536447173f538f5f7581adb2600806/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-07T23:16:19+08:00" />
<meta property="article:modified_time" content="2021-02-07T23:16:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">abaqus与matlab联合仿真</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="abaqusmatlab_0"></a>abaqus与matlab联合仿真</h2> 
<p align="right"> 取材于2020.11的资料，文档整理于2021.2.7</p> 
<hr> 
<h4><a id="abaqus_license_5"></a>引：启动abaqus license</h4> 
<p>如果运行abaqus报错如下图：</p> 
<p><img src="https://images2.imgbox.com/e7/31/3YoqpTQS_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7a/48/f4uBz3YP_o.jpg" alt="在这里插入图片描述"></p> 
<p>则点击abaqus licensing，选择第四个【Start/Stop/Reread】，点击第一个按钮【Start Server】，下方显示框中显示【Server Start Successful.】，再次打开abaqus ACE即可，如果还是报错就再开一次。</p> 
<p>abaqus licensing界面：</p> 
<p><img src="https://images2.imgbox.com/41/3c/8Zp3XUDZ_o.jpg" alt="在这里插入图片描述"></p> 
<p>正常打开的abaqus提示框：</p> 
<p><img src="https://images2.imgbox.com/35/7d/XDpkGkdp_o.jpg" alt="在这里插入图片描述"></p> 
<h4><a id="_27"></a>联合编程思路</h4> 
<blockquote> 
 <p>注：本文所用的接口函数<code>runabaqus.m</code>、<code>get_history_output.m</code>、<code>odbHistoyOutput.py</code>与<a href="https://blog.csdn.net/hdpai2018/article/details/106113842">这篇博客</a>相同。</p> 
</blockquote> 
<p>一、abaqus中完成有限元建模，得到模型文件，进行一次仿真，得到自动生成的.inp文件。</p> 
<p>​ 具体建模方法在前两篇博客里已有详细描述。</p> 
<p>二、matlab调用abaqus引擎进行仿真</p> 
<ol><li> <p>根据需要的参数修改.inp文件</p> <p>选本次模型用abaqus仿真时自动生成的.inp文件作为初始文件进行修改比较省事。一般是根据要求修改载荷力和分析步长，注意matlab代码中的具体修改的是inp文件的哪行要打开inp文件进行确认，改错行结果肯定凉凉。</p> </li><li> <p>根据需要读取的结果设置req.txt</p> <pre><code class="prism language-matlab">%e.g.
req='PART-1-1,Node PART-1-1.11,U2'; %指定部件名，节点名和读取的结果
</code></pre> <p>部件名即inp文件中的实例名<code>*Instance, name=Part-1-1, part=Part-1</code>，每个inp文件内容会略有差别，我这个在第51行。<strong>节点名一定要大写，不管你在abaqus里命名的大写还是小写这里都必须大写</strong>。</p> </li><li> <p>matlab调用abaqus引擎的接口<code>runabaqus.m</code>，提交inp文件运行，得到.odb结果文件。</p> </li><li> <p>matlab调用python脚本<code>odbHistoyOutput.py</code>，根据req.txt的要求，从.odb文件中读取仿真结果数据并存入结果txt。</p> </li><li> <p>matlab读取结果txt中的数据并绘图。</p> </li></ol> 
<p>利用matlab调用abaqus引擎获取变载荷的仿真过程变量（例如端点位移量）的原理是，多次调用abaqus进行仿真，每次只仿真分析步长的时间，获取本次仿真中最后一个时刻变量值，再进行下一次仿真。例如仿真时长为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         0.4 
        
       
         s 
        
       
      
        0.4s 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord mathdefault">s</span></span></span></span></span>，分析步长为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         0.01 
        
       
         s 
        
       
      
        0.01s 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span><span class="mord mathdefault">s</span></span></span></span></span>，则要进行<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         0.4 
        
       
         / 
        
       
         0.01 
        
       
         = 
        
       
         40 
        
       
      
        0.4/0.01=40 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord">/</span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">4</span><span class="mord">0</span></span></span></span></span>次仿真。两次仿真之间可以通过修改inp文件修改载荷力，即可实现变载荷力仿真，如正弦载荷。</p> 
<p>所以运行一次仿真的时间都比较长，需要根据仿真结果调pid参数的时候可以酌情减少仿真时长阶节约时间，毕竟pid参数好不好前两次超调的一小段就已经能说明很多问题了。</p> 
<h4><a id="_60"></a>报错：未找到匹配的文件。</h4> 
<p>我进行软体手指的受力位移仿真时，报错：</p> 
<pre><code>&gt;&gt; finger
Abaqus License Manager checked out the following license(s): 
"cae" release 6.12 from DESKTOP-8I4F446 
&lt;1022 out of 1024 licenses remain available&gt;. 
KeyError: Node finger_8-1.45 
File "odbHistoyOutput.py", line 38, in &lt;module&gt; 
    region =step_n.historyRegions[node_set] 
 
Abaqus Error: cae exited with an error. 
错误使用 movefile
未找到匹配的文件。

出错 finger (line 15)
    movefile('COOR1.txt', 'N_X.txt');
</code></pre> 
<p>我修改了<code>odbHistoyOutput.py</code>，增加了提示性输出，发现运行到<code>region =step_n.historyRegions[node_set]</code>一句就不会再往下运行。我猜到是传入的参数<code>node_set</code>即matlab中req的第二个参数有问题，但穷尽想象力尝试到凌晨四点也没能解决，第二天去问师姐，师姐说名称必须大写，我改成大写果然可以了。这个离谱规定让我记忆犹新。</p> 
<h4><a id="_83"></a>其他注意事项</h4> 
<p>1、<code>runabaqus.m</code>、<code>get_history_output.m</code>、<code>odbHistoyOutput.py</code>必须与运行的.m文件放在同一目录下，否则会报错类似：</p> 
<pre><code>&gt;&gt; beam1
未定义函数或变量 'runabaqus'。

出错 beam1 (line 24)
runabaqus(Path,InpFile,cpus);         %运行abaqus进行计算
</code></pre> 
<p>2、未找到匹配文件的报错可能原因有很多，从仿真运行到结果读取，任何一个小环节出问题最后大概率在<code>movefile</code>处报错。</p> 
<p>排查思路：</p> 
<p>（1）看生成的.odb文件的大小，若没有这个文件或文件过小（正常应该至少10M），就是仿真环节已经出问题了。<strong>检查abaqus licensing是否运行</strong>，若仿真环节没有问题会输出提示类似：</p> 
<pre><code>----------ABAQUS complete----------
           time costed  0:0:26
Abaqus License Manager checked out the following license(s): 
"cae" release 6.12 from DESKTOP-8I4F446 
&lt;1023 out of 1024 licenses remain available&gt;. 
</code></pre> 
<p>（2）若.odb文件大小正常，逐个检查req参数，软体手指仿真中此句为：</p> 
<pre><code class="prism language-matlab">req=['FINGER_8-1,Node FINGER_8-1.1,COOR1']; %指定部件名，节点名和读取的结果
</code></pre> 
<p>循环获取多个节点输出时可写为：</p> 
<pre><code class="prism language-MATLAB">nodef='Node FINGER_8-1.';     %用instance的名字，不管在abaqus里是大写还是小写这里都写成大写
%节点顺序按abaqus里查看的顺序排列
node=[19,45,955,1032,1231,1309,1507,185,207,1724,1816,2000,2092,2290,364,397,417,437,2866,468]; 
nx=zeros(27,20);ny=zeros(27,20);nz=zeros(27,20);
for k=1:1:20
    nodename=[nodef num2str(node(k))];
    k % 输出进度
    req=['FINGER_8-1,' nodename ',COOR1'];  %指定部件名，节点名和读取的结果
    %其他调用部分...
end
</code></pre> 
<p><strong>注意部件名和节点名必须和.inp文件中一致，且一定要在abaqus中要创建这些节点所需的历程输出（即输出COOR1）。</strong></p> 
<hr> 
<p>当时做联合仿真的时候踩了很多坑，本来想记录一下常见报错及解决思路，结果考试周那会儿太忙了没抽出时间，寒假里倒是有时间了，但有哪些坑都忘得差不多了，尝试重新做了一遍居然一次成功，想踩坑的时候倒踩不到了。。。根据记忆整理了本文，如有缺漏有缘再补充。</p> 
<p>参考链接：</p> 
<blockquote> 
 <p>https://blog.csdn.net/hdpai2018/article/details/106113842</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bd9699c4533cd2214f3173f3524be8bc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用mysql查询图书的信息_PHP&#43;MySQL 利用mysql_fetch_row模糊查询图书信息</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e5753175e414e456f8272009d3098815/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java方法的自动调用问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>