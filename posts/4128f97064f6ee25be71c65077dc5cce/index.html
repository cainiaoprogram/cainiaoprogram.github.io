<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于vue解决大数据表格卡顿问题 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于vue解决大数据表格卡顿问题" />
<meta property="og:description" content="点我在线体验Demo(请用电脑查看)
亲测苹果电脑，chrome浏览器无卡顿现象，其它浏览器并未测试，如遇到卡顿请备注系统和浏览器，方便我后续优化，谢谢
先看一下效果,一共1000 X 100 = 10W个单元格基本感受不到卡顿，而且每个单元格点击可以编辑，支持固定头和固定列
Github项目源代码 觉得可以就Star一下,哪里有问题也欢迎指出，感谢 解决问题核心点：根据可视区域，横向滚动加载，竖向滚动加载，控制dom数量 项目背景 笔者最近在做广告排期功能，需要进行点位预占，大的合同可能需要对多个资源排期，周期可能到几年这样，然后我们的页面交互是这样
横向每个月30个单元格，最多的3年，36个月，每行36*30=1080个单元格
竖向100个资源，总共约️10W个单元格，然后每个单元格里面会有一个输入框，一个库存总数，所以总数是20W个，内网使用，接口请求根本不是问题，可以浏览器渲染就扛不住了接口回来之后会出现几十秒的白屏，整个页面处于卡死状态
这还不算，加载出之后页面操作也是非常卡，滑动延迟严重，页面基本处于瘫痪状态
之前的功能是基于jquery开发的，项目重构用的vue,UI采用了ElementUI，ElmentUI中的表格在数据量较大是有严重的性能问题，最直接的表现就是白屏时间较长，而且会出现渲染错乱
所以就想着自己实现一个表格，解决卡顿问题
实现思路 表格拆分，动态加载 表格横向按月拆分，每个月份单独一个table，月份table外层放一个占位div，根据横向滚动位置控制展示
竖向按资源拆分，同样包裹一个占位div,按照滚动位置动态加载，始终保持dom数量上线
动态编辑，按需生成编辑输入框 不同的标签在浏览器渲染时性能是不一样的，比如input这种标签就比span等标签重许多，所以不能满屏input 方案就是点击单元格展示输入框，焦点丢失移除，此处的展示非display控制显示隐藏，而是v-if控制dom是否加载
代码分解 固定头 &lt;div class=&#34;table-head&#34;&gt; &lt;div class=&#34;module&#34; v-bind:style=&#34;{ transform: &#39;translateX(&#39; &#43; scrollLeft &#43; &#39;px)&#39; }&#34; v-for=&#34;(item, index) in monthData&#34; v-bind:key=&#34;index&#34;&gt; &lt;table cellspacing=&#34;0&#34; cellpadding=&#34;0&#34;&gt; &lt;thead&gt; &lt;tr&gt; &lt;td colspan=&#34;30&#34;&gt;{{item.month}}&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td width=&#34;100&#34; v-for=&#34;(d_item, d_index) in item.days&#34; v-bind:key=&#34;d_index&#34; style=&#34;min-width:100px&#34;&gt;{{d_item}}&lt;/td&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;/table&gt; &lt;/div&gt; &lt;/div&gt; 复制代码 固定列 &lt;div class=&#34;table-fix-cloumns&#34;&gt; &lt;div class=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4128f97064f6ee25be71c65077dc5cce/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-03-19T12:27:24+08:00" />
<meta property="article:modified_time" content="2019-03-19T12:27:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于vue解决大数据表格卡顿问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="article-content"> 
 <p><a href="https://link.juejin.im?target=https%3A%2F%2Fcoldday.github.io%2Fvue-fast-table%2Fdist%2Findex.html" rel="nofollow">点我在线体验Demo(请用电脑查看)</a></p> 
 <blockquote> 
  <p>亲测苹果电脑，chrome浏览器无卡顿现象，其它浏览器并未测试，如遇到卡顿请备注系统和浏览器，方便我后续优化，谢谢</p> 
 </blockquote> 
 <p>先看一下效果,一共<code>1000 X 100 = 10W</code>个单元格基本感受不到卡顿，而且每个单元格点击可以编辑，支持固定头和固定列</p> 
 <h5 class="heading"><a href="https://link.juejin.im?target=https%3A%2F%2Fgithub.com%2FColdDay%2Fvue-fast-table" rel="nofollow">Github项目源代码</a> 觉得可以就<code>Star</code>一下,哪里有问题也欢迎指出，感谢</h5> 
 <h5 class="heading">解决问题核心点：根据可视区域，横向滚动加载，竖向滚动加载，控制dom数量</h5> 
 <h4 class="heading">项目背景</h4> 
 <p>笔者最近在做广告排期功能，需要进行点位预占，大的合同可能需要对多个资源排期，周期可能到几年这样，然后我们的页面交互是这样</p> 
 <p>横向每个月30个单元格，最多的3年，36个月，每行36*30=1080个单元格</p> 
 <p>竖向100个资源，总共约️10W个单元格，然后每个单元格里面会有一个输入框，一个库存总数，所以总数是20W个，内网使用，接口请求根本不是问题，可以浏览器渲染就扛不住了接口回来之后会出现几十秒的白屏，整个页面处于卡死状态</p> 
 <p>这还不算，加载出之后页面操作也是非常卡，滑动延迟严重，页面基本处于瘫痪状态</p> 
 <p>之前的功能是基于jquery开发的，项目重构用的vue,UI采用了ElementUI，ElmentUI中的表格在数据量较大是有严重的性能问题，最直接的表现就是白屏时间较长，而且会出现渲染错乱</p> 
 <p>所以就想着自己实现一个表格，解决卡顿问题</p> 
 <h3 class="heading">实现思路</h3> 
 <h5 class="heading">表格拆分，动态加载</h5> 
 <p>表格横向按月拆分，每个月份单独一个table，月份table外层放一个占位div，根据横向滚动位置控制展示</p> 
 <p>竖向按资源拆分，同样包裹一个占位div,按照滚动位置动态加载，始终保持dom数量上线</p> 
 <h5 class="heading">动态编辑，按需生成编辑输入框</h5> 
 <h6 class="heading">不同的标签在浏览器渲染时性能是不一样的，比如input这种标签就比span等标签重许多，所以不能满屏input</h6> 
 <p>方案就是点击单元格展示输入框，焦点丢失移除，此处的展示非display控制显示隐藏，而是v-if控制dom是否加载</p> 
 <h4 class="heading">代码分解</h4> 
 <h5 class="heading">固定头</h5> 
 <pre><code class="hljs bash copyable">&lt;div class=<span class="hljs-string">"table-head"</span>&gt;
          &lt;div class=<span class="hljs-string">"module"</span>
            v-bind:style=<span class="hljs-string">"{ transform: 'translateX(' + scrollLeft + 'px)' }"</span>  
            v-for=<span class="hljs-string">"(item, index) in monthData"</span> v-bind:key=<span class="hljs-string">"index"</span>&gt;
            &lt;table cellspacing=<span class="hljs-string">"0"</span> cellpadding=<span class="hljs-string">"0"</span>&gt;
              &lt;thead&gt;
                &lt;tr&gt;
                  &lt;td colspan=<span class="hljs-string">"30"</span>&gt;{<!-- -->{item.month}}&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                  &lt;td width=<span class="hljs-string">"100"</span> 
                    v-for=<span class="hljs-string">"(d_item, d_index) in item.days"</span> v-bind:key=<span class="hljs-string">"d_index"</span>
                    style=<span class="hljs-string">"min-width:100px"</span>&gt;{<!-- -->{d_item}}&lt;/td&gt;
                &lt;/tr&gt;
              &lt;/thead&gt;
            &lt;/table&gt;
          &lt;/div&gt;
        &lt;/div&gt;
<span class="copy-code-btn">复制代码</span></code></pre> 
 <h5 class="heading">固定列</h5> 
 <pre><code class="hljs bash copyable"> &lt;div class=<span class="hljs-string">"table-fix-cloumns"</span>&gt;
          &lt;div class=<span class="hljs-string">"module fix-left-top"</span>&gt;
            &lt;table width=<span class="hljs-string">"100"</span> cellspacing=<span class="hljs-string">"0"</span> cellpadding=<span class="hljs-string">"0"</span>&gt;
              &lt;thead&gt;
                &lt;tr&gt;
                  &lt;td&gt;位置&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                  &lt;td&gt;position&lt;/td&gt;
                &lt;/tr&gt;
              &lt;/thead&gt;
            &lt;/table&gt;
          &lt;/div&gt;
          &lt;div class=<span class="hljs-string">"module"</span>  v-bind:style=<span class="hljs-string">"{ transform: 'translateY(' + scrollTop + 'px)' }"</span>&gt;
            &lt;table width=<span class="hljs-string">"100"</span> cellspacing=<span class="hljs-string">"0"</span> cellpadding=<span class="hljs-string">"0"</span>&gt;
              &lt;thead&gt;
                &lt;tr v-for=<span class="hljs-string">"(item, index) in projectData"</span> v-bind:key=<span class="hljs-string">"index"</span>&gt;
                  &lt;td&gt;{<!-- -->{item.name}}&lt;/td&gt;
                &lt;/tr&gt;
              &lt;/thead&gt;
            &lt;/table&gt;
          &lt;/div&gt;
        &lt;/div&gt;
<span class="copy-code-btn">复制代码</span></code></pre> 
 <h4 class="heading">表体</h4> 
 <pre><code class="hljs bash copyable">&lt;div class=<span class="hljs-string">"table-body"</span> @scroll=<span class="hljs-string">"tableScroll"</span> style=<span class="hljs-string">"height: 300px"</span>&gt;
          &lt;div class=<span class="hljs-string">"module"</span> 
            style=<span class="hljs-string">"width:3000px;"</span>
            v-for=<span class="hljs-string">"(item, index) in monthData"</span> v-bind:key=<span class="hljs-string">"index"</span>&gt;
            &lt;div class=<span class="hljs-string">"content"</span> 
              v-if=<span class="hljs-string">"Math.abs(index - curModule)  &lt; 3"</span>&gt;
              &lt;div class=<span class="hljs-string">"row"</span>
                style=<span class="hljs-string">"height:30px"</span>
                v-for=<span class="hljs-string">"(p_item, p_index) in projectData"</span> 
                v-bind:key=<span class="hljs-string">"p_index"</span>&gt;
                &lt;table width=<span class="hljs-string">"3000"</span>
                  v-if=<span class="hljs-string">"Math.abs(p_index - curRow)  &lt; 20"</span>
                  cellspacing=<span class="hljs-string">"0"</span> cellpadding=<span class="hljs-string">"0"</span>&gt;
                  &lt;tbody&gt;
                    &lt;tr&gt;
                      &lt;td 
                        @click=<span class="hljs-string">"clickTd(p_index,item.month, d_item, <span class="hljs-variable">$event</span>)"</span> 
                        v-for=<span class="hljs-string">"(d_item, d_index) in item.days"</span> v-bind:key=<span class="hljs-string">"d_index"</span>&gt;
                      &lt;span v-if=<span class="hljs-string">"!originProjectData[p_index][''+item.month][''+d_item]['show']"</span>&gt;{<!-- -->{originProjectData[p_index][<span class="hljs-string">''</span>+item.month][<span class="hljs-string">''</span>+d_item][<span class="hljs-string">'last'</span>]}}&lt;/span&gt;
                      &lt;input
                        @blur=<span class="hljs-string">"blurTd(p_index,item.month, d_item)"</span>
                        v-if=<span class="hljs-string">"originProjectData[p_index][''+item.month][''+d_item]['show']"</span>
                        v-model=<span class="hljs-string">"originProjectData[p_index][''+item.month][''+d_item]['last']"</span>
                        v-focus=<span class="hljs-string">"originProjectData[p_index][''+item.month][''+d_item]['focus']"</span>/&gt;
                      &lt;/td&gt;
                    &lt;/tr&gt;
                  &lt;/tbody&gt;
                &lt;/table&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
<span class="copy-code-btn">复制代码</span></code></pre> 
 <p>经过如上优化，完美解决表格卡顿问题，但是我并没有封装组件，原因如下</p> 
 <pre><code class="copyable">·插件封装后会有很多限制，不能再用vue那种模板写法，用json传入数据，自定义内容不是很灵活
·可以根据自己的应用场景自行修改拓展，代码已经很简洁
·比较懒
<span class="copy-code-btn">复制代码</span></code></pre> 
 <h3 class="heading">如果你有类似需求可以试一下我这个，怎么该你说了算</h3> 
</div> 
<p>转载于:https://juejin.im/post/5c8e51bff265da67f51b42c6</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/24cf8f109b8bc88eca1ab68e88eb3068/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mac系统下使用ll命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/af23648532c59bb404b8d520c0874f7d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">6.Python3标准库--数学运算</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>