<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mybatis 代码生成器 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Mybatis 代码生成器" />
<meta property="og:description" content="MBG与Example GitHub - mybatis/generator: A code generator for MyBatis.
我们在项目中使用Mybatis的时候，针对需要操作的一张表，需要创建实体类、Mapper映射器、Mapper接口，里面又有很多的字段和方法的配置，这部分的工作是非常频繁的。而大部分时候我们对于表的基本操作都是相同的，比如根据主键查询、根据Map查询、单条插入、批量插入、根据主键删除等等等等。当我们的表很多的时候，意味着有大量的重复工作。
所以有没有一种办法，可以根据我们的表，自动生成实体类、Mapper映射器、Mapper接口、里面包含了我们需要用到的这些基本方法和SQL呢。
Mybatis也提供了一个代码生成器，叫做Mybatis Generator，建成MBG，是mybatis的一个插件。我们只需要修改一个配置文件，使用相关的jar包命令或者java代码就可以帮助我们生成实体类、映射器和接口文件。
MBG的配置文件里面有一个Example的开关，这个东西用来构造复杂的筛选条件的，换句话说就是根据我们的代码去生成where条件。
原理：在实体类中包含了两个继承关系的Criteria，用其中自动生成的方法来构建查询条件。把这个包含了Criteria的实体类作为参数传到查询参数中，在解析Mapper映射器的时候会转换成SQL条件。
添加配置文件 我们添加如下的配置文件
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt; &lt;!DOCTYPE generatorConfiguration PUBLIC &#34;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&#34; &#34;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&#34;&gt; &lt;generatorConfiguration&gt; &lt;!-- 数据库的驱动包路径 --&gt; &lt;classPathEntry location=&#34;C:\Users\dpb\.m2\repository\mysql\mysql- connectorjava\8.0.11\mysql-connector-java-8.0.11.jar&#34; /&gt; &lt;context id=&#34;DB2Tables&#34; targetRuntime=&#34;MyBatis3&#34;&gt; &lt;!-- 去掉生成文件中的注释 --&gt; &lt;commentGenerator&gt; &lt;property name=&#34;suppressAllComments&#34; value=&#34;true&#34; /&gt; &lt;/commentGenerator&gt; &lt;!-- 数据库链接URL、用户名、密码 --&gt; &lt;jdbcConnection driverClass=&#34;com.mysql.cj.jdbc.Driver&#34; connectionURL=&#34;jdbc:mysql://localhost:3306/mybatisdb? characterEncoding=utf-8&amp;amp;serverTimezone=UTC&#34; userId=&#34;root&#34; password=&#34;123456&#34;&gt; &lt;property name=&#34;nullCatalogMeansCurrent&#34; value=&#34;true&#34; /&gt; &lt;/jdbcConnection&gt; &lt;!-- &lt;jdbcConnection driverClass=&#34;oracle.jdbc.driver.OracleDriver&#34; connectionURL=&#34;jdbc:oracle:thin:@localhost:1521:XE&#34; userId=&#34;car&#34; password=&#34;car&#34;&gt; &lt;/jdbcConnection&gt; --&gt; &lt;javaTypeResolver &gt; &lt;property name=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/fd391afb237c1ef7b120313a3c7317b1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-28T17:47:56+08:00" />
<meta property="article:modified_time" content="2022-09-28T17:47:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mybatis 代码生成器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>MBG与Example</h3> 
<p><a href="https://github.com/mybatis/generator" title="GitHub - mybatis/generator: A code generator for MyBatis.">GitHub - mybatis/generator: A code generator for MyBatis.</a></p> 
<p>        我们在项目中使用Mybatis的时候，针对需要操作的一张表，需要创建实体类、Mapper映射器、Mapper接口，里面又有很多的字段和方法的配置，这部分的工作是非常频繁的。而大部分时候我们对于表的基本操作都是相同的，比如根据主键查询、根据Map查询、单条插入、批量插入、根据主键删除等等等等。当我们的表很多的时候，意味着有大量的重复工作。</p> 
<p>        所以有没有一种办法，可以根据我们的表，自动生成实体类、Mapper映射器、Mapper接口、里面包含了我们需要用到的这些基本方法和SQL呢。</p> 
<p>        Mybatis也提供了一个代码生成器，叫做Mybatis Generator，建成MBG，是mybatis的一个插件。我们只需要修改一个配置文件，使用相关的jar包命令或者java代码就可以帮助我们生成实体类、映射器和接口文件。</p> 
<p>        MBG的配置文件里面有一个Example的开关，这个东西用来构造复杂的筛选条件的，换句话说就是根据我们的代码去生成where条件。</p> 
<p>        原理：在实体类中包含了两个继承关系的Criteria，用其中自动生成的方法来构建查询条件。把这个包含了Criteria的实体类作为参数传到查询参数中，在解析Mapper映射器的时候会转换成SQL条件。</p> 
<h4>添加配置文件</h4> 
<p>我们添加如下的配置文件</p> 
<pre><code class="language-XML">        &lt;?xml version="1.0" encoding="UTF-8"?&gt;
        &lt;!DOCTYPE generatorConfiguration
                PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"
                "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;
&lt;generatorConfiguration&gt;
    &lt;!-- 数据库的驱动包路径 --&gt;
    &lt;classPathEntry location="C:\Users\dpb\.m2\repository\mysql\mysql-        connectorjava\8.0.11\mysql-connector-java-8.0.11.jar" /&gt;
        &lt;context id="DB2Tables" targetRuntime="MyBatis3"&gt;
            &lt;!-- 去掉生成文件中的注释 --&gt;
            &lt;commentGenerator&gt;
                &lt;property name="suppressAllComments" value="true" /&gt;
            &lt;/commentGenerator&gt;
            &lt;!-- 数据库链接URL、用户名、密码 --&gt;
            &lt;jdbcConnection driverClass="com.mysql.cj.jdbc.Driver"
                    connectionURL="jdbc:mysql://localhost:3306/mybatisdb?
characterEncoding=utf-8&amp;amp;serverTimezone=UTC"
                    userId="root"
                    password="123456"&gt;
                &lt;property name="nullCatalogMeansCurrent" value="true" /&gt;
            &lt;/jdbcConnection&gt;
    &lt;!-- &lt;jdbcConnection driverClass="oracle.jdbc.driver.OracleDriver"
    connectionURL="jdbc:oracle:thin:@localhost:1521:XE"
    userId="car"
    password="car"&gt;
    &lt;/jdbcConnection&gt; --&gt;
            &lt;javaTypeResolver &gt;
                &lt;property name="forceBigDecimals" value="false" /&gt;
            &lt;/javaTypeResolver&gt;
            &lt;!-- 生成模型的包名和位置 --&gt;
            &lt;javaModelGenerator targetPackage="com.gupaoedu.vip.domain" targetProject="./src/main/java"&gt;
            &lt;!-- 是否在当前路径下新加一层schema,eg：fase路径com.oop.eksp.user.model，true:com.oop.eksp.user.model.[schemaName] --&gt;
                &lt;property name="enableSubPackages" value="false" /&gt;
                &lt;property name="trimStrings" value="true" /&gt;
            &lt;/javaModelGenerator&gt;
            &lt;!-- 生成的映射文件包名和位置 --&gt;
            &lt;sqlMapGenerator targetPackage="com.gupaoedu.vip.mapper" targetProject="./src/main/java"&gt;
            &lt;property name="enableSubPackages" value="false" /&gt;
            &lt;/sqlMapGenerator&gt;
        &lt;!-- 生成DAO的包名和位置 --&gt;
        &lt;javaClientGenerator type="XMLMAPPER" targetPackage="com.gupaoedu.vip.mapper" targetProject="./src/main/java"&gt;
            &lt;property name="enableSubPackages" value="false" /&gt;
        &lt;/javaClientGenerator&gt;
        &lt;table tableName="t_user" domainObjectName="User" /&gt;
    &lt;/context&gt;
&lt;/generatorConfiguration&gt;</code></pre> 
<h4>添加插件</h4> 
<p>        我们需要在pom.xml中添加对应的插件</p> 
<pre><code class="language-XML">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-generator-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;1.3.2&lt;/version&gt;
            &lt;configuration&gt;
            &lt;!-- 指定配置文件的位置 --&gt;
                &lt;configurationFile&gt;src/main/resources/generatorConfig.xml&lt;/configurationFile&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre> 
<h4> 生成</h4> 
<p>        然后我们就可以利用插件帮助我们快速生成我们需要的表结构对应的相关文件</p> 
<p><img alt="" height="330" src="https://images2.imgbox.com/e4/eb/fRAKuicX_o.png" width="607"></p> 
<h3>通用Mapper</h3> 
<p>        问题：当我们的表字段发生变化的时候，我们需要修改实体类和Mapper文件定义的字段和方法。如 果是增量维护，那么一个个文件去修改。如果是全量替换，我们还要去对比用MBG生成的文件。字段变动一次就要修改一次，维护起来非常麻烦。</p> 
<h4>方式一</h4> 
<p>        第一个，因为MyBatis的Mapper是支持继承的（见：https://github.com/mybatis/mybatis-3/issue s/35）。所以我们可以把我们的Mapper.xml和Mapper接口都分成两个文件。一个是MBG生成的，这部 分是固定不变的。然后创建DAO类继承生成的接口，变化的部分就在DAO里面维护。 </p> 
<pre><code class="language-java">public interface UserMapperExt extends UserMapper {
    public List&lt;User&gt; selectUserByName(String userName);
}</code></pre> 
<p>对应的映射文件</p> 
<pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" &gt;
    &lt;mapper namespace="com.gupaoedu.vip.mapper.UserMapperExt" &gt;
        &lt;resultMap id="BaseResultMapExt" type="com.gupaoedu.vip.domain.User" &gt;
            &lt;id column="id" property="id" jdbcType="INTEGER" /&gt;
            &lt;result column="user_name" property="userName" jdbcType="VARCHAR" /&gt;
            &lt;result column="real_name" property="realName" jdbcType="VARCHAR" /&gt;
            &lt;result column="password" property="password" jdbcType="VARCHAR" /&gt;
            &lt;result column="age" property="age" jdbcType="INTEGER" /&gt;
            &lt;result column="d_id" property="dId" jdbcType="INTEGER" /&gt;
            &lt;result column="i_id" property="iId" jdbcType="INTEGER" /&gt;
        &lt;/resultMap&gt;
    &lt;select id="selectUserByName" resultMap="BaseResultMapExt" &gt;
        select * from t_user where user_name = #{userName}
    &lt;/select&gt;
&lt;/mapper&gt;</code></pre> 
<p>在全局配置文件中我们也需要扫描</p> 
<pre><code class="language-XML">&lt;mappers&gt;
    &lt;mapper resource="mapper/UserMapper.xml"/&gt;
    &lt;mapper resource="mapper/UserMapperExt.xml"/&gt;
&lt;/mappers&gt;</code></pre> 
<p>所以以后只要修改Ext的文件就可以了。这么做有一个缺点，就是文件会增多。</p> 
<h4>方式二</h4> 
<p>        既然针对每张表生成的基本方法都是一样的，也就是公共的方法部分代码都是一样的，我们能不能把 这部分合并成一个文件，让它支持泛型呢？ 当然可以！</p> 
<p>        编写一个支持泛型的通用接口，比如叫GPBaseMapper，把实体类作为参数传入。这个接口里面定义 了大量的增删改查的基础方法，这些方法都是支持泛型的。 自定义的Mapper接口继承该通用接口，例如BlogMapper extends GPBaseMapper，自动获得对实 体类的操作方法。遇到没有的方法，我们依然可以在我们自己的Mapper里面编写。</p> 
<p>        我们能想到的解决方案，早就有人做了这个事了，这个东西就叫做通用Mapper。</p> 
<p><a href="https://github.com/abel533/Mapper/wiki" title="https://github.com/abel533/Mapper/wiki">https://github.com/abel533/Mapper/wiki</a></p> 
<p>        用途：主要解决单表的增删改查问题，并不适用于多表关联查询的场景。</p> 
<p>         除了配置文件变动的问题之外，通用Mapper还可以解决：</p> 
<ol><li>每个Mapper接口中大量的重复方法的定义;</li><li>屏蔽数据库的差异；</li><li>提供批量操作的方法；</li><li>实现分页。</li></ol> 
<p>使用方式：在Spring中使用时，引入jar包，替换applicationContext.xml中的sqlSessionFactory和configure。</p> 
<pre><code class="language-XML">&lt;bean class="tk.mybatis.spring.mapper.MapperScannerConfigurer"&gt;
    &lt;property name="basePackage" value="com.gupaoedu.crud.dao"/&gt;
&lt;/bean&gt;
</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9210ce80c692ddecc39616d65dee8858/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">allegro如何将A板复制到B板中 (sub drawing功能的应用)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/62d3644deb946b57fe85d7a873583a69/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【快速幂】a的n次幂的算法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>