<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>利用三次样条插值调整鱼眼扭曲程度 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="利用三次样条插值调整鱼眼扭曲程度" />
<meta property="og:description" content="本文利用三次样条插值算法，改变鱼眼扭曲程度。效果如下图所示：
源码下载地址：利用三次样条插值算法更改鱼眼特效的扭曲程度资源-CSDN文库
（说明：源码基于QT和opencv ）
主要代码 鱼眼扭曲 void fisheye(const Mat &amp;src, Mat &amp;dst) { dst.create(src.rows, src.cols, CV_8UC3); dst.setTo(0); if (srcX.size() == 0 || srcX.size() != dstY.size() || cubicCoeffs == nullptr) return; Point2f center; center.x = src.cols / 2.0; center.y = src.rows / 2.0; double rr = sqrt(center.x * center.x &#43; center.y * center.y); for (int id = 1; id &lt; src.rows - 1; id&#43;&#43;) { for (int jd = 1; jd &lt; src." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ed29610f5b6dfd706682d9ea49a43249/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-09T21:41:49+08:00" />
<meta property="article:modified_time" content="2023-11-09T21:41:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">利用三次样条插值调整鱼眼扭曲程度</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>         本文利用三次样条插值算法，改变鱼眼扭曲程度。效果如下图所示：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b8/f0/bCn131Wc_o.gif"></p> 
<p>源码下载地址：<a href="https://download.csdn.net/download/hulinhulin/88520102" title="利用三次样条插值算法更改鱼眼特效的扭曲程度资源-CSDN文库">利用三次样条插值算法更改鱼眼特效的扭曲程度资源-CSDN文库</a></p> 
<p>（说明：源码基于QT和opencv ）</p> 
<h2>主要代码</h2> 
<h3>鱼眼扭曲</h3> 
<pre><code class="hljs">void fisheye(const Mat &amp;src, Mat &amp;dst)
{
    dst.create(src.rows, src.cols, CV_8UC3);
    dst.setTo(0);

    if (srcX.size() == 0 || srcX.size() != dstY.size() || cubicCoeffs == nullptr)
        return;

    Point2f center;
    center.x = src.cols / 2.0;
    center.y = src.rows / 2.0;
    double rr = sqrt(center.x * center.x + center.y * center.y);
    for (int id = 1; id &lt; src.rows - 1; id++) {
        for (int jd = 1; jd &lt; src.cols - 1; jd++) {
            double xd = 1.0 * (jd - center.x) / rr;//nomalize to -1 --- 1
            double yd = 1.0 * (id - center.y) / rr;
            double rd = sqrt(xd * xd + yd * yd);
            double phid = atan2(yd, xd);
            //double xs = asin(rd) * 2 / PI * cos(phid) * rr * sqrt(2);
            //double ys = asin(rd) * 2 / PI * sin(phid) * rr * sqrt(2);

            double nr = 0;
            if (rd&gt;0 &amp;&amp; rd &lt;= 1)
                cubicSpline.cubicSplineInterpolation2(cubicCoeffs, srcX, rd, nr);
            double xs = nr * cos(phid) * rr * sqrt(2);
            double ys = nr * sin(phid) * rr * sqrt(2);

            int is = round(ys +  center.y);
            int js = round(xs + center.x);
            if (is &gt; dst.rows - 1 || is &lt; 1 || js&gt;dst.cols - 1 || js &lt; 1){
                //is = id;
                //js = jd;
            }
            else{
                dst.at&lt;Vec3b&gt;(id, jd)[0] = src.at&lt;Vec3b&gt;(is, js)[0];
                dst.at&lt;Vec3b&gt;(id, jd)[1] = src.at&lt;Vec3b&gt;(is, js)[1];
                dst.at&lt;Vec3b&gt;(id, jd)[2] = src.at&lt;Vec3b&gt;(is, js)[2];
            }
        }
    }
}
</code></pre> 
<p>其中cubicSpline.cubicSplineInterpolation2是调用三次样条插值函数计算某点的对应值，详情可查看源码。</p> 
<h3>三次样条插值算法</h3> 
<p>可以查看以下博文：</p> 
<p><a class="has-card" href="https://mp.csdn.net/mp_blog/creation/editor/134171633" title="三次样条插值"><span class="link-card-box"><span class="link-title">三次样条插值</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/a6/5f/fPchGsHe_o.png" alt="icon-default.png?t=N7T8">https://mp.csdn.net/mp_blog/creation/editor/134171633</span></span></a>插值初始化如下：</p> 
<pre><code class="hljs">    vector&lt;double&gt; dstY;
    vector&lt;double&gt; srcX;

    //srcX(not change after initialize)
    srcX.push_back(0.0f);
    srcX.push_back(0.2f);
    srcX.push_back(0.4f);
    srcX.push_back(0.6f);
    srcX.push_back(0.8f);
    srcX.push_back(1.0f);

    //dstY
    for (int i = 0;i &lt; (int)srcX.size();i++)
    {
        float v = asin(srcX.at(i)) * 2 / PI;
        if (v &gt; 1.0f)
            v = 1.0f;
     }</code></pre> 
<h3>将图片压缩成圆形</h3> 
<p>通过点击转化成圆形按钮可实现将图片转化成圆形：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b5/57/zDtRhxze_o.jpg"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c8b5f35a5c2c568bbbdccb29559ad9a9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">记录一个Arduino调用MPU6050的姿态解算算法代码</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a79fb93d6958e02cc21f8073833ab726/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">大语言模型-LLM简介</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>