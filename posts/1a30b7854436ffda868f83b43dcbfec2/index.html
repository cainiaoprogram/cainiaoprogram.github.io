<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>大数据之LibrA数据库系统告警处理（ALM-12033 慢盘故障） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="大数据之LibrA数据库系统告警处理（ALM-12033 慢盘故障）" />
<meta property="og:description" content="告警解释 系统每一秒执行一次iostat命令，监控磁盘I/O的系统指标，如果在60s内，svctm大于100ms的周期数大于30次则认为磁盘有问题，产生该告警。
更换磁盘后，告警自动恢复。
告警属性 告警ID
告警级别
可自动清除
12033
严重
是
告警参数 参数名称
参数含义
ServiceName
产生告警的服务名称。
RoleName
产生告警的角色名称。
HostName
产生告警的主机名。
DiskName
产生告警的磁盘名。
对系统的影响 磁盘慢盘故障，导致业务性能下降，阻塞业务的处理能力，例如DBService主备同步等，严重时可能会导致服务不可用。
可能原因 磁盘老化或者磁盘坏道。
处理步骤 检查磁盘状态。
在FusionInsight Manager界面，单击“告警管理”。查看该告警的详细信息，查看定位信息中“HostName”字段和“DiskName”字段的值，获取该告警产生的故障磁盘信息。确认上报告警的节点是否为虚拟化环境。 是，执行步骤 4。否，执行步骤 7。
请检查虚拟化环境提供的存储性能是否满足硬件要求，检查完毕之后执行步骤 17。 说明： 硬件要求说明，可参考产品文档中《产品描述》的“部署方案 &gt; 硬件及运行环境要求”章节。
登录告警节点，执行df -h命令，查看输出内容是否包含“DiskName”字段的值。 是，执行步骤 7。否，执行步骤 6。
执行lsblk命令，是否可以查到“DiskName”字段值与磁盘设备的映射关系。 是，执行步骤 7。.否，执行步骤 25。
使用PuTTY工具，以root用户登录上报告警的节点，执行lsscsi | grep &#34;/dev/sd[x]&#34;命令查看磁盘的设备信息，判断磁盘是否建立了RAID。 说明： 其中/dev/sd[x]为步骤 2中获取到的上报告警的磁盘名称。
例如执行：
lsscsi | grep &#34;/dev/sda&#34;
如果命令执行结果第三列显示ATA、SATA或者SAS，说明磁盘没有建立RAID；显示其他信息，则该磁盘可能建立了RAID。
是，执行步骤 12。否，执行步骤 8。
执行smartctl -i /dev/sd[x]命令检查硬件是否支持smart。 例如执行：
smartctl -i /dev/sda" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1a30b7854436ffda868f83b43dcbfec2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-09T16:35:50+08:00" />
<meta property="article:modified_time" content="2023-11-09T16:35:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">大数据之LibrA数据库系统告警处理（ALM-12033 慢盘故障）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h5>告警解释</h5> 
<p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p6311694">系统每一秒执行一次<strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b56805252">iostat</strong>命令，监控磁盘I/O的系统指标，如果在60s内，svctm大于100ms的周期数大于30次则认为磁盘有问题，产生该告警。</p> 
<p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p41485221">更换磁盘后，告警自动恢复。</p> 
<h5>告警属性</h5> 
<table border="1" cellpadding="4" cellspacing="0" id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_table4859769"><thead><tr id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_row63241711"><th id="mcps1.3.2.2.1.4.1.1"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p22304965">告警ID</p> </th><th id="mcps1.3.2.2.1.4.1.2"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p61871711">告警级别</p> </th><th id="mcps1.3.2.2.1.4.1.3"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p45552677">可自动清除</p> </th></tr></thead><tbody><tr id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_row65888257"><td style="vertical-align:top;"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p35348568">12033</p> </td><td style="vertical-align:top;"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p44661780">严重</p> </td><td style="vertical-align:top;"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p60834461">是</p> </td></tr></tbody></table> 
<h5>告警参数</h5> 
<table border="1" cellpadding="4" cellspacing="0" id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_table28644314"><thead><tr id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_row6331686"><th id="mcps1.3.3.2.1.3.1.1"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p43104582">参数名称</p> </th><th id="mcps1.3.3.2.1.3.1.2"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p1810271">参数含义</p> </th></tr></thead><tbody><tr id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_row12414232"><td style="vertical-align:top;"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p66028697">ServiceName</p> </td><td style="vertical-align:top;"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p46724235">产生告警的服务名称。</p> </td></tr><tr id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_row17864933"><td style="vertical-align:top;"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p37773507">RoleName</p> </td><td style="vertical-align:top;"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p39755237">产生告警的角色名称。</p> </td></tr><tr id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_row22252820"><td style="vertical-align:top;"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p57647959">HostName</p> </td><td style="vertical-align:top;"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p38973140">产生告警的主机名。</p> </td></tr><tr id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_row15213943"><td style="vertical-align:top;"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p24369851">DiskName</p> </td><td style="vertical-align:top;"> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p27800908">产生告警的磁盘名。</p> </td></tr></tbody></table> 
<h5>对系统的影响</h5> 
<p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p37281041">磁盘慢盘故障，导致业务性能下降，阻塞业务的处理能力，例如DBService主备同步等，严重时可能会导致服务不可用。</p> 
<h5>可能原因</h5> 
<p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p66974322">磁盘老化或者磁盘坏道。</p> 
<h5>处理步骤</h5> 
<p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p1856018391458"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b3282392191458">检查磁盘状态。</strong></p> 
<ol id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ol4468641992138"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li4149191591458">在FusionInsight Manager界面，单击“告警管理”。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3788291791458"><a name="zh-cn_topic_0085571118_li3788291791458"></a>查看该告警的详细信息，查看定位信息中“HostName”字段和“DiskName”字段的值，获取该告警产生的故障磁盘信息。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li540193791458">确认上报告警的节点是否为虚拟化环境。 <p></p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul4861744191458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3490378991458">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2831628891458" rel="nofollow">步骤 4</a>。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li863462891458">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2583597491458" rel="nofollow">步骤 7</a>。</li></ul><p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2831628891458"><a name="zh-cn_topic_0085571118_li2831628891458"></a>请检查虚拟化环境提供的存储性能是否满足硬件要求，检查完毕之后执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3381567991458" rel="nofollow">步骤 17</a>。 <p></p> 说明： <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p4015336691458">硬件要求说明，可参考产品文档中《产品描述》的“部署方案 &gt; 硬件及运行环境要求”章节。</p> <p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1205527419227">登录告警节点，执行df -h命令，查看输出内容是否包含“DiskName”字段的值。 <p></p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul12100362193111"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li56917037201355">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2583597491458" rel="nofollow">步骤 7</a>。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li8577348201455">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2325719119312" rel="nofollow">步骤 6</a>。</li></ul><p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2325719119312"><a name="zh-cn_topic_0085571118_li2325719119312"></a>执行lsblk命令，是否可以查到“DiskName”字段值与磁盘设备的映射关系。 <p></p> <img alt="" height="178" src="https://images2.imgbox.com/4b/d8/XLStVXSJ_o.png" width="620"> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul245583919286"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li40945773201617">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2583597491458" rel="nofollow">步骤 7</a>。.</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li4547636219286">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li5456647491458" rel="nofollow">步骤 25</a>。</li></ul><p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2583597491458"><a name="zh-cn_topic_0085571118_li2583597491458"></a>使用PuTTY工具，以<strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b3119718091458">root</strong>用户登录上报告警的节点，执行<strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b1233916891458">lsscsi | grep "/dev/sd[x]"</strong>命令查看磁盘的设备信息，判断磁盘是否建立了RAID。 <p></p> 说明： <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p5994854291458">其中<strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b266597091458">/dev/sd[x]</strong>为<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3788291791458" rel="nofollow">步骤 2</a>中获取到的上报告警的磁盘名称。</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p1461704291458">例如执行：</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p6444452091458"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b4312977191458">lsscsi | grep "/dev/sda"</strong></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p5262362091458">如果命令执行结果第三列显示ATA、SATA或者SAS，说明磁盘没有建立RAID；显示其他信息，则该磁盘可能建立了RAID。</p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul385053291458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3465478891458">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1471607091458" rel="nofollow">步骤 12</a>。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li5557441691458">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li523387391458" rel="nofollow">步骤 8</a>。</li></ul><p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li523387391458"><a name="zh-cn_topic_0085571118_li523387391458"></a>执行<strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b4710486591458">smartctl -i /dev/sd[x]</strong>命令检查硬件是否支持smart。 <p></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p2129060791458">例如执行：</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p5739774091458"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b4681761791458">smartctl -i /dev/sda</strong></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p1870537691458">如果命令执行结果中包含“SMART support is: Enabled”，表示磁盘支持smart；执行结果中包含“Device does not support SMART”或者其他，表示磁盘不支持smart。</p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul3413065691458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3874045191458">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3483730991458" rel="nofollow">步骤 9</a>。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li5096886491458">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3381567991458" rel="nofollow">步骤 17</a>。</li></ul><p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3483730991458"><a name="zh-cn_topic_0085571118_li3483730991458"></a>执行<strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b4510032791458">smartctl -H --all /dev/sd[x]</strong>命令查看smart的基本信息，判断磁盘是否正常。 <p></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p324976291458">例如执行：</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p2924786491458"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b6190418491458">smartctl -H --all /dev/sda</strong></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p2026674991458">查看命令执行结果的“SMART overall-health self-assessment test result”内容，如果是“FAILED”，表示磁盘故障，需要更换；如果为“PASSED”，需要进一步看“Reallocated_Sector_Ct”或者“Elements in grown defect list”项的计数，如果大于100，则认为磁盘故障，需要更换。</p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul4818301491458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3099395091458">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1145378391458" rel="nofollow">步骤 10</a>。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2748205391458">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li6235920691458" rel="nofollow">步骤 18</a>。</li></ul><p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1145378391458"><a name="zh-cn_topic_0085571118_li1145378391458"></a>执行<strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b3597518991458">smartctl -l error -H /dev/sd[x]</strong>命令查看磁盘的GLIST列表，进一步继续判断磁盘是否正常。 <p></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p5534124691458">例如执行：</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p2830917391458"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b5345597091458">smartctl -l error -H /dev/sda</strong></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p1134168691458">查看命令执行结果的“Command/Featrue_name”列，如果出现“READ SECTOR(S)”或者“WRITE SECTOR(S)”表示磁盘有坏道；如果出现其他错误，表示磁盘电路板有问题。这两种错误均表示磁盘不正常，需要更换。</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p3496631491458">如果显示“No Errors Logged”，则表示没有错误日志，则可以触发磁盘smart自检。</p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul4626137591458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1369919991458">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2167780691458" rel="nofollow">步骤 11</a>。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3589332091458">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li6235920691458" rel="nofollow">步骤 18</a>。</li></ul><p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2167780691458"><a name="zh-cn_topic_0085571118_li2167780691458"></a>执行<strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b6088252791458">smartctl -t long /dev/sd[x]</strong>命令触发磁盘smart自检。命令执行后，会提示自检完成的时间，在等待自检完成后，重新执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3483730991458" rel="nofollow">步骤 9</a>和<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1145378391458" rel="nofollow">步骤 10</a>，检查磁盘是否正常。 <p></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p2440318291458">例如执行：</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p1830205491458"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b3050076291458">smartctl -t long /dev/sda</strong></p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul607140291458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li5464262591458">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3381567991458" rel="nofollow">步骤 17</a>。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li6397652591458">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li6235920691458" rel="nofollow">步骤 18</a>。</li></ul><p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1471607091458"><a name="zh-cn_topic_0085571118_li1471607091458"></a>执行<strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b6533577191458">smartctl -d [sat|scsi]+megaraid,[DID] -H --all /dev/sd[x]</strong>命令检查硬件是否支持smart。 <p></p> 说明： 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul5770606591458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li4959254191458">[sat|scsi]表示磁盘类型，需要尝试以上两种类型。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li4367968891458">[DID]表示槽位信息，需要尝试0～15。</li></ul><p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p5757287591458">例如依次执行：</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p4839383191458"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b3289130291458">smartctl -d sat+megaraid,0 -H --all /dev/sda</strong></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p2758626391458"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b4694978191458">smartctl -d sat+megaraid,1 -H --all /dev/sda</strong></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p1989484891458"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b4483590591458">smartctl -d sat+megaraid,2 -H --all /dev/sda</strong></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p86996191458">...</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p782964991458">依次尝试不同磁盘类型和槽位信息的命令组合，如果执行结果中显示“SMART support is: Enabled”，表示磁盘支持smart，记录命令执行成功时磁盘类型和槽位信息组合参数；如果尝试完以上所有的命令组合，执行结果都未显示“SMART support is: Enabled”，表示磁盘不支持smart。</p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul335797891458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3022180591458">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li4568369291458" rel="nofollow">步骤 13</a>。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3204716691458">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1606413991458" rel="nofollow">步骤 16</a>。</li></ul><p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li4568369291458"><a name="zh-cn_topic_0085571118_li4568369291458"></a>执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1471607091458" rel="nofollow">步骤 12</a>中记录的<strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b939158291458">smartctl -d [sat|scsi]+megaraid,[DID] -H --all /dev/sd[x]</strong>命令查看smart的基本信息，判断磁盘是否正常。 <p></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p1741538191458">例如执行：</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p2252070191458"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b135972091458">smartctl -d sat+megaraid,2 -H --all /dev/sda</strong></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p1223748891458">查看命令执行结果的“SMART overall-health self-assessment test result”内容，如果是“FAILED”，表示磁盘故障，需要更换；如果为“PASSED”，需要进一步看“Reallocated_Sector_Ct”或者“Elements in grown defect list”项的计数，如果大于100，则认为磁盘故障，需要更换。</p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul4302853391458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li5171248091458">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li5027541391458" rel="nofollow">步骤 14</a>。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2796133291458">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li6235920691458" rel="nofollow">步骤 18</a>。</li></ul><p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li5027541391458"><a name="zh-cn_topic_0085571118_li5027541391458"></a>执行<strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b4982553391458">smartctl -d [sat|scsi]+megaraid,[DID] -l error -H /dev/sd[x]</strong>命令查看硬盘的GLIST列表，进一步判断硬盘是否正常。 <p></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p4577661891458">例如执行：</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p933637991458"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b1691855591458">smartctl -d sat+megaraid,2 -l error -H /dev/sda</strong></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p1804927491458">查看命令执行结果的“Command/Featrue_name”列，如果出现“READ SECTOR(S)”或者“WRITE SECTOR(S)”表示磁盘有坏道；如果出现其他错误，表示磁盘电路板有问题。这两种错误均表示磁盘不正常，需要更换。</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p2822574691458">如果显示“No Errors Logged”，则表示没有错误日志，则可以触发磁盘smart自检。</p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul5270512291458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li458405291458">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1119862391458" rel="nofollow">步骤 15</a>。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3576394791458">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li6235920691458" rel="nofollow">步骤 18</a>。</li></ul><p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1119862391458"><a name="zh-cn_topic_0085571118_li1119862391458"></a>执行<strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b3367874791458">smartctl -d [sat|scsi]+megaraid,[DID] -t long /dev/sd[x]</strong>命令触发磁盘smart自检。命令执行后，会提示自检完成的时间，在等待自检完成后，重新执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li4568369291458" rel="nofollow">步骤 13</a>和<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li5027541391458" rel="nofollow">步骤 14</a>，检查磁盘是否正常。 <p></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p5707158091458">例如执行：</p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p4388217491458"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b5939525391458">smartctl -d sat+megaraid,2 -t long /dev/sda</strong></p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul6479523391458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li4628618791458">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3381567991458" rel="nofollow">步骤 17</a>。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li5819363791458">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li6235920691458" rel="nofollow">步骤 18</a>。</li></ul><p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1606413991458"><a name="zh-cn_topic_0085571118_li1606413991458"></a>磁盘不支持smart，通常是因为配置的RAID卡不支持，此时需要使用对应RAID卡厂商的检查工具进行处理，然后执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3381567991458" rel="nofollow">步骤 17</a>。 <p></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p2612691991458">例如LSI一般是MegaCli工具。</p> <p></p> </li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3381567991458"><a name="zh-cn_topic_0085571118_li3381567991458"></a>删除告警，并继续观察该告警，查看同一块磁盘的告警是否会继续上报。 <p></p> <p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p3590566291458">如果当前磁盘出现三次以上该告警，建议用户更换磁盘。</p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul5471550891458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2267753091458">是，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li6235920691458" rel="nofollow">步骤 18</a>。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2494067591458">否，操作结束。</li></ul><p></p> </li></ol> 
<p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p1160151292144"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b3730474492144">更换磁盘。</strong></p> 
<ol id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ol5110722692159"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li6235920691458"><a name="zh-cn_topic_0085571118_li6235920691458"></a>在FusionInsight Manager界面，单击“告警管理”。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2436194691458">查看该告警的详细信息，查看定位信息中对应的“HostName”字段和“DiskName”字段的值，获取该告警上报的故障磁盘信息。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li1793092591458">参考产品文档《故障管理》的“应急处理 &gt; 常见紧急故障修复 &gt; 硬盘故障处理”章节进行更换硬盘操作。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li2716060091458">检查告警是否清除。 <p></p> 
  <ul id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ul4311881291458"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li5252499591458">是，操作结束。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li296290891458">否，执行<a href="#ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li4518231891458" rel="nofollow">步骤 22</a>。</li></ul><p></p> </li></ol> 
<p id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_p98841749221"><strong id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_b218487059221">收集故障信息。</strong></p> 
<ol id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_ol24355139224"><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li4518231891458"><a name="zh-cn_topic_0085571118_li4518231891458"></a>在FusionInsight Manager界面，单击“系统设置 &gt; 日志下载”。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li398767891458">在“服务”下拉框中勾选“Manager”，单击“确定”。</li><li id="ZH-CN_TOPIC_0123926477__zh-cn_topic_0085571118_li3588910391458">设置日志收集的“开始时间”和“结束时间”分别为告警产生时间的前后10分钟，单击“下载”。</li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6c0391b28fc9bbea388e553de2522212/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Matlab实现：图像边缘提取</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/464fea3bcb3e03ea8b6b6bcc046b673c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">移动云获取推拉流地址</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>