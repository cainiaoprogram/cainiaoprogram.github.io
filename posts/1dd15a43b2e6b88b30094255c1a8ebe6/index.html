<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>安卓多用户管理之IUserManager.AIDL - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="安卓多用户管理之IUserManager.AIDL" />
<meta property="og:description" content="目录 前言一、API接口功能简介1.1 创建用户1.1.1 创建一个新的用户1.1.2 预创建一个新的用户，但不立即激活 1.2 创建用户配置文件1.2.1 创建一个配置文件1.2.2 创建一个受限配置文件1.2.3 即使被禁止也为用户创建配置文件 1.3 指定、设置用户信息1.3.1 设置用户的名称1.3.2 设置用户的图标1.3.3 设置指定用户的用户账户名称1.3.4 设置指定用户的用户限制1.3.5 设置指定应用程序的限制1.3.6 启用指定用户1.3.7 将指定用户设置为管理员用户1.3.9 清除指定用户的凭证加密密钥1.3.10 移除指定用户1.3.11 即使被禁止，也移除指定用户1.3.12 添加用户限制监听器1.3.13 设置默认访客用户的限制1.3.14 标记访客用户以便删除1.3.15 请求启用/禁用静默模式 1.4 获取用户信息1.4.1 获取用户的图标1.4.2 获取主用户的信息1.4.3 获取用户列表1.4.4 获取用户的配置文件列表1.4.5 获取用户的配置文件 ID 列表1.4.6 获取用户的配置文件的父用户信息1.4.7 获取用户的创建时间1.4.8 获取指定用户的信息1.4.9 获取指定用户的序列号1.4.10 获取指定应用程序的限制1.4.11 获取指定用户的指定应用程序的限制1.4.12 根据用户序列号获取用户 ID1.4.13 获取指定用户的用户账户名称1.4.14 获取指定用户受限制的限制源1.4.15 获取指定用户受限制的限制源列表1.4.16 获取指定用户的限制1.4.17 获取当前用户的用户名1.4.18 获取默认访客用户的限制1.4.19 获取用户启动的实时时间1.4.20 获取用户解锁的实时时间 1.5 检查用户相关信息1.5.1 检查是否可以向指定用户添加更多配置文件1.5.2 检查是否可以向指定用户添加更多受管理的配置文件1.5.3 检查两个用户是否属于同一个配置文件组1.5.4 检查指定用户是否具有基本用户限制1.5.5 检查指定用户是否属于指定的用户类型1.5.6 检查指定用户是否具有用户限制1.5.7 检查任何用户是否具有指定的用户限制1.5.8 检查当前用户是否受到限制1.5.9 检查指定用户对于指定设置是否受限制1.5.10 查指定用户是否可以拥有受限制的配置文件1.5.11 检查指定用户是否为演示用户1.5.12 检查指定用户是否为托管配置文件用户1.5.13 检查指定用户是否为预创建用户1.5.14 检查指定用户是否启用了安静模式1.5.15 检查指定用户是否正在解锁或已解锁1.5.16 检查指定用户是否为配置文件用户1.5.17 检查指定用户是否已解锁1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1dd15a43b2e6b88b30094255c1a8ebe6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T13:05:48+08:00" />
<meta property="article:modified_time" content="2024-01-05T13:05:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">安卓多用户管理之IUserManager.AIDL</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_4" rel="nofollow">前言</a></li><li><a href="#API_9" rel="nofollow">一、API接口功能简介</a></li><li><ul><li><a href="#11__10" rel="nofollow">1.1 创建用户</a></li><li><ul><li><a href="#111__11" rel="nofollow">1.1.1 创建一个新的用户</a></li><li><a href="#112__19" rel="nofollow">1.1.2 预创建一个新的用户，但不立即激活</a></li></ul> 
   </li><li><a href="#12__25" rel="nofollow">1.2 创建用户配置文件</a></li><li><ul><li><a href="#121__26" rel="nofollow">1.2.1 创建一个配置文件</a></li><li><a href="#122__38" rel="nofollow">1.2.2 创建一个受限配置文件</a></li><li><a href="#123__46" rel="nofollow">1.2.3 即使被禁止也为用户创建配置文件</a></li></ul> 
   </li><li><a href="#13__58" rel="nofollow">1.3 指定、设置用户信息</a></li><li><ul><li><a href="#131__60" rel="nofollow">1.3.1 设置用户的名称</a></li><li><a href="#132__67" rel="nofollow">1.3.2 设置用户的图标</a></li><li><a href="#133__74" rel="nofollow">1.3.3 设置指定用户的用户账户名称</a></li><li><a href="#134__81" rel="nofollow">1.3.4 设置指定用户的用户限制</a></li><li><a href="#135__90" rel="nofollow">1.3.5 设置指定应用程序的限制</a></li><li><a href="#136__98" rel="nofollow">1.3.6 启用指定用户</a></li><li><a href="#137__103" rel="nofollow">1.3.7 将指定用户设置为管理员用户</a></li><li><a href="#139__109" rel="nofollow">1.3.9 清除指定用户的凭证加密密钥</a></li><li><a href="#1310__114" rel="nofollow">1.3.10 移除指定用户</a></li><li><a href="#1311__120" rel="nofollow">1.3.11 即使被禁止，也移除指定用户</a></li><li><a href="#1312__126" rel="nofollow">1.3.12 添加用户限制监听器</a></li><li><a href="#1313__133" rel="nofollow">1.3.13 设置默认访客用户的限制</a></li><li><a href="#1314__141" rel="nofollow">1.3.14 标记访客用户以便删除</a></li><li><a href="#1315__146" rel="nofollow">1.3.15 请求启用/禁用静默模式</a></li></ul> 
   </li><li><a href="#14__157" rel="nofollow">1.4 获取用户信息</a></li><li><ul><li><a href="#141__158" rel="nofollow">1.4.1 获取用户的图标</a></li><li><a href="#142__168" rel="nofollow">1.4.2 获取主用户的信息</a></li><li><a href="#143__173" rel="nofollow">1.4.3 获取用户列表</a></li><li><a href="#144__182" rel="nofollow">1.4.4 获取用户的配置文件列表</a></li><li><a href="#145__ID__190" rel="nofollow">1.4.5 获取用户的配置文件 ID 列表</a></li><li><a href="#146__200" rel="nofollow">1.4.6 获取用户的配置文件的父用户信息</a></li><li><a href="#147__207" rel="nofollow">1.4.7 获取用户的创建时间</a></li><li><a href="#148__214" rel="nofollow">1.4.8 获取指定用户的信息</a></li><li><a href="#149__221" rel="nofollow">1.4.9 获取指定用户的序列号</a></li><li><a href="#1410__227" rel="nofollow">1.4.10 获取指定应用程序的限制</a></li><li><a href="#1411__235" rel="nofollow">1.4.11 获取指定用户的指定应用程序的限制</a></li><li><a href="#1412__ID_245" rel="nofollow">1.4.12 根据用户序列号获取用户 ID</a></li><li><a href="#1413__253" rel="nofollow">1.4.13 获取指定用户的用户账户名称</a></li><li><a href="#1414__259" rel="nofollow">1.4.14 获取指定用户受限制的限制源</a></li><li><a href="#1415__266" rel="nofollow">1.4.15 获取指定用户受限制的限制源列表</a></li><li><a href="#1416__273" rel="nofollow">1.4.16 获取指定用户的限制</a></li><li><a href="#1417__279" rel="nofollow">1.4.17 获取当前用户的用户名</a></li><li><a href="#1418__283" rel="nofollow">1.4.18 获取默认访客用户的限制</a></li><li><a href="#1419__289" rel="nofollow">1.4.19 获取用户启动的实时时间</a></li><li><a href="#1420__293" rel="nofollow">1.4.20 获取用户解锁的实时时间</a></li></ul> 
   </li><li><a href="#15__302" rel="nofollow">1.5 检查用户相关信息</a></li><li><ul><li><a href="#151__303" rel="nofollow">1.5.1 检查是否可以向指定用户添加更多配置文件</a></li><li><a href="#152__311" rel="nofollow">1.5.2 检查是否可以向指定用户添加更多受管理的配置文件</a></li><li><a href="#153__318" rel="nofollow">1.5.3 检查两个用户是否属于同一个配置文件组</a></li><li><a href="#154__325" rel="nofollow">1.5.4 检查指定用户是否具有基本用户限制</a></li><li><a href="#155__332" rel="nofollow">1.5.5 检查指定用户是否属于指定的用户类型</a></li><li><a href="#156__339" rel="nofollow">1.5.6 检查指定用户是否具有用户限制</a></li><li><a href="#157__346" rel="nofollow">1.5.7 检查任何用户是否具有指定的用户限制</a></li><li><a href="#158__352" rel="nofollow">1.5.8 检查当前用户是否受到限制</a></li><li><a href="#159__358" rel="nofollow">1.5.9 检查指定用户对于指定设置是否受限制</a></li><li><a href="#1510__368" rel="nofollow">1.5.10 查指定用户是否可以拥有受限制的配置文件</a></li><li><a href="#1511__375" rel="nofollow">1.5.11 检查指定用户是否为演示用户</a></li><li><a href="#1512__381" rel="nofollow">1.5.12 检查指定用户是否为托管配置文件用户</a></li><li><a href="#1513__387" rel="nofollow">1.5.13 检查指定用户是否为预创建用户</a></li><li><a href="#1514__393" rel="nofollow">1.5.14 检查指定用户是否启用了安静模式</a></li><li><a href="#1515__398" rel="nofollow">1.5.15 检查指定用户是否正在解锁或已解锁</a></li><li><a href="#1516__403" rel="nofollow">1.5.16 检查指定用户是否为配置文件用户</a></li><li><a href="#1517__409" rel="nofollow">1.5.17 检查指定用户是否已解锁</a></li><li><a href="#1517__416" rel="nofollow">1.5.17 查找当前的访客用户信息</a></li><li><a href="#1518__421" rel="nofollow">1.5.18 检查指定用户是否正在运行</a></li><li><a href="#1519__426" rel="nofollow">1.5.19 检查指定用户是否已设置用户名</a></li><li><a href="#1520__432" rel="nofollow">1.5.20 检查是否存在受限制的配置文件</a></li></ul> 
   </li><li><a href="#16__436" rel="nofollow">1.6 种子账户相关</a></li><li><ul><li><a href="#161__437" rel="nofollow">1.6.1 设置种子账户数据</a></li><li><a href="#162__447" rel="nofollow">1.6.2 获取种子账户的账户名称</a></li><li><a href="#163__451" rel="nofollow">1.6.3 获取种子账户的账户类型</a></li><li><a href="#164__457" rel="nofollow">1.6.4 获取种子账户的账户选项</a></li><li><a href="#165__462" rel="nofollow">1.6.5 清除种子账户数据</a></li><li><a href="#166__466" rel="nofollow">1.6.6 检查是否有用户拥有指定的种子账户</a></li></ul> 
   </li><li><a href="#17__474" rel="nofollow">1.7 用户徽章资源相关</a></li><li><ul><li><a href="#171__ID_476" rel="nofollow">1.7.1 获取用户图标徽章资源 ID</a></li><li><a href="#172__ID_482" rel="nofollow">1.7.2 获取用户徽章资源 ID</a></li><li><a href="#173__ID_487" rel="nofollow">1.7.3 获取用户无背景的徽章资源 ID</a></li><li><a href="#174__ID_493" rel="nofollow">1.7.4 获取用户徽章标签资源 ID</a></li><li><a href="#175__ID_499" rel="nofollow">1.7.5 获取用户徽章颜色资源 ID</a></li><li><a href="#176__ID_506" rel="nofollow">1.7.6 获取用户徽章深色颜色资源 ID</a></li><li><a href="#177__512" rel="nofollow">1.7.7 检查指定用户是否有徽章</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_518" rel="nofollow">二、配置文件、种子账户、用户徽章简介</a></li><li><ul><li><a href="#21__520" rel="nofollow">2.1 配置文件</a></li><li><a href="#22__530" rel="nofollow">2.2 种子账户</a></li><li><a href="#23__536" rel="nofollow">2.3 用户徽章</a></li></ul> 
  </li><li><a href="#_539" rel="nofollow">三、总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_4"></a>前言</h2> 
<p><code>IUserManager.AIDL</code>是一个接口，内部定义了很多用户管理的API，它的真正实现类是<code>UserManagerService</code>，在了解<code>UserManagerService</code>之前，先总览一下<code>IUserManager.AIDL</code>定义了哪些API，对其进行一个大概分类及简介。<br> 版本信息：Android11</p> 
<hr> 
<h2><a id="API_9"></a>一、API接口功能简介</h2> 
<h3><a id="11__10"></a>1.1 创建用户</h3> 
<h4><a id="111__11"></a>1.1.1 创建一个新的用户</h4> 
<blockquote> 
 <p>UserInfo createUserWithThrow(in String name, in String userType, int flags);<br> 作用：通过此方法创建一个新的用户。<br> 参数：<br> name：新用户的名称。<br> userType：用户类型。<br> flags：标志位，用于指定创建用户时的一些特性。<br> 返回值：返回一个 UserInfo 对象，包含了新创建用户的信息。</p> 
</blockquote> 
<h4><a id="112__19"></a>1.1.2 预创建一个新的用户，但不立即激活</h4> 
<blockquote> 
 <p>UserInfo preCreateUserWithThrow(in String userType);<br> 作用：预创建一个新的用户，但不立即激活。<br> 参数：<br> userType：用户类型。<br> 返回值：返回一个 UserInfo 对象，包含了新创建用户的信息。</p> 
</blockquote> 
<h3><a id="12__25"></a>1.2 创建用户配置文件</h3> 
<h4><a id="121__26"></a>1.2.1 创建一个配置文件</h4> 
<blockquote> 
 <p>UserInfo createProfileForUserWithThrow(in String name, in String userType, int flags, int userId, in String[] disallowedPackages);<br> 作用：为指定的用户创建一个配置文件。<br> 参数：<br> name：配置文件的名称。<br> userType：用户类型。<br> flags：标志位，用于指定创建配置文件时的一些特性。<br> userId：指定的用户 ID。<br> disallowedPackages：不允许在配置文件中安装的应用程序包名数组。<br> 返回值：返回一个 UserInfo 对象，包含了新创建配置文件的信息。</p> 
</blockquote> 
<h4><a id="122__38"></a>1.2.2 创建一个受限配置文件</h4> 
<blockquote> 
 <p>UserInfo createRestrictedProfileWithThrow(String name, int parentUserHandle);<br> 作用：为指定的用户创建一个受限配置文件。<br> 参数：<br> name：受限配置文件的名称。<br> parentUserHandle：父用户的用户句柄。<br> 返回值：返回一个 UserInfo 对象，包含了新创建受限配置文件的信息。</p> 
</blockquote> 
<h4><a id="123__46"></a>1.2.3 即使被禁止也为用户创建配置文件</h4> 
<blockquote> 
 <p>UserInfo createProfileForUserEvenWhenDisallowedWithThrow(String name, String userType, int flags, int userId, String[] disallowedPackages);<br> 作用：即使被禁止也为用户创建配置文件。<br> 参数：<br> name - 配置文件名称。<br> userType - 用户类型。<br> flags - 标志位。<br> userId - 用户 ID。<br> disallowedPackages - 被禁止的包名数组。<br> 返回值：返回一个 UserInfo 对象，包含了新创建的配置文件用户的信息。</p> 
</blockquote> 
<h3><a id="13__58"></a>1.3 指定、设置用户信息</h3> 
<h4><a id="131__60"></a>1.3.1 设置用户的名称</h4> 
<blockquote> 
 <p>void setUserName(int userId, String name);<br> 作用：设置指定用户的名称。<br> 参数：<br> userId：指定用户的用户 ID。<br> name：用户的新名称。</p> 
</blockquote> 
<h4><a id="132__67"></a>1.3.2 设置用户的图标</h4> 
<blockquote> 
 <p>void setUserIcon(int userId, in Bitmap icon);<br> 作用：设置指定用户的图标。<br> 参数：<br> userId：指定用户的用户 ID。<br> icon：用户的新图标。</p> 
</blockquote> 
<h4><a id="133__74"></a>1.3.3 设置指定用户的用户账户名称</h4> 
<blockquote> 
 <p>void setUserAccount(int userId, String accountName);<br> 作用：设置指定用户的用户账户名称。<br> 参数：<br> userId：指定用户的用户 ID。<br> accountName：要设置的用户账户名称。<br> 返回值：无。</p> 
</blockquote> 
<h4><a id="134__81"></a>1.3.4 设置指定用户的用户限制</h4> 
<blockquote> 
 <p>void setUserRestriction(String key, boolean value, int userId);<br> 作用：设置指定用户的用户限制。<br> 参数：<br> key：限制键值。<br> value：限制的值。<br> userId：指定用户的用户 ID。<br> 返回值：无。</p> 
</blockquote> 
<h4><a id="135__90"></a>1.3.5 设置指定应用程序的限制</h4> 
<blockquote> 
 <p>void setApplicationRestrictions(String packageName, Bundle restrictions, int userId);<br> 作用：设置指定应用程序的限制。<br> 参数：<br> packageName：应用程序包名。<br> restrictions：限制的 Bundle 对象。<br> userId：指定用户的用户 ID。<br> 返回值：无。</p> 
</blockquote> 
<h4><a id="136__98"></a>1.3.6 启用指定用户</h4> 
<blockquote> 
 <p>void setUserEnabled(int userId);<br> 作用：启用指定用户。<br> 参数：<br> userId：指定用户的用户 ID。</p> 
</blockquote> 
<h4><a id="137__103"></a>1.3.7 将指定用户设置为管理员用户</h4> 
<blockquote> 
 <p>void setUserAdmin(int userId);<br> 作用：将指定用户设置为管理员用户。<br> 参数：<br> userId：指定用户的用户 ID。</p> 
</blockquote> 
<h4><a id="139__109"></a>1.3.9 清除指定用户的凭证加密密钥</h4> 
<blockquote> 
 <p>void evictCredentialEncryptionKey(int userId);<br> 作用：清除指定用户的凭证加密密钥。<br> 参数：<br> userId：指定用户的用户 ID。</p> 
</blockquote> 
<h4><a id="1310__114"></a>1.3.10 移除指定用户</h4> 
<blockquote> 
 <p>boolean removeUser(int userId);<br> 作用：移除指定用户。<br> 参数：<br> userId：指定用户的用户 ID。<br> 返回值：如果成功移除用户，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1311__120"></a>1.3.11 即使被禁止，也移除指定用户</h4> 
<blockquote> 
 <p>boolean removeUserEvenWhenDisallowed(int userId);<br> 作用：即使被禁止，也移除指定用户。<br> 参数：<br> userId：指定用户的用户 ID。<br> 返回值：如果成功移除用户，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1312__126"></a>1.3.12 添加用户限制监听器</h4> 
<blockquote> 
 <p>void addUserRestrictionsListener(IUserRestrictionsListener listener);<br> 作用：添加用户限制监听器。<br> 参数：<br> listener：用户限制监听器对象。<br> 返回值：无。</p> 
</blockquote> 
<h4><a id="1313__133"></a>1.3.13 设置默认访客用户的限制</h4> 
<blockquote> 
 <p>void setDefaultGuestRestrictions(Bundle restrictions);<br> 作用：设置默认访客用户的限制。<br> 参数：<br> restrictions：默认访客用户的限制 Bundle 对象。<br> 返回值：无。</p> 
</blockquote> 
<h4><a id="1314__141"></a>1.3.14 标记访客用户以便删除</h4> 
<blockquote> 
 <p>boolean markGuestForDeletion(int userId);<br> 作用：标记访客用户以便删除。<br> 参数：userId - 用户 ID。<br> 返回值：如果成功标记访客用户以便删除，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1315__146"></a>1.3.15 请求启用/禁用静默模式</h4> 
<blockquote> 
 <p>boolean requestQuietModeEnabled(String callingPackage, boolean enableQuietMode, int userId, IntentSender target, int flags);<br> 作用：请求启用/禁用静默模式。<br> 参数：<br> callingPackage - 调用方包名。<br> enableQuietMode - 是否启用静默模式。<br> userId - 用户 ID。<br> target - 目标 IntentSender。<br> flags - 标志位。<br> 返回值：返回一个布尔值，表示请求是否成功。</p> 
</blockquote> 
<h3><a id="14__157"></a>1.4 获取用户信息</h3> 
<h4><a id="141__158"></a>1.4.1 获取用户的图标</h4> 
<blockquote> 
 <p>ParcelFileDescriptor getUserIcon(int userId);<br> 作用：获取指定用户的图标。<br> 参数：<br> userId：指定用户的用户 ID。<br> 返回值：返回一个 ParcelFileDescriptor 对象，包含了用户的图标信息。</p> 
</blockquote> 
<h4><a id="142__168"></a>1.4.2 获取主用户的信息</h4> 
<blockquote> 
 <p>UserInfo getPrimaryUser();<br> 作用：获取主用户的信息。<br> 返回值：返回一个 UserInfo 对象，包含了主用户的信息。</p> 
</blockquote> 
<h4><a id="143__173"></a>1.4.3 获取用户列表</h4> 
<blockquote> 
 <p>List &lt; UserInfo&gt; getUsers(boolean excludePartial, boolean excludeDying, boolean excludePreCreated);<br> 作用：获取用户列表。<br> 参数：<br> excludePartial：是否排除部分用户。<br> excludeDying：是否排除即将被移除的用户。<br> excludePreCreated：是否排除预创建的用户。<br> 返回值：返回一个 UserInfo 对象列表，包含了符合条件的用户信息。</p> 
</blockquote> 
<h4><a id="144__182"></a>1.4.4 获取用户的配置文件列表</h4> 
<blockquote> 
 <p>List getProfiles(int userId, boolean enabledOnly);<br> 作用：获取指定用户的配置文件列表。<br> 参数：<br> userId：指定用户的用户 ID。<br> enabledOnly：是否只包含已启用的配置文件。<br> 返回值：返回一个 UserInfo 对象列表，包含了符合条件的配置文件信息。</p> 
</blockquote> 
<h4><a id="145__ID__190"></a>1.4.5 获取用户的配置文件 ID 列表</h4> 
<blockquote> 
 <p>int[] getProfileIds(int userId, boolean enabledOnly);<br> 作用：获取指定用户的配置文件 ID 列表。<br> 参数：<br> userId：指定用户的用户 ID。<br> enabledOnly：是否只包含已启用的配置文件。<br> 返回值：返回一个整型数组，包含了符合条件的配置文件 ID。</p> 
</blockquote> 
<h4><a id="146__200"></a>1.4.6 获取用户的配置文件的父用户信息</h4> 
<blockquote> 
 <p>UserInfo getProfileParent(int userId);<br> 作用：获取指定用户的配置文件的父用户信息。<br> 参数：<br> userId：指定用户的用户 ID。<br> 返回值：返回一个 UserInfo 对象，包含了配置文件的父用户信息。</p> 
</blockquote> 
<h4><a id="147__207"></a>1.4.7 获取用户的创建时间</h4> 
<blockquote> 
 <p>long getUserCreationTime(int userId);<br> 作用：获取指定用户的创建时间。<br> 参数：<br> userId：指定用户的用户 ID。<br> 返回值：返回指定用户的创建时间，以毫秒为单位的时间戳。</p> 
</blockquote> 
<h4><a id="148__214"></a>1.4.8 获取指定用户的信息</h4> 
<blockquote> 
 <p>UserInfo getUserInfo(int userId);<br> 作用：获取指定用户的信息。<br> 参数：<br> userId：指定用户的用户 ID。<br> 返回值：返回一个 UserInfo 对象，包含了指定用户的信息。</p> 
</blockquote> 
<h4><a id="149__221"></a>1.4.9 获取指定用户的序列号</h4> 
<blockquote> 
 <p>int getUserSerialNumber(int userId);<br> 作用：获取指定用户的序列号。<br> 参数：<br> userId：指定用户的用户 ID。<br> 返回值：返回指定用户的序列号。</p> 
</blockquote> 
<h4><a id="1410__227"></a>1.4.10 获取指定应用程序的限制</h4> 
<blockquote> 
 <p>Bundle getApplicationRestrictions(String packageName);<br> 作用：获取指定应用程序的限制。<br> 参数：<br> packageName：应用程序包名。<br> 返回值：返回一个 Bundle 对象，包含了指定应用程序的限制。</p> 
</blockquote> 
<h4><a id="1411__235"></a>1.4.11 获取指定用户的指定应用程序的限制</h4> 
<blockquote> 
 <p>Bundle getApplicationRestrictionsForUser(String packageName, int userId);<br> 作用：获取指定用户的指定应用程序的限制。<br> 参数：<br> packageName：应用程序包名。<br> userId：指定用户的用户 ID。<br> 返回值：返回一个 Bundle 对象，包含了指定用户的指定应用程序的限制。</p> 
</blockquote> 
<h4><a id="1412__ID_245"></a>1.4.12 根据用户序列号获取用户 ID</h4> 
<blockquote> 
 <p>int getUserHandle(int userSerialNumber);<br> 作用：根据用户序列号获取用户 ID。<br> 参数：<br> userSerialNumber：用户的序列号。<br> 返回值：返回指定用户序列号对应的用户 ID。</p> 
</blockquote> 
<h4><a id="1413__253"></a>1.4.13 获取指定用户的用户账户名称</h4> 
<blockquote> 
 <p>String getUserAccount(int userId);<br> 作用：获取指定用户的用户账户名称。<br> 参数：<br> userId：指定用户的用户 ID。<br> 返回值：返回指定用户的用户账户名称。</p> 
</blockquote> 
<h4><a id="1414__259"></a>1.4.14 获取指定用户受限制的限制源</h4> 
<blockquote> 
 <p>int getUserRestrictionSource(String restrictionKey, int userId);<br> 作用：获取指定用户受限制的限制源。<br> 参数：<br> restrictionKey：限制键值。<br> userId：指定用户的用户 ID。<br> 返回值：返回指定用户受限制的限制源。</p> 
</blockquote> 
<h4><a id="1415__266"></a>1.4.15 获取指定用户受限制的限制源列表</h4> 
<blockquote> 
 <p>List&lt;UserManager.EnforcingUser&gt; getUserRestrictionSources(String restrictionKey, int userId);<br> 作用：获取指定用户受限制的限制源列表。<br> 参数：<br> restrictionKey：限制键值。<br> userId：指定用户的用户 ID。<br> 返回值：返回一个 UserManager.EnforcingUser 对象列表，包含了指定用户受限制的限制源列表。</p> 
</blockquote> 
<h4><a id="1416__273"></a>1.4.16 获取指定用户的限制</h4> 
<blockquote> 
 <p>Bundle getUserRestrictions(int userId);<br> 作用：获取指定用户的限制。<br> 参数：<br> userId：指定用户的用户 ID。<br> 返回值：返回一个 Bundle 对象，包含了指定用户的限制。</p> 
</blockquote> 
<h4><a id="1417__279"></a>1.4.17 获取当前用户的用户名</h4> 
<blockquote> 
 <p>String getUserName();<br> 作用：获取当前用户的用户名。<br> 返回值：返回当前用户的用户名。</p> 
</blockquote> 
<h4><a id="1418__283"></a>1.4.18 获取默认访客用户的限制</h4> 
<blockquote> 
 <p>Bundle getDefaultGuestRestrictions();<br> 作用：获取默认访客用户的限制。<br> 参数：无。<br> 返回值：返回一个 Bundle 对象，包含了默认访客用户的限制。</p> 
</blockquote> 
<h4><a id="1419__289"></a>1.4.19 获取用户启动的实时时间</h4> 
<blockquote> 
 <p>long getUserStartRealtime();<br> 作用：获取用户启动的实时时间。<br> 返回值：返回用户启动的实时时间。</p> 
</blockquote> 
<h4><a id="1420__293"></a>1.4.20 获取用户解锁的实时时间</h4> 
<blockquote> 
 <p>long getUserUnlockRealtime();<br> 作用：获取用户解锁的实时时间。<br> 返回值：返回用户解锁的实时时间。</p> 
</blockquote> 
<h3><a id="15__302"></a>1.5 检查用户相关信息</h3> 
<h4><a id="151__303"></a>1.5.1 检查是否可以向指定用户添加更多配置文件</h4> 
<blockquote> 
 <p>boolean canAddMoreProfilesToUser(in String userType, int userId, boolean allowedToRemoveOne);<br> 作用：检查是否可以向指定用户添加更多配置文件。<br> 参数：<br> userType：用户类型。<br> userId：指定用户的用户 ID。<br> allowedToRemoveOne：是否允许移除一个配置文件以添加更多。<br> 返回值：如果可以向指定用户添加更多配置文件，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="152__311"></a>1.5.2 检查是否可以向指定用户添加更多受管理的配置文件</h4> 
<blockquote> 
 <p>boolean canAddMoreManagedProfiles(int userId, boolean allowedToRemoveOne);<br> 作用：检查是否可以向指定用户添加更多受管理的配置文件。<br> 参数：<br> userId：指定用户的用户 ID。<br> allowedToRemoveOne：是否允许移除一个配置文件以添加更多。<br> 返回值：如果可以向指定用户添加更多受管理的配置文件，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="153__318"></a>1.5.3 检查两个用户是否属于同一个配置文件组</h4> 
<blockquote> 
 <p>boolean isSameProfileGroup(int userId, int otherUserHandle);<br> 作用：检查两个用户是否属于同一个配置文件组。<br> 参数：<br> userId：第一个用户的用户 ID。<br> otherUserHandle：第二个用户的用户 ID。<br> 返回值：如果两个用户属于同一个配置文件组，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="154__325"></a>1.5.4 检查指定用户是否具有基本用户限制</h4> 
<blockquote> 
 <p>boolean hasBaseUserRestriction(String restrictionKey, int userId);<br> 作用：检查指定用户是否具有基本用户限制。<br> 参数：<br> restrictionKey：限制键值。<br> userId：指定用户的用户 ID。<br> 返回值：如果指定用户具有指定的基本用户限制，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="155__332"></a>1.5.5 检查指定用户是否属于指定的用户类型</h4> 
<blockquote> 
 <p>boolean isUserOfType(int userId, in String userType);<br> 作用：检查指定用户是否属于指定的用户类型。<br> 参数：<br> userId：指定用户的用户 ID。<br> userType：用户类型。<br> 返回值：如果指定用户属于指定的用户类型，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="156__339"></a>1.5.6 检查指定用户是否具有用户限制</h4> 
<blockquote> 
 <p>boolean hasUserRestriction(String restrictionKey, int userId);<br> 作用：检查指定用户是否具有用户限制。<br> 参数：<br> restrictionKey：限制键值。<br> userId：指定用户的用户 ID。<br> 返回值：如果指定用户具有指定的用户限制，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="157__346"></a>1.5.7 检查任何用户是否具有指定的用户限制</h4> 
<blockquote> 
 <p>boolean hasUserRestrictionOnAnyUser(String restrictionKey);<br> 作用：检查任何用户是否具有指定的用户限制。<br> 参数：<br> restrictionKey：限制键值。<br> 返回值：如果任何用户具有指定的用户限制，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="158__352"></a>1.5.8 检查当前用户是否受到限制</h4> 
<blockquote> 
 <p>boolean isRestricted();<br> 作用：检查当前用户是否受到限制。<br> 参数：无。<br> 返回值：如果当前用户受到限制，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="159__358"></a>1.5.9 检查指定用户对于指定设置是否受限制</h4> 
<blockquote> 
 <p>boolean isSettingRestrictedForUser(String setting, int userId, String value, int callingUid);<br> 作用：检查指定用户对于指定设置是否受限制。<br> 参数：<br> setting：设置名称。<br> userId：指定用户的用户 ID。<br> value：设置的值。<br> callingUid：调用者的 UID。<br> 返回值：如果指定用户对于指定设置受到限制，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1510__368"></a>1.5.10 查指定用户是否可以拥有受限制的配置文件</h4> 
<blockquote> 
 <p>boolean canHaveRestrictedProfile(int userId);<br> 作用：检查指定用户是否可以拥有受限制的配置文件。<br> 参数：<br> userId：指定用户的用户 ID。<br> 返回值：如果指定用户可以拥有受限制的配置文件，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1511__375"></a>1.5.11 检查指定用户是否为演示用户</h4> 
<blockquote> 
 <p>boolean isDemoUser(int userId);<br> 作用：检查指定用户是否为演示用户。<br> 参数：userId - 用户 ID。<br> 返回值：如果指定用户是演示用户，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1512__381"></a>1.5.12 检查指定用户是否为托管配置文件用户</h4> 
<blockquote> 
 <p>boolean isManagedProfile(int userId);<br> 作用：检查指定用户是否为托管配置文件用户。<br> 参数：userId - 用户 ID。<br> 返回值：如果指定用户是托管配置文件用户，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1513__387"></a>1.5.13 检查指定用户是否为预创建用户</h4> 
<blockquote> 
 <p>boolean isPreCreated(int userId);<br> 作用：检查指定用户是否为预创建用户。<br> 参数：userId - 用户 ID。<br> 返回值：如果指定用户是预创建用户，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1514__393"></a>1.5.14 检查指定用户是否启用了安静模式</h4> 
<blockquote> 
 <p>boolean isQuietModeEnabled(int userId);<br> 作用：检查指定用户是否启用了安静模式。<br> 参数：userId - 用户 ID。<br> 返回值：如果指定用户启用了安静模式，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1515__398"></a>1.5.15 检查指定用户是否正在解锁或已解锁</h4> 
<blockquote> 
 <p>boolean isUserUnlockingOrUnlocked(int userId);<br> 作用：检查指定用户是否正在解锁或已解锁。<br> 参数：userId - 用户 ID。<br> 返回值：如果指定用户正在解锁或已解锁，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1516__403"></a>1.5.16 检查指定用户是否为配置文件用户</h4> 
<blockquote> 
 <p>boolean isProfile(int userId);<br> 作用：检查指定用户是否为配置文件用户。<br> 参数：userId - 用户 ID。<br> 返回值：如果指定用户是配置文件用户，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1517__409"></a>1.5.17 检查指定用户是否已解锁</h4> 
<blockquote> 
 <p>boolean isUserUnlocked(int userId);<br> 作用：检查指定用户是否已解锁。<br> 参数：userId - 用户 ID。<br> 返回值：如果指定用户已解锁，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1517__416"></a>1.5.17 查找当前的访客用户信息</h4> 
<blockquote> 
 <p>UserInfo findCurrentGuestUser();<br> 作用：查找当前的访客用户信息。<br> 返回值：返回一个 UserInfo 对象，包含当前访客用户的信息。</p> 
</blockquote> 
<h4><a id="1518__421"></a>1.5.18 检查指定用户是否正在运行</h4> 
<blockquote> 
 <p>boolean isUserRunning(int userId);<br> 作用：检查指定用户是否正在运行。<br> 参数：userId - 用户 ID。<br> 返回值：如果指定用户正在运行，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1519__426"></a>1.5.19 检查指定用户是否已设置用户名</h4> 
<blockquote> 
 <p>boolean isUserNameSet(int userId);<br> 作用：检查指定用户是否已设置用户名。<br> 参数：userId - 用户 ID。<br> 返回值：如果指定用户已设置用户名，则返回 true；否则返回 false。</p> 
</blockquote> 
<h4><a id="1520__432"></a>1.5.20 检查是否存在受限制的配置文件</h4> 
<blockquote> 
 <p>boolean hasRestrictedProfiles();<br> 作用：检查是否存在受限制的配置文件。<br> 返回值：如果存在受限制的配置文件，则返回 true；否则返回 false。</p> 
</blockquote> 
<h3><a id="16__436"></a>1.6 种子账户相关</h3> 
<h4><a id="161__437"></a>1.6.1 设置种子账户数据</h4> 
<blockquote> 
 <p>void setSeedAccountData(int userId, String accountName, String accountType, PersistableBundle accountOptions, boolean persist);<br> 作用：设置种子账户数据。<br> 参数：<br> userId - 用户 ID。<br> accountName - 账户名称。<br> accountType - 账户类型。<br> accountOptions - 账户选项的 PersistableBundle 对象。<br> persist - 是否持久化数据。<br> 返回值：无。</p> 
</blockquote> 
<h4><a id="162__447"></a>1.6.2 获取种子账户的账户名称</h4> 
<blockquote> 
 <p>String getSeedAccountName();<br> 作用：获取种子账户的账户名称。<br> 返回值：返回种子账户的账户名称。</p> 
</blockquote> 
<h4><a id="163__451"></a>1.6.3 获取种子账户的账户类型</h4> 
<blockquote> 
 <p>String getSeedAccountType();<br> 作用：获取种子账户的账户类型。<br> 返回值：返回种子账户的账户类型。</p> 
</blockquote> 
<h4><a id="164__457"></a>1.6.4 获取种子账户的账户选项</h4> 
<blockquote> 
 <p>PersistableBundle getSeedAccountOptions();<br> 作用：获取种子账户的账户选项。<br> 返回值：返回一个 PersistableBundle 对象，包含了种子账户的账户选项。</p> 
</blockquote> 
<h4><a id="165__462"></a>1.6.5 清除种子账户数据</h4> 
<blockquote> 
 <p>void clearSeedAccountData();<br> 作用：清除种子账户数据。<br> 返回值：无。</p> 
</blockquote> 
<h4><a id="166__466"></a>1.6.6 检查是否有用户拥有指定的种子账户</h4> 
<blockquote> 
 <p>boolean someUserHasSeedAccount(String accountName, String accountType);<br> 作用：检查是否有用户拥有指定的种子账户。<br> 参数：<br> accountName - 账户名称。<br> accountType - 账户类型。<br> 返回值：如果有用户拥有指定的种子账户，则返回 true；否则返回 false。</p> 
</blockquote> 
<h3><a id="17__474"></a>1.7 用户徽章资源相关</h3> 
<h4><a id="171__ID_476"></a>1.7.1 获取用户图标徽章资源 ID</h4> 
<blockquote> 
 <p>int getUserIconBadgeResId(int userId);<br> 作用：获取用户图标徽章资源 ID。<br> 参数：userId - 用户 ID。<br> 返回值：返回用户图标徽章资源的 ID。</p> 
</blockquote> 
<h4><a id="172__ID_482"></a>1.7.2 获取用户徽章资源 ID</h4> 
<blockquote> 
 <p>int getUserBadgeResId(int userId);<br> 作用：获取用户徽章资源 ID。<br> 参数：userId - 用户 ID。<br> 返回值：返回用户徽章资源的 ID。</p> 
</blockquote> 
<h4><a id="173__ID_487"></a>1.7.3 获取用户无背景的徽章资源 ID</h4> 
<blockquote> 
 <p>int getUserBadgeNoBackgroundResId(int userId);<br> 作用：获取用户无背景的徽章资源 ID。<br> 参数：userId - 用户 ID。<br> 返回值：返回用户无背景的徽章资源的 ID。</p> 
</blockquote> 
<h4><a id="174__ID_493"></a>1.7.4 获取用户徽章标签资源 ID</h4> 
<blockquote> 
 <p>int getUserBadgeLabelResId(int userId);<br> 作用：获取用户徽章标签资源 ID。<br> 参数：userId - 用户 ID。<br> 返回值：返回用户徽章标签资源的 ID。</p> 
</blockquote> 
<h4><a id="175__ID_499"></a>1.7.5 获取用户徽章颜色资源 ID</h4> 
<blockquote> 
 <p>int getUserBadgeColorResId(int userId);<br> 作用：获取用户徽章颜色资源 ID。<br> 参数：userId - 用户 ID。<br> 返回值：返回用户徽章颜色资源的 ID。</p> 
</blockquote> 
<h4><a id="176__ID_506"></a>1.7.6 获取用户徽章深色颜色资源 ID</h4> 
<blockquote> 
 <p>int getUserBadgeDarkColorResId(int userId);<br> 作用：获取用户徽章深色颜色资源 ID。<br> 参数：userId - 用户 ID。<br> 返回值：返回用户徽章深色颜色资源的 ID。</p> 
</blockquote> 
<h4><a id="177__512"></a>1.7.7 检查指定用户是否有徽章</h4> 
<blockquote> 
 <p>boolean hasBadge(int userId);<br> 作用：检查指定用户是否有徽章。<br> 参数：userId - 用户 ID。<br> 返回值：如果指定用户有徽章，则返回 true；否则返回 false。</p> 
</blockquote> 
<h2><a id="_518"></a>二、配置文件、种子账户、用户徽章简介</h2> 
<h3><a id="21__520"></a>2.1 配置文件</h3> 
<blockquote> 
 <p>在 Android 多用户环境中，每个用户都有自己的用户配置文件信息，这些信息包括用户的个人设置、应用程序数据、权限等。用户配置文件信息通常存储在设备的内部存储器中，每个用户的配置文件信息都是相互隔离的，以确保用户之间的数据不会相互干扰。<br> 用户配置文件信息通常包括以下内容：<br> <code>个人设置</code>：每个用户可以自定义设备的个人设置，例如壁纸、铃声、语言偏好等。这些设置信息存储在用户的配置文件中，并在用户登录时加载。<br> <code>应用程序数据</code>：每个用户安装的应用程序的数据和设置信息都存储在其个人的配置文件中。这包括应用程序的用户偏好、登陆信息、游戏进度等。<br> <code>权限</code>：Android 系统会根据用户的配置文件信息来管理应用程序的权限。不同用户的权限设置是相互独立的，这样可以确保用户之间的数据安全和隐私。<br> <code>存储空间</code>：每个用户的配置文件信息占用设备的存储空间，Android 系统会对每个用户的存储空间进行分配和管理，以确保用户之间的数据不会相互干扰。<br> <code>安全设置</code>：每个用户的安全设置信息，例如锁屏密码、指纹识别等，都存储在其个人的配置文件中。<br> Android 系统会根据用户登录时的身份加载相应的配置文件信息，以确保用户能够获得自己的个人设置和数据。这种多用户的配置文件信息的隔离设计，有助于保护用户的隐私和数据安全。</p> 
</blockquote> 
<h3><a id="22__530"></a>2.2 种子账户</h3> 
<blockquote> 
 <p>在 Android 系统中，种子账户是指系统预置的用户账户，通常用于设备的初始化设置或者系统自身的运行。这些种子账户通常不允许用户直接登录或进行操作，而是由系统进行管理和控制。种子账户通常包括以下几种类型：<br> <code>系统账户</code>：这是 Android 系统内置的账户，用于管理设备的核心功能和服务，例如系统更新、安全策略、应用商店等。<br> <code>默认用户账户</code>：在设备首次启动时创建的用户账户，通常作为设备的主要用户账户。默认用户账户具有较高的权限，可以对设备进行全面的管理和操作。<br> <code>Guest 账户</code>：这是一个临时的访客账户，用于临时借给其他人使用设备而不会影响到主要用户账户的数据和设置。<br> <code>Restricted Profile 账户</code>：这是一个受限制的配置文件，用于限制某些功能和内容的访问权限，通常用于设备共享或家庭使用，以保护隐私和安全。</p> 
</blockquote> 
<h3><a id="23__536"></a>2.3 用户徽章</h3> 
<blockquote> 
 <p>在 Android 多用户环境中，每个用户都可以有自己的用户徽章。用户徽章是一个图标，用于表示用户的身份或状态。在多用户环境下，用户徽章可以帮助用户快速识别当前处于哪个用户账户下，以及该用户账户的状态。用户徽章通常显示在设备的锁屏界面、通知栏、快速设置面板等位置</p> 
</blockquote> 
<h2><a id="_539"></a>三、总结</h2> 
<p><code>IUserManager.AIDL</code> 是 Android 系统中的一个特定接口，用于管理用户和用户相关的操作。它包含了一系列方法，可以用于创建、删除、查询用户信息，以及管理用户的权限和配置等操作。通过 IUserManager.AIDL 接口，应用程序可以与系统 <code>UserManager</code> 服务进行通信，实现对用户账户的管理和控制。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c9388781c31b2d05d6362c818be6c85f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">限制选中指定个数CheckBox控件（1/2）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/05406b6a28baf6caf1cee286bbf857a6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">雷军说好的百万美金大奖双倍发放：造车与造OS，都离不开AI了</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>