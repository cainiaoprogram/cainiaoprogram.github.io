<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于51单片机的积水监测系统设计 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于51单片机的积水监测系统设计" />
<meta property="og:description" content="1 适用场景 道路积水监测、城市街道等需要进行水量监控的场景。
小鱼儿电子设计微信号：IOTElectronics
2 硬件方案 51系列单片机（芯片型号为STC12C5A60S2单片机）、水位传感器*2、E18-D80NK漫反射式光电红外传感器、HC-SR04超声波传感器、ESP8266WiFi模块、蜂鸣器、按键模块、USB转TTL-CH340模块、OLED显示幕、USB充电线
3 系统实现功能 实时监测：实时监测积水的水位情况（低水位/中水位/高水位）、积水的高度（单位：dm）、井盖是否存在（0：不存在，1：存在），并将监测结果显示到OLED屏幕上。手动控制模式：手动控制按键结合OLED屏幕进行积水最佳阈值设定。自动控制模式：当积水水位为高水位或测量到的积水高度大于最佳阈值时，自动声光报警。云平台远程监测：通过WiFi将监测数据上传到OneNET云平台，在手机端、电脑端和网页端均可以查看积水的水位情况、积水高度、报警触发次数及井盖是否存在等。 4 设计思路 超声波测距计算策略：d=超声波传感器安装高度-超声波传感器安装高度到积水的距离 高、中、低水位计算策略：将水位传感器1放在3dm处，水位传感器2放在6dm处，如果未淹没水位传感器1为低水位，如果淹没水位传感器1，未淹没水位传感器2为高水位，同时淹没两个水位传感器为高水位。 5 实物展示 5.1 云平台展示 5.2 下位机展示 6 云平台源码 用户需要自行完成一下2个函数的实现 1、定时下发数据任务初始化函数：device_timer_init(dev)【可选】 2、对设备上传数据进行解析（包括心跳等）：device_data_analyze(dev) ----------------------------------------------------------------------------------------- function device_timer_init(dev) dev:timeout(5) dev:add(10,&#34;dev1&#34;,&#34;syn\r\n&#34;) end ----------------------------------------------------------------------------------------- function device_data_analyze(dev)	local t = {} --数组定义	local a = 0 --数声明	local s = dev:size() --获得数据总长度 dev_logon(dev)--注册返回 local length = dev:byte(3)--获取负载长度LEN（PAYLOAD长度） local cmd = dev:byte(4)--获取命令内容CMD（CMD命令） if dev:byte(1)==0x5A and dev:byte(2)==0x5A and dev:byte(5&#43;length)==0xA5 then if cmd==0x01 then --上报状态值status add_val(t,&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ec85f56d1f8d8220ecf308c801bddd6e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-18T17:26:57+08:00" />
<meta property="article:modified_time" content="2023-09-18T17:26:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于51单片机的积水监测系统设计</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="margin-left:.0001pt;text-align:left;">1  适用场景</h2> 
<hr> 
<p style="margin-left:.0001pt;text-align:left;">        道路积水监测、城市街道等需要进行水量监控的场景。</p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:left;">        小鱼儿电子设计微信号：IOTElectronics</p> 
</blockquote> 
<hr> 
<h2 style="text-align:left;">2  硬件方案</h2> 
<hr> 
<p style="margin-left:.0001pt;text-align:left;">        51系列单片机（芯片型号为STC12C5A60S2单片机）、水位传感器*2、E18-D80NK漫反射式光电红外传感器、HC-SR04超声波传感器、ESP8266WiFi模块、蜂鸣器、按键模块、USB转TTL-CH340模块、OLED显示幕、USB充电线</p> 
<hr> 
<h2 style="text-align:left;">3  系统实现功能</h2> 
<hr> 
<blockquote> 
 <ul><li style="margin-left:.0001pt;text-align:left;">实时监测：实时监测积水的水位情况（低水位/中水位/高水位）、积水的高度（单位：dm）、井盖是否存在（0：不存在，1：存在），并将监测结果显示到OLED屏幕上。</li><li style="margin-left:.0001pt;text-align:left;">手动控制模式：手动控制按键结合OLED屏幕进行积水最佳阈值设定。</li><li style="margin-left:.0001pt;text-align:left;">自动控制模式：当积水水位为高水位或测量到的积水高度大于最佳阈值时，自动声光报警。</li><li style="margin-left:.0001pt;text-align:left;">云平台远程监测：通过WiFi将监测数据上传到OneNET云平台，在手机端、电脑端和网页端均可以查看积水的水位情况、积水高度、报警触发次数及井盖是否存在等。</li></ul> 
</blockquote> 
<hr> 
<h2 style="text-align:left;">4  设计思路</h2> 
<hr> 
<blockquote> 
 <ul><li style="margin-left:.0001pt;text-align:left;">        超声波测距计算策略：d=超声波传感器安装高度-超声波传感器安装高度到积水的距离</li><li style="margin-left:.0001pt;text-align:left;">        高、中、低水位计算策略：将水位传感器1放在3dm处，水位传感器2放在6dm处，如果未淹没水位传感器1为低水位，如果淹没水位传感器1，未淹没水位传感器2为高水位，同时淹没两个水位传感器为高水位。<img alt="" height="552" src="https://images2.imgbox.com/e9/30/fENd40Mm_o.png" width="1179"></li></ul> 
</blockquote> 
<hr> 
<h2 style="margin-left:.0001pt;text-align:justify;">5  实物展示</h2> 
<hr> 
<h3>5.1  云平台展示</h3> 
<hr> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/a2/ac/m8q7cyIy_o.jpg" width="1080"></p> 
<hr> 
<h3>5.2  下位机展示 </h3> 
<hr> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/74/01/jIUz7kaa_o.jpg" width="1200"></p> 
<hr> 
<h2>6  云平台源码</h2> 
<hr> 
<p>用户需要自行完成一下2个函数的实现                                 <br> 1、定时下发数据任务初始化函数：device_timer_init(dev)【可选】     <br> 2、对设备上传数据进行解析（包括心跳等）：device_data_analyze(dev) </p> 
<pre><code class="language-java">-----------------------------------------------------------------------------------------
function device_timer_init(dev)
	dev:timeout(5)
	dev:add(10,"dev1","syn\r\n")
end
-----------------------------------------------------------------------------------------
function device_data_analyze(dev)	
	local t = {}     --数组定义	
	local a = 0      --数声明	
	local s = dev:size() --获得数据总长度   
	dev_logon(dev)--注册返回
	local length = dev:byte(3)--获取负载长度LEN（PAYLOAD长度）
	local cmd    = dev:byte(4)--获取命令内容CMD（CMD命令）
	if dev:byte(1)==0x5A and dev:byte(2)==0x5A and dev:byte(5+length)==0xA5   then     
	  if cmd==0x01 then             --上报状态值status
		  add_val(t,"distance",0,dev:bytes(5,1))
		  add_val(t,"higt_std",0,dev:bytes(6,1))
		  add_val(t,"water",0,dev:bytes(7,1))
		  add_val(t,"beep",0,dev:bytes(8,1))
		  add_val(t,"lid",0,dev:bytes(9,1))	  
		  dev:send("get status\r\n")  
	  end 
	end
--------------------------------------------------------------------	</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/54209cd5d3ca5f30dbd2c896c1608989/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数据结构学习笔记—— 基数排序</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1633ec51af38eaf418fd2d9c04f7ea5e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">GPU对应的cuda以及cuDNN驱动安装</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>