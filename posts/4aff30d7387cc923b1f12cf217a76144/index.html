<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>GROMACS使用小计 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="GROMACS使用小计" />
<meta property="og:description" content="参考网站：（1）国内网址， github网址, tutorial
目录
MDP文件书写
GROMACS简单处理命令
MDP文件书写 1. 各个参数
title = Protein-ligand complex MD simulation ; Run parameters #（常用） integrator = md ; #指定积分算法；md:蛙跳牛顿积分算法，用于平衡动力学积分 nsteps = 500000 ; #积分或能量最小化步数，*dt= 1ns总模拟时长 （常用） dt = 0.002 ; #积分步长，一般为 0.002ps ~0.004ps ; Output control #（常用） nstxout = 0 ; #坐标保存到轨迹文件的频率 .trr nstvout = 0 ; #速度保存到轨迹文件的频率 v, 开启会增加运行时间 nstenergy = 5000 ; #能量保存到轨迹文件的频率，必须是nstcalcenergy的倍数 nstlog = 5000 ; # log文件更新频率 nstxout-compressed = 5000 ; # compressed-x-grps = System energygrps = Protein JZ4 #保存能量的组 ; Bond parameters continuation = yes ; #初试构象不约束，不复位，用于精确的继续计算或重计算 constraint_algorithm = lincs ; #约束算法 lincs ：不能用于角度约束 constraints = all-bonds ; #键约束，all-bonds:所有键约束，#(键的约束，不常用） lincs_iter = 1 ; #迭代次数，用于LINCS约束精度，默认1 lincs_order = 4 ; #约束偶合矩阵阶次，用于LINCS约束精度，默认4 ; Neighborsearching cutoff-scheme = Verlet ns_type = grid ; #邻近列表搜索方法 nstlist = 10 ; #邻近列表更新频率 rcoulomb = 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4aff30d7387cc923b1f12cf217a76144/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-04T18:19:41+08:00" />
<meta property="article:modified_time" content="2020-08-04T18:19:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">GROMACS使用小计</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>参考网站：（1）<a href="http://t066v5.coding-pages.com" rel="nofollow">国内网址</a>，  <a href="http://jerkwin.github.io/" rel="nofollow">github网址</a>, <a href="http://www.mdtutorials.com/gmx/" rel="nofollow">tutorial</a></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:40px;"> </p> 
<p id="MDP%E6%96%87%E4%BB%B6%E4%B9%A6%E5%86%99-toc" style="margin-left:40px;"><a href="#MDP%E6%96%87%E4%BB%B6%E4%B9%A6%E5%86%99" rel="nofollow">MDP文件书写</a></p> 
<p id="%C2%A0GROMACS%E7%AE%80%E5%8D%95%E5%A4%84%E7%90%86%E5%91%BD%E4%BB%A4-toc" style="margin-left:40px;"><a href="#%C2%A0GROMACS%E7%AE%80%E5%8D%95%E5%A4%84%E7%90%86%E5%91%BD%E4%BB%A4" rel="nofollow"> GROMACS简单处理命令</a></p> 
<hr id="hr-toc"> 
<h3 id="MDP%E6%96%87%E4%BB%B6%E4%B9%A6%E5%86%99" style="margin-left:0pt;">MDP文件书写</h3> 
<p><strong>1. 各个参数</strong></p> 
<pre><code>title = Protein-ligand complex MD simulation 
; Run parameters #（常用）
integrator = md ; #指定积分算法；md:蛙跳牛顿积分算法，用于平衡动力学积分 
nsteps = 500000 ; #积分或能量最小化步数，*dt= 1ns总模拟时长 （常用） 
dt = 0.002 ; #积分步长，一般为 0.002ps ~0.004ps 

; Output control #（常用） 
nstxout = 0 ; #坐标保存到轨迹文件的频率  .trr
nstvout = 0 ; #速度保存到轨迹文件的频率  v, 开启会增加运行时间 
nstenergy = 5000 ; #能量保存到轨迹文件的频率，必须是nstcalcenergy的倍数 
nstlog = 5000 ; # log文件更新频率 
nstxout-compressed = 5000 ; # 
compressed-x-grps = System 
energygrps = Protein JZ4 #保存能量的组 

; Bond parameters 
continuation = yes ; #初试构象不约束，不复位，用于精确的继续计算或重计算 constraint_algorithm = lincs ; #约束算法 lincs ：不能用于角度约束 
constraints = all-bonds ; #键约束，all-bonds:所有键约束，#(键的约束，不常用） 
lincs_iter = 1 ; #迭代次数，用于LINCS约束精度，默认1 
lincs_order = 4 ; #约束偶合矩阵阶次，用于LINCS约束精度，默认4 
; Neighborsearching 
cutoff-scheme = Verlet 
ns_type = grid ; #邻近列表搜索方法 
nstlist = 10 ; #邻近列表更新频率 
rcoulomb = 1.4 ; #短程库伦截断 
rvdw = 1.4 ; #短程范德华力截断(一般为1~1.4, 太短不够精确，太长计算量太大) 
; Electrostatics 
coulombtype = PME ; #库伦计算方式 
pme_order = 4 ; #PME插值，默认4表示3次插值 
fourierspacing = 0.16 ; #FFT傅里叶变换格点间距，默认。。。，与PME同时使用 
; Temperature coupling 
tcoupl = V-rescale ; #指定热耦合方法 
tc-grps = Protein_JZ4 Water_and_ions ; #热偶合组，分为蛋白质和水两个组 
tau_t = 0.1 0.1 ; #热偶合时间常数
ref_t = 300 300 ; #参考温度--恒温值，个数对应组，蛋白质设300K, 水300K（常用！修改） 
; Pressure coupling 
pcoupl = Parrinello-Rahman ; #指定压力耦合方式 
；Parrinello-Rahman：
pcoupltype = isotropic ; #isotropic:盒子各向同性 
tau_p = 2.0 ; #压力耦合时间常数 
ref_p = 1.0 ; #参考压力---恒压值，一般为1 bar 
compressibility = 4.5e-5 ; #水可压缩性，1 bar300K时为4.5e-5 bar-1 
; Periodic boundary conditions 
pbc = xyz ; #周期性边界条件；xyz:使用周期性边界条件 
; Dispersion correction 
DispCorr = EnerPres ; #色散校正 
; Velocity generation 
gen_vel = no ; #速度生成；no:不生成速度。输入文件没有速度，则为0；</code></pre> 
<p id="%C2%A0GROMACS%E7%AE%80%E5%8D%95%E5%A4%84%E7%90%86%E5%91%BD%E4%BB%A4"><strong>2. 使用md.mdp生成输入文件tpr</strong></p> 
<pre><code class="language-bash">gmx_mpi  grompp -f md.mdp -c init.gro -p fws_plus.top -o md.tpr  -maxwarn 5
#run md
gmx_mpi  mdrun  -deffnm md</code></pre> 
<p>3. GPU运行</p> 
<p>使用4个GPU</p> 
<pre><code>#!/bin/bash
#SBATCH -N 2
#SBATCH -p migration
#SBATCH --ntasks-per-node=4
#SBATCH --cpus-per-task=8
#SBATCH --gres=gpu:4
#SBATCH --exclusive

###module load gromacs_gpu
mpirun gmx_mpi mdrun -nsteps 50000 -v -deffnm npt-nopr -pin on -nb gpu -pme cpu -ntomp 8 -gpu_id 0123</code></pre> 
<p> 使用一个GPU</p> 
<pre><code>mpirun gmx_mpi mdrun -nsteps 10000 -v -deffnm npt-nopr -pin on -nb gpu -pme cpu -ntomp 8 -gpu_id 0</code></pre> 
<p> </p> 
<h3>GROMACS简单处理命令</h3> 
<p><strong>1.pdb转换为去掉 pbc、旋转对齐,去掉水的pdb</strong></p> 
<pre><code>echo "1\n 1\n" | gmx  trjconv -f output.pdb -s md.tpr -o center.pdb -center  -pbc nojump

echo "1\n 1\n" | gmx  trjconv -f center.pdb -s md.tpr -fit rot+trans -o newout.pdb</code></pre> 
<p><strong>2将pdb转化成xtc</strong></p> 
<pre><code>gmx  trjconv -f output.pdb -o output.xtc</code></pre> 
<p style="margin-left:0pt;"><strong>3.RMSD </strong>分析蛋白质：</p> 
<pre><code>echo "1\n 1 \n 1" | gmx  rms -f center.pdb -s md.tpr -o rmsd-start.xvg</code></pre> 
<p style="margin-left:0pt;"><strong>4.生成index</strong>文件：</p> 
<pre><code>gmx make_ndx -f md.tpr -o 15-40.ndx

r 15-40

q</code></pre> 
<p style="margin-left:0pt;">5<strong>.RMSD</strong>分析指定部分： </p> 
<pre><code>gmx rms -f center.pdb -s md.tpr -o rmsd-15-40.xvg -n 15-40.ndx</code></pre> 
<p style="margin-left:0pt;"> </p> 
<p style="margin-left:0pt;"><strong>6.蛋白质rmsf</strong></p> 
<pre><code>echo "1\n 1 \n 1" | gmx  rmsf -f center.pdb -s md.tpr -o rmsd-start.xvg</code></pre> 
<p style="margin-left:0pt;"><strong>7.dssp</strong></p> 
<p style="margin-left:0pt;">(需要安装dssp,，注意需要配置新版GROMACS，否则会报错ver)</p> 
<p style="margin-left:0pt;">Dssp 安装下载网站https://swift.cmbi.umcn.nl/gv/dssp/ 寻找页面上的，然后进入github下载源码解压之后，进入源码文件中，./autogen.sh  ./configure 。（发现要安装boost库）<br>  </p> 
<pre><code>echo 1 | gmx do_dssp -f newout.pdb -s md.tpr -o secondary-structure.xpm -sc secondary-structure.xvg

echo 1 | gmx xpm2ps -f secondary-structure.xpm -o secondary-structure.eps -size 4000

ps2pdf secondary-structure.eps

evince secondary-structure.pdf</code></pre> 
<p style="margin-left:0pt;"><strong>8.生成index，</strong>以及技巧，分析1-9和10-40号氨基酸分别的rmsd。</p> 
<pre><code>gmx make_ndx -f out.pdb -o 3_28.ndx

r3 r28 splitch10 splitch11 #splitch可以按链分组</code></pre> 
<p><strong>9. gmx distance</strong> 命令，分析特定原子组之间的平均距离，用这个分析 E3 和 对面链上的 K28 之间的距离</p> 
<p style="margin-left:0pt;">求质心间距离</p> 
<pre><code>gmx distance -f out.pdb -s md.tpr -n gg.ndx -oav dis.xvg -select "com of group 12 plus com of group 24"</code></pre> 
<p><strong>10.gmx min_dis</strong> 命令，求最小距离</p> 
<pre><code>echo 12 24 | gmx mindist -f out.pdb -s md.tpr -n gg.ndx -od min-dis.xvg -o min-dis.out</code></pre> 
<p> </p> 
<p style="margin-left:0pt;">参考博客<a href="https://blog.csdn.net/u012325865/article/details/78148309"><u><span style="color:#0000ff;"><u>https://blog.csdn.net/u012325865/article/details/78148309</u></span></u></a></p> 
<p style="margin-left:0pt;">参考博客 <a href="http://blog.sciencenet.cn/blog-548663-1082458.html" rel="nofollow"><u><span style="color:#0000ff;"><u>http://blog.sciencenet.cn/blog-548663-1082458.html</u></span></u></a></p> 
<p><strong>中文手册</strong></p> 
<p><a href="http://blog.sciencenet.cn/blog-548663-1082458.html" rel="nofollow">http://blog.sciencenet.cn/blog-548663-1082458.html</a></p> 
<p><a href="http://jerkwin.github.io/GMX/GMXprg/#gmx-trjconv--" rel="nofollow">http://jerkwin.github.io/GMX/GMXprg/#gmx-trjconv--</a></p> 
<p><a href="https://jerkwin.github.io/" rel="nofollow">https://jerkwin.github.io/</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f5b6c1858c044bb1463d6c5c7f136d82/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java设计模式之单例模式（Singleton Pattern）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3d89ffc870e6a682e8fd25ae139da52f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">新项目启动报错：No qualifying bean of type ‘xxxMapper‘ available: expected at least 1 bean which qualifies..</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>