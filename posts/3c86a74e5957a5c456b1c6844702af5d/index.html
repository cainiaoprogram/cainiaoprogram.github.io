<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用wire重构商品微服务 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用wire重构商品微服务" />
<meta property="og:description" content="一.wire简介 Wire 是一个轻巧的Golang依赖注入工具。它由Go Cloud团队开发，通过自动生成代码的方式在编译期完成依赖注入。
依赖注入是保持软件 “低耦合、易维护” 的重要设计准则之一。
此准则被广泛应用在各种开发平台之中，有很多与之相关的优秀工具。
其中最著名的当属 Spring，Spring IOC 作为框架的核心功能对Spring的发展到今天统治地位起了决定性作用。
依赖注入很重要，所以Golang社区中早已有人开发了相关工具， 比如来自Uber 的 dig 、来自Facebook 的 inject 。他们都通过反射机制实现了运行时依赖注入。
二.快速使用 2.1安装 安装很简单，运行 go get github.com/google/wire/cmd/wire 之后， wire 命令行工具 将被安装到 $GOPATH/bin 。只要确保 $GOPATH/bin 在 $PATH 中， wire 命令就可以在任何目录调用了。安装成功后运行如下命令
2.2快速入门 设计一个程序，其中 Event依赖Greeter，Greeter依赖Message
package main import ( &#34;fmt&#34; &#34;github.com/pkg/errors&#34; &#34;time&#34; ) type Message string func NewMessage(phrase string) Message { return Message(phrase) } type Greeter struct { Message Message } func NewGreeter(m Message) Greeter { return Greeter{Message: m} } func (g Greeter) Greet() Message { return g." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3c86a74e5957a5c456b1c6844702af5d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-08T09:55:57+08:00" />
<meta property="article:modified_time" content="2023-12-08T09:55:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用wire重构商品微服务</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="wire_0"></a>一.wire简介</h4> 
<p>Wire 是一个轻巧的Golang依赖注入工具。它由Go Cloud团队开发，通过自动生成代码的方式在编译期完成依赖注入。</p> 
<p>依赖注入是保持软件 “低耦合、易维护” 的重要设计准则之一。</p> 
<p>此准则被广泛应用在各种开发平台之中，有很多与之相关的优秀工具。</p> 
<p>其中最著名的当属 Spring，Spring IOC 作为框架的核心功能对Spring的发展到今天统治地位起了决定性作用。</p> 
<p>依赖注入很重要，所以Golang社区中早已有人开发了相关工具， 比如来自Uber 的 dig 、来自Facebook 的 inject 。他们都通过反射机制实现了运行时依赖注入。</p> 
<h4><a id="_12"></a>二.快速使用</h4> 
<h5><a id="21_14"></a>2.1安装</h5> 
<p>安装很简单，运行 <code>go get github.com/google/wire/cmd/wire</code> 之后， wire 命令行工具 将被安装到 <code>$GOPATH/bin</code> 。只要确保 <code>$GOPATH/bin</code> 在 $PATH 中， wire 命令就可以在任何目录调用了。安装成功后运行如下命令<br> <img src="https://images2.imgbox.com/94/3c/pzA3Yd64_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="22_20"></a>2.2快速入门</h5> 
<p>设计一个程序，其中 Event依赖Greeter，Greeter依赖Message</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/pkg/errors"</span>
	<span class="token string">"time"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Message <span class="token builtin">string</span>

<span class="token keyword">func</span> <span class="token function">NewMessage</span><span class="token punctuation">(</span>phrase <span class="token builtin">string</span><span class="token punctuation">)</span> Message <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token function">Message</span><span class="token punctuation">(</span>phrase<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Greeter <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Message Message
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">NewGreeter</span><span class="token punctuation">(</span>m Message<span class="token punctuation">)</span> Greeter <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> Greeter<span class="token punctuation">{<!-- --></span>Message<span class="token punctuation">:</span> m<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>g Greeter<span class="token punctuation">)</span> <span class="token function">Greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Message <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> g<span class="token punctuation">.</span>Message
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Event <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Greeter Greeter <span class="token comment">// &lt;- adding a Greeter field</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">NewEvent</span><span class="token punctuation">(</span>g Greeter<span class="token punctuation">)</span> <span class="token punctuation">(</span>Event<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Unix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> Event<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"could not create event: event greeter is grumpy"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> Event<span class="token punctuation">{<!-- --></span>Greeter<span class="token punctuation">:</span> g<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>e Event<span class="token punctuation">)</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	msg <span class="token operator">:=</span> e<span class="token punctuation">.</span>Greeter<span class="token punctuation">.</span><span class="token function">Greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>如果运行Event需要逐个构建依赖，代码如下</p> 
<pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    message <span class="token operator">:=</span> <span class="token function">NewMessage</span><span class="token punctuation">(</span><span class="token string">"lisus2000"</span><span class="token punctuation">)</span>
    greeter <span class="token operator">:=</span> <span class="token function">NewGreeter</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
    event <span class="token operator">:=</span> <span class="token function">NewEvent</span><span class="token punctuation">(</span>greeter<span class="token punctuation">)</span>

    event<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>在此之前先介绍两个概念</p> 
<p><strong>Provider</strong><br> Provider 你可以把它理解成工厂函数，这个函数的入参是依赖的属性，返回值为新一个新的类型实例</p> 
<p>如下所示都是 provider 函数，在实际使用的时候，往往是一些简单的工厂函数，这个函数不会太复杂。</p> 
<pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">NewMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Message <span class="token punctuation">{<!-- --></span>
 <span class="token keyword">return</span> <span class="token function">Message</span><span class="token punctuation">(</span><span class="token string">"Hi there!"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">NewGreeter</span><span class="token punctuation">(</span>m Message<span class="token punctuation">)</span> Greeter <span class="token punctuation">{<!-- --></span>
 <span class="token keyword">return</span> Greeter<span class="token punctuation">{<!-- --></span>Message<span class="token punctuation">:</span> m<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>Injector</strong></p> 
<p>我们常常在 wire.go 文件中定义 injector ，injector也是一个普通函数，它用来声明组件之间的依赖关系</p> 
<p>如下代码，我们把Event、Greeter、Message 的工厂函数(provider)一股脑塞入wire.Build()中，代表着构建 Event依赖Greeter、Message。我们不必关心Greeter、Message之间的依赖关系，wire会帮我们处理</p> 
<pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">InitializeEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Event <span class="token punctuation">{<!-- --></span>
    wire<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span>NewEvent<span class="token punctuation">,</span> NewGreeter<span class="token punctuation">,</span> NewMessage<span class="token punctuation">)</span>
    <span class="token keyword">return</span> Event<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>编写wire.go文件</p> 
<pre><code class="prism language-go"><span class="token comment">//go:build wireinject</span>
<span class="token comment">// +build wireinject</span>

<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"github.com/google/wire"</span>

<span class="token keyword">var</span> wireSet <span class="token operator">=</span> wire<span class="token punctuation">.</span><span class="token function">NewSet</span><span class="token punctuation">(</span>wire<span class="token punctuation">.</span><span class="token function">Struct</span><span class="token punctuation">(</span><span class="token function">new</span><span class="token punctuation">(</span>Greeter<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Message"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NewMessage<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">InitializeEvent</span><span class="token punctuation">(</span>phrase <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>Event<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   <span class="token comment">//我们常常在 wire.go 文件中定义 injector ，injector也是一个普通函数，它用来声明组件之间的依赖关系</span>
   <span class="token comment">//如下代码，我们把Event、Greeter、Message 的工厂函数(provider)一股脑塞入wire.Build()中，</span>
   <span class="token comment">//代表着构建 Event依赖Greeter、Message。我们不必关心Greeter、Message之间的依赖关系，wire会帮我们处理</span>

   <span class="token function">panic</span><span class="token punctuation">(</span>wire<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span>NewEvent<span class="token punctuation">,</span> wireSet<span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token comment">//return Event{}, nil</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>注：使用wire生成代码时，要在代码上加以下</p> 
<p>可以在wire.go第一行加入 //+build wireinject （与//go:build wireinject等效）注释，确保了这个文件在我们正常编译的时候不会被引用</p> 
<p>在带有wire.go目录下运行wire命令，就会生成wire_gen.go文件，如下图所示</p> 
<p><img src="https://images2.imgbox.com/da/e8/7bfmYk76_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/c9/3f/rWbngNjw_o.png" alt="在这里插入图片描述"></p> 
<p>完整的main.go文件如下</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">"fmt"</span>
   <span class="token string">"github.com/pkg/errors"</span>
   <span class="token string">"time"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Message <span class="token builtin">string</span>

<span class="token keyword">func</span> <span class="token function">NewMessage</span><span class="token punctuation">(</span>phrase <span class="token builtin">string</span><span class="token punctuation">)</span> Message <span class="token punctuation">{<!-- --></span>
   <span class="token keyword">return</span> <span class="token function">Message</span><span class="token punctuation">(</span>phrase<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Greeter <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
   Message Message
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">NewGreeter</span><span class="token punctuation">(</span>m Message<span class="token punctuation">)</span> Greeter <span class="token punctuation">{<!-- --></span>
   <span class="token keyword">return</span> Greeter<span class="token punctuation">{<!-- --></span>Message<span class="token punctuation">:</span> m<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>g Greeter<span class="token punctuation">)</span> <span class="token function">Greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Message <span class="token punctuation">{<!-- --></span>
   <span class="token keyword">return</span> g<span class="token punctuation">.</span>Message
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Event <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
   Greeter Greeter <span class="token comment">// &lt;- adding a Greeter field</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">NewEvent</span><span class="token punctuation">(</span>g Greeter<span class="token punctuation">)</span> <span class="token punctuation">(</span>Event<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   <span class="token keyword">if</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Unix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> Event<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"could not create event: event greeter is grumpy"</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> Event<span class="token punctuation">{<!-- --></span>Greeter<span class="token punctuation">:</span> g<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>e Event<span class="token punctuation">)</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   msg <span class="token operator">:=</span> e<span class="token punctuation">.</span>Greeter<span class="token punctuation">.</span><span class="token function">Greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   event<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> <span class="token function">InitializeEvent</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span>
   event<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><a href="https://blog.csdn.net/weixin_50071922/article/details/133278161">wire的进阶</a>，详见https://blog.csdn.net/weixin_50071922/article/details/133278161</p> 
<h4><a id="wire_201"></a>三.基于wire构建商品微服务</h4> 
<h5><a id="31_203"></a>3.1编写商品微服务提供者</h5> 
<pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">NewGoodsAppWire</span><span class="token punctuation">(</span>logOpts <span class="token operator">*</span>log<span class="token punctuation">.</span>Options<span class="token punctuation">,</span> registrar registry<span class="token punctuation">.</span>Registrar<span class="token punctuation">,</span> serverOpts <span class="token operator">*</span>options<span class="token punctuation">.</span>ServerOptions<span class="token punctuation">,</span>
   rpcServer <span class="token operator">*</span>rpcserver<span class="token punctuation">.</span>Server<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>gapp<span class="token punctuation">.</span>App<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   <span class="token comment">//初始化log</span>
   log<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span>logOpts<span class="token punctuation">)</span>
   <span class="token keyword">defer</span> log<span class="token punctuation">.</span><span class="token function">Flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token keyword">return</span> gapp<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>
      gapp<span class="token punctuation">.</span><span class="token function">WithName</span><span class="token punctuation">(</span>serverOpts<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span>
      gapp<span class="token punctuation">.</span><span class="token function">WithRPCServer</span><span class="token punctuation">(</span>rpcServer<span class="token punctuation">)</span><span class="token punctuation">,</span>
      gapp<span class="token punctuation">.</span><span class="token function">WithRegistrar</span><span class="token punctuation">(</span>registrar<span class="token punctuation">)</span><span class="token punctuation">,</span>
   <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">NewRegistrar</span><span class="token punctuation">(</span>registry <span class="token operator">*</span>options<span class="token punctuation">.</span>RegistryOptions<span class="token punctuation">)</span> registry<span class="token punctuation">.</span>Registrar <span class="token punctuation">{<!-- --></span>
   c <span class="token operator">:=</span> api<span class="token punctuation">.</span><span class="token function">DefaultConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   c<span class="token punctuation">.</span>Address <span class="token operator">=</span> registry<span class="token punctuation">.</span>Address
   c<span class="token punctuation">.</span>Scheme <span class="token operator">=</span> registry<span class="token punctuation">.</span>Scheme
   client<span class="token punctuation">,</span> err <span class="token operator">:=</span> api<span class="token punctuation">.</span><span class="token function">NewClient</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
   <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> consul<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> consul<span class="token punctuation">.</span><span class="token function">WithHealthCheck</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">NewGoodsRPCServerWire</span><span class="token punctuation">(</span>telemetry <span class="token operator">*</span>options<span class="token punctuation">.</span>TelemetryOptions<span class="token punctuation">,</span>
   serverOpts <span class="token operator">*</span>options<span class="token punctuation">.</span>ServerOptions<span class="token punctuation">,</span> gserver gpb<span class="token punctuation">.</span>GoodsServer<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>rpcserver<span class="token punctuation">.</span>Server<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   <span class="token comment">// 初始化 open-telemetry 的 exporter</span>
   trace<span class="token punctuation">.</span><span class="token function">InitAgent</span><span class="token punctuation">(</span>trace<span class="token punctuation">.</span>Options<span class="token punctuation">{<!-- --></span>
      Name<span class="token punctuation">:</span>     telemetry<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
      Endpoint<span class="token punctuation">:</span> telemetry<span class="token punctuation">.</span>Endpoint<span class="token punctuation">,</span>
      Sampler<span class="token punctuation">:</span>  telemetry<span class="token punctuation">.</span>Sampler<span class="token punctuation">,</span>
      Batcher<span class="token punctuation">:</span>  telemetry<span class="token punctuation">.</span>Batcher<span class="token punctuation">,</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token comment">// 这里会根据 endpoint 为单元注册 trace 服务的实例</span>
   rpcAddr <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%s:%d"</span><span class="token punctuation">,</span> serverOpts<span class="token punctuation">.</span>Host<span class="token punctuation">,</span> serverOpts<span class="token punctuation">.</span>Port<span class="token punctuation">)</span>
   <span class="token keyword">var</span> opts <span class="token punctuation">[</span><span class="token punctuation">]</span>rpcserver<span class="token punctuation">.</span>ServerOption
   opts <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>opts<span class="token punctuation">,</span> rpcserver<span class="token punctuation">.</span><span class="token function">WithAddress</span><span class="token punctuation">(</span>rpcAddr<span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token keyword">if</span> serverOpts<span class="token punctuation">.</span>EnableLimit <span class="token punctuation">{<!-- --></span>
      opts <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>opts<span class="token punctuation">,</span> rpcserver<span class="token punctuation">.</span><span class="token function">WithUnaryInterceptor</span><span class="token punctuation">(</span>grpc<span class="token punctuation">.</span><span class="token function">NewUnaryServerInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   grpcServer <span class="token operator">:=</span> rpcserver<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span>opts<span class="token operator">...</span><span class="token punctuation">)</span>
   gpb<span class="token punctuation">.</span><span class="token function">RegisterGoodsServer</span><span class="token punctuation">(</span>grpcServer<span class="token punctuation">.</span>Server<span class="token punctuation">,</span> gserver<span class="token punctuation">)</span>
   <span class="token keyword">return</span> grpcServer<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">NewGoodsServerWire</span><span class="token punctuation">(</span>srv v1<span class="token punctuation">.</span>ServiceFactory<span class="token punctuation">)</span> proto<span class="token punctuation">.</span>GoodsServer <span class="token punctuation">{<!-- --></span>
   <span class="token keyword">return</span> <span class="token operator">&amp;</span>goodsServer<span class="token punctuation">{<!-- --></span>
      srv<span class="token punctuation">:</span> srv<span class="token punctuation">,</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">NewGoodsServiceWire</span><span class="token punctuation">(</span>data v1<span class="token punctuation">.</span>DataFactory<span class="token punctuation">,</span> dataSearch v12<span class="token punctuation">.</span>SearchFactory<span class="token punctuation">)</span> ServiceFactory <span class="token punctuation">{<!-- --></span>
   <span class="token keyword">return</span> <span class="token operator">&amp;</span>service<span class="token punctuation">{<!-- --></span>
      data<span class="token punctuation">:</span>       data<span class="token punctuation">,</span>
      dataSearch<span class="token punctuation">:</span> dataSearch<span class="token punctuation">,</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">GetDBFactoryOr</span><span class="token punctuation">(</span>mysqlOpts <span class="token operator">*</span>options<span class="token punctuation">.</span>MySQLOptions<span class="token punctuation">)</span> <span class="token punctuation">(</span>v1<span class="token punctuation">.</span>DataFactory<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   <span class="token keyword">if</span> mysqlOpts <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> dbFactory <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">WithCode</span><span class="token punctuation">(</span>code<span class="token punctuation">.</span>ErrConnectDB<span class="token punctuation">,</span> <span class="token string">"failed to get mysql store factory"</span><span class="token punctuation">)</span>

   <span class="token punctuation">}</span>
   <span class="token keyword">var</span> err <span class="token builtin">error</span>
   once<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      dsn <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%s:%s@tcp(%s:%s)/%s?charset=utf8mb4&amp;parseTime=True&amp;loc=Local"</span><span class="token punctuation">,</span>
         mysqlOpts<span class="token punctuation">.</span>Username<span class="token punctuation">,</span>
         mysqlOpts<span class="token punctuation">.</span>Password<span class="token punctuation">,</span>
         mysqlOpts<span class="token punctuation">.</span>Host<span class="token punctuation">,</span>
         mysqlOpts<span class="token punctuation">.</span>Port<span class="token punctuation">,</span>
         mysqlOpts<span class="token punctuation">.</span>Database<span class="token punctuation">)</span>
      <span class="token comment">//希望大家自己可以去封装logger</span>
      newLogger <span class="token operator">:=</span> logger<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>
         log<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stdout<span class="token punctuation">,</span> <span class="token string">"\r\n"</span><span class="token punctuation">,</span> log<span class="token punctuation">.</span>LstdFlags<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// io writer（日志输出的目标，前缀和日志包含的内容——译者注）</span>
         logger<span class="token punctuation">.</span>Config<span class="token punctuation">{<!-- --></span>
            SlowThreshold<span class="token punctuation">:</span>             time<span class="token punctuation">.</span>Second<span class="token punctuation">,</span>                         <span class="token comment">// 慢 SQL 阈值</span>
            LogLevel<span class="token punctuation">:</span>                  logger<span class="token punctuation">.</span><span class="token function">LogLevel</span><span class="token punctuation">(</span>mysqlOpts<span class="token punctuation">.</span>LogLevel<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 日志级别</span>
            IgnoreRecordNotFoundError<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                                <span class="token comment">// 忽略ErrRecordNotFound（记录未找到）错误</span>
            Colorful<span class="token punctuation">:</span>                  <span class="token boolean">false</span><span class="token punctuation">,</span>                               <span class="token comment">// 禁用彩色打印</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span>
      db<span class="token punctuation">,</span> err <span class="token operator">:=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>mysql<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>dsn<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>gorm<span class="token punctuation">.</span>Config<span class="token punctuation">{<!-- --></span>
         Logger<span class="token punctuation">:</span> newLogger<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
         <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      sqlDB<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">DB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      dbFactory <span class="token operator">=</span> <span class="token operator">&amp;</span>mysqlFactory<span class="token punctuation">{<!-- --></span>
         db<span class="token punctuation">:</span> db<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
      <span class="token comment">//允许连接多少个mysql</span>
      sqlDB<span class="token punctuation">.</span><span class="token function">SetMaxOpenConns</span><span class="token punctuation">(</span>mysqlOpts<span class="token punctuation">.</span>MaxOpenConnections<span class="token punctuation">)</span>
      <span class="token comment">//允许最大的空闲的连接数</span>
      sqlDB<span class="token punctuation">.</span><span class="token function">SetMaxIdleConns</span><span class="token punctuation">(</span>mysqlOpts<span class="token punctuation">.</span>MaxIdleConnections<span class="token punctuation">)</span>
      <span class="token comment">//重用连接的最大时长</span>
      sqlDB<span class="token punctuation">.</span><span class="token function">SetConnMaxLifetime</span><span class="token punctuation">(</span>mysqlOpts<span class="token punctuation">.</span>MaxConnectionLifetime<span class="token punctuation">)</span>

   <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token keyword">if</span> dbFactory <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token operator">||</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">WithCode</span><span class="token punctuation">(</span>code<span class="token punctuation">.</span>ErrConnectDB<span class="token punctuation">,</span> <span class="token string">"failed to get mysql store factory"</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> dbFactory<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">GetSearchFactoryOr</span><span class="token punctuation">(</span>opts <span class="token operator">*</span>options<span class="token punctuation">.</span>EsOptions<span class="token punctuation">)</span> <span class="token punctuation">(</span>v12<span class="token punctuation">.</span>SearchFactory<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   <span class="token keyword">if</span> opts <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> searchFactory <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"failed to get es client"</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>

   once<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      esOpt <span class="token operator">:=</span> db<span class="token punctuation">.</span>EsOptions<span class="token punctuation">{<!-- --></span>
         Host<span class="token punctuation">:</span> opts<span class="token punctuation">.</span>Host<span class="token punctuation">,</span>
         Port<span class="token punctuation">:</span> opts<span class="token punctuation">.</span>Port<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
      esClient<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">NewEsClient</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>esOpt<span class="token punctuation">)</span>
      <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
         <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      searchFactory <span class="token operator">=</span> <span class="token operator">&amp;</span>dataSearch<span class="token punctuation">{<!-- --></span>
         esClient<span class="token punctuation">:</span> esClient<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>

   <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token keyword">if</span> searchFactory <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"failed to get es client"</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> searchFactory<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="32wirego_349"></a>3.2编写wire.go文件</h5> 
<pre><code class="prism language-go"><span class="token comment">//go:build wireinject</span>
<span class="token comment">// +build wireinject</span>

<span class="token keyword">package</span> srv

<span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">"github.com/google/wire"</span>
   v1 <span class="token string">"mxshop/app/goods/srv/internal/controller/v1"</span>
   <span class="token string">"mxshop/app/goods/srv/internal/data/v1/data_search/v1/es"</span>
   <span class="token string">"mxshop/app/goods/srv/internal/data/v1/db"</span>
   v12 <span class="token string">"mxshop/app/goods/srv/internal/service/v1"</span>
   <span class="token string">"mxshop/app/pkg/options"</span>
   gapp <span class="token string">"mxshop/gmicro/app"</span>
   <span class="token string">"mxshop/pkg/log"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">initApp</span><span class="token punctuation">(</span><span class="token operator">*</span>log<span class="token punctuation">.</span>Options<span class="token punctuation">,</span> <span class="token operator">*</span>options<span class="token punctuation">.</span>ServerOptions<span class="token punctuation">,</span> <span class="token operator">*</span>options<span class="token punctuation">.</span>RegistryOptions<span class="token punctuation">,</span>
   <span class="token operator">*</span>options<span class="token punctuation">.</span>TelemetryOptions<span class="token punctuation">,</span> <span class="token operator">*</span>options<span class="token punctuation">.</span>MySQLOptions<span class="token punctuation">,</span> <span class="token operator">*</span>options<span class="token punctuation">.</span>EsOptions<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>gapp<span class="token punctuation">.</span>App<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   wire<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span>NewGoodsAppWire<span class="token punctuation">,</span>
      NewRegistrar<span class="token punctuation">,</span>
      NewGoodsRPCServerWire<span class="token punctuation">,</span>
      v1<span class="token punctuation">.</span>NewGoodsServerWire<span class="token punctuation">,</span>
      v12<span class="token punctuation">.</span>NewGoodsServiceWire<span class="token punctuation">,</span>
      db<span class="token punctuation">.</span>GetDBFactoryOr<span class="token punctuation">,</span>
      es<span class="token punctuation">.</span>GetSearchFactoryOr<span class="token punctuation">,</span>
   <span class="token punctuation">)</span>

   <span class="token keyword">return</span> <span class="token operator">&amp;</span>gapp<span class="token punctuation">.</span>App<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>3.3生成wire_gen.go文件</p> 
<p><img src="https://images2.imgbox.com/e2/1b/RaFkaTK7_o.png" alt="在这里插入图片描述"></p> 
<p>生成后的文件如下：</p> 
<pre><code class="prism language-go"><span class="token comment">// Code generated by Wire. DO NOT EDIT.</span>

<span class="token comment">//go:generate go run github.com/google/wire/cmd/wire</span>
<span class="token comment">//go:build !wireinject</span>
<span class="token comment">// +build !wireinject</span>

<span class="token keyword">package</span> srv

<span class="token keyword">import</span> <span class="token punctuation">(</span>
   v1_2 <span class="token string">"mxshop/app/goods/srv/internal/controller/v1"</span>
   <span class="token string">"mxshop/app/goods/srv/internal/data/v1/data_search/v1/es"</span>
   <span class="token string">"mxshop/app/goods/srv/internal/data/v1/db"</span>
   <span class="token string">"mxshop/app/goods/srv/internal/service/v1"</span>
   <span class="token string">"mxshop/app/pkg/options"</span>
   <span class="token string">"mxshop/gmicro/app"</span>
   <span class="token string">"mxshop/pkg/log"</span>
<span class="token punctuation">)</span>

<span class="token comment">// Injectors from wire.go:</span>

<span class="token keyword">func</span> <span class="token function">initApp</span><span class="token punctuation">(</span>logOptions <span class="token operator">*</span>log<span class="token punctuation">.</span>Options<span class="token punctuation">,</span> serverOptions <span class="token operator">*</span>options<span class="token punctuation">.</span>ServerOptions<span class="token punctuation">,</span> registryOptions <span class="token operator">*</span>options<span class="token punctuation">.</span>RegistryOptions<span class="token punctuation">,</span> telemetryOptions <span class="token operator">*</span>options<span class="token punctuation">.</span>TelemetryOptions<span class="token punctuation">,</span> mySQLOptions <span class="token operator">*</span>options<span class="token punctuation">.</span>MySQLOptions<span class="token punctuation">,</span> esOptions <span class="token operator">*</span>options<span class="token punctuation">.</span>EsOptions<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>app<span class="token punctuation">.</span>App<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   registrar <span class="token operator">:=</span> <span class="token function">NewRegistrar</span><span class="token punctuation">(</span>registryOptions<span class="token punctuation">)</span>
   dataFactory<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">GetDBFactoryOr</span><span class="token punctuation">(</span>mySQLOptions<span class="token punctuation">)</span>
   <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
   <span class="token punctuation">}</span>
   searchFactory<span class="token punctuation">,</span> err <span class="token operator">:=</span> es<span class="token punctuation">.</span><span class="token function">GetSearchFactoryOr</span><span class="token punctuation">(</span>esOptions<span class="token punctuation">)</span>
   <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
   <span class="token punctuation">}</span>
   serviceFactory <span class="token operator">:=</span> v1<span class="token punctuation">.</span><span class="token function">NewGoodsServiceWire</span><span class="token punctuation">(</span>dataFactory<span class="token punctuation">,</span> searchFactory<span class="token punctuation">)</span>
   goodsServer <span class="token operator">:=</span> v1_2<span class="token punctuation">.</span><span class="token function">NewGoodsServerWire</span><span class="token punctuation">(</span>serviceFactory<span class="token punctuation">)</span>
   server<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">NewGoodsRPCServerWire</span><span class="token punctuation">(</span>telemetryOptions<span class="token punctuation">,</span> serverOptions<span class="token punctuation">,</span> goodsServer<span class="token punctuation">)</span>
   <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
   <span class="token punctuation">}</span>
   appApp<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">NewGoodsAppWire</span><span class="token punctuation">(</span>logOptions<span class="token punctuation">,</span> registrar<span class="token punctuation">,</span> serverOptions<span class="token punctuation">,</span> server<span class="token punctuation">)</span>
   <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> appApp<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在如下方法替换接口</p> 
<p><img src="https://images2.imgbox.com/9b/ef/4eae5j3R_o.png" alt="在这里插入图片描述"></p> 
<p>运行main.go文件，如下显示，正常启动</p> 
<p><img src="https://images2.imgbox.com/2c/15/am5kPXA3_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b2d61257730a9113272b7b56c72fc987/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">寄存器、缓存、内存、硬盘、存储器的理解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/be3640cee88f3a541fb5d382db04afa3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">单片机常见的复位方式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>