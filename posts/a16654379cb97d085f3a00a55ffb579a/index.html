<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python WebDriver如何处理右键菜单 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python WebDriver如何处理右键菜单" />
<meta property="og:description" content="WebDriver如何处理右键菜单
一、背景
在学习selenium webdriver的过程中，遇到这样一个问题。ActionChains类中提供了context_click的方法，它可以用来在web页面中进行右键点击的操作，但是问题来了。右键弹出的菜单如何去选择呢？
二、尝试
1、在ActionChains类中，我们可以​看到有一个send_keys的方法。该方法可以接受Keys类中键盘上大部分的按键操作，如ActionChains(driver).send_keys(Keys.DOWN)，意图是发送一个向下的箭头操作来选择右键弹出菜单，但是实践后，发现是无效的；
2、既然send_keys​方法不行，那我接着找到了key_down和key_up的方法，按下某个键后再释放，达到相同的目的，实践后仍然失败；
3、我告诉自己不要气馁，一定会找到解决办法的。我又看到move_by_offset​的方法，既然键盘操作不行，那么我还可以用鼠标偏移量的方法，让鼠标移动到目标菜单上，再点击操作。残酷的现实告诉我，此路不通；
4、这时的我基本已经绝望，百度了很多方法也不行。后来，看到有人说用Robot类可以实现这个右键菜单的操作。而且，下面还有成功的代码，不过是用Java写的。对于只会python的我来说，需要找到一个python语言的实现，接下来开始找python下的“robot”​类。百度已经被我烦到死，还是没有找到；
5、最后，我在想那Python语言下是不是有模拟鼠标键盘操作的类库呢？换了一个思路，果然有所收获。win32api/win32con两个很牛的类可以做这个事，尝试成功。
import win32api
import win32con
win32api.keybd_event(40,0,0,0)#下箭头的键码是40
win32api.keybd_event(40,0,win32con.KEYEVENTF_KEYUP,0)#按下后再释放
​附个键位码表：
键位码表
6、还有一种解决右键菜单的方法，也列在下面，待以后有时间再尝试
使用AutoItX实现鼠标模拟：
#将AutoItX3.dll 文件复制到 window目录然后注册一下
regsvr32.exe AutoItX3.dll
from win32com.client import Dispatch
def enter_game():
AutoItX = Dispatch( &#34;AutoItX3.Control&#34; )
# Block All Input
AutoItX.BlockInput( 1 )
AutoItX.Sleep( 20000 )
if AutoItX.WinActivate( GAME_WINDOW_TITLE, &#39;&#39; ):
pass
else:
if AutoItX.WinWaitActive( GAME_WINDOW_TITLE, &#39;&#39;, 8 ):
pass
else:
# Unblock input
AutoItX.BlockInput( 0 )
return False" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a16654379cb97d085f3a00a55ffb579a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-03-02T16:36:00+08:00" />
<meta property="article:modified_time" content="2017-03-02T16:36:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python WebDriver如何处理右键菜单</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <p align="left">WebDriver如何处理右键菜单</p> 
 <p align="left">一、背景</p> 
 <p align="left">在学习selenium webdriver的过程中，遇到这样一个问题。ActionChains类中提供了context_click的方法，它可以用来在web页面中进行右键点击的操作，但是问题来了。右键弹出的菜单如何去选择呢？</p> 
 <p align="left">二、尝试</p> 
 <p align="left">1、在ActionChains类中，我们可以​看到有一个send_keys的方法。该方法可以接受Keys类中键盘上大部分的按键操作，如ActionChains(driver).send_keys(Keys.DOWN)，意图是发送一个向下的箭头操作来选择右键弹出菜单，但是实践后，发现是无效的；</p> 
 <p align="left">2、既然send_keys​方法不行，那我接着找到了key_down和key_up的方法，按下某个键后再释放，达到相同的目的，实践后仍然失败；</p> 
 <p align="left">3、我告诉自己不要气馁，一定会找到解决办法的。我又看到move_by_offset​的方法，既然键盘操作不行，那么我还可以用鼠标偏移量的方法，让鼠标移动到目标菜单上，再点击操作。残酷的现实告诉我，此路不通；</p> 
 <p align="left">4、这时的我基本已经绝望，百度了很多方法也不行。后来，看到有人说用Robot类可以实现这个右键菜单的操作。而且，下面还有成功的代码，不过是用Java写的。对于只会python的我来说，需要找到一个python语言的实现，接下来开始找python下的“robot”​类。百度已经被我烦到死，还是没有找到；</p> 
 <p align="left">5、最后，我在想那Python语言下是不是有模拟鼠标键盘操作的类库呢？换了一个思路，果然有所收获。win32api/win32con两个很牛的类可以做这个事，尝试<strong>成功</strong>。</p> 
 <p align="left">import win32api</p> 
 <p align="left">import win32con</p> 
 <p align="left"> </p> 
 <p align="left">win32api.keybd_event(40,0,0,0)#下箭头的键码是40</p> 
 <p align="left">win32api.keybd_event(40,0,win32con.KEYEVENTF_KEYUP,0)#按下后再释放</p> 
 <p align="left">​<strong>附个键位码表：</strong></p> 
 <p align="center"><em>键位码表</em></p> 
 <p align="left">6、还有一种解决右键菜单的方法，也列在下面，待以后有时间再尝试</p> 
 <p align="left"><strong>使用</strong><strong>AutoItX</strong><strong>实现鼠标模拟</strong>：</p> 
 <p align="left">#将AutoItX3.dll 文件复制到 window目录然后注册一下</p> 
 <p align="left">regsvr32.exe AutoItX3.dll</p> 
 <p align="left">from win32com.client import Dispatch</p> 
 <p align="left">def enter_game():</p> 
 <p align="left">   AutoItX = Dispatch( "AutoItX3.Control" )</p> 
 <p align="left">   # Block All Input</p> 
 <p align="left">   AutoItX.BlockInput( 1 )</p> 
 <p align="left">   AutoItX.Sleep( 20000 )</p> 
 <p align="left">   if AutoItX.WinActivate( GAME_WINDOW_TITLE, '' ):</p> 
 <p align="left">     pass</p> 
 <p align="left">   else:</p> 
 <p align="left">     if AutoItX.WinWaitActive( GAME_WINDOW_TITLE, '', 8 ):</p> 
 <p align="left">       pass</p> 
 <p align="left">     else:</p> 
 <p align="left">       # Unblock input</p> 
 <p align="left">       AutoItX.BlockInput( 0 )</p> 
 <p align="left">       return False</p> 
 <p align="left">   AutoItX.WinSetTitle( GAME_WINDOW_TITLE, '', _pre_title )</p> 
 <p align="left">   AutoItX.WinSetState( _pre_title, '', AutoItX.SW_MAXIMIZE )</p> 
 <p align="left">   AutoItX.Sleep( 5000 )</p> 
 <p align="left">   AutoItX.MouseMove( 462, 396, 10 )</p> 
 <p align="left">   AutoItX.MouseClick( "left" )</p> 
 <p align="left">   AutoItX.Sleep( 1000 )</p> 
 <p align="left">   AutoItX.Send( GAME_ACCT_NAME )</p> 
 <p align="left">   AutoItX.Sleep( 1000 )</p> 
 <p align="left">   AutoItX.MouseMove ( 462, 472, 10 )</p> 
 <p align="left">   AutoItX.MouseClick( "left" )</p> 
 <p align="left">   AutoItX.Sleep( 1000 )</p> 
 <p align="left">   AutoItX.Send( GAME_ACCT_PASS )</p> 
 <p align="left">   AutoItX.Send( "{ENTER}" )</p> 
 <p align="left">   AutoItX.Sleep( 10000 )</p> 
 <p align="left">   # Unblock input</p> 
 <p align="left">   AutoItX.BlockInput( 0 )</p> 
 <p align="left">   return True</p> 
 <p> </p> 
</div> 
<p>转载于:https://www.cnblogs.com/ai594ai/p/6491331.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/47ad417a177db55a6b34e4cc7acc3d2f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">bootstrap下拉菜单无效的解决方法之一</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d19c397f8a1d5069478d410ed3d41138/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【图像处理】windows 10 &#43; vs2015&#43; opencv3.0.0 &#43;附加模块opencv_contrib编译和配置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>