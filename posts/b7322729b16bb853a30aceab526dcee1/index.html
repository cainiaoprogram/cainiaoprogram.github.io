<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>fastgpt搭配chatglm3本地使用 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="fastgpt搭配chatglm3本地使用" />
<meta property="og:description" content="fastgpt搭配chatglm3本地使用 安装并配置ChatGLM3安装并配置one-api安装fastgpt安装docker拉取fastgpt修改配置文件修改docker-compose.yml修改config.json 启动容器效果展示 安装并配置ChatGLM3 详见我的上一篇文章: 清华开源语言大模型ChatGLM3部署实战
安装并配置one-api 详见我的上一篇文章: 清华开源语言大模型ChatGLM3联通one-api实现快速部署
安装fastgpt 安装docker # 安装 Docker curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun systemctl enable --now docker # 安装 docker-compose curl -L https://github.com/docker/compose/releases/download/2.20.3/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose chmod &#43;x /usr/local/bin/docker-compose # 验证安装 docker -v docker-compose -v 拉取fastgpt mkdir fastgpt cd fastgpt curl -O https://raw.githubusercontent.com/labring/FastGPT/main/files/deploy/fastgpt/docker-compose.yml curl -O https://raw.githubusercontent.com/labring/FastGPT/main/projects/app/data/config.json 修改配置文件 修改docker-compose.yml # 非 host 版本, 不使用本机代理 version: &#39;3.3&#39; services: pg: image: ankane/pgvector:v0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b7322729b16bb853a30aceab526dcee1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-24T16:36:46+08:00" />
<meta property="article:modified_time" content="2023-11-24T16:36:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">fastgpt搭配chatglm3本地使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>fastgpt搭配chatglm3本地使用</h4> 
 <ul><li><a href="#ChatGLM3_1" rel="nofollow">安装并配置ChatGLM3</a></li><li><a href="#oneapi_3" rel="nofollow">安装并配置one-api</a></li><li><a href="#fastgpt_5" rel="nofollow">安装fastgpt</a></li><li><ul><li><a href="#docker_6" rel="nofollow">安装docker</a></li><li><a href="#fastgpt_18" rel="nofollow">拉取fastgpt</a></li><li><a href="#_26" rel="nofollow">修改配置文件</a></li><li><ul><li><a href="#dockercomposeyml_27" rel="nofollow">修改docker-compose.yml</a></li><li><a href="#configjson_146" rel="nofollow">修改config.json</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_222" rel="nofollow">启动容器</a></li><li><a href="#_228" rel="nofollow">效果展示</a></li></ul> 
</div> 
<p></p> 
<h2><a id="ChatGLM3_1"></a>安装并配置ChatGLM3</h2> 
<p>详见我的上一篇文章: <a href="https://blog.csdn.net/Silver__Wolf/article/details/134247535">清华开源语言大模型ChatGLM3部署实战</a></p> 
<h2><a id="oneapi_3"></a>安装并配置one-api</h2> 
<p>详见我的上一篇文章: <a href="https://blog.csdn.net/Silver__Wolf/article/details/134501416">清华开源语言大模型ChatGLM3联通one-api实现快速部署</a></p> 
<h2><a id="fastgpt_5"></a>安装fastgpt</h2> 
<h3><a id="docker_6"></a>安装docker</h3> 
<pre><code># 安装 Docker
curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun
systemctl enable --now docker
# 安装 docker-compose
curl -L https://github.com/docker/compose/releases/download/2.20.3/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose
# 验证安装
docker -v
docker-compose -v
</code></pre> 
<h3><a id="fastgpt_18"></a>拉取fastgpt</h3> 
<pre><code>mkdir fastgpt
cd fastgpt
curl -O https://raw.githubusercontent.com/labring/FastGPT/main/files/deploy/fastgpt/docker-compose.yml
curl -O https://raw.githubusercontent.com/labring/FastGPT/main/projects/app/data/config.json
</code></pre> 
<h3><a id="_26"></a>修改配置文件</h3> 
<h4><a id="dockercomposeyml_27"></a>修改docker-compose.yml</h4> 
<pre><code># 非 host 版本, 不使用本机代理
version: '3.3'
services:
  pg:
    image: ankane/pgvector:v0.5.0 # git
    # image: registry.cn-hangzhou.aliyuncs.com/fastgpt/pgvector:v0.5.0 # 阿里云
    container_name: fastgpt-pg
    restart: always
    ports: # 生产环境建议不要暴露
      - 5432:5432
    networks:
      - fastgpt
    environment:
      # 这里的配置只有首次运行生效。修改后，重启镜像是不会生效的。需要把持久化数据删除再重启，才有效果
      - POSTGRES_USER=username
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=postgres
    volumes:
      - ./pg/data:/var/lib/postgresql/data
  mongo:
    image: mongo:5.0.18
    # image: registry.cn-hangzhou.aliyuncs.com/fastgpt/mongo:5.0.18 # 阿里云
    container_name: fastgpt-mongo
    restart: always
    ports: # 生产环境建议不要暴露
      - 27017:27017
    networks:
      - fastgpt
    environment:
      # 这里的配置只有首次运行生效。修改后，重启镜像是不会生效的。需要把持久化数据删除再重启，才有效果
      - MONGO_INITDB_ROOT_USERNAME=username
      - MONGO_INITDB_ROOT_PASSWORD=password
    volumes:
      - ./mongo/data:/data/db
  fastgpt:
    container_name: fastgpt-fastgpt
    image: ghcr.io/labring/fastgpt:latest # git
    # image: registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt:latest # 阿里云
    ports:
      - 3000:3000
    networks:
      - fastgpt
    depends_on:
      - mongo
      - pg
    restart: always
    environment:
      # root 密码，用户名为: root
      - DEFAULT_ROOT_PSW=1234
      # 中转地址，如果是用官方号，不需要管,https://api.openai.com/v1
      - OPENAI_BASE_URL=http://192.168.225.97:3001/v1
      - CHAT_API_KEY=sk-rYmgZkdQg0a3IMGB6452E94bFd574d6fB7A452C7D9C1B96c
      - DB_MAX_LINK=5 # database max link
      - TOKEN_KEY=any
      - ROOT_KEY=root_key
      - FILE_TOKEN_KEY=filetoken
      # mongo 配置，不需要改. 如果连不上，可能需要去掉 ?authSource=admin
      - MONGODB_URI=mongodb://username:password@mongo:27017/fastgpt?authSource=admin
      # pg配置. 不需要改
      - PG_URL=postgresql://username:password@pg:5432/postgres
    volumes:
      - ./config.json:/app/data/config.json
networks:
  fastgpt:
# host 版本, 不推荐。
# version: '3.3'
# services:
#   pg:
#   image: ankane/pgvector:v0.5.0 # dockerhub
#   # image: registry.cn-hangzhou.aliyuncs.com/fastgpt/pgvector:v0.5.0 # 阿里云
#   container_name: pg
#   restart: always
#   ports: # 生产环境建议不要暴露
#       - 5432:5432
#   environment:
#       # 这里的配置只有首次运行生效。修改后，重启镜像是不会生效的。需要把持久化数据删除再重启，才有效果
#       - POSTGRES_USER=username
#       - POSTGRES_PASSWORD=password
#       - POSTGRES_DB=postgres
#   volumes:
#       - ./pg/data:/var/lib/postgresql/data
#   mongo:
#   image: mongo:5.0.18
#   # image: registry.cn-hangzhou.aliyuncs.com/fastgpt/mongo:5.0.18 # 阿里云
#   container_name: mongo
#   restart: always
#   ports: # 生产环境建议不要暴露
#       - 27017:27017
#   environment:
#       # 这里的配置只有首次运行生效。修改后，重启镜像是不会生效的。需要把持久化数据删除再重启，才有效果
#       - MONGO_INITDB_ROOT_USERNAME=username
#       - MONGO_INITDB_ROOT_PASSWORD=password
#   volumes:
#       - ./mongo/data:/data/db
#       - ./mongo/logs:/var/log/mongodb
#   fastgpt:
#   # image: ghcr.io/labring/fastgpt:latest # github
#   image: registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt:latest # 阿里云
#   network_mode: host
#   restart: always
#   container_name: fastgpt
#   environment:
#       # root 密码，用户名为: root
#       - DEFAULT_ROOT_PSW=1234
#       # 中转地址，如果是用官方号，不需要管
#       - OPENAI_BASE_URL=https://api.openai.com/v1
#       - CHAT_API_KEY=sk-xxxx
#       - DB_MAX_LINK=5 # database max link
#       # token加密凭证（随便填，作为登录凭证）
#       - TOKEN_KEY=any
#       # root key, 最高权限，可以内部接口互相调用
#       - ROOT_KEY=root_key
#       # mongo 配置，不需要改
#       - MONGODB_URI=mongodb://username:password@0.0.0.0:27017/fastgpt?authSource=admin
#       # pg配置. 不需要改
#       - PG_URL=postgresql://username:password@0.0.0.0:5432/postgres
</code></pre> 
<h4><a id="configjson_146"></a>修改config.json</h4> 
<pre><code>{
  "SystemParams": {
    "pluginBaseUrl": "",
    "openapiPrefix": "openapi",
    "vectorMaxProcess": 15,
    "qaMaxProcess": 15,
    "pgIvfflatProbe": 10
  },
  "ChatModels": [
    {
      "model": "ChatGLM3",
      "name": "ChatGLM3",
      "price": 0,
      "maxToken": 4000,
      "quoteMaxToken": 2000,
      "maxTemperature": 1.2,
      "censor": false,
      "defaultSystemChatPrompt": ""
    }
  ],
  "QAModels": [
    {
      "model": "ChatGLM3",
      "name": "ChatGLM3",
      "maxToken": 8000,
      "price": 0
    }
  ],
  "CQModels": [
    {
      "model": "ChatGLM3",
      "name": "ChatGLM3",
      "maxToken": 8000,
      "price": 0,
      "functionCall": true,
      "functionPrompt": ""
    }
  ],
  "ExtractModels": [
    {
      "model": "ChatGLM3",
      "name": "ChatGLM3",
      "maxToken": 8000,
      "price": 0,
      "functionCall": true,
      "functionPrompt": ""
    }
  ],
  "QGModels": [
    {
      "model": "ChatGLM3",
      "name": "ChatGLM3",
      "maxToken": 4000,
      "price": 0
    }
  ],
  "VectorModels": [
    {
      "model": "m3e-base",
      "name": "m3e-base",
      "price": 0.2,
      "defaultToken": 700,
      "maxToken": 3000
    },
    {
      "model": "m3e-base",
      "name": "m3e-base",
      "price": 0.1,
      "defaultToken": 500,
      "maxToken": 1800
    }
  ]
}
</code></pre> 
<h2><a id="_222"></a>启动容器</h2> 
<pre><code># 在 docker-compose.yml 同级目录下执行
docker-compose pull
docker-compose up -d
</code></pre> 
<h2><a id="_228"></a>效果展示</h2> 
<p><img src="https://images2.imgbox.com/f7/44/JDIBRlaP_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d95d49bdf68e26bb18a15e7a9cdd5325/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【公网远程手机Android服务器】安卓Termux搭建Web服务器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/27a7fabf28901e487665532ffc9c00a5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">神经网络实现sklearn中鸢尾花数据集的分类</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>