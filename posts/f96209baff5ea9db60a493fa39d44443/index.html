<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>FreeRTOS——软件定时器知识总结及其实战 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="FreeRTOS——软件定时器知识总结及其实战" />
<meta property="og:description" content="1.软件定时器概念 是指具有定时功能的软件，可设置定时周期，当指定时间到达后要调用回调函数（也称超时函数），用户在回调函数中处理信息。
2 软件定时器使用特点 1）如果要使能软件定时器，需将configUSE_TIMERS 配置项配置成 1
2）软件定时器支持设置成：单次定时器或周期定时器
3）软件定时器的超时回调函数是由软件定时器服务任务调用的，软件定时器的超时回调函数本身不是任务，因此不能在该回调函数中使用可能会导致任务阻塞的 API 函数。
3 软件定时器服务任务 在调用函数 vTaskStartScheduler()开启任务调度器的时候，会创建一个用于管理软件定时器的任务，这个任务就叫做软件定时器服务任务。
其作用：
1、负责软件定时器超时的逻辑判断
2、调用超时软件定时器的超时回调函数
3、处理软件定时器命令队列
4软件定时器相关配置 1）当FreeRTOS 的配置项 configUSE_TIMERS 设置为1，在启动任务调度器时，会自动创建软件定时器的服务/守护任务prvTimerTask( ) ；
2）软件定时器服务任务的优先级为 configTIMER_TASK_PRIORITY = 31；
3）定时器的命令队列长度为 configTIMER_QUEUE_LENGTH = 5 ；
注意事项：软件定时器的超时回调函数是在软件定时器服务任务中被调用的，服务任务不是专为某个定时器服务的，它还要处理其他定时器。因此调用的回调函数不能被阻塞，要求如下：
1、回调函数要尽快实行，不能进入阻塞状态，即不能调用那些会阻塞任务的 API 函数，如：vTaskDelay()
2、访问队列或者信号量的非零阻塞时间的 API 函数也不能调用。
5软件定时器的状态 休眠态：当指定时间到达之后，但因为没有运行，所以其定时超时回调函数不会被执行。
运行态：运行态的定时器，当指定时间到达之后，它的超时回调函数会被调用。
注意:
刚创建的软件定时器处于休眠态
6 软件定时器的状态转换 7 软件定时器结构体 typedef struct { const char * pcTimerName	/* 软件定时器名字 */ ListItem_t xTimerListItem	/* 软件定时器列表项 */ TickType_t xTimerPeriodInTicks; /* 软件定时器的周期 */ void * pvTimerID	/* 软件定时器的ID */ TimerCallbackFunction_t	pxCallbackFunction; /* 软件定时器的回调函数 */ #if ( configUSE_TRACE_FACILITY == 1 ) UBaseType_t uxTimerNumber	/* 软件定时器的编号，调试用 */ #endif uint8_t ucStatus; /* 软件定时器的状态 */ } xTIMER; 8软件定时器API函数 1）创建软件定时器" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f96209baff5ea9db60a493fa39d44443/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T12:00:21+08:00" />
<meta property="article:modified_time" content="2024-01-05T12:00:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">FreeRTOS——软件定时器知识总结及其实战</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1_0"></a>1.软件定时器概念</h2> 
<p>是指具有定时功能的软件，可设置定时周期，当指定时间到达后要调用回调函数（也称超时函数），用户在回调函数中处理信息。</p> 
<h2><a id="2__2"></a>2 软件定时器使用特点</h2> 
<p>1）如果要使能软件定时器，需将configUSE_TIMERS 配置项配置成 1<br> 2）软件定时器支持设置成：单次定时器或周期定时器<br> 3）软件定时器的超时回调函数是由软件定时器服务任务调用的，软件定时器的超时回调函数本身不是任务，因此不能在该回调函数中使用可能会导致任务阻塞的 API 函数。</p> 
<h2><a id="3__6"></a>3 软件定时器服务任务</h2> 
<p>在调用函数 vTaskStartScheduler()开启任务调度器的时候，会创建一个用于管理软件定时器的任务，这个任务就叫做软件定时器服务任务。<br> 其作用：<br> 1、负责软件定时器超时的逻辑判断<br> 2、调用超时软件定时器的超时回调函数<br> 3、处理软件定时器命令队列<br> <img src="https://images2.imgbox.com/55/e7/tnbWf77Q_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="4_13"></a>4软件定时器相关配置</h2> 
<p>1）当FreeRTOS 的配置项 configUSE_TIMERS 设置为1，在启动任务调度器时，会自动创建软件定时器的服务/守护任务prvTimerTask( ) ；<br> 2）软件定时器服务任务的优先级为 configTIMER_TASK_PRIORITY = 31；<br> 3）定时器的命令队列长度为 configTIMER_QUEUE_LENGTH = 5 ；</p> 
<p>注意事项：软件定时器的超时回调函数是在软件定时器服务任务中被调用的，服务任务不是专为某个定时器服务的，它还要处理其他定时器。因此调用的回调函数不能被阻塞，要求如下：<br> 1、回调函数要尽快实行，不能进入阻塞状态，即不能调用那些会阻塞任务的 API 函数，如：vTaskDelay()<br> 2、访问队列或者信号量的非零阻塞时间的 API 函数也不能调用。</p> 
<h2><a id="5_22"></a>5软件定时器的状态</h2> 
<p>休眠态：当指定时间到达之后，但因为没有运行，所以其定时超时回调函数不会被执行。<br> 运行态：运行态的定时器，当指定时间到达之后，它的超时回调函数会被调用。</p> 
<p>注意:<br> 刚创建的软件定时器处于休眠态</p> 
<h2><a id="6__29"></a>6 软件定时器的状态转换</h2> 
<p><img src="https://images2.imgbox.com/cb/2c/E1VCbZcG_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="7__31"></a>7 软件定时器结构体</h2> 
<pre><code class="prism language-c"><span class="token keyword">typedef</span>    <span class="token keyword">struct</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> 					pcTimerName		 <span class="token comment">/* 软件定时器名字 */</span>
        ListItem_t 					xTimerListItem		 <span class="token comment">/* 软件定时器列表项 */</span>
        TickType_t 					xTimerPeriodInTicks<span class="token punctuation">;</span>        	<span class="token comment">/* 软件定时器的周期 */</span>     
        <span class="token keyword">void</span> <span class="token operator">*</span> 						pvTimerID			 <span class="token comment">/* 软件定时器的ID */</span>
        TimerCallbackFunction_t	 		pxCallbackFunction<span class="token punctuation">;</span> 	<span class="token comment">/* 软件定时器的回调函数 */</span>
        <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token punctuation">(</span> configUSE_TRACE_FACILITY <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span></span></span>
         UBaseType_t 					uxTimerNumber		<span class="token comment">/*  软件定时器的编号，调试用  */</span>
        <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
        <span class="token class-name">uint8_t</span> 						ucStatus<span class="token punctuation">;</span>                     		<span class="token comment">/*  软件定时器的状态  */</span>
    <span class="token punctuation">}</span> xTIMER<span class="token punctuation">;</span>
</code></pre> 
<h2><a id="8API_46"></a>8软件定时器API函数</h2> 
<p><img src="https://images2.imgbox.com/d1/90/Bwx3sJmu_o.png" alt="在这里插入图片描述"><br> 1）创建软件定时器</p> 
<pre><code class="prism language-c">TimerHandle_t   <span class="token function">xTimerCreate</span><span class="token punctuation">(</span>    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> <span class="token keyword">const</span>   pcTimerName<span class="token punctuation">,</span>				
                                 <span class="token keyword">const</span> TickType_t 	  xTimerPeriodInTicks<span class="token punctuation">,</span>				
                                 <span class="token keyword">const</span> UBaseType_t 	    uxAutoReload<span class="token punctuation">,</span>					
                                 <span class="token keyword">void</span> <span class="token operator">*</span> <span class="token keyword">const</span> 			    pvTimerID<span class="token punctuation">,</span>				
                                TimerCallbackFunction_t     pxCallbackFunction  <span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> 
<p>形参：<br> pcTimerName ：软件定时器名<br> xTimerPeriodInTicks：定时超时时间，单位：系统时钟节拍<br> uxAutoReload：定时器模式， pdTRUE：周期定时器， pdFALSE：单次定时器<br> pvTimerID：软件定时器 ID，用于多个软件定时器公用一个超时回调函数<br> pxCallbackFunction：软件定时器超时回调函数<br> 返回值：<br> NULL 创建失败<br> 其他 返回句柄，创建成功</p> 
<p>2）开启软件定时器</p> 
<pre><code class="prism language-c">BaseType_t   <span class="token function">xTimerStart</span><span class="token punctuation">(</span> 	TimerHandle_t 	xTimer<span class="token punctuation">,</span>			
                            <span class="token keyword">const</span> TickType_t 	xTicksToWait  <span class="token punctuation">)</span><span class="token punctuation">;</span> 

</code></pre> 
<p>形参：<br> xTimer： 等待软件定时器句柄<br> xTicksToWait：发送命令到软件定时器命令队列的最大等待时间<br> 返回值：<br> pdPASS 成功<br> pdFAIL 失败</p> 
<p>3）停止软件定时器API函数</p> 
<pre><code class="prism language-c">BaseType_t   <span class="token function">xTimerStop</span><span class="token punctuation">(</span>  TimerHandle_t 	xTimer<span class="token punctuation">,</span>			
                          <span class="token keyword">const</span> TickType_t 	xTicksToWait<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>形参：<br> xTimer： 软件定时器句柄<br> xTicksToWait：发送命令到软件定时器命令队列的最大等待时间<br> 返回值：<br> pdPASS 成功<br> pdFAIL 失败</p> 
<p>4）复位软件定时器</p> 
<pre><code class="prism language-c">BaseType_t  <span class="token function">xTimerReset</span><span class="token punctuation">(</span> TimerHandle_t 	xTimer<span class="token punctuation">,</span>				
                         <span class="token keyword">const</span> TickType_t 	xTicksToWait<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>形参：<br> xTimer： 软件定时器句柄<br> xTicksToWait：发送命令到软件定时器命令队列的最大等待时间<br> 返回值：<br> pdPASS 成功<br> pdFAIL 失败<br> 注意：该功能将使软件定时器的重新开启定时，复位后的软件定时器以复位时的时刻作为开启时刻重新定时</p> 
<p>5）更改软件定时器超时时间</p> 
<pre><code class="prism language-c">BaseType_t  <span class="token function">xTimerChangePeriod</span><span class="token punctuation">(</span> TimerHandle_t 		xTimer<span class="token punctuation">,</span>	
                                <span class="token keyword">const</span> TickType_t 	xNewPeriod<span class="token punctuation">,</span> 
                                <span class="token keyword">const</span> TickType_t 	xTicksToWait<span class="token punctuation">)</span><span class="token punctuation">;</span> 				                                                                                              	          
</code></pre> 
<p>形参：<br> xTimer： 软件定时器句柄<br> xNewPeriod： 新的定时超时时间，单位：系统时钟节拍<br> xTicksToWait：发送命令到软件定时器命令队列的最大等待时间<br> 返回值：<br> pdPASS 成功<br> pdFAIL 失败</p> 
<h2><a id="8_120"></a>8软件定时器实战</h2> 
<p><img src="https://images2.imgbox.com/d6/3f/fGoqDW0A_o.png" alt="在这里插入图片描述"><br> 代码：</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"freertos_demo.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"./BSP/LCD/lcd.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"./BSP/KEY/key.h"</span></span>
<span class="token comment">/*FreeRTOS*********************************************************************************************/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"FreeRTOS.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"task.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"timers.h"</span></span>

<span class="token comment">/******************************************************************************************************/</span>
<span class="token comment">/*FreeRTOS配置*/</span>

<span class="token comment">/* START_TASK 任务 配置
 * 包括: 任务句柄 任务优先级 堆栈大小 创建任务
 */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">START_TASK_PRIO</span> <span class="token expression"><span class="token number">1</span>                   </span><span class="token comment">/* 任务优先级 */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">START_STK_SIZE</span>  <span class="token expression"><span class="token number">128</span>                 </span><span class="token comment">/* 任务堆栈大小 */</span></span>
TaskHandle_t            StartTask_Handler<span class="token punctuation">;</span>  <span class="token comment">/* 任务句柄 */</span>
<span class="token keyword">void</span> <span class="token function">start_task</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>pvParameters<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 任务函数 */</span>

<span class="token comment">/* TASK1 任务 配置
 * 包括: 任务句柄 任务优先级 堆栈大小 创建任务
 */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK1_PRIO</span>      <span class="token expression"><span class="token number">2</span>                   </span><span class="token comment">/* 任务优先级 */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK1_STK_SIZE</span>  <span class="token expression"><span class="token number">128</span>                 </span><span class="token comment">/* 任务堆栈大小 */</span></span>
TaskHandle_t            Task1Task_Handler<span class="token punctuation">;</span>  <span class="token comment">/* 任务句柄 */</span>
<span class="token keyword">void</span> <span class="token function">task1</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>pvParameters<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">/* 任务函数 */</span>

<span class="token comment">//定义定时器回调函数、与定时器句柄</span>
TimerHandle_t timer1_handle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment">//单次定时器</span>
TimerHandle_t timer2_handle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment">//周期定时器</span>

<span class="token keyword">void</span> <span class="token function">timer1_callback</span><span class="token punctuation">(</span>TimerHandle_t pxTimer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">timer2_callback</span><span class="token punctuation">(</span>TimerHandle_t pxTimer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @brief       FreeRTOS例程入口函数
 * @param       无
 * @retval      无
 */</span>
<span class="token keyword">void</span> <span class="token function">freertos_demo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>    
    <span class="token function">xTaskCreate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>TaskFunction_t <span class="token punctuation">)</span>start_task<span class="token punctuation">,</span>            <span class="token comment">/* 任务函数 */</span>
                <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span>    <span class="token punctuation">)</span><span class="token string">"start_task"</span><span class="token punctuation">,</span>          <span class="token comment">/* 任务名称 */</span>
                <span class="token punctuation">(</span><span class="token class-name">uint16_t</span>       <span class="token punctuation">)</span>START_STK_SIZE<span class="token punctuation">,</span>        <span class="token comment">/* 任务堆栈大小 */</span>
                <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span>          <span class="token punctuation">)</span><span class="token constant">NULL</span><span class="token punctuation">,</span>                  <span class="token comment">/* 传入给任务函数的参数 */</span>
                <span class="token punctuation">(</span>UBaseType_t    <span class="token punctuation">)</span>START_TASK_PRIO<span class="token punctuation">,</span>       <span class="token comment">/* 任务优先级 */</span>
                <span class="token punctuation">(</span>TaskHandle_t<span class="token operator">*</span>  <span class="token punctuation">)</span><span class="token operator">&amp;</span>StartTask_Handler<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">/* 任务句柄 */</span>
    <span class="token function">vTaskStartScheduler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @brief       start_task
 * @param       pvParameters : 传入参数(未用到)
 * @retval      无
 */</span>
<span class="token keyword">void</span> <span class="token function">start_task</span><span class="token punctuation">(</span> <span class="token keyword">void</span> <span class="token operator">*</span> pvParameters <span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">taskENTER_CRITICAL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">/* 进入临界区 */</span>
    
    <span class="token comment">// 定时器1创建为单次定时器 </span>
    timer1_handle <span class="token operator">=</span> <span class="token function">xTimerCreate</span><span class="token punctuation">(</span><span class="token string">"timer1"</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> pdFALSE<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">1</span><span class="token punctuation">,</span> timer1_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    
    <span class="token comment">// 定时器2创建为周期定时器 </span>
    timer2_handle <span class="token operator">=</span> <span class="token function">xTimerCreate</span><span class="token punctuation">(</span> <span class="token string">"timer2"</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span>pdTRUE<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">2</span><span class="token punctuation">,</span> timer2_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    
    <span class="token function">xTaskCreate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>TaskFunction_t         <span class="token punctuation">)</span>   task1<span class="token punctuation">,</span>
                <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>                 <span class="token punctuation">)</span>   <span class="token string">"task1"</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span>configSTACK_DEPTH_TYPE <span class="token punctuation">)</span>   TASK1_STK_SIZE<span class="token punctuation">,</span>
                <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>                 <span class="token punctuation">)</span>   <span class="token constant">NULL</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span>UBaseType_t            <span class="token punctuation">)</span>   TASK1_PRIO<span class="token punctuation">,</span>
                <span class="token punctuation">(</span>TaskHandle_t <span class="token operator">*</span>         <span class="token punctuation">)</span>   <span class="token operator">&amp;</span>Task1Task_Handler <span class="token punctuation">)</span><span class="token punctuation">;</span>
                                             
    <span class="token function">vTaskDelete</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">taskEXIT_CRITICAL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">/* 退出临界区 */</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @brief       task1
 * @param       pvParameters : 传入参数(未用到)
 * @retval      无
 */</span>
<span class="token comment">//任务一、按键扫描并控制软件定时器</span>
<span class="token keyword">void</span> <span class="token function">task1</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>pvParameters<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">uint8_t</span> key <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        key <span class="token operator">=</span> <span class="token function">key_scan</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">==</span> KEY0_PRES<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>

            <span class="token function">xTimerStart</span><span class="token punctuation">(</span>timer1_handle<span class="token punctuation">,</span>portMAX_DELAY<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">xTimerStart</span><span class="token punctuation">(</span>timer2_handle<span class="token punctuation">,</span>portMAX_DELAY<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">==</span> KEY1_PRES<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">xTimerStop</span><span class="token punctuation">(</span>timer1_handle<span class="token punctuation">,</span>portMAX_DELAY<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">xTimerStop</span><span class="token punctuation">(</span>timer2_handle<span class="token punctuation">,</span>portMAX_DELAY<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">vTaskDelay</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @brief       Timer1超时回调函数
 * @param       xTimer : 传入参数(未用到)
 * @retval      无
 */</span>
<span class="token comment">//timer1的超时回调函数</span>
<span class="token keyword">void</span> <span class="token function">timer1_callback</span><span class="token punctuation">(</span>TimerHandle_t pxTimer<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token class-name">uint32_t</span> timer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"timer1的运行次数：%d\r\n"</span><span class="token punctuation">,</span><span class="token operator">++</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @brief       Timer2超时回调函数
 * @param       xTimer : 传入参数(未用到)
 * @retval      无
 */</span>
<span class="token keyword">void</span> <span class="token function">timer2_callback</span><span class="token punctuation">(</span>TimerHandle_t pxTimer<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
     <span class="token keyword">static</span> <span class="token class-name">uint32_t</span> timer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"timer2的运行次数：%d\r\n"</span><span class="token punctuation">,</span><span class="token operator">++</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/843d84e7a1a364eec010d004c8b94577/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于albert的汽车评论情感分析【含代码】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/726fdb57d9c5b58ed48094baacca44ee/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">分享一份适合单片机工程师的嵌入式 Linux 学习计划！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>