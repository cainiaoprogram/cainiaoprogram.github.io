<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>rootkit检测、病毒查杀、webshell检测 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="rootkit检测、病毒查杀、webshell检测" />
<meta property="og:description" content="一、chkrootkit
1、下载rootkit
wget ftp://ftp.pangeia.com.br/pub/seg/pac/chkrootkit.tar.gz
2、安装
tar xf chkrootkit.tar.gz
3、使用
cd chkrootkit-0.52/
./chkrootkit |grep INFECTED 没有出现INFECTED说明系统没有问题
二、rkhunter
1、下载rkhunter
wget http://jaist.dl.sourceforge.net/project/rkhunter/rkhunter/1.4.2/rkhunter-1.4.2.tar.gz 最新版本去官网下载
2、安装
./installer.sh --install
3、使用
rkhunter --update 扫描之前最好更新病毒库
rkhunter -c --sh
yum install rkhunter -y
安装后就可以使用rkhunter命令了，下面列出有用的参数：
–checkall (-c) #全系统检测，rkhunter的所有检测项目;
–createlogfile #建立登录档，一般预设放在/var/log/rkhunter.log;
–skip-keypress #忽略按键后继续的举动(程序会持续自动执行);
–versioncheck #检测试否有新的版本在服务器上;
接下来运行rkhunter --checkall，连续敲击回车，数分钟后得到报表，如图：
rkhunter --checkall
我们从分析报告可以看出，Rkhunter怀疑被篡改的文件有9个，怀疑rootkits有3个，具体再去/var/log/rkhunter/rkhunter.log中查看。
如果您不想要每个部分都以 Enter 来继续，想要让程序自动持续执行，可以使用：
rkhunter --check --sk
Rkhunter拥有并维护着一个包含rootkit特征的数据库，然后它根据此数据库来检测系统中的rootkits，所以可以对此数据库进行升级，rkhunter –update
rkhunter --update
那么简单来讲，RKhunter就像我们的杀毒软件，有着自己的病毒数据库，对每一个重点命令进行比对，当发现了可疑代码则会提示用户。
三、Clamav 病毒查杀
1、zlib依赖包安装
wget http://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.7/zlib-1.2.7.tar.gz
tar zxvf zlib-1.2.7.tar.gz
cd zlib-1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/5bc9d4231ff61808383f798df480825a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-08T14:41:46+08:00" />
<meta property="article:modified_time" content="2022-03-08T14:41:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">rootkit检测、病毒查杀、webshell检测</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>一、chkrootkit<br> 1、下载rootkit<br> wget ftp://ftp.pangeia.com.br/pub/seg/pac/chkrootkit.tar.gz<br> 2、安装<br> tar xf chkrootkit.tar.gz<br> 3、使用<br> cd chkrootkit-0.52/<br> ./chkrootkit |grep INFECTED 没有出现INFECTED说明系统没有问题</p> 
<p>二、rkhunter<br> 1、下载rkhunter<br> wget http://jaist.dl.sourceforge.net/project/rkhunter/rkhunter/1.4.2/rkhunter-1.4.2.tar.gz 最新版本去官网下载<br> 2、安装<br> ./installer.sh --install<br> 3、使用<br> rkhunter --update 扫描之前最好更新病毒库<br> rkhunter -c --sh</p> 
<p>yum install rkhunter -y<br> 安装后就可以使用rkhunter命令了，下面列出有用的参数：<br> –checkall (-c) #全系统检测，rkhunter的所有检测项目;<br> –createlogfile #建立登录档，一般预设放在/var/log/rkhunter.log;<br> –skip-keypress #忽略按键后继续的举动(程序会持续自动执行);<br> –versioncheck #检测试否有新的版本在服务器上;<br> 接下来运行rkhunter --checkall，连续敲击回车，数分钟后得到报表，如图：<br> rkhunter --checkall</p> 
<p>我们从分析报告可以看出，Rkhunter怀疑被篡改的文件有9个，怀疑rootkits有3个，具体再去/var/log/rkhunter/rkhunter.log中查看。<br> 如果您不想要每个部分都以 Enter 来继续，想要让程序自动持续执行，可以使用：<br> rkhunter --check --sk<br> <img src="https://images2.imgbox.com/52/54/e5VAFHgt_o.png" alt="在这里插入图片描述"><br> Rkhunter拥有并维护着一个包含rootkit特征的数据库，然后它根据此数据库来检测系统中的rootkits，所以可以对此数据库进行升级，rkhunter –update<br> rkhunter --update<br> 那么简单来讲，RKhunter就像我们的杀毒软件，有着自己的病毒数据库，对每一个重点命令进行比对，当发现了可疑代码则会提示用户。</p> 
<p>三、Clamav 病毒查杀<br> 1、zlib依赖包安装<br> wget http://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.7/zlib-1.2.7.tar.gz<br> tar zxvf zlib-1.2.7.tar.gz<br> cd zlib-1.2.7<br> CFLAGS="-O3 -fPIC" ./configure --prefix=<br> /usr/local/zlib/<br> make &amp;&amp; make make install<br> groupadd clamav<br> useradd -g clamav -s /bin/false<br> 3、clamav安装<br> ClamAV的官方下载地址为http://www.clamav.net/download.html<br> mkdir /opt/clamav/logs<br> mkdir /opt/clamav/updata<br> chown clamav.clamav clamd.log<br> chown clamav.clamav freshclam.log<br> vim /opt/clamav<br> vim /opt/clamav/etc/clam.conf 注释第八行</p> 
<p>/opt/clamac/bin/freshclam 更新病毒库</p> 
<p>yum安装</p> 
<p>yum install -y clamav<br> freshclam 更新病毒库<br> clamscan -r / --bell -i 扫描所有文件并显示有问题文件的结果<br> clamscan -r / 扫面素有文件并显示所有文件的扫面结果<br> clamsacn -r --remove / 扫面并清除<br> clamscan [选项] [路径] [文件]<br> –quiet 使用安静模式，仅仅打印出错误信息<br> -i 仅仅打印被感染的文件<br> -d&lt;文件&gt; 以指定的文件作为病毒库，一代替默认的/var/clamav目录下的病毒库文件<br> -l &lt;文件&gt; 指定日志文件，以代替默认的/var/log/clamav/freshclam.log文件<br> -r 递归扫描，即扫描指定目录下的子目录<br> –move=&lt;目录&gt; 把感染病毒的文件移动到指定目录<br> –remove 删除感染病毒的文件<br> 扫描方法</p> 
<p>clamscan -r /etc --max-dir-recursion=5 -l /root/etcclamav.log<br> clamscan -r /bin --max-dir-recursion=5 -l /root/binclamav.log<br> clamscan -r /usr --max-dir-recursion=5 -l /root/usrclamav.log<br> clamscan -r --remove /bin/<br> clamscan -r --remove /usr/bin/</p> 
<p>查看日志发现<br> grep FOUND /root/etcclamav.log<br> 有FOUND为病毒</p> 
<p>四、河马webshell<br> 1、下载<br> 官网：http://www.shellpub.com<br> 2、安装<br> wget -O hm-linux.tgz http://down.shellpub.com/hm/latest/hm-linux-amd64.tgz?version=1.5.0<br> tar xvf hm0linux.tgz<br> ./hm update<br> ./hm scan / 扫描根目录 一般只扫面web目录<br> cat result.csv 扫面结果</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cc683b726c504e45d98e78cbee4557b2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux如何查看一个文件最近被修改和访问的时间</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7ce491d356b4c427581fc03d5567dcaa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于主机Overlay和自研虚拟化网关的VPC在360的落地</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>