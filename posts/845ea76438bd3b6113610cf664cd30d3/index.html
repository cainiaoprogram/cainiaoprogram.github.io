<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>为什么神经网络会出现梯度消失和梯度爆炸？ - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="为什么神经网络会出现梯度消失和梯度爆炸？" />
<meta property="og:description" content="点击蓝字“视学算法”关注我哟
加个“星标★”，每日好文必达
文末包邮送5本技术书给老读者
阿广 · 家里蹲大学幼儿组编程赛参与奖
我们知道深度神经网络中一个非常关键的问题是如何解决梯度消失和梯度爆炸。当我们看完深度神经网络之后，很多朋友不乏对梯度消失和梯度爆炸一头雾水、一知半解。所以阿广今天给大家彻底的讲一下神经网络中梯度消失和梯度爆炸。
举个例子：下面是一个输入层，三个隐藏层，一个输出层的简单神经网络。
如上图所示的神经网络，误差对b1的求导如下：
其中
我们假设激活函数使用的是sigmoid函数，如下图：
而sigmoid函数的导数最大值为0.25，如下图所示：
通常abs(w)&lt;1，所以可以得到下面的式子：
从上式中不难看出，随着网络层数加大，从前面的层传递到后面的层梯度会越来越小，进而引起了梯度消失的问题。
那么到底什么是梯度爆炸呢？
我们可以看到上式中，sigmoid的导数最大值为0.25，而只有我们的权重持续符合abs(w)&gt;4的时候，才会出现梯度爆炸的问题。
梯度消失和爆炸哪个更容易出现呢？
我们在日常实验或者科研项目中权重的设置基本上都是abs(w)&lt;4，所以梯度消失更普遍。
既然发现了梯度消失和梯度爆炸的问题，那么应该如何解决呢？
1、更换激活函数，使用ReLU或者Maxout等激活函数替代sigmoid；
2、例如ResNet中的残差网络（使用参数隔层传递），也可以有效的防止梯度消失的问题；
3、使用Dropout策略；
4、使用BatchNormlization对各层输入统一；
5、调整学习率；
6、调整权重衰减率；
7、调整网络结构（例如残差网络等）；
8、等待各位开发。
加个“星标★”，欢迎留言！
阿广 · 一个会讲段子的科学探索者
如果有收获，欢迎转发给身边的朋友，也是对阿广最大的支持，后续会更新计算机视觉和深度学习、机器学习数学基础等系列文章，希望得到大家的支持和鼓励！
如果不出什么意外情况，每周包邮送五本书给留言阅读最多和分享最多的老粉丝。本周中奖名单如下（详细中奖名单请看次条文章，中奖者请联系微信：872561826，并使用一条信息发给我所有信息：邮寄信息&#43;想要哪本书）：
PS：特别感谢北京大学出版社的赞助，下面部分图书参与了京东五折活动，欢迎购买。
麻烦给我一个在看！" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/845ea76438bd3b6113610cf664cd30d3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-18T14:03:00+08:00" />
<meta property="article:modified_time" content="2020-03-18T14:03:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">为什么神经网络会出现梯度消失和梯度爆炸？</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p style="text-align: center">点击蓝字“<strong>视学算法</strong>”关注我哟</p> 
 <p style="text-align: center">加个“星标<strong><strong>★</strong></strong>”，每日好文必达</p> 
 <p style="text-align: center"><strong>文末包邮送5本技术书给老读者</strong><strong></strong></p> 
 <p style="text-align: center"><strong>阿广</strong><strong> · 家里蹲大学幼儿组编程赛参与奖</strong></p> 
 <p style="text-align: justify">我们知道深度神经网络中一个非常关键的问题是如何解决梯度消失和梯度爆炸。当我们看完深度神经网络之后，很多朋友不乏对梯度消失和梯度爆炸一头雾水、一知半解。所以阿广今天给大家彻底的讲一下神经网络中梯度消失和梯度爆炸。<br></p> 
 <p style="text-align: justify">举个例子：下面是<strong>一个输入层，三个隐藏层，一个输出层</strong>的简单神经网络。</p> 
 <p style="text-align: justify"><img src="https://images2.imgbox.com/d0/08/DG9PyPsk_o.png"></p> 
 <p style="text-align: justify">如上图所示的神经网络，误差对b1的求导如下：<br></p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/8b/1a/0vifQuQy_o.png"></p> 
 <p style="text-align: justify">其中</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/0d/69/Xf2m3gXT_o.png"></p> 
 <p style="text-align: justify">我们假设激活函数使用的是sigmoid函数，如下图：<br></p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/b2/13/NI7UJf9M_o.png"></p> 
 <p style="text-align: justify">而<strong>sigmoid函数的导数最大值为</strong><strong>0.25</strong>，如下图所示：<br></p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/4f/68/Zcv0Twib_o.png"></p> 
 <p style="text-align: justify">通常<strong>abs(w)&lt;1</strong>，所以可以得到下面的式子：</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/b1/9c/u48fEUri_o.png"></p> 
 <p style="text-align: justify">从上式中不难看出，<strong>随着网络层数加大，从前面的层传递到后面的层梯度会越来越小，进而引起了梯度消失的问题。</strong></p> 
 <p>那么到底什么是梯度爆炸呢？</p> 
 <p style="text-align: justify">我们可以看到上式中，<strong>sigmoid的导数最大值为0.25</strong>，而只有我们的<strong>权重持续符合abs(w)&gt;4</strong>的时候，<strong>才会出现梯度爆炸的问题。</strong></p> 
 <p>梯度消失和爆炸哪个更容易出现呢？</p> 
 <p style="text-align: justify">我们在日常实验或者科研项目中权重的设置基本上都是<strong>abs(w)&lt;4</strong>，所以梯度消失更普遍。<br></p> 
 <p style="text-align: justify">既然发现了梯度消失和梯度爆炸的问题，<strong>那么应该如何解决呢？</strong></p> 
 <p>1、更换激活函数，使用ReLU或者Maxout等激活函数替代sigmoid；</p> 
 <p>2、例如ResNet中的残差网络（使用参数隔层传递），也可以有效的防止梯度消失的问题；</p> 
 <p>3、使用Dropout策略；</p> 
 <p>4、使用BatchNormlization对各层输入统一；</p> 
 <p>5、调整学习率；</p> 
 <p>6、调整权重衰减率；</p> 
 <p>7、调整网络结构（例如残差网络等）；</p> 
 <p>8、等待各位开发。</p> 
 <p style="text-align: center">加个“星标<strong><strong>★</strong></strong>”，欢迎留言！</p> 
 <p style="text-align: center"><strong>阿广</strong><strong> · </strong><strong>一个会讲段子的科学探索者</strong></p> 
 <p>如果有收获，欢迎转发给身边的朋友，也是对阿广最大的支持，后续会更新计算机视觉和深度学习、机器学习数学基础等系列文章，希望得到大家的支持和鼓励！</p> 
 <p>如果不出什么意外情况，<strong>每周包邮</strong>送<strong>五本书</strong>给<strong>留言阅读最多</strong>和<strong>分享最多</strong>的<strong>老粉丝。</strong>本周中奖名单如下（<strong>详细中奖名单请看次条文章</strong>，中奖者请联系微信：<strong>872561826</strong>，并<strong>使用一条信息</strong>发给我所有信息：<strong>邮寄信息+想要哪本书</strong>）：</p> 
 <p><strong>PS：<strong>特别感谢<strong>北京大学出版社</strong>的</strong></strong><strong>赞助，下面部分图书参与了京东五折活动，欢迎购买。</strong></p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/b9/df/A9XwH7kw_o.png"></p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/6b/5c/USRs1R6u_o.png"></p> 
 <p><strong></strong><img src="https://images2.imgbox.com/f1/6e/CTdEfQOq_o.png"></p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/8d/13/dztCkiy1_o.png"><br></p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/56/36/uIQzWaAf_o.png"></p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/8b/af/k0N6txG3_o.png"></p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/b2/f8/x3eWZE6E_o.png"></p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/5e/f5/SLqQZM7q_o.png"></p> 
 <p style="text-align: right"><strong>麻烦给我一个在看！</strong></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8eae8da15fa9986cdf6205a557a4515c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue项目PC端扫码授权绑定公众号</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a5030b96e7802d19e5079c4232fe6e77/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">error Failed to build iOS project. We ran &#34;xcodebuild&#34; command but it exited with error code 65.- RN</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>