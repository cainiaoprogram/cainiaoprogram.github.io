<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C&#43;&#43;qt-信号-信号槽 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C&#43;&#43;qt-信号-信号槽" />
<meta property="og:description" content="1、概念 信号和槽是两种函数，这是Qt在C&#43;&#43;基础上新增的特性，类似于其他技术中的回调的概念。
信号和槽通过程序员提前设定的“约定”，可以实现对象之间的通信，有两个先决的条件：
通信的对象必须都是从QObject类中派生出来的。类中要有Q_OBJECT宏。 2、函数原型 信号槽需要在使用前进行“约定”，这个约定被称为连接。
【例子】：如果金龙考试考了100分，新宇请金龙吃饭。
// 参数1：const QObject * sender 发射者，表示因发起对象 // 参数2：const char * signal信号函数，表示因的发起动作，使用SIGNAL()包裹。 // 参数3：const QObject * receiver 接收者，表示果的发起对象 // 参数4：const char * method 槽函数，表示果发起的动作，请吃饭，SLOT()包裹。 QObject:: connect(const QObject * sender, const char * signal, const QObject * receiver, const char * method)[static] 3、实现 为了学习，把信号槽分为三种实现方式。
自带信号 -&gt; 自带槽自带信号 -&gt; 自定义槽自定义信号 3.1 自带信号-&gt;自带槽 这种连接方式是最简单的，因为信号函数和槽函数都是Qt内置的，只需要在文档中查询出函数后，使用connect函数连接即可。
查找函数 F1F1 查找手册 查找函数：在对应的QPushButton Class基类继承自（QAbstractButton）类，查找自带槽（Public Slots），找到对应槽函数（click），
// 按钮按下后时发射的信号 void QAbstractButton:: clicked(bool checked = false)[signal] 查询函数：在对应的Widget基类查找自带槽（Public Slots），找到对应槽函数（close），" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/fb53dec7c7004194f2b3c2e96610251d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-09T16:30:07+08:00" />
<meta property="article:modified_time" content="2024-01-09T16:30:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C&#43;&#43;qt-信号-信号槽</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2><strong><span style="color:#1a1a1a;">1、概念</span></strong></h2> 
<div> 
 <div> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">信号和槽是两种函数，这是Qt在C++基础上新增的特性，类似于其他技术中的回调的概念。</span></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">信号和槽通过程序员提前设定的“约定”，可以实现对象之间的通信，有两个先决的条件：</span></p> 
  <ul><li style="text-align:left;"><span style="color:#333333;">通信的对象必须都是从QObject类中派生出来的。</span></li><li style="text-align:left;"><span style="color:#333333;">类中要有Q_OBJECT宏。</span></li><li style="text-align:left;"> <h2>2、<strong><span style="color:#1a1a1a;">函数原型</span></strong></h2> </li></ul> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">信号槽需要在使用前进行“约定”，这个约定被称为连接。</span></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">【例子】：如果金龙考试考了100分，新宇请金龙吃饭。</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#708090;">// 参数1：</span><span style="color:#000000;">const QObject * sender</span> <span style="color:#708090;">发射者，表示因发起对象</span>
<span style="color:#708090;">// 参数2：</span><span style="color:#000000;">const char * signal</span><span style="color:#708090;">信号函数，表示因的发起动作，使用SIGNAL()包裹。</span>
<span style="color:#708090;">// 参数3：</span><span style="color:#000000;">const QObject * receiver</span> <span style="color:#708090;">接收者，表示果的发起对象</span>
<span style="color:#708090;">// 参数4：</span><span style="color:#000000;">const char * method</span> <span style="color:#708090;">槽函数，表示果发起的动作，请吃饭，SLOT()包裹。</span>
<span style="color:#dd4a68;">QObject</span><span style="color:#999999;">::</span> <span style="color:#dd4a68;">connect</span><span style="color:#999999;">(</span><span style="color:#0077aa;">const</span> <span style="color:#dd4a68;">QObject</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;"> sender</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">const</span> <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;"> signal</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">const</span> <span style="color:#dd4a68;">QObject</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;"> receiver</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">const</span> <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;"> method</span><span style="color:#999999;">)[</span><span style="color:#0077aa;">static</span><span style="color:#999999;">]</span>
</code></span></pre> 
  <h2><strong><span style="color:#1a1a1a;">3、实现</span></strong></h2> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">为了学习，把信号槽分为三种实现方式。</span></p> 
  <ul><li style="text-align:left;"><span style="color:#333333;">自带信号 -&gt; 自带槽</span></li><li style="text-align:left;"><span style="color:#333333;">自带信号 -&gt; 自定义槽</span></li><li style="text-align:left;"><span style="color:#333333;">自定义信号</span></li></ul> 
  <p style="margin-left:0;text-align:left;"></p> 
  <h3 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">3.1 自带信号-&gt;自带槽</span></strong></h3> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">这种连接方式是最简单的，因为信号函数和槽函数都是Qt内置的，只需要在文档中查询出函数后，使用connect函数连接即可。</span></p> 
  <h4 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">查找函数 F1F1 查找手册</span></strong></h4> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">查找函数：在对应的</span><span style="color:#333333;">QPushButton Class</span><span style="color:#333333;">基类继承自</span><span style="color:#333333;">（QAbstractButton）类，</span><span style="color:#333333;">查找自带槽（</span><span style="color:#333333;">Public Slots</span><span style="color:#333333;">），找到对应槽函数（click），</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#708090;">// 按钮按下后时发射的信号</span>
<span style="color:#000000;">void </span><span style="color:#dd4a68;">QAbstractButton</span><span style="color:#999999;">::</span> <span style="color:#dd4a68;">clicked</span><span style="color:#999999;">(</span><span style="color:#0077aa;">bool</span><span style="color:#000000;"> checked </span><span style="color:#9a6e3a;">=</span> <span style="color:#990055;">false</span><span style="color:#999999;">)[</span><span style="color:#000000;">signal</span><span style="color:#999999;">]</span>
</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">查询函数：在对应的Widget基类查找自带槽（</span><span style="color:#333333;">Public Slots</span><span style="color:#333333;">），找到对应槽函数（close），</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#708090;">// 关闭 槽函数</span>
<span style="color:#0077aa;">bool</span> <span style="color:#dd4a68;">QWidget</span><span style="color:#999999;">::</span> <span style="color:#dd4a68;">close</span><span style="color:#999999;">()</span>
</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.h</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#ifndef </span><span style="color:#990055;">DIALOG_H</span>
<span style="color:#000000;">#define </span><span style="color:#990055;">DIALOG_H</span>

<span style="color:#000000;">#include </span><span style="color:#9a6e3a;">&lt;</span><span style="color:#dd4a68;">QDialog</span><span style="color:#9a6e3a;">&gt;</span>
<span style="color:#000000;">#include </span><span style="color:#9a6e3a;">&lt;</span><span style="color:#dd4a68;">QDebug</span><span style="color:#9a6e3a;">&gt;</span>
<span style="color:#000000;">#include </span><span style="color:#9a6e3a;">&lt;</span><span style="color:#dd4a68;">QPushButton</span><span style="color:#9a6e3a;">&gt;</span>


<span style="color:#000000;">class </span><span style="color:#dd4a68;">Dialog</span> <span style="color:#999999;">:</span><span style="color:#000000;"> public </span><span style="color:#dd4a68;">QDialog</span>
<span style="color:#999999;">{<!-- --></span>
    <span style="color:#990055;">Q_OBJECT</span>

<span style="color:#000000;">public</span><span style="color:#999999;">:</span>
    <span style="color:#dd4a68;">Dialog</span><span style="color:#999999;">(</span><span style="color:#dd4a68;">QWidget</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">parent </span><span style="color:#9a6e3a;">=</span> <span style="color:#990055;">0</span><span style="color:#999999;">);</span>
<span style="color:#000000;">    ~</span><span style="color:#dd4a68;">Dialog</span><span style="color:#999999;">();</span>
    <span style="color:#dd4a68;">QPushButton</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">btn</span><span style="color:#999999;">;</span>   <span style="color:#708090;">// 成员变量</span>
<span style="color:#999999;">};</span>

<span style="color:#000000;">#endif </span><span style="color:#708090;">// DIALOG_H</span>

</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.cpp</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#include </span><span style="color:#669900;">"dialog.h"</span>
<span style="color:#dd4a68;">Dialog</span><span style="color:#999999;">::</span><span style="color:#dd4a68;">Dialog</span><span style="color:#999999;">(</span><span style="color:#dd4a68;">QWidget</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">parent</span><span style="color:#999999;">)</span>
    <span style="color:#999999;">:</span> <span style="color:#dd4a68;">QDialog</span><span style="color:#999999;">(</span><span style="color:#000000;">parent</span><span style="color:#999999;">)</span>
<span style="color:#999999;">{<!-- --></span>
    <span style="color:#708090;">//设置窗口的宽高</span>
    <span style="color:#dd4a68;">resize</span><span style="color:#999999;">(</span><span style="color:#990055;">500</span><span style="color:#999999;">,</span><span style="color:#990055;">500</span><span style="color:#999999;">);</span>
<span style="color:#000000;">    btn </span><span style="color:#9a6e3a;">=</span><span style="color:#000000;"> new </span><span style="color:#dd4a68;">QPushButton</span><span style="color:#999999;">(</span><span style="color:#669900;">"关闭"</span><span style="color:#999999;">,</span><span style="color:#000000;">this</span><span style="color:#999999;">);</span>
    <span style="color:#708090;">// 设置按钮的位置</span>
<span style="color:#000000;">    btn</span><span style="color:#999999;">-&gt;</span><span style="color:#0077aa;">move</span><span style="color:#999999;">(</span><span style="color:#990055;">200</span><span style="color:#999999;">,</span><span style="color:#990055;">250</span><span style="color:#999999;">);</span>
    <span style="color:#708090;">//but 发起者、SIGNAL()包裹发起动作：点击、this 接收者、SLOT(close()) 接收结果 close关闭窗口</span>
    <span style="color:#dd4a68;">connect</span><span style="color:#999999;">(</span><span style="color:#000000;">btn</span><span style="color:#999999;">,</span><span style="color:#990055;">SIGNAL</span><span style="color:#999999;">(</span><span style="color:#dd4a68;">clicked</span><span style="color:#999999;">()),</span><span style="color:#000000;">this</span><span style="color:#999999;">,</span><span style="color:#990055;">SLOT</span><span style="color:#999999;">(</span><span style="color:#dd4a68;">close</span><span style="color:#999999;">()));</span>
<span style="color:#999999;">}</span>
<span style="color:#dd4a68;">Dialog</span><span style="color:#999999;">::</span><span style="color:#000000;">~</span><span style="color:#dd4a68;">Dialog</span><span style="color:#999999;">()</span>
<span style="color:#999999;">{<!-- --></span>
    <span style="color:#708090;">// C++内存回收</span>
<span style="color:#000000;">    delete btn</span><span style="color:#999999;">;</span>
<span style="color:#999999;">}</span>
</code></span></pre> 
  <p></p> 
  <h3 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">3.2 自带信号-&gt;自定义槽</span></strong></h3> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">Qt不可能内置所有执行的动作代码，特别是一些复杂的操作，需要开发者手动编写槽函数。这种方式也是所有连接方式中使用最多的。</span></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">槽函数时一个特殊的成员函数，在声明的时候权限的作用主要是修饰其作为普通成员函数的使用效果，不影响信号槽的连接效果。</span></p> 
  <p style="margin-left:0;text-align:left;"><img alt="" height="79" src="https://images2.imgbox.com/a8/43/GNfHzfFb_o.png" width="255"></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">【例子】：点击按钮，向右边和下面移动窗口10个像素。同时输出当前窗口的坐标。</span></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.h</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#ifndef DIALOG_H</span>
<span style="color:#000000;">#define DIALOG_H</span>
<span style="color:#000000;">// 添加头文件QDialog对话框基类，Qt自带类型通常使用Q开头</span>
<span style="color:#000000;">#include &lt;QDialog&gt;</span>
<span style="color:#000000;">#include &lt;QDebug&gt;</span>
<span style="color:#000000;">#include &lt;QPushButton&gt;</span>
<span style="color:#000000;">// 自定义对话框类</span>
<span style="color:#000000;">// 继承于QDialog类</span>
<span style="color:#000000;">class Dialog : public QDialog</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    // </span><span style="color:#708090;">是一个宏是必要条件：一个标准，有这个宏才可以用connect链接</span>
<span style="color:#000000;">    Q_OBJECT</span>
<span style="color:#000000;">public:</span>
<span style="color:#000000;">    Dialog(QWidget *parent = 0);    // 构造函数</span>
<span style="color:#000000;">    ~Dialog();      // 析构函数</span>
<span style="color:#000000;">    QPushButton *btn;   // 成员变量</span>
<span style="color:#000000;">    //声明自定义槽函数</span>
<span style="color:#000000;">private slots://最小权限法则，能使用私有权限就是用私有</span><span style="color:#000000;">（固定写法：表示声明的是一个槽函数，connect连接时才能找到该槽函数）</span>
<span style="color:#000000;">    void mySlot();//小驼峰命名：第一个单词首字母小写，其他大写</span>
<span style="color:#000000;">};</span>
<span style="color:#000000;">#endif // DIALOG_H</span>
</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.cpp</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#include "dialog.h"</span>
<span style="color:#000000;">// 构造函数定义</span>
<span style="color:#000000;">// parent 参数</span>
<span style="color:#000000;">Dialog::Dialog(QWidget *parent): QDialog(parent)   // 透传构造</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    //设置窗口宽高</span>
<span style="color:#000000;">    resize(500,500);</span>
<span style="color:#000000;">    btn = new QPushButton("移动",this);</span>
<span style="color:#000000;">    //设置按钮位置</span>
<span style="color:#000000;">    btn-&gt;move(200,200);</span>
<span style="color:#000000;">    //but 发起者、SIGNAL(clicked()) 发起动作：点击、this 接收者、SLOT(close()) 接收结果 close关闭窗口</span>
<span style="color:#000000;">    connect(btn,SIGNAL(clicked()),this,SLOT(mySlot()));</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">// 析构函数类外定义</span>
<span style="color:#000000;">Dialog::~Dialog()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    // C++内存回收</span>
<span style="color:#000000;">    delete btn;</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">//槽函数定义</span>
<span style="color:#000000;">void Dialog::mySlot()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    //先获取当前窗口坐标</span>
<span style="color:#000000;">    int x = this-&gt;x();//坐标函数返回值就是坐标值</span>
<span style="color:#000000;">    int y = this-&gt;y();</span>
<span style="color:#000000;">    //移动坐标位置</span><span style="color:#708090;">,每次获取的都是最新的坐标位置，所以不需要赋值</span>
<span style="color:#000000;">    move(x+10,y+10);</span>
<span style="color:#000000;">    //输出当前坐标位置</span>
<span style="color:#000000;">    qDebug()&lt;&lt;x+10&lt;&lt;y+10;</span>
<span style="color:#000000;">}</span>

</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><img alt="" height="167" src="https://images2.imgbox.com/7f/47/u9m2QAit_o.png" width="453"></p> 
  <h3 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">3.3 自定义信号</span></strong></h3> 
  <h4 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">emit关键字发射。</span></strong></h4> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">为了讲解，强行使用自定义信号，并非问题的最优解，主要学习写法。</span></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">信号函数是一个非常特殊的函数，因此只有声明，没有定义，没有函数体。因此无法调用，只能使用emit关键字发射。</span></p> 
  <p style="margin-left:0;text-align:left;"><img alt="" height="100" src="https://images2.imgbox.com/8e/95/tosxoWxH_o.png" width="244"><img alt="" height="134" src="https://images2.imgbox.com/46/dc/3PcZ371a_o.png" width="242"></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">【例子】点击按钮，关闭窗口。</span></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">3.1 节的信号连接方式</span></p> 
  <p style="margin-left:0;text-align:left;"><img alt="" height="426" src="https://images2.imgbox.com/9c/f6/Z9SQrSrt_o.png" width="1200"></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">本节强行在中间加一层自定义信号的转发过程。</span></p> 
  <p style="margin-left:0;text-align:left;"><img alt="" height="664" src="https://images2.imgbox.com/97/1c/2QiT6YGX_o.png" width="1200"></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">上图中</span><img alt="" height="22" src="https://images2.imgbox.com/30/ef/Pun6ztJZ_o.png" width="155"><span style="color:#333333;">表示信号槽连接。</span></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.h</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#ifndef DIALOG_H</span>
<span style="color:#000000;">#define DIALOG_H</span>

<span style="color:#000000;">#include &lt;QDialog&gt;</span>
<span style="color:#000000;">#include &lt;QPushButton&gt;</span>

<span style="color:#000000;">class Dialog : public QDialog</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    Q_OBJECT</span>

<span style="color:#000000;">public:</span>
<span style="color:#000000;">    Dialog(QWidget *parent = 0);</span>
<span style="color:#000000;">    ~Dialog();</span>
<span style="color:#000000;">private:</span>
<span style="color:#000000;">    QPushButton *btn;</span>
<span style="color:#000000;">//自定义槽函数声明</span>
<span style="color:#000000;">private slots:</span>
<span style="color:#000000;">    void mySlot();</span>
<span style="color:#000000;">//自定义信号声明</span>
<span style="color:#000000;">signals:</span>
<span style="color:#000000;">    void mySignal();</span>
<span style="color:#000000;">};</span>
<span style="color:#000000;">#endif // DIALOG_H</span>
</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.cpp</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#include "dialog.h"</span>

<span style="color:#000000;">Dialog::Dialog(QWidget *parent)</span>
<span style="color:#000000;">    : QDialog(parent)</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    resize(500,500);</span>
<span style="color:#000000;">    btn = new QPushButton("杀鸡用牛刀",this);</span>
<span style="color:#000000;">    btn-&gt;move(200,200);</span>
<span style="color:#000000;">    //第一次信号槽链接</span>
<span style="color:#000000;">    connect(btn,SIGNAL(clicked()),this,SLOT(mySlot()));</span>
<span style="color:#000000;">    //第二次信号槽链接</span>
<span style="color:#000000;">    connect(this,SIGNAL(mySignal()),this,SLOT(close()));</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">Dialog::~Dialog()</span>
<span style="color:#000000;">{<!-- --></span>
    <span style="color:#000000;">/</span><span style="color:#9a6e3a;">/</span><span style="color:#708090;">释放类对象堆空间</span>
<span style="color:#000000;">    delete btn;</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">void Dialog::mySlot()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    //发射信号</span>
<span style="color:#000000;">    emit mySignal();</span>
<span style="color:#000000;">}</span>

</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">步骤：自定义信号无法调用，只能发射信号，因此在头函数内声明自定义信号和自定义槽函数，在自定义槽函数内发射该自定义信号，并调用相关槽函数。（声明自定义槽函数和自定义信号，需要connect连接多次）</span></p> 
  <h2 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">4、信号槽传参</span></strong></h2> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">【例子】点击按钮，按钮上显式点击的次数。</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#708090;">// QPushButton的文字属性为text:QString，可以使用setText更改按钮文字</span>
<span style="color:#708090;">// 参数:更新的文字</span>
<span style="color:#000000;">void	</span><span style="color:#dd4a68;">setText</span><span style="color:#999999;">(</span><span style="color:#0077aa;">const</span> <span style="color:#dd4a68;">QString</span> <span style="color:#9a6e3a;">&amp;</span><span style="color:#000000;"> text</span><span style="color:#999999;">)</span>
</code></span></pre> 
  <p></p> 
  <h3 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">正常解法（非信号槽传参）：</span></strong></h3> 
  <p style="margin-left:0;text-align:left;"><img alt="" height="690" src="https://images2.imgbox.com/e4/92/C8QFUxnL_o.png" width="1200"></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.h</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#ifndef DIALOG_H</span>
<span style="color:#000000;">#define DIALOG_H</span>
<span style="color:#000000;">#include &lt;QDialog&gt;</span>
<span style="color:#000000;">#include &lt;QPushButton&gt;</span>
<span style="color:#000000;">class Dialog : public QDialog</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    Q_OBJECT</span>
<span style="color:#000000;">public:</span>
<span style="color:#000000;">    Dialog(QWidget *parent = 0);</span>
<span style="color:#000000;">    ~Dialog();</span>
<span style="color:#000000;">    QPushButton *btn;</span>
<span style="color:#000000;">    //自定义槽函数声明</span>
<span style="color:#000000;">private slots:</span>
<span style="color:#000000;">    void mySlot();</span>
<span style="color:#000000;">};</span>
<span style="color:#000000;">#endif // DIALOG_H</span>

</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.cpp</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#include "dialog.h"</span>

<span style="color:#000000;">Dialog::Dialog(QWidget *parent)</span>
<span style="color:#000000;">    : QDialog(parent)</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    resize(500,500);</span>
    <span style="color:#000000;">/</span><span style="color:#9a6e3a;">/</span><span style="color:#708090;">btn初始化 初始数据为”0“</span>
<span style="color:#000000;">    btn = new QPushButton("0",this);</span>
<span style="color:#000000;">    btn-&gt;move(200,200);</span>
<span style="color:#000000;">    //connect 连接</span>
<span style="color:#000000;">    connect(btn,SIGNAL(clicked()),this,SLOT(mySlot()));</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">Dialog::~Dialog()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    delete btn;</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">void Dialog::mySlot()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    //静态局部变量</span>
<span style="color:#000000;">    static int count = 0;</span>
<span style="color:#000000;">    count++;</span>
<span style="color:#000000;">    //类型转换 int-&gt; QString，整形转字符型，number(形参)：形参：要转换的数据</span>
<span style="color:#000000;">    QString text = QString::number(count);</span>
<span style="color:#000000;">    btn-&gt;setText(text);//</span><span style="color:#708090;">更改按钮文字</span>
<span style="color:#000000;">}</span>

</code></span></pre> 
  <p></p> 
  <h3 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">信号槽传参法：</span></strong></h3> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">把上面的案例强行改为信号槽传参：</span></p> 
  <p style="margin-left:0;text-align:left;"><img alt="" height="747" src="https://images2.imgbox.com/b0/90/vPLuCrD8_o.png" width="1200"></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.h</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#ifndef DIALOG_H</span>
<span style="color:#000000;">#define DIALOG_H</span>
<span style="color:#000000;">#include &lt;QDialog&gt;</span>
<span style="color:#000000;">#include &lt;QPushButton&gt;</span>
<span style="color:#000000;">class Dialog : public QDialog</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    Q_OBJECT</span>
<span style="color:#000000;">public:</span>
<span style="color:#000000;">    Dialog(QWidget *parent = 0);</span>
<span style="color:#000000;">    ~Dialog();</span>
<span style="color:#000000;">    QPushButton *btn;</span>
<span style="color:#000000;">    //自定义槽函数声明</span>
<span style="color:#000000;">private slots:</span>
<span style="color:#000000;">    void mySlot();</span>
<span style="color:#000000;">    void mySlot2(int);//有参自定义槽函数</span>
<span style="color:#000000;">signals:</span>
<span style="color:#000000;">    void mySignal(int);//有参自定义信号函数</span>
<span style="color:#000000;">};</span>
<span style="color:#000000;">#endif // DIALOG_H</span>

</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.cpp</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#include "dialog.h"</span>
<span style="color:#000000;">Dialog::Dialog(QWidget *parent)</span>
<span style="color:#000000;">    : QDialog(parent)</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    resize(500,500);</span>
<span style="color:#000000;">    btn = new QPushButton("0",this);</span>
<span style="color:#000000;">    btn-&gt;move(200,200);</span>
<span style="color:#000000;">    //connect 连接</span>
<span style="color:#000000;">    connect(btn,SIGNAL(clicked()),this,SLOT(mySlot()));</span>
<span style="color:#000000;">    connect(this,SIGNAL(mySignal(int)),this,SLOT(mySlot2(int)));</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">Dialog::~Dialog()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    delete btn;</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">//自定义信号槽初始化</span>
<span style="color:#000000;">void Dialog::mySlot()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    //静态局部变量</span>
<span style="color:#000000;">    static int count = 0;</span>
<span style="color:#000000;">    count++;</span>
<span style="color:#000000;">    //发射带参数的自定义信号函数</span>
<span style="color:#000000;">    emit mySignal(count);</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">//自定义信号槽函数初始化，注意传参</span>
<span style="color:#000000;">void Dialog::mySlot2(int count)</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    //类型转化 int -&gt; QString</span>
<span style="color:#000000;">    QString text = QString::number(count);</span>
<span style="color:#000000;">    btn-&gt;setText(text);</span>
<span style="color:#000000;">}</span>

</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">需要注意的是：</span></p> 
  <ul><li style="text-align:left;"><span style="color:#333333;">理论上可以传递任意多个参数，建议最多写两个参数，多了会很冗余。如果非得传多个参数的话，可以定义成一个类，传递对象。</span></li><li style="text-align:left;"><span style="color:#333333;">信号的参数个数必须大于等于槽的参数个数。</span></li><li style="text-align:left;"><span style="color:#333333;">信号的参数类型要与槽的参数类型匹配。</span></li></ul> 
  <h2 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">5、对应关系</span></strong></h2> 
  <h3 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">5.1 一对多</span></strong></h3> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">一对多指的是一个信号连接多个槽函数。</span></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.h</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#ifndef DIALOG_H</span>
<span style="color:#000000;">#define DIALOG_H</span>
<span style="color:#000000;">#include &lt;QDialog&gt;</span>
<span style="color:#000000;">#include &lt;QDebug&gt;</span>
<span style="color:#000000;">#include &lt;QPushButton&gt;</span>
<span style="color:#000000;">class Dialog : public QDialog</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    Q_OBJECT</span>
<span style="color:#000000;">public:</span>
<span style="color:#000000;">    Dialog(QWidget *parent = 0);</span>
<span style="color:#000000;">    ~Dialog();</span>
<span style="color:#000000;">    QPushButton *btn0;</span>
<span style="color:#000000;">    QPushButton *btn1;</span>
<span style="color:#000000;">    QPushButton *btn2;</span>
<span style="color:#000000;">private slots:</span>
<span style="color:#000000;">    void mySlot0();</span>
<span style="color:#000000;">    void mySlot1();</span>
<span style="color:#000000;">    void mySlot2();</span>
<span style="color:#000000;">};</span>

<span style="color:#000000;">#endif // DIALOG_H</span>

</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.cpp</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#include "dialog.h"</span>
<span style="color:#000000;">Dialog::Dialog(QWidget *parent)</span>
<span style="color:#000000;">    : QDialog(parent)</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    resize(500,500);</span>
<span style="color:#000000;">    btn0 = new QPushButton("一对多",this);</span>
<span style="color:#000000;">    btn0-&gt;move(200,250);</span>
<span style="color:#000000;">    //一对多的优势是可以灵活处理每个对应关系</span>
<span style="color:#000000;">    //例如可以断开某个信号槽连接</span>
<span style="color:#000000;">    //断开连接的函数与连接函数传参一样，只需要在前面加一个dis</span>
<span style="color:#000000;">    //disconnect(btn0,SIGNAL(clicked()),this,SLOT(mySlot0()));</span>
<span style="color:#000000;">    //一对多信号槽连接</span>
<span style="color:#000000;">    connect(btn0,SIGNAL(clicked()),this,SLOT(mySlot0()));</span>
<span style="color:#000000;">    connect(btn0,SIGNAL(clicked()),this,SLOT(mySlot1()));</span>
<span style="color:#000000;">    //一对一信号槽链接，连接简单，但处理不灵活</span>
<span style="color:#000000;">    btn1 = new QPushButton("一对一",this);</span>
<span style="color:#000000;">    btn1-&gt;move(100,200);</span>
<span style="color:#000000;">    connect(btn1,SIGNAL(clicked()),this,SLOT(mySlot2()));</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">Dialog::~Dialog()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    delete btn0;</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">void Dialog::mySlot0()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    qDebug()&lt;&lt;"A";</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">void Dialog::mySlot1()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    qDebug()&lt;&lt;"B";</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">void Dialog::mySlot2()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    mySlot0();</span>
<span style="color:#000000;">    mySlot1();</span>
<span style="color:#000000;">}</span>

</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">在头文件内声明的函数，可以以下操作在主函数内自定添加定义</span></p> 
  <p style="margin-left:0;text-align:left;"><img alt="" height="456" src="https://images2.imgbox.com/c4/2b/IlHCar0I_o.png" width="1135"></p> 
  <h3 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">5.2 多对一</span></strong></h3> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">多对一指的是多个信号连接同一个槽函数。多对一的问题在于槽函数无法直接判断那个信号触发的槽函数调用，可以通过sender函数在槽函数中获得发射者对象，通过对象对比判断来源。</span></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.h</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#ifndef DIALOG_H</span>
<span style="color:#000000;">#define DIALOG_H</span>
<span style="color:#000000;">#include &lt;QDialog&gt;</span>
<span style="color:#000000;">#include &lt;QPushButton&gt;</span>
<span style="color:#000000;">#include &lt;QDebug&gt;</span>
<span style="color:#0077aa;">class</span> <span style="color:#dd4a68;">Dialog</span> <span style="color:#9a6e3a;">:</span> <span style="color:#000000;">public QDialog</span>
<span style="color:#999999;">{<!-- --></span>
<span style="color:#000000;">    Q_OBJECT</span>
<span style="color:#0077aa;">public</span><span style="color:#9a6e3a;">:</span>
    <span style="color:#dd4a68;">Dialog</span><span style="color:#999999;">(</span><span style="color:#000000;">QWidget </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">parent </span><span style="color:#9a6e3a;">=</span> <span style="color:#990055;">0</span><span style="color:#999999;">);</span>
    <span style="color:#9a6e3a;">~</span><span style="color:#dd4a68;">Dialog</span><span style="color:#999999;">();</span>
<span style="color:#000000;">    QPushButton </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">btn1</span><span style="color:#999999;">;</span>
<span style="color:#000000;">    QPushButton </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">btn2</span><span style="color:#999999;">;</span>
<span style="color:#0077aa;">private</span><span style="color:#000000;"> slots</span><span style="color:#9a6e3a;">:</span>
    <span style="color:#0077aa;">void</span> <span style="color:#dd4a68;">btnClickedSlot</span><span style="color:#999999;">();</span>
<span style="color:#999999;">};</span>
<span style="color:#000000;">#endif // DIALOG_H</span>

</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">dialog.cpp</span></p> 
  <p style="margin-left:0;text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#include "dialog.h"</span>
<span style="color:#000000;">Dialog::Dialog(QWidget *parent)</span>
<span style="color:#000000;">    : QDialog(parent)</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    resize(500,500);</span>
<span style="color:#000000;">    btn1 = new QPushButton("多对一A",this);</span>
<span style="color:#000000;">    btn1-&gt;move(200,200);</span>

<span style="color:#000000;">    btn2 = new QPushButton("多对一B",this);</span>
<span style="color:#000000;">    btn2-&gt;move(300,300);</span>

<span style="color:#000000;">    // 多对一连接</span>
<span style="color:#000000;">    connect(btn1,SIGNAL(clicked()),this,SLOT(btnClickedSlot()));</span>
<span style="color:#000000;">    connect(btn2,SIGNAL(clicked()),this,SLOT(btnClickedSlot()));</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">Dialog::~Dialog()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    delete btn1;</span>
<span style="color:#000000;">    delete btn2;</span>
<span style="color:#000000;">}</span>
<span style="color:#000000;">void Dialog::btnClickedSlot()</span>
<span style="color:#000000;">{<!-- --></span>
<span style="color:#000000;">    // 通过sender函数获取发射者对象</span>
<span style="color:#000000;">    if(sender() == btn1)</span>
<span style="color:#000000;">    {<!-- --></span>
<span style="color:#000000;">        qDebug() &lt;&lt; "A" ;</span>
<span style="color:#000000;">    }</span>
<span style="color:#000000;">    else if(sender() == btn2)</span>
<span style="color:#000000;">    {<!-- --></span>
<span style="color:#000000;">        qDebug() &lt;&lt; "B" ;</span>
<span style="color:#000000;">    }</span>
<span style="color:#000000;">    else</span>
<span style="color:#000000;">    {<!-- --></span>
<span style="color:#000000;">        qDebug() &lt;&lt; "对象错误" ;</span>
    <span style="color:#999999;">}</span>
<span style="color:#999999;">}</span>

</code></span></pre> 
  <p></p> 
  <p style="margin-left:0;text-align:left;"></p> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/caff3e03089e88274ebc574ff265df05/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">LeetCode 36 有效的数独</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f3def03065f16b9073a8da39ec720dc5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据库备份和恢复以及配置优化</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>