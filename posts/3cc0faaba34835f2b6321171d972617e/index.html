<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>记录一次服务器断电重启后网络配置的问题 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="记录一次服务器断电重启后网络配置的问题" />
<meta property="og:description" content="1. 问题描述 服务器系统 CentOS 7， IP 是 172.22.xx.245，一直正常使用。
前两天突然断电重启后发现网络不通，在服务器上使用 ip a 命令查看，发现状态为 UP 的网卡名称是 enp4s0，其 IP 是 192.168.1.4 。
但是在 /etc/sysconfig/network-scripts/ 下发现只有一个名为 ifcfg-enp5s0 的配置，并没有 enp4s0 的，很奇怪。
使用 ifup enp5s0 和 ifup ifcfg-enp5s0 命令启动网卡，报错如下：
Error: Connection activation failed: No suitable device found for this connection (device enp5s0 not available because profile is not compatible with device (mismatching interface name)). 2. 问题解决 首先是按照网上说的禁用 NetworkManager 后重启 network 服务 （没用）systemctl stop NetworkManager systemctl disable NetworkManager systemctl restart network 可能是网卡配置中没有 mac 地址导致的，于是使用 enp4s0 的 mac 地址放在 ifcfg-enp5s0 配置文件中增加如下配置 （没用）HWADDR=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3cc0faaba34835f2b6321171d972617e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-18T11:41:17+08:00" />
<meta property="article:modified_time" content="2022-04-18T11:41:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">记录一次服务器断电重启后网络配置的问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h5><a id="1__0"></a>1. 问题描述</h5> 
<p>服务器系统 CentOS 7， IP 是 <code>172.22.xx.245</code>，一直正常使用。</p> 
<p>前两天突然断电重启后发现网络不通，在服务器上使用 <code>ip a</code> 命令查看，发现状态为 <code>UP</code> 的网卡名称是 <code>enp4s0</code>，其 IP 是 <code>192.168.1.4</code> 。</p> 
<p>但是在 <code>/etc/sysconfig/network-scripts/</code> 下发现只有一个名为 <code>ifcfg-enp5s0</code> 的配置，并没有 <code>enp4s0</code> 的，很奇怪。</p> 
<p>使用 <code>ifup enp5s0</code> 和 <code>ifup ifcfg-enp5s0</code> 命令启动网卡，报错如下：</p> 
<pre><code class="prism language-shell">Error: Connection activation failed: No suitable device found <span class="token keyword">for</span> this connection 
<span class="token punctuation">(</span>device enp5s0 not available because profile is not compatible with device <span class="token punctuation">(</span>mismatching interface name<span class="token punctuation">))</span>.
</code></pre> 
<hr> 
<h5><a id="2__14"></a>2. 问题解决</h5> 
<ol><li>首先是按照网上说的禁用 NetworkManager 后重启 network 服务 <strong>（没用）</strong><pre><code class="prism language-shell">systemctl stop NetworkManager
systemctl disable NetworkManager
systemctl restart network
</code></pre> </li><li>可能是网卡配置中没有 mac 地址导致的，于是使用 <code>enp4s0</code> 的 mac 地址放在 <code>ifcfg-enp5s0</code> 配置文件中增加如下配置 <strong>（没用）</strong><pre><code class="prism language-bash"><span class="token assign-left variable">HWADDR</span><span class="token operator">=</span><span class="token string">"44:37:e6:dc:48:9e"</span>
</code></pre> </li><li>修改配置文件名与 <code>ip a</code> 中状态为 <code>UP</code> 的网卡名一致 <strong>（有用）</strong><pre><code class="prism language-shell"><span class="token comment"># 首先备份原配置文件</span>
<span class="token function">cp</span> ifcfg-enp5s0 ifcfg-enp5s0.bak
<span class="token comment"># 修改配置文件名</span>
<span class="token function">mv</span> ifcfg-enp5s0 ifcfg-enp4s0
<span class="token comment"># 修改配置文件中以下内容，与网卡名保持一致</span>
<span class="token assign-left variable">NAME</span><span class="token operator">=</span><span class="token string">"enp4s0"</span>
<span class="token assign-left variable">DEVICE</span><span class="token operator">=</span><span class="token string">"enp4s0"</span>
</code></pre> 修改完成后， <code>systemctl restart network</code> 重启网络服务，成功</li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/983e8dd3ec8d4bf6c810d64268bdd62e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Gitea在windows平台的安装和简单使用教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7916969c5036517dc0e8fa7f61278de8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">15.网络协议-Radius协议</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>