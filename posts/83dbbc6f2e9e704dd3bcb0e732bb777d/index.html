<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql数据库定时备份 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql数据库定时备份" />
<meta property="og:description" content="1 环境检查
1. 执行本手册前，请正确安装Mysql数据库，并知晓数据库用户名和密码；
2. 执行本手册前，请先确定Mysql数据库数据要储存的天数；默认30
2 批处理文件配置
当前步骤主要实现以下目标配置：
Ø 配置Mysql安装目录，定义Mysql目录下BIN目录路径，用于定时导出数据的命令源；
Ø 配置Mysql数据库root用户名及root密码，用于定时导出数据库数据；
Ø 配置数据库备份目录，用于存储数据库备份文件；
Ø 配置数据库备份数据存储的天数，用于清理数据时限；
当前步骤配置文件源为，\07、数据库定时备份与清理手册\databasebak.bat：
2.1 配置批处理文件变量
找到“\07、数据库定时备份与清理手册\databasebak.bat”文件，选中后右键，点击“编辑”选项；
文档内容分为两部分：
第一部分，变量配置，用于部署人员配置变量；
第二部分，不需要做任何变更。请勿随意变更。
2.1.1 配置Mysql数据库安装BIN路径
定义mysql安装路径下BIN目录。必须以实际环境目录为准。在此，举例为C:/Program Files/MySQL/MySQL Server 5.7/bin。
Ø Windows系统：将变量“mysqlfilepath”设置如下，黄色部分作废，通过REM # 命令作废Linux命令。
REM ##################################### REM # 第一部分：变量定义，维护人员仅在此部分做变量调整 REM # 无论是Windows系统还是Linux系统mysql数据库用户名和密码均更改为实际环境下配置 REM ##################################### REM # 定义mysql安装路径下BIN目录。必须以实际环境目录为准，需要变更 REM # Windows，执行命令:与Linux命令不共存 set mysqlfilepath=C:/Program Files/MySQL/MySQL Server 5.7/bin REM # Linux，执行命令:与Windows命令不共存 REM # set mysqlfilepath=/Program Files/MySQL/MySQL Server 5.7/bin Ø Linux系统：将变量“mysqlfilepath”设置如下，黄色部分作废，通过REM # 命令作废Windows命令。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/83dbbc6f2e9e704dd3bcb0e732bb777d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-31T20:22:14+08:00" />
<meta property="article:modified_time" content="2023-01-31T20:22:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql数据库定时备份</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:.0001pt;text-align:justify;"><strong>1 </strong><strong>环境检查</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">1. 执行本手册前，请正确安装Mysql数据库，并知晓数据库用户名和密码；</p> 
<p style="margin-left:.0001pt;text-align:justify;">2. 执行本手册前，请先确定Mysql数据库数据要储存的天数；默认30</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>2 </strong><strong>批处理文件配置</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">当前步骤主要实现以下目标配置：</p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø 配置Mysql安装目录，定义Mysql目录下BIN目录路径，用于定时导出数据的命令源；</p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø 配置Mysql数据库root用户名及root密码，用于定时导出数据库数据；</p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø 配置数据库备份目录，用于存储数据库备份文件；</p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø 配置数据库备份数据存储的天数，用于清理数据时限；</p> 
<p style="margin-left:.0001pt;text-align:justify;">当前步骤配置文件源为，\07、数据库定时备份与清理手册\databasebak.bat：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>2.1 </strong><strong>配置批处理文件变量</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">找到“\07、数据库定时备份与清理手册\databasebak.bat”文件，选中后右键，点击“编辑”选项；</p> 
<p class="img-center"><img alt="" height="282" src="https://images2.imgbox.com/79/b6/Tayla7vQ_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>文档内容分为两部分：</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">第一部分，变量配置，用于部署人员配置变量；</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#ff0000;">第二部分，不需要做任何变更。请勿随意变更。</span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="692" src="https://images2.imgbox.com/97/59/9wtASqDa_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>2.1.1 </strong><strong>配置</strong><strong>Mysql</strong><strong>数据库安装</strong><strong>BIN路径</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="335" src="https://images2.imgbox.com/3d/73/Qla2dbPb_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>定义mysql安装路径下</strong><strong>BIN</strong><strong>目录。必须以实际环境目录为准。在此，举例为</strong><strong>C:/Program Files/MySQL/MySQL Server 5.7/bin</strong><strong>。</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø Windows系统：将变量“mysqlfilepath”设置如下，黄色部分作废，通过REM # 命令作废Linux命令。</p> 
<table border="1" cellspacing="0" style="margin-left:4.9pt;"><tbody><tr><td style="vertical-align:top;width:314pt;"> <p style="margin-left:.0001pt;text-align:justify;">REM #####################################    REM # 第一部分：变量定义，维护人员仅在此部分做变量调整 REM # 无论是Windows系统还是Linux系统mysql数据库用户名和密码均更改为实际环境下配置 REM ##################################### REM # 定义mysql安装路径下BIN目录。必须以实际环境目录为准，需要变更 REM # Windows，执行命令:与Linux命令不共存 <span style="color:#ff0000;">set mysqlfilepath=C:/Program Files/MySQL/MySQL Server 5.7/bin</span> REM # Linux，执行命令:与Windows命令不共存 <span style="color:#ff0000;">REM # </span><span style="background-color:#ffff00;">set mysqlfilepath=/Program Files/MySQL/MySQL Server 5.7/bin</span> </p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;">Ø Linux系统：将变量“mysqlfilepath”设置如下，黄色部分作废，通过REM # 命令作废Windows命令。</p> 
<table border="1" cellspacing="0" style="margin-left:4.9pt;"><tbody><tr><td style="vertical-align:top;width:314pt;"> <p style="margin-left:.0001pt;text-align:justify;">REM #####################################    REM # 第一部分：变量定义，维护人员仅在此部分做变量调整 REM # 无论是Windows系统还是Linux系统mysql数据库用户名和密码均更改为实际环境下配置 REM ##################################### REM # 定义mysql安装路径下BIN目录。必须以实际环境目录为准，需要变更 REM # Windows，执行命令:与Linux命令不共存 <span style="color:#ff0000;">REM # </span><span style="background-color:#ffff00;">set mysqlfilepath=C:/Program Files/MySQL/MySQL Server 5.7/bin</span>  REM # Linux，执行命令:与Windows命令不共存 <span style="color:#ff0000;">set mysqlfilepath=/Program Files/MySQL/MySQL Server 5.7/bin</span></p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>2.1.2 </strong><strong>配置</strong><strong>Mysql</strong><strong>数据库</strong><strong>root用户名</strong><strong>和密码</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="577" src="https://images2.imgbox.com/1d/3b/svA2yBZx_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø 按上图定位到数据库用户名和密码配置区域，一般情况下username不需要变更，password需要变更。</p> 
<table border="1" cellspacing="0" style="margin-left:4.9pt;"><tbody><tr><td style="vertical-align:top;width:314pt;"> <p style="margin-left:.0001pt;text-align:justify;">REM # 定义root用户名和用户名密码。必须以实际环境目录为准，username不需要变更，password需要变更 set username=root set password=<span style="color:#ff0000;">123456</span></p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>2.1.3 </strong><strong>配置数据库备份目录，用于存储数据库备份文件</strong><strong> </strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="570" src="https://images2.imgbox.com/2d/b0/ikvw1AaR_o.png" width="1200"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø Windows系统：按上图定位到数据库备份目录配置区域，将变量“dbPath”设置如下，黄色部分作废，通过REM # 命令作废Linux命令。<strong><span style="color:#ff0000;">Windows</span></strong><strong><span style="color:#ff0000;">下必须使用</span></strong><strong><span style="color:#ff0000;">“\”</span></strong><strong><span style="color:#ff0000;">，盘符根据情况自定义，建议使用</span></strong><strong><span style="color:#ff0000;">D</span></strong><strong><span style="color:#ff0000;">盘。</span></strong>最终文件备份在“D:/SSXHDB/”文件夹下。</p> 
<table border="1" cellspacing="0" style="margin-left:4.9pt;"><tbody><tr><td style="vertical-align:top;width:314pt;"> <p style="margin-left:.0001pt;text-align:justify;">REM # 定义数据备份路径，默认使用Windows下D盘目录，一般不需要变更 REM # Windows:Windows下使用\,否则清理命令不可用 <span style="color:#ff0000;">set dbPath=D:\</span> REM # Linux: <span style="color:#ff0000;">REM # </span><span style="background-color:#ffff00;">set dbPath=/</span></p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;">Ø Linux系统：按上图定位到数据库备份目录配置区域，将变量“dbPath”设置如下，黄色部分作废，通过REM # 命令作废Windows命令。最终文件备份在“/SSXHDB/”文件夹下。</p> 
<table border="1" cellspacing="0" style="margin-left:4.9pt;"><tbody><tr><td style="vertical-align:top;width:314pt;"> <p style="margin-left:.0001pt;text-align:justify;">REM # 定义数据备份路径，默认使用Windows下D盘目录，一般不需要变更 REM # Windows:Windows下使用\,否则清理命令不可用 <span style="color:#ff0000;">REM # </span><span style="background-color:#ffff00;">set dbPath=D:\</span> REM # Linux: <span style="color:#ff0000;">set dbPath=/</span></p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>2.1.4 </strong><strong>配置数据库备份数据存储的天数</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="570" src="https://images2.imgbox.com/91/c9/fvBufrMB_o.png" width="1200"> </p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø 按上图定位到数据库备份数据存储的天数配置区域，一般情况下，不需要变更，<strong><span style="color:#ff0000;">如需变更请根据实际情况自定义</span></strong>。默认30天</p> 
<table border="1" cellspacing="0" style="margin-left:4.9pt;"><tbody><tr><td style="vertical-align:top;width:314pt;"> <p style="margin-left:.0001pt;text-align:justify;">REM # 定义备份数据保存的天数，超出日期的将被清理，默认30天，一般不需要变更 set saveDays=30</p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>2.2 </strong><strong>批处理文件移动至服务器</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø Linux系统：将本地“\07、数据库定时备份与清理手册\databasebak.bat”复制到Linux系统根目录/SSXH/下；</p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø Windows系统：将本地“\07、数据库定时备份与清理手册\databasebak.bat”复制到系统根目录D:/SSXH/下；</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#ff0000;">注意：无论是</span></strong><strong><span style="color:#ff0000;">Windows</span></strong><strong><span style="color:#ff0000;">系统或者</span></strong><strong><span style="color:#ff0000;">Linux</span></strong><strong><span style="color:#ff0000;">系统，在部署银医程序时均已创建SSX</span></strong><strong><span style="color:#ff0000;">H</span></strong><strong><span style="color:#ff0000;">文件夹，若无当前文件夹，表示未按银医部署文档执行规范操作。</span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>3 </strong><strong>配置定时任务</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>3.1 Windows</strong><strong>系统</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø Windows键+R 调出此窗口，输入compmgmt.msc （调用的是计算机管理）</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="630" src="https://images2.imgbox.com/ba/8e/HhiAQNkL_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø 创建基本任务</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="720" src="https://images2.imgbox.com/f3/c9/yNeVne9R_o.png" width="1007"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">名称为“SSXH-Mysql数据库备份与清理任务”，点击下一步。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="720" src="https://images2.imgbox.com/28/b1/gtXRzoE2_o.png" width="1007"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">选择“每天”，点击下一步；</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="720" src="https://images2.imgbox.com/ec/6e/QDs9TMy9_o.png" width="1007"></p> 
<p style="margin-left:.0001pt;text-align:justify;">设置开始日期及时间点，并设置一天发生一次，点击下一步；</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="720" src="https://images2.imgbox.com/91/44/NO3JubYw_o.png" width="1007"></p> 
<p style="margin-left:.0001pt;text-align:justify;">选择“启动程序”，点击下一步；</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="720" src="https://images2.imgbox.com/39/04/Lr21UrX6_o.png" width="1007"></p> 
<p style="margin-left:.0001pt;text-align:justify;">通过浏览，选定要执行的脚本，点击下一步；</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="720" src="https://images2.imgbox.com/95/bd/aM94XYcJ_o.png" width="1007"></p> 
<p style="margin-left:.0001pt;text-align:justify;">点击“完成”，新任务将会被创建并添加到Windows计划中。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="720" src="https://images2.imgbox.com/25/33/aHDd3HHA_o.png" width="1007"></p> 
<p style="margin-left:.0001pt;text-align:justify;">任务框中，选中当前任务，点击右侧“属性”，配置最高权限，点击确定，输入用户名密码，完成设置。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="607" src="https://images2.imgbox.com/a1/72/rjnu8FXG_o.png" width="1200"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>3.2 Linux</strong><strong>系统</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø 通过linux相关工具连接上linux服务器，linux操作命令此处不赘述；</p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø 输入命令“cd /var/spool/cron”;</p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø 输入命令“crontab –l”，查看定时任务；</p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø 输入命令“crontab －e”，在打开的页面中点击“i”键，进入插入模式，进行编辑；编辑的格式，是“分 时 日 月 周 命令”。当分为＊时，表示每分钟执行一次，时为＊时，表示每小时执行一次；如果要设置没隔多久执行，则写为“＊/数字”，在哪个位置就代表没隔多久执行一次。只要把要执行的文件放在服务器上，然后按照这个格式写，然后按照设定的时间，就会自动执行文件了。比如我设定每天凌晨3点定时执行备份文件。“<span style="color:#ff0000;">* 3 * * *</span><span style="color:#ff0000;"> /SSXH /databasebak.bat</span>”;</p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø 编辑完成后，点ESC，然后输入 :wq 点击回车；</p> 
<p style="margin-left:.0001pt;text-align:justify;">Ø restart crond.service  #启动服务</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>4 </strong><strong>验证测试</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">备份：在对应数据库备份目录下，查询对应目录文件即可；</p> 
<p style="margin-left:.0001pt;text-align:justify;">清理：可在备份目录下放置一个日期比较旧的文件，用于验证文件超时清理；</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c24c5a3a47e7a0efce84db355cec11cc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">给程序员的ChatGPT使用指南：优化工作流程的 3 种实用方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/29952d291ee18ac0449df329d9c227b8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">多线程8锁问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>