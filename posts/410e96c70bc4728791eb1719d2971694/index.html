<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue3中将后端传来的json文件转成excel下载到本地 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue3中将后端传来的json文件转成excel下载到本地" />
<meta property="og:description" content="前言： 在浏览器中将JSON格式数据以excel文件的形式下载。该组件是基于[this thread] (https://stackoverflow.com/questions/17142427/javascript-to-export-html-table-to-excel)提出的解决方案。支持Vue3.2.25及以上版本使用
重要提示! Microsoft Excel中的额外提示
此组件中实现的方法使用HTML表绘制。在xls文件中，Microsoft Excel不再将HTML识别为本机内容，因此在打开文件之前会显示警告消息。excel的内容已经完美呈现，但是提示信息无法避免，请不要在意！
使用效果： 如果出现下面的提示，点是就行了 官方地址：点我 使用步骤： 1、安装 npm/cnpm/pnpm/yarn 都可以，装下面插件 vue3-json-excel 2、main.js中配置 import vue3JsonExcel from &#39;vue3-json-excel&#39;; const app = createApp(App); app.component(&#39;Vue3JsonExcel&#39;, vue3JsonExcel); 3、页面具体使用 template &lt;template&gt; &lt;vue3-json-excel :json-data=&#34;json_data&#34; :fields=&#34;fields&#34; name=&#34;测试111.xls&#34; &gt; &lt;el-button&gt;点我下载&lt;/el-button&gt; &lt;/vue3-json-excel&gt; &lt;/template&gt; ts &lt;script lang=&#34;ts&#34; setup&gt; const fields = ref({ &#39;姓名&#39;:&#39;name&#39;, &#39;年龄&#39;:&#39;age&#39;, &#39;编号&#39;:&#39;num&#39;, }); const json_data = ref([ { name:&#39;张三&#39;, age:17, num:&#39;~00013&#39;, //能解决丢0问题 },{ name:&#39;李四&#39;, age:33, num:&#39;00014&#39;,//会出现丢失0 }, ]); &lt;/script&gt; 4、 尚存在问题 和vue2的插件vue-json-excel一样，也是有 0 被丢失问题" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/410e96c70bc4728791eb1719d2971694/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-22T12:02:29+08:00" />
<meta property="article:modified_time" content="2023-07-22T12:02:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue3中将后端传来的json文件转成excel下载到本地</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>前言：</h3> 
<blockquote> 
 <p>        在浏览器中将JSON格式数据以excel文件的形式下载。该组件是基于[this thread] (<a href="https://stackoverflow.com/questions/17142427/javascript-to-export-html-table-to-excel%29%E6%8F%90%E5%87%BA%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E3%80%82%E6%94%AF%E6%8C%81Vue3.2.25%E5%8F%8A%E4%BB%A5%E4%B8%8A%E7%89%88%E6%9C%AC%E4%BD%BF%E7%94%A8" rel="nofollow" title="https://stackoverflow.com/questions/17142427/javascript-to-export-html-table-to-excel)提出的解决方案。支持Vue3.2.25及以上版本使用">https://stackoverflow.com/questions/17142427/javascript-to-export-html-table-to-excel)提出的解决方案。支持Vue3.2.25及以上版本使用</a></p> 
 <p>重要提示! Microsoft Excel中的额外提示</p> 
 <p><strong>        此组件中实现的方法使用HTML表绘制。在xls文件中，Microsoft Excel不再将HTML识别为本机内容，因此在打开文件之前会显示警告消息。excel的内容已经完美呈现，但是提示信息无法避免，请不要在意！</strong></p> 
</blockquote> 
<h3>使用效果：</h3> 
<p><img alt="" height="123" src="https://images2.imgbox.com/48/af/lQ6mkE9B_o.png" width="115"></p> 
<h5>如果出现下面的提示，点是就行了</h5> 
<p><img alt="" height="139" src="https://images2.imgbox.com/ac/62/Ex1PzoZJ_o.png" width="749"></p> 
<p> <img alt="" height="163" src="https://images2.imgbox.com/42/d8/njKB3Yev_o.png" width="203"></p> 
<p> </p> 
<h3>官方地址：<a class="link-info" href="https://www.npmjs.com/package/vue3-json-excel" rel="nofollow" title="点我">点我</a></h3> 
<h3>使用步骤：</h3> 
<h4>1、安装 npm/cnpm/pnpm/yarn  都可以，装下面插件</h4> 
<pre><code>vue3-json-excel</code></pre> 
<h4><a name="t6"></a>2、main.js中配置</h4> 
<pre><code class="hljs">import vue3JsonExcel from 'vue3-json-excel';

const app = createApp(App);
app.component('Vue3JsonExcel', vue3JsonExcel);</code></pre> 
<h4>3、页面具体使用</h4> 
<h5>template</h5> 
<pre><code class="hljs">&lt;template&gt;
  &lt;vue3-json-excel
    :json-data="json_data"
    :fields="fields"
    name="测试111.xls"
  &gt;
    &lt;el-button&gt;点我下载&lt;/el-button&gt;
  &lt;/vue3-json-excel&gt;

&lt;/template&gt;</code></pre> 
<h5>ts</h5> 
<pre><code class="hljs">&lt;script lang="ts" setup&gt;
const fields = ref({
    '姓名':'name',
    '年龄':'age',
    '编号':'num',
  });
const json_data = ref([
  {
    name:'张三',
    age:17,
    num:'~00013', //能解决丢0问题
  },{
    name:'李四',
    age:33,
    num:'00014',//会出现丢失0
  },
]);

&lt;/script&gt;</code></pre> 
<h4>4、 尚存在问题</h4> 
<blockquote> 
 <p>     和vue2的插件vue-json-excel一样，也是有 0 被丢失问题</p> 
 <p>前面加个符号，~0  可以解决该问题</p> 
</blockquote> 
<h4>5、官方api</h4> 
<table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th><th>remark</th></tr></thead><tbody><tr><td>json-data</td><td>Array</td><td>即将导出的数据</td><td></td><td></td></tr><tr><td>fields</td><td>Object</td><td>要导出的JSON对象内的字段。如果未提供任何属性，将导出JSON中的所有属性。</td><td></td><td></td></tr><tr><td>export-fields (exportFields)</td><td>Object</td><td>用于修复使用变量字段的其他组件的问题，如vee-validate。exportFields的工作原理与fields完全相同</td><td></td><td></td></tr><tr><td>type</td><td>string</td><td>Mime 类型 [xls, csv]</td><td>xls</td><td>1.0.x版本暂时只支持xls，csv会在下个版本迭代</td></tr><tr><td>name</td><td>string</td><td>File 导出的文件名</td><td>jsonData.xls</td><td></td></tr><tr><td>header</td><td>string/Array</td><td>数据的标题。可以是字符串（一个标题）或字符串数组（多个标题）。</td><td></td><td></td></tr><tr><td>title(deprecated)</td><td>string/Array</td><td>与header相同，title是出于追溯兼容性目的而维护的，但由于与HTML5 title属性冲突，不建议使用它。</td></tr></tbody></table> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ef197ec821c287a693905786edb2a4a8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">并发给数据库带来的问题及解决方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/41e29e2fbd037028c3cdbe70dd327010/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#--使用Quartz实现定时任务的暂停定时、恢复定时、关闭定时等操作</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>