<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>VBA之正则表达式（5）-- 中文字符 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="VBA之正则表达式（5）-- 中文字符" />
<meta property="og:description" content="实例需求：数据保存在A列中，需要将其中中文字符提取至B列。如何匹配中文字符呢？
大家都知道匹配英文单词很简单，[a-zA-z]把26个字母大小写将都涵盖了，可是中文字符怎么搞呢，是否也可以使用类似的方法，找到中文的开始和结尾的字符。中文到底有多少个字符？其实这个问题很难回答。CJK（CJK Unified Ideographs，中日韩统一表意文字）字符集中从0x4E00到0x9FA5 的连续区域，包含了 20902 个来自于中国、韩国、日本的汉字，涵盖了多数中文字符，可以说CJK是GB2312-80和BIG5等字符集的超集。
0x4E00和0x9FA5分别对应中文中的哪个字呢？大家可以在网上使用Unicode转换器进行转换，其实在Word中使用【符号】对话框将可以进行查询，如下图所示。
0x4E00对应汉字【一】，0x9FA5对应汉字【龥】，这个字属于古汉字，其读音为yù，使用拼音输入法，需要翻页N多次，才可以找到它。
在不同字体中，0x9FA5不一定是CJK统一汉字的最后一个字，例如下图还有之后的8个字符也属于CJK统一汉字，但是这些似乎都是偏旁部首，所以一般情况下使用[一-龥]匹配汉字就足够了。由于输入龥字比较麻烦，直接使用16进制的字符编码[\u4e00-\u9fa5]来表示中文字符集更加方便。
示例代码如下。
Sub RegExpChinese() Dim strTxt As String, strMsg As String Dim objRegEx As Object, objMatch As Object Dim j As Integer Set objRegEx = CreateObject(&#34;vbscript.regexp&#34;) &#39;objRegEx.Pattern = &#34;[^一-龥]&#34; objRegEx.Pattern = &#34;[^\u4e00-\u9fa5]&#34; objRegEx.Global = True For Each c In Range([A1], Cells(Rows.Count, 1).End(xlUp)) strTxt = Trim(c.Value) c.Offset(0, 1).Value = objRegEx.Replace(strTxt, &#34;&#34;) Next Set objRegEx = Nothing End Sub 【代码解析】
第6行代码使用后期绑定创建正则对象。
第7行代码指定正则匹配字符串，用于匹配非中文字符，方括号中的^代表字符集的否定，即不包含指定字符集。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2099db343adb34343677b7a4bf1138ca/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-03-10T11:07:46+08:00" />
<meta property="article:modified_time" content="2019-03-10T11:07:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">VBA之正则表达式（5）-- 中文字符</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>实例需求：数据保存在A列中，需要将其中中文字符提取至B列。如何匹配中文字符呢？<br> <img src="https://images2.imgbox.com/3d/aa/95R51tQN_o.png" width="50%" height="50%"><br> 大家都知道匹配英文单词很简单，<code>[a-zA-z]</code>把26个字母大小写将都涵盖了，可是中文字符怎么搞呢，是否也可以使用类似的方法，找到中文的开始和结尾的字符。中文到底有多少个字符？其实这个问题很难回答。CJK（CJK Unified Ideographs，中日韩统一表意文字）字符集中从0x4E00到0x9FA5 的连续区域，包含了 20902 个来自于中国、韩国、日本的汉字，涵盖了多数中文字符，可以说CJK是GB2312-80和BIG5等字符集的超集。<br> 0x4E00和0x9FA5分别对应中文中的哪个字呢？大家可以在网上使用Unicode转换器进行转换，其实在Word中使用【符号】对话框将可以进行查询，如下图所示。</p> 
<img src="https://images2.imgbox.com/ea/64/zJCleKgH_o.png" width="50%" height="50%"> 
<img src="https://images2.imgbox.com/06/e1/Q8OjnDFp_o.png" width="50%" height="50%"> 
<p>0x4E00对应汉字【一】，0x9FA5对应汉字【龥】，这个字属于古汉字，其读音为yù，使用拼音输入法，需要翻页N多次，才可以找到它。<br> <img src="https://images2.imgbox.com/86/22/BadFwlUd_o.png" width="50%" height="50%"><br> 在不同字体中，0x9FA5不一定是CJK统一汉字的最后一个字，例如下图还有之后的8个字符也属于CJK统一汉字，但是这些似乎都是偏旁部首，所以一般情况下使用<code>[一-龥]</code>匹配汉字就足够了。由于输入龥字比较麻烦，直接使用16进制的字符编码<code>[\u4e00-\u9fa5]</code>来表示中文字符集更加方便。<br> <img src="https://images2.imgbox.com/66/94/Ppp1lVcD_o.png" width="50%" height="50%"></p> 
<p>示例代码如下。</p> 
<pre><code>Sub RegExpChinese()
    Dim strTxt As String, strMsg As String
    Dim objRegEx As Object, objMatch As Object
    Dim j As Integer
    Set objRegEx = CreateObject("vbscript.regexp")
    'objRegEx.Pattern = "[^一-龥]"
    objRegEx.Pattern = "[^\u4e00-\u9fa5]"
    objRegEx.Global = True
    For Each c In Range([A1], Cells(Rows.Count, 1).End(xlUp))
        strTxt = Trim(c.Value)
        c.Offset(0, 1).Value = objRegEx.Replace(strTxt, "")
    Next
    Set objRegEx = Nothing
End Sub
</code></pre> 
<p>【代码解析】<br> 第6行代码使用后期绑定创建正则对象。<br> 第7行代码指定正则匹配字符串，用于匹配非中文字符，方括号中的<code>^</code>代表字符集的否定，即不包含指定字符集。<br> 第8行代码设置为全局搜索模式。<br> 第9行代码第12行代码循环处理工作表中的数据。<br> 第11行代码执行正则替换，并将替换后的结果写入工作表中。</p> 
<hr> 
<p>相关博文链接：<br> <a href="https://blog.csdn.net/taller_2000/article/details/88088378">VBA之正则表达式（1）-- 基础篇</a><br> <a href="https://blog.csdn.net/taller_2000/article/details/88097358">VBA之正则表达式（2）-- 批量修改公式</a><br> <a href="https://blog.csdn.net/taller_2000/article/details/88097536">VBA之正则表达式（3）-- 特殊公式计算</a><br> <a href="https://blog.csdn.net/taller_2000/article/details/88366081">VBA之正则表达式（4）-- 提取日期和金额</a><br> <a href="https://blog.csdn.net/taller_2000/article/details/88374471">VBA之正则表达式（5）-- 中文字符</a><br> <a href="https://blog.csdn.net/taller_2000/article/details/89505595">VBA之正则表达式（6）-- 设置音标格式</a><br> <a href="https://blog.csdn.net/taller_2000/article/details/89506634">VBA之正则表达式（7）-- 乾坤大挪移（数据整理） </a><br> <a href="https://blog.csdn.net/taller_2000/article/details/89735304">VBA之正则表达式（8）-- 重复字符分组</a><br> <a href="https://blog.csdn.net/taller_2000/article/details/89784517">VBA之正则表达式（9）-- 添加千分位（1/3） </a><br> <a href="https://blog.csdn.net/taller_2000/article/details/89792241">VBA之正则表达式（10）-- 添加千分位（2/3） </a><br> <a href="https://blog.csdn.net/taller_2000/article/details/89792990">VBA之正则表达式（11）-- 添加千分位（3/3） </a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2dbbc5fa2924d164f53f7aed376e9bb6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">打开office应用时报错：应用程序错误-(0xc0000142)--word, ppt, excel</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5f2de16df094e17a7281ac62e631e184/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python深度学习--预训练网络：特征提取和模型微调（接dogs_vs_cats）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>