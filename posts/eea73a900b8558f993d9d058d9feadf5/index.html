<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PowerShell系列（六）：PowerShell脚本执行策略梳理 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PowerShell系列（六）：PowerShell脚本执行策略梳理" />
<meta property="og:description" content="目录
1、执行策略等级
2、执行策略范围
3、执行策略命令语法格式
4、执行策略常用命令
PowerShell 是一种用于操作 系统的命令行界面，支持跨平台，它提供了许多功能来自动化和优化各种任务。PowerShell 是由微软官方开发的，并作为 Windows Server 操作系统的一部分提供。 使用 PowerShell，您可以执行许多运维操作，例如创建、编辑、查看和删除文件和文件夹，管理用户和计算机，配置网络设置，运行系统命令，自动化测试和部署等。今天继续给大家分享PowerShell系列教程。
上一篇文章讲解了PowerShell通过脚本方式运行笔记的相关知识，今天给大家介绍PowerShell脚本执行策略相关的知识，了解微软推出的PowerShell如何来保护运行脚本的安全。
PowerShell 脚本执行策略用于控制何时以及何种方式执行 PowerShell 脚本。通过执行策略可以限制 PowerShell 脚本的执行范围，为系统管理员提供一定的安全保障。策略可以限制执行脚本的用户、限制执行脚本的来源等等。这些策略可以在计算机本地或组策略中进行配置。最终保护计算机免受恶意脚本和非法操作的侵害。
今天给大家讲解PowerShell脚本执行策略相关的知识！
1、执行策略等级 AllSigned：要求所有脚本和配置文件都由受信任的发布者签名，包括在本地计算机上编写的脚本；从尚未分类为受信任或不受信任的发布者运行脚本之前，需要确认是否执行。Bypass：脚本执行没有任何限制RemoteSigned：本地计算机上的本地脚本，不需要数字签名直接允许；从Internet或其他计算机下载的脚本，需要脚本必须经过数字签名才能运行。Restricted：允许单个命令，但不允许脚本，它会阻止运行所有脚本文件。Undefined:当前范围没有执行策略。简单来说如果所有范围的执行策略都是Undefined的话，实际使用的测试和Default策略保持一致。Default：默认执行策略，Window客户端为Restricted；Windows服务器为RemoteSigned 。Unrestricted：脚本运行不受签名限制，如果脚本不来自本地 Intranet 区域的脚本和配置文件，运行之前会有警告 2、执行策略范围 MachinePolicy：由组策略为计算机的所有用户设置UserPolicy：由计算机当前用户的组策略设置Process：范围 Process 仅影响当前 PowerShell 会话;执行策略保存在环境变量 $env:PSExecutionPolicyPreference中，而不是注册表中。 关闭 PowerShell 会话时，变量和值将被删除。CurrentUser：执行策略仅影响当前用户。 它存储在 HKEY_CURRENT_USER 注册表子项中。LocalMachine：执行策略会影响当前计算机上的所有用户。 它存储在 HKEY_LOCAL_MACHINE 注册表子项中。 3、执行策略命令语法格式 Set-ExecutionPolicy [-ExecutionPolicy] [[-Scope] ] [-Force] [-WhatIf] [-Confirm] [] 参数说明：
-ExecutionPolicy ：指定执行策略-Scope：指定受执行策略影响的范围。 默认作用域为 LocalMachine。-Force：调整所有脚本提示，建议谨慎使用该参数。默认值为 None，可以指定为 False-WhatIf：显示运行该 cmdlet 时会发生什么情况。默认值为False。-Confirm：提示你在运行 cmdlet 之前进行确认。默认值是False。 4、执行策略常用命令 获取当前执行策略
Get-ExecutionPolicy 获取影响当前会话的所有执行策略
Get-ExecutionPolicy -List 调整脚本执行策略" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/eea73a900b8558f993d9d058d9feadf5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-12T13:46:29+08:00" />
<meta property="article:modified_time" content="2023-06-12T13:46:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PowerShell系列（六）：PowerShell脚本执行策略梳理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div></div> 
<div></div> 
<div> 
 <p id="main-toc"><strong>目录</strong></p> 
 <p id="1%E3%80%81%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E7%AD%89%E7%BA%A7-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E7%AD%89%E7%BA%A7" rel="nofollow">1、执行策略等级</a></p> 
 <p id="2%E3%80%81%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E8%8C%83%E5%9B%B4-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E8%8C%83%E5%9B%B4" rel="nofollow">2、执行策略范围</a></p> 
 <p id="3%E3%80%81%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E5%91%BD%E4%BB%A4%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F-toc" style="margin-left:40px;"><a href="#3%E3%80%81%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E5%91%BD%E4%BB%A4%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F" rel="nofollow">3、执行策略命令语法格式</a></p> 
 <p id="4%E3%80%81%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4-toc" style="margin-left:40px;"><a href="#4%E3%80%81%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4" rel="nofollow">4、执行策略常用命令</a></p> 
 <hr id="hr-toc"> 
 <p>PowerShell 是一种用于操作 系统的命令行界面，支持跨平台，它提供了许多功能来自动化和优化各种任务。PowerShell 是由微软官方开发的，并作为 Windows Server 操作系统的一部分提供。 使用 PowerShell，您可以执行许多运维操作，例如创建、编辑、查看和删除文件和文件夹，管理用户和计算机，配置网络设置，运行系统命令，自动化测试和部署等。今天继续给大家分享PowerShell系列教程。</p> 
 <p>上一篇文章讲解了PowerShell通过脚本方式运行笔记的相关知识，今天给大家介绍PowerShell脚本执行策略相关的知识，了解微软推出的PowerShell如何来保护运行脚本的安全。</p> 
 <p><img alt="" height="448" src="https://images2.imgbox.com/65/9d/mm6VX5Qv_o.png" width="1025"></p> 
</div> 
<div> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">PowerShell 脚本执行策略用于控制何时以及何种方式执行 PowerShell 脚本。通过执行策略可以限制 PowerShell 脚本的执行范围，为系统管理员提供一定的安全保障。策略可以限制执行脚本的用户、限制执行脚本的来源等等。这些策略可以在计算机本地或组策略中进行配置。最终保护计算机免受恶意脚本和非法操作的侵害。</span></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">今天给大家讲解PowerShell脚本执行策略相关的知识！</span></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <h3 id="1%E3%80%81%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E7%AD%89%E7%BA%A7" style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">1、执行策略等级</span></strong></h3> 
 <ul><li style="text-align:left;"><span style="color:#333333;">AllSigned：要求所有脚本和配置文件都由受信任的发布者签名，包括在本地计算机上编写的脚本；从尚未分类为受信任或不受信任的发布者运行脚本之前，需要确认是否执行。</span></li><li style="text-align:left;"><span style="color:#333333;">Bypass：脚本执行没有任何限制</span></li><li style="text-align:left;"><span style="color:#333333;">RemoteSigned：本地计算机上的本地脚本，不需要数字签名直接允许；从Internet或其他计算机下载的脚本，需要脚本必须经过数字签名才能运行。</span></li><li style="text-align:left;"><span style="color:#333333;">Restricted：允许单个命令，但不允许脚本，它会阻止运行所有脚本文件。</span></li><li style="text-align:left;"><span style="color:#333333;">Undefined:当前范围没有执行策略。简单来说如果所有范围的执行策略都是Undefined的话，实际使用的测试和Default策略保持一致。</span></li><li style="text-align:left;"><span style="color:#333333;">Default：默认执行策略，Window客户端为Restricted；Windows服务器为RemoteSigned 。</span></li><li style="text-align:left;"><span style="color:#333333;">Unrestricted：脚本运行不受签名限制，如果脚本不来自本地 Intranet 区域的脚本和配置文件，运行之前会有警告</span></li></ul> 
 <p style="margin-left:0;text-align:left;"></p> 
 <h3 id="2%E3%80%81%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E8%8C%83%E5%9B%B4" style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">2、执行策略范围</span></strong></h3> 
 <ul><li style="text-align:left;"><span style="color:#333333;">MachinePolicy：由组策略为计算机的所有用户设置</span></li><li style="text-align:left;"><span style="color:#333333;">UserPolicy：由计算机当前用户的组策略设置</span></li><li style="text-align:left;"><span style="color:#333333;">Process：范围 Process 仅影响当前 PowerShell 会话;执行策略保存在环境变量 $env:PSExecutionPolicyPreference中，而不是注册表中。 关闭 PowerShell 会话时，变量和值将被删除。</span></li><li style="text-align:left;"><span style="color:#333333;">CurrentUser：执行策略仅影响当前用户。 它存储在 HKEY_CURRENT_USER 注册表子项中。</span></li><li style="text-align:left;"><span style="color:#333333;">LocalMachine：执行策略会影响当前计算机上的所有用户。 它存储在 HKEY_LOCAL_MACHINE 注册表子项中。</span></li></ul> 
 <p style="margin-left:0px;text-align:center;"><img alt="" src="https://images2.imgbox.com/5a/3d/rWf35PIi_o.jpg"></p> 
 <p></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <h3 id="3%E3%80%81%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E5%91%BD%E4%BB%A4%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F" style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">3、执行策略命令语法格式</span></strong></h3> 
 <p style="margin-left:0;text-align:left;"></p> 
 <pre><span style="background-color:#fafafa;"><code><span style="color:#dd4a68;">Set-ExecutionPolicy</span>
   <span style="color:#999999;">[</span><span style="color:#9a6e3a;">-</span><span style="color:#000000;">ExecutionPolicy</span><span style="color:#999999;">]</span><span style="color:#000000;"> </span>
   <span style="color:#999999;">[[</span><span style="color:#9a6e3a;">-</span><span style="color:#000000;">Scope</span><span style="color:#999999;">]</span><span style="color:#000000;"> </span><span style="color:#999999;">]</span>
   <span style="color:#999999;">[</span><span style="color:#9a6e3a;">-</span><span style="color:#000000;">Force</span><span style="color:#999999;">]</span>
   <span style="color:#999999;">[</span><span style="color:#9a6e3a;">-</span><span style="color:#000000;">WhatIf</span><span style="color:#999999;">]</span>
   <span style="color:#999999;">[</span><span style="color:#9a6e3a;">-</span><span style="color:#000000;">Confirm</span><span style="color:#999999;">]</span>
   <span style="color:#999999;">[</span><span style="color:#999999;">]</span>

</code></span></pre> 
 <p></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">参数说明：</span></p> 
 <ul><li style="text-align:left;"><span style="color:#333333;">-ExecutionPolicy ：指定执行策略</span></li><li style="text-align:left;"><span style="color:#333333;">-Scope：指定受执行策略影响的范围。 默认作用域为 LocalMachine。</span></li><li style="text-align:left;"><span style="color:#333333;">-Force：调整所有脚本提示，建议谨慎使用该参数。默认值为 None，可以指定为 False</span></li><li style="text-align:left;"><span style="color:#333333;">-WhatIf：显示运行该 cmdlet 时会发生什么情况。默认值为False。</span></li><li style="text-align:left;"><span style="color:#333333;">-Confirm：提示你在运行 cmdlet 之前进行确认。默认值是False。</span></li></ul> 
 <p style="margin-left:0;text-align:left;"></p> 
 <h3 id="4%E3%80%81%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4" style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">4、执行策略常用命令</span></strong></h3> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">获取当前执行策略</span></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <pre><span style="background-color:#fafafa;"><code><span style="color:#dd4a68;">Get-ExecutionPolicy</span>
</code></span></pre> 
 <p></p> 
 <p class="img-center"><img alt="" src="https://images2.imgbox.com/0b/ec/to7sU4Ls_o.png"></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">获取影响当前会话的所有执行策略</span></p> 
 <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">Get-ExecutionPolicy -List</span>
</code></span></pre> 
 <p></p> 
 <p class="img-center"><img alt="" src="https://images2.imgbox.com/8e/be/3NlJbSr3_o.png"></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">调整脚本执行策略</span></p> 
 <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">Set-ExecutionPolicy ALLSIGNED</span>
</code></span></pre> 
 <p></p> 
 <p class="img-center"><img alt="" src="https://images2.imgbox.com/3d/e4/a48Hnxlt_o.png"></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">删除执行策略</span></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">若要删除特定范围的执行策略，请将执行策略设置为 Undefined。</span></p> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#161616;">注意：Windows 客户端的默认策略为</span></span><span style="color:#333333;">Restricted </span></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#</span><span style="color:#000000;">删除本地计算机所有用户的执行策略</span>
<span style="color:#000000;">Set-ExecutionPolicy -ExecutionPolicy Undefined -Scope LocalMachine</span>
</code></span></pre> 
 <p><strong>往期回顾</strong></p> 
 <p><br><a class="link-info" href="https://blog.csdn.net/xishining/article/details/130524280" title="PowerShell系列（一）：PowerShell介绍和cmd命令行的区别">PowerShell系列（一）：PowerShell介绍和cmd命令行的区别</a></p> 
 <p><a class="link-info" href="https://blog.csdn.net/xishining/article/details/130571977" title="PowerShell系列（二）：PowerShell和Python之间的差异介绍">PowerShell系列（二）：PowerShell和Python之间的差异介绍</a></p> 
 <p><a class="link-info" href="https://blog.csdn.net/xishining/article/details/130702980" title="PowerShell系列（三）：PowerShell发展历程梳理">PowerShell系列（三）：PowerShell发展历程梳理</a></p> 
 <p><a class="link-info" href="https://blog.csdn.net/xishining/article/details/130836734" title="PowerShell系列（四）：PowerShell进入交互环境的三种方式">PowerShell系列（四）：PowerShell进入交互环境的三种方式</a></p> 
 <p><a href="https://blog.csdn.net/xishining/article/details/131116560" title="PowerShell系列（五）：PowerShell通过脚本方式运行笔记_powershell脚本执行_IT技术分享社区的博客-CSDN博客">PowerShell系列（五）：PowerShell通过脚本方式运行笔记_powershell脚本执行_IT技术分享社区的博客-CSDN博客</a></p> 
 <p style="margin-left:0;text-align:left;"></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dd7db665f34f952a0c110f241037f97e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MindOpt Tuner调参器，提升求解速度、性能（二）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4ffc5e50e4fe54570596dd24a04b1e87/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">前端面试官：介绍一下less和scss，以及他们的区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>