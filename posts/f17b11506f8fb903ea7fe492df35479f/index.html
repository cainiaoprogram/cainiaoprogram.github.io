<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>解决Office组件调用时未找到“AxImp.exe”问题 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="解决Office组件调用时未找到“AxImp.exe”问题" />
<meta property="og:description" content="今天做Windows编程实验时，需要调用word和excel的com。但是发现不停的报错，而且很多dll文件找不到。这里记录一下最后感觉有用的两个方法。
环境：vs 2019 commuity,Office 2016专业增强版64位版。
1.通过VSTO找office各个dll的路径 这个世界上最可怕的就是打开软件安装目录发现找不到dll了。一度让我认为我是不是必须要重新安装Office才能做这个实验。不过后来突然想到了微软早已单独研发出了专门适用于Office开发的项目类型——VSTO。于是我先用打开Visual Studio Installer加入了对VSTO项目的支持。然后创建了一个新的word vsto外接程序。
然后我们运行一下，vs会打开word。说明我们的vsto程序创建成功了。好了，我也没有认真研究vsto，我们还是看怎么找dll。
既然能成功打开word说明vs肯定已经帮我们把各种引用添加好了，我们看看解决方案资源管理器，果不其然各种引用都已经被正常添加到了项目中。
这就很好办了，点开Microsoft.Office.Interop.Word，然后打开属性视图找找路径。
其实这个给人的感觉像是这个项目框架安装时新加入的dll而非电脑上本来的Office自带的。但是管它呢？能打开word让我开始做实验就ok了。重新创建自己的实验项目，然后干脆把那个路径文件夹下的所有dll全部添加进去引用。
2.根据调试信息下载sdk 上一步做完后，word实验可以做了。但之后做excel实验的时候，发现添加System.drawing竟然也有问题，不由得让我怀疑可能确实是我本身环境没有配好。
于是认真阅读报错信息
MSB3091 任务失败，因为未找到“AxImp.exe”，或未安装正确的 Microsoft Windows SDK。任务正在注册表项 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SDKs\NETFXSDK\4.7.2\WinSDK-NetFx40Tools-x86 的 InstallationFolder 值中所指定位置下的“bin”子目录中查找“AxImp.exe”。
通过执行下列操作之一可以解决此问题:
安装 Microsoft Windows SDK。安装 Visual Studio 2010。手动向正确的位置设置上面的注册表项。将正确的位置传入任务的“ToolPath”参数中。 这个报错确实是让人很头大，因为我注册表从Microsoft SDKs这层开始就没有它下面说的那些目录了。手动添加我也找不到要添加进去的东西呀。
然后查看Visual Studio Installer的.Net桌面开发。.Net 4.7.2开发工具是必选项不存在没有安装的情况。这还让我说什么。
漫无目的的各种翻，翻到了Visual Studio Installer的单个组件列表。发现了问题。
这个SDK原来是没有装的。这就说的过去了。下载安装就完事了。但是这个不在安装.NET开发平台的时候直接安装sdk而且之后还不提示的操作真的是让我。。安装完成后一切正常运行。
结尾 心情不好没有结尾。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f17b11506f8fb903ea7fe492df35479f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-11-02T18:18:48+08:00" />
<meta property="article:modified_time" content="2019-11-02T18:18:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">解决Office组件调用时未找到“AxImp.exe”问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>今天做Windows编程实验时，需要调用word和excel的com。但是发现不停的报错，而且很多dll文件找不到。这里记录一下最后感觉有用的两个方法。</p> 
<p>环境：vs 2019 commuity,Office 2016专业增强版64位版。</p> 
<h3><a id="1VSTOofficedll_4"></a>1.通过VSTO找office各个dll的路径</h3> 
<p>这个世界上最可怕的就是打开软件安装目录发现找不到dll了。一度让我认为我是不是必须要重新安装Office才能做这个实验。不过后来突然想到了微软早已单独研发出了专门适用于Office开发的项目类型——VSTO。于是我先用打开Visual Studio Installer加入了对VSTO项目的支持。然后创建了一个新的word vsto外接程序。<br> <img src="https://images2.imgbox.com/91/72/NGqlyxTH_o.png" alt="在这里插入图片描述"><br> 然后我们运行一下，vs会打开word。说明我们的vsto程序创建成功了。好了，我也没有认真研究vsto，我们还是看怎么找dll。</p> 
<p>既然能成功打开word说明vs肯定已经帮我们把各种引用添加好了，我们看看解决方案资源管理器，果不其然各种引用都已经被正常添加到了项目中。</p> 
<p><img src="https://images2.imgbox.com/0f/10/ndspK1V0_o.png" alt="在这里插入图片描述"><br> 这就很好办了，点开Microsoft.Office.Interop.Word，然后打开属性视图找找路径。</p> 
<p><img src="https://images2.imgbox.com/ee/38/rxc9v2e2_o.png" alt="在这里插入图片描述"><br> 其实这个给人的感觉像是这个项目框架安装时新加入的dll而非电脑上本来的Office自带的。但是管它呢？能打开word让我开始做实验就ok了。重新创建自己的实验项目，然后干脆把那个路径文件夹下的所有dll全部添加进去引用。</p> 
<h3><a id="2sdk_17"></a>2.根据调试信息下载sdk</h3> 
<p>上一步做完后，word实验可以做了。但之后做excel实验的时候，发现添加System.drawing竟然也有问题，不由得让我怀疑可能确实是我本身环境没有配好。</p> 
<p>于是认真阅读报错信息</p> 
<blockquote> 
 <p>MSB3091 任务失败，因为未找到“AxImp.exe”，或未安装正确的 Microsoft Windows SDK。任务正在注册表项 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SDKs\NETFXSDK\4.7.2\WinSDK-NetFx40Tools-x86 的 InstallationFolder 值中所指定位置下的“bin”子目录中查找“AxImp.exe”。<br> 通过执行下列操作之一可以解决此问题:</p> 
 <ol><li>安装 Microsoft Windows SDK。</li><li>安装 Visual Studio 2010。</li><li>手动向正确的位置设置上面的注册表项。</li><li>将正确的位置传入任务的“ToolPath”参数中。</li></ol> 
</blockquote> 
<p>这个报错确实是让人很头大，因为我注册表从Microsoft SDKs这层开始就没有它下面说的那些目录了。手动添加我也找不到要添加进去的东西呀。</p> 
<p>然后查看Visual Studio Installer的.Net桌面开发。.Net 4.7.2开发工具是必选项不存在没有安装的情况。这还让我说什么。</p> 
<p><img src="https://images2.imgbox.com/80/fc/Vuf1HS3u_o.png" alt="在这里插入图片描述"><br> 漫无目的的各种翻，翻到了Visual Studio Installer的单个组件列表。发现了问题。<br> <img src="https://images2.imgbox.com/4d/b5/Q78FXuvR_o.png" alt="在这里插入图片描述"><br> 这个SDK原来是没有装的。这就说的过去了。下载安装就完事了。但是这个不在安装.NET开发平台的时候直接安装sdk而且之后还不提示的操作真的是让我。。安装完成后一切正常运行。</p> 
<h3><a id="_38"></a>结尾</h3> 
<p>心情不好没有结尾。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/22dececfa9c4cdf56ab201518de36dfd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">php 在字符串中 特定位置 插入 字符串</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4f43fefbc581f230e7ee94fa428f788f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">每日一题-涂色问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>