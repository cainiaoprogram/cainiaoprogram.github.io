<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>windows配置使用supervisor - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="windows配置使用supervisor" />
<meta property="og:description" content="提示：文章写完后，目录可以自动生成，如何生成可参考右边的帮助文档
文章目录 前言一、使用步骤1.安装supervisor-win2.配置supervisord3.配置program4.启动supervisord.exe5.supervisorctl.exe管控 二、后台启动总结 前言 windows使用supervisor和linux略有不同，严格来说比linux略难，而且不是所有的特性都支持。
一、使用步骤 1.安装supervisor-win 其实有一个纯exe版本的supervisor，但是实际使用起来比python版的功能差些。所以，经过对比还是supervisor-win更有性价比。
建议使用anaconda3，因为本篇文章基于annaconda3，原生python目录请自行查找，这里不再赘述。
pip install supervisor-win -i https://mirrors.aliyun.com/pypi/simple 安装完成后在anaconda的Scripts下面有exe文件。用到的就红框括起来的几个exe。
2.配置supervisord 使用过linux的都知道/etc/supervisor.conf是配置文件，windows上的配置文件需要用命令生成。
echo_supervisord_conf.exe &gt; D:\supervisord.conf 可以指定目录，不一定非得是D盘。
3.配置program 直接在supervisord.conf里面填就行了。下面是conf示例：
[program:theprogramname] command=cmd.exe ; the program (relative uses PATH, can take args) directory=%(ENV_TMP)s ; directory to cwd to before exec (def no cwd) autostart=true ; start at supervisord start (default: true) startsecs=1 ; # of secs prog must stay up to be running (def. 1) startretries=3 ; max # of serial start failures when starting (default 3) autorestart=unexpected ; when to restart if exited after running (def: unexpected) redirect_stderr=true ; redirect proc stderr to stdout (default false) stdout_logfile=a\\path ; stdout log path, NONE for none; default AUTO stdout_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) stdout_logfile_backups=10 ; # of stdout logfile backups (0 means none, default 10) 在supervisord." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ab6d4dd380cb5d2c87bb817f3d13a730/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T15:29:23+08:00" />
<meta property="article:modified_time" content="2024-01-05T15:29:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">windows配置使用supervisor</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>提示：文章写完后，目录可以自动生成，如何生成可参考右边的帮助文档</p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_7" rel="nofollow">前言</a></li><li><a href="#_12" rel="nofollow">一、使用步骤</a></li><li><ul><li><a href="#1supervisorwin_13" rel="nofollow">1.安装supervisor-win</a></li><li><a href="#2supervisord_25" rel="nofollow">2.配置supervisord</a></li><li><a href="#3program_34" rel="nofollow">3.配置program</a></li><li><a href="#4supervisordexe_66" rel="nofollow">4.启动supervisord.exe</a></li><li><a href="#5supervisorctlexe_117" rel="nofollow">5.supervisorctl.exe管控</a></li></ul> 
  </li><li><a href="#_135" rel="nofollow">二、后台启动</a></li><li><a href="#_148" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_7"></a>前言</h2> 
<p>windows使用supervisor和linux略有不同，严格来说比linux略难，而且不是所有的特性都支持。</p> 
<hr> 
<h2><a id="_12"></a>一、使用步骤</h2> 
<h3><a id="1supervisorwin_13"></a>1.安装supervisor-win</h3> 
<p>其实有一个纯exe版本的supervisor，但是实际使用起来比python版的功能差些。所以，经过对比还是supervisor-win更有性价比。</p> 
<p>建议使用anaconda3，因为本篇文章基于annaconda3，原生python目录请自行查找，这里不再赘述。</p> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> supervisor-win <span class="token parameter variable">-i</span> https://mirrors.aliyun.com/pypi/simple
</code></pre> 
<p>安装完成后在anaconda的Scripts下面有exe文件。用到的就红框括起来的几个exe。<br> <img src="https://images2.imgbox.com/2e/c3/jqHW9tLv_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2supervisord_25"></a>2.配置supervisord</h3> 
<p>使用过linux的都知道/etc/supervisor.conf是配置文件，windows上的配置文件需要用命令生成。</p> 
<pre><code class="prism language-bash">echo_supervisord_conf.exe <span class="token operator">&gt;</span> D:<span class="token punctuation">\</span>supervisord.conf
</code></pre> 
<p>可以指定目录，不一定非得是D盘。</p> 
<h3><a id="3program_34"></a>3.配置program</h3> 
<p>直接在supervisord.conf里面填就行了。下面是conf示例：</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>program:theprogramname<span class="token punctuation">]</span>
<span class="token assign-left variable">command</span><span class="token operator">=</span>cmd.exe               <span class="token punctuation">;</span> the program <span class="token punctuation">(</span>relative uses <span class="token environment constant">PATH</span>, can take args<span class="token punctuation">)</span>
<span class="token assign-left variable">directory</span><span class="token operator">=</span>%<span class="token punctuation">(</span>ENV_TMP<span class="token punctuation">)</span>s         <span class="token punctuation">;</span> directory to cwd to before <span class="token builtin class-name">exec</span> <span class="token punctuation">(</span>def no cwd<span class="token punctuation">)</span>
<span class="token assign-left variable">autostart</span><span class="token operator">=</span>true                <span class="token punctuation">;</span> start at supervisord start <span class="token punctuation">(</span>default: <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token assign-left variable">startsecs</span><span class="token operator">=</span><span class="token number">1</span>                   <span class="token punctuation">;</span> <span class="token comment"># of secs prog must stay up to be running (def. 1)</span>
<span class="token assign-left variable">startretries</span><span class="token operator">=</span><span class="token number">3</span>                <span class="token punctuation">;</span> max <span class="token comment"># of serial start failures when starting (default 3)</span>
<span class="token assign-left variable">autorestart</span><span class="token operator">=</span>unexpected        <span class="token punctuation">;</span> when to restart <span class="token keyword">if</span> exited after running <span class="token punctuation">(</span>def: unexpected<span class="token punctuation">)</span>
<span class="token assign-left variable">redirect_stderr</span><span class="token operator">=</span>true          <span class="token punctuation">;</span> redirect proc stderr to stdout <span class="token punctuation">(</span>default <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token assign-left variable">stdout_logfile</span><span class="token operator">=</span>a<span class="token punctuation">\</span><span class="token punctuation">\</span>path        <span class="token punctuation">;</span> stdout log path, NONE <span class="token keyword">for</span> none<span class="token punctuation">;</span> default AUTO
<span class="token assign-left variable">stdout_logfile_maxbytes</span><span class="token operator">=</span>1MB   <span class="token punctuation">;</span> max <span class="token comment"># logfile bytes b4 rotation (default 50MB)</span>
<span class="token assign-left variable">stdout_logfile_backups</span><span class="token operator">=</span><span class="token number">10</span>     <span class="token punctuation">;</span> <span class="token comment"># of stdout logfile backups (0 means none, default 10)</span>
</code></pre> 
<p><code>在supervisord.conf里面 ; 符号是行注释的意思，去掉行注释，这一行就会被supervidord.exe解析。</code></p> 
<p>字段解释：<br> [program:theprogramname] ： 固定写法，theprogramname是程序名字，英文。<br> command ： 需要执行的命令，建议使用<code>绝对路径</code>，而且必须是linux那种<code>正斜杠 / 分割目录</code><br> directory ： 工作目录<br> autostart ： 自动启动，默认开启<br> startsecs ： 程序至少需要维持1秒才被认为启动成功<br> startretries ： 启动失败尝试次数<br> autorestart ： 自动重新启动，如果程序意外退出生效（保活功能）<br> redirect_stderr ： 重定向标准错误日志输出到标准输出，也可以单独输出，依据喜好。<br> stdout_logfile ： 标准输出目录，可以是反斜杠。<code>目录一定要存在，否则报错。</code><br> stdout_logfile_maxbytes ： 单文件最大空间，超过了另起一个文件<br> stdout_logfile_backups ： 最多保持的日志文件数</p> 
<h3><a id="4supervisordexe_66"></a>4.启动supervisord.exe</h3> 
<p>配置好了，就可以管控程序了，实测exe程序都可以管控，<code>有些bat报错，还在研究原因</code>。</p> 
<p>再此之前还需要改supervidsord.conf的两个地方，这样supervisorctl.exe才能正常工作，没错supervisorctl.exe和supervisord.exe是通过网络连接的。</p> 
<pre><code class="prism language-bash"><span class="token comment">#默认的配置</span>
<span class="token punctuation">;</span><span class="token punctuation">[</span>inet_http_server<span class="token punctuation">]</span>         <span class="token punctuation">;</span> inet <span class="token punctuation">(</span>TCP<span class="token punctuation">)</span> server disabled by default
<span class="token punctuation">;</span><span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">127.0</span>.0.1:9001        <span class="token punctuation">;</span> ip_address:port specifier, *:port <span class="token keyword">for</span> all iface
<span class="token punctuation">;</span><span class="token assign-left variable">username</span><span class="token operator">=</span>user              <span class="token punctuation">;</span> default is no username <span class="token punctuation">(</span>open server<span class="token punctuation">)</span>
<span class="token punctuation">;</span><span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token number">123</span>               <span class="token punctuation">;</span> default is no password <span class="token punctuation">(</span>open server<span class="token punctuation">)</span>

<span class="token comment">#改为</span>
<span class="token punctuation">[</span>inet_http_server<span class="token punctuation">]</span>         <span class="token punctuation">;</span> inet <span class="token punctuation">(</span>TCP<span class="token punctuation">)</span> server disabled by default
<span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">127.0</span>.0.1:9001        <span class="token punctuation">;</span> ip_address:port specifier, *:port <span class="token keyword">for</span> all iface
<span class="token punctuation">;</span><span class="token assign-left variable">username</span><span class="token operator">=</span>user              <span class="token punctuation">;</span> default is no username <span class="token punctuation">(</span>open server<span class="token punctuation">)</span>
<span class="token punctuation">;</span><span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token number">123</span>               <span class="token punctuation">;</span> default is no password <span class="token punctuation">(</span>open server<span class="token punctuation">)</span>

</code></pre> 
<p>需要用户名密码就解开username和password的注释。</p> 
<pre><code class="prism language-bash"><span class="token comment">#默认配置</span>
<span class="token punctuation">[</span>supervisorctl<span class="token punctuation">]</span>
<span class="token punctuation">;</span><span class="token assign-left variable">serverurl</span><span class="token operator">=</span>http://127.0.0.1:9001 <span class="token punctuation">;</span> use an http:// url to specify an inet socket
<span class="token punctuation">;</span><span class="token assign-left variable">username</span><span class="token operator">=</span>chris              <span class="token punctuation">;</span> should be same as <span class="token keyword">in</span> <span class="token punctuation">[</span>*_http_server<span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token builtin class-name">set</span>
<span class="token punctuation">;</span><span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token number">123</span>                <span class="token punctuation">;</span> should be same as <span class="token keyword">in</span> <span class="token punctuation">[</span>*_http_server<span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token builtin class-name">set</span>
<span class="token punctuation">;</span><span class="token assign-left variable">prompt</span><span class="token operator">=</span>mysupervisor         <span class="token punctuation">;</span> cmd line prompt <span class="token punctuation">(</span>default <span class="token string">"supervisor"</span><span class="token punctuation">)</span>
<span class="token punctuation">;</span><span class="token assign-left variable">history_file</span><span class="token operator">=~</span>/.sc_history  <span class="token punctuation">;</span> use readline <span class="token function">history</span> <span class="token keyword">if</span> available

<span class="token comment">#改为</span>
<span class="token punctuation">[</span>supervisorctl<span class="token punctuation">]</span>
<span class="token assign-left variable">serverurl</span><span class="token operator">=</span>http://127.0.0.1:9001 <span class="token punctuation">;</span> use an http:// url to specify an inet socket
<span class="token punctuation">;</span><span class="token assign-left variable">username</span><span class="token operator">=</span>chris              <span class="token punctuation">;</span> should be same as <span class="token keyword">in</span> <span class="token punctuation">[</span>*_http_server<span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token builtin class-name">set</span>
<span class="token punctuation">;</span><span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token number">123</span>                <span class="token punctuation">;</span> should be same as <span class="token keyword">in</span> <span class="token punctuation">[</span>*_http_server<span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token builtin class-name">set</span>
<span class="token punctuation">;</span><span class="token assign-left variable">prompt</span><span class="token operator">=</span>mysupervisor         <span class="token punctuation">;</span> cmd line prompt <span class="token punctuation">(</span>default <span class="token string">"supervisor"</span><span class="token punctuation">)</span>
<span class="token punctuation">;</span><span class="token assign-left variable">history_file</span><span class="token operator">=~</span>/.sc_history  <span class="token punctuation">;</span> use readline <span class="token function">history</span> <span class="token keyword">if</span> available
</code></pre> 
<p>需要用户名密码就解开username和password的注释。</p> 
<p>就这样基础配置基本完事了，需要其他功能的自行配置。</p> 
<p>启动supervisord.exe才能管控程序</p> 
<pre><code class="prism language-bash">‪D:<span class="token punctuation">\</span>conda<span class="token punctuation">\</span>envs<span class="token punctuation">\</span>supervisord<span class="token punctuation">\</span>Scripts<span class="token punctuation">\</span>supervisord.exe <span class="token parameter variable">-c</span> D:<span class="token punctuation">\</span>conda<span class="token punctuation">\</span>envs<span class="token punctuation">\</span>supervisord<span class="token punctuation">\</span>Scripts<span class="token punctuation">\</span>supervisord.conf
</code></pre> 
<p><code>这种启动方式是前台启动，cmd关掉就没了。</code></p> 
<h3><a id="5supervisorctlexe_117"></a>5.supervisorctl.exe管控</h3> 
<pre><code class="prism language-bash"><span class="token comment">#重新加载，修改了supervisord.conf必须reload</span>
D:<span class="token punctuation">\</span>conda<span class="token punctuation">\</span>envs<span class="token punctuation">\</span>supervisord<span class="token punctuation">\</span>Scripts<span class="token punctuation">\</span>supervisorctl.exe reload

<span class="token comment">#查看状态</span>
D:<span class="token punctuation">\</span>conda<span class="token punctuation">\</span>envs<span class="token punctuation">\</span>supervisord<span class="token punctuation">\</span>Scripts<span class="token punctuation">\</span>supervisorctl.exe status

<span class="token comment">#启动程序</span>
D:<span class="token punctuation">\</span>conda<span class="token punctuation">\</span>envs<span class="token punctuation">\</span>supervisord<span class="token punctuation">\</span>Scripts<span class="token punctuation">\</span>supervisorctl.exe start <span class="token operator">&lt;</span>program name<span class="token operator">&gt;</span>

<span class="token comment">#停止程序</span>
D:<span class="token punctuation">\</span>conda<span class="token punctuation">\</span>envs<span class="token punctuation">\</span>supervisord<span class="token punctuation">\</span>Scripts<span class="token punctuation">\</span>supervisorctl.exe stop <span class="token operator">&lt;</span>program name<span class="token operator">&gt;</span>
</code></pre> 
<p>这里不多介绍了，基本和linux差不多。</p> 
<h2><a id="_135"></a>二、后台启动</h2> 
<p>有好几种方法，这里介绍一种vbs方法</p> 
<p>supervisord.vbs</p> 
<pre><code class="prism language-bash">Set ws <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"Wscript.Shell"</span><span class="token punctuation">)</span>
ws.run <span class="token string">"D:\Work\Anaconda<span class="token entity" title="\e">\e</span>nvs\supervisord\Scripts\supervisord.exe -c D:<span class="token entity" title="\c">\c</span>onda<span class="token entity" title="\e">\e</span>nvs\supervisord\Scripts\supervisord.conf"</span>,vbhide
</code></pre> 
<p>双击supervisord.vbs，supervisord.exe就在后台启动了，解析来就可以使用supervisorctl.exe管控了。</p> 
<hr> 
<h2><a id="_148"></a>总结</h2> 
<p>1、比linux上的略差些，但是基本功能都有，可以满足使用需求。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d2f8364c77b74977a18a4d734e0b7c10/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用Python实现神经网络（附完整代码）！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5c882af4809a50e88b9b3a2079dced50/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">第九章 关系查询和优化查询——（数据库系统原理不挂科系列，数据库期末看完必过——思维导图Thanks♪(･ω･)ﾉ）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>