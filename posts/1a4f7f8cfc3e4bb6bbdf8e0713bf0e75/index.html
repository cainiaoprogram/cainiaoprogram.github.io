<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>nodejs实现文件同步服务器,Nodejs实现多文件夹文件同步 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="nodejs实现文件同步服务器,Nodejs实现多文件夹文件同步" />
<meta property="og:description" content="本文实例为大家分享了Nodejs实现多文件夹文件同步的具体代码，供大家参考，具体内容如下
package.json
{
&#34;name&#34;: &#34;asyncFile&#34;,
&#34;version&#34;: &#34;0.0.1&#34;,
&#34;dependencies&#34;:{
&#34;fs-sync&#34;:&#34;&#34;,
&#34;later&#34;:&#34;&#34;
}
}
asycnFile.js
var fsSync = require(&#39;fs-sync&#39;);
var fs = require(&#39;fs&#39;);
var util = require(&#34;util&#34;);
var later = require(&#34;later&#34;);
//需要同步的文件夹路径
var path = {
&#34;pathOne&#34;: &#34;/home/lincoln/testAsync/dirOne/&#34;,
&#34;pathTwo&#34;: &#34;/home/lincoln/testAsync/dirTwo/&#34;
};
//需要同步的文件夹名称
var asyncDir = [&#34;img&#34;, &#34;music&#34;];
var dirFilesOne;
var dirFilesTwo;
//读取文件夹信息
function readDir(dirName){
dirFilesOne = fs.readdirSync(path.pathOne &#43; dirName);
dirFilesTwo = fs.readdirSync(path.pathTwo &#43; dirName);
}
//使用fs-sync模块拷贝文件信息
function useFileCopy(sourcePath,distPath,copyFiles) {
for(var index in copyFiles){" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1a4f7f8cfc3e4bb6bbdf8e0713bf0e75/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-09T21:53:32+08:00" />
<meta property="article:modified_time" content="2021-08-09T21:53:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">nodejs实现文件同步服务器,Nodejs实现多文件夹文件同步</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>本文实例为大家分享了Nodejs实现多文件夹文件同步的具体代码，供大家参考，具体内容如下</p> 
 <p>package.json</p> 
 <p>{<!-- --></p> 
 <p>"name": "asyncFile",</p> 
 <p>"version": "0.0.1",</p> 
 <p>"dependencies":{<!-- --></p> 
 <p>"fs-sync":"",</p> 
 <p>"later":""</p> 
 <p>}</p> 
 <p>}</p> 
 <p>asycnFile.js</p> 
 <p>var fsSync = require('fs-sync');</p> 
 <p>var fs = require('fs');</p> 
 <p>var util = require("util");</p> 
 <p>var later = require("later");</p> 
 <p>//需要同步的文件夹路径</p> 
 <p>var path = {<!-- --></p> 
 <p>"pathOne": "/home/lincoln/testAsync/dirOne/",</p> 
 <p>"pathTwo": "/home/lincoln/testAsync/dirTwo/"</p> 
 <p>};</p> 
 <p>//需要同步的文件夹名称</p> 
 <p>var asyncDir = ["img", "music"];</p> 
 <p>var dirFilesOne;</p> 
 <p>var dirFilesTwo;</p> 
 <p>//读取文件夹信息</p> 
 <p>function readDir(dirName){<!-- --></p> 
 <p>dirFilesOne = fs.readdirSync(path.pathOne + dirName);</p> 
 <p>dirFilesTwo = fs.readdirSync(path.pathTwo + dirName);</p> 
 <p>}</p> 
 <p>//使用fs-sync模块拷贝文件信息</p> 
 <p>function useFileCopy(sourcePath,distPath,copyFiles) {<!-- --></p> 
 <p>for(var index in copyFiles){<!-- --></p> 
 <p>fsSync.copy(sourcePath+copyFiles[index],distPath+copyFiles[index])</p> 
 <p>}</p> 
 <p>}</p> 
 <p>//统计需要同步的文件信息</p> 
 <p>function needCopyFiles(sourceFiles, distFiles) {<!-- --></p> 
 <p>var needCopyFiles = [];</p> 
 <p>for (var index in sourceFiles) {<!-- --></p> 
 <p>if (distFiles.indexOf(sourceFiles[index]) == -1) {<!-- --></p> 
 <p>needCopyFiles.push(sourceFiles[index]);</p> 
 <p>console.log("needAsyncFile--&gt;"+sourceFiles[index]);</p> 
 <p>}</p> 
 <p>}</p> 
 <p>return needCopyFiles;</p> 
 <p>}</p> 
 <p>//同步文件</p> 
 <p>function copyFile(dirName) {<!-- --></p> 
 <p>var sourcePath = path.pathOne + dirName +"/";</p> 
 <p>var distPath = path.pathTwo + dirName +"/";</p> 
 <p>readDir(dirName)</p> 
 <p>useFileCopy(sourcePath,distPath,needCopyFiles(dirFilesOne,dirFilesTwo));</p> 
 <p>readDir(dirName);</p> 
 <p>useFileCopy(distPath,sourcePath,needCopyFiles(dirFilesTwo,dirFilesOne));</p> 
 <p>}</p> 
 <p>//for (var index in asyncDir) {<!-- --></p> 
 <p>// //console.log(asyncDir[index])</p> 
 <p>// console.log(new Date() +" 执行同步---&gt;"+asyncDir[index])</p> 
 <p>// copyFile(asyncDir[index]);</p> 
 <p>//}</p> 
 <p>var sched = later.parse.recur().every(10).second(),</p> 
 <p>t = later.setInterval(function() {<!-- --></p> 
 <p>for (var index in asyncDir) {<!-- --></p> 
 <p>//console.log(asyncDir[index])</p> 
 <p>console.log(new Date() +" 执行同步---&gt;"+asyncDir[index]);</p> 
 <p>copyFile(asyncDir[index]);</p> 
 <p>}</p> 
 <p>}, sched);</p> 
 <p>代码只是能用，菜鸟写法，等js这块有深入理解了之后，再修改这块的代码，也希望js大牛指点。</p> 
 <p>以上就是本文的全部内容，希望对大家的学习有所帮助，也希望大家多多支持脚本之家。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d46875e5b6c86b6bffecd70c82c4daec/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">fifa足球世界服务器不稳定,FIFA足球世界卡顿原因 卡顿解决方法一览</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/63b01391bb542ecf4c30371d25944fcf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">服务器架设成功后,重装系统,服务器系统重装后要配置吗</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>