<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>WEB：探索开源OFD.js技术应用 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="WEB：探索开源OFD.js技术应用" />
<meta property="og:description" content="1、简述 OFD.js 是一个由开源社区维护的 JavaScript 库，专注于在浏览器中渲染和处理 OFD 文件。OFD 作为一种开放式的文档格式，被广泛应用于电子政务、电子合同等领域。OFD.js 的出现为开发者提供了一个强大的工具，使得在前端实现 OFD 文件的展示和交互变得更加简单和灵活。
2、技术特点 OFD 标准支持
OFD.js 严格遵循 OFD 标准，能够准确解析 OFD 文件，实现对各种 OFD 版本和规范的兼容性。
基于 Web 技术
OFD.js 利用 HTML5、Canvas 等标准的 Web 技术，实现在浏览器中高效渲染 OFD 文件。这种基于 Web 的设计使得 OFD.js 具备良好的跨平台性和兼容性。
多层次渲染
OFD 文件通常包含多个层次的图形元素，例如文字、图片、矢量图等。OFD.js 提供了多层次的渲染能力，确保在展示 OFD 文件时保持图像的清晰和准确。
交互性
OFD.js 支持对 OFD 文件中的交互元素进行处理，如超链接、表单等，使得用户能够在浏览器中更加直观地与 OFD 文件进行交互。
3、下载 OFD.js 作为一个开源项目，得到了全球开发者社区的关注和支持。这意味着你可以从开源社区中获得反馈、解决问题，并参与到 OFD.js 的开发和改进中。 网络上的版本很多，但是真正一直维护的比较少，这边推荐的也是比较经常维护的：
Gitee 地址：https://gitee.com/Donal/ofd.js
直接点击下载或者通过git指令下载：
git clone https://gitee.com/Donal/ofd.js.git 当前ofd预览有些以图片为主的ofd文件兼容性不是很好，如果有遇到这种Ofd无法打开可以使用以下开源插件：
git clone https://gitee.com/gaoxingzaq/ofdview.git 这个有水印和页数限制，能不能破解看你自己了哈，都是js脚本。
4、应用 OFD.js 设计简洁，以轻量化为目标，使得在浏览器中加载和渲染 OFD 文件时能够保持高性能。首先要在本地安装Nodejs环境。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f336fca3f4580cdd18030eb737ca4d14/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-02T11:45:31+08:00" />
<meta property="article:modified_time" content="2024-01-02T11:45:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">WEB：探索开源OFD.js技术应用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="1_0"></a>1、简述</h4> 
<p>OFD.js 是一个由开源社区维护的 JavaScript 库，专注于在浏览器中渲染和处理 OFD 文件。OFD 作为一种开放式的文档格式，被广泛应用于电子政务、电子合同等领域。OFD.js 的出现为开发者提供了一个强大的工具，使得在前端实现 OFD 文件的展示和交互变得更加简单和灵活。</p> 
<h4><a id="2_3"></a>2、技术特点</h4> 
<ul><li> <p>OFD 标准支持<br> OFD.js 严格遵循 OFD 标准，能够准确解析 OFD 文件，实现对各种 OFD 版本和规范的兼容性。</p> </li><li> <p>基于 Web 技术<br> OFD.js 利用 HTML5、Canvas 等标准的 Web 技术，实现在浏览器中高效渲染 OFD 文件。这种基于 Web 的设计使得 OFD.js 具备良好的跨平台性和兼容性。</p> </li><li> <p>多层次渲染<br> OFD 文件通常包含多个层次的图形元素，例如文字、图片、矢量图等。OFD.js 提供了多层次的渲染能力，确保在展示 OFD 文件时保持图像的清晰和准确。</p> </li><li> <p>交互性<br> OFD.js 支持对 OFD 文件中的交互元素进行处理，如超链接、表单等，使得用户能够在浏览器中更加直观地与 OFD 文件进行交互。</p> </li></ul> 
<h4><a id="3_16"></a>3、下载</h4> 
<p>OFD.js 作为一个开源项目，得到了全球开发者社区的关注和支持。这意味着你可以从开源社区中获得反馈、解决问题，并参与到 OFD.js 的开发和改进中。 网络上的版本很多，但是真正一直维护的比较少，这边推荐的也是比较经常维护的：</p> 
<p>Gitee 地址：<a href="https://gitee.com/Donal/ofd.js" rel="nofollow">https://gitee.com/Donal/ofd.js</a></p> 
<p><img src="https://images2.imgbox.com/4c/9b/lGRkWyvD_o.png" alt="在这里插入图片描述"><br> 直接点击下载或者通过git指令下载：</p> 
<pre><code class="prism language-bash"><span class="token function">git</span> clone https://gitee.com/Donal/ofd.js.git
</code></pre> 
<p>当前ofd预览有些以图片为主的ofd文件兼容性不是很好，如果有遇到这种Ofd无法打开可以使用以下开源插件：</p> 
<pre><code class="prism language-bash"><span class="token function">git</span> clone https://gitee.com/gaoxingzaq/ofdview.git
</code></pre> 
<p>这个有水印和页数限制，能不能破解看你自己了哈，都是js脚本。</p> 
<h4><a id="4_34"></a>4、应用</h4> 
<p>OFD.js 设计简洁，以轻量化为目标，使得在浏览器中加载和渲染 OFD 文件时能够保持高性能。首先要在本地安装Nodejs环境。</p> 
<h5><a id="41__37"></a>4.1 本地打开</h5> 
<p>通过npm指令来运行当前vue的页面UI:</p> 
<pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span>
</code></pre> 
<p>然后通过run指令来运行：</p> 
<pre><code class="prism language-bash"><span class="token function">npm</span> run serve
</code></pre> 
<p><img src="https://images2.imgbox.com/94/a5/XdksT31R_o.png" alt="在这里插入图片描述"></p> 
<p>运行完成后，通过当前提供的地址访问：http://localhost:8080/ofd/</p> 
<p><img src="https://images2.imgbox.com/d7/a5/Qu3279Ll_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="42_OFDjs_55"></a>4.2 OFD.js库</h5> 
<ul><li>引入OFD.js 库<br> 首先在项目VUE引入OFD.js的JavaScript文件：</li></ul> 
<pre><code class="prism language-bash"><span class="token function">import</span> <span class="token punctuation">{<!-- --></span>parseOfdDocument, renderOfd, renderOfdByScale, digestCheck, getPageScale, setPageScale<span class="token punctuation">}</span> from <span class="token string">"@/utils/ofd/ofd"</span><span class="token punctuation">;</span>
<span class="token function">import</span> * as JSZipUtils from <span class="token string">"jszip-utils"</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>解析<br> 通过OFD提供的parseOfdDocument方法来解析当前OFD文件：</li></ul> 
<pre><code class="prism language-bash"><span class="token builtin class-name">let</span> that <span class="token operator">=</span> this<span class="token punctuation">;</span>
<span class="token builtin class-name">let</span> t <span class="token operator">=</span> new Date<span class="token punctuation">(</span><span class="token punctuation">)</span>.getTime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
this.loading <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
parseOfdDocument<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  ofd: file,
  success<span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    that.ofdObj <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>//OfD对象
    that.pageCount <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.pages.length<span class="token punctuation">;</span>
    //渲染当前OFD文件到前端DIV上
    const divs <span class="token operator">=</span> renderOfd<span class="token punctuation">(</span>screenWidth, res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    that.displayOfdDiv<span class="token punctuation">(</span>divs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    that.loading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>,
  fail<span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    that.loading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    that.<span class="token variable">$alert</span><span class="token punctuation">(</span><span class="token string">'OFD打开失败'</span>, error, <span class="token punctuation">{<!-- --></span>
      confirmButtonText: <span class="token string">'确定'</span>,
      callback: action <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        this.<span class="token variable">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
          type: <span class="token string">'info'</span>,
          message: <span class="token variable"><span class="token variable">`</span>action: $<span class="token punctuation">{<!-- --></span> action <span class="token punctuation">}</span><span class="token variable">`</span></span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>缩放<br> 通过 getPageScale, setPageScale来获取和设置当前缩放值，然后重新去渲染当前OFD对象：</li></ul> 
<pre><code class="prism language-bash">//this.ofdObj上面保存解析后的OFD对象
setPageScale<span class="token punctuation">(</span>++this.scale<span class="token punctuation">)</span><span class="token punctuation">;</span>
const divs <span class="token operator">=</span> renderOfdByScale<span class="token punctuation">(</span>this.ofdObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
this.displayOfdDiv<span class="token punctuation">(</span>divs<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>页切换<br> 当前页的切换主要是通过DIV容器子节点列表下标来切换：</li></ul> 
<pre><code class="prism language-bash"><span class="token builtin class-name">let</span> contentDiv <span class="token operator">=</span> document.getElementById<span class="token punctuation">(</span><span class="token string">'content'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin class-name">let</span> ele <span class="token operator">=</span> contentDiv.children.item<span class="token punctuation">(</span>this.pageIndex-2<span class="token punctuation">)</span><span class="token punctuation">;</span>
ele?.scrollIntoView<span class="token punctuation">(</span>true<span class="token punctuation">)</span><span class="token punctuation">;</span>
ele?this.pageIndex<span class="token operator">=</span>this.pageIndex-1:<span class="token string">''</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="5_114"></a>5、结语</h4> 
<p>OFD.js 作为一个开源的前端 OFD 文件渲染库，通过其对 OFD 标准的支持、基于 Web 技术的设计、轻量化的特点以及开源社区的支持，为开发者提供了一个优秀的工具，使得在浏览器中处理和展示 OFD 文件变得更加简便和高效。如果你正在寻找一个可靠的前端 OFD 文件渲染解决方案，OFD.js 绝对值得你深入了解和尝试，为你的项目带来更好的体验和灵活性。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/03526d330ada362e19a7c574e0f3a041/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">outlook邮件群发单显技巧？群发怎么单显？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a43e583d7d714e8ffb573c03754e9fad/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">（已解决）word如何制作和引用参考文献</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>