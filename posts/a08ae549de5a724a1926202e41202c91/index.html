<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>BUU-crypto-刷题记录20 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="BUU-crypto-刷题记录20" />
<meta property="og:description" content="[RoarCTF2019]RSA 题目
A=(((y%x)**5)%(x%y))**2019&#43;y**316&#43;(y&#43;1)/x p=next_prime(z*x*y) q=next_prime(z) A = 2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724 n = 117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127 c = 41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747 885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128 解题
已知n、c
将n分解得到：
p = 842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569 q = 139916095583110895133596833227506693679306709873174024876891023355860781981175916446323044732913066880786918629089023499311703408489151181886568535621008644997971982182426706592551291084007983387911006261442519635405457077292515085160744169867410973960652081452455371451222265819051559818441257438021073941183 e未知，需要爆破一下（e最小为2)
注意，[RoarCTF2019]的默认flag形式为RoarCTF{***}
import sympy from gmpy2 import * from Crypto.Util.number import long_to_bytes #记得导入数据 phi=(p-1)*(q-1) flag=&#34;RoarCTF{&#34; e = 2 while(e&lt;100000): e = next_prime(e) d = invert(e,phi) m = pow(c,d,n) s = str(long_to_bytes(m)) if flag in s: print(s) break 出现错误
ZeroDivisionError: invert() no inverse exists
对出错语句加上异常处理：
while(e&lt;100000): e = next_prime(e) try: d = invert(e,phi) except: continue else: m = pow(c,d,n) s = str(long_to_bytes(m)) if flag in s: print(s) break 运行得到" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a08ae549de5a724a1926202e41202c91/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-04T21:36:06+08:00" />
<meta property="article:modified_time" content="2024-01-04T21:36:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">BUU-crypto-刷题记录20</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="RoarCTF2019RSA_0"></a>[RoarCTF2019]RSA</h3> 
<p><strong>题目</strong></p> 
<pre><code>A=(((y%x)**5)%(x%y))**2019+y**316+(y+1)/x
p=next_prime(z*x*y)
q=next_prime(z)
A =  2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724
n =  117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127
c =  41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747 885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128
</code></pre> 
<p><strong>解题</strong></p> 
<p>已知n、c<br> <a href="http://www.factordb.com/index.php" rel="nofollow">将n分解</a>得到：</p> 
<pre><code class="prism language-python">p <span class="token operator">=</span> <span class="token number">842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569</span>
q <span class="token operator">=</span> <span class="token number">139916095583110895133596833227506693679306709873174024876891023355860781981175916446323044732913066880786918629089023499311703408489151181886568535621008644997971982182426706592551291084007983387911006261442519635405457077292515085160744169867410973960652081452455371451222265819051559818441257438021073941183</span>
</code></pre> 
<p>e未知，需要爆破一下（e最小为2)</p> 
<p>注意，[RoarCTF2019]的默认flag形式为RoarCTF{***}</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sympy
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes

<span class="token comment">#记得导入数据</span>

phi<span class="token operator">=</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
flag<span class="token operator">=</span><span class="token string">"RoarCTF{"</span>

e <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>e<span class="token operator">&lt;</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    e <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>
    m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
    s <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> flag <span class="token keyword">in</span> s<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
        <span class="token keyword">break</span>
</code></pre> 
<p>出现错误</p> 
<p><strong>ZeroDivisionError: invert() no inverse exists</strong></p> 
<p>对出错语句加上异常处理：</p> 
<pre><code class="prism language-python"><span class="token keyword">while</span><span class="token punctuation">(</span>e<span class="token operator">&lt;</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    e <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
        s <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> flag <span class="token keyword">in</span> s<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre> 
<p>运行得到</p> 
<pre><code>b'RoarCTF{wm-l1l1ll1l1l1l111ll}'
</code></pre> 
<p><strong>答案</strong><br> flag{wm-l1l1ll1l1l1l111ll}</p> 
<h3><a id="_72"></a>救世捷径</h3> 
<p><strong>题目</strong></p> 
<p>一个名叫CPU的神秘大陆有26个国家，有些国家之间会有一条无向路，每条路径都有不同的长度和一段神秘代码，救世主尼奥要从国家1出发，赶往国家26拯救大陆，请你帮助救世主选择最短路径，而走过的路的神秘代码连接起来便是flag。 以下是数行数据，每行第一个，第二个数字代表这条路的两个端点国家，第三个数字代表路途长度，最后一个字符串便是神秘代码。路在附件中~ 帮助救世主尼奥吧，他快被吓尿了。。。</p> 
<pre><code>1 2 100 FLAG{
2 3 87 AFQWE
2 4 57 ETKLS
2 5 50 WEIVK
2 6 51 AWEIW
3 7 94 QIECJF
3 8 78 QSXKE
3 9 85 QWEIH
4 13 54 WQOJF
4 14 47 KDNVE
4 15 98 QISNV
5 10 43 AEWJV
5 11 32 QWKXF
5 12 44 ASJVL
6 16 59 ASJXJ
6 17 92 QJXNV
6 18 39 SCJJF
6 23 99 SJVHF
7 19 99 WJCNF
8 20 96 SKCNG
9 20 86 SJXHF
10 21 60 SJJCH
11 21 57 SJHGG
12 22 47 SJCHF
14 10 55 EJFHG
16 17 59 ASJVH
18 12 53 SJFHG
18 24 93 SHFVG
21 22 33 SJFHB
19 25 88 ASHHF
20 25 96 SJVHG
22 25 23 SJVHJ
25 26 75 SDEV}
</code></pre> 
<p><strong>解题</strong><br> 本来想写代码的，发现还不如直接算容易</p> 
<p>倒着来，最后字符为SDEV}</p> 
<p>到25，有三条路19–&gt;25;20–&gt;25;22–&gt;25</p> 
<p>在往回追溯，1–&gt;2–&gt;3–&gt;7–&gt;19–&gt;25，总路程543<br> 1–&gt;2–&gt;3–&gt;8–&gt;20–&gt;25，总路程532<br> 1–&gt;2–&gt;3–&gt;9–&gt;20–&gt;25，总路程529<br> 1–&gt;2–&gt;5–&gt;12–&gt;22–&gt;25，总路程362</p> 
<p>肯定最后一个最短了FLAG{WEIVKASJVLSJCHFSJVHJSDEV}<br> <strong>答案</strong><br> flag{WEIVKASJVLSJCHFSJVHJSDEV}</p> 
<h3><a id="_2020_boom_127"></a>[网鼎杯 2020 青龙组]boom</h3> 
<p><strong>题目</strong><br> <img src="https://images2.imgbox.com/26/e6/CJem52bL_o.png" alt="在这里插入图片描述"><br> <strong>解题</strong><br> Play a simple game</p> 
<p>first:this string md5:46e5efe6165a5afb361217446a2dbd01</p> 
<p><a href="https://cmd5.com/" rel="nofollow">MD5解密</a>得到：en5oy</p> 
<p>Great next level</p> 
<p>This time:Here are have some formulas<br> 3x-y+z=185<br> 2x+3y-z=321<br> x+y+z=173<br> input: x =<br> input: y =<br> input: z =</p> 
<p>解方程？</p> 
<pre><code class="prism language-python"><span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> z <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token number">3</span><span class="token operator">*</span>x<span class="token operator">-</span>y<span class="token operator">+</span>z<span class="token operator">==</span><span class="token number">185</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token number">2</span><span class="token operator">*</span>x<span class="token operator">+</span><span class="token number">3</span><span class="token operator">*</span>y<span class="token operator">-</span>z<span class="token operator">==</span><span class="token number">321</span><span class="token punctuation">:</span>
                    <span class="token keyword">if</span> x<span class="token operator">+</span>y<span class="token operator">+</span>z<span class="token operator">==</span><span class="token number">173</span><span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span>
                        <span class="token keyword">break</span>
</code></pre> 
<p>x=74,y=68,z=31</p> 
<p>Last time: Kill it<br> x*x+x-7943722218936282=0<br> input x:</p> 
<pre><code class="prism language-python"><span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7943722218936282</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> x<span class="token operator">*</span>x<span class="token operator">+</span>x<span class="token operator">==</span><span class="token number">7943722218936282</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">break</span>
</code></pre> 
<p>89127561</p> 
<p>输入，然后，，，关闭了😦</p> 
<p>搜了下，别的师傅有用OD调试的，菜菜OD还没下载，所以选择了另一种方式，用cmd打开，</p> 
<p>再运行一遍</p> 
<p>Great This is your FLAG<br> flag{en5oy_746831_89127561}</p> 
<p><strong>答案</strong><br> flag{en5oy_746831_89127561}</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dc74fb44a6e106fa56badbff92f1f87a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">华为云CES监控与飞书通知</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9e8bd5db5e5f29ec10c7e15ed43c12ce/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【UnityShader入门精要学习笔记】第三章（1）Unity Shader介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>