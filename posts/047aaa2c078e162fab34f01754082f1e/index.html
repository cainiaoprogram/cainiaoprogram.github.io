<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Graylog3 布署 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Graylog3 布署" />
<meta property="og:description" content="前言 因为先前的日志收集系统存在一些功能缺陷，经过一番了解，最后决定布署Graylog3，本文包含Graylog3服务器&amp;客户端的布署
服务器组件列表 OS: Centos 7
oracle jdk: jdk-8u251-linux-x64.tar.gz
mongodb: mongodb-linux-x86_64-3.6.13.tgz
elasticsearch : elasticsearch-6.8.3.rpm
graylogserver: graylog-3.1-repository_latest.rpm
客户端组件 Windows: graylog-sidecar: graylog_sidecar_installer_1.0.2-1.exe
Linux: graylog-sidecar: graylog-sidecar-1.0.0-1.x86_64.rpm
filebeat: filebeat-7.4.0-x86_64.rpm
服务器ip: 172.24.42.11
安装 jdk 到官网下载 jdk1.8
下载页面: https://www.oracle.com/java/technologies/javase-downloads.html
# mkdir /home/java # tar -zxvf jdk-8u251-linux-x64.tar.gz -C /home/java 修改环境变量
# vim /etc/profile 添加 export JAVA_CMD=/home/java/jdk1.8.0_251/bin export JAVA_HOME=/home/java/jdk1.8.0_251 export PATH=$PATH:$JAVA_HOME/bin 生效
# source /etc/profile 验证
# java -version java version &#34;1.8.0_251&#34; Java(TM) SE Runtime Environment (build 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/047aaa2c078e162fab34f01754082f1e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-06-22T09:55:29+08:00" />
<meta property="article:modified_time" content="2020-06-22T09:55:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Graylog3 布署</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4 style="margin-left:0cm;"><span style="color:#3399ea;">前言</span></h4> 
<p style="margin-left:0cm;">因为先前的日志收集系统存在一些功能缺陷，经过一番了解，最后决定布署Graylog3，本文包含Graylog3服务器&amp;客户端的布署</p> 
<h4 style="margin-left:0cm;"> </h4> 
<h4 style="margin-left:0cm;"><span style="color:#3399ea;">服务器组件列表</span></h4> 
<p style="margin-left:0cm;">OS: Centos 7</p> 
<p style="margin-left:0cm;">oracle jdk: jdk-8u251-linux-x64.tar.gz</p> 
<p style="margin-left:0cm;">mongodb: mongodb-linux-x86_64-3.6.13.tgz</p> 
<p style="margin-left:0cm;">elasticsearch : elasticsearch-6.8.3.rpm</p> 
<p style="margin-left:0cm;">graylogserver: graylog-3.1-repository_latest.rpm</p> 
<p style="margin-left:0cm;"> </p> 
<h4 style="margin-left:0cm;"><span style="color:#3399ea;">客户端组件</span></h4> 
<ul><li style="margin-left:0cm;">Windows:</li></ul> 
<p style="margin-left:0cm;">graylog-sidecar: <a href="https://github.com/Graylog2/collector-sidecar/releases/download/1.0.2/graylog_sidecar_installer_1.0.2-1.exe"><span style="color:#0366d6;">graylog_sidecar_installer_1.0.2-1.exe</span></a></p> 
<ul><li style="margin-left:0cm;">Linux:</li></ul> 
<p style="margin-left:0cm;">graylog-sidecar: graylog-sidecar-1.0.0-1.x86_64.rpm</p> 
<p style="margin-left:0cm;">filebeat: filebeat-7.4.0-x86_64.rpm</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">服务器ip: 172.24.42.11</p> 
<p style="margin-left:0cm;"> </p> 
<h4><span style="color:#3399ea;">安装 jdk</span></h4> 
<p style="margin-left:0cm;">到官网下载 jdk1.8</p> 
<p style="margin-left:0cm;">下载页面: <a href="https://www.oracle.com/java/technologies/javase-downloads.html" rel="nofollow">https://www.oracle.com/java/technologies/javase-downloads.html</a></p> 
<pre><code class="language-bash"># mkdir /home/java
# tar -zxvf jdk-8u251-linux-x64.tar.gz -C /home/java
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">修改环境变量</p> 
<pre><code class="language-bash"># vim /etc/profile
添加
export JAVA_CMD=/home/java/jdk1.8.0_251/bin
export JAVA_HOME=/home/java/jdk1.8.0_251
export PATH=$PATH:$JAVA_HOME/bin</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">生效</p> 
<pre><code class="language-bash"># source /etc/profile</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">验证</p> 
<pre><code class="language-bash"># java -version
java version "1.8.0_251"
Java(TM) SE Runtime Environment (build 1.8.0_251-b08)
Java HotSpot(TM) 64-Bit Server VM (build 25.251-b08, mixed mode)
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">建立软链接</p> 
<pre><code class="language-bash"># cd /bin
# ln -s /home/java/jdk1.8.0_251/bin/java
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"> </p> 
<h4 style="margin-left:0cm;"><span style="color:#3399ea;">安装 mongodb</span></h4> 
<p> </p> 
<p style="margin-left:0cm;">下载地址: <a href="https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.6.13.tgz" rel="nofollow">https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.6.13.tgz</a></p> 
<p style="margin-left:0cm;">解压安装</p> 
<pre><code class="language-bash"># tar -zxvf mongodb-linux-x86_64-3.6.13.tgz  -C /usr/local</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">增加环境变量</p> 
<pre><code class="language-bash"># vim /etc/profile
增加一行：
export MONGODB_HOME=/usr/local/mongodb-linux-x86_64-3.6.13
在 PATH 后面增加(含冒号) :$MONGODB_HOME/bin

生效
# source /etc/profile
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">创建数据库文件和 log 目录(事先评估好容量)</p> 
<pre><code class="language-bash"># mkdir -p /db/data
# mkdir -p /db/logs
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">新建配置文件</p> 
<pre><code class="language-bash">vim /usr/local/mongodb-linux-x86_64-3.6.13/mongo.conf
dbpath=/db/data
logpath=/db/logs/mongo.log
logappend=true
journal=true
quiet=true
port=27017
fork=true
bind_ip=0.0.0.0
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">测试</p> 
<pre><code class="language-bash"># cd /usr/local/mongodb-linux-x86_64-3.6.13/
# bin/mongod -f mongo.conf 
about to fork child process, waiting until server is ready for connections.
forked process: 1518
child process started successfully, parent exiting

# lsof -i:27017
COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
mongod  1518 root   11u  IPv4  21535      0t0  TCP *:27017 (LISTEN)
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">设置服务启动</p> 
<pre><code class="language-bash"># vim /lib/system/system/mongodb.service
添加以下内容
[Unit]
Description=mongodb
After=network.target remote-fs.target nss-lookup.target

[Service]
Type=forking
ExecStart=/usr/local/mongodb-linux-x86_64-3.6.13/bin/mongod --config /usr/local/mongodb-linux-x86_64-3.6.13/mongo.conf
ExecReload=/bin/kill -s HUP $MAINPID
ExecStop=/usr/local/mongodb-linux-x86_64-3.6.13/bin/mongod --shutdown --config /usr/local/mongodb-linux-x86_64-3.6.13/mongo.conf
PrivateTmp=true

[Install]
WantedBy=multi-user.target
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">修改权限</p> 
<pre><code class="language-bash"># chmod 754 /lib/systemd/system/mongodb.service</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">启动服务/设置开机启动</p> 
<pre><code class="language-bash"># pkill –f -9 mongod
# systemctl start mongodb
# systemctl enable mongodb
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<h4><span style="color:#3399ea;">安装 elasticsearch</span></h4> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">选择版本下载 rpm 安装包,</p> 
<p style="margin-left:0cm;">下载页面: <a href="https://www.elastic.co/cn/downloads/past-releases" rel="nofollow">https://www.elastic.co/cn/downloads/past-releases</a></p> 
<p style="margin-left:0cm;">6.8.3的下载地址:</p> 
<p style="margin-left:0cm;"><a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.8.3.rpm" rel="nofollow">https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.8.3.rpm</a></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">安装</p> 
<pre><code class="language-bash"># rpm -ivh elasticsearch-6.8.3.rpm</code></pre> 
<p style="margin-left:0cm;">安装后会自动建立服务账号 elasticsearch, 可以查看文件 /etc/passwd</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">建立目录</p> 
<pre><code class="language-bash"># mkdir –p /data/elasticsearch/data
# mkdir –p /data/elasticsearch/logs
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">设置目录权限</p> 
<pre><code class="language-bash"># chown -R elasticsearch:elasticsearch /data/elasticsearch/</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">修改配置</p> 
<pre><code class="language-bash"># vim /etc/elasticsearch/elasticsearch.yml
修改以下几个参数，没有的就添加
cluster.name: my-cluster
path.data: /data/elasticsearch/data
path.logs: /data/elasticsearch/logs
network.host: 0.0.0.0
action.auto_create_index: .watches,.triggered_watches,.watcher-history-*
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">添加 JAVA_HOME</p> 
<pre><code class="language-bash"># vim /etc/sysconfig/elasticsearch
修改
JAVA_HOME=/home/java/jdk1.8.0_251
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">启动服务</p> 
<pre><code class="language-bash"># systemctl start elasticsearch</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">测试</p> 
<pre><code class="language-bash">检查端口 9200 是否开启
# lsof –i:9200
从远程浏览器输入 http://172.24.42.11:9200
显示以下内容表示正常
{
  "name" : "oifThn1",
  "cluster_name" : "my-cluster",
  "cluster_uuid" : "DDmYdQUQTVi-0EBLFk-z1w",
  "version" : {
    "number" : "6.8.3",
    "build_flavor" : "default",
    "build_type" : "rpm",
    "build_hash" : "0c48c0e",
    "build_date" : "2019-08-29T19:05:24.312154Z",
    "build_snapshot" : false,
    "lucene_version" : "7.7.0",
    "minimum_wire_compatibility_version" : "5.6.0",
    "minimum_index_compatibility_version" : "5.0.0"
  },
  "tagline" : "You Know, for Search"
}
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"> </p> 
<h4 style="margin-left:0cm;"><span style="color:#3399ea;">安装 graylog-server</span></h4> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">下载 graylog-server 的 repo</p> 
<p style="margin-left:0cm;"><a href="https://packages.graylog2.org/repo/packages/graylog-3.1-repository_latest.rpm" rel="nofollow">https://packages.graylog2.org/repo/packages/graylog-3.1-repository_latest.rpm</a></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">先安装 repo 文件</p> 
<pre><code class="language-bash"># rpm –ivh graylog-3.1-repository_latest.rpm</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">安装</p> 
<pre><code class="language-bash"># yum install graylog-server</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">安装密码生成器 pwgen</p> 
<p style="margin-left:0cm;">下载网址: <a href="http://sourceforge.net/projects/pwgen" rel="nofollow">http://sourceforge.net/projects/pwgen</a></p> 
<pre><code class="language-bash"># yum install gcc
# tar zxvf pwgen-2.08.tar.gz
# cd pwgen-2.08
# ./configure &amp;&amp; make &amp;&amp; make install
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">密码配置</p> 
<pre><code class="language-bash"># pwgen -N 1 -s 96
将生成的密码填入 /etc/graylog/server/server.conf 的 password_secret= 字段

# yum install perl-Digest-SHA
得到登录密码 SHA2 的值

# echo -n mypassword | shasum -a 256  其中 mypassword为想要设置的密码字符串
将生成的字符串填入 /etc/graylog/server/server.conf 的root_password_sha2 = 字段
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">其它配置</p> 
<pre><code class="language-bash"># vim /etc/graylog/server/server.conf
修改以下字段
root_timezone=Asia/Shanghai
elasticsearch_bind_address=0.0.0.0:9000
http_publish_uri=http://172.24.42.11:9000
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">启动服务</p> 
<pre><code class="language-bash"># systemctl enable graylog-server
# systemctl start graylog-server
</code></pre> 
<p style="margin-left:0cm;">服务启动失败的日志在 /var/log/messages 里</p> 
<p style="margin-left:0cm;">服务启动后的日志在 /var/log/graylog-server/server.log 里</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">启动服务后,检查端口 9000</p> 
<pre><code class="language-bash"># lsof -i:9000</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">配置 graylog</p> 
<p style="margin-left:0cm;">打开网址 <a href="http://172.24.42.11:9000" rel="nofollow">http://172.24.42.11:9000</a></p> 
<p style="margin-left:0cm;">登录用户名: admin</p> 
<p style="margin-left:0cm;">密码: 前文设置的 (mypassword 出现的地方)</p> 
<p style="margin-left:0cm;"> </p> 
<ul><li style="margin-left:0cm;">创建 sidecar 的 token</li></ul> 
<p style="margin-left:0cm;">点击 System 下拉式菜单的 Sidecars 菜单项</p> 
<p style="margin-left:0cm;"><img alt="001" src="https://images2.imgbox.com/1d/a3/Fiv43wto_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">点击蓝色链接 “Create or reuse a token for the graylog-sidecar user.”</p> 
<p style="margin-left:0cm;"><img alt="002" src="https://images2.imgbox.com/59/56/v26kpjZH_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">输入 Token name ,点击 Create Token 按钮</p> 
<p style="margin-left:0cm;"><img alt="003" src="https://images2.imgbox.com/13/02/kQgwcxGy_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">点击 Copy to clipboard 按钮获取 token, 保存好后面要用到</p> 
<p style="margin-left:0cm;"><img alt="" src="https://images2.imgbox.com/ab/28/AH2FXn7m_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<ul><li style="margin-left:0cm;">设置输入点</li></ul> 
<p style="margin-left:0cm;">点击 System/Authentications 下拉菜单的 Inputs 菜单菜</p> 
<p style="margin-left:0cm;"><img alt="005" src="https://images2.imgbox.com/bc/7d/FdXMEhXO_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">点击 Select input 下拉输入框的 Beats 项后，点击 Launch new input 按钮</p> 
<p style="margin-left:0cm;"><img alt="006" src="https://images2.imgbox.com/d9/43/CcVCgChA_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">在弹出的页面中</p> 
<p style="margin-left:0cm;">从 Node下拉菜单选取节点(本文只有1个节点)</p> 
<p style="margin-left:0cm;">输入 Title</p> 
<p style="margin-left:0cm;"><img alt="007" src="https://images2.imgbox.com/81/b3/VaQV3uRi_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">钩选底部的 Do not add Beats type as prefix 单选框，点击 Save 按钮</p> 
<p style="margin-left:0cm;"><img alt="008" src="https://images2.imgbox.com/e5/90/PHAbGET5_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">可以看到新建好的 input-1 的设置</p> 
<p style="margin-left:0cm;"><img alt="009" src="https://images2.imgbox.com/9d/24/XrYmx0xC_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"><span style="color:#f33b45;">以同样的方法建立 input-2, 将端口设置为 5046 (后面会用到)</span></p> 
<p style="margin-left:0cm;"> </p> 
<ul><li style="margin-left:0cm;">建立Sidecar 配置</li></ul> 
<p style="margin-left:0cm;">再点击 System 下拉菜单的 Sidecars 菜单菜</p> 
<p style="margin-left:0cm;"><img alt="001" src="https://images2.imgbox.com/bd/cc/UDXLV2uf_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">点吉右上方的 Configuration 按钮进入配置页面</p> 
<p style="margin-left:0cm;"><img alt="010" height="186" src="https://images2.imgbox.com/19/66/wH43QzSP_o.png" width="495"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">点击 Create Configuration 按钮建立1项配置(用来收集 windows 日志)</p> 
<p style="margin-left:0cm;"><img alt="011" src="https://images2.imgbox.com/dc/50/gRJmO8jB_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">设置基本信息</p> 
<p style="margin-left:0cm;">输入 Name</p> 
<p style="margin-left:0cm;">点选 Color</p> 
<p style="margin-left:0cm;">选择收集器 winlogbeat on Windows</p> 
<p style="margin-left:0cm;"><img alt="012" src="https://images2.imgbox.com/76/a7/7zaSS9qz_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">配置脚本(服务器ip/port,日志类型等)，点击下方 Create 按钮</p> 
<p style="margin-left:0cm;"><img alt="013" src="https://images2.imgbox.com/2f/38/FqXTPA9y_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">再点击 Create Coniguration 按钮建立1项配置(用来收集 linux 日志)</p> 
<p style="margin-left:0cm;">输入 Name</p> 
<p style="margin-left:0cm;">点选 Color</p> 
<p style="margin-left:0cm;">选择收集器 filebeat on linux</p> 
<p style="margin-left:0cm;"><img alt="027" src="https://images2.imgbox.com/ec/20/T9kGEa3i_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">配置脚本(端口不能与其它配置相同), 配置日志的源文档(可以是系统日志或Nginx等),点击 Create 按钮</p> 
<p style="margin-left:0cm;"><img alt="028" src="https://images2.imgbox.com/87/6c/2cqbtwU5_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<ul><li style="margin-left:0cm;">安装 graylog-sidecar for windows 客户端</li></ul> 
<p style="margin-left:0cm;">下载地址<a href="https://github.com/Graylog2/collector-sidecar/releases">https://github.com/Graylog2/collector-sidecar/releases</a></p> 
<p style="margin-left:0cm;">选择下载 <a href="https://github.com/Graylog2/collector-sidecar/releases/download/1.0.2/graylog_sidecar_installer_1.0.2-1.exe"><span style="color:#0366d6;">graylog_sidecar_installer_1.0.2-1.exe</span></a></p> 
<p style="margin-left:0cm;">在 windows 服务器上执行</p> 
<p style="margin-left:0cm;"><img alt="015" src="https://images2.imgbox.com/18/f0/DnUaHW2A_o.png"></p> 
<p style="margin-left:0cm;"><img alt="016" src="https://images2.imgbox.com/b0/37/Vj2dVbp9_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">填入 api url, 输入实例: sidecar-windows, 输入之前建立的 token(Create Token的地方)</p> 
<p style="margin-left:0cm;"><img alt="017" src="https://images2.imgbox.com/38/88/TVXX87dZ_o.png"></p> 
<p style="margin-left:0cm;"><img alt="018" src="https://images2.imgbox.com/9d/5b/1jrjsAYC_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">安装/启动服务</p> 
<pre><code class="language-bash">以管理员身份启动 cmd.exe 进入到 graylog-sidecar 的安装目录，执行以下命令
&gt; graylog-sidecar.exe -service install
&gt; graylog-sidecar.exe -service start
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">检查服务是否已启动</p> 
<p style="margin-left:0cm;"><img alt="020" height="189" src="https://images2.imgbox.com/85/bf/FwuAMeLy_o.png" width="635"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"> </p> 
<ul><li style="margin-left:0cm;">将 windows 客户端与Graylog-Server配置进行关联</li></ul> 
<p style="margin-left:0cm;">回到 graylog 系统的网站，点击右上角的 Administration 按钮</p> 
<p style="margin-left:0cm;">可以看到刚才安装 graylog-sidecar 的 windows 客户端，钩选 winlogbeat，</p> 
<p style="margin-left:0cm;">再点击右侧的 Configure 下拉菜单，点击刚才建立的 sidecar 配置(蓝色)</p> 
<p style="margin-left:0cm;"><img alt="021" src="https://images2.imgbox.com/f2/b7/ELGAFOmx_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">点击 Confirm 按钮确认</p> 
<p style="margin-left:0cm;"><img alt="022" src="https://images2.imgbox.com/de/bc/WF8ajfbc_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">点击右侧的 Process 正拉菜单的 Start 项</p> 
<p style="margin-left:0cm;"><img alt="023" src="https://images2.imgbox.com/37/50/pO3DWrKZ_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">点击 Confirm 按钮确认</p> 
<p style="margin-left:0cm;"><img alt="024" src="https://images2.imgbox.com/38/b1/OyTeO8LR_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">点击 Search 菜单项</p> 
<p style="margin-left:0cm;"><img alt="025" src="https://images2.imgbox.com/9a/c0/Vbl19b37_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">查看 Messages 模块，可以看到已经收集到刚才的 windows 服务器的日志</p> 
<p style="margin-left:0cm;"><img alt="026" src="https://images2.imgbox.com/5f/bd/CTFhDM4w_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"> </p> 
<ul><li style="margin-left:0cm;">安装 graylog-sidecar for linux 客户端</li></ul> 
<p style="margin-left:0cm;">下载地址: <a href="https://github.com/Graylog2/collector-sidecar/releases">https://github.com/Graylog2/collector-sidecar/releases</a></p> 
<p style="margin-left:0cm;">下载安装包 graylog-sidecar-1.0.2-1.x86_64.rpm</p> 
<p style="margin-left:0cm;">安装</p> 
<pre><code class="language-bash"># rpm -ivh graylog-sidecar-1.0.0-1.x86_64.rpm</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">修改配置</p> 
<pre><code class="language-bash"># vim /etc/graylog/sidecar/sidecar.yml
同 windows 客户端一样，修改 
server_url 为 “http://172.24.42.11:9000/api/”
server_api_token 为先前建立的 token
node_name: "node-1"
update_interval: 10
send_status: true
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">安装/启动服务</p> 
<pre><code class="language-bash"># graylog-sidecar -service install
# systemctl start graylog-sidecar
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">安装 filebea</p> 
<p style="margin-left:0cm;">下载页面 <a href="https://www.elastic.co/downloads/past-releases/filebeat-7-4-0" rel="nofollow">https://www.elastic.co/downloads/past-releases/filebeat-7-4-0</a></p> 
<p style="margin-left:0cm;">下载地址 <a href="https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.4.0-x86_64.rpm" rel="nofollow">https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.4.0-x86_64.rpm</a></p> 
<p style="margin-left:0cm;">安装</p> 
<pre><code class="language-bash"># rpm -ivh filebeat-7.4.0-x86_64.rpm</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">启动服务</p> 
<pre><code class="language-bash"># systemctl enable filebeat
# systemctl start filebeat
</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">将 linux 客户端与配置进行关联</p> 
<p style="margin-left:0cm;">回到 graylog 系统的网站，点击右上角的 Administration 按钮</p> 
<p style="margin-left:0cm;">可以看到刚才安装 graylog-sidecar 的 linux 客户端，钩选 filebeat</p> 
<p style="margin-left:0cm;">再点击右侧的 Configure 下拉菜单，点击刚才建立的 sidecar 配置(棕色)</p> 
<p style="margin-left:0cm;"><img alt="030" src="https://images2.imgbox.com/a5/83/Mx72xco3_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">回到 Search 页面，就可以看到 linux 收集到的日志了</p> 
<p style="margin-left:0cm;"><img alt="031" src="https://images2.imgbox.com/34/76/HYDBkRSD_o.png"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">至此，布署的部分已完成</p> 
<p style="margin-left:0cm;">然而</p> 
<p style="margin-left:0cm;">Graylog 的使用才才开始，包含日志选择收集, 日志预警，多节点，集<span style="color:#333333;">群等</span></p> 
<p style="margin-left:0cm;"> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0f1f3a0410f4636cd4f34a9a643bd5e2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CentOS 7 安装SonarQube 8.3版本</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/96c0907746c28c010b714f434c77640c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">图像分割系列概述FCN、UNet、DeepLab</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>