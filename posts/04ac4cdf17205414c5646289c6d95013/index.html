<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>数据增强方法小汇总 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="数据增强方法小汇总" />
<meta property="og:description" content="数据增强的作用/为啥要进行数据增强 避免过拟合。当数据集具有某种明显的特征，例如数据集中图片基本在同一个场景中拍 摄，使用 Cutout 方法和风格迁移变化等相关方法可避免模型学到跟目标无关的信息。提升模型鲁棒性，降低模型对图像的敏感度。当训练数据都属于比较理想的状态，碰到 一些特殊情况，如遮挡，亮度，模糊等情况容易识别错误，对训练数据加上噪声，掩码等方 法可提升模型鲁棒性。增加训练数据，提高模型泛化能力。避免样本不均衡。在工业缺陷检测方面，医疗疾病识别方面，容易出现正负样本极度不 平衡的情况，通过对少样本进行一些数据增强方法，降低样本不均衡比例。理论上来说，用于训练的数据集越多越好。 数据增强分类 在线增强 在训练前对数据集进行处理，往往能得到多倍的数据集。
离线增强 在线增强是在训练时对加载数据进行预处理，不改变训练数据的数量。
常用的方法 比较常用的几何变换方法主要有：翻转，旋转，裁剪，缩放，平移，抖动。
值得注意的是，在某些具体的任务中，当使用这些方法时需要主要标签数据的变化，如目标检测中若使用翻转，则需要将 gt 框进行相应的调整。
比较常用的像素变换方法有：加椒盐噪声，高斯噪声，进行高斯模糊，调整 HSV 对比度，调节亮度，饱和度，直方图均衡化，调整白平衡等。
设0.5的概率翻转：
if random.random() &gt;= 0.5: image = image[::-1] label = label[::-1] 这些常用方法都比较简单，这里不多赘述。下面是一些比较特殊的数据增强方法。
随机裁剪：
从320×320的图片中随机裁剪出288×288的图片
# h=w=320 new_h=new_w=288 top = np.random.randint(0, h - new_h) left = np.random.randint(0, w - new_w) image = image[top: top &#43; new_h, left: left &#43; new_w] label = label[top: top &#43; new_h, left: left &#43; new_w] Coutout（2017） 该方法来源于论文《Improved Regularization of Convolutional Neural Networks with Cutout》" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/04ac4cdf17205414c5646289c6d95013/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-22T13:36:51+08:00" />
<meta property="article:modified_time" content="2021-04-22T13:36:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">数据增强方法小汇总</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>数据增强的作用/为啥要进行数据增强</h2> 
<ol><li>避免过拟合。当数据集具有某种明显的特征，例如数据集中图片基本在同一个场景中拍 摄，使用 Cutout 方法和风格迁移变化等相关方法可避免模型学到跟目标无关的信息。</li><li>提升模型鲁棒性，降低模型对图像的敏感度。当训练数据都属于比较理想的状态，碰到 一些特殊情况，如遮挡，亮度，模糊等情况容易识别错误，对训练数据加上噪声，掩码等方 法可提升模型鲁棒性。</li><li>增加训练数据，提高模型泛化能力。</li><li>避免样本不均衡。在工业缺陷检测方面，医疗疾病识别方面，容易出现正负样本极度不 平衡的情况，通过<strong>对少样本</strong>进行一些数据增强方法，降低样本不均衡比例。</li><li>理论上来说，用于训练的数据集越多越好。</li></ol> 
<h2><a id="_7"></a>数据增强分类</h2> 
<h3><a id="_8"></a>在线增强</h3> 
<p>在训练前对数据集进行处理，往往能得到多倍的数据集。</p> 
<h3><a id="_10"></a>离线增强</h3> 
<p>在线增强是在训练时对加载数据进行预处理，不改变训练数据的数量。</p> 
<h2><a id="_13"></a>常用的方法</h2> 
<p>比较常用的几何变换方法主要有：翻转，旋转，裁剪，缩放，平移，抖动。<br> 值得注意的是，在某些具体的任务中，当使用这些方法时需要主要标签数据的变化，如目标检测中若使用翻转，则需要将 gt 框进行相应的调整。<br> 比较常用的像素变换方法有：加椒盐噪声，高斯噪声，进行高斯模糊，调整 HSV 对比度，调节亮度，饱和度，直方图均衡化，调整白平衡等。</p> 
<p>设0.5的概率翻转：</p> 
<pre><code class="prism language-python">		<span class="token keyword">if</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0.5</span><span class="token punctuation">:</span>
			image <span class="token operator">=</span> image<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
			label <span class="token operator">=</span> label<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
</code></pre> 
<p>这些常用方法都比较简单，这里不多赘述。下面是一些比较特殊的数据增强方法。</p> 
<p>随机裁剪：<br> 从320×320的图片中随机裁剪出288×288的图片</p> 
<pre><code class="prism language-python"><span class="token comment"># h=w=320   new_h=new_w=288</span>
		top <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> h <span class="token operator">-</span> new_h<span class="token punctuation">)</span>
		left <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> w <span class="token operator">-</span> new_w<span class="token punctuation">)</span>

		image <span class="token operator">=</span> image<span class="token punctuation">[</span>top<span class="token punctuation">:</span> top <span class="token operator">+</span> new_h<span class="token punctuation">,</span> left<span class="token punctuation">:</span> left <span class="token operator">+</span> new_w<span class="token punctuation">]</span>
		label <span class="token operator">=</span> label<span class="token punctuation">[</span>top<span class="token punctuation">:</span> top <span class="token operator">+</span> new_h<span class="token punctuation">,</span> left<span class="token punctuation">:</span> left <span class="token operator">+</span> new_w<span class="token punctuation">]</span>
</code></pre> 
<h2><a id="Coutout2017_39"></a>Coutout（2017）</h2> 
<p>该方法来源于论文《Improved Regularization of Convolutional Neural Networks with Cutout》<br> 在一些人体姿态估计，人脸识别，目标跟踪，行人重识别等任务中常常会出现遮挡的情 况，为了提高模型的鲁棒性，提出了使用 Cutout 数据增强方法。该方法的依据是 CutOut 能 够让 CNN 更好地利用图像的全局信息，而不是依赖于一小部分特定的视觉特征。<br> 做法：对一张图像随机选取一个小正方形区域，在这个区域的像素值设置为 0 或其它统 一的值。<br> 注：存在 50%的概率不对图像使用 Cutout。<br> 效果图如下：<br> <img src="https://images2.imgbox.com/39/ea/W3LhLdj9_o.png" alt="在这里插入图片描述"></p> 
<p>官方代码：<a href="https://github.com/uoguelph-mlrg/Cutout">https://github.com/uoguelph-mlrg/Cutout</a></p> 
<h2><a id="Random_Erasing2017_49"></a>Random Erasing(2017)</h2> 
<p>该方法来源于论文《Random Erasing Data Augmentation》。 这个方法有点类似于 Cutout，这两者同一年发表的。与 Cutout 不同的是，Random Erasing 掩码区域的长宽，以及区域中像素值的替代值都是随机的，Cutout 是固定使用正方形，替代 值都使用同一个。 具体算法如下：<br> <img src="https://images2.imgbox.com/9f/9c/UO3zg0jb_o.png" alt="在这里插入图片描述"></p> 
<p>效果图：<br> <img src="https://images2.imgbox.com/fc/d6/79xtkLeb_o.png" alt="在这里插入图片描述"><br> 官方代码： <a href="https://github.%20com/zhunzhong07/Random-Erasing" rel="nofollow">https://github. com/zhunzhong07/Random-Erasing</a></p> 
<h2><a id="Mixup2018_56"></a>Mixup(2018)</h2> 
<p>该方法来源于论文《mixup: BEYOND EMPIRICAL RISK MINIMIZATION》。 主要思想是将在数据集中随机选择两张图片按照一定比例融合，包括标签值。在论文中 给出了代码，看一眼代码即可很好的理解。</p> 
<p><img src="https://images2.imgbox.com/41/2d/lOb6IYAq_o.png" alt="在这里插入图片描述"><br> 通过beta分布得到一个随机数lam，然后用lam*x1加上（1-lam）*x2得到一张融合的新图<br> 效果图如下： 一张海上帆船与熊猫的融合。<br> <img src="https://images2.imgbox.com/b4/ed/ZznGU1Fu_o.png" alt="在这里插入图片描述"><br> 官方代码：<a href="https://github.com/facebookresearch/mixup-cifar10">https://github.com/facebookresearch/mixup-cifar10</a></p> 
<h2><a id="_65"></a>渐进式采样</h2> 
<p>我们先diss一下传统的过采样与欠采样（按深度之的主播就其个人经验来说，几乎没有用）<br> <img src="https://images2.imgbox.com/e0/4c/JiwTRxLW_o.png" alt="在这里插入图片描述"><br> 而渐进式采样提升0.6%左右<br> <img src="https://images2.imgbox.com/40/97/GnhDvRVL_o.png" alt="在这里插入图片描述"><br> 用大白话来讲，就是随着训练代数的增多，样本数量多的取的越来越少，样本数量少的取的越来越多<br> <img src="https://images2.imgbox.com/95/1b/6f7OgZ1A_o.png" alt="在这里插入图片描述"><br> GitHub：<a href="https://github.com/ufoym/imbalanced-dataset-sampler">https://github.com/ufoym/imbalanced-dataset-sampler</a></p> 
<h2><a id="_74"></a>多尺度训练</h2> 
<p>多尺度训练是一种 「直接有效」 的方法，通过输入不同尺度的图像数据集，因为神经网络卷积池化的特殊性，这样可以让神经网络充分地学习不同分辨率下图像的特征，可以提高机器学习的性能。</p> 
<p>也可以用来处理过拟合效应，在图像数据集不是特别充足的情况下，可以先训练小尺寸图像，然后增大尺寸并再次训练相同模型，这样的思想在Yolo-v2的论文中也提到过：<br> <img src="https://images2.imgbox.com/a6/a4/KuXHojjG_o.png" alt="在这里插入图片描述"></p> 
<p>需要注意的是：多尺度训练并不是适合所有的深度学习应用，多尺度训练可以算是特殊的数据增强方法，在图像大小这一块做了调整。如果有可能最好利用可视化代码将多尺度后的图像近距离观察一下， 「看看多尺度会对图像的整体信息有没有影响」，如果对图像信息有影响的话，这样直接训练的话会误导算法导致得不到应有的结果。<br> 部分来自公众号《CV 技术指南》总结文档中。<br> 部分来自深度之眼的直播</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/67b1e143c92096be158fca9d2c2ceac3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux下7款最佳的开源视频播放器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/854470aaa53302d227925245f9bafaa6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">蚂蚁金服P6级面试归来(已拿Offer)，5点面试经验&#43;14个知识点</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>