<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python2写csv文件中文乱码问题 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python2写csv文件中文乱码问题" />
<meta property="og:description" content="前言 python2最大的坑在于中文编码问题，遇到中文报错首先加u，再各种encode、decode。 当list、tuple、dict里面有中文时，打印出来的是Unicode编码，这个是无解的。 对中文编码纠结的建议尽快换python3吧，python2且用且珍惜！ csv中文乱码 。
前言 python2最大的坑在于中文编码问题，遇到中文报错首先加u，再各种encode、decode。
当list、tuple、dict里面有中文时，打印出来的是Unicode编码，这个是无解的。
对中文编码纠结的建议尽快换python3吧，python2且用且珍惜！
csv中文乱码 1.open打开csv文件，用writer写入带有中文的数据时
writer写入单行writers写入多行 # coding:utf-8 import csv f = open(&#34;xieru.csv&#34;, &#39;wb&#39;) writer = csv.writer(f) # 需要写入的信息 data = [&#34;客户名称&#34;, &#34;行业类型&#34;, &#34;客户联系人&#34;, &#34;职位&#34;, &#34;联系方式&#34;, &#34;邮箱&#34;,&#34;地址&#34;] writer.writerow(data) # 写入单行 # writer.writerows(datas) # 写入多行 f.close() 2.打开csv文件，发现写入的中文乱码了
编码与解码 1.中文乱码问题一直是python2挥之不去的痛，这里先弄清楚乱码原因：
python2本身内部代码的编码有str和unicode两种编码然而文件写入到windows系统时候，windows上的是gb2312编码 所以就导致了乱码问题
2.先把python里面的中文字符串decode成utf-8，再encode为gbk编码
data.decode(&#39;utf-8&#39;).encode(&#39;gbk&#39;)
3.如果是读取csv文件的话，就反过来：
data.decode(&#39;gbk&#39;).encode(&#39;utf-8&#39;)
解决方案 1.方案一：对字符串转换编码(这个太麻烦了，不推荐)
# coding:utf-8 import csv f = open(&#34;xieru1.csv&#34;, &#39;wb&#39;) writer = csv.writer(f) # 需要写入的信息 data = [&#34;客户名称&#34;, &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/df955796d1e136df93961e98983c56cc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-09T15:09:39+08:00" />
<meta property="article:modified_time" content="2022-02-09T15:09:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python2写csv文件中文乱码问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>前言 python2最大的坑在于中文编码问题，遇到中文报错首先加u，再各种encode、decode。 当list、tuple、dict里面有中文时，打印出来的是Unicode编码，这个是无解的。 对中文编码纠结的建议尽快换python3吧，python2且用且珍惜！ csv中文乱码 。</p> 
<p></p> 
<p></p> 
<p></p> 
<h2 id="slide-0">前言</h2> 
<p>python2最大的坑在于中文编码问题，遇到中文报错首先加u，再各种encode、decode。<br> 当list、tuple、dict里面有中文时，打印出来的是Unicode编码，这个是无解的。<br> 对中文编码纠结的建议尽快换python3吧，python2且用且珍惜！</p> 
<h2 id="slide-1">csv中文乱码</h2> 
<p>1.open打开csv文件，用writer写入带有中文的数据时</p> 
<ul><li>writer写入单行</li><li>writers写入多行</li></ul> 
<pre><code># coding:utf-8
import csv

f = open("xieru.csv", 'wb')
writer = csv.writer(f)

# 需要写入的信息
data = ["客户名称", "行业类型", "客户联系人", "职位", "联系方式", "邮箱","地址"]

writer.writerow(data)       # 写入单行
# writer.writerows(datas)    # 写入多行

f.close()</code></pre> 
<p>2.打开csv文件，发现写入的中文乱码了</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b8/c1/wFBBIM0G_o.png"></p> 
<h2 id="slide-2">编码与解码</h2> 
<p>1.中文乱码问题一直是python2挥之不去的痛，这里先弄清楚乱码原因：</p> 
<ul><li>python2本身内部代码的编码有str和unicode两种编码</li><li>然而文件写入到windows系统时候，windows上的是gb2312编码</li></ul> 
<p>所以就导致了乱码问题</p> 
<p>2.先把python里面的中文字符串decode成utf-8，再encode为gbk编码</p> 
<blockquote> 
 <p>data.decode('utf-8').encode('gbk')</p> 
</blockquote> 
<p>3.如果是读取csv文件的话，就反过来：</p> 
<blockquote> 
 <p>data.decode('gbk').encode('utf-8')</p> 
</blockquote> 
<h2 id="slide-3">解决方案</h2> 
<p>1.方案一：对字符串转换编码(这个太麻烦了，不推荐)</p> 
<pre><code># coding:utf-8
import csv

f = open("xieru1.csv", 'wb')
writer = csv.writer(f)

# 需要写入的信息
data = ["客户名称", "行业类型", "客户联系人", "职位", "联系方式", "邮箱","地址"]

a = []
for i in data:
    a.append(i.decode("utf-8").encode("gbk"))

writer.writerow(a)           # 写入单行
# writer.writerows(datas)    # 写入多行

f.close()</code></pre> 
<p>2.方法二：用codecs提供的open方法来指定打开的文件的语言编码，它会在读取的时候自动转换为内部unicode (推荐)</p> 
<pre><code># coding:utf-8
import csv, codecs

import sys
reload(sys)
sys.setdefaultencoding('utf8')

f = codecs.open("xx.csv", 'wb', "gbk")
writer = csv.writer(f)
writer.writerow(["客户名称", "行业类型", "客户联系人", "职位", "联系方式", "邮箱","地址"])

# 多组数据存放list列表里面
datas = [
    ["客户名称", "行业类型", "客户联系人", "职位", "联系方式", "邮箱","地址"],
    ["客户名称", "行业类型", "客户联系人", "职位", "联系方式", "邮箱","地址"],
    ["客户名称", "行业类型", "客户联系人", "职位", "联系方式", "邮箱","地址"],
       ]

writer.writerows(datas)
f.close()</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/87b19936100c82c4c1df7dd15dae6f73/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">tvm tutorial (1.1)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9a2c37181926df2fa5d24545fc84161e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">17 个实用 shell 脚本</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>