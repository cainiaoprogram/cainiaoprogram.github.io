<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>安全漏洞--C/C&#43;&#43;代码安全漏洞审计技术学习分享 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="安全漏洞--C/C&#43;&#43;代码安全漏洞审计技术学习分享" />
<meta property="og:description" content="0x01 简介 代码审计，大家估计见到最多的一般是web程序的代码审计。然而c/c&#43;&#43;这种语言的代码审计估计就很少了。
今天我们要来学习一下，工欲善其事必先利其器，今天介绍一款审计的利器Flawfinder（当然同类的还有很多工具，比如
RATS,RIPS,VCG,Fortify SCA,GOLD,YASCA等等）。该工具我搭建运行在ubuntu16.0.4LTS系统之上。
Flawfinder是一个C/C&#43;&#43;代码的开源安全审查工具，采用内建语法缺陷数据库，能够标记类似缓冲溢出、格式字符串、竞争条件、随
机数获取方面的问题。Flawfinder是一个非常简单的工具，采用的算法也不复杂，可以看做是一个基于词典的源代码静态分析器。
Flawfinder的开发者David Wheeler表示：很多软件开发者都在不断重复犯相同的错误，开发人员应当在软件部署前就
用Flawfinder审查代码。 官方地址http://www.dwheeler.com/flawfinder/
0x02 flawfinder root@ubuntu:~/Desktop# flawfinder --h *** getopt error: option --h not a unique prefix flawfinder [--help | -h] [--version] [--listrules] [--allowlink] [--followdotdir] [--nolink] [--patch filename | -P filename] [--inputs | -I] [--minlevel X | -m X] [--falsepositive | -F] [--neverignore | -n] [--context | -c] [--columns | -C] [--dataonly | -D] [--html | -H] [--immediate | -i] [--singleline | -S] [--omittime] [--quiet | -Q] [--loadhitlist F] [--savehitlist F] [--diffhitlist F] [--] [source code file or source root directory]&#43; The options cover various aspects of flawfinder as follows." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/7574dbc537aa0baa8aa2f7202c1c2d68/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-10-18T13:29:24+08:00" />
<meta property="article:modified_time" content="2016-10-18T13:29:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">安全漏洞--C/C&#43;&#43;代码安全漏洞审计技术学习分享</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2><span style="font-size:18px">0x01 简介</span></h2> 
<p><br> </p> 
<p><span style="font-size:18px">代码审计，大家估计见到最多的一般是web程序的代码审计。然而c/c++这种语言的代码审计估计就很少了。</span></p> 
<p><span style="font-size:18px">今天我们要来学习一下，工欲善其事必先利其器，今天介绍一款审计的利器Flawfinder（当然同类的还有很多工具，比如</span></p> 
<p><span style="font-size:18px">RATS,RIPS,VCG,Fortify SCA,GOLD,YASCA等等）。该工具我搭建运行在ubuntu16.0.4LTS系统之上。</span></p> 
<p></p> 
<p><span style="font-size:18px">Flawfinder是一个C/C++代码的开源安全审查工具，采用内建语法缺陷数据库，能够标记类似缓冲溢出、格式字符串、竞争条件、随</span></p> 
<p><span style="font-size:18px">机数获取方面的问题。Flawfinder是一个非常简单的工具，采用的算法也不复杂，可以看做是一个基于词典的源代码静态分析器。</span></p> 
<p><span style="font-size:18px">Flawfinder的开发者David Wheeler表示：很多软件开发者都在不断重复犯相同的错误，开发人员应当在软件部署前就</span></p> 
<p><span style="font-size:18px">用Flawfinder审</span><span style="font-size:18px">查代码。  官方地址</span><a target="_blank" href="http://www.dwheeler.com/flawfinder/" rel="nofollow noopener noreferrer" style="font-size:18px">http://www.dwheeler.com/flawfinder/</a></p> 
<br> 
<h2><span style="font-size:18px">0x02 flawfinder</span></h2> 
<div> 
 <span style="font-size:18px"></span> 
 <pre><code class="language-html">root@ubuntu:~/Desktop# flawfinder --h
*** getopt error: option --h not a unique prefix

flawfinder [--help | -h] [--version] [--listrules]
  [--allowlink] [--followdotdir] [--nolink] 
           [--patch filename | -P filename]
  [--inputs | -I] [--minlevel X | -m X]
           [--falsepositive | -F] [--neverignore | -n]
  [--context | -c] [--columns | -C] [--dataonly | -D]
           [--html | -H] [--immediate | -i] [--singleline | -S]
           [--omittime] [--quiet | -Q]
  [--loadhitlist F] [--savehitlist F] [--diffhitlist F]
  [--] [source code file or source root directory]+

  The options cover various aspects of flawfinder as follows.

  Documentation:
  --help | -h Show this usage help.
  --version   Show version number.
  --listrules List the rules in the ruleset (rule database).

  Selecting Input Data:
  --allowlink Allow symbolic links.
  --followdotdir
              Follow directories whose names begin with ".".
              Normally they are ignored.
  --nolink    Skip symbolic links (ignored).
  --patch F | -P F
              Display information related to the patch F
              (patch must be already applied).

  Selecting Hits to Display:
  --inputs | -I
              Show only functions that obtain data from outside the program;
              this also sets minlevel to 0.
  -m X | --minlevel=X
              Set minimum risk level to X for inclusion in hitlist.  This
              can be from 0 (``no risk'')  to  5  (``maximum  risk'');  the
              default is 1.
  --falsepositive | -F
              Do not include hits that are likely to be false  positives.
              Currently,  this  means  that function names are ignored if
              they're not followed by "(", and that declarations of char-
              acter  arrays  aren't noted.  Thus, if you have use a vari-
              able named "access" everywhere, this will eliminate  refer-
              ences  to  this ordinary variable.  This isn't the default,
              because this  also  increases  the  likelihood  of  missing
              important  hits;  in  particular, function names in #define
              clauses and calls through function pointers will be missed.
  --neverignore | -n
              Never ignore security issues, even if they have an ``ignore''
              directive in a comment.
  --regex PATTERN | -e PATTERN
              Only report hits that match the regular expression PATTERN.

  Selecting Output Format:
  --columns | -C
              Show  the  column  number  (as well as the file name and
              line number) of each hit; this is shown after the line number
              by adding a colon and the column number in the line (the first
              character in a line is column number 1).
  --context | -c
              Show context (the line having the "hit"/potential flaw)
  --dataonly | -D
              Don't display the headers and footers of the analysis;
              use this along with --quiet to get just the results.
  --html | -H
              Display as HTML output.
  --immediate | -i
              Immediately display hits (don't just wait until the end).
  --singleline | -S
              Single-line output.
  --omittime  Omit time to run.
  --quiet | -Q
              Don't display status information (i.e., which files are being
              examined) while the analysis is going on.

  Hitlist Management:
  --savehitlist=F
              Save all hits (the "hitlist") to F.
  --loadhitlist=F
              Load hits from F instead of analyzing source programs.
  --diffhitlist=F
              Show only hits (loaded or analyzed) not in F.


  For more information, please consult the manpage or available
  documentation.</code></pre> 
 <br> 
 <br> 
</div> 
<p><span style="font-size:18px"><br> </span></p> 
<h2><span style="font-size:18px">0x03 示例</span></h2> 
<p></p> 
<p><span style="font-size:18px">代码</span></p> 
<p><span style="font-size:18px"><img src="https://images2.imgbox.com/ab/d7/BEdCZSWC_o.jpg" alt=""><br> </span></p> 
<p><span style="font-size:18px"><br> </span></p> 
<p><span style="font-size:18px">命令</span></p> 
<p><span style="font-size:18px"></span></p> 
<pre><code class="language-html">flawfinder --columns --context main.c --html</code></pre> 
<p></p> 
<p></p> 
<p><span style="font-size:18px">也可以保存成文档</span></p> 
<p><span style="font-size:18px"></span></p> 
<pre><code class="language-html">flawfinder --columns --context main.c --html &gt; result.html</code></pre> 
<br> 
<p></p> 
<p><br> </p> 
<img src="https://images2.imgbox.com/3a/71/IfIB9DKc_o.jpg" alt=""> 
<br> 
<p><br> </p> 
<p><br> </p> 
<h2><span style="font-size:18px">0x04 结果分析</span></h2> 
<div> 
 <span style="font-size:18px"></span> 
 <pre><code class="language-html">Flawfinder version 1.31, (C) 2001-2014 David A. Wheeler.
Number of rules (primarily dangerous function names) in C/C++ ruleset: 169
Examining main.c
Warning: Skipping non-existent file --html

FINAL RESULTS:

main.c:7:2:  [5] (buffer) gets:
  Does not check for buffer overflows (CWE-120, CWE-20). Use fgets() instead.
	gets(ch,stdin);
main.c:6:2:  [2] (buffer) char:
  Statically-sized arrays can be improperly restricted, leading to potential
  overflows or other issues (CWE-119:CWE-120). Perform bounds checking, use
  functions that limit length, or ensure that the size is larger than the
  maximum possible length.
	char ch[50];

ANALYSIS SUMMARY:

Hits = 2
Lines analyzed = 9 in approximately 0.01 seconds (1170 lines/second)
Physical Source Lines of Code (SLOC) = 9
Hits@level = [0]   0 [1]   0 [2]   1 [3]   0 [4]   0 [5]   1
Hits@level+ = [0+]   2 [1+]   2 [2+]   2 [3+]   1 [4+]   1 [5+]   1
Hits/KSLOC@level+ = [0+] 222.222 [1+] 222.222 [2+] 222.222 [3+] 111.111 [4+] 111.111 [5+] 111.111
Minimum risk level = 1
Not every hit is necessarily a security vulnerability.
There may be other security vulnerabilities; review your code!
See 'Secure Programming for Linux and Unix HOWTO'
(http://www.dwheeler.com/secure-programs) for more information.</code></pre> 
</div> 
<p><span style="font-size:18px"><br> </span></p> 
<p><span style="font-size:18px"><strong><span style="color:#ff0000">main.c:7:2:  [5] (buffer) gets: //第七行 没有检查buffer缓存会溢出。</span></strong><br>   Does not check for buffer overflows (CWE-120, CWE-20). Use fgets() instead.<br> <span style="white-space:pre"></span>gets(ch,stdin);<br> <strong><span style="color:#ff0000">main.c:6:2:  [2] (buffer) char: //第六行 静态分配的数组大小会被溢出。</span></strong><br>   Statically-sized arrays can be improperly restricted, leading to potential<br>   overflows or other issues (CWE-119:CWE-120). Perform bounds checking, use<br>   functions that limit length, or ensure that the size is larger than the<br>   maximum possible length.<br> <span style="white-space:pre"></span>char ch[50];<br> </span><br> </p> 
<p><span style="font-size:18px"><span style="color:#ff0000"><strong>ANALYSIS SUMMARY: //分析总结</strong></span><br> <br> <strong><span style="color:#ff0000">Hits = 2 //两个可疑点<br> Lines analyzed = 9 in approximately 0.01 seconds (1170 lines/second) //总共9行代码用时0.01s</span></strong><br> Physical Source Lines of Code (SLOC) = 9<br> Hits@level = [0]   0 [1]   0 [2]   1 [3]   0 [4]   0 [5]   1<br> Hits@level+ = [0+]   2 [1+]   2 [2+]   2 [3+]   1 [4+]   1 [5+]   1<br> Hits/KSLOC@level+ = [0+] 222.222 [1+] 222.222 [2+] 222.222 [3+] 111.111 [4+] 111.111 [5+] 111.111<br> <span style="color:#ff0000"><strong>Minimum risk level = 1</strong></span><br> <span style="color:#ff0000"><strong>Not every hit is necessarily a security vulnerability. //注意此处，不是所有的可疑点都是安全漏洞</strong></span><br> There may be other security vulnerabilities; review your code!<br> See 'Secure Programming for Linux and Unix HOWTO'<br> (http://www.dwheeler.com/secure-programs) for more information.</span><br> </p> 
<h2><span style="font-size:18px">0x05 总结</span></h2> 
<p><span style="font-size:18px"><br> </span></p> 
<p><span style="font-size:18px">       自动化的静态代码审计工具虽然可以在某种程度节省代码审计的人力成本，时间成本。</span></p> 
<p><span style="font-size:18px">是提高代码审计效率的重要手段。</span><span style="font-size:18px">然而需要注意的是，自动化工具并非是完全智能准确的，</span></p> 
<p><span style="font-size:18px">跟所有的检测扫描工具一样，误报率的</span><span style="font-size:18px">存在仍然是必须面对的现实问题。因此，检测结果</span></p> 
<p><span style="font-size:18px">中显示的漏洞还是需要审计人员，手动验证或者手工进一步确认是否真的存在。</span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0ab6bc38e8ed73a5cf5bff8dcaf34d31/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VC 操作Excel sheet复制、重命名</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fe86fee6ec4d69c798163d861f171289/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">golang实践-目录结构与工具</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>