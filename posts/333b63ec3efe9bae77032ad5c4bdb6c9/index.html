<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>UE5像素流公网多人部署 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="UE5像素流公网多人部署" />
<meta property="og:description" content="前言： 本机需要安装 node.js node安装与配置
打包项目时需要启用插件 Pixel Streaming
一、打包项目后进入 Samples\PixelStreaming\WebServers\SignallingWebServer 目录 1、在目录下新建 文本文档 添加以下内容，然后改名与后缀为 setup.bat
:: Copyright Epic Games, Inc. All Rights Reserved. pushd %~dp0 npm install popd 2、同上创建一个 run.bat 添加以下内容
:: Copyright Epic Games, Inc. All Rights Reserved. @echo off pushd %~dp0 call setup.bat title Cirrus ::Run node server ::If running with frontend web server and accessing outside of localhost pass in --publicIp=&lt;ip_of_machine&gt; node cirrus %* popd pause 3、修改 config." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/333b63ec3efe9bae77032ad5c4bdb6c9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-21T09:42:29+08:00" />
<meta property="article:modified_time" content="2023-03-21T09:42:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">UE5像素流公网多人部署</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <h4>前言：</h4> 
 <p>本机需要安装 node.js <a href="http://t.csdn.cn/ktlmn" rel="nofollow" title="node安装与配置">node安装与配置</a></p> 
 <p>打包项目时需要启用插件 <strong>Pixel Streaming</strong></p> 
</blockquote> 
<h4>一、打包项目后进入 Samples\PixelStreaming\WebServers\SignallingWebServer 目录</h4> 
<blockquote> 
 <p>1、在目录下新建 文本文档 添加以下内容，然后改名与后缀为 setup.bat</p> 
</blockquote> 
<pre><code class="language-bash">:: Copyright Epic Games, Inc. All Rights Reserved.
pushd %~dp0

npm install

popd
</code></pre> 
<p></p> 
<blockquote> 
 <p>2、同上创建一个 run.bat 添加以下内容</p> 
</blockquote> 
<p></p> 
<pre><code class="language-bash">:: Copyright Epic Games, Inc. All Rights Reserved.
@echo off

pushd %~dp0

call setup.bat

title Cirrus

::Run node server
::If running with frontend web server and accessing outside of localhost pass in --publicIp=&lt;ip_of_machine&gt;
node cirrus %*

popd
pause
</code></pre> 
<p></p> 
<blockquote> 
 <p> 3、修改 config.json 文件，把 localhost 修改为公网ip（本地部署不用修改），HttpPort 修改为外网访问的端口（默认是80）</p> 
</blockquote> 
<pre><code class="language-javascript">{
	"UseFrontend": false,
	"UseMatchmaker": false,
	"UseHTTPS": false,
	"UseAuthentication": false,
	"LogToFile": true,
	"LogVerbose": true,
	"HomepageFile": "/Public/player.html",
	"AdditionalRoutes": {},
	"EnableWebserver": true,
	"MatchmakerAddress": "",
	"MatchmakerPort": "9999",
	"PublicIp": "localhost",
	"HttpPort": 88,
	"HttpsPort": 443,
	"StreamerPort": 8888,
	"SFUPort": 8889,
	"peerConnectionOptions": "{ \"iceServers\": [{\"urls\": [\"stun:localhost:19302\",\"turn:localhost:19303\"], \"username\": \"PixelStreamingUser\", \"credential\": \"Another TURN in the road\"}] }"
}</code></pre> 
<blockquote> 
 <p> 4、双击运行 run.bat 启动服务</p> 
</blockquote> 
<p><img alt="" height="250" src="https://images2.imgbox.com/d8/d0/XZ9zo5F9_o.png" width="307"></p> 
<blockquote> 
 <p> 5、出现以下界面代表服务启动成功（窗口不要关）</p> 
</blockquote> 
<h4><img alt="" height="442" src="https://images2.imgbox.com/57/ea/j8aWiuZW_o.png" width="955"></h4> 
<h4> 二、启动项目（返回项目根目录）</h4> 
<blockquote> 
 <p> 1、创建项目启动文件快捷方式（win10可以选择文件后按住 alt 与鼠标左键拖动即可快速创建）</p> 
</blockquote> 
<p><img alt="" height="295" src="https://images2.imgbox.com/19/2d/JNWVzD9v_o.png" width="290"></p> 
<blockquote> 
 <p> 2、创建快捷方式后，右键快捷方式选择属性，在目标后面，加上空格，再加上下面代码保存</p> 
</blockquote> 
<pre><code class="language-bash">-AudioMixer -PixelStreamingIP=localhost -PixelStreamingPort=8888</code></pre> 
<blockquote> 
 <p>3、打开创建的快捷方式运行项目（项目不能最小化，否则像素流不出去）在浏览器输入上面设置好的ip与端口（本地测试）</p> 
</blockquote> 
<h4><img alt="" height="548" src="https://images2.imgbox.com/41/92/HwgCBezb_o.png" width="997"></h4> 
<h4> 三、公网访问</h4> 
<blockquote> 
 <p>服务器需要开放 19302 与 19303 端口</p> 
 <p>需要获取ue4.26打包出来 release 文件夹</p> 
 <p>ue4.26后的版本已去掉了此文件，此文件里面是两个协议 turn 与 stun，用来公网NAT穿透</p> 
</blockquote> 
<p><img alt="" height="355" src="https://images2.imgbox.com/77/7c/6niKavuM_o.png" width="1012"></p> 
<blockquote> 
 <p> 1、随便导出一个4.26的测试项目（需要启用插件 <strong>Pixel Streaming</strong>），在导出的项目搜索 release 文件夹，可以复制出来单独使用</p> 
</blockquote> 
<p> <img alt="" height="107" src="https://images2.imgbox.com/bf/1f/LBol5bhp_o.png" width="914"></p> 
<blockquote> 
 <p> 2、修改 release 文件夹里面的 Start_AWS_TURNServer.ps1 文件，把 $LocalIp 后面修改为127.0.0.1</p> 
</blockquote> 
<p> <img alt="" height="429" src="https://images2.imgbox.com/17/b8/QyaDIY7W_o.png" width="595"> </p> 
<blockquote> 
 <p> 3、分别启动 Start_AWS_TURNServer.bat 与 Start_STUNServer.bat（启动后窗口不要关）</p> 
</blockquote> 
<p> <img alt="" height="254" src="https://images2.imgbox.com/b7/af/jOu8iEGh_o.png" width="283"></p> 
<h4> 四、公网预览项目</h4> 
<blockquote> 
 <p>在浏览器输入前面填的公网ip与端口即可访问</p> 
 <p>注意事项：</p> 
 <p>1、以上所有打开的命令窗口与项目运行窗口都不能关闭（3个命令窗口1个项目运行窗口）</p> 
 <p>2、如需后台运行项目，可以在上面的快捷方式加上之前的代码后接着加上空格与下面代码</p> 
 <p>3、如需关闭后台运行项目，需要去任务管理器结束</p> 
</blockquote> 
<pre><code>-RenderOffScreen</code></pre> 
<h4> 五、可选功能（Matchmaker分发访问）此步骤与前面分开</h4> 
<blockquote> 
 <p>服务器运行多个项目，通过访问一个Matchmaker地址，自动分发空闲的项目（有点类似服务器的负载均衡）</p> 
</blockquote> 
<blockquote> 
 <p>1、进入 Samples\PixelStreaming\WebServers\Matchmaker 目录，修改 config.json 文件的HttpPort 端口（不可与之前的信令服务器端口冲突）</p> 
</blockquote> 
<pre><code class="language-javascript">{
	"HttpPort": 90,
	"UseHTTPS": false,
	"MatchmakerPort": 9999,
	"LogToFile": true
}</code></pre> 
<blockquote> 
 <p>2、运行 run.bat 文件 （运行后窗口不要关）</p> 
</blockquote> 
<p><img alt="" height="268" src="https://images2.imgbox.com/31/90/GmoSfHw1_o.png" width="296"></p> 
<blockquote> 
 <p> 3、复制一份之前的信令服务文件夹</p> 
</blockquote> 
<p><img alt="" height="244" src="https://images2.imgbox.com/d3/a3/i0Ot1cIn_o.png" width="326"></p> 
<blockquote> 
 <p> 4、分别修改里面的 config.json 文件，以下示例（主要修改UseMatchmaker、HttpPort、StreamerPort、SFUPort这四个值），localhost 修改为公网ip</p> 
</blockquote> 
<h4>第一个config.json</h4> 
<pre><code class="language-javascript">{
	"UseFrontend": false,
	"UseMatchmaker": true,
	"UseHTTPS": false,
	"UseAuthentication": false,
	"LogToFile": true,
	"LogVerbose": true,
	"HomepageFile": "/Public/player.html",
	"AdditionalRoutes": {},
	"EnableWebserver": true,
	"MatchmakerAddress": "",
	"MatchmakerPort": "9999",
	"PublicIp": "localhost",
	"HttpPort": 81,
	"HttpsPort": 443,
	"StreamerPort": 8001,
	"SFUPort": 8801,
	"peerConnectionOptions": "{ \"iceServers\": [{\"urls\": [\"stun:localhost:19302\",\"turn:localhost:19303\"], \"username\": \"PixelStreamingUser\", \"credential\": \"Another TURN in the road\"}] }"
}</code></pre> 
<h4> 第二个config.json</h4> 
<pre><code class="language-javascript">{
	"UseFrontend": false,
	"UseMatchmaker": true,
	"UseHTTPS": false,
	"UseAuthentication": false,
	"LogToFile": true,
	"LogVerbose": true,
	"HomepageFile": "/Public/player.html",
	"AdditionalRoutes": {},
	"EnableWebserver": true,
	"MatchmakerAddress": "",
	"MatchmakerPort": "9999",
	"PublicIp": "localhost",
	"HttpPort": 82,
	"HttpsPort": 443,
	"StreamerPort": 8002,
	"SFUPort": 8802,
	"peerConnectionOptions": "{ \"iceServers\": [{\"urls\": [\"stun:localhost:19302\",\"turn:localhost:19303\"], \"username\": \"PixelStreamingUser\", \"credential\": \"Another TURN in the road\"}] }"
}</code></pre> 
<blockquote> 
 <p>5、运行多个项目（也可以同一个项目复制多个快捷方式，运行是单独的）</p> 
</blockquote> 
<p><img alt="" height="244" src="https://images2.imgbox.com/00/b2/mfsCPzct_o.png" width="292"></p> 
<blockquote> 
 <p> 6、分别右键在属性的目标后面加上以下代码（同上记得先加空格）</p> 
</blockquote> 
<pre><code class="language-javascript">// 快捷方式1
-AudioMixer -PixelStreamingIP=localhost -PixelStreamingPort=8001

// 快捷方式2
-AudioMixer -PixelStreamingIP=localhost -PixelStreamingPort=8002</code></pre> 
<p><img alt="" height="281" src="https://images2.imgbox.com/52/ff/YBXzgi8s_o.png" width="653"></p> 
<p> <img alt="" height="308" src="https://images2.imgbox.com/b9/6b/66AaevkE_o.png" width="680"></p> 
<blockquote> 
 <p> 7、分别运行前面的两个信令服务与这个两个快捷方式，执行后访问前面信令服务 config.json 里面设置的公网ip与 Matchmaker 里面 config.json 设置的端口，即可自动分发</p> 
</blockquote> 
<h4>此教程需要具备一些的ue项目像素流的基础了解，如有疑问可留言</h4> 
<h4>end </h4>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/14d84aa266cbc20d3c871313a71530f1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java中Json转List(Jackson)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/611b0d96c2e227126038f0543dfa9f7a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Layer子iframe传数据到父页面的两种方式【按钮和非按钮】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>