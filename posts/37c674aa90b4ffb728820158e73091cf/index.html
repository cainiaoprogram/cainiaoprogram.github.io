<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>VBA基础 - 分支和循环 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="VBA基础 - 分支和循环" />
<meta property="og:description" content="概要 编程语言的基础除了数据类型, 就是控制结构了. 所谓控制结构, 主要就是分支和循环.
分支 废话不说, 直接示例代码:
单条件判断 1 Sub Test() 2 If 2 &gt; 1 Then 3 Debug.Print &#34;xxxx&#34; 4 End If 5 End Sub 执行后输出:
xxxx 多条件判断 if-elseif-else 结构
1 Option Explicit 2 3 Sub Test() 4 score 55 5 score 65 6 score 85 7 score 95 8 End Sub 9 10 Function score(points As Integer) 11 12 If points &gt; 0 And points &lt; 60 Then 13 Debug." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/37c674aa90b4ffb728820158e73091cf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-09-29T11:01:00+08:00" />
<meta property="article:modified_time" content="2019-09-29T11:01:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">VBA基础 - 分支和循环</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown"> 
 <h2 id="概要">概要</h2> 
 <p>编程语言的基础除了数据类型, 就是控制结构了. 所谓控制结构, 主要就是分支和循环.</p> 
 <h2 id="分支">分支</h2> 
 <p>废话不说, 直接示例代码:</p> 
 <h3 id="单条件判断">单条件判断</h3> 
 <pre><code class="language-vb"><code>1  Sub Test()
2   If 2 &gt; 1 Then
3       Debug.Print "xxxx"
4   End If
5  End Sub</code></code></pre> 
 <p>执行后输出:</p> 
 <pre><code>xxxx</code></pre> 
 <h3 id="多条件判断">多条件判断</h3> 
 <ol><li><p>if-elseif-else 结构</p> <pre><code class="language-vb"><code> 1  Option Explicit
 2  
 3  Sub Test()
 4      score 55
 5      score 65
 6      score 85
 7      score 95
 8  End Sub
 9  
10  Function score(points As Integer)
11  
12      If points &gt; 0 And points &lt; 60 Then
13          Debug.Print "不及格"
14      ElseIf points &gt; 80 And points &lt; 90 Then
15          Debug.Print "良好"
16      ElseIf points &gt;= 90 Then
17          Debug.Print "优秀"
18      Else
19          Debug.Print "及格"
20      End If
21  
22  End Function</code></code></pre> <p>输出结果:</p> <pre><code>      不及格
      及格
      良好
      优秀</code></pre></li><li><p>select-case 结构</p> <pre><code class="language-vb"><code> 1  Option Explicit
 2  
 3  Sub Test()
 4      score 55
 5      score 65
 6      score 85
 7      score 95
 8  End Sub
 9  
10  Function score(points As Integer)
11  
12      Select Case points
13          Case 90 To 100
14              Debug.Print "优秀"
15          Case 80 To 90
16              Debug.Print "良好"
17          Case 60 To 80
18              Debug.Print "及格"
19          Case 0 To 60
20              Debug.Print "不及格"
21      End Select
22  
23  End Function</code></code></pre> <p>输出结果:</p> <pre><code>      不及格
      及格
      良好
      优秀</code></pre></li></ol> 
 <h3 id="异常处理">异常处理</h3> 
 <p>其实异常处理, 也是一种条件判断, 只不过只将异常作为条件</p> 
 <pre><code class="language-vb"><code> 1  Option Explicit
 2  
 3  Sub Test()
 4      Dim x As Integer
 5  
 6      On Error GoTo finally
 7          x = 10 / 0
 8  
 9  finally:
10      Debug.Print "发生错误"
11  
12  End Sub</code></code></pre> 
 <p>输出结果:</p> 
 <pre><code>  发生错误</code></pre> 
 <h2 id="循环">循环</h2> 
 <h3 id="for-next">for-next</h3> 
 <pre><code class="language-vb"><code> 1  Option Explicit
 2  
 3  Sub Test()
 4      Dim n As Integer
 5  
 6      Debug.Print "打印 1 ~ 10 的奇数"
 7      For n = 1 To 10 Step 2
 8          Debug.Print n
 9      Next n
10  
11  End Sub</code></code></pre> 
 <p>执行结果:</p> 
 <pre><code>打印 1 ~ 10 的奇数
1
3
5
7
9</code></pre> 
 <h3 id="for-each-next">for-each-next</h3> 
 <pre><code class="language-vb"><code> 1  Option Explicit
 2  
 3  Sub Test()
 4      Dim n As Variant
 5  
 6      Debug.Print "打印 1 ~ 10 的奇数"
 7      For Each n In Array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
 8          If Not n Mod 2 = 0 Then
 9              Debug.Print n
10          End If
11      Next
12  
13  End Sub</code></code></pre> 
 <p>执行结果:</p> 
 <pre><code>打印 1 ~ 10 的奇数
1
3
5
7
9</code></pre> 
 <h3 id="do-loop-until">do-loop-until</h3> 
 <pre><code class="language-vb"><code> 1  Option Explicit
 2  
 3  Sub Test()
 4      Dim n As Integer
 5  
 6      Debug.Print "打印 1 ~ 10 的奇数"
 7      Do
 8          n = n + 1
 9  
10          If Not n Mod 2 = 0 Then
11              Debug.Print n
12          End If
13      Loop Until n &gt;= 10
14  
15      n = 0
16  
17      Debug.Print "打印 1 ~ 10 的奇数"
18      Do Until n &gt;= 10
19          n = n + 1
20  
21          If Not n Mod 2 = 0 Then
22              Debug.Print n
23          End If
24      Loop
25  
26  End Sub</code></code></pre> 
 <p>执行结果:</p> 
 <pre><code>   打印 1 ~ 10 的奇数
   1
   3
   5
   7
   9
  打印 1 ~ 10 的奇数
   1
   3
   5
   7
   9</code></pre> 
 <p>上例中, <strong>until</strong> 的位置对循环的影响:</p> 
 <ol><li>until 在 Do 后面: 先进行判断, 再运行循环体</li><li>until 在 Loop 后面: 先运行循环体, 再进行判断</li></ol> 
 <p>示例:</p> 
 <pre><code class="language-vb"><code> 1  Option Explicit
 2  
 3  Sub Test()
 4      Dim n As Integer
 5  
 6      n = 0
 7      Do
 8          Debug.Print "会运行"
 9      Loop Until n = 0
10  
11      n = 0
12      Do Until n = 0
13          Debug.Print "不会运行"
14      Loop
15  
16  End Sub</code></code></pre> 
 <p>执行结果如下:</p> 
 <pre><code>   会运行</code></pre> 
 <h3 id="do-loop-while">do-loop-while</h3> 
 <pre><code class="language-vb"><code> 1  Option Explicit
 2  
 3  Sub Test()
 4      Dim n As Integer
 5  
 6      Debug.Print "打印 1 ~ 10 的奇数"
 7      Do
 8          n = n + 1
 9  
10          If Not n Mod 2 = 0 Then
11              Debug.Print n
12          End If
13      Loop While n &lt; 10
14  
15      n = 0
16  
17      Debug.Print "打印 1 ~ 10 的奇数"
18      Do While n &lt; 10
19          n = n + 1
20  
21          If Not n Mod 2 = 0 Then
22              Debug.Print n
23          End If
24      Loop
25  
26  End Sub</code></code></pre> 
 <p>执行结果和 <strong>until</strong> 一样:</p> 
 <pre><code>   打印 1 ~ 10 的奇数
   1
   3
   5
   7
   9
  打印 1 ~ 10 的奇数
   1
   3
   5
   7
   9</code></pre> 
 <p><strong>while</strong> vs <strong>until</strong>:</p> 
 <ul><li>while 是满足条件运行循环体</li><li>until 是满足条件退出循环体</li></ul> 
</div> 
<p>转载于:https://www.cnblogs.com/wang_yb/p/11606585.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7be8af8322ef7cc6b19d7cf77af6c080/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">AD自动布地过孔设置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/221c9d5074b48d831679e81af3c5db0f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">redis 安装配置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>