<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MySQL优化解析 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MySQL优化解析" />
<meta property="og:description" content=" MySQL优化解析 前言 无论在工作实践还是面试理论中MySQL优化作为重要的一环，都应需要各位开发了解并掌握其解决方案
硬件与操作系统 硬件配置升级 cpu性能和核心数内存固态硬盘网络 操作系统 windows改linux MySQL配置 增加MySQL服务器可用连接数
show variables like &#39;MAX_CONNECTIONS&#39;; --- 查看连接数，默认151，可以设置成16384(2^14) 减少客户端可用连接数
连接池设置批量操作最大传输数据大小 调节MySQL的配置文件my.ini中的 max_allowed_socket 参数大小 设置第三方缓存模块 使用redis等第三方中间件开启mybatis或hibernate等ORM框架缓存模块 慢查询等性能分析工具开启
慢查询日志show variables like &#39;slow_query%&#39;; --- 慢日志信息 show variables like &#39;long_query_time&#39;; --- 当SQL执行超过这个值时才记录到慢日志中,默认10s mysql专门用来分析慢日志的工具 mysqldumpslow profilesmysqldumoslow -s t -t 20 -g &#39;select&#39; /var/lib/mysql/localhost-slow.log --表示前二十个耗时最长的SQL语句查询语句 show profiles; select @@profiling; 数据库架构 分库分表 mycat/sharing jdbc 集群 一主多从多主一从互为主从级联复制 存储引擎和表结构 存储引擎 当插入和查询较多时，选择MyISAM存储引擎，不支持事务临时表，选择基于内存的Memory存储引擎大多数业务场景下使用默认Innodb存储引擎，支持事务 表结构 字段类型选择字段大小选择 SQL和索引 SQL优化 执行计划：EXPLAIN SELECT * FROM USER WHERE id =1; select_type;简单查询、子查询、联合查询type:衡量SQL执行效率的一个重要指标 system/const/eq_ref 一般业务SQL很难优化到这种起步，忽略ref：select * from student where name=‘小明’; //name为索引rang：select name from student where id&gt;1; //id字段为索引index：select name from student; //name字段为索引all：select name from student; //name字段不为索引 possible_keys：查询过程中可能使用到的索引key：查询过程中实际使用到的索引Extra：十分重要的额外信息 using filesort：select * from student order by name; //name字段不为索引using temporary：select distinct name,phone from student;using index：select phone from student where name=‘小明’; //name_phone为联合索引using where：select * from student where phone=18012345678; //iphone不为索引using index condition：索引下推 索引优化 " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/998919efbef13804abc11bcfac5d0843/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-16T20:39:15+08:00" />
<meta property="article:modified_time" content="2022-04-16T20:39:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL优化解析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="MySQL_0"></a>MySQL优化解析</h2> 
<h3><a id="_1"></a>前言</h3> 
<blockquote> 
 <p>无论在工作实践还是面试理论中MySQL优化作为重要的一环，都应需要各位开发了解并掌握其解决方案</p> 
</blockquote> 
<h4><a id="_5"></a>硬件与操作系统</h4> 
<ul><li>硬件配置升级 
  <ul><li>cpu性能和核心数</li><li>内存</li><li>固态硬盘</li><li>网络</li></ul> </li><li>操作系统 
  <ul><li>windows改linux</li></ul> </li></ul> 
<h4><a id="MySQL_14"></a>MySQL配置</h4> 
<ul><li> <p>增加MySQL服务器可用连接数</p> <pre><code class="prism language-shell">show variables like <span class="token string">'MAX_CONNECTIONS'</span><span class="token punctuation">;</span>  --- 查看连接数，默认151，可以设置成16384<span class="token punctuation">(</span><span class="token number">2</span>^14<span class="token punctuation">)</span>
</code></pre> </li><li> <p>减少客户端可用连接数</p> 
  <ul><li>连接池</li><li>设置批量操作最大传输数据大小 
    <ul><li>调节MySQL的配置文件<code>my.ini</code>中的 <code>max_allowed_socket</code> 参数大小</li></ul> </li><li>设置第三方缓存模块 
    <ul><li>使用redis等第三方中间件</li><li>开启mybatis或hibernate等ORM框架缓存模块</li></ul> </li></ul> </li><li> <p>慢查询等性能分析工具开启</p> 
  <ul><li>慢查询日志<pre><code class="prism language-shell">show variables like <span class="token string">'slow_query%'</span><span class="token punctuation">;</span>   --- 慢日志信息
show variables like <span class="token string">'long_query_time'</span><span class="token punctuation">;</span> --- 当SQL执行超过这个值时才记录到慢日志中,默认10s 
</code></pre> </li><li>mysql专门用来分析慢日志的工具 <code>mysqldumpslow</code> <code>profiles</code><pre><code class="prism language-shell">mysqldumoslow -s t -t <span class="token number">20</span> -g <span class="token string">'select'</span> /var/lib/mysql/localhost-slow.log  --表示前二十个耗时最长的SQL语句查询语句
show profiles<span class="token punctuation">;</span> <span class="token keyword">select</span> @@profiling<span class="token punctuation">;</span>
</code></pre> </li></ul> </li></ul> 
<h4><a id="_38"></a>数据库架构</h4> 
<ul><li>分库分表 
  <ul><li>mycat/sharing jdbc</li></ul> </li><li>集群 
  <ul><li>一主多从</li><li>多主一从</li><li>互为主从</li><li>级联复制</li></ul> </li></ul> 
<h4><a id="_47"></a>存储引擎和表结构</h4> 
<ul><li>存储引擎 
  <ul><li>当插入和查询较多时，选择MyISAM存储引擎，不支持事务</li><li>临时表，选择基于内存的Memory存储引擎</li><li>大多数业务场景下使用默认Innodb存储引擎，支持事务</li></ul> </li><li>表结构 
  <ul><li>字段类型选择</li><li>字段大小选择</li></ul> </li></ul> 
<h4><a id="SQL_55"></a>SQL和索引</h4> 
<ul><li>SQL优化 
  <ul><li>执行计划：EXPLAIN SELECT * FROM USER WHERE id =1; 
    <ul><li>select_type;简单查询、子查询、联合查询</li><li>type:衡量SQL执行效率的一个重要指标 
      <ul><li>system/const/eq_ref 一般业务SQL很难优化到这种起步，忽略</li><li>ref：select * from student where name=‘小明’; //name为索引</li><li>rang：select name from student where id&gt;1; //id字段为索引</li><li>index：select name from student; //name字段为索引</li><li>all：select name from student; //name字段不为索引</li></ul> </li><li>possible_keys：查询过程中可能使用到的索引</li><li>key：查询过程中实际使用到的索引</li><li>Extra：十分重要的额外信息 
      <ul><li>using filesort：select * from student order by name; //name字段不为索引</li><li>using temporary：select distinct name,phone from student;</li><li>using index：select phone from student where name=‘小明’; //name_phone为联合索引</li><li>using where：select * from student where phone=18012345678; //iphone不为索引</li><li>using index condition：索引下推</li></ul> </li></ul> </li><li>索引优化</li></ul> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2b8df1f132a2a6ef0f9b3bdb67ff1da7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL常见的索引及创建方式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/daa8e3cdeb6edd9e98ab174fce622241/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Redis的简介以及安装教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>