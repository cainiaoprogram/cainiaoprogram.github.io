<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>用VBS操作Excel常见方法总结！ - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="用VBS操作Excel常见方法总结！" />
<meta property="og:description" content="本人详解
作者：王文峰，参加过 CSDN 2020年度博客之星，《Java王大师王天师》
公众号：JAVA开发王大师，专注于天道酬勤的 Java 开发问题
中国国学、传统文化和代码爱好者的程序人生，期待你的关注和支持！本人外号：神秘小峯 山峯 转载说明：务必注明来源（注明：作者：王文峰哦）
一键三连 一键三连 一键三连~
系列文章分类
C#专栏、VBS专栏、JAVA 专栏、IDEA 专栏
用VBS操作Excel常见方法总结 前言一、实现代码二、实现代码三、实现代码四、实现VBS操作Excel 总结 前言 vbs详情&gt; VBS是基于Visual Basic的脚本语言。VBS的全称是：Microsoft Visual Basic Script Edition。（微软公司可视化BASIC脚本版）。 其语言类似Visual Basic（VB） 脚本语言的特点为: 简单易学 解释性语言 集成成熟技术 VBScript是 Visual Basic Script 的简称，即 Visual Basic 脚本语言，有时也被缩写为 VBS。 VBScript 是微软开发的一种脚本语言。使用 VBScript，可通过 Windows 脚本宿主调用 COM，所以可以使用 Windows 操作系统中可被使用的程序库。 VBScript 一般被用在以下个方面：VBScript 经常被用来完成重复性的Windows 操作系统任务；用来指挥客户方的网页浏览器。在这一方面，VBS 与JavaScript 是竞争者，因为本文的实验环境基于 Window 平台，为了达到更好的兼容性和性能选用 VBScript。 提示：以下是本篇文章正文内容，下面案例可供参考
一、实现代码 dim oExcel,oWb,oSheet Set oExcel= CreateObject(&#34;Excel.Application&#34;) Set oWb = oExcel." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/db21ce3233cd7c0bfb572aeac090e15c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-03T15:53:51+08:00" />
<meta property="article:modified_time" content="2023-11-03T15:53:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">用VBS操作Excel常见方法总结！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>本人详解<br> 作者：王文峰，参加过 CSDN 2020年度博客之星，《Java王大师王天师》<br> 公众号：JAVA开发王大师，专注于天道酬勤的 Java 开发问题<br>中国国学、传统文化和代码爱好者的程序人生，期待你的关注和支持！本人外号：神秘小峯 山峯 <br> 转载说明：务必注明来源（注明：作者：王文峰哦）</p> 
</blockquote> 
<p><strong><font color="#13d">一键三连 <sub>一键三连</sub> 一键三连~</font></strong><br> <font color="blue">系列文章分类<br> <font color="#999AAA"></font></font></p> 
<p>C#<a href="https://blog.csdn.net/feng_wwf/category_9691568.html">专栏</a>、VBS<a href="https://blog.csdn.net/feng_wwf/category_10368465.html">专栏</a>、JAVA <a href="https://blog.csdn.net/feng_wwf/category_9693364.html">专栏</a>、IDEA <a href="https://blog.csdn.net/feng_wwf/category_10231758.html">专栏</a></p> 
<hr color="#000000" size='1"'> 
<font color="#999AAA"> </font> 
<p></p> 
<div class="toc"> 
 <h4>用VBS操作Excel常见方法总结</h4> 
 <ul><li><a href="#_21" rel="nofollow">前言</a></li><li><ul><li><a href="#_41" rel="nofollow">一、实现代码</a></li><li><ul><li><a href="#_61" rel="nofollow">二、实现代码</a></li><li><ul><li><a href="#_154" rel="nofollow">三、实现代码</a></li><li><ul><li><a href="#VBSExcel_178" rel="nofollow">四、实现VBS操作Excel</a></li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_237" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr color="#000000" size='1"'> 
<h2><a id="_21"></a>前言</h2> 
<p><img src="https://images2.imgbox.com/3a/e7/UQdLFAHi_o.jpg" alt="在这里插入图片描述"></p> 
<font color="#D28EFF"> vbs详情&gt; VBS是基于Visual Basic的脚本语言。VBS的全称是：Microsoft Visual Basic Script Edition。（微软公司可视化BASIC脚本版）。 其语言类似Visual Basic（VB） 脚本语言的特点为: 简单易学 解释性语言 集成成熟技术 VBScript是 Visual Basic Script 的简称，即 Visual Basic 脚本语言，有时也被缩写为 VBS。 VBScript 是微软开发的一种脚本语言。使用 VBScript，可通过 Windows 脚本宿主调用 COM，所以可以使用 Windows 操作系统中可被使用的程序库。 VBScript 一般被用在以下个方面：VBScript 经常被用来完成重复性的Windows 操作系统任务；用来指挥客户方的网页浏览器。在这一方面，VBS 与JavaScript 是竞争者，因为本文的实验环境基于 Window 平台，为了达到更好的兼容性和性能选用 VBScript。 </font> 
<hr color="#000000" size='1"'> 
<p><font color="#999AAA">提示：以下是本篇文章正文内容，下面案例可供参考</font></p> 
<h3><a id="_41"></a>一、实现代码</h3> 
<pre><code class="prism language-csharp"><span class="token class-name">dim</span> oExcel<span class="token punctuation">,</span>oWb<span class="token punctuation">,</span>oSheet 
<span class="token class-name">Set</span> oExcel<span class="token operator">=</span> <span class="token function">CreateObject</span><span class="token punctuation">(</span><span class="token string">"Excel.Application"</span><span class="token punctuation">)</span> 
<span class="token class-name">Set</span> oWb <span class="token operator">=</span> oExcel<span class="token punctuation">.</span>Workbooks<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">"E:\其他\新装电话表.xls"</span><span class="token punctuation">)</span> 
<span class="token class-name">Set</span> oSheet <span class="token operator">=</span> oWb<span class="token punctuation">.</span><span class="token function">Sheets</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">)</span> 
<span class="token return-type class-name">MsgBox</span> oSheet<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token string">"B2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value '#提取单元格B2内容 
'<span class="token range operator">..</span><span class="token range operator">..</span><span class="token punctuation">.</span> 
<span class="token number">3</span>、如果是XP系统，可以使用如下代码 
Dim objFileDlg 
<span class="token class-name">Set</span> objFileDlg <span class="token operator">=</span> <span class="token function">CreateObject</span><span class="token punctuation">(</span><span class="token string">"UserAccounts.CommonDialog"</span><span class="token punctuation">)</span> 
objFileDlg<span class="token punctuation">.</span>Filter <span class="token operator">=</span> <span class="token string">"Excel File (*.xls) |*.xls"</span> 
If objFileDlg<span class="token punctuation">.</span>ShowOpen Then 
msgbox <span class="token string">"您选择的文件是："</span> <span class="token operator">&amp;</span> objFileDlg<span class="token punctuation">.</span>FileName <span class="token operator">&amp;</span> vbCrLf 
End If 
</code></pre> 
<h4><a id="_61"></a>二、实现代码</h4> 
<pre><code class="prism language-csharp"><span class="token punctuation">(</span>一<span class="token punctuation">)</span> 使用动态创建的方法 
首先创建 Excel 对象，使用ComObj<span class="token punctuation">:</span> 
oExcel <span class="token operator">=</span> <span class="token function">CreateObject</span><span class="token punctuation">(</span> <span class="token string">"Excel.Application"</span> <span class="token punctuation">)</span> 
<span class="token number">1</span><span class="token punctuation">)</span> 显示当前窗口： 
oExcel<span class="token punctuation">.</span>Visible <span class="token operator">=</span> True 
<span class="token number">2</span><span class="token punctuation">)</span> 更改 Excel 标题栏： 
oExcel<span class="token punctuation">.</span>Caption <span class="token operator">=</span> <span class="token string">"应用程序调用 Microsoft Excel"</span> 
<span class="token number">3</span><span class="token punctuation">)</span> 添加新工作簿： 
oExcel<span class="token punctuation">.</span>WorkBooks<span class="token punctuation">.</span>Add 
<span class="token number">4</span><span class="token punctuation">)</span> 打开已存在的工作簿： 
oExcel<span class="token punctuation">.</span>WorkBooks<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span> <span class="token string">"C:\Excel\Demo.xls"</span> <span class="token punctuation">)</span> 
<span class="token number">5</span><span class="token punctuation">)</span> 设置第<span class="token number">2</span>个工作表为活动工作表： 
oExcel<span class="token punctuation">.</span><span class="token function">WorkSheets</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Activate 
或 
oExcel<span class="token punctuation">.</span><span class="token function">WorksSheets</span><span class="token punctuation">(</span> <span class="token string">"Sheet2"</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>Activate 
<span class="token number">6</span><span class="token punctuation">)</span> 给单元格赋值： 
oExcel<span class="token punctuation">.</span><span class="token function">Cells</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"第一行第四列"</span> 
<span class="token number">7</span><span class="token punctuation">)</span> 设置指定列的宽度（单位：字符个数），以第一列为例： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ColumnsWidth <span class="token operator">=</span> <span class="token number">5</span> 
<span class="token number">8</span><span class="token punctuation">)</span> 设置指定行的高度（单位：磅）（<span class="token number">1</span>磅＝<span class="token number">0.035</span>厘米），以第二行为例： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>RowHeight <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">0.035</span> ' <span class="token number">1</span>厘米 
<span class="token number">9</span><span class="token punctuation">)</span> 在第<span class="token number">8</span>行之前插入分页符： 
oExcel<span class="token punctuation">.</span><span class="token function">WorkSheets</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span>PageBreak <span class="token operator">=</span> <span class="token number">1</span> 
<span class="token number">10</span><span class="token punctuation">)</span> 在第<span class="token number">8</span>列之前删除分页符： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>PageBreak <span class="token operator">=</span> <span class="token number">0</span> 
<span class="token number">11</span><span class="token punctuation">)</span> 指定边框线宽度： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span> <span class="token string">"B3:D4"</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Borders</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Weight <span class="token operator">=</span> <span class="token number">3</span> 
<span class="token number">1</span><span class="token operator">-</span>左 <span class="token number">2</span><span class="token operator">-</span>右 <span class="token number">3</span><span class="token operator">-</span>顶 <span class="token number">4</span><span class="token operator">-</span>底 <span class="token number">5</span><span class="token operator">-</span>斜<span class="token punctuation">(</span> \ <span class="token punctuation">)</span> <span class="token number">6</span><span class="token operator">-</span>斜<span class="token punctuation">(</span> <span class="token operator">/</span> <span class="token punctuation">)</span> 
<span class="token number">12</span><span class="token punctuation">)</span> 清除第一行第四列单元格公式： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Cells</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ClearContents 
<span class="token number">13</span><span class="token punctuation">)</span> 设置第一行字体属性： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">"隶书"</span> 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Color <span class="token operator">=</span> <span class="token return-type class-name">clBlue</span> 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Bold <span class="token operator">=</span> <span class="token return-type class-name">True</span> 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Font<span class="token punctuation">.</span>UnderLine <span class="token operator">=</span> True 
<span class="token number">14</span><span class="token punctuation">)</span> 进行页面设置： 
a<span class="token punctuation">.</span>页眉： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PageSetup<span class="token punctuation">.</span>CenterHeader <span class="token operator">=</span> <span class="token string">"报表演示"</span> 
b<span class="token punctuation">.</span>页脚： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PageSetup<span class="token punctuation">.</span>CenterFooter <span class="token operator">=</span> <span class="token string">"第&amp;P页"</span> 
c<span class="token punctuation">.</span>页眉到顶端边距2cm： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PageSetup<span class="token punctuation">.</span>HeaderMargin <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">0.035</span> 
d<span class="token punctuation">.</span>页脚到底端边距3cm： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PageSetup<span class="token punctuation">.</span>HeaderMargin <span class="token operator">=</span> <span class="token number">3</span><span class="token operator">/</span><span class="token number">0.035</span> 
e<span class="token punctuation">.</span>顶边距2cm： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PageSetup<span class="token punctuation">.</span>TopMargin <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">0.035</span> 
f<span class="token punctuation">.</span>底边距2cm： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PageSetup<span class="token punctuation">.</span>BottomMargin <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">0.035</span> 
g<span class="token punctuation">.</span>左边距2cm： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PageSetup<span class="token punctuation">.</span>LeftMargin <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">0.035</span> 
h<span class="token punctuation">.</span>右边距2cm： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PageSetup<span class="token punctuation">.</span>RightMargin <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">0.035</span> 
i<span class="token punctuation">.</span>页面水平居中： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PageSetup<span class="token punctuation">.</span>CenterHorizontally <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">0.035</span> 
j<span class="token punctuation">.</span>页面垂直居中： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PageSetup<span class="token punctuation">.</span>CenterVertically <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">0.035</span> 
k<span class="token punctuation">.</span>打印单元格网线： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PageSetup<span class="token punctuation">.</span>PrintGridLines <span class="token operator">=</span> True 
<span class="token number">15</span><span class="token punctuation">)</span> 拷贝操作： 
a<span class="token punctuation">.</span>拷贝整个工作表： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>Used<span class="token punctuation">.</span>Range<span class="token punctuation">.</span>Copy 
b<span class="token punctuation">.</span>拷贝指定区域： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span> <span class="token string">"A1:E2"</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>Copy 
c<span class="token punctuation">.</span>从A1位置开始粘贴： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>Range<span class="token punctuation">.</span><span class="token punctuation">(</span> <span class="token string">"A1"</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>PasteSpecial 
d<span class="token punctuation">.</span>从文件尾部开始粘贴： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>Range<span class="token punctuation">.</span>PasteSpecial 
<span class="token number">16</span><span class="token punctuation">)</span> 插入一行或一列： 
a<span class="token punctuation">.</span> oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token return-type class-name">Insert</span> 
b<span class="token punctuation">.</span> oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Insert 
<span class="token number">17</span><span class="token punctuation">)</span> 删除一行或一列： 
a<span class="token punctuation">.</span> oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token return-type class-name">Delete</span> 
b<span class="token punctuation">.</span> oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Delete 
<span class="token number">18</span><span class="token punctuation">)</span> 打印预览工作表： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PrintPreview 
<span class="token number">19</span><span class="token punctuation">)</span> 打印输出工作表： 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PrintOut 
<span class="token number">20</span><span class="token punctuation">)</span> 工作表保存： 
<span class="token keyword">if</span> <span class="token keyword">not</span> oExcel<span class="token punctuation">.</span>ActiveWorkBook<span class="token punctuation">.</span>Saved then 
oExcel<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>PrintPreview 
<span class="token number">21</span><span class="token punctuation">)</span> 工作表另存为： 
oExcel<span class="token punctuation">.</span><span class="token function">SaveAs</span><span class="token punctuation">(</span> <span class="token string">"C:\Excel\Demo1.xls"</span> <span class="token punctuation">)</span> 
<span class="token number">22</span><span class="token punctuation">)</span> 放弃存盘： 
oExcel<span class="token punctuation">.</span>ActiveWorkBook<span class="token punctuation">.</span>Saved <span class="token operator">=</span> True 
<span class="token number">23</span><span class="token punctuation">)</span> 关闭工作簿： 
oExcel<span class="token punctuation">.</span>WorkBooks<span class="token punctuation">.</span>Close 
<span class="token number">24</span><span class="token punctuation">)</span> 退出 Excel： 
oExcel<span class="token punctuation">.</span>Quit 
</code></pre> 
<h5><a id="_154"></a>三、实现代码</h5> 
<p>用vbs把excel的单元格数据写到txt</p> 
<pre><code class="prism language-csharp"> 
If WScript<span class="token punctuation">.</span>Arguments<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token class-name">Then</span> Filename <span class="token operator">=</span> WScript<span class="token punctuation">.</span><span class="token function">Arguments</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> 
<span class="token class-name">Set</span> a <span class="token operator">=</span> <span class="token function">CreateObject</span><span class="token punctuation">(</span><span class="token string">"Excel.Application"</span><span class="token punctuation">)</span> 
<span class="token class-name">If</span> Filename <span class="token operator">=</span> <span class="token string">""</span> <span class="token class-name">Then</span> 
Filename <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">GetOpenFilename</span><span class="token punctuation">(</span><span class="token string">"Excel Files (*.xls), *.xls"</span><span class="token punctuation">)</span> 
<span class="token return-type class-name">If</span> <span class="token function">VarType</span><span class="token punctuation">(</span>Filename<span class="token punctuation">)</span> <span class="token operator">=</span> vbBoolean Then 
MsgBox <span class="token string">"Excel2Txt用于将Excel文件的每个Sheet保存为一个文本文件。"</span> <span class="token operator">&amp;</span> vbCr <span class="token operator">&amp;</span> vbLf <span class="token operator">&amp;</span> vbCr <span class="token operator">&amp;</span> vbLf <span class="token operator">&amp;</span> <span class="token string">"用法: Excel2Txt filename.xls 或在对话框中打开Excel文件。"</span> 
WScript<span class="token punctuation">.</span>Quit 
End If 
End If 
<span class="token class-name">Set</span> w <span class="token operator">=</span> a<span class="token punctuation">.</span>Workbooks<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>Filename<span class="token punctuation">)</span> 
n <span class="token operator">=</span> <span class="token function">Replace</span><span class="token punctuation">(</span><span class="token function">Replace</span><span class="token punctuation">(</span>w<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token string">".xls"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">".XLS"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> 
a<span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> False 
For Each s In w<span class="token punctuation">.</span>Sheets 
s<span class="token punctuation">.</span>SaveAs w<span class="token punctuation">.</span>Path <span class="token operator">&amp;</span> <span class="token string">"\" &amp; n &amp; "</span>_<span class="token string">" &amp; s.Name &amp; "</span><span class="token punctuation">.</span>txt"<span class="token punctuation">,</span> <span class="token number">20</span> 
Next 
a<span class="token punctuation">.</span>Quit 

</code></pre> 
<p>改后缀vbs,双击执行就行了 。</p> 
<h6><a id="VBSExcel_178"></a>四、实现VBS操作Excel</h6> 
<pre><code class="prism language-csharp"> 
<span class="token class-name">Set</span> objExcel <span class="token operator">=</span> <span class="token function">CreateObject</span><span class="token punctuation">(</span><span class="token string">"Excel.Application"</span><span class="token punctuation">)</span> '建一个exel对象 
<span class="token class-name">Set</span> objWorkbook <span class="token operator">=</span> <span class="token return-type class-name">objExcel<span class="token punctuation">.</span>Workbooks<span class="token punctuation">.</span>Open</span> _ 
<span class="token punctuation">(</span><span class="token string">"E:\DOC\Hewl\领域模型.xls"</span><span class="token punctuation">)</span> '打开文件 
strToBeWrited <span class="token operator">=</span> <span class="token string">"-----------------------------------"</span> <span class="token operator">&amp;</span> vbcrlf <span class="token operator">&amp;</span> _ 
<span class="token string">"-- Generated by ScriptGenerator ---"</span> <span class="token operator">&amp;</span> vbcrlf <span class="token operator">&amp;</span> _ 
<span class="token string">"-----------------------------------"</span> <span class="token operator">&amp;</span> vbcrlf <span class="token operator">&amp;</span> <span class="token class-name">vbcrlf</span> 
Count <span class="token operator">=</span> objWorkbook<span class="token punctuation">.</span>WorkSheets<span class="token punctuation">.</span>Count '取sheet数量 
<span class="token class-name">Set</span> my <span class="token operator">=</span> <span class="token function">CreateObject</span><span class="token punctuation">(</span><span class="token string">"Excel.Sheet"</span><span class="token punctuation">)</span> '新建sheet对象 
For Each my In objWorkbook<span class="token punctuation">.</span>WorkSheets '遍历sheet 
If my<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">"目录"</span> <span class="token keyword">or</span> my<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">"SecondHandHouse"</span> Then 
'<span class="token keyword">do</span> nothing 
Else 
'Wscript<span class="token punctuation">.</span>Echo my<span class="token punctuation">.</span>Name '获得sheet名字 
'Wscript<span class="token punctuation">.</span>Echo my<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count 
'strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> <span class="token string">"create table "</span> <span class="token operator">&amp;</span> my<span class="token punctuation">.</span>Name <span class="token operator">&amp;</span> <span class="token class-name">vbcrlf</span> 
strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> <span class="token string">"/*==============================================================*/"</span> <span class="token operator">&amp;</span> <span class="token class-name">vbcrlf</span> 
strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> <span class="token string">"/* Table: "</span> <span class="token operator">&amp;</span> my<span class="token punctuation">.</span>Name <span class="token operator">&amp;</span> <span class="token string">" */"</span> <span class="token operator">&amp;</span> <span class="token class-name">vbcrlf</span> 
strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> <span class="token string">"/*==============================================================*/"</span> <span class="token operator">&amp;</span> <span class="token class-name">vbcrlf</span> 
strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> <span class="token string">"create table "</span> <span class="token operator">&amp;</span> my<span class="token punctuation">.</span>Name <span class="token operator">&amp;</span> <span class="token string">" ("</span> <span class="token operator">&amp;</span> <span class="token class-name">vbcrlf</span> 
rowNum <span class="token operator">=</span> <span class="token number">3</span> 
Do <span class="token return-type class-name">Until</span> my<span class="token punctuation">.</span><span class="token function">Cells</span><span class="token punctuation">(</span>rowNum<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">""</span> 
'Wscript<span class="token punctuation">.</span>Echo <span class="token string">"sAMAccountName: "</span> <span class="token operator">&amp;</span> my<span class="token punctuation">.</span><span class="token function">Cells</span><span class="token punctuation">(</span>rowNum<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token class-name">Value</span> 
strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> <span class="token string">" "</span> <span class="token operator">&amp;</span> my<span class="token punctuation">.</span><span class="token function">Cells</span><span class="token punctuation">(</span>rowNum<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&amp;</span> <span class="token string">" "</span> <span class="token operator">&amp;</span> my<span class="token punctuation">.</span><span class="token function">Cells</span><span class="token punctuation">(</span>rowNum<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&amp;</span> <span class="token string">" not null"</span> 
If <span class="token keyword">not</span> my<span class="token punctuation">.</span><span class="token function">Cells</span><span class="token punctuation">(</span>rowNum<span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">""</span> <span class="token class-name">Then</span> 
strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> <span class="token string">" default "</span> <span class="token operator">&amp;</span> my<span class="token punctuation">.</span><span class="token function">Cells</span><span class="token punctuation">(</span>rowNum<span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value 
End <span class="token class-name">If</span> 
strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> <span class="token string">","</span> <span class="token operator">&amp;</span> <span class="token class-name">vbcrlf</span> 
rowNum <span class="token operator">=</span> rowNum <span class="token operator">+</span> <span class="token number">1</span> 
<span class="token class-name">Loop</span> 
strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> <span class="token string">" constraint PK_"</span> <span class="token operator">&amp;</span> my<span class="token punctuation">.</span>Name <span class="token operator">&amp;</span> <span class="token string">" primary key (id)"</span> <span class="token operator">&amp;</span> <span class="token class-name">vbcrlf</span> 
strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> <span class="token string">")"</span> <span class="token operator">&amp;</span> vbcrlf 
End <span class="token class-name">If</span> 
strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> vbcrlf 
Next 
For Each my In objWorkbook<span class="token punctuation">.</span>WorkSheets '遍历sheet 
If my<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">"目录"</span> <span class="token keyword">or</span> my<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">"SecondHandHouse"</span> Then 
'<span class="token keyword">do</span> nothing 
<span class="token class-name">Else</span> 

strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> <span class="token string">" constraint PK_"</span> <span class="token operator">&amp;</span> my<span class="token punctuation">.</span>Name <span class="token operator">&amp;</span> <span class="token string">" primary key (id)"</span> <span class="token operator">&amp;</span> <span class="token class-name">vbcrlf</span> 
strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> <span class="token string">")"</span> <span class="token operator">&amp;</span> vbcrlf 
End <span class="token class-name">If</span> 
strToBeWrited <span class="token operator">=</span> strToBeWrited <span class="token operator">&amp;</span> vbcrlf 
Next 
'写文件 
<span class="token keyword">set</span> fs <span class="token operator">=</span><span class="token function">createobject</span><span class="token punctuation">(</span><span class="token string">"scripting.filesystemobject"</span><span class="token punctuation">)</span> 
<span class="token keyword">set</span> f <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">opentextfile</span><span class="token punctuation">(</span><span class="token string">"E:\DOC\Hewl\dbscript.sql"</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> 
'Wscript<span class="token punctuation">.</span>Echo strToBeWrited 
f<span class="token punctuation">.</span>write strToBeWrited 
f<span class="token punctuation">.</span>close 
<span class="token class-name">Set</span> f <span class="token operator">=</span> nothing 
<span class="token class-name">Set</span> fs <span class="token operator">=</span> nothing 
objExcel<span class="token punctuation">.</span>Quit '结束退出 

</code></pre> 
<h2><a id="_237"></a>总结</h2> 
<p><font color="#999AAA">方法是：在EXCEL中录制宏，然后在EXCEL的VBA编辑器中修改语句，调试运行无误后再粘贴到VBS语句中，进行适当的修改。</font></p> 
<blockquote> 
 <p>本人详解<br> 作者：王文峰，参加过 CSDN 2020年度博客之星，《Java王大师王天师》<br> 公众号：JAVA开发王大师，专注于天道酬勤的 Java 开发问题<br>中国国学、传统文化和代码爱好者的程序人生，期待你的关注和支持！本人外号：神秘小峯 山峯 <br> 转载说明：务必注明来源（注明：作者：王文峰哦）</p> 
</blockquote> 
<p><strong><font color="#13d">一键三连 <sub>一键三连</sub> 一键三连~</font></strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f1ea38ef01bcc9df36b9bcf3e8a66bdb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">多种代码生成炫酷代码雨（推荐）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8859ff3eb3cc7512a111ae7ae81b2288/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">简述“优化求解器”的相关概念和国内外软件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>