<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Deployment Procces by Rowan Simpson - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Deployment Procces by Rowan Simpson" />
<meta property="og:description" content="This is Part II in a two-part series. Part I covers the Trade Me application architecture.
Tim’s second lot of questions are about our dev tools and process:
Q: Any third party tools in the software or the dev/management process?
Q: What source control software do you use, and how do you use it?
Q: How do you manage roll outs? Dev/Staging/Live?
Q: Do you use pair programming, or adopt any other methodologies from the agile world?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f6053a59d72464472a2bcc5948c625af/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-04-22T00:53:54+08:00" />
<meta property="article:modified_time" content="2013-04-22T00:53:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Deployment Procces by Rowan Simpson</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> <strong>This is Part II in a two-part series. <a href="http://rowansimpson.com/2007/03/07/questions-from-tim-haines-part-i/" rel="nofollow" style="text-decoration:none; color:rgb(18,67,126)">Part I</a> covers the Trade Me application architecture.</strong></p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> Tim’s second lot of questions are about our dev tools and process:</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> <em>Q: Any third party tools in the software or the dev/management process?</em></p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> <em>Q: What source control software do you use, and how do you use it?</em></p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> <em>Q: How do you manage roll outs? Dev/Staging/Live?</em></p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> <em>Q: Do you use pair programming, or adopt any other methodologies from the agile world?</em></p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> The answers to these questions are just a snapshot, capturing how we do things today (early in April, 2007).</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> I go far enough back to remember when our “development environment” was Jessi’s PC (Jessi at that stage was our entire Customer Service department!) Back then there was no source control as such, we all shared a single set of source files. To deploy a change we would simply copy the relevant ASP files directly onto the live web server and then quickly make the associated database changes.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> Somehow it worked!</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> Ever since then we’ve been constantly tweaking the tools and processes we use, to accommodate a growing team and a growing site. As our application and environment has evolved and become more complex our tools and process have had to change also.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> This change will continue, I’m sure. So, it will be interesting to come back to this post in another 8 years and see if the things I describe below sound as ridiculous then as the things I described above do now.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> Also, the standard disclaimer applies to these ideas: what makes sense for us, in our environment and with our site, may not make sense to you in yours. So, please apply your common sense.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> <strong>Tools</strong></p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> Our developers use Visual Studio as their IDE and Visual SourceSafe for source control.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> All of our .NET application code and all of our stored procedures are kept in a SourceSafe project. Developers tend to work in Visual Studio and use the integration with SourceSafe to check files in and out etc.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> Thus far we’ve used an exclusive lock approach to source control. So, a developer will check out the file they need to make changes to and hold a lock over that file until the changes are deployed.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> However, as the team gets bigger this approach has started to run into problems – for example, where multiple developers are working on changes together, or where larger changes need to be made causing key files to be blocked for longer periods.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> To get around these issues, we’re increasingly working on local copies of files and only checking those files out and merging in their changes later. I imagine we will shortly switch to an <a href="http://www.ericsink.com/scm/scm_checkins.html" rel="nofollow" style="text-decoration:none; color:rgb(18,67,126)">edit-merge-commit approach</a>, and that will require us to look again at alternative source control tools (e.g. SourceGear’s <a href="http://www.sourcegear.com/vault/" rel="nofollow" style="text-decoration:none; color:rgb(18,67,126)">Vault</a>, Microsoft’s <a href="http://msdn2.microsoft.com/en-us/teamsystem/default.aspx" rel="nofollow" style="text-decoration:none; color:rgb(18,67,126)">Visual Studio Team System</a> or perhaps <a href="http://subversion.tigris.org/" rel="nofollow" style="text-decoration:none; color:rgb(18,67,126)">Subversion</a> – we’d be interested to hear from anybody who’s had experience with any of these).</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> <strong>Release Manager</strong></p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> At the centre of our dev + test process is a tool we’ve built ourselves called the ‘Release Manager’.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> This incorporates a simple task management tool, where tasks can be described and assigned to individual developers and testers. It also hooks into source control, and allows a developer to associate source code changes with the task they are working on.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> This group of files, which we call a ‘package’, may include ASPX files, VB class files as well as scripts to create or replace stored procedures in the database.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> The tool also incorporates reports which help us track tasks as they progress through the dev + test process. These are built using SQL Reporting Services.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> <strong>Environments</strong></p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> We have four environments:</p> 
<ol style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"><li>Dev: this includes a shared database instance and local web servers for each developer.</li><li>Test: this includes a production-like database (actually databases, as we now have multiple instances in production) and a separate web server.</li><li>Stage: our pre-production environment, again with it’s own web server</li><li>Production: our live site, which actually incorporates two environments currently, one in Wellington and one in Auckland.</li></ol> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> Developers typically work on changes individually. We have a code-review process, so any code changes have two sets of eyes over them before they hit test.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> Once a code change is completed, the developer will create the package in Release Manager and set the task to be ‘ready to test’ so it appears on the radar of the test team.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> We have a web-based deployment tool which testers can use to deploy one or more packages into the test environment. This involves some <a href="http://nant.sourceforge.net/" rel="nofollow" style="text-decoration:none; color:rgb(18,67,126)">Nant</a> build scripts which get the source files for the selected packages, copy these into the test environment and then build the .NET assemblies on the test server. The build script also executes any associated database changes that are included, and then updates the status of the package/s to ‘in test’.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> The deploy tool is able to use the data from Release Manager to identify any dependencies between packages. Where dependencies exist we’re forced to deploy packages in a certain order, but in the general case we’re able to deploy packages independently of each other, which provides a great degree of flexibility and allows us to respond quickly where required (e.g. when there is an urgent bug fix required).</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> <strong>Production</strong></p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> Once a package has been tested the test team use the same deploy tool to move the package into the stage environment ready for go-live.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> From there the responsibility switches to the platform team, who manage our production web servers. They have automated scripts, again built using <a href="http://nant.sourceforge.net/" rel="nofollow" style="text-decoration:none; color:rgb(18,67,126)">Nant</a>, which deploy from stage to our production environment/s. These scripts update configuration files then copy the required production files to the various web server locations. It also manages the execution of database scripts. The idea is to get everything as close to the brink as possible (which is the time consuming part of the deploy process) and then tip everything over the edge as quickly as possible, so as to minimise disruption to the site.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> Typically we do two production releases each day, although this number varies (up and down) depending on the specific packages. In most cases these releases are done without taking the site offline.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> <strong>The bigger picture</strong></p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> Our dev + test process is just one part of a much bigger product management process, which is roughly represented by the diagram below (click for a larger view):</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> <a href="http://rowan.files.wordpress.com/2007/04/development-process.jpg" rel="nofollow" title="Product Management Process" style="text-decoration:none; color:rgb(18,67,126)"><img src="https://images2.imgbox.com/b4/ac/4zIe0k5j_o.jpg" alt="Product Management Process" width="480" style="border:none; margin-bottom:0.5em"></a></p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> The other parts of this process are probably fodder for a separate post, but it’s important to note that there is a loop involved here.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> Most of the changes we make to the site are influenced heavily by previous changes. In many cases very recent changes. This only works like it does because our process allows us to iterate around this loop quickly and often.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> While we don’t follow any formal agile methodology, our process is definitely lightweight. We don’t produce lots of documentation, which is not to say that we don’t design changes up-front, just that we don’t spend too much time translating that thinking into large documents (it’s not uncommon for screen designs to be whiteboard printouts for example).</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> While we do make larger changes from time to time (for example, the <a href="http://rowansimpson.com/2007/04/08/dvds-on-trade-me/" rel="nofollow" style="text-decoration:none; color:rgb(18,67,126)">DVD release which went out last week</a>) the vast majority of changes we make are small and seemingly insignificant. Again, this only works because each of these small changes is able to flow through with minimal friction added by the tools and processes.</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> I’d also hate to give you the impression that this process is perfect. There is massive room for improvement. The challenge for us is to continue to look for these opportunities.<br> <strong><br> More?</strong></p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> That’s it for Tim’s questions. I hope some of that was useful?</p> 
<p style="color:rgb(51,51,51); font-family:facitweb-1,facitweb-2,Georgia,serif; font-size:14px; line-height:26px"> If you have any other questions, ask away. You can either place a comment below or contact me directly. My email address is in the sidebar to the right.</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/89dc68df76625a1fa8f35779b62d8301/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">最长单调子序列（DP）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/95d6e82cd154c9214047a8e0dda2b1f6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Flex, version 2.5</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>