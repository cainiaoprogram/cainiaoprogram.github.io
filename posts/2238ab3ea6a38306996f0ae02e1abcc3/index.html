<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux 下使用 C&#43;&#43; 实现的 Web 文件服务器 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux 下使用 C&#43;&#43; 实现的 Web 文件服务器" />
<meta property="og:description" content=" 项目地址：
Github：https://github.com/shangguanyongshi/WebFileServer
在学习完成《TCP/IP 网络编程》和《Linux高性能服务器编程》后，阅读了一些Web服务器的相关代码，自动动手使用 C&#43;&#43;11 实现了这个 Linux 下简单 Web 文件服务器，通过浏览器发送 HTTP 请求管理服务器指定文件夹下的所有文件。主要功能包括：
以 HTML 页面形式返回该文件夹下的所有文件可以选择本地文件上传到服务器可以对列表中的文件文件执行下载操作可以删除服务器中的指定文件 HTML 的文件列表页面如下所示：
整体框架 使用 Reactor 事件处理模型，通过统一事件源，主线程使用 epoll 监听所有的事件，工作线程负责执行事件的逻辑处理预先创建线程池，当有事件发生时，加入线程池的工作队列中，使用随机选择算法选择线程池中的一个线程处理工作队列的事件使用 HTTP GET 方法获取文件列表，发起下载文件、删除文件的请求。使用 POST 方法向服务器上传文件服务端使用有限状态机对请求消息进行解析，根据解析结果执行操作后，向客户端发送页面、发送文件或发送重定向报文服务端使用 sendfile 函数实现零拷贝数据发送 功能展示 获取文件列表 上传文件 下载文件 删除文件 运行 build 项目sh ./build.sh 启动文件服务器./main 在浏览器端输入 服务端ip:端口号（端口号默认是8888）serverip:8888 拓展 由于时间匆忙，该项目仅仅完成了最基础的功能，但是该项目还有很多可以继续拓展的功能，这里简单列出，以后会继续完善：
现有程序中，运行日志直接输入到控制台，另设进程池实现日志服务（实现远程日志服务器）
增加用户注册登陆功能，根据登陆账户提供各自的文件服务
添加定时器定时处理非活动的连接
参考资料 《TCP/IP 网络编程》：https://book.douban.com/subject/25911735/《Linux高性能服务器编程》：https://book.douban.com/subject/24722611/TinyWebServer：https://github.com/qinguoyi/TinyWebServer " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2238ab3ea6a38306996f0ae02e1abcc3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-27T08:45:27+08:00" />
<meta property="article:modified_time" content="2022-09-27T08:45:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux 下使用 C&#43;&#43; 实现的 Web 文件服务器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>项目地址：</p> 
 <p>Github：<a href="https://github.com/shangguanyongshi/WebFileServer">https://github.com/shangguanyongshi/WebFileServer</a></p> 
</blockquote> 
<p>在学习完成《TCP/IP 网络编程》和《Linux高性能服务器编程》后，阅读了一些Web服务器的相关代码，自动动手使用 C++11 实现了这个 Linux 下简单 <strong>Web 文件服务器</strong>，通过浏览器发送 HTTP 请求管理服务器指定文件夹下的所有文件。主要功能包括：</p> 
<ul><li>以 HTML 页面形式返回该文件夹下的所有文件</li><li>可以选择本地文件上传到服务器</li><li>可以对列表中的文件文件执行下载操作</li><li>可以删除服务器中的指定文件</li></ul> 
<p>HTML 的文件列表页面如下所示：</p> 
<p><img src="https://images2.imgbox.com/d2/6a/DSmitG5f_o.png" alt="请添加图片描述"></p> 
<h2><a id="_16"></a>整体框架</h2> 
<ul><li>使用 <strong>Reactor 事件处理模型</strong>，通过统一事件源，主线程使用 epoll 监听所有的事件，工作线程负责执行事件的逻辑处理</li><li>预先创建<strong>线程池</strong>，当有事件发生时，加入线程池的工作队列中，使用<strong>随机选择</strong>算法选择线程池中的一个线程处理工作队列的事件</li><li>使用 HTTP <strong>GET</strong> 方法获取文件列表，发起下载文件、删除文件的请求。使用 <strong>POST</strong> 方法向服务器上传文件</li><li>服务端使用<strong>有限状态机</strong>对请求消息进行解析，根据解析结果执行操作后，向客户端发送页面、发送文件或发送重定向报文</li><li>服务端使用 <code>sendfile</code> 函数实现<strong>零拷贝</strong>数据发送</li></ul> 
<p><img src="https://images2.imgbox.com/bd/ce/WY7FKg7G_o.png" alt="请添加图片描述"></p> 
<h2><a id="_27"></a>功能展示</h2> 
<h3><a id="_29"></a>获取文件列表</h3> 
<p><img src="https://images2.imgbox.com/e4/54/N30UGsWV_o.gif" alt="请添加图片描述"></p> 
<h3><a id="_32"></a>上传文件</h3> 
<p><img src="https://images2.imgbox.com/34/d3/uN8r5Q8J_o.gif" alt="请添加图片描述"></p> 
<h3><a id="_36"></a>下载文件</h3> 
<p><img src="https://images2.imgbox.com/75/41/rmzLEzPv_o.gif" alt="请添加图片描述"></p> 
<h3><a id="_43"></a>删除文件</h3> 
<p><img src="https://images2.imgbox.com/d5/68/EJGZmAjZ_o.gif" alt="请添加图片描述"></p> 
<h2><a id="_49"></a>运行</h2> 
<ol><li>build 项目<pre><code>sh ./build.sh
</code></pre> </li><li>启动文件服务器<pre><code>./main
</code></pre> </li><li>在浏览器端输入 <code>服务端ip:端口号</code>（端口号默认是8888）<pre><code>serverip:8888
</code></pre> </li></ol> 
<h2><a id="_63"></a>拓展</h2> 
<p>由于时间匆忙，该项目仅仅完成了最基础的功能，但是该项目还有很多可以继续拓展的功能，这里简单列出，以后会继续完善：</p> 
<ul><li class="task-list-item"> <p><input type="checkbox" class="task-list-item-checkbox" disabled> 现有程序中，运行日志直接输入到控制台，另设进程池实现日志服务（实现远程日志服务器）</p> </li><li class="task-list-item"> <p><input type="checkbox" class="task-list-item-checkbox" disabled> 增加用户注册登陆功能，根据登陆账户提供各自的文件服务</p> </li><li class="task-list-item"> <p><input type="checkbox" class="task-list-item-checkbox" disabled> 添加定时器定时处理非活动的连接</p> </li></ul> 
<h2><a id="_73"></a>参考资料</h2> 
<ul><li>《TCP/IP 网络编程》：<a href="https://book.douban.com/subject/25911735/" rel="nofollow">https://book.douban.com/subject/25911735/</a></li><li>《Linux高性能服务器编程》：<a href="https://book.douban.com/subject/24722611/" rel="nofollow">https://book.douban.com/subject/24722611/</a></li><li>TinyWebServer：<a href="https://github.com/qinguoyi/TinyWebServer">https://github.com/qinguoyi/TinyWebServer</a></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8a41acfa7272a21705d3b727408d1f0a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">广州大学学生实验报告，进程控制与进程通信</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9f073d6cab6f028f16d5478af47b7cab/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">dynamic_cast使用以及原理探究</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>