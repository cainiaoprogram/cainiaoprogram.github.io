<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机床数控改造控制系统设计(微型计算机),简易数控车床的微机控制系统软件 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机床数控改造控制系统设计(微型计算机),简易数控车床的微机控制系统软件" />
<meta property="og:description" content="作者简介：汪英(1972—)，女，湖南岳阳人，副教授，研究方向：电子技术、物联网应用技术(E-mail：)；殷文珊(1975—)，女，湖南岳阳人，讲师，硕士，研究方向：计算机通信。
摘要：在用高新技术改造传统机械加工产业中，除了发展高精度、多功能的数控机床外，研发价格低廉、操作方便的简易数控机床也是适合我国国情的一种有效途径。本文采用AT89C52单片机和步进电机设计一种面向现有普通车床进行数控技术改造的微机控制系统，该系统能自动控制完成圆弧类二次曲线形零件的车削等多种功能。其软件设计采用模块化结构，编程简单灵活，扩充性、移植性好，对同类微机数控系统的设计具有一定参考价值。
关键词：简易数控车床；微机控制；软件；AT89C52；步进电机
中图分类号：TP368 文献标识码：A
1引言
数控机床因其智能化、高精度、高速度和高柔性化为制造业带来巨大变化，进入21世纪，我国在制造业方面投入了大量的技术改造资金，数控设备制造迎来了一个快速发展的阶段[1]。但是由于我国制造业起步比较晚，高性能的数控设备引进成本较高，面对众多中小机械加工类企业的普通机床技术改造的需求，采用单片机作为普通机床的数控中心，是较为适合我国国情，改造老式落后加工设备见效快，经济性能好，易于推广的一种有效措施[2]。本文研制了一种普通车床微机控制装置，该装置用于C618车床技术改造，能驱动车床完成手柄类零件车削加工，经现场运行，性能良好。本文主要讨论在这类装置上的系统软件，既是对已成功的软件的总结，也是对如何进一步提高其性能作些探讨。
2系统简介
本微机数控装置适用于改造C618、C616、CW6163等最大加工直径在400毫米以下的普通车床。它通过对刀架在纵横两个方向的运动距离、速度和方向的控制来实现车削内圆、外圆、断面、锥面、切槽、倒角以及圆弧或曲线零件等加工任务。其硬件结构框图如图1所示[3]。
本装置采用AT89C52单片机[4，5]作为控制中心，利用单片机上可编程的计数/定时器C/T0作为定时信号发生器，以中断方式启动CPU向外输出脉冲；利用单片机的P1口作为步进电机驱动信号输出口。在加工过程中，CPU按照用户编制的加工程序从P1口发出相应的一系列脉冲信号，经光电隔离、放大后驱动两台步进电机[6，7]，以控制刀架在纵横两个运动的方向、长度和速度，从而与机床主轴配合完成各种车削动作。
3控制系统软件设计
3.1主要程序流程图
由以上分析可知，控制程序的主要功能为：
1)按用户加工程序安排C/T0控制字，以产生相应的定时信号；
2)把加工程序中的位移毫米数转换成相应步进电机的步数；
3)安排步进电机的转向；
4)显示有关参数(如：当前工序的道数，加工性质字，位移的余量等)；
5)当C/T0中断信号产生时，驱动电机前进一步。
系统加电复位后，首先完成初始化，同时建立工件号/工序步表首地址对照表，等待操作人员按下启动键，启动键处理程序如图2所示。由流程图可见，整个控制程序是以加工子程序MACHINE为中心组成。正常工作的过程是，操作者按下启动键后，则CPU进入启动键处理程序，在其中安排好工序步表指针指向用户加工程序后，调用加工子程序MACHINE完成工件的加工。加工子程序MACHINE的流程图如图3所示。
进入MACHINE后，首先清除各有关标识和计数器，然后根据工序步表指针取出本工件总的工序步数作为工序步计数器初值，取出第一道工序的标志字，如无错误则转到相应的处理模块执行。所有的处理模块执行完毕后，均转回到MACHINE程序中的DONE处，在此对工序步计数一次，判本工件的所有工序是否全部完成。已完则返回到主程序，未完则转到MACHINE2取出下一道工序继续加工。
工序步间的转换，通过工作信号灯方式来实现。每道工序的开始，设置好刀架运动的方向、长度、初始化C/T0后，便置位工作灯：1(BUSY)，进入显示循环等待C/T0中断。在C/T0中断服务子程序中，调用X向或Y向驱动子程序，驱动相应步进电机前进一步，进给计数一次，并判是否走完既定的步数。未完则返回，已完则置完成标志，且复位工作灯后返回。在主程序中循环显示一遍后，将监测工作灯状态，当发现(BUSY)=0时，则控制程序转向执行下一道工序。
由于斜线和圆弧加工时，需要X、Y两相步进电机联动，也即只有当X、Y向行程均走完时，斜线或圆弧的加工才算完毕，故安排他们的工作灯置位时是2(BUSY)，当X、Y向电机均前进到终点后，先后两次减1，使得(BUSY)=0，表示斜线或圆弧加工完毕，从而可进入下一道工序。
3.2斜线插补程序
完成斜线或圆弧切削的中心问题是如何根据原始参数，通过位置及轨迹控制运算(即通常所说的插补运算)，产生有规律的两串脉冲，来控制刀架的位置及运动轨迹[8]。对插补算法的要求，除了保证运算精度外，还要求运算方法简单以适应八位单片机的特点，另外还应尽量满足刀架运动速度不变的要求，以提高加工质量。在本系统中，采用逐点比较法来进行斜线和圆弧的插补算法[9]，它具有算法简单，速度平稳，调节方便，精度适合于普通车床加工要求等优点。
本系统允许1，2，3，4象限的斜线加工。对4个象限的斜线，采用统一的算法，即全部按第一象限的斜线进行插补运算，至于X、Y向电机的进给方向，则在工序开始时由控制程序根据斜线所在象限来规定。
3.3圆弧插补程序
圆弧插补比斜线插补的算法要复杂得多，其复杂度体现在如下三个方面：
1)圆弧有8种不同的类型(4个象限，每个象限内有2种方向——顺时针方向和逆时针方向)，要区别对待；
2)圆弧有过象限的问题；
3)圆弧不是线性函数，由于X、Y向脉冲当量不相同且均不等于1，若不加修改直接按通常的圆弧插补公式进行计算，则加工出的曲线将发生畸变，不再是所要求的圆弧。
对于8种不同类型的圆弧，我们将其分为两大类，其中第1象限顺圆弧、第3象限顺圆弧、第2象限逆圆弧、第4象限逆圆弧为一大类，其特点是圆弧发展趋向为：X向坐标绝对值越来越大，Y向坐标绝对值越来越小，记为“XY”；其余4种圆弧为另一大类，特点是圆弧发展趋向为“XY”。两类不同的圆弧插补算法有所区别，且第一大类圆弧还有可能有过象限问题。
4结语
本文设计了一个基于AT89C52单片机的普通车床微机控制系统，完成了单片机驱动步进电机的转向、转速、转数的软件设计，重点研究了斜线及圆弧等二次曲线零件加工中的插补算法，提出了加工程序的循环设计技术。由于本软件采用模块化结构，且在设计时，已考虑了可扩充性等问题，故只要稍作修改便可方便地增加目前尚未开发的其他功能，亦可轻易地移植到那些采用步进电机驱动的其他类型车床的微机控制装置上去，对于同类微机数控系统的设计开发，具有一定的实用价值和指导意义。
参考文献
[1]冯银兰，周会成. 当代数控技术的发展特点及趋势[J].科学之友，2007，10 (2)：207-210.
[2]石岩. 数控技术的发展趋势和思考[J]. 职业时空，2007，3(4)：50-52.
[3]彭楚武. 微型计算机原理及其应用[M]. 长沙：湖南大学出版社，2009.
[4]Cui Bo， Xu Guangbin. Design and realization of an intelligent data acquisition and display system based on AT89C52 and modbus [C]// Computing， Communication， Control， and Management， 2009." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/bedf669785986095587826d551f12b89/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-21T17:32:14+08:00" />
<meta property="article:modified_time" content="2021-06-21T17:32:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机床数控改造控制系统设计(微型计算机),简易数控车床的微机控制系统软件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>作者简介：汪英(1972—)，女，湖南岳阳人，副教授，研究方向：电子技术、物联网应用技术(E-mail：)；殷文珊(1975—)，女，湖南岳阳人，讲师，硕士，研究方向：计算机通信。</p> 
 <p>摘要：在用高新技术改造传统机械加工产业中，除了发展高精度、多功能的数控机床外，研发价格低廉、操作方便的简易数控机床也是适合我国国情的一种有效途径。本文采用AT89C52单片机和步进电机设计一种面向现有普通车床进行数控技术改造的微机控制系统，该系统能自动控制完成圆弧类二次曲线形零件的车削等多种功能。其软件设计采用模块化结构，编程简单灵活，扩充性、移植性好，对同类微机数控系统的设计具有一定参考价值。</p> 
 <p>关键词：简易数控车床；微机控制；软件；AT89C52；步进电机</p> 
 <p>中图分类号：TP368 文献标识码：A</p> 
 <p>1引言</p> 
 <p>数控机床因其智能化、高精度、高速度和高柔性化为制造业带来巨大变化，进入21世纪，我国在制造业方面投入了大量的技术改造资金，数控设备制造迎来了一个快速发展的阶段[1]。但是由于我国制造业起步比较晚，高性能的数控设备引进成本较高，面对众多中小机械加工类企业的普通机床技术改造的需求，采用单片机作为普通机床的数控中心，是较为适合我国国情，改造老式落后加工设备见效快，经济性能好，易于推广的一种有效措施[2]。本文研制了一种普通车床微机控制装置，该装置用于C618车床技术改造，能驱动车床完成手柄类零件车削加工，经现场运行，性能良好。本文主要讨论在这类装置上的系统软件，既是对已成功的软件的总结，也是对如何进一步提高其性能作些探讨。</p> 
 <p>2系统简介</p> 
 <p>本微机数控装置适用于改造C618、C616、CW6163等最大加工直径在400毫米以下的普通车床。它通过对刀架在纵横两个方向的运动距离、速度和方向的控制来实现车削内圆、外圆、断面、锥面、切槽、倒角以及圆弧或曲线零件等加工任务。其硬件结构框图如图1所示[3]。</p> 
 <p>本装置采用AT89C52单片机[4，5]作为控制中心，利用单片机上可编程的计数/定时器C/T0作为定时信号发生器，以中断方式启动CPU向外输出脉冲；利用单片机的P1口作为步进电机驱动信号输出口。在加工过程中，CPU按照用户编制的加工程序从P1口发出相应的一系列脉冲信号，经光电隔离、放大后驱动两台步进电机[6，7]，以控制刀架在纵横两个运动的方向、长度和速度，从而与机床主轴配合完成各种车削动作。</p> 
 <p>3控制系统软件设计</p> 
 <p>3.1主要程序流程图</p> 
 <p>由以上分析可知，控制程序的主要功能为：</p> 
 <p>1)按用户加工程序安排C/T0控制字，以产生相应的定时信号；</p> 
 <p>2)把加工程序中的位移毫米数转换成相应步进电机的步数；</p> 
 <p>3)安排步进电机的转向；</p> 
 <p>4)显示有关参数(如：当前工序的道数，加工性质字，位移的余量等)；</p> 
 <p>5)当C/T0中断信号产生时，驱动电机前进一步。</p> 
 <p>系统加电复位后，首先完成初始化，同时建立工件号/工序步表首地址对照表，等待操作人员按下启动键，启动键处理程序如图2所示。由流程图可见，整个控制程序是以加工子程序MACHINE为中心组成。正常工作的过程是，操作者按下启动键后，则CPU进入启动键处理程序，在其中安排好工序步表指针指向用户加工程序后，调用加工子程序MACHINE完成工件的加工。加工子程序MACHINE的流程图如图3所示。</p> 
 <p>进入MACHINE后，首先清除各有关标识和计数器，然后根据工序步表指针取出本工件总的工序步数作为工序步计数器初值，取出第一道工序的标志字，如无错误则转到相应的处理模块执行。所有的处理模块执行完毕后，均转回到MACHINE程序中的DONE处，在此对工序步计数一次，判本工件的所有工序是否全部完成。已完则返回到主程序，未完则转到MACHINE2取出下一道工序继续加工。</p> 
 <p>工序步间的转换，通过工作信号灯方式来实现。每道工序的开始，设置好刀架运动的方向、长度、初始化C/T0后，便置位工作灯：1(BUSY)，进入显示循环等待C/T0中断。在C/T0中断服务子程序中，调用X向或Y向驱动子程序，驱动相应步进电机前进一步，进给计数一次，并判是否走完既定的步数。未完则返回，已完则置完成标志，且复位工作灯后返回。在主程序中循环显示一遍后，将监测工作灯状态，当发现(BUSY)=0时，则控制程序转向执行下一道工序。</p> 
 <p>由于斜线和圆弧加工时，需要X、Y两相步进电机联动，也即只有当X、Y向行程均走完时，斜线或圆弧的加工才算完毕，故安排他们的工作灯置位时是2(BUSY)，当X、Y向电机均前进到终点后，先后两次减1，使得(BUSY)=0，表示斜线或圆弧加工完毕，从而可进入下一道工序。</p> 
 <p>3.2斜线插补程序</p> 
 <p>完成斜线或圆弧切削的中心问题是如何根据原始参数，通过位置及轨迹控制运算(即通常所说的插补运算)，产生有规律的两串脉冲，来控制刀架的位置及运动轨迹[8]。对插补算法的要求，除了保证运算精度外，还要求运算方法简单以适应八位单片机的特点，另外还应尽量满足刀架运动速度不变的要求，以提高加工质量。在本系统中，采用逐点比较法来进行斜线和圆弧的插补算法[9]，它具有算法简单，速度平稳，调节方便，精度适合于普通车床加工要求等优点。</p> 
 <p>本系统允许1，2，3，4象限的斜线加工。对4个象限的斜线，采用统一的算法，即全部按第一象限的斜线进行插补运算，至于X、Y向电机的进给方向，则在工序开始时由控制程序根据斜线所在象限来规定。</p> 
 <p>3.3圆弧插补程序</p> 
 <p>圆弧插补比斜线插补的算法要复杂得多，其复杂度体现在如下三个方面：</p> 
 <p>1)圆弧有8种不同的类型(4个象限，每个象限内有2种方向——顺时针方向和逆时针方向)，要区别对待；</p> 
 <p>2)圆弧有过象限的问题；</p> 
 <p>3)圆弧不是线性函数，由于X、Y向脉冲当量不相同且均不等于1，若不加修改直接按通常的圆弧插补公式进行计算，则加工出的曲线将发生畸变，不再是所要求的圆弧。</p> 
 <p>对于8种不同类型的圆弧，我们将其分为两大类，其中第1象限顺圆弧、第3象限顺圆弧、第2象限逆圆弧、第4象限逆圆弧为一大类，其特点是圆弧发展趋向为：X向坐标绝对值越来越大，Y向坐标绝对值越来越小，记为“XY”；其余4种圆弧为另一大类，特点是圆弧发展趋向为“XY”。两类不同的圆弧插补算法有所区别，且第一大类圆弧还有可能有过象限问题。</p> 
 <p>4结语</p> 
 <p>本文设计了一个基于AT89C52单片机的普通车床微机控制系统，完成了单片机驱动步进电机的转向、转速、转数的软件设计，重点研究了斜线及圆弧等二次曲线零件加工中的插补算法，提出了加工程序的循环设计技术。由于本软件采用模块化结构，且在设计时，已考虑了可扩充性等问题，故只要稍作修改便可方便地增加目前尚未开发的其他功能，亦可轻易地移植到那些采用步进电机驱动的其他类型车床的微机控制装置上去，对于同类微机数控系统的设计开发，具有一定的实用价值和指导意义。</p> 
 <p>参考文献</p> 
 <p>[1]冯银兰，周会成. 当代数控技术的发展特点及趋势[J].科学之友，2007，10 (2)：207-210.</p> 
 <p>[2]石岩. 数控技术的发展趋势和思考[J]. 职业时空，2007，3(4)：50-52.</p> 
 <p>[3]彭楚武. 微型计算机原理及其应用[M]. 长沙：湖南大学出版社，2009.</p> 
 <p>[4]Cui Bo， Xu Guangbin. Design and realization of an intelligent data acquisition and display system based on AT89C52 and modbus [C]// Computing， Communication， Control， and Management， 2009. ISECS International Colloquium on . IEEE Conference Publications， 2009：455-459</p> 
 <p>[5]Xi Baoqiang ， Fu Chenghua. Design of Intelligent Toy Car Motion Control System Based on the AT89C52 [C]// E-Product E-Service and E-Entertainment (ICEEE)， 2010 International Conference on . IEEE Conference Publications， 2010：1-4</p> 
 <p>[6]Kang Z.L ， Qu So.F. A new methodology for using single microprocessor to control DC stepper motors [C]// Industrial Technology， 1994， Proceedings of the IEEE International Conference on. IEEE Conference Publications， 1994：543-545</p> 
 <p>[7]Aranjo B， Soor P.K.， Talukder P. Stepper motor drives for robotic applications[C]// Power Engineering and Optimization Conference (PEDCO) Melaka， Malaysia， 2012 IEEE International Conference on. IEEE Conference Publications， 2012：361-366</p> 
 <p>[8]陈伯时. 电力拖动自动控制系统[M]. 北京：机械工业出版社，1991</p> 
 <p>[9]黄新燕. 机床数控技术及编程[M]. 北京：北京理工大学出版社，2009.</p> 
 <p>[10]蒙斌. 数控原理和数控机床[M]. 北京：化学工业出版社，2009.</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d81688bed0e8edb06dc9f22d51b80fe8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">网站图片多导致网站加载慢怎么解决？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/626adbb3a0e84471ab94ef56f9d9e188/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于JAVA界面——商品购买的简单实现。（图片背景）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>