<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>部分查询练习题及答案 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="部分查询练习题及答案" />
<meta property="og:description" content="1、通过SQL语句创建图书信息管理数据库，命名为“db_Library”，数据文件和日志文件放在D盘下以自己学号和姓名命名的文件夹中，数据文件的逻辑名为db_Library_data，数据文件的操作系统名为db_Library_data.mdf，文件初始大小为10MB，最大可增加至300MB，增幅为10%；日志文件的逻辑名为db_Library_log，日志文件的操作系统名为db_Library_data.ldf，文件初始大小为5MB，最大可增加至200MB，增幅为2MB。
CREATE DATABASE db_Library
ON PRIMARY (
NAME=db_Library_data,
FILENAME=‘D:\DATA\db_Library_data.mdf’,
SIZE=10MB,
MAXSIZE=300,
FILEGROWTH=10%)
LOG ON (
NAME=db_Library_log,
FILENAME=‘D:\DATA\db_Library_data.ldf’,
SIZE=5,
MAXSIZE=200,
FILEGROWTH=2 )
2、通过SQL语句在该数据库中创建模式L_C。
（二）创建和管理数据表
要求为各数据表的字段选择合适的数据类型及名称；为各数据表设置相应的完整性约束条件。
1、通过SQL语句将以下数据表创建在L_C模式下：
课程信息表（tb_course）——课程编号、课程名、先修课、学分
USE db_Library go
CREATE SCHEMA L_C GO
CREATE TABLE L_C.tb_course (
课程编号 char(10) primary key,
课程名 varchar(30) not null,
先修课 char(10),
学分 real
)
CREATE TABLE tb_course (
课程编号 char(10) primary key,
课程名 varchar(30) not null,
先修课 char(10),
学分 real
)
2、通过SQL语句将以下数据表创建在该数据库的默认模式dbo下：
图书类别信息表（tb_booktype)——类别编号、类别名称" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/fbb9a04a8df9b67b90f43228d25bff34/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-28T11:12:56+08:00" />
<meta property="article:modified_time" content="2020-11-28T11:12:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">部分查询练习题及答案</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>1、通过SQL语句创建图书信息管理数据库，命名为“db_Library”，数据文件和日志文件放在D盘下以自己学号和姓名命名的文件夹中，数据文件的逻辑名为db_Library_data，数据文件的操作系统名为db_Library_data.mdf，文件初始大小为10MB，最大可增加至300MB，增幅为10%；日志文件的逻辑名为db_Library_log，日志文件的操作系统名为db_Library_data.ldf，文件初始大小为5MB，最大可增加至200MB，增幅为2MB。<br> CREATE DATABASE db_Library<br> ON PRIMARY (<br> NAME=db_Library_data,<br> FILENAME=‘D:\DATA\db_Library_data.mdf’,<br> SIZE=10MB,<br> MAXSIZE=300,<br> FILEGROWTH=10%)<br> LOG ON (<br> NAME=db_Library_log,<br> FILENAME=‘D:\DATA\db_Library_data.ldf’,<br> SIZE=5,<br> MAXSIZE=200,<br> FILEGROWTH=2 )<br> 2、通过SQL语句在该数据库中创建模式L_C。<br> （二）创建和管理数据表<br> 要求为各数据表的字段选择合适的数据类型及名称；为各数据表设置相应的完整性约束条件。<br> 1、通过SQL语句将以下数据表创建在L_C模式下：<br> 课程信息表（tb_course）——课程编号、课程名、先修课、学分<br> USE db_Library go<br> CREATE SCHEMA L_C GO<br> CREATE TABLE L_C.tb_course (<br> 课程编号 char(10) primary key,<br> 课程名 varchar(30) not null,<br> 先修课 char(10),<br> 学分 real<br> )</p> 
<p>CREATE TABLE tb_course (<br> 课程编号 char(10) primary key,<br> 课程名 varchar(30) not null,<br> 先修课 char(10),<br> 学分 real<br> )</p> 
<h3><a id="2SQLdbo%0Atb_booktype%0ACREATE_TABLE_tb_booktype__%0A_char5_primary_key%0A_varchar30_not_null%0A%0Atb_book%0ACREATE_TABLE_tb_book__%0A_char10_primary_key%0A_char5%0A_varchar30_not_null%0A_varchar10%0A_varchar50%0A_money%0A_int_default_0%0A%0Atb_reader%0ACREATE_TABLE_tb_reader__%0A_char10_primary_key%0A_varchar10_unique%0A_char2%0A_char11%0A_char10%0A_varchar30%0A%0Atb_borrow%0ACREATE_TABLE_tb_borrow__%0A_char10%0A_char10%0A_datetime%0A_datetime%0A_primary_key%0A%0A3SQL%0AALTER_TABLE_tb_reader%0ADROP_COLUMN__35"></a>2、通过SQL语句将以下数据表创建在该数据库的默认模式dbo下：<br> 图书类别信息表（tb_booktype)——类别编号、类别名称<br> CREATE TABLE tb_booktype (<br> 类别编号 char(5) primary key,<br> 类别名称 varchar(30) not null<br> )<br> 图书信息表（tb_book）——图书编号、类别编号、书名、作者、出版社、定价、库存数<br> CREATE TABLE tb_book (<br> 图书编号 char(10) primary key,<br> 类别编号 char(5),<br> 书名 varchar(30) not null,<br> 作者 varchar(10),<br> 出版社 varchar(50),<br> 定价 money,<br> 库存数 int default 0<br> )<br> 读者信息表（tb_reader）——读者编号、姓名、性别、学号、班级、系部<br> CREATE TABLE tb_reader (<br> 读者编号 char(10) primary key,<br> 姓名 varchar(10) unique,<br> 性别 char(2),<br> 学号 char(11),<br> 班级 char(10),<br> 系部 varchar(30)<br> )<br> 借阅信息表（tb_borrow)——图书编号、读者编号、借阅日期、归还日期<br> CREATE TABLE tb_borrow (<br> 图书编号 char(10),<br> 读者编号 char(10),<br> 借阅日期 datetime,<br> 归还日期 datetime,<br> primary key(图书编号,读者编号)<br> )<br> 3、通过SQL语句对读者信息表进行修改：删除系部字段、添加所在系字段。<br> ALTER TABLE tb_reader<br> DROP COLUMN 系部</h3> 
<p>ALTER TABLE tb_reader<br> ADD 所在系 varchar(30)<br> 4、通过SQL语句对图书信息表进行修改：将定价的数据类型改为REAL。<br> ALTER TABLE tb_book<br> ALTER COLUMN 定价 real<br> 5、通过SQL语句删除课程信息表。<br> DROP TABLE L_C.tb_course<br> （三）创建和删除索引<br> 1、使用SQL语句在图书信息表上创建一个非聚簇索引IX_S_QUANTITY，要求按照该表中库存数字段的降序创建。<br> CREATE NONCLUSTERED INDEX IX_S_QUANTITY<br> ON tb_book(库存数 desc)<br> 2、使用SQL语句在读者信息表上创建一个唯一的非聚簇索引IX_S_NAME，<br> 要求按照该表中的姓名字段的升序创建。<br> CREATE UNIQUE NONCLUSTERED INDEX IX_S_NAME<br> ON tb_reader(姓名 asc)<br> 3、使用SQL语句删除之前创建的两个索引。<br> DROP INDEX tb_reader.IX_S_NAME</p> 
<p>（1）查询每本图书的所有信息；<br> USE db_LibraryNew<br> go<br> SELECT * FROM tb_book<br> （2）查询每个读者的读者编号、姓名和班级；<br> SELECT 读者编号,姓名,班级 FROM tb_reader<br> （3）查询每条借阅记录的借阅天数（函数DATEDIFF获取两个日期的差）；<br> select DATEDIFF(WEEK,借阅日期,归还日期)<br> from tb_borrow<br> （4）查询被借阅过的图书的图书编号；<br> select distinct 图书编号<br> from tb_borrow<br> （5）查询图书编号为“10006”的书名和作者；<br> select 书名,作者<br> from tb_book<br> where 图书编号=‘10006’<br> （6）查询库存数在5到10本之间的图书的图书编号和书名；<br> select 图书编号,书名<br> from tb_book<br> where 库存数 between 5 and 10<br> （7）查询计算机系或电子系姓张的读者信息；<br> select *<br> from tb_reader<br> where 姓名 like ‘张%’ and 所在系 IN (‘计算机系’,‘电子系’)<br> （8）查询书名包括“英语”的图书信息；<br> select *<br> from tb_book<br> where 书名 like ‘%英语%’<br> （9）统计男读者、女读者的人数；<br> select 性别,COUNT(<em>) 人数<br> from tb_reader<br> group by 性别<br> （10）统计各类图书的类别编号、平均定价以及库存总数；<br> select 类别编号,AVG(定价) 平均定价,SUM(库存数) 库存综述<br> from tb_book<br> group by 类别编号<br> （11）统计每本书籍借阅的人数，要求输出图书编号和所借人数，查询结果按人数降序排列；<br> select 图书编号,COUNT(读者编号) 借阅数量<br> from tb_borrow<br> group by 图书编号<br> order by count(读者编号)<br> –order by 借阅数量<br> （12）查询有库存的各类别图书的类别编号、类别名称和借阅数量；<br> select tb_booktype.类别编号,类别名称,COUNT(</em>) 借阅数量<br> from tb_booktype,tb_borrow,tb_book<br> where tb_booktype.类别编号=tb_book.类别编号<br> and tb_book.图书编号=tb_borrow.图书编号<br> and 库存数&gt;0<br> GROUP by tb_booktype.类别编号,类别名称（13）查询借阅了“大学英语”一书的读者，<br> 输出读者姓名、性别、系部；<br> select 姓名,性别,所在系<br> from tb_book,tb_borrow,tb_reader<br> where tb_book.图书编号=tb_borrow.图书编号<br> and tb_reader.读者编号=tb_borrow.读者编号<br> and 书名=‘大学英语’<br> （14）查询每个读者的读者编号、姓名、所借图书编号以及所借阅日期；（LEFT OUTER JOIN）</p> 
<p>（15）查询现有图书中价格最高的图书，<br> 输出书名、作者、定价；<br> select 书名,作者,定价<br> from tb_book<br> where 定价=<br> (<br> select MAX(定价)<br> from tb_book)<br> （16）查询借阅了“大学英语”但没有借阅“C++程序设计”的读者，输出读者姓名、性别、系部；<br> select 姓名,性别,所在系<br> from tb_reader<br> where 读者编号 in<br> (select 读者编号<br> from tb_borrow,tb_book<br> where tb_book.图书编号=tb_borrow.图书编号<br> and 书名=‘大学英语’<br> )<br> and 读者编号 not in<br> (<br> select 读者编号<br> from tb_borrow,tb_book<br> where tb_book.图书编号=tb_borrow.图书编号<br> and 书名=‘C++程序设计’<br> )<br> （17）统计借阅了2本以上图书的读者信息；<br> select 读者编号,COUNT(图书编号) 借阅数量<br> from tb_borrow<br> group by 读者编号<br> having COUNT(图书编号)&gt;2<br> （18）查询借阅了“大学英语”一书或者<br> 借阅了“C++程序设计”一书的读者信息；（用集合查询完成）<br> select *<br> from tb_borrow,tb_book,tb_reader<br> where tb_book.图书编号=tb_borrow.图书编号<br> and tb_reader.读者编号=tb_borrow.读者编号<br> and 书名=‘大学英语’<br> union<br> select *<br> from tb_borrow,tb_book,tb_reader<br> where tb_book.图书编号=tb_borrow.图书编号<br> and tb_reader.读者编号=tb_borrow.读者编号<br> and 书名=‘C++程序设计’<br> （19）查询既借阅了“大学英语”一书又借阅了“C++程序设计”一书的读者信息；（用集合查询完成）<br> select *<br> from tb_borrow,tb_book,tb_reader<br> where tb_book.图书编号=tb_borrow.图书编号<br> and tb_reader.读者编号=tb_borrow.读者编号<br> and 书名=‘大学英语’<br> intersect<br> select *<br> from tb_borrow,tb_book,tb_reader<br> where tb_book.图书编号=tb_borrow.图书编号<br> and tb_reader.读者编号=tb_borrow.读者编号<br> and 书名=‘C++程序设计’<br> 20）查询计算机系中比其他系所有读者借书数量都多的读者的信息；<br> select * from tb_reader<br> where 读者编号 in<br> (select tb_borrow.读者编号<br> from tb_borrow,tb_reader<br> where tb_borrow.读者编号=tb_reader.读者编号<br> and 所在系=‘计算机系’<br> group by tb_borrow.读者编号<br> having COUNT(图书编号)&gt;all<br> (<br> select COUNT(图书编号)<br> from tb_borrow,tb_reader<br> where tb_borrow.读者编号=tb_reader.读者编号<br> and 所在系!=‘计算机系’<br> group by tb_borrow.读者编号)<br> )<br> （21）在读者信息表中插入一条新的记录（读者编号：R10011；姓名：张三；所在系：电子系）；<br> insert into tb_reader(读者编号,姓名,所在系)<br> values(‘R10011’,‘张三’,‘电子系’)<br> （22）定义一个表tb_bknew，<br> 包含图书编号、书名和类别名称字段，要求将类别编号为“3”的图书的图书编号、书名和类别名称插入到tb_bknew表中；<br> select 图书编号,书名,类别名称<br> into tb_bknew1<br> from tb_book,tb_booktype<br> where tb_book.类别编号=‘3’<br> and tb_book.类别编号=tb_booktype.类别编号</p> 
<h3><a id="select__from_tb_bknew1%0A2335%0Aupdate_tb_book__set_5__where_3%0A24C%0ADATEADD%0Aupdate_tb_borrow%0Aset_DATEADDmonth1%0Awhere_C%0A25%0ADELETE_FROM_tb_reader%0Awhere_%0A26tb_bknew%0Adelete_from_tb_bknew_228"></a>select * from tb_bknew1<br> （23）将类别编号为“3”的所有图书的库存数增加5；<br> update tb_book set 库存数=库存数+5 where 类别编号=‘3’<br> （24）将“C++程序设计”这本书的归还日期增加一个月<br> （函数DATEADD）。<br> update tb_borrow<br> set 归还日期=DATEADD(month,1,归还日期)<br> where 书名=‘C++程序设计’<br> （25）删除姓名为“张三”的读者的信息；<br> DELETE FROM tb_reader<br> where 姓名=‘张三’<br> （26）删除tb_bknew表中的所有数据；<br> delete from tb_bknew</h3> 
<p>truncate table tb_bknew</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9407aee1dd421cdfd4df81c5595503df/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">测试方案模板_C&#43;&#43;函数模板的偏特化</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/23025b32df180cbc7b2748e8bbac09f1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">完美实现跨域Iframe高度自适应</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>