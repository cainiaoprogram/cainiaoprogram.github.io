<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SkeyeARS 全景AR增强监视系统之cuda(cuvid)视频硬解码 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SkeyeARS 全景AR增强监视系统之cuda(cuvid)视频硬解码" />
<meta property="og:description" content="SkeyeARS 全景AR增强监视系统之cuda(cuvid)视频硬解码 1、写在前面 前面我们已经了解关于视频硬解码的一些技术。
其中提到的 nvcuvid 则是 Nvidia GPU 硬解码的核心，并且是由官方提供支持，因此可以放心使用。
2、正文开始 NVDECODE API 支持的编解码器有：
MPEG-1
MPEG-2
MPEG4
VC-1
H.264 (AVCHD) (8 位)
H.265 (HEVC)（8 位、10 位和 12 位）
VP8
VP9（8位、10位和12位）
AV1 Main profile
Hybrid (CUDA &#43; CPU) JPEG
解码器管道由三个主要组件组成：解复用器、视频解析器和视频解码器,这些组件不相互依赖，因此可以独立使用。
NVDECODE API 为 NVIDIA 视频解析器和 NVIDIA 视频解码器提供 API。
其中，NVIDIA 视频解析器纯粹是一个软件组件，如果需要，用户可以插入任何解析器来代替 NVIDIA 视频解析器（例如 FFmpeg 解析器）。
NVDECODE 视频解码器管道如下图所示：
[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-1kQueSpw-1649148749070)(./img/nvdecoder_pipeline.png)]
在高层次上，应遵循以下步骤来解码任何视频内容，使用 NVDECODEAPI：
1、创建一个 CUDA 上下文。
2、查询硬件解码器的解码能力。
使用 cuvidGetDecoderCaps() 3、创建解码器实例。 使用 cuvidCreateDecoder() 创建 CUvideodecoder 实例 4、解复用内容（如 ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e61adee47e2958ec9c49e55cdc8e169b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-05T16:53:50+08:00" />
<meta property="article:modified_time" content="2022-04-05T16:53:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SkeyeARS 全景AR增强监视系统之cuda(cuvid)视频硬解码</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="SkeyeARS_ARcudacuvid_0"></a>SkeyeARS 全景AR增强监视系统之cuda(cuvid)视频硬解码</h2> 
<h4><a id="1_2"></a>1、写在前面</h4> 
<p>前面我们已经了解关于视频硬解码的一些技术。</p> 
<p>其中提到的 <code>nvcuvid</code> 则是 Nvidia GPU 硬解码的核心，并且是由官方提供支持，因此可以放心使用。</p> 
<hr> 
<h4><a id="2_10"></a>2、正文开始</h4> 
<p>NVDECODE API 支持的编解码器有：</p> 
<blockquote> 
 <p>MPEG-1<br> MPEG-2<br> MPEG4<br> VC-1<br> H.264 (AVCHD) (8 位)<br> H.265 (HEVC)（8 位、10 位和 12 位）<br> VP8<br> VP9（8位、10位和12位）<br> AV1 Main profile<br> Hybrid (CUDA + CPU) JPEG</p> 
</blockquote> 
<p>解码器管道由三个主要组件组成：解复用器、视频解析器和视频解码器,这些组件不相互依赖，因此可以独立使用。</p> 
<p><code>NVDECODE API</code> 为 NVIDIA 视频解析器和 NVIDIA 视频解码器提供 API。</p> 
<p>其中，NVIDIA 视频解析器纯粹是一个软件组件，如果需要，用户可以插入任何解析器来代替 NVIDIA 视频解析器（例如 FFmpeg 解析器）。</p> 
<p>NVDECODE 视频解码器管道如下图所示：</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-1kQueSpw-1649148749070)(./img/nvdecoder_pipeline.png)]</p> 
<p>在高层次上，应遵循以下步骤来解码任何视频内容，使用 <code>NVDECODEAPI</code>：</p> 
<ul><li> <p>1、创建一个 CUDA 上下文。</p> </li><li> <p>2、查询硬件解码器的解码能力。</p> </li></ul> 
<pre><code>	使用 cuvidGetDecoderCaps()
</code></pre> 
<ul><li>3、创建解码器实例。</li></ul> 
<pre><code>	使用 cuvidCreateDecoder() 创建 CUvideodecoder 实例
</code></pre> 
<ul><li> <p>4、解复用内容（如 .mp4），这可以使用 FFMPEG 等第三方软件来完成。</p> </li><li> <p>5、使用 <code>NVDECODE API</code> 提供的解析器或第三方解析器解析视频码流，比如 FFmpeg。</p> </li></ul> 
<pre><code>	从解复用器中提取的数据包使用 cuvidParseVideoData() 输入解析器。

	解析器在从内部同步创建解析器对象时触发注册的回调cuvidParseVideoData()，只要有序列变化或图片准备好被解码和/或显示。 如果回调返回失败，它将被传播cuvidParseVideoData() 到应用程序。

	解码结果与 CUVIDPICPARAMS 结构中的图片索引值相关联，

	这也是由解析器提供的。 这个图片索引稍后用于映射解码的帧到 CUDA 内存
</code></pre> 
<ul><li>6、使用 <code>VDECODE API</code> 开始解码。</li></ul> 
<pre><code>    调用 cuvidDecodePicture() 并将解码器句柄和指针传递给 CUVIDPICPARAMS 在 NVDEC 上开始解码。
</code></pre> 
<ul><li>7、获取解码后的 YUV 进行进一步处理。</li></ul> 
<pre><code>	用户需要调用 cuvidMapVideoFrame() 来获取 CUDA 设备指针和保存解码和后处理帧的输出表面。

	请注意 cuvidDecodePicture() 指示 NVDEC 硬件引擎启动帧/字段的解码。 

	但是 cuvidMapVideoFrame() 成功完成表示解码过程完成，解码后的YUV帧从 NVDEC 生成的格式转换为 CUVIDDECODECREATEINFO::OutputFormat 中指定的 YUV 格式。

	cuvidMapVideoFrame() API 将解码表面索引 (nPicIdx) 作为输入并将其映射到可用的输出表面之一，对解码帧进行后处理并复制到输出表面和返回 CUDA 设备指针和输出表面的相关间距。
</code></pre> 
<ul><li>8、查询解码帧的状态。</li></ul> 
<pre><code>	解码开始后，可随时调用 cuvidGetDecodeStatus() 进行查询该帧的解码状态。
</code></pre> 
<ul><li> <p>9、根据解码状态，使用解码后的输出进行进一步处理，例如渲染、推理、后处理等</p> </li><li> <p>10、如果应用程序需要显示输出</p> 
  <ul><li> <p>将解码的 YUV 表面转换为 RGBA。</p> </li><li> <p>将 RGBA 表面映射到 DirectX 或 OpenGL 纹理。</p> </li><li> <p>在屏幕上绘制纹理。</p> </li></ul> </li><li> <p>11、解码过程完成后销毁解码器实例。</p> </li></ul> 
<pre><code>	用户需要调用 cuvidDestroyDecoder() 来销毁解码器会话并释放所有分配的解码器资源。
</code></pre> 
<ul><li>12、销毁 CUDA 上下文。</li></ul> 
<hr> 
<h4><a id="3_110"></a>3、结语</h4> 
<p>最后，我们的 <code>SkeyeARS</code> 实际上支持可配置视频 <code>软解码/硬解码</code> 的。</p> 
<p>在 <code>SkeyeARS</code> 运行目录下 <code>config/config.ini</code> 中。</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-9GNElImZ-1649148749072)(./img/codec_config.png)]</p> 
<p>其中：<code>EasyPlayerProDecodeType</code> 为直播解码选项，<code>EasyPlayerDecodeType</code> 则为录播解码选项。</p> 
<p>配置为 <code>0</code> 选择软解码，配置为 <code>1</code> 选择硬解码。</p> 
<p>8749072)]</p> 
<p>其中：<code>EasyPlayerProDecodeType</code> 为直播解码选项，<code>EasyPlayerDecodeType</code> 则为录播解码选项。</p> 
<p>配置为 <code>0</code> 选择软解码，配置为 <code>1</code> 选择硬解码。</p> 
<h3><a id="SkeyeARS_128"></a>关于SkeyeARS</h3> 
<p>SkeyeARS全景AR增强监视系统， 是视开科技开发的一款基于宽场景多路视频无缝拼接、视频实时增强、监视目标增强显示、目标自动跟踪、视频存储回放、远程数据传输和多通道全景视频同步显示等功能的综合视频AR增强监视系统，广泛应用于智慧交通、智慧城市、智慧机场等大场景智能监控领域。</p> 
<p>详细说明：<a href="http://www.openskeye.cn/web/product/ars?id=0df9217e-da11-4fdf-a83c-3afcc16ca01b" rel="nofollow" title="SkeyeARS">http://www.openskeye.cn/web/product/ars</a></p> 
<h3><a id="_136"></a>获取更多信息</h3> 
<p>邮件：<a href="mailto:support@openskeye.cn" rel="nofollow">support@openskeye.cn</a></p> 
<p>QQ交流群：102644504</p> 
<p><strong>SkeyeVSS</strong><a href="http://www.openskeye.cn/web/product/vss?id=c24a0a06-6d38-45a5-8623-a1fa3f406ab1" rel="nofollow">综合安防互联网无插件播放解决方案</a></p> 
<p><strong>SkeyeARS</strong><a href="http://www.openskeye.cn/web/product/ars?id=0df9217e-da11-4fdf-a83c-3afcc16ca01b" rel="nofollow">全景AR增强监视系统解决方案</a></p> 
<p><strong>SkeyeIVMS</strong><a href="http://www.openskeye.cn/web/product/ivms?id=8c2d5507-08f1-48a8-a91b-1c15f6e7cc15" rel="nofollow">集群式视频云管控平台解决方案</a></p> 
<p>Copyright © OpenSKEYE Team 2018-2022</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/88834810295c1775d8d994efaf974340/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">socket原理以及socket的简单实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c1fab8de7b422b5c6f18d7a1c7e4353d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【学习笔记】大数据技术之Kafka3.x（生产调优手册）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>