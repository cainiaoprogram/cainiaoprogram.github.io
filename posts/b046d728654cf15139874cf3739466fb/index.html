<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue项目使用vite设置proxy代理，vite.config.js配置，解决本地跨域问题 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue项目使用vite设置proxy代理，vite.config.js配置，解决本地跨域问题" />
<meta property="og:description" content="vue3&#43;vite4项目，配置代理实现本地开发跨域问题 非同源请求，也就是协议(protocol)、端口(port)、主机(host)其中一项不相同的时候，这时候就会产生跨域
vite的proxy代理和vue-cli的proxy大致相同，需要在vite.config.js文件中配置（打包配置也在此）代理配置在server中，可以上vite官网服务器选项查看server.proxy代码示例：开发服务器选项–server.proxy需要注意：使用了代理之后，axios的base路径需要改成代理路径，比如
ok 直接贴配置代码： import { fileURLToPath, URL } from &#39;node:url&#39; import { defineConfig } from &#39;vite&#39; import vue from &#39;@vitejs/plugin-vue&#39; import fs from &#34;fs&#34; // https://vitejs.dev/config/ export default defineConfig({ base: &#39;./&#39;, //相对路径 plugins: [vue()], resolve: { alias: { &#39;@&#39;: fileURLToPath(new URL(&#39;./src&#39;, import.meta.url)) } }, css: { preprocessorOptions: { less: { modifyVars: {}, javascriptEnabled: true, }, }, }, build: { minify:&#39;terser&#39;, outDir: &#34;./dist&#34;, //emptyOutDir: true, //assetsDir: &#34;assets&#34;, //指定静态资源存放路径 // sourcemap: false, //是否构建source map 文件 terserOptions: { // 生产环境移除console compress: { drop_console: false, drop_debugger: true, }, }, // 块大小警告的限制（以 kbs 为单位） 默认： 500 chunkSizeWarningLimit: 1000, // 分解块，将大块分解成更小的块 rollupOptions: { output: { manualChunks(id) { if (id." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b046d728654cf15139874cf3739466fb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-03T17:59:18+08:00" />
<meta property="article:modified_time" content="2023-11-03T17:59:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue项目使用vite设置proxy代理，vite.config.js配置，解决本地跨域问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="vue3vite4_0"></a>vue3+vite4项目，配置代理实现本地开发跨域问题</h3> 
<blockquote> 
 <p>非同源请求，也就是协议(protocol)、端口(port)、主机(host)其中一项不相同的时候，这时候就会产生跨域</p> 
</blockquote> 
<blockquote> 
 <ol><li>vite的proxy代理和vue-cli的proxy大致相同，需要在vite.config.js文件中配置（打包配置也在此）</li><li>代理配置在server中，可以上vite官网服务器选项查看server.proxy代码示例：<a href="https://cn.vitejs.dev/config/server-options.html#server-proxy" rel="nofollow">开发服务器选项–server.proxy</a></li><li>需要注意：使用了代理之后，axios的base路径需要改成代理路径，比如<br> <img src="https://images2.imgbox.com/fd/59/X2lq7UjH_o.png" alt="在这里插入图片描述"></li><li>ok 直接贴配置代码：</li></ol> 
</blockquote> 
<pre><code>import { fileURLToPath, URL } from 'node:url'
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import fs from "fs"
// https://vitejs.dev/config/
export default defineConfig({
  base: './', //相对路径
  plugins: [vue()],
  resolve: {
    alias: {
      '@': fileURLToPath(new URL('./src', import.meta.url))
    }
  },
  css: {
    preprocessorOptions: {
      less: {
        modifyVars: {},
        javascriptEnabled: true,
      },
    },
  },
  build: {
    minify:'terser',
    outDir: "./dist",
    //emptyOutDir: true,
    //assetsDir: "assets", //指定静态资源存放路径
    // sourcemap: false, //是否构建source map 文件
    terserOptions: {
      // 生产环境移除console
      compress: {
        drop_console: false,
        drop_debugger: true,
      },
    },
    // 块大小警告的限制（以 kbs 为单位） 默认： 500
    chunkSizeWarningLimit: 1000,
    // 分解块，将大块分解成更小的块
    rollupOptions: {
      output: {
        manualChunks(id) {
          if (id.includes('node_modules')) {
            return id.toString().split('node_modules/')[1].split('/')[0].toString();
          }
        },
        chunkFileNames: (chunkInfo) =&gt; {
          const facadeModuleId = chunkInfo.facadeModuleId
            ? chunkInfo.facadeModuleId.split('/')
            : [];
          const fileName = facadeModuleId[facadeModuleId.length - 2] || '[name]';
          return `js/${fileName}/[name].[hash].js`;
        }
      }
    },
  },
  server: {
  	// 配置https代理与证书
    https: {
      key: fs.readFileSync('cert/8982715__nsfocus.com.key'),
      cert: fs.readFileSync('cert/8982715__nsfocus.com.pem')
    },// 是否开启 https
    open: false, // 是否自动在浏览器打开
    port: 8899, // 端口号
    host: "0.0.0.0",
    //这里的ip和端口是前端项目的;下面为需要跨域访问后端项目
    proxy: {
      '/seatsapi/': {   // '/api'是代理标识，用于告诉node，url前面是/api的就是使用代理的
        target: 'https://miccdev.nsfocus.com/',//这里填入你要请求的接口的前缀
        ws: false,//代理websocked
        changeOrigin: true,  //是否跨域
        secure: true,  //是否https接口
        // pathRewrite:{  // pathRewrite 的作用是把实际Request Url中的'/api'用""代替
        //   "^/": "/"
        // },
      //   headers: {
      //     referer: 'https://uat.nsfocus.com/api/input_suggest', //这里后端做了拒绝策略限制，请求头必须携带referer，否则无法访问后台
      //   }
      }
    }
  },
})

</code></pre> 
<h3><a id="____94"></a>结束，总结完毕 ~ 简单易懂 ~</h3>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c8993ab82b0183835406919896f3a782/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何吃，少花钱又营养丰富？可用MindOpt线性规划求解来决策</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3a704be62020ad4f55c6d0b6c412b669/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">京东青龙上车教程保姆级别讲解为什么上车以及详细开活动教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>