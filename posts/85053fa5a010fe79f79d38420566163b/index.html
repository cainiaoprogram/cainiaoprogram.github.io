<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>数字IC设计——用Verilog实现序列检测器（有限状态机FSM） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="数字IC设计——用Verilog实现序列检测器（有限状态机FSM）" />
<meta property="og:description" content="数字IC设计——用Verilog实现序列检测器（有限状态机）
序列检测器在数据通讯，雷达和遥测等领域中用与检测步识别标志。它是一种用来检测一组或多组序列信号的电路。例如检测器收到一组串行码｛1110010｝后，输出标志1，否则，输出0。
一、“101” 序列检测器 序列检测器：有“101”序列输入时输出为1，其他输入情况下，输出为0。画出状态转移图，并用Verilog描述。
先分析输入序列时，产生的结果
序列检测器就是将一个指定序列从数字码流中识别出来。本例中将设计一个“101”序列的检测器。设X为数字码流的输入，Z为检测出标记输出，高电平表示发现指定的序列101.考虑码流为10101010101…则 时钟1234567891011输入X10101010101输出Z00101010101 将上述功能转化为状态转移图：
用Verilog语言描述状态机 module Detect_101( input clk, input rst_n, input data, output flag_101 ); parameter S0 = 0, S1 = 1, S2 = 2, S3 = 3; reg [1:0] state; always @(posedge clk or negedge rst_n)begin if(rst_n == 1&#39;b0)begin state &lt;= S0; end else begin case(state) S0: if(data == 1) state &lt;= S1; else state &lt;= S0; S1: if(data == 0) state &lt;= S2; else state &lt;= S1; S2: if(data == 1) state &lt;= S3; else state &lt;= S0; S3: if(data == 1) state &lt;= S1; else state &lt;= S2; default: state &lt;=S0; endcase end end assign flag_101 = (state == S3)?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/85053fa5a010fe79f79d38420566163b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-25T14:32:46+08:00" />
<meta property="article:modified_time" content="2022-05-25T14:32:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">数字IC设计——用Verilog实现序列检测器（有限状态机FSM）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>数字IC设计——用Verilog实现序列检测器（有限状态机）<br> 序列检测器在数据通讯，雷达和遥测等领域中用与检测步识别标志。它是一种用来检测一组或多组序列信号的电路。例如检测器收到一组串行码｛1110010｝后，输出标志1，否则，输出0。</p> 
<h6><a id="101__2"></a>一、“101” 序列检测器</h6> 
<p>序列检测器：有“101”序列输入时输出为1，其他输入情况下，输出为0。画出状态转移图，并用Verilog描述。</p> 
<ol><li>先分析输入序列时，产生的结果<br> 序列检测器就是将一个指定序列从数字码流中识别出来。本例中将设计一个“101”序列的检测器。设X为数字码流的输入，Z为检测出标记输出，高电平表示发现指定的序列101.考虑码流为10101010101…则</li></ol> 
<table><thead><tr><th>时钟</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th></tr></thead><tbody><tr><td>输入X</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td></tr><tr><td>输出Z</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td></tr></tbody></table> 
<ol start="2"><li>将上述功能转化为状态转移图：<br> <img src="https://images2.imgbox.com/4e/c2/EjNSDSk0_o.png" alt="在这里插入图片描述"></li><li>用Verilog语言描述状态机</li></ol> 
<pre><code class="prism language-java">
<span class="token keyword">module</span> <span class="token class-name">Detect_101</span><span class="token punctuation">(</span>
    input           clk<span class="token punctuation">,</span>
    input           rst_n<span class="token punctuation">,</span>
    input           data<span class="token punctuation">,</span>
    output          flag_101
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

parameter   S0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
            S1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
            S2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
            S3 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

reg     <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>   state<span class="token punctuation">;</span>

always @<span class="token punctuation">(</span>posedge clk or negedge rst_n<span class="token punctuation">)</span>begin
    <span class="token keyword">if</span><span class="token punctuation">(</span>rst_n <span class="token operator">==</span> <span class="token number">1</span>'b0<span class="token punctuation">)</span>begin
        state <span class="token operator">&lt;=</span> S0<span class="token punctuation">;</span>
    end
    <span class="token keyword">else</span> begin
        <span class="token keyword">case</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>
        S0<span class="token operator">:</span> 
            <span class="token keyword">if</span><span class="token punctuation">(</span>data <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
                state <span class="token operator">&lt;=</span> S1<span class="token punctuation">;</span>
            <span class="token keyword">else</span> 
                state <span class="token operator">&lt;=</span> S0<span class="token punctuation">;</span>
        S1<span class="token operator">:</span> 
            <span class="token keyword">if</span><span class="token punctuation">(</span>data <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                state <span class="token operator">&lt;=</span> S2<span class="token punctuation">;</span>
            <span class="token keyword">else</span> 
                state <span class="token operator">&lt;=</span> S1<span class="token punctuation">;</span>
        S2<span class="token operator">:</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>data <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
                state <span class="token operator">&lt;=</span> S3<span class="token punctuation">;</span>
            <span class="token keyword">else</span> 
                state <span class="token operator">&lt;=</span> S0<span class="token punctuation">;</span>
        S3<span class="token operator">:</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>data <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
                state <span class="token operator">&lt;=</span> S1<span class="token punctuation">;</span>
            <span class="token keyword">else</span> 
                state <span class="token operator">&lt;=</span> S2<span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
                state <span class="token operator">&lt;=</span>S0<span class="token punctuation">;</span>       
        endcase
    end
end

assign  flag_101 <span class="token operator">=</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> S3<span class="token punctuation">)</span><span class="token operator">?</span> <span class="token number">1</span><span class="token char">'b1: 1'</span>b0<span class="token punctuation">;</span>

endmodule
</code></pre> 
<p>采用三段式状态机将时序逻辑和组合逻辑分开，把状态和输出单独列开，方便检查和维护。可以写成如下：</p> 
<pre><code class="prism language-java">
<span class="token keyword">module</span> <span class="token class-name">Detect_101</span><span class="token punctuation">(</span>
    input           clk<span class="token punctuation">,</span>
    input           rst_n<span class="token punctuation">,</span>
    input           data<span class="token punctuation">,</span>
    output          flag_101
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

parameter   S0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
            S1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
            S2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
            S3 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

reg     <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>   state<span class="token punctuation">;</span>
reg     <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>   next_state<span class="token punctuation">;</span>
wire 			flag_101<span class="token punctuation">;</span>

always @<span class="token punctuation">(</span>posedge clk or negedge rst_n<span class="token punctuation">)</span> begin
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> rst_n<span class="token punctuation">)</span>
		state <span class="token operator">&lt;=</span> S0<span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		state <span class="token operator">&lt;=</span> next_state<span class="token punctuation">;</span>
end

always @<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>begin
        <span class="token keyword">case</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>
        S0<span class="token operator">:</span> 
        	next_state <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">?</span> S1<span class="token operator">:</span>S0<span class="token punctuation">;</span>
        S1<span class="token operator">:</span> 
        	next_state <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">?</span> S1<span class="token operator">:</span>S2<span class="token punctuation">;</span>
        S2<span class="token operator">:</span> 
        	next_state <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">?</span> S3<span class="token operator">:</span>S0<span class="token punctuation">;</span>
        S3<span class="token operator">:</span> 
        	next_state <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">?</span> S1<span class="token operator">:</span>S2<span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            state <span class="token operator">=</span> S0<span class="token punctuation">;</span>       
        endcase
end

always @<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>begin
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> rst_n<span class="token punctuation">)</span>
		flag_101 <span class="token operator">=</span> <span class="token number">1</span>'b0<span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> S3<span class="token punctuation">)</span>
		flag_101 <span class="token operator">=</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		flag_101 <span class="token operator">=</span> <span class="token number">1</span>'b0<span class="token punctuation">;</span>
end

endmodule	
</code></pre> 
<ol start="4"><li><strong>需要注意的地方</strong><br> 由于对于 <mark>有“101”序列输入时输出为1，其他输入情况下，输出为0</mark>。<br> 在画状态转移图的时候，只要有101的序列输出就会输出为1<br> <img src="https://images2.imgbox.com/ff/4c/02KeL86k_o.png" alt="在这里插入图片描述"><br> 但是有时会出现如下情况，即输出完101序列后，状态机又回到初始状态重新检测101序列：<br> <img src="https://images2.imgbox.com/96/37/0MPwSrNX_o.png" alt="在这里插入图片描述"><br> 因此状态转移又会发生变化：<br> <img src="https://images2.imgbox.com/02/8c/0I8xdCK9_o.png" alt="在这里插入图片描述"></li></ol> 
<h6><a id="10101__129"></a>二、“10101” 序列检测器</h6> 
<p>分析这个序列的状态转移图时，当状态机的个数，状态转移发生变化时，也会有不同的结果：</p> 
<ol><li>当有五个状态机时，有如下两种状态转移图：</li></ol> 
<p><img src="https://images2.imgbox.com/c7/09/6xeuti8a_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5f/87/ACtU78WN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/22/52/KnrtBpIL_o.png" alt="在这里插入图片描述"><br> 2. 在设计状态机时，应注意合理选择状态机数量，以及状态转移的路径。</p> 
<h6><a id="_137"></a>三、序列检测器设计的思路步骤</h6> 
<p>总统设计思路：<br> 1.列出检测器的逻辑功能<br> 2.画出状态图，注意多余的状态图。<br> 3.设计代码<br> 4.写测试代码<br> 5.时序仿真</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d3140d4d50b73fd118504cf1c34b192e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">添加Latex上标一点或者一撇的命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/df93dbdc621bb0ea7189aeaabcfd9d33/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">未给默认值，报错 type check failed for prop “total“. Expected Number with value ‘ ’</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>