<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Setup Factory打包教程整合 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Setup Factory打包教程整合" />
<meta property="og:description" content="一些简单的过程就不详细写了，就写一些可能会遇到的问题。
我使用的是Setup Factory 9.0.3.0 汉化版，资源地址：
https://download.csdn.net/download/woaishapi/7789171
这个是我参考的打包教程：
https://dominick-li.blog.csdn.net/article/details/83149751（不是Java应用打包也可以用的，这里面的1、2、4、6可以参考，3和5我在下面用了别的方法，7写错了我下面会写正确的）
http://t.zoukankan.com/lidabo-p-9809757.html（里面有打包过程、设置安装序列号、“到期”属性等）
1.卸载程序 自带的卸载程序uninstall.exe双击会报错，所以自己写一个卸载程序。
在Setup Factory软件左侧列表中点击【操作】-【关于安装之后】，在【On Post Install】里写入以下代码：
Shell.CreateShortcut(SessionVar.Expand(&#34;%AppFolder%&#34;), SessionVar.Expand(&#34;卸载%ProductName%&#34;), SessionVar.Expand(&#34;%AppFolder%\\uninstall.exe&#34;), SessionVar.Expand(&#34;%AppFolder%\\uninstall.exe \&#34;/U:%AppFolder%\\Uninstall\\uninstall.xml\&#34;&#34;), SessionVar.Expand(&#34;%AppFolder%&#34;), SessionVar.Expand(&#34;%AppFolder%\\uninstall.exe&#34;), 0, SW_SHOWNORMAL, nil, &#34;&#34;); 然后点击【卸载】-【操作】，在【On Post Uninstall】里写入以下代码：
resultF = Folder.DoesExist(SessionVar.Expand(&#34;%AppFolder%&#34;)); if (resultF) then Folder.DeleteTree(SessionVar.Expand(&#34;%AppFolder%&#34;),nil); end 安装发布包后，生成的文件夹中的uninstall.exe还是不起作用的，起作用的是我们上面写的卸载项目名.exe。
2.开机自启动 以下两个方法都自测可用：
1）写入注册表的方式
点击【操作】-【关于安装之后】，在【On Post Install】里写入以下代码：
isExist = Registry.DoesKeyExist(HKEY_LOCAL_MACHINE,&#34;SOFTWARE\\Microsoft\\windows\\CurrentVersion\\Run&#34;); -- An if ... else statement that compares two numbers if (isExist) then -- Do something here Registry.SetValue(HKEY_LOCAL_MACHINE,&#34;SOFTWARE\\Microsoft\\windows\\CurrentVersion\\Run&#34;,&#34;Message&#34;, SessionVar.Expand(&#34;%AppFolder%\\%ProductName%.exe&#34;),REG_SZ); else -- Do something else here Registry." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/44fd795c79f3e46c62c80a9b1347c68b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-28T11:12:27+08:00" />
<meta property="article:modified_time" content="2022-07-28T11:12:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Setup Factory打包教程整合</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>一些简单的过程就不详细写了，就写一些可能会遇到的问题。<br> 我使用的是Setup Factory 9.0.3.0 汉化版，资源地址：<br> <a href="https://download.csdn.net/download/woaishapi/7789171">https://download.csdn.net/download/woaishapi/7789171</a><br> 这个是我参考的打包教程：<br> <a href="https://dominick-li.blog.csdn.net/article/details/83149751" rel="nofollow">https://dominick-li.blog.csdn.net/article/details/83149751</a>（不是Java应用打包也可以用的，这里面的1、2、4、6可以参考，3和5我在下面用了别的方法，7写错了我下面会写正确的）<br> <a href="http://t.zoukankan.com/lidabo-p-9809757.html" rel="nofollow">http://t.zoukankan.com/lidabo-p-9809757.html</a>（里面有打包过程、设置安装序列号、“到期”属性等）</p> 
<h3><a id="1_7"></a>1.卸载程序</h3> 
<p>自带的卸载程序uninstall.exe双击会报错，所以自己写一个卸载程序。<br> 在Setup Factory软件左侧列表中点击【操作】-【关于安装之后】，在【On Post Install】里写入以下代码：</p> 
<pre><code class="prism language-lua">Shell<span class="token punctuation">.</span><span class="token function">CreateShortcut</span><span class="token punctuation">(</span>SessionVar<span class="token punctuation">.</span><span class="token function">Expand</span><span class="token punctuation">(</span><span class="token string">"%AppFolder%"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SessionVar<span class="token punctuation">.</span><span class="token function">Expand</span><span class="token punctuation">(</span><span class="token string">"卸载%ProductName%"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SessionVar<span class="token punctuation">.</span><span class="token function">Expand</span><span class="token punctuation">(</span><span class="token string">"%AppFolder%\\uninstall.exe"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SessionVar<span class="token punctuation">.</span><span class="token function">Expand</span><span class="token punctuation">(</span><span class="token string">"%AppFolder%\\uninstall.exe \"/U:%AppFolder%\\Uninstall\\uninstall.xml\""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SessionVar<span class="token punctuation">.</span><span class="token function">Expand</span><span class="token punctuation">(</span><span class="token string">"%AppFolder%"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SessionVar<span class="token punctuation">.</span><span class="token function">Expand</span><span class="token punctuation">(</span><span class="token string">"%AppFolder%\\uninstall.exe"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> SW_SHOWNORMAL<span class="token punctuation">,</span> <span class="token keyword">nil</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>然后点击【卸载】-【操作】，在【On Post Uninstall】里写入以下代码：</p> 
<pre><code class="prism language-lua">resultF <span class="token operator">=</span> Folder<span class="token punctuation">.</span><span class="token function">DoesExist</span><span class="token punctuation">(</span>SessionVar<span class="token punctuation">.</span><span class="token function">Expand</span><span class="token punctuation">(</span><span class="token string">"%AppFolder%"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>resultF<span class="token punctuation">)</span> <span class="token keyword">then</span>
Folder<span class="token punctuation">.</span><span class="token function">DeleteTree</span><span class="token punctuation">(</span>SessionVar<span class="token punctuation">.</span><span class="token function">Expand</span><span class="token punctuation">(</span><span class="token string">"%AppFolder%"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">nil</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
</code></pre> 
<p>安装发布包后，生成的文件夹中的uninstall.exe还是不起作用的，起作用的是我们上面写的卸载项目名.exe。</p> 
<h3><a id="2_22"></a>2.开机自启动</h3> 
<p>以下两个方法都自测可用：</p> 
<p>1）写入注册表的方式<br> 点击【操作】-【关于安装之后】，在【On Post Install】里写入以下代码：</p> 
<pre><code class="prism language-lua">isExist <span class="token operator">=</span> Registry<span class="token punctuation">.</span><span class="token function">DoesKeyExist</span><span class="token punctuation">(</span>HKEY_LOCAL_MACHINE<span class="token punctuation">,</span><span class="token string">"SOFTWARE\\Microsoft\\windows\\CurrentVersion\\Run"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">-- An if ... else statement that compares two numbers </span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>isExist<span class="token punctuation">)</span> <span class="token keyword">then</span> 
<span class="token comment">-- Do something here </span>
Registry<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span>HKEY_LOCAL_MACHINE<span class="token punctuation">,</span><span class="token string">"SOFTWARE\\Microsoft\\windows\\CurrentVersion\\Run"</span><span class="token punctuation">,</span><span class="token string">"Message"</span><span class="token punctuation">,</span> 
SessionVar<span class="token punctuation">.</span><span class="token function">Expand</span><span class="token punctuation">(</span><span class="token string">"%AppFolder%\\%ProductName%.exe"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>REG_SZ<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">else</span> 
<span class="token comment">-- Do something else here </span>
Registry<span class="token punctuation">.</span><span class="token function">CreateKey</span><span class="token punctuation">(</span>HKEY_LOCAL_MACHINE<span class="token punctuation">,</span><span class="token string">"SOFTWARE\\Microsoft\\windows\\CurrentVersion\\Run"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
Registry<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span>HKEY_LOCAL_MACHINE<span class="token punctuation">,</span>REG_SZ<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">end</span> 
</code></pre> 
<p>%ProductName%是要开机自启的应用程序名，如果不是项目名就自己改掉。<br> 卸载的话需要删除注册表，点击【卸载】-【操作】，在【On Post Uninstall】里写入代码，结合上面本身的卸载程序，就变成了：</p> 
<pre><code class="prism language-lua">resultF <span class="token operator">=</span> Folder<span class="token punctuation">.</span><span class="token function">DoesExist</span><span class="token punctuation">(</span>SessionVar<span class="token punctuation">.</span><span class="token function">Expand</span><span class="token punctuation">(</span><span class="token string">"%AppFolder%"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>resultF<span class="token punctuation">)</span> <span class="token keyword">then</span>
Registry<span class="token punctuation">.</span><span class="token function">DeleteValue</span><span class="token punctuation">(</span>HKEY_LOCAL_MACHINE<span class="token punctuation">,</span> <span class="token string">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="token punctuation">,</span> <span class="token string">"Message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Folder<span class="token punctuation">.</span><span class="token function">DeleteTree</span><span class="token punctuation">(</span>SessionVar<span class="token punctuation">.</span><span class="token function">Expand</span><span class="token punctuation">(</span><span class="token string">"%AppFolder%"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">nil</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
</code></pre> 
<p>这个注册表可以在\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run找到。</p> 
<p>2）快捷方式放入开机自启的文件夹中<br> WIN10自测可用，右击exe文件选择【文件属性】，在【快捷方式】-【位置】，勾选【自定义】，并填入C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp。<br> <img src="https://images2.imgbox.com/5b/06/eaU5b4O0_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_54"></a>3.更换安装目录时补全应用名称</h3> 
<p>在安装时选择非默认安装目录时，项目名会丢失，所以需要自己进行一些修改。（也就是开始时说的有点问题的教程）<br> 需要在Setup Factory安装目录下找到文件_SUF70_Global_Functions.lua，用记事本打开并找到g_EditFieldFolderBrowse，把这个函数改为如下图所示：<br> <img src="https://images2.imgbox.com/45/82/lD7BZPjg_o.png" alt="在这里插入图片描述"><br> 代码：</p> 
<pre><code class="prism language-lua"><span class="token comment">-- replace the contents of the edit field with the folder path that was selected</span>
<span class="token comment">-- tbEditProps.Text = strTargetFolder;</span>
strCCCn <span class="token operator">=</span> SessionVar<span class="token punctuation">.</span><span class="token function">Expand</span><span class="token punctuation">(</span><span class="token string">"\\%ProductName%"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
tbEditProps<span class="token punctuation">.</span>Text <span class="token operator">=</span> strTargetFolder<span class="token operator">..</span>strCCCn<span class="token punctuation">;</span>
DlgEditField<span class="token punctuation">.</span><span class="token function">SetProperties</span><span class="token punctuation">(</span>nIDEditField<span class="token punctuation">,</span> tbEditProps<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="4_67"></a>4.安装新版本并卸载前一版本</h3> 
<p><a href="https://blog.csdn.net/hejingdong123/article/details/94440905">https://blog.csdn.net/hejingdong123/article/details/94440905</a>（自动卸载）<br> <a href="https://blog.csdn.net/andr0id/article/details/106861372">https://blog.csdn.net/andr0id/article/details/106861372</a>（需先手动确认卸载）</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/104e28bcdecb2fbeb308e98857959bad/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【百战GAN】StyleGAN人脸属性（表情年龄性别）编辑代码实战</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b108f64602cacb74048031ee30dcf3a6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">numpy和pytorch中的元素拼接操作：stack，concatenat，cat</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>