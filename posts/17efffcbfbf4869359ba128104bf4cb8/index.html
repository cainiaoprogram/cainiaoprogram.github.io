<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>代码随想录day60:贪心算法｜84.柱状图中最大的矩形 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="代码随想录day60:贪心算法｜84.柱状图中最大的矩形" />
<meta property="og:description" content="84. Largest Rectangle in Histogram 进行优化，如果我们想获得left就给他left即可，我们只需要在求宽度的时候用到left,而没必要修改原数组。
所以给栈插入一个虚拟索引-1 思考过程：
left应该为多少呢？
首先确定left是什么？ left是索引，是左边界的柱子
那第一个元素是8的时候，他的面积怎么求的，不就是宽度1 * 高度8.
他的左边界应该是多少呢？
根据公式可得：
width = 1 - left - 1 == 1 ，可知left == -1 ! 害！这不就是索引0的左边吗？索引为-1
相当于给数组第一个元素左侧插入了一个虚拟元素嘛。
func largestRectangleArea(heights []int) int { heights = append(heights, 0) stack := []int{-1} maxArea := 0 for i, h := range heights { for len(stack) &gt; 1 &amp;&amp; h &lt; heights[stack[len(stack)-1]] { height := heights[stack[len(stack)-1]] stack = stack[:len(stack)-1] width := i - stack[len(stack)-1] - 1 maxArea = max(maxArea, height*width) } stack = append(stack, i) } return maxArea } 详解版" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/17efffcbfbf4869359ba128104bf4cb8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-08T01:59:44+08:00" />
<meta property="article:modified_time" content="2024-01-08T01:59:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">代码随想录day60:贪心算法｜84.柱状图中最大的矩形</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="84_Largest_Rectangle_in_Histogram_0"></a>84. Largest Rectangle in Histogram</h4> 
<p><img src="https://images2.imgbox.com/1a/40/3BJlhaar_o.png" alt="在这里插入图片描述"><br> 进行优化，如果我们想获得left就给他left即可，我们只需要在求宽度的时候用到left,而没必要修改原数组。<br> <font color="red">所以给栈插入一个虚拟索引-1 </font></p> 
<p><strong>思考过程</strong>：</p> 
<blockquote> 
 <p><strong>left应该为多少呢？</strong><br> <strong>首先确定left是什么？</strong> left是索引，是左边界的柱子<br> 那第一个元素是8的时候，他的面积怎么求的，不就是宽度1 * 高度8.<br> 他的左边界应该是多少呢？<br> 根据公式可得：<br> <code>width = 1 - left - 1 == 1</code> ，可知<code>left == -1</code> ! 害！<strong>这不就是索引0的左边吗？索引为-1</strong><br> 相当于给数组第一个元素左侧插入了一个虚拟元素嘛。</p> 
</blockquote> 
<pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">largestRectangleArea</span><span class="token punctuation">(</span>heights <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span>
	heights <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>heights<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
	stack <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{<!-- --></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span>
	maxArea <span class="token operator">:=</span> <span class="token number">0</span>
	<span class="token keyword">for</span> i<span class="token punctuation">,</span> h <span class="token operator">:=</span> <span class="token keyword">range</span> heights <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token function">len</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> h <span class="token operator">&lt;</span> heights<span class="token punctuation">[</span>stack<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span> 
			height <span class="token operator">:=</span> heights<span class="token punctuation">[</span>stack<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
			stack <span class="token operator">=</span> stack<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token function">len</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>           
			width <span class="token operator">:=</span> i <span class="token operator">-</span> stack<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span>      
			maxArea <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>maxArea<span class="token punctuation">,</span> height<span class="token operator">*</span>width<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		stack <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>stack<span class="token punctuation">,</span> i<span class="token punctuation">)</span> 
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> maxArea
<span class="token punctuation">}</span>

</code></pre> 
<p>详解版</p> 
<pre><code class="prism language-go"><span class="token comment">// 找每个柱子左右两侧第一个小于该柱子的柱子</span>
<span class="token comment">// 找小的，需要维护一个单调递增栈</span>
<span class="token keyword">func</span> <span class="token function">largestRectangleArea</span><span class="token punctuation">(</span>heights <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 结尾添加最小值0，让heights中最后一个元素可以出栈，计算它的面积！</span>
	<span class="token comment">// 而且他还可以让所有留在栈中的元素都出栈[1,2,2,2,2,3],第一个2可是面积最大值，不能不计算！</span>
	heights <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>heights<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
	stack <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{<!-- --></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token comment">// 防止栈底元素弹出时，找不到左柱子</span>
	maxArea <span class="token operator">:=</span> <span class="token number">0</span>

	<span class="token keyword">for</span> i<span class="token punctuation">,</span> h <span class="token operator">:=</span> <span class="token keyword">range</span> heights <span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 维护递增栈，寻找两侧第一个小的竹子</span>

		<span class="token comment">// 注意栈中第一个元素是-1,不属于heights中，不能进行判断，所以栈长度要&gt;1</span>
		<span class="token keyword">for</span> <span class="token function">len</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> h <span class="token operator">&lt;</span> heights<span class="token punctuation">[</span>stack<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 此时i为右侧第一个小于栈顶的，为右侧柱子</span>
			height <span class="token operator">:=</span> heights<span class="token punctuation">[</span>stack<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">// 栈顶元素高度</span>
			stack <span class="token operator">=</span> stack<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token function">len</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>           <span class="token comment">// 出栈</span>

			<span class="token comment">//计算面积</span>
			left <span class="token operator">:=</span> stack<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment">// 此时栈顶为左侧第一个小于弹出的栈顶的，为左侧柱子</span>
			width <span class="token operator">:=</span> i <span class="token operator">-</span> left <span class="token operator">-</span> <span class="token number">1</span>       <span class="token comment">// 求两个柱子中间的距离，要-1</span>
			maxArea <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>maxArea<span class="token punctuation">,</span> height<span class="token operator">*</span>width<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		stack <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>stack<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token comment">// 当前柱子入栈，记录索引值</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> maxArea
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="Questions_67"></a>Questions</h2> 
<p>问几个问题来检验一下自己的理解吧！</p> 
<h3><a id="1_heights0_70"></a>1. 为什么在heights添加最后一个元素0？</h3> 
<p>不仅可以让最后一个元素出栈，而且可以让所有的元素都可以出栈，可以计算每个元素的高度的面积<br> 当heights=[1,2,2,2,2,2,2,3]中，如果不添加最后一个元素，单调递增，所有元素都不可以出栈！可第一个2是我们要找最大面积哦！</p> 
<h3><a id="2_stack1_74"></a>2. stack栈中为什么要插入一个-1？</h3> 
<p>这是一种优化哦！</p> 
<h3><a id="3_heights_78"></a>3. 栈底元素一定是heights中第一个元素吗？</h3> 
<p>不一定</p> 
<h3><a id="4_1_81"></a>4. 判断栈操作中，为什么要判断栈长度&gt;1而不是栈非空？</h3> 
<h3><a id="5__84"></a>5. 卡哥代码中为什么可以不判断栈是否为空？</h3> 
<p><code>while (heights[i] &lt; heights[st.top()])</code>为什么可以不判断栈是否为空？</p> 
<pre><code class="prism language-cpp"><span class="token comment">// 版本二</span>
<span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token function">largestRectangleArea</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> heights<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        stack<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> st<span class="token punctuation">;</span>
        heights<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>heights<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 数组头部加入元素0</span>
        heights<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 数组尾部加入元素0</span>
        st<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> heights<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> heights<span class="token punctuation">[</span>st<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">int</span> mid <span class="token operator">=</span> st<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                st<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> w <span class="token operator">=</span> i <span class="token operator">-</span> st<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> h <span class="token operator">=</span> heights<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">;</span>
                result <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> w <span class="token operator">*</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            st<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/be24cf056deeafe3c609c39148b1456d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【EAI 005】EmbodiedGPT：通过具身思维链进行视觉语言预训练的具身智能大模型</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a290d7ab970686ee993a3e499394ae7d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">案例104:基于微信小程序的随堂测系统设计与实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>