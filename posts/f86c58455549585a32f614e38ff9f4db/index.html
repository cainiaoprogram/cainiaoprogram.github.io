<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>配置Beyond Compare 4作为git mergetool来解决git merge命令导致的文件冲突 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="配置Beyond Compare 4作为git mergetool来解决git merge命令导致的文件冲突" />
<meta property="og:description" content="文章目录 前言解决方案前提配置 Beyond Compare文件冲突及处理产生冲突解决冲突 工具配置的参数含义git configgit mergetool 思考总结 前言 使用 git merge 命令合并代码的时候可能会产生文件冲突，产生这种冲突的根本原因是文件的同一处同时被多次修改，这种同时修改常体现的不同分支上，当多个分支修改了同一处代码，再合并代码的时候就会产生冲突，因为 git 程序也不知道我们想要保留哪一份修改，这时就需要我们手动修改产生冲突的文件。
当冲突内容很少的时候我们可以打开文本编辑器，找到 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;、=========== 和 &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; 这三行字符包裹的内容就是需要解决冲突的部分，但是当冲突内容特别多时我们还是习惯于通过可视化的工具来处理，Beyond Compare 就是这样一款工具，可以用来比较不同的文本文件、表格文件，还可以比较文件夹内容，之前用着比较习惯，所以在处理 git 冲突的时候也想使用这个工具来做，通过查找技术文档发现了下面的方法。
解决方案 鉴于大家都比较急，查找问题时想要直接找到答案，所以我这里直接说明配置步骤，送给不求甚解的小伙伴，也方便今后我可以直接找到，不过配置之前还是要先看一下前提。
前提 在 Windows 上安装了 git 客户端，可以执行 git 命令（废话！没装 git 怎么产生冲突的）安装了 Beyond Compare 4 这个软件，下载链接很多，自己找一个吧，实在找不到，那就放弃吧（找我要） 配置 首先找到 Beyond Compare 的安装路径，比如我的软件安装路径是 D:\mybc4\BComp.exe，然后在 git 命令行客户端中执行下面命令：
git config --global merge.tool bc4 git config --global mergetool.bc4.cmd &#34;\&#34;D:\\mybc4\\BComp.exe\&#34; \&#34;\$LOCAL\&#34; \&#34;\$REMOTE\&#34; \&#34;\$BASE\&#34; \&#34;\$MERGED\&#34;&#34; git config --global mergetool.bc4.trustExitCode true git config --global mergetool." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f86c58455549585a32f614e38ff9f4db/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-23T00:51:55+08:00" />
<meta property="article:modified_time" content="2020-05-23T00:51:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">配置Beyond Compare 4作为git mergetool来解决git merge命令导致的文件冲突</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">前言</a></li><li><a href="#_8" rel="nofollow">解决方案</a></li><li><ul><li><a href="#_12" rel="nofollow">前提</a></li><li><a href="#_17" rel="nofollow">配置</a></li></ul> 
  </li><li><a href="#Beyond_Compare_29" rel="nofollow">Beyond Compare</a></li><li><a href="#_48" rel="nofollow">文件冲突及处理</a></li><li><ul><li><a href="#_50" rel="nofollow">产生冲突</a></li><li><a href="#_171" rel="nofollow">解决冲突</a></li></ul> 
  </li><li><a href="#_236" rel="nofollow">工具配置的参数含义</a></li><li><ul><li><a href="#git_config_247" rel="nofollow">git config</a></li><li><a href="#git_mergetool_276" rel="nofollow">git mergetool</a></li></ul> 
  </li><li><a href="#_351" rel="nofollow">思考</a></li><li><a href="#_355" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>前言</h2> 
<p>使用 <code>git merge</code> 命令合并代码的时候可能会产生文件冲突，产生这种冲突的根本原因是文件的同一处同时被多次修改，这种同时修改常体现的不同分支上，当多个分支修改了同一处代码，再合并代码的时候就会产生冲突，因为 <code>git</code> 程序也不知道我们想要保留哪一份修改，这时就需要我们手动修改产生冲突的文件。</p> 
<p>当冲突内容很少的时候我们可以打开文本编辑器，找到 <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>、<code>===========</code> 和 <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code> 这三行字符包裹的内容就是需要解决冲突的部分，但是当冲突内容特别多时我们还是习惯于通过可视化的工具来处理，<code>Beyond Compare</code> 就是这样一款工具，可以用来比较不同的文本文件、表格文件，还可以比较文件夹内容，之前用着比较习惯，所以在处理 <code>git</code> 冲突的时候也想使用这个工具来做，通过查找技术文档发现了下面的方法。</p> 
<h2><a id="_8"></a>解决方案</h2> 
<p>鉴于大家都比较急，查找问题时想要直接找到答案，所以我这里直接说明配置步骤，送给不求甚解的小伙伴，也方便今后我可以直接找到，不过配置之前还是要先看一下前提。</p> 
<h3><a id="_12"></a>前提</h3> 
<ul><li>在 Windows 上安装了 <code>git</code> 客户端，可以执行 <code>git</code> 命令（废话！没装 <code>git</code> 怎么产生冲突的）</li><li>安装了 <code>Beyond Compare 4</code> 这个软件，下载链接很多，自己找一个吧，实在找不到，那就放弃吧（找我要）</li></ul> 
<h3><a id="_17"></a>配置</h3> 
<p>首先找到 <code>Beyond Compare</code> 的安装路径，比如我的软件安装路径是 <code>D:\mybc4\BComp.exe</code>，然后在 <code>git</code> 命令行客户端中执行下面命令：</p> 
<pre><code class="prism language-bash"><span class="token function">git</span> config --global merge.tool bc4
<span class="token function">git</span> config --global mergetool.bc4.cmd <span class="token string">"\"D:\\mybc4\\BComp.exe\" \"\<span class="token variable">$LOCAL</span>\" \"\<span class="token variable">$REMOTE</span>\" \"\<span class="token variable">$BASE</span>\" \"\<span class="token variable">$MERGED</span>\""</span>
<span class="token function">git</span> config --global mergetool.bc4.trustExitCode <span class="token boolean">true</span>
<span class="token function">git</span> config --global mergetool.keepBackup <span class="token boolean">false</span>
</code></pre> 
<p>至此，<code>git mergetool</code> 就配置完了，当下次冲突的时候，直接使用 <code>git mergetool</code> 命令就可以调用 <code>Beyond Compare</code> 解决冲突文件了，但是你不好奇，这些设置命令都是什么意思吗？为什么执行完这些命令就能调用 <code>Beyond Compare 4</code> 这个软件了，如果你感兴趣可以接下往下看一看。</p> 
<h2><a id="Beyond_Compare_29"></a>Beyond Compare</h2> 
<p>这是一款强大的比较工具，前面提到它可以比较文本、比较表格、比较文件夹，但是它的能力不仅限于此，它甚至可以比较MP3、比较图片、比较注册表，我们的目的是调用它的比较功能，但是前提是这款软件允许你调用，如果它不给你提供接口，你就是想调用也得绕上八百个圈才可以。</p> 
<p>这一点我们可以查询文档确定，文档是安装软件时自带的，名字为 <code>BCompare.chm</code>，如果找不到，安利你一个叫做 <code>Everything</code> 的软件，装上它以后，电脑中的一切东西都能搜索找到。</p> 
<p>这个文档应该很容易找到的，与软件的可执行文件在同一目录，其实我们使用的比较工具应该是 <code>BCompare.exe</code>，但是为什么在配置 <code>git mergetool</code> 的是后用的是 <code>BComp.exe</code> 呢？这一点文档中有写：</p> 
<blockquote> 
 <p>BCompare.exe: This is the main application. Only one copy will run at a time, regardless of how many windows you have open. If you launch a second copy it will tell the existing copy to start a comparison and exit immediately.<br> BComp.exe: This is a Win32 GUI program. If launched from a version control system, it should work just fine. If launched from a console window, the console (or batch file) will not wait for it.</p> 
</blockquote> 
<p>文档是英文的，但是比较容易理解，总的来说 <code>BCompare.exe</code> 是主程序，<code>BComp.exe</code> 用在版本控制工具中更加优秀，至于文档中提到的主程序只能启动一个副本的说明，我试了一下并不是这样的，但是这不是重点，根据文档建议，我们应该调用 <code>BComp.exe</code> 程序。</p> 
<p>关于调用参数，文档中对于每种形式的比较也给出了说明，我们这里只列举两个文件和四个文件这两种参数，两个文件作为参数时常用来对比，我直接使用主程序对比文件就是这种形式，参数格式为 <code>BCompare.exe "C:\Left File.ext" "C:\Right File.ext"</code>，但是使用时我常把文件直接拖拽到软件上进行比较。四个文件作为参数时常用来处理文件冲突，参数类型为 <code>BCompare.exe C:\Left.ext C:\Right.ext C:\Center.ext C:\Output.ext</code>，参数中文件的名字表明处理时的位置和作用，看下面这个图就明白了。</p> 
<p><img src="https://images2.imgbox.com/4b/9a/vXaD1H4E_o.png" alt="解决文件合并冲突1"></p> 
<p>从红框圈定的位置就可以发现和文件的对应关系了，最下面是最终的输出文件，也是我们可以手动修改的文件。</p> 
<h2><a id="_48"></a>文件冲突及处理</h2> 
<h3><a id="_50"></a>产生冲突</h3> 
<p>先看一下 <code>git</code> 仓库的原始情况</p> 
<pre><code class="prism language-bash">albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev<span class="token punctuation">)</span>
$ <span class="token function">git</span> status
On branch dev
Your branch is up to <span class="token function">date</span> with <span class="token string">'origin/dev'</span><span class="token keyword">.</span>

nothing to commit, working tree clean

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev<span class="token punctuation">)</span>
$ <span class="token function">ls</span>
README.md

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev<span class="token punctuation">)</span>
$ <span class="token function">cat</span> README.md
learn <span class="token function">git</span> branch <span class="token function">command</span>
m2
<span class="token function">test</span> checkout
</code></pre> 
<p>在此基础上新建两个分支 <code>dev1</code> 和 <code>dev2</code></p> 
<pre><code class="prism language-bash">albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev<span class="token punctuation">)</span>
$ <span class="token function">git</span> checkout -b dev1
Switched to a new branch <span class="token string">'dev1'</span>

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token punctuation">)</span>
$ <span class="token function">git</span> checkout -b dev2
Switched to a new branch <span class="token string">'dev2'</span>

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev2<span class="token punctuation">)</span>
$ <span class="token function">git</span> branch <span class="token operator">|</span> <span class="token function">grep</span> dev
  dev
  dev1
* dev2
</code></pre> 
<p>在 <code>dev2</code> 分支上修改 <code>README.md</code> 文件后提交</p> 
<pre><code class="prism language-bash">albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev2<span class="token punctuation">)</span>
$ <span class="token keyword">echo</span> <span class="token string">"this is dev2 test"</span><span class="token operator">&gt;&gt;</span>README.md

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev2<span class="token punctuation">)</span>
$ <span class="token function">git</span> add README.md
warning: LF will be replaced by CRLF <span class="token keyword">in</span> README.md.
The <span class="token function">file</span> will have its original line endings <span class="token keyword">in</span> your working directory

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev2<span class="token punctuation">)</span>
$ <span class="token function">git</span> commit -m<span class="token string">"update readme at dev2"</span>
<span class="token punctuation">[</span>dev2 d8d80b7<span class="token punctuation">]</span> update readme at dev2
 1 <span class="token function">file</span> changed, 1 insertion<span class="token punctuation">(</span>+<span class="token punctuation">)</span>

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev2<span class="token punctuation">)</span>
$ <span class="token function">cat</span> README.md
learn <span class="token function">git</span> branch <span class="token function">command</span>
m2
<span class="token function">test</span> checkout
this is dev2 <span class="token function">test</span>
</code></pre> 
<p>切换回 <code>dev1</code> 分支修改 <code>README.md</code> 文件后提交</p> 
<pre><code class="prism language-bash">albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev2<span class="token punctuation">)</span>
$ <span class="token function">git</span> checkout dev1
Switched to branch <span class="token string">'dev1'</span>

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token punctuation">)</span>
$ <span class="token keyword">echo</span> <span class="token string">"this is dev1 test"</span><span class="token operator">&gt;&gt;</span>README.md

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token punctuation">)</span>
$ <span class="token function">git</span> add README.md
warning: LF will be replaced by CRLF <span class="token keyword">in</span> README.md.
The <span class="token function">file</span> will have its original line endings <span class="token keyword">in</span> your working directory
<span class="token function">git</span> com -
albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token punctuation">)</span>
$ <span class="token function">git</span> commit -m<span class="token string">"update readme at dev1"</span>
<span class="token punctuation">[</span>dev1 3136341<span class="token punctuation">]</span> update readme at dev1
 1 <span class="token function">file</span> changed, 1 insertion<span class="token punctuation">(</span>+<span class="token punctuation">)</span>

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token punctuation">)</span>
$ <span class="token function">cat</span> README.md
learn <span class="token function">git</span> branch <span class="token function">command</span>
m2
<span class="token function">test</span> checkout
this is dev1 <span class="token function">test</span>
</code></pre> 
<p>这时在 <code>dev1</code> 分支上合并 <code>dev2</code> 分支上的修改就会产生冲突</p> 
<pre><code class="prism language-bash">albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token punctuation">)</span>
$ <span class="token function">git</span> merge dev2
Auto-merging README.md
CONFLICT <span class="token punctuation">(</span>content<span class="token punctuation">)</span>: Merge conflict <span class="token keyword">in</span> README.md
Automatic merge failed<span class="token punctuation">;</span> fix conflicts and <span class="token keyword">then</span> commit the result.

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token operator">|</span>MERGING<span class="token punctuation">)</span>
$ <span class="token function">cat</span> README.md
learn <span class="token function">git</span> branch <span class="token function">command</span>
m2
<span class="token function">test</span> checkout
<span class="token operator">&lt;&lt;&lt;</span><span class="token operator">&lt;&lt;&lt;</span><span class="token operator">&lt;</span> HEAD
this is dev1 <span class="token function">test</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
this is dev2 <span class="token function">test</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> dev2

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token operator">|</span>MERGING<span class="token punctuation">)</span>
$ <span class="token function">ls</span>
README.md
</code></pre> 
<p>冲突产生了，文档中同一位置被两个分支修改后合并导致的，内容里出现了 <code>&lt;&lt;&lt;</code>、<code>===</code>、<code>&gt;&gt;&gt;</code>，包裹的内容被分成了两部分，上面一部分是当前分支修改的，下面一部分是从 <code>dev2</code> 分支合并过来的，还要注意虽然产生了产生了冲突，但是目录中并没有产生其他多余的文件。</p> 
<h3><a id="_171"></a>解决冲突</h3> 
<p>这样的冲突比较简单，我们只要使用文本工具删除不想要的内容，保存后 <code>git add README.md</code>，然后再 <code>git commit</code> 就完成了冲突的解决，但是因为配置了 <code>git mergetool</code>，我们可以用它来解决冲突，直接在命令行敲命令 <code>git mergetool</code> 就可以:</p> 
<pre><code class="prism language-bash">albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token operator">|</span>MERGING<span class="token punctuation">)</span>
$ <span class="token function">git</span> mergetool
Merging:
README.md

Normal merge conflict <span class="token keyword">for</span> <span class="token string">'README.md'</span><span class="token keyword">:</span>
  <span class="token punctuation">{<!-- --></span>local<span class="token punctuation">}</span>: modified <span class="token function">file</span>
  <span class="token punctuation">{<!-- --></span>remote<span class="token punctuation">}</span>: modified <span class="token function">file</span>

</code></pre> 
<p>这时光标不会退出，一闪一闪并且打开 <code>BComp.exe</code> 工具，截图如下：</p> 
<p><img src="https://images2.imgbox.com/4f/10/foNXivIS_o.png" alt="解决文件合并冲突2"></p> 
<p>这时如果你打开 <code>git</code> 库所在目录会发现除了 <code>README.md</code> 还多了下面4个文件：</p> 
<pre><code class="prism language-bash">README.md
README_BACKUP_584.md
README_BASE_584.md
README_LOCAL_584.md
README_REMOTE_584.md
</code></pre> 
<p>按照自己的实际情况修改最下面的文件，然后点击箭头所指的保存按钮，关闭 <code>Beyond Compare</code>，查询一下仓库状态</p> 
<pre><code class="prism language-bash">albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token operator">|</span>MERGING<span class="token punctuation">)</span>
$ <span class="token function">git</span> status
On branch dev1
All conflicts fixed but you are still merging.
  <span class="token punctuation">(</span>use <span class="token string">"git commit"</span> to conclude merge<span class="token punctuation">)</span>

Changes to be committed:
        modified:   README.md

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token operator">|</span>MERGING<span class="token punctuation">)</span>
$ <span class="token function">ls</span>
README.md
</code></pre> 
<p>不但冲突文件没有了，还给我们自动执行 <code>git add README.md</code> 命令，我们只需要执行 <code>git commit</code> 就解决完了冲突。</p> 
<pre><code class="prism language-bash">albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token operator">|</span>MERGING<span class="token punctuation">)</span>
$ <span class="token function">git</span> commit
<span class="token punctuation">[</span>dev1 b348ae6<span class="token punctuation">]</span> Merge branch <span class="token string">'dev2'</span> into dev1

albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token punctuation">)</span>
$ <span class="token function">git</span> adog
*   b348ae6 <span class="token punctuation">(</span>HEAD -<span class="token operator">&gt;</span> dev1<span class="token punctuation">)</span> Merge branch <span class="token string">'dev2'</span> into dev1
<span class="token operator">|</span>\
<span class="token operator">|</span> * d8d80b7 <span class="token punctuation">(</span>dev2<span class="token punctuation">)</span> update readme at dev2
* <span class="token operator">|</span> 3136341 update readme at dev1
<span class="token operator">|</span>/
* 5f4181e <span class="token punctuation">(</span>origin/dev, dev<span class="token punctuation">)</span> add comments
</code></pre> 
<h2><a id="_236"></a>工具配置的参数含义</h2> 
<p>回过头来再看看 <code>git mergetool</code> 的4句配置到底有什么用</p> 
<pre><code class="prism language-bash"><span class="token function">git</span> config --global merge.tool bc4
<span class="token function">git</span> config --global mergetool.bc4.cmd <span class="token string">"\"D:\\mybc4\\BComp.exe\" \"\<span class="token variable">$LOCAL</span>\" \"\<span class="token variable">$REMOTE</span>\" \"\<span class="token variable">$BASE</span>\" \"\<span class="token variable">$MERGED</span>\""</span>
<span class="token function">git</span> config --global mergetool.bc4.trustExitCode <span class="token boolean">true</span>
<span class="token function">git</span> config --global mergetool.keepBackup <span class="token boolean">false</span>
</code></pre> 
<h3><a id="git_config_247"></a>git config</h3> 
<p>首先你需要知道 <code>git config</code> 的作用，就是用来配置 <code>git</code> 的，加上了 <code>--global</code> 表示调整全局 <code>git</code> 配置，不加的话就是调整当前库的 <code>git</code> 配置。windows上的全局配置一般在 <code>C:\Users\用户名\.gitconfig</code>，如果你之前用过 <code>git</code>，一般会执行过 <code>git config --global user.name xxx</code> 对吧，这些命令都是来调整 <code>git</code> 配置的，打开这个 <code>.gitconfig</code> 你会看到</p> 
<pre><code class="prism language-.gitconfig">[user]
    name = albert
    email = albert@163.com
[core]
    autocrlf = true
[alias]
    st = status
    adog = "log --all --decorate --oneline --graph"
[merge]
    tool = bc4
[mergetool "bc4"]
    cmd = \"D:\\mybc4\\BComp.exe\" \"$LOCAL\" \"$REMOTE\" \"$BASE\" \"$MERGED\"
    trustExitCode = true
[mergetool]
    keepBackup = false
</code></pre> 
<p>看看最后几行就是我们添加的4项配置，只不过到文件中变成了键值对的形式，经过测试后发现，这些属性最少两级，比如 <code>user.name</code> 、<code>core.autocrlf</code>，最多三级比如 <code>mergetool.bc4.cmd</code>、 <code>mergetool.bc4.trustExitCode</code>，如果级数再多会怎么办，你可以试试 <code>git config --global a.b.c.d.e test</code>，它最终也会被拆成三级如下</p> 
<pre><code>[a "b.c.d"]
    e = test
</code></pre> 
<h3><a id="git_mergetool_276"></a>git mergetool</h3> 
<p>这个需要查一下官方文档了，<code>git mergetool --help</code> 就能打开<a href="https://git-scm.com/docs" rel="nofollow">git官方文档</a>，文档写得真不错，排版格式看着就很舒服。</p> 
<p>文档提到添加 <code>--tool-help</code> 选项可以列举可以的合并工具，展示如下</p> 
<pre><code class="prism language-bash">albert@home-pc MINGW64 /d/gitstart <span class="token punctuation">(</span>dev1<span class="token punctuation">)</span>
$ <span class="token function">git</span> mergetool --tool-help
<span class="token string">'git mergetool --tool=&lt;tool&gt;'</span> may be <span class="token keyword">set</span> to one of the following:
                vimdiff
                vimdiff2
                vimdiff3

        user-defined:
                bc4.cmd <span class="token string">"D:\Program Files\Beyond Compare 4\BComp.exe"</span> <span class="token string">"<span class="token variable">$LOCAL</span>"</span> <span class="token string">"<span class="token variable">$REMOTE</span>"</span> <span class="token string">"<span class="token variable">$BASE</span>"</span> <span class="token string">"<span class="token variable">$MERGED</span>"</span>

The following tools are valid, but not currently available:
                araxis
                <span class="token function">bc</span>
                bc3
                codecompare
                deltawalker
                diffmerge
                diffuse
                ecmerge
                emerge
                examdiff
                guiffy
                gvimdiff
                gvimdiff2
                gvimdiff3
                kdiff3
                meld
                opendiff
                p4merge
                smerge
                tkdiff
                tortoisemerge
                winmerge
                xxdiff

Some of the tools listed above only work <span class="token keyword">in</span> a windowed
environment. If run <span class="token keyword">in</span> a terminal-only session, they will fail.
</code></pre> 
<p>这一查才发现，原来 <code>git mergetool</code> 支持的工具有这么多，不过下面这些我都没安装，用一下上面列举的3个，试试 <code>git mergetool --tool=vimdiff</code>，果然打开了一个界面</p> 
<p><img src="https://images2.imgbox.com/78/3c/dix9K0HJ_o.png" alt="解决文件合并冲突3"></p> 
<p>幸亏不如 <code>Beyond Compare</code> 好用，不然我不是白配置了，不过这些工具确实方便，都不需要配置，只要安装了参数中指定一下就可以用了，比如这个 <code>bc3</code>，我猜它是 <code>Beyond Compare 3</code>，只不过我安装的是 <code>Beyond Compare 4</code> 这个版本。</p> 
<p>这些内置工具使用的前提是已经安装了，并且安装软件的目录放在了环境变量 <code>Path</code> 中，如果没有放在这个变量中需要通过 <code>mergetool.&lt;tool&gt;.path</code> 参数来配置，比如我把 <code>Beyond Compare 3</code> 安装在了 <code>D</code> 盘根目录，就可以设置 <code>git config --global mergetool.bc3.path "D:\\"</code>。</p> 
<p>我们在可用工具中没有找到 <code>Beyond Compare 4</code> 为什么我们可以用呢？因为 <code>git mergetool</code> 命令还支持自定义合并解决冲突的工具，只要指定 <code>mergetool.&lt;tool&gt;.cmd</code> 就可以调用了，就像 <code>git mergetool --tool-help</code> 查询结果中提到的 <code>user-defined: bc4.cmd "D:\Program Files\Beyond Compare 4\BComp.exe" "$LOCAL" "$REMOTE" "$BASE" "$MERGED"</code>，<code>git mergetool</code> 把 <code>bc4</code> 作为了一个等同于内置合并工具的软件。</p> 
<p>再来看看这4句配置的含义：</p> 
<pre><code class="prism language-bash"><span class="token function">git</span> config --global merge.tool bc4
<span class="token function">git</span> config --global mergetool.bc4.cmd <span class="token string">"\"D:\\mybc4\\BComp.exe\" \"\<span class="token variable">$LOCAL</span>\" \"\<span class="token variable">$REMOTE</span>\" \"\<span class="token variable">$BASE</span>\" \"\<span class="token variable">$MERGED</span>\""</span>
<span class="token function">git</span> config --global mergetool.bc4.trustExitCode <span class="token boolean">true</span>
<span class="token function">git</span> config --global mergetool.keepBackup <span class="token boolean">false</span>
</code></pre> 
<p>第一句 <code>git config --global merge.tool bc4</code> 是说把 <code>git mergetool</code> 的默认工具配置成 <code>bc4</code>，如果不指定默认工具在使用时就需要写成 <code>git mergetool --tool=bc4</code> 或者 <code>git mergetool -t bc4</code> 了，可是 <code>bc4</code> 是我们自己起的名字，根本就没有这个名字啊，接着往下看。</p> 
<p>第二句 <code>git config --global mergetool.bc4.cmd "\"D:\\mybc4\\BComp.exe\" \"\$LOCAL\" \"\$REMOTE\" \"\$BASE\" \"\$MERGED\""</code> 指定了工具 <code>bc4</code> 的调用路径和参数，后面的这4个参数都是 <code>git mergetool</code> 命令提供的，依次代表本地修改，被合并分支修改，两端未修改前版本文件，最终合并导出的文本文件。</p> 
<p>第三句 <code>git config --global mergetool.bc4.trustExitCode true</code>， 设置为 <code>true</code> 表示信任软件的返回码，并依据返回码确定合并是否成功，如果设置成 <code>false</code> 就会在合并完成后问你是否解决完冲突，设置成 <code>true</code> 会方便很多。</p> 
<p>第四句 <code>git config --global mergetool.keepBackup false</code>， 是指定在合并完成后删除备份文件 <code>*.orig</code>，这个文件会在调用 <code>git mergetool</code> 是产生 <code>*.orig</code> 备份文件，成功合并后自动删除就可以了。</p> 
<h2><a id="_351"></a>思考</h2> 
<p>至此终于弄明白这个 <code>git mergetool</code> 是怎么工作的了，但是想这样一个问题，这个 <code>&lt;tool&gt;.cmd</code> 一定得调用冲突解决工具吗？如果你从头看到这里应该会明白，这里只是给用户提供了一个调用自定义工具的方式，至于你调用什么它是不关心的，你完全可以在 <code>git mergetool</code> 的时候让电脑关机，这些都是可以的，在你明白了原理以后，一切都变得简单了。</p> 
<h2><a id="_355"></a>总结</h2> 
<ul><li><code>Beyond Compare</code> 是一款强大的比较工具，合理的使用可以有效的提升工作效率</li><li><code>git mergetool</code> 内置了很多可以使用的合并工具，并且支持调用自定义的合并工具</li><li><code>git</code> 的官方文档写得真的挺详细，有时间可以多看一看，你会发现很多有意思的功能</li><li>急于解决问题时可以不求甚解，解决问题后最好可以明白其中的缘由，这其实就是一种进步</li></ul> 
<hr> 
<blockquote> 
 <p>尽管科技很发达，但有些人一旦分开可能真的就是一生不见了</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b5c16a25b3d074230401d2287fc2be2c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用vscode开发ns3项目（代码高亮、自动补全支持）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/85e960cf83e0ce3d32a2ce7bec23f220/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">STM32驱动SPI接口EEPROM，AT25010、AT25020、AT25040</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>