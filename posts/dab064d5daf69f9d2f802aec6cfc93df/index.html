<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>应急响应入门之Linux分析排查 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="应急响应入门之Linux分析排查" />
<meta property="og:description" content="前言： 当企业发生黑客入侵、系统崩溃或其它影响业务正常运行的安全事件时，急需第一时间进行处理，使企业的网络信息系统在最短时间内恢复正常工作，进一步查找入侵来源，还原入侵事故过程，同时给出解决方案与防范措施，为企业挽回或减少经济损失。 针对常见的攻击事件，结合工作中应急响应事件分析和解决的方法，总结了一些 Linux 服务器入侵排查的思路。
01文件分析-敏感文件信息 在linux系统下一切都是文件，其中/tmp是一个特别的临时目录文件。每个用户都可以对它进行读写操作。因此一个普通用户可以对/tmp目录执行读写操作。
查看敏感目录文件，如 tmp目录、可执行程序目录/usr/bin ，/usr/sbin等
1.使用la -alt / 查找tmp目录
【一&gt;所有资源获取&lt;一】 1、200份很多已经买不到的绝版电子书 2、30G安全大厂内部的视频资料 3、100份src文档 4、常见安全面试题 5、ctf大赛经典题目解析 6、全套工具包 7、应急响应笔记
2.使用ls —help 查看帮助信息
3.ls的常用用法： ls 用来显示目录列表
-a 显示所有档案及目录
-l 以长格式显示目录下的内容列表
-t 用文件和目录的更改时间排序
4.进入tmp目录，查找最近新添加的可疑文件。
02文件分分析-敏感文件信息 查看开机启动项内容/etc/init.d/，恶意代码很有可能设置在开机启动的位置。
查看指定目录下文件时间顺序的排序：ls -alt | head -n 10
查看文件时间属性: stat 文件名
使用ls -alh /etc/init.d // 查看开机启动项
进入开机启动项目录，对其进行筛选。
针对可以文件可以使用**stat **进行创建修改时间、访问时间的详细查看，若修改时间距离时间日期接近，有线性关联，说明可以被篡改。
如：stat apache2 查看文件详细信息。
03文件分析-敏感文件信息 主要针对新增文件分析：
查找24h内被修改的文件
find ./ -mtime 0 -name “*.php”
查找72h内新增的文件
find ./ -ctime -2 -name “‘*." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/dab064d5daf69f9d2f802aec6cfc93df/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-20T21:38:22+08:00" />
<meta property="article:modified_time" content="2023-02-20T21:38:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">应急响应入门之Linux分析排查</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>前言：</h3> 
<p>当企业发生黑客入侵、系统崩溃或其它影响业务正常运行的安全事件时，急需第一时间进行处理，使企业的网络信息系统在最短时间内恢复正常工作，进一步查找入侵来源，还原入侵事故过程，同时给出解决方案与防范措施，为企业挽回或减少经济损失。 针对常见的攻击事件，结合工作中应急响应事件分析和解决的方法，总结了一些 <strong>Linux</strong> 服务器入侵排查的思路。</p> 
<h3>01文件分析-敏感文件信息</h3> 
<p>在linux系统下一切都是文件，其中/tmp是一个特别的临时目录文件。每个用户都可以对它进行读写操作。因此一个普通用户可以对/tmp目录执行读写操作。</p> 
<p>查看敏感目录文件，如 tmp目录、可执行程序目录/usr/bin ，/usr/sbin等</p> 
<p>1.使用la -alt / 查找tmp目录</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/1e/86/Fx9if2Bf_o.png"></p> 
<blockquote> 
 <p><strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fshimo.im%2Fdocs%2FC9WxVrD6V3tGcjgQ%2F" rel="nofollow" title="【一&gt;所有资源获取&lt;一】">【一&gt;所有资源获取&lt;一】</a></strong> 1、200份很多已经买不到的绝版电子书 2、30G安全大厂内部的视频资料 3、100份src文档 4、常见安全面试题 5、ctf大赛经典题目解析 6、全套工具包 7、应急响应笔记</p> 
</blockquote> 
<p>2.使用ls —help 查看帮助信息</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/84/88/bKYE2FBN_o.png"></p> 
<p>3.ls的常用用法： ls 用来显示目录列表</p> 
<p>-a 显示所有档案及目录</p> 
<p>-l 以长格式显示目录下的内容列表</p> 
<p>-t 用文件和目录的更改时间排序</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/29/13/Y0E2Fy3Q_o.png"></p> 
<p>4.进入tmp目录，查找最近新添加的可疑文件。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/b7/45/FG05AIiE_o.png"></p> 
<h3>02文件分分析-敏感文件信息</h3> 
<p>查看开机启动项内容/etc/init.d/，恶意代码很有可能设置在开机启动的位置。</p> 
<p>查看指定目录下文件时间顺序的排序：ls -alt | head -n 10</p> 
<p>查看文件时间属性: stat 文件名</p> 
<p>使用ls -alh /etc/init.d // 查看开机启动项</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/5e/c3/Izt2xXER_o.png"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/1a/a0/MRycm8BN_o.png"></p> 
<p>进入开机启动项目录，对其进行筛选。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/34/88/elLKrGC4_o.png"></p> 
<p>针对可以文件可以使用**stat **进行创建修改时间、访问时间的详细查看，若修改时间距离时间日期接近，有线性关联，说明可以被篡改。</p> 
<p>如：stat apache2 查看文件详细信息。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/51/e4/FMNkbmgp_o.png"></p> 
<h3>03文件分析-敏感文件信息</h3> 
<p>主要针对<strong>新增文件</strong>分析：</p> 
<p>查找24h内被修改的文件</p> 
<p>find ./ -mtime 0 -name “*.php”</p> 
<p>查找72h内新增的文件</p> 
<p>find ./ -ctime -2 -name “‘*.php”</p> 
<p>权限查找，在linux系统中，如果具有777权限，那么文件就很可疑。</p> 
<p>find ./ -iname “*.php” -perm 777 其中 -iname忽略大小写，-perm用于设定筛选文件权限</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/61/6e/vLTcxQUE_o.png"></p> 
<p>find ./ -ctime -2 -name “‘*.txt” //查找72h内新增的txt文件。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/e2/86/2OzlZGuC_o.png"></p> 
<p>find ./ -iname “*.php” -perm 777 //查找最近新建的含.php文件的，具有最高权限的文件。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/9c/bd/QrQ5jrpR_o.png"></p> 
<p>新建立一个z.php文件，给予最高权限。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/dc/f5/QU2LyOEc_o.png"></p> 
<p>再次进行筛选。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/d3/b2/IGvlMDwK_o.png"></p> 
<h3>04-网络连接分析</h3> 
<p><strong>在linux中可以使用netstat进行网络连接查看</strong></p> 
<p>netstat -Print network connections，rounting tables，interface statistics，masquerade connections，and multicast memberships</p> 
<p>具体帮助信息查看 man netstat</p> 
<p>常用命令 **netstat -pantl **查看处于tcp网络套接字相关信息</p> 
<p>关闭未知连接使用** kill -9 pid **既可关闭。</p> 
<p>使用：netstat -pantl 查看处于tcp网络套接字相关信息</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/05/7a/DsMZuJRf_o.png"></p> 
<p>ip a 查看网络信息</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/12/72/pgDLTOla_o.png"></p> 
<p>发现可疑进程，使用 kill -9 + pid值，然后关闭进程。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/73/b2/FZmGSpkh_o.png"></p> 
<h3>05-进程分析-进程所对文件</h3> 
<p>使用ps命令，分析进程。根据netstat 定位出pid ，使用ps命令，分析进程</p> 
<p>使用ps aux 查看你所有进程信息</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/b3/c7/4qMAV78O_o.png"></p> 
<p>ps aux | grep “22” 查看最近使用了22端口的进程。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/d0/83/FcFv2N6H_o.png"></p> 
<p>使用pid进行筛选</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/93/36/0I8Og4G7_o.png"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/e8/43/nL8rf9mI_o.png"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/85/46/P3yjkSyy_o.png"></p> 
<p>筛选 pid为647的 进程。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/fb/ed/aWf3AVLG_o.png"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/10/9e/HhfyGCAY_o.png"></p> 
<p>查看端口未22的隐藏进程</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/fe/c3/r8nL4yJR_o.png"></p> 
<h3>06-登录分析-筛选异常登录</h3> 
<p>在Linux做的操作都会被记录到系统日志中，对于登录也可以查看日志信息查看是否有异常登录</p> 
<p>last命令记录着所有用户登录系统的日志，可以用来查找非授权用户的登录事件，而last命令的输出结果来源于**/var/log/wtmp**文件，稍有经验的入侵者都会删掉 /var/log/wtmp以清除自己行踪，但是还是会露出蛛丝马迹在此文件中的</p> 
<p>last -i grep -h 0.0.0.0 查看登录日志，筛选非本地登录</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/53/61/qForBwEX_o.png"></p> 
<p>last -i //查看登录日志，含登录ip地址。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/19/64/d9LeEhYF_o.png"></p> 
<p>last -i grep -v 0.0.0.0 查看登录日志，筛选非本地登录</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/7a/cd/tqsqo55x_o.png"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/ad/2b/0IVh0bgH_o.png"></p> 
<p><strong>常见的用法</strong>： who 查看当前登录用户（tty本地登陆 pts远程登录） w 查看某一时刻用户的行为 uptime 查看有多少用户，以此确定是否存在异常用户 lastb 显示登录失败次数，判断是存在ssh爆破 last 显示用户最近登录信息。 lastlog 登录成功记录</p> 
<h3>总结：</h3> 
<p>本文主要总结了在遇到了Linux系统时，应急响应先从对敏感文件分析、敏感文件信息、网络连接分析、进程分析、异常登录记录进行分析。</p> 
<h3><strong><span style="color:#333333;">网络安全入门学习路线</span></strong></h3> 
<p style="margin-left:.8em;"><span style="color:#333333;">其实入门网络安全要学的东西不算多，也就是网络基础+操作系统+中间件+数据库，四个流程下来就差不多了。</span></p> 
<h3><strong><span style="color:#333333;">1.网络安全法和了解电脑基础</span></strong></h3> 
<p style="margin-left:.8em;"><span style="color:#333333;"><img alt="" src="https://images2.imgbox.com/1b/5e/yoDKbZwK_o.png"> 其中包括操作系统Windows基础和Linux基础，标记语言HTML基础和代码JS基础，以及网络基础、数据库基础和虚拟机使用等...</span></p> 
<p style="margin-left:.8em;"><span style="color:#333333;">别被这些看上去很多的东西给吓到了，其实都是很简单的基础知识，同学们看完基本上都能掌握。计算机专业的同学都应该接触了解过，这部分可以直接略过。没学过的同学也不要慌，可以去B站搜索相关视频，你搜关键词网络安全工程师会出现很多相关的视频教程，我粗略的看了一下，排名第一的视频就讲的很详细。 <img alt="" src="https://images2.imgbox.com/9d/bb/EL8YlDIk_o.png"> 当然你也可以看下面这个视频教程<span style="color:#FF0000;"><span style="color:inherit;">仅展示部分截图</span></span>： <img alt="" src="https://images2.imgbox.com/d6/14/NLJUhK6J_o.png"> 学到http和https抓包后能读懂它在说什么就行。</span></p> 
<h3><strong><span style="color:#333333;">2.网络基础和编程语言</span></strong></h3> 
<p style="margin-left:.8em;"><span style="color:#333333;"><img alt="" src="https://images2.imgbox.com/c2/64/jdFS5vi3_o.png"></span></p> 
<h3><strong><span style="color:#333333;">3.入手Web安全</span></strong></h3> 
<p style="margin-left:.8em;"><span style="color:#333333;">web是对外开放的，自然成了的重点关照对象，有事没事就来入侵一波，<strong>你说不管能行吗！</strong> <img alt="" src="https://images2.imgbox.com/61/e0/xFF2YZ2I_o.png"> 想学好Web安全，咱首先得先弄清web是怎么搭建的，知道它的构造才能精准打击。所以web前端和web后端的知识多少要了解点，然后再学点python，起码得看懂部分代码吧。</span></p> 
<p style="margin-left:.8em;"><span style="color:#333333;">最后网站开发知识多少也要了解点，不过别紧张，只是学习基础知识。</span></p> 
<p style="margin-left:.8em;"><span style="color:#333333;">等你用几周的时间学完这些，基本上算是具备了入门合格渗透工程师的资格，记得上述的重点要重点关注哦！ <img alt="" src="https://images2.imgbox.com/8f/12/06d46fi7_o.png"> 再就是，要正式进入web安全领域，得学会web渗透，OWASP TOP 10等常见Web漏洞原理与利用方式需要掌握，像SQL注入/XSS跨站脚本攻击/Webshell木马编写/命令执行等。</span></p> 
<p style="margin-left:.8em;"><span style="color:#333333;">这个过程并不枯燥，一边打怪刷级一边成长岂不美哉，每个攻击手段都能让你玩得不亦乐乎，而且总有更猥琐的方法等着你去实践。</span></p> 
<p style="margin-left:.8em;"><span style="color:#333333;">学完web渗透还不算完，还得掌握相关系统层面漏洞，像ms17-010永恒之蓝等各种微软ms漏洞，所以要学习后渗透。可能到这里大家已经不知所云了，不过不要紧，等你学会了web渗透再来看会发现很简单。</span></p> 
<p style="margin-left:.8em;"><span style="color:#333333;">其实学会了这几步，你就正式从新手小白晋升为入门学员了，真的不算难，你上你也行。</span></p> 
<h3><strong><span style="color:#333333;">4.安全体系</span></strong></h3> 
<p style="margin-left:.8em;"><span style="color:#333333;"><img alt="" src="https://images2.imgbox.com/60/6e/Flgen05o_o.png"> 不过我们这个水平也就算个渗透测试工程师，也就只能做个基础的安全服务，而这个领域还有很多业务，像攻防演练、等保测评、风险评估等，我们的能力根本不够看。</span></p> 
<p style="margin-left:.8em;"><span style="color:#333333;">所以想要成为一名合格的网络工程师，想要拿到安全公司的offer，还得再掌握更多的网络安全知识，能力再更上一层楼才行。即便以后进入企业，也需要学习很多新知识，不充实自己的技能就会被淘汰。</span></p> 
<p style="margin-left:.8em;"><span style="color:#333333;">从时代发展的角度看，网络安全的知识是学不完的，而且以后要学的会更多，同学们要摆正心态，既然选择入门网络安全，就不能仅仅只是入门程度而已，能力越强机会才越多。</span></p> 
<h2><strong><span style="color:#333333;">尾言</span></strong></h2> 
<p style="margin-left:.8em;"><span style="color:#333333;">因为入门学习阶段知识点比较杂，所以我讲得比较笼统，最后<span style="color:#FF0000;"><strong><span style="color:inherit;">联合CSDN整理了一套【282G】网络安全从入门到精通资料包</span></strong></span>，需要的小伙伴可以点击链接领取哦！ <a href="https://mp.weixin.qq.com/s/BWb9OzaB-gVGVpkm161PMw" rel="nofollow" title="网络安全重磅福利：入门&amp;进阶全套282G学习资源包免费分享！">网络安全重磅福利：入门&amp;进阶全套282G学习资源包免费分享！</a></span></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/667a5a252ed5f3d0ce92272ea31742b3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">图解人工智能知识架构(从系统角度告诉你人工智能到底学些啥)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/76e49bd4fac416caad1c6a15dada35c9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JSP九大内置对象</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>