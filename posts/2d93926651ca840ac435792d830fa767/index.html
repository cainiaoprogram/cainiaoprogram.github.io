<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>调试SAR SENSOR的一些感悟 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="调试SAR SENSOR的一些感悟" />
<meta property="og:description" content="手机工作时是有电磁辐射的https://zhuanlan.zhihu.com/p/353591714，那怎样能降低电磁辐射对人体的伤害呢。
sar sensor能感应到有人在使用手机，从而发消息让modem降低发射功率(从而达到标准)。如果没人在使用手机，手机可以按正常功率工作。sar sensor的工作原理不描述，目前接触到的是艾为的aw9610x系列，sar sensor(可理解为一个接近传感器)一般有现成的驱动，调试也比较简单。
sar sensor默认有一个感应阀值(可软件设置)，超过该值(人接近手机)，或者低于该值(人远离手机)，都会触发sar sensor中断，ap收到该中断后，可以跟sensor sensor进行通信，判定sar sensor当前的状态，可以汇报键值给Android系统。
sar sensor由于碰撞或其他原因，需要校准。可以在插入或者拔出充电器时，执行sensor的校准函数。
framerwork层收到该键值后，可以调用soc提供的at接口来回退Modem功率。如展讯平台
import com.android.unisoc.telephony.RadioInteractor; private static String[] mRep = new String[]{}; private static RadioInteractor radioInteractor; radioInteractor = new RadioInteractor(context); if (radioInteractor != null) { radioInteractor.sendAtCmd(&#34;AT&#43;SPPOWERFB=0&#34;, mRep, 0);//正常功率 radioInteractor.sendAtCmd(&#34;AT&#43;SPPOWERFB=1,0&#34;, mRep, 0);//回退功率 } mtk平台可参考[FAQ24764] AP如何調用AT指令給Modem
或者通过工程模式发送AT指令
1、拨号键盘输入*#*#3646633#*#*进入工模 2、选择Connectivity-&gt;CDS Information-&gt;Radio Information-&gt;SIM1 MAIN/SIM2 SUB AT&#43;ERFIDX=1,0//场景0 回退功率
AT&#43;ERFIDX=1,1//场景1 回退功率
AT&#43;ERFIDX=1,x//场景x 回退功率
AT&#43;ERFIDX=1,-1//正常功率
一般配一个场景就够了，如
AT&#43;ERFIDX=1,0//场景0 回退功率
AT&#43;ERFIDX=1,-1//正常功率
当然，soc厂商回提供回退功率的的方法，如
CS0021-GAK1AC-AND-V1.3EN_Modem_SW_Platform_System_RF_SAR_Tx_backoff_Customization(2G_3G_4G)_Application_Note.pdf 34096_UMS512TSR3595D多场景下功率回退提升指南V1.2.pdf Modem工程师根据文档配置好对应场景的nv，然后驱动/系统工程师调用接口发送at指令就ok了。
有个问题，如果手机休眠了，把手机放口袋里要不要降功率呢，应该是需要的。这时候就需要让sar sensor(sar sensor不能睡眠)中断能唤醒系统了，可根据Linux休眠后开启中断的方法及中断唤醒过程_那颗流星的博客-CSDN博客_android 中断唤醒修改驱动代码。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2d93926651ca840ac435792d830fa767/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-18T15:29:04+08:00" />
<meta property="article:modified_time" content="2022-04-18T15:29:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">调试SAR SENSOR的一些感悟</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>手机工作时是有电磁辐射的<a href="https://zhuanlan.zhihu.com/p/353591714" rel="nofollow" title="https://zhuanlan.zhihu.com/p/353591714">https://zhuanlan.zhihu.com/p/353591714</a>，那怎样能降低电磁辐射对人体的伤害呢。</p> 
<p>sar sensor能感应到有人在使用手机，从而发消息让modem降低发射功率(从而达到标准)。如果没人在使用手机，手机可以按正常功率工作。sar sensor的工作原理不描述，目前接触到的是艾为的aw9610x系列，sar sensor(可理解为一个接近传感器)一般有现成的驱动，调试也比较简单。</p> 
<p>sar sensor默认有一个感应阀值(可软件设置)，超过该值(人接近手机)，或者低于该值(人远离手机)，都会触发sar sensor中断，ap收到该中断后，可以跟sensor sensor进行通信，判定sar sensor当前的状态，可以汇报键值给Android系统。</p> 
<p>sar sensor由于碰撞或其他原因，需要校准。可以在插入或者拔出充电器时，执行sensor的校准函数。</p> 
<p>framerwork层收到该键值后，可以调用soc提供的at接口来回退Modem功率。如展讯平台</p> 
<pre><code class="language-cpp">import com.android.unisoc.telephony.RadioInteractor;
private static String[] mRep = new String[]{};
private static RadioInteractor radioInteractor;
radioInteractor = new RadioInteractor(context);
if (radioInteractor != null) {
	radioInteractor.sendAtCmd("AT+SPPOWERFB=0", mRep, 0);//正常功率
	radioInteractor.sendAtCmd("AT+SPPOWERFB=1,0", mRep, 0);//回退功率
}
</code></pre> 
<p>mtk平台可参考[FAQ24764] AP如何調用AT指令給Modem</p> 
<p>或者通过工程模式发送AT指令</p> 
<pre><code class="language-cpp">1、拨号键盘输入*#*#3646633#*#*进入工模
2、选择Connectivity-&gt;CDS Information-&gt;Radio Information-&gt;SIM1 MAIN/SIM2 SUB</code></pre> 
<p>AT+ERFIDX=1,0//场景0 回退功率<br> AT+ERFIDX=1,1//场景1 回退功率<br> AT+ERFIDX=1,x//场景x 回退功率<br> AT+ERFIDX=1,-1//正常功率</p> 
<p>一般配一个场景就够了，如</p> 
<p>AT+ERFIDX=1,0//场景0 回退功率<br> AT+ERFIDX=1,-1//正常功率</p> 
<p>当然，soc厂商回提供回退功率的的方法，如</p> 
<pre><code class="language-cpp">CS0021-GAK1AC-AND-V1.3EN_Modem_SW_Platform_System_RF_SAR_Tx_backoff_Customization(2G_3G_4G)_Application_Note.pdf

34096_UMS512TSR3595D多场景下功率回退提升指南V1.2.pdf</code></pre> 
<p>Modem工程师根据文档配置好对应场景的nv，然后驱动/系统工程师调用接口发送at指令就ok了。</p> 
<p>有个问题，如果手机休眠了，把手机放口袋里要不要降功率呢，应该是需要的。这时候就需要让sar sensor(sar sensor不能睡眠)中断能唤醒系统了，可根据<a href="https://blog.csdn.net/mike8825/article/details/98473014" title="Linux休眠后开启中断的方法及中断唤醒过程_那颗流星的博客-CSDN博客_android 中断唤醒">Linux休眠后开启中断的方法及中断唤醒过程_那颗流星的博客-CSDN博客_android 中断唤醒</a>修改驱动代码。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/41/de/jDqtnSCw_o.jpg"></p> 
<p style="text-align:center;"> <img alt="" src="https://images2.imgbox.com/ef/54/TpM951Ow_o.jpg"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6325d7b6c7682e2f084c82463555f180/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【文本检测】DB:Real-time Scene Text Detection with Differentiable Binarization</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b2ddb77edf633f4d5cd7ac4be76a381a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Parcel服务报错:regeneratorRuntime is not defined</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>