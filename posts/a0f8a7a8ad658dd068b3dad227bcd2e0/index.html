<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【YOLOv5】 02-标注图片，训练并使用自己的模型 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【YOLOv5】 02-标注图片，训练并使用自己的模型" />
<meta property="og:description" content="在上一篇文章中，我们完成了YOLOv5的安装和测试。如果想检测自定义目标，就需要用到LabelImg来对图片打标签，本篇文章介绍了LabelImg安装与使用，以及如何训练并使用自己的模型。
一、安装LabelImg 输入如下命令进行安装：
pip install labelimg 二、使用LabelImg 输入“labelimg”来打开该软件
软件界面如下：
常用的快捷键有：
点击如下按钮，打开样本所在的文件夹
点击如下按钮来框选目标的范围
框选好后，选择存为YOLO格式（即将标记的信息保存为.txt格式）
点击“Save”来保存标记好后的第一张图（这里是灰色是因为已经保存过了），保存到一个指定的文件夹，之后所有标记好的txt都存储到该文件夹中。
注意：保存的文件名要与原始图片的文件名保持一致。每标记一张图都要记得保存！
点击File-》Change Save Dir ，选择刚才存储txt的那个文件夹
点击“Next Image”来准备标注下一个图片
如果遇到只能框选方形，无法框选矩形的情况，只需按下“ctrl&#43;shift&#43;R”就可以恢复创建矩形box
三、训练模型 首先新建训练集和验证集文件夹，分别命名为“train”和“val”
“train”和“val”文件夹都需包含“images”和“labels”文件夹。其中，“images”文件夹用于存放图片，“labels”文件夹用来存放txt
将刚才标注好的约75%的图片和标签分别放入“train”中的“images”和“labels”，用作训练集
注意：图片和标签必需一一对应
将剩下的放入“val”中的“images”和“labels”，用作验证集
创建一个yaml文件
文件内容如下：
修改“train.py”中的一些参数
运行train.py来训练，可以看到训练的结果存储在“runs\train\exp4\weights”中
四、使用模型 如下图，将detect.py中的“--weights”参数替换为刚训练好的pt文件路径，“--source”改为待检测的图片路径
五、继续训练 如果想在上一次训练的基础上继续训练模型，可以更改“train.py”中的“--weights”参数，改为上一次训练的pt文件" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a0f8a7a8ad658dd068b3dad227bcd2e0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-20T14:50:22+08:00" />
<meta property="article:modified_time" content="2023-04-20T14:50:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【YOLOv5】 02-标注图片，训练并使用自己的模型</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <p style="padding-left:1.4em;"> 在<a class="kdocs-link" style="color:#0A6CFF;" href="https://blog.csdn.net/ChaoChao66666/article/details/129123126?spm=1001.2014.3001.5501" target="_blank" rel="noopener noreferrer">上一篇文章</a>中，我们完成了YOLOv5的安装和测试。如果想检测自定义目标，就需要用到LabelImg来对图片打标签，本篇文章介绍了LabelImg安装与使用，以及如何训练并使用自己的模型。</p> 
 <h2 style="">一、安装LabelImg</h2> 
 <p style="">输入如下命令进行安装：</p> 
 <pre class="kdocs-python"><code class="language-python">pip install labelimg</code></pre> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:774px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:57.105946%;height:0;"> 
    <img src="https://images2.imgbox.com/48/f5/lLGKB48u_o.png" style="margin-left:;display:block;width:774px;margin-top:-57.105946%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <h2 style="">二、使用LabelImg</h2> 
 <p style="">输入“labelimg”来打开该软件</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:297px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:13.131313%;height:0;"> 
    <img src="https://images2.imgbox.com/99/ce/XfRSkbVM_o.png" style="margin-left:;display:block;width:297px;margin-top:-13.131313%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">软件界面如下：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1920px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:54.583332%;height:0;"> 
    <img src="https://images2.imgbox.com/4c/38/TKWN1JJW_o.png" style="margin-left:;display:block;width:1920px;margin-top:-54.583332%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">常用的快捷键有：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:967px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:52.947258%;height:0;"> 
    <img src="https://images2.imgbox.com/fd/fb/A0DKKqMf_o.png" style="margin-left:;display:block;width:967px;margin-top:-52.947258%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">点击如下按钮，打开样本所在的文件夹</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:600px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:88.333336%;height:0;"> 
    <img src="https://images2.imgbox.com/66/ba/v9R78CuL_o.png" style="margin-left:;display:block;width:600px;margin-top:-88.333336%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">点击如下按钮来框选目标的范围</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1125px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:56.711113%;height:0;"> 
    <img src="https://images2.imgbox.com/ed/8e/oBjr0r9G_o.png" style="margin-left:;display:block;width:1125px;margin-top:-56.711113%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">框选好后，选择存为YOLO格式（即将标记的信息保存为.txt格式）</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:452px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:133.18584%;height:0;"> 
    <img src="https://images2.imgbox.com/25/81/B7tdIHAx_o.png" style="margin-left:;display:block;width:452px;margin-top:-133.18584%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">点击“Save”来保存标记好后的第一张图（这里是灰色是因为已经保存过了），保存到一个指定的文件夹，之后所有标记好的txt都存储到该文件夹中。</p> 
 <p style=""><span class="kdocs-color" style="color:#C21C13;">注意：保存的文件名要与原始图片的文件名保持一致。每标记一张图都要记得保存！</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:212px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:95.754715%;height:0;"> 
    <img src="https://images2.imgbox.com/89/1a/KSrdnR1e_o.png" style="margin-left:;display:block;width:212px;margin-top:-95.754715%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">点击File-》Change Save Dir ，选择刚才存储txt的那个文件夹</p> 
 <p style=""></p> 
 <p style="">点击“Next Image”来准备标注下一个图片</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:955px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:66.0733%;height:0;"> 
    <img src="https://images2.imgbox.com/9a/0f/lde3O2Z7_o.png" style="margin-left:;display:block;width:955px;margin-top:-66.0733%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">如果遇到只能框选方形，无法框选矩形的情况，只需按下“ctrl+shift+R”就可以恢复创建矩形box</p> 
 <p style=""></p> 
 <h2 style="">三、训练模型</h2> 
 <p style="">首先新建训练集和验证集文件夹，分别命名为“train”和“val”</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:593px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:42.158516%;height:0;"> 
    <img src="https://images2.imgbox.com/83/d5/BIE6pA7u_o.png" style="margin-left:;display:block;width:593px;margin-top:-42.158516%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">“train”和“val”文件夹都需包含“images”和“labels”文件夹。其中，“images”文件夹用于存放图片，“labels”文件夹用来存放txt</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:494px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:31.983805%;height:0;"> 
    <img src="https://images2.imgbox.com/e3/ee/v7Mvmwcu_o.png" style="margin-left:;display:block;width:494px;margin-top:-31.983805%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">将刚才标注好的约75%的图片和标签分别放入“train”中的“images”和“labels”，用作训练集</p> 
 <p style=""><span class="kdocs-color" style="color:#C21C13;">注意：图片和标签必需一一对应</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1282px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:59.672386%;height:0;"> 
    <img src="https://images2.imgbox.com/d5/ff/rN5WoM1U_o.png" style="margin-left:;display:block;width:1282px;margin-top:-59.672386%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">将剩下的放入“val”中的“images”和“labels”，用作验证集</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1180px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:34.152542%;height:0;"> 
    <img src="https://images2.imgbox.com/3c/cf/7swoFHLV_o.png" style="margin-left:;display:block;width:1180px;margin-top:-34.152542%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">创建一个yaml文件</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:621px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:54.10628%;height:0;"> 
    <img src="https://images2.imgbox.com/28/df/vJXcD12A_o.png" style="margin-left:;display:block;width:621px;margin-top:-54.10628%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">文件内容如下：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:449px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:40.979954%;height:0;"> 
    <img src="https://images2.imgbox.com/2a/c4/ZwpPs4mV_o.png" style="margin-left:;display:block;width:449px;margin-top:-40.979954%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <p style="">修改“train.py”中的一些参数</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1257px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:64.757355%;height:0;"> 
    <img src="https://images2.imgbox.com/37/ba/3tCZ2CQC_o.png" style="margin-left:;display:block;width:1257px;margin-top:-64.757355%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">运行train.py来训练，可以看到训练的结果存储在“runs\train\exp4\weights”中</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1237px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:55.61843%;height:0;"> 
    <img src="https://images2.imgbox.com/2a/e8/T6aSQlx1_o.png" style="margin-left:;display:block;width:1237px;margin-top:-55.61843%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <h2 style="">四、使用模型</h2> 
 <p style="">如下图，将detect.py中的“--weights”参数替换为刚训练好的pt文件路径，“--source”改为待检测的图片路径</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1363px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:34.556126%;height:0;"> 
    <img src="https://images2.imgbox.com/20/83/mICfeltv_o.png" style="margin-left:;display:block;width:1363px;margin-top:-34.556126%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <h2 style="">五、继续训练</h2> 
 <p style="">如果想在上一次训练的基础上继续训练模型，可以更改“train.py”中的“--weights”参数，改为上一次训练的pt文件</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1131px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:31.47657%;height:0;"> 
    <img src="https://images2.imgbox.com/9f/79/UB2GiYy1_o.png" style="margin-left:;display:block;width:1131px;margin-top:-31.47657%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dcfe68d1d1c7a2ce766af72272906b57/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">OpenCV(12): 傅里叶变换以及高通低通滤波器代码复现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7a75aaa08d472efba3b223973a93cbf3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python查看时间序列数据的季节规律matplotlib画时间（10分钟为间隔）序列坐标</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>