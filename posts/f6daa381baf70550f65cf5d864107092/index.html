<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>如何把ResultSet转换成Java对象 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="如何把ResultSet转换成Java对象" />
<meta property="og:description" content="有时候我们不想使用任何框架，但又需要用JDBC实现类似于iBATIS的orm映射功能，把一个ResultSet转换成我们的JavaBeans,我们可以模仿iBATIS的方式自己写一个ResultSetMapper实现类，利用反射原理把ResultSet转换成一个JavaBeans，下面是网上的一个开源实现，主要用到的是 注解和 反射机制，我们先看一下使用效果： package com.heaven.mapper; import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; import java.util.List; public class SampleMain { public static void main(String ...args){ try { ResultSetMapper&lt;SamplePojo&gt; resultSetMapper = new ResultSetMapper&lt;SamplePojo&gt;(); ResultSet resultSet = null; // simple JDBC code to run SQL query and populate resultSet - START Class.forName(&#34;sun.jdbc.odbc.JdbcOdbcDriver&#34;); String database = &#34;jdbc:odbc:AkDb&#34;; Connection connection = DriverManager.getConnection( database ,&#34;&#34;,&#34;&#34;); PreparedStatement statement = connection.prepareStatement(&#34;SELECT * FROM UsersSample&#34;); resultSet = statement." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f6daa381baf70550f65cf5d864107092/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-09-03T11:30:43+08:00" />
<meta property="article:modified_time" content="2014-09-03T11:30:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">如何把ResultSet转换成Java对象</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-family:微软雅黑; font-size:15px; line-height:22px"> 
 <span style="font-size:11pt; line-height:1.5"><span style="white-space:pre"></span>    有时候我们不想使用任何框架，但又需要用</span>JDBC实现类似于iBATIS的orm映射功能，把一个ResultSet转换成我们的JavaBeans,我们可以模仿iBATIS的方式自己写一个ResultSetMapper实现类，利用反射原理把ResultSet转换成一个JavaBeans，下面是网上的一个开源实现，主要用到的是 
 <strong>注解</strong>和 
 <strong>反射</strong>机制，我们先看一下使用效果： 
</div> 
<div style="font-family:微软雅黑; font-size:15px; line-height:22px"> 
 <pre><code class="language-java">package com.heaven.mapper;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;
public class SampleMain {
		public static void main(String ...args){
		try {
			ResultSetMapper&lt;SamplePojo&gt; resultSetMapper = new ResultSetMapper&lt;SamplePojo&gt;();
			ResultSet resultSet = null;
			// simple JDBC code to run SQL query and populate resultSet - START
			Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
			String database = "jdbc:odbc:AkDb"; 
			Connection connection = DriverManager.getConnection( database ,"","");
			PreparedStatement statement = connection.prepareStatement("SELECT * FROM UsersSample");
			resultSet = statement.executeQuery();
			/******************************/
			List&lt;SamplePojo&gt; pojoList = resultSetMapper.mapRersultSetToObject(resultSet, SamplePojo.class);
			/******************************/
			if(pojoList != null){
				for(SamplePojo pojo : pojoList){
					System.out.println(pojo);
				}
			}else{
				System.out.println("ResultSet is empty. Please check if database table is empty");
			}
			connection.close();
		} catch (ClassNotFoundException e) {
			e.printStackTrace();
		} catch (SQLException e) {
			e.printStackTrace();
		}
		
		}
}
</code></pre> 
 <span style="white-space:pre"></span>    如上图所示，把ResultSet转换成我们的JavaPojo对象只需要调用ResultSetMapper的一个方法即可完成，使用起来非常方便。 
</div> 
<div style="font-family:微软雅黑; font-size:15px; line-height:22px"> 
 <span style="white-space:pre"></span>    下面是 
 <span style="font-family:微软雅黑; line-height:22px">ResultSetMapper源代码：</span> 
</div> 
<div style="font-family:微软雅黑; font-size:15px; line-height:22px"> 
 <pre><code class="language-java">package com.heaven.mapper;

import java.lang.reflect.Field;
import java.lang.reflect.InvocationTargetException;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import javax.persistence.Column;
import javax.persistence.Entity;
import org.apache.commons.beanutils.BeanUtils;

public class ResultSetMapper&lt;T&gt; {
	@SuppressWarnings("unchecked")
	public List&lt;T&gt; mapRersultSetToObject(ResultSet rs, Class outputClass) {
		List&lt;T&gt; outputList = null;
		try {
			// make sure resultset is not null
			if (rs != null) {
				// check if outputClass has 'Entity' annotation
				if (outputClass.isAnnotationPresent(Entity.class)) {
					// get the resultset metadata
					ResultSetMetaData rsmd = rs.getMetaData();
					// get all the attributes of outputClass
					Field[] fields = outputClass.getDeclaredFields();
					while (rs.next()) {
						T bean = (T) outputClass.newInstance();
						for (int _iterator = 0; _iterator &lt; rsmd.getColumnCount(); _iterator++) {
							// getting the SQL column name
							String columnName = rsmd.getColumnName(_iterator + 1);
							// reading the value of the SQL column
							Object columnValue = rs.getObject(_iterator + 1);
							// iterating over outputClass attributes to check if
							// any attribute has 'Column' annotation with
							// matching 'name' value
							for (Field field : fields) {
								if (field.isAnnotationPresent(Column.class)) {
									Column column = field.getAnnotation(Column.class);
									if (column.name().equalsIgnoreCase(columnName) &amp;&amp; columnValue != null) {
										BeanUtils.setProperty(bean, field.getName(), columnValue);
										break;
									}
								}
							}
						}
						if (outputList == null) {
							outputList = new ArrayList&lt;T&gt;();
						}
						outputList.add(bean);
					}

				} else {
					// throw some error
				}
			} else {
				return null;
			}
		} catch (IllegalAccessException e) {
			e.printStackTrace();
		} catch (SQLException e) {
			e.printStackTrace();
		} catch (InstantiationException e) {
			e.printStackTrace();
		} catch (InvocationTargetException e) {
			e.printStackTrace();
		}
		return outputList;
	}
}
</code></pre> 
 <span style="white-space:pre"></span>    使用注解的pojo对象： 
</div> 
<div style="font-family:微软雅黑; font-size:15px; line-height:22px"> 
 <pre><code class="language-java">&lt;pre name="code" class="java"&gt;package com.heaven.mapper;
import javax.persistence.Column;
import javax.persistence.Entity;
@Entity
public class SamplePojo {
	@Column(name="User_Id")
	private int id;
	@Column(name="User_Name")
	private String name;
	@Column(name="Address")
	private String address;
	@Column(name="Gender")
	private boolean gender;
	public int getId() {
		return id;
	}
	public void setId(int id) {
		this.id = id;
	}
	public String getName() {
		return name;
	}
	public void setName(String name) {
		this.name = name;
	}
	public String getAddress() {
		return address;
	}
	public void setAddress(String address) {
		this.address = address;
	}
	public boolean isGender() {
		return gender;
	}
	public void setGender(boolean gender) {
		this.gender = gender;
	}
	
	@Override
	public String toString() {
		return 	"id: " + id + "\n" + 
				"name: " + name + "\n"+
				"address: " + address + "\n" +
				"gender: " + (gender ? "Male" : "Female") + "\n\n";
	}
}
</code></pre> 
 <br> 
 <br> 
 <pre></pre> 
 <br> 
 <br> 
 <br> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/63fe2e904ac8762efd46e8341eaa1464/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vertica “ERROR: Too many ROS containers exist”</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5a2b6f508b2f1cae2a39a13167727dd3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">在Linux/Ubuntu下将一个文件从一个文件夹移动到另一个文件夹中</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>