<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ACL与VLAN - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ACL与VLAN" />
<meta property="og:description" content="ACL和VLAN
一.ACL:访问控制列表—---控制列表（策略列表）
二.功能:
定义感兴趣路由（控制层面） 在路由器流量流入或流出的接口上，匹配流量，然后执行设定好的动作 --- permit（允许），deny（拒绝）
定义感兴趣流量（数据层面） ACL的另一个作用就是和其他服务结合使用。ACL只负责抓取流量，动 作由其他服务来执行。
三.思科 --- ACL列表末尾默认包含一条拒绝所有的规则---拒绝所有
华为 --- ACL列表末尾没有包含任何规则---默认所以
ACL列表的分类 基础ACL --- 仅关注数据包中的源IP地址 --- “只关注你是谁” 高级ACL --- 不仅关注数据包中的源IP地址，还关注目标IP地址，以及协议和端口号 --- “不仅关注你是谁，还关注你去哪，干啥” 二层ACL 用户自定义ACL列表
五.
需求一：要求PC1可以访问3.0网段，但是PC2不行。 基础ACL配置的位置原则：因为基础ACL只关注源IP地址，所以，可能会造成误伤，所以，建议基础ACL配置位置越靠近目标越好。 基础ACL配置： 1，创建ACL列表 [r2]acl ? INTEGER&lt;2000-2999&gt; Basic access-list(add to current using rules) --- 基础ACL INTEGER&lt;3000-3999&gt; Advanced access-list(add to current using rules) --- 高级ACL INTEGER&lt;4000-4999&gt; Specify a L2 acl group --- 二层ACL
2，在ACL列表中添加规则 [r2-acl-basic-2000]rule deny source 192.168.1.3 0.0.0.0 --- 通配符 --- 0代表不可变，1代表可变 --- 通配符和反掩码不同，他可以0和1穿插着使用" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2461921c0285c0f3d263cc2ce2249ec1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-12T01:19:21+08:00" />
<meta property="article:modified_time" content="2023-01-12T01:19:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ACL与VLAN</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:.0001pt;text-align:center;"><strong><strong>ACL和VLAN</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>一.</strong></strong><strong><strong>ACL:</strong></strong><strong><strong>访问控制列表</strong></strong><strong><strong>—</strong></strong><strong><strong>---控制列表（策略列表）</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>二.</strong></strong><strong><strong>功能:</strong></strong></p> 
<ol><li><strong><strong>定义感兴趣</strong></strong><strong><span style="color:#ff0000;"><strong>路由</strong></span></strong><strong><strong>（控制层面）</strong></strong></li></ol> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>在路由器流量流入或流出的接口上，匹配流量，然后执行设定好的动作 --- </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>permit（允许），deny（拒绝）</strong></span></strong></p> 
<ol><li><strong><strong>定义感兴趣流量（数据层面）</strong></strong></li></ol> 
<p style="margin-left:.0001pt;text-align:left;"><strong>  </strong><strong><span style="color:#000000;"><strong>ACL的另一个作用就是和其他服务结合使用。ACL只负责抓取流量，动 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>作由其他服务来执行。</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>三.思科 --- ACL列表末尾默认包含一条拒绝所有的规则---拒绝所有</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>华为 --- ACL列表末尾没有包含任何规则---默认所以</strong></span></strong></p> 
<ul><li style="text-align:justify;"><strong><strong>ACL列表的分类</strong></strong></li></ul> 
<p style="margin-left:.0001pt;text-align:left;"><strong>  </strong><strong>  </strong><strong><span style="color:#000000;"><strong>基础ACL --- 仅关注数据包中的源IP地址 --- “只关注你是谁” </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>高级ACL --- 不仅关注数据包中的源IP地址，还关注目标IP地址，以及协议和端口号 --- “不仅关注你是谁，还关注你去哪，干啥” </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>二层ACL </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>用户自定义ACL列表</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>五.</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>  </strong><img alt="" height="280" src="https://images2.imgbox.com/fa/97/salJVDUS_o.png" width="474"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#0000ff;"><strong>需求一</strong></span></strong><strong><span style="color:#000000;"><strong>：要求PC1可以访问3.0网段，但是PC2不行。 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>基础ACL配置的位置原则：因为基础ACL只关注源IP地址，所以，可能会造成误伤，所以，建议基础ACL配置位置越靠近目标越好。 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>基础ACL配置： </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>1，创建ACL列表 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2]acl ? </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>INTEGER&lt;2000-2999&gt; Basic access-list(add to current using rules) --- 基础ACL </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>INTEGER&lt;3000-3999&gt; Advanced access-list(add to current using rules) --- 高级ACL </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>INTEGER&lt;4000-4999&gt; Specify a L2 acl group --- 二层ACL</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong> </strong><strong> </strong><strong><span style="color:#000000;"><strong>2，在ACL列表中添加规则 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2-acl-basic-2000]rule deny source 192.168.1.3 0.0.0.0 --- 通配符 --- 0代表不可变，1代表可变 --- 通配符和反掩码不同，他可以0和1穿插着使用</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2-acl-basic-2000]rule permit source any --- 允许所有 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2]display acl 2000 --- 查看ACL列表 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#ff0000;"><strong>华为的规则默认以5为步调自动添加序号，目的为了方便插入规则</strong></span></strong><strong> </strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2-acl-basic-2000]undo rule 7 --- 删除规则</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#ff0000;"><strong>注意</strong></span></strong><strong><span style="color:#000000;"><strong>：一个接口的一个方向上只能调用一张ACL列表</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>3，在接口上调用ACL列表 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2-GigabitEthernet0/0/1]traffic-filter outbound acl 2000 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#ff0000;"><strong>注意</strong></span></strong><strong><span style="color:#000000;"><strong>：一个接口的一个方向上只能调用一张ACL列表</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#0070c0;"><strong>需求二</strong></span></strong><strong><span style="color:#000000;"><strong>：要求PC1可以ping通PC3，但是不能ping通PC4。 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>高级ACL列表配置位置原则： </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>因为高级ACL列表可以进行精准的匹配，所以，位置应该放在尽可能靠近源的地方，可以</strong></span></strong><strong><span style="background-color:#00ff00;"><span style="color:#000000;"><strong>节约链路资源</strong></span></span></strong><strong><span style="color:#000000;"><strong>。 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r1]acl name xueqiuer 3000 --- 通过重命名的方法来创建高级ACL列表 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r1-acl-adv-xueqiuer] </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r1-acl-adv-xueqiuer]rule deny ip source 192.168.1.2 0.0.0.0 destination 192.168.3.3 0.0.0.0 --- 高级ACL列表规则 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r1-GigabitEthernet0/0/0]traffic-filter inbound acl name xueqiuer --- 通过调用名称来调用列表</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#0070c0;"><strong>需求三</strong></span></strong><strong><span style="color:#000000;"><strong>：要求AR3可以ping通R2，但是不能telnetR2 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r1-acl-adv-xueqiuer]rule deny tcp source +IP(R2所有端口的IP) 0.0.0.0 destination +IP 0.0.0.0 destination-port eq 23 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>六. </strong></strong><strong><span style="color:#000000;"><strong>V --- Virtual --- 虚拟 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>LAN --- 局域网；MAN---城域网；WAN---广域网</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>VLAN --- 虚拟局域网 --- 虚拟广播域 --- 交换机和路由器协同工作后，将原来的一个广播域，逻辑上切分为多个。</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#0070c0;"><strong>VLAN的配置</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>第一步：创建VLAN </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>&lt;Huawei&gt;display vlan --- 查看设备VLAN的配置信息 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>交换机在没有进行配置的时候，默认存在一个VLAN，其VID为1。 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>802.1Q标准对VID （--- VLAN ID --- 用来区分和标定不同的VLAN）进行设定 --- 12位二进制 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>构成的 --- 0 - 4095。因为0和4095这两个数字保留，真实的取值范围1 - 4094 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[Huawei]vlan 2 --- 创建VLAN </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[Huawei-vlan2]q </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[Huawei]vlan batch 4 to 100 --- 批量创建VLAN </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[Huawei]undo vlan batch 4 to 100 --- 批量删除 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>第二步：将接口划入VLAN </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[sw1-GigabitEthernet0/0/1]port link-type access </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[sw1-GigabitEthernet0/0/1]port default vlan 2 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[sw1]port-group group-member GigabitEthernet 0/0/3 GigabitEthernet 0/0/4 ---创建接口组 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[sw1-port-group] </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[sw1-port-group]port link-type access </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[sw1-GigabitEthernet0/0/3]port link-type access </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[sw1-GigabitEthernet0/0/4]port link-type access </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[sw1-port-group]port default vlan 3 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[sw1-GigabitEthernet0/0/3]port default vlan 3 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[sw1-GigabitEthernet0/0/4]port default vlan 3</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>VID配置映射到交换机的接口上，实现VLAN范围的划分 --- 物理VLAN/一层VLAN </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>VID配置映射到数据帧中的MAC地址上，实现VLAN的划分 --- 二层VLAN </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>VID可以配置映射到数据帧中类型字段上，实现VLAN的划分 --- 三层VLAN</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="165" src="https://images2.imgbox.com/b0/4f/7WrIvbzZ_o.png" width="662"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#ff0000;">基于IP地址进行VLAN的划分，基于策略完成VLAN的划分。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>802.1Q帧 --- 在以太网Ⅱ型帧源MAC地址和类型字段之间，增加了4个字节的tag，其中包含12位的VID。 --- Tagged帧 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>电脑只能识别普通的以太网Ⅱ型帧 --- Untagged帧 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>根据以上特性，我们将交换机和电脑之间的链路称为</strong></span></strong><strong><span style="color:#e84c22;"><strong>Access链路</strong></span></strong><strong><span style="color:#000000;"><strong>（交换机侧的接口称为</strong></span></strong><strong><span style="color:#e84c22;"><strong>Access接口</strong></span></strong><strong><span style="color:#000000;"><strong>），这些链路中，只能通过Untagged帧，并且这些帧只能属于某一种特定的VLAN；交换机和交换机之间的链路，我们称为</strong></span></strong><strong><span style="color:#e84c22;"><strong>Trunk干道</strong></span></strong><strong><span style="color:#000000;"><strong>（交换机侧的接口称为</strong></span></strong><strong><span style="color:#e84c22;"><strong>Trunk接口</strong></span></strong><strong><span style="color:#000000;"><strong>），这些链路允许通过tagged帧，并且这些帧可以属于多种VLAN；</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>第三步：</strong></strong><strong><span style="color:#000000;"><strong>：配置Trunk干道</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong>   </strong><strong><span style="color:#000000;"><strong>[名-GigabitEthernet0/0/5]port link-type trunk </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[名-GigabitEthernet0/0/5]port trunk allow-pass vlan 2 to 3 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[名-GigabitEthernet0/0/3]port trunk allow-pass vlan all --- 放通所有VLAN的流量</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>第四步：VLAN间路由 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>1，创建子接口 --- 单臂路由 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r1]interface GigabitEthernet 0/0/0.? </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>&lt;1-4096&gt; GigabitEthernet interface subinterface number </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r1]interface GigabitEthernet 0/0/0.1 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r1-GigabitEthernet0/0/0.1]ip address 192.168.1.254 24 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r1-GigabitEthernet0/0/0.1]dot1q termination vid 2 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r1-GigabitEthernet0/0/0.1]arp broadcast enable </strong></span></strong></p> 
<ul><li style="text-align:left;"><strong><span style="color:#000000;"><strong>NAT --- 网络地址转换在IP地址空间中，A，B，C三类地址中各有一部分地址，他们被称为私有IP地址（私网地址），其余的被称为公有IP地址（公网地址）</strong></span></strong></li></ul> 
<p style="margin-left:.0001pt;text-align:left;"><strong>   </strong><span style="color:#ff0000;">NAT --- 网络地址转换 --- 他的基本任务就是实现私网地址和公网地址之间的一个转换</span></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong>  </strong><strong><span style="color:#000000;"><strong> A：10.0.0.0 - 10.255.255.255 --- 相当于1条A类网段 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>B：172.16.0.0 - 172.31.255.255 --- 相当于16条B类网段 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>C：192.168.0.0 - 192.168.255.255 --- 相当于256条C类网段</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>我们要求这些私网地址可以重复使用，仅需保证私网内部唯一即可，但是，不允许他们在互联网中使用我们一般习惯性的将使用私网IP地址构成的网络称为</strong></span></strong><strong><span style="color:#e84c22;"><strong>私网</strong></span></strong><strong><span style="color:#000000;"><strong>，使用公网IP地址构成的网路称为</strong></span></strong><strong><span style="color:#e84c22;"><strong>公网</strong></span></strong><strong><span style="color:#000000;"><strong>。</strong></span></strong></p> 
<ul><li style="text-align:left;"><strong><strong>NAT的分类</strong></strong></li></ul> 
<ol><li style="text-align:left;"><strong><strong>静态的NAT</strong></strong></li></ol> 
<p style="margin-left:.0001pt;text-align:left;"><strong>  </strong><strong> </strong><strong><span style="color:#000000;"><strong>静态NAT就是通过在边界路由器上维护一张</strong></span></strong><strong><span style="color:#e84c22;"><strong>静态地址映射表</strong></span></strong><strong><span style="color:#000000;"><strong>。静态地址映射表中记录的是私网IP地址和公网IP地址之间一一对应的关系。 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2-GigabitEthernet0/0/2]nat static global </strong></span></strong><strong><span style="color:#e84c22;"><strong>12.0.0.3 </strong></span></strong><strong><span style="color:#000000;"><strong>inside 192.168.1.2</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#ff0000;"><strong>12.0.0.3---是公网地址---必须满足两个条件</strong></span></strong><strong><strong>：</strong></strong><strong><strong>a.必须在12.0.0.0/24网段； b.这个IP地址是花钱在运营商处买到的合法的公网地址；</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2]display nat static --- 查看静态地址映射表</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<ol><li style="text-align:left;"><strong><strong>动态的NAT</strong></strong></li></ol> 
<p style="margin-left:.0001pt;text-align:left;"><strong>      </strong><strong><span style="color:#000000;"><strong>动态NAT就是通过在边界路由器上维护一张</strong></span></strong><strong><span style="color:#e84c22;"><strong>动态地址映射表</strong></span></strong><strong><span style="color:#000000;"><strong>。可以实现多对多的NAT转换，但是，在同一时刻，依然是一对一的过程。如果上网需求较大时，需要排对等待；</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong> </strong><strong><span style="color:#ff0000;"><strong> 配置方法</strong></span></strong><strong><span style="color:#000000;"><strong>： </strong></span></strong><strong><span style="color:#000000;"><strong>1，创建公网地址池 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2]nat address-group 0 12.0.0.4 12.0.0.8 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>2，通过ACL列表抓取私网流量 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2-acl-basic-2000]rule permit source 192.168.0.0 0.0.255.255</strong></span></strong></p> 
<ol><li style="text-align:left;"><span style="color:#000000;">在接口上配置动态NAT </span></li></ol> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[r2-GigabitEthernet0/0/2]nat outbound 2000 address-group 0 </span><span style="color:#e84c22;">no-pat </span></p> 
<ol><li style="text-align:left;"><strong><strong>NAPT---网络地址端口转换</strong></strong></li></ol> 
<p style="margin-left:.0001pt;text-align:left;"><strong>        </strong><strong><span style="color:#000000;"><strong>一对多 --- easy ip </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>Easy ip 的配置：</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>1，通过ACL列表抓取私网流量 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2-acl-basic-2000]rule permit source 192.168.0.0 0.0.255.255 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>2，在接口上配置easy ip </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2-GigabitEthernet0/0/2]nat outbound 2000  </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>多对多的配置： </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>1，创建公网地址池 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2]nat address-group 0 12.0.0.4 12.0.0.8 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>2，通过ACL列表抓取私网流量 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2-acl-basic-2000]rule permit source 192.168.0.0 0.0.255.255 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>3，在接口上配置动态NAT </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2-GigabitEthernet0/0/2]nat outbound 2000 address-group 0</strong></span></strong></p> 
<ol><li style="text-align:left;"><strong><strong>端口映射</strong></strong></li></ol> 
<p style="margin-left:.0001pt;text-align:left;"><strong> </strong><strong>    </strong><strong><span style="color:#000000;"><strong>[r2-GigabitEthernet0/0/2]nat server protocol tcp global current-interface 80 inside 192.168.1.10 80 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><span style="color:#000000;"><strong>[r2-GigabitEthernet0/0/2]nat server protocol tcp global current-interface </strong></span></strong><strong><span style="color:#ff0000;"><strong>8080</strong></span></strong><strong><span style="color:#000000;"><strong> inside 192.168.1.20  80 </strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b3dbeb7607382a8b4769de1191cbc592/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SpringMVC和SpringBoot的区别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dd0caab31b29920524af8b2c2221404d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">逆变器并联--下垂控制引入虚拟阻抗</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>