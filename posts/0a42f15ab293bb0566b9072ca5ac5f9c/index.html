<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python项目--餐厅订单数据分析 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python项目--餐厅订单数据分析" />
<meta property="og:description" content="导入包，加载数据 数据是网上获取的，数据见链接: 餐厅订单数据分析的数据.通过分析之后我们要用到以下三个包，分别是numpy、pandas、matplotlib。加载数据我们采用pandas中的read_excel函数，由于该表中有三张小表，我们将这三张表都读取进来。 import numpy as np import pandas as pd import matplotlib.pyplot as plt plt.rcParams[&#39;font.sans-serif&#39;] = &#39;SimHei&#39; # 设置中文显示 data1 = pd.read_excel(&#34;E:\下载\数据分析实战项目资料\餐厅\meal_order_detail.xlsx&#34;, sheet_name=&#39;meal_order_detail1&#39;) data2 = pd.read_excel(&#39;E:\下载\数据分析实战项目资料\餐厅\meal_order_detail.xlsx&#39;, sheet_name=&#39;meal_order_detail2&#39;) data3 = pd.read_excel(&#39;E:\下载\数据分析实战项目资料\餐厅\meal_order_detail.xlsx&#39;, sheet_name=&#39;meal_order_detail3&#39;) 数据预处理 因为三张表不方便操作且有些内容重复，所以使用pandas库中的concat函数将三张表的数据拼接起来，并用dropna方法将空的列给删掉 data = pd.concat([data1, data2, data3], axis=0) # 按照行进行拼接数据 # 查看数据的前五列 print(data.head(5)) data.dropna(axis=1, inplace=True) # 按照列删除na列，并且修改源数据 # 查看数据详情信息，有多少个非空值等 print(data.info()) 分析数据–初步分析 统计卖出菜品的平均价格 print(round(data[&#39;amounts&#39;].mean(), 2)) #方法一：pandas自带函数 print(round(np.mean(data[&#39;amounts&#39;]), 2)) #方法二：numpy函数处理 频数统计，最受欢迎的10个菜，并画出菜品和销量的条形图 dishes_count = data[&#39;dishes_name&#39;].value_counts()[:10] print(dishes_count) dishes_count.plot(kind=&#39;line&#39;, color=[&#39;r&#39;]) dishes_count.plot(kind=&#39;bar&#39;, fontsize=16) for x, y in enumerate(dishes_count): print(x, y) plt." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0a42f15ab293bb0566b9072ca5ac5f9c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-28T18:50:51+08:00" />
<meta property="article:modified_time" content="2022-03-28T18:50:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python项目--餐厅订单数据分析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>导入包，加载数据</h3> 
<ul><li>数据是网上获取的，数据见链接: <a href="https://download.csdn.net/download/weixin_46361294/85048191">餐厅订单数据分析的数据</a>.</li><li>通过分析之后我们要用到以下三个包，分别是<code>numpy</code>、<code>pandas</code>、<code>matplotlib</code>。加载数据我们采用<code>pandas</code>中的<code>read_excel</code>函数，由于该表中有三张小表，我们将这三张表都读取进来。</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'SimHei'</span>  <span class="token comment"># 设置中文显示</span>
data1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"E:\下载\数据分析实战项目资料\餐厅\meal_order_detail.xlsx"</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'meal_order_detail1'</span><span class="token punctuation">)</span>
data2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'E:\下载\数据分析实战项目资料\餐厅\meal_order_detail.xlsx'</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'meal_order_detail2'</span><span class="token punctuation">)</span>
data3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'E:\下载\数据分析实战项目资料\餐厅\meal_order_detail.xlsx'</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'meal_order_detail3'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_12"></a>数据预处理</h3> 
<ul><li>因为三张表不方便操作且有些内容重复，所以使用<code>pandas</code>库中的<code>concat</code>函数将三张表的数据拼接起来，并用<code>dropna</code>方法将空的列给删掉</li></ul> 
<pre><code class="prism language-python">data <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>data1<span class="token punctuation">,</span> data2<span class="token punctuation">,</span> data3<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 按照行进行拼接数据</span>
<span class="token comment"># 查看数据的前五列</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 按照列删除na列，并且修改源数据</span>
<span class="token comment"># 查看数据详情信息，有多少个非空值等</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_22"></a>分析数据–初步分析</h3> 
<ol><li>统计卖出菜品的平均价格</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'amounts'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#方法一：pandas自带函数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'amounts'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#方法二：numpy函数处理</span>
</code></pre> 
<ol start="2"><li>频数统计，最受欢迎的<code>10</code>个菜，并画出菜品和销量的条形图</li></ol> 
<pre><code class="prism language-python">dishes_count <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'dishes_name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dishes_count<span class="token punctuation">)</span>
dishes_count<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'line'</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
dishes_count<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>dishes_count<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>运行结果如下：<br> <img src="https://images2.imgbox.com/83/88/W4yW3VHU_o.png" alt="在这里插入图片描述"></li></ul> 
<ol start="3"><li>点菜的种类的<code>top10</code>订单</li></ol> 
<pre><code class="prism language-python">data_group <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'order_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>
data_group<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'订单点菜的种类Top10'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'订单ID'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'点菜种类'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="4"><li>订单<code>ID</code>点菜数量<code>Top10</code></li></ol> 
<ul><li>思路：先将<code>id</code>分组，得到数量金额总数，再分组求和，将分组求和得到的结果按降序排序，对<code>top10</code>画条形图。</li></ul> 
<pre><code class="prism language-python">data<span class="token punctuation">[</span><span class="token string">'total_amounts'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'counts'</span><span class="token punctuation">]</span> <span class="token operator">*</span> data<span class="token punctuation">[</span><span class="token string">'amounts'</span><span class="token punctuation">]</span>  <span class="token comment"># 统计单道菜消费总额</span>
dataGroup <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'order_id'</span><span class="token punctuation">,</span> <span class="token string">'counts'</span><span class="token punctuation">,</span> <span class="token string">'amounts'</span><span class="token punctuation">,</span> <span class="token string">'total_amounts'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'order_id'</span><span class="token punctuation">)</span>
Group_sum <span class="token operator">=</span> dataGroup<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 分组求和</span>
sort_counts <span class="token operator">=</span> Group_sum<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'counts'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># 排序</span>
sort_counts<span class="token punctuation">[</span><span class="token string">'counts'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'订单ID'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'点菜数量'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'订单ID点菜数量Top10'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="5"><li>订单消费金额<code>Top10</code></li></ol> 
<pre><code class="prism language-python">sort_total_amounts <span class="token operator">=</span> Group_sum<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'total_amounts'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
sort_total_amounts<span class="token punctuation">[</span><span class="token string">'total_amounts'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'订单ID'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'消费金额'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'消费金额前10'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="6"><li>订单平均消费金额<code>Top10</code></li></ol> 
<pre><code class="prism language-python">Group_sum<span class="token punctuation">[</span><span class="token string">'average'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Group_sum<span class="token punctuation">[</span><span class="token string">'total_amounts'</span><span class="token punctuation">]</span> <span class="token operator">/</span> Group_sum<span class="token punctuation">[</span><span class="token string">'counts'</span><span class="token punctuation">]</span>
sort_average <span class="token operator">=</span> Group_sum<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'average'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
sort_average<span class="token punctuation">[</span><span class="token string">'average'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'订单ID'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'消费单价'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'订单消费单价前10'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="7"><li>订单平均消费金额<code>Top10</code></li></ol> 
<pre><code class="prism language-python">Group_sum<span class="token punctuation">[</span><span class="token string">'average'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Group_sum<span class="token punctuation">[</span><span class="token string">'total_amounts'</span><span class="token punctuation">]</span> <span class="token operator">/</span> Group_sum<span class="token punctuation">[</span><span class="token string">'counts'</span><span class="token punctuation">]</span>
sort_average <span class="token operator">=</span> Group_sum<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'average'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
sort_average<span class="token punctuation">[</span><span class="token string">'average'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'订单ID'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'消费单价'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'订单消费单价前10'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="8"><li>订单消费时间</li></ol> 
<ul><li>思路：在订单下单时间中取出小时画图</li></ul> 
<pre><code class="prism language-python">data<span class="token punctuation">[</span><span class="token string">'hourcount'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># 新列，用作计数器</span>
data<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'place_order_time'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 将时间转换成日期类型存储</span>
data<span class="token punctuation">[</span><span class="token string">'hour'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>hour<span class="token punctuation">)</span>
gp_by_hour <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'hour'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'hourcount'</span><span class="token punctuation">]</span>
gp_by_hour<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'小时'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'点菜数量'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'点菜数与小时的关系图'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="9"><li>每天订餐数量</li></ol> 
<pre><code class="prism language-python">data<span class="token punctuation">[</span><span class="token string">'daycount'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
data<span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>day<span class="token punctuation">)</span>  <span class="token comment"># 解析出天</span>
gp_by_day <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'day'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'daycount'</span><span class="token punctuation">]</span>
gp_by_day<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'8月份日期'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'点菜数量'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'点菜数量与日期的关系图'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="10"><li>点菜量最大的前5天</li></ol> 
<pre><code class="prism language-python">gp_by_day<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'点菜量Top5'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'点菜数量'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'点菜数量与日期Top5'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="11"><li>查看本月周几点餐人数最多</li></ol> 
<pre><code class="prism language-python">data<span class="token punctuation">[</span><span class="token string">'weekcount'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
data<span class="token punctuation">[</span><span class="token string">'weekday'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>weekday<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
gp_by_weekday <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'weekday'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'weekcount'</span><span class="token punctuation">]</span>
gp_by_weekday<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'星期'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'点菜数量'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'点菜数量与星期关系图'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="12"><li>查看本月周几点餐人数最多</li></ol> 
<pre><code class="prism language-python">data<span class="token punctuation">[</span><span class="token string">'weekcount'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
data<span class="token punctuation">[</span><span class="token string">'weekday'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>weekday<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
gp_by_weekday <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'weekday'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'weekcount'</span><span class="token punctuation">]</span>
gp_by_weekday<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'星期'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'点菜数量'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'点菜数量与星期关系图'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_148"></a>进一步分析</h3> 
<ol><li>计算每日销售额，绘制折线图分析<code>8</code>月餐饮销售额趋势</li></ol> 
<pre><code class="prism language-python"><span class="token comment"># 计算销售额</span>
data<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'counts'</span><span class="token punctuation">]</span> <span class="token operator">*</span> data<span class="token punctuation">[</span><span class="token string">'amounts'</span><span class="token punctuation">]</span>
<span class="token comment"># 将订餐日期与星期相对应</span>
week <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'place_order_time'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
data<span class="token punctuation">[</span><span class="token string">'weekday'</span><span class="token punctuation">]</span> <span class="token operator">=</span> week<span class="token punctuation">.</span>day_name<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 将订餐日期与月份天数相对应</span>
data<span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'place_order_time'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>day
data_gb <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'day'</span><span class="token punctuation">)</span>
<span class="token comment"># number .agg聚合日期和价格</span>
number <span class="token operator">=</span> data_gb<span class="token punctuation">.</span>agg<span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>
<span class="token comment"># 绘制折线图</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> number<span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'D'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> number<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'8月餐饮销售额趋势示意图'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'日期'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'销售额'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>运行结果如下：<br> <img src="https://images2.imgbox.com/50/62/K3KnsJIc_o.png" alt="在这里插入图片描述"></li><li>分析：明显可以看出销售额有四个顶峰，说明这四个顶峰的两天可能是周末，也符合现状，在周末的销售额会更高。</li></ul> 
<ol start="2"><li>更近一步分析这四个两天的时间段是不是周末。</li></ol> 
<pre><code class="prism language-python"><span class="token comment"># 计算星期一至星期日的销售额并绘制柱状图分析星期与销售额的情况。</span>
data_gb <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'weekday'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'weekday'</span><span class="token punctuation">)</span>
<span class="token comment"># number .agg聚合星期和价格</span>
outcome <span class="token operator">=</span> data_gb<span class="token punctuation">.</span>agg<span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>outcome<span class="token punctuation">)</span>
<span class="token comment"># 对星期进行排序操作</span>
sort <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Monday'</span><span class="token punctuation">,</span> <span class="token string">'Tuesday'</span><span class="token punctuation">,</span> <span class="token string">'Wednesday'</span><span class="token punctuation">,</span> <span class="token string">'Thursday'</span><span class="token punctuation">,</span> <span class="token string">'Friday'</span><span class="token punctuation">,</span> <span class="token string">'Saturday'</span><span class="token punctuation">,</span> <span class="token string">'Sunday'</span><span class="token punctuation">]</span>
outcome2 <span class="token operator">=</span> outcome<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>sort<span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>outcome2<span class="token punctuation">)</span>
<span class="token comment"># 绘制柱状图</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>outcome2<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> outcome2<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>outcome2<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> outcome2<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'星期与销售额的数量情况'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>outcome2<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> outcome2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token string">'%i'</span> <span class="token operator">%</span> j<span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">'bottom'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>运行结果如下：<img src="https://images2.imgbox.com/f4/1f/8wvV5bbj_o.png" alt="在这里插入图片描述"></li><li>分析：如图所示，销售额最好的那两天一定是周末</li></ul> 
<ol start="3"><li>绘制圆环图分析星期与销售额占比情况</li></ol> 
<pre><code class="prism language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'Solarize_Light2'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>outcome2<span class="token punctuation">,</span> labels<span class="token operator">=</span>outcome2<span class="token punctuation">.</span>index<span class="token punctuation">,</span> autopct<span class="token operator">=</span><span class="token string">'%.2f %%'</span><span class="token punctuation">,</span> wedgeprops<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'星期销售额占比情况'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>运行结果如下：<img src="https://images2.imgbox.com/06/f5/GuZeov11_o.png" alt="在这里插入图片描述"></li><li>分析：周六和周天的销售额总和占整个月的六成，由此我们可以看出餐厅的盈利基本上是靠周末。</li></ul> 
<ol start="4"><li>绘制气泡图查看时间，订单量，销售额的关系</li></ol> 
<pre><code class="prism language-python">data_gb <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'order_id'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">,</span> <span class="token string">'day'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'day'</span><span class="token punctuation">)</span>
<span class="token comment"># 定义sort函数，去除表格中的的重复数字，并进行排序。</span>
<span class="token keyword">def</span> <span class="token function">sort</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>

outcome3 <span class="token operator">=</span> data_gb<span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'price'</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">,</span> <span class="token string">'order_id'</span><span class="token punctuation">:</span> sort<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>outcome3<span class="token punctuation">)</span>

<span class="token comment"># 绘制气泡图</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> outcome3<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>outcome3<span class="token punctuation">[</span><span class="token string">'order_id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'订单量、销售额与时间的关系'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'时间'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'销售额'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>运行结果如下：<img src="https://images2.imgbox.com/88/7e/1Hm4BLLu_o.png" alt="在这里插入图片描述"></li><li>总结：</li></ul> 
<ol><li>餐厅生意最好的时候是每周的周末</li><li>点的最多的菜品是凉拌菠菜、古道小庄、麻辣小龙虾、爆炒鱿鱼和芝士烩波士顿龙虾，说明客户爱吃蔬菜，小龙虾等，可以对这类菜品进行开发，还能利用菜品信息对菜品库存进行调整减少浪费</li><li>消费金额高和频率高的顾客可以定位出来，以优惠券的形式吸引二次消费</li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/81500a9bb3d36b9208d79c8bf9d74a46/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">超微X99 ESXI物理机安装提示No Network Adapters</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/aecc184b15c87d53ec67b6863f4ed30b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">pip install git(pip直接安装git上的项目)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>