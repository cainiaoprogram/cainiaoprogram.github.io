<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一、MongoDB安装与基本操作 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="一、MongoDB安装与基本操作" />
<meta property="og:description" content="MongoDB安装与基本操作 1、linux安装MongoDB2、MongoDB-连接3、Mongo shell使用mongo shell常用命令 4、安全认证5、MongoDB工具 1、linux安装MongoDB 环境准备：
linux系统： centos7安装MongoDB社区版 下载MongoDB Community Server
MongoDB社区版下载地址
下载MongoDB wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-4.4.19.tgz tar -zxvf mongodb-linux-x86_64-rhel70-4.4.19.tgz 启动MongoDB Server
#创建dbpath和logpath
mkdir -p /mongodb/data /mongodb/log #进入mongodb目录，启动mongodb服务 bin/mongod --port=27017 --dbpath=/mongodb/data --logpath=/mongodb/log/mongodb.log \ --bind_ip=0.0.0.0 --fork –dbpath :指定数据文件存放目录
–logpath :指定日志文件，注意是指定文件不是目录
–logappend :使用追加的方式记录日志
–port:指定端口，默认为27017
–bind_ip:默认只监听localhost网卡
–fork: 后台启动
–auth: 开启认证模式
添加环境变量
#修改/etc/profile，添加环境变量,方便执行MongoDB命令 export MONGODB_HOME=/usr/local/soft/mongodb PATH=$PATH:$MONGODB_HOME/bin #重新加载环境变量 source /etc/profile 利用配置文件启动服务
编辑MONGODB_HOME/conf/mongo.conf文件
systemLog: destination: file path: /mongodb/log/mongod.log # log path logAppend: true storage: dbPath: /mongodb/data # data directory engine: wiredTiger #存储引擎 journal: #是否启用journal日志 enabled: true net: bindIp: 0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2fd0597a19fb7e5e401345adcf2af989/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-07T19:03:25+08:00" />
<meta property="article:modified_time" content="2023-03-07T19:03:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一、MongoDB安装与基本操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>MongoDB安装与基本操作</h4> 
 <ul><li><a href="#1linuxMongoDB_2" rel="nofollow">1、linux安装MongoDB</a></li><li><a href="#2MongoDB_91" rel="nofollow">2、MongoDB-连接</a></li><li><a href="#3Mongo_shell_184" rel="nofollow">3、Mongo shell使用</a></li><li><ul><li><a href="#mongo_shell_207" rel="nofollow">mongo shell常用命令</a></li></ul> 
  </li><li><a href="#4_260" rel="nofollow">4、安全认证</a></li><li><a href="#5MongoDB_353" rel="nofollow">5、MongoDB工具</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1linuxMongoDB_2"></a>1、linux安装MongoDB</h2> 
<p><strong>环境准备：</strong></p> 
<ul><li>linux系统： centos7</li><li>安装MongoDB社区版</li></ul> 
<p><strong>下载MongoDB Community Server</strong></p> 
<p><a href="https://www.mongodb.com/try/download/community" rel="nofollow">MongoDB社区版下载地址</a><br> <img src="https://images2.imgbox.com/02/8f/ti2FkM3v_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell">下载MongoDB
<span class="token function">wget</span> https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-4.4.19.tgz

<span class="token function">tar</span> -zxvf mongodb-linux-x86_64-rhel70-4.4.19.tgz
</code></pre> 
<p><strong>启动MongoDB Server</strong></p> 
<p>#创建dbpath和logpath</p> 
<pre><code class="prism language-shell"><span class="token function">mkdir</span> -p /mongodb/data /mongodb/log  
<span class="token comment">#进入mongodb目录，启动mongodb服务</span>
bin/mongod --port<span class="token operator">=</span><span class="token number">27017</span> --dbpath<span class="token operator">=</span>/mongodb/data --logpath<span class="token operator">=</span>/mongodb/log/mongodb.log <span class="token punctuation">\</span>
--bind_ip<span class="token operator">=</span><span class="token number">0.0</span>.0.0 --fork

</code></pre> 
<p>–dbpath :指定数据文件存放目录<br> –logpath :指定日志文件，注意是指定文件不是目录<br> –logappend :使用追加的方式记录日志<br> –port:指定端口，默认为27017<br> –bind_ip:默认只监听localhost网卡<br> –fork: 后台启动<br> –auth: 开启认证模式</p> 
<p><strong>添加环境变量</strong></p> 
<pre><code class="prism language-shell"><span class="token comment">#修改/etc/profile，添加环境变量,方便执行MongoDB命令</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">MONGODB_HOME</span><span class="token operator">=</span>/usr/local/soft/mongodb
<span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$MONGODB_HOME</span>/bin
<span class="token comment">#重新加载环境变量</span>
<span class="token builtin class-name">source</span> /etc/profile
</code></pre> 
<p><strong>利用配置文件启动服务</strong><br> 编辑MONGODB_HOME/conf/mongo.conf文件</p> 
<pre><code class="prism language-yml"><span class="token key atrule">systemLog</span><span class="token punctuation">:</span>
  <span class="token key atrule">destination</span><span class="token punctuation">:</span> file
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /mongodb/log/mongod.log <span class="token comment"># log path</span>
  <span class="token key atrule">logAppend</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">storage</span><span class="token punctuation">:</span>
  <span class="token key atrule">dbPath</span><span class="token punctuation">:</span> /mongodb/data <span class="token comment"># data directory</span>
  <span class="token key atrule">engine</span><span class="token punctuation">:</span> wiredTiger  <span class="token comment">#存储引擎</span>
  <span class="token key atrule">journal</span><span class="token punctuation">:</span>            <span class="token comment">#是否启用journal日志</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">net</span><span class="token punctuation">:</span>
  <span class="token key atrule">bindIp</span><span class="token punctuation">:</span> 0.0.0.0
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">27017</span> <span class="token comment"># port</span>
<span class="token key atrule">processManagement</span><span class="token punctuation">:</span>
  <span class="token key atrule">fork</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre> 
<p><strong>注意：一定要yaml格式</strong></p> 
<pre><code class="prism language-shell"><span class="token comment">#启动mongodb</span>
mongod -f /mongodb/conf/mongo.conf
<span class="token comment"># -f 选项表示将使用配置文件启动mongodb</span>


<span class="token comment">##关闭mongodb服务</span>

<span class="token comment">#方式一</span>
mongod --port<span class="token operator">=</span><span class="token number">27017</span> --dbpath<span class="token operator">=</span>/mongodb/data --shutdown
<span class="token comment">#方式二：进入mongo shell</span>

use admin
db.shutdownServer<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h2><a id="2MongoDB_91"></a>2、MongoDB-连接</h2> 
<p><strong>MongoDB shell 来连接 MongoDB 服务器</strong><br> <em>标准URI连接语法</em></p> 
<pre><code class="prism language-powershell">mongodb:<span class="token operator">/</span><span class="token operator">/</span><span class="token namespace">[username:password@]</span>host1<span class="token punctuation">[</span>:port1<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span>host2<span class="token punctuation">[</span>:port2<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token punctuation">,</span>hostN<span class="token punctuation">[</span>:portN<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">/</span><span class="token namespace">[database]</span><span class="token punctuation">[</span>?options<span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<ul><li>mongodb:// 这是固定的格式，必须要指定</li><li>username:password@ 可选项，如果设置，在连接数据库服务器之后，驱动都会尝试登录这个数据库</li><li>host1 必须的指定至少一个host, host1 是这个URI唯一要填写的。它指定了要连接服务器的地址。如果要连接复制集，请指定多个主机地址。</li><li>portX 可选的指定端口，如果不填，默认为27017</li><li>/database 如果指定username:password@，连接并验证登录指定数据库。若不指定，默认打开 test 数据库。</li><li>?options 是连接选项。如果不使用/database，则前面需要加上/。所有连接选项都是键值对name=value，键值对之间通过&amp;或;（分号）隔开</li></ul> 
<p><strong>options:(标准的连接格式包含了多个选项(options))</strong></p> 
<table><thead><tr><th align="left">选项</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left">replicaSet=name</td><td align="left">验证replicaSet的名称。 Impliesconnect=replicaSet.</td></tr><tr><td align="left">slaveOk=true/false</td><td align="left"><ul><li>true:在connect=direct模式下，驱动会连接第一台机器，即使这台服务器不是主。在connect=replicaSet模式下，驱动会发送所有的写请求到主并且把读取操作分布在其他从服务</li><li> false: 在 connect=direct模式下，驱动会自动找寻主服务器. 在connect=replicaSet 模式下，驱动仅仅连接主服务器，并且所有的读写命令都连接到主服务器</li></ul></td></tr><tr><td align="left">safe=true/false</td><td align="left"><ul><li>true: 在执行更新操作之后，驱动都会发送getLastError命令来确保更新成功。(还要参考 wtimeoutMS)</li><li>false: 在每次更新之后，驱动不会发送getLastError来确保更新成功</li></ul></td></tr><tr><td align="left">w=n</td><td align="left">驱动添加 { w : n } 到getLastError命令. 应用于safe=true</td></tr><tr><td align="left">wtimeoutMS=ms</td><td align="left">驱动添加 { wtimeout : ms } 到 getlasterror 命令. 应用于 safe=true</td></tr><tr><td align="left">fsync=true/false</td><td align="left"><ul><li>true: 驱动添加 { fsync : true } 到 getlasterror 命令.应用于 safe=true.</li><li>false: 驱动不会添加到getLastError命令中</li></ul></td></tr><tr><td align="left">journal=true/false</td><td align="left">如果设置为 true, 同步到 journal (在提交到数据库前写入到实体中). 应用于 safe=true</td></tr><tr><td align="left">connectTimeoutMS=ms</td><td align="left">可以打开连接的时间</td></tr><tr><td align="left">socketTimeoutMS=ms</td><td align="left">发送和接受sockets的时间</td></tr></tbody></table> 
<p><strong>实例</strong></p> 
<p>使用默认端口来连接 MongoDB 的服务</p> 
<pre><code class="prism language-poweshell">mongodb://localhost
</code></pre> 
<p>通过 shell 连接 MongoDB 服务：</p> 
<pre><code class="prism language-poweshell">$ ./mongo
MongoDB shell version: 4.4.18
connecting to: test
... 
</code></pre> 
<p><strong>MongoDB 连接命令格式</strong></p> 
<p>连接本地数据库服务器，端口是默认的:27017</p> 
<pre><code class="prism language-poweshell">mongodb://localhost
</code></pre> 
<p>使用用户名fred，密码foobar登录localhost的admin数据库。</p> 
<pre><code class="prism language-poweshell">mongodb://fred:foobar@localhost
</code></pre> 
<p>使用用户名fred，密码foobar登录localhost的baz数据库。</p> 
<pre><code class="prism language-poweshell">mongodb://fred:foobar@localhost/baz
</code></pre> 
<p>连接 replica pair, 服务器1为example1.com服务器2为example2。</p> 
<pre><code class="prism language-poweshell">mongodb://example1.com:27017,example2.com:27017
</code></pre> 
<p>连接 replica set 三台服务器 (端口 27017, 27018, 和27019):</p> 
<pre><code class="prism language-poweshell">mongodb://localhost,localhost:27018,localhost:27019
</code></pre> 
<p>连接 replica set 三台服务器, 写入操作应用在主服务器 并且分布查询到从服务器。</p> 
<pre><code class="prism language-poweshell">mongodb://host1,host2,host3/?slaveOk=true
</code></pre> 
<p>直接连接第一个服务器，无论是replica set一部分或者主服务器或者从服务器</p> 
<pre><code class="prism language-poweshell">mongodb://host1,host2,host3/?connect=direct;slaveOk=true
</code></pre> 
<p><strong>当你的连接服务器有优先级，还需要列出所有服务器，你可以使用上述连接方式。</strong></p> 
<p>安全模式连接到localhost:</p> 
<pre><code class="prism language-poweshell">mongodb://localhost/?safe=true
</code></pre> 
<p>以安全模式连接到replica set，并且等待至少两个复制服务器成功写入，超时时间设置为2秒。</p> 
<pre><code class="prism language-poweshell">mongodb://host1,host2,host3/?safe=true;w=2;wtimeoutMS=2000
</code></pre> 
<h2><a id="3Mongo_shell_184"></a>3、Mongo shell使用</h2> 
<p><strong>mongo是MongoDB的交互式JavaScript Shell界面，它为系统管理员提供了强大的界面，并为开发人员提供了直接测试数据库查询和操作的方法</strong></p> 
<pre><code class="prism language-powershell">bin/mongo <span class="token operator">--</span>port=27017 
bin/mongo localhost:27017
mongodb:<span class="token operator">/</span><span class="token operator">/</span>xxx:xxx@192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>229<span class="token punctuation">.</span>106:27017/
</code></pre> 
<pre><code>--port:指定端口，默认为27017
--host:连接的主机地址，默认127.0.0.1
</code></pre> 
<p><strong>JavaScript支持</strong></p> 
<p>mongo shell是基于JavaScript语法的，MongoDB使用了SpiderMonkey作为其内部的JavaScript解释器引擎，这是由Mozilla官方提供的JavaScript内核解释器，该解释器也被同样用于大名鼎鼎的Firefox浏览器产品之中。SpiderMonkey对ECMA Script标准兼容性非常好，可以支持ECMA Script 6。可以通过下面的命令检查JavaScript解释器的版本：</p> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@weljy conf]</span><span class="token comment"># mongo --port=27017</span>
MongoDB shell version v4<span class="token punctuation">.</span>4<span class="token punctuation">.</span>9
connecting to: mongodb:<span class="token operator">/</span><span class="token operator">/</span>127<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>1:27017/?compressors=disabled&amp;gssapiServiceName=mongodb
Implicit session: session <span class="token punctuation">{<!-- --></span> <span class="token string">"id"</span> : UUID<span class="token punctuation">(</span><span class="token string">"8831aba3-d347-4478-b88a-d21c749fa869"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
MongoDB server version: 4<span class="token punctuation">.</span>4<span class="token punctuation">.</span>9
&gt; interpreterVersion<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
MozJS-60
</code></pre> 
<h3><a id="mongo_shell_207"></a>mongo shell常用命令</h3> 
<table><thead><tr><th align="left">命令</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">show dbs | show databases</td><td align="left">显示数据库列表</td></tr><tr><td align="left">use 数据库表名</td><td align="left">切换数据库，如果不存在创建数据库，刚创建的数据库要想show dbs看到，必须先要插入一些数据</td></tr><tr><td align="left">db.dropDatabase()</td><td align="left">删除数据库</td></tr><tr><td align="left">show collections | show tables</td><td align="left">显示当前数据库的集合</td></tr><tr><td align="left">db.集合名.stats()</td><td align="left">查看集合详情</td></tr><tr><td align="left">db.集合.drop()</td><td align="left">删除集合</td></tr><tr><td align="left">show users</td><td align="left">显示当前数据库的用户列表</td></tr><tr><td align="left">show roles</td><td align="left">显示当前数据库的角色列表</td></tr><tr><td align="left">show profile</td><td align="left">显示最近发生的操作</td></tr><tr><td align="left">load(“xxx.js”)</td><td align="left">执行一个js脚本文件</td></tr><tr><td align="left">exit | quit()</td><td align="left">退出当前shell</td></tr><tr><td align="left">help</td><td align="left">查看mongodb支持哪些命令</td></tr><tr><td align="left">db.help()</td><td align="left">查看当前数据库支持的方法</td></tr><tr><td align="left">db.集合名.help()</td><td align="left">显示集合的帮助信息</td></tr><tr><td align="left">db.version()</td><td align="left">查看数据库版本</td></tr></tbody></table> 
<p><strong>数据操作</strong></p> 
<pre><code class="prism language-powershell"><span class="token comment">#查看所有库</span>
show dbs
<span class="token comment"># 切换到指定数据库，不存在则创建</span>
use test
<span class="token comment"># 删除当前数据库  </span>
db<span class="token punctuation">.</span>dropDatabase<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>集合操作</strong></p> 
<pre><code class="prism language-powershell"><span class="token comment">#创建集合语法</span>
db<span class="token punctuation">.</span>createCollection<span class="token punctuation">(</span>name<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
<span class="token comment">#查看集合</span>
show collections
<span class="token comment">#创建集合</span>
db<span class="token punctuation">.</span>createCollection<span class="token punctuation">(</span><span class="token string">"emp"</span><span class="token punctuation">)</span>
<span class="token comment">#删除集合</span>
db<span class="token punctuation">.</span>emp<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><strong>创建集合options</strong></p> 
<table><thead><tr><th align="left">字段</th><th align="left">类型</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left">capped</td><td align="left">bool</td><td align="left">（可选）<mark>如果为true，则创建固定集合。</mark> 固定集合是指有着固定大小的集合，当达到最大值时，它会自动覆盖最早的文档。</td></tr><tr><td align="left">size</td><td align="left">int</td><td align="left">（可选）为固定集合指定一个最大值（以字节计）。如果 capped 为 true，也需要指定该字段。</td></tr><tr><td align="left">max</td><td align="left">int</td><td align="left">（可选）指定固定集合中包含文档的最大数量。</td></tr></tbody></table> 
<p><mark>注意：当集合不存在时，向集合中插入文档也会创建集合</mark></p> 
<h2><a id="4_260"></a>4、安全认证</h2> 
<p><strong>创建管理员账户</strong></p> 
<pre><code class="prism language-powershell"><span class="token comment">#设置管理员用户名与密码需要切换到admin库</span>
use admin
<span class="token comment">#创建管理员</span>
db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>user:<span class="token string">"xxx"</span><span class="token punctuation">,</span><span class="token function">pwd</span>:<span class="token string">"xxx"</span><span class="token punctuation">,</span>roles:<span class="token punctuation">[</span><span class="token string">"root"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># 查看当前数据库所有用户信息 </span>
show users 
<span class="token comment">#显示可设置权限</span>
show roles 
<span class="token comment">#显示所有用户</span>
db<span class="token punctuation">.</span>system<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>常用权限</strong></p> 
<table><thead><tr><th align="left">权限名</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left">read</td><td align="left">允许用户读取指定数据库</td></tr><tr><td align="left">readWrite</td><td align="left">允许用户读写指定数据库</td></tr><tr><td align="left">dbAdmin</td><td align="left">允许用户在指定数据库中执行管理函数，如索引创建、删除，查看统计或访问system.profile</td></tr><tr><td align="left">dbOwner</td><td align="left">允许用户在指定数据库中执行任意操作，增、删、改、查等</td></tr><tr><td align="left">userAdmin</td><td align="left">允许用户向system.users集合写入，可以在指定数据库里创建、删除和管理用户</td></tr><tr><td align="left">clusterAdmin</td><td align="left">只在admin数据库中可用，赋予用户所有分片和复制集相关函数的管理权限</td></tr><tr><td align="left">readAnyDatabase</td><td align="left">只在admin数据库中可用，赋予用户所有数据库的读权限</td></tr><tr><td align="left">readWriteAnyDatabase</td><td align="left">只在admin数据库中可用，赋予用户所有数据库的读写权限</td></tr><tr><td align="left">userAdminAnyDatabase</td><td align="left">只在admin数据库中可用，赋予用户所有数据库的userAdmin权限</td></tr><tr><td align="left">dbAdminAnyDatabase</td><td align="left">只在admin数据库中可用，赋予用户所有数据库的dbAdmin权限</td></tr><tr><td align="left">root</td><td align="left">只在admin数据库中可用。超级账号，超级权限</td></tr></tbody></table> 
<p><strong>重新赋予用户操作权限</strong></p> 
<pre><code class="prism language-powershell">db<span class="token punctuation">.</span>grantRolesToUser<span class="token punctuation">(</span> <span class="token string">"fox"</span> <span class="token punctuation">,</span> <span class="token punctuation">[</span> 
    <span class="token punctuation">{<!-- --></span> role: <span class="token string">"clusterAdmin"</span><span class="token punctuation">,</span> db: <span class="token string">"admin"</span> <span class="token punctuation">}</span> <span class="token punctuation">,</span>
     <span class="token punctuation">{<!-- --></span> role: <span class="token string">"userAdminAnyDatabase"</span><span class="token punctuation">,</span> db: <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{<!-- --></span> role: <span class="token string">"userAdminAnyDatabase"</span><span class="token punctuation">,</span> db: <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{<!-- --></span> role: <span class="token string">"readWriteAnyDatabase"</span><span class="token punctuation">,</span> db: <span class="token string">"admin"</span><span class="token punctuation">}</span> 
 <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 删除用户</span>
db<span class="token punctuation">.</span>dropUser<span class="token punctuation">(</span><span class="token string">"xxx"</span><span class="token punctuation">)</span>
<span class="token comment">#删除当前数据库所有用户</span>
 db<span class="token punctuation">.</span>dropAllUser<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#用户认证，返回1表示认证成功</span>
test&gt; use admin
switched to db admin
admin&gt; db<span class="token punctuation">.</span>auth<span class="token punctuation">(</span><span class="token string">"weljy"</span><span class="token punctuation">,</span><span class="token string">"weljy"</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span> ok: 1 <span class="token punctuation">}</span>
</code></pre> 
<p><strong>创建测试数据库，并赋予用户权限</strong></p> 
<pre><code class="prism language-powershell">admin&gt; use testdb
switched to db testdb
testdb&gt; db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>user:<span class="token string">"testdb"</span><span class="token punctuation">,</span><span class="token function">pwd</span>:<span class="token string">"testdb"</span><span class="token punctuation">,</span>roles:<span class="token punctuation">[</span><span class="token string">"dbOwner"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span> ok: 1 <span class="token punctuation">}</span>
testdb&gt; show users
<span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span>
    _id: <span class="token string">'testdb.testdb'</span><span class="token punctuation">,</span>
    userId: new UUID<span class="token punctuation">(</span><span class="token string">"f3f6f51b-fb93-4222-a481-ae893708b639"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    user: <span class="token string">'testdb'</span><span class="token punctuation">,</span>
    db: <span class="token string">'testdb'</span><span class="token punctuation">,</span>
    roles: <span class="token punctuation">[</span> <span class="token punctuation">{<!-- --></span> role: <span class="token string">'dbOwner'</span><span class="token punctuation">,</span> db: <span class="token string">'testdb'</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    mechanisms: <span class="token punctuation">[</span> <span class="token string">'SCRAM-SHA-1'</span><span class="token punctuation">,</span> <span class="token string">'SCRAM-SHA-256'</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> 
<p><strong>默认情况下，MongoDB不会启用鉴权，以鉴权模式启动MongoDB</strong></p> 
<pre><code class="prism language-powershell">mongod <span class="token operator">-</span>f <span class="token operator">/</span>mongodb/conf/mongo<span class="token punctuation">.</span>conf <span class="token operator">--</span>auth
<span class="token comment"># 启用鉴权之后，连接MongoDB的相关操作都需要提供身份认证</span>

mongo localhost:27017 <span class="token operator">-</span>u xxx <span class="token operator">-</span>p xxx <span class="token operator">--</span>authenticationDatabase=admin

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
mongodb:<span class="token operator">/</span><span class="token operator">/</span>testdb:testdb@192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>229<span class="token punctuation">.</span>106/testdb


Current Mongosh Log ID: 63f86b8358ebc516b2d18795
Connecting to:          mongodb:<span class="token operator">/</span><span class="token operator">/</span>&lt;credentials&gt;@192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>229<span class="token punctuation">.</span>106/testdb?directConnection=true&amp;appName=mongosh+1<span class="token punctuation">.</span>7<span class="token punctuation">.</span>1
<span class="token keyword">Using</span> MongoDB:          4<span class="token punctuation">.</span>4<span class="token punctuation">.</span>9
<span class="token keyword">Using</span> Mongosh:          1<span class="token punctuation">.</span>7<span class="token punctuation">.</span>1

<span class="token keyword">For</span> mongosh info see: https:<span class="token operator">/</span><span class="token operator">/</span>docs<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>com/mongodb-shell/

testdb&gt;
</code></pre> 
<h2><a id="5MongoDB_353"></a>5、MongoDB工具</h2> 
<p><a href="https://www.mongodb.com/zh-cn/products/compass" rel="nofollow">官方GUI工具-COMPASS</a></p> 
<p><a href="https://robomongo.org/" rel="nofollow">GUI工具- Robo 3T免费</a></p> 
<p><a href="https://studio3t.com/download/" rel="nofollow">GUI工具-Studio 3T（收费，试用30天）</a></p> 
<p><a href="https://www.mongodb.com/try/download/database-tools" rel="nofollow">MongoDB Database Tools</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/82ba30fb727bf54cabf7ef3c2fa09491/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">redisTemplate 根据key前缀批量删除</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4ae83f802644b67dd789bb83c727407f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">go clean -modcache 把$GOPATH/pkg/mod 目录文件清空了如何恢复</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>