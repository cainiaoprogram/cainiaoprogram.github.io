<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>小程序时间段选择 选取某天的某时间段 基于vantweapp的时间段选择器 日期选择器 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="小程序时间段选择 选取某天的某时间段 基于vantweapp的时间段选择器 日期选择器" />
<meta property="og:description" content="demo地址：
https://github.com/939624959/Components-time-picker-.git
目录
效果图： 组件 time-picker
time-picker.json
time-picker.js
time-picker.wxml
time-picker.wxss
页面
page.json
page.js page.wxml
page.wxss
效果图： 组件 time-picker time-picker.json { &#34;component&#34;: true, &#34;usingComponents&#34;: { &#34;van-popup&#34;: &#34;@vant/weapp/popup/index&#34;, &#34;van-icon&#34;: &#34;@vant/weapp/icon/index&#34;, &#34;van-tree-select&#34;: &#34;@vant/weapp/tree-select/index&#34;, &#34;van-button&#34;: &#34;@vant/weapp/button/index&#34; } } time-picker.js const getDateStr = AddDayCount =&gt; { var dd = new Date(); dd.setDate(dd.getDate()&#43;AddDayCount);//获取AddDayCount天后的日期 var y = dd.getFullYear(); var m = dd.getMonth()&#43;1;//获取当前月份的日期 var d = dd.getDate(); return y&#43;&#34;-&#34;&#43;m&#43;&#34;-&#34;&#43;d; } Component({ properties: { title: String, // 标题 isShow: Boolean, // 控制显示隐藏 dayNum: Number, // 左侧导航栏数量 timeArr: Array // 右侧时间段数组 }, data: { mainActiveIndex: 0, activeId: null, itemTree:[] }, lifetimes: { attached: function() { // 在组件实例进入页面节点树时执行 this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/01f35555f2763b885b1628b9d4a5f135/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-23T17:08:55+08:00" />
<meta property="article:modified_time" content="2021-12-23T17:08:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">小程序时间段选择 选取某天的某时间段 基于vantweapp的时间段选择器 日期选择器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p> demo地址：</p> 
<p><a href="https://github.com/939624959/Components-time-picker-.git" title="https://github.com/939624959/Components-time-picker-.git">https://github.com/939624959/Components-time-picker-.git</a></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E6%95%88%E6%9E%9C%E5%9B%BE%EF%BC%9A%C2%A0-toc" style="margin-left:40px;"><a href="#%E6%95%88%E6%9E%9C%E5%9B%BE%EF%BC%9A%C2%A0" rel="nofollow" title="效果图： ">效果图： </a></p> 
<p id="%E7%BB%84%E4%BB%B6%20time-picker-toc" style="margin-left:40px;"><a href="#%E7%BB%84%E4%BB%B6%20time-picker" rel="nofollow" title="组件 time-picker">组件 time-picker</a></p> 
<p id="time-picker.json-toc" style="margin-left:80px;"><a href="#time-picker.json" rel="nofollow" title="time-picker.json">time-picker.json</a></p> 
<p id="time-picker.js-toc" style="margin-left:80px;"><a href="#time-picker.js" rel="nofollow" title="time-picker.js">time-picker.js</a></p> 
<p id="%C2%A0time-picker.wxml-toc" style="margin-left:80px;"><a href="#%C2%A0time-picker.wxml" rel="nofollow" title=" time-picker.wxml"> time-picker.wxml</a></p> 
<p id="%C2%A0time-picker.wxss-toc" style="margin-left:80px;"><a href="#%C2%A0time-picker.wxss" rel="nofollow" title=" time-picker.wxss"> time-picker.wxss</a></p> 
<p id="%C2%A0%E9%A1%B5%E9%9D%A2-toc" style="margin-left:40px;"><a href="#%C2%A0%E9%A1%B5%E9%9D%A2" rel="nofollow" title=" 页面"> 页面</a></p> 
<p id="page.json-toc" style="margin-left:80px;"><a href="#page.json" rel="nofollow" title="page.json">page.json</a></p> 
<p id="page.js%C2%A0-toc" style="margin-left:80px;"><a href="#page.js%C2%A0" rel="nofollow" title="page.js ">page.js </a></p> 
<p id="page.wxml-toc" style="margin-left:80px;"><a href="#page.wxml" rel="nofollow" title="page.wxml">page.wxml</a></p> 
<p id="page.wxss-toc" style="margin-left:80px;"><a href="#page.wxss" rel="nofollow" title="page.wxss">page.wxss</a></p> 
<hr id="hr-toc"> 
<h3 id="%E6%95%88%E6%9E%9C%E5%9B%BE%EF%BC%9A%C2%A0">效果图： </h3> 
<p><img alt="" height="424" src="https://images2.imgbox.com/cf/76/Ep9VedJg_o.png" width="239"></p> 
<h3 id="%E7%BB%84%E4%BB%B6%20time-picker">组件 time-picker</h3> 
<h4 id="time-picker.json">time-picker.json</h4> 
<pre><code>{
	"component": true,
	"usingComponents": {
		"van-popup": "@vant/weapp/popup/index",
		"van-icon": "@vant/weapp/icon/index",
		"van-tree-select": "@vant/weapp/tree-select/index",
		"van-button": "@vant/weapp/button/index"
	}
}</code></pre> 
<h4 id="time-picker.js">time-picker.js</h4> 
<pre><code>const getDateStr = AddDayCount =&gt; {
	var dd = new Date();
	dd.setDate(dd.getDate()+AddDayCount);//获取AddDayCount天后的日期
	var y = dd.getFullYear();
	var m = dd.getMonth()+1;//获取当前月份的日期
	var d = dd.getDate();
	return y+"-"+m+"-"+d;
}

Component({
	properties: {
		title: String, // 标题
		isShow: Boolean,  // 控制显示隐藏
		dayNum: Number,  // 左侧导航栏数量
		timeArr: Array  // 右侧时间段数组
	},

	data: {
		mainActiveIndex: 0,
		activeId: null,
		itemTree:[]
	},

	lifetimes: {
		attached: function() {
		  // 在组件实例进入页面节点树时执行
		  this.getTimeLists()
		},
		detached: function() {
		  // 在组件实例被从页面节点树移除时执行
		},
	},

	methods: {
		// 关闭页面 触发父级设置为隐藏
		onClose(){
			this.triggerEvent('closeEvent',{})
		},
		// 选择大类
		onClickNav({ detail = {} }) {
			this.setData({
			  mainActiveIndex: detail.index || 0,
			});
		},
		// 选择小类
		onClickItem({ detail = {} }) {
			const activeId = this.data.activeId === detail.id ? null : detail.id;
		
			this.setData({ activeId });
		},
		// 确定按钮
		timePicked(){
			let { activeId } = this.data
			if(!!activeId){
				let dayIndex = Math.floor(activeId / 10)
				let timeIndex = activeId - dayIndex * 10
				console.log(dayIndex, timeIndex)
				let day = this.data.itemTree[dayIndex-1].text
				console.log(day)
				let time = this.data.itemTree[dayIndex].children[timeIndex].text
				console.log(time)
				let value = day + ' ' + time
				console.log(value)
				this.triggerEvent('onSelected', {value})
			}
			
			this.triggerEvent('closeEvent',{})
		},
		// 获取时间树数据
		getTimeLists(){
			let itemTree = []
			for(let i = 1; i &lt;= this.properties.dayNum; i++){
				let day = getDateStr(i)
				let children = []
				for(let j = 0; j &lt;= this.properties.timeArr.length; j++){
					children.push({
						text: this.properties.timeArr[j],
						id: i * 10 + j	
					})
				}
				
				itemTree.push({
					text: day,
					children
				})
			}
			this.setData({itemTree})
		},
	}
})</code></pre> 
<h4 id="%C2%A0time-picker.wxml"> time-picker.wxml</h4> 
<pre><code>&lt;van-popup
	show="{<!-- -->{ isShow }}"
	round
	position="bottom"
	bind:close="onClose"
&gt;
	&lt;!-- 标题 --&gt;
	&lt;view class="title"&gt;
		&lt;view&gt;{<!-- -->{title}}&lt;/view&gt;
		&lt;view bindtap="onClose" style="width: 50rpx;height: 50rpx;text-align: center;"&gt;&lt;van-icon name="cross" /&gt;&lt;/view&gt;
		
	&lt;/view&gt;
	&lt;!-- 选择器 --&gt;
	&lt;van-tree-select
		items="{<!-- -->{ itemTree }}"
		main-active-index="{<!-- -->{ mainActiveIndex }}"
		active-id="{<!-- -->{ activeId }}"
		main-active-class="green"
		content-active-class="green"
		bind:click-nav="onClickNav"
		bind:click-item="onClickItem"
	/&gt;
	&lt;!-- 确定按钮 --&gt;
	&lt;view class="footerBtn"&gt;
		&lt;van-button type="primary" block round bind:click="timePicked"&gt;确定&lt;/van-button&gt;
	&lt;/view&gt;
&lt;/van-popup&gt;</code></pre> 
<h4 id="%C2%A0time-picker.wxss"> time-picker.wxss</h4> 
<pre><code>.title{
	font-size: 28rpx;
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 20rpx 40rpx;
}
.green{
	color: #04c255;
	border-color: #04c255!important;
}
.footerBtn{
	padding: 20rpx;
	border-top: 1rpx solid #f7f8fa;
}</code></pre> 
<h3 id="%C2%A0%E9%A1%B5%E9%9D%A2"> 页面</h3> 
<h4 id="page.json">page.json</h4> 
<pre><code>{
  "navigationBarTitleText": "时间选择器",
  "usingComponents": {
    "time-picker": "/components/time-picker/time-picker",
    "van-cell": "@vant/weapp/cell/index"
  }
}</code></pre> 
<h4 id="page.js%C2%A0">page.js </h4> 
<pre><code>Page({

	data: {
		showTimePicker: true, // 是否显示时间选择器
		expTime: '请选择期望时间',  // 页面显示选中时间值
		dayNum: 5,  // 日期数量
		timeArr: ['09:00-15:00', '15:00-21:00']  // 时间段数组
	},

	// 打开时间选择器
	toPickTime(){
		this.setData({showTimePicker: true})
	},
    // 关闭时间选择器
	closeTimePicker(){
		this.setData({showTimePicker: false})
	},
    // 跟新选中时间值
	updateExpTime(e){
		let expTime = e.detail.value
		this.setData({expTime})
	},
})</code></pre> 
<h4 id="page.wxml">page.wxml</h4> 
<pre><code>&lt;view&gt;
	&lt;view class="label"&gt;期望上门时间：&lt;/view&gt;
	&lt;van-cell title="{<!-- -->{expTime}}" is-link bind:click="toPickTime"/&gt;
	&lt;!-- 时间选择器 --&gt;
	&lt;time-picker
        isShow="{<!-- -->{showTimePicker}}"
        title="选择上门时间" 
        dayNum="{<!-- -->{dayNum}}" 
        timeArr="{<!-- -->{timeArr}}"
        bindcloseEvent="closeTimePicker" 
        bindonSelected="updateExpTime"
    /&gt;
&lt;/view&gt;</code></pre> 
<h4 id="page.wxss">page.wxss</h4> 
<pre><code>.label{
	padding: 20rpx;
	font-size: 28rpx;
}</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/43780264018f36182e83b80828d1d807/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VS工程中报错 常量中有换行符</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4c4f86a206a19197b471a3b23ab7eb7a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">postman之get请求发送</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>