<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>æ·±åº¦å­¦ä¹  Day11â€”â€”T11ä¼˜åŒ–å™¨å¯¹æ¯”å®éªŒ - èœé¸Ÿç¨‹åºå‘˜åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="æ·±åº¦å­¦ä¹  Day11â€”â€”T11ä¼˜åŒ–å™¨å¯¹æ¯”å®éªŒ" />
<meta property="og:description" content="ğŸ¨ æœ¬æ–‡ä¸ºğŸ”—365å¤©æ·±åº¦å­¦ä¹ è®­ç»ƒè¥ ä¸­çš„å­¦ä¹ è®°å½•åšå®¢ğŸ– åŸä½œè€…ï¼šKåŒå­¦å•Š | æ¥è¾…å¯¼ã€é¡¹ç›®å®šåˆ¶ æ–‡ç« ç›®å½• å‰è¨€ä¸€ã€æˆ‘çš„ç¯å¢ƒäºŒã€ä»£ç å®ç°ä¸æ‰§è¡Œç»“æœ1.å¼•å…¥åº“2.è®¾ç½®GPUï¼ˆå¦‚æœä½¿ç”¨çš„æ˜¯CPUå¯ä»¥å¿½ç•¥è¿™æ­¥ï¼‰3.å¯¼å…¥æ•°æ®4.æŸ¥çœ‹æ•°æ®5.åŠ è½½æ•°æ®6.å†æ¬¡æ£€æŸ¥æ•°æ®7.é…ç½®æ•°æ®é›†8.å¯è§†åŒ–æ•°æ®9.æ„å»ºCNNç½‘ç»œæ¨¡å‹10.ç¼–è¯‘æ¨¡å‹11.è®­ç»ƒæ¨¡å‹12.æ¨¡å‹è¯„ä¼° ä¸‰ã€çŸ¥è¯†ç‚¹è¯¦è§£1.åŠ è½½é¢„è®­ç»ƒçš„ VGG16 æ¨¡å‹2 ä¼˜åŒ–å™¨2.1 æ¢¯åº¦ä¸‹é™æ³• (Gradient Descent)2.1.1 æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³• (Batch Gradient Descent, BGD)2.1.2éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆStochastic Gradient Descent, SGDï¼‰ 2.2 åŠ¨é‡ä¼˜åŒ–æ³•ï¼ˆMomentumï¼‰2.3 è‡ªé€‚åº”å­¦ä¹ ç‡ä¼˜åŒ–ç®—æ³•2.2.1 AdaGradï¼ˆAdaptive Gradientï¼‰2.2.2 Adadelta2.2.3 RMSprop2.2.4 Adamï¼ˆAdaptive Moment Estimationï¼‰ æ€»ç»“ å‰è¨€ æœ¬æ–‡å°†é‡‡ç”¨CNNå®ç°å¥½è±åæ˜æ˜Ÿè¯†åˆ«ï¼Œå¹¶ç”¨ä¸¤ç§ä¸åŒçš„ä¼˜åŒ–å™¨ç”¨äºè®­ç»ƒï¼Œå¹¶è¿›è¡Œå¯¹æ¯”ã€‚ç®€å•è®²è¿°å®ç°ä»£ç ä¸æ‰§è¡Œç»“æœï¼Œå¹¶æµ…è°ˆæ¶‰åŠçŸ¥è¯†ç‚¹ã€‚
å…³é”®å­—ï¼šåŠ è½½é¢„è®­ç»ƒçš„ VGG16 æ¨¡å‹ï¼Œä¼˜åŒ–å™¨ã€‚
ä¸€ã€æˆ‘çš„ç¯å¢ƒ ç”µè„‘ç³»ç»Ÿï¼šWindows 11è¯­è¨€ç¯å¢ƒï¼špython 3.8.6ç¼–è¯‘å™¨ï¼špycharm2020.2.3æ·±åº¦å­¦ä¹ ç¯å¢ƒï¼šTensorFlow 2.10.1æ˜¾å¡ï¼šNVIDIA GeForce RTX 4070 äºŒã€ä»£ç å®ç°ä¸æ‰§è¡Œç»“æœ 1.å¼•å…¥åº“ from PIL import Image import numpy as np from pathlib import Path import tensorflow as tf from tensorflow.keras.layers import Dropout, Dense, BatchNormalization from tensorflow." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ac28dfbfa3d8da2c48faed473993eaa2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-14T11:39:45+08:00" />
<meta property="article:modified_time" content="2023-12-14T11:39:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="èœé¸Ÿç¨‹åºå‘˜åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">èœé¸Ÿç¨‹åºå‘˜åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">æ·±åº¦å­¦ä¹  Day11â€”â€”T11ä¼˜åŒ–å™¨å¯¹æ¯”å®éªŒ</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <ul><li><strong>ğŸ¨ æœ¬æ–‡ä¸º<a href="https://mp.weixin.qq.com/s/Nb93582M_5usednAKp_Jtw" rel="nofollow">ğŸ”—365å¤©æ·±åº¦å­¦ä¹ è®­ç»ƒè¥</a> ä¸­çš„å­¦ä¹ è®°å½•åšå®¢</strong></li><li><strong>ğŸ– åŸä½œè€…ï¼š<a href="https://mtyjkh.blog.csdn.net/" rel="nofollow">KåŒå­¦å•Š | æ¥è¾…å¯¼ã€é¡¹ç›®å®šåˆ¶</a></strong></li></ul> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#_8" rel="nofollow">å‰è¨€</a></li><li><a href="#_13" rel="nofollow">ä¸€ã€æˆ‘çš„ç¯å¢ƒ</a></li><li><a href="#_20" rel="nofollow">äºŒã€ä»£ç å®ç°ä¸æ‰§è¡Œç»“æœ</a></li><li><ul><li><a href="#1_21" rel="nofollow">1.å¼•å…¥åº“</a></li><li><a href="#2GPUCPU_36" rel="nofollow">2.è®¾ç½®GPUï¼ˆå¦‚æœä½¿ç”¨çš„æ˜¯CPUå¯ä»¥å¿½ç•¥è¿™æ­¥ï¼‰</a></li><li><a href="#3_54" rel="nofollow">3.å¯¼å…¥æ•°æ®</a></li><li><a href="#4_61" rel="nofollow">4.æŸ¥çœ‹æ•°æ®</a></li><li><a href="#5_82" rel="nofollow">5.åŠ è½½æ•°æ®</a></li><li><a href="#6_118" rel="nofollow">6.å†æ¬¡æ£€æŸ¥æ•°æ®</a></li><li><a href="#7_135" rel="nofollow">7.é…ç½®æ•°æ®é›†</a></li><li><a href="#8_157" rel="nofollow">8.å¯è§†åŒ–æ•°æ®</a></li><li><a href="#9CNN_176" rel="nofollow">9.æ„å»ºCNNç½‘ç»œæ¨¡å‹</a></li><li><a href="#10_269" rel="nofollow">10.ç¼–è¯‘æ¨¡å‹</a></li><li><a href="#11_288" rel="nofollow">11.è®­ç»ƒæ¨¡å‹</a></li><li><a href="#12_322" rel="nofollow">12.æ¨¡å‹è¯„ä¼°</a></li></ul> 
  </li><li><a href="#_388" rel="nofollow">ä¸‰ã€çŸ¥è¯†ç‚¹è¯¦è§£</a></li><li><ul><li><a href="#1_VGG16__389" rel="nofollow">1.åŠ è½½é¢„è®­ç»ƒçš„ VGG16 æ¨¡å‹</a></li><li><a href="#2__439" rel="nofollow">2 ä¼˜åŒ–å™¨</a></li><li><ul><li><a href="#21__Gradient_Descent_442" rel="nofollow">2.1 æ¢¯åº¦ä¸‹é™æ³• (Gradient Descent)</a></li><li><ul><li><a href="#211___Batch_Gradient_Descent_BGD_460" rel="nofollow">2.1.1 æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³• (Batch Gradient Descent, BGD)</a></li><li><a href="#212Stochastic_Gradient_Descent_SGD_465" rel="nofollow">2.1.2éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆStochastic Gradient Descent, SGDï¼‰</a></li></ul> 
    </li><li><a href="#22_Momentum_482" rel="nofollow">2.2 åŠ¨é‡ä¼˜åŒ–æ³•ï¼ˆMomentumï¼‰</a></li><li><a href="#23__498" rel="nofollow">2.3 è‡ªé€‚åº”å­¦ä¹ ç‡ä¼˜åŒ–ç®—æ³•</a></li><li><ul><li><a href="#221__AdaGradAdaptive_Gradient_508" rel="nofollow">2.2.1 AdaGradï¼ˆAdaptive Gradientï¼‰</a></li><li><a href="#222__Adadelta_519" rel="nofollow">2.2.2 Adadelta</a></li><li><a href="#223_RMSprop_528" rel="nofollow">2.2.3 RMSprop</a></li><li><a href="#224_AdamAdaptive_Moment_Estimation_541" rel="nofollow">2.2.4 Adamï¼ˆAdaptive Moment Estimationï¼‰</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_588" rel="nofollow">æ€»ç»“</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_8"></a>å‰è¨€</h2> 
<p>æœ¬æ–‡å°†é‡‡ç”¨CNNå®ç°å¥½è±åæ˜æ˜Ÿè¯†åˆ«ï¼Œå¹¶ç”¨ä¸¤ç§ä¸åŒçš„ä¼˜åŒ–å™¨ç”¨äºè®­ç»ƒï¼Œå¹¶è¿›è¡Œå¯¹æ¯”ã€‚ç®€å•è®²è¿°å®ç°ä»£ç ä¸æ‰§è¡Œç»“æœï¼Œå¹¶æµ…è°ˆæ¶‰åŠçŸ¥è¯†ç‚¹ã€‚<br> å…³é”®å­—ï¼šåŠ è½½é¢„è®­ç»ƒçš„ VGG16 æ¨¡å‹ï¼Œä¼˜åŒ–å™¨ã€‚</p> 
<h2><a id="_13"></a>ä¸€ã€æˆ‘çš„ç¯å¢ƒ</h2> 
<ul><li>ç”µè„‘ç³»ç»Ÿï¼šWindows 11</li><li>è¯­è¨€ç¯å¢ƒï¼špython 3.8.6</li><li>ç¼–è¯‘å™¨ï¼špycharm2020.2.3</li><li>æ·±åº¦å­¦ä¹ ç¯å¢ƒï¼šTensorFlow 2.10.1</li><li>æ˜¾å¡ï¼šNVIDIA GeForce RTX 4070</li></ul> 
<h2><a id="_20"></a>äºŒã€ä»£ç å®ç°ä¸æ‰§è¡Œç»“æœ</h2> 
<h3><a id="1_21"></a>1.å¼•å…¥åº“</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dropout<span class="token punctuation">,</span> Dense<span class="token punctuation">,</span> BatchNormalization
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Model
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># æ”¯æŒä¸­æ–‡</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>  <span class="token comment"># ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span>
<span class="token keyword">import</span> warnings
warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>  <span class="token comment"># å¿½ç•¥ä¸€äº›warningå†…å®¹ï¼Œæ— éœ€æ‰“å°</span>
</code></pre> 
<h3><a id="2GPUCPU_36"></a>2.è®¾ç½®GPUï¼ˆå¦‚æœä½¿ç”¨çš„æ˜¯CPUå¯ä»¥å¿½ç•¥è¿™æ­¥ï¼‰</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''å‰æœŸå·¥ä½œ-è®¾ç½®GPUï¼ˆå¦‚æœä½¿ç”¨çš„æ˜¯CPUå¯ä»¥å¿½ç•¥è¿™æ­¥ï¼‰'''</span>
<span class="token comment"># æ£€æŸ¥GPUæ˜¯å¦å¯ç”¨</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>tf<span class="token punctuation">.</span>test<span class="token punctuation">.</span>is_built_with_cuda<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>list_physical_devices<span class="token punctuation">(</span><span class="token string">"GPU"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>gpus<span class="token punctuation">)</span>
<span class="token keyword">if</span> gpus<span class="token punctuation">:</span>
    gpu0 <span class="token operator">=</span> gpus<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># å¦‚æœæœ‰å¤šä¸ªGPUï¼Œä»…ä½¿ç”¨ç¬¬0ä¸ªGPU</span>
    tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>set_memory_growth<span class="token punctuation">(</span>gpu0<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½®GPUæ˜¾å­˜ç”¨é‡æŒ‰éœ€ä½¿ç”¨</span>
    tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>set_visible_devices<span class="token punctuation">(</span><span class="token punctuation">[</span>gpu0<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"GPU"</span><span class="token punctuation">)</span>
</code></pre> 
<p>æ‰§è¡Œç»“æœ</p> 
<pre><code>True
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
</code></pre> 
<h3><a id="3_54"></a>3.å¯¼å…¥æ•°æ®</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''å‰æœŸå·¥ä½œ-å¯¼å…¥æ•°æ®'''</span>
data_dir <span class="token operator">=</span> <span class="token string">r"D:\DeepLearning\data\HollywoodStars"</span>
data_dir <span class="token operator">=</span> Path<span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="4_61"></a>4.æŸ¥çœ‹æ•°æ®</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''å‰æœŸå·¥ä½œ-æŸ¥çœ‹æ•°æ®'''</span>
image_count <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>data_dir<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'*/*.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å›¾ç‰‡æ€»æ•°ä¸ºï¼š"</span><span class="token punctuation">,</span> image_count<span class="token punctuation">)</span>
roses <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data_dir<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'Jennifer Lawrence/*.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
image <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>roses<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># æŸ¥çœ‹å›¾åƒå®ä¾‹çš„å±æ€§</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">,</span> image<span class="token punctuation">.</span>size<span class="token punctuation">,</span> image<span class="token punctuation">.</span>mode<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>æ‰§è¡Œç»“æœï¼š</p> 
<pre><code>å›¾ç‰‡æ€»æ•°ä¸ºï¼š 1800
JPEG (474, 569) RGB
</code></pre> 
<p><img src="https://images2.imgbox.com/b5/ce/PYmaCpsD_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="5_82"></a>5.åŠ è½½æ•°æ®</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''æ•°æ®é¢„å¤„ç†-åŠ è½½æ•°æ®'''</span>
batch_size <span class="token operator">=</span> <span class="token number">16</span>
img_height <span class="token operator">=</span> <span class="token number">336</span>
img_width <span class="token operator">=</span> <span class="token number">336</span>
<span class="token triple-quoted-string string">"""
å…³äºimage_dataset_from_directory()çš„è¯¦ç»†ä»‹ç»å¯ä»¥å‚è€ƒæ–‡ç« ï¼šhttps://mtyjkh.blog.csdn.net/article/details/117018789
"""</span>
train_ds <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image_dataset_from_directory<span class="token punctuation">(</span>
    data_dir<span class="token punctuation">,</span>
    validation_split<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>
    subset<span class="token operator">=</span><span class="token string">"training"</span><span class="token punctuation">,</span>
    seed<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>
    image_size<span class="token operator">=</span><span class="token punctuation">(</span>img_height<span class="token punctuation">,</span> img_width<span class="token punctuation">)</span><span class="token punctuation">,</span>
    batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">)</span>
val_ds <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image_dataset_from_directory<span class="token punctuation">(</span>
    data_dir<span class="token punctuation">,</span>
    validation_split<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>
    subset<span class="token operator">=</span><span class="token string">"validation"</span><span class="token punctuation">,</span>
    seed<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>
    image_size<span class="token operator">=</span><span class="token punctuation">(</span>img_height<span class="token punctuation">,</span> img_width<span class="token punctuation">)</span><span class="token punctuation">,</span>
    batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">)</span>
class_names <span class="token operator">=</span> train_ds<span class="token punctuation">.</span>class_names
<span class="token keyword">print</span><span class="token punctuation">(</span>class_names<span class="token punctuation">)</span>
</code></pre> 
<p>è¿è¡Œç»“æœï¼š</p> 
<pre><code class="prism language-html">Found 1800 files belonging to 17 classes.
Using 1440 files for training.
Found 1800 files belonging to 17 classes.
Using 360 files for validation.
['Angelina Jolie', 'Brad Pitt', 'Denzel Washington', 'Hugh Jackman', 'Jennifer Lawrence', 'Johnny Depp', 'Kate Winslet', 'Leonardo DiCaprio', 'Megan Fox', 'Natalie Portman', 'Nicole Kidman', 'Robert Downey Jr', 'Sandra Bullock', 'Scarlett Johansson', 'Tom Cruise', 'Tom Hanks', 'Will Smith']

</code></pre> 
<h3><a id="6_118"></a>6.å†æ¬¡æ£€æŸ¥æ•°æ®</h3> 
<pre><code class="prism language-python{.line-numbers}">'''æ•°æ®é¢„å¤„ç†-å†æ¬¡æ£€æŸ¥æ•°æ®'''
# Image_batchæ˜¯å½¢çŠ¶çš„å¼ é‡(16, 336, 336, 3)ã€‚è¿™æ˜¯ä¸€æ‰¹å½¢çŠ¶336x336x3çš„16å¼ å›¾ç‰‡ï¼ˆæœ€åä¸€ç»´æŒ‡çš„æ˜¯å½©è‰²é€šé“RGBï¼‰ã€‚
# Label_batchæ˜¯å½¢çŠ¶ï¼ˆ16ï¼Œï¼‰çš„å¼ é‡ï¼Œè¿™äº›æ ‡ç­¾å¯¹åº”16å¼ å›¾ç‰‡
for image_batch, labels_batch in train_ds:
    print(image_batch.shape)
    print(labels_batch.shape)
    break
</code></pre> 
<p>è¿è¡Œç»“æœ</p> 
<pre><code>(16, 336, 336, 3)
(16,)
</code></pre> 
<h3><a id="7_135"></a>7.é…ç½®æ•°æ®é›†</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''æ•°æ®é¢„å¤„ç†-é…ç½®æ•°æ®é›†'''</span>
AUTOTUNE <span class="token operator">=</span> tf<span class="token punctuation">.</span>data<span class="token punctuation">.</span>AUTOTUNE
<span class="token keyword">def</span> <span class="token function">train_preprocessing</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>image <span class="token operator">/</span> <span class="token number">255.0</span><span class="token punctuation">,</span> label<span class="token punctuation">)</span>
train_ds <span class="token operator">=</span> <span class="token punctuation">(</span>
    train_ds<span class="token punctuation">.</span>cache<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>train_preprocessing<span class="token punctuation">)</span>  <span class="token comment"># è¿™é‡Œå¯ä»¥è®¾ç½®é¢„å¤„ç†å‡½æ•°</span>
        <span class="token comment"># .batch(batch_size)           # åœ¨image_dataset_from_directoryå¤„å·²ç»è®¾ç½®äº†batch_size</span>
        <span class="token punctuation">.</span>prefetch<span class="token punctuation">(</span>buffer_size<span class="token operator">=</span>AUTOTUNE<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
val_ds <span class="token operator">=</span> <span class="token punctuation">(</span>
    val_ds<span class="token punctuation">.</span>cache<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>train_preprocessing<span class="token punctuation">)</span>  <span class="token comment"># è¿™é‡Œå¯ä»¥è®¾ç½®é¢„å¤„ç†å‡½æ•°</span>
        <span class="token comment"># .batch(batch_size)         # åœ¨image_dataset_from_directoryå¤„å·²ç»è®¾ç½®äº†batch_size</span>
        <span class="token punctuation">.</span>prefetch<span class="token punctuation">(</span>buffer_size<span class="token operator">=</span>AUTOTUNE<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="8_157"></a>8.å¯è§†åŒ–æ•°æ®</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''æ•°æ®é¢„å¤„ç†-å¯è§†åŒ–æ•°æ®'''</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># å›¾å½¢çš„å®½ä¸º10é«˜ä¸º5</span>
plt<span class="token punctuation">.</span>suptitle<span class="token punctuation">(</span><span class="token string">"æ•°æ®å±•ç¤º"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> images<span class="token punctuation">,</span> labels <span class="token keyword">in</span> train_ds<span class="token punctuation">.</span>take<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>

        <span class="token comment"># æ˜¾ç¤ºå›¾ç‰‡</span>
        plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>images<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment"># æ˜¾ç¤ºæ ‡ç­¾</span>
        plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span>class_names<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>fontdict<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'family'</span> <span class="token punctuation">:</span> <span class="token string">'Times New Roman'</span><span class="token punctuation">,</span> <span class="token string">'size'</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ef/e4/B2LFNfWF_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="9CNN_176"></a>9.æ„å»ºCNNç½‘ç»œæ¨¡å‹</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''æ„å»ºCNNç½‘ç»œ'''</span>
<span class="token keyword">def</span> <span class="token function">create_model</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># åŠ è½½é¢„è®­ç»ƒæ¨¡å‹</span>
    vgg16_base_model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>vgg16<span class="token punctuation">.</span>VGG16<span class="token punctuation">(</span>weights<span class="token operator">=</span><span class="token string">'imagenet'</span><span class="token punctuation">,</span>
                                                         include_top<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                                                         input_shape<span class="token operator">=</span><span class="token punctuation">(</span>img_width<span class="token punctuation">,</span> img_height<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                         pooling<span class="token operator">=</span><span class="token string">'avg'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> layer <span class="token keyword">in</span> vgg16_base_model<span class="token punctuation">.</span>layers<span class="token punctuation">:</span>
        layer<span class="token punctuation">.</span>trainable <span class="token operator">=</span> <span class="token boolean">False</span>

    X <span class="token operator">=</span> vgg16_base_model<span class="token punctuation">.</span>output

    X <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    X <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    X <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>

    output <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>class_names<span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    vgg16_model <span class="token operator">=</span> Model<span class="token punctuation">(</span>inputs<span class="token operator">=</span>vgg16_base_model<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">,</span> outputs<span class="token operator">=</span>output<span class="token punctuation">)</span>

    vgg16_model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span>optimizer<span class="token punctuation">,</span>
                        loss<span class="token operator">=</span><span class="token string">'sparse_categorical_crossentropy'</span><span class="token punctuation">,</span>
                        metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> vgg16_model
model1 <span class="token operator">=</span> create_model<span class="token punctuation">(</span>optimizer<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>optimizers<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model2 <span class="token operator">=</span> create_model<span class="token punctuation">(</span>optimizer<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>optimizers<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model2<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>ç½‘ç»œç»“æ„ç»“æœå¦‚ä¸‹ï¼š</p> 
<pre><code>Model: "model_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_2 (InputLayer)        [(None, 336, 336, 3)]     0         
                                                                 
 block1_conv1 (Conv2D)       (None, 336, 336, 64)      1792      
                                                                 
 block1_conv2 (Conv2D)       (None, 336, 336, 64)      36928     
                                                                 
 block1_pool (MaxPooling2D)  (None, 168, 168, 64)      0         
                                                                 
 block2_conv1 (Conv2D)       (None, 168, 168, 128)     73856     
                                                                 
 block2_conv2 (Conv2D)       (None, 168, 168, 128)     147584    
                                                                 
 block2_pool (MaxPooling2D)  (None, 84, 84, 128)       0         
                                                                 
 block3_conv1 (Conv2D)       (None, 84, 84, 256)       295168    
                                                                 
 block3_conv2 (Conv2D)       (None, 84, 84, 256)       590080    
                                                                 
 block3_conv3 (Conv2D)       (None, 84, 84, 256)       590080    
                                                                 
 block3_pool (MaxPooling2D)  (None, 42, 42, 256)       0         
                                                                 
 block4_conv1 (Conv2D)       (None, 42, 42, 512)       1180160   
                                                                 
 block4_conv2 (Conv2D)       (None, 42, 42, 512)       2359808   
                                                                 
 block4_conv3 (Conv2D)       (None, 42, 42, 512)       2359808   
                                                                 
 block4_pool (MaxPooling2D)  (None, 21, 21, 512)       0         
                                                                 
 block5_conv1 (Conv2D)       (None, 21, 21, 512)       2359808   
                                                                 
 block5_conv2 (Conv2D)       (None, 21, 21, 512)       2359808   
                                                                 
 block5_conv3 (Conv2D)       (None, 21, 21, 512)       2359808   
                                                                 
 block5_pool (MaxPooling2D)  (None, 10, 10, 512)       0         
                                                                 
 global_average_pooling2d_1   (None, 512)              0         
 (GlobalAveragePooling2D)                                        
                                                                 
 dense_2 (Dense)             (None, 170)               87210     
                                                                 
 batch_normalization_1 (Batc  (None, 170)              680       
 hNormalization)                                                 
                                                                 
 dropout_1 (Dropout)         (None, 170)               0         
                                                                 
 dense_3 (Dense)             (None, 17)                2907      
                                                                 
=================================================================
Total params: 14,805,485
Trainable params: 90,457
Non-trainable params: 14,715,028
_________________________________________________________________
</code></pre> 
<h3><a id="10_269"></a>10.ç¼–è¯‘æ¨¡å‹</h3> 
<pre><code class="prism language-python"><span class="token comment"># è®¾ç½®åˆå§‹å­¦ä¹ ç‡</span>
initial_learning_rate <span class="token operator">=</span> <span class="token number">1e-4</span>

lr_schedule <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>optimizers<span class="token punctuation">.</span>schedules<span class="token punctuation">.</span>ExponentialDecay<span class="token punctuation">(</span>
        initial_learning_rate<span class="token punctuation">,</span>
        decay_steps<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">,</span>      <span class="token comment"># æ•²é»‘æ¿ï¼ï¼ï¼è¿™é‡Œæ˜¯æŒ‡ stepsï¼Œä¸æ˜¯æŒ‡epochs</span>
        decay_rate<span class="token operator">=</span><span class="token number">0.96</span><span class="token punctuation">,</span>     <span class="token comment"># lrç»è¿‡ä¸€æ¬¡è¡°å‡å°±ä¼šå˜æˆ decay_rate*lr</span>
        staircase<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># å°†æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡é€å…¥ä¼˜åŒ–å™¨</span>
optimizer <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>optimizers<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>learning_rate<span class="token operator">=</span>lr_schedule<span class="token punctuation">)</span>

model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span>optimizer<span class="token punctuation">,</span>
              loss<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>CategoricalCrossentropy<span class="token punctuation">(</span>from_logits<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="11_288"></a>11.è®­ç»ƒæ¨¡å‹</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''è®­ç»ƒæ¨¡å‹'''</span>
NO_EPOCHS <span class="token operator">=</span> <span class="token number">50</span>

history_model1 <span class="token operator">=</span> model1<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_ds<span class="token punctuation">,</span> epochs<span class="token operator">=</span>NO_EPOCHS<span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> validation_data<span class="token operator">=</span>val_ds<span class="token punctuation">)</span>
history_model2 <span class="token operator">=</span> model2<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_ds<span class="token punctuation">,</span> epochs<span class="token operator">=</span>NO_EPOCHS<span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> validation_data<span class="token operator">=</span>val_ds<span class="token punctuation">)</span>

</code></pre> 
<p>è®­ç»ƒè®°å½•å¦‚ä¸‹ï¼š</p> 
<pre><code>Epoch 1/50
90/90 [==============================] - 13s 99ms/step - loss: 2.7601 - accuracy: 0.1764 - val_loss: 2.7506 - val_accuracy: 0.1250
Epoch 2/50
90/90 [==============================] - 8s 86ms/step - loss: 2.0679 - accuracy: 0.3285 - val_loss: 2.4926 - val_accuracy: 0.2111
Epoch 3/50
90/90 [==============================] - 8s 86ms/step - loss: 1.7437 - accuracy: 0.4410 - val_loss: 2.2004 - val_accuracy: 0.3639
......
Epoch 49/50
90/90 [==============================] - 8s 86ms/step - loss: 0.1929 - accuracy: 0.9354 - val_loss: 2.8650 - val_accuracy: 0.4972
Epoch 50/50
90/90 [==============================] - 8s 86ms/step - loss: 0.1694 - accuracy: 0.9458 - val_loss: 2.7593 - val_accuracy: 0.4694
Epoch 1/50
90/90 [==============================] - 8s 87ms/step - loss: 3.0367 - accuracy: 0.1090 - val_loss: 2.7868 - val_accuracy: 0.1250
Epoch 2/50
90/90 [==============================] - 8s 86ms/step - loss: 2.5409 - accuracy: 0.1979 - val_loss: 2.6385 - val_accuracy: 0.1056
Epoch 3/50
90/90 [==============================] - 8s 86ms/step - loss: 2.2875 - accuracy: 0.2847 - val_loss: 2.4560 - val_accuracy: 0.2167
......


</code></pre> 
<h3><a id="12_322"></a>12.æ¨¡å‹è¯„ä¼°</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''æ¨¡å‹è¯„ä¼°'''</span>
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>ticker <span class="token keyword">import</span> MultipleLocator

plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'savefig.dpi'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">300</span>  <span class="token comment"># å›¾ç‰‡åƒç´ </span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'figure.dpi'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">300</span>  <span class="token comment"># åˆ†è¾¨ç‡</span>

acc1 <span class="token operator">=</span> history_model1<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span>
acc2 <span class="token operator">=</span> history_model2<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span>
val_acc1 <span class="token operator">=</span> history_model1<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_accuracy'</span><span class="token punctuation">]</span>
val_acc2 <span class="token operator">=</span> history_model2<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_accuracy'</span><span class="token punctuation">]</span>

loss1 <span class="token operator">=</span> history_model1<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'loss'</span><span class="token punctuation">]</span>
loss2 <span class="token operator">=</span> history_model2<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'loss'</span><span class="token punctuation">]</span>
val_loss1 <span class="token operator">=</span> history_model1<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_loss'</span><span class="token punctuation">]</span>
val_loss2 <span class="token operator">=</span> history_model2<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_loss'</span><span class="token punctuation">]</span>

epochs_range <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>acc1<span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs_range<span class="token punctuation">,</span> acc1<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Training Accuracy-Adam'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs_range<span class="token punctuation">,</span> acc2<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Training Accuracy-SGD'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs_range<span class="token punctuation">,</span> val_acc1<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Validation Accuracy-Adam'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs_range<span class="token punctuation">,</span> val_acc2<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Validation Accuracy-SGD'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'lower right'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Training and Validation Accuracy'</span><span class="token punctuation">)</span>
<span class="token comment"># è®¾ç½®åˆ»åº¦é—´éš”ï¼Œxè½´æ¯1ä¸€ä¸ªåˆ»åº¦</span>
ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>gca<span class="token punctuation">(</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>xaxis<span class="token punctuation">.</span>set_major_locator<span class="token punctuation">(</span>MultipleLocator<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs_range<span class="token punctuation">,</span> loss1<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Training Loss-Adam'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs_range<span class="token punctuation">,</span> loss2<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Training Loss-SGD'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs_range<span class="token punctuation">,</span> val_loss1<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Validation Loss-Adam'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs_range<span class="token punctuation">,</span> val_loss2<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Validation Loss-SGD'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'upper right'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Training and Validation Loss'</span><span class="token punctuation">)</span>

<span class="token comment"># è®¾ç½®åˆ»åº¦é—´éš”ï¼Œxè½´æ¯1ä¸€ä¸ªåˆ»åº¦</span>
ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>gca<span class="token punctuation">(</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>xaxis<span class="token punctuation">.</span>set_major_locator<span class="token punctuation">(</span>MultipleLocator<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">test_accuracy_report</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    score <span class="token operator">=</span> model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>val_ds<span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Loss function: %s, accuracy:'</span> <span class="token operator">%</span> score<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> score<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


test_accuracy_report<span class="token punctuation">(</span>model1<span class="token punctuation">)</span>
test_accuracy_report<span class="token punctuation">(</span>model2<span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/d3/10/7JhUjmPv_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>Loss function: 2.759303092956543, accuracy: 0.4694444537162781<br> Loss function: 1.3968818187713623, accuracy: 0.5805555582046509</p> 
<h2><a id="_388"></a>ä¸‰ã€çŸ¥è¯†ç‚¹è¯¦è§£</h2> 
<h3><a id="1_VGG16__389"></a>1.åŠ è½½é¢„è®­ç»ƒçš„ VGG16 æ¨¡å‹</h3> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">create_model</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># åŠ è½½é¢„è®­ç»ƒæ¨¡å‹</span>
    vgg16_base_model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>vgg16<span class="token punctuation">.</span>VGG16<span class="token punctuation">(</span>weights<span class="token operator">=</span><span class="token string">'imagenet'</span><span class="token punctuation">,</span>
                                                         include_top<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                                                         input_shape<span class="token operator">=</span><span class="token punctuation">(</span>img_width<span class="token punctuation">,</span> img_height<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                         pooling<span class="token operator">=</span><span class="token string">'avg'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> layer <span class="token keyword">in</span> vgg16_base_model<span class="token punctuation">.</span>layers<span class="token punctuation">:</span>
        layer<span class="token punctuation">.</span>trainable <span class="token operator">=</span> <span class="token boolean">False</span>

    X <span class="token operator">=</span> vgg16_base_model<span class="token punctuation">.</span>output

    X <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    X <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    X <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>

    output <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>class_names<span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    vgg16_model <span class="token operator">=</span> Model<span class="token punctuation">(</span>inputs<span class="token operator">=</span>vgg16_base_model<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">,</span> outputs<span class="token operator">=</span>output<span class="token punctuation">)</span>

    vgg16_model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span>optimizer<span class="token punctuation">,</span>
                        loss<span class="token operator">=</span><span class="token string">'sparse_categorical_crossentropy'</span><span class="token punctuation">,</span>
                        metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> vgg16_model


model1 <span class="token operator">=</span> create_model<span class="token punctuation">(</span>optimizer<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>optimizers<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model2 <span class="token operator">=</span> create_model<span class="token punctuation">(</span>optimizer<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>optimizers<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model2<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>å®šä¹‰äº†ä¸€ä¸ªåä¸º create_model çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•° optimizerï¼ˆé»˜è®¤ä¸º â€˜adamâ€™ï¼‰ã€‚å‡½æ•°å†…éƒ¨é¦–å…ˆä½¿ç”¨ tf.keras.applications.vgg16.VGG16 åŠ è½½äº†é¢„è®­ç»ƒçš„ VGG16 æ¨¡å‹ï¼Œå…¶ä¸­ weights = â€˜imagenetâ€™ è¡¨ç¤ºä½¿ç”¨ ImageNet æ•°æ®é›†çš„é¢„è®­ç»ƒæƒé‡ï¼Œinclude_top = False è¡¨ç¤ºä¸åŒ…å«é¡¶å±‚çš„å…¨è¿æ¥å±‚ï¼Œinput_shape è®¾ç½®è¾“å…¥å›¾åƒçš„å½¢çŠ¶ï¼Œpooling = â€˜avgâ€™ è¡¨ç¤ºä½¿ç”¨å¹³å‡æ± åŒ–ã€‚</p> 
<p>ç„¶åï¼Œå¯¹ VGG16 æ¨¡å‹çš„æ‰€æœ‰å±‚è¿›è¡Œå¾ªç¯éå†ï¼Œå°†æ¯ä¸€å±‚çš„ trainable å±æ€§è®¾ç½®ä¸º Falseï¼Œå³å†»ç»“é¢„è®­ç»ƒå‚æ•°ï¼Œä½¿å®ƒä»¬åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¿æŒä¸å˜ã€‚</p> 
<p>æ¥ä¸‹æ¥ï¼Œå°† VGG16 æ¨¡å‹çš„è¾“å‡ºä½œä¸ºè¾“å…¥ï¼Œå¹¶ç»è¿‡ä¸€ç³»åˆ—çš„ç¥ç»ç½‘ç»œå±‚è¿›è¡Œç‰¹å¾æå–å’Œåˆ†ç±»ã€‚é¦–å…ˆæ˜¯å…¨è¿æ¥å±‚ Dense(170, activation = â€˜reluâ€™)ï¼Œç„¶åæ˜¯æ‰¹å½’ä¸€åŒ–å±‚ BatchNormalization()ï¼Œæœ€åæ˜¯ä¸¢å¼ƒå±‚ Dropout(0.5)ï¼Œç”¨äºé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p> 
<p>æœ€åä¸€å±‚æ˜¯è¾“å‡ºå±‚ Dense(len(class_names), activation = â€˜softmaxâ€™)ï¼Œå…¶ä¸­ len(class_names) æ˜¯ç±»åˆ«çš„æ•°é‡ï¼Œæ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œè®¾ç½®ï¼Œæ¿€æ´»å‡½æ•°ä½¿ç”¨ softmaxã€‚</p> 
<p>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ Model å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æ¨¡å‹ vgg16_modelï¼ŒæŒ‡å®šäº†è¾“å…¥å’Œè¾“å‡ºã€‚è¿™é‡Œçš„ vgg16_base_model.input è¡¨ç¤º VGG16 æ¨¡å‹çš„è¾“å…¥ï¼Œoutput è¡¨ç¤ºä¸Šè¿°ç¥ç»ç½‘ç»œå±‚çš„è¾“å‡ºã€‚</p> 
<p>ç„¶åï¼Œä½¿ç”¨ compile æ–¹æ³•ç¼–è¯‘äº†æ¨¡å‹ï¼ŒæŒ‡å®šäº†ä¼˜åŒ–å™¨ã€æŸå¤±å‡½æ•°å’Œè¯„ä¼°æŒ‡æ ‡ã€‚ä¼˜åŒ–å™¨æ ¹æ®ä¼ å…¥çš„å‚æ•°è¿›è¡Œé€‰æ‹©ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤ä¸º Adam ä¼˜åŒ–å™¨ã€‚æŸå¤±å‡½æ•°ä½¿ç”¨ç¨€ç–åˆ†ç±»äº¤å‰ç†µï¼Œè¯„ä¼°æŒ‡æ ‡ä¸ºå‡†ç¡®ç‡ã€‚</p> 
<p>æœ€åï¼Œå‡½æ•°è¿”å›åˆ›å»ºçš„æ¨¡å‹ã€‚</p> 
<p>æ¥ä¸‹æ¥ï¼Œé€šè¿‡è°ƒç”¨ create_model å‡½æ•°åˆ†åˆ«åˆ›å»ºäº†ä¸¤ä¸ªæ¨¡å‹ model1 å’Œ model2ï¼Œåˆ†åˆ«ä½¿ç”¨äº† Adam ä¼˜åŒ–å™¨å’Œ SGD ä¼˜åŒ–å™¨ã€‚æœ€åè°ƒç”¨ model2.summary() æ‰“å°äº† model2 çš„æ¨¡å‹æ‘˜è¦ä¿¡æ¯ã€‚</p> 
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://blog.csdn.net/qq_45735298/article/details/131353054">æ·±åº¦å­¦ä¹ -ç¬¬T11å‘¨â€”â€”ä¼˜åŒ–å™¨å¯¹æ¯”å®éªŒ</a></p> 
<h3><a id="2__439"></a>2 ä¼˜åŒ–å™¨</h3> 
<p>ä¼˜åŒ–å™¨æ˜¯ä¸€ç§ç®—æ³•ï¼Œå®ƒåœ¨æ¨¡å‹ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼ŒåŠ¨æ€åœ°è°ƒæ•´æ¢¯åº¦çš„å¤§å°å’Œæ–¹å‘ï¼Œä½¿æ¨¡å‹èƒ½å¤Ÿæ”¶æ•›åˆ°æ›´å¥½çš„ä½ç½®ï¼Œæˆ–è€…ç”¨æ›´å¿«çš„é€Ÿåº¦è¿›è¡Œæ”¶æ•›ã€‚</p> 
<h4><a id="21__Gradient_Descent_442"></a>2.1 æ¢¯åº¦ä¸‹é™æ³• (Gradient Descent)</h4> 
<p>æˆ‘ä»¬å¯ä»¥æŠŠæ¨¡å‹çš„å‚æ•°ç©ºé—´æƒ³è±¡æˆæ˜¯ä¸€ä¸ªæ›²é¢ï¼Œæ›²é¢çš„é«˜åº¦æ˜¯æ•´ä½“ä¸Šæ¨¡å‹é¢„æµ‹å€¼ä¸çœŸå®å€¼çš„è¯¯å·®ã€‚æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æ‰¾åˆ°æ•´ä¸ªæ›²é¢çš„æœ€ä½ç‚¹ï¼Œè¿™æ ·æˆ‘ä»¬å…¶å®å°±æ‰¾åˆ°äº†æ¨¡å‹å‚æ•°çš„æœ€ä¼˜ç‚¹ã€‚æ¢¯åº¦ä¸‹é™æ³•æ˜¯æœ€åŸºæœ¬çš„ä¼˜åŒ–ç®—æ³•ä¹‹ä¸€ï¼Œå®ƒè®©å‚æ•°æœç€æ¢¯åº¦ä¸‹é™æœ€å¤§çš„æ–¹å‘å»å˜åŒ–ã€‚</p> 
<p>å‡è®¾æ¨¡å‹å‚æ•°ä¸º <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Î¸ 
        
       
      
        \theta 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span></span></span></span></span>ï¼ŒæŸå¤±å‡½æ•°ä¸º <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         J 
        
       
         ( 
        
       
         Î¸ 
        
       
         ) 
        
       
      
        J(\theta) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0962em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="mclose">)</span></span></span></span></span> ï¼ŒæŸå¤±å‡½æ•°<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         J 
        
       
         ( 
        
       
         Î¸ 
        
       
         ) 
        
       
      
        J(\theta) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0962em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="mclose">)</span></span></span></span></span> å…³äºå‚æ•° <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Î¸ 
        
       
      
        \theta 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span></span></span></span></span> çš„åå¯¼æ•°ï¼Œä¹Ÿå°±æ˜¯æ¢¯åº¦ä¸º <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          âˆ‡ 
         
        
          t 
         
        
       
         J 
        
       
         ( 
        
       
         Î¸ 
        
       
         ) 
        
       
      
        \nabla_tJ(\theta) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord">âˆ‡</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.0962em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="mclose">)</span></span></span></span></span> ï¼Œå­¦ä¹ ç‡ä¸º <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Î± 
        
       
      
        \alpha 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">Î±</span></span></span></span></span> ï¼Œåˆ™ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•æ›´æ–°å‚æ•°çš„å…¬å¼ä¸ºï¼š<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           Î¸ 
          
          
          
            t 
           
          
            + 
           
          
            1 
           
          
         
        
          = 
         
         
         
           Î¸ 
          
         
           t 
          
         
        
          âˆ’ 
         
        
          Î± 
         
        
          â‹… 
         
         
         
           âˆ‡ 
          
         
           t 
          
         
        
          J 
         
        
          ( 
         
        
          Î¸ 
         
        
          ) 
         
        
       
         \theta_{t+1}=\theta_t-\alpha\cdot\nabla_tJ(\theta) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9028em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4445em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">Î±</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord">âˆ‡</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.0962em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="mclose">)</span></span></span></span></span></span></p> 
<p>æ¢¯åº¦ä¸‹é™ç®—æ³•ä¸­ï¼Œæ²¿ç€æ¢¯åº¦çš„æ–¹å‘ä¸æ–­å‡å°æ¨¡å‹å‚æ•°ï¼Œä»è€Œæœ€å°åŒ–æŸå¤±å‡½æ•°ã€‚åŸºæœ¬ç­–ç•¥å¯ä»¥ç†è§£ä¸ºâ€åœ¨ä½ ç›®å…‰æ‰€åŠçš„èŒƒå›´å†…ï¼Œä¸æ–­å¯»æ‰¾æœ€é™¡æœ€å¿«çš„è·¯å¾„ä¸‹å±±â€œ</p> 
<img src="https://images2.imgbox.com/29/a9/rEYd1THK_o.png" width="70%"> 
<blockquote> 
 <p><strong>ç®—æ³•ç¼ºç‚¹ï¼š</strong></p> 
 <ul><li>è®­ç»ƒé€Ÿåº¦æ…¢ï¼šæ¯èµ°ä¸€æ­¥éƒ½è¦è®¡ç®—è°ƒæ•´ä¸‹ä¸€æ­¥çš„æ–¹å‘ï¼Œä¸‹å±±çš„é€Ÿåº¦å˜æ…¢ã€‚åœ¨åº”ç”¨äºå¤§å‹æ•°æ®é›†ä¸­ï¼Œæ¯è¾“å…¥ä¸€ä¸ªæ ·æœ¬éƒ½è¦æ›´æ–°ä¸€æ¬¡å‚æ•°ï¼Œä¸”æ¯æ¬¡è¿­ä»£éƒ½è¦éå†æ‰€æœ‰çš„æ ·æœ¬ã€‚ä¼šä½¿å¾—è®­ç»ƒè¿‡ç¨‹åŠå…¶ç¼“æ…¢ï¼Œéœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´æ‰èƒ½å¾—åˆ°æ”¶æ•›è§£ã€‚</li><li>å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜è§£ï¼šç”±äºæ˜¯åœ¨æœ‰é™è§†è·å†…å¯»æ‰¾ä¸‹å±±çš„æ–¹å‘ã€‚å½“é™·å…¥å¹³å¦çš„æ´¼åœ°ï¼Œä¼šè¯¯ä»¥ä¸ºåˆ°è¾¾äº†å±±åœ°çš„æœ€ä½ç‚¹ï¼Œä»è€Œä¸ä¼šç»§ç»­å¾€ä¸‹èµ°ã€‚</li></ul> 
</blockquote> 
<p>çœŸæ­£åœ¨ä½¿ç”¨æ—¶ï¼Œä¸»è¦æ˜¯ç»è¿‡æ”¹è¿›çš„ä»¥ä¸‹ä¸‰ç±»æ–¹æ³•ï¼ŒåŒºåˆ«åœ¨äº<strong>æ¯æ¬¡å‚æ•°æ›´æ–°æ—¶è®¡ç®—çš„æ ·æœ¬æ•°æ®é‡ä¸åŒ</strong>ï¼š</p> 
<ul><li>æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•(BGD, Batch Gradient Descent)</li><li>éšæœºæ¢¯åº¦ä¸‹é™æ³•(SGD, Stochastic Gradient Descent)</li><li>å°æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•(Mini-batch Gradient Descent)</li></ul> 
<h5><a id="211___Batch_Gradient_Descent_BGD_460"></a>2.1.1 æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³• (Batch Gradient Descent, BGD)</h5> 
<p>â€ƒâ€ƒç¬¬ä¸€ç§å¾ˆå¤©ç„¶çš„æƒ³æ³•æ˜¯æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•BGD(Batch Gradient Descent)ï¼Œå…¶å®å°±æ˜¯æ¯æ¬¡ç”¨å…¨é‡çš„æ•°æ®å¯¹å‚æ•°è¿›è¡Œæ¢¯åº¦ä¸‹é™ã€‚<br> å‡è®¾è®­ç»ƒæ ·æœ¬æ€»æ•°ä¸ºnï¼Œæ ·æœ¬ä¸º {(x1,y1), â€¦ (xn, yn)} ï¼Œæ¨¡å‹å‚æ•°ä¸º <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Î¸ 
        
       
      
        \theta 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span></span></span></span></span>ï¼ŒæŸå¤±å‡½æ•°ä¸º <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         J 
        
       
         ( 
        
       
         Î¸ 
        
       
         ) 
        
       
      
        J(\theta) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0962em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="mclose">)</span></span></span></span></span> ï¼ŒæŸå¤±å‡½æ•°<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         J 
        
       
         ( 
        
       
         Î¸ 
        
       
         ) 
        
       
      
        J(\theta) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0962em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="mclose">)</span></span></span></span></span> å…³äºå‚æ•° <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Î¸ 
        
       
      
        \theta 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span></span></span></span></span> çš„åå¯¼æ•°ï¼Œä¹Ÿå°±æ˜¯æ¢¯åº¦ä¸º <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          âˆ‡ 
         
        
          t 
         
        
       
         J 
        
       
         ( 
        
       
         Î¸ 
        
       
         ) 
        
       
      
        \nabla_tJ(\theta) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord">âˆ‡</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.0962em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="mclose">)</span></span></span></span></span> ï¼Œå­¦ä¹ ç‡ä¸º <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Î± 
        
       
      
        \alpha 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">Î±</span></span></span></span></span> ï¼Œåˆ™ä½¿ç”¨BGDæ›´æ–°å‚æ•°ä¸ºï¼š<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           Î¸ 
          
          
          
            t 
           
          
            + 
           
          
            1 
           
          
         
        
          = 
         
         
         
           Î¸ 
          
         
           t 
          
         
        
          âˆ’ 
         
         
         
           Î± 
          
         
           t 
          
         
        
          â‹… 
         
         
         
           âˆ‘ 
          
          
          
            i 
           
          
            = 
           
          
            1 
           
          
         
           n 
          
         
         
         
           âˆ‡ 
          
         
           t 
          
         
         
         
           J 
          
         
           i 
          
         
        
          ( 
         
        
          Î¸ 
         
        
          , 
         
         
         
           x 
          
         
           i 
          
         
        
          , 
         
         
         
           y 
          
         
           i 
          
         
        
          ) 
         
        
       
         \theta_{t+1}=\theta_t-\alpha_t\cdot\sum_{i=1}^n\nabla_tJ_i(\theta,x^i,y^i) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9028em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.5945em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.9291em; vertical-align: -1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">âˆ‘</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord">âˆ‡</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0962em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0962em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> ç”±ä¸Šå¼å¯ä»¥çœ‹å‡ºï¼Œæ¯è¿›è¡Œä¸€æ¬¡å‚æ•°æ›´æ–°ï¼Œéœ€è¦è®¡ç®—æ•´ä¸ªæ•°æ®æ ·æœ¬é›†ï¼Œå› æ­¤å¯¼è‡´æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•çš„é€Ÿåº¦ä¼šæ¯”è¾ƒæ…¢ï¼Œå°¤å…¶æ˜¯æ•°æ®é›†éå¸¸å¤§çš„æƒ…å†µä¸‹ï¼Œæ”¶æ•›é€Ÿåº¦å°±ä¼šéå¸¸æ…¢ï¼Œä½†æ˜¯ç”±äºæ¯æ¬¡çš„ä¸‹é™æ–¹å‘ä¸ºæ€»ä½“å¹³å‡æ¢¯åº¦ï¼Œå®ƒå¯èƒ½å¾—åˆ°çš„ä¼šæ˜¯ä¸€ä¸ªå…¨å±€æœ€ä¼˜è§£ã€‚</p> 
<h5><a id="212Stochastic_Gradient_Descent_SGD_465"></a>2.1.2éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆStochastic Gradient Descent, SGDï¼‰</h5> 
<p>éšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼Œä¸åƒBGDæ¯ä¸€æ¬¡å‚æ•°æ›´æ–°ï¼Œéœ€è¦è®¡ç®—æ•´ä¸ªæ•°æ®æ ·æœ¬é›†çš„æ¢¯åº¦ï¼Œè€Œæ˜¯æ¯æ¬¡å‚æ•°æ›´æ–°æ—¶ï¼Œä»…ä»…é€‰å–ä¸€ä¸ªæ ·æœ¬(xi, yi)è®¡ç®—å…¶æ¢¯åº¦ï¼Œå‚æ•°æ›´æ–°å…¬å¼ä¸º<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           Î¸ 
          
          
          
            t 
           
          
            + 
           
          
            1 
           
          
         
        
          = 
         
         
         
           Î¸ 
          
         
           t 
          
         
        
          âˆ’ 
         
        
          Î± 
         
        
          â‹… 
         
         
         
           âˆ‡ 
          
         
           t 
          
         
         
         
           J 
          
         
           i 
          
         
        
          ( 
         
        
          Î¸ 
         
        
          , 
         
         
         
           x 
          
         
           i 
          
         
        
          , 
         
         
         
           y 
          
         
           i 
          
         
        
          ) 
         
        
       
         \theta_{t+1}=\theta_t-\alpha\cdot\nabla_tJ_i(\theta,x^i,y^i) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9028em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4445em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">Î±</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1247em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord">âˆ‡</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0962em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0962em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">Î¸</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> SGDè®­ç»ƒé€Ÿåº¦å¾ˆå¿«ï¼Œå³ä½¿åœ¨æ ·æœ¬é‡å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½åªéœ€è¦å…¶ä¸­ä¸€éƒ¨åˆ†æ ·æœ¬å°±èƒ½è¿­ä»£åˆ°æœ€ä¼˜è§£ï¼Œç”±äºæ¯æ¬¡è¿­ä»£å¹¶ä¸æ˜¯éƒ½å‘ç€æ•´ä½“æœ€ä¼˜åŒ–æ–¹å‘ï¼Œå¯¼è‡´æ¢¯åº¦ä¸‹é™çš„æ³¢åŠ¨éå¸¸å¤§ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œæ›´å®¹æ˜“ä»ä¸€ä¸ªå±€éƒ¨æœ€ä¼˜è·³åˆ°å¦ä¸€ä¸ªå±€éƒ¨æœ€ä¼˜ï¼Œå‡†ç¡®åº¦ä¸‹é™ã€‚</p> 
<img src="https://images2.imgbox.com/1f/9a/zBXTTgfK_o.png" width="50%"> 
<blockquote> 
 <p><strong>ä¼˜ç‚¹</strong>ï¼š</p> 
 <ul><li>ç”±äºæ¯æ¬¡è¿­ä»£åªä½¿ç”¨äº†ä¸€ä¸ªæ ·æœ¬è®¡ç®—æ¢¯åº¦ï¼Œè®­ç»ƒé€Ÿåº¦å¿«ï¼ŒåŒ…å«ä¸€å®šéšæœºæ€§ï¼Œä½†æ˜¯ä»æœŸæœ›æ¥çœ‹ï¼Œæ¯æ¬¡è®¡ç®—çš„æ¢¯åº¦åŸºæœ¬æ˜¯æ­£ç¡®çš„å¯¼æ•°çš„ã€‚è™½ç„¶çœ‹èµ·æ¥SGDæ³¢åŠ¨éå¸¸å¤§ï¼Œä¼šèµ°å¾ˆå¤šå¼¯è·¯ï¼Œä½†æ˜¯å¯¹æ¢¯åº¦çš„è¦æ±‚å¾ˆä½ï¼ˆè®¡ç®—æ¢¯åº¦å¿«ï¼‰ï¼Œè€Œä¸”å¯¹äºå¼•å…¥å™ªå£°ï¼Œå¤§é‡çš„ç†è®ºå’Œå®è·µå·¥ä½œè¯æ˜ï¼Œåªè¦å™ªå£°ä¸æ˜¯ç‰¹åˆ«å¤§ï¼ŒSGDéƒ½èƒ½å¾ˆå¥½åœ°æ”¶æ•›ã€‚</li><li>åº”ç”¨å¤§å‹æ•°æ®é›†æ—¶ï¼Œè®­ç»ƒé€Ÿåº¦å¾ˆå¿«ã€‚æ¯”å¦‚æ¯æ¬¡ä»ç™¾ä¸‡æ•°æ®æ ·æœ¬ä¸­ï¼Œå–å‡ ç™¾ä¸ªæ•°æ®ç‚¹ï¼Œç®—ä¸€ä¸ªSGDæ¢¯åº¦ï¼Œæ›´æ–°ä¸€ä¸‹æ¨¡å‹å‚æ•°ã€‚ç›¸æ¯”äºæ ‡å‡†æ¢¯åº¦ä¸‹é™æ³•çš„éå†å…¨éƒ¨æ ·æœ¬ï¼Œæ¯è¾“å…¥ä¸€ä¸ªæ ·æœ¬æ›´æ–°ä¸€æ¬¡å‚æ•°ï¼Œè¦å¿«å¾—å¤š<br> <strong>ç¼ºç‚¹ï¼š</strong></li><li>æ›´æ–°é¢‘ç¹ï¼Œå¸¦æœ‰éšæœºæ€§ï¼Œä¼šé€ æˆæŸå¤±å‡½æ•°åœ¨æ”¶æ•›è¿‡ç¨‹ä¸­ä¸¥é‡éœ‡è¡ã€‚SGDæ²¡èƒ½å•ç‹¬å…‹æœå±€éƒ¨æœ€ä¼˜è§£çš„é—®é¢˜ï¼ˆä¸»è¦ï¼‰</li><li>SGDåœ¨éšæœºé€‰æ‹©æ¢¯åº¦çš„åŒæ—¶ä¼šå¼•å…¥å™ªå£°ï¼Œä½¿å¾—æƒå€¼æ›´æ–°çš„æ–¹å‘ä¸ä¸€å®šæ­£ç¡®ï¼ˆæ¬¡è¦ï¼‰</li></ul> 
</blockquote> 
<h4><a id="22_Momentum_482"></a>2.2 åŠ¨é‡ä¼˜åŒ–æ³•ï¼ˆMomentumï¼‰</h4> 
<p><strong>å…³äºåŠ¨é‡</strong><br> åŠ¨é‡ä¼˜åŒ–æ³•å¼•å…¥äº†ç‰©ç†ä¹‹ä¸­çš„æ¦‚å¿µã€‚åŠ¨é‡ p=mvp=mvp=mvï¼Œå½“ä¸€ä¸ªå°çƒä»å±±é¡¶æ»šä¸‹ï¼Œé€Ÿåº¦è¶Šæ¥è¶Šå¿«ï¼ŒåŠ¨é‡è¶Šæ¥è¶Šå¤§ï¼Œå¼€å§‹åŠ é€Ÿæ¢¯åº¦ä¸‹é™ï¼Œå½“è·¨è¶Šäº†å±±è°·ï¼Œæ»šåˆ°å¯¹é¢çš„å¡ä¸Šæ—¶ï¼Œé€Ÿåº¦å‡å°ï¼ŒåŠ¨é‡å‡å°ã€‚</p> 
<p>å¸¦åŠ¨é‡çš„å°çƒä¸ä»…å¯ä»¥åŠ é€Ÿæ¢¯åº¦ï¼›è¿˜å¯ä»¥å€Ÿç€ç§¯ç´¯çš„åŠ¨é‡ï¼Œå†²è¿‡å°çš„å±±å¡ï¼Œä»¥é¿å…è½å…¥å±€éƒ¨æœ€ä¼˜ç‚¹ã€‚</p> 
<p><strong>åŠ¨é‡ä¼˜åŒ–æ³•ï¼ˆMomentumï¼‰æå‡ºçš„åŸå› </strong><br> æ¢¯åº¦ä¸‹é™æ³•å®¹æ˜“è¢«å›°åœ¨å±€éƒ¨æœ€å°çš„æ²Ÿå£‘å¤„æ¥å›éœ‡è¡ï¼Œå¯èƒ½å­˜åœ¨æ›²é¢çš„å¦ä¸€ä¸ªæ–¹å‘æœ‰æ›´å°çš„å€¼ï¼›æœ‰æ—¶å€™æ¢¯åº¦ä¸‹é™æ³•æ”¶æ•›é€Ÿåº¦è¿˜æ˜¯å¾ˆæ…¢ã€‚åŠ¨é‡æ³•å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜æå‡ºçš„</p> 
<p><strong>åŠ¨é‡ä¼˜åŒ–æ³•æ€æƒ³</strong><br> å‚æ•°æ›´æ–°æ—¶åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿ç•™ä¹‹å‰æ›´æ–°çš„æ–¹å‘ï¼ŒåŒæ—¶åˆåˆ©ç”¨å½“å‰batchçš„æ¢¯åº¦å¾®è°ƒæœ€ç»ˆçš„æ›´æ–°æ–¹å‘ï¼Œç®€è¨€ä¹‹å°±æ˜¯é€šè¿‡ç§¯ç´¯ä¹‹å‰çš„åŠ¨é‡æ¥ (previous_sum_of_gradient) åŠ é€Ÿå½“å‰çš„æ¢¯åº¦ã€‚</p> 
<blockquote> 
 <p><strong>ä¼˜ç¼ºç‚¹åˆ†æ</strong></p> 
 <ul><li>ä¼˜ç‚¹ï¼šå‰åæ¢¯åº¦ä¸€è‡´çš„æ—¶å€™èƒ½å¤ŸåŠ é€Ÿå­¦ä¹ ï¼›å‰åæ¢¯åº¦ä¸ä¸€è‡´çš„æ—¶å€™èƒ½å¤ŸæŠ‘åˆ¶éœ‡è¡ï¼Œè¶Šè¿‡å±€éƒ¨æå°å€¼ï¼ˆåŠ é€Ÿæ”¶æ•›ï¼Œå‡å°éœ‡è¡ï¼‰</li><li>ç¼ºç‚¹ï¼šå¤šäº†ä¸€ä¸ªè¶…å‚æ•°ï¼Œå¢åŠ äº†è®¡ç®—é‡</li></ul> 
</blockquote> 
<h4><a id="23__498"></a>2.3 è‡ªé€‚åº”å­¦ä¹ ç‡ä¼˜åŒ–ç®—æ³•</h4> 
<p>ä¼ ç»Ÿçš„ä¼˜åŒ–ç®—æ³•è¦ä¹ˆå°†å­¦ä¹ ç‡è®¾ç½®ä¸ºå¸¸æ•°è¦ä¹ˆæ ¹æ®è®­ç»ƒæ¬¡æ•°è°ƒèŠ‚å­¦ä¹ ç‡ã€‚å¾€å¾€å¿½è§†äº†å­¦ä¹ ç‡å…¶ä»–å˜åŒ–çš„å¯èƒ½æ€§ã€‚å­¦ä¹ ç‡å¯¹æ¨¡å‹çš„æ€§èƒ½æœ‰ç€æ˜¾è‘—çš„å½±å“ï¼Œéœ€è¦é‡‡å–ä¸€äº›ç­–ç•¥æ¥æ›´æ–°å­¦ä¹ ç‡ï¼Œè¿›è€Œæé«˜è®­ç»ƒé€Ÿåº¦ä¸å‡†ç¡®ç‡ã€‚</p> 
<blockquote> 
 <p><strong>ä½¿ç”¨ç»Ÿä¸€çš„å…¨å±€å­¦ä¹ ç‡çš„ç¼ºç‚¹å¯èƒ½å‡ºç°çš„é—®é¢˜</strong></p> 
 <ul><li>å¯¹äºæŸäº›å‚æ•°ï¼Œé€šè¿‡ç®—æ³•å·²ç»ä¼˜åŒ–åˆ°äº†æå°å€¼é™„è¿‘ï¼Œä½†æ˜¯æœ‰çš„å‚æ•°ä»ç„¶æœ‰ç€å¾ˆå¤§çš„æ¢¯åº¦ã€‚</li><li>å¦‚æœå­¦ä¹ ç‡å¤ªå°ï¼Œåˆ™æ¢¯åº¦å¾ˆå¤§çš„å‚æ•°ä¼šæœ‰ä¸€ä¸ªå¾ˆæ…¢çš„æ”¶æ•›é€Ÿåº¦ï¼› å¦‚æœå­¦ä¹ ç‡å¤ªå¤§ï¼Œåˆ™å·²ç»ä¼˜åŒ–å¾—å·®ä¸å¤šçš„å‚æ•°å¯èƒ½ä¼šå‡ºç°ä¸ç¨³å®šçš„æƒ…å†µã€‚</li></ul> 
 <p>è§£å†³æ–¹æ¡ˆï¼šå¯¹æ¯ä¸ªå‚ä¸è®­ç»ƒçš„å‚æ•°è®¾ç½®ä¸åŒçš„å­¦ä¹ ç‡ï¼Œåœ¨æ•´ä¸ªå­¦ä¹ è¿‡ç¨‹ä¸­é€šè¿‡ä¸€äº›ç®—æ³•è‡ªåŠ¨é€‚åº”è¿™äº›å‚æ•°çš„å­¦ä¹ ç‡ã€‚<br> å¦‚æœæŸå¤±ä¸æŸä¸€æŒ‡å®šå‚æ•°çš„åå¯¼çš„ç¬¦å·ç›¸åŒï¼Œé‚£ä¹ˆå­¦ä¹ ç‡åº”è¯¥å¢åŠ ï¼› å¦‚æœæŸå¤±ä¸è¯¥å‚æ•°çš„åå¯¼çš„ç¬¦å·ä¸åŒï¼Œé‚£ä¹ˆå­¦ä¹ ç‡åº”è¯¥å‡å°ã€‚</p> 
</blockquote> 
<h5><a id="221__AdaGradAdaptive_Gradient_508"></a>2.2.1 AdaGradï¼ˆAdaptive Gradientï¼‰</h5> 
<p>Adagradå…¶å®æ˜¯å¯¹å­¦ä¹ ç‡è¿›è¡Œäº†ä¸€ä¸ªçº¦æŸï¼Œå¯¹äºç»å¸¸æ›´æ–°çš„å‚æ•°ï¼Œæˆ‘ä»¬å·²ç»ç§¯ç´¯äº†å¤§é‡å…³äºå®ƒçš„çŸ¥è¯†ï¼Œä¸å¸Œæœ›è¢«å•ä¸ªæ ·æœ¬å½±å“å¤ªå¤§ï¼Œå¸Œæœ›å­¦ä¹ é€Ÿç‡æ…¢ä¸€äº›ï¼›å¯¹äºå¶å°”æ›´æ–°çš„å‚æ•°ï¼Œæˆ‘ä»¬äº†è§£çš„ä¿¡æ¯å¤ªå°‘ï¼Œå¸Œæœ›èƒ½ä»æ¯ä¸ªå¶ç„¶å‡ºç°çš„æ ·æœ¬ï¼ˆç¨€ç–ç‰¹å¾çš„æ ·æœ¬ï¼‰èº«ä¸Šå¤šå­¦ä¸€äº›ï¼Œå³å­¦ä¹ é€Ÿç‡å¤§ä¸€äº›ã€‚è¯¥æ–¹æ³•ä¸­å¼€å§‹ä½¿ç”¨çš„äºŒé˜¶åŠ¨é‡ï¼Œæ„å‘³ç€â€œè‡ªé€‚åº”å­¦ä¹ ç‡â€ä¼˜åŒ–ç®—æ³•æ—¶ä»£çš„åˆ°æ¥ã€‚</p> 
<blockquote> 
 <p>AdaGrad ç®—æ³•ï¼Œç‹¬ç«‹åœ°é€‚åº”æ‰€æœ‰æ¨¡å‹å‚æ•°çš„å­¦ä¹ ç‡ï¼Œç¼©æ”¾æ¯ä¸ªå‚æ•°åæ¯”äºå…¶æ‰€æœ‰æ¢¯åº¦å†å²å¹³å‡å€¼æ€»å’Œçš„å¹³æ–¹æ ¹ã€‚ï¼ˆçŸ¥é“è¿™ä¹ˆå›äº‹å°±å¥½ï¼ŒåŸºæœ¬ä¸ç”¨å®ƒ~ï¼‰<br> â— å…·æœ‰æŸå¤±å‡½æ•°æœ€å¤§æ¢¯åº¦çš„å‚æ•°ç›¸åº”åœ°æœ‰ä¸ªå¿«é€Ÿä¸‹é™çš„å­¦ä¹ ç‡ â— è€Œå…·æœ‰å°æ¢¯åº¦çš„å‚æ•°åœ¨å­¦ä¹ ç‡ä¸Šæœ‰ç›¸å¯¹è¾ƒå°çš„ä¸‹é™ã€‚</p> 
 <p><strong>ä¼˜ç‚¹</strong>ï¼šè‡ªé€‚åº”çš„å­¦ä¹ ç‡ï¼Œæ— éœ€äººå·¥è°ƒèŠ‚<br> <strong>ç¼ºç‚¹</strong>ï¼š</p> 
 <ul><li>ä»éœ€è¦æ‰‹å·¥è®¾ç½®ä¸€ä¸ªå…¨å±€å­¦ä¹ ç‡ Î·, å¦‚æœ Î· è®¾ç½®è¿‡å¤§çš„è¯ï¼Œä¼šä½¿ regularizer è¿‡äºæ•æ„Ÿï¼Œå¯¹æ¢¯åº¦çš„è°ƒèŠ‚å¤ªå¤§</li><li>ä¸­åæœŸï¼Œ<strong>åˆ†æ¯ä¸Šæ¢¯åº¦ç´¯åŠ çš„å¹³æ–¹å’Œä¼šè¶Šæ¥è¶Šå¤§ï¼Œä½¿å¾—å‚æ•°æ›´æ–°é‡è¶‹è¿‘äº0</strong>ï¼Œä½¿å¾—è®­ç»ƒæå‰ç»“æŸï¼Œæ— æ³•å­¦ä¹ </li></ul> 
</blockquote> 
<h5><a id="222__Adadelta_519"></a>2.2.2 Adadelta</h5> 
<p>ç”±äºAdaGradè°ƒæ•´å­¦ä¹ ç‡å˜åŒ–è¿‡äºæ¿€è¿›ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªæ”¹å˜äºŒé˜¶åŠ¨é‡è®¡ç®—æ–¹æ³•çš„ç­–ç•¥ï¼šä¸ç´¯ç§¯å…¨éƒ¨å†å²æ¢¯åº¦ï¼Œè€Œåªå…³æ³¨è¿‡å»ä¸€æ®µæ—¶é—´çª—å£çš„ä¸‹é™æ¢¯åº¦ï¼Œå³Adadeltaåªç´¯åŠ å›ºå®šå¤§å°çš„é¡¹ï¼Œå¹¶ä¸”ä¹Ÿä¸ç›´æ¥å­˜å‚¨è¿™äº›é¡¹ï¼Œä»…ä»…æ˜¯è¿‘ä¼¼è®¡ç®—å¯¹åº”çš„å¹³å‡å€¼ï¼ˆæŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼ï¼‰ï¼Œè¿™å°±é¿å…äº†äºŒé˜¶åŠ¨é‡æŒç»­ç´¯ç§¯ã€å¯¼è‡´è®­ç»ƒè¿‡ç¨‹æå‰ç»“æŸçš„é—®é¢˜äº†ã€‚</p> 
<blockquote> 
 <p><strong>ä¼˜ç‚¹</strong>ï¼š</p> 
 <ul><li>ä¸ä¾èµ–å…¨å±€learning rate</li><li>è®­ç»ƒåˆä¸­æœŸï¼ŒåŠ é€Ÿæ•ˆæœä¸é”™ï¼Œå¾ˆå¿«</li></ul> 
 <p><strong>ç¼ºç‚¹</strong>ï¼š è®­ç»ƒåæœŸï¼Œåå¤åœ¨å±€éƒ¨æœ€å°å€¼é™„è¿‘æŠ–åŠ¨</p> 
</blockquote> 
<h5><a id="223_RMSprop_528"></a>2.2.3 RMSprop</h5> 
<p>RMSprop å’Œ Adadelta éƒ½æ˜¯ä¸ºäº†è§£å†³ AdaGrad å­¦ä¹ ç‡æ€¥å‰§ä¸‹é™é—®é¢˜çš„ï¼Œä½†æ˜¯RMSPropç®—æ³•ä¿®æ”¹äº†AdaGradçš„æ¢¯åº¦å¹³æ–¹å’Œç´¯åŠ ä¸º<strong>æŒ‡æ•°åŠ æƒçš„ç§»åŠ¨å¹³å‡</strong>ã€‚</p> 
<blockquote> 
 <p>æŒ‡æ•°åŠ æƒå¹³å‡ï¼Œæ—¨åœ¨æ¶ˆé™¤æ¢¯åº¦ä¸‹é™ä¸­çš„æ‘†åŠ¨ï¼Œä¸Momentumçš„æ•ˆæœä¸€æ ·ï¼ŒæŸä¸€ç»´åº¦çš„å¯¼æ•°æ¯”è¾ƒå¤§ï¼Œåˆ™æŒ‡æ•°åŠ æƒå¹³å‡å°±å¤§ï¼ŒæŸä¸€ç»´åº¦çš„å¯¼æ•°æ¯”è¾ƒå°ï¼Œåˆ™å…¶æŒ‡æ•°åŠ æƒå¹³å‡å°±å°ï¼Œè¿™æ ·å°±ä¿è¯äº†å„ç»´åº¦å¯¼æ•°éƒ½åœ¨ä¸€ä¸ªé‡çº§ï¼Œè¿›è€Œå‡å°‘äº†æ‘†åŠ¨ã€‚</p> 
</blockquote> 
<p>å¦å¤–ï¼ŒæŒ‡æ•°è¡°å‡å¹³å‡çš„æ–¹å¼å¯ä»¥æ·¡åŒ–é¥è¿œè¿‡å»çš„å†å²å¯¹å½“å‰æ­¥éª¤å‚æ•°æ›´æ–°é‡çš„å½±å“ï¼Œè¡°å‡ç‡è¡¨æ˜çš„æ˜¯åªæ˜¯æœ€è¿‘çš„æ¢¯åº¦å¹³æ–¹æœ‰æ„ä¹‰ï¼Œè€Œå¾ˆä¹…ä»¥å‰çš„æ¢¯åº¦åŸºæœ¬ä¸Šä¼šè¢«é—å¿˜</p> 
<blockquote> 
 <p><strong>ä¼˜ç‚¹</strong>ï¼š</p> 
 <ul><li>RMSpropç®—æ˜¯Adagradçš„ä¸€ç§å‘å±•ï¼Œå’ŒAdadeltaçš„å˜ä½“ï¼Œæ•ˆæœè¶‹äºäºŒè€…ä¹‹é—´</li><li>é€‚åˆå¤„ç†éå¹³ç¨³ç›®æ ‡(åŒ…æ‹¬å­£èŠ‚æ€§å’Œå‘¨æœŸæ€§)â€”â€”å¯¹äºRNNæ•ˆæœå¾ˆå¥½</li></ul> 
 <p><strong>ç¼ºç‚¹</strong>ï¼šå…¶å®RMSpropä¾ç„¶ä¾èµ–äºå…¨å±€å­¦ä¹ ç‡ Î·</p> 
</blockquote> 
<h5><a id="224_AdamAdaptive_Moment_Estimation_541"></a>2.2.4 Adamï¼ˆAdaptive Moment Estimationï¼‰</h5> 
<p>Adam ç»“åˆäº†å‰é¢æ–¹æ³•çš„ä¸€é˜¶åŠ¨é‡å’ŒäºŒé˜¶åŠ¨é‡ï¼Œæ˜¯å‰è¿°æ–¹æ³•çš„é›†å¤§æˆè€…ã€‚</p> 
<blockquote> 
 <p><strong>ä¼˜ç‚¹</strong>ï¼š</p> 
 <ul><li>Adamæ¢¯åº¦ç»è¿‡åç½®æ ¡æ­£åï¼Œæ¯ä¸€æ¬¡è¿­ä»£å­¦ä¹ ç‡éƒ½æœ‰ä¸€ä¸ªå›ºå®šèŒƒå›´ï¼Œä½¿å¾—å‚æ•°æ¯”è¾ƒå¹³ç¨³ã€‚</li><li>ç»“åˆäº†Adagradå–„äºå¤„ç†ç¨€ç–æ¢¯åº¦å’ŒRMSpropå–„äºå¤„ç†éå¹³ç¨³ç›®æ ‡çš„ä¼˜ç‚¹</li><li>ä¸ºä¸åŒçš„å‚æ•°è®¡ç®—ä¸åŒçš„è‡ªé€‚åº”å­¦ä¹ ç‡</li><li>èŠ‚çœäº†è®­ç»ƒé›†æ—¶é—´ã€è®­ç»ƒæˆæœ¬</li></ul> 
 <p><strong>ç¼ºç‚¹</strong>ï¼š Adam ä½¿ç”¨åŠ¨é‡çš„æ»‘åŠ¨å¹³å‡ï¼Œå¯èƒ½ä¼šéšç€è®­ç»ƒæ•°æ®å˜åŒ–è€ŒæŠ–åŠ¨æ¯”è¾ƒå‰§çƒˆï¼Œåœ¨onlineåœºæ™¯å¯èƒ½æ³¢åŠ¨è¾ƒå¤§ï¼Œåœ¨å¹¿å‘Šåœºæ™¯å¾€å¾€æ•ˆæœä¸å¦‚ AdaGrad</p> 
</blockquote> 
<p><strong>Adamé‚£ä¹ˆæ£’ï¼Œä¸ºä»€ä¹ˆè¿˜å¯¹SGDå¿µå¿µä¸å¿˜</strong><br> ä¸¾ä¸ªæ —å­ã€‚å¾ˆå¤šå¹´ä»¥å‰ï¼Œæ‘„å½±ç¦»æ™®ç½—å¤§ä¼—éå¸¸é¥è¿œã€‚åå¹´å‰ï¼Œå‚»ç“œç›¸æœºå¼€å§‹é£é¡ï¼Œæ¸¸å®¢å‡ ä¹äººæ‰‹ä¸€ä¸ªã€‚æ™ºèƒ½æ‰‹æœºå‡ºç°ä»¥åï¼Œæ‘„å½±æ›´æ˜¯èµ°è¿›åƒå®¶ä¸‡æˆ·ï¼Œæ‰‹æœºéšæ‰‹ä¸€æ‹ï¼Œå‰åä¸¤åƒä¸‡ï¼Œç…§äº®ä½ çš„ç¾ï¼ˆå’¦ï¼Œè¿™æ˜¯ä»€ä¹ˆä¹±ä¸ƒå…«ç³Ÿçš„ï¼‰ã€‚ä½†æ˜¯ä¸“ä¸šæ‘„å½±å¸ˆè¿˜æ˜¯å–œæ¬¢ç”¨å•åï¼Œå­œå­œä¸å€¦åœ°è°ƒå…‰åœˆã€å¿«é—¨ã€ISOã€ç™½å¹³è¡¡â€¦â€¦ä¸€å †è‡ªæ‹å…šä»ä¸careçš„åè¯ã€‚æŠ€æœ¯çš„è¿›æ­¥ï¼Œä½¿å¾—å‚»ç“œå¼æ“ä½œå°±å¯ä»¥å¾—åˆ°ä¸é”™çš„æ•ˆæœï¼Œä½†æ˜¯åœ¨ç‰¹å®šçš„åœºæ™¯ä¸‹ï¼Œè¦æ‹å‡ºæœ€å¥½çš„æ•ˆæœï¼Œä¾ç„¶éœ€è¦æ·±å…¥åœ°ç†è§£å…‰çº¿ã€ç†è§£ç»“æ„ã€ç†è§£å™¨æã€‚<br> æ›´æ·±å…¥çš„å†…å®¹ï¼Œå¯ä»¥é€šè¿‡æ–‡æœ«çš„å‚è€ƒæ–‡çŒ®è¿›å…¥äº†è§£ã€‚<br> <strong>1ï¼‰TensorFlow2è°ƒç”¨<br> å‡½æ•°åŸå‹ï¼š</strong></p> 
<pre><code class="prism language-python">keras<span class="token punctuation">.</span>optimizers<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span> beta_1<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> beta_2<span class="token operator">=</span><span class="token number">0.999</span><span class="token punctuation">,</span> epsilon<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> decay<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> amsgrad<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> 
<p>ğŸ“å®˜ç½‘åœ°å€ï¼šhttps://www.tensorflow.org/api_docs/python/tf/keras/optimizers/Adam</p> 
<p>å‚æ•°è¯¦è§£ï¼š</p> 
<ul><li>lr: float &gt;= 0. å­¦ä¹ ç‡ã€‚</li><li>beta_1: float, 0 &lt; beta &lt; 1. é€šå¸¸æ¥è¿‘äº 1ã€‚</li><li>beta_2: float, 0 &lt; beta &lt; 1. é€šå¸¸æ¥è¿‘äº 1ã€‚</li><li>epsilon: float &gt;= 0. æ¨¡ç³Šå› å­. è‹¥ä¸º None, é»˜è®¤ä¸º K.epsilon()ã€‚</li><li>decay: float &gt;= 0. æ¯æ¬¡å‚æ•°æ›´æ–°åå­¦ä¹ ç‡è¡°å‡å€¼ã€‚</li><li>amsgrad: boolean. æ˜¯å¦åº”ç”¨æ­¤ç®—æ³•çš„ AMSGrad å˜ç§ï¼Œæ¥è‡ªè®ºæ–‡ â€œOn the Convergence of Adam and Beyondâ€ã€‚</li></ul> 
<p>è°ƒç”¨ç¤ºä¾‹ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># è®¾ç½®ä¼˜åŒ–å™¨</span>
opt <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>optimizers<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>learning_rate<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span> decay<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span>opt<span class="token punctuation">,</span>
              loss<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>SparseCategoricalCrossentropy<span class="token punctuation">(</span>from_logits<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>å‚è€ƒæ–‡çŒ®<br> <a href="https://arxiv.org/pdf/1609.04747.pdf" rel="nofollow">An overview of gradient descent optimization algorithms</a></p> 
<p><a href="https://zhuanlan.zhihu.com/p/32262540" rel="nofollow">Adamé‚£ä¹ˆæ£’ï¼Œä¸ºä»€ä¹ˆè¿˜å¯¹SGDå¿µå¿µä¸å¿˜ (2)â€”â€” Adamçš„ä¸¤å®—ç½ª</a></p> 
<h2><a id="_588"></a>æ€»ç»“</h2> 
<p>é€šè¿‡æœ¬æ¬¡çš„å­¦ä¹ ï¼Œäº†è§£äº†é¢„åŠ è½½æ¨¡å‹çš„ç”¨æ³•ï¼Œäº†è§£äº†å¤šç§ä¼˜åŒ–å™¨ã€‚</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9567413ecebe78c1d590153cffe8c2ef/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Djangoå’ŒEChartså¼‚æ­¥è¯·æ±‚ç¤ºä¾‹</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/888b5c8a072037923de5bf2fbd2c3604/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">æ·±åº¦å­¦ä¹  Day14â€”â€”P3å¤©æ°”è¯†åˆ«</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 èœé¸Ÿç¨‹åºå‘˜åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>