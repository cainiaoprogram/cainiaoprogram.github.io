<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>html从json格式取某字段,从服务器端获取JSON格式字符串并解决到前端页面中显示；使用JSON改写表单验证案例（使用JSON.parse()来把JSON格式转变为js对象的运用）2019年5月1... - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="html从json格式取某字段,从服务器端获取JSON格式字符串并解决到前端页面中显示；使用JSON改写表单验证案例（使用JSON.parse()来把JSON格式转变为js对象的运用）2019年5月1..." />
<meta property="og:description" content="从服务器端获取JSON格式字符串并解决到前端页面中显示:
实例
html&gt;
Json小案例 点击我获取信息
// 获取按钮
var btn = document.getElementsByTagName(&#39;button&#39;).item(0);
// 创建ajax对象
var request = new XMLHttpRequest;
// 监听按钮点击
btn.addEventListener(&#39;click&#39;, getData, false);
// 创建点击事件函数
function getData() {
// ajax步骤
request.addEventListener(&#39;readystatechange&#39;, show, false);
request.open(&#39;get&#39; ,&#39;demo1.php&#39;, true);
request.send(null);
}
// 创建show函数
function show() {
// if语句判断是否获取到PHP中的对象
if (request.readyState === 4) {
// console.log(request.responseText);//检查是否获取到JSON格式的对象
// 创建变量obj存储JSON的对象
var obj = JSON.parse(request.responseText);// JSON格式转为对象
// 更新DOM操作
//获取h3标签
var h3 = document.getElementsByTagName(&#39;h3&#39;).item(0);
// console.log(obj.name);//检查obj变量是否正确
// 将JSON格式里所需的数据打印在页面中" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a1b1e65e20e8e3e406776e4c6d443a03/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-05-31T02:32:41+08:00" />
<meta property="article:modified_time" content="2021-05-31T02:32:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">html从json格式取某字段,从服务器端获取JSON格式字符串并解决到前端页面中显示；使用JSON改写表单验证案例（使用JSON.parse()来把JSON格式转变为js对象的运用）2019年5月1...</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>从服务器端获取JSON格式字符串并解决到前端页面中显示:</p> 
 <p>实例</p> 
 <p>html&gt;</p>Json小案例 
 <p>点击我获取信息</p> 
 <h4></h4> 
 <p>// 获取按钮</p> 
 <p>var btn = document.getElementsByTagName('button').item(0);</p> 
 <p>// 创建ajax对象</p> 
 <p>var request = new XMLHttpRequest;</p> 
 <p>// 监听按钮点击</p> 
 <p>btn.addEventListener('click', getData, false);</p> 
 <p>// 创建点击事件函数</p> 
 <p>function getData() {<!-- --></p> 
 <p>// ajax步骤</p> 
 <p>request.addEventListener('readystatechange', show, false);</p> 
 <p>request.open('get' ,'demo1.php', true);</p> 
 <p>request.send(null);</p> 
 <p>}</p> 
 <p>// 创建show函数</p> 
 <p>function show() {<!-- --></p> 
 <p>// if语句判断是否获取到PHP中的对象</p> 
 <p>if (request.readyState === 4) {<!-- --></p> 
 <p>// console.log(request.responseText);//检查是否获取到JSON格式的对象</p> 
 <p>// 创建变量obj存储JSON的对象</p> 
 <p>var obj = JSON.parse(request.responseText);// JSON格式转为对象</p> 
 <p>// 更新DOM操作</p> 
 <p>//获取h3标签</p> 
 <p>var h3 = document.getElementsByTagName('h3').item(0);</p> 
 <p>// console.log(obj.name);//检查obj变量是否正确</p> 
 <p>// 将JSON格式里所需的数据打印在页面中</p> 
 <p>h3.innerHTML = '姓名：' + obj.name + '，PHP成绩：' + obj.grade.php + '，爱好：' + obj.hobby[1] + '。';</p> 
 <p>}</p> 
 <p>}</p> 
 <p>运行实例 »</p> 
 <p>点击 "运行实例" 按钮查看在线实例</p> 
 <p>php代码如下：</p> 
 <p>实例</p> 
 <p>$json = '{<!-- --></p> 
 <p>"name": "小金莲",</p> 
 <p>"age": 23,</p> 
 <p>"isMarried": true,</p> 
 <p>"sweetheart": null,</p> 
 <p>"grade": {<!-- --></p> 
 <p>"javascript": 80,</p> 
 <p>"php": 90</p> 
 <p>},</p> 
 <p>"hobby": ["做烧饼", "下毒", "饮酒作乐"]</p> 
 <p>}';</p> 
 <p>echo $json;</p> 
 <p>运行实例 »</p> 
 <p>点击 "运行实例" 按钮查看在线实例</p> 
 <p>最终显示效果：</p> 
 <p align="center"><img src="https://images2.imgbox.com/81/8d/MnGVZbfr_o.png" alt="76b7bd2dbc2668a7d04634ae93e1a318.png"></p> 
 <p>使用JSON改写表单验证案例：</p> 
 <p>实例</p> 
 <p>html&gt;</p>Ajax实战:表单验证 
 <h4>用户登录</h4> 
 <p>邮箱:</p> 
 <p>*</p> 
 <p>密码: </p> 
 <p>*</p> 
 <p>提交</p> 
 <p>// 获取必要的元素,以及提示信息的占位符元素</p> 
 <p>var login = document.forms.namedItem('login');</p> 
 <p>var submit = document.getElementById('submit');</p> 
 <p>var error_email = document.getElementById('error_email');</p> 
 <p>var error_psw = document.getElementById('error_psw');</p> 
 <p>var result = document.getElementById('result');</p> 
 <p>// 为提交按钮设置点击事件, 并分配一个事件响应函数(只需要名称即可)</p> 
 <p>submit.addEventListener('click', checkUser, false);</p> 
 <p>// 主函数: 定义提交事件函数, 内部会调用二个子函数,完成主要功能</p> 
 <p>function checkUser() {<!-- --></p> 
 <p>// 1.数据非空验证</p> 
 <p>var user = isEmpty(login, error_email, error_psw);</p> 
 <p>// 2. Ajax异步验证</p> 
 <p>// 如果非空验证返回false,说明验证失败, 就不必再到服务器进行Ajax验证了, 直接返回false</p> 
 <p>// 否则就将需要验证的数据(对象字面量user)做为参数,调用异步验证器: verfiy()</p> 
 <p>return user ? verfiy(user, result) : false;</p> 
 <p>}</p> 
 <p>/*****************************************************************/</p> 
 <p>// 非空验证函数</p> 
 <p>function isEmpty(form, error1, error2) {<!-- --></p> 
 <p>// 获取表单控件中的内容,并清空前后空格</p> 
 <p>var email = form.email.value.trim();</p> 
 <p>var password = form.password.value.trim();</p> 
 <p>// 先验证邮箱,再验证密码,并正确的设置焦点与返回值</p> 
 <p>if (email.length === 0) {<!-- --></p> 
 <p>error1.innerText = '邮箱不能为空';</p> 
 <p>login.email.focus();</p> 
 <p>return  false;</p> 
 <p>} else if (password.length === 0){<!-- --></p> 
 <p>error2.innerText = '密码不能为空';</p> 
 <p>login.password.focus();</p> 
 <p>return  false;</p> 
 <p>}</p> 
 <p>// 非空验证通过, 则返回邮箱与密码组成的对象字面量,方便后续代码调用</p> 
 <p>return {<!-- --></p> 
 <p>email: email,</p> 
 <p>password: password</p> 
 <p>}</p> 
 <p>}</p> 
 <p>/*****************************************************************/</p> 
 <p>function verfiy(user, result) {<!-- --></p> 
 <p>//1.创建request对象</p> 
 <p>var request = new XMLHttpRequest();</p> 
 <p>//2.监听响应状态</p> 
 <p>request.onreadystatechange = function(){<!-- --></p> 
 <p>if (request.readyState === 4) { // 准备就绪</p> 
 <p>// console.log(request.responseText);</p> 
 <p>// // 设置验证提示</p> 
 <p>// result.innerHTML = request.responseText;</p> 
 <p>// // 验证通过的跳转功能, 需要使用JSON来实现</p> 
 <p>//用JSON改写表单验证</p> 
 <p>// 用JSON来实现PHP代码验证</p> 
 <p>// 创建obj变量来存储验证提示为JSON转变的js对象</p> 
 <p>var obj = JSON.parse(request.responseText);</p> 
 <p>//验证是否获取正常</p> 
 <p>console.log(obj);</p> 
 <p>//验证是否获取正常</p> 
 <p>console.log(obj.message);</p> 
 <p>//用switch语句输出验证提示</p> 
 <p>switch (obj.status) {<!-- --></p> 
 <p>case 1:</p> 
 <p>result.style.color = 'red'; //样式</p> 
 <p>result.innerHTML = obj.message;//邮箱错误提示</p> 
 <p>break;</p> 
 <p>case 2:</p> 
 <p>result.style.color = 'red';//样式</p> 
 <p>result.innerHTML = obj.message;//密码错误提示</p> 
 <p>break;</p> 
 <p>case 3:</p> 
 <p>result.style.color = 'green';//样式</p> 
 <p>result.innerHTML = obj.message;</p> 
 <p>break;</p> 
 <p>}</p> 
 <p>}</p> 
 <p>return false;</p> 
 <p>};</p> 
 <p>//3.设置请求参数</p> 
 <p>request.open('post','check.php',true);</p> 
 <p>//4. 设置头信息,将内容类型设置为表单提交方式(固定模板语法结构)</p> 
 <p>request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');</p> 
 <p>//4.发送请求</p> 
 <p>// 准备要提交的数据</p> 
 <p>var data = 'email=' + user.email + '&amp;password=' + user.password;</p> 
 <p>request.send(data);</p> 
 <p>}</p> 
 <p>// input: 当用户修改错误数据时, 提示信息应该消失</p> 
 <p>login.email.addEventListener('input', function (){<!-- --></p> 
 <p>error_email.innerText = ''; // 清除邮箱错误提示</p> 
 <p>result.innerText = '';  // 清除服务器返回的验证提示</p> 
 <p>}, false);</p> 
 <p>login.password.addEventListener('input', function (){<!-- --></p> 
 <p>error_psw.innerText = '';  // 清除密码错误提示</p> 
 <p>result.innerText = '';  // 清除服务器返回的验证提示</p> 
 <p>}, false);</p> 
 <p>运行实例 »</p> 
 <p>点击 "运行实例" 按钮查看在线实例</p> 
 <p>PHP代码如下：</p> 
 <p>实例</p> 
 <p>//print_r($_POST);</p> 
 <p>$email = $_POST['email'];</p> 
 <p>$password = $_POST['password'];</p> 
 <p>$emailList = ['admin@php.cn', 'admin@html.cn', 'admin@py.cn'];</p> 
 <p>$pwd = md5('123456');</p> 
 <p>if (!in_array($email, $emailList)) {<!-- --></p> 
 <p>//    echo '邮箱不正确';</p> 
 <p>// 从服务器返回json格式的数据,其实就是一个字符串,默认必须是UTF8编码</p> 
 <p>// json_encode: 将php数组或数组转为json格式字符串</p> 
 <p>echo json_encode(['status'=&gt;1, 'message'=&gt;'邮箱不正确']);</p> 
 <p>} else if (md5($password) !== $pwd) {<!-- --></p> 
 <p>//    echo '密码不正确';</p> 
 <p>echo json_encode(['status'=&gt;2, 'message'=&gt;'密码不正确']);</p> 
 <p>} else {<!-- --></p> 
 <p>//    echo '验证通过,正在跳转...';</p> 
 <p>echo json_encode(['status'=&gt;3, 'message'=&gt;'验证通过正在跳转']);</p> 
 <p>}</p> 
 <p>运行实例 »</p> 
 <p>点击 "运行实例" 按钮查看在线实例</p> 
 <p>邮箱错误提示的显示：</p> 
 <p align="center"><img src="https://images2.imgbox.com/83/f4/4X03dNKn_o.png" alt="ea08bcf8ff550f10b8c40b6df0a7e079.png"></p> 
 <p>密码错误的显示：</p> 
 <p align="center"><img src="https://images2.imgbox.com/3d/09/JQvamaD1_o.png" alt="f0de83a04df59f98d2939731b26a16d9.png"></p> 
 <p>最终通过验证的显示：</p> 
 <p align="center"><img src="https://images2.imgbox.com/c7/65/WjmqMNav_o.png" alt="e9d8ee98398a263df43ad9c68a7286c5.png"></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e411c0df268c34e0cea9ffb76ffac435/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">html字符串转换成json对象,json对象格式化成html字符串显示</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/770498257acbce43b51200c836910c59/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android应用间共享目录,FileProvider（应用间共享文件）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>