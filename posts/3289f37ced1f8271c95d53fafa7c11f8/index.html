<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux nohup后台启动/ 后台启动命令中nohup 、&amp;、重定向的使用 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux nohup后台启动/ 后台启动命令中nohup 、&amp;、重定向的使用" />
<meta property="og:description" content="文章目录 一、前言二、nohup（不挂断）简介三、nohup使用3.1、nohup启动3.2、nohup与&amp;，后台运行3.3、nohup与&gt;，日志重定向3.4、nohup后台启动-综合使用`(推荐)``2&gt;&amp;1` 3.5、nohup后台启动(不生成日志) 四、查看进程五、知识扩展5.1、不停止服务，直接清空nohup.out5.2、只记录警告级别比较高的日志5.3、不想输出日志 一、前言 经常看到一些jar包，sh脚本用nohup命令后台启动，今天就讲解一下nohup的用法。
nohup主要作用就是可以在后台运行，并可以选择将日志输出到指定文件。如启动jar包，若使用java -jar demo.jar的方式启动程序当窗口关闭的时候程序也停止了，而且日志会直接输出到控制台非常不直观，nohup启动就可以解决这两个问题。
二、nohup（不挂断）简介 nohup 是 no hung up的缩写，意思是不挂断 。
nohup 命令，在默认情况下（非重定向时），会输出一个名叫 nohup.out 的文件到当前目录下，如果当前目录的 nohup.out 文件不可写，输出重定向到 $HOME/nohup.out 文件中。
使用 Xshell 等Linux 客户端工具，远程执行 Linux 脚本时，有时候会由于网络问题，导致客户端失去连接，终端断开，脚本运行一半就意外结束了。这种时候，就可以用nohup 指令来运行指令，即使客户端与服务端断开，服务端的脚本仍可继续运行。
nohup 语法格式：
nohup 命令 [参数]... 说明：
关闭客户端后，命令仍然会运行，不会挂断。nohup命令允许被运行的程序的输出信息将不会显示到终端。 三、nohup使用 3.1、nohup启动 nohup sh test.sh 说明：
后台启动test.sh脚本，日志默认会输出到当前目录的nohup.out 文件 3.2、nohup与&amp;，后台运行 &amp;符号表示将该命令或脚本放入后台运行。 即&amp;方式启动会有进程号，使用Ctrl&#43;C程序不会中断，但终端关闭后运行会中断。
nohup sh test.sh &amp; 3.3、nohup与&gt;，日志重定向 上面提到的日志文件默认名称是 nohup.out ，如果修改日志文件的名称，则用到 重定向 ，符号是&gt;，语法格式是
nohup sh test.sh &gt;test.log &gt;表示标准输出，还可以用&gt;,&gt;&gt;, 1&gt;或1&gt;&gt;等进行表示
3.4、nohup后台启动-综合使用(推荐) # 后台执行test.sh文件，将标准日志输出到output.log文件中，将错误日志也输出到output.log文件中 nohup ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3289f37ced1f8271c95d53fafa7c11f8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-09T16:57:40+08:00" />
<meta property="article:modified_time" content="2023-11-09T16:57:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux nohup后台启动/ 后台启动命令中nohup 、&amp;、重定向的使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">一、前言</a></li><li><a href="#nohup_5" rel="nofollow">二、nohup（不挂断）简介</a></li><li><a href="#nohup_20" rel="nofollow">三、nohup使用</a></li><li><ul><li><a href="#31nohup_21" rel="nofollow">3.1、nohup启动</a></li><li><a href="#32nohup_31" rel="nofollow">3.2、nohup与&amp;，后台运行</a></li><li><a href="#33nohup_39" rel="nofollow">3.3、nohup与&gt;，日志重定向</a></li><li><a href="#34nohup_46" rel="nofollow">3.4、nohup后台启动-综合使用`(推荐)`</a></li><li><ul><li><a href="#21_63" rel="nofollow">`2&gt;&amp;1`</a></li></ul> 
   </li><li><a href="#35nohup_75" rel="nofollow">3.5、nohup后台启动(不生成日志)</a></li></ul> 
  </li><li><a href="#_83" rel="nofollow">四、查看进程</a></li><li><a href="#_97" rel="nofollow">五、知识扩展</a></li><li><ul><li><a href="#51nohupout_98" rel="nofollow">5.1、不停止服务，直接清空nohup.out</a></li><li><a href="#52_112" rel="nofollow">5.2、只记录警告级别比较高的日志</a></li><li><a href="#53_118" rel="nofollow">5.3、不想输出日志</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>一、前言</h2> 
<p>经常看到一些jar包，sh脚本用nohup命令后台启动，今天就讲解一下nohup的用法。</p> 
<p>nohup主要作用就是可以在后台运行，并可以选择将日志输出到指定文件。如启动jar包，若使用<code>java -jar demo.jar</code>的方式启动程序当窗口关闭的时候程序也停止了，而且日志会直接输出到控制台非常不直观，nohup启动就可以解决这两个问题。</p> 
<h2><a id="nohup_5"></a>二、nohup（不挂断）简介</h2> 
<p>nohup 是 <mark>no hung up</mark>的缩写，意思是不挂断 。<br> nohup 命令，在默认情况下（非重定向时），会输出一个名叫 nohup.out 的文件到当前目录下，如果当前目录的 nohup.out 文件不可写，输出重定向到 $HOME/nohup.out 文件中。</p> 
<p>使用 Xshell 等Linux 客户端工具，远程执行 Linux 脚本时，有时候会由于网络问题，导致客户端失去连接，终端断开，脚本运行一半就意外结束了。这种时候，就可以用nohup 指令来运行指令，即使客户端与服务端断开，服务端的脚本仍可继续运行。</p> 
<p>nohup 语法格式：</p> 
<pre><code class="prism language-java">nohup 命令 <span class="token punctuation">[</span>参数<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<p><code>说明：</code></p> 
<ul><li>关闭客户端后，命令仍然会运行，<strong>不会挂断</strong>。</li><li>nohup命令允许被运行的程序的输出信息将不会显示到终端。</li></ul> 
<h2><a id="nohup_20"></a>三、nohup使用</h2> 
<h3><a id="31nohup_21"></a>3.1、nohup启动</h3> 
<pre><code class="prism language-java">nohup sh test<span class="token punctuation">.</span>sh 
</code></pre> 
<p>说明：</p> 
<ol><li>后台启动test.sh脚本，<code>日志默认会输出到当前目录的nohup.out 文件</code></li></ol> 
<p><img src="https://images2.imgbox.com/17/cd/uDJBJh6o_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="32nohup_31"></a>3.2、nohup与&amp;，后台运行</h3> 
<p><mark>&amp;符号表示将该命令或脚本放入后台运行。</mark> 即&amp;方式启动会有进程号，<code>使用Ctrl+C程序不会中断，但终端关闭后运行会中断。</code></p> 
<pre><code class="prism language-bash"><span class="token function">nohup</span> <span class="token function">sh</span> test.sh <span class="token operator">&amp;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e4/03/UMRuwv8m_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="33nohup_39"></a>3.3、nohup与&gt;，日志重定向</h3> 
<p>上面提到的日志文件默认名称是 nohup.out ，如果修改日志文件的名称，则用到 重定向 ，符号是<code>&gt;</code>，语法格式是</p> 
<pre><code class="prism language-bash"><span class="token function">nohup</span> <span class="token function">sh</span> test.sh <span class="token operator">&gt;</span>test.log
</code></pre> 
<p><code>&gt;</code>表示标准输出，还可以用<code>&gt;,&gt;&gt;, 1&gt;或1&gt;&gt;</code>等进行表示</p> 
<h3><a id="34nohup_46"></a>3.4、nohup后台启动-综合使用<code>(推荐)</code></h3> 
<pre><code class="prism language-bash"><span class="token comment"># 后台执行test.sh文件，将标准日志输出到output.log文件中，将错误日志也输出到output.log文件中</span>
<span class="token function">nohup</span> ./test.sh <span class="token operator">&gt;</span> output.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
等同于
<span class="token function">nohup</span> ./test.sh <span class="token operator">&gt;</span> output.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>output.log <span class="token operator">&amp;</span>
</code></pre> 
<p>说明：</p> 
<pre><code class="prism language-bash"><span class="token string">"&gt;"</span>符号用于将命令的<span class="token variable"><span class="token variable">`</span>标准输出<span class="token variable">`</span></span>重定向到指定的文件中
<span class="token operator">&gt;</span> outlog.log 表示将终端输出保存到outlog.log文件中
<span class="token string">"2&gt;"</span>表示将命令的<span class="token variable"><span class="token variable">`</span>标准错误<span class="token variable">`</span></span>输出重定向到指定的文件中
<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> 表示将命令的标准错误输出重定向到标准输出1中一起输出 （ps:标准输出1指的是<span class="token operator">&gt;</span>outlog.log文件，具体可见下面的内容）
<span class="token operator">&amp;</span> 后台挂起
</code></pre> 
<h4><a id="21_63"></a><code>2&gt;&amp;1</code></h4> 
<p><code>&gt;</code>符号用于将命令的标准输出重定向到指定的文件中，<br> <code>2&gt;</code>表示将命令的标准错误输出重定向到指定的文件中，<br> <code>2&gt;&amp;1</code>表示将命令的标准错误输出重定向到标准输出中</p> 
<p>在Linux系统中0 1 2是一个文件描述符</p> 
<table><thead><tr><th>几种输入输出方式</th><th>文件描述符</th><th>操作符</th><th>java中表示</th><th>说明</th></tr></thead><tbody><tr><td>标准输入（stdin），即standard input</td><td>0</td><td>&lt;或&lt;&lt;</td><td>System.in</td><td>即表示键盘输入</td></tr><tr><td>标准输出（stdout），即standard output</td><td>1</td><td>&gt;,&gt;&gt;, 1&gt;或1&gt;&gt;</td><td>System.out</td><td>例如，运行"ls 文件"命令将会输出当前工作目录下的文件列表，这些信息将会被输出到标准输出中并显示在终端上。</td></tr><tr><td>标准错误输出（stderr），即standard error output</td><td>2</td><td>2&gt;或2&gt;&gt;</td><td>System.err</td><td>例如，运行"ls 文件"命令，但是不存在此文件，那么将会输出错误信息"ls:cannot access ‘文件名’:No such file or directory"，这个错误信息将会被输出到标准错误输出中并显示在终端上。</td></tr></tbody></table> 
<h3><a id="35nohup_75"></a>3.5、nohup后台启动(不生成日志)</h3> 
<p>上面的示例中，都会将nohup执行的日志存放到nohup.out文件或者其他文件中，有没有方法不存放日志了呢？请使用以下命令</p> 
<pre><code class="prism language-bash"><span class="token comment">#/dev/null 表示空设备文件。 如果不想输出任何的日志时，使用此参数 。</span>
<span class="token function">nohup</span> ./test.sh <span class="token operator">&gt;</span>/dev/null <span class="token operator">&amp;</span> 
</code></pre> 
<h2><a id="_83"></a>四、查看进程</h2> 
<pre><code class="prism language-bash"><span class="token function">nohup</span> test.sh <span class="token operator">&gt;</span>out.log <span class="token number">2</span><span class="token operator">&amp;</span><span class="token number">1</span> <span class="token operator">&amp;</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"test.sh"</span>
</code></pre> 
<p>参数说明：</p> 
<ul><li>a: 显示所有程序</li><li>u: 以用户为主的格式来显示</li><li>x: 显示所有程序，不区分终端机</li></ul> 
<h2><a id="_97"></a>五、知识扩展</h2> 
<h3><a id="51nohupout_98"></a>5.1、不停止服务，直接清空nohup.out</h3> 
<p>如果脚本一直运行下去，nohup.out 日志会一直增长，日志但是硬盘容量有限，怎么把日志文件的大小减少 ？<br> 注意，千万别直接删除日志文件，会造成服务无法输出日志，服务异常直接停止运行，这是最严重生产事故。</p> 
<p>不停止服务，直接清空nohup.out文件有两种方法：</p> 
<pre><code class="prism language-bash"><span class="token comment"># 第1种：</span>
<span class="token function">cat</span> /dev/null <span class="token operator">&gt;</span> nohup.out
 
<span class="token comment"># 第2种：</span>
<span class="token function">cp</span> /dev/null nohup.out
</code></pre> 
<h3><a id="52_112"></a>5.2、只记录警告级别比较高的日志</h3> 
<p>输出的日志太多，nohup.out 增长特别快，对于不重要的日记，可以不记录，选择只记录警告级别比较高的日志。</p> 
<pre><code class="prism language-bash"><span class="token comment"># 只输出错误信息到日志文件，其它日志不输出</span>
<span class="token function">nohup</span> ./test.sh <span class="token operator">&gt;</span> /dev/null   <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>error.log  <span class="token operator">&amp;</span>
</code></pre> 
<h3><a id="53_118"></a>5.3、不想输出日志</h3> 
<p>不想输出日志，什么日志都不要，只要服务能正常运行就行了。</p> 
<pre><code class="prism language-bash"><span class="token comment"># 什么日志也不输出</span>
<span class="token function">nohup</span> ./test.sh <span class="token operator">&gt;</span> /dev/null   <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>   <span class="token operator">&amp;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6c8f642ade41076851fae79da25e2f8c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java动态设置注解值</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cadbee71ea21bb8b91d3d73b6cdf56ee/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">「2024最新JVM面试题」10道不得不会的JVM面试题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>