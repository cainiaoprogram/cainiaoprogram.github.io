<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>“是男人就下一百层”h5游戏全网最详细教学、全代码，js操作 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="“是男人就下一百层”h5游戏全网最详细教学、全代码，js操作" />
<meta property="og:description" content="“是男人就下一百层”h5游戏全网最详细教学、全代码，js操作 博主的话游戏展示编程工具介绍游戏代码代码讲解js 第一步 切换div的显示与隐藏js 第二步 在菜单页面用lufylegend插件封装英雄js 第三步 在菜单页面实现挑选英雄js 第四步 在游戏页面生成英雄js 第五步 在游戏页面制作滚动的背景js 第六步 在游戏页面添加地板！js 第七步 定义英雄上升、下降、死亡函数js 第八步 英雄与地板开始作用js 第九步 添加生命条、分数、声音显示js 第十步 排行榜 进行下一个游戏的开发！总结 博主的话 这里博主将展示此游戏的html和js部分的代码，主要是对这些代码的讲解，教大家如何编写这样一个简单的 h5小游戏。希望大家在认真看完博主的文章后，不但能编写“是男人就下一百层”，还可以发散思维，编写更多有 趣的小游戏。 如果想要跑程序的话，还需要css代码和图片资源；在js里面还用到了jq和lufylegend框架，这是开源的， 大家可以到网上下载。 对于要css代码和img资源的，下载地址：
https://download.csdn.net/download/qq_43592352/12368545
游戏展示 看图说话
游戏初始界面：
游戏开始：
编程工具介绍 1’ Google浏览器。 我是在Google上跑的游戏，如果大家拿我的文件参照的话，尽量用Google。我做的时候没有考虑兼容性 ，觉得一个小游戏，没必要。 2’VS Code。 这个没什么要求的，我用的是VS Code，只要可以编html、css、js，什么都可以，个人喜好。 3’JQuery和lufylegend插件。 简单的说，它们两个也是js文件。只是被封装起来，方便各种功能的调用。 用的话&lt;script src=&#34;js/lufylegend-1.10.1.min.js&#34;&gt;&lt;/script&gt; &lt;script src=&#34;js/jquery-3.3.1.js&#34;&gt;&lt;/script&gt; 直接在相关的文件里引用就可以了。 4’JQuery介绍 jq简单来说就是对原生js的简化，使js的使用更加方便快捷。 5’lufylegend介绍 lufylegend是一种游戏开发引擎，它是通过html的canvas标签来操作的。里面有一些方法很好用，但是， 它的排版和监听和js一比实在是太麻烦，于是我就抛弃了lufylegend。我的js代码只用了lufylegend一点点的 游戏动作封装的函数。 而且，用lufylegend只是身边正好有一本它的书。个人觉得lufylegend不是最好的游戏引擎。大家对游戏 感兴趣的话，不妨去网上找一些更大众的开源引擎。 游戏代码 &lt;html&gt; &lt;link rel=&#34;stylesheet&#34; type=&#34;text/css&#34; href=&#34;css/index.css&#34;/&gt; &lt;script src=&#34;js/lufylegend-1.10.1.min.js&#34;&gt;&lt;/script&gt; &lt;script src=&#34;js/jquery-3.3.1.js&#34;&gt;&lt;/script&gt; &lt;body&gt; &lt;div id=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/623f4ec3ee01864a590eace9e32a4483/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-05-07T20:49:01+08:00" />
<meta property="article:modified_time" content="2019-05-07T20:49:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">“是男人就下一百层”h5游戏全网最详细教学、全代码，js操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>“是男人就下一百层”h5游戏全网最详细教学、全代码，js操作</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">博主的话</a></li><li><a href="#_11" rel="nofollow">游戏展示</a></li><li><a href="#_16" rel="nofollow">编程工具介绍</a></li><li><a href="#_35" rel="nofollow">游戏代码</a></li><li><a href="#_458" rel="nofollow">代码讲解</a></li><li><ul><li><a href="#js__div_482" rel="nofollow">js 第一步 切换div的显示与隐藏</a></li><li><a href="#js__lufylegend_498" rel="nofollow">js 第二步 在菜单页面用lufylegend插件封装英雄</a></li><li><a href="#js___558" rel="nofollow">js 第三步 在菜单页面实现挑选英雄</a></li><li><a href="#js___584" rel="nofollow">js 第四步 在游戏页面生成英雄</a></li><li><a href="#js___614" rel="nofollow">js 第五步 在游戏页面制作滚动的背景</a></li><li><a href="#js___628" rel="nofollow">js 第六步 在游戏页面添加地板！</a></li><li><a href="#js___743" rel="nofollow">js 第七步 定义英雄上升、下降、死亡函数</a></li><li><a href="#js___765" rel="nofollow">js 第八步 英雄与地板开始作用</a></li><li><a href="#js___812" rel="nofollow">js 第九步 添加生命条、分数、声音显示</a></li><li><a href="#js___855" rel="nofollow">js 第十步 排行榜</a></li></ul> 
   </li><li><a href="#_871" rel="nofollow">进行下一个游戏的开发！</a></li><li><a href="#_874" rel="nofollow">总结</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>博主的话</h3> 
<pre><code>	这里博主将展示此游戏的html和js部分的代码，主要是对这些代码的讲解，教大家如何编写这样一个简单的
h5小游戏。希望大家在认真看完博主的文章后，不但能编写“是男人就下一百层”，还可以发散思维，编写更多有
趣的小游戏。
	如果想要跑程序的话，还需要css代码和图片资源；在js里面还用到了jq和lufylegend框架，这是开源的，
大家可以到网上下载。
</code></pre> 
<p>对于要css代码和img资源的，下载地址：<br> <a href="https://download.csdn.net/download/qq_43592352/12368545">https://download.csdn.net/download/qq_43592352/12368545</a></p> 
<h3><a id="_11"></a>游戏展示</h3> 
<blockquote> 
 <p>看图说话<br> 游戏初始界面：<img src="https://images2.imgbox.com/4c/d7/yO2iVRoa_o.png" alt="在这里插入图片描述"><br> 游戏开始：<br> <img src="https://images2.imgbox.com/4d/ca/rgxfN779_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<h3><a id="_16"></a>编程工具介绍</h3> 
<pre><code>1’ Google浏览器。
	我是在Google上跑的游戏，如果大家拿我的文件参照的话，尽量用Google。我做的时候没有考虑兼容性
	，觉得一个小游戏，没必要。
2’VS Code。
	这个没什么要求的，我用的是VS Code，只要可以编html、css、js，什么都可以，个人喜好。
3’JQuery和lufylegend插件。
	简单的说，它们两个也是js文件。只是被封装起来，方便各种功能的调用。
	用的话&lt;script src="js/lufylegend-1.10.1.min.js"&gt;&lt;/script&gt;
    	  &lt;script src="js/jquery-3.3.1.js"&gt;&lt;/script&gt;
    直接在相关的文件里引用就可以了。
4’JQuery介绍
	jq简单来说就是对原生js的简化，使js的使用更加方便快捷。
5’lufylegend介绍
	lufylegend是一种游戏开发引擎，它是通过html的canvas标签来操作的。里面有一些方法很好用，但是，
它的排版和监听和js一比实在是太麻烦，于是我就抛弃了lufylegend。我的js代码只用了lufylegend一点点的
游戏动作封装的函数。
	而且，用lufylegend只是身边正好有一本它的书。个人觉得lufylegend不是最好的游戏引擎。大家对游戏
感兴趣的话，不妨去网上找一些更大众的开源引擎。
</code></pre> 
<h3><a id="_35"></a>游戏代码</h3> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> type<span class="token operator">=</span><span class="token string">"text/css"</span> href<span class="token operator">=</span><span class="token string">"css/index.css"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"js/lufylegend-1.10.1.min.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"js/jquery-3.3.1.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"container"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"game"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>audio id<span class="token operator">=</span><span class="token string">"player"</span> src<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>audio<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"info"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"info_life"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"info_score"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"info_score_num"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"css/img/0.png"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"info_score_num"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"css/img/0.png"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"info_score_num"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"css/img/0.png"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"info_score_num"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"css/img/0.png"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"main"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"menu"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"menu_title"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>是男人就下<span class="token number">100</span>层<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"menu_hero"</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"menu_hero1"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"css/img/left.png"</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"menu_hero2"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"menu_hero3"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"css/img/right.png"</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"menu_button"</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"menu_button1"</span><span class="token operator">&gt;</span>开始游戏<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"menu_button2"</span><span class="token operator">&gt;</span>排行榜<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"gamemain"</span><span class="token operator">&gt;</span>
                
                <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"hero"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"game_bg2"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"css/img/game_bg2.png"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"ranking"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>排行榜<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"rank_table"</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>dl<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dt<span class="token operator">&gt;</span>排名<span class="token operator">&lt;</span><span class="token operator">/</span>dt<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token number">3</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token number">4</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token number">5</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>dl<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>dl<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dt<span class="token operator">&gt;</span>英雄大名<span class="token operator">&lt;</span><span class="token operator">/</span>dt<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>dl<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>dl<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dt<span class="token operator">&gt;</span>层数<span class="token operator">&lt;</span><span class="token operator">/</span>dt<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>dd<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>dl<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token comment">/**************************便捷函数**************************************/</span>
    <span class="token keyword">function</span> <span class="token function">getRandom</span><span class="token punctuation">(</span>min<span class="token punctuation">,</span>max<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//获取在区间[min.max]内的int数</span>
        <span class="token keyword">var</span> s<span class="token punctuation">;</span>
        s<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>max<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>s<span class="token operator">&lt;</span>min<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
        s<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>max<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> s<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">onIt</span><span class="token punctuation">(</span>hx<span class="token punctuation">,</span>hy<span class="token punctuation">,</span>fx<span class="token punctuation">,</span>fy<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>hx<span class="token operator">&lt;=</span>fx<span class="token operator">+</span><span class="token number">60</span><span class="token operator">&amp;&amp;</span>hx<span class="token operator">&gt;=</span>fx<span class="token operator">-</span><span class="token number">32</span><span class="token operator">&amp;&amp;</span>hy<span class="token operator">&gt;=</span>fy<span class="token operator">-</span><span class="token number">32</span><span class="token operator">&amp;&amp;</span>hy<span class="token operator">&lt;=</span>fy<span class="token operator">-</span><span class="token number">31</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> 
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> shansuoTimes<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">shansuo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//闪烁3次</span>
        shansuoTimes<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#hero'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fadeTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#hero'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fadeTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>shansuoTimes<span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">)</span> 
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">"shansuo()"</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            shansuoTimes<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">function</span> <span class="token function">sleep</span><span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//时间延迟函数</span>
          <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span>resolve <span class="token operator">=&gt;</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>ms<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span>
        <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'world!'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/**************************基础页面操作设置**************************************/</span>
    <span class="token keyword">var</span> hero_href<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>hero_href_key<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">15</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        hero_href<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"css/hero/"</span><span class="token operator">+</span>i<span class="token operator">+</span><span class="token string">".png"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//js改变网页页面大小</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>zoom<span class="token operator">=</span><span class="token number">.8</span><span class="token punctuation">;</span>
    <span class="token comment">//控制menu、gamemain、ranking的显示</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu_button1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'block'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#ranking"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">heroDie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">init</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"hero"</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span>main<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">heroDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">myfloor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">displayScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">displayLife</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu_button2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#ranking"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'block'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//控制英雄的切换</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu_hero1 img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>hero_href_key<span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span> hero_href_key<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token function">heroDie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu_hero3 img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>hero_href_key<span class="token operator">&lt;</span><span class="token number">15</span><span class="token punctuation">)</span> hero_href_key<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token function">heroDie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token comment">//分数显示</span>
    <span class="token keyword">var</span> score_pic<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token string">'css/img/0.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/1.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/2.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/3.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/4.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/5.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/6.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/7.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/8.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/9.png'</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> score<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">displayScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> s<span class="token operator">=</span>score<span class="token punctuation">;</span>
        <span class="token keyword">var</span> score0<span class="token operator">=</span>s<span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> score1<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>s<span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> score2<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>s<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> score3<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>s<span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".info_score_num img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span>score_pic<span class="token punctuation">[</span>score0<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".info_score_num img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span>score_pic<span class="token punctuation">[</span>score1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".info_score_num img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span>score_pic<span class="token punctuation">[</span>score2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".info_score_num img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span>score_pic<span class="token punctuation">[</span>score3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">'displayScore()'</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//生命条显示</span>
    <span class="token keyword">var</span> deadflag<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">displayLife</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">isdie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#info_life"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">,</span>nowHP<span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>nowHP<span class="token operator">&lt;=</span><span class="token number">4</span><span class="token operator">&amp;&amp;</span>nowHP<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#info_life"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'background'</span><span class="token punctuation">,</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>nowHP<span class="token operator">==</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>deadflag<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token function">playMusic</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>deadflag<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">'displayLife()'</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">playMusic</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> player <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#player"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            player<span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">'css/sound/dead.mp3'</span><span class="token punctuation">;</span>
            player<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
            
        
    <span class="token punctuation">}</span>

    <span class="token comment">/**************************游戏设置**************************************/</span>
    <span class="token comment">/***lufylegend框架封装英雄类*****/</span>
    <span class="token keyword">var</span> loader<span class="token punctuation">,</span>anime<span class="token punctuation">,</span>layer<span class="token punctuation">;</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"menu_hero2"</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span>main<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        loader<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        loader<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>LEvent<span class="token punctuation">.</span><span class="token constant">COMPLETE</span><span class="token punctuation">,</span>loadBItmapdata<span class="token punctuation">)</span><span class="token punctuation">;</span>
        loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>hero_href<span class="token punctuation">[</span>hero_href_key<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"bitmapData"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">loadBItmapdata</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> bitmapdata<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LBitmapData</span><span class="token punctuation">(</span>loader<span class="token punctuation">.</span>content<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> list<span class="token operator">=</span>LGlobal<span class="token punctuation">.</span><span class="token function">divideCoordinate</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        layer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LSprite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addChild</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        anime<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LAnimation</span><span class="token punctuation">(</span>layer<span class="token punctuation">,</span>bitmapdata<span class="token punctuation">,</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
        layer<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>LEvent<span class="token punctuation">.</span><span class="token constant">ENTER_FRAME</span><span class="token punctuation">,</span>onframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">onframe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keydown</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>which<span class="token operator">==</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            anime<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>which<span class="token operator">==</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            anime<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keyup</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            anime<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        anime<span class="token punctuation">.</span><span class="token function">onframe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">heroDie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        layer<span class="token punctuation">.</span><span class="token function">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        layer<span class="token punctuation">.</span><span class="token function">removeAllChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/***封装游戏背景类*****/</span>
    <span class="token keyword">var</span> bgHeight<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        bgHeight<span class="token operator">+=</span><span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'background'</span><span class="token punctuation">,</span><span class="token string">'url("css/img/gamemain_bg.png") 0px '</span><span class="token operator">+</span>bgHeight<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>bgHeight<span class="token operator">&gt;=</span><span class="token number">550</span><span class="token punctuation">)</span> bgHeight<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//防止bgHeight过大</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">'background()'</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/*********封装地板****************/</span>
    <span class="token keyword">function</span> <span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> img<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> floorx<span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">370</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> floory<span class="token operator">=</span><span class="token number">530</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">createFloor1</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//地板1类</span>
            img<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">'src'</span><span class="token punctuation">:</span><span class="token string">'css/img/floor1.png'</span><span class="token punctuation">,</span>
                <span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'floor'</span><span class="token punctuation">,</span>
                <span class="token string">'relative'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token string">'type'</span><span class="token punctuation">:</span><span class="token number">1</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">'margin-left'</span><span class="token punctuation">:</span>floorx<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
                <span class="token string">'margin-top'</span><span class="token punctuation">:</span>floory<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">createFloor2</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//地板2类</span>
            img<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">'src'</span><span class="token punctuation">:</span><span class="token string">'css/img/floor2.png'</span><span class="token punctuation">,</span>
                <span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'floor'</span><span class="token punctuation">,</span>
                <span class="token string">'relative'</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token string">'type'</span><span class="token punctuation">:</span><span class="token number">1</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">'margin-left'</span><span class="token punctuation">:</span>floorx<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
                <span class="token string">'margin-top'</span><span class="token punctuation">:</span>floory<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">createFloor3</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//地板3类</span>
            img<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">'src'</span><span class="token punctuation">:</span><span class="token string">'css/img/floor3.png'</span><span class="token punctuation">,</span>
                <span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'floor'</span><span class="token punctuation">,</span>
                <span class="token string">'relative'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token string">'type'</span><span class="token punctuation">:</span><span class="token number">1</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">'margin-left'</span><span class="token punctuation">:</span>floorx<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
                <span class="token string">'margin-top'</span><span class="token punctuation">:</span>floory<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">createFloor4</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//地板4类 会消失的地板</span>
            img<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">'src'</span><span class="token punctuation">:</span><span class="token string">'css/img/floor4in1.png'</span><span class="token punctuation">,</span>
                <span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'floor'</span><span class="token punctuation">,</span>
                <span class="token string">'relative'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token string">'type'</span><span class="token punctuation">:</span><span class="token number">2</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">'margin-left'</span><span class="token punctuation">:</span>floorx<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
                <span class="token string">'margin-top'</span><span class="token punctuation">:</span>floory<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">createFloor5</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//地板5类 会滚动的地板</span>
            img<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">'src'</span><span class="token punctuation">:</span><span class="token string">'css/img/floor5.gif'</span><span class="token punctuation">,</span>
                <span class="token string">'id'</span><span class="token punctuation">:</span><span class="token string">'floor5'</span><span class="token punctuation">,</span>
                <span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'floor'</span><span class="token punctuation">,</span>
                <span class="token string">'relative'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token string">'type'</span><span class="token punctuation">:</span><span class="token number">3</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">'margin-left'</span><span class="token punctuation">:</span>floorx<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
                <span class="token string">'margin-top'</span><span class="token punctuation">:</span>floory<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">run</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>floory<span class="token operator">&gt;=</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                floory<span class="token operator">-=</span><span class="token number">2</span><span class="token punctuation">;</span>
                img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-top'</span><span class="token punctuation">,</span>floory<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">setTimeout</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>run<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                img<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                score<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">changefloor4</span><span class="token punctuation">(</span>$ppp<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//地板4类消失函数</span>
        $ppp<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span><span class="token string">'css/img/floor4in2.png'</span><span class="token punctuation">)</span>
        <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
        $ppp<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"src"</span><span class="token punctuation">,</span><span class="token string">"css/img/floor4in3.png"</span><span class="token punctuation">)</span>
        <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
        $ppp<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        $ppp<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        score<span class="token operator">++</span><span class="token punctuation">;</span>
        ontheFloor<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span><span class="token function">heroDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>up<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">floor5Move1</span><span class="token punctuation">(</span>fx<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//地板5类左移英雄</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">&gt;</span>fx<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#hero'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-left'</span><span class="token punctuation">,</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-=</span><span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        ontheFloor<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span><span class="token function">heroDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>up<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">myfloor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//创建地板</span>
    <span class="token keyword">var</span> ppp<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">floor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> ppp<span class="token punctuation">.</span><span class="token function">createFloor1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span> ppp<span class="token punctuation">.</span><span class="token function">createFloor2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span> ppp<span class="token punctuation">.</span><span class="token function">createFloor3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">4</span><span class="token punctuation">)</span> ppp<span class="token punctuation">.</span><span class="token function">createFloor4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">5</span><span class="token punctuation">)</span> ppp<span class="token punctuation">.</span><span class="token function">createFloor5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">'myfloor()'</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">/*********封装英雄（未封装原因：lufylegend插件已经生成了英雄）****************/</span>
    <span class="token keyword">var</span> position<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//全局变量，hero的位置坐标</span>
    <span class="token keyword">var</span> maxHP<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>nowHP<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">;</span><span class="token comment">//全局变量，最大HP，现在HP</span>
    <span class="token keyword">var</span> ontheFloor<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//全局变量，是否在地板上</span>
    <span class="token keyword">var</span> gspeed<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//全局变量，英雄下落速度，可随游戏时间增加</span>
    <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keydown</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//对英雄移动的键盘操作</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>which<span class="token operator">==</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token punctuation">(</span><span class="token punctuation">(</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">?</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-=</span><span class="token number">3</span><span class="token punctuation">;</span>
                <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#hero"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-left'</span><span class="token punctuation">,</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>which<span class="token operator">==</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token punctuation">(</span><span class="token punctuation">(</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">398</span><span class="token punctuation">)</span><span class="token operator">?</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">398</span><span class="token punctuation">:</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">;</span>
                <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#hero"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-left'</span><span class="token punctuation">,</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> down<span class="token punctuation">,</span>up<span class="token punctuation">,</span>move<span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">heroDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//英雄自由下落</span>
        position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+=</span>gspeed<span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#hero"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-top'</span><span class="token punctuation">,</span>position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        down<span class="token operator">=</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">"heroDown()"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">heroUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//英雄随地板上升，此函数与floor类的run函数数值同步</span>
        position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-=</span><span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#hero"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-top'</span><span class="token punctuation">,</span>position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        up<span class="token operator">=</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">"heroUp()"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">isdie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//对英雄向上触碰、向下掉底直接死亡，设置nowHP=0，然后交给‘生命条显示’函数来做英雄死亡后的事件</span>
        <span class="token keyword">var</span> y<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#hero"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-top'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>y<span class="token operator">&gt;=</span><span class="token number">520</span><span class="token operator">||</span>y<span class="token operator">&lt;=</span><span class="token number">9</span><span class="token punctuation">)</span> nowHP<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">}</span>
 
<span class="token comment">/************************对是否落到地板上进行判断、处理****************************/</span>
    <span class="token keyword">var</span> StandX<span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> allfloor<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".floor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> n<span class="token operator">=</span>allfloor<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> fx<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>allfloor<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">"margin-left"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> fy<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>allfloor<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">"margin-top"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> relativey<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>allfloor<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"relative"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将木板的relative值转化为int型</span>
            <span class="token keyword">var</span> type<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>allfloor<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将木板的type值转化为int型</span>
            <span class="token keyword">var</span> hx<span class="token operator">=</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>hy<span class="token operator">=</span>position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">onIt</span><span class="token punctuation">(</span>hx<span class="token punctuation">,</span>hy<span class="token punctuation">,</span>fx<span class="token punctuation">,</span>fy<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>ontheFloor<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    ontheFloor<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
                    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>down<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+=</span>relativey<span class="token punctuation">;</span><span class="token comment">//每个地板加了一个属性relative，是人物相对于木板的距离，方便带刺木板人物位置摆放</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>relativey<span class="token operator">==</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>nowHP<span class="token operator">--</span><span class="token punctuation">;</span><span class="token function">shansuo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>type<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        <span class="token function">changefloor4</span><span class="token punctuation">(</span>allfloor<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type<span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                            <span class="token function">floor5Move1</span><span class="token punctuation">(</span>fx<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token function">heroUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    StandX<span class="token operator">=</span>fx<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>hx<span class="token operator">&lt;</span>StandX<span class="token operator">-</span><span class="token number">32</span><span class="token operator">||</span>hx<span class="token operator">&gt;</span>StandX<span class="token operator">+</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>ontheFloor<span class="token operator">==</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>ontheFloor<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span><span class="token function">heroDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>up<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">"check()"</span><span class="token punctuation">,</span><span class="token number">.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/************************对排行榜相关数据处理****************************/</span>
    <span class="token comment">/*var fso=new XMLHttpRequest(Scripting.FileSystemObject);
    var f=fso.createtextfile("data.txt",2,true);
    f.writeLine("wo shi di yi hang"); */</span>

    
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="_458"></a>代码讲解</h3> 
<pre><code>我尽量把讲解的重心放在游戏编程思想和js上面。
</code></pre> 
<blockquote> 
 <p>首先是html的节点结构。无论是编游戏，还是编网页，编程之前做好html节点的树结构是十分重要的事情。</p> 
</blockquote> 
<p>如图：<br> <img src="https://images2.imgbox.com/ed/4e/avuHrL67_o.png" alt="在这里插入图片描述"><br> dom结构大概是这样，方便大家搞清关系。</p> 
<pre><code>container
</code></pre> 
<p>这是一个容器div，背景是截图中的那张山水图片。然后我把这个div居中，其他元素都写在container里面。</p> 
<pre><code>game
</code></pre> 
<p>这也是一个容器div，背景如下：<br> <img src="https://images2.imgbox.com/55/8b/PjNbrxG5_o.png" alt="在这里插入图片描述"><br> 让game居container的中。</p> 
<pre><code>info
</code></pre> 
<p>这里面会显示生命条和分数。</p> 
<pre><code>main
</code></pre> 
<p>main里面有三个div，这才是核心部分。第一个div是菜单，第二个是游戏主页，第三个是排行榜。</p> 
<blockquote> 
 <p>其次是js代码的编写，这是核心。</p> 
</blockquote> 
<p>我们把main的宽高限制在#game（以后的div用#id替代）背景的第三个白色透明框。同样的，#menu，#gamemain，#ranking的宽高也是。</p> 
<h4><a id="js__div_482"></a>js 第一步 切换div的显示与隐藏</h4> 
<p>当我们刚开始打开游戏，出现的应该是菜单页面，在点击“开始游戏”“排行榜”之后，会切换到相应的div。即显示相应的div，隐藏其他的div。</p> 
<pre><code class="prism language-javascript"><span class="token comment">//控制menu、gamemain、ranking的显示</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu_button1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'block'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#ranking"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu_button2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#ranking"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'block'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>对相应的按钮点击后，对不同的div进行显示和隐藏。</p> 
<h4><a id="js__lufylegend_498"></a>js 第二步 在菜单页面用lufylegend插件封装英雄</h4> 
<pre><code class="prism language-javascript"><span class="token comment">/***lufylegend框架封装英雄类*****/</span>
    <span class="token keyword">var</span> loader<span class="token punctuation">,</span>anime<span class="token punctuation">,</span>layer<span class="token punctuation">;</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"menu_hero2"</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span>main<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        loader<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        loader<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>LEvent<span class="token punctuation">.</span><span class="token constant">COMPLETE</span><span class="token punctuation">,</span>loadBItmapdata<span class="token punctuation">)</span><span class="token punctuation">;</span>
        loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>hero_href<span class="token punctuation">[</span>hero_href_key<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"bitmapData"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">loadBItmapdata</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> bitmapdata<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LBitmapData</span><span class="token punctuation">(</span>loader<span class="token punctuation">.</span>content<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> list<span class="token operator">=</span>LGlobal<span class="token punctuation">.</span><span class="token function">divideCoordinate</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        layer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LSprite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addChild</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        anime<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LAnimation</span><span class="token punctuation">(</span>layer<span class="token punctuation">,</span>bitmapdata<span class="token punctuation">,</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
        layer<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>LEvent<span class="token punctuation">.</span><span class="token constant">ENTER_FRAME</span><span class="token punctuation">,</span>onframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">onframe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keydown</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>which<span class="token operator">==</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            anime<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>which<span class="token operator">==</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            anime<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keyup</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            anime<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        anime<span class="token punctuation">.</span><span class="token function">onframe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">heroDie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        layer<span class="token punctuation">.</span><span class="token function">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        layer<span class="token punctuation">.</span><span class="token function">removeAllChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>这里值得注意的是：</p> 
<pre><code class="prism language-javascript"><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"menu_hero2"</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span>main<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>此init()方法表示在#menu_hero2为id的div里面建立一个宽高都为32px的canvas标签，整体速度是50ms一次，回调函数是main()。【建议大家去看一下lufylegend的官方API】</p> 
</blockquote> 
<p>在main()函数中有如下代码：</p> 
<pre><code class="prism language-javascript">loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>hero_href<span class="token punctuation">[</span>hero_href_key<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"bitmapData"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>【划重点！！！】<br> 这里hero_href[hero_href_key]是一个存放我本地英雄图片url的数组。</p> 
</blockquote> 
<p>在main()函数中又调用了loadBItmapdata()函数。loadBItmapdata()函数里有如下代码：</p> 
<pre><code class="prism language-javascript">javascriptvar list<span class="token operator">=</span>LGlobal<span class="token punctuation">.</span><span class="token function">divideCoordinate</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>【划重点！！！】<br> 这是对图片进行分割。长宽都为128px的图片，进行4x4的分割。如下图。这种RPG小游戏的人物图片都是这样的，经过插件封装后会自动循环播放（这里播放速度就和init()函数里面的参数有关啦）。<br> 如果自己用js代码写的话，不一定可以写出来，而且也没有人家的好。<br> <img src="https://images2.imgbox.com/a1/63/yoSxAh7T_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>好了，到这里，lufylegend的使命已经结束了，接下来都是js的功劳了。</p> 
<h4><a id="js___558"></a>js 第三步 在菜单页面实现挑选英雄</h4> 
<pre><code>带大家理清思路。我们要实现的是#menu、#gamemain、#ranking三部分。现在我们已经把#gamemain、
#ranking的display设置为none了，它们消失了，只有#menu存在，所以我们专心做菜单的业务。
</code></pre> 
<p>大家回到最上方看一下我菜单的样式，css我就不再说了，很简单的。在英雄两边设置了两个按钮来改变英雄的样式。<br> 这个要怎么实现呢？</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> hero_href<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>hero_href_key<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">15</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        hero_href<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"css/hero/"</span><span class="token operator">+</span>i<span class="token operator">+</span><span class="token string">".png"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
     <span class="token comment">//控制英雄的切换</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu_hero1 img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>hero_href_key<span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span> hero_href_key<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token function">heroDie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu_hero3 img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>hero_href_key<span class="token operator">&lt;</span><span class="token number">15</span><span class="token punctuation">)</span> hero_href_key<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token function">heroDie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>1’定义一个数组hero_href[]用来存放"css/hero/1.png",“css/hero/2.png”……这样的字符，注意我这里的字符就是我用js访问图片的路径，大家要设置好。<br> 2’定义一个hero_href_key。当点击按钮的时候，hero_href_key会加一或者减一。<br> 3’调用heroDie()函数把页面清空，然后再重新调用main()，但是此时的图片url已经改变，所以英雄会相应改变。</p> 
<h4><a id="js___584"></a>js 第四步 在游戏页面生成英雄</h4> 
<pre><code>这时候菜单页面已经做完了，我们把#menu的display设为none，#gamemain的display设为block。方便调试，
不然每次都要点击一下“开始游戏”按钮。接下来，我们开始做游戏模块！
</code></pre> 
<p>同样的，在点击“开始游戏”按钮后，插件会清除画布，并在#hero里面生成英雄。这时，init()的参数速度不能为&gt;0,因为多次调用init，它的速度参数会叠加。</p> 
<pre><code class="prism language-javascript"><span class="token comment">//控制menu、gamemain、ranking的显示</span>
 <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu_button1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
     <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#menu"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'block'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#ranking"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">heroDie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">init</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"hero"</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span>main<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>定义全局变量，position[0]为英雄的x，position[1]为英雄的y；<br> 监听键盘的左键和右键控制英雄左右移动，并且不可以移出#gamemain之外。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> position<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//全局变量，hero的位置坐标</span>
<span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keydown</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//对英雄移动的键盘操作</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>which<span class="token operator">==</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
             <span class="token punctuation">(</span><span class="token punctuation">(</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">?</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-=</span><span class="token number">3</span><span class="token punctuation">;</span>
             <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#hero"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-left'</span><span class="token punctuation">,</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>which<span class="token operator">==</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
             <span class="token punctuation">(</span><span class="token punctuation">(</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">398</span><span class="token punctuation">)</span><span class="token operator">?</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">398</span><span class="token punctuation">:</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">;</span>
             <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#hero"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-left'</span><span class="token punctuation">,</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>

 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="js___614"></a>js 第五步 在游戏页面制作滚动的背景</h4> 
<pre><code class="prism language-javascript"><span class="token comment">/***封装游戏背景类*****/</span>
 <span class="token keyword">var</span> bgHeight<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
 <span class="token keyword">function</span> <span class="token function">background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
     bgHeight<span class="token operator">+=</span><span class="token number">2</span><span class="token punctuation">;</span>
     <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'background'</span><span class="token punctuation">,</span><span class="token string">'url("css/img/gamemain_bg.png") 0px '</span><span class="token operator">+</span>bgHeight<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>bgHeight<span class="token operator">&gt;=</span><span class="token number">550</span><span class="token punctuation">)</span> bgHeight<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//防止bgHeight过大</span>
     <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">'background()'</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token function">background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>这里的技巧主要在css的background上，大家不妨去查一下background的参数。首先，我设置background是可以repeat的（没写默认可以），然后再定义y方向上的偏移量。最后每50ms执行一次其y上的偏移量加2。【值得注意的是，虽然背景图片是一张，但是拼接起来要看不出来分界线才行，要不然滚动也没意义】</p> 
<h4><a id="js___628"></a>js 第六步 在游戏页面添加地板！</h4> 
<pre><code class="prism language-javascript"><span class="token comment">/*********封装地板****************/</span>
 <span class="token keyword">function</span> <span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
     <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
     <span class="token keyword">var</span> img<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">var</span> floorx<span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">370</span><span class="token punctuation">;</span>
     <span class="token keyword">var</span> floory<span class="token operator">=</span><span class="token number">530</span><span class="token punctuation">;</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">createFloor1</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//地板1类</span>
         img<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
             <span class="token string">'src'</span><span class="token punctuation">:</span><span class="token string">'css/img/floor1.png'</span><span class="token punctuation">,</span>
             <span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'floor'</span><span class="token punctuation">,</span>
             <span class="token string">'relative'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
             <span class="token string">'type'</span><span class="token punctuation">:</span><span class="token number">1</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
             <span class="token string">'margin-left'</span><span class="token punctuation">:</span>floorx<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
             <span class="token string">'margin-top'</span><span class="token punctuation">:</span>floory<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         
         <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">createFloor2</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//地板2类</span>
         img<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
             <span class="token string">'src'</span><span class="token punctuation">:</span><span class="token string">'css/img/floor2.png'</span><span class="token punctuation">,</span>
             <span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'floor'</span><span class="token punctuation">,</span>
             <span class="token string">'relative'</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span>
             <span class="token string">'type'</span><span class="token punctuation">:</span><span class="token number">1</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
             <span class="token string">'margin-left'</span><span class="token punctuation">:</span>floorx<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
             <span class="token string">'margin-top'</span><span class="token punctuation">:</span>floory<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         
         <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">createFloor3</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//地板3类</span>
         img<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
             <span class="token string">'src'</span><span class="token punctuation">:</span><span class="token string">'css/img/floor3.png'</span><span class="token punctuation">,</span>
             <span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'floor'</span><span class="token punctuation">,</span>
             <span class="token string">'relative'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
             <span class="token string">'type'</span><span class="token punctuation">:</span><span class="token number">1</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
             <span class="token string">'margin-left'</span><span class="token punctuation">:</span>floorx<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
             <span class="token string">'margin-top'</span><span class="token punctuation">:</span>floory<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         
         <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">createFloor4</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//地板4类 会消失的地板</span>
         img<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
             <span class="token string">'src'</span><span class="token punctuation">:</span><span class="token string">'css/img/floor4in1.png'</span><span class="token punctuation">,</span>
             <span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'floor'</span><span class="token punctuation">,</span>
             <span class="token string">'relative'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
             <span class="token string">'type'</span><span class="token punctuation">:</span><span class="token number">2</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
             <span class="token string">'margin-left'</span><span class="token punctuation">:</span>floorx<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
             <span class="token string">'margin-top'</span><span class="token punctuation">:</span>floory<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         
         <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">createFloor5</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//地板5类 会滚动的地板</span>
         img<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
             <span class="token string">'src'</span><span class="token punctuation">:</span><span class="token string">'css/img/floor5.gif'</span><span class="token punctuation">,</span>
             <span class="token string">'id'</span><span class="token punctuation">:</span><span class="token string">'floor5'</span><span class="token punctuation">,</span>
             <span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'floor'</span><span class="token punctuation">,</span>
             <span class="token string">'relative'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
             <span class="token string">'type'</span><span class="token punctuation">:</span><span class="token number">3</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
             <span class="token string">'margin-left'</span><span class="token punctuation">:</span>floorx<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
             <span class="token string">'margin-top'</span><span class="token punctuation">:</span>floory<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">,</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         
         <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#gamemain"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">run</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>floory<span class="token operator">&gt;=</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span>
         <span class="token punctuation">{<!-- --></span>
             floory<span class="token operator">-=</span><span class="token number">2</span><span class="token punctuation">;</span>
             img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-top'</span><span class="token punctuation">,</span>floory<span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token function">setTimeout</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>run<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">else</span>
         <span class="token punctuation">{<!-- --></span>
             img<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             img<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             score<span class="token operator">++</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre> 
<p>首先，我们来封装个地板类。我们把地板的x坐标设为随机，y坐标固定在底部。<br> 然后，不同的createfloor函数，它们的url不同（即图片的样式，是地板还是尖刺还是弹簧……），relative不同（针对尖刺地板，假设图片高是20px，对于一般木板，英雄可以直接站上去，但是带刺的木板，英雄要踩刺，得再往下站一些，所以定义relative相当于木板和英雄的相对距离），type不同（不同类型木板，英雄站上去之后有不同的函数去执行）。<br> 最后，我们让每一个createfloor函数都去执行run函数，来控制木板上升，当木板上升到最上方时，把木板删去，分数+1。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">myfloor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//创建地板</span>
    <span class="token keyword">var</span> ppp<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">floor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> ppp<span class="token punctuation">.</span><span class="token function">createFloor1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span> ppp<span class="token punctuation">.</span><span class="token function">createFloor2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span> ppp<span class="token punctuation">.</span><span class="token function">createFloor3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">4</span><span class="token punctuation">)</span> ppp<span class="token punctuation">.</span><span class="token function">createFloor4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">5</span><span class="token punctuation">)</span> ppp<span class="token punctuation">.</span><span class="token function">createFloor5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">'myfloor()'</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>每隔0.5秒随机创建五种木板里的一种出来。</p> 
<h4><a id="js___743"></a>js 第七步 定义英雄上升、下降、死亡函数</h4> 
<p>首先这里面的数值不是随便设置的，不然没有游戏体验的。<br> 封装出英雄上升，下降，死亡函数。<br> 在踩到地板时上升；脚下没有地板时下降，碰到上方的刺或者掉落判断死亡。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> down<span class="token punctuation">,</span>up<span class="token punctuation">,</span>move<span class="token punctuation">;</span>
   <span class="token keyword">function</span> <span class="token function">heroDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//英雄自由下落</span>
       position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+=</span>gspeed<span class="token punctuation">;</span>
       <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#hero"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-top'</span><span class="token punctuation">,</span>position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       down<span class="token operator">=</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">"heroDown()"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">function</span> <span class="token function">heroUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//英雄随地板上升，此函数与floor类的run函数数值同步</span>
       position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-=</span><span class="token number">2</span><span class="token punctuation">;</span>
       <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#hero"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-top'</span><span class="token punctuation">,</span>position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       up<span class="token operator">=</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">"heroUp()"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">function</span> <span class="token function">isdie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//对英雄向上触碰、向下掉底直接死亡，设置nowHP=0，然后交给‘生命条显示’函数来做英雄死亡后的事件</span>
       <span class="token keyword">var</span> y<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#hero"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'margin-top'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span>y<span class="token operator">&gt;=</span><span class="token number">520</span><span class="token operator">||</span>y<span class="token operator">&lt;=</span><span class="token number">9</span><span class="token punctuation">)</span> nowHP<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
       
   <span class="token punctuation">}</span>
</code></pre> 
<h4><a id="js___765"></a>js 第八步 英雄与地板开始作用</h4> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> StandX<span class="token punctuation">;</span>
 <span class="token keyword">function</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
     <span class="token keyword">var</span> allfloor<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".floor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">var</span> n<span class="token operator">=</span>allfloor<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
         <span class="token keyword">var</span> fx<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>allfloor<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">"margin-left"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">var</span> fy<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>allfloor<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">"margin-top"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">var</span> relativey<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>allfloor<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"relative"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将木板的relative值转化为int型</span>
         <span class="token keyword">var</span> type<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>allfloor<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将木板的type值转化为int型</span>
         <span class="token keyword">var</span> hx<span class="token operator">=</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>hy<span class="token operator">=</span>position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">onIt</span><span class="token punctuation">(</span>hx<span class="token punctuation">,</span>hy<span class="token punctuation">,</span>fx<span class="token punctuation">,</span>fy<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>ontheFloor<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token punctuation">{<!-- --></span>
                 ontheFloor<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
                 <span class="token function">clearTimeout</span><span class="token punctuation">(</span>down<span class="token punctuation">)</span><span class="token punctuation">;</span>
                 position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+=</span>relativey<span class="token punctuation">;</span><span class="token comment">//每个地板加了一个属性relative，是人物相对于木板的距离，方便带刺木板人物位置摆放</span>
                 <span class="token keyword">if</span><span class="token punctuation">(</span>relativey<span class="token operator">==</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>nowHP<span class="token operator">--</span><span class="token punctuation">;</span><span class="token function">shansuo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
                 <span class="token keyword">if</span><span class="token punctuation">(</span>type<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                     <span class="token function">changefloor4</span><span class="token punctuation">(</span>allfloor<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token punctuation">}</span>
                 <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type<span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                         <span class="token function">floor5Move1</span><span class="token punctuation">(</span>fx<span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token punctuation">}</span>
                 <span class="token function">heroUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 StandX<span class="token operator">=</span>fx<span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>hx<span class="token operator">&lt;</span>StandX<span class="token operator">-</span><span class="token number">32</span><span class="token operator">||</span>hx<span class="token operator">&gt;</span>StandX<span class="token operator">+</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>ontheFloor<span class="token operator">==</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token punctuation">{<!-- --></span>ontheFloor<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span><span class="token function">heroDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>up<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>

     <span class="token punctuation">}</span>
     <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">"check()"</span><span class="token punctuation">,</span><span class="token number">.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> 
<p>这算是核心代码了。<br> 解释如下：</p> 
<pre><code>1，定义一个check函数，每0.5ms执行一次，一秒2000次。
2，每次都干什么事情呢？
   每次都获取当前页面存在的地板对象，放在一个数组里面。然后用for循环遍历（暴力方式，所以是小游戏，大游戏
   得考虑算法和数据结构优化的）每个对象是不是碰到英雄了，并且ontheFloor这个flag也很重要。
   onIt(hx,hy,fx,fy)函数是我刚开始封装的，判断英雄有没有站在地板上。
3，如果在地板上了，调用heroup函数，控制英雄与地板同步上升。之后开始判断是哪个地板。如果relative==10（带
	刺木板），那么英雄life-1，并且闪烁三次，并且再向下移动10px才行。如果是type==2（会消失的地板），那
	么英雄站上去之后，每隔300ms此地板换一个样式，三次之后木板消失，英雄继续下落。如果是type==3（水平传
	送带），那么……
4，如果英雄脚下没有地板了，那么停止heroup函数，执行herodown。
</code></pre> 
<h4><a id="js___812"></a>js 第九步 添加生命条、分数、声音显示</h4> 
<pre><code class="prism language-javascript"><span class="token comment">//分数显示</span>
 <span class="token keyword">var</span> score_pic<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token string">'css/img/0.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/1.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/2.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/3.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/4.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/5.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/6.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/7.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/8.png'</span><span class="token punctuation">,</span><span class="token string">'css/img/9.png'</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> score<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
 <span class="token keyword">function</span> <span class="token function">displayScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
     <span class="token keyword">var</span> s<span class="token operator">=</span>score<span class="token punctuation">;</span>
     <span class="token keyword">var</span> score0<span class="token operator">=</span>s<span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
     <span class="token keyword">var</span> score1<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>s<span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
     <span class="token keyword">var</span> score2<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>s<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
     <span class="token keyword">var</span> score3<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>s<span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".info_score_num img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span>score_pic<span class="token punctuation">[</span>score0<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".info_score_num img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span>score_pic<span class="token punctuation">[</span>score1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".info_score_num img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span>score_pic<span class="token punctuation">[</span>score2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".info_score_num img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span>score_pic<span class="token punctuation">[</span>score3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">'displayScore()'</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token comment">//生命条显示</span>
 <span class="token keyword">var</span> deadflag<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
 <span class="token keyword">function</span> <span class="token function">displayLife</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
     <span class="token function">isdie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#info_life"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">,</span>nowHP<span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span><span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>nowHP<span class="token operator">&lt;=</span><span class="token number">4</span><span class="token operator">&amp;&amp;</span>nowHP<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#info_life"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'background'</span><span class="token punctuation">,</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>nowHP<span class="token operator">==</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>deadflag<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token function">playMusic</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>deadflag<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
     <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">'displayLife()'</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">function</span> <span class="token function">playMusic</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
     <span class="token keyword">var</span> player <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#player"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token punctuation">{<!-- --></span>
         player<span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">'css/sound/dead.mp3'</span><span class="token punctuation">;</span>
         player<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
         
     
 <span class="token punctuation">}</span>
</code></pre> 
<p>分数显示：<br> 我的分数是用图片显示的。就是获取score后，得到个、十、百、千位的值，然后对应我的数字（艺术字样式）的图片显示出来。和之前英雄的显示类似。<br> 生命条显示：<br> 我把生命分成12份，每少1，生命条的宽度小8.3%，当nowHP小于4，设置生命条颜色为红色。<br> 声音：<br> 当nowHP为0，执行声音函数，播放死亡的音效。</p> 
<h4><a id="js___855"></a>js 第十步 排行榜</h4> 
<pre><code>排行榜，我有三种方法去实现。但是我这个游戏也不是多人玩的，不想做排行榜。
</code></pre> 
<p>方法介绍给大家：<br> 1，运用php+mysql。<br> 用php写好之后，把获取的值转递给页面，页面来显示。<br> 但是，php文件必须在xampp目录下才可以运行，意味着，我要把html、js文件都移过去。麻烦。<br> 2，运用txt文本。<br> 大家学c的时候，一定操作过用c来对txt流进行读和写吧。<br> 就是这种思想。<br> 第一，每次游戏结束后，你要对玩家的姓名和分数进行写入。<br> 第二，每次打开排行榜，你要读取txt文本，获取值。因为txt文本的特性，所以读取之后你要进行数据提取稍微麻烦一点点（相信大家领会我的意思）。<br> 3，用js/json文件，存数据。<br> 但是好像只能读不能写。</p> 
<h3><a id="_871"></a>进行下一个游戏的开发！</h3> 
<p><a href="https://blog.csdn.net/qq_43592352/article/details/88058449">飞机大战h5小游戏开发</a><br> <a href="https://blog.csdn.net/qq_43592352/article/details/90383837">指尖大冒险、跳一跳升级版html5游戏全代码</a></p> 
<h3><a id="_874"></a>总结</h3> 
<p>虽然引用了一些框架，但是都是浅尝辄止。而且对英雄和地板的判断那一块，都是靠for循环，和时间函数来暴力执行（一秒2000次，我都害怕）。所以多看点算法，数据结构，框架还是很重要的，可以进行代码的优化，使其效率更高、更准确。<br> 继承也是一个很重要的地方。比如地板，我本可以定义一个父类，然后对每种类型的地板进行继承父类，然后重写函数，不但节约代码，效率也高。但是我看了找js的书，也没有找到一种好的办法来继承（因为floor里面还有一个Image对象，我其实操作的是Image对象，但是Image对象是不可以编写定义的），所以只好把所有的地板都放在一个类中，用不同的函数名来区分。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c20b032062498d506b0eb9a91502d92c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Oracle--其他复杂查询</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9eb8eb9bfc0bc9293cb9a473ac15df0a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Chrome浏览器占用内存过高解决办法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>