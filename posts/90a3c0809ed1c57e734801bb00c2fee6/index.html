<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>项目集成七牛云存储sdk - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="项目集成七牛云存储sdk" />
<meta property="og:description" content="以PHP为例
第一步：下载sdk
PHP SDK_SDK 下载_对象存储 - 七牛开发者中心
sdk下载成功之后，将sdk放入项目中，目录选择以自己项目实际情况而定。
注意：在examples目录中有各种上传文件的参考示例，这里我们主要参考的是下面两个
第二步：注册七牛账号
注册账号之后，进入控制台并创建存储桶，配置加速域名。
第三步：获取七牛密钥。
获取此处的ak sk备用。
代码部分：
1：引入sdk
//七牛 require_once API_ROOT. &#39;/public/qiniu/autoload.php&#39;; //以自己实际项目路径为准 use Qiniu\Auth; use Qiniu\Zone; use Qiniu\Config; use Qiniu\Storage\UploadManager; 2：构造上传方法 function updateImg(){ $rs = array(&#39;code&#39; =&gt; 0 , &#39;msg&#39; =&gt; &#39;&#39;, &#39;info&#39; =&gt; array()); $accessKey=&#34;填写ak&#34;; $secretKey=&#34;填写sk&#34;; $bucket=&#34;填写存储桶名称&#34;; // 构建鉴权对象 $auth = new Auth($accessKey, $secretKey); // 生成上传 Token $token = $auth-&gt;uploadToken($bucket); $filePath = $_FILES[&#39;file&#39;][&#39;tmp_name&#39;]; $filename=$_FILES[&#39;file&#39;][&#39;name&#39;]; $filename_arr = explode(&#34;.&#34;,$filename); //文件后缀 $file_suffix=$filename_arr[1]; //上传文件名称 $key = date(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/90a3c0809ed1c57e734801bb00c2fee6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-28T16:51:13+08:00" />
<meta property="article:modified_time" content="2023-09-28T16:51:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">项目集成七牛云存储sdk</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>以PHP为例</p> 
<p><strong>第一步：下载sdk</strong></p> 
<p><a href="https://developer.qiniu.com/kodo/1241/php#1" rel="nofollow" title="PHP SDK_SDK 下载_对象存储 - 七牛开发者中心">PHP SDK_SDK 下载_对象存储 - 七牛开发者中心</a></p> 
<p>sdk下载成功之后，将sdk放入项目中，目录选择以自己项目实际情况而定。</p> 
<p><img alt="" height="448" src="https://images2.imgbox.com/6d/a6/uuwigjOq_o.png" width="648"></p> 
<p></p> 
<p>注意：在examples目录中有各种上传文件的参考示例，这里我们主要参考的是下面两个</p> 
<p><img alt="" height="167" src="https://images2.imgbox.com/0d/61/APXw5RPP_o.png" width="539"></p> 
<p><strong>第二步：注册七牛账号</strong></p> 
<p>注册账号之后，进入控制台并创建存储桶，配置加速域名。</p> 
<p><strong>第三步：获取七牛密钥。</strong></p> 
<p><img alt="" height="353" src="https://images2.imgbox.com/64/b3/clOBPBon_o.png" width="257"></p> 
<p>获取此处的ak  sk备用。</p> 
<p><img alt="" height="221" src="https://images2.imgbox.com/4d/f5/6fHBGjzA_o.png" width="749"></p> 
<p></p> 
<p>代码部分：</p> 
<p>1：引入sdk</p> 
<p><img alt="" height="252" src="https://images2.imgbox.com/73/45/dAklzysG_o.png" width="694"></p> 
<pre><code class="language-php">//七牛
require_once API_ROOT. '/public/qiniu/autoload.php'; //以自己实际项目路径为准
use Qiniu\Auth;
use Qiniu\Zone;
use Qiniu\Config;
use Qiniu\Storage\UploadManager;</code></pre> 
<p>2：构造上传方法 </p> 
<pre><code class="language-php">function updateImg(){
    $rs = array('code' =&gt; 0 , 'msg' =&gt; '', 'info' =&gt; array());
    
    $accessKey="填写ak";
	$secretKey="填写sk";
	$bucket="填写存储桶名称";

    // 构建鉴权对象
	$auth = new Auth($accessKey, $secretKey);
    // 生成上传 Token
	$token = $auth-&gt;uploadToken($bucket);
    
	$filePath = $_FILES['file']['tmp_name'];
	$filename=$_FILES['file']['name'];
	$filename_arr = explode(".",$filename);
    
    //文件后缀
	$file_suffix=$filename_arr[1];
    //上传文件名称
	$key = date("YmdHis").rand(999,99999).".".$file_suffix;

	// 华东：z0，华北：z1，华南：z2，北美：na0，东南亚：as0
	switch ($configpri['qiniu_zone']) {
		case 'z0':
		    $zone = Zone::zonez0();
		    break;

		case 'z1':
			$zone = Zone::zonez1();
			break;

		case 'z2':
			$zone = Zone::zonez2();
			break;

		case 'na0':
			$zone = Zone::zonena0();
			break;

		case 'as0':
			$zone = Zone::zoneas0();
			break;
				
		default:
			$zone = Zone::zonez0();
			break;
	}
	
    // 指定 zone 上传		
	$config = new Config($zone);
	
	$uploadMgr = new UploadManager($config);
	list($ret, $err) = $uploadMgr-&gt;putFile($token, $key, $filePath);
			
	if ($err !== null) {
		$rs['code']=1001;
		$rs['msg']='头像上传失败';
		return $rs;
	}

	if (!empty($ret)) {
		$avatar=  $key;
		//以下可执行自己的代码

	}

}</code></pre> 
<p>3：form表单上传图片测试</p> 
<p>注意：此处form表单提交地址action要根据自己项目实际情况做修改</p> 
<pre><code class="language-php">&lt;form method="post" enctype="multipart/form-data" action="http://xxxxx.com/appapi/index.php?service=User.updateImg"&gt;

		图片：&lt;input type="file" name="file" &gt;&lt;br /&gt;
		&lt;input type="submit" value="提交"&gt;
	&lt;/form&gt;</code></pre> 
<p>4：打印结果：</p> 
<p><img alt="" height="100" src="https://images2.imgbox.com/92/ed/7YbsVCnS_o.png" width="320"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/84ec9f520bbb90d74b0b59770745ef8a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用Python来写猜数字小游戏</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/500803ad475b92acdfd044c51331e218/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">用Python来画满屏不重复的圆</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>