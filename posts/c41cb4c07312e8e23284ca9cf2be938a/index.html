<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【开发杂记】基于Python和TK的exe应用程序开发 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【开发杂记】基于Python和TK的exe应用程序开发" />
<meta property="og:description" content="0 前言 一开始也没想到要做这个，人力的领导嫌用Excel太烦了想把一些机械重复劳动以程序替换，所以产生了这个需求。由于是面向个人需求开发的产品，所以做成单机的，一套做下来感觉事倍功半，以后还是B/S架构做成网页好点，这里避免工作浪费在这里总结一下全过程。
目录 0 前言1 数据2 需求3 GUI工具TK（tkinter）4 功能实现4.1 整体框架4.11主界面4.12 主界面配件 4.2 上传功能实现4.3 查询功能实现4.31 查询条件交互功能实现4.32 查询算法实现4.33 查询结果展示功能实现 4.4 业务计算功能实现4.5 结果保存功能实现4.6 全局滚动条实现 5 打包成.exe文件6 完整代码 1 数据 数据是员工技能考试数据，进行了简单的脱敏处理，大致如下：
2 需求 其实需求没有太复杂，实现简单只是效率和前端上经不起考验。
实现表格的查询功能包括单条件查询和多条件查询。实现简单的业务计算并产生报表。所有功能要交互完成。 3 GUI工具TK（tkinter） 用python做GUI的情况应该比较少，我也就随大流选了TK工具包，其难点还是在于网格式布局的理解以及功能套件封装没有那么易用，比如滚轮滑动都费了较大力气才弄好,对这方面感兴趣的可以看Python的GUI图形界面工具大全。
4 功能实现 4.1 整体框架 TK的布局分为层级式和网格式，当然网格式比较灵活，但比较难分清楚每个部件构成。本文采取的是网格式，就像画画一样，所有功能按钮都是一层层铺上去的，这里先建个底层，也就是主界面。
4.11主界面 主界面采用全屏展示，再把横竖的滚动条也加上，注意此处的滚动条仅有其形，功能还没加上。
root = tk.Tk() root.title(&#34;乐川考试系统&#34;) # #窗口标题 w = root.winfo_screenwidth() h = root.winfo_screenheight() root.geometry(&#34;%dx%d&#34; %(w,h)) canvas= tk.Canvas(root, width=w, height=h) xscrollbar = tk.Scrollbar(root,orient=tk.HORIZONTAL) yscrollbar = tk.Scrollbar(root) yscrollbar.config(command=canvas.yview) yscrollbar.pack(side=tk.RIGHT, fill=tk.Y) xscrollbar." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c41cb4c07312e8e23284ca9cf2be938a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-16T15:49:29+08:00" />
<meta property="article:modified_time" content="2022-01-16T15:49:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【开发杂记】基于Python和TK的exe应用程序开发</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="0__0"></a>0 前言</h2> 
<p>   一开始也没想到要做这个，人力的领导嫌用Excel太烦了想把一些机械重复劳动以程序替换，所以产生了这个需求。由于是面向个人需求开发的产品，所以做成单机的，一套做下来感觉事倍功半，以后还是B/S架构做成网页好点，这里避免工作浪费在这里总结一下全过程。<br> </p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#0__0" rel="nofollow">0 前言</a></li><li><a href="#1__5" rel="nofollow">1 数据</a></li><li><ul><li><a href="#2__9" rel="nofollow">2 需求</a></li><li><a href="#3_GUITKtkinter_15" rel="nofollow">3 GUI工具TK（tkinter）</a></li><li><a href="#4__17" rel="nofollow">4 功能实现</a></li><li><ul><li><a href="#41__18" rel="nofollow">4.1 整体框架</a></li><li><ul><li><a href="#411_20" rel="nofollow">4.11主界面</a></li><li><a href="#412__40" rel="nofollow">4.12 主界面配件</a></li></ul> 
    </li><li><a href="#42__78" rel="nofollow">4.2 上传功能实现</a></li><li><a href="#43__85" rel="nofollow">4.3 查询功能实现</a></li><li><ul><li><a href="#431__88" rel="nofollow">4.31 查询条件交互功能实现</a></li><li><a href="#432__127" rel="nofollow">4.32 查询算法实现</a></li><li><a href="#433__143" rel="nofollow">4.33 查询结果展示功能实现</a></li></ul> 
    </li><li><a href="#44__184" rel="nofollow">4.4 业务计算功能实现</a></li><li><a href="#45__237" rel="nofollow">4.5 结果保存功能实现</a></li><li><a href="#46__253" rel="nofollow">4.6 全局滚动条实现</a></li></ul> 
  </li></ul> 
  </li><li><a href="#5_exe_264" rel="nofollow">5 打包成.exe文件</a></li><li><a href="#6__266" rel="nofollow">6 完整代码</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1__5"></a>1 数据</h2> 
<p>  数据是员工技能考试数据，进行了简单的脱敏处理，大致如下：<br> <img src="https://images2.imgbox.com/3f/bd/iIE7A3hR_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2__9"></a>2 需求</h3> 
<p>  其实需求没有太复杂，实现简单只是效率和前端上经不起考验。</p> 
<ul><li>实现表格的查询功能包括单条件查询和多条件查询。</li><li>实现简单的业务计算并产生报表。</li><li>所有功能要交互完成。</li></ul> 
<h3><a id="3_GUITKtkinter_15"></a>3 GUI工具TK（tkinter）</h3> 
<p>  用python做GUI的情况应该比较少，我也就随大流选了TK工具包，其难点还是在于网格式布局的理解以及功能套件封装没有那么易用，比如滚轮滑动都费了较大力气才弄好,对这方面感兴趣的可以看<a href="https://zhuanlan.zhihu.com/p/347290491?ivk_sa=1024320u" rel="nofollow">Python的GUI图形界面工具大全</a>。</p> 
<h3><a id="4__17"></a>4 功能实现</h3> 
<h4><a id="41__18"></a>4.1 整体框架</h4> 
<p>  TK的布局分为层级式和网格式，当然网格式比较灵活，但比较难分清楚每个部件构成。本文采取的是网格式，就像画画一样，所有功能按钮都是一层层铺上去的，这里先建个底层，也就是主界面。</p> 
<h5><a id="411_20"></a>4.11主界面</h5> 
<p>  主界面采用全屏展示，再把横竖的滚动条也加上，注意此处的滚动条仅有其形，功能还没加上。</p> 
<pre><code class="prism language-python">root <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
root<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"乐川考试系统"</span><span class="token punctuation">)</span>    <span class="token comment"># #窗口标题</span>
w <span class="token operator">=</span> root<span class="token punctuation">.</span>winfo_screenwidth<span class="token punctuation">(</span><span class="token punctuation">)</span>
h <span class="token operator">=</span> root<span class="token punctuation">.</span>winfo_screenheight<span class="token punctuation">(</span><span class="token punctuation">)</span>
root<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">"%dx%d"</span> <span class="token operator">%</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span>
canvas<span class="token operator">=</span> tk<span class="token punctuation">.</span>Canvas<span class="token punctuation">(</span>root<span class="token punctuation">,</span> width<span class="token operator">=</span>w<span class="token punctuation">,</span> height<span class="token operator">=</span>h<span class="token punctuation">)</span>
xscrollbar <span class="token operator">=</span> tk<span class="token punctuation">.</span>Scrollbar<span class="token punctuation">(</span>root<span class="token punctuation">,</span>orient<span class="token operator">=</span>tk<span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span>
yscrollbar <span class="token operator">=</span> tk<span class="token punctuation">.</span>Scrollbar<span class="token punctuation">(</span>root<span class="token punctuation">)</span>
yscrollbar<span class="token punctuation">.</span>config<span class="token punctuation">(</span>command<span class="token operator">=</span>canvas<span class="token punctuation">.</span>yview<span class="token punctuation">)</span>
yscrollbar<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>RIGHT<span class="token punctuation">,</span> fill<span class="token operator">=</span>tk<span class="token punctuation">.</span>Y<span class="token punctuation">)</span> 
xscrollbar<span class="token punctuation">.</span>config<span class="token punctuation">(</span>command<span class="token operator">=</span>canvas<span class="token punctuation">.</span>xview<span class="token punctuation">)</span>
xscrollbar<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>BOTTOM<span class="token punctuation">,</span> fill<span class="token operator">=</span>tk<span class="token punctuation">.</span>X<span class="token punctuation">)</span> 
canvas<span class="token punctuation">.</span>config<span class="token punctuation">(</span>xscrollcommand<span class="token operator">=</span>xscrollbar<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">,</span>yscrollcommand<span class="token operator">=</span>yscrollbar<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">)</span>
canvas<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span><span class="token string">"left"</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token string">"both"</span><span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment">#side=LEFT,expand=True,fill=BOTH</span>
main_frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>canvas<span class="token punctuation">)</span>
canvas<span class="token punctuation">.</span>create_window<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>window<span class="token operator">=</span>main_frm<span class="token punctuation">,</span> anchor<span class="token operator">=</span><span class="token string">'nw'</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="412__40"></a>4.12 主界面配件</h5> 
<p>  初始界面很简单，就文件上传(数据加载)和功能按钮栏。<br> <img src="https://images2.imgbox.com/c6/aa/FFWo3U5N_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># In[]</span>
path <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment"># #创建变量，便于取值</span>
path<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>

upload_frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>master<span class="token operator">=</span>main_frm<span class="token punctuation">)</span> <span class="token comment">#上传组件</span>
upload_frm<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

entry1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>upload_frm<span class="token punctuation">,</span>textvariable<span class="token operator">=</span>path<span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token string">'40'</span><span class="token punctuation">)</span>

entry1<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
btn <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>upload_frm<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'上传文件'</span><span class="token punctuation">,</span> command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span>upload_file<span class="token punctuation">(</span>upload_frm<span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>


func_frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>main_frm<span class="token punctuation">)</span> <span class="token comment">#功能索引</span>
<span class="token comment"># func_frm.pack()</span>
func_frm<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
select_button <span class="token operator">=</span>tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>func_frm<span class="token punctuation">,</span>bg<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'进入查询界面'</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
                            command<span class="token operator">=</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span>select<span class="token punctuation">(</span>main_frm<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">)</span>
select_button<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># select_button.pack()</span>

func_button_1 <span class="token operator">=</span>tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>func_frm<span class="token punctuation">,</span>bg<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'功能按钮2'</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
                            command<span class="token operator">=</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span>func_cal_pass<span class="token punctuation">(</span>main_frm<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">)</span>
func_button_1<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

func_button_2 <span class="token operator">=</span>tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>func_frm<span class="token punctuation">,</span>bg<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'功能按钮3'</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
                            command<span class="token operator">=</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span>func3<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
func_button_2<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>


cur_row <span class="token operator">=</span> <span class="token number">2</span>
</code></pre> 
<h4><a id="42__78"></a>4.2 上传功能实现</h4> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">upload_file</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    selectFile <span class="token operator">=</span> filedialog<span class="token punctuation">.</span>askopenfilename<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># askopenfilename 1次上传1个；askopenfilenames1次上传多个</span>
    entry1<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> selectFile<span class="token punctuation">)</span>
    path<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>selectFile<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="43__85"></a>4.3 查询功能实现</h4> 
<p>  查询主要由查询条件、查询算法、结果展示三部分构成。<br> <img src="https://images2.imgbox.com/d6/44/TT9rGiyh_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="431__88"></a>4.31 查询条件交互功能实现</h5> 
<p>  这里展示出数据所有的列，再根据每一列的需求进行筛选。这里只做了“==”的条件查询。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">select</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data_path <span class="token operator">=</span> path<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>data_path<span class="token punctuation">)</span>
    data <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> 
    data <span class="token operator">=</span> data<span class="token punctuation">.</span>applymap<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span>

    colnms <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
            
    values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>nm<span class="token punctuation">]</span><span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> nm <span class="token keyword">in</span> colnms<span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'--请选择'</span><span class="token punctuation">)</span>
        values<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># print(values)</span>
    
    start_row <span class="token operator">=</span> <span class="token number">3</span>
    start_col <span class="token operator">=</span> <span class="token number">0</span>
    QCONDI_ROW_CNTS <span class="token operator">=</span> <span class="token number">5</span> <span class="token comment">#查询条件多少行一列</span>
    textvs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token builtin">len</span><span class="token punctuation">(</span>colnms<span class="token punctuation">)</span>
    <span class="token keyword">global</span> cur_row
    condi_frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>master<span class="token operator">=</span>root<span class="token punctuation">)</span>
    <span class="token comment"># condi_frm.pack()</span>
    condi_frm<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>cur_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>colnms<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        textvs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>master<span class="token operator">=</span>condi_frm<span class="token punctuation">)</span>
        frm<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row <span class="token operator">=</span> start_row <span class="token operator">+</span> i<span class="token operator">%</span>QCONDI_ROW_CNTS<span class="token punctuation">,</span>column <span class="token operator">=</span> start_col<span class="token operator">+</span>i<span class="token operator">//</span>QCONDI_ROW_CNTS<span class="token punctuation">,</span>sticky <span class="token operator">=</span> E<span class="token punctuation">)</span>
        com <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Combobox<span class="token punctuation">(</span>frm<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>textvs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>     <span class="token comment"># #创建下拉菜单</span>
        tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>frm<span class="token punctuation">,</span> text <span class="token operator">=</span> colnms<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span> start_row <span class="token operator">+</span> i<span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>sticky <span class="token operator">=</span> W<span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>pady<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        com<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>start_row <span class="token operator">+</span> i<span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>sticky <span class="token operator">=</span> E<span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>     <span class="token comment"># #将下拉菜单绑定到窗体</span>
        com<span class="token punctuation">[</span><span class="token string">"value"</span><span class="token punctuation">]</span> <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span>   
        com<span class="token punctuation">.</span>current<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    
        cur_row <span class="token operator">=</span> start_row <span class="token operator">+</span> i
    query_button <span class="token operator">=</span>tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span>bg<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'查询'</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span>query<span class="token punctuation">(</span>root<span class="token punctuation">,</span>data<span class="token punctuation">,</span>textvs<span class="token punctuation">)</span><span class="token punctuation">)</span>
    query_button<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>cur_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> columnspan<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
    root<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="432__127"></a>4.32 查询算法实现</h5> 
<p>  其实就是数据库的单表查询，直接用最笨的方法，筛完一个再继续，直到为空或者条件筛完。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">query</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span>data<span class="token punctuation">,</span>textvs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> cur_row
    ipts <span class="token operator">=</span> <span class="token punctuation">[</span>v<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> v <span class="token keyword">in</span> textvs<span class="token punctuation">]</span>
    DEFALUT <span class="token operator">=</span> <span class="token string">'--请选择'</span>
    colnms <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
    sub_data <span class="token operator">=</span> data<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>ipts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> ipts<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> DEFALUT<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            sub_data <span class="token operator">=</span> sub_data<span class="token punctuation">[</span>sub_data<span class="token punctuation">[</span>colnms<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">==</span>ipts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
    show_data<span class="token punctuation">(</span>root<span class="token punctuation">,</span>sub_data<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="433__143"></a>4.33 查询结果展示功能实现</h5> 
<p>  最多展示只展示10条。<img src="https://images2.imgbox.com/87/33/cw0Tbasj_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">show_data</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span>sub_data<span class="token punctuation">,</span>detail_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> cur_row
    cur_row <span class="token operator">=</span> <span class="token number">10</span>
    table_frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>root<span class="token punctuation">)</span>
    table_frm<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>cur_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    cur_row <span class="token operator">=</span> cur_row<span class="token operator">+</span><span class="token number">1</span>
    
    tree <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Treeview<span class="token punctuation">(</span>table_frm<span class="token punctuation">)</span>      <span class="token comment"># #创建表格对象</span>
    tree<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token operator">*</span>tree<span class="token punctuation">.</span>get_children<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">[</span><span class="token string">"columns"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>     <span class="token comment"># #定义列</span>
    
    <span class="token keyword">for</span> coln <span class="token keyword">in</span> tree<span class="token punctuation">[</span><span class="token string">"columns"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        tree<span class="token punctuation">.</span>column<span class="token punctuation">(</span>coln<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> anchor <span class="token operator">=</span> <span class="token string">"center"</span><span class="token punctuation">)</span>          <span class="token comment"># #设置列</span>
        tree<span class="token punctuation">.</span>heading<span class="token punctuation">(</span>coln<span class="token punctuation">,</span> text<span class="token operator">=</span>coln<span class="token punctuation">)</span>        <span class="token comment"># #设置显示的表头名</span>
    
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#最多展示</span>
        <span class="token comment"># print(sub_data.iloc[i])</span>
        tree<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"第"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"行"</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token builtin">tuple</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># #给第0行添加数据，索引值可重复</span>
    
    tree<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>row <span class="token operator">=</span> cur_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>columnspan<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
    cur_row <span class="token operator">=</span> cur_row <span class="token operator">+</span> <span class="token number">10</span>
    
    dlpath <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    dlpath<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    dl_frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>root<span class="token punctuation">)</span>
    dl_frm<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>cur_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> columnspan<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>

    cur_row <span class="token operator">=</span> cur_row <span class="token operator">+</span> <span class="token number">1</span>
    entry1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>dl_frm<span class="token punctuation">,</span>textvariable<span class="token operator">=</span>dlpath<span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token string">'40'</span><span class="token punctuation">)</span>
    entry1<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>cur_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    cur_row <span class="token operator">=</span> cur_row <span class="token operator">+</span> <span class="token number">1</span> 
    btn <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>dl_frm<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'保存结果'</span><span class="token punctuation">,</span> command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span>download_file<span class="token punctuation">(</span>sub_data<span class="token punctuation">,</span>detail_data<span class="token punctuation">,</span>root<span class="token punctuation">,</span>dlpath<span class="token punctuation">)</span><span class="token punctuation">)</span>
    btn<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>cur_row<span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    cur_row <span class="token operator">=</span> cur_row <span class="token operator">+</span> <span class="token number">1</span> 
    <span class="token comment"># cur_row = 0</span>
</code></pre> 
<h4><a id="44__184"></a>4.4 业务计算功能实现</h4> 
<p>   这里的业务也就是常规的统计计算。<br> <img src="https://images2.imgbox.com/dd/da/mN6foaed_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">func_cal_pass</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data_path <span class="token operator">=</span> path<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>data_path<span class="token punctuation">)</span>
    colnms <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
        
    <span class="token comment"># print(colnms)</span>
    dep <span class="token operator">=</span> <span class="token number">0</span>
    etype <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>colnms<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token string">'所在机构和部门'</span> <span class="token keyword">in</span> colnms<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
            dep <span class="token operator">=</span> i
        <span class="token keyword">if</span> <span class="token string">'报考科目'</span> <span class="token keyword">in</span> colnms<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
            etype <span class="token operator">=</span> i
               
    dep_data <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>colnms<span class="token punctuation">[</span>dep<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># print(dep_data)</span>
    func_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"所在机构和部门"</span><span class="token punctuation">,</span> <span class="token string">"报考人数"</span><span class="token punctuation">,</span> <span class="token string">"合格人数"</span><span class="token punctuation">,</span> <span class="token string">"不合格人数"</span><span class="token punctuation">,</span><span class="token string">"缺考人数"</span><span class="token punctuation">,</span><span class="token string">"合格率"</span><span class="token punctuation">,</span><span class="token string">"不合格率"</span><span class="token punctuation">,</span><span class="token string">"缺考率"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>dep_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sub_data <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span>colnms<span class="token punctuation">[</span>dep<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">==</span>dep_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
        pass_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">[</span>sub_data<span class="token punctuation">[</span><span class="token string">'合格情况'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'合格'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#通过</span>
        abs_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">[</span>sub_data<span class="token punctuation">[</span><span class="token string">'成绩'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#缺考</span>
        un_pass_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">)</span><span class="token operator">-</span>pass_num<span class="token operator">-</span>abs_num <span class="token comment">#未通过</span>
        row <span class="token operator">=</span> <span class="token punctuation">[</span>dep_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">)</span><span class="token punctuation">,</span>pass_num<span class="token punctuation">,</span>un_pass_num<span class="token punctuation">,</span>abs_num<span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span>pass_num<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               <span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span>un_pass_num<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span>abs_num<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token comment"># print(row)</span>
        func_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>row
    
    detail_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    etype_data <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>colnms<span class="token punctuation">[</span>etype<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>dep_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sub_data_1 <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span>colnms<span class="token punctuation">[</span>dep<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">==</span>dep_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">#先找部门</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>etype_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sub_data_2 <span class="token operator">=</span> sub_data_1<span class="token punctuation">[</span>sub_data_1<span class="token punctuation">[</span>colnms<span class="token punctuation">[</span>etype<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">==</span>etype_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">#再找科目</span>
            <span class="token comment"># print(len(sub_data_2))</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> sub_data_2<span class="token punctuation">.</span>empty<span class="token punctuation">:</span>
                pass_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">[</span>sub_data_2<span class="token punctuation">[</span><span class="token string">'合格情况'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'合格'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#通过</span>
                abs_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">[</span>sub_data_2<span class="token punctuation">[</span><span class="token string">'成绩'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#缺考</span>
                un_pass_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">)</span><span class="token operator">-</span>pass_num<span class="token operator">-</span>abs_num <span class="token comment">#未通过</span>
                row <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>dep_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>etype_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">)</span><span class="token punctuation">,</span>pass_num<span class="token punctuation">,</span>un_pass_num<span class="token punctuation">,</span>abs_num<span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span>pass_num<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                       <span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span>un_pass_num<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span>abs_num<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                detail_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    detail_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>detail_list<span class="token punctuation">,</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"所在机构和部门"</span><span class="token punctuation">,</span> <span class="token string">"报考科目"</span><span class="token punctuation">,</span><span class="token string">"报考人数"</span><span class="token punctuation">,</span> <span class="token string">"合格人数"</span><span class="token punctuation">,</span> <span class="token string">"不合格人数"</span><span class="token punctuation">,</span><span class="token string">"缺考人数"</span><span class="token punctuation">,</span><span class="token string">"合格率"</span><span class="token punctuation">,</span><span class="token string">"不合格率"</span><span class="token punctuation">,</span><span class="token string">"缺考率"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># print(detail_data)</span>
    
    <span class="token comment"># print(func_data)</span>
    show_data<span class="token punctuation">(</span>root<span class="token punctuation">,</span>func_data<span class="token punctuation">,</span>detail_data<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="45__237"></a>4.5 结果保存功能实现</h4> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">download_file</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>detail_data<span class="token punctuation">,</span>root<span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    selectFile <span class="token operator">=</span> filedialog<span class="token punctuation">.</span>asksaveasfilename<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># askopenfilename 1次上传1个；askopenfilenames1次上传多个</span>
    entry1<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> selectFile<span class="token punctuation">)</span>
    path<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>selectFile<span class="token punctuation">)</span>
    writer <span class="token operator">=</span> pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span>selectFile<span class="token operator">+</span><span class="token string">'.xlsx'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> selectFile<span class="token punctuation">:</span>
        data<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">'汇总'</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> detail_data<span class="token punctuation">.</span>empty<span class="token punctuation">:</span>
            detail_data<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">'明细'</span><span class="token punctuation">)</span>
        messagebox<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">'提示'</span><span class="token punctuation">,</span>message<span class="token operator">=</span><span class="token string">'保存成功！'</span><span class="token punctuation">)</span>
        writer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="46__253"></a>4.6 全局滚动条实现</h4> 
<pre><code class="prism language-python">root<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>
canvas<span class="token punctuation">.</span>config<span class="token punctuation">(</span>scrollregion<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>h<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">processWheel</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    a<span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>delta<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">)</span>
    canvas<span class="token punctuation">.</span>yview_scroll<span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token string">'units'</span><span class="token punctuation">)</span>
    <span class="token comment"># canvas.xview_scroll(a,'units')</span>
main_frm<span class="token punctuation">.</span>bind_all<span class="token punctuation">(</span><span class="token string">"&lt;MouseWheel&gt;"</span><span class="token punctuation">,</span> processWheel<span class="token punctuation">)</span>
root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># #窗口持久化</span>
</code></pre> 
<h2><a id="5_exe_264"></a>5 打包成.exe文件</h2> 
<p>   主要用pyinstaller打包，详见<a href="http://c.biancheng.net/view/2690.html" rel="nofollow">Python PyInstaller安装和使用教程（详解版）</a>。</p> 
<h2><a id="6__266"></a>6 完整代码</h2> 
<pre><code class="prism language-py"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token triple-quoted-string string">"""
Created on Tue Sep 14 22:37:56 2021

@author: Administrator
"""</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk
<span class="token keyword">from</span> tkinter <span class="token keyword">import</span> ttk
<span class="token keyword">from</span> tkinter <span class="token keyword">import</span> filedialog
<span class="token keyword">from</span> tkinter <span class="token keyword">import</span> messagebox
<span class="token keyword">from</span> tkinter <span class="token keyword">import</span> W<span class="token punctuation">,</span>N<span class="token punctuation">,</span>E<span class="token punctuation">,</span>S<span class="token punctuation">,</span>HORIZONTAL<span class="token punctuation">,</span>BOTTOM<span class="token punctuation">,</span>X<span class="token punctuation">,</span>VERTICAL<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>RIGHT<span class="token punctuation">,</span>LEFT<span class="token punctuation">,</span>BOTH
<span class="token comment"># import Pmw</span>

<span class="token keyword">def</span> <span class="token function">upload_file</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    selectFile <span class="token operator">=</span> filedialog<span class="token punctuation">.</span>askopenfilename<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># askopenfilename 1次上传1个；askopenfilenames1次上传多个</span>
    entry1<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> selectFile<span class="token punctuation">)</span>
    path<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>selectFile<span class="token punctuation">)</span>
    

<span class="token keyword">def</span> <span class="token function">func_cal_pass</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data_path <span class="token operator">=</span> path<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>data_path<span class="token punctuation">)</span>
    colnms <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
        
    <span class="token comment"># print(colnms)</span>
    dep <span class="token operator">=</span> <span class="token number">0</span>
    etype <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>colnms<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token string">'所在机构和部门'</span> <span class="token keyword">in</span> colnms<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
            dep <span class="token operator">=</span> i
        <span class="token keyword">if</span> <span class="token string">'报考科目'</span> <span class="token keyword">in</span> colnms<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
            etype <span class="token operator">=</span> i
               
    dep_data <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>colnms<span class="token punctuation">[</span>dep<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># print(dep_data)</span>
    func_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"所在机构和部门"</span><span class="token punctuation">,</span> <span class="token string">"报考人数"</span><span class="token punctuation">,</span> <span class="token string">"合格人数"</span><span class="token punctuation">,</span> <span class="token string">"不合格人数"</span><span class="token punctuation">,</span><span class="token string">"缺考人数"</span><span class="token punctuation">,</span><span class="token string">"合格率"</span><span class="token punctuation">,</span><span class="token string">"不合格率"</span><span class="token punctuation">,</span><span class="token string">"缺考率"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>dep_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sub_data <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span>colnms<span class="token punctuation">[</span>dep<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">==</span>dep_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
        pass_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">[</span>sub_data<span class="token punctuation">[</span><span class="token string">'合格情况'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'合格'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#通过</span>
        abs_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">[</span>sub_data<span class="token punctuation">[</span><span class="token string">'成绩'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#缺考</span>
        un_pass_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">)</span><span class="token operator">-</span>pass_num<span class="token operator">-</span>abs_num <span class="token comment">#未通过</span>
        row <span class="token operator">=</span> <span class="token punctuation">[</span>dep_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">)</span><span class="token punctuation">,</span>pass_num<span class="token punctuation">,</span>un_pass_num<span class="token punctuation">,</span>abs_num<span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span>pass_num<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               <span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span>un_pass_num<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span>abs_num<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token comment"># print(row)</span>
        func_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>row
    
    detail_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    etype_data <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>colnms<span class="token punctuation">[</span>etype<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>dep_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sub_data_1 <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span>colnms<span class="token punctuation">[</span>dep<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">==</span>dep_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">#先找部门</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>etype_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sub_data_2 <span class="token operator">=</span> sub_data_1<span class="token punctuation">[</span>sub_data_1<span class="token punctuation">[</span>colnms<span class="token punctuation">[</span>etype<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">==</span>etype_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">#再找科目</span>
            <span class="token comment"># print(len(sub_data_2))</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> sub_data_2<span class="token punctuation">.</span>empty<span class="token punctuation">:</span>
                pass_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">[</span>sub_data_2<span class="token punctuation">[</span><span class="token string">'合格情况'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'合格'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#通过</span>
                abs_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">[</span>sub_data_2<span class="token punctuation">[</span><span class="token string">'成绩'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#缺考</span>
                un_pass_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">)</span><span class="token operator">-</span>pass_num<span class="token operator">-</span>abs_num <span class="token comment">#未通过</span>
                row <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>dep_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>etype_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">)</span><span class="token punctuation">,</span>pass_num<span class="token punctuation">,</span>un_pass_num<span class="token punctuation">,</span>abs_num<span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span>pass_num<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                       <span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span>un_pass_num<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span>abs_num<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                detail_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    detail_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>detail_list<span class="token punctuation">,</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"所在机构和部门"</span><span class="token punctuation">,</span> <span class="token string">"报考科目"</span><span class="token punctuation">,</span><span class="token string">"报考人数"</span><span class="token punctuation">,</span> <span class="token string">"合格人数"</span><span class="token punctuation">,</span> <span class="token string">"不合格人数"</span><span class="token punctuation">,</span><span class="token string">"缺考人数"</span><span class="token punctuation">,</span><span class="token string">"合格率"</span><span class="token punctuation">,</span><span class="token string">"不合格率"</span><span class="token punctuation">,</span><span class="token string">"缺考率"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># print(detail_data)</span>
    
    <span class="token comment"># print(func_data)</span>
    show_data<span class="token punctuation">(</span>root<span class="token punctuation">,</span>func_data<span class="token punctuation">,</span>detail_data<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">func3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span>

<span class="token keyword">def</span> <span class="token function">select</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data_path <span class="token operator">=</span> path<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>data_path<span class="token punctuation">)</span>
    data <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> 
    data <span class="token operator">=</span> data<span class="token punctuation">.</span>applymap<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span>

    colnms <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
            
    values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>nm<span class="token punctuation">]</span><span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> nm <span class="token keyword">in</span> colnms<span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'--请选择'</span><span class="token punctuation">)</span>
        values<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># print(values)</span>
    
    start_row <span class="token operator">=</span> <span class="token number">3</span>
    start_col <span class="token operator">=</span> <span class="token number">0</span>
    QCONDI_ROW_CNTS <span class="token operator">=</span> <span class="token number">5</span> <span class="token comment">#查询条件多少行一列</span>
    textvs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token builtin">len</span><span class="token punctuation">(</span>colnms<span class="token punctuation">)</span>
    <span class="token keyword">global</span> cur_row
    condi_frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>master<span class="token operator">=</span>root<span class="token punctuation">)</span>
    <span class="token comment"># condi_frm.pack()</span>
    condi_frm<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>cur_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>colnms<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        textvs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>master<span class="token operator">=</span>condi_frm<span class="token punctuation">)</span>
        frm<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row <span class="token operator">=</span> start_row <span class="token operator">+</span> i<span class="token operator">%</span>QCONDI_ROW_CNTS<span class="token punctuation">,</span>column <span class="token operator">=</span> start_col<span class="token operator">+</span>i<span class="token operator">//</span>QCONDI_ROW_CNTS<span class="token punctuation">,</span>sticky <span class="token operator">=</span> E<span class="token punctuation">)</span>
        com <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Combobox<span class="token punctuation">(</span>frm<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>textvs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>     <span class="token comment"># #创建下拉菜单</span>
        tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>frm<span class="token punctuation">,</span> text <span class="token operator">=</span> colnms<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span> start_row <span class="token operator">+</span> i<span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>sticky <span class="token operator">=</span> W<span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>pady<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        com<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>start_row <span class="token operator">+</span> i<span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>sticky <span class="token operator">=</span> E<span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>     <span class="token comment"># #将下拉菜单绑定到窗体</span>
        com<span class="token punctuation">[</span><span class="token string">"value"</span><span class="token punctuation">]</span> <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span>   
        com<span class="token punctuation">.</span>current<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    
        cur_row <span class="token operator">=</span> start_row <span class="token operator">+</span> i
    query_button <span class="token operator">=</span>tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span>bg<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'查询'</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span>query<span class="token punctuation">(</span>root<span class="token punctuation">,</span>data<span class="token punctuation">,</span>textvs<span class="token punctuation">)</span><span class="token punctuation">)</span>
    query_button<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>cur_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> columnspan<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
    root<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
<span class="token keyword">def</span> <span class="token function">query</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span>data<span class="token punctuation">,</span>textvs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> cur_row
    ipts <span class="token operator">=</span> <span class="token punctuation">[</span>v<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> v <span class="token keyword">in</span> textvs<span class="token punctuation">]</span>
    DEFALUT <span class="token operator">=</span> <span class="token string">'--请选择'</span>
    colnms <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
    sub_data <span class="token operator">=</span> data<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>ipts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> ipts<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> DEFALUT<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            sub_data <span class="token operator">=</span> sub_data<span class="token punctuation">[</span>sub_data<span class="token punctuation">[</span>colnms<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">==</span>ipts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
    show_data<span class="token punctuation">(</span>root<span class="token punctuation">,</span>sub_data<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    
<span class="token keyword">def</span> <span class="token function">download_file</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>detail_data<span class="token punctuation">,</span>root<span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    selectFile <span class="token operator">=</span> filedialog<span class="token punctuation">.</span>asksaveasfilename<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># askopenfilename 1次上传1个；askopenfilenames1次上传多个</span>
    entry1<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> selectFile<span class="token punctuation">)</span>
    path<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>selectFile<span class="token punctuation">)</span>
    writer <span class="token operator">=</span> pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span>selectFile<span class="token operator">+</span><span class="token string">'.xlsx'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> selectFile<span class="token punctuation">:</span>
        data<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">'汇总'</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> detail_data<span class="token punctuation">.</span>empty<span class="token punctuation">:</span>
            detail_data<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">'明细'</span><span class="token punctuation">)</span>
        messagebox<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">'提示'</span><span class="token punctuation">,</span>message<span class="token operator">=</span><span class="token string">'保存成功！'</span><span class="token punctuation">)</span>
        writer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
<span class="token keyword">def</span> <span class="token function">show_data</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span>sub_data<span class="token punctuation">,</span>detail_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> cur_row
    cur_row <span class="token operator">=</span> <span class="token number">10</span>
    table_frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>root<span class="token punctuation">)</span>
    table_frm<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>cur_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    cur_row <span class="token operator">=</span> cur_row<span class="token operator">+</span><span class="token number">1</span>
    
    tree <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Treeview<span class="token punctuation">(</span>table_frm<span class="token punctuation">)</span>      <span class="token comment"># #创建表格对象</span>
    tree<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token operator">*</span>tree<span class="token punctuation">.</span>get_children<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">[</span><span class="token string">"columns"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>     <span class="token comment"># #定义列</span>
    
    <span class="token keyword">for</span> coln <span class="token keyword">in</span> tree<span class="token punctuation">[</span><span class="token string">"columns"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        tree<span class="token punctuation">.</span>column<span class="token punctuation">(</span>coln<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> anchor <span class="token operator">=</span> <span class="token string">"center"</span><span class="token punctuation">)</span>          <span class="token comment"># #设置列</span>
        tree<span class="token punctuation">.</span>heading<span class="token punctuation">(</span>coln<span class="token punctuation">,</span> text<span class="token operator">=</span>coln<span class="token punctuation">)</span>        <span class="token comment"># #设置显示的表头名</span>
    
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#最多展示</span>
        <span class="token comment"># print(sub_data.iloc[i])</span>
        tree<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"第"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"行"</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token builtin">tuple</span><span class="token punctuation">(</span>sub_data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># #给第0行添加数据，索引值可重复</span>
    
    tree<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>row <span class="token operator">=</span> cur_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>columnspan<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
    cur_row <span class="token operator">=</span> cur_row <span class="token operator">+</span> <span class="token number">10</span>
    
    dlpath <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    dlpath<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    dl_frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>root<span class="token punctuation">)</span>
    dl_frm<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>cur_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> columnspan<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>

    cur_row <span class="token operator">=</span> cur_row <span class="token operator">+</span> <span class="token number">1</span>
    entry1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>dl_frm<span class="token punctuation">,</span>textvariable<span class="token operator">=</span>dlpath<span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token string">'40'</span><span class="token punctuation">)</span>
    entry1<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>cur_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    cur_row <span class="token operator">=</span> cur_row <span class="token operator">+</span> <span class="token number">1</span> 
    btn <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>dl_frm<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'保存结果'</span><span class="token punctuation">,</span> command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span>download_file<span class="token punctuation">(</span>sub_data<span class="token punctuation">,</span>detail_data<span class="token punctuation">,</span>root<span class="token punctuation">,</span>dlpath<span class="token punctuation">)</span><span class="token punctuation">)</span>
    btn<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span>cur_row<span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    cur_row <span class="token operator">=</span> cur_row <span class="token operator">+</span> <span class="token number">1</span> 
    <span class="token comment"># cur_row = 0</span>

    
root <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
root<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"乐川考试系统"</span><span class="token punctuation">)</span>    <span class="token comment"># #窗口标题</span>
w <span class="token operator">=</span> root<span class="token punctuation">.</span>winfo_screenwidth<span class="token punctuation">(</span><span class="token punctuation">)</span>
h <span class="token operator">=</span> root<span class="token punctuation">.</span>winfo_screenheight<span class="token punctuation">(</span><span class="token punctuation">)</span>

root<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">"%dx%d"</span> <span class="token operator">%</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span>

canvas<span class="token operator">=</span> tk<span class="token punctuation">.</span>Canvas<span class="token punctuation">(</span>root<span class="token punctuation">,</span> width<span class="token operator">=</span>w<span class="token punctuation">,</span> height<span class="token operator">=</span>h<span class="token punctuation">)</span>

xscrollbar <span class="token operator">=</span> tk<span class="token punctuation">.</span>Scrollbar<span class="token punctuation">(</span>root<span class="token punctuation">,</span>orient<span class="token operator">=</span>tk<span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span>
yscrollbar <span class="token operator">=</span> tk<span class="token punctuation">.</span>Scrollbar<span class="token punctuation">(</span>root<span class="token punctuation">)</span>

yscrollbar<span class="token punctuation">.</span>config<span class="token punctuation">(</span>command<span class="token operator">=</span>canvas<span class="token punctuation">.</span>yview<span class="token punctuation">)</span>
yscrollbar<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>RIGHT<span class="token punctuation">,</span> fill<span class="token operator">=</span>tk<span class="token punctuation">.</span>Y<span class="token punctuation">)</span> 
xscrollbar<span class="token punctuation">.</span>config<span class="token punctuation">(</span>command<span class="token operator">=</span>canvas<span class="token punctuation">.</span>xview<span class="token punctuation">)</span>
xscrollbar<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>BOTTOM<span class="token punctuation">,</span> fill<span class="token operator">=</span>tk<span class="token punctuation">.</span>X<span class="token punctuation">)</span> 

canvas<span class="token punctuation">.</span>config<span class="token punctuation">(</span>xscrollcommand<span class="token operator">=</span>xscrollbar<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">,</span>yscrollcommand<span class="token operator">=</span>yscrollbar<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">)</span>


canvas<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span><span class="token string">"left"</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token string">"both"</span><span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment">#side=LEFT,expand=True,fill=BOTH</span>
main_frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>canvas<span class="token punctuation">)</span>
canvas<span class="token punctuation">.</span>create_window<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>window<span class="token operator">=</span>main_frm<span class="token punctuation">,</span> anchor<span class="token operator">=</span><span class="token string">'nw'</span><span class="token punctuation">)</span>

<span class="token comment"># In[]</span>
path <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment"># #创建变量，便于取值</span>
path<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>

upload_frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>master<span class="token operator">=</span>main_frm<span class="token punctuation">)</span> <span class="token comment">#上传组件</span>
upload_frm<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

entry1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>upload_frm<span class="token punctuation">,</span>textvariable<span class="token operator">=</span>path<span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token string">'40'</span><span class="token punctuation">)</span>

entry1<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
btn <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>upload_frm<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'上传文件'</span><span class="token punctuation">,</span> command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span>upload_file<span class="token punctuation">(</span>upload_frm<span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>


func_frm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>main_frm<span class="token punctuation">)</span> <span class="token comment">#功能索引</span>
<span class="token comment"># func_frm.pack()</span>
func_frm<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
select_button <span class="token operator">=</span>tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>func_frm<span class="token punctuation">,</span>bg<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'进入查询界面'</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
                            command<span class="token operator">=</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span>select<span class="token punctuation">(</span>main_frm<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">)</span>
select_button<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># select_button.pack()</span>

func_button_1 <span class="token operator">=</span>tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>func_frm<span class="token punctuation">,</span>bg<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'功能按钮2'</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
                            command<span class="token operator">=</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span>func_cal_pass<span class="token punctuation">(</span>main_frm<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">)</span>
func_button_1<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

func_button_2 <span class="token operator">=</span>tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>func_frm<span class="token punctuation">,</span>bg<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'功能按钮3'</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
                            command<span class="token operator">=</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span>func3<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
func_button_2<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>


cur_row <span class="token operator">=</span> <span class="token number">2</span>
<span class="token comment"># In[]</span>

root<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>
canvas<span class="token punctuation">.</span>config<span class="token punctuation">(</span>scrollregion<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>h<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">processWheel</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    a<span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>delta<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">)</span>
    canvas<span class="token punctuation">.</span>yview_scroll<span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token string">'units'</span><span class="token punctuation">)</span>
    <span class="token comment"># canvas.xview_scroll(a,'units')</span>
main_frm<span class="token punctuation">.</span>bind_all<span class="token punctuation">(</span><span class="token string">"&lt;MouseWheel&gt;"</span><span class="token punctuation">,</span> processWheel<span class="token punctuation">)</span>
root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># #窗口持久化</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b736698a99b3aaac6e67ed28d2837bc5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">时间序列多步预测的五种策略</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e8f8f56cdfe9e9a578405057e1c46e2b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">初识C语言---------常量和变量</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>