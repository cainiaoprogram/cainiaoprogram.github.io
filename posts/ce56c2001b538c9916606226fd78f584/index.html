<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>sql的书写操作 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="sql的书写操作" />
<meta property="og:description" content="创建数据库
create database &lt;数据库名&gt; 创建表
create table &lt;表名&gt;( &lt;列名1&gt; &lt;数据类型&gt; &lt;该列的约束&gt;， &lt;列名2&gt; &lt;数据类型&gt; &lt;该列的约束&gt;， ... &lt;该表的约束1&gt;,&lt;该表的约束2&gt;,... ); 数据类型
-字符串：定长char，可变长度varchar
-数字：int/integer
-日期：date
约束：
-null
-not null
-primary key
create table student (sid int(4) primary key auto_increment comment &#39;学生id&#39;, sname char(20) not null comment &#39;学生名字&#39;, ssex char(3) not null comment &#39;学生性别&#39;, sage integer not null comment &#39;学生年龄&#39;); 增加表的列
alter table &lt;表名&gt; add &lt;列名&gt; alter table tableName add columnName varchar(30) 删除表的列
alter table &lt;表名&gt; drop &lt;列名&gt; 删除表" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ce56c2001b538c9916606226fd78f584/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-06T16:16:57+08:00" />
<meta property="article:modified_time" content="2022-09-06T16:16:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">sql的书写操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>创建数据库</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token operator">&lt;</span>数据库名<span class="token operator">&gt;</span>
</code></pre> 
<p><strong>创建表</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span><span class="token punctuation">(</span>
<span class="token operator">&lt;</span>列名<span class="token number">1</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>数据类型<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>该列的约束<span class="token operator">&gt;</span>，
<span class="token operator">&lt;</span>列名<span class="token number">2</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>数据类型<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>该列的约束<span class="token operator">&gt;</span>，
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">&lt;</span>该表的约束<span class="token number">1</span><span class="token operator">&gt;</span><span class="token punctuation">,</span><span class="token operator">&lt;</span>该表的约束<span class="token number">2</span><span class="token operator">&gt;</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>数据类型</p> 
<p>-字符串：定长char，可变长度varchar</p> 
<p>-数字：int/integer</p> 
<p>-日期：date</p> 
<p>约束：</p> 
<p>-null</p> 
<p>-not null</p> 
<p>-primary key</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> student
<span class="token punctuation">(</span>sid  <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span> <span class="token keyword">comment</span> <span class="token string">'学生id'</span><span class="token punctuation">,</span>
sname <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">comment</span> <span class="token string">'学生名字'</span><span class="token punctuation">,</span>
ssex <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">comment</span> <span class="token string">'学生性别'</span><span class="token punctuation">,</span>
sage <span class="token keyword">integer</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">comment</span> <span class="token string">'学生年龄'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>增加表的列</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span> <span class="token keyword">add</span> <span class="token operator">&lt;</span>列名<span class="token operator">&gt;</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> tableName <span class="token keyword">add</span> columnName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>  
</code></pre> 
<p><strong>删除表的列</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span> <span class="token keyword">drop</span> <span class="token operator">&lt;</span>列名<span class="token operator">&gt;</span>
</code></pre> 
<p><strong>删除表</strong></p> 
<p>1）如果想删除表，当然用drop；</p> 
<p>如果想保留表而将所有数据删除，如果和事务无关，用truncate即可；</p> 
<p>如果如果想保留表而将所有数据删除，如果和事务有关，或者想触发trigger，还是用delete；</p> 
<p>2）执行速度：drop&gt;truncate&gt;delete</p> 
<p>3）drop、truncate是立即执行，不能回滚</p> 
<p>4）drop、truncate不能加where条件</p> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">table</span> student<span class="token punctuation">;</span>

<span class="token keyword">truncate</span> <span class="token keyword">table</span> 表名<span class="token punctuation">;</span>

<span class="token keyword">delete</span> <span class="token keyword">from</span>  student <span class="token keyword">where</span>  T_name <span class="token operator">=</span> <span class="token string">"张三"</span><span class="token punctuation">;</span>

</code></pre> 
<p><strong>插入数据</strong></p> 
<p>可以只插入所需要的列，但其他未被写入的列必须可以为空，如果设置成不为null那将报错</p> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>列名<span class="token number">1</span><span class="token operator">&gt;</span>，<span class="token operator">&lt;</span>列名<span class="token number">2</span><span class="token operator">&gt;</span>，<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>）
<span class="token keyword">values</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>值<span class="token number">1</span><span class="token operator">&gt;</span><span class="token punctuation">,</span><span class="token operator">&lt;</span>值<span class="token number">2</span><span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>；
</code></pre> 
<p><strong>更新数据</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">UPDATE</span> <span class="token operator">&lt;</span>列名<span class="token operator">&gt;</span> <span class="token keyword">SET</span> 列<span class="token number">1</span><span class="token operator">=</span>value1<span class="token punctuation">,</span> 列<span class="token number">2</span><span class="token operator">=</span>value2<span class="token punctuation">,</span> … <span class="token keyword">WHERE</span> conditions
</code></pre> 
<p><strong>为列设置别名</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name <span class="token keyword">as</span> s_name <span class="token keyword">from</span> student<span class="token punctuation">;</span>
</code></pre> 
<p><strong>删除重复数据</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">//distinct 放在列名前</span>
<span class="token keyword">select</span> <span class="token keyword">distinct</span> name <span class="token keyword">from</span> student<span class="token punctuation">;</span>
</code></pre> 
<p><strong>mysql的执行顺序</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
    catid<span class="token punctuation">,</span>
    <span class="token function">count</span><span class="token punctuation">(</span>orderid<span class="token punctuation">)</span> <span class="token keyword">as</span> sales
<span class="token keyword">from</span>
    t
<span class="token keyword">where</span> 
    catid <span class="token operator">&lt;&gt;</span> <span class="token string">"c666"</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> 
    catid
<span class="token keyword">having</span>
    <span class="token function">count</span><span class="token punctuation">(</span>orderid<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> 
    <span class="token function">count</span><span class="token punctuation">(</span>orderid<span class="token punctuation">)</span> <span class="token keyword">desc</span>
<span class="token keyword">limit</span> <span class="token number">3</span>
</code></pre> 
<p>执行顺序是:from-on-join-where-groupby-having-select-orderby-limit</p> 
<p>如果是单表就根据这个执行顺序来套入，order by里的字段前面必须出现，group by出现或者select出现都可以</p> 
<p>https://www.nowcoder.com/practice/e00bbac732cb4b6bbc62a52b930cb15e?tpId=199&amp;tqId=1975672&amp;ru=/exam/oj&amp;qru=/ta/sql-quick-study/question-ranking&amp;sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D199</p> 
<p><strong>运算符</strong></p> 
<p>+、-、*、/、=、&lt;&gt;、 &gt;、 &gt;= &lt;、 &lt;=</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 姓名<span class="token punctuation">,</span>出生日期 <span class="token keyword">from</span> student <span class="token keyword">where</span> 出生日期<span class="token operator">&lt;&gt;</span><span class="token string">'1990-01-01'</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>查出null和not null值</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 教师号<span class="token punctuation">,</span>教师姓名 <span class="token keyword">from</span> teacher <span class="token keyword">where</span> 教师姓名 <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> 教师号<span class="token punctuation">,</span>教师姓名 <span class="token keyword">from</span> teacher <span class="token keyword">where</span> 教师姓名 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>逻辑运算符</strong></p> 
<p>not、and、between、or、in</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 学号<span class="token punctuation">,</span>成绩 <span class="token keyword">from</span> course <span class="token keyword">where</span> <span class="token operator">not</span> 成绩<span class="token operator">&lt;</span><span class="token number">60</span><span class="token punctuation">;</span>

<span class="token comment">-- 60&lt;=成绩&lt;=90</span>
<span class="token keyword">select</span> 学号<span class="token punctuation">,</span>成绩 <span class="token keyword">from</span> course <span class="token keyword">where</span> 成绩 <span class="token operator">between</span> <span class="token number">60</span> <span class="token operator">and</span> <span class="token number">90</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> 姓名<span class="token punctuation">,</span>性别 <span class="token keyword">from</span> student <span class="token keyword">where</span> 姓名 <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'猴子'</span><span class="token punctuation">,</span><span class="token string">'马云'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> 姓名<span class="token punctuation">,</span>性别 <span class="token keyword">from</span> student <span class="token keyword">where</span> 姓名 <span class="token operator">not</span> <span class="token operator">in</span><span class="token punctuation">(</span><span class="token string">'猴子'</span><span class="token punctuation">,</span><span class="token string">'马云'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>%跟_</strong></p> 
<p>%表示任意字符串，_表示任意一个字符</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student <span class="token keyword">where</span> 姓名 <span class="token operator">like</span> <span class="token string">'%猴%'</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student <span class="token keyword">where</span> 姓名 <span class="token operator">like</span> <span class="token string">'王__'</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>汇总函数</strong></p> 
<p>count()，参数写列名则不包括空值，写*则包括空值</p> 
<p>sum()，对某列求和</p> 
<p>avg()，求某列的平均值</p> 
<p>max()，求某列的最大值</p> 
<p>min()，求某列的最小值</p> 
<p><strong>分组</strong></p> 
<p>使用group by分组时，会将相同字段的记录归并成一条记录，这时那些不是在group by后那些字段就可能会出现多个值</p> 
<p>分组前：<br> <img src="https://images2.imgbox.com/00/7a/RTxnEP2w_o.png" alt="在这里插入图片描述"><br> 分组后：<br> <img src="https://images2.imgbox.com/1b/6c/V870PovU_o.png" alt="在这里插入图片描述"><br> 如果使用name分组的话，返回应该是虚拟表3，可以看到id跟number一个单元格里有多个值，这样查询出来的结果是错误的；但name每个单元格只有一个数据，因此select name是不会报错的</p> 
<p>既然一个单元格有多个值，若使用聚合函数把多个值合并起来，再查询，这样是允许的</p> 
<p>例如使用count(id),sum(number)等等</p> 
<p>偶尔也会出现多个字段分组，例如group by name,number，我们可以把它看成一个整体字段，用整体来分组</p> 
<p><img src="https://images2.imgbox.com/3c/d3/7unFK2hM_o.png" alt="在这里插入图片描述"><br> 这也解释了为什么order by出现的字段group by里必须要有</p> 
<p><strong>排序</strong></p> 
<p>使用order by，默认是asc即升序，desc是倒序</p> 
<p>可以根据多个列排序，order by 成绩 asc，课程号 desc;</p> 
<p><strong>常见错误</strong></p> 
<p>-在groupby和having里不要使用select 里的别名，因为先后顺序问题</p> 
<p>-在where中使用聚合函数，都还没根据条件筛选出来，怎么使用聚合函数</p> 
<p><strong>视图</strong></p> 
<p>可以将查询出来的结果存放在一张虚拟表上，这张虚拟表叫做视图，可以对这张表进行增删改查，但一般不会增删改，因为会影响原表，而原表修改对视图也有影响</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">view</span> viewName <span class="token keyword">as</span> <span class="token keyword">select</span>语句
</code></pre> 
<p>视图列名跟select子句的列名是一一对应的</p> 
<p><strong>视图的作用</strong></p> 
<p>当经常需要使用到一个比较复杂的sql查询时，通过sql可以避免每次都写很多的语句，因此具有简单性</p> 
<p>视图可以只显示某些数据，它可以保证某些敏感数据不被增删改查，因此具有安全性</p> 
<p><strong>子查询</strong></p> 
<p>子查询是一次性的视图，可以放在from、in、any(任意一个，有一个满足即可)、all(所有都需要满足)语句中</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 性别<span class="token punctuation">,</span>人数 <span class="token keyword">from</span><span class="token punctuation">(</span> <span class="token keyword">select</span> 性别<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> 人数 <span class="token keyword">from</span> student <span class="token keyword">group</span> <span class="token keyword">by</span> 性别 <span class="token punctuation">)</span><span class="token keyword">as</span> 按性别汇总<span class="token punctuation">;</span>

<span class="token keyword">select</span> 学号<span class="token punctuation">,</span>成绩 <span class="token keyword">from</span> course <span class="token keyword">where</span> 成绩<span class="token operator">&gt;</span><span class="token keyword">any</span><span class="token punctuation">(</span><span class="token keyword">select</span> 成绩 <span class="token keyword">from</span> course <span class="token keyword">where</span> 课程号<span class="token operator">=</span><span class="token string">'0002'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>偶尔使用sql语句：子查询</p> 
<p>频繁使用sql语句：视图</p> 
<p><strong>子查询的执行顺序</strong></p> 
<p>看是关联子查询还是非关联子查询</p> 
<p>如果是关联子查询，即外部查询返回的每一行数据子查询都要执行一次，然后子查询再将结果返回给外部查询，外部查询根据结果做出决策</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept d <span class="token keyword">where</span> <span class="token keyword">exists</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp e <span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> 
<p>这样执行顺序是先执行外层再执行内层</p> 
<p>如果是非关联子查询，即子查询是独立于太不查询的查询，子查询执行完毕后将结果传给外部查询</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>执行顺序是先执行内层查询再执行外层查询</p> 
<p><strong>关联子查询有什么用</strong></p> 
<p>在每个组里进行比较的时候，使用关联子查询</p> 
<p><strong>联合查询，也叫组合查询</strong></p> 
<p>-union，删除重复行</p> 
<p>-union all，保留重复行</p> 
<p>联合查询select必须拥有相同数量的列且具有相同类型的列</p> 
<pre><code class="prism language-sql"><span class="token comment">//相同名字不会被查出来</span>
<span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name1 <span class="token keyword">UNION</span> <span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name2
<span class="token comment">//相同名字会被查出来</span>
<span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name1 <span class="token keyword">UNION</span> <span class="token keyword">ALL</span> <span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name2
</code></pre> 
<p>https://www.nowcoder.com/practice/979b1a5a16d44afaba5191b22152f64a?tpId=199&amp;tqId=1975677&amp;ru=/exam/oj&amp;qru=/ta/sql-quick-study/question-ranking&amp;sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D199</p> 
<p><strong>连接查询</strong></p> 
<p>连接：表和表之间通过列产生关系，联结就是根据表和表之间的关系将两个表合并在一起的操作</p> 
<p>常用的联结：交叉连接、内连接、左连接、右连接、全连接</p> 
<p>例如<img src="https://images2.imgbox.com/f3/0e/DVpTUCs6_o.png" alt="在这里插入图片描述"><br> <strong>交叉连接</strong></p> 
<p>交叉连接也称笛卡尔积，即将表1的每一行数据和表2的每一行数据合并在一起</p> 
<p>行数的3*2<br> <img src="https://images2.imgbox.com/fb/60/334UJ3QK_o.png" alt="在这里插入图片描述"><br> <strong>内连接</strong></p> 
<p>查找两张表里共同存在的数据，即交集<br> <img src="https://images2.imgbox.com/67/98/3kbBF7Ao_o.png" alt="在这里插入图片描述"><br> 步骤：</p> 
<p>-分别从两张表里查出符合条件的行，两张表都需要存在某些数据<br> <img src="https://images2.imgbox.com/d8/34/I1ST4Add_o.png" alt="在这里插入图片描述"><br> 这就解释了https://www.nowcoder.com/practice/88aa923a9a674253b861a8fa56bac8e5?tpId=199&amp;tqId=1975674&amp;ru=/exam/oj&amp;qru=/ta/sql-quick-study/question-ranking&amp;sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D199为什么需要用distinct</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> a<span class="token punctuation">.</span>学号<span class="token punctuation">,</span>a<span class="token punctuation">.</span>姓名<span class="token punctuation">,</span>b<span class="token punctuation">.</span>课程号 <span class="token keyword">from</span> student <span class="token keyword">as</span> a <span class="token keyword">inner</span> <span class="token keyword">join</span> course <span class="token keyword">as</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>学号<span class="token operator">=</span>b<span class="token punctuation">.</span>学号<span class="token punctuation">;</span>
</code></pre> 
<p><strong>左连接</strong></p> 
<p>左表全部查询，右表只查出两张表都存在的数据<br> <img src="https://images2.imgbox.com/a8/02/3Ov9rSvn_o.png" alt="在这里插入图片描述"><br> 步骤：</p> 
<p>-左边表的数据全部取出，右边的表选择同时存在于两张表中的数据</p> 
<p>-将两张表中取出的数据进行合并，即交叉联结</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> a<span class="token punctuation">.</span>学号<span class="token punctuation">,</span>a<span class="token punctuation">.</span>姓名<span class="token punctuation">,</span>b<span class="token punctuation">.</span>课程号 <span class="token keyword">from</span> student <span class="token keyword">as</span> a <span class="token keyword">left</span> <span class="token keyword">join</span> course <span class="token keyword">as</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>学号<span class="token operator">=</span>b<span class="token punctuation">.</span>学号<span class="token punctuation">;</span>
</code></pre> 
<p><strong>查出A表里不在B表的数据</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> a<span class="token punctuation">.</span>学号<span class="token punctuation">,</span>a<span class="token punctuation">.</span>姓名<span class="token punctuation">,</span>b<span class="token punctuation">.</span>课程号 <span class="token keyword">from</span> student <span class="token keyword">as</span> a <span class="token keyword">left</span> <span class="token keyword">join</span> course <span class="token keyword">as</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>学号<span class="token operator">=</span>b<span class="token punctuation">.</span>学号 <span class="token keyword">where</span> b<span class="token punctuation">.</span>学号 <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>右连接</strong><br> <img src="https://images2.imgbox.com/3e/a1/O2daKmPi_o.png" alt="在这里插入图片描述"><br> 左连接跟右连接差不多，可以互换</p> 
<p><strong>全连接</strong><br> <img src="https://images2.imgbox.com/2a/f0/U763LO9i_o.png" alt="在这里插入图片描述"><br> <strong>连接图</strong><br> <img src="https://images2.imgbox.com/4e/ee/8zUVW6Kb_o.png" alt="在这里插入图片描述"><br> <strong>self join</strong></p> 
<p>返回表与自己连接后符合条件的记录，一般用在表里有一个字段是用主键作为外键的情况<br> <img src="https://images2.imgbox.com/58/8e/6d7oV7U0_o.png" alt="在这里插入图片描述"><br> <strong>case表达式</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">case</span> <span class="token keyword">when</span> <span class="token operator">&lt;</span>判断表达式<span class="token operator">&gt;</span> <span class="token keyword">then</span> <span class="token operator">&lt;</span>表达式<span class="token operator">&gt;</span>
     <span class="token keyword">when</span> <span class="token operator">&lt;</span>判断表达式<span class="token operator">&gt;</span> <span class="token keyword">then</span> <span class="token operator">&lt;</span>表达式<span class="token operator">&gt;</span>
     <span class="token keyword">when</span> <span class="token operator">&lt;</span>判断表达式<span class="token operator">&gt;</span> <span class="token keyword">then</span> <span class="token operator">&lt;</span>表达式<span class="token operator">&gt;</span>
     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
     <span class="token keyword">else</span> <span class="token operator">&lt;</span>表达式<span class="token operator">&gt;</span>
<span class="token keyword">end</span>
</code></pre> 
<p>注意事项：</p> 
<p>-else语句可以省略不写，默认为空值，建议不要省略</p> 
<p>-end不能省略</p> 
<p>-case表达式可以写在sql的任意子句中</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询出每门课程的及格人数和不及格人数</span>
<span class="token keyword">select</span> 课程号<span class="token punctuation">,</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> 成绩<span class="token operator">&gt;=</span><span class="token number">60</span> <span class="token keyword">then</span> <span class="token number">1</span>
<span class="token keyword">else</span> <span class="token number">0</span>
<span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> 及格人数<span class="token punctuation">,</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> 成绩<span class="token operator">&lt;</span><span class="token number">60</span> <span class="token keyword">then</span> <span class="token number">1</span>
<span class="token keyword">else</span> <span class="token number">0</span>
<span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> 不及格人数
<span class="token keyword">from</span> score
<span class="token keyword">group</span> <span class="token keyword">by</span> 课程号<span class="token punctuation">;</span>
</code></pre> 
<p><strong>书写sql的思路</strong></p> 
<p>-翻译成大白话</p> 
<p>-写出分析思路</p> 
<p>-写出对应的sql子句</p> 
<p>例如查询所有学生的学号、姓名、选课数、总成绩</p> 
<p>-大白话</p> 
<p>1）学号、姓名（学生表student）</p> 
<p>2）选课数（每个学生的选课数目：成绩表score，按学号分组，对课程号计数count）</p> 
<p>3）总成绩（每个学生的总成绩：成绩表score，按学号分组，对成绩求和sum）</p> 
<p>-思路</p> 
<p>1）select 查询结果：[学号，姓名，选课数，总成绩]</p> 
<p>2）from 从哪张表查找数据：[学生表student，成绩表score；两个表如何连接？通过学号；用哪种连接？左连接）</p> 
<p>3）where 查询条件：[没有]</p> 
<p>4）group by 分组：[每个学生的选课数目：按学号分组，对课程号计数count；每个学生的总成绩：按学号分组，对成绩求和sum]</p> 
<p>5）having 对分组结果指定条件：[没有]</p> 
<p>6）order by 对查询结果排序：[没有]</p> 
<p>7）limit 从查询结果中取出指定行：[没有];</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> a<span class="token punctuation">.</span>学号<span class="token punctuation">,</span>a<span class="token punctuation">.</span>姓名<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>课程号<span class="token punctuation">)</span> <span class="token keyword">as</span> 选课数<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>成绩<span class="token punctuation">)</span> <span class="token keyword">as</span> 总成绩
<span class="token keyword">from</span> student <span class="token keyword">as</span> a <span class="token keyword">left</span> <span class="token keyword">join</span> score <span class="token keyword">as</span> b
<span class="token keyword">on</span> a<span class="token punctuation">.</span>学号<span class="token operator">=</span>b<span class="token punctuation">.</span>学号
<span class="token keyword">group</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>学号<span class="token punctuation">;</span>
</code></pre> 
<p><strong>ID自动编号的数据库当中删除了一条记录后，如何才能使编号仍然保持连续</strong></p> 
<pre><code class="prism language-sql">Delid <span class="token operator">=</span> <span class="token number">26</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> tablename <span class="token keyword">where</span> id <span class="token operator">=</span> Delid
<span class="token keyword">update</span> tablename <span class="token keyword">set</span> id <span class="token operator">=</span> id<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">where</span> id <span class="token operator">&gt;</span> Delid
</code></pre> 
<p>有一个前提条件，id不能为标识列(唯一值)，如果是标识列先取消自动标识，然后执行update 语句，执行完毕再把id设置成自动标志</p> 
<p><strong>sql 里的计数方式</strong></p> 
<p>count(*)，count(1)，count(主键)，count(普通字段)</p> 
<p>首先 count(字段)表示的就是该字段里值不为null的数据行有多少行</p> 
<p>count(*)其实就是count(0)，无论是count(0)还是count(1)，0跟1都永远不为null，因此会把为null的行也统计进来</p> 
<p>性能比较，count(*)=count(1)&gt;count(主键)&gt;count(普通字段)</p> 
<p>count(主键)跟count(普通字段)，当拿到行数据之后，还要判断拿到的主键/普通字段是否为null值，因此性能相对会差一点</p> 
<p>但为什么count(主键)&gt;count(普通字段)，因为主键值比较容易拿到，如果存在二级索引，那么count(主键)不需要回表操作，但是count(普通字段)需要回表操作</p> 
<p>而count(*)跟count(1)不需要判断值是否为null值，因此相对性能会快一点</p> 
<p>如果存在二级索引，那么innodb遍历数据将会使用二级索引，因为二级索引占的内存小一点，性能会好一点</p> 
<p><strong>mysql里的判断</strong></p> 
<p>-case函数</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
    t<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span>
    <span class="token punctuation">(</span>
        <span class="token keyword">CASE</span> t<span class="token punctuation">.</span>sex
        <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span>
            <span class="token string">'男'</span>
        <span class="token keyword">WHEN</span> <span class="token number">2</span> <span class="token keyword">THEN</span>
            <span class="token string">'女'</span>
        <span class="token keyword">ELSE</span>
            <span class="token string">'未知'</span>
        <span class="token keyword">END</span>
    <span class="token punctuation">)</span> 性别
<span class="token keyword">FROM</span>
    t_customer t

<span class="token keyword">UPDATE</span> salary
<span class="token keyword">SET</span>
    sex <span class="token operator">=</span> <span class="token keyword">CASE</span> sex
        <span class="token keyword">WHEN</span> <span class="token string">'m'</span> <span class="token keyword">THEN</span> <span class="token string">'f'</span>
        <span class="token keyword">ELSE</span> <span class="token string">'m'</span>
    <span class="token keyword">END</span><span class="token punctuation">;</span>
</code></pre> 
<p>-if函数</p> 
<p>使用CASE函数可以实现非常复杂的逻辑判断，可是若只是实现“如果符合条件则返回A，否则返回B”这样简单的判断逻辑的话，使用CASE函数就过于繁琐。MYSQL提供了IF()函数用于简化这种逻辑判断，其语法格式如下：IF(expr1,expr2,expr3)</p> 
<p>如果 expr1 为真&amp;&amp;expr1 &lt;&gt; 0 &amp;&amp; expr1 &lt;&gt; NULL)，那么 IF() 返回 expr2，否则返回expr3。IF()返回一个数字或字符串，这取决于它被使用的语境</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> t<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>weight<span class="token operator">&lt;</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token string">'正常'</span><span class="token punctuation">,</span><span class="token string">'肥胖'</span><span class="token punctuation">)</span> 体重 <span class="token keyword">from</span> t_customer t
</code></pre> 
<p><strong>where1=1的意义</strong></p> 
<pre><code class="prism language-sql">
<span class="token operator">&lt;</span><span class="token keyword">select</span> id<span class="token operator">=</span><span class="token string">"queryBookInfo"</span> parameterType<span class="token operator">=</span><span class="token string">"com.ths.platform.entity.BookInfo"</span> resultType<span class="token operator">=</span><span class="token string">"java.lang.Integer"</span><span class="token operator">&gt;</span>
 <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">from</span> t_book t <span class="token keyword">where</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token operator">&lt;</span><span class="token keyword">if</span> test<span class="token operator">=</span><span class="token string">"title !=null and title !='' "</span><span class="token operator">&gt;</span>
 <span class="token operator">AND</span> title <span class="token operator">=</span> <span class="token comment">#{title} </span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span><span class="token keyword">if</span> test<span class="token operator">=</span><span class="token string">"author !=null and author !='' "</span><span class="token operator">&gt;</span>
 <span class="token operator">AND</span> author <span class="token operator">=</span> <span class="token comment">#{author}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">select</span><span class="token operator">&gt;</span>
</code></pre> 
<p>这里where1=1的意义是为了后面if标签为true时给这条sql语句添加一个where</p> 
<p>那么where1=1对性能是否有影响，是否会让索引失效</p> 
<p>通过explain语句可以可知使用where1=1同样是能走索引的，因此对性能并不会影响。不仅如此，mysql在执行sql的时候会优化sql，自动把1=1这个条件去掉</p> 
<p>但是如果数据量大的话，那么mysql优化还是有影响的，建议使用标签，这个标签可以自动把第一个and或者or去掉</p> 
<pre><code class="prism language-sql"><span class="token operator">&lt;</span><span class="token keyword">select</span> id<span class="token operator">=</span><span class="token string">"queryBookInfo"</span> parameterType<span class="token operator">=</span><span class="token string">"com.ths.platform.entity.BookInfo"</span> resultType<span class="token operator">=</span><span class="token string">"java.lang.Integer"</span><span class="token operator">&gt;</span>
 <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> t_book t
<span class="token operator">&lt;</span><span class="token keyword">where</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token keyword">if</span> test<span class="token operator">=</span><span class="token string">"title !=null and title !='' "</span><span class="token operator">&gt;</span>
 title <span class="token operator">=</span> <span class="token comment">#{title} </span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token keyword">if</span> test<span class="token operator">=</span><span class="token string">"author !=null and author !='' "</span><span class="token operator">&gt;</span> 
 <span class="token operator">AND</span> author <span class="token operator">=</span> <span class="token comment">#{author}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">where</span><span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">select</span><span class="token operator">&gt;</span>
</code></pre> 
<p><strong>where跟having的区别</strong></p> 
<p>where针对的是一条记录，例如当一条数据id=1时</p> 
<p>having针对的是多条记录，例如说求语文平均成绩大于80的班级</p> 
<p>where 后面不能接聚合函数，如果需要用聚合函数可以使用having</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a2a91c1d42151d1904f21ad05584e51f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何使用Anaconda安装Tensorflow2.0？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4141a1b9b507fa110b2a8c91115fdad8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">tensorrt 从0开始搭建部署环境</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>