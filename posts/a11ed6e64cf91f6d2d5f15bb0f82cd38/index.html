<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Centos7安装Hive2.0.1集群 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Centos7安装Hive2.0.1集群" />
<meta property="og:description" content="1、准备工作
1.1、安装jdk1.8和mysql5.7.21,略
1.2、安装Hadoop2.6.0，略
1.3、机器介绍
192.168.1.89 node1 192.168.1.149 node2 192.168.1.180 node3 node1、node2、node3上都已经安装了Hadoop2.6.0
2、下载并上传(三个节点都操作)
http://archive.apache.org/dist/hive/hive-2.0.1/apache-hive-2.0.1-bin.tar.gz
上传至三台机器的/data/server目录下，并解压：
tar -zxvf apache-hive-2.0.1-bin.tar.gz
3、修改配置文件(三个节点都操作)
cd apache-hive-2.0.1-bin/conf cp hive-default.xml.template hive-site.xml vi hive-site.xml，新增： &lt;configuration&gt; &lt;property&gt; &lt;name&gt;datanucleus.schema.autoCreateAll&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt; &lt;value&gt;jdbc:mysql://192.168.1.166:3306/hive_db?createDatabaseIfNotExist=true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt; &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt; &lt;value&gt;root&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt; &lt;value&gt;123456&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.support.concurrency&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.enforce.bucketing&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.exec.dynamic.partition.mode&lt;/name&gt; &lt;value&gt;nonstrict&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.txn.manager&lt;/name&gt; &lt;value&gt;org.apache.hadoop.hive.ql.lockmgr.DbTxnManager&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.compactor.initiator.on&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.compactor.worker.threads&lt;/name&gt; &lt;value&gt;1&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a11ed6e64cf91f6d2d5f15bb0f82cd38/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-03T21:27:18+08:00" />
<meta property="article:modified_time" content="2021-06-03T21:27:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Centos7安装Hive2.0.1集群</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>1、准备工作<br> 1.1、安装jdk1.8和mysql5.7.21,略<br> 1.2、安装Hadoop2.6.0，略<br> 1.3、机器介绍</p> 
<pre><code>192.168.1.89 node1
192.168.1.149 node2
192.168.1.180 node3</code></pre> 
<p>node1、node2、node3上都已经安装了Hadoop2.6.0<br> 2、下载并上传(三个节点都操作)<br> http://archive.apache.org/dist/hive/hive-2.0.1/apache-hive-2.0.1-bin.tar.gz<br> 上传至三台机器的/data/server目录下，并解压：<br> tar -zxvf apache-hive-2.0.1-bin.tar.gz<br> 3、修改配置文件(三个节点都操作)</p> 
<pre><code>cd apache-hive-2.0.1-bin/conf
cp hive-default.xml.template hive-site.xml
vi hive-site.xml，新增：
&lt;configuration&gt;
&lt;property&gt;
    &lt;name&gt;datanucleus.schema.autoCreateAll&lt;/name&gt;
    &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;
    &lt;value&gt;jdbc:mysql://192.168.1.166:3306/hive_db?createDatabaseIfNotExist=true&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;
    &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;
    &lt;value&gt;root&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;
    &lt;value&gt;123456&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;hive.support.concurrency&lt;/name&gt;
    &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;hive.enforce.bucketing&lt;/name&gt;
    &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;
    &lt;property&gt;
    &lt;name&gt;hive.exec.dynamic.partition.mode&lt;/name&gt;
    &lt;value&gt;nonstrict&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;hive.txn.manager&lt;/name&gt;
    &lt;value&gt;org.apache.hadoop.hive.ql.lockmgr.DbTxnManager&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;hive.compactor.initiator.on&lt;/name&gt;
    &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;hive.compactor.worker.threads&lt;/name&gt;
    &lt;value&gt;1&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;hive.in.test&lt;/name&gt;
    &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;hive.server2.transport.mode&lt;/name&gt;
    &lt;value&gt;binary&lt;/value&gt;
    &lt;description&gt;
      Expects one of [binary, http].
      Transport mode of HiveServer2.
    &lt;/description&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;hive.server2.thrift.bind.host&lt;/name&gt;
    &lt;value&gt;机器IP&lt;/value&gt;
    &lt;description&gt;
       Bind host on which to run the HiveServer2 Thrift interface.Can
       be overridden by setting $HIVE_SERVER2_THRIFT_BIND_HOST
    &lt;/description&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;hive.server2.thrift.port&lt;/name&gt;
    &lt;value&gt;10000&lt;/value&gt;
    &lt;description&gt;Port number of HiveServer2 Thrift interface when hive.server2.transport.mode is 'binary'.&lt;/description&gt;
 &lt;/property&gt;
&lt;/configuration&gt;</code></pre> 
<p>4、修改环境变量(三个节点都操作)</p> 
<pre><code>vim /etc/profile
export HIVE_HOME=/data/server/apache-hive-2.0.1-bin
export HIVE_CONF_DIR=$HIVE_HOME/conf
export PATH=$HIVE_HOME/bin:$PATH
激活配置：source /etc/profile</code></pre> 
<p>5、上传mysql驱动(三个节点都操作)</p> 
<pre><code>cd /data/server/apache-hive-2.0.1-bin/lib/
上传mysql-connector-java-5.1.30.jar</code></pre> 
<p>6、测试是否成功(三个节点都操作)<br> (1) hive    //登录hive<br> (2) show databases;  //显示hive表名<br> 7、后台启动服务(三个节点都操作)<br> //不需要启动 nohup hive --service metastore  &amp;<br> nohup hive --service hiveserver2  &amp;<br> 8、简单使用1(node1上操作，不可修改或删除行数据)<br> 使用beeline命令打开客户端，使用!connect jdbc:hive2://node1:10000/default连接上hive默认库并回车<br> 8.1、创建库</p> 
<pre><code>create database test_db;</code></pre> 
<p>8.2、创建表</p> 
<pre><code>use test_db;
CREATE TABLE t_test1 (a int, b int, c int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t';</code></pre> 
<p>关键字释义：<br> ROW FORMAT DELIMITED 是指明后面的关键词是列和元素分隔符的<br> FIELDS TERMINATED BY 是字段分隔符，<br> 8.3、导入数据</p> 
<pre><code>vi /data/server/apache-hive-2.0.1-bin/t_test1.txt，字段之间以tab隔开：</code></pre> 
<p>16      2       3<br> 61      12      13<br> 41      2       31<br> 17      21      3<br> 71      2       31<br> 1       12      34<br> 11      2       34<br> 导入脚本：</p> 
<pre><code>LOAD DATA LOCAL INPATH '/data/server/apache-hive-2.0.1-bin/t_test1.txt' OVERWRITE INTO TABLE t_test1;</code></pre> 
<p>8.4、新增数据</p> 
<pre><code>insert into t_test1(a,b,c) values(12,13,14);</code></pre> 
<p>8.5、查看数据(可到其他节点查询数据是否同步，从而验证集群)</p> 
<pre><code>select * from t_test1;</code></pre> 
<p>8.6、查看表结构</p> 
<pre><code>desc t_test1;</code></pre> 
<p>8.7、删除表</p> 
<pre><code>drop table t_test1;</code></pre> 
<p>9、简单使用2(node1上操作，可修改或删除行数据)<br> 使用beeline命令打开客户端，使用!connect jdbc:hive2://node1:10000/default连接上hive默认库并回车<br> 9.1、创建表</p> 
<pre><code>use test_db;
create table t_test2(id int ,name string ) clustered by (id) into 2 buckets stored as orc TBLPROPERTIES('transactional'='true');</code></pre> 
<p>关键字释义：<br> clustered by (id) into 2 buckets 将表根据id分为2个桶<br> stored as orc 表存储文件的格式为orc<br> TBLPROPERTIES('transactional'='true')启用表的事务支持<br> 9.2、导入数据<br> 不支持文件导入<br> 9.3、新增数据</p> 
<pre><code>insert into t_test2(id,name) values(1,'你好');</code></pre> 
<p>9.4、修改数据</p> 
<pre><code>update t_test2 set name = '你不好' where id=1;</code></pre> 
<p>9.5、查看数据(可到其他节点查询数据是否同步，从而验证集群)</p> 
<pre><code>select * from t_test2;</code></pre> 
<p>9.6、删除数据</p> 
<pre><code>delete from t_test2 where id=1;</code></pre> 
<p>9.7、查看表结构</p> 
<pre><code>desc t_test1;</code></pre> 
<p>9.8、删除表</p> 
<pre><code>drop table t_test1;</code></pre> 
<p>9.9、注意事项<br> 如果在创建orc表时出现lock错误提示，可以添加Hive元数据（使用mysql存储）INSERT INTO NEXT_LOCK_ID VALUES(1);<br> 10、java调用hive实例<br> 10.1、导入maven依赖</p> 
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.hive&lt;/groupId&gt;
    &lt;artifactId&gt;hive-jdbc&lt;/artifactId&gt;
    &lt;version&gt;2.1.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre> 
<p>10.2、代码实现</p> 
<pre><code>package com.x.y.test;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;

public class HiveJDBC {
    
    private static String driverName="org.apache.hive.jdbc.HiveDriver";
    private static String url = "jdbc:hive2://192.168.1.89:10000/test_db";
    private static Connection conn = null;
    private static Statement stmt = null;
    private static ResultSet rs = null;

    public static void main(String[] args) throws Exception {
        Class.forName(driverName);
        conn = DriverManager.getConnection(url, null, null);
        stmt = conn.createStatement();

        String sql = "select * from t_xxl";
        System.out.println("Running: " + sql);
        rs = stmt.executeQuery(sql);
        System.out.println("a" + "\t" + "b" +"\t" + "c" );
        while (rs.next()) {
            System.out.println(rs.getInt(1) + "\t" + rs.getString(2)+ "\t"+ rs.getString(3));
        }

        if (rs != null) {
            rs.close();
        }
        if (stmt != null) {
            stmt.close();
        }
        if (conn != null) {
            conn.close();
        }

    }

}</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bbcaa2b8d0225994dbbc00914cc63a93/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">android 携程日历控件,仿携程酒店日历组件for小程序</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c09ef2ce0d1143e762ca60a12671833c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">终于有阿里大牛把Spring Cloud的精髓全总结出来了！不服不行啊</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>