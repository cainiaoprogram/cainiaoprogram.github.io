<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>文本处理工具-----------AWK - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="文本处理工具-----------AWK" />
<meta property="og:description" content="文本处理工具--------AWK AWK介绍 awk：Aho, Weinberger, Kernighan，报告生成器，格式化文本输出 有多种版本：New awk（nawk），GNU awk（ gawk） gawk：模式扫描和处理语言，打印报表 基本用法： awk [options] ‘program’ var=value file… awk [options] -f programfile var=value file… awk [options] &#39;BEGIN{ action;… } pattern{ action;… } END{ action;… }&#39; file ... awk 程序通常由：BEGIN语句块、能够使用模式匹配的通用语句块、END语句块，共3部分组成 program通常是被单引号或双引号中 【建议用单引号】 选项： -F 指明输入时用到的字段分隔符 -v var=value: 自定义变量 AWK语言： 【行的换行符合自行指定；自带循环】 基本格式：awk [options] &#39;program&#39; file… program:pattern{action statements;..} pattern和action： • pattern部分决定动作语句何时触发及触发事件 BEGIN,END • action statements对数据进行处理，放在{}内指明 print, printf 分割符、域和记录 • awk执行时， 由分隔符分隔的字段（域）标记$1,$2..$n称为域标识。 $0为所有域，注意：和shell中变量$符含义不同 【默认空白符为分隔符】 • 文件的每一行称为记录 • 省略action，则默认执行 print $0 的操作 注意：行：称为记录record 列：称为字段或域field或属性 AWK工作原理： 第一步：执行BEGIN{action;… }语句块中的语句第二步：从文件或标准输入(stdin)读取一行，然后执行pattern{ action;… }语句块，它逐行扫描文件，从第一行到最后一行重复这个过程，直到文件全部被读取完毕。第三步：当读至输入流末尾时，执行END{action;…}语句块BEGIN语句块在awk开始从输入流中读取行之前被执行，这是一个可选的语句块，比如变量初始化、打印输出表格的表头等语句通常可以写在BEGIN语句块中END语句块在awk从输入流中读取完所有的行之后即被执行，比如打印所有行的分析结果这类信息汇总都是在END语句块中完成，它也是一个可选语句块pattern语句块中的通用命令是最重要的部分，也是可选的。如果没有提供pattern语句块，则默认执行{ print }，即打印每一个读取到的行，awk读取的每一行都会执行该语句块 AWK （支持标准输入，和标准输出，管道;支持数据运算） print格式： print item1, item2, ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2bfe1ff6205851305bc8ca0e2ad88b08/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-05-17T10:55:44+08:00" />
<meta property="article:modified_time" content="2018-05-17T10:55:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">文本处理工具-----------AWK</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="white-space:pre-wrap;text-align:center;line-height:1.75;font-size:14px;"> 
 <span style="font-size:32px;"><strong>文本处理工具--------AWK</strong></span> 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">AWK介绍</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk：Aho, Weinberger, Kernighan，报告生成器，格式化文本输出 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">
  有多种版本：New awk（nawk），GNU awk（ gawk） 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  gawk：模式扫描和处理语言，打印报表 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">基本用法</span>： 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk [options] ‘program’ var=value file… 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk [options] -f programfile var=value file… 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk [options] 'BEGIN{ action;… } pattern{ action;… } END{ action;… }' file ... 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk 程序通常由：BEGIN语句块、能够使用模式匹配的通用语句块、END语句块，共3部分组成 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  program通常是被单引号或双引号中 
 <span style="color:rgb(223,64,42);"> 【建议用单引号】</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">选项：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  -F 指明输入时用到的字段分隔符 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  -v var=value: 自定义变量 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">AWK语言：</span> 
 <span style="color:rgb(223,64,42);"><strong>【行的换行符合自行指定；自带循环】</strong></span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  基本格式：awk [options] 'program' file… 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  program:pattern{action statements;..} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  pattern和action： 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • pattern部分决定动作语句何时触发及触发事件 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  BEGIN,END 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • action statements对数据进行处理，放在{}内指明 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  print, printf 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  分割符、域和记录 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • awk执行时， 
 <span style="color:rgb(223,64,42);">由分隔符分隔的字段</span>（域）标记$1,$2..$n称为域标识。 
 <span style="color:rgb(223,64,42);">$0为所有域</span>，注意：和shell中变量$符含义不同 
 <span style="color:rgb(223,64,42);">【默认空白符为分隔符】</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • 文件的每一行称为记录 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • 省略action，则默认执行 print $0 的操作 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);background-color:rgb(250,226,32);">注意：行：称为记录record</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);background-color:rgb(250,226,32);"> 列：称为字段或域field或属性</span> 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="background-color:rgb(255,255,255);"><strong>AWK工作原理：</strong></span> 
</div> 
<ul><li style="text-align:left;line-height:1.75;font-size:14px;list-style-position:inside;white-space:pre-wrap;font-family:'Microsoft YaHei', STXihei;color:rgb(0,0,0);">第一步：执行BEGIN{action;… }语句块中的语句</li><li style="text-align:left;line-height:1.75;font-size:14px;list-style-position:inside;white-space:pre-wrap;font-family:'Microsoft YaHei', STXihei;color:rgb(0,0,0);">第二步：从文件或标准输入(stdin)读取一行，然后执行pattern{ action;… }语句块，它逐行扫描文件，从第一行到最后一行重复这个过程，直到文件全部被读取完毕。</li><li style="text-align:left;line-height:1.75;font-size:14px;list-style-position:inside;white-space:pre-wrap;font-family:'Microsoft YaHei', STXihei;color:rgb(0,0,0);">第三步：当读至输入流末尾时，执行END{action;…}语句块</li><li style="text-align:left;line-height:1.75;font-size:14px;list-style-position:inside;white-space:pre-wrap;font-family:'Microsoft YaHei', STXihei;color:rgb(0,0,0);">BEGIN语句块在awk开始从输入流中读取行之前被执行，这是一个可选的语句块，比如变量初始化、打印输出表格的表头等语句通常可以写在BEGIN语句块中</li><li style="text-align:left;line-height:1.75;font-size:14px;list-style-position:inside;white-space:pre-wrap;font-family:'Microsoft YaHei', STXihei;color:rgb(0,0,0);">END语句块在awk从输入流中读取完所有的行之后即被执行，比如打印所有行的分析结果这类信息<span style="color:rgb(223,64,42);">汇总</span>都是在END语句块中完成，它也是一个可选语句块</li><li style="text-align:left;line-height:1.75;font-size:14px;list-style-position:inside;white-space:pre-wrap;font-family:'Microsoft YaHei', STXihei;color:rgb(0,0,0);">pattern语句块中的通用命令是最重要的部分，也是可选的。如果没有提供pattern语句块，则默认执行{ print }，即打印每一个读取到的行，awk读取的每一行都会执行该语句块</li></ul> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">AWK </span> 
 <span style="color:rgb(223,64,42);"><strong>（支持标准输入，和标准输出，管道;支持数据运算）</strong></span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  print格式： print item1, item2, ... 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  要点： 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  (1) 逗号分隔符 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  (2) 输出的各item可以字符串，也可以是数值；当前记录的字段、变量或awk的表达式 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  (3) 如省略item，相当于print $0 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  示例： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk '{print "hello,awk"}' //支持键盘输入；打印hello，awk 【读一行，打印hello，awk】 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk 'BEGIN{print "hello,awk"}' //直接打印字符串“hello awk” 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk 'BEGIN{print “2^10”' //实现数值运算 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk –F: '{print}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk –F: ‘{print “wang”}’ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk –F: ‘{print $1}’ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk –F: ‘{print $0}’ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk –F: ‘{print $1”\t”$3}’ /etc/passwd 以：为分隔符，去第一和第三个字段 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  df | awk '{print $1,$5}' //取第一列和第5列，实现取分区利用率 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  tail –3 /etc/fstab |awk ‘{print $2,$4} //取出挂载点和挂载选项 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk变量：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  变量：内置和自定义变量 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  FS：输入 
 <span style="color:rgb(223,64,42);">字段分隔符</span>，默认为空白字符 
 <span style="color:rgb(223,64,42);">【对读入内容的分割】</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk -v FS=':' '{print $1,FS,$3}’ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk –F: '{print $1,$3,$7}’ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  OFS：输出字段分隔符，默认为空白字符 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk -v FS=‘:’ -v OFS=‘:’ '{print $1,$3,$7}’ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  RS：输入记录分隔符，指定输入时的换行符 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk -v RS=' ' ‘{print }’ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  ORS：输出记录分隔符，输出时用指定符号代替换行符 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk -v RS=' ' -v ORS='###'‘{print }’ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  NF：字段数量 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk -F： ‘{print NF}’ /etc/fstab,引用内置变量不用$ 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk -F: '{print $(NF-1)}' /etc/passwd //打印倒数第二个字段的值 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  NR：记录号 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk '{print NR}' /etc/fstab ; awk END'{print NR}' /etc/fstab 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  FNR：各文件分别计数,记录号 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk '{print FNR}' /etc/fstab /etc/inittab 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  FILENAME：当前文件名 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk '{print FILENAME}’ /etc/fstab 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  ARGC：命令行参数的个数 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk '{print ARGC}’ /etc/fstab /etc/inittab 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk ‘BEGIN {print ARGC}’ /etc/fstab /etc/inittab 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  ARGV：数组，保存的是命令行所给定的各参数 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk ‘BEGIN {print ARGV[0]}’ /etc/fstab /etc/inittab 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk ‘BEGIN {print ARGV[1]}’ /etc/fstab /etc/inittab 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk自定义变量:</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  (1) -v var=value 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  (2) 在program中直接定义 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">
  示例： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk -v test='hello gawk' '{print test}' /etc/fstab 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk -v test='hello gawk' 'BEGIN{print test}' 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk 'BEGIN{test="hello,gawk";print test}' 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk –F:‘{sex=“male”;print $1,sex,age;age=18}’ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  cat awkscript 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  {print script,$1,$2} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk -F: -f awkscript script=“awk” /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">printf命令</span>： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  格式化输出：printf “FORMAT”, item1, item2, ... 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  (1) 必须指定FORMAT 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  (2) 不会自动换行，需要显式给出换行控制符，\n 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  (3) FORMAT中需要分别为后面每个item指定格式符 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  格式符：与item一一对应 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  %c: 显示字符的ASCII码 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  %d, %i: 显示十进制整数 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  %e, %E:显示科学计数法数值 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  %f：显示为浮点数 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  %g, %G：以科学计数法或浮点形式显示数值 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  %s：显示字符串 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  %u：无符号整数 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  %%: 显示%自身 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  修饰符： 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  #[.#]：第一个数字控制显示的宽度；第二个#表示小数点后精度，%3.1f 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  -: 左对齐（默认右对齐） %-15s 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  +：显示数值的正负符号 %+d 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  printf示例 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk -F: ‘{printf "%s",$1}’ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">操作符：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">算术操作符：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  x+y, x-y, x*y, x/y, x^y, x%y 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  -x: 转换为负数 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  +x: 转换为数值 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">字符串操作符</span>：没有符号的操作符，字符串连接 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">赋值操作符：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  =, +=, -=, *=, /=, %=, ^= 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  ++, -- 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  下面两语句有何不同 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • awk ‘BEGIN{i=0;print ++i,i}’ 先加后输出，结果为 1 1 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • awk ‘BEGIN{i=0;print i++,i}’ 先输出后加 ，结果为 0 1 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">比较操作符：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  ==, !=, &gt;, &gt;=, &lt;, &lt;= 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">模式匹配符：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  ~：左边是否和右边匹配包含 !~：是否不匹配 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  示例： 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  awk –F: '$0 ~ /root/{print $1}‘ /etc/passwd 包含root 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  awk '$0~“^root"' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  awk '$0 !~ /root/‘ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  awk –F: ‘$3==0’ /etc/passwd 输出第三列等于0的行 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">逻辑操作符：与&amp;&amp;，或||，非!</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  示例： 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  • awk –F: '$3&gt;=0 &amp;&amp; $3&lt;=1000 {print $1}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  • awk -F: '$3==0 || $3&gt;=1000 {print $1}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  • awk -F: ‘!($3==0) {print $1}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  • awk -F: ‘!($3&gt;=500) {print $3}’ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">函数调用</span>： function_name(argu1, argu2, ...) 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">条件表达式</span>（三目表达式）： 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  selector?if-true-expression:if-false-expression（判断？为真cmd1：为假cmd2） 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  • 示例： 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk -F: '{$3&gt;=1000?usertype="Common User":usertype="Sysadmin or SysUser";printf 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">
  "%15s:%-s\n",$1,usertype}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk PATTERN</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  PATTERN:根据pattern条件，过滤匹配的行，再做处理 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  (1)如果未指定：空模式，匹配每一行 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  (2) /regular expression/：仅处理能够模式匹配到的行，需要用/ /括起来 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  awk '/^UUID/{print $1}' /etc/fstab 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  awk '!/^UUID/{print $1}' /etc/fstab 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  (3) relational expression: 关系表达式，结果为“真”才会被处理 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  真：结果为非0值，非空字符串 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  假：结果为空字符串或0值 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  （4) line ranges：行范围 
</div> 
<div style="white-space:pre-wrap;text-indent:112px;text-align:left;line-height:1.75;font-size:14px;">
  startline,endline：/pat1/,/pat2/ 不支持直接给出数字格式 
</div> 
<div style="white-space:pre-wrap;text-indent:112px;text-align:left;line-height:1.75;font-size:14px;">
  awk -F: ‘/^root\&gt;/,/^nobody\&gt;/{print $1}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:112px;text-align:left;line-height:1.75;font-size:14px;">
  awk -F: ‘(NR&gt;=10&amp;&amp;NR&lt;=20){print NR,$1}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  (5) BEGIN/END模式 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  BEGIN{}: 仅在开始处理文件中的文本之前执行一次 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  END{}：仅在文本处理完成之后执行一次 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  示例： 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • awk -F: 'i=1;j=1{print i,j}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • awk ‘!0’ /etc/passwd ; awk ‘!1’ /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • awk –F: '$3&gt;=1000{print $1,$3}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • awk -F: '$3&lt;1000{print $1,$3}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • awk -F: '$NF=="/bin/bash"{print $1,$NF}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • awk -F: '$NF ~ /bash$/{print $1,$NF}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk action:</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  常用的action分类 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • (1) Expressions:算术，比较表达式等 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • (2) Control statements：if, while等 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • (3) Compound statements：组合语句 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • (4) input statements 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • (5) output statements：print等 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk 控制语句：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  { statements;… } 组合语句 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  if(condition) {statements;…} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  if(condition) {statements;…} else {statements;…} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  while(conditon) {statments;…} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  do {statements;…} while(condition) 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  for(expr1;expr2;expr3) {statements;…} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  break 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  continue 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  delete array[index] 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  delete array 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  exit 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk 控制语句if-else：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  语法：if(condition){statement;…}[else statement] 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  if(condition1){statement1}else if(condition2){statement2} 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  else{statement3} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  使用场景：对awk取得的整行或某个字段做条件判断 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">示例：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk -F: '{if($3&gt;=1000) {printf "Common user: %s\n",$1} else {printf "root or Sysuser: %s\n",$1}}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  df -h|awk -F% '/^\/dev/{print $1}'|awk '$NF&gt;=80{print $1,$5}‘ //实现判断分区利用率 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk控制语句while循环</span>： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  语法：while(condition){statement;…} 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  条件“真”，进入循环；条件“假”，退出循环 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  使用场景： 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  对一行内的多个字段逐一类似处理时使用 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  对数组中的各元素逐一处理时使用 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  示例： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk '/^[[:space:]]*linux16/{i=1;while(i&lt;=NF){print $i,length($i); i++}}' /etc/grub2.cfg //打印Linux16所在行的每个单词和其长度 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk控制语句do-while循环</span>： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  语法：do {statement;…}while(condition) 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  意义：无论真假，至少执行一次循环体 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);background-color:rgb(255,255,255);"><strong>示例打印1到100加和【四种方法】</strong></span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);background-color:rgb(250,226,32);">awk 'BEGIN{ total=0;i=0;do{ total+=i;i++;}while(i&lt;=100);print total}’ 打印1到100加和</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);background-color:rgb(250,226,32);"> awk 'BEGIN{i=1;sum=0;while(i&lt;=100){sum+=i;i++};print sum}'</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);background-color:rgb(250,226,32);">awk 'BEGIN{for(i=1;i&lt;=100;i++)sum+=i;print sum}' </span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);background-color:rgb(250,226,32);">for((i=1,sum=0;i&lt;=100;i++));do let sum+=i;done ;echo $sum </span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);background-color:rgb(250,226,32);">seq -s + 1 100 |bc</span> 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="background-color:rgb(255,255,255);"><strong>性能比较：</strong></span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  time (awk 'BEGIN{ total=0;for(i=0;i&lt;=10000;i++){total+=i;};print total;}') 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;line-height:1.75;font-size:14px;">
  time(total=0;for i in {1..10000};do total=$(($total+i));done;echo $total) 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;line-height:1.75;font-size:14px;">
  time(for ((i=0;i&lt;=10000;i++));do let total+=i;done;echo $total) 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;line-height:1.75;font-size:14px;">
  time(seq –s ”+” 10000|bc) 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk控制语句for循环：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  语法：for(expr1;expr2;expr3) {statement;…} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  常见用法： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  for(variable assignment;condition;iteration process) 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  {for-body} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">特殊用法：</span>能够遍历数组中的元素 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  语法：for(var in array) {for-body} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  示例： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk '/^[[:space:]]*linux16/{for(i=1;i&lt;=NF;i++) {print $i,length($i)}}' /etc/grub2.cfg 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk控制语句：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">switch语句</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  语法：switch(expression) {case VALUE1 or /REGEXP/: statement1; case 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  VALUE2 or /REGEXP2/: statement2; ...; default: statementn} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">break和continue</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">示例：</span> 
</div> 
<ul><li style="text-indent:56px;text-align:left;line-height:1.75;font-size:14px;list-style-position:inside;white-space:pre-wrap;font-family:'Microsoft YaHei', STXihei;color:rgb(0,0,0);">awk ‘BEGIN{sum=0;for(i=1;i&lt;=100;i++)</li></ul> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  {if(i%2==0)continue;sum+=i}print sum}‘ 
</div> 
<ul><li style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;list-style-position:inside;white-space:pre-wrap;font-family:'Microsoft YaHei', STXihei;color:rgb(0,0,0);"> awk ‘BEGIN{sum=0;for(i=1;i&lt;=100;i++)</li></ul> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  {if(i==66)break;sum+=i}print sum}‘ 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">break [n] continue [n]</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">next:</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  提前结束对本行处理而直接进入下一行处理（awk自身循环） 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk -F: '{if($3%2!=0) next; print $1,$3}' /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk 数组：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);">关联数组</span>：array[index-expression] 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  index-expression: 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • (1) 可使用任意字符串；字符串要使用双引号括起来 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • (2) 如果某数组元素事先不存在，在引用时，awk会自动创建此元素，并将其值 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">
  初始化为“空串” 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • 若要判断数组中是否存在某元素，要使用“index in array”格式进行遍历 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  示例： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  weekdays[“mon”]="Monday“ //数组赋值 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk 'BEGIN{weekdays["mon"]="Monday"; 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  weekdays["tue"]="Tuesday";print weekdays["mon"]}‘ 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="background-color:rgb(250,212,211);">awk ‘!arr[$0]++’ dupfile //去掉文件中重复的行</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk '{!arr[$0]++;print $0, arr[$0]}' dupfile 跟踪变化过程 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk数组，遍历数组：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  for(var in array) {for-body} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);background-color:rgb(250,226,32);">注意：var会遍历array的每个索引</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="background-color:rgb(250,212,211);"> ab -c 100 -n 6521 http://172.20.0.7/ //向主机172.20.0.7发送大量的并发请求</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  示例： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  • awk 'BEGIN{weekdays["mon"]="Monday";weekdays["tue"]="Tuesday";for(i in weekdays) {print weekdays[i]}}‘ 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  • netstat -tan | awk '/^tcp/{state[$NF]++}END {for(i in state) { print i,state[i]}}' 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  • awk '/^[0-9]/{ip[$1]++}END{for(i in ip) {print i,ip[i]}}' /var/log/httpd/access_log 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);"><strong>示例：拒绝ip访问</strong></span> 
</div> 
<div style="text-align:left;float:none;"> 
 <img src="https://images2.imgbox.com/e5/13/3AQogJDv_o.png" alt=""> 
 <img src="https://images2.imgbox.com/c1/ec/Yi9oXoYl_o.png" alt=""> 
 <br> 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="background-color:rgb(250,212,211);"> iptables -A INPUT -s ip地址 -j REJECT //拒绝某ip地址访问</span> 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">
  awk '{for(i=1;i&lt;=NF;i++){word[$i]++}}END{for(j in word){print j,word[j]}}' /etc/rc.sysinit //统计文件中单词个数 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk函数：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">数值处理</span>： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  init()：取整 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  rand()：返回0和1之间一个随机数 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk 'BEGIN{srand(); for (i=1;i&lt;=10;i++)print int(rand()*100) }' 
 <span style="color:rgb(223,64,42);">//生成1到100的随机整数</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">字符串处理：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • length([s])：返回指定字符串的长度 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • sub(r,s,[t])：对t字符串进行搜索r表示的模式匹配的内容，并将第一个匹配的内容替换为s 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  echo "2008:08:08 08:08:08" | awk 'sub(/:/,“-",$1)' 
 <span style="color:rgb(223,64,42);"> //将第一个：用-代替（全代替用gsub)</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • gsub(r,s,[t])：对t字符串进行搜索r表示的模式匹配的内容，并全部替换为s所表示的内容 
</div> 
<div style="white-space:pre-wrap;text-indent:84px;text-align:left;line-height:1.75;font-size:14px;">
  echo "2008:08:08 08:08:08" | awk ‘gsub(/:/,“-",$0)' 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  • split(s,array,[r])：以r为分隔符，切割字符串s，并将切割后的结果保存至array所表示的数组中，第一个索引值为1,第二个索引值为2,… 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  netstat -tan | awk '/^tcp\&gt;/{split($5,ip,":");count[ip[1]]++}END{for (i in count) {print i,count[i]}}' 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);"><strong>自定义函数</strong></span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  格式： 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  function name ( parameter, parameter, ... ) { 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  statements 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">
  return expression 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  } 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);"> 示例：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  cat fun.awk 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  function max(v1,v2) { 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  v1&gt;v2?var=v1:var=v2 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  return var 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  } 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  BEGIN{a=3;b=2;print max(a,b)} 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <br> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  awk –f fun.awk 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk中调用shell命令</span>： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);">system命令</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);background-color:rgb(250,226,32);">空格是awk中的字符串连接符，如果system中需要使用awk中的变量可以使用空格分隔，或者说除了awk的变量外其他一律用""引用起来。</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk BEGIN'{system("hostname") }' 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awk 'BEGIN{score=100; system("echo your score is " score) }' 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">awk脚本：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  将awk程序写成脚本，直接调用或执行 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);">示例</span>： 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">
  cat f1.awk 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  {if($3&gt;=1000)print $1,$3} 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">
  awk -F: -f f1.awk /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  cat f2.awk 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  #!/bin/awk –f //必须这么写 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  #this is a awk script 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  {if($3&gt;=1000)print $1,$3} 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  chmod +x f2.awk 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">
  f2.awk –F: /etc/passwd 
</div> 
<div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="font-weight:bold;">向awk脚本传递参数：</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  格式： 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  awkfile var=value var2=value2... Inputfile 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);background-color:rgb(250,226,32);">注意：在BEGIN过程中不可用。直到首行输入完成以后，变量才可用。可以通过-v 参数，让awk在执行BEGIN之前得到变量的值。命令行中每一个指定的变量都需要一个-v参数</span> 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"> 
 <span style="color:rgb(223,64,42);">示例</span>： 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  cat test.awk 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  #!/bin/awk –f 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  {if($3 &gt;=min &amp;&amp; $3&lt;=max)print $1,$3} 
</div> 
<div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">
  chmod +x test.awk 
</div> 
<div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">
  test.awk -F: min=100 max=200 /etc/passwd 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b0459c61fd7dcd4bf96b80a463efc82c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【java】【jvm】使用命令行jmap手工触发fullGC</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5dabca52f96ea3bebbccb09ceb0f9c5e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">php 微信公众号开发之 三 自定义菜单</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>