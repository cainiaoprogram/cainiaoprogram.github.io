<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>二进制转BCD码原理及verilog实现 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="二进制转BCD码原理及verilog实现" />
<meta property="og:description" content="一、BCD码概念 BCD码（Binary-Coded Decimal‎），利用四个2进制位储存一个10进制的数，如下表所示。本文所讨论的问题均以8421BCD码为例，十进制的0~9分别用0000~1001来表示。
十进制数23，可表示为0010_0011，十进制数129，可表示为0001_0010_1001。
即分别对个位、十位、百位求对应的BCD码。
​二、二进制数到BCD码的转换 先根据输入不同位数的二进制数，求对应的BCD码
假设输入1位二进制数1，则对应的BCD码为0001，对应十进制1；
若输入2位二进制数11，则BCD码为0011，对应十进制3；
若输入3位二进制数111，则BCD码为0111，对应十进制7；
若输入4位二进制数1110，那么问题来了，BCD码范围在0000~1001之间, 是满10进位的, 它只能表示十进制数0~9，而1110对应的十进制数为14！理应转换为0001_0100才对！
那怎么才能转换成0001_0100呢？
需要对进位的时机做一些处理,
先看看以下的分析：
1110（十进制14，BCD码需要表示十位和个位）是111（十进制7）左移一位的结果，其大小等于二倍的111，同理：
1100（十进制12，BCD码需要表示十位和个位）是110（十进制6）左移一位的结果，其大小等于二倍的110，
1010（十进制10，BCD码需要表示十位和个位）是101（十进制5）左移一位的结果，其大小等于二倍的101，
1000（十进制8，BCD码只需要表示个位）是100（十进制4）左移一位的结果，其大小等于二倍的100，
左移相当于乘2, 那么当二进制数 ≥ 0101b, 即≥5（或&gt; 0100b, 即 ＞4）的时候，左移以后就 ≥ 1010b , 即 ≥ 10，对应的BCD码就需要表示个位和十位了，那么对于一个 4 位的二进制数，先输入的高3位在 ≥5 （或 &gt; 4 ）的时候，要对它们处理一下，使得最低位输入进来后，表示十位的BCD码为0001。
这个处理过程, 称为:
加3移位法 举例说明一下, 先设输入一个4位二进制数, 记作abcd，输出为其对应的8421BCD码.
在最低位输入前，如果高3位的 abc ≥ 0101（或 abc &gt; 0100）时, 对其加上3（即0011）, 最低位d输入, 使得加过3的高3位整体左移一位.
这相当于（abc &#43; 0011）*2&#43;d，即abc*2 &#43; 6 &#43; d，红字的部分就直接 ≥ 16 了，超过了4位2进制数表示的范围, 向更高位进一位！那么此时表示十位的BCD码为0001。
举两个实例, 更容易理解:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/05eb297ab057a2dd0368da5f3581a6b9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-13T15:16:06+08:00" />
<meta property="article:modified_time" content="2023-07-13T15:16:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">二进制转BCD码原理及verilog实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、BCD码概念</h2> 
<p style="margin-left:0;text-align:left;">BCD码（Binary-Coded Decimal‎），利用四个2进制位储存一个10进制的数，如下表所示。本文所讨论的问题均以8421BCD码为例，十进制的0~9分别用0000~1001来表示。</p> 
<p style="margin-left:0;text-align:left;">十进制数23，可表示为0010_0011，十进制数129，可表示为0001_0010_1001。</p> 
<p style="margin-left:0;text-align:left;">即分别对个位、十位、百位求对应的BCD码。</p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="457" src="https://images2.imgbox.com/a7/f3/1yBuJbSJ_o.png" width="860"></p> 
<p></p> 
<h2 style="margin-left:.0001pt;text-align:left;">​二、二进制数到BCD码的转换</h2> 
<p>先根据输入不同位数的二进制数，求对应的BCD码</p> 
<p>假设输入1位二进制数1，则对应的BCD码为0001，对应十进制1；</p> 
<p>若输入2位二进制数11，则BCD码为0011，对应十进制3；</p> 
<p>若输入3位二进制数111，则BCD码为0111，对应十进制7；</p> 
<p>若输入4位二进制数1110，那么问题来了，<span style="color:#fe2c24;">BCD码范围在0000~1001之间, 是满10进位的</span>, 它只能表示十进制数0~9，而1110对应的十进制数为14！理应转换为0001_0100才对！</p> 
<p>那怎么才能转换成0001_0100呢？</p> 
<p>需要对进位的时机做一些处理,</p> 
<p>先看看以下的分析：</p> 
<p><span style="color:#fe2c24;">1110</span>（十进制14，BCD码需要表示十位和个位）是111（十进制7）左移一位的结果，其大小等于二倍的111，同理：</p> 
<p><span style="color:#fe2c24;">1100</span>（十进制12，BCD码需要表示十位和个位）是110（十进制6）左移一位的结果，其大小等于二倍的110，</p> 
<p><span style="color:#fe2c24;">1010</span>（十进制10，BCD码需要表示十位和个位）是101（十进制5）左移一位的结果，其大小等于二倍的101，</p> 
<p>1000（十进制8，BCD码只需要表示个位）是100（十进制4）左移一位的结果，其大小等于二倍的100，</p> 
<p><span style="color:#fe2c24;">左移相当于乘2</span>, 那么<span style="color:#fe2c24;">当二进制数 ≥ 0101b, 即≥5（或&gt; 0100b,  即 ＞4）</span>的时候，<span style="color:#fe2c24;">左移以后就 ≥ 1010b , 即 ≥ 10</span>，对应的BCD码就需要表示<span style="color:#fe2c24;">个位和十位</span>了，那么对于一个 4 位的二进制数，先输入的高3位在 ≥5 （或 &gt; 4 ）的时候，要对它们处理一下，使得最低位输入进来后，表示十位的BCD码为0001。</p> 
<p></p> 
<p>这个处理过程, 称为:</p> 
<h2><strong>加3移位法</strong></h2> 
<p></p> 
<p>举例说明一下, 先设输入一个4位二进制数, 记作abcd，输出为其对应的8421BCD码.</p> 
<p>在最低位输入前，<strong><span style="color:#fe2c24;">如果高3位的 abc  ≥ 0101（或 abc  &gt; 0100）时, 对其加上3（即0011）</span></strong>, 最低位d输入, 使得加过3的高3位整体左移一位.</p> 
<p>这相当于（abc + 0011）*2+d，即<span style="color:#fe2c24;">abc*2 + 6 </span>+ d，红字的部分就直接<span style="color:#fe2c24;"> ≥ 16 </span>了，超过了4位2进制数表示的范围,  <span style="color:#fe2c24;">向更高位进一位！那么此时表示十位的BCD码为0001。</span></p> 
<p></p> 
<p>举两个实例, 更容易理解:</p> 
<h4>例1：</h4> 
<p>还是以输入为4位二进制数1110(十进制14)为例：</p> 
<p>送入最高位得到0001；</p> 
<p>送入第二位得到0011；</p> 
<p>送入第三位得到0111 &gt; 0100，在0111基础上进行<strong>修正</strong>，即0111 + 0011 = 1010；</p> 
<p>在修正的结果上送入第四位得到<span style="color:#fe2c24;">1_</span>0100，即<span style="color:#fe2c24;">0001_0100</span>即为1110的BCD码（十进制14）。</p> 
<h4>例2：</h4> 
<p style="margin-left:.0001pt;text-align:left;">再以输入为8位二进制数10100101（十进制165）为例，8位二进制数表示范围为0~255，BCD码需要表示百位、十位、个位, 将<span style="color:#fe2c24;">10100101b从高位到低位依次送入</span>:</p> 
<p style="margin-left:.0001pt;text-align:left;">送入最高位1, 得到0001；</p> 
<p style="margin-left:.0001pt;text-align:left;">送入第二位0, 得到0010；</p> 
<p style="margin-left:.0001pt;text-align:left;">送入第三位1, 得到0101 ，因为0101 &gt; 0100，<strong>修正</strong>：0101 + 0011 = 1000；</p> 
<p style="margin-left:.0001pt;text-align:left;">送入第四位0, 得到0001_0000；</p> 
<p style="margin-left:.0001pt;text-align:left;">送入第五位0, 得到0010_0000；</p> 
<p style="margin-left:.0001pt;text-align:justify;">送入第六位1, 得到0100_0001；</p> 
<p style="margin-left:.0001pt;text-align:justify;">送入第七位0, 得到1000_0010，1000 &gt; 0100，<strong>修正</strong>：1000 + 0011 = 1011；</p> 
<p style="margin-left:.0001pt;text-align:justify;">送入第八位1, 得到0001_0110_0101，得到输出结果为<span style="color:#fe2c24;">0001_0110_0101</span>（十进制165）。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#fe2c24;">归纳为:</span></strong>  <span style="color:#fe2c24;">每次当新的一位输入前, 都需要对表示 百位/十位/个位 的连续4bit数据判断大小. 大于4, 则进行加3移位处理.</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">下面为二进制转BCD码的verilog实现过程:</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h2 style="margin-left:.0001pt;text-align:justify;">三、verilog实现</h2> 
<p style="margin-left:.0001pt;text-align:justify;">设计一个<span style="color:#fe2c24;">8位无符号二进制数</span>（取值范围0 ~ 255）到<span style="color:#fe2c24;">10位BCD码</span>的转换组合逻辑电路。其中10位BCD码定义如下：</p> 
<table align="center" border="1" cellspacing="0"><tbody><tr><td style="vertical-align:top;width:85.05pt;"> <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>数据位</strong></strong></p> </td><td style="vertical-align:top;width:141.75pt;"> <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>描述</strong></strong></p> </td></tr><tr><td style="vertical-align:top;width:85.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">9:8</p> </td><td style="vertical-align:top;width:141.75pt;"> <p style="margin-left:.0001pt;text-align:justify;">百位BCD码，取值0 ~ 2</p> </td></tr><tr><td style="vertical-align:top;width:85.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">7:4</p> </td><td style="vertical-align:top;width:141.75pt;"> <p style="margin-left:.0001pt;text-align:justify;">十位BCD码，取值0 ~ 9</p> </td></tr><tr><td style="vertical-align:top;width:85.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">3:0</p> </td><td style="vertical-align:top;width:141.75pt;"> <p style="margin-left:.0001pt;text-align:justify;">个位BCD码，取值0 ~ 9</p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;">例如：</p> 
<p style="margin-left:.0001pt;text-align:justify;">输入8'b10100101（十进制165），输出10'b01_0110_0101；</p> 
<p style="margin-left:.0001pt;text-align:justify;">输入8'b11110000（十进制240），输出10'b10_0100_0000.</p> 
<p style="margin-left:.0001pt;text-align:justify;">模块输入输出功能定义：</p> 
<table align="center" border="1" cellspacing="0"><tbody><tr><td style="vertical-align:top;width:85.05pt;"> <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>名称</strong></strong></p> </td><td style="vertical-align:top;width:70.9pt;"> <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>方向</strong></strong></p> </td><td style="vertical-align:top;width:70.9pt;"> <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>位宽</strong></strong></p> </td><td style="vertical-align:top;width:141.75pt;"> <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>描述</strong></strong></p> </td></tr><tr><td style="vertical-align:top;width:85.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">bin_in</p> </td><td style="vertical-align:top;width:70.9pt;"> <p style="margin-left:.0001pt;text-align:justify;">I</p> </td><td style="vertical-align:top;width:70.9pt;"> <p style="margin-left:.0001pt;text-align:justify;">8</p> </td><td style="vertical-align:top;width:141.75pt;"> <p style="margin-left:.0001pt;text-align:justify;">输入二进制数</p> </td></tr><tr><td style="vertical-align:top;width:85.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">bcd_out</p> </td><td style="vertical-align:top;width:70.9pt;"> <p style="margin-left:.0001pt;text-align:justify;">O</p> </td><td style="vertical-align:top;width:70.9pt;"> <p style="margin-left:.0001pt;text-align:justify;">10</p> </td><td style="vertical-align:top;width:141.75pt;"> <p style="margin-left:.0001pt;text-align:justify;">输出BCD编码</p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;">要求：</p> 
<p style="margin-left:.0001pt;text-align:justify;">Verilog实现代码可综合，逻辑延迟越小越好，给出仿真结果。</p> 
<p style="margin-left:.0001pt;text-align:justify;">设计代码:</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#fe2c24;">注：</span></strong>此处通过阻塞赋值实现移位寄存器的功能，用阻塞赋值描述移位寄存器是可行的（但这种风格并不好），通过阻塞赋值，只要<strong><span style="color:#fe2c24;">赋值的顺序正确</span></strong>，就可以通过组合逻辑描述移位寄存器。相较于时序逻辑，可以有更小的逻辑延迟和资源消耗。</p> 
<p style="margin-left:.0001pt;text-align:justify;">参考：夏宇闻《verilog数字系统设计教程》-- 14.5.寄存器模型 -- 例14.6</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<pre><code>module binary_bcd(
	input	[7:0]	bin_in,
	output	[9:0]	bcd_out
    );
	
reg [3:0] ones;
reg [3:0] tens;
reg [1:0] hundreds;
integer i;

always @(*) begin
	ones 		= 4'd0;
	tens 		= 4'd0;
	hundreds 	= 2'd0;
	
	for(i = 7; i &gt;= 0; i = i - 1) begin
		if (ones &gt;= 4'd5) 		ones = ones + 4'd3;
		if (tens &gt;= 4'd5) 		tens = tens + 4'd3;
		if (hundreds &gt;= 4'd5)	hundreds = hundreds + 4'd3;
		hundreds = {hundreds[0],tens[3]};
		tens	 = {tens[2:0],ones[3]};
		ones	 = {ones[2:0],bin_in[i]};
	end

end	

assign bcd_out = {hundreds, tens, ones};

endmodule</code></pre> 
<p>testbench:</p> 
<pre><code>`timescale 1ns / 1ps

module tb_binary_bcd();

reg 	[7:0] bin_in;
wire  	[9:0] bcd_out;

initial begin
	bin_in = 8'b1010_0101; //十进制165
	#100
	bin_in = 8'b1111_0000; //十进制240
	#100
	bin_in = 8'b1111_1111;	//十进制255
end

binary_bcd u_binary_bcd(
	.bin_in (bin_in),
	.bcd_out(bcd_out)
);

endmodule</code></pre> 
<p>仿真结果：</p> 
<p><img alt="" height="255" src="https://images2.imgbox.com/72/ee/Oh6yYqbK_o.png" width="676"></p> 
<p> 综合结果：</p> 
<p><img alt="" height="297" src="https://images2.imgbox.com/b4/03/CZO7dMy0_o.png" width="296"></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f5ac241f06248bc23a4c81f3a78c9baa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">linux查看cpu与内存</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/238eb86a9ea749bb1e909e9ae7e5907e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">长亭WAF社区版联动企业微信报警</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>