<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>高中成绩主成分分析 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="高中成绩主成分分析" />
<meta property="og:description" content="高中成绩主成分分析 “”&#34;
1.导入模块
2.导入数据
3.建立变量的相关系数矩阵ρ
4.求ρ的特征值λ1&gt;λ2&gt;…&gt;λp&gt;0,和特征向量e1,e2,…,ep
5.写出前m个主成分Y1,Y2,…,Ym的表达式
6.计算样本各主成分的得分
7.计算总主成分Y=(λ1Y1&#43;λ2Y2&#43;…&#43;λ1Ym)/(λ1&#43;λ2&#43;…&#43;λm)的综合得分
“”&#34;
1.导入模块 import pandas as pd # 数据分析的模块
import numpy as np # 数据分析的模块
import matplotlib.pyplot as plt # 画图的模块
import seaborn as sns # 画图的模块
from factor_analyzer.factor_analyzer import calculate_bartlett_sphericity # Bartlett’s球状检验
from factor_analyzer.factor_analyzer import calculate_kmo # KMO检验
plt.style.use(‘seaborn-whitegrid’) # 画图的风格
plt.rc(‘font’, **{‘family’: ‘Microsoft YaHei, SimHei’}) # 显示中文字体的模块
2.导入数据 df = pd.read_excel(r’D:\codes\金融大数据挖掘与分析\实验十二 主成分分析\学生成绩表.xls’, usecols=range(1, 10)) # 导入数据，去掉第1列的索引，样本数据
n, p = df." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/fb54becb9e694252c7c414f0f3b64dd9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-06T17:29:41+08:00" />
<meta property="article:modified_time" content="2022-12-06T17:29:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">高中成绩主成分分析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>高中成绩主成分分析</h2> 
<p>“”"<br> 1.导入模块<br> 2.导入数据<br> 3.建立变量的相关系数矩阵ρ<br> 4.求ρ的特征值λ1&gt;λ2&gt;…&gt;λp&gt;0,和特征向量e1,e2,…,ep<br> 5.写出前m个主成分Y1,Y2,…,Ym的表达式<br> 6.计算样本各主成分的得分<br> 7.计算总主成分Y=(λ1Y1+λ2Y2+…+λ1Ym)/(λ1+λ2+…+λm)的综合得分<br> “”"</p> 
<h2><a id="1_10"></a>1.导入模块</h2> 
<p>import pandas as pd # 数据分析的模块<br> import numpy as np # 数据分析的模块<br> import matplotlib.pyplot as plt # 画图的模块<br> import seaborn as sns # 画图的模块<br> from factor_analyzer.factor_analyzer import calculate_bartlett_sphericity # Bartlett’s球状检验<br> from factor_analyzer.factor_analyzer import calculate_kmo # KMO检验<br> plt.style.use(‘seaborn-whitegrid’) # 画图的风格<br> plt.rc(‘font’, **{‘family’: ‘Microsoft YaHei, SimHei’}) # 显示中文字体的模块</p> 
<h2><a id="2_20"></a>2.导入数据</h2> 
<p>df = pd.read_excel(r’D:\codes\金融大数据挖掘与分析\实验十二 主成分分析\学生成绩表.xls’, usecols=range(1, 10)) # 导入数据，去掉第1列的索引，样本数据<br> n, p = df.shape # n样本的个数，p属性的个数<br> df.describe().to_csv(r’D:\codes\金融大数据挖掘与分析\实验十二 主成分分析\describe_data.csv’, encoding=‘gb18030’, index=False) # 查看描述统计信息（最大、最小、平均、中位、四分位、标准差）并保存为csv文件</p> 
<h2><a id="_25"></a>数据检验</h2> 
<h2><a id="Bartletts_26"></a>Bartlett’s球状检验</h2> 
<h2><a id="1_27"></a>检验总体变量的相关矩阵是否是单位阵（相关系数矩阵对角线的所有元素均为1,所有非对角线上的元素均为零）；即检验各个变量是否各自独立。</h2> 
<h2><a id="_28"></a>如果该值较⼤,且其对应的相伴概率值⼩于指定的显著⽔平时,拒绝零假设,表明相关系数矩阵不是单位阵,原有变量之间存在相关性,适合进⾏主成分分析；反之,如果该值较小,原有变量之间不存在相关性,数据不适合进⾏主成分分析。</h2> 
<p>chi_square_value, p_value = calculate_bartlett_sphericity(df)<br> print(“Bartlett’s球状检验参数：\n”, chi_square_value, p_value)</p> 
<h2><a id="KMO_32"></a>KMO检验</h2> 
<h2><a id="01KMO1_33"></a>检查变量间的相关性和偏相关性，取值在0-1之间；KMO统计量越接近1，变量间的相关性越强，偏相关性越弱，主成分分析的效果越好。</h2> 
<h2><a id="06_34"></a>通常取值超0.6开始进行主成分分析</h2> 
<p>kmo_all, kmo_model = calculate_kmo(df)<br> print(“KMO检验参数：\n”, kmo_model)</p> 
<h2><a id="3_38"></a>3.建立变量的相关系数矩阵ρ</h2> 
<p>ρ = df.corr(method=‘pearson’) # 样本相关系数矩阵</p> 
<h2><a id="printpdDataFrameround_2values___4_40"></a>print(pd.DataFrame(round(ρ, 2).values)) # 打印保留4位小数的相关系数矩阵</h2> 
<p>ρ1 = pd.DataFrame(round(ρ, 4).values)<br> ρ1.to_csv(r’D:\codes\金融大数据挖掘与分析\实验十二 主成分分析\相关系数矩阵.csv’, encoding=‘gb18030’, index=False)</p> 
<h2><a id="_44"></a>相关系数热力图</h2> 
<p>sns.heatmap(ρ, annot=True) # annot=True: 显示相关系数矩阵的具体数值</p> 
<h2><a id="07PCA_46"></a>发现变量间相关性都比较高，大于0.7，有做PCA的必要</h2> 
<h2><a id="412p0e1e2ep_48"></a>4.求相关系数矩阵ρ的特征值λ1&gt;λ2&gt;…&gt;λp&gt;0,和特征向量e1,e2,…,ep</h2> 
<p>λ, e = np.linalg.eig(ρ) # 求特征值λ与特征向量e，特征值默认从大到小排序<br> e = pd.DataFrame(e) # 特征向量以dataframe显示</p> 
<h2><a id="_52"></a>特征值的散点图和折线图</h2> 
<p>plt.scatter(range(1, df.shape[1] + 1), λ)<br> plt.plot(range(1, df.shape[1] + 1), λ)<br> plt.title(“Scree Plot”)<br> plt.xlabel(“Factors”)<br> plt.ylabel(“Eigenvalue”)<br> plt.grid() # 显示网格</p> 
<h2><a id="_60"></a>主成分的贡献率</h2> 
<p>contr = [] # 主成分的贡献率列表<br> for i in range(len(λ)):<br> contri = λ[i] / np.sum(λ) # 贡献率的计算<br> contr.append(contri) # 添加主成分的贡献率到列表中<br> contr = pd.DataFrame(contr) # 把列表转换成dataframe</p> 
<h2><a id="_67"></a>累计贡献率的折线图</h2> 
<p>plt.plot(np.cumsum(contr), linewidth=3) # 累计贡献率的折线图<br> plt.xlabel(“主成分的数量”) # X轴标签<br> plt.ylabel(“累\n积\n贡\n献\n率”, rotation=0, labelpad=20) # Y轴标签<br> plt.axhline(y=0.8, c=‘r’, ls=‘–’, lw=2) # 保留主成分的临界值<br> tick_label = [‘第1主成分’, ‘第2主成分’, ‘第3主成分’, ‘第4主成分’, ‘第5主成分’, ‘第6主成分’, ‘第7主成分’]<br> plt.grid(True) # 画网格线<br> plt.show()</p> 
<h2><a id="5mY1Y2Ym_76"></a>5.写出前m个主成分Y1,Y2,…,Ym</h2> 
<p>s = 0 # 累计贡献率<br> m = 0 # 保留主成分的个数<br> cr = [] # 贡献率列表<br> for i in range(len(λ)):<br> m += 1 # 保留主成分的个数<br> contri = λ[i] / np.sum(λ) # 第i主成分贡献率<br> cr.append(contri) # 追加贡献率<br> s += contri # 累计贡献率值的计算<br> if s &gt;= 0.8: # 累计贡献率达80%即停止<br> break<br> li = pd.DataFrame(λ)[0:m].values # 保留的特征值<br> cr = pd.DataFrame(cr) # 贡献率，返回的是dataframe<br> cr[‘cr_sum’] = cr.cumsum() # 添加累计贡献率列<br> cr[‘特征值’] = li # 添加特征值列</p> 
<h2><a id="_92"></a>写出主成分的表达式</h2> 
<p>e = pd.DataFrame(e)<br> e = e.iloc[:, :m] # 保留的特征值对应的特征向量，返回的是DataFrame<br> round(e, 4) # 保留4位小数的特征向量<br> for i in range(m):<br> print(‘y’ + str(i+1) + ‘=’ + str(round(e.iloc[0, i], 4)) + ‘*X1+’ + str(round(e.iloc[1, i], 4)) + ‘*X2+’ + str(round(e.iloc[2, i], 4)) + ‘*X3+’ + str(round(e.iloc[3, i], 4)) + ‘*X4+’ + str(round(e.iloc[4, i], 4)) + ‘*X5+’ + str(round(e.iloc[5, i], 4)) + ‘*X6+’ + str(round(e.iloc[6, i], 4)) + ‘*X7+’ + str(round(e.iloc[5, i], 4)) + ‘*X8+’ + str(round(e.iloc[6, i], 4)) + ‘*X9’) # 写出主成分的表达式</p> 
<h2><a id="6_99"></a>6.计算样本各主成分的得分</h2> 
<p>score = pd.DataFrame(np.dot(df, e)) # df乘以e 得到100X3的矩阵,100个学生的3个主成分得分<br> score = score.rename(columns={0: ‘第1主成分得分’, 1: ‘第2主成分得分’, 2: ‘第3主成分得分’})</p> 
<h2><a id="7Y1Y12Y21Ym12m_103"></a>7.计算总主成分Y=(λ1Y1+λ2Y2+…+λ1Ym)/(λ1+λ2+…+λm)的综合得分</h2> 
<p>cr = pd.DataFrame(cr) # 贡献率、累计贡献率、特征值<br> score_T = np.dot(score, cr.iloc[:, 0]) # 总主成分得分<br> score_T = pd.DataFrame(score_T)<br> df1 = pd.read_excel(r’D:\codes\金融大数据挖掘与分析\实验十二 主成分分析\学生成绩表.xls’, usecols=range(0, 1)) # 获得样本的名单<br> df1 = df1.join(score_T) # 各个样本的总主成分得分<br> df1 = df1.sort_values(by=0, ascending=False) # 对各个样本总主成分得分降序排列<br> df1 = df1.rename(columns={0: ‘综合得分’})</p> 
<p>print(‘原始数据的前5行：’, df.head())<br> print(‘相关系数矩阵：’, ρ1)<br> print(‘特征值：\n’, round(pd.DataFrame(λ), 4))<br> print(‘特征向量：\n’, round(e, 4))<br> print(‘保留的主成分个数：’, m)<br> print(‘保留主成分的贡献率、累计贡献率、特征值：\n’, round(cr, 4))<br> print(‘各主成分得分：\n’, round(score, 4))<br> print(‘主成分综合得分：\n’, round(df1, 4))</p> 
<p>附录：学生成绩表<br> 100个学生语文、数学、英语、政治、地理、历史、物理、化学、生物的成绩</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/85e882de892145f1c64989b6d3192a22/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">设置canvas画布大小</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/aba1fbb25ea9823bc62cf4d1454710c7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">VS2017编码格式不同报错</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>