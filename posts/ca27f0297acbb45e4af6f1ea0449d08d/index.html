<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vueé¡¹ç›®æŒ‰éœ€è¯·æ±‚ï¼Œç»„ä»¶æ•°æ®æ‡’åŠ è½½â€”@vueuse/coreä¸­ useIntersectionObserverçš„ä½¿ç”¨ - èœé¸Ÿç¨‹åºå‘˜åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Vueé¡¹ç›®æŒ‰éœ€è¯·æ±‚ï¼Œç»„ä»¶æ•°æ®æ‡’åŠ è½½â€”@vueuse/coreä¸­ useIntersectionObserverçš„ä½¿ç”¨" />
<meta property="og:description" content="Vueé¡¹ç›®æŒ‰éœ€è¯·æ±‚ï¼Œç»„ä»¶æ•°æ®æ‡’åŠ è½½â€”@vueuse/coreä¸­ useIntersectionObserverçš„ä½¿ç”¨ ä¸€ã€é€šè¿‡ç›‘å¬ scroll äº‹ä»¶å®ç° import { ref } from &#39;vue&#39;; // å“åº”å¼æ•°æ®ï¼Œç”¨äºæ˜¯å¦æ˜¾ç¤ºå›ºå®šå¤´éƒ¨ const isShow = ref(false); // ç›‘å¬æµè§ˆå™¨æ»šåŠ¨äº‹ä»¶ window.addEventListener(&#39;scroll&#39;, () =&gt; { // è·å–æ»šåŠ¨å‡ºå»çš„è·ç¦» const top = document.documentElement.scrollTop; if (top &gt;= 78) { // å¤§äºç­‰äº 78 æ˜¾ç¤ºç›’å­ isShow.value = true; } else { // åä¹‹éšè—ç›’å­ isShow.value = false; } }); // tempalte &lt;div class=&#34;app-header-sticky&#34; :class=&#34;{ show: isShow }&#34;&gt;&lt;/div&gt; äºŒã€é€šè¿‡ @vueuse/coreå®ç° å³å½“æ¨¡å—è¿›å…¥åˆ° å¯è§†åŒº ï¼Œå†å‘è¯·æ±‚è·å–æ•°æ®
ä½¿ç”¨ @vueuse/core ä¸­çš„ useIntersectionObserver æ¥å®ç°ç›‘å¬ç»„ä»¶è¿›å…¥å¯è§†åŒºåŸŸè¡Œä¸ºï¼Œ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ca27f0297acbb45e4af6f1ea0449d08d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-30T10:45:43+08:00" />
<meta property="article:modified_time" content="2022-08-30T10:45:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="èœé¸Ÿç¨‹åºå‘˜åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">èœé¸Ÿç¨‹åºå‘˜åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vueé¡¹ç›®æŒ‰éœ€è¯·æ±‚ï¼Œç»„ä»¶æ•°æ®æ‡’åŠ è½½â€”@vueuse/coreä¸­ useIntersectionObserverçš„ä½¿ç”¨</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Vuevueusecore_useIntersectionObserver_0"></a>Vueé¡¹ç›®æŒ‰éœ€è¯·æ±‚ï¼Œç»„ä»¶æ•°æ®æ‡’åŠ è½½â€”<code>@vueuse/core</code>ä¸­ <code>useIntersectionObserver</code>çš„ä½¿ç”¨</h2> 
<h4><a id="_scroll__2"></a>ä¸€ã€é€šè¿‡ç›‘å¬ scroll äº‹ä»¶å®ç°</h4> 
<pre><code class="prism language-ts"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>

<span class="token comment">// å“åº”å¼æ•°æ®ï¼Œç”¨äºæ˜¯å¦æ˜¾ç¤ºå›ºå®šå¤´éƒ¨</span>
<span class="token keyword">const</span> isShow <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ç›‘å¬æµè§ˆå™¨æ»šåŠ¨äº‹ä»¶</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// è·å–æ»šåŠ¨å‡ºå»çš„è·ç¦»</span>
  <span class="token keyword">const</span> top <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>top <span class="token operator">&gt;=</span> <span class="token number">78</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// å¤§äºç­‰äº 78 æ˜¾ç¤ºç›’å­</span>
    isShow<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// åä¹‹éšè—ç›’å­</span>
    isShow<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// tempalte</span>
<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"app-header-sticky"</span> <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"{ show: isShow }"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="_vueusecore_28"></a>äºŒã€é€šè¿‡ <code>@vueuse/core</code>å®ç°</h4> 
<blockquote> 
 <p>å³å½“æ¨¡å—è¿›å…¥åˆ° å¯è§†åŒº ï¼Œå†å‘è¯·æ±‚è·å–æ•°æ®</p> 
</blockquote> 
<p>ä½¿ç”¨ <code>@vueuse/core</code> ä¸­çš„ <code>useIntersectionObserver</code> æ¥å®ç°ç›‘å¬ç»„ä»¶è¿›å…¥å¯è§†åŒºåŸŸè¡Œä¸ºï¼Œ</p> 
<p>éœ€è¦é…åˆ <code>vue3</code> çš„ç»„åˆ <code>API</code> çš„æ–¹å¼æ‰èƒ½å®ç° <a href="https://vueuse.org/core/useIntersectionObserver/" rel="nofollow">å¯å‚è€ƒå®˜ç½‘</a></p> 
<p>å…ˆåˆ†æä¸‹è¿™ä¸ª<code>useIntersectionObserver</code> å‡½æ•°ï¼š</p> 
<h5><a id="_38"></a>âœ¨æ ¸å¿ƒå•è¯è§£é‡Šï¼š</h5> 
<ul><li><code>useIntersectionObserver</code> æ£€æŸ¥å…ƒç´ æ˜¯å¦è¿›å…¥å¯è§†åŒºå‡½æ•°</li><li><code>target</code> ç›®æ ‡å…ƒç´ ï¼ŒğŸ¯éœ€é…åˆæ¨¡æ¿ ref ä½¿ç”¨</li><li><code>isIntersecting </code> æ˜¯å¦è¿›å…¥å¯è§†åŒº(å¸ƒå°”å€¼)</li><li><code>stop</code> ç”¨äºåœæ­¢æ£€æµ‹çš„å‡½æ•°</li></ul> 
<pre><code class="prism language-ts"><span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> useIntersectionObserver <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vueuse/core'</span><span class="token punctuation">;</span>

<span class="token comment">// å‡†å¤‡ç›®æ ‡å…ƒç´ (DOMèŠ‚ç‚¹æˆ–ç»„ä»¶ï¼Œéœ€é…åˆæ¨¡æ¿ ref ä½¿ç”¨)</span>
<span class="token keyword">const</span> target <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> stop <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useIntersectionObserver</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> isIntersecting <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ£€æµ‹å…ƒç´ å¯è§æ€§'</span><span class="token punctuation">,</span> isIntersecting<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// éœ€æ±‚ï¼šå¦‚æœç›®æ ‡å…ƒç´ è¿›å…¥å¯è§†åŒºï¼Œå°±å‘é€è¯·æ±‚ï¼Œå¹¶åœæ­¢æ£€æµ‹</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isIntersecting<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// å½“ç›®æ ‡å…ƒç´ è¿›å…¥å¯è§†åŒºåŸŸæ—¶ï¼Œæ‰å‘é€è¯·æ±‚</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'è¿›å…¥å¯è§†åŒºï¼Œéœ€è¦å‘é€è¯·æ±‚'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è¯·æ±‚å·²å‘é€ï¼Œä¸»åŠ¨åœæ­¢æ£€æŸ¥</span>
    <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token string">"height: 2000px"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> ğŸ¯ç›®æ ‡å…ƒç´ éœ€æ·»åŠ æ¨¡æ¿ ref  <span class="token operator">--</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token string">"target"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>ğŸ¯æˆ‘æ˜¯ç›®æ ‡å…ƒç´ ğŸ¯<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token string">"height: 2000px"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

</code></pre> 
<h4><a id="_78"></a>ç»„ä»¶æ•°æ®æ‡’åŠ è½½é€»è¾‘å¤ç”¨</h4> 
<p><code>æœ¬èŠ‚ç›®æ ‡:</code> æŠ½ç¦»ç»„ä»¶æ•°æ®æ‡’åŠ è½½å¯å¤ç”¨çš„é€»è¾‘</p> 
<h5><a id="_82"></a>ç°å­˜é—®é¢˜</h5> 
<blockquote> 
 <p>é¦–é¡µä¸­ï¼Œå¾ˆå¤šåœ°æ–¹éƒ½åº”è¯¥ä½¿ç”¨ç»„ä»¶æ•°æ®æ‡’åŠ è½½è¿™ä¸ªåŠŸèƒ½ï¼Œä¸ç®¡æ˜¯å“ªä¸ªæ¨¡å—ä½¿ç”¨ï¼Œä¸‹é¢ä»£ç éƒ½ä¼šé‡å¤ä¹¦å†™ã€‚</p> 
</blockquote> 
<p>äº‹å®ä¸Šï¼Œå”¯ä¸€å¯èƒ½ä¼šéšç€ä¸šåŠ¡ä½¿ç”¨å‘ç”Ÿå˜åŒ–çš„æ˜¯ ajaxæ¥å£çš„è°ƒç”¨ï¼Œå…¶ä½™çš„éƒ¨åˆ†æˆ‘ä»¬è¿›è¡Œé‡å¤ä½¿ç”¨ï¼ŒæŠ½ç¦»ä¸ºå¯å¤ç”¨é€»è¾‘</p> 
<p><img src="https://images2.imgbox.com/54/1c/rUNTrf2O_o.png" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p> 
<h5><a id="_91"></a>æŠ½ç¦»é€šç”¨é€»è¾‘</h5> 
<p>1ï¼‰æŠ½ç¦»é€»è¾‘</p> 
<p><code>src/hooks/index.ts</code></p> 
<ul><li>hooks.ts å°è£…å¸¸ç”¨çš„ ç»„åˆå¼ API å‡½æ•°</li></ul> 
<pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> useIntersectionObserver <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@vueuse/core"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * è¯·æ±‚æŒ‰éœ€åŠ è½½
 * @param apiFn å‘é€è¯·æ±‚å‡½æ•°
 * @returns  ğŸš¨ target ç”¨äºæ¨¡æ¿ç»‘å®š
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useObserver</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function-variable function">apiFn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// å‡†å¤‡ä¸ª ref ç”¨äºç»‘å®šæ¨¡æ¿ä¸­çš„æŸä¸ªç›®æ ‡å…ƒç´ (DOMèŠ‚ç‚¹æˆ–ç»„ä»¶)</span>
  <span class="token keyword">const</span> target <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> stop <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useIntersectionObserver</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> isIntersecting <span class="token punctuation">}</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æ˜¯å¦è¿›å…¥å¯è§†åŒºåŸŸ"</span><span class="token punctuation">,</span> isIntersecting<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isIntersecting<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// å½“ç›®æ ‡å…ƒç´ è¿›å…¥å¯è§†åŒºåŸŸæ—¶ï¼Œæ‰å‘é€è¯·æ±‚</span>
      <span class="token function">apiFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// è¯·æ±‚å·²å‘é€ï¼Œä¸»åŠ¨åœæ­¢æ£€æŸ¥</span>
      <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ğŸš¨è¿”å› ref ç”¨äºæ¨¡æ¿ç»‘å®šï¼Œå»ºè®®è¿”å›å¯¹è±¡æ ¼å¼æ”¯æŒè§£æ„è·å–</span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> target <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> 
<p>2ï¼‰ä¸šåŠ¡æ”¹å†™</p> 
<pre><code class="prism language-ts"><span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> RouterLink <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue-router"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> useStore <span class="token keyword">from</span> <span class="token string">"@/store"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> HomePanel <span class="token keyword">from</span> <span class="token string">"./home-panel.vue"</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> useObserver <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@/hooks"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> home <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> target <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useObserver</span><span class="token punctuation">(</span>home<span class="token punctuation">.</span>getHotGoodsList<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4293b047ebb20fec21066e6fa79c0fe4/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">è§£å†³vue3&#43;tsï¼Œå†…åµŒvue2ä»£ç ï¼Œæ— æ³•ä½¿ç”¨$refsçš„é—®é¢˜</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0c4546e7238fcbb08c11a35b86707a22/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">Vueåˆ†é¡µç›‘å¬</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 èœé¸Ÿç¨‹åºå‘˜åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>