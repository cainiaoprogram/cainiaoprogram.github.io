<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>正确使用Block避免Cycle Retain和Crash - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="正确使用Block避免Cycle Retain和Crash" />
<meta property="og:description" content="Block简介 Block作为C语言的扩展，并不是高新技术，和其他语言的闭包或lambda表达式是一回事。需要注意的是由于Objective-C在iOS中不支持GC机制，使用Block必须自己管理内存，而内存管理正是使用Block坑最多的地方，错误的内存管理 要么导致return cycle内存泄漏要么内存被提前释放导致crash。 Block的使用很像函数指针，不过与函数最大的不同是：Block可以访问函数以外、词法作用域以内的外部变量的值。换句话说，Block不仅 实现函数的功能，还能携带函数的执行环境。
可以这样理解，Block其实包含两个部分内容
Block执行的代码，这是在编译的时候已经生成好的； 一个包含Block执行时需要的所有外部变量值的数据结构。 Block将使用到的、作用域附近到的变量的值建立一份快照拷贝到栈上。 Block与函数另一个不同是，Block类似ObjC的对象，可以使用自动释放池管理内存（但Block并不完全等同于ObjC对象，后面将详细说明）。
Block基本语法 1 2 3 4 5 6 7 8 9 10 11 // 声明一个Block变量 long (^sum) (int, int) = nil; // sum是个Block变量，该Block类型有两个int型参数，返回类型是long。 // 定义Block并赋给变量sum sum = ^ long (int a, int b) { return a &#43; b; }; // 调用Block： long s = sum(1, 2); 定义一个实例函数，该函数返回Block：
1 2 3 4 5 6 7 8 9 - (long (^)(int, int) sumBlock { int base = 100; return [[ ^ long (int a, int b) { return base &#43; a &#43; b; } copy] autorelease]; } // 调用Block [self sumBlock](1,2); 是不是感觉很怪？为了看的舒服，我们把Block类型typedef一下" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4bb7b1b3ccf5518731ad24ffc5fe6ecf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-06-04T18:37:13+08:00" />
<meta property="article:modified_time" content="2013-06-04T18:37:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">正确使用Block避免Cycle Retain和Crash</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4 style="margin:0px 0px 1em; padding:0px; border:0px; font-family:'PT Serif',Georgia,'Helvetica Neue',Arial,sans-serif; line-height:27.59375px; font-size:1.3em; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> Block简介</h4> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> Block作为C语言的扩展，并不是高新技术，和其他语言的闭包或lambda表达式是一回事。需要注意的是由于Objective-C在iOS中不支持GC机制，使用Block必须自己管理内存，而内存管理正是使用Block坑最多的地方，错误的内存管理 要么导致return cycle内存泄漏要么内存被提前释放导致crash。 Block的使用很像函数指针，不过与函数最大的不同是：Block可以访问函数以外、词法作用域以内的外部变量的值。换句话说，Block不仅 实现函数的功能，还能携带函数的执行环境。</p> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 可以这样理解，Block其实包含两个部分内容</p> 
<ol style="margin:0px 0px 1.5em; padding:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; list-style-position:initial; color:rgb(34,34,34); background-color:rgb(248,248,248)"><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> Block执行的代码，这是在编译的时候已经生成好的；</li><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> 一个包含<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">Block执行时需要的所有外部变量值</code>的数据结构。 Block将使用到的、作用域附近到的<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">变量的值</code>建立一份快照拷贝到栈上。</li></ol> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> Block与函数另一个不同是，Block类似ObjC的对象，可以使用自动释放池管理内存（但Block并不完全等同于ObjC对象，后面将详细说明）。</p> 
<h4 style="margin:0px 0px 1em; padding:0px; border:0px; font-family:'PT Serif',Georgia,'Helvetica Neue',Arial,sans-serif; line-height:27.59375px; font-size:1.3em; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> Block基本语法</h4> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">8</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">9</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">10</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">11</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:749px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// 声明一个Block变量</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="nb" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(133,153,0)!important">nil</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// sum是个Block变量，该Block类型有两个int型参数，返回类型是long。</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// 定义Block并赋给变量sum</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// 调用Block：</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">s</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">2</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 定义一个实例函数，该函数返回Block：</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">8</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">9</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">-</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="nf" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important; color:rgb(38,139,210)!important">sumBlock</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">100</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">}</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">copy</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">autorelease</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">}</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// 调用Block</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sumBlock</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">](</span><span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">2</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 是不是感觉很怪？为了看的舒服，我们把Block类型typedef一下</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">8</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">9</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">typedef</span> <span class="nf" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important; color:rgb(38,139,210)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">-</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="nf" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important; color:rgb(38,139,210)!important">sumBlock</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">100</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">}</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">copy</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">autorelease</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">}</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<h4 style="margin:0px 0px 1em; padding:0px; border:0px; font-family:'PT Serif',Georgia,'Helvetica Neue',Arial,sans-serif; line-height:27.59375px; font-size:1.3em; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> Block在内存中的位置</h4> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 根据Block在内存中的位置分为三种类型NSGlobalBlock，NSStackBlock, NSMallocBlock。</p> 
<ul style="margin:0px 0px 1.5em; padding:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; list-style-position:initial; color:rgb(34,34,34); background-color:rgb(248,248,248)"><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> NSGlobalBlock：类似函数，位于text段；</li><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> NSStackBlock：位于栈内存，函数返回后Block将无效；</li><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> NSMallocBlock：位于堆内存。</li></ul> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">8</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">9</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">10</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">11</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">12</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">13</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">14</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:749px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk1</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"blk1 = %@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk1</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span><span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// blk1 = &lt;__NSGlobalBlock__: 0x47d0&gt;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">100</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk2</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"blk2 = %@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk2</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span> <span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// blk2 = &lt;__NSStackBlock__: 0xbfffddf8&gt;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk3</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk2</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">copy</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">autorelease</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"blk3 = %@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk3</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span> <span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// blk3 = &lt;__NSMallocBlock__: 0x902fda0&gt;</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 为什么blk1类型是NSGlobalBlock，而blk2类型是NSStackBlock？blk1和blk2的区别在于，blk1没有使用Block以外的任何外部变量，Block不需要建立局部变量值的快照，这使blk1与函数没有任何区别，从blk1所在内存地址0x47d0猜测编译器把blk1放到了text代码段。blk2与blk1唯一不同是的使用了局部变量base，在定义（注意是定义，不是运行）blk2时，局部变量base当前值被copy到栈上，作为<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">常量</code>供Block使用。执行下面代码，结果是203，而不是204。</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">100</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">100</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">++</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">printf</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"%ld"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">2</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">));</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<blockquote style="margin:0px 0px 1.5em; padding:0px 0px 0px 1.5em; border-width:0px 0px 0px 4px; border-left-style:solid; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; font-style:italic; line-height:1.5em; font-size:1.2em; vertical-align:baseline; quotes:none; position:relative; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 
 <p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:22px; vertical-align:baseline"> 在Block内变量base是只读的，如果想在Block内改变base的值，在定义base时要用 <code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__block</code>修饰：<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__block int base = 100;</code>。</p> 
</blockquote> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">8</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">9</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__block</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">100</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">100</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">10</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">++</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">printf</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"%ld</span><span class="se" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(220,50,47)!important">\n</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">2</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">));</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">printf</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"%d</span><span class="se" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(220,50,47)!important">\n</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<blockquote style="margin:0px 0px 1.5em; padding:0px 0px 0px 1.5em; border-width:0px 0px 0px 4px; border-left-style:solid; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; font-style:italic; line-height:1.5em; font-size:1.2em; vertical-align:baseline; quotes:none; position:relative; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 
 <p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:22px; vertical-align:baseline"> 输出将是214,211。Block中使用<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__block</code>修饰的变量时，将取变量此刻运行时的值，而不是定义时的快照。这个例子中，执行<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">sum(1,2)</code>时，base将取<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">base++</code>之后的值，也就是201，再执行Block<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">base+=10; base+a+b</code>，运行结果是214。执行完Block时，base已经变成211了。</p> 
</blockquote> 
<h4 style="margin:0px 0px 1em; padding:0px; border:0px; font-family:'PT Serif',Georgia,'Helvetica Neue',Arial,sans-serif; line-height:27.59375px; font-size:1.3em; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> Block的copy、retain、release操作</h4> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 不同于NSObjec的copy、retain、release操作：</p> 
<ul style="margin:0px 0px 1.5em; padding:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; list-style-position:initial; color:rgb(34,34,34); background-color:rgb(248,248,248)"><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> Block_copy与copy等效，Block_release与release等效；</li><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> 对Block不管是retain、copy、release都不会改变引用计数retainCount，retainCount始终是1；</li><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> NSGlobalBlock：retain、copy、release操作都无效；</li><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> NSStackBlock：retain、release操作无效，必须注意的是，NSStackBlock在函数返回后，Block内存将被回收。即使retain也没用。容易犯的错误是[<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">[mutableAarry addObject:stackBlock]</code>，在函数出栈后，从mutableAarry中取到的stackBlock已经被回收，变成了野指针。正确的做法是先将stackBlock copy到堆上，然后加入数组：<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">[mutableAarry addObject:[[stackBlock copy] autorelease]]</code>。支持copy，copy之后生成新的NSMallocBlock类型对象。</li><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> NSMallocBlock支持retain、release，虽然retainCount始终是1，但内存管理器中仍然会增加、减少计数。copy之后不会生成新的对象，只是增加了一次引用，类似retain；</li><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> 尽量不要对Block使用retain操作。</li></ul> 
<h4 style="margin:0px 0px 1em; padding:0px; border:0px; font-family:'PT Serif',Georgia,'Helvetica Neue',Arial,sans-serif; line-height:27.59375px; font-size:1.3em; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> Block对不同类型的变量的存取</h4> 
<h6 style="margin:0px 0px 1em; padding:0px; border:0px; font-family:'PT Serif',Georgia,'Helvetica Neue',Arial,sans-serif; line-height:27.59375px; font-size:0.9em; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 基本类型</h6> 
<ul style="margin:0px 0px 1.5em; padding:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; list-style-position:initial; color:rgb(34,34,34); background-color:rgb(248,248,248)"><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> 局部自动变量，在Block中只读。Block定义时copy变量的值，在Block中作为常量使用，所以即使变量的值在Block外改变，也不影响他在Block中的值。</li></ul> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">100</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// base++; 编译错误，只读</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">0</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">printf</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"%ld</span><span class="se" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(220,50,47)!important">\n</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">2</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">));</span> <span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// 这里输出是103，而不是3</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<ul style="margin:0px 0px 1.5em; padding:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; list-style-position:initial; color:rgb(34,34,34); background-color:rgb(248,248,248)"><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> static变量、全局变量。如果把上个例子的base改成全局的、或static。Block就可以对他进行读写了。因为全局变量或静态变量在内存中的地址是固定的，Block在读取该变量值的时候是直接从其所在内存读出，获取到的是最新值，而不是在定义时copy的常量。</li></ul> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">8</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">9</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">static</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">100</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">++</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">0</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">printf</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"%d</span><span class="se" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(220,50,47)!important">\n</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">printf</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"%ld</span><span class="se" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(220,50,47)!important">\n</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">2</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">));</span> <span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// 这里输出是3，而不是103</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">printf</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"%d</span><span class="se" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(220,50,47)!important">\n</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 输出结果是<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">0 4 1</code>，表明Block外部对base的更新会影响Block中的base的取值，同样Block对base的更新也会影响Block外部的base值。</p> 
<ul style="margin:0px 0px 1.5em; padding:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; list-style-position:initial; color:rgb(34,34,34); background-color:rgb(248,248,248)"><li style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> Block变量，被<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__block</code>修饰的变量称作Block变量。 基本类型的Block变量等效于全局变量、或静态变量。</li></ul> 
<h6 style="margin:0px 0px 1em; padding:0px; border:0px; font-family:'PT Serif',Georgia,'Helvetica Neue',Arial,sans-serif; line-height:27.59375px; font-size:0.9em; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> Block被另一个Block使用时，另一个Block被copy到堆上时，被使用的Block也会被copy。但作为参数的Block是不会发生copy的。</h6> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">8</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">9</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">10</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">11</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">12</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">13</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">14</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">15</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">16</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">17</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">18</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">19</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">20</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">21</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:749px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">void</span> <span class="nf" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important; color:rgb(38,139,210)!important">foo</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">()</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">100</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">long</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">int</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span>  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">base</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">a</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">b</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span> <span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// &lt;__NSStackBlock__: 0xbfffdb40&gt;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">bar</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">}</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">void</span> <span class="nf" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important; color:rgb(38,139,210)!important">bar</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum_blk</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum_blk</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span> <span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// 与上面一样，说明作为参数传递时，并不会发生copy</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">void</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">BlkSum</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>     <span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// 无论blk在堆上还是栈上，作为参数的Block不会发生copy。</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum_blk</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span> <span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// 当blk copy到堆上时，sum_blk也被copy了一分到堆上上。</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum_blk</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span> <span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// blk在栈上</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">copy</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">autorelease</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blk</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">sum_blk</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span> <span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// blk在堆上</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">}</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<h6 style="margin:0px 0px 1em; padding:0px; border:0px; font-family:'PT Serif',Georgia,'Helvetica Neue',Arial,sans-serif; line-height:27.59375px; font-size:0.9em; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> ObjC对象，不同于基本类型，Block会引起对象的引用计数变化。</h6> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 先看下面代码</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">8</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">9</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">10</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">11</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">12</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">13</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">14</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">15</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">16</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">17</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">18</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">19</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">20</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">21</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">22</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">23</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">24</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">25</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">26</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">27</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">28</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">29</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">30</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">31</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">32</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">33</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">34</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">35</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">36</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">37</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">38</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">39</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">40</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">41</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:749px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">@interface</span> <span class="nc" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(211,54,130)!important">MyClass</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">()</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSObject</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">_instanceObj</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">}</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">@end</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">@implementation</span> <span class="nc" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(211,54,130)!important">MyClass</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSObject</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__globalObj</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="nb" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(133,153,0)!important">nil</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">-</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">id</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="nf" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important; color:rgb(38,139,210)!important">init</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">if</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">super</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">init</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">])</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">        <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">_instanceObj</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSObject</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">alloc</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">init</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">}</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">return</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">}</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">-</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">void</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="nf" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important; color:rgb(38,139,210)!important">test</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">static</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSObject</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__staticObj</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="nb" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(133,153,0)!important">nil</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__globalObj</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSObject</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">alloc</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">init</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__staticObj</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSObject</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">alloc</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">init</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSObject</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">localObj</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSObject</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">alloc</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">init</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__block</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSObject</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blockObj</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSObject</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">alloc</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">init</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">typedef</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">void</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">MyBlock</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">void</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">MyBlock</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">aBlock</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">        <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__globalObj</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">        <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__staticObj</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">        <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">_instanceObj</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">        <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">localObj</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">        <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blockObj</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">aBlock</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">aBlock</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">copy</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">autorelease</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">aBlock</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">();</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%d"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__globalObj</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retainCount</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%d"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__staticObj</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retainCount</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%d"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">_instanceObj</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retainCount</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%d"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">localObj</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retainCount</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%d"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">blockObj</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retainCount</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">}</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 执行结果为<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">1 1 1 2 1</code>。</p> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> <code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__globalObj</code>和<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__staticObj</code>在内存中的位置是确定的，所以Block copy时不会retain对象。</p> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> <code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">_instanceObj</code>在Block copy时也没有直接retain <code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">_instanceObj</code>对象本身，但会retain self。所以在Block中可以直接读写<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">_instanceObj</code>变量。</p> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> <code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">localObj</code>在Block copy时，系统自动retain对象，增加其引用计数。</p> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> <code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">blockObj</code>在Block copy时也不会retain。</p> 
<h6 style="margin:0px 0px 1em; padding:0px; border:0px; font-family:'PT Serif',Georgia,'Helvetica Neue',Arial,sans-serif; line-height:27.59375px; font-size:0.9em; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 非ObjC对象，如GCD队列dispatch_queue_t。Block copy时并不会自动增加他的引用计数，这点要非常小心。</h6> 
<h4 style="margin:0px 0px 1em; padding:0px; border:0px; font-family:'PT Serif',Georgia,'Helvetica Neue',Arial,sans-serif; line-height:27.59375px; font-size:1.3em; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> Block中使用的ObjC对象的行为</h4> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">@property</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">nonatomic</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">copy</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">void</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">myBlock</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">void</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">MyClass</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">obj</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">MyClass</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">alloc</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">init</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">autorelease</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">.</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">myBlock</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">obj</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">doSomething</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 对象obj在Block被copy到堆上的时候自动retain了一次。因为Block不知道obj什么时候被释放，为了不在Block使用obj前被释放，Block retain了obj一次，在Block被释放的时候，obj被release一次。</p> 
<h4 style="margin:0px 0px 1em; padding:0px; border:0px; font-family:'PT Serif',Georgia,'Helvetica Neue',Arial,sans-serif; line-height:27.59375px; font-size:1.3em; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> retain cycle</h4> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> retain cycle问题的根源在于Block和obj可能会互相强引用，互相retain对方，这样就导致了retain cycle，最后这个Block和obj就变成了孤岛，谁也释放不了谁。比如：</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">ASIHTTPRequest</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">request</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">ASIHTTPRequest</span> <span class="nl" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(133,153,0)!important">requestWithURL:</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">url</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">request</span> <span class="nl" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(133,153,0)!important">setCompletionBlock:</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSString</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">string</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">request</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">responseString</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">}];</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">       <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">       <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">request</span>   <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">Block</span>   <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">---&gt;</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">--------&gt;</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">       <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">2</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">&lt;--------</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">       <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">       <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 解决这个问题的办法是使用弱引用打断retain cycle：</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__block</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">ASIHTTPRequest</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">request</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">ASIHTTPRequest</span> <span class="nl" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(133,153,0)!important">requestWithURL:</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">url</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">request</span> <span class="nl" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(133,153,0)!important">setCompletionBlock:</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSString</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">string</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">request</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">responseString</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">}];</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">request</span>   <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">Block</span>   <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">----&gt;|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">--------&gt;</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">&lt;</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weak</span>    <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> <code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">request</code>被持有者释放后。request 的retainCount变成0,request被dealloc，request释放持有的Block，导致Block的retainCount变成0，也被销毁。这样这两个对象内存都被回收。</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">request</span>   <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">Block</span>   <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">--</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">X</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-&gt;|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">----</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">X</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">---&gt;</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">0</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">&lt;</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">0</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weak</span>    <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 与上面情况类似的陷阱：</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">.</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">myBlock</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">doSomething</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 这里self和myBlock循环引用，解决办法同上：</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__block</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">MyClass</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weakSelf</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">.</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">myBlock</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weakSelf</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">doSomething</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">@property</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">nonatomic</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSString</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">someVar</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">.</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">myBlock</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">_someVer</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 这里在Block中虽然没直接使用self，但使用了成员变量。在Block中使用成员变量，retain的不是这个变量，而会retain self。解决办法也和上面一样。</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">@property</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">nonatomic</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSString</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">someVar</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__block</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">MyClass</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weakSelf</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">.</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">myBlock</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">.</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">someVer</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 或者</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSString</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">str</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">_someVer</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">.</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">myBlock</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">str</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> retain cycle不只发生在两个对象之间，也可能发生在多个对象之间，这样问题更复杂，更难发现</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">ClassA</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">objA</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">ClassA</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">alloc</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">init</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">autorelease</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">objA</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">.</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">myBlock</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">doSomething</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">.</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">objA</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">objA</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">8</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">9</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span>    <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">objA</span>    <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">Block</span>   <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">--------&gt;</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">--------&gt;</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">       <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span>                                                <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">       <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>                                                <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">       <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+------------------------------------------------+</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 解决办法同样是用<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__block</code>打破循环引用</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">ClassA</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">objA</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">ClassA</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">alloc</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">init</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">autorelease</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">MyClass</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weakSelf</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">objA</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">.</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">myBlock</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weakSelf</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">doSomething</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">};</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">.</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">objA</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">objA</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<blockquote style="margin:0px 0px 1.5em; padding:0px 0px 0px 1.5em; border-width:0px 0px 0px 4px; border-left-style:solid; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; font-style:italic; line-height:1.5em; font-size:1.2em; vertical-align:baseline; quotes:none; position:relative; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 
 <p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:22px; vertical-align:baseline"> <span style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">注意</span>：MRC中<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__block</code>是不会引起retain；但在ARC中<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__block</code>则会引起retain。ARC中应该使用<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__weak</code>或<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__unsafe_unretained</code>弱引用。<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__weak</code>只能在iOS5以后使用。</p> 
</blockquote> 
<h4 style="margin:0px 0px 1em; padding:0px; border:0px; font-family:'PT Serif',Georgia,'Helvetica Neue',Arial,sans-serif; line-height:27.59375px; font-size:1.3em; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> Block使用对象被提前释放</h4> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 看下面例子，有这种情况，如果不只是<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">request</code>持有了Block，另一个对象也持有了Block。</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">request</span>   <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">Block</span>   <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">objA</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">----&gt;|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">--------&gt;</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|&lt;--------</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">&lt;</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">2</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weak</span>    <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 这时如果request 被持有者释放。</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">request</span>   <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">Block</span>   <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">objA</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">--</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">X</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-&gt;|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">--------&gt;</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|&lt;--------</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">0</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">&lt;</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">-</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">retain</span> <span class="mi" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">1</span>  <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>   <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weak</span>    <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">|</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">      <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>           <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">+-----------+</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 这时request已被完全释放，但Block仍被objA持有，没有释放，如果这时触发了Block，在Block中将访问已经销毁的request，这将导致程序crash。为了避免这种情况，开发者必须要注意对象和Block的生命周期。</p> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 另一个常见错误使用是，开发者担心retain cycle错误的使用<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__block</code>。比如</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:757px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__block</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">kkProducView</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weakSelf</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">dispatch_async</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">dispatch_get_main_queue</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(),</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weakSelf</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">.</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">xx</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">xx</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">});</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 将Block作为参数传给dispatch_async时，系统会将Block拷贝到堆上，如果Block中使用了实例变量，还将retain self，因为dispatch_async并不知道self会在什么时候被释放，为了确保系统调度执行Block中的任务时self没有被意外释放掉，dispatch_async必须自己retain一次self，任务完成后再release self。但这里使用<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__block</code>，使dispatch_async没有增加self的引用计数，这使得在系统在调度执行Block之前，self可能已被销毁，但系统并不知道这个情况，导致Block被调度执行时self已经被释放导致crash。</p> 
<div class="highlight" style="margin:0px; padding:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; background-color:rgb(0,43,54); overflow-y:hidden; overflow-x:auto; border:1px solid rgb(5,35,43)!important"> 
 <table style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:baseline; border-collapse:collapse; border-spacing:0px"><tbody style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><tr style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><td class="gutter" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle"> <pre class="line-numbers" style=""><span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">1</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">2</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">3</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">4</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">5</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">6</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">7</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">8</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">9</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">10</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">11</span>
<span class="line-number" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(88,110,117)!important">12</span>
</pre> </td><td class="code" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-style:inherit; font-variant:inherit; line-height:inherit; font-size:18px; vertical-align:middle; width:845px"> <pre style=""><code class="objc" style="margin:0px; padding:0.8em; border:0px; font-style:inherit; font-variant:inherit; line-height:1.45em; vertical-align:baseline; overflow-y:hidden; display:block; overflow-x:auto; background-color:rgb(0,0,0); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace!important"><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// MyClass.m</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="k" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(203,75,22)!important">-</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">void</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)</span> <span class="nf" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important; color:rgb(38,139,210)!important">test</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">{<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">__block</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">MyClass</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weakSelf</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">self</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">double</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">delayInSeconds</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="mf" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">10.0</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">;</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">dispatch_time_t</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">popTime</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">dispatch_time</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">DISPATCH_TIME_NOW</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">int64_t</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">)(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">delayInSeconds</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSEC_PER_SEC</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">));</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">  <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">dispatch_after</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">popTime</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">dispatch_get_main_queue</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(),</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">^</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="kt" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">void</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">){<!-- --></span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">    <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">NSLog</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">(</span><span class="s" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(42,161,152)!important">@"%@"</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">,</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">weakSelf</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">);</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">});</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="c1" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-style:italic!important; color:rgb(88,110,117)!important">// other.m</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">MyClass</span><span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">*</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">obj</span> <span class="o" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; font-weight:bold!important">=</span> <span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[[[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">MyClass</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">alloc</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">init</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">]</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">autorelease</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span><span class="line" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline"><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">[</span><span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">obj</span> <span class="n" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline; color:rgb(38,139,210)!important">test</span><span class="p" style="margin:0px; padding:0px; border:0px; font-family:inherit; font-variant:inherit; line-height:inherit; vertical-align:baseline">];</span>
</span></code></pre> </td></tr></tbody></table> 
</div> 
<p style="margin-top:0px; margin-bottom:1.5em; padding-top:0px; padding-bottom:0px; border:0px; font-family:'PT Serif',Georgia,Times,'Times New Roman',serif; line-height:27.59375px; font-size:18px; vertical-align:baseline; color:rgb(34,34,34); background-color:rgb(248,248,248)"> 这里用dispatch_after模拟了一个异步任务，10秒后执行Block。但执行Block的时候<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">MyClass* obj</code>已经被释放了，导致crash。解决办法是不要使用<code style="margin:-1px 0px; padding:0px 0.3em; border:1px solid rgb(221,221,221); font-family:Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace; font-style:inherit; font-variant:inherit; line-height:1.5em; font-size:0.8em; vertical-align:baseline; display:inline-block; background-color:rgb(255,255,255); color:rgb(85,85,85)">__block</code>。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/26cf2c3b715adfb7881a9284a8d9e12f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">汇编反汇编</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/397f8afb069c1974fc8443abe0438cdb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">sql distinct 关键字失效的办法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>