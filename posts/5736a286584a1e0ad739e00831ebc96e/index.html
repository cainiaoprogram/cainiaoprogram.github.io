<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>分布式（9） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="分布式（9）" />
<meta property="og:description" content="目录
41.常见的JOB实现方案？
42.Cookie和Session有什么区别？
43.谈谈会话技术的发展？
44.分布式会话有哪些解决方案？
45.什么是Session Stick？
41.常见的JOB实现方案？ 基于上面Java任务演化出分布式Job方案：
quartz
JDBCJobStore 支持集群所有触发和Job都存储在数据库中无论服务器停止和重启都可以恢复任务同时支持事务处理
elastic job
elastic job是由当当网基于quartz二次开发之后的分布式调度解决方案，由两个相对独立的子项目Elastic Job Lite和Elastic JOB Cloud 组成。
Elastic Job Lite 定位为轻量级无中心化解决方案，使用jar包的形式提供分布式任务的协调服务。
Elastic Job Cloud使用Mesos&#43;Docker（TBD)的解决方案，额外提供资源治理，应用分发以及进程隔离等服务
两点：
1.基于quartz定时任务框架为基础的，因此具备quartz的大部分功能
2.使用zookeeper做协调，调度中心，更加轻量级
3.支持任务的分片
4.支持弹性扩容，可以水平扩展，当任务再次运行时，会检查当前的服务器数量，重新分片，分片结束之后才会继续执行任务。
5.失效转移，容错处理，当一台调度服务器宕机或者跟zookeeper断开连接后，会立即停止作业，然后再去寻找其他空闲的调度服务器，来运行剩余的任务。
6.提供运维界面，可以管理作业和注册中心。
xxl job
一个轻量级分布式任务调度框架，主要分为调度中心和执行器两部分，调度中心在启动初始化的时候，会默认生成执行器的RPC代理
对象（http协议调用），执行器项目启动之后，调度中心在触发定时器之后通过jobHandle来调用执行器项目里面的代码，核心功能和elastic job差不多
42.Cookie和Session有什么区别？ Cookie和Session的方案虽然分别属于客户端和服务端，但是服务端的session的实现对客户端的cookie有依赖关系的，服务端执行session机制时候会生成session的id值，这个id值会发送给客户端，客户端每次请求都会把这个Id值放到http请求的头部发送给服务器，而这个id值在客户端会保存下来，保存的容器就是cookie,因此当我们完全禁掉浏览器的cookie的时候，服务端的session也会不能正常使用。
43.谈谈会话技术的发展？ 单机 Session&#43;Cookie
多机器
在负载均衡侧 Session粘滞
Session数据同步
多机器，集群，session集中管理，比如redis;目前方案上用的最多的是SpringSession，早前也有用tomcata集成方式的。
无状态token,比如JWT
44.分布式会话有哪些解决方案？ Session Stick
Session Replication Session数据集中存储
Cookie Based
JWT
45.什么是Session Stick？ 方案即将客户端的每次请求都转发至同一台服务器，这就需要负载均衡器能够根据每次请求的会话标识（Session ID）进行请求转发，如下图所示。
这种方案实现比较简单，对于Web服务器来说和单机的情况一样。但是可能会带来如下问题：
如果有一台服务器宕机或者重启，那么这台机器上的会话数据会全部丢失。
会话标识是应用层信息，那么负载均衡要将同一个会话的请求都保存同一个Web服务器上的话没救需要进行应用层（第7层）的解析，这个开销比第4层大。
负载均衡器将编程一个有状态的节点，要将会话保存到具体的web服务器的映射。和无状态节点相比，内存消耗更大，容灾方面也会更麻烦。
PS：为什么这种方案到目前还有很多项目使用呢？因为不需要在项目代码侧改动，而是只需要在负载均衡侧改动。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/5736a286584a1e0ad739e00831ebc96e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-04T12:13:10+08:00" />
<meta property="article:modified_time" content="2024-01-04T12:13:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">分布式（9）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:200px;"></p> 
<p id="41.%E5%B8%B8%E8%A7%81%E7%9A%84JOB%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88%EF%BC%9F-toc" style="margin-left:200px;"><a href="#41.%E5%B8%B8%E8%A7%81%E7%9A%84JOB%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88%EF%BC%9F" rel="nofollow">41.常见的JOB实现方案？</a></p> 
<p id="42.Cookie%E5%92%8CSession%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F-toc" style="margin-left:200px;"><a href="#42.Cookie%E5%92%8CSession%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F" rel="nofollow">42.Cookie和Session有什么区别？</a></p> 
<p id="43.%E8%B0%88%E8%B0%88%E4%BC%9A%E8%AF%9D%E6%8A%80%E6%9C%AF%E7%9A%84%E5%8F%91%E5%B1%95%EF%BC%9F-toc" style="margin-left:200px;"><a href="#43.%E8%B0%88%E8%B0%88%E4%BC%9A%E8%AF%9D%E6%8A%80%E6%9C%AF%E7%9A%84%E5%8F%91%E5%B1%95%EF%BC%9F" rel="nofollow">43.谈谈会话技术的发展？</a></p> 
<p id="44.%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D%E6%9C%89%E5%93%AA%E4%BA%9B%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%9F-toc" style="margin-left:200px;"><a href="#44.%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D%E6%9C%89%E5%93%AA%E4%BA%9B%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%9F" rel="nofollow">44.分布式会话有哪些解决方案？</a></p> 
<p id="45.%E4%BB%80%E4%B9%88%E6%98%AFSession%C2%A0%20Stick%EF%BC%9F-toc" style="margin-left:200px;"><a href="#45.%E4%BB%80%E4%B9%88%E6%98%AFSession%C2%A0%20Stick%EF%BC%9F" rel="nofollow">45.什么是Session  Stick？</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h6 id="41.%E5%B8%B8%E8%A7%81%E7%9A%84JOB%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88%EF%BC%9F">41.常见的JOB实现方案？</h6> 
<p>基于上面Java任务演化出分布式Job方案：</p> 
<p>quartz</p> 
<p>JDBCJobStore 支持集群所有触发和Job都存储在数据库中无论服务器停止和重启都可以恢复任务同时支持事务处理</p> 
<p>elastic   job</p> 
<p>elastic  job是由当当网基于quartz二次开发之后的分布式调度解决方案，由两个相对独立的子项目Elastic  Job  Lite和Elastic  JOB  Cloud 组成。</p> 
<p>Elastic  Job  Lite 定位为轻量级无中心化解决方案，使用jar包的形式提供分布式任务的协调服务。</p> 
<p>Elastic  Job Cloud使用Mesos+Docker（TBD)的解决方案，额外提供资源治理，应用分发以及进程隔离等服务</p> 
<p>两点：</p> 
<p>1.基于quartz定时任务框架为基础的，因此具备quartz的大部分功能</p> 
<p>2.使用zookeeper做协调，调度中心，更加轻量级</p> 
<p>3.支持任务的分片</p> 
<p>4.支持弹性扩容，可以水平扩展，当任务再次运行时，会检查当前的服务器数量，重新分片，分片结束之后才会继续执行任务。</p> 
<p>5.失效转移，容错处理，当一台调度服务器宕机或者跟zookeeper断开连接后，会立即停止作业，然后再去寻找其他空闲的调度服务器，来运行剩余的任务。</p> 
<p>6.提供运维界面，可以管理作业和注册中心。</p> 
<p>xxl  job</p> 
<p>一个轻量级分布式任务调度框架，主要分为调度中心和执行器两部分，调度中心在启动初始化的时候，会默认生成执行器的RPC代理</p> 
<p>对象（http协议调用），执行器项目启动之后，调度中心在触发定时器之后通过jobHandle来调用执行器项目里面的代码，核心功能和elastic  job差不多</p> 
<p></p> 
<p><img alt="" height="364" src="https://images2.imgbox.com/7d/59/OSHvvtMb_o.png" width="762"></p> 
<h6 id="42.Cookie%E5%92%8CSession%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F">42.Cookie和Session有什么区别？</h6> 
<p>Cookie和Session的方案虽然分别属于客户端和服务端，但是服务端的session的实现对客户端的cookie有依赖关系的，服务端执行session机制时候会生成session的id值，这个id值会发送给客户端，客户端每次请求都会把这个Id值放到http请求的头部发送给服务器，而这个id值在客户端会保存下来，保存的容器就是cookie,因此当我们完全禁掉浏览器的cookie的时候，服务端的session也会不能正常使用。</p> 
<h6 id="43.%E8%B0%88%E8%B0%88%E4%BC%9A%E8%AF%9D%E6%8A%80%E6%9C%AF%E7%9A%84%E5%8F%91%E5%B1%95%EF%BC%9F">43.谈谈会话技术的发展？</h6> 
<p>单机    Session+Cookie</p> 
<p>多机器</p> 
<p>在负载均衡侧   Session粘滞</p> 
<p>Session数据同步</p> 
<p>多机器，集群，session集中管理，比如redis;目前方案上用的最多的是SpringSession，早前也有用tomcata集成方式的。</p> 
<p>无状态token,比如JWT</p> 
<h6 id="44.%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D%E6%9C%89%E5%93%AA%E4%BA%9B%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%9F">44.分布式会话有哪些解决方案？</h6> 
<p>Session  Stick</p> 
<p>Session  Replication </p> 
<p>Session数据集中存储</p> 
<p>Cookie  Based</p> 
<p>JWT</p> 
<h6 id="45.%E4%BB%80%E4%B9%88%E6%98%AFSession%C2%A0%20Stick%EF%BC%9F">45.什么是Session  Stick？</h6> 
<p>方案即将客户端的每次请求都转发至同一台服务器，这就需要负载均衡器能够根据每次请求的会话标识（Session   ID）进行请求转发，如下图所示。</p> 
<p>这种方案实现比较简单，对于Web服务器来说和单机的情况一样。但是可能会带来如下问题：</p> 
<p>如果有一台服务器宕机或者重启，那么这台机器上的会话数据会全部丢失。</p> 
<p>会话标识是应用层信息，那么负载均衡要将同一个会话的请求都保存同一个Web服务器上的话没救需要进行应用层（第7层）的解析，这个开销比第4层大。</p> 
<p>负载均衡器将编程一个有状态的节点，要将会话保存到具体的web服务器的映射。和无状态节点相比，内存消耗更大，容灾方面也会更麻烦。</p> 
<p>PS：为什么这种方案到目前还有很多项目使用呢？因为不需要在项目代码侧改动，而是只需要在负载均衡侧改动。</p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1b37677833d0035ffdc13bd0a7e25b86/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用EasyExcel导出数据</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b13480814bf5a52a43a7eaa7a7fd576c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">中国AIGC广告营销产业全景报告：五大变革四大影响，生成式AI让只为「一个人」打造广告成为可能...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>