<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java操作excel - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java操作excel" />
<meta property="og:description" content="jxl是一个韩国人写的java操作excel的工具, 在开源世界中，有两套比较有影响的API可供使用，一个是POI，一个是jExcelAPI。其中功能相对POI比较弱一点。但jExcelAPI对中文支持非常好，API是纯Java的， 并不依赖Windows系统，即使运行在Linux下，它同样能够正确的处理Excel文件。 另外需要说明的是，这套API对图形和图表的支持很有限，而且仅仅识别PNG格式。
使用如下：
搭建环境
将下载后的文件解包，得到jxl.jar，放入classpath，安装就完成了。
基本操作
一、创建文件
拟生成一个名为“test.xls”的Excel文件，其中第一个工作表被命名为
“第一页”，大致效果如下：
package test;
//生成Excel的类
import java.io.File;
import jxl.Workbook;
import jxl.write.Label;
import jxl.write.WritableSheet;
import jxl.write.WritableWorkbook;
public class CreateExcel {
public static void main(String args[]) {
try {
// 打开文件
WritableWorkbook book = Workbook.createWorkbook(new File(&#34;test.xls&#34;));
// 生成名为“第一页”的工作表，参数0表示这是第一页
WritableSheet sheet = book.createSheet(&#34;第一页&#34;, 0);
// 在Label对象的构造子中指名单元格位置是第一列第一行(0,0)
// 以及单元格内容为test
Label label = new Label(0, 0, &#34;test&#34;);
// 将定义好的单元格添加到工作表中
sheet.addCell(label);
/*
* 生成一个保存数字的单元格 必须使用Number的完整包路径，否则有语法歧义 单元格位置是第二列，第一行，值为789.123" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2b139fc50eaa88559f69aaab799cf15a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-17T20:45:30+08:00" />
<meta property="article:modified_time" content="2023-06-17T20:45:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java操作excel</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>jxl是一个韩国人写的java操作excel的工具, 在开源世界中，有两套比较有影响的API可供使用，一个是POI，一个是jExcelAPI。其中功能相对POI比较弱一点。但jExcelAPI对中文支持非常好，API是纯Java的， 并不依赖Windows系统，即使运行在Linux下，它同样能够正确的处理Excel文件。 另外需要说明的是，这套API对图形和图表的支持很有限，而且仅仅识别PNG格式。</p> 
<p>使用如下：</p> 
<p>搭建环境</p> 
<p> 将下载后的文件解包，得到jxl.jar，放入classpath，安装就完成了。</p> 
<p> 基本操作</p> 
<p> 一、创建文件</p> 
<p> 拟生成一个名为“test.xls”的Excel文件，其中第一个工作表被命名为<br>  “第一页”，大致效果如下：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/c3/4b/S6gdk5KS_o.png"></p> 
<p>package test;<br><br> //生成Excel的类<br> import java.io.File;<br><br> import jxl.Workbook;<br> import jxl.write.Label;<br> import jxl.write.WritableSheet;<br> import jxl.write.WritableWorkbook;<br><br> public class CreateExcel {<!-- --><br>     public static void main(String args[]) {<!-- --><br>         try {<!-- --><br>             // 打开文件<br>             WritableWorkbook book = Workbook.createWorkbook(new File("test.xls"));<br>             // 生成名为“第一页”的工作表，参数0表示这是第一页<br>             WritableSheet sheet = book.createSheet("第一页", 0);<br>             // 在Label对象的构造子中指名单元格位置是第一列第一行(0,0)<br>             // 以及单元格内容为test<br>             Label label = new Label(0, 0, "test");<br><br>             // 将定义好的单元格添加到工作表中<br>             sheet.addCell(label);<br><br>             /*<br>              * 生成一个保存数字的单元格 必须使用Number的完整包路径，否则有语法歧义 单元格位置是第二列，第一行，值为789.123<br>              */<br>             jxl.write.Number number = new jxl.write.Number(1, 0, 555.12541);<br>             sheet.addCell(number);<br><br>             // 写入数据并关闭文件<br>             book.write();<br>             book.close();<br><br>         } catch (Exception e) {<!-- --><br>             System.out.println(e);<br>         }<br>     }<br> }</p> 
<p></p> 
<p>   编译执行后，会产生一个Excel文件。</p> 
<p> 三、读取文件</p> 
<p> 以刚才我们创建的Excel文件为例，做一个简单的读取操作，程序代码如下：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/67/a8/u4RAAKY4_o.png"></p> 
<p>package test;<br><br> //读取Excel的类<br> import java.io.File;<br><br> import jxl.Cell;<br> import jxl.Sheet;<br> import jxl.Workbook;<br><br> public class ReadExcel {<!-- --><br>     public static void main(String args[]) {<!-- --><br>         try {<!-- --><br>             Workbook book = Workbook.getWorkbook(new File("test.xls"));<br>             // 获得第一个工作表对象<br>             Sheet sheet = book.getSheet(0);<br>             // 得到第一列第一行的单元格<br>             Cell cell1 = sheet.getCell(0, 0);<br>             String result = cell1.getContents();<br>             System.out.println(result);<br>             book.close();<br>         } catch (Exception e) {<!-- --><br>             System.out.println(e);<br>         }<br>     }<br> }</p> 
<p><br>   程序执行结果：test</p> 
<p> 四、修改文件<br>  利用jExcelAPI可以修改已有的Excel文件，修改Excel文件的时候，除了打开文件的方式不同之外，<br>  其他操作和创建Excel是一样的。下面的例子是在我们已经生成的Excel文件中添加一个工作表：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/55/c1/OZ3mcHAF_o.png"></p> 
<p>package test;<br><br> import java.io.File;<br><br> import jxl.Workbook;<br> import jxl.write.Label;<br> import jxl.write.WritableSheet;<br> import jxl.write.WritableWorkbook;<br><br> public class UpdateExcel {<!-- --><br>     public static void main(String args[]) {<!-- --><br>         try {<!-- --><br>             // Excel获得文件<br>             Workbook wb = Workbook.getWorkbook(new File("test.xls"));<br>             // 打开一个文件的副本，并且指定数据写回到原文件<br>             WritableWorkbook book = Workbook.createWorkbook(new File("test.xls"),<br>                     wb);<br>             // 添加一个工作表<br>             WritableSheet sheet = book.createSheet("第二页", 1);<br>             sheet.addCell(new Label(0, 0, "第二页的测试数据"));<br>             book.write();<br>             book.close();<br>         } catch (Exception e) {<!-- --><br>             System.out.println(e);<br>         }<br>     }<br> }</p> 
<p><br> 其他操作</p> 
<p> 一、 数据格式化</p> 
<p> 在Excel中不涉及复杂的数据类型，能够比较好的处理字串、数字和日期已经能够满足一般的应用。</p> 
<p> 1、 字串格式化</p> 
<p> 字符串的格式化涉及到的是字体、粗细、字号等元素，这些功能主要由WritableFont和<br>  WritableCellFormat类来负责。假设我们在生成一个含有字串的单元格时，使用如下语句，<br>  为方便叙述，我们为每一行命令加了编号：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/d9/8f/Rt0MjQZg_o.png"></p> 
<p>WritableFont font1=<br>  new WritableFont(WritableFont.TIMES,16,WritableFont.BOLD); ①<br><br>  WritableCellFormat format1=new WritableCellFormat(font1); ②<br><br>  Label label=new Label(0,0,”data 4 test”,format1) ③<br>  </p> 
<p>  其中①指定了字串格式：字体为TIMES，字号16，加粗显示。WritableFont有非常丰富的<br>  构造子，供不同情况下使用，jExcelAPI的java-doc中有详细列表，这里不再列出。</p> 
<p> ②处代码使用了WritableCellFormat类，这个类非常重要，通过它可以指定单元格的各种<br>  属性，后面的单元格格式化中会有更多描述。</p> 
<p> ③处使用了Label类的构造子，指定了字串被赋予那种格式。</p> 
<p> 在WritableCellFormat类中，还有一个很重要的方法是指定数据的对齐方式，比如针对我们<br>  上面的实例，可以指定：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/31/4b/EkirkiqY_o.png"></p> 
<p> //把水平对齐方式指定为居中<br>  format1.setAlignment(jxl.format.Alignment.CENTRE);<br><br>  //把垂直对齐方式指定为居中<br>  format1.setVerticalAlignment(jxl.format.VerticalAlignment.CENTRE);</p> 
<p>二、单元格操作</p> 
<p> Excel中很重要的一部分是对单元格的操作，比如行高、列宽、单元格合并等，所幸jExcelAPI<br>  提供了这些支持。这些操作相对比较简单，下面只介绍一下相关的API。</p> 
<p> 1、 合并单元格</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/68/7b/yDNtIJC6_o.png"></p> 
<p> WritableSheet.mergeCells(int m,int n,int p,int q); <br><br>  //作用是从(m,n)到(p,q)的单元格全部合并，比如：<br>  WritableSheet sheet=book.createSheet(“第一页”,0);<br><br>  //合并第一列第一行到第六列第一行的所有单元格<br>  sheet.mergeCells(0,0,5,0);</p> 
<p> 合并既可以是横向的，也可以是纵向的。合并后的单元格不能再次进行合并，否则会触发异常。</p> 
<p> 2、 行高和列宽</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/0a/84/P8TkjZ1q_o.png"></p> 
<p> WritableSheet.setRowView(int i,int height);<br><br>  //作用是指定第i+1行的高度，比如：<br><br>  //将第一行的高度设为200<br>  sheet.setRowView(0,200);<br><br>  WritableSheet.setColumnView(int i,int width);<br><br>  //作用是指定第i+1列的宽度，比如：<br><br>  //将第一列的宽度设为30<br>  sheet.setColumnView(0,30);</p> 
<p> jExcelAPI还有其他的一些功能，比如插入图片等，这里就不再一一介绍，读者可以自己探索。</p> 
<p>其中：如果读一个excel，需要知道它有多少行和多少列，如下操作：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/52/42/NxnJjgCI_o.png"></p> 
<p>Workbook book = Workbook.getWorkbook(new File("测试1.xls"));<br>         // 获得第一个工作表对象<br>         Sheet sheet = book.getSheet(0);<br>         // 得到第一列第一行的单元格<br>         int columnum = sheet.getColumns();// 得到列数<br>         int rownum = sheet.getRows();// 得到行数<br>         System.out.println(columnum);<br>         System.out.println(rownum);<br>         for (int i = 0; i &lt; rownum; i++)// 循环进行读写<br>         {<!-- --><br>             for (int j = 0; j &lt; columnum; j++) {<!-- --><br>                 Cell cell1 = sheet.getCell(j, i);<br>                 String result = cell1.getContents();<br>                 System.out.print(result);<br>                 System.out.print("\t");<br>             }<br>             System.out.println();<br>         }<br>         book.close();</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f7bcd812be7f22f17762cd313bc221b4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Centos添加路由</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d5bc4973d017c144de5a7ecf876536cc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数字图像处理期末考点整理（全）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>