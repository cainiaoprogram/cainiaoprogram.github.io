<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C&#43;&#43;设计模式——桥模式 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C&#43;&#43;设计模式——桥模式" />
<meta property="og:description" content="桥模式（Bridge） 动机（Motivation） 由于某些类型的固有实现逻辑，使得他们具有两个变化的维度，乃至多个维度的变化
如何应对这种“多维度的变化”？如何利用面向对象技术来使得类型可以轻松沿着两个乃至多个方向变化，而不引入额外复杂度？
模式定义 将抽象部分（业务功能）与实现部分（平台实现）分离，使他们都可以独立的变化。 ——《设计模式》GoF
结构（Struture） （1）Abstraction（抽象类）
用于定义抽象类的接口，其中定义了一个Implementation（实现类接口）的对象并可以维护该对象，它与 Implementation具有关联关系。
（2）Refined Abstraction（扩充抽象类）
扩充由Abstraction定义的接口，通常它不再是抽象类而是具体类。提供控制逻辑的变体。与其父类一样，它们通过通用实现接口与不同的实现进行交互
提供高层控制逻辑，依赖于完成底层实际工作的实现对像
（3）Implementation（实现类接口）
为所有具体实现声明通用接口。抽象部分仅能通过在这里声明的方法与实现对象交互
（4）ConcreateImplementations（具体实现类）
包括特定的实现代码
（5）Client（客户端）
仅关心如何与抽象部分合作。但是，Client需要将抽象对象与一个实现对象连接起来。
实例 如手机支付方式微信、支付宝APP，而每种APP支持三种付款验证方式，密码、指纹、人脸，则桥接模式的实现方式如下：
IPayMode类是实现类，定义了基本操作security()，用于设置验证方式，其子类提供了实现，它位于桥接模式的抽象层。
#include &lt;iostream&gt; using namespace std; // 实现类接口 Implementation（实现类接口）：支付模式 class IPayMode { public: virtual bool security(string Uid) = 0; }; // 具体实现类：密码支付 class PayCypher : public IPayMode { public: bool security(string uId) override { cout &lt;&lt; &#34;Password to pay&#34; &lt;&lt; endl; return true; } }; // 具体实现类：人脸支付 class PayFaceMode : public IPayMode { public: bool security(string uId) override { cout &lt;&lt; &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/35f0eb289b93440bf84a1ffc1a819c5e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-17T10:46:57+08:00" />
<meta property="article:modified_time" content="2023-04-17T10:46:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C&#43;&#43;设计模式——桥模式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="Bridge_0"></a>桥模式（Bridge）</h3> 
<h4><a id="Motivation_2"></a>动机（Motivation）</h4> 
<p>由于某些类型的固有实现逻辑，使得他们具有两个变化的维度，乃至多个维度的变化</p> 
<p>如何应对这种“多维度的变化”？如何利用面向对象技术来使得类型可以轻松沿着两个乃至多个方向变化，而不引入额外复杂度？</p> 
<h4><a id="_8"></a>模式定义</h4> 
<blockquote> 
 <p>将抽象部分（业务功能）与实现部分（平台实现）分离，使他们都可以独立的变化。 ——《设计模式》GoF</p> 
</blockquote> 
<h4><a id="Struture_12"></a>结构（Struture）</h4> 
<p><img src="https://images2.imgbox.com/09/8e/ZM9ZNi7m_o.png" alt=""></p> 
<p>（1）Abstraction（抽象类）</p> 
<p>用于定义抽象类的接口，其中定义了一个Implementation（实现类接口）的对象并可以维护该对象，它与 Implementation具有关联关系。</p> 
<p>（2）Refined Abstraction（扩充抽象类）</p> 
<p>扩充由Abstraction定义的接口，通常它不再是抽象类而是具体类。提供控制逻辑的变体。与其父类一样，它们通过通用实现接口与不同的实现进行交互</p> 
<p>提供高层控制逻辑，依赖于完成底层实际工作的实现对像<br> （3）Implementation（实现类接口）</p> 
<p>为所有具体实现声明通用接口。抽象部分仅能通过在这里声明的方法与实现对象交互<br> （4）ConcreateImplementations（具体实现类）</p> 
<p>包括特定的实现代码</p> 
<p>（5）Client（客户端）</p> 
<p>仅关心如何与抽象部分合作。但是，Client需要将抽象对象与一个实现对象连接起来。</p> 
<h4><a id="_39"></a>实例</h4> 
<p>如手机支付方式微信、支付宝APP，而每种APP支持三种付款验证方式，密码、指纹、人脸，则桥接模式的实现方式如下：</p> 
<p>IPayMode类是实现类，定义了基本操作security()，用于设置验证方式，其子类提供了实现，它位于桥接模式的抽象层。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span> </span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span> 
 
<span class="token comment">// 实现类接口 Implementation（实现类接口）：支付模式 </span>
<span class="token keyword">class</span> <span class="token class-name">IPayMode</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">bool</span> <span class="token function">security</span><span class="token punctuation">(</span>string Uid<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token comment">// 具体实现类：密码支付</span>
<span class="token keyword">class</span> <span class="token class-name">PayCypher</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">IPayMode</span></span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">bool</span> <span class="token function">security</span><span class="token punctuation">(</span>string uId<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Password to pay"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token comment">// 具体实现类：人脸支付</span>
<span class="token keyword">class</span> <span class="token class-name">PayFaceMode</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">IPayMode</span></span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">bool</span> <span class="token function">security</span><span class="token punctuation">(</span>string uId<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
         cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Face to pay"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token comment">// 具体实现类：指纹支付</span>
<span class="token keyword">class</span> <span class="token class-name">PayFingerprintMode</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">IPayMode</span></span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">bool</span> <span class="token function">security</span><span class="token punctuation">(</span>string uId<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"fingo-pay"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token comment">// 抽象化类：支付</span>
<span class="token keyword">class</span> <span class="token class-name">Pay</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Pay</span><span class="token punctuation">(</span>IPayMode<span class="token operator">*</span> payMode<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token operator">-&gt;</span>payMode <span class="token operator">=</span> payMode<span class="token punctuation">;</span><span class="token comment">//抽象类中定义了一个 IPayMode，与IPayMode存在关联关系</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">delete</span> payMode<span class="token punctuation">;</span> <span class="token punctuation">}</span>
 
    <span class="token keyword">virtual</span> string <span class="token function">transfer</span><span class="token punctuation">(</span>string uId<span class="token punctuation">,</span> string tradeId<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token keyword">long</span> amount<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
 
    IPayMode<span class="token operator">*</span> payMode<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token comment">// 扩展抽象化角色： 微信支付</span>
<span class="token keyword">class</span> <span class="token class-name">WxPay</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Pay</span></span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">WxPay</span><span class="token punctuation">(</span>IPayMode<span class="token operator">*</span> payMode<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Pay</span><span class="token punctuation">(</span>payMode<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span>
    <span class="token comment">//扩展抽象类 实现了抽象类中定义的方法</span>
    string <span class="token function">transfer</span><span class="token punctuation">(</span>string uId<span class="token punctuation">,</span> string tradeId<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token keyword">long</span> amount<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         cout <span class="token operator">&lt;&lt;</span> <span class="token string">"WeChat pay start, uId: "</span> <span class="token operator">&lt;&lt;</span> uId <span class="token operator">&lt;&lt;</span> <span class="token string">" tradeId: "</span> 
             <span class="token operator">&lt;&lt;</span> tradeId <span class="token operator">&lt;&lt;</span> <span class="token string">"amount: "</span> <span class="token operator">&lt;&lt;</span> amount <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">bool</span> security <span class="token operator">=</span> payMode<span class="token operator">-&gt;</span><span class="token function">security</span><span class="token punctuation">(</span>uId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>security<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"WeChat pay failed, uId: "</span> <span class="token operator">&lt;&lt;</span> uId <span class="token operator">&lt;&lt;</span> <span class="token string">" tradeId: "</span> 
             <span class="token operator">&lt;&lt;</span> tradeId <span class="token operator">&lt;&lt;</span> <span class="token string">" amount: "</span> <span class="token operator">&lt;&lt;</span> amount <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
             <span class="token keyword">return</span> <span class="token string">"0001"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
 
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"WeChat pay succeed, uId: "</span> <span class="token operator">&lt;&lt;</span> uId <span class="token operator">&lt;&lt;</span> <span class="token string">" tradeId: "</span> 
             <span class="token operator">&lt;&lt;</span> tradeId <span class="token operator">&lt;&lt;</span> <span class="token string">" amount: "</span> <span class="token operator">&lt;&lt;</span> amount <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
 
        <span class="token keyword">return</span> <span class="token string">"0000"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token comment">// 扩展抽象化角色：支付宝支付</span>
<span class="token keyword">class</span> <span class="token class-name">ZfbPay</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Pay</span></span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">ZfbPay</span><span class="token punctuation">(</span>IPayMode<span class="token operator">*</span> payMode<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Pay</span><span class="token punctuation">(</span>payMode<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span>
 
    string <span class="token function">transfer</span><span class="token punctuation">(</span>string uId<span class="token punctuation">,</span> string tradeId<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token keyword">long</span> amount<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Alipay pay start, uId: "</span> <span class="token operator">&lt;&lt;</span> uId <span class="token operator">&lt;&lt;</span> <span class="token string">" tradeId: "</span> 
             <span class="token operator">&lt;&lt;</span> tradeId <span class="token operator">&lt;&lt;</span> <span class="token string">" amount: "</span> <span class="token operator">&lt;&lt;</span> amount <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">bool</span> security <span class="token operator">=</span> payMode<span class="token operator">-&gt;</span><span class="token function">security</span><span class="token punctuation">(</span>uId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>security<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            cout <span class="token operator">&lt;&lt;</span><span class="token string">"Alipay pay failed,uId: "</span> <span class="token operator">&lt;&lt;</span> uId <span class="token operator">&lt;&lt;</span> <span class="token string">" tradeId: "</span> 
             <span class="token operator">&lt;&lt;</span> tradeId <span class="token operator">&lt;&lt;</span> <span class="token string">" amount: "</span> <span class="token operator">&lt;&lt;</span> amount <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
             <span class="token keyword">return</span> <span class="token string">"0001"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
 
        cout <span class="token operator">&lt;&lt;</span><span class="token string">"Alipay pay succeed,uId: "</span> <span class="token operator">&lt;&lt;</span> uId <span class="token operator">&lt;&lt;</span> <span class="token string">" tradeId: "</span> 
             <span class="token operator">&lt;&lt;</span> tradeId <span class="token operator">&lt;&lt;</span> <span class="token string">" amount: "</span> <span class="token operator">&lt;&lt;</span> amount <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
 
        <span class="token keyword">return</span> <span class="token string">"0000"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token comment">// 客户端使用</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"--------Please select the method of payment------------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    Pay<span class="token operator">*</span> wxPay <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">WxPay</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">PayFaceMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    wxPay<span class="token operator">-&gt;</span><span class="token function">transfer</span><span class="token punctuation">(</span><span class="token string">"weixin_666"</span><span class="token punctuation">,</span> <span class="token string">"a123456"</span><span class="token punctuation">,</span> <span class="token number">290</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
 
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"--------Please select the method of payment----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    Pay<span class="token operator">*</span> zfbPay <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ZfbPay</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">PayCypher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    zfbPay<span class="token operator">-&gt;</span><span class="token function">transfer</span><span class="token punctuation">(</span><span class="token string">"zfb_888, "</span>a123456"<span class="token punctuation">,</span> <span class="token number">319</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_154"></a>优缺点</h4> 
<p>优点：</p> 
<p>（1）分离抽象类及其实现部分。桥接模式使用“对象间的关联关系”解耦了抽象和实现之间 固有的绑定关系，使得抽象和实现可以沿着各自的维度来变化。</p> 
<p>（2）桥接模式是比多继承方案更好的解决方法。</p> 
<p>（3）桥接模式提高了系统的可扩展性，在两个变化维度中任意扩展一个维度，都不需要修改原有的系统。</p> 
<p>（4）实现细节对客户透明，可以对用户隐藏实现细节。用户在使用时不需要关系实现，在抽象层通过聚合关联关系完成封装与对象组合。</p> 
<p>缺点：</p> 
<p>（1）桥接模式的引入会增加系统的理解与设计难度。聚合关系建立在抽象层，要求开发者针对抽象进行设计与编程。</p> 
<p>（2）桥接模式要求正确识别出系统的两个独立变化的维度，因此使用范围具有一定的局限性。</p> 
<h4><a id="_172"></a>要点总结</h4> 
<ul><li> <p>Bridge模式使用“对象间的组合关系”解耦了抽象和实现之间固有的绑定关系，使得抽象和实现可以沿着各自的维度来变化。所谓抽象和实现沿着各自纬度的变化，即“子类化”它们。</p> </li><li> <p>Bridge模式有时候类似于多继承方案，但是多继承方案往往违背单，复用性比较差。职责原则(即一个类只有一个变化的原因)Bridge模式是比多继承方案更好的解决方法</p> </li><li> <p>Bridge模式的应用一般在“两个非常强的变化维度”，有时一个类也有多于两个的变化维度，这时可以使用Bridge的扩展模式。</p> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/445e6006d3fb4900379a0bfab579b314/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux下获取时间的方法对比</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/09304e13ad71de5af7b543dcff31963c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue3中使用base64加密(两种方法)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>