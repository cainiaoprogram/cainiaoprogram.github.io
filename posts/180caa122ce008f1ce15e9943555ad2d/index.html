<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Web自动化测试 —— 测试环境搭建 （Selenium&#43;Python） Windows篇 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Web自动化测试 —— 测试环境搭建 （Selenium&#43;Python） Windows篇" />
<meta property="og:description" content="2017年6月8日/星期四/阴
（说明：文中提到的网址，在本文完成时都是可以访问的，如果后期不能访问了，可以用文中提到的方法尝试找到新的获取方式）
环境搭建前的准备：
1，到Python官网下载Python安装包：https://www.python.org/
如果不能访问，可以试试下面的解决办法：
a）安装VPN网络连接工具，推荐用绿色VPN，我用的时候是免费的。
b）百度搜索一下“Python官网无法访问解决办法”或“Python的最新官方版本下载”。
进入Python官网后，点击下载菜单，进入下载界面，截止本文写作时间，Python最新版本号为3.6.1，如果你是电脑是Windows操作系统，可以直接点击“下载Python 3.6.1”按钮下载保存Windows 32位版本的安装包。
如果不是可以在上图中的发布版本列表中点击Python 3.6.1进入3.6.1版本下载界面，在下载界面最下方有各个操作系统环境下的Python 3.6.1版本，如下图：
Windows版本分为32位和64位，用的32位Windows操作系统的同学请下载Windows x86版本，用64位Windows操作系统的同学请下载Windows x86-64版本。
另外，我们可以看到Windows 32位和63位版本又分别有3个不同的版本，我们到底应该用哪一个呢？
“嵌入式zip文件”
嵌入是可嵌入的意思，即这个版本是嵌入版本。该版本下载后是一个压缩包，其中包含一个最小的Python的环境。它的目的是作为另一个应用程序的一部分，而不是直接被终端用户访问。
下图是Python的官方帮助文档中对嵌入式版本的说明：
帮助文档地址：https：//docs.python.org/3/ 在界面中选择“Python设置和用法”
或者在Python官网主页，选择“文档”下的“docs” - &gt;“Python 3.x Docs”或“Python 2.x Docs”进入帮助文档界面
这是下载后压缩包截图：
下图是解压后，压缩包的内容：
“可执行安装程序”：可执行安装文件，直接运行安装，下载后可以在无网络的情况下安装。
“基于网络的安装程序”： 需要通过联网完成安装
2，PIP下载
下载地址：https：//pypi.python.org/pypi/pip/
如果下载地址不可用，可以尝试用下面的方法找到PIP最新版本下载
进入Python的官网，选择的PyPI菜单
在PyPI将界面搜索框中输入PIP搜索
在搜索结果中找到最新的pip版本
进入下载界面，下载PIP包
3，selenium安装包下载
下载地址：https：//pypi.python.org/pypi/selenium/　和PIP相同，如果下载地址不能用，可以通过下面的方法尝试获取硒最新版本
在Python的官网上的PyPI界面搜索硒
找到最新版本的selenium进入下载界面下载安装包
环境搭建：
1，安装的Python
我用的是可执行安装程序版本，直接双击安装包，然后就是下一步，需要注意的是，3.6.1版本在安装时，有一个选项是配置Python环境的，选了就不用再手动配置环境了。其他的和一般的软件安装没区别。
安装成功后的目录结构：一个是Python的安装目录结构，一个是安装目录下LIB \站点包目录结构（注：目前是没有装硒的目录结构）。
2，检测一下python是否安装成功
同时按下赢键&#43; R键，出现运行窗口，输入 “CMD”，回车，进入命令窗口
在命令行窗口输入 “python”，回车，安装成功就会显示下图中标红的内容，如果报错了，先看看是不是环境变量没有配置。
PS环境变量配置方法：在“我的电脑”图标上鼠标右键调出右键菜单，然后选择“属性”，win7以上都需要在弹出的窗口上左边菜单列表中选择“高级系统设置”项，然后才能看到我们属性的系统属性窗口，在系统属性窗口点击 “环境变量” 按钮，进入环境变量配置界面在PATH变量后增加的变量值如下：　变量名：PATH
变量值：; C:\Python36;C:\Python36\脚本;
说明：这里的变量值是安装的Python的路径，如果安装在d盘，就把Ç换成d，如果不是安装在磁盘根目录下，要把安装的完整路径填上
配置好了，再用上面的方法验证Python中是否安装成功。
3，安装selenium
Python的环境下安装selenium有两种方法：
方法一：如果电脑中安装了 “pip”，我们就可以用PIP来安装selenium，这个方法就比较简单。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/180caa122ce008f1ce15e9943555ad2d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-19T11:45:33+08:00" />
<meta property="article:modified_time" content="2022-01-19T11:45:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Web自动化测试 —— 测试环境搭建 （Selenium&#43;Python） Windows篇</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>2017年6月8日/星期四/阴</p> 
<p>（说明：文中提到的网址，在本文完成时都是可以访问的，如果后期不能访问了，可以用文中提到的方法尝试找到新的获取方式）</p> 
<p><strong>环境搭建前的准备：</strong></p> 
<p>　　1，到Python官网下载Python安装包：<a href="https://www.python.org/" rel="nofollow" title="https">https</a>:<a href="https://www.python.org/" rel="nofollow" title="//www.python.org/">//www.python.org/</a></p> 
<p>　　如果不能访问，可以试试下面的解决办法：</p> 
<p>　　a）安装VPN网络连接工具，推荐用绿色VPN，我用的时候是免费的。</p> 
<p>　　b）百度搜索一下“Python官网无法访问解决办法”或“Python的最新官方版本下载”。</p> 
<p>　　 <img alt="" src="https://images2.imgbox.com/be/73/nvMIb79w_o.png"> </p> 
<p>　　进入Python官网后，点击下载菜单，进入下载界面，截止本文写作时间，Python最新版本号为3.6.1，如果你是电脑是Windows操作系统，可以直接点击“下载Python 3.6.1”按钮下载保存Windows 32位版本的安装包。</p> 
<p>　　如果不是可以在上图中的发布版本列表中点击Python 3.6.1进入3.6.1版本下载界面，在下载界面最下方有各个操作系统环境下的Python 3.6.1版本，如下图：</p> 
<p>　　<img alt="" height="530" src="https://images2.imgbox.com/54/53/37frfE1g_o.png" width="1198"></p> 
<p> </p> 
<p>　　Windows版本分为32位和64位，用的32位Windows操作系统的同学请下载Windows x86版本，用64位Windows操作系统的同学请下载Windows x86-64版本。</p> 
<p>　　另外，我们可以看到Windows 32位和63位版本又分别有3个不同的版本，我们到底应该用哪一个呢？</p> 
<p><strong>　　“嵌入式zip文件”</strong></p> 
<p><strong>　　　　</strong>嵌入是可嵌入的意思，即这个版本是嵌入版本。该版本下载后是一个压缩包，其中包含一个最小的Python的环境。它的目的是作为另一个应用程序的一部分，而不是直接被终端用户访问。</p> 
<p>　　　　<strong>下图是Python的官方帮助文档中对嵌入式版本的说明：</strong></p> 
<p>　　　　<img alt="" height="206" src="https://images2.imgbox.com/45/65/Sgk5NwBT_o.png" width="829"></p> 
<p> </p> 
<p> 　　　　帮助文档地址：<a href="https://docs.python.org/3/" rel="nofollow" title="https">https</a>：<a href="https://docs.python.org/3/" rel="nofollow" title="//docs.python.org/3/">//docs.python.org/3/</a>   在界面中选择“Python设置和用法”</p> 
<p>　　　　或者在Python官网主页，选择“文档”下的“docs” - &gt;“Python 3.x Docs”或“Python 2.x Docs”进入帮助文档界面</p> 
<p>　　　　<img alt="" src="https://images2.imgbox.com/ae/4e/knPdT9rf_o.png"></p> 
<p>　　　　<img alt="" src="https://images2.imgbox.com/43/48/19VhLFCX_o.png"></p> 
<p>　　　　<strong>这是下载后压缩包截图：</strong><img alt="" src="https://images2.imgbox.com/20/1c/LHbViyzK_o.png"></p> 
<p>　　　　<strong>下图是解压后，压缩包的内容：</strong></p> 
<p>　　　　<img alt="" src="https://images2.imgbox.com/a5/4f/UKsNYopo_o.png"></p> 
<p><strong>　　“可执行安装程序”：</strong>可执行安装文件，直接运行安装，下载后可以在无网络的情况下安装。</p> 
<p><strong>　　“基于网络的安装程序”：</strong>  需要通过联网完成安装</p> 
<p>　　2，PIP下载</p> 
<p>　　　　下载地址：<a href="https://pypi.python.org/pypi/pip/" rel="nofollow" title="https">https</a>：<a href="https://pypi.python.org/pypi/pip/" rel="nofollow" title="//pypi.python.org/pypi/pip/">//pypi.python.org/pypi/pip/</a></p> 
<p>　　　　如果下载地址不可用，可以尝试用下面的方法找到PIP最新版本下载</p> 
<p>　　　　进入Python的官网，选择的PyPI菜单</p> 
<p>　　　　<img alt="" src="https://images2.imgbox.com/cd/28/hWcPdd31_o.png"></p> 
<p>　　　　在PyPI将界面搜索框中输入PIP搜索</p> 
<p>　　　　<img alt="" src="https://images2.imgbox.com/99/44/z4zAE1IC_o.png"></p> 
<p>　　　　在搜索结果中找到最新的pip版本</p> 
<p>　　　　<img alt="" src="https://images2.imgbox.com/4b/d9/I7dRQNL3_o.png"></p> 
<p>　　　　进入下载界面，下载PIP包</p> 
<p>　　　　　　　　</p> 
<p>　　3，selenium安装包下载</p> 
<p>　　　　下载地址：<a href="https://pypi.python.org/pypi/selenium/" rel="nofollow" title="https">https</a>：<a href="https://pypi.python.org/pypi/selenium/" rel="nofollow" title="//pypi.python.org/pypi/selenium/">//pypi.python.org/pypi/selenium/</a>　　　　　　　　　　</p> 
<p>　　　　和PIP相同，如果下载地址不能用，可以通过下面的方法尝试获取硒最新版本</p> 
<p>　　　　在Python的官网上的PyPI界面搜索硒</p> 
<p>　　　　<img alt="" src="https://images2.imgbox.com/96/7b/DEhyHxBH_o.png"></p> 
<p>　　　　找到最新版本的selenium进入下载界面下载安装包</p> 
<p>　　　　<img alt="" src="https://images2.imgbox.com/20/9e/x3W6HVU9_o.png"></p> 
<p>　　　　<img alt="" src="https://images2.imgbox.com/8e/eb/MOwiTVUx_o.png"></p> 
<p></p> 
<p><strong>环境搭建：</strong></p> 
<p>1，安装的Python</p> 
<p>　　我用的是<strong>可执行安装程序</strong>版本，直接双击安装包，然后就是下一步，需要注意的是，3.6.1版本在安装时，有一个选项是配置Python环境的，选了就不用再手动配置环境了。其他的和一般的软件安装没区别。</p> 
<p>　　<img alt="" src="https://images2.imgbox.com/c1/b2/IcdLUk6g_o.png"></p> 
<p>　　安装成功后的目录结构：一个是Python的安装目录结构，一个是安装目录下LIB \站点包目录结构（注：目前是没有装硒的目录结构）。</p> 
<p>　　<img alt="" src="https://images2.imgbox.com/1d/dc/rihwckAP_o.png"></p> 
<p><img alt="" src="https://images2.imgbox.com/1a/7c/dH5Tmq4r_o.png"></p> 
<p>2，检测一下python是否安装成功</p> 
<p>　　同时按下赢键+ R键，出现运行窗口，输入 “CMD”，回车，进入命令窗口</p> 
<p>　　<img alt="" src="https://images2.imgbox.com/8f/d0/TkM5tCtA_o.png"></p> 
<p>　　在命令行窗口输入 “python”，回车，安装成功就会显示下图中标红的内容，如果报错了，先看看是不是环境变量没有配置。</p> 
<p>　　<img alt="" src="https://images2.imgbox.com/07/85/DJmBAaWV_o.png"></p> 
<p>　　PS环境变量配置方法：在“我的电脑”图标上鼠标右键调出右键菜单，然后选择“属性”，win7以上都需要在弹出的窗口上左边菜单列表中选择“高级系统设置”项，然后才能看到我们属性的系统属性窗口，在系统属性窗口点击 “环境变量” 按钮，进入环境变量配置界面在PATH变量后增加的变量值如下：　　</p> 
<p>　　变量名：PATH</p> 
<p>　　变量值：; C:\Python36;C:\Python36\脚本;</p> 
<p>　　说明：这里的变量值是安装的Python的路径，如果安装在d盘，就把Ç换成d，如果不是安装在磁盘根目录下，要把安装的完整路径填上</p> 
<p>　　配置好了，再用上面的方法验证Python中是否安装成功。</p> 
<p>3，安装selenium</p> 
<p>　　Python的环境下安装selenium有两种方法：</p> 
<p>　　方法一：如果电脑中安装了 “pip”，我们就可以用PIP来安装selenium，这个方法就比较简单。</p> 
<p>　　　　如何知道自己电脑中是否安装了pip呢？</p> 
<p>　　　　我们可以通过Python版本判断，当Python版本为Python 2.7.9以上或Python 3.4以上的版本，那么我们的系统中在安装Python时就自带了pip。（注：Python版本的查看方式参照第2点）</p> 
<p>　　　　还有一个简单粗暴的方法，直接在的Windows命令行输入PIP，如果有说明信息，则说明系统已经安装了PIP，反之则没有安装。下图就说明系统中以及安装的点子。</p> 
<p>　　　　<img alt="" src="https://images2.imgbox.com/7a/71/B7hDbb1M_o.png"></p> 
<p>　　　　用pip -V查看pip的版本，如果不是最新的版本更新一下版本，使用命令：python -m pip install -U pip更新版本</p> 
<p>　　　　<img alt="" src="https://images2.imgbox.com/fa/97/ydrvQVtV_o.png"></p> 
<p>　　　　然后用PIP安装selenium，方法如下</p> 
<p>　　　　　　1），使用命令pip install Selenium，回车后就会显示如下安装进度，提示安装成功后就安装好了（这个命令是安装最新的Selenium版本，还可以安装指定的版本）</p> 
<p>　　　　　　　　<img alt="" src="https://images2.imgbox.com/c1/eb/F3AKkltu_o.png"></p> 
<p>　　　　　　2），安装指定的Selenium版本命令：pip install selenium == 3.4.1</p> 
<p>　　　　　　　　</p> 
<p></p> 
<p>　　方法二：直接通过Selenium安装包安装，方法如下：</p> 
<p>　　　　1）将下载的Selenium安装包解压，解压后如下</p> 
<p>　　　　　　</p> 
<p>　　　　2）打开的Windows命令行窗口，将目录切换到Selenium解压后的目录中</p> 
<p>　　　　　　使用命令：直接输入“盘符：”回车可以切换盘符，然后用“cd路径”切换到Selenium解压后的目录中</p> 
<p>　　　　　　<img alt="" src="https://images2.imgbox.com/bb/0a/ykvtqdua_o.png"></p> 
<p>　　　　　　<img alt="" src="https://images2.imgbox.com/d5/e1/4eZhBvlT_o.png"></p> 
<p>　　　　3）使用命令：python setup.py install安装Selenium</p> 
<p>　　　　　　<img alt="" src="https://images2.imgbox.com/90/37/xvJUJM8r_o.png"></p> 
<p>如图4所示，检查Selenium是否安装成功</p> 
<p>　　方法一：</p> 
<p>　　　　使用命令“pip show selenium”可以看到当前系统中安装的版本信息（截图参看上一点中的方法一）</p> 
<p>　　方法二：</p> 
<p>　　首先，可以到的Python的安装目录下查看，多了一个selenium的目录</p> 
<p>　　<img alt="" src="https://images2.imgbox.com/62/23/fUq4Tqkg_o.png"></p> 
<p>　　然后打开的Python的IDLE</p> 
<p>　　<img alt="" src="https://images2.imgbox.com/1f/a0/mElw8k72_o.png"></p> 
<p>　　在IDLE中输入下图中的命令（黄色框中的），回车后显示红色框中的内容就可以判断Selenium安装成功了。</p> 
<p>　　<img alt="" src="https://images2.imgbox.com/5d/f0/iWUI8isb_o.png"></p> 
<p> 5，检查安装好的环境是否能进行自动化测试</p> 
<p>　　写一个简单的Python的自动化脚本，代码要实现的功能是打开的Firefox浏览器，输入百度的网址，打开百度界面，在百度搜索框中输入“Selenium2”关键字，然后点“百度一下”按钮搜索出结果，然后自动关闭浏览器。</p> 
<p>　　代码来源：虫师的Selenium 2自动化测试实践一书，代码的具体解释可以去虫师的博客看</p> 
<pre><code class="language-html">1 #coding=utf-8
2 from selenium import webdriver
3 
4 driver = webdriver.Firefox()
5 driver.get("http://www.baidu.com")
6 
7 driver.find_element_by_id("kw").send_keys("selenium2")
8 driver.find_element_by_id("su").click()
9 driver.quit()</code></pre> 
<p>步骤：</p> 
<p>　　1，新建一个的Python脚本文件，命名为baidu.py，必须以的.py为后缀，这是的Python脚本文件的固有后缀名</p> 
<p>　　2，然后用Python的IDLE打开该文件，或者用记事本打开都可以，用IDLE编辑代码后可以直接运行，用记事本编辑代码还需要到命令行用命令“Python文件名.py”来运行</p> 
<p>　　3，复制粘贴上面的代码，或者自己动手敲进去，自动动手敲可以加深印象</p> 
<p>　　如图4所示，运行代码，查看结果</p> 
<p>运行结果如下：</p> 
<p>　　<img alt="" src="https://images2.imgbox.com/41/39/NA6H6LLR_o.png"></p> 
<p>这段代码的运行结果，应该是把火狐打开，然后显示百度的界面，并搜索出“Selenium2”的结果，但实际我运行时报错了，而火狐浏览器根本就没有打开。</p> 
<p>这是为什么呢？</p> 
<p>因为火狐浏览器在新版本中更新了新引擎。以前的Firefox的版本使用的是谷歌的原生驱动，当时谷歌的原生驱动支持火狐的引擎，但是现在的Firefox更新了引擎，而谷歌的原生驱动没有做对应的更新，所以导致上面的问题出现，为了解决这个问题，就需要重新下载一个驱动文件，文件名为“geckodriver.exe”，下载后将其路径配置在路径变量中。或者直接把文件拷贝到Python安装目录下</p> 
<p>geckodriver.exe的下载路径：<a href="https://github.com/mozilla/geckodriver/releases" title="https">https</a>：<a href="https://github.com/mozilla/geckodriver/releases" title="//github.com/mozilla/geckodriver/releases">//github.com/mozilla/geckodriver/releases</a></p> 
<p>从上面的路径获取最新版本，geckodriver也有多个版本，选择自己系统对应的版本，我的是视窗系统64位的</p> 
<p>　　<img alt="" src="https://images2.imgbox.com/de/88/daFPk7ed_o.png"></p> 
<p>　　下载后把压缩包解压了，我是直接将解压后的文件拷到Python的安装目录下了</p> 
<p>　　<img alt="" src="https://images2.imgbox.com/24/bb/8Zu7aY6D_o.png"></p> 
<p>　　再运行刚刚的脚本，这次就能成功的打开浏览器并搜索结果了。</p> 
<p>　　　　　　　　</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1fbed2ac79fd8f87f90f54e3f621e1a5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数字翻转（4位数）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f5fccf981fa612d692da0c36f7012655/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">你的外卖为什么他来送——聊一聊外卖订单的生命周期</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>