<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>如何更改max_allowed_pa​​cket大小 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="如何更改max_allowed_pa​​cket大小" />
<meta property="og:description" content="本文翻译自：How to change max_allowed_packet size
I am having a problem with BLOB fields in my MySQL database - when uploading files larger than approx 1MB I get an error Packets larger than max_allowed_packet are not allowed. 我的MySQL数据库中的BLOB字段存在问题-上传大于1MB的文件时出现错误， Packets larger than max_allowed_packet are not allowed. Here is what i&#39;ve tried: 这是我尝试过的： In MySQL Query Browser I ran a show variables like &#39;max_allowed_packet&#39; which gave me 1048576. 在MySQL查询浏览器中，我运行了一个show variables like &#39;max_allowed_packet&#39; ，它给了我1048576。 Then I execute the query set global max_allowed_packet=33554432 followed by show variables like &#39;max_allowed_packet&#39; - it gives me 33554432 as expected." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/444cf00a5e940ab6fcd29813b834d0fc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-05T10:36:55+08:00" />
<meta property="article:modified_time" content="2020-08-05T10:36:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">如何更改max_allowed_pa​​cket大小</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>本文翻译自：<a href="https://oldbug.net/q/xPqg/How-to-change-max-allowed-packet-size" rel="nofollow">How to change max_allowed_packet size</a></p> 
<p> <i>I am having a problem with BLOB fields in my MySQL database - when uploading files larger than approx 1MB I get an error <code>Packets larger than max_allowed_packet are not allowed.</code></i> <b>我的MySQL数据库中的BLOB字段存在问题-上传大于1MB的文件时出现错误， <code>Packets larger than max_allowed_packet are not allowed.</code></b> </p> 
<p> <i>Here is what i've tried:</i> <b>这是我尝试过的：</b> </p> 
<p> <i>In MySQL Query Browser I ran a <code>show variables like 'max_allowed_packet'</code> which gave me 1048576.</i> <b>在MySQL查询浏览器中，我运行了一个<code>show variables like 'max_allowed_packet'</code> ，它给了我1048576。</b> </p> 
<p> <i>Then I execute the query <code>set global max_allowed_packet=33554432</code> followed by <code>show variables like 'max_allowed_packet'</code> - it gives me 33554432 as expected.</i> <b>然后，我执行查询<code>set global max_allowed_packet=33554432</code>然后执行<code>show variables like 'max_allowed_packet'</code>如预期的那样，它给了我33554432。</b> </p> 
<p> <i>But when I restart the MySQL server it magically goes back to 1048576. What am I doing wrong here?</i> <b>但是，当我重新启动MySQL服务器时，它神奇地回到了1048576。在这里我做错了什么？</b> </p> 
<p> <i>Bonus question, is it possible to compress a BLOB field?</i> <b>额外的问题，是否可以压缩BLOB字段？</b> </p> 
<hr> 
<h4>#1楼</h4> 
<p>参考：<a href="https://stackoom.com/question/xPqg/%E5%A6%82%E4%BD%95%E6%9B%B4%E6%94%B9max-allowed-pa-cket%E5%A4%A7%E5%B0%8F" rel="nofollow">https://stackoom.com/question/xPqg/如何更改max-allowed-pa-cket大小</a></p> 
<hr> 
<h4>#2楼</h4> 
<p> <i>I think some would also want to know how to find the my.ini file on your PC.</i> <b>我认为有些人也想知道如何在您的PC上找到my.ini文件。</b> <i>For windows users, I think the best way is as follows:</i> <b>对于Windows用户，我认为最好的方法如下：</b> </p> 
<ol><li> <i><strong>Win+R</strong> (shortcut for 'run'), type <strong>services.msc</strong> , Enter</i> <b><strong>Win + R</strong> （“运行”的快捷方式），键入<strong>services.msc</strong> ，输入</b> </li><li> <i>You could find an entry like 'MySQL56', right click on it, select <strong>properties</strong></i> <b>您可以找到类似“ MySQL56”的条目，右键单击它，选择<strong>属性</strong></b> </li><li> <i>You could see sth like "D:/Program Files/MySQL/MySQL Server 5.6/bin\\mysqld" --defaults-file="D:\\ProgramData\\MySQL\\MySQL Server 5.6\\my.ini" MySQL56</i> <b>您可能会看到类似“ D：/ Program Files / MySQL / MySQL Server 5.6 / bin \\ mysqld” --defaults-file =“ D：\\ ProgramData \\ MySQL \\ MySQL Server 5.6 \\ my.ini” MySQL56</b> </li></ol> 
<p> <i>I got this answer from <a href="http://bugs.mysql.com/bug.php?id=68516" rel="nofollow">http://bugs.mysql.com/bug.php?id=68516</a></i> <b>我从<a href="http://bugs.mysql.com/bug.php?id=68516" rel="nofollow">http://bugs.mysql.com/bug.php?id=68516</a>得到了这个答案</b> </p> 
<hr> 
<h4>#3楼</h4> 
<p> <i>One of my junior developers was having a problem modifying this for me so I thought I would expand this in greater detail for linux users:</i> <b>我的一名初级开发人员在为我修改此文件时遇到了问题，因此我想我将为Linux用户更详细地介绍这一点：</b> </p> 
<p> <i>1) open terminal</i> <b>1）打开终端</b> </p> 
<p> <i>2) ssh root@YOURIP</i> <b>2）ssh root @您的IP地址</b> </p> 
<p> <i>3) enter root password</i> <b>3）输入root密码</b> </p> 
<p> <i>4) nano /etc/mysql/my.cnf (if command is not recognized do this first or try vi then repeat: yum install nano )</i> <b>4）nano /etc/mysql/my.cnf（如果无法识别命令，请先执行此操作，或者先尝试vi然后再重复：yum install nano）</b> </p> 
<p> <i>5) add the line: max_allowed_packet=256M (obviously adjust size for whatever you need) under the [MYSQLD] section.</i> <b>5）在[MYSQLD]部分下添加以下行：max_allowed_pa​​cket = 256M（显然可以根据需要调整大小）。</b> <i>He made a mistake of putting it at the bottom of the file first so it did not work.</i> <b>他犯了一个错误，将其首先放在文件的底部，因此它不起作用。</b> </p> 
<p><img src="https://images2.imgbox.com/b5/26/vIAEIiIb_o.png" alt="在此处输入图片说明"></p> 
<p> <i>6) Control + O (save) then ENTER (confirm) then Control + X (exit file)</i> <b>6）Control + O（保存），然后按ENTER（确认），然后按Control + X（退出文件）</b> </p> 
<p> <i>7) service mysqld restart</i> <b>7）服务mysqld重启</b> </p> 
<p> <i>8) You can check the change in the variables section on phpmyadmin</i> <b>8）您可以在phpmyadmin的变量部分中检查更改</b> </p> 
<hr> 
<h4>#4楼</h4> 
<p> <i>If getting this error while performing a backup, <code>max_allowed_packet</code> can be set in the <code>my.cnf</code> particularly for <code>mysqldump</code> .</i> <b>如果在执行备份时出现此错误，则可以在<code>my.cnf</code>设置<code>max_allowed_packet</code> ，特别是对于<code>mysqldump</code> 。</b> </p> 
<pre><code>[mysqldump]
max_allowed_packet=512M
</code></pre> 
<p> <i>I kept getting this error while performing a <code>mysqldump</code> and I did not understand because I had this set in <code>my.cnf</code> under the <code>[mysqld]</code> section.</i> <b>我在执行<code>mysqldump</code>时一直收到此错误，但我不明白，因为我在<code>[mysqld]</code>部分下的<code>my.cnf</code>对此进行了设置。</b> <i>Once I figured out I could set it for <code>[mysqldump]</code> and I set the value, my backups completed without issue.</i> <b>一旦确定可以为<code>[mysqldump]</code>设置它并设置该值，我的备份就可以顺利完成了。</b> </p> 
<hr> 
<h4>#5楼</h4> 
<p> <i>If you want upload big size image or data in database.</i> <b>如果要上载较大尺寸的图像或数据库中的数据。</b> <i>Just change the data type to <code>'BIG BLOB'</code> .</i> <b>只需将数据类型更改为<code>'BIG BLOB'</code> 。</b> </p> 
<hr> 
<h4>#6楼</h4> 
<p> <i><strong>For those running wamp mysql server</strong></i> <b><strong>对于那些运行wamp mysql服务器的人</strong></b> </p> 
<p> <i>Wamp tray Icon -&gt; MySql -&gt; my.ini</i> <b>Wamp tray图标-&gt; MySql-&gt; my.ini</b> </p> 
<pre><code>[wampmysqld]
port        = 3306
socket      = /tmp/mysql.sock
key_buffer_size = 16M
max_allowed_packet = 16M        // --&gt; changing this wont solve
sort_buffer_size = 512K
</code></pre> 
<p> <i>Scroll down to the end until u find</i> <b>向下滚动到最后直到找到</b> </p> 
<pre><code>[mysqld]
port=3306
explicit_defaults_for_timestamp = TRUE
</code></pre> 
<p> <i>Add the line of <strong>packet_size</strong> in between</i> <b>在之间添加<strong>packet_size</strong>行</b> </p> 
<pre><code>[mysqld]
port=3306
max_allowed_packet = 16M
explicit_defaults_for_timestamp = TRUE
</code></pre> 
<p> <i>Check whether it worked with this query</i> <b>检查它是否适用于此查询</b> </p> 
<pre><code>Select @@global.max_allowed_packet;
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e60eef3197c5f9b71010689e82ac1d31/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">nrf52840的uart0与uart1双串口使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f88864367b1de9ebe726e0116082cbdb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">YouTube热门视频的分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>