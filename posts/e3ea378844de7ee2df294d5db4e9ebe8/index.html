<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>NSIS入门教程 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="NSIS入门教程" />
<meta property="og:description" content="NSIS简介 NSIS是&#34;Nullsoft 脚本安装系统&#34;(Nullsoft scriptable Installation System)的缩写，它是是一个免费的win32安装、卸载程序，可以打包windows应用程序。
打包步骤 下载NSIS脚本安装系统，启动NSIS Edit
引用了急支糖浆的图片
注：这里有一些信息使用了变量来表示，因为脚本中可能会在多个地方使用，使用变量可以方便修改，统一管理。这些变量在下面的脚本中会设置相应的值。
; 该脚本使用 HM VNISEdit 脚本编辑器向导产生 ; 安装程序初始定义常量 !define PRODUCT_NAME &#34;HTE加密程序&#34; !define PRODUCT_VERSION &#34;1.05&#34; !define PRODUCT_PUBLISHER &#34;gyc&#34; !define PRODUCT_DIR_REGKEY &#34;Software\Microsoft\Windows\CurrentVersion\App Paths\HTE加密程序.exe&#34; !define PRODUCT_UNINST_KEY &#34;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&#34; !define PRODUCT_UNINST_ROOT_KEY &#34;HKLM&#34; SetCompressor lzma ; ------ MUI 现代界面定义 (1.67 版本以上兼容) ------ !include &#34;MUI.nsh&#34; ; MUI 预定义常量 !define MUI_ABORTWARNING !define MUI_ICON &#34;a6ob4-47ow2-001.ico&#34; !define MUI_UNICON &#34;a0280-9m4nb-001.ico&#34; ; 语言选择窗口常量设置 !define MUI_LANGDLL_REGISTRY_ROOT &#34;${PRODUCT_UNINST_ROOT_KEY}&#34; !define MUI_LANGDLL_REGISTRY_KEY &#34;${PRODUCT_UNINST_KEY}&#34; !define MUI_LANGDLL_REGISTRY_VALUENAME &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e3ea378844de7ee2df294d5db4e9ebe8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-18T18:00:00+08:00" />
<meta property="article:modified_time" content="2023-02-18T18:00:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">NSIS入门教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">NSIS简介</span></h3> 
 <p style="">NSIS是"Nullsoft 脚本安装系统"(Nullsoft scriptable Installation System)的缩写，它是是一个免费的win32安装、卸载程序，可以打包windows应用程序。</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">打包步骤</span></h3> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p><span class="kdocs-bold" style="font-weight:bold;">下载NSIS脚本安装系统</span>，启动NSIS Edit</p></li></ol> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:282px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:123.049644%;height:0;"> 
    <img src="https://images2.imgbox.com/ad/0f/NFN9PA9W_o.png" style="margin-left:;display:block;width:282px;margin-top:-123.049644%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:601px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:72.04659%;height:0;"> 
    <img src="https://images2.imgbox.com/5b/38/zlXqcizj_o.png" style="margin-left:;display:block;width:601px;margin-top:-72.04659%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:598px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:71.404686%;height:0;"> 
    <img src="https://images2.imgbox.com/4a/77/DzTT3O3U_o.png" style="margin-left:;display:block;width:598px;margin-top:-71.404686%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">引用了急支糖浆的图片</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:726px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:55.922863%;height:0;"> 
    <img src="https://images2.imgbox.com/19/6f/vEyGYb0k_o.png" style="margin-left:;display:block;width:726px;margin-top:-55.922863%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:699px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:57.22461%;height:0;"> 
    <img src="https://images2.imgbox.com/93/25/08m9Ddt8_o.png" style="margin-left:;display:block;width:699px;margin-top:-57.22461%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:717px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:59.553696%;height:0;"> 
    <img src="https://images2.imgbox.com/5d/a7/ZT2eK5FM_o.png" style="margin-left:;display:block;width:717px;margin-top:-59.553696%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""><span class="kdocs-color" style="color:#C21C13;">注：这里有一些信息使用了变量来表示，因为脚本中可能会在多个地方使用，使用变量可以方便修改，统一管理。这些变量在下面的脚本中会设置相应的值。</span></p> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">; 该脚本使用 HM VNISEdit 脚本编辑器向导产生

; 安装程序初始定义常量
!define PRODUCT_NAME "HTE加密程序"
!define PRODUCT_VERSION "1.05"
!define PRODUCT_PUBLISHER "gyc"
!define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\HTE加密程序.exe"
!define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"
!define PRODUCT_UNINST_ROOT_KEY "HKLM"

SetCompressor lzma

; ------ MUI 现代界面定义 (1.67 版本以上兼容) ------
!include "MUI.nsh"

; MUI 预定义常量
!define MUI_ABORTWARNING
!define MUI_ICON "a6ob4-47ow2-001.ico"
!define MUI_UNICON "a0280-9m4nb-001.ico"

; 语言选择窗口常量设置
!define MUI_LANGDLL_REGISTRY_ROOT "${PRODUCT_UNINST_ROOT_KEY}"
!define MUI_LANGDLL_REGISTRY_KEY "${PRODUCT_UNINST_KEY}"
!define MUI_LANGDLL_REGISTRY_VALUENAME "NSIS:Language"

; 欢迎页面
!insertmacro MUI_PAGE_WELCOME
; 安装目录选择页面
!insertmacro MUI_PAGE_DIRECTORY
; 安装过程页面
!insertmacro MUI_PAGE_INSTFILES
; 安装完成页面
!define MUI_FINISHPAGE_RUN "$INSTDIR\HTE加密程序.exe"
!insertmacro MUI_PAGE_FINISH

; 安装卸载过程页面
!insertmacro MUI_UNPAGE_INSTFILES

; 安装界面包含的语言设置
!insertmacro MUI_LANGUAGE "English"
!insertmacro MUI_LANGUAGE "SimpChinese"
!insertmacro MUI_LANGUAGE "TradChinese"
!insertmacro MUI_LANGUAGE "Esperanto"

; 安装预释放文件
!insertmacro MUI_RESERVEFILE_LANGDLL
!insertmacro MUI_RESERVEFILE_INSTALLOPTIONS
; ------ MUI 现代界面定义结束 ------

Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"
OutFile "Setup.exe"
InstallDir "$PROGRAMFILES\HTE加密程序"
InstallDirRegKey HKLM "${PRODUCT_UNINST_KEY}" "UninstallString"
ShowInstDetails show
ShowUnInstDetails show
BrandingText " "

Section "MainSection" SEC01
  SetOutPath "$INSTDIR"
  SetOverwrite on
  File "HTE加密程序\HTE加密程序\gyc"
SectionEnd

Section -AdditionalIcons
  CreateShortCut "$SMPROGRAMS\HTE加密程序\Uninstall.lnk" "$INSTDIR\uninst.exe"
SectionEnd

Section -Post
  WriteUninstaller "$INSTDIR\uninst.exe"
  WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\HTE加密程序.exe"
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\HTE加密程序.exe"
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"
SectionEnd

#-- 根据 NSIS 脚本编辑规则，所有 Function 区段必须放置在 Section 区段之后编写，以避免安装程序出现未可预知的问题。--#

Function .onInit
  !insertmacro MUI_LANGDLL_DISPLAY
FunctionEnd

/******************************
 *  以下是安装程序的卸载部分  *
 ******************************/

Section Uninstall
  Delete "$INSTDIR\uninst.exe"
  Delete "$INSTDIR\chrome_100_percent.pak"
  Delete "$INSTDIR\chrome_200_percent.pak"
  Delete "$INSTDIR\d3dcompiler_47.dll"
  Delete "$INSTDIR\ffmpeg.dll"
  Delete "$INSTDIR\HTE加密程序.exe"
  Delete "$INSTDIR\icudtl.dat"
  Delete "$INSTDIR\libEGL.dll"
  Delete "$INSTDIR\libGLESv2.dll"
  Delete "$INSTDIR\licenses.html"
  Delete "$INSTDIR\README.txt"
  Delete "$INSTDIR\resources.pak"
  Delete "$INSTDIR\snapshot_blob.bin"
  Delete "$INSTDIR\v8_context_snapshot.bin"
  Delete "$INSTDIR\vk_swiftshader.dll"
  Delete "$INSTDIR\vk_swiftshader_icd.json"
  Delete "$INSTDIR\vulkan-1.dll"

  Delete "$SMPROGRAMS\HTE加密程序\Uninstall.lnk"
  Delete "$DESKTOP\HTE加密程序.lnk"
  Delete "$SMPROGRAMS\HTE加密程序\HTE加密程序.lnk"

  RMDir "$SMPROGRAMS\HTE加密程序"

  RMDir /r "$INSTDIR\app"

  RMDir "$INSTDIR"

  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"
  DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"
  SetAutoClose true
SectionEnd

#-- 根据 NSIS 脚本编辑规则，所有 Function 区段必须放置在 Section 区段之后编写，以避免安装程序出现未可预知的问题。--#

Function un.onInit
!insertmacro MUI_UNGETLANGUAGE
  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "您确实要完全移除 $(^Name) ，及其所有的组件？" IDYES +2
  Abort
FunctionEnd

Function un.onUninstSuccess
  HideWindow
  MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) 已成功地从您的计算机移除。"
FunctionEnd</code></pre> 
 <h3 style="">下载与说明</h3> 
 <p style=""><a class="kdocs-link" style="color:#0A6CFF;" href="http://u5n.cn/LkamH" rel="nofollow noopener noreferrer" target="_blank">下载链接（汉化版）</a>访问密码：CSDN。这里不推荐汉化版，因为有时候会出现bug和乱码等问题</p> 
 <p style=""><a class="kdocs-link" style="color:#0A6CFF;" href="https://nsis.sourceforge.io/Download" rel="nofollow noopener noreferrer" target="_blank">官网下载链接（英文）</a>官网可以下载插件和教程而且比汉化版的更新快一点</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:769px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:65.799736%;height:0;"> 
    <img src="https://images2.imgbox.com/69/c6/oPg47LC3_o.png" style="margin-left:;display:block;width:769px;margin-top:-65.799736%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">小技巧：</span></p> 
 <p style="text-align:null;">检查当前版本是否为nsis3.08，可以运行下面这个最简化脚本，编译能过即为NSIS V3.08</p> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">#
OutFile 'Nsistest.exe'

Section
GetWinVer $1 Build
SectionEnd
#//</code></pre> 
 <h3 style="">最终测试</h3> 
 <p style="">我就随随便便写了一段程序，然后编译。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:236px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:78.38983%;height:0;"> 
    <img src="https://images2.imgbox.com/9f/ec/DwStpAZw_o.png" style="margin-left:;display:block;width:236px;margin-top:-78.38983%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">如果报错，下面有提示信息，看看什么没有设置。设置好后，下面就会出现这个安装向导程序：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:475px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:68.63158%;height:0;"> 
    <img src="https://images2.imgbox.com/71/c0/kzADJo1Z_o.png" style="margin-left:;display:block;width:475px;margin-top:-68.63158%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:122px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:101.63934%;height:0;"> 
    <img src="https://images2.imgbox.com/f0/62/DbjnRcmm_o.png" style="margin-left:;display:block;width:122px;margin-top:-101.63934%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">然后他会自动生成一个卸载程序和快捷方式</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:247px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:220.64777%;height:0;"> 
    <img src="https://images2.imgbox.com/ab/4e/nDWvzorg_o.png" style="margin-left:;display:block;width:247px;margin-top:-220.64777%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">exe程序也是可以运行的</p> 
 <hr> 
 <h4 style="">注意</h4> 
 <p style="">NSIS识别的编码是ANSI格式编码，不能识别UTF8编码，故在中文系统下打包出的小语种安装页面，在中文系统下是显示正常的，但是在英文系统下不一定是正常的。</p> 
 <p style="">对于小语种需要在英文系统下进行打包，这样才会在外文系统下正常显示。查看系统的编码是否是英文，可以在cmd中输入chcp进行查看，chcp 936是中文，chcp 437是美式英语。即使是英文系统，有可能编码系统是中文，可以使用chcp查看和切换。</p> 
 <p style="">————————————————</p> 
 <p style="">版权声明：本段为CSDN博主「夜雨听萧瑟」的原创文章中的一段，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。</p> 
 <p style="">原片段链接：<a class="kdocs-link" style="color:#0A6CFF;" href="https://blog.csdn.net/hanxiaoyong_/article/details/124149436" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/hanxiaoyong_/article/details/124149436</a></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/139a681de3b148c643d412f367332a81/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【投屏】Scrcpy源码分析三（Client篇-投屏阶段）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4429cb3ce10c188a832ed8d29c9d2e1b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">LeetCode第529题：扫雷游戏</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>