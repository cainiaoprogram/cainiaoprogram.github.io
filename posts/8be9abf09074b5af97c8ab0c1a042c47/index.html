<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>单片机项目分享 stm32实现车牌识别系统 -物联网 嵌入式 单片机 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="单片机项目分享 stm32实现车牌识别系统 -物联网 嵌入式 单片机" />
<meta property="og:description" content="文章目录 0 前言1 简介2 主要器件3 实现效果4 设计原理4.1 **软件总体过程：**4.2 具体解释 5 部分核心代码6 最后 0 前言 🔥 这两年开始毕业设计和毕业答辩的要求和难度不断提升，传统的毕设题目缺少创新和亮点，往往达不到毕业答辩的要求，这两年不断有学弟学妹告诉学长自己做的项目系统达不到老师的要求。
为了大家能够顺利以及最少的精力通过毕设，学长分享优质毕业设计项目，今天要分享的是
🚩 基于stm32的实现车牌识别系统
🥇学长这里给一个题目综合评分(每项满分5分)
难度系数：4分工作量：4分创新点：3分 1 简介 本系统利用STM32单片机驱动摄像头采集图像，通过模式识别，匹配车牌的识别结果，并在屏幕上显示。
2 主要器件 STM32F103RCT6 主控芯片TFT液晶屏OV7670摄像头蜂鸣器LED电路 3 实现效果 识别效果
摄像头模块
4 设计原理 4.1 软件总体过程： （1）OV7670带FIFO摄像头图像采集，采用GPIO模拟摄像头时序，通过读取FIFO输出值将图像直接显示在LCD屏上
（2）LCD屏相当于一个图像缓存，同时也做显示，通过读取LCD屏上的像素值进行图像处理；
（3）车牌定位处理，车牌定位常用二值化分割，腐蚀膨胀处理，连通域计算等操作，显然这些算法在stm32f1上实现是很困难的，且处理速度太慢，因此，采用RGB转HSV颜色空间变换和阈值选择进行车牌定位，然后将车牌定位区域进行二值化处理，不是蓝色车牌的部分就是字符区域；
（4）车牌字符分割处理，字符分割先采用行统计加列统计的方式，确定每行和每列的有效像素和，进一步确定字符区域；然后进行横向统计分割，通过每一列的像素和阈值判断字符的分界线和个数；
（5）车牌归一化处理，归一化处理先将每个字符提取出来，然后按照像素值进行横向和纵向压缩，最终处理成模板一样大小的字符；并在液晶屏上保存字符的数据；
（6）模板匹配，将归一化之后的字符，与模板中的字符通过像素值一一比较，确定相似度最高的字符就是目标值；
4.2 具体解释 图像采集
通过OV7670摄像头进行图像采集，采集的图像大小为320*240像素，像素格式为RGB565。每个像素由两字节组成，第一字节的高五位是Red，第一字节的低三位和第二字节的高三位组成Green，第二字节的低五位是Blue。
二值化
二值化就是让图像的像素点矩阵中的每个像素点的灰度值为0（黑色）或者255（白色），让整个图片呈现出只有黑色和白色的效果。二值化后的图像中灰度值范围是0或者255。这时需要设定一个阈值来对像素点进行设置。
常用二值化方法：
取中值：设置阈值为127，灰度值小于127的为0，大于127的为255。这样设置计算量小，计算快。缺点也严重：在不同的图像中，颜色分布差别大，处理效果也不会很好。程序开始之前设置R,G，B的阈值，通过阈值判断将像素设置为全黑（0x0000）或者全白（0xFFFF）.同时根据色彩的变化记录每一行的颜色跳变点，由此识别出车牌区域。取平均值：像素点平均值 = （像素点1灰度值 &#43; 像素点2灰度值 &#43; …… &#43; 像素点n灰度值） / n双峰法：此方法适用于具有明显双峰直方图的图像，不适合直方图中双峰差别很大或双峰间的谷比较宽广而平坦的图像。该方法认为图像由前景和背景组成，在灰度直方图上，前景和背景会形成高峰，在双峰之间的最低谷处就是阈值。 识别车牌区域
根据上一步的二值化，由于车牌区域跳变点多，由此可以得出车牌区域。分别记录车牌区域的上下高度。然后通过RGB-HSV颜色转换，识别出车牌区域的左右边界。
字符分割
我国常见车牌以及排列顺序大部分都是按照如下设计的：汉字、英文字母、点、英文字母、阿拉伯数字、阿拉伯数字、阿拉伯数字、阿拉伯数字。基于这个规律，以及图像采集高度一致，设计了如下的分割方法：
在内存中开辟七个长为车牌长的七分之一和宽为车牌宽的区域从车牌图像长边的巾问向下开始扫描车牌图像，并把扫描到的所有的点灰度值复制到0区域的第四个区域对应位置上。然后再从上向下扫描刚扫描过这一努的左边或右边，直到所扫描的这一峰上的所有点的灰度都是0时为止,并把这一竖认为是字符的分离处。切割第五到第七个字符。方法就是，切割完了第四个字符之后，再依次扫描剩下的空间，直到所扫描的这一竖上的所有点的灰度值不全为0时，认为是字符的开始并依次扫描直到所扫描的这一竖上的所有点的灰度值全为0时认为是字符的结束。切割第三到第四个字符。这两个字符的切割方式与第五到第七个字符一样。切割第一到第二个字符。当第三个字符切割完之后，我们将遇到一个点，我们也把它看作一个字符，只不过这个点扫描之后就不要了。扫描完这个点之后，我们来切割第二个字符，它的切割方式与前面一样。切割完了第二个字符之后，再向左扫描，直到所扫描的这一竖上的所有点的灰度值不全为0时，认为是字符的开始，并依次扫描直到所扫描所有剩下的，并填到相应的位置，直到剩下的空间填满。经过粗分割后，可以得到一些单个字符区域和多余的空间。下一步我们将把这些多余的空间去掉。这将更有利于下一步字符的识别。去除图像上多余空间：车牌上的字符经过了粗切割所得到的是一些单的字符，但在分配空间时是按照车牌的宽和长的七分之一来分配的；所以这个空间可能大于字符应该占的空问。所以，要将多余空间去除。对于第一个字符从第一行开始向下扫描，把那些一行中所有的点的灰度值全为0的点去掉，直到扫描到有一行不全为0时为止。然后再从第一列开始向右扫描把那些一列中所有的点的灰度值全为0的点去掉，直到扫描到有一列不全为0时为止。接下来从最后一行开始向上扫描，把那些一行中所有的点的灰度值全为0的点去掉，直到扫描到有一行不全为0时为止。最后从最后一列开始向左扫描把那些一列中所有的点的灰度值全为0的点去掉，直到扫描到有一列不全为0时为止。重复上面的步骤完成剩下字符的切割。根据二值化的结果，以及记录的跳变点位置，对字符进行分割，同时记录字符的左右边界。 字符匹配
对分割出来的字符进行归一化处理，这里用到图片的扩大算法，扩大之后逐一的去进行字符匹配。字符模板事前通过字模软件转换成二进制数据保存在数组中。最后根据匹配结果相似度最大的做为输出结果。
归一化图像就是要把原来各不相同的字符统一到同一尺寸。因为扫描进来的图像中字符大小存在较大的差异，而相对来说，统一尺寸的字符识别的标准性更强，准确率自然也更高。具体算法如下：先得到原来字符的高度和宽度，与系统已存字模的数据作比较，得出要变换的系数，然后根据得到的系数按照插值的方法映射到原图像中。
5 部分核心代码 #define COLOR_RGB565_TO_R8(pixel) \ ({ \ __typeof__ (pixel) __pixel = (pixel); \ __pixel = (__pixel &gt;&gt; 8) &amp; 0xF8; \ __pixel | (__pixel &gt;&gt; 5); \ }) #define COLOR_RGB565_TO_G8(pixel) \ ({ \ __typeof__ (pixel) __pixel = (pixel); \ __pixel = (__pixel &gt;&gt; 3) &amp; 0xFC; \ __pixel | (__pixel &gt;&gt; 6); \ }) #define COLOR_RGB565_TO_B8(pixel) \ ({ \ __typeof__ (pixel) __pixel = (pixel); \ __pixel = (__pixel &lt;&lt; 3) &amp; 0xF8; \ __pixel | (__pixel &gt;&gt; 5); \ })	int8_t imlib_rgb565_to_l(uint16_t pixel) { float r_lin = xyz_table[COLOR_RGB565_TO_R8(pixel)]; float g_lin = xyz_table[COLOR_RGB565_TO_G8(pixel)]; float b_lin = xyz_table[COLOR_RGB565_TO_B8(pixel)]; float y = ((r_lin * 0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8be9abf09074b5af97c8ab0c1a042c47/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-06T12:31:57+08:00" />
<meta property="article:modified_time" content="2024-01-06T12:31:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">单片机项目分享 stm32实现车牌识别系统 -物联网 嵌入式 单片机</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#0__6" rel="nofollow">0 前言</a></li><li><a href="#1__27" rel="nofollow">1 简介</a></li><li><a href="#2__31" rel="nofollow">2 主要器件</a></li><li><a href="#3__39" rel="nofollow">3 实现效果</a></li><li><a href="#4__47" rel="nofollow">4 设计原理</a></li><li><ul><li><a href="#41__49" rel="nofollow">4.1 **软件总体过程：**</a></li><li><a href="#42__58" rel="nofollow">4.2 具体解释</a></li></ul> 
  </li><li><a href="#5__90" rel="nofollow">5 部分核心代码</a></li><li><a href="#6__288" rel="nofollow">6 最后</a></li></ul> 
</div> 
<p></p> 
<hr color="#000000" size='1"'> 
<h2><a id="0__6"></a>0 前言</h2> 
<p>🔥 这两年开始毕业设计和毕业答辩的要求和难度不断提升，传统的毕设题目缺少创新和亮点，往往达不到毕业答辩的要求，这两年不断有学弟学妹告诉学长自己做的项目系统达不到老师的要求。</p> 
<p>为了大家能够顺利以及最少的精力通过毕设，学长分享优质毕业设计项目，今天要分享的是</p> 
<p>🚩 <strong>基于stm32的实现车牌识别系统</strong></p> 
<p>🥇学长这里给一个题目综合评分(每项满分5分)</p> 
<ul><li>难度系数：4分</li><li>工作量：4分</li><li>创新点：3分</li></ul> 
<br> 
<h2><a id="1__27"></a>1 简介</h2> 
<p>本系统利用STM32单片机驱动摄像头采集图像，通过模式识别，匹配车牌的识别结果，并在屏幕上显示。</p> 
<h2><a id="2__31"></a>2 主要器件</h2> 
<ul><li>STM32F103RCT6 主控芯片</li><li>TFT液晶屏</li><li>OV7670摄像头</li><li>蜂鸣器</li><li>LED电路</li></ul> 
<h2><a id="3__39"></a>3 实现效果</h2> 
<p><strong>识别效果</strong><img src="https://images2.imgbox.com/b9/57/gBPi4Qkv_o.png" alt="在这里插入图片描述"><br> <strong>摄像头模块</strong><br> <img src="https://images2.imgbox.com/23/89/wzzapz5P_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="4__47"></a>4 设计原理</h2> 
<h3><a id="41__49"></a>4.1 <strong>软件总体过程：</strong></h3> 
<p>（1）OV7670带FIFO摄像头图像采集，采用GPIO模拟摄像头时序，通过读取FIFO输出值将图像直接显示在LCD屏上<br> （2）LCD屏相当于一个图像缓存，同时也做显示，通过读取LCD屏上的像素值进行图像处理；<br> （3）车牌定位处理，车牌定位常用二值化分割，腐蚀膨胀处理，连通域计算等操作，显然这些算法在stm32f1上实现是很困难的，且处理速度太慢，因此，采用RGB转HSV颜色空间变换和阈值选择进行车牌定位，然后将车牌定位区域进行二值化处理，不是蓝色车牌的部分就是字符区域；<br> （4）车牌字符分割处理，字符分割先采用行统计加列统计的方式，确定每行和每列的有效像素和，进一步确定字符区域；然后进行横向统计分割，通过每一列的像素和阈值判断字符的分界线和个数；<br> （5）车牌归一化处理，归一化处理先将每个字符提取出来，然后按照像素值进行横向和纵向压缩，最终处理成模板一样大小的字符；并在液晶屏上保存字符的数据；<br> （6）模板匹配，将归一化之后的字符，与模板中的字符通过像素值一一比较，确定相似度最高的字符就是目标值；</p> 
<h3><a id="42__58"></a>4.2 具体解释</h3> 
<p><strong>图像采集</strong><br> 通过OV7670摄像头进行图像采集，采集的图像大小为320*240像素，像素格式为RGB565。每个像素由两字节组成，第一字节的高五位是Red，第一字节的低三位和第二字节的高三位组成Green，第二字节的低五位是Blue。</p> 
<p><strong>二值化</strong><br> 二值化就是让图像的像素点矩阵中的每个像素点的灰度值为0（黑色）或者255（白色），让整个图片呈现出只有黑色和白色的效果。二值化后的图像中灰度值范围是0或者255。这时需要设定一个阈值来对像素点进行设置。</p> 
<p>常用二值化方法：</p> 
<ol><li>取中值：设置阈值为127，灰度值小于127的为0，大于127的为255。这样设置计算量小，计算快。缺点也严重：在不同的图像中，颜色分布差别大，处理效果也不会很好。程序开始之前设置R,G，B的阈值，通过阈值判断将像素设置为全黑（0x0000）或者全白（0xFFFF）.同时根据色彩的变化记录每一行的颜色跳变点，由此识别出车牌区域。</li><li>取平均值：像素点平均值 = （像素点1灰度值 + 像素点2灰度值 + …… + 像素点n灰度值） / n</li><li>双峰法：此方法适用于具有明显双峰直方图的图像，不适合直方图中双峰差别很大或双峰间的谷比较宽广而平坦的图像。该方法认为图像由前景和背景组成，在灰度直方图上，前景和背景会形成高峰，在双峰之间的最低谷处就是阈值。</li></ol> 
<p><strong>识别车牌区域</strong><br> 根据上一步的二值化，由于车牌区域跳变点多，由此可以得出车牌区域。分别记录车牌区域的上下高度。然后通过RGB-HSV颜色转换，识别出车牌区域的左右边界。</p> 
<p><strong>字符分割</strong><br> 我国常见车牌以及排列顺序大部分都是按照如下设计的：汉字、英文字母、点、英文字母、阿拉伯数字、阿拉伯数字、阿拉伯数字、阿拉伯数字。基于这个规律，以及图像采集高度一致，设计了如下的分割方法：</p> 
<ol><li>在内存中开辟七个长为车牌长的七分之一和宽为车牌宽的区域</li><li>从车牌图像长边的巾问向下开始扫描车牌图像，并把扫描到的所有的点灰度值复制到0区域的第四个区域对应位置上。然后再从上向下扫描刚扫描过这一努的左边或右边，直到所扫描的这一峰上的所有点的灰度都是0时为止,并把这一竖认为是字符的分离处。</li><li>切割第五到第七个字符。方法就是，切割完了第四个字符之后，再依次扫描剩下的空间，直到所扫描的这一竖上的所有点的灰度值不全为0时，认为是字符的开始并依次扫描直到所扫描的这一竖上的所有点的灰度值全为0时认为是字符的结束。</li><li>切割第三到第四个字符。这两个字符的切割方式与第五到第七个字符一样。</li><li>切割第一到第二个字符。当第三个字符切割完之后，我们将遇到一个点，我们也把它看作一个字符，只不过这个点扫描之后就不要了。扫描完这个点之后，我们来切割第二个字符，它的切割方式与前面一样。切割完了第二个字符之后，再向左扫描，直到所扫描的这一竖上的所有点的灰度值不全为0时，认为是字符的开始，并依次扫描直到所扫描所有剩下的，并填到相应的位置，直到剩下的空间填满。经过粗分割后，可以得到一些单个字符区域和多余的空间。下一步我们将把这些多余的空间去掉。这将更有利于下一步字符的识别。</li><li>去除图像上多余空间：车牌上的字符经过了粗切割所得到的是一些单的字符，但在分配空间时是按照车牌的宽和长的七分之一来分配的；所以这个空间可能大于字符应该占的空问。所以，要将多余空间去除。对于第一个字符从第一行开始向下扫描，把那些一行中所有的点的灰度值全为0的点去掉，直到扫描到有一行不全为0时为止。然后再从第一列开始向右扫描把那些一列中所有的点的灰度值全为0的点去掉，直到扫描到有一列不全为0时为止。接下来从最后一行开始向上扫描，把那些一行中所有的点的灰度值全为0的点去掉，直到扫描到有一行不全为0时为止。最后从最后一列开始向左扫描把那些一列中所有的点的灰度值全为0的点去掉，直到扫描到有一列不全为0时为止。重复上面的步骤完成剩下字符的切割。</li><li>根据二值化的结果，以及记录的跳变点位置，对字符进行分割，同时记录字符的左右边界。</li></ol> 
<p><strong>字符匹配</strong><br> 对分割出来的字符进行归一化处理，这里用到图片的扩大算法，扩大之后逐一的去进行字符匹配。字符模板事前通过字模软件转换成二进制数据保存在数组中。最后根据匹配结果相似度最大的做为输出结果。<br> 归一化图像就是要把原来各不相同的字符统一到同一尺寸。因为扫描进来的图像中字符大小存在较大的差异，而相对来说，统一尺寸的字符识别的标准性更强，准确率自然也更高。具体算法如下：先得到原来字符的高度和宽度，与系统已存字模的数据作比较，得出要变换的系数，然后根据得到的系数按照插值的方法映射到原图像中。</p> 
<h2><a id="5__90"></a>5 部分核心代码</h2> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">COLOR_RGB565_TO_R8</span><span class="token expression"><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span> </span><span class="token punctuation">\</span>
<span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> </span><span class="token punctuation">\</span>
<span class="token expression"><span class="token function">__typeof__</span> <span class="token punctuation">(</span>pixel<span class="token punctuation">)</span> __pixel <span class="token operator">=</span> <span class="token punctuation">(</span>pixel<span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
<span class="token expression">__pixel <span class="token operator">=</span> <span class="token punctuation">(</span>__pixel <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xF8</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
<span class="token expression">__pixel <span class="token operator">|</span> <span class="token punctuation">(</span>__pixel <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
<span class="token expression"><span class="token punctuation">}</span><span class="token punctuation">)</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">COLOR_RGB565_TO_G8</span><span class="token expression"><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span> </span><span class="token punctuation">\</span>
<span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> </span><span class="token punctuation">\</span>
 <span class="token expression"><span class="token function">__typeof__</span> <span class="token punctuation">(</span>pixel<span class="token punctuation">)</span> __pixel <span class="token operator">=</span> <span class="token punctuation">(</span>pixel<span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
    <span class="token expression">__pixel <span class="token operator">=</span> <span class="token punctuation">(</span>__pixel <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFC</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
    <span class="token expression">__pixel <span class="token operator">|</span> <span class="token punctuation">(</span>__pixel <span class="token operator">&gt;&gt;</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
<span class="token expression"><span class="token punctuation">}</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">COLOR_RGB565_TO_B8</span><span class="token expression"><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span> </span><span class="token punctuation">\</span>
<span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> </span><span class="token punctuation">\</span>
   <span class="token expression"><span class="token function">__typeof__</span> <span class="token punctuation">(</span>pixel<span class="token punctuation">)</span> __pixel <span class="token operator">=</span> <span class="token punctuation">(</span>pixel<span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
   <span class="token expression">__pixel <span class="token operator">=</span> <span class="token punctuation">(</span>__pixel <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xF8</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
   <span class="token expression">__pixel <span class="token operator">|</span> <span class="token punctuation">(</span>__pixel <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
 <span class="token expression"><span class="token punctuation">}</span><span class="token punctuation">)</span>	</span></span>
<span class="token class-name">int8_t</span> <span class="token function">imlib_rgb565_to_l</span><span class="token punctuation">(</span><span class="token class-name">uint16_t</span> pixel<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>   
<span class="token keyword">float</span> r_lin <span class="token operator">=</span> xyz_table<span class="token punctuation">[</span><span class="token function">COLOR_RGB565_TO_R8</span><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    
	<span class="token keyword">float</span> g_lin <span class="token operator">=</span> 	xyz_table<span class="token punctuation">[</span><span class="token function">COLOR_RGB565_TO_G8</span><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   
	<span class="token keyword">float</span> b_lin <span class="token operator">=</span> xyz_table<span class="token punctuation">[</span><span class="token function">COLOR_RGB565_TO_B8</span><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">float</span> y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r_lin <span class="token operator">*</span> <span class="token number">0.2126f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>g_lin <span class="token operator">*</span> <span class="token number">0.7152f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>b_lin <span class="token operator">*</span> <span class="token number">0.0722f</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.0f</span> <span class="token operator">/</span> <span class="token number">100.000f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	y <span class="token operator">=</span> <span class="token punctuation">(</span>y<span class="token operator">&gt;</span><span class="token number">0.008856f</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">fast_cbrtf</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">*</span> <span class="token number">7.787037f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.137931f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	    
	<span class="token keyword">return</span> <span class="token function">fast_floorf</span><span class="token punctuation">(</span><span class="token number">116</span> <span class="token operator">*</span> y<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
	
<span class="token class-name">int8_t</span> <span class="token function">imlib_rgb565_to_a</span><span class="token punctuation">(</span><span class="token class-name">uint16_t</span> pixel<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>  
	 <span class="token keyword">float</span> r_lin <span class="token operator">=</span> xyz_table<span class="token punctuation">[</span><span class="token function">COLOR_RGB565_TO_R8</span><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   
	 <span class="token keyword">float</span> g_lin <span class="token operator">=</span>  xyz_table<span class="token punctuation">[</span><span class="token function">COLOR_RGB565_TO_G8</span><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
	 <span class="token keyword">float</span> b_lin <span class="token operator">=</span>  xyz_table<span class="token punctuation">[</span><span class="token function">COLOR_RGB565_TO_B8</span><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	 <span class="token keyword">float</span> x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r_lin <span class="token operator">*</span> <span class="token number">0.4124f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>g_lin <span class="token operator">*</span> <span class="token number">0.3576f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>b_lin <span class="token operator">*</span> <span class="token number">0.1805f</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.0f</span> <span class="token operator">/</span> <span class="token number">095.047f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r_lin <span class="token operator">*</span> <span class="token number">0.2126f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>g_lin <span class="token operator">*</span> <span class="token number">0.7152f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>b_lin <span class="token operator">*</span> <span class="token number">0.0722f</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.0f</span> <span class="token operator">/</span> <span class="token number">100.000f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	 x <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">&gt;</span><span class="token number">0.008856f</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">fast_cbrtf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">*</span> <span class="token number">7.787037f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.137931f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    y <span class="token operator">=</span> <span class="token punctuation">(</span>y<span class="token operator">&gt;</span><span class="token number">0.008856f</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">fast_cbrtf</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">*</span> <span class="token number">7.787037f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.137931f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		
	 <span class="token keyword">return</span> <span class="token function">fast_floorf</span><span class="token punctuation">(</span><span class="token number">500</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x<span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">int8_t</span> <span class="token function">imlib_rgb565_to_b</span><span class="token punctuation">(</span><span class="token class-name">uint16_t</span> pixel<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>   
	<span class="token keyword">float</span> r_lin <span class="token operator">=</span> xyz_table<span class="token punctuation">[</span><span class="token function">COLOR_RGB565_TO_R8</span><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   
	<span class="token keyword">float</span> g_lin <span class="token operator">=</span> xyz_table<span class="token punctuation">[</span><span class="token function">COLOR_RGB565_TO_G8</span><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   
	<span class="token keyword">float</span> b_lin <span class="token operator">=</span> xyz_table<span class="token punctuation">[</span><span class="token function">COLOR_RGB565_TO_B8</span><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>				
	<span class="token keyword">float</span> y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r_lin <span class="token operator">*</span> <span class="token number">0.2126f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>g_lin <span class="token operator">*</span> <span class="token number">0.7152f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>b_lin <span class="token operator">*</span> <span class="token number">0.0722f</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.0f</span> <span class="token operator">/</span> <span class="token number">100.000f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> z <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r_lin <span class="token operator">*</span> <span class="token number">0.0193f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>g_lin <span class="token operator">*</span> <span class="token number">0.1192f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>b_lin <span class="token operator">*</span> <span class="token number">0.9505f</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.0f</span> <span class="token operator">/</span> <span class="token number">108.883f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>				
	y <span class="token operator">=</span> <span class="token punctuation">(</span>y<span class="token operator">&gt;</span><span class="token number">0.008856f</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">fast_cbrtf</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">*</span> <span class="token number">7.787037f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.137931f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    z <span class="token operator">=</span> <span class="token punctuation">(</span>z<span class="token operator">&gt;</span><span class="token number">0.008856f</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">fast_cbrtf</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">*</span> <span class="token number">7.787037f</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.137931f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>				
	<span class="token keyword">return</span> <span class="token function">fast_floorf</span><span class="token punctuation">(</span><span class="token number">200</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y<span class="token operator">-</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-c">	<span class="token keyword">unsigned</span> <span class="token keyword">short</span> xrIntFloat_16<span class="token operator">=</span><span class="token punctuation">(</span>Src_width<span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">/</span>Dst_width<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>   <span class="token comment">//扩大倍数    </span>
	<span class="token keyword">unsigned</span> <span class="token keyword">short</span> yrIntFloat_16<span class="token operator">=</span><span class="token punctuation">(</span>Src_height<span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">/</span>Dst_height<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>    
	 
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> pDstLine<span class="token operator">=</span>Dst_y8<span class="token punctuation">;</span>  
	<span class="token keyword">unsigned</span> <span class="token keyword">short</span> srcy_16<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    
	  
        <span class="token keyword">for</span> <span class="token punctuation">(</span>y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>y<span class="token operator">&lt;</span>Dst_height<span class="token punctuation">;</span><span class="token operator">++</span>y<span class="token punctuation">)</span>   
       <span class="token punctuation">{<!-- --></span>        
             <span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> pSrcLine<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>Src_y8<span class="token operator">+</span>Src_width<span class="token operator">*</span><span class="token punctuation">(</span>srcy_16<span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
             <span class="token keyword">unsigned</span> <span class="token keyword">short</span> srcx_16<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>     
             <span class="token keyword">for</span> <span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>x<span class="token operator">&lt;</span>Dst_width<span class="token punctuation">;</span><span class="token operator">++</span>x<span class="token punctuation">)</span>      
              <span class="token punctuation">{<!-- --></span>          
		pDstLine<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">=</span>pSrcLine<span class="token punctuation">[</span>srcx_16<span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>         
		srcx_16<span class="token operator">+=</span>xrIntFloat_16<span class="token punctuation">;</span>       
              <span class="token punctuation">}</span>      
               srcy_16<span class="token operator">+=</span>yrIntFloat_16<span class="token punctuation">;</span>    
               pDstLine<span class="token operator">+=</span>Dst_width<span class="token punctuation">;</span>   
      <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>模板匹配算法</strong></p> 
<pre><code class="prism language-c"><span class="token comment">/**
* @function 欧几里得距离计算，用于图片相似度计算
* @param[in] src1和src2，必须是相同大小灰度图片
* @param[out] 欧几里得距离
* @retval ERROR -1 错误
*/</span>
<span class="token keyword">float</span> <span class="token function">Euclidean_Distance</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>Src1<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>Src2<span class="token punctuation">,</span><span class="token keyword">int</span> length<span class="token punctuation">,</span><span class="token keyword">float</span> Euclideandis<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>Src1<span class="token operator">==</span><span class="token constant">NULL</span><span class="token operator">||</span>Src2<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		sum<span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>Src1<span class="token operator">-</span><span class="token operator">*</span>Src2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Src1<span class="token operator">++</span><span class="token punctuation">;</span>
		Src2<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	Euclideandis<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token function">sqrt</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> Euclideandis<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">/**
* @function 余弦相似度计算，用于图片相似度计算
* @param[in] src1和src2，必须是相同大小灰度图片
* @param[out] 余弦相似度
* @retval 0 相似度小于0
* @retval ERROR -1 错误
* @retval CosineSimilar
*/</span>
<span class="token keyword">float</span> <span class="token function">Cosine_Similarity</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>Src1<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>Src2<span class="token punctuation">,</span><span class="token keyword">int</span> length<span class="token punctuation">,</span><span class="token keyword">float</span> CosineSimilar<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>Src1<span class="token operator">==</span><span class="token constant">NULL</span><span class="token operator">||</span>Src2<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>sum1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>sum2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">float</span> temp0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>temp1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	
		sum<span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>Src1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>Src2<span class="token punctuation">)</span><span class="token punctuation">;</span>
		sum1<span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>Src1<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		sum2<span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>Src2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Src1<span class="token operator">++</span><span class="token punctuation">;</span>
		Src2<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>sum<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	temp0<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">sqrt</span><span class="token punctuation">(</span>sum1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	temp1<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">sqrt</span><span class="token punctuation">(</span>sum2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	CosineSimilar<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token operator">/</span>temp0<span class="token punctuation">)</span><span class="token operator">/</span>temp1<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> CosineSimilar<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">/**
* @function 皮尔逊相似度计算，用于图片相似度计算
* @param[in] src1和src2，必须是相同大小灰度图片
* @param[out] 皮尔逊相似度
* @retval ERROR -1 错误
* @par 2021年5月28日 zhengmf
*/</span>
<span class="token keyword">float</span> <span class="token function">Pearson_Correlation</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>Src1<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>Src2<span class="token punctuation">,</span><span class="token keyword">int</span> length<span class="token punctuation">,</span><span class="token keyword">float</span> PearsonSimilar<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>Src1<span class="token operator">==</span><span class="token constant">NULL</span><span class="token operator">||</span>Src2<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> aver1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>aver2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>sum1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>sum2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">float</span> temp0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>temp1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		sum1<span class="token operator">+=</span><span class="token operator">*</span>Src1<span class="token punctuation">;</span>
		sum2<span class="token operator">+=</span><span class="token operator">*</span>Src2<span class="token punctuation">;</span>
		Src1<span class="token operator">++</span><span class="token punctuation">;</span>
		Src2<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	aver1<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sum1<span class="token operator">/</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
	aver2<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sum2<span class="token operator">/</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
	sum1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	sum2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		sum<span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>Src1<span class="token operator">-</span>aver1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>Src2<span class="token operator">-</span>aver2<span class="token punctuation">)</span><span class="token punctuation">;</span>
		sum1<span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>Src1<span class="token operator">-</span>aver1<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		sum2<span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>Src2<span class="token operator">-</span>aver2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Src1<span class="token operator">++</span><span class="token punctuation">;</span>
		Src2<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>sum<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	temp0<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">sqrt</span><span class="token punctuation">(</span>sum1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	temp1<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">sqrt</span><span class="token punctuation">(</span>sum2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	PearsonSimilar<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token operator">/</span>temp0<span class="token punctuation">)</span><span class="token operator">/</span>temp1<span class="token punctuation">)</span><span class="token punctuation">;</span>		
	<span class="token keyword">return</span> PearsonSimilar<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<br> 
<h2><a id="6__288"></a>6 最后</h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c36fc5a9ced0bde843dbd1a8687feca9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">利用注解和反射处理方法级别的逻辑</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0e553bec1bc2fe77ffb86f88afe27f88/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">大翻车！斯坦福超火机器人自曝内幕，研究者救场还受伤了，网友：放心了</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>