<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>视觉学习笔记4——学习研究ORB-SLAM3 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="视觉学习笔记4——学习研究ORB-SLAM3" />
<meta property="og:description" content="文章目录 一、ORB-SLAM3是什么？二、配置安装ORB-SLAM31.运行环境2.配置Pangolin环境3.配置opencv 环境4.配置Eigen3环境4.配置boost环境4.配置DBoW2 和 g2o环境5.安装编译OBR-SLAM3 1.0版本6.安装编译ROS 三、OBR-SLAM3与ROS调试1.使用ROS usb_cam调用USB摄像头2.初试ORB-SLAM3 1.0版本3.转战OBR-SLAM3 0.3版本4.ORB-SLAM3 0.3版本运行单目USB摄像头5.再战ORB-SLAM3 1.0版本6.ORB-SLAM3 1.0版本运行单目USB摄像头7.ORB-SLAM3 1.0版本运行双目摄像头8.双目参数标定 一、ORB-SLAM3是什么？ ORB-SLAM3是第一个能够让单目、立体和RGB-D相机和针孔和鱼眼镜头模型解耦进行视觉、视觉惯性和多地图SLAM的系统。第一个主要的创新是一个基于特征的紧密集成视觉惯性SLAM系统，它完全依赖于最大后验概率（MAP）估计，甚至在IMU初始化阶段也是如此。第二个主要的创新是一个多地图系统，它依赖于一种新的位置识别方法和改进的召回。多亏了它，ORB-SLAM3能够在长时间的不良视觉信息下生存：当它丢失时，它会启动一个新的地图，当重新访问地图区域时，它将与以前的地图无缝地合并。与只使用最后几秒信息的视觉里程计系统相比，ORB-SLAM3也是第一个能够在所有算法阶段重用所有先前信息的系统。这允许在BA优化中使用历史的共视关键帧，即使这些关键帧来自很久以前的地图或者不同子图。该系统在小型和大型，室内和室外环境中都能稳定地运行，并且比以前的方法精确2到5倍。
开源地址
论文地址
二、配置安装ORB-SLAM3 1.运行环境 i7GTX 1660 TIubuntu18.04 2.配置Pangolin环境 查看ORB-SLAM3的项目要求，要求安装Pangolin 1. 安装Pangolin所需要的依赖
查了一下其他大佬的方法
终端逐条运行以下命令：
sudo apt install libgl1-mesa-dev
sudo apt install libglew-dev CMake
sudo apt install cmake
sudo apt install libpython2.7-dev
sudo apt install pkg-config
sudo apt install libegl1-mesa-dev libwayland-dev libxkbcommon-dev wayland-protocols
sudo apt-get install cmake libeigen3-dev libsuitesparse-dev qtdeclarative5-dev qt5-qmake libqglviewer-dev
sudo apt-get install libboost-dev" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/7fb9b3155521f0d734e82fce4e7d6630/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-04T16:17:29+08:00" />
<meta property="article:modified_time" content="2023-03-04T16:17:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">视觉学习笔记4——学习研究ORB-SLAM3</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#ORBSLAM3_1" rel="nofollow">一、ORB-SLAM3是什么？</a></li><li><a href="#ORBSLAM3_8" rel="nofollow">二、配置安装ORB-SLAM3</a></li><li><ul><li><a href="#1_10" rel="nofollow">1.运行环境</a></li><li><a href="#2Pangolin_15" rel="nofollow">2.配置Pangolin环境</a></li><li><a href="#3opencv__63" rel="nofollow">3.配置opencv 环境</a></li><li><a href="#4Eigen3_67" rel="nofollow">4.配置Eigen3环境</a></li><li><a href="#4boost_75" rel="nofollow">4.配置boost环境</a></li><li><a href="#4DBoW2__g2o_134" rel="nofollow">4.配置DBoW2 和 g2o环境</a></li><li><a href="#5OBRSLAM3_10_146" rel="nofollow">5.安装编译OBR-SLAM3 1.0版本</a></li><li><a href="#6ROS_198" rel="nofollow">6.安装编译ROS</a></li></ul> 
  </li><li><a href="#OBRSLAM3ROS_203" rel="nofollow">三、OBR-SLAM3与ROS调试</a></li><li><ul><li><a href="#1ROS_usb_camUSB_204" rel="nofollow">1.使用ROS usb_cam调用USB摄像头</a></li><li><a href="#2ORBSLAM3_10_256" rel="nofollow">2.初试ORB-SLAM3 1.0版本</a></li><li><a href="#3OBRSLAM3_03_410" rel="nofollow">3.转战OBR-SLAM3 0.3版本</a></li><li><a href="#4ORBSLAM3_03USB_489" rel="nofollow">4.ORB-SLAM3 0.3版本运行单目USB摄像头</a></li><li><a href="#5ORBSLAM3_10_497" rel="nofollow">5.再战ORB-SLAM3 1.0版本</a></li><li><a href="#6ORBSLAM3_10USB_562" rel="nofollow">6.ORB-SLAM3 1.0版本运行单目USB摄像头</a></li><li><a href="#7ORBSLAM3_10_583" rel="nofollow">7.ORB-SLAM3 1.0版本运行双目摄像头</a></li><li><a href="#8_692" rel="nofollow">8.双目参数标定</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="ORBSLAM3_1"></a>一、ORB-SLAM3是什么？</h2> 
<hr> 
<p>ORB-SLAM3是第一个能够让单目、立体和RGB-D相机和针孔和鱼眼镜头模型解耦进行视觉、视觉惯性和多地图SLAM的系统。第一个主要的创新是一个基于特征的紧密集成视觉惯性SLAM系统，它完全依赖于最大后验概率（MAP）估计，甚至在IMU初始化阶段也是如此。第二个主要的创新是一个多地图系统，它依赖于一种新的位置识别方法和改进的召回。多亏了它，ORB-SLAM3能够在长时间的不良视觉信息下生存：当它丢失时，它会启动一个新的地图，当重新访问地图区域时，它将与以前的地图无缝地合并。与只使用最后几秒信息的视觉里程计系统相比，ORB-SLAM3也是第一个能够在所有算法阶段重用所有先前信息的系统。这允许在BA优化中使用历史的共视关键帧，即使这些关键帧来自很久以前的地图或者不同子图。该系统在小型和大型，室内和室外环境中都能稳定地运行，并且比以前的方法精确2到5倍。<br> <a href="https://github.com/UZ-SLAMLab/ORB_SLAM3">开源地址</a><br> <a href="https://arxiv.org/pdf/2007.11898.pdf" rel="nofollow">论文地址</a></p> 
<hr> 
<h2><a id="ORBSLAM3_8"></a>二、配置安装ORB-SLAM3</h2> 
<h3><a id="1_10"></a>1.运行环境</h3> 
<ol><li>i7</li><li>GTX 1660 TI</li><li>ubuntu18.04</li></ol> 
<h3><a id="2Pangolin_15"></a>2.配置Pangolin环境</h3> 
<p>查看ORB-SLAM3的项目要求，要求安装<a href="https://github.com/stevenlovegrove/Pangolin">Pangolin </a></p> 
<p><strong>1. 安装Pangolin所需要的依赖</strong><br> 查了一下其他大佬的<a href="https://blog.csdn.net/weixin_44228131/article/details/122316118?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164714350816780271580709%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=164714350816780271580709&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~times_rank-1-122316118.first_rank_v2_pc_rank_v29_v2&amp;utm_term=orb-slam3%E5%AE%89%E8%A3%85&amp;spm=1018.2226.3001.4187">方法</a></p> 
<p>终端逐条运行以下命令：</p> 
<blockquote> 
 <p>sudo apt install libgl1-mesa-dev<br> sudo apt install libglew-dev CMake<br> sudo apt install cmake<br> sudo apt install libpython2.7-dev<br> sudo apt install pkg-config<br> sudo apt install libegl1-mesa-dev libwayland-dev libxkbcommon-dev wayland-protocols<br> sudo apt-get install cmake libeigen3-dev libsuitesparse-dev qtdeclarative5-dev qt5-qmake libqglviewer-dev<br> sudo apt-get install libboost-dev</p> 
</blockquote> 
<p><strong>2. 编译安装Pangolin</strong><br> 终端逐条运行以下命令：</p> 
<pre><code class="prism language-rust">cd <span class="token class-name">Pangolin</span>
mkdir build
cd build
cmake <span class="token punctuation">..</span>
cmake <span class="token operator">-</span><span class="token operator">-</span>build <span class="token punctuation">.</span>
</code></pre> 
<p><strong>但是编译出现以下问题</strong><br> <img src="https://images2.imgbox.com/7a/1e/apWKBEV5_o.png" alt="在这里插入图片描述"><br> 大概意思是有的包配置文件没找到，或者干脆没安装，于是按照Pangolin的sh配置文件再安装一次。<br> 终端cd到Pangolin文件夹下，执行以下命令：</p> 
<blockquote> 
 <p>./scripts/install_prerequisites.sh recommended</p> 
</blockquote> 
<p>然后重复之前的命令：</p> 
<pre><code class="prism language-rust">cd <span class="token class-name">Pangolin</span>
mkdir build
cd build
cmake <span class="token punctuation">..</span>
cmake <span class="token operator">-</span><span class="token operator">-</span>build <span class="token punctuation">.</span>
sudo make install
</code></pre> 
<p>最终编译成功，会默认安装在/usr/local/include/pangolin</p> 
<h3><a id="3opencv__63"></a>3.配置opencv 环境</h3> 
<p>OBR官方提示OpenCV(要求&gt;3.0)<br> 关于怎么安装可以参考我这篇<a href="https://blog.csdn.net/qq_45848817/article/details/117987514">博客</a>。</p> 
<h3><a id="4Eigen3_67"></a>4.配置Eigen3环境</h3> 
<p>基于很多博客说建议源码安装，决定跟着大队走<br> 其实前面已经有安装了，但是以防万一</p> 
<blockquote> 
 <p>sudo apt-get install libeigen3-dev<br> sudo updatedb #创建或更新 slocate/locate 命令所必需的数据库文件<br> locate eigen3 #查看位置，我的是安装在了/usr/include</p> 
</blockquote> 
<h3><a id="4boost_75"></a>4.配置boost环境</h3> 
<p>ubuntu18.04 下默认boost版本 1.65.0，就算不进行到命令行安装ros也会自动安装，随意吧。</p> 
<blockquote> 
 <p>sudo apt-get install libboost-system-dev</p> 
</blockquote> 
<p><strong>更新：手动源码安装无法嵌入ros中，安装ros时还会再次命令行安装boost1.65版本，所以不需要手动安装，而且多版本boost存在有时会导致冲突。以下boost1.70步骤不需要进行，只做记录。</strong></p> 
<p>（1）下载boost库，我使用的是<a href="https://boostorg.jfrog.io/artifactory/main/release/1.70.0/source/boost_1_70_0.tar.bz2" rel="nofollow">1.7.0 </a>版本<br> （2）进入到该目录，解压到自己想放的位置<br> （3）之后通过终端进入boost目录执行命令</p> 
<blockquote> 
 <p>cd boost<br> sudo ./bootstrap.sh</p> 
</blockquote> 
<p>bootstrap.sh会产生bjam和b2两个工具，继续执行</p> 
<blockquote> 
 <p>sudo ./b2 install</p> 
</blockquote> 
<p>这个时候你的/usr/local/include下会产生boost的头文件，/usr/local/lib下面会产生boost库<br> （4）切换到profile.d目录下，使用超级用户创建文件boost.sh</p> 
<blockquote> 
 <p>cd /etc/profile.d<br> sudo touch boost.sh<br> sudo vim boost.sh</p> 
</blockquote> 
<p>在里面添加如下内容</p> 
<blockquote> 
 <p>#!/bin/sh<br> BOOST_ROOT=（boost的解压路径)<br> BOOST_INCLUDE=/usr/local/include/boost<br> BOOST_LIB=/usr/local/lib<br> export BOOST_INCLUDE BOOST_LIB BOOST_ROOT</p> 
</blockquote> 
<p>修改boost.sh的权限 ，执行 boost.sh</p> 
<blockquote> 
 <p>sudo chmod +x boost.sh<br> source /etc/profile.d/boost.sh</p> 
</blockquote> 
<p>卸载源码安装boost：</p> 
<pre><code class="prism language-rust">sudo rm <span class="token operator">-</span>rf <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>include<span class="token operator">/</span>boost
sudo rm <span class="token operator">-</span>rf <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>lib<span class="token operator">/</span>libboost<span class="token operator">*</span>
sudo rm <span class="token operator">-</span>rf <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>lib<span class="token operator">/</span>cmake<span class="token operator">/</span><span class="token operator">*</span><span class="token number">1.70</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token operator">*</span>
</code></pre> 
<p>卸载命令行安装boost:</p> 
<pre><code class="prism language-rust">要注意会同时把ros一起卸载掉
sudo apt<span class="token operator">-</span>get autoremove libboost1<span class="token number">.65</span><span class="token operator">-</span>dev
</code></pre> 
<p>查询版本</p> 
<pre><code class="prism language-rust"> dpkg <span class="token operator">-</span>l <span class="token operator">|</span> grep boost1<span class="token punctuation">.</span><span class="token constant">XX</span>
</code></pre> 
<h3><a id="4DBoW2__g2o_134"></a>4.配置DBoW2 和 g2o环境</h3> 
<p>按照OBR官方提示：</p> 
<blockquote> 
 <p>我们使用DBoW2库的修改版本来执行地点识别和g2o库来执行非线性优化。两个修改后的库（BSD）都包含在第三方文件夹中。</p> 
</blockquote> 
<p>意思应该是OBR包里包含了，不需要另外安装。<br> 不过需要安装依赖：</p> 
<blockquote> 
 <p>sudo apt-get install libcanberra-gtk-module<br> sudo apt-get install libssl-dev</p> 
</blockquote> 
<h3><a id="5OBRSLAM3_10_146"></a>5.安装编译OBR-SLAM3 1.0版本</h3> 
<p>进入SLAM文件夹，运行以下命令：</p> 
<blockquote> 
 <p>cd ORB-SLAM3/<br> chmod +x build.sh<br> sudo ./build.sh</p> 
</blockquote> 
<p>建议把build.sh中的指令逐条进行，这样就可以具体知道是哪个部分出问题了。<br> <strong>build.sh中的内容如下：</strong></p> 
<pre><code class="prism language-rust">echo <span class="token string">"Configuring and building Thirdparty/DBoW2 ..."</span>

cd <span class="token class-name">Thirdparty</span><span class="token operator">/</span><span class="token class-name">DBoW2</span>
mkdir build
cd build
cmake <span class="token punctuation">..</span> <span class="token operator">-</span><span class="token constant">DCMAKE_BUILD_TYPE</span><span class="token operator">=</span><span class="token class-name">Release</span>
make <span class="token operator">-</span>j

cd <span class="token punctuation">..</span><span class="token operator">/</span><span class="token punctuation">..</span><span class="token operator">/</span>g2o

echo <span class="token string">"Configuring and building Thirdparty/g2o ..."</span>

mkdir build
cd build
cmake <span class="token punctuation">..</span> <span class="token operator">-</span><span class="token constant">DCMAKE_BUILD_TYPE</span><span class="token operator">=</span><span class="token class-name">Release</span>
make <span class="token operator">-</span>j

cd <span class="token punctuation">..</span><span class="token operator">/</span><span class="token punctuation">..</span><span class="token operator">/</span><span class="token punctuation">..</span><span class="token operator">/</span>

echo <span class="token string">"Uncompress vocabulary ..."</span>

cd <span class="token class-name">Vocabulary</span>
tar <span class="token operator">-</span>xf <span class="token class-name">ORBvoc</span><span class="token punctuation">.</span>txt<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz
cd <span class="token punctuation">..</span>

echo <span class="token string">"Configuring and building ORB_SLAM3 ..."</span>

mkdir build
cd build
cmake <span class="token punctuation">..</span> <span class="token operator">-</span><span class="token constant">DCMAKE_BUILD_TYPE</span><span class="token operator">=</span><span class="token class-name">Release</span>
make <span class="token operator">-</span>j
</code></pre> 
<p><strong>出现报错：</strong></p> 
<p><img src="https://images2.imgbox.com/36/86/p6zoiow0_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/cc/9c/wrl1N1QI_o.png" alt="在这里插入图片描述"><br> 找了很多资料，借鉴这个<a href="https://blog.csdn.net/xiaoren886/article/details/123413342?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164717493016780265464419%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=164717493016780265464419&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~times_rank-7-123413342.first_rank_v2_pc_rank_v29_v2&amp;utm_term=/usr/bin/ld:%20%E6%89%BE%E4%B8%8D%E5%88%B0%20-lboost_serialization&amp;spm=1018.2226.3001.4187">博客</a><br> 确定是boost的问题，具体解决可以看上面的方法。<br> 解决后删掉ORB-SLAM3下的bulid文件夹，重新编译，建议把build.sh中的指令逐条进行，这样就可以具体知道是哪个部分出问题了。</p> 
<h3><a id="6ROS_198"></a>6.安装编译ROS</h3> 
<p>不同的Unbutn安装的Ros版本不同。Ubuntu18.04对应的ros版本为<strong>ROS Melodic</strong><br> <img src="https://images2.imgbox.com/a5/b3/Cj22TR6V_o.png" alt="在这里插入图片描述"></p> 
<p>因为ROS挺多教程的，我参考这篇<a href="https://blog.csdn.net/KIK9973/article/details/118755045?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164722886416780261979841%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=164722886416780261979841&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~times_rank-4-118755045.first_rank_v2_pc_rank_v29_v2&amp;utm_term=ros%E5%AE%89%E8%A3%85%2018&amp;spm=1018.2226.3001.4187"> 博客</a>。我遇到的所有问题他都给出解决方案实在良心，所以我就不专门写出具体的过程 ，直接套娃。</p> 
<h2><a id="OBRSLAM3ROS_203"></a>三、OBR-SLAM3与ROS调试</h2> 
<h3><a id="1ROS_usb_camUSB_204"></a>1.使用ROS usb_cam调用USB摄像头</h3> 
<p>先创建文件夹，具体位置可以自己选择</p> 
<blockquote> 
 <p>mkdir -p catkin_ws/src<br> cd catkin_ws/src</p> 
</blockquote> 
<p>然后下载usb_cam文件，可以终端下载也可以手动github或gitee下载</p> 
<blockquote> 
 <p>git clone https://github.com/ros-drivers/usb_cam.git</p> 
</blockquote> 
<p>但是要注意先确定你的usb摄像头的编号和修改launch文件，不然要么会调用到默认摄像头要么报错。<br> 查看接入的USB摄像头的设备号</p> 
<blockquote> 
 <p>ls /dev/video*</p> 
</blockquote> 
<p>修改catkin_ws/src/usb_cam/launch/usb_cam-test.launch里面的参数，默认是/dev/video0</p> 
<blockquote> 
 <p>param name=“video_device” value=“/dev/video0”</p> 
</blockquote> 
<p>修改后，终端<strong>回退到catkin_ws</strong>，编译usb_cam文件，</p> 
<pre><code class="prism language-rust">cd <span class="token punctuation">..</span><span class="token operator">/</span><span class="token punctuation">..</span><span class="token operator">/</span><span class="token punctuation">..</span><span class="token operator">/</span>
catkin_make
</code></pre> 
<p><strong>编译失败1：</strong></p> 
<blockquote> 
 <p>ERROR: cannot launch node of type [usb_cam/usb_cam_node]: usb_cam</p> 
</blockquote> 
<p><strong>解决1：</strong><br> 需要在终端./catkin_ws中打开以下目录 并键入以下命令</p> 
<blockquote> 
 <p>source devel/setup.bash</p> 
</blockquote> 
<p>安装依赖</p> 
<blockquote> 
 <p>sudo apt install ros-melodic-uvc-camera</p> 
 <p>sudo apt install ros-melodic-image-view</p> 
 <p>sudo apt install ros-melodic-usb-cam</p> 
</blockquote> 
<p>进入catkin_ws/src/usb_cam/launch文件夹打开终端，运行命令：</p> 
<blockquote> 
 <p>roslaunch usb_cam-test.launch</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/ea/0b/QwIxqzFj_o.png" alt="在这里插入图片描述"><br> <strong>记得去对自己的USB相机进行标定，有关资料不在此列出！！！！</strong></p> 
<hr> 
<h3><a id="2ORBSLAM3_10_256"></a>2.初试ORB-SLAM3 1.0版本</h3> 
<pre><code class="prism language-rust">方法一、直接安装<span class="token punctuation">.</span>sh命令：
cd <span class="token constant">ORB</span><span class="token operator">-</span><span class="token constant">SLAM3</span><span class="token operator">/</span> 
chmod <span class="token operator">+</span>x build<span class="token punctuation">.</span>sh 
 sudo <span class="token punctuation">.</span><span class="token operator">/</span>build<span class="token punctuation">.</span>sh
 
 
方法二、 进入build<span class="token punctuation">.</span>sh间接安装：
echo <span class="token string">"Configuring and building Thirdparty/DBoW2 ..."</span>

cd <span class="token class-name">Thirdparty</span><span class="token operator">/</span><span class="token class-name">DBoW2</span>
mkdir build
cd build
cmake <span class="token punctuation">..</span> <span class="token operator">-</span><span class="token constant">DCMAKE_BUILD_TYPE</span><span class="token operator">=</span><span class="token class-name">Release</span>
make <span class="token operator">-</span>j

cd <span class="token punctuation">..</span><span class="token operator">/</span><span class="token punctuation">..</span><span class="token operator">/</span>g2o

echo <span class="token string">"Configuring and building Thirdparty/g2o ..."</span>

mkdir build
cd build
cmake <span class="token punctuation">..</span> <span class="token operator">-</span><span class="token constant">DCMAKE_BUILD_TYPE</span><span class="token operator">=</span><span class="token class-name">Release</span>
make <span class="token operator">-</span>j

cd <span class="token punctuation">..</span><span class="token operator">/</span><span class="token punctuation">..</span><span class="token operator">/</span><span class="token punctuation">..</span><span class="token operator">/</span>

echo <span class="token string">"Uncompress vocabulary ..."</span>

cd <span class="token class-name">Vocabulary</span>
tar <span class="token operator">-</span>xf <span class="token class-name">ORBvoc</span><span class="token punctuation">.</span>txt<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz
cd <span class="token punctuation">..</span>

echo <span class="token string">"Configuring and building ORB_SLAM3 ..."</span>

mkdir build
cd build
cmake <span class="token punctuation">..</span> <span class="token operator">-</span><span class="token constant">DCMAKE_BUILD_TYPE</span><span class="token operator">=</span><span class="token class-name">Release</span>
make <span class="token operator">-</span>j


编译ros环境：
cd <span class="token punctuation">..</span>
<span class="token punctuation">.</span><span class="token operator">/</span>build_ros<span class="token punctuation">.</span>sh
</code></pre> 
<p><strong>报错1：</strong></p> 
<blockquote> 
 <p>No module named ‘rospkg’</p> 
</blockquote> 
<p><strong>解决方法：</strong></p> 
<pre><code class="prism language-rust">虚拟环境 <span class="token punctuation">(</span>虚拟环境名<span class="token punctuation">)</span>
conda activate 虚拟环境名   #进入虚拟环境
conda install pip    # 这里是让conda用虚拟环境里的 pip 确保 rospkg 装在该环境
pip install rospkg

非虚拟环境下 <span class="token punctuation">(</span>base<span class="token punctuation">)</span>
pip install rospkg
</code></pre> 
<p><strong>报错2：</strong><br> <img src="https://images2.imgbox.com/8c/30/VUC0HJrk_o.png" alt=""><br> <strong>解决方法：</strong></p> 
<p>尝试了各种修改路径的方法，仍然是提示报错，但是gedit ~/.bashrc路径明明是添加进去了…</p> 
<pre><code class="prism language-rust">gedit ~<span class="token operator">/</span><span class="token punctuation">.</span>bashrc 
export <span class="token constant">ROS_PACKAGE_PATH</span><span class="token operator">=</span>$<span class="token punctuation">{<!-- --></span><span class="token constant">ROS_PACKAGE_PATH</span><span class="token punctuation">}</span><span class="token punctuation">:</span><span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">/</span><span class="token class-name">Examples</span><span class="token operator">/</span><span class="token constant">ROS</span>
source ~<span class="token operator">/</span><span class="token punctuation">.</span>bashrc 
</code></pre> 
<p>后来发现是Examples和Examples_old文件问题<br> 首先感谢这篇<a href="https://blog.csdn.net/zhh2005757/article/details/122353772?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164731311916780255215980%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=164731311916780255215980&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~times_rank-10-122353772.142%5Ev2%5Epc_search_result_cache,143%5Ev4%5Econtrol&amp;utm_term=examples%E5%92%8Cexamples_old&amp;spm=1018.2226.3001.4187">博客的博主</a>，特别是这几天github有进不去了，以及感谢github问题区的<a href="https://hub.fastgit.org/UZ-SLAMLab/ORB_SLAM3/issues/442" rel="nofollow">解决者 </a><br> 其实解决这个问题需要先进行另一个步骤：<br> 因为我现在编译的是ORB_SLAM1.0版本，这个版本有一个不同，就是区分Examples和Examples_old文件，我们需要的一些文件是在Examples_old文件中，需要先建立软链接：</p> 
<pre><code class="prism language-rust"><span class="token number">1</span>、在<span class="token class-name">Examples</span>中新建文件夹<span class="token constant">ROS</span>，进入<span class="token constant">ROS</span>文件夹终端
<span class="token number">2</span>、sudo ln <span class="token operator">-</span>s <span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">/</span><span class="token class-name">Examples_old</span><span class="token operator">/</span><span class="token constant">ROS</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span> <span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">/</span><span class="token class-name">Examples</span><span class="token operator">/</span><span class="token constant">ROS</span>
<span class="token number">3</span>、<span class="token punctuation">.</span><span class="token operator">/</span>build<span class="token punctuation">.</span>sh
</code></pre> 
<p><img src="https://images2.imgbox.com/ec/a3/9UoIW6Sy_o.png" alt="在这里插入图片描述"><br> <strong>不间断运行 <code>./build_ros.sh</code>，会持续出现以下问题：</strong></p> 
<p><strong>问题1：</strong></p> 
<p><img src="https://images2.imgbox.com/cf/69/7As2mskU_o.png" alt="在这里插入图片描述"><br> 提示找不到sophus库，修改Examples/ROS/ORB_SLAM3下的CMAKELISTS中添加修改为</p> 
<pre><code class="prism language-bash"><span class="token variable">${PROJECT_SOURCE_DIR}</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/Thirdparty/Sophus
</code></pre> 
<p><strong>问题2：</strong><br> <img src="https://images2.imgbox.com/83/6a/rm8VMkZX_o.png" alt="在这里插入图片描述"></p> 
<p>解决 cv::Mat Tcw = mpSLAM-&gt;TrackMonocular(cv_ptr-&gt;image,cv_ptr-&gt;header.stamp.toSec()); 报错</p> 
<blockquote> 
 <p>#include &lt;Eigen/Dense&gt;<br> #include &lt;opencv2/core/eigen.hpp&gt;</p> 
</blockquote> 
<p>引入上述两个头文件，然后删除ROS/ORB_SLAM3/src/AR/ros_mono_ar.cc第151行，由下面内容替换</p> 
<pre><code class="prism language-rust"><span class="token namespace">cv<span class="token punctuation">::</span></span><span class="token class-name">Mat</span> <span class="token class-name">Tcw</span><span class="token punctuation">;</span>
<span class="token class-name">Sophus</span><span class="token punctuation">::</span><span class="token class-name">SE3f</span> <span class="token class-name">Tcw_SE3f</span> <span class="token operator">=</span> mpSLAM<span class="token punctuation">-&gt;</span><span class="token class-name">TrackMonocular</span><span class="token punctuation">(</span>cv_ptr<span class="token punctuation">-&gt;</span>image<span class="token punctuation">,</span>cv_ptr<span class="token punctuation">-&gt;</span>header<span class="token punctuation">.</span>stamp<span class="token punctuation">.</span><span class="token function">toSec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Eigen</span><span class="token punctuation">::</span><span class="token class-name">Matrix4f</span> <span class="token class-name">Tcw_Matrix</span> <span class="token operator">=</span> <span class="token class-name">Tcw_SE3f</span><span class="token punctuation">.</span><span class="token function">matrix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token namespace">cv<span class="token punctuation">::</span></span><span class="token function">eigen2cv</span><span class="token punctuation">(</span><span class="token class-name">Tcw_Matrix</span><span class="token punctuation">,</span> <span class="token class-name">Tcw</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>问题3：</strong><br> <img src="https://images2.imgbox.com/63/e2/V2W8oZjl_o.png" alt="在这里插入图片描述"><br> 解决 cv::Mat Xw = pMP-&gt;GetWorldPos();报错<br> 引入上述两个头文件，然后删除ROS/ORB_SLAM3/src/AR/ViewerAR.cc第530行，由以下内容替换</p> 
<pre><code class="prism language-rust"><span class="token namespace">cv<span class="token punctuation">::</span></span><span class="token class-name">Mat</span> <span class="token class-name">Xw</span><span class="token punctuation">;</span>
<span class="token namespace">cv<span class="token punctuation">::</span></span><span class="token function">eigen2cv</span><span class="token punctuation">(</span>pMP<span class="token punctuation">-&gt;</span><span class="token class-name">GetWorldPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Xw</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>问题4：</strong><br> <img src="https://images2.imgbox.com/2e/b4/YPUt6F4C_o.png" alt="在这里插入图片描述"><br> cv中的eigen2cv问题，建议在每个修改文件的顶部包含以下文件头文件：</p> 
<pre><code class="prism language-rust">#include <span class="token operator">&lt;</span><span class="token class-name">Eigen</span><span class="token operator">/</span><span class="token class-name">Dense</span><span class="token operator">&gt;</span>
#include <span class="token operator">&lt;</span>opencv2<span class="token operator">/</span>core<span class="token operator">/</span>eigen<span class="token punctuation">.</span>hpp<span class="token operator">&gt;</span>
</code></pre> 
<p><strong>再编译，没有其他问题的话正常编译通过。</strong></p> 
<p><strong>报错3：</strong></p> 
<p><img src="https://images2.imgbox.com/45/13/okMNFlBZ_o.png" alt="在这里插入图片描述"><br> <strong>解决方法：</strong><br> 没有解决的头绪，借鉴了挺多博客，总结了一下可能存在的问题：</p> 
<ol><li>EIGEN版本问题</li><li>Pangolin的版本问题</li><li>CMAKELISTS中-march=native矩阵问题</li><li>cv_bridge版本问题</li><li>ROS的opencv3.2与本机opencv4.4冲突问题<br> 尝试了近一个星期，这些问题解决方法并没有给我解决问题的根源。<br> 后来迫不得已去更换orb-slam3 Tags中的v0.3版本重新编译。<br> <img src="https://images2.imgbox.com/ea/35/5IC2BHS2_o.png" alt="在这里插入图片描述"></li></ol> 
<hr> 
<h3><a id="3OBRSLAM3_03_410"></a>3.转战OBR-SLAM3 0.3版本</h3> 
<p>与前面的1.0的步骤差不多，细节看前面：</p> 
<pre><code class="prism language-rust">echo <span class="token string">"Configuring and building Thirdparty/DBoW2 ..."</span>

cd <span class="token class-name">Thirdparty</span><span class="token operator">/</span><span class="token class-name">DBoW2</span>
mkdir build
cd build
cmake <span class="token punctuation">..</span> <span class="token operator">-</span><span class="token constant">DCMAKE_BUILD_TYPE</span><span class="token operator">=</span><span class="token class-name">Release</span>
make <span class="token operator">-</span>j

cd <span class="token punctuation">..</span><span class="token operator">/</span><span class="token punctuation">..</span><span class="token operator">/</span>g2o

echo <span class="token string">"Configuring and building Thirdparty/g2o ..."</span>

mkdir build
cd build
cmake <span class="token punctuation">..</span> <span class="token operator">-</span><span class="token constant">DCMAKE_BUILD_TYPE</span><span class="token operator">=</span><span class="token class-name">Release</span>
make <span class="token operator">-</span>j

cd <span class="token punctuation">..</span><span class="token operator">/</span><span class="token punctuation">..</span><span class="token operator">/</span><span class="token punctuation">..</span><span class="token operator">/</span>

echo <span class="token string">"Uncompress vocabulary ..."</span>

cd <span class="token class-name">Vocabulary</span>
tar <span class="token operator">-</span>xf <span class="token class-name">ORBvoc</span><span class="token punctuation">.</span>txt<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz
cd <span class="token punctuation">..</span>

echo <span class="token string">"Configuring and building ORB_SLAM3 ..."</span>

mkdir build
cd build
cmake <span class="token punctuation">..</span> <span class="token operator">-</span><span class="token constant">DCMAKE_BUILD_TYPE</span><span class="token operator">=</span><span class="token class-name">Release</span>
make <span class="token operator">-</span>j


cd <span class="token punctuation">..</span>
<span class="token punctuation">.</span><span class="token operator">/</span>build_ros<span class="token punctuation">.</span>sh
</code></pre> 
<p>到这里和上面的安装编译是大同小异，如果只是这样直接尝试启动单目的话依然是失败的</p> 
<pre><code class="prism language-rust">#第一个窗口启动<span class="token constant">ROS</span>服务
roscore
#第二个窗口启动usb摄像头节点
roslaunch usb_cam<span class="token operator">-</span>test<span class="token punctuation">.</span>launch
#第三个窗口启动<span class="token constant">SLAM3</span>
rosrun <span class="token constant">ORB_SLAM3</span> <span class="token class-name">Mono</span> <span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">/</span><span class="token class-name">Vocabulary</span><span class="token operator">/</span><span class="token class-name">ORBvoc</span><span class="token punctuation">.</span>txt <span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">/</span><span class="token class-name">Examples</span><span class="token operator">/</span><span class="token constant">ROS</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">/</span><span class="token class-name">Asus</span><span class="token punctuation">.</span>yaml
</code></pre> 
<p><strong>报错1：</strong><br> Map Viewer空白， Current Frame没有图像画面。<br> <img src="https://images2.imgbox.com/ef/89/8CSacotS_o.png" alt="在这里插入图片描述"><br> <strong>解决方法：</strong><br> 以下方法有一些可能有用，有一些没有用，请根据自己请况进行修改：</p> 
<p>1、cv_bridge编译修改opencv版本（不一定有用），因为在编译./builde_ros时出现警告，提示我opencv版本不对应问题，主要是两种方法，已修改现有的和下载新版本，建议没得办法时尝试，有关资料不在这里列出。</p> 
<p>2、先到/opt/ros/melodic/share目录下，删除原来的ORB_SLAM3软连接（如果有的话）</p> 
<pre><code class="prism language-rust">sudo rm <span class="token operator">-</span>r <span class="token constant">ORB_SLAM3</span>
</code></pre> 
<p>在/opt/ros/melodic/share目录下建立软链接</p> 
<pre><code class="prism language-rust">sudo ln <span class="token operator">-</span>s <span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">/</span><span class="token class-name">Examples</span><span class="token operator">/</span><span class="token constant">ROS</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span> <span class="token operator">/</span>opt<span class="token operator">/</span>ros<span class="token operator">/</span>melodic<span class="token operator">/</span>share<span class="token operator">/</span><span class="token constant">ORB_SLAM3</span>
</code></pre> 
<p><strong>重新编译./builde_ros</strong><br> <em><strong>此外在/opt/ros/melodic/share目录下建立ORB_SLAM3软链接，我在1.0版本没有尝试过，有兴趣可以自己调试一下。</strong></em></p> 
<p>这时就成功运行单目USB摄像头了</p> 
<hr> 
<h3><a id="4ORBSLAM3_03USB_489"></a>4.ORB-SLAM3 0.3版本运行单目USB摄像头</h3> 
<pre><code class="prism language-rust">roscore
roslaunch usb_cam<span class="token operator">-</span>test<span class="token punctuation">.</span>launch
rosrun <span class="token constant">ORB_SLAM3</span> <span class="token class-name">Mono</span> <span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">/</span><span class="token class-name">Vocabulary</span><span class="token operator">/</span><span class="token class-name">ORBvoc</span><span class="token punctuation">.</span>txt <span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">/</span><span class="token class-name">Examples</span><span class="token operator">/</span><span class="token constant">ROS</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">/</span><span class="token class-name">Asus</span><span class="token punctuation">.</span>yaml
</code></pre> 
<p><img src="https://images2.imgbox.com/4c/f3/OClpgkNI_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="5ORBSLAM3_10_497"></a>5.再战ORB-SLAM3 1.0版本</h3> 
<p>首先复原初试的步骤，至少那里的步骤大致是没有什么错误的，接下来就是当时的错误“段错误”：<br> <img src="https://images2.imgbox.com/f1/65/5vYQivKp_o.png" alt="在这里插入图片描述"></p> 
<p>之前也思考过错误来源，经过大量试错，判断应该是opencv的版本冲突问题：<br> <strong>ROS的opencv3.2与本机opencv4.4冲突问题</strong></p> 
<p>本来想尝试修改CMakeLists.txt和cv_bridge使用本机opencv4，<a href="https://blog.csdn.net/bigdog_1027/article/details/79092263">参考的是这位博主</a>。<br> 可是过程繁琐，且修改或依然无法使用（主要是和个人配置使用的某些环境出现冲突），导致失败。<br> 那么就只能使用ROS的opencv3.2，<a href="https://blog.csdn.net/weixin_45947476/article/details/123567621?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165043229716780269893670%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=165043229716780269893670&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~times_rank-5-123567621.nonecase&amp;utm_term=orbslam3&amp;spm=1018.2226.3001.4450">参考的是这位博主</a>。</p> 
<p><strong>找到ORB_SLAM3的CMakeLists.txt文件打开，找个这个位置修改4.4这个值,改为(OpenCV 3 REQUIRED)，如图所示：</strong></p> 
<pre><code class="prism language-rust"><span class="token comment">//find_package(OpenCV 4.4)</span>
<span class="token function">find_package</span><span class="token punctuation">(</span><span class="token class-name">OpenCV</span> <span class="token number">3</span> <span class="token constant">REQUIRED</span><span class="token punctuation">)</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NOT</span> <span class="token class-name">OpenCV_FOUND</span><span class="token punctuation">)</span>
      <span class="token function">message</span><span class="token punctuation">(</span><span class="token constant">FATAL_ERROR</span> <span class="token string">"OpenCV &gt; 4.4 not found."</span><span class="token punctuation">)</span>
   <span class="token function">endif</span><span class="token punctuation">(</span><span class="token punctuation">)</span>。
</code></pre> 
<p><img src="https://images2.imgbox.com/3e/15/LtUtxoP0_o.png" alt="在这里插入图片描述"></p> 
<p>然后把ORB-SLAM3重新编译:</p> 
<pre><code class="prism language-rust">sudo <span class="token punctuation">.</span><span class="token operator">/</span>build<span class="token punctuation">.</span>sh
sudo <span class="token punctuation">.</span><span class="token operator">/</span>build_ros<span class="token punctuation">.</span>sh
</code></pre> 
<p><strong>报错1：</strong></p> 
<p>Map Viewer空白， Current Frame没有图像画面，并在左下角提示WAITING FOR IMAGES 。<br> <img src="https://images2.imgbox.com/b4/4d/9T2xlvUF_o.png" alt="在这里插入图片描述"></p> 
<p><strong>解决方法：</strong></p> 
<p><strong>1、按理来说，如果没有画面显示waiting for images时，就需要检查一下摄像头订阅。打开.cc文件发现"/camera/image_raw"没有修改成"/usb_cam/image_raw"，所以需要修改。</strong></p> 
<p><a href="https://blog.csdn.net/poulang5786/article/details/79249755">参考这位博主</a><br> <img src="https://images2.imgbox.com/4e/4d/WhRhLGcb_o.png" alt="在这里插入图片描述"><br> <strong>2、修改之后记得更新ORB_SLAM3软连接，在/opt/ros/melodic/share目录下，删除原来的ORB_SLAM3软连接（如果有的话）</strong></p> 
<pre><code class="prism language-rust">sudo rm <span class="token operator">-</span>r <span class="token constant">ORB_SLAM3</span>
</code></pre> 
<p>在/opt/ros/melodic/share目录下建立软链接</p> 
<pre><code class="prism language-rust">sudo ln <span class="token operator">-</span>s <span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token operator">/</span><span class="token class-name">Examples_old</span><span class="token operator">/</span><span class="token constant">ROS</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span> <span class="token operator">/</span>opt<span class="token operator">/</span>ros<span class="token operator">/</span>melodic<span class="token operator">/</span>share<span class="token operator">/</span><span class="token constant">ORB_SLAM3</span>
</code></pre> 
<p><strong>3、修改后需要重新编译ros：</strong></p> 
<pre><code class="prism language-rust">sudo <span class="token punctuation">.</span><span class="token operator">/</span>build_ros<span class="token punctuation">.</span>sh
</code></pre> 
<h3><a id="6ORBSLAM3_10USB_562"></a>6.ORB-SLAM3 1.0版本运行单目USB摄像头</h3> 
<pre><code class="prism language-rust">第<span class="token number">1</span>个终端：
roscore
第<span class="token number">2</span>个终端：
roslaunch usb_cam<span class="token operator">-</span>test<span class="token punctuation">.</span>launch
第<span class="token number">3</span>个终端：
rosrun <span class="token constant">ORB_SLAM3</span> <span class="token class-name">Mono</span> <span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token operator">/</span><span class="token class-name">Vocabulary</span><span class="token operator">/</span><span class="token class-name">ORBvoc</span><span class="token punctuation">.</span>txt <span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token operator">/</span><span class="token class-name">Examples_old</span><span class="token operator">/</span><span class="token constant">ROS</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">/</span><span class="token class-name">Asus</span><span class="token punctuation">.</span>yaml
第<span class="token number">4</span>个终端：
rqt_graph
</code></pre> 
<p><img src="https://images2.imgbox.com/b0/19/V0z5PjWw_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/b0/50/vAvsLpxx_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="7ORBSLAM3_10_583"></a>7.ORB-SLAM3 1.0版本运行双目摄像头</h3> 
<p>这个摄像头是合成图像的双目摄像头，意思就是使用的双目摄像头在计算机上是一个设备，即将两个摄像头的图像合成为了一副图像，此时需要先将一幅图分割为左右两幅，再分别作为一个ros_node发布。</p> 
<blockquote> 
 <p>ls /dev/video*<br> 它的编号也只有一个能打开</p> 
</blockquote> 
<ul><li><strong>直接打开双目的代码，用以测试</strong></li></ul> 
<pre><code class="prism language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> time

AUTO <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># 自动拍照，或手动按s键拍照</span>
INTERVAL <span class="token operator">=</span> <span class="token number">2</span>  <span class="token comment"># 自动拍照间隔</span>
cv2<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">)</span>
cap <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 设置分辨率左右摄像机同一频率，同一设备ID；左右摄像机总分辨率3840x1080；分割为两个1920x1080</span>
cap<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>CAP_PROP_FRAME_WIDTH<span class="token punctuation">,</span> <span class="token number">1280</span><span class="token punctuation">)</span>
cap<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>CAP_PROP_FRAME_HEIGHT<span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">)</span>
counter <span class="token operator">=</span> <span class="token number">0</span>
utc <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
folder <span class="token operator">=</span> <span class="token string">"./SaveImage/"</span>  <span class="token comment"># 拍照文件目录</span>


<span class="token keyword">def</span> <span class="token function">shot</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> frame<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> counter


    path <span class="token operator">=</span> folder <span class="token operator">+</span> pos <span class="token operator">+</span> <span class="token string">"_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".jpg"</span>
    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>path<span class="token punctuation">,</span> frame<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"snapshot saved into: "</span> <span class="token operator">+</span> path<span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    ret<span class="token punctuation">,</span> frame <span class="token operator">=</span> cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ret:"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span>
    <span class="token comment"># 裁剪坐标为[y0:y1, x0:x1] HEIGHT * WIDTH，</span>
    <span class="token comment">#双目相机是两个在一起的，通过剪切坐标位置可以单独分开相机</span>
    left_frame <span class="token operator">=</span> frame<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">640</span><span class="token punctuation">]</span>
    right_frame <span class="token operator">=</span> frame<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">:</span><span class="token number">1280</span><span class="token punctuation">]</span>
    cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">,</span> left_frame<span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">,</span> right_frame<span class="token punctuation">)</span>
    now <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> AUTO <span class="token keyword">and</span> now <span class="token operator">-</span> utc <span class="token operator">&gt;=</span> INTERVAL<span class="token punctuation">:</span>
        shot<span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">,</span> left_frame<span class="token punctuation">)</span>
        shot<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">,</span> right_frame<span class="token punctuation">)</span>
        counter <span class="token operator">+=</span> <span class="token number">1</span>
        utc <span class="token operator">=</span> now
    key <span class="token operator">=</span> cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> key <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"s"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        shot<span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">,</span> left_frame<span class="token punctuation">)</span>
        shot<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">,</span> right_frame<span class="token punctuation">)</span>
        counter <span class="token operator">+=</span> <span class="token number">1</span>
cap<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyWindow<span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyWindow<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li><strong>测试完毕进行后，使用ROS打开双目</strong></li></ul> 
<p>复制一份单目的launch文件更名为usb_cam-stereo<br> <img src="https://images2.imgbox.com/61/5e/WuLosnK8_o.png" alt="在这里插入图片描述"></p> 
<p>修改usb_cam-stereo的video_device和pixel_format，其中pixel_format的类型有mjpeg、yuyv等，根据自己的双目而定。</p> 
<pre><code class="prism language-python"><span class="token operator">&lt;</span>launch<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>node name<span class="token operator">=</span><span class="token string">"usb_cam"</span> pkg<span class="token operator">=</span><span class="token string">"usb_cam"</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"usb_cam_node"</span> output<span class="token operator">=</span><span class="token string">"screen"</span> <span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>param name<span class="token operator">=</span><span class="token string">"video_device"</span> value<span class="token operator">=</span><span class="token string">"/dev/video2"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>param name<span class="token operator">=</span><span class="token string">"image_width"</span> value<span class="token operator">=</span><span class="token string">"1280"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>param name<span class="token operator">=</span><span class="token string">"image_height"</span> value<span class="token operator">=</span><span class="token string">"480"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>param name<span class="token operator">=</span><span class="token string">"pixel_format"</span> value<span class="token operator">=</span><span class="token string">"mjpeg"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>param name<span class="token operator">=</span><span class="token string">"camera_frame_id"</span> value<span class="token operator">=</span><span class="token string">"usb_cam"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>param name<span class="token operator">=</span><span class="token string">"io_method"</span> value<span class="token operator">=</span><span class="token string">"mmap"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>node<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>node name<span class="token operator">=</span><span class="token string">"image_view"</span> pkg<span class="token operator">=</span><span class="token string">"image_view"</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"image_view"</span> respawn<span class="token operator">=</span><span class="token string">"false"</span> output<span class="token operator">=</span><span class="token string">"screen"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>remap <span class="token keyword">from</span><span class="token operator">=</span><span class="token string">"image"</span> to<span class="token operator">=</span><span class="token string">"/usb_cam/image_raw"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>param name<span class="token operator">=</span><span class="token string">"autosize"</span> value<span class="token operator">=</span><span class="token string">"true"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>node<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>launch<span class="token operator">&gt;</span>
</code></pre> 
<ul><li><strong>根据修改单目ros_mono.cc的经验去修改ros_stereo.cc文件，和单目一样修改后需要更新软链接和重新编译。</strong><br> <img src="https://images2.imgbox.com/c6/8d/ZNwt9UO8_o.png" alt="在这里插入图片描述"></li><li><strong>在ROS调用双目</strong></li></ul> 
<pre><code class="prism language-python">在usb_cam文件夹打开终端运行
roslaunch usb_cam<span class="token operator">-</span>stereo<span class="token punctuation">.</span>launch
</code></pre> 
<ul><li><strong>成功后尝试在通过ROS双目调用ORBSLAM3</strong></li></ul> 
<pre><code class="prism language-rust">第<span class="token number">1</span>个终端：
roscore
第<span class="token number">2</span>个终端：
roslaunch usb_cam<span class="token operator">-</span>stereo<span class="token punctuation">.</span>launch
第<span class="token number">3</span>个终端：
rosrun <span class="token constant">ORB_SLAM3</span> <span class="token class-name">Mono</span> <span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token operator">/</span><span class="token class-name">Vocabulary</span><span class="token operator">/</span><span class="token class-name">ORBvoc</span><span class="token punctuation">.</span>txt <span class="token operator">/</span>home<span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token class-name">Guide_blind</span><span class="token operator">/</span><span class="token constant">ORB_SLAM3</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token operator">/</span><span class="token class-name">Examples_old</span><span class="token operator">/</span><span class="token class-name">Stereo</span><span class="token operator">/</span><span class="token class-name">EuRoC</span><span class="token punctuation">.</span>yaml
</code></pre> 
<p>也可以尝试Stereo文件夹下各个.yaml文件<br> <img src="https://images2.imgbox.com/1b/e0/Quh0z5yH_o.png" alt="在这里插入图片描述"></p> 
<p>对比单目而言，双目比较稳定，可以进行适当的运动以及失联后的有效恢复，更快更稳。</p> 
<h3><a id="8_692"></a>8.双目参数标定</h3> 
<p>在测试中发现Stereo文件夹下各个.yaml文件运行效果都有所差异，尝试制作自己的.yaml文件</p> 
<ul><li><strong>获取标定数据</strong><br> 打印 一张标定图（盗的图）</li></ul> 
<p><img src="https://images2.imgbox.com/aa/70/Z8VCd8vd_o.png" alt="在这里插入图片描述"></p> 
<p>制作自己的标定图集，注意摄像头编号、路径、角点和像素</p> 
<pre><code class="prism language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> time

AUTO <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment"># 自动拍照，或手动按s键拍照</span>
INTERVAL <span class="token operator">=</span> <span class="token number">6</span>  <span class="token comment"># 自动拍照间隔</span>
cv2<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">)</span>
cap <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># 设置分辨率左右摄像机同一频率，同一设备ID；左右摄像机总分辨率3840x1080；分割为两个1920x1080</span>
cap<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>CAP_PROP_FRAME_WIDTH<span class="token punctuation">,</span> <span class="token number">1280</span><span class="token punctuation">)</span>
cap<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>CAP_PROP_FRAME_HEIGHT<span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">)</span>
counter <span class="token operator">=</span> <span class="token number">0</span>
utc <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
folder <span class="token operator">=</span> <span class="token string">"/home/nh666/llw/ORB_FAR/标定图片/"</span>  <span class="token comment"># 拍照文件目录</span>


<span class="token keyword">def</span> <span class="token function">shot</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> frame<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> counter


    path <span class="token operator">=</span> folder <span class="token operator">+</span> pos <span class="token operator">+</span> <span class="token string">"_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".jpg"</span>
    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>path<span class="token punctuation">,</span> frame<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"snapshot saved into: "</span> <span class="token operator">+</span> path<span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    ret<span class="token punctuation">,</span> frame <span class="token operator">=</span> cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ret:"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span>
    <span class="token comment"># 裁剪坐标为[y0:y1, x0:x1] HEIGHT * WIDTH，</span>
    <span class="token comment">#双目相机是两个在一起的，通过剪切坐标位置可以单独分开相机</span>
    left_frame <span class="token operator">=</span> frame<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">640</span><span class="token punctuation">]</span>
    right_frame <span class="token operator">=</span> frame<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">:</span><span class="token number">1280</span><span class="token punctuation">]</span>
    cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">,</span> left_frame<span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">,</span> right_frame<span class="token punctuation">)</span>
    now <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> AUTO <span class="token keyword">and</span> now <span class="token operator">-</span> utc <span class="token operator">&gt;=</span> INTERVAL<span class="token punctuation">:</span>
        shot<span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">,</span> left_frame<span class="token punctuation">)</span>
        shot<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">,</span> right_frame<span class="token punctuation">)</span>
        counter <span class="token operator">+=</span> <span class="token number">1</span>
        utc <span class="token operator">=</span> now
    key <span class="token operator">=</span> cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> key <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"s"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        shot<span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">,</span> left_frame<span class="token punctuation">)</span>
        shot<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">,</span> right_frame<span class="token punctuation">)</span>
        counter <span class="token operator">+=</span> <span class="token number">1</span>
cap<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyWindow<span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyWindow<span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li><strong>得到图集后自己分好类，用MATLAB进行标定</strong><br> （本来用opencv做的，但是做出来的数据不太对）</li></ul> 
<p>按顺序点击<br> <img src="https://images2.imgbox.com/05/df/s49QHVAe_o.png" alt="在这里插入图片描述"></p> 
<p>导入图集<br> <img src="https://images2.imgbox.com/8e/c7/5an4yU4X_o.png" alt="在这里插入图片描述"></p> 
<p>开始标注<br> <img src="https://images2.imgbox.com/2d/93/0F64F9ns_o.png" alt="在这里插入图片描述"></p> 
<p>根据1、2来观察，通过4去删除偏差过大的图片，5用来观察极线，6是导出数据<br> <img src="https://images2.imgbox.com/7b/11/MO0wYbWA_o.png" alt="在这里插入图片描述"></p> 
<p>根据以下数据来修改自己的.yaml文件<br> <img src="https://images2.imgbox.com/a4/98/dOnGwpAl_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c3/08/mNTwxbMk_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3c/89/jPj7gikq_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/d8/15/pM8PFypB_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e9/01/h24UXlaT_o.png" alt="在这里插入图片描述"></p> 
<p>建议复制一份新的来修改，怎么修改可以参考<a href="https://blog.csdn.net/weixin_48592526/article/details/122839172#t2">这篇博客</a></p> 
<ul><li><strong>使用修改过的.yaml文件后，感觉差别不太大，可能需要再去研究一下。</strong></li></ul> 
<p>接下来需要进行地图测试了<br> 未完待续。。。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ead38b057b3fedc0cd53e0b3ea8f4243/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何学习计算机视觉？初学者怎么入门？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6713db770d421035f0d822617b472ce7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">FFmpeg解码的软解及硬解（cuda和qsv）使用方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>