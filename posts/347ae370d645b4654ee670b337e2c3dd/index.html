<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>矫正图片背景 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="矫正图片背景" />
<meta property="og:description" content="在利用明场或荧光显微镜成像时，往往会由于样品厚度不一、镜头污渍或者光照不均等因素，降低图片质量，从而影响分析以及展示。
这篇文章就为大家介绍：怎样利用 ImageJ 对图片进行背景校正，包括两个方面：白平衡以及平场校正。
一、白平衡 白平衡（White Balance），在数码摄影中常常会遇到，在拍摄显微镜的明场图片时，更是值得关注的一点。
白色通常是指反射到人眼中的光线由于蓝、绿、红三种色光比例相同，且具有一定的亮度所形成的视觉反应。
对应在 RGB 彩色图片上，即 RGB 图片的三个通道（Red, Green, Blue）的灰度值大小相近。下图这个立方体很好地解释了 RGB 色彩模式，当 R,G,B 三个通道的灰度值都为 255 时，呈白色：
但在实际利用显微镜拍照的过程中（例如对细胞进行明场拍照），因为培养基本身的颜色等因素的影响，拍摄的照片往往不显白色，有不同颜色的偏向，即 RGB 三个通道的灰度值差别很大。
如下图，是利用倒置像差显微镜拍摄的细胞，图片整体偏黄。
1.将 RGB 图片变成三种颜色通道的 Stack（Image -&gt; Color -&gt; Make Composite）。 这一步将 RGB 图像分解成 R, G, B 三个通道的堆栈（Stack），每个通道为 8-bit 图像。但这时并不能看到单色的图片。
2.利用 Channels Tool 调出单一颜色通道（Image -&gt; Color -&gt; Channels Tool）。 打开 Channels Tool，这时处于 Composite 模式，三个 Channel 全部勾选，Channel 1、2、3 分别对应 Red、Green、Blue。
选择 Color 模式，则可以查看单一颜色通道：
从这里可以明显看出 Red、Green 两个通道较亮，Blue 通道较暗。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/347ae370d645b4654ee670b337e2c3dd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-17T18:20:43+08:00" />
<meta property="article:modified_time" content="2023-10-17T18:20:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">矫正图片背景</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>在利用明场或荧光显微镜成像时，往往会由于<strong>样品厚度不一</strong>、<strong>镜头污渍</strong>或者<strong>光照不均</strong>等因素，降低图片质量，从而影响分析以及展示。</p> 
<p>这篇文章就为大家介绍：怎样利用 ImageJ 对图片进行背景校正，包括两个方面：<strong>白平衡</strong>以及<strong>平场校正</strong>。</p> 
<h4><a id="_7"></a>一、白平衡</h4> 
<p><strong>白平衡（White Balance）</strong>，在数码摄影中常常会遇到，在拍摄显微镜的明场图片时，更是值得关注的一点。</p> 
<p>白色通常是指反射到人眼中的光线由于蓝、绿、红三种色光比例相同，且具有一定的亮度所形成的视觉反应。</p> 
<p>对应在 RGB 彩色图片上，即 RGB 图片的三个通道（Red, Green, Blue）的灰度值大小相近。下图这个立方体很好地解释了 RGB 色彩模式，当 R,G,B 三个通道的灰度值都为 255 时，呈白色：</p> 
<p><img src="https://images2.imgbox.com/5d/01/puH9BQzj_o.png" alt=""></p> 
<p>但在实际利用显微镜拍照的过程中（例如对细胞进行明场拍照），因为<strong>培养基本身的颜色等因素的影响</strong>，<strong>拍摄的照片往往不显白色，有不同颜色的偏向，即 RGB 三个通道的灰度值差别很大</strong>。</p> 
<p>如下图，是利用倒置像差显微镜拍摄的细胞，图片整体偏黄。</p> 
<h5><a id="1_RGB__StackImage__Color__Make_Composite_21"></a>1.将 RGB 图片变成三种颜色通道的 Stack（Image -&gt; Color -&gt; Make Composite）。</h5> 
<p>这一步将 RGB 图像分解成 R, G, B 三个通道的堆栈（Stack），每个通道为 8-bit 图像。但这时并不能看到单色的图片。</p> 
<p><img src="https://images2.imgbox.com/e8/b8/tLxG4Ugw_o.png" alt=""></p> 
<h5><a id="2_Channels_Tool_Image__Color__Channels_Tool_27"></a>2.利用 Channels Tool 调出单一颜色通道（Image -&gt; Color -&gt; Channels Tool）。</h5> 
<p>打开 Channels Tool，这时处于 Composite 模式，三个 Channel 全部勾选，Channel 1、2、3 分别对应 Red、Green、Blue。</p> 
<p><img src="https://images2.imgbox.com/1e/b4/k2Equqx1_o.png" alt=""></p> 
<p>选择 Color 模式，则可以查看单一颜色通道：</p> 
<p><img src="https://images2.imgbox.com/92/c2/Ymwdrpd5_o.png" alt=""></p> 
<p>从这里可以明显看出 Red、Green 两个通道较亮，Blue 通道较暗。</p> 
<p><img src="https://images2.imgbox.com/9b/0c/gsCKCotK_o.png" alt=""></p> 
<h5><a id="3_Color_BalanceImage__Adjust__Color_Balance_41"></a>3.对三个通道分别进行 Color Balance（Image -&gt; Adjust -&gt; Color Balance）。</h5> 
<p>打开 Color Balance，依次选择 Channel 1、2、3，然后进行 Auto，即对图片的亮度进行自动地调节：</p> 
<p><img src="https://images2.imgbox.com/c5/2c/8WxvnNwu_o.png" alt=""></p> 
<p>**注：**如果不利用 Channels Tool 调出单一颜色通道，也可以进行 Color Balance，依次选择 Channel 1、2、3，然后进行调节即可。</p> 
<h5><a id="4_RGB_Image__Color__Stack_to_RGB_49"></a>4.将不同通道<strong>合并为 RGB 图片</strong>（Image -&gt; Color -&gt; Stack to RGB）</h5> 
<p>调节完成后，将不同通道合并为 RGB 图片：</p> 
<p><img src="https://images2.imgbox.com/0d/1f/eatVz5YJ_o.png" alt=""></p> 
<p>进行白平衡后，图片偏黄的情况有很大的改善。</p> 
<h4><a id="_57"></a>二、平场校正</h4> 
<p>另一种情况，当光照不均匀或镜头上有污渍时，需要对图片进行平场校正。通常的做法是在拍照时，拍一张空白图片作为背景，然后利用 Image Calculator，将拍摄照片减去背景，可校正得到的图片，如下图所示：</p> 
<p><img src="https://images2.imgbox.com/19/10/wUy9jj75_o.png" alt=""></p> 
<p>但当我们无法得到背景图片，就需要借助其他方法进行平场校正。如下图所示，该图片有明显的背景以及光照不均。</p> 
<p><img src="https://images2.imgbox.com/8c/9c/XkeadyFg_o.png" alt=""></p> 
<h5><a id="1Image__Duplicate_67"></a>1.复制图片（Image -&gt; Duplicate）。</h5> 
<p><img src="https://images2.imgbox.com/94/28/citi9L9N_o.png" alt=""></p> 
<h5><a id="2Process__Filters__Gaussian_Blur_71"></a>2.对复制后图片进行<strong>高斯模糊</strong>（Process -&gt; Filters -&gt; Gaussian Blur）。</h5> 
<p>高斯模糊（Gaussian Blur）可以滤去图片中的高频成分即细节，剩下的低频成分即为背景。Sigma 的值可以更改，<strong>Sigma 越大图像越模糊</strong>，在这个例子当中，Sigma 取 50 即可。这样我们就得到了背景图片。</p> 
<p><img src="https://images2.imgbox.com/1b/42/GIn07kPy_o.png" alt=""></p> 
<h5><a id="3Process__Image_Calculator_77"></a>3.原始图片<strong>减去背景</strong>（Process -&gt; Image Calculator）。</h5> 
<p>Operation 选择 Subtract，勾选 Create new window。</p> 
<p><img src="https://images2.imgbox.com/0f/e0/edSoUw3w_o.png" alt=""></p> 
<p>处理后的图片很好地去除了背景，保留了图像的原始细节。</p> 
<p><img src="https://images2.imgbox.com/ac/22/3XJhSm4V_o.png" alt=""></p> 
<h4><a id="_86"></a>三、程序代码</h4> 
<p><a href="https://gitee.com/harrytsz/harrytszcode/tree/master/Tools" rel="nofollow">Tools</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/48f197ad61e2eb79c532e1f5de9df1cb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">web前端【3】JS基础-轮播图【JavaScript、定时器、鼠标动作、自动轮播、增加和减少li列表】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1ef35c7aec92fc04729ed9c90373a22f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">xml文件报错 ORA-00907: 缺失右括号</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>