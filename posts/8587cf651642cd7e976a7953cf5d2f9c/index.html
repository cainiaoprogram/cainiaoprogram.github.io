<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>利用Python进行数据归一化 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="利用Python进行数据归一化" />
<meta property="og:description" content="利用Python进行数据归一化 归一化化定义：
归一化就是要把需要处理的数据经过处理后（通过某种算法）限制在你需要的一定范围内。
归一化方法有两种形式：
一种是把数变为（0，1）之间的小数一种是把有量纲表达式变为无量纲表达式 一、归一到[0，1] class sklearn.preprocessing.MinMaxScaler(feature_range=(0, 1),
copy=True)
计算原理（参考sklearn官方文档）：
X_std = (X - X.min(axis=0)) / (X.max(axis=0) - X.min(axis=0)) X_scaled = X_std * (max - min) &#43; min 这里 min, max = feature_range。也就是你要归一化的范围，默认是（0,1），即min=0,max=1;
这里axis=0，表示MinMaxScaler方法默认是对每一列做这样的归一化操作，这也比较符合实际应用。
示例代码：
from sklearn import preprocessing import numpy as np x = np.array([[3., -1., 2., 613.], [2., 0., 0., 232], [0., 1., -1., 113], [1., 2., -3., 489]]) min_max_scaler = preprocessing.MinMaxScaler() x_minmax = min_max_scaler.fit_transform(x) print(x_minmax) 运行结果： [[1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8587cf651642cd7e976a7953cf5d2f9c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-01-08T16:09:35+08:00" />
<meta property="article:modified_time" content="2020-01-08T16:09:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">利用Python进行数据归一化</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Python_0"></a>利用Python进行数据归一化</h2> 
<p><strong>归一化化定义</strong>：<br> 归一化就是要把需要处理的数据经过处理后（通过某种算法）限制在你需要的一定范围内。</p> 
<p><strong>归一化方法有两种形式</strong>：</p> 
<ol><li>一种是把数变为（0，1）之间的小数</li><li>一种是把有量纲表达式变为无量纲表达式</li></ol> 
<h3><a id="01_9"></a>一、归一到[0，1]</h3> 
<blockquote> 
 <p>class sklearn.preprocessing.MinMaxScaler(feature_range=(0, 1),<br> copy=True)</p> 
</blockquote> 
<p>计算原理（<a href="http://lijiancheng0614.github.io/scikit-learn/modules/generated/sklearn.preprocessing.MinMaxScaler.html" rel="nofollow">参考sklearn官方文档</a>）：</p> 
<pre><code class="prism language-python">X_std <span class="token operator">=</span> <span class="token punctuation">(</span>X <span class="token operator">-</span> X<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>X<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> X<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
X_scaled <span class="token operator">=</span> X_std <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token builtin">max</span> <span class="token operator">-</span> <span class="token builtin">min</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">min</span>
</code></pre> 
<p>这里 min, max = feature_range。也就是你要归一化的范围，默认是（0,1），即min=0,max=1;<br> 这里axis=0，表示MinMaxScaler方法默认是对每一列做这样的归一化操作，这也比较符合实际应用。</p> 
<p>示例代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> preprocessing
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">613</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">232</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">489</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

min_max_scaler <span class="token operator">=</span> preprocessing<span class="token punctuation">.</span>MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_minmax <span class="token operator">=</span> min_max_scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x_minmax<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">运行结果：
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span>         <span class="token number">0</span><span class="token punctuation">.</span>         <span class="token number">1</span><span class="token punctuation">.</span>         <span class="token number">1</span><span class="token punctuation">.</span>        <span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.66666667</span> <span class="token number">0.33333333</span> <span class="token number">0.6</span>        <span class="token number">0.238</span>     <span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span>         <span class="token number">0.66666667</span> <span class="token number">0.4</span>        <span class="token number">0</span><span class="token punctuation">.</span>        <span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.33333333</span> <span class="token number">1</span><span class="token punctuation">.</span>         <span class="token number">0</span><span class="token punctuation">.</span>         <span class="token number">0.752</span>     <span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<h4><a id="DataFrame_45"></a>注意：单独用在DataFrame某一列报错问题</h4> 
<p>背景：训练好xgboost模型后，对测试集的label进行预测，并将其归一化到（0,1）范围内，作为预测的概率。遇到以下情况：</p> 
<pre><code class="prism language-python"><span class="token comment">#predict test set</span>
dataset3_preds<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>dataset3<span class="token punctuation">)</span>
dataset3_preds<span class="token punctuation">.</span>label <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>dataset3_preds<span class="token punctuation">.</span>label<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">运行结果：
AttributeError<span class="token punctuation">:</span> <span class="token string">'Series'</span> <span class="token builtin">object</span> has no attribute <span class="token string">'reshape'</span>
</code></pre> 
<p>试着去掉reshape运行：</p> 
<pre><code class="prism language-python"><span class="token comment">#predict test set</span>
dataset3_preds<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>dataset3<span class="token punctuation">)</span>
dataset3_preds<span class="token punctuation">.</span>label <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>dataset3_preds<span class="token punctuation">.</span>label<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">运行结果：
ValueError<span class="token punctuation">:</span> Expected <span class="token number">2D</span> array<span class="token punctuation">,</span> got <span class="token number">1D</span> array instead<span class="token punctuation">:</span>
array<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.6797101</span>   <span class="token number">0.64954907</span> <span class="token operator">-</span><span class="token number">2.3749304</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">-</span><span class="token number">0.2589171</span>  <span class="token operator">-</span><span class="token number">0.5653752</span>
 <span class="token operator">-</span><span class="token number">0.26819348</span><span class="token punctuation">]</span><span class="token punctuation">.</span>
Reshape your data either using array<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">if</span> your data has a single feature <span class="token operator">or</span> array<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">if</span> it contains a single sample<span class="token punctuation">.</span>
</code></pre> 
<p>结果也不行。</p> 
<p>出错的原因是Series没有reshape这个接口，而Series有values这个接口，<br> 解决的办法是y调用values接口，然后调用values中的reshape方法。<br> 如：</p> 
<pre><code class="prism language-python"><span class="token comment">#predict test set</span>
dataset3_preds<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>dataset3<span class="token punctuation">)</span>
dataset3_preds<span class="token punctuation">.</span>label <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>dataset3_preds<span class="token punctuation">.</span>label<span class="token punctuation">.</span>values<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>就可以正常运行。</p> 
<h3><a id="11_84"></a>二、归一到[-1,1]</h3> 
<p>（<a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MaxAbsScaler.html#sklearn.preprocessing.MaxAbsScaler" rel="nofollow">更多请参考sklearn官方文档</a>）<br> 示例代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> preprocessing
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
 
x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">613</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">232</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">489</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
max_abs_scaler <span class="token operator">=</span> preprocessing<span class="token punctuation">.</span>MaxAbsScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_train_maxsbs <span class="token operator">=</span> max_abs_scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
x_train_maxsbs
</code></pre> 
<pre><code class="prism language-python">运行结果：
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">.</span>        <span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span>       <span class="token punctuation">,</span>  <span class="token number">0.66666667</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">.</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">0.66666667</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span>        <span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span>        <span class="token punctuation">,</span>  <span class="token number">0.37846656</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span>        <span class="token punctuation">,</span>  <span class="token number">0.5</span>       <span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.33333333</span><span class="token punctuation">,</span>  <span class="token number">0.18433931</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">0.33333333</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">.</span>        <span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span>        <span class="token punctuation">,</span>  <span class="token number">0.79771615</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>参考博客：<br> [1]:<a href="https://blog.csdn.net/weixin_40683253/article/details/81508321#MaxAbsScaler%EF%BC%9A%E5%BD%92%E4%B8%80%E5%88%B0%20%5B%20-1%EF%BC%8C1%20%5D%C2%A0">数据归一化 - MinMaxScaler()/MaxAbsScaler() - Python代码</a><br> [2]: <a href="https://blog.csdn.net/weixin_38664232/article/details/86760297">AttributeError: ‘Series’ object has no attribute ‘reshape’</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a3f8806fcf3db4e00c146463d725247c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ubuntu安装软件时报错（报错：dpkg: 处理软件包  xxx  (--configure)时出错：  依赖关系问题 - 仍未被配置）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/69312a5d8910afbb9e0c0404914e4b7d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">No signing certificate &#34;iOS Distribution&#34; found</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>