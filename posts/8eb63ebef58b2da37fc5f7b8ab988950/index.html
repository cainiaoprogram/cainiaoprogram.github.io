<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>盘点一个Python自动化办公的需求——一键批量插图到Excel指定单元格 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="盘点一个Python自动化办公的需求——一键批量插图到Excel指定单元格" />
<meta property="og:description" content="点击上方“Python爬虫与数据挖掘”，进行关注
回复“书籍”即可获赠Python从入门到进阶共10本电子书
今
日
鸡
汤
读书好处心先觉，立雪深时道已传。
大家好，我是皮皮。
一、前言 前几天在Python白银交流群【上海新年人】问了一个Python自动化办公的问题，问题如下：大佬们，昨天我在做插入excel图片的时候想起一个需求，好像挺难办的，也蛮现实的。比如每个图片是有名称的，但在做excel的时候，能不能按照excel中的名称调用图片插入。就像下面这样子，插入在B列对应的名称边上。
相当于你现在的图片名称已经命名好了，你现在只需要插入到Excel中，图片名称（以单元格命名）所对应的那个单元格里边。单个插入很简单的，他自己也实现了，就是批量进行操作的时候，有些有心无力了。代码如下：
from openpyxl.drawing.image import Image pic_path = r&#39;C:\Users\Administrator\Desktop\图片练习&#39; wb = load_workbook(r&#39;C:\Users\Administrator\Desktop\练习2.xlsx&#39;) ws = wb.active pic_list = [os.path.join(pic_path,i) for i in os.listdir(pic_path) if i.endswith(&#39;.jpg&#39;)] new_size = (90,90) num = 2 for i,pic in enumerate(pic_list,start=1): image = Image(pic) image.width,image.height = new_size ws.row_dimensions[num].height = 80 ws.column_dimensions[&#39;b&#39;].width = 12 ws.add_image(image,&#39;b&#39; &#43; str(num)) num &#43;= 2 wb.save(r&#39;C:\Users\Administrator\Desktop\练习2.xlsx&#39;) 二、实现过程 这里【论草莓如何成为冻干莓】给了一个思路：仅用excel做，vba也可以的，就是名称匹配而已。我们这个是直接固定在单元格里，单元格多大，图片就多大。
后来【论草莓如何成为冻干莓】直接问到了这份代码：
顺利地解决了粉丝的问题。
需要一键批量插图到Excel指定单元格代码的小伙伴们可以找后台找我威信，加上后给你分享，万一你以后在工作这也遇到类似这样的需求的时候，也有备无患了。
三、总结 大家好，我是皮皮。这篇文章主要盘点了一个Pandas数据提取的问题，文中针对该问题，给出了具体的解析和代码实现，帮助粉丝顺利解决了问题。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8eb63ebef58b2da37fc5f7b8ab988950/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-10T09:01:18+08:00" />
<meta property="article:modified_time" content="2024-01-10T09:01:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">盘点一个Python自动化办公的需求——一键批量插图到Excel指定单元格</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p style="text-align:center;">点击上方“<strong>Python爬虫与数据挖掘</strong>”，进行关注</p> 
 <p style="text-align:center;">回复“<strong>书籍</strong>”即可获赠Python从入门到进阶共10本电子书</p> 
 <p>今</p> 
 <p>日</p> 
 <p>鸡</p> 
 <p>汤</p> 
 <p style="text-align:center;">读书好处心先觉，立雪深时道已传。</p> 
 <p>大家好，我是皮皮。</p> 
 <h4>一、前言</h4> 
 <p>前几天在Python白银交流群【上海新年人】问了一个Python自动化办公的问题，问题如下：大佬们，昨天我在做插入excel图片的时候想起一个需求，好像挺难办的，也蛮现实的。比如每个图片是有名称的，但在做excel的时候，能不能按照excel中的名称调用图片插入。就像下面这样子，插入在B列对应的名称边上。</p> 
 <img src="https://images2.imgbox.com/fe/71/DBcAiXtv_o.png" alt="9e2c5d22eac7c320ddb912cdc2ffbe99.png"> 
 <p>相当于你现在的图片名称已经命名好了，你现在只需要插入到Excel中，图片名称（以单元格命名）所对应的那个单元格里边。单个插入很简单的，他自己也实现了，就是批量进行操作的时候，有些有心无力了。代码如下：</p> 
 <pre class="has"><code class="language-go">from openpyxl.drawing.image import Image
pic_path = r'C:\Users\Administrator\Desktop\图片练习'
wb = load_workbook(r'C:\Users\Administrator\Desktop\练习2.xlsx')
ws = wb.active
pic_list = [os.path.join(pic_path,i) for i in os.listdir(pic_path) if i.endswith('.jpg')]

new_size = (90,90)
num = 2
for i,pic in enumerate(pic_list,start=1):
    image = Image(pic)
    image.width,image.height = new_size
    ws.row_dimensions[num].height = 80
    ws.column_dimensions['b'].width = 12
    ws.add_image(image,'b' + str(num))
    num += 2
wb.save(r'C:\Users\Administrator\Desktop\练习2.xlsx')</code></pre> 
 <h4>二、实现过程</h4> 
 <p>这里【论草莓如何成为冻干莓】给了一个思路：仅用excel做，vba也可以的，就是名称匹配而已。我们这个是直接固定在单元格里，单元格多大，图片就多大。</p> 
 <img src="https://images2.imgbox.com/66/fa/whUqqYZm_o.png" alt="d925a9f63bb330c4abe141a598c3d0d2.png"> 
 <p>后来【论草莓如何成为冻干莓】直接问到了这份代码：</p> 
 <img src="https://images2.imgbox.com/0b/bb/2TynMH7K_o.png" alt="08783a70801962240b573a25179099ee.png"> 
 <p>顺利地解决了粉丝的问题。</p> 
 <p>需要一键批量插图到Excel指定单元格代码的小伙伴们可以找后台找我威信，加上后给你分享，万一你以后在工作这也遇到类似这样的需求的时候，也有备无患了。</p> 
 <h4>三、总结</h4> 
 <p>大家好，我是皮皮。这篇文章主要盘点了一个Pandas数据提取的问题，文中针对该问题，给出了具体的解析和代码实现，帮助粉丝顺利解决了问题。</p> 
 <p>最后感谢粉丝【上海新年人】提出的问题，感谢【瑜亮老师】、【论草莓如何成为冻干莓】给出的思路和代码，感谢【莫生气】、【冯诚】等人参与学习交流。</p> 
 <p>【提问补充】温馨提示，大家在群里提问的时候。可以注意下面几点：如果涉及到大文件数据，可以数据脱敏后，发点demo数据来（小文件的意思），然后贴点代码（可以复制的那种），记得发报错截图（截全）。代码不多的话，直接发代码文字即可，代码超过50行这样的话，发个.py文件就行。</p> 
 <img src="https://images2.imgbox.com/b7/42/Vfce7kSC_o.png" alt="53287d2f82e144f9ef8e1b851b78fdff.png"> 
 <p>大家在学习过程中如果有遇到问题，欢迎随时联系我解决（我的微信：pdcfighting1），应粉丝要求，我创建了一些ChatGPT机器人交流群和高质量的Python付费学习交流群和付费接单群，欢迎大家加入我的Python学习交流群和接单群！</p> 
 <img src="https://images2.imgbox.com/2a/be/3eyInbrc_o.png" alt="2bdcc0305591391676a35854aad10ebc.png"> 
 <p style="text-align:left;">小伙伴们，快快用实践一下吧！如果在学习过程中，有遇到任何问题，欢迎加我好友，我拉你进Python学习交流群共同探讨学习。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/7a/3e/UyBV15k5_o.png" alt="d47e348d98b476d851139326de353272.jpeg"></p> 
 <p style="text-align:center;"><strong><strong><strong><strong><strong>---</strong>--<strong><strong><strong><strong><strong><strong>---</strong></strong>---<strong><strong><strong><strong><strong>---</strong>--<strong><strong><strong><strong><strong><strong>---</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong> End <strong><strong><strong><strong><strong>---</strong>--<strong><strong><strong><strong><strong><strong>---</strong>--</strong>---<strong><strong><strong><strong><strong>---</strong>--<strong><strong><strong><strong><strong><strong>-</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br></p> 
 <p style="text-align:left;">往期精彩文章推荐：</p> 
 <ul><li><p><a href="" rel="nofollow">盘点一个Pandas实现Excel判断写法的问题</a></p></li><li><p><a href="" rel="nofollow">Pandas实现这列股票代码中10-12之间的股票筛出来</a></p></li><li><p><a href="" rel="nofollow">从5亿行数据中，筛选出重复次数在1000行的数据行，也爆内存了</a></p></li><li><p><a href="" rel="nofollow">Python自动化办公——3个Excel表格中每个门店物品不同，想要汇总在一起（方法五）</a><br></p></li></ul> 
 <p><img src="https://images2.imgbox.com/98/f5/12Ph2vQ3_o.png" alt="a3be36fd3076dbf2e3db8dcb41692466.png"></p> 
 <p>欢迎大家<strong>点赞，</strong><strong>留言，</strong><strong>转发，<strong>转载，</strong></strong>感谢大家的相伴与支持</p> 
 <p>想加入Python学习群请在后台回复【<strong>入群</strong>】</p> 
 <p>万水千山总是情，点个【<strong>在看</strong>】行不行</p> 
 <p style="text-align:center;"><strong>/今日留言主题/</strong></p> 
 <p style="text-align:center;">随便说一两句吧~~</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4ab37066d2c718501053e5276a292416/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">第十九章 调用Callout Library函数 - 将 $ZF(-5) 与多个库和许多函数调用一起使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/44c25563313d16354d7932a41bebf533/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于 InternLM 和 LangChain 搭建你的知识库</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>