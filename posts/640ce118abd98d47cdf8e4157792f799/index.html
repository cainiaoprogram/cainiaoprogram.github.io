<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>NLP预训练模型：RoBERTa、ELECTRA、DeBERTa和DeBERTaV3 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="NLP预训练模型：RoBERTa、ELECTRA、DeBERTa和DeBERTaV3" />
<meta property="og:description" content="文章目录 Models CorpusRoBERTa: A Robustly Optimized BERT Pretraining ApproachELECTRA: PRE-TRAINING TEXT ENCODERS AS DISCRIMINATORS RATHER THAN GENERATORSRTD, Replaced Token DetectionWeight SharingSmaller GeneratorsTraining Algorithms DeBERTa: Decoding-enhanced BERT with Disentangled AttentionDISENTANGLED SELF-ATTENTIONENHANCED MASK DECODER ACCOUNTS FOR ABSOLUTE WORD POSITIONSSCALE INVARIANT FINE-TUNING，SiFT DeBERTaV3: Improving DeBERTa using ELECTRA-Style Pre-Training with Gradient-Disentangled Embedding SharingDeBERTa with RTDToken Embedding Sharing in ELECTRAGradient-Disentangled Embedding Sharing Models Corpus RoBERTa: A Robustly Optimized BERT Pretraining Approach 论文连接： https://arxiv.org/pdf/1907.11692.pdf
与BERT主要区别在于：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/640ce118abd98d47cdf8e4157792f799/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-18T16:20:21+08:00" />
<meta property="article:modified_time" content="2023-03-18T16:20:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">NLP预训练模型：RoBERTa、ELECTRA、DeBERTa和DeBERTaV3</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#Models_Corpus_5" rel="nofollow">Models Corpus</a></li><li><a href="#RoBERTa__A_Robustly_Optimized_BERT_Pretraining_Approach_9" rel="nofollow">RoBERTa: A Robustly Optimized BERT Pretraining Approach</a></li><li><a href="#ELECTRA_PRETRAINING_TEXT_ENCODERS_AS_DISCRIMINATORS_RATHER_THAN_GENERATORS_30" rel="nofollow">ELECTRA: PRE-TRAINING TEXT ENCODERS AS DISCRIMINATORS RATHER THAN GENERATORS</a></li><li><ul><li><a href="#RTD_Replaced_Token_Detection_38" rel="nofollow">RTD, Replaced Token Detection</a></li><li><a href="#Weight_Sharing_56" rel="nofollow">Weight Sharing</a></li><li><a href="#Smaller_Generators_67" rel="nofollow">Smaller Generators</a></li><li><a href="#Training_Algorithms_72" rel="nofollow">Training Algorithms</a></li></ul> 
  </li><li><a href="#DeBERTa_Decodingenhanced_BERT_with_Disentangled_Attention_81" rel="nofollow">DeBERTa: Decoding-enhanced BERT with Disentangled Attention</a></li><li><ul><li><a href="#DISENTANGLED_SELFATTENTION_84" rel="nofollow">DISENTANGLED SELF-ATTENTION</a></li><li><a href="#ENHANCED_MASK_DECODER_ACCOUNTS_FOR_ABSOLUTE_WORD_POSITIONS_100" rel="nofollow">ENHANCED MASK DECODER ACCOUNTS FOR ABSOLUTE WORD POSITIONS</a></li><li><a href="#SCALE_INVARIANT_FINETUNINGSiFT_109" rel="nofollow">SCALE INVARIANT FINE-TUNING，SiFT</a></li></ul> 
  </li><li><a href="#DeBERTaV3_Improving_DeBERTa_using_ELECTRAStyle_PreTraining_with_GradientDisentangled_Embedding_Sharing_114" rel="nofollow">DeBERTaV3: Improving DeBERTa using ELECTRA-Style Pre-Training with Gradient-Disentangled Embedding Sharing</a></li><li><ul><li><a href="#DeBERTa_with_RTD_119" rel="nofollow">DeBERTa with RTD</a></li><li><a href="#Token_Embedding_Sharing_in_ELECTRA_122" rel="nofollow">Token Embedding Sharing in ELECTRA</a></li><li><a href="#GradientDisentangled_Embedding_Sharing_129" rel="nofollow">Gradient-Disentangled Embedding Sharing</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="Models_Corpus_5"></a>Models Corpus</h2> 
<p><img src="https://images2.imgbox.com/e9/48/jxD9atFP_o.png" alt="在这里插入图片描述" height="220"></p> 
<hr> 
<h2><a id="RoBERTa__A_Robustly_Optimized_BERT_Pretraining_Approach_9"></a>RoBERTa: A Robustly Optimized BERT Pretraining Approach</h2> 
<p><strong>论文连接：</strong> https://arxiv.org/pdf/1907.11692.pdf</p> 
<p><strong>与BERT主要区别在于：</strong></p> 
<ul><li><code>large mini-batches</code>: 保持总训练tokens数一致，使用更大的学习率、更大的batch size，adam <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           β 
          
         
           2 
          
         
        
          = 
         
        
          0.98 
         
        
       
         \beta_2=0.98 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0.98</span></span></span></span></span>；</li><li><code>dynamic masking</code>: 动态掩盖，同一份样本重复10次；</li><li><code>FULL-SENTENCES without NSP</code>: 做了四种输入格式实验，验证了NSP任务的无效性，DOC-SENTENCES方式最优： 
  <ul><li>SEGMENT-PAIR+NSP: BERT输入类型，以一对文本段做了输入，文本段包含多句输入，总token数小于512；</li><li>SENTENCE-PAIR+NSP: 以句对作为输入，总长度可能远小于512，增加batch size使得单批次总tokens数接近其它方法；</li><li>FULL-SENTENCES:从单篇文章或多篇文章采样的连续句子，不同文章句采用特殊标记拼接，总长度最多512；</li><li>DOC-SENTENCES: 从单篇文章采样的连续句子，总长度可能不足512，增加batch_size保持单批次总tokens数接近其它方法；</li></ul> </li><li><code>larger byte-level BPE</code>: 使用更大词表的BPE，词表大小从30K提升至50K，无预处理步骤，无unknown token；</li></ul> 
<blockquote> 
 <p><strong>Byte-Pair Encoding (BPE)</strong><br> <br> A hybrid between character- and word-level representations that allows handling the large vocabularies common in natural language corpora.<br> Instead of full words, BPE relies on subwords units, which are extracted by performing statistical analysis of the training corpus.<br> <br> Radford et al. (2019) introduce a clever implementation of BPE that <strong>uses bytes instead of unicode characters as the base subword units</strong>. Using bytes makes it possible to learn a subword vocabulary of a modest size (50K units) that can still <strong>encode any input text without introducing any “unknown” tokens</strong>.</p> 
</blockquote> 
<hr> 
<h2><a id="ELECTRA_PRETRAINING_TEXT_ENCODERS_AS_DISCRIMINATORS_RATHER_THAN_GENERATORS_30"></a>ELECTRA: PRE-TRAINING TEXT ENCODERS AS DISCRIMINATORS RATHER THAN GENERATORS</h2> 
<p><strong>论文链接：</strong> https://arxiv.org/abs/2003.10555<br> <strong>释义：</strong> ELECTRA, “<mark>E</mark>fficiently <mark>L</mark>earning an <mark>E</mark>ncoder that <mark>C</mark>lassifies <mark>T</mark>oken <mark>R</mark>eplacements <mark>A</mark>ccurately”.<br> <strong>主要贡献：</strong> 提出Replaced Token Detection (RTD)预训练任务，让判别器学习输入token是否被替换，与MLM预训练相比，消除了<code>[MASK]</code>在预训练与下游微调之间不统一的问题，此外，判别器学习输入中的每一个token，比MLM任务仅学习部分掩盖token更有效率。</p> 
<p>如图1所示，同算力消耗下，RTD比MLM更高效：<br> <img src="https://images2.imgbox.com/7b/b2/Gh6EzEie_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="RTD_Replaced_Token_Detection_38"></a>RTD, Replaced Token Detection</h3> 
<p><img src="https://images2.imgbox.com/36/83/xAF3x4Dd_o.png" alt="在这里插入图片描述" height="350"><br> 同时训练生成器<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         G 
        
       
      
        G 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></span>和判别器<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         D 
        
       
      
        D 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span></span></span></span></span>两个网络，每个网络都是一个Transformer Encoder，将输入tokens序列<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          x 
         
        
       
         = 
        
       
         [ 
        
        
        
          x 
         
        
          1 
         
        
       
         , 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         , 
        
        
        
          x 
         
        
          n 
         
        
       
         ] 
        
       
      
        \pmb x=[x_1, ..., x_n] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord" style="text-shadow: 0.02em 0.01em 0.04px;"><span class="mord mathnormal">x</span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>，编码为语义向量序列<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         h 
        
       
         ( 
        
        
        
          x 
         
        
       
         ) 
        
       
         = 
        
       
         [ 
        
        
        
          h 
         
        
          1 
         
        
       
         , 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         , 
        
        
        
          h 
         
        
          n 
         
        
       
         ] 
        
       
      
        h(\pmb x)=[h_1,...,h_n] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord" style="text-shadow: 0.02em 0.01em 0.04px;"><span class="mord mathnormal">x</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>。</p> 
<p>给定位置<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>，令<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          x 
         
        
          t 
         
        
       
         = 
        
       
         [ 
        
       
         MASK 
        
       
         ] 
        
       
      
        x_t=[\text{MASK}] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord text"><span class="mord">MASK</span></span><span class="mclose">]</span></span></span></span></span>，<strong>生成器(MLM)</strong> 预测输出概率分布：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           p 
          
         
           G 
          
         
        
          ( 
         
         
         
           x 
          
         
           t 
          
         
        
          ∣ 
         
         
         
           x 
          
         
        
          ) 
         
        
          = 
         
        
          exp 
         
        
          ⁡ 
         
        
          ( 
         
        
          e 
         
        
          ( 
         
         
         
           x 
          
         
           t 
          
         
         
         
           ) 
          
         
           ⊤ 
          
         
         
         
           h 
          
         
           G 
          
         
        
          ( 
         
         
         
           x 
          
         
         
         
           ) 
          
         
           t 
          
         
        
          ) 
         
        
          / 
         
         
         
           ∑ 
          
          
          
            x 
           
          
            ′ 
           
          
         
        
          exp 
         
        
          ⁡ 
         
        
          ( 
         
        
          e 
         
        
          ( 
         
         
         
           x 
          
         
           ′ 
          
         
         
         
           ) 
          
         
           ⊤ 
          
         
         
         
           h 
          
         
           G 
          
         
        
          ( 
         
         
         
           x 
          
         
         
         
           ) 
          
         
           t 
          
         
        
          ) 
         
        
       
         p_G(x_t|\pmb x)=\exp(e(x_t)^\top h_G(\pmb x)_t)/\sum_{x'}\exp(e(x')^\top h_G(\pmb x)_t) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord" style="text-shadow: 0.02em 0.01em 0.04px;"><span class="mord mathnormal">x</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.344em; vertical-align: -1.294em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord" style="text-shadow: 0.02em 0.01em 0.04px;"><span class="mord mathnormal">x</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -1.856em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6828em;"><span class="" style="top: -2.786em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.294em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord" style="text-shadow: 0.02em 0.01em 0.04px;"><span class="mord mathnormal">x</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p> 
<p>式中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         e 
        
       
      
        e 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span></span>表示token embeddings。对于位置<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>，<strong>判别器</strong>判别该位置token来自于真实数据分布还是生成器预测分布，即是否被替换：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          D 
         
        
          ( 
         
         
         
           x 
          
         
        
          , 
         
        
          t 
         
        
          ) 
         
        
          = 
         
        
          sigmoid 
         
        
          ( 
         
         
         
           w 
          
         
           ⊤ 
          
         
         
         
           h 
          
         
           D 
          
         
        
          ( 
         
         
         
           x 
          
         
         
         
           ) 
          
         
           t 
          
         
        
          ) 
         
        
       
         D(\pmb x, t)=\text{sigmoid}(w^\top h_D(\pmb x)_t) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="mopen">(</span><span class="mord" style="text-shadow: 0.02em 0.01em 0.04px;"><span class="mord mathnormal">x</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1491em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">sigmoid</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord" style="text-shadow: 0.02em 0.01em 0.04px;"><span class="mord mathnormal">x</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p> 
<p>与GAN的区别在于，生成器以极大似然估计方式训练，不需要欺骗判别器。<mark><strong>判别器梯度不反向传播至生成器</strong></mark>，下游任务仅使用判别器。</p> 
<blockquote> 
 <p>生成器生成的token与原始token的语义接近，使用生成器预测序列作为判别器输入（更难区分），比随机替换token的方式更有效。</p> 
</blockquote> 
<h3><a id="Weight_Sharing_56"></a>Weight Sharing</h3> 
<p>当判别器和生成器大小相同时，所有transformer参数均可以共享，但生成器参数量较少时训练更小效率，因此，仅共享token和position两种embedding参数。</p> 
<p>表：GLUE在生成器和判别器共享参数下的性能</p> 
<table><tbody><tr><td>不共享参数</td><td>共享token embeddings</td><td>共享全部参数</td></tr><tr><td>83.6</td><td>84.3</td><td>84.4</td></tr></tbody></table> 
<p>共享参数可带来性能微增，但却要求判别器和生成器模型结构一致！</p> 
<h3><a id="Smaller_Generators_67"></a>Smaller Generators</h3> 
<p>若生成器和判别器大小一致，则单步迭代所需算力约是MLM模型的2倍，通过实验发现，当生成器大小为判别器大小的1/4至1/2时，判别器能够获得最优性能，可能是由于<strong>判别器难以应对过于强大的生成器</strong>，而且生成器建模数据分布，而判别器需要<strong>更多参数建模生成器</strong>。</p> 
<p><img src="https://images2.imgbox.com/72/eb/jGwcBx6M_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="Training_Algorithms_72"></a>Training Algorithms</h3> 
<p>两阶段训练算法步骤：</p> 
<ol><li>训练生成器n步；</li><li>使用生成器参数初始化判别器，冻结生成器参数，训练判别器n步；</li></ol> 
<p>如图3右图可见，两阶段训练的模型性能不如联合训练，对抗训练不如最大似然训练。对抗训练性能较低的原因可能在于，强化学习在大空间尺度上的样本采样性能差，导致对抗生成器在掩码语言建模上表现较差。</p> 
<hr> 
<h2><a id="DeBERTa_Decodingenhanced_BERT_with_Disentangled_Attention_81"></a>DeBERTa: Decoding-enhanced BERT with Disentangled Attention</h2> 
<p><strong>论文链接：</strong> https://arxiv.org/abs/2006.03654</p> 
<h3><a id="DISENTANGLED_SELFATTENTION_84"></a>DISENTANGLED SELF-ATTENTION</h3> 
<p>改进自注意力机制，将不同位置的内容向量和相对位置向量的cross attention分数作为自注意力分数：<br> <img src="https://images2.imgbox.com/b0/0d/oPodgV6M_o.png" alt="在这里插入图片描述" width="400"></p> 
<p>标准自注意力机制：<br> <img src="https://images2.imgbox.com/42/36/JZkVsFnM_o.png" alt="在这里插入图片描述" width="400"></p> 
<p>引入相对位置的分散自注意力机制：<br> <img src="https://images2.imgbox.com/af/0c/x4D0q5j4_o.png" alt="在这里插入图片描述" width="600"><br> 上述矩阵各行对应各位置的向量表示，其中：</p> 
<ul><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          H 
         
        
          , 
         
         
         
           H 
          
         
           o 
          
         
        
          ∈ 
         
         
         
           R 
          
          
          
            N 
           
          
            × 
           
          
            d 
           
          
         
        
       
         H,H_o\in\R^{N\times d} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0813em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0813em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0813em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.109em;">N</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span>，表示注意力层输入、输出隐状态；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           Q 
          
         
           c 
          
         
        
          , 
         
         
         
           K 
          
         
           c 
          
         
        
          , 
         
         
         
           V 
          
         
           c 
          
         
        
       
         Q_c,K_c,V_c 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，表示经投影矩阵<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           W 
          
          
          
            q 
           
          
            , 
           
          
            c 
           
          
         
        
          , 
         
         
         
           W 
          
          
          
            k 
           
          
            , 
           
          
            c 
           
          
         
        
          , 
         
         
         
           W 
          
          
          
            v 
           
          
            , 
           
          
            c 
           
          
         
        
          ∈ 
         
         
         
           R 
          
          
          
            d 
           
          
            × 
           
          
            d 
           
          
         
        
       
         W_{q,c}, W_{k,c}, W_{v,c}\in\R^{d\times d} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">q</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">v</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span>，投影后的内容向量；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          P 
         
        
          ∈ 
         
         
         
           R 
          
          
          
            2 
           
          
            k 
           
          
            × 
           
          
            d 
           
          
         
        
       
         P\in\R^{2k\times d} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7224em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span>，表示相对位置嵌入，所有层共享；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           Q 
          
         
           r 
          
         
        
          , 
         
         
         
           K 
          
         
           r 
          
         
        
       
         Q_r,K_r 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，表示经投影矩阵<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           W 
          
          
          
            q 
           
          
            , 
           
          
            r 
           
          
         
        
          , 
         
         
         
           W 
          
          
          
            k 
           
          
            , 
           
          
            r 
           
          
         
        
          ∈ 
         
         
         
           R 
          
          
          
            d 
           
          
            × 
           
          
            d 
           
          
         
        
       
         W_{q,r},W_{k,r}\in\R^{d\times d} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">q</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span>，投影后的相对位置向量；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          softmax 
         
        
       
         \text{softmax} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">softmax</span></span></span></span></span></span>，表示做行向量归一化，输出矩阵行向量为单位向量；</li></ul> 
<h3><a id="ENHANCED_MASK_DECODER_ACCOUNTS_FOR_ABSOLUTE_WORD_POSITIONS_100"></a>ENHANCED MASK DECODER ACCOUNTS FOR ABSOLUTE WORD POSITIONS</h3> 
<p>Given a sentence “a new <strong>store</strong> opened beside the new <strong>mall</strong>” with the words “store” and “mall” masked for prediction. Using only the local context (e.g., relative positions and surrounding words) is insufficient for the model to distinguish store and mall in this sentence, <mark>since both follow the word new with the same relative positions</mark>. For example, the subject of the sentence is “store” not “mall”. These syntactical nuances depend, to a large degree, upon the words’ absolute positions in the sentence.</p> 
<blockquote> 
 <p>语法上的细微差别，很大程度上取决于单词在句子中的绝对位置。</p> 
</blockquote> 
<p>In DeBERTa, we incorporate them right after all the Transformer layers but before the softmax layer for masked token prediction, as shown in Figure 2. In this way, DeBERTa captures the relative positions in all the Transformer layers and only uses absolute positions as complementary information when decoding the masked words. Thus, we call DeBERTa’s decoding component an Enhanced Mask Decoder (EMD).</p> 
<blockquote> 
 <p>在所有transformers层之后、softmax之前，合并绝对位置信息，预测掩盖的token。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/c5/27/xrwBsM3i_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="SCALE_INVARIANT_FINETUNINGSiFT_109"></a>SCALE INVARIANT FINE-TUNING，SiFT</h3> 
<p>向标准化的word embeddings增加扰动，增强模型泛化性。</p> 
<hr> 
<h2><a id="DeBERTaV3_Improving_DeBERTa_using_ELECTRAStyle_PreTraining_with_GradientDisentangled_Embedding_Sharing_114"></a>DeBERTaV3: Improving DeBERTa using ELECTRA-Style Pre-Training with Gradient-Disentangled Embedding Sharing</h2> 
<p><strong>论文链接：</strong> https://arxiv.org/abs/2111.09543<br> <strong>主要特点：</strong></p> 
<ul><li>使用ELECTRA架构训练，以RTD代替MLM；</li><li>提出词向量梯度分散共享，优化生成器和判别器词向量共享，避免发生“tug-of-war”（激烈竞争）；</li></ul> 
<h3><a id="DeBERTa_with_RTD_119"></a>DeBERTa with RTD</h3> 
<p>Replacing the MLM objective used in DeBERTa with the RTD objective.</p> 
<h3><a id="Token_Embedding_Sharing_in_ELECTRA_122"></a>Token Embedding Sharing in ELECTRA</h3> 
<p><img src="https://images2.imgbox.com/39/a8/ZjfOn5tK_o.png" alt="在这里插入图片描述"><br> The tasks of MLM and RTD pull token embeddings into very different directions. MLM tries to map the tokens that are semantically similar to the embedding vectors that are close to each other. RTD, on the other hand, tries to discriminate semantically similar tokens, pulling their embeddings as far as possible to optimize the classification accuracy.</p> 
<p>使用不同词向量共享和梯度传播方式，词向量平均余弦相似度比较：<br> <img src="https://images2.imgbox.com/cd/54/MMgs1Q2v_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="GradientDisentangled_Embedding_Sharing_129"></a>Gradient-Disentangled Embedding Sharing</h3> 
<p>The training of GDES follows that of NES. <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          E 
         
        
          Δ 
         
        
       
      
        E_\Delta 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">Δ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is initialized as a zero matrix. In each training pass:</p> 
<ul><li>Run a forward pass with the generator to generate the inputs for the discriminator, and then run a backward pass with respect to the MLM loss to update <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           E 
          
         
           G 
          
         
        
       
         E_G 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, which is shared by both the generator and the discriminator.</li><li>Run a forward pass for the discriminator using the inputs produced by the generator, and run a backward pass with respect to the RTD loss to update ED by propagating gradients only through <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           E 
          
         
           Δ 
          
         
        
       
         E_\Delta 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">Δ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.</li><li>After model training, <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           E 
          
         
           Δ 
          
         
        
       
         E_\Delta 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">Δ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is added to <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           E 
          
         
           G 
          
         
        
       
         E_G 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and the sum is saved as <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           E 
          
         
           D 
          
         
        
       
         E_D 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> in the discriminator.</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c540a14a83f59dca6eb0fc012071adc9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">加入ASFF,优化yolov5的手与人识别任务</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2ff3c6a3ba20eb83ac5db3646bb7feb4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">电脑重装按键是什么</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>