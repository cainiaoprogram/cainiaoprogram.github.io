<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>小程序无需编程，体验IoT物联网平台-物模型开发——设备接入类 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="小程序无需编程，体验IoT物联网平台-物模型开发——设备接入类" />
<meta property="og:description" content="微信小程序码 1. 准备工作 1.1 注册阿里云账号 浏览器打开 ​​https://aliyun.com​​ ，开通阿里云账号，并通过支付宝实名认证。[](https://www.aliyun.com)
/&gt;
1.2 免费开通IoT物联网平台 在产品分类，找到物联网平台，进入产品官网，立即开通。​​https://aliyun.com/product/iot​​
2. 控制台操作步骤 2.1 创建产品 进入物联网平台的控制台，创建产品。自定义品类，数据传输JSON格式
2.2 产品功能定义 在产品详情页面的功能定义选项卡，创建产品物模型。
这里我们可以导入附录里的物模型。​​点击获取​​ 完整物模型JSON，导入前需要替换对应的产品productKey。
物模型导入成功如下：
2.3 注册设备 在产品下注册设备，获得身份三元组，如下图。
3. 微信小程序操作 3.1 设备上线 我们打开微信，扫描小程序码，进入小程序。输入设备身份三元组，点击设备上线。如下图，可以看到设备状态为在线，小程序log和设备详情页面 最后上线时间一致。
3.2 上报数据 在小程序界面，点击数据上报，我们看到模拟器上报了当前湿度，温度值。在控制台设备日志也可以查到本次消息详情，如下图。
同时，在设备详情的运行状态，也能实时看到设备上报的数据。
3.3 订阅主题和数据下行 在小程序界面，点击 订阅主题，然后我们再去控制台，设备详情页面的 Topic列表，找到对应的topic，点击发布消息。在发布消息页面，填写消息内容，点击确认。我们就会看到在小程序端展示推送消息，如下图。
同时在设备下行日志，也可以看到完整的下行消息。
3.4 物模型-服务调用 在控制台的在线调试界面，我们选中小程序设备，选中功能 开灯(switch)，输入参数{&#34;status&#34;:&#34;on&#34;},点击发送命令。小程序的灯，就会变亮。如下图。
{&#34;status&#34;:&#34;on&#34;} //status选项有：on ,off ,blue ,green 在设备详情的服务调用选项卡，也可以看到服务调用记录。如下图。
3.4 物模型-事件上报 我们在小程序界面点击告警，就会生成一条事件告警，上报当前的温度。如下图。
附录：物模型TSL { &#34;schema&#34;: &#34;https://iotx-tsl.oss-ap-southeast-1.aliyuncs.com/schema.json&#34;, &#34;profile&#34;: { &#34;productKey&#34;: &#34;替换为你的productKey&#34; }, &#34;services&#34;: [ { &#34;outputData&#34;: [], &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/121e4aaef53730c4cf7b78a3f70d65e5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-09T14:24:43+08:00" />
<meta property="article:modified_time" content="2023-03-09T14:24:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">小程序无需编程，体验IoT物联网平台-物模型开发——设备接入类</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 id="slide-0">微信小程序码</h3> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/fb/98/Te0MuVr3_o.png"></p> 
<h3 id="slide-1">1. 准备工作</h3> 
<p></p> 
<h4 id="slide-2">1.1 注册阿里云账号</h4> 
<p>浏览器打开 ​<a href="https://www.aliyun.com/" rel="nofollow" title="​https://aliyun.com​">​https://aliyun.com​</a>​ ，开通阿里云账号，并通过支付宝实名认证。[](https://www.aliyun.com)</p> 
<p>/&gt;</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/b5/3b/jtyPeSv5_o.png"></p> 
<p></p> 
<h4 id="slide-3">1.2 免费开通IoT物联网平台</h4> 
<p>在产品分类，找到物联网平台，进入产品官网，立即开通。​<a href="https://www.aliyun.com/product/iot" rel="nofollow" title="​https://aliyun.com/product/iot​">​https://aliyun.com/product/iot​</a>​</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/67/ba/5ZVf8uY3_o.png"></p> 
<h3 id="slide-4">2. 控制台操作步骤</h3> 
<p></p> 
<h4 id="slide-5">2.1 创建产品</h4> 
<p><strong> </strong>进入物联网平台的控制台，创建产品。自定义品类，数据传输JSON格式</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/ce/67/lertTBPu_o.png"></p> 
<p></p> 
<h4 id="slide-6">2.2 产品功能定义</h4> 
<p>在产品详情页面的功能定义选项卡，创建产品物模型。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/aa/15/MjHgZdKp_o.png"></p> 
<p></p> 
<p>这里我们可以导入附录里的物模型。​<a href="https://developer.aliyun.com/article/713773?spm=a2c6h.13262185.profile.29.21b46bd8sKfvMK#bc8e91a0" rel="nofollow" title="​点击获取​">​点击获取​</a>​ 完整物模型JSON，导入前需要替换对应的产品productKey。</p> 
<p>物模型导入成功如下：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/15/9c/FVH795sa_o.png"></p> 
<h4 id="slide-7">2.3 注册设备</h4> 
<p>在产品下注册设备，获得身份三元组，如下图。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/2f/19/msGlPnVK_o.png"></p> 
<p></p> 
<h3 id="slide-8">3. 微信小程序操作                  </h3> 
<p></p> 
<h4 id="slide-9">3.1 设备上线</h4> 
<p>我们打开微信，扫描小程序码，进入小程序。输入设备身份三元组，点击设备上线。如下图，可以看到设备状态为<strong>在线</strong>，小程序log和设备详情页面 最后上线时间一致。</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/34/30/0C90Revq_o.png"></p> 
<h4 id="slide-10">3.2 上报数据</h4> 
<p>在小程序界面，点击数据上报，我们看到模拟器上报了当前湿度，温度值。在控制台设备日志也可以查到本次消息详情，如下图。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/40/f8/UnKBDurE_o.png"></p> 
<p></p> 
<p>同时，在设备详情的运行状态，也能实时看到设备上报的数据。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/5b/7d/jJLb0I0K_o.png"></p> 
<h4 id="slide-11">3.3 订阅主题和数据下行</h4> 
<p>在小程序界面，点击 <strong>订阅主题</strong>，然后我们再去控制台，设备详情页面的 Topic列表，找到对应的topic，点击发布消息。在发布消息页面，填写消息内容，点击确认。我们就会看到在小程序端展示推送消息，如下图。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/36/ef/mOff7wGu_o.png"></p> 
<p></p> 
<p>同时在设备下行日志，也可以看到完整的下行消息。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/8b/6f/uWEQNpTc_o.png"></p> 
<p></p> 
<h4 id="slide-12">3.4 物模型-服务调用</h4> 
<p>在控制台的<strong>在线调试</strong>界面，我们选中小程序设备，选中功能<strong> 开灯(switch)</strong>，输入参数{"status":"on"},点击发送命令。小程序的灯，就会变亮。如下图。</p> 
<pre>{"status":"on"} //status选项有：on ,off ,blue ,green</pre> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/82/40/L1JuxEIj_o.png"></p> 
<p></p> 
<p>在设备详情的<strong>服务调用</strong>选项卡，也可以看到服务调用记录。如下图。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/2e/6b/a686wnU3_o.png"></p> 
<p></p> 
<h4 id="slide-13">3.4 物模型-事件上报</h4> 
<p> </p> 
<p>我们在小程序界面点击告警，就会生成一条事件告警，上报当前的温度。如下图。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/de/c7/BZR1HG0t_o.png"></p> 
<p></p> 
<h3 id="slide-15">附录：物模型TSL</h3> 
<pre><code class="hljs">{
  "schema": "https://iotx-tsl.oss-ap-southeast-1.aliyuncs.com/schema.json",
  "profile": {
    "productKey": "替换为你的productKey"
  },
  "services": [
    {
      "outputData": [],
      "identifier": "set",
      "inputData": [
        {
          "identifier": "temperature",
          "dataType": {
            "specs": {
              "unit": "°C",
              "min": "-20",
              "max": "80",
              "step": "0.1"
            },
            "type": "float"
          },
          "name": "温度"
        },
        {
          "identifier": "humidity",
          "dataType": {
            "specs": {
              "unit": "%",
              "min": "0",
              "max": "100",
              "step": "0.1"
            },
            "type": "float"
          },
          "name": "湿度"
        }
      ],
      "method": "thing.service.property.set",
      "name": "set",
      "required": true,
      "callType": "async",
      "desc": "属性设置"
    },
    {
      "outputData": [
        {
          "identifier": "temperature",
          "dataType": {
            "specs": {
              "unit": "°C",
              "min": "-20",
              "max": "80",
              "step": "0.1"
            },
            "type": "float"
          },
          "name": "温度"
        },
        {
          "identifier": "humidity",
          "dataType": {
            "specs": {
              "unit": "%",
              "min": "0",
              "max": "100",
              "step": "0.1"
            },
            "type": "float"
          },
          "name": "湿度"
        }
      ],
      "identifier": "get",
      "inputData": [
        "temperature",
        "humidity"
      ],
      "method": "thing.service.property.get",
      "name": "get",
      "required": true,
      "callType": "async",
      "desc": "属性获取"
    },
    {
      "outputData": [],
      "identifier": "switch",
      "inputData": [
        {
          "identifier": "status",
          "dataType": {
            "specs": {
              "length": "48"
            },
            "type": "text"
          },
          "name": "开关"
        }
      ],
      "method": "thing.service.switch",
      "name": "开灯",
      "required": false,
      "callType": "async"
    }
  ],
  "properties": [
    {
      "identifier": "temperature",
      "dataType": {
        "specs": {
          "unit": "°C",
          "min": "-20",
          "max": "80",
          "step": "0.1"
        },
        "type": "float"
      },
      "name": "温度",
      "accessMode": "rw",
      "required": true
    },
    {
      "identifier": "humidity",
      "dataType": {
        "specs": {
          "unit": "%",
          "min": "0",
          "max": "100",
          "step": "0.1"
        },
        "type": "float"
      },
      "name": "湿度",
      "accessMode": "rw",
      "required": true
    }
  ],
  "events": [
    {
      "outputData": [
        {
          "identifier": "temperature",
          "dataType": {
            "specs": {
              "unit": "°C",
              "min": "-20",
              "max": "80",
              "step": "0.1"
            },
            "type": "float"
          },
          "name": "温度"
        },
        {
          "identifier": "humidity",
          "dataType": {
            "specs": {
              "unit": "%",
              "min": "0",
              "max": "100",
              "step": "0.1"
            },
            "type": "float"
          },
          "name": "湿度"
        }
      ],
      "identifier": "post",
      "method": "thing.event.property.post",
      "name": "post",
      "type": "info",
      "required": true,
      "desc": "属性上报"
    },
    {
      "outputData": [
        {
          "identifier": "temperature",
          "dataType": {
            "specs": {
              "unit": "°C",
              "min": "0",
              "max": "10000",
              "step": "0.1"
            },
            "type": "float"
          },
          "name": "温度"
        }
      ],
      "identifier": "hotAlarm",
      "method": "thing.event.hotAlarm.post",
      "name": "温度过高报警",
      "type": "alert",
      "required": false,
      "desc": "温度过高报警"
    }
  ]
}</code></pre> 
<p></p> 
<p>物联网平台产品介绍详情：​<a href="https://www.aliyun.com/product/iot/iot_instc_public_cn" rel="nofollow" title="​https://www.aliyun.com/product/iot/iot_instc_public_cn​">​https://www.aliyun.com/product/iot/iot_instc_public_cn​</a>​</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/6a/46/8hBKTHJd_o.png"></p> 
<p style="text-align:center;">阿里云物联网平台客户交流群</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5ed2afa04b2d31f3e27af7954d98f250/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">前端大文件上传处理方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3758e6e48fd5e8abcea733988834a17a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java对接企业微信</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>