<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[JavaScript]Cookie详解(转) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[JavaScript]Cookie详解(转)" />
<meta property="og:description" content="cookie概述
假如利用一个不变的框架来存储购物栏数据，而商品显示页面是不断变化的，尽管这样能达到一个模拟全局变量的功能，但并不严谨。例如在导航框架页面内右击，单击快捷菜单中的【刷新】命令，则所有的JavaScript变量都会丢失。因此，要实现严格的跨页面全局变量，这种方式是不行的， JavaScript中的另一个机制：cookie，则可以达到真正全局变量的要求。
cookie 是浏览器提供的一种机制，它将document对象的cookie属性提供给JavaScript。可以由JavaScript对其进行控制，而并不是 JavaScript本身的性质。cookie是存于用户硬盘的一个文件，这个文件通常对应于一个域名，当浏览器再次访问这个域名时，便使这个 cookie可用。因此，cookie可以跨越一个域名下的多个网页，但不能跨越多个域名使用。
不同的浏览器对cookie的实现也不一样，但其性质是相同的。例如在Windows 2000以及Windows xp中，cookie文件存储于documents and settings\userName\cookie\文件夹下。通常的命名格式为：userName@domain.txt。
cookie机制将信息存储于用户硬盘，因此可以作为全局变量，这是它最大的一个优点。它可以用于以下几种场合。
1.保存用户登录状态。例如将用户id存储于一个cookie内，这样当用户下次访问该页面时就不需要重新登录了，现在很多论坛和社区都提供这样的功能。cookie还可以设置过期时间，当超过时间期限后，cookie就会自动消失。因此，系统往往可以提示用户保持登录状态的时间：常见选项有一个月、三个月、一年等。
2.跟踪用户行为。例如一个天气预报网站，能够根据用户选择的地区显示当地的天气情况。如果每次都需要选择所在地是烦琐的，当利用了cookie后就会显得很人性化了，系统能够记住上一次访问的地区，当下次再打开该页面时，它就会自动显示上次用户所在地区的天气情况。因为一切都是在后台完成，所以这样的页面就像为某个用户所定制的一样，使用起来非常方便。
3.定制页面。如果网站提供了换肤或更换布局的功能，那么可以使用cookie来记录用户的选项，例如：背景色、分辨率等。当用户下次访问时，仍然可以保存上一次访问的界面风格。
4.创建购物车。正如在前面的例子中使用cookie来记录用户需要购买的商品一样，在结账的时候可以统一提交。例如淘宝网就使用cookie记录了用户曾经浏览过的商品，方便随时进行比较。
当然，上述应用仅仅是cookie能完成的部分应用，还有更多的功能需要全局变量。cookie的缺点主要集中于安全性和隐私保护。主要包括以下几种：
1.cookie可能被禁用。当用户非常注重个人隐私保护时，他很可能禁用浏览器的cookie功能；
2.cookie是与浏览器相关的。这意味着即使访问的是同一个页面，不同浏览器之间所保存的cookie也是不能互相访问的；
3.cookie可能被删除。因为每个cookie都是硬盘上的一个文件，因此很有可能被用户删除；
4.cookie安全性不够高。所有的cookie都是以纯文本的形式记录于文件中，因此如果要保存用户名密码等信息时，最好事先经过加密处理。
设置cookie
每个cookie都是一个名/值对，可以把下面这样一个字符串赋值给document.cookie：
document.cookie=”userId=828″;
如果要一次存储多个名/值对，可以使用分号加空格（; ）隔开，例如：
document.cookie=”userId=828; userName=hulk”;
在cookie 的名或值中不能使用分号（;）、逗号（,）、等号（=）以及空格。在cookie的名中做到这点很容易，但要保存的值是不确定的。如何来存储这些值呢？方法是用escape()函数进行编码，它能将一些特殊符号使用十六进制表示，例如空格将会编码为“20%”，从而可以存储于cookie值中，而且使用此种方案还可以避免中文乱码的出现。例如：
document.cookie=”str=”&#43;escape(”I love ajax”);
相当于：
document.cookie=”str=I%20love%20ajax”;
当使用escape()编码后，在取出值以后需要使用unescape()进行解码才能得到原来的cookie值，这在前面已经介绍过。
尽管document.cookie看上去就像一个属性，可以赋不同的值。但它和一般的属性不一样，改变它的赋值并不意味着丢失原来的值，例如连续执行下面两条语句：
document.cookie=”userId=828″;
document.cookie=”userName=hulk”;
这时浏览器将维护两个cookie，分别是userId和userName，因此给document.cookie赋值更像执行类似这样的语句：
document.addCookie(”userId=828″);
document.addCookie(”userName=hulk”);
事实上，浏览器就是按照这样的方式来设置cookie的，如果要改变一个cookie的值，只需重新赋值，例如：
document.cookie=”userId=929″;
这样就将名为userId的cookie值设置为了929。
获取cookie的值
下面介绍如何获取cookie的值。cookie的值可以由document.cookie直接获得：
var strCookie=document.cookie;
这将获得以分号隔开的多个名/值对所组成的字符串，这些名/值对包括了该域名下的所有cookie。
在实际开发中，cookie常常需要长期保存，例如保存用户登录的状态。这可以用下面的选项来实现：
document.cookie=”userId=828; expires=GMT_String”;
其中GMT_String是以GMT格式表示的时间字符串，这条语句就是将userId这个cookie设置为GMT_String表示的过期时间，超过这个时间，cookie将消失，不可访问。
删除cookie
为了删除一个cookie，可以将其过期时间设定为一个过去的时间．
指定可访问cookie的路径
默认情况下，如果在某个页面创建了一个cookie，那么该页面所在目录中的其他页面也可以访问该cookie。如果这个目录下还有子目录，则在子目录中也可以访问。例如在　www.xxxx.com/html/a.html　中所创建的cookie，可以被　www.xxxx.com/html/b.html　或　www.xxx.com/html/ some/c.html　所访问，但不能被　www.xxxx.com/d.html　访问。
为了控制cookie可以访问的目录，需要使用path参数设置cookie，语法如下：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/55bb6e683118e8ec9dceaf306b64c382/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-02T23:27:57+08:00" />
<meta property="article:modified_time" content="2019-07-02T23:27:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[JavaScript]Cookie详解(转)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <div id="td_content"> 
  <div class="storycontent"> 
   <p><strong>cookie概述</strong></p> 
   <p>　　假如利用一个不变的框架来存储购物栏数据，而商品显示页面是不断变化的，尽管这样能达到一个模拟全局变量的功能，但并不严谨。例如在导航框架页面内右击，单击快捷菜单中的【刷新】命令，则所有的JavaScript变量都会丢失。因此，要实现严格的跨页面全局变量，这种方式是不行的， JavaScript中的另一个机制：cookie，则可以达到真正全局变量的要求。</p> 
   <p>　　cookie 是浏览器提供的一种机制，它将document对象的cookie属性提供给JavaScript。可以由JavaScript对其进行控制，而并不是 JavaScript本身的性质。cookie是存于用户硬盘的一个文件，这个文件通常对应于一个域名，当浏览器再次访问这个域名时，便使这个 cookie可用。因此，cookie可以跨越一个域名下的多个网页，但不能跨越多个域名使用。</p> 
   <p>　　不同的浏览器对cookie的实现也不一样，但其性质是相同的。例如在Windows 2000以及Windows xp中，cookie文件存储于documents and settings\userName\cookie\文件夹下。通常的命名格式为：userName@domain.txt。</p> 
   <p>　　cookie机制将信息存储于用户硬盘，因此可以作为全局变量，这是它最大的一个优点。它可以用于以下几种场合。</p> 
   <p>1.保存用户登录状态。例如将用户id存储于一个cookie内，这样当用户下次访问该页面时就不需要重新登录了，现在很多论坛和社区都提供这样的功能。cookie还可以设置过期时间，当超过时间期限后，cookie就会自动消失。因此，系统往往可以提示用户保持登录状态的时间：常见选项有一个月、三个月、一年等。</p> 
   <p>2.跟踪用户行为。例如一个天气预报网站，能够根据用户选择的地区显示当地的天气情况。如果每次都需要选择所在地是烦琐的，当利用了cookie后就会显得很人性化了，系统能够记住上一次访问的地区，当下次再打开该页面时，它就会自动显示上次用户所在地区的天气情况。因为一切都是在后台完成，所以这样的页面就像为某个用户所定制的一样，使用起来非常方便。</p> 
   <p>3.定制页面。如果网站提供了换肤或更换布局的功能，那么可以使用cookie来记录用户的选项，例如：背景色、分辨率等。当用户下次访问时，仍然可以保存上一次访问的界面风格。</p> 
   <p>4.创建购物车。正如在前面的例子中使用cookie来记录用户需要购买的商品一样，在结账的时候可以统一提交。例如淘宝网就使用cookie记录了用户曾经浏览过的商品，方便随时进行比较。</p> 
   <p>当然，上述应用仅仅是cookie能完成的部分应用，还有更多的功能需要全局变量。cookie的缺点主要集中于安全性和隐私保护。主要包括以下几种：</p> 
   <p>1.cookie可能被禁用。当用户非常注重个人隐私保护时，他很可能禁用浏览器的cookie功能；</p> 
   <p>2.cookie是与浏览器相关的。这意味着即使访问的是同一个页面，不同浏览器之间所保存的cookie也是不能互相访问的；</p> 
   <p>3.cookie可能被删除。因为每个cookie都是硬盘上的一个文件，因此很有可能被用户删除；</p> 
   <p>4.cookie安全性不够高。所有的cookie都是以纯文本的形式记录于文件中，因此如果要保存用户名密码等信息时，最好事先经过加密处理。</p> 
   <p><strong>设置cookie</strong></p> 
   <p>每个cookie都是一个名/值对，可以把下面这样一个字符串赋值给document.cookie：</p> 
   <p>document.cookie=”userId=828″;</p> 
   <p>如果要一次存储多个名/值对，可以使用分号加空格（; ）隔开，例如：</p> 
   <p>document.cookie=”userId=828; userName=hulk”;</p> 
   <p>在cookie 的名或值中不能使用分号（;）、逗号（,）、等号（=）以及空格。在cookie的名中做到这点很容易，但要保存的值是不确定的。如何来存储这些值呢？方法是用escape()函数进行编码，它能将一些特殊符号使用十六进制表示，例如空格将会编码为“20%”，从而可以存储于cookie值中，而且使用此种方案还可以避免中文乱码的出现。例如：</p> 
   <p>document.cookie=”str=”+escape(”I love ajax”);</p> 
   <p>相当于：</p> 
   <p>document.cookie=”str=I%20love%20ajax”;</p> 
   <p>当使用escape()编码后，在取出值以后需要使用unescape()进行解码才能得到原来的cookie值，这在前面已经介绍过。</p> 
   <p>尽管document.cookie看上去就像一个属性，可以赋不同的值。但它和一般的属性不一样，改变它的赋值并不意味着丢失原来的值，例如连续执行下面两条语句：</p> 
   <p>document.cookie=”userId=828″;</p> 
   <p>document.cookie=”userName=hulk”;</p> 
   <p>这时浏览器将维护两个cookie，分别是userId和userName，因此给document.cookie赋值更像执行类似这样的语句：</p> 
   <p>document.addCookie(”userId=828″);</p> 
   <p>document.addCookie(”userName=hulk”);</p> 
   <p>事实上，浏览器就是按照这样的方式来设置cookie的，如果要改变一个cookie的值，只需重新赋值，例如：</p> 
   <p>document.cookie=”userId=929″;</p> 
   <p>这样就将名为userId的cookie值设置为了929。</p> 
   <p><strong>获取cookie的值</strong></p> 
   <p>下面介绍如何获取cookie的值。cookie的值可以由document.cookie直接获得：</p> 
   <p>var strCookie=document.cookie;</p> 
   <p>这将获得以分号隔开的多个名/值对所组成的字符串，这些名/值对包括了该域名下的所有cookie。</p> 
   <p>在实际开发中，cookie常常需要长期保存，例如保存用户登录的状态。这可以用下面的选项来实现：</p> 
   <p>document.cookie=”userId=828; expires=GMT_String”;<br> 其中GMT_String是以GMT格式表示的时间字符串，这条语句就是将userId这个cookie设置为GMT_String表示的过期时间，超过这个时间，cookie将消失，不可访问。</p> 
   <p><strong>删除cookie</strong></p> 
   <p>为了删除一个cookie，可以将其过期时间设定为一个过去的时间．</p> 
   <p>指定可访问cookie的路径<br> 默认情况下，如果在某个页面创建了一个cookie，那么该页面所在目录中的其他页面也可以访问该cookie。如果这个目录下还有子目录，则在子目录中也可以访问。例如在　www.xxxx.com/html/a.html　中所创建的cookie，可以被　 www.xxxx.com/html/b.html　或　www.xxx.com/html/ some/c.html　所访问，但不能被　www.xxxx.com/d.html　访问。</p> 
   <p>为了控制cookie可以访问的目录，需要使用path参数设置cookie，语法如下：</p> 
   <p>document.cookie=”name=value; path=cookieDir”;</p> 
   <p>其中cookieDir表示可访问cookie的目录。例如：</p> 
   <p>document.cookie=”userId=320; path=/shop”;</p> 
   <p>就表示当前cookie仅能在shop目录下使用。</p> 
   <p>如果要使cookie在整个网站下可用，可以将cookie_dir指定为根目录，例如：</p> 
   <p>document.cookie=”userId=320; path=/”;</p> 
   <p>指定可访问cookie的主机名</p> 
   <p>和路径类似，主机名是指同一个域下的不同主机，例如：</p> 
   <p>www.google.com 和 gmail.google.com就是两个不同的主机名。默认情况下，一个主机中创建的cookie在另一个主机下是不能被访问的，但可以通过domain参数来实现对其的控制，其语法格式为：</p> 
   <p>document.cookie=”name=value; domain=cookieDomain”;</p> 
   <p>以google为例，要实现跨主机访问，可以写为：</p> 
   <p>document.cookie=”name=value;domain=.google.com”;</p> 
   <p>这样，所有google.com下的主机都可以访问该cookie。</p> 
   <p>综合示例：构造通用的cookie处理函数<br> cookie的处理过程比较复杂，并具有一定的相似性。因此可以定义几个函数来完成cookie的通用操作，从而实现代码的复用。下面列出了常用的cookie操作及其函数实现。</p> 
   <p>1．设置COOKIE<br> function SetCookie(name,value,expires,path,domain,secure)<br> {<!-- --><br> var expDays = expires*24*60*60*1000;<br> var expDate = new Date();<br> expDate.setTime(expDate.getTime()+expDays);<br> var expString = ((expires==null) ? “” : (”;expires=”+expDate.toGMTString()))<br> var pathString = ((path==null) ? “” : (”;path=”+path))<br> var domainString = ((domain==null) ? “” : (”;domain=”+domain))<br> var secureString = ((secure==true) ? “;secure” : “” )<br> document.cookie = name + “=” + escape(value) + expString + pathString + domainString + secureString;<br> } </p> 
   <p>2．获取指定名称的cookie值：<br> function GetCookie(name)<br> {<!-- --><br> var result = null;<br> var myCookie = document.cookie + “;”;<br> var searchName = name + “=”;<br> var startOfCookie = myCookie.indexOf(searchName);<br> var endOfCookie;<br> if (startOfCookie != -1)<br> {<!-- --><br> startOfCookie += searchName.length;<br> endOfCookie = myCookie.indexOf(”;”,startOfCookie);<br> result = unescape(myCookie.substring(startOfCookie, endOfCookie));<br> }<br> return result;<br> } </p> 
   <p>3．删除指定名称的cookie：<br> function ClearCookie(name)<br> {<!-- --><br> var ThreeDays=3*24*60*60*1000;<br> var expDate = new Date();<br> expDate.setTime(expDate.getTime()-ThreeDays);<br> document.cookie=name+”=;expires=”+expDate.toGMTString();<br> } </p> 
  </div> 
 </div> 
 <p align="center"><br><strong><a name="trackback"></a>引用地址：<a href="http://blog.programfan.com/trackback.asp?id=24189" rel="nofollow">http://blog.programfan.com/trackback.asp?id=24189</a></strong></p> 
</div> 
<p>转载于:https://www.cnblogs.com/hdjjun/archive/2008/09/28/1301287.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b05685e78443f4e1bb9af75ac8100eab/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">TKmybatis和mybatisplus哪个好用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1b378b491dc659d4fe24c7a595e43c74/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux用户空间内存区域的匿名映射</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>