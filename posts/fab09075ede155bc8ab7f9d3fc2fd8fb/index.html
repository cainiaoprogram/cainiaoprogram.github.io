<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PowerShell系列（五）：PowerShell通过脚本方式运行笔记 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PowerShell系列（五）：PowerShell通过脚本方式运行笔记" />
<meta property="og:description" content="目录
一、四种执行方式介绍
1、当前文件夹运行命令
2、直接指定完整文件路径执行
3、通过cmd命令直接执行
4、通过Windows计划任务执行PowerShell脚本
二、通过脚本方式执行命令的优势
往期回顾 PowerShell系列（一）：PowerShell介绍和cmd命令行的区别
PowerShell系列（二）：PowerShell和Python之间的差异介绍
PowerShell系列（三）：PowerShell发展历程梳理
PowerShell系列（四）：PowerShell进入交互环境的三种方式
PowerShell 是一种用于操作 系统的命令行界面，支持跨平台，它提供了许多功能来自动化和优化各种任务。PowerShell 是由微软官方开发的，并作为 Windows Server 操作系统的一部分提供。 使用 PowerShell，您可以执行许多运维操作，例如创建、编辑、查看和删除文件和文件夹，管理用户和计算机，配置网络设置，运行系统命令，自动化测试和部署等。今天继续给大家分享PowerShell系列教程。
上一篇文章讲解了Powershell通过交互环境运行命令的相关知识，今天给大家介绍实际工作当中使用最频繁的方式——通过脚本运行，简单来说就是和咱们实际编写代码一样，先编写代码，然后通过开发工具执行。同样的为了实现PowerShell脚本的保存、方面在别的服务器迁移，一般都是先编写脚本，然后通过脚本文件执行完成相应的运维任务。
PowerShell通过脚本方式的好处主要有以下几条：
可以将常见的运维操作封装成脚本，方便后续的重复使用和维护。可以使用 PowerShell 的强大功能来自动化和优化服务器的各种任务。可以将 PowerShell 脚本与其他软件和工具集成，从而提高工作效率。可以使用 PowerShell 脚本来执行任何类型的操作，包括系统管理、安全、性能优化和自动化测试等场景。可以通过 PowerShell 脚本来定义和执行自定义命令和操作，以满足特定的需求和环境。 总得来说使用 PowerShell 脚本可以让您更加高效地管理和操作系统，提高工作效率并增强系统的可维护性。下面给大家详细介绍一下。
案例脚本
首先打开 WindowPowerShell ISE 开发环境新建一个test.ps1，脚本内容如下：
$arr1=1..10 #定义一个1~10的数组 $arr1 #打印数组 一、四种执行方式介绍 1、当前文件夹运行命令 进入存放脚本文件的命令，然后执行：
.\psl1脚本文件
我的脚本文件存放在F盘的桌面目录执行命令如下：
F #进入F盘 cd 桌面 #进入桌面文件夹 .\test.ps1 #运行命令 2、直接指定完整文件路径执行 完整psl1脚本文件
F:\桌面\test.ps1 具体如下图 3、通过cmd命令直接执行 需要加关键字PowerShell才可以识别是执行的PowerShell命令。
命令格式：PowerShell ps1脚本文件完整路径
4、通过Windows计划任务执行PowerShell脚本 PowerShell 脚本默认无法执行，需要先修改 PowerShell 执行策略（ExecutionPolicy）命令如下：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/fab09075ede155bc8ab7f9d3fc2fd8fb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-08T21:57:38+08:00" />
<meta property="article:modified_time" content="2023-06-08T21:57:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PowerShell系列（五）：PowerShell通过脚本方式运行笔记</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E5%9B%9B%E7%A7%8D%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8F%E4%BB%8B%E7%BB%8D-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E5%9B%9B%E7%A7%8D%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8F%E4%BB%8B%E7%BB%8D" rel="nofollow">一、四种执行方式介绍</a></p> 
<p id="1%E3%80%81%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E5%A4%B9%E8%BF%90%E8%A1%8C%E5%91%BD%E4%BB%A4-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E5%A4%B9%E8%BF%90%E8%A1%8C%E5%91%BD%E4%BB%A4" rel="nofollow">1、当前文件夹运行命令</a></p> 
<p id="2%E3%80%81%E7%9B%B4%E6%8E%A5%E6%8C%87%E5%AE%9A%E5%AE%8C%E6%95%B4%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E6%89%A7%E8%A1%8C-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E7%9B%B4%E6%8E%A5%E6%8C%87%E5%AE%9A%E5%AE%8C%E6%95%B4%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E6%89%A7%E8%A1%8C" rel="nofollow">2、直接指定完整文件路径执行</a></p> 
<p id="3%E3%80%81%E9%80%9A%E8%BF%87cmd%E5%91%BD%E4%BB%A4%E7%9B%B4%E6%8E%A5%E6%89%A7%E8%A1%8C-toc" style="margin-left:40px;"><a href="#3%E3%80%81%E9%80%9A%E8%BF%87cmd%E5%91%BD%E4%BB%A4%E7%9B%B4%E6%8E%A5%E6%89%A7%E8%A1%8C" rel="nofollow">3、通过cmd命令直接执行</a></p> 
<p id="4%E3%80%81%E9%80%9A%E8%BF%87Windows%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8CPowerShell%E8%84%9A%E6%9C%AC-toc" style="margin-left:40px;"><a href="#4%E3%80%81%E9%80%9A%E8%BF%87Windows%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8CPowerShell%E8%84%9A%E6%9C%AC" rel="nofollow">4、通过Windows计划任务执行PowerShell脚本</a></p> 
<p id="%E4%BA%8C%E3%80%81%E9%80%9A%E8%BF%87%E8%84%9A%E6%9C%AC%E6%96%B9%E5%BC%8F%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E7%9A%84%E4%BC%98%E5%8A%BF-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E9%80%9A%E8%BF%87%E8%84%9A%E6%9C%AC%E6%96%B9%E5%BC%8F%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E7%9A%84%E4%BC%98%E5%8A%BF" rel="nofollow">二、通过脚本方式执行命令的优势</a></p> 
<hr id="hr-toc"> 
<p><img alt="" height="443" src="https://images2.imgbox.com/8c/aa/cSQcEWD7_o.png" width="1023"></p> 
<p></p> 
<h3><strong>往期回顾</strong></h3> 
<div> 
 <p style="margin-left:0;text-align:left;"><a class="link-info" href="https://blog.csdn.net/xishining/article/details/130524280" title="PowerShell系列（一）：PowerShell介绍和cmd命令行的区别">PowerShell系列（一）：PowerShell介绍和cmd命令行的区别</a></p> 
 <p style="margin-left:0;text-align:left;"><a class="link-info" href="https://blog.csdn.net/xishining/article/details/130571977" title="PowerShell系列（二）：PowerShell和Python之间的差异介绍">PowerShell系列（二）：PowerShell和Python之间的差异介绍</a></p> 
 <p style="margin-left:0;text-align:left;"><a class="link-info" href="https://blog.csdn.net/xishining/article/details/130702980" title="PowerShell系列（三）：PowerShell发展历程梳理">PowerShell系列（三）：PowerShell发展历程梳理</a></p> 
 <p style="margin-left:0;text-align:left;"><a class="link-info" href="https://blog.csdn.net/xishining/article/details/130836734" title="PowerShell系列（四）：PowerShell进入交互环境的三种方式">PowerShell系列（四）：PowerShell进入交互环境的三种方式</a></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <p style="margin-left:0;text-align:left;">PowerShell 是一种用于操作 系统的命令行界面，支持跨平台，它提供了许多功能来自动化和优化各种任务。PowerShell 是由微软官方开发的，并作为 Windows Server 操作系统的一部分提供。 使用 PowerShell，您可以执行许多运维操作，例如创建、编辑、查看和删除文件和文件夹，管理用户和计算机，配置网络设置，运行系统命令，自动化测试和部署等。今天继续给大家分享PowerShell系列教程。</p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">上一篇文章讲解了Powershell通过交互环境运行命令的相关知识，今天给大家介绍实际工作当中使用最频繁的方式——通过脚本运行，简单来说就是和咱们实际编写代码一样，先编写代码，然后通过开发工具执行。同样的为了实现PowerShell脚本的保存、方面在别的服务器迁移，一般都是先编写脚本，然后通过脚本文件执行完成相应的运维任务。</span></p> 
 <p>PowerShell通过脚本方式的好处主要有以下几条：</p> 
 <ul><li>可以将常见的运维操作封装成脚本，方便后续的重复使用和维护。</li><li>可以使用 PowerShell 的强大功能来自动化和优化服务器的各种任务。</li><li>可以将 PowerShell 脚本与其他软件和工具集成，从而提高工作效率。</li><li>可以使用 PowerShell 脚本来执行任何类型的操作，包括系统管理、安全、性能优化和自动化测试等场景。</li><li>可以通过 PowerShell 脚本来定义和执行自定义命令和操作，以满足特定的需求和环境。</li></ul> 
 <p>总得来说使用 PowerShell 脚本可以让您更加高效地管理和操作系统，提高工作效率并增强系统的可维护性。下面给大家详细介绍一下。</p> 
 <p style="margin-left:0;text-align:left;"><strong>案例脚本</strong></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">首先打开 WindowPowerShell ISE 开发环境新建一个test.ps1，脚本内容如下：</span></p> 
 <pre><span style="background-color:#fafafa;"><code><span style="color:#ee9900;">$arr1</span><span style="color:#000000;">=1</span><span style="color:#999999;">..</span><span style="color:#000000;">10 </span><span style="color:#708090;">#定义一个1~10的数组 </span>
<span style="color:#ee9900;">$arr1</span>  <span style="color:#708090;">#打印数组</span>
</code></span>
</pre> 
 <h2 id="%E4%B8%80%E3%80%81%E5%9B%9B%E7%A7%8D%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8F%E4%BB%8B%E7%BB%8D" style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">一、四种执行方式介绍</span></strong></h2> 
 <p></p> 
 <h3 id="1%E3%80%81%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E5%A4%B9%E8%BF%90%E8%A1%8C%E5%91%BD%E4%BB%A4" style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">1、当前文件夹运行命令</span></strong></h3> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">进入存放脚本文件的命令，然后执行：</span></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">.\psl1脚本文件</span></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">我的脚本文件存放在F盘的桌面目录执行命令如下：</span></p> 
 <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">F</span><span style="color:#000000;">  #</span><span style="color:#000000;">进入F盘</span>
<span style="color:#000000;">cd 桌面</span><span style="color:#000000;"> #</span><span style="color:#000000;">进入桌面文件夹</span>
<span style="color:#000000;"> .\test.ps1</span><span style="color:#000000;">  #</span><span style="color:#000000;">运行命令</span>

</code></span></pre> 
 <p><img alt="" height="582" src="https://images2.imgbox.com/81/d3/eK8UTs9I_o.png" width="1156"></p> 
 <p></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <h3 id="2%E3%80%81%E7%9B%B4%E6%8E%A5%E6%8C%87%E5%AE%9A%E5%AE%8C%E6%95%B4%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E6%89%A7%E8%A1%8C" style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">2、直接指定完整文件路径执行</span></strong></h3> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">完整psl1脚本文件</span></p> 
 <p style="margin-left:0;text-align:left;"><img alt="" height="577" src="https://images2.imgbox.com/c9/5a/Me87zbzg_o.png" width="1200"></p> 
 <p></p> 
 <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">F:\桌面\test.ps1</span>
</code></span>
<span style="color:#333333;">具体如下图</span></pre> 
 <p class="img-center"><img alt="" src="https://images2.imgbox.com/07/a3/qEzDGW1s_o.png"></p> 
 <h3 id="3%E3%80%81%E9%80%9A%E8%BF%87cmd%E5%91%BD%E4%BB%A4%E7%9B%B4%E6%8E%A5%E6%89%A7%E8%A1%8C" style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">3、通过cmd命令直接执行</span></strong></h3> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">需要加关键字PowerShell才可以识别是执行的PowerShell命令。</span></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">命令格式：PowerShell  ps1脚本文件完整路径</span></p> 
 <p style="margin-left:0;text-align:left;"><img alt="" height="498" src="https://images2.imgbox.com/ae/81/tMRW4oTd_o.png" width="967"></p> 
 <p></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <h3 id="4%E3%80%81%E9%80%9A%E8%BF%87Windows%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8CPowerShell%E8%84%9A%E6%9C%AC" style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">4、通过Windows计划任务执行PowerShell脚本</span></strong></h3> 
 <p style="margin-left:0;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#333333;">PowerShell 脚本默认无法执行，需要先修改 PowerShell 执行策略（ExecutionPolicy）命令如下：</span></span></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;"> set-ExecutionPolicy RemoteSigned</span>
</code></span></pre> 
 <p></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">说明：关于PowerShell的策略问题，下篇文章会进行详细讲解。</span></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">输入上面的命令后会提示我们如何对策略进行修改，这里我们选择y，然后按下回车键。</span></p> 
 <p class="img-center"><img alt="" src="https://images2.imgbox.com/b4/f6/NqHEUpzS_o.png"></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">首先打开Windows任务计划程序</span></p> 
 <p class="img-center"><img alt="" src="https://images2.imgbox.com/82/18/GRRYTYkH_o.png"></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">创建一个计划任务</span></p> 
 <p style="margin-left:0;text-align:left;"><img alt="" height="591" src="https://images2.imgbox.com/18/79/u31RDBqe_o.png" width="1108"></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">打开创建计划任务常规选项卡，然后输入名称和描述，具体如下图：</span></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <p><img alt="" height="531" src="https://images2.imgbox.com/75/d2/GkEhoFTY_o.png" width="621"></p> 
 <p></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">切换到触发器选项卡，设置每五分钟执行一次。</span></p> 
 <p style="margin-left:0;text-align:left;"><img alt="" height="540" src="https://images2.imgbox.com/b6/fd/vjZBelhG_o.png" width="623"></p> 
 <p> <span style="color:#333333;">切换到操作选项卡，新建操作设置执行脚本文件</span></p> 
 <p style="margin-left:0;text-align:left;"></p> 
 <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">powershell</span>
</code></span></pre> 
 <p><span style="color:#000000;">添加参数 </span></p> 
 <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;"> F:\桌面\test.ps1</span>
</code></span></pre> 
 <p></p> 
 <p class="img-center"><img alt="" src="https://images2.imgbox.com/07/c6/N5EOVf0O_o.png"></p> 
 <p style="margin-left:0;text-align:left;"><span style="color:#333333;">然后就可以正常运行该计划了。</span></p> 
 <h2 id="%E4%BA%8C%E3%80%81%E9%80%9A%E8%BF%87%E8%84%9A%E6%9C%AC%E6%96%B9%E5%BC%8F%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E7%9A%84%E4%BC%98%E5%8A%BF" style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">二、通过脚本方式执行命令的优势</span></strong></h2> 
 <ol><li style="text-align:left;"><span style="color:#333333;">方便迁移，比如在之前工作经验积累下来的运维脚本，可以保存下来。如果业务场景用的到的话，直接文件拷贝过来就可以运行。</span></li><li style="text-align:left;"><span style="color:#333333;">提升脚本的可读性。针对一些复杂的运维脚本，如果通过交互命令方式，如果命令非常多且比较复杂的话，那么脚本可读性就大打折扣了。建议针对复杂运维命令的话，注释一定要写的比较清晰，方便后续使用和运维。</span></li><li style="text-align:left;"><span style="color:#333333;">脚本编写效率大大提高。交互执行的方式会存在脚本思维的跳跃。不利于脚本整体逻辑的把控。</span></li><li style="text-align:left;"><span style="color:#333333;">定时任务的实现。通过脚本方式可以很方便的脚本文件周期重复性执行，这样就达到了定时任务的目的。</span></li></ol> 
 <p style="margin-left:0;text-align:left;"></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ca7e58c25bfffe7341e07ab8e5960b8d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">护网HW（红蓝队）小白必知必会</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5a21448a642ec021f508cf954d113767/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux系统简介-虚拟机安装教程(保姆级)-Linux常用命令</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>