<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>力扣 (LeetCode) - Database-刷题601--体育馆的人流量 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="力扣 (LeetCode) - Database-刷题601--体育馆的人流量" />
<meta property="og:description" content="目录
题目描述：
我的答案：
答案解析：
题目描述： 表：Stadium
&#43;---------------&#43;---------&#43;
| Column Name | Type |
&#43;---------------&#43;---------&#43;
| id | int |
| visit_date | date |
| people | int |
&#43;---------------&#43;---------&#43;
visit_date 是表的主键
每日人流量信息被记录在这三列信息中：序号 (id)、日期 (visit_date)、 人流量 (people)
每天只有一行记录，日期随着 id 的增加而增加
编写一个 SQL 查询以找出每行的人数大于或等于 100 且 id 连续的三行或更多行记录。
返回按 visit_date 升序排列的结果表。
查询结果格式如下所示。
Stadium table:
&#43;------&#43;------------&#43;-----------&#43;
| id | visit_date | people |
&#43;------&#43;------------&#43;-----------&#43;
| 1 | 2017-01-01 | 10 |" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/57cd717f165b1d3b4e21f7bd8c4bcdd8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-25T09:56:27+08:00" />
<meta property="article:modified_time" content="2020-11-25T09:56:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">力扣 (LeetCode) - Database-刷题601--体育馆的人流量</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0%EF%BC%9A-toc" style="margin-left:0px;"><a href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0%EF%BC%9A" rel="nofollow">题目描述：</a></p> 
<p id="%E6%88%91%E7%9A%84%E7%AD%94%E6%A1%88%EF%BC%9A-toc" style="margin-left:0px;"><a href="#%E6%88%91%E7%9A%84%E7%AD%94%E6%A1%88%EF%BC%9A" rel="nofollow">我的答案：</a></p> 
<p id="%E7%AD%94%E6%A1%88%E8%A7%A3%E6%9E%90%EF%BC%9A-toc" style="margin-left:0px;"><a href="#%E7%AD%94%E6%A1%88%E8%A7%A3%E6%9E%90%EF%BC%9A" rel="nofollow">答案解析：</a></p> 
<hr id="hr-toc"> 
<hr> 
<h2 id="%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0%EF%BC%9A"><span style="color:#f33b45;">题目描述：</span></h2> 
<p>表：Stadium<br> +---------------+---------+<br> | Column Name   | Type    |<br> +---------------+---------+<br> | id            | int     |<br> | visit_date    | date    |<br> | people        | int     |<br> +---------------+---------+<br> visit_date 是表的主键<br> 每日人流量信息被记录在这三列信息中：序号 (id)、日期 (visit_date)、 人流量 (people)<br> 每天只有一行记录，日期随着 id 的增加而增加<br>  </p> 
<p>编写一个 SQL 查询以找出每行的人数大于或等于 100 且 id 连续的三行或更多行记录。</p> 
<p>返回按 visit_date 升序排列的结果表。</p> 
<p>查询结果格式如下所示。</p> 
<p>Stadium table:<br> +------+------------+-----------+<br> | id   | visit_date | people    |<br> +------+------------+-----------+<br> | 1    | 2017-01-01 | 10        |<br> | 2    | 2017-01-02 | 109       |<br> | 3    | 2017-01-03 | 150       |<br> | 4    | 2017-01-04 | 99        |<br> | 5    | 2017-01-05 | 145       |<br> | 6    | 2017-01-06 | 1455      |<br> | 7    | 2017-01-07 | 199       |<br> | 8    | 2017-01-09 | 188       |<br> +------+------------+-----------+</p> 
<p>Result table:<br> +------+------------+-----------+<br> | id   | visit_date | people    |<br> +------+------------+-----------+<br> | 5    | 2017-01-05 | 145       |<br> | 6    | 2017-01-06 | 1455      |<br> | 7    | 2017-01-07 | 199       |<br> | 8    | 2017-01-09 | 188       |<br> +------+------------+-----------+<br> id 为 5、6、7、8 的四行 id 连续，并且每行都有 &gt;= 100 的人数记录。<br> 请注意，即使第 7 行和第 8 行的 visit_date 不是连续的，输出也应当包含第 8 行，因为我们只需要考虑 id 连续的记录。<br> 不输出 id 为 2 和 3 的行，因为至少需要三条 id 连续的记录。</p> 
<hr> 
<h2 id="%E6%88%91%E7%9A%84%E7%AD%94%E6%A1%88%EF%BC%9A"><span style="color:#f33b45;">我的答案：</span></h2> 
<pre><code class="language-sql">select distinct a.id,a.visit_date,a.people from Stadium as a, Stadium as b, Stadium as c where a.people&gt;=100 and b.people&gt;=100 and c.people&gt;=100 and 
((a.id-b.id=1 and b.id-c.id=1) or
 (b.id-a.id=1 and a.id-c.id=1) or
 (c.id-b.id=1 and b.id-a.id=1)
) order by a.id</code></pre> 
<hr> 
<h2 id="%E7%AD%94%E6%A1%88%E8%A7%A3%E6%9E%90%EF%BC%9A"><span style="color:#f33b45;">答案解析：</span></h2> 
<p>主要考察筛选的逻辑</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f41af2afda0a20d0f91a781eac961fe6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python念数字的题目_python练习题-day18</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a2da19c9741a4776627d891dbc1f8e30/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">elementUI 学习入门之 Button 按钮</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>