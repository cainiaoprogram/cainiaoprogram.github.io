<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>nfs常见问题解决方法 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="nfs常见问题解决方法" />
<meta property="og:description" content="网络文件服务器（Network File System，简称NFS），是分布式计算系统的一个组成部分，可实现在异种网络上共享和装配远程文件系统。NFS由Sun公司开发，目前已经成为文件服务的一种标准（RFC1904，RFC1813）。其最大的功能就是可以通过网络，让不同操作系统的计算机可以共享数据，所以也可以将它看做是一个文件服务器。
NFS网络出现了故障，可以从以下几个方面着手检查：
（1） 检查NFS客户机和服务器的负荷是否太高，Server和Client之间的网络是否正常；
（2） 检查/etc/exports文件的正确性；
（3） 必要时重新启动NFS或portmap服务；
（4）运行下列命令重新启动portmap和NFS:
service portmap restart service nfs start
（5） 检查Client上的mount命令或/etc/fstab的语法是否正确;
（6） 查看内核是否支持NFS和RPC服务。
附加：★NFS常见故障排除 -------------------
1、The rpcbind failure error 故障现象： nfs mount: server1:: RPC: Rpcbind failure RPC: Timed Out nfs mount: retrying: /mntpoint 原因： 第一，可能因为客户机的hosts文件中存在错误的ip地址、主机名或节点名组合； 第二，服务器因为过载而暂时停止服务。 2、The server not responding error 现象： NFS server server2 not responding, still trying 原因： 第一，网络不通，用ping命令检测一下。 第二，服务器关机。 3、The NFS client fails a reboot error 现象： 启动客户机后停住了，不断显示如下提示信息： Setting default interface for multicast: add net 224." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a437c9758e393ab80d37ade015381e47/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-03-31T17:03:00+08:00" />
<meta property="article:modified_time" content="2011-03-31T17:03:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">nfs常见问题解决方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>网络文件服务器（Network File System，简称NFS），是分布式计算系统的一个组成部分，可实现在异种网络上共享和装配远程文件系统。NFS由Sun公司开发，目前已经成为文件服务的一种标准（RFC1904，RFC1813）。其最大的功能就是可以通过网络，让不同操作系统的计算机可以共享数据，所以也可以将它看做是一个文件服务器。</p> 
<p>    NFS网络出现了故障，可以从以下几个方面着手检查：</p> 
<p>    （1） 检查NFS客户机和服务器的负荷是否太高，Server和Client之间的网络是否正常；</p> 
<p>    （2） 检查/etc/exports文件的正确性；</p> 
<p>    （3） 必要时重新启动NFS或portmap服务；</p> 
<p>    （4）运行下列命令重新启动portmap和NFS:</p> 
<p>    service portmap restart service nfs start<br> </p> 
<p><br>    （5） 检查Client上的mount命令或/etc/fstab的语法是否正确;</p> 
<p>    （6） 查看内核是否支持NFS和RPC服务。</p> 
<p> </p> 
<p><br>附加：★NFS常见故障排除 <br>-------------------<br>1、The rpcbind failure error <br>故障现象： <br>nfs mount: server1:: RPC: Rpcbind failure <br>RPC: Timed Out <br>nfs mount: retrying: /mntpoint <br>原因： <br>第一，可能因为客户机的hosts文件中存在错误的ip地址、主机名或节点名组合； <br>第二，服务器因为过载而暂时停止服务。 </p> 
<p>2、The server not responding error <br>现象： <br>NFS server server2 not responding, still trying <br>原因： <br>第一，网络不通，用ping命令检测一下。 <br>第二，服务器关机。 </p> 
<p>3、The NFS client fails a reboot error <br>现象： <br>启动客户机后停住了，不断显示如下提示信息： <br>Setting default interface for multicast: add net 224.0.0.0: gateway: <br>client_node_name. <br>原因： <br>在etc/vfstab的mount选项中使用了fg而又无法成功mount服务器上的资源，改成bg或将该行注释掉，直到服务器可用为止。 </p> 
<p>4、The service not responding error <br>现象： <br>nfs mount: dbserver: NFS: Service not responding <br>nfs mount: retrying: /mntpoint <br>原因： <br>第一，当前级别不是级别3，用who –r查看，用init切换。 <br>第二，NFS Server守护进程不存在，用ps –ef | grep nfs检查，用/etc/init.d/nfs.server start启动。 </p> 
<p>5、The program not registered error <br>现象： <br>nfs mount: dbserver: RPC: Program not registered <br>nfs mount: retrying: /mntpoint <br>原因： <br>第一，当前级别不是级别3。 <br>第二，mountd守护进程没有启动，用/etc/init.d/nfs.server脚本启动NFS守护进程。 <br>第三，看/etc/dfs/dfstab中的条目是否正常。 </p> 
<p>6、The stale file handle error <br>现象： <br>stale NFS file handle <br>原因： <br>服务器上的共享资源移动位置了，在客户端使用umount和mount重新挂接就可以了。 </p> 
<p>7、The unknown host error <br>现象： <br>nfs mount: sserver1:: RPC: Unknown host <br>原因： <br>hosts文件中的内容不正确。 </p> 
<p>8、The mount point error <br>现象： <br>mount: mount-point /DS9 does not exist. <br>原因： <br>该挂接点在客户机上不存在，注意检查命令行或/etc/vfstab文件中相关条目的拼写。 </p> 
<p>9、The no such file error <br>现象： <br>No such file or directory. <br>原因： <br>该挂接点在服务器上不存在，注意检查命令行或/etc/vfstab文件中相关条目的拼写。</p> 
<p>10、No route to host <br>错误现象：<br>[root@msa30 sysconfig]# mount 10.10.11.211:/opt/b2b-data/xmldb  /b2b-web1/b2b-data/xmldb  -t nfs  -o rw<br>mount: mount to NFS server '10.10.11.211' failed: System Error: No route to host.</p> 
<p>原因：<br>防火墙被打开，关闭防火墙。</p> 
<p>11、Not owner<br>现象：<br>[root@msa30:/founder/shell]# mount -F nfs -o rw 10.10.2.3:/mnt/b2b/b2b-data/resinfo2 /data/b2b-data/resinfo2<br>nfs mount: mount: /data/b2b-data/resinfo2: Not owner</p> 
<p>原因：<br>这是Solaris 10版本挂载较低版本nfs时报的错误。</p> 
<p>解决：<br>需要用-o vers=3参数</p> 
<p>示例：<br>[root@msa30:/founder/shell]# mount -F nfs -o vers=3  10.10.2.3:/mnt/b2b/b2b-data/resinfo2 /data/b2b-data/resinfo2</p> 
<p>12、RPC: Program not registered &amp; retrying<br>现象：<br>nfs mount: 10.10.2.3: : RPC: Program not registered<br>nfs mount: retrying: /data/b2b-data/resinfo2</p> 
<p>原因：<br>没有启动NFS共享端服务。</p> 
<p>解决：需要重新启动share端的NFS服务，<br>Linux:<br>mount: RPC: Program not registered<br>#service nfs restart</p> 
<p>Solaris:<br>mount: RPC: Program not registered<br>#/etc/rc.d/init.d/nfs restart</p> 
<p>13、can't contact portmapper: RPC: Remote system error - Connection refused<br>现象：<br>#exportfs -a<br>can't contact portmapper: RPC: Remote system error - Connection refused</p> 
<p>原因：<br>出现这个错误信息是由于SEVER端的PORTMAP没有启动。</p> 
<p>解决：<br>#service portmap start<br>#service pcmcia start</p> 
<p> </p> 
<p> </p> 
<p>----------------------------------------------------------------------------</p> 
<div style="background: #f8f8f8; mso-element: para-border-div; mso-border-alt: none black 0cm; mso-shading: windowtext; mso-pattern: solid #F8F8F8; border: black 1pt; padding: 0cm;"> 
 <p class="MsoNormal" style="background: #f8f8f8; margin: 7.5pt 0cm; text-indent: 21pt; line-height: 19.5pt; mso-border-alt: none black 0cm; mso-shading: windowtext; mso-pattern: solid #F8F8F8; mso-padding-alt: 0cm 0cm 0cm 0cm; padding: 0cm;"><span style="background: #f8f8f8; color: black; font-family: 宋体;"><span style="font-size: small;"><strong><span style="text-decoration: underline;"><span lang="EN-US">NFS</span>故障解决:</span></strong></span><span lang="EN-US"><br><span style="font-size: small;">1</span></span><span style="font-size: small;">、<span lang="EN-US">NFSD</span>没有启动起来</span><span lang="EN-US"><br></span><span style="font-size: small;">首先要确认<span lang="EN-US"> NFS </span>输出列表存在，否则<span lang="EN-US"> nfsd </span>不会启动。可用<span lang="EN-US"> exportfs </span>命令来检查，如果<span lang="EN-US"> exportfs </span>命令没有结果返回或返回不正确，则需要检查<span lang="EN-US"> /etc/exports </span>文件。</span><span lang="EN-US"><br><span style="font-size: small;">2</span></span><span style="font-size: small;">、<span lang="EN-US">mountd </span>进程没有启动</span><span lang="EN-US"><br><span style="font-size: small;">mountd </span></span><span style="font-size: small;">进程是一个远程过程调用<span lang="EN-US"> (RPC) </span>，其作用是对客户端要求安装（<span lang="EN-US">mount</span>）文件系统的申请作出响应。<span lang="EN-US">mountd</span>进程通过查找<span lang="EN-US"> /etc/xtab</span>文件来获知哪些文件系统可以被远程客户端使用。另外，通过<span lang="EN-US">mountd</span>进程，用户可以知道目前有哪些文件系统已被远程文件系统装配，并得知远程客户端的列表。查看<span lang="EN-US">mountd</span>是否正常启动起来可以使用命令<span lang="EN-US">rpcinfo</span>进行查看，在正常情况下在输出的列表中应该象这样的行：</span><span lang="EN-US"><br><span style="font-size: small;">100005 1 udp 1039 mountd<br>100005 1 tcp 1113 mountd<br>100005 2 udp 1039 mountd<br>100005 2 tcp 1113 mountd<br>100005 3 udp 1039 mountd<br>100005 3 tcp 1113 mountd<br></span></span><span style="font-size: small;">如果没有起来的话可以检查是否安装了<span lang="EN-US">PORTMAP</span>组件。</span><span lang="EN-US"><br><span style="font-size: small;">rpm -qa|grep portmap<br>3</span></span><span style="font-size: small;">、</span><span style="font-size: small;"><span lang="EN-US">fs type nfs no supported by kernel<br>kernel</span>不支持<span lang="EN-US">nfs</span>文件系统，重新编译一下<span lang="EN-US">KERNEL</span>就可以解决。</span><span lang="EN-US"><br><span style="font-size: small;">4</span></span><span style="font-size: small;">、</span><span style="font-size: small;"><span lang="EN-US">cant contact portmapper: RPC: Remote system error - Connection refused<br></span>出现这个错误信息是由于<span lang="EN-US">SEVER</span>端的<span lang="EN-US">PORTMAP</span>没有启动。</span><span lang="EN-US"><br><span style="font-size: small;">5</span></span><span style="font-size: small;">、</span><span style="font-size: small;"><span lang="EN-US">mount clntudp_create: RPC: Program not registered<br>NFS</span>没有启动起来，可以用<span lang="EN-US">showmout -e host</span>命令来检查<span lang="EN-US">NFS SERVER</span>是否正常启动起来。</span><span lang="EN-US"><br><span style="font-size: small;">6</span></span><span style="font-size: small;">、</span><span style="font-size: small;"><span lang="EN-US">mount: localhost:/home/test failed, reason given by server: Permission denied<br></span>这个提示是当<span lang="EN-US">client</span>要<span lang="EN-US">mount nfs server</span>时可能出现的提示，意思是说本机没有权限去<span lang="EN-US">mount nfs server</span>上的目录。解决方法当然是去修改<span lang="EN-US">NFS SERVER</span>咯。</span><span lang="EN-US"><br><span style="font-size: small;">7</span></span><span style="font-size: small;">、被防火墙阻挡</span><span lang="EN-US"><br></span><span style="font-size: small;">这个原因很多人都忽视了，在有严格要求的网络环境中，我们一般会关闭<span lang="EN-US">linux</span>上的所有端口，当需要使用哪个端口的时候才会去打开。而<span lang="EN-US">NFS</span>默认是使用<span lang="EN-US">111</span>端口，所以我们先要检测是否打开了这个端口，另外也要检查<span lang="EN-US">TCP_Wrappers</span>的设定。<span lang="EN-US"></span></span></span></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/df030f69a674bb2274521307ebbd5082/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">安全策略禁止本机管理员登录解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2929da4c59fbec1b14b2ef5779f480eb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java 可以或得到的全部的时区ID</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>