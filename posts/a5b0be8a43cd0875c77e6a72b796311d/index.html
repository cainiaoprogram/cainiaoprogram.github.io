<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Jenkins&#43;Docker 一键自动化部署 SpringBoot 项目 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Jenkins&#43;Docker 一键自动化部署 SpringBoot 项目" />
<meta property="og:description" content="点击关注公众号，实用技术文章及时了解
本文章实现最简单全面的Jenkins&#43;docker&#43;springboot 一键自动部署项目，步骤齐全，少走坑路。
环境：centos7&#43;git(gitee)
简述实现步骤：在docker安装jenkins，配置jenkins基本信息，利用Dockerfile和shell脚本实现项目自动拉取打包并运行。
一、安装docker docker安装社区版本CE
1.确保 yum 包更新到最新。
yum update 2.卸载旧版本(如果安装过旧版本的话)
yum remove docker docker-common docker-selinux docker-engine 3.安装需要的软件包
yum install -y yum-utils device-mapper-persistent-data lvm2 4.设置yum源
yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo 5.安装docker
yum install docker-ce #由于repo中默认只开启stable仓库，故这里安装的是最新稳定版17.12.0 yum install &lt;自己的版本&gt; # 例如：sudo yum install docker-ce-17.12.0.ce 6.启动和开机启动
systemctl start docker systemctl enable docker 7.验证安装是否成功
docker version 二、安装Jenkins Jenkins中文官网：
https://www.jenkins.io/zh/
1.安装Jenkins docker 安装一切都是那么简单，注意检查8080是否已经占用！如果占用修改端口
docker run --name jenkins -u root --rm -d -p 8080:8080 -p 50000:50000 -v /var/jenkins_home:/var/jenkins_home -v /var/run/docker." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a5b0be8a43cd0875c77e6a72b796311d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-13T16:45:05+08:00" />
<meta property="article:modified_time" content="2022-08-13T16:45:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Jenkins&#43;Docker 一键自动化部署 SpringBoot 项目</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p><em><strong>点击关注公众号，实用技术文章</strong><strong>及时了解</strong><img src="https://images2.imgbox.com/d5/43/P9HRxKid_o.png" alt="4e5875fd6fb1e2d842de2bd99f842f1f.png"></em></p> 
 <p>本文章实现最简单全面的<code>Jenkins+docker+springboot</code> 一键自动部署项目，步骤齐全，少走坑路。</p> 
 <blockquote> 
  <p>环境：centos7+git(gitee)</p> 
 </blockquote> 
 <p>简述实现步骤：在docker安装jenkins，配置jenkins基本信息，利用Dockerfile和shell脚本实现项目自动拉取打包并运行。</p> 
 <h3>一、安装docker</h3> 
 <p>docker安装社区版本CE</p> 
 <p>1.确保 yum 包更新到最新。</p> 
 <pre class="has"><code class="language-go">yum update</code></pre> 
 <p>2.卸载旧版本(如果安装过旧版本的话)</p> 
 <pre class="has"><code class="language-go">yum remove docker  docker-common docker-selinux docker-engine</code></pre> 
 <p>3.安装需要的软件包</p> 
 <pre class="has"><code class="language-go">yum install -y yum-utils device-mapper-persistent-data lvm2</code></pre> 
 <p>4.设置yum源</p> 
 <pre class="has"><code class="language-go">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</code></pre> 
 <p>5.安装docker</p> 
 <pre class="has"><code class="language-go">yum install docker-ce  #由于repo中默认只开启stable仓库，故这里安装的是最新稳定版17.12.0
yum install &lt;自己的版本&gt;  # 例如：sudo yum install docker-ce-17.12.0.ce</code></pre> 
 <p>6.启动和开机启动</p> 
 <pre class="has"><code class="language-go">systemctl start docker
systemctl enable docker</code></pre> 
 <p>7.验证安装是否成功</p> 
 <pre class="has"><code class="language-go">docker version</code></pre> 
 <h3>二、安装Jenkins</h3> 
 <p>Jenkins中文官网：</p> 
 <blockquote> 
  <p>https://www.jenkins.io/zh/</p> 
 </blockquote> 
 <h5>1.安装Jenkins</h5> 
 <p>docker 安装一切都是那么简单，注意检查8080是否已经占用！如果占用修改端口</p> 
 <pre class="has"><code class="language-go">docker run --name jenkins -u root --rm -d -p 8080:8080 -p 50000:50000 -v /var/jenkins_home:/var/jenkins_home -v /var/run/docker.sock:/var/run/docker.sock jenkinsci/blueocean</code></pre> 
 <p>如果没改端口号的话</p> 
 <p>安装完成后访问地址-&gt; <code>http://{部署Jenkins所在服务IP}:8080</code></p> 
 <p>此处会有几分钟的等待时间。</p> 
 <h5>2.初始化Jenkins</h5> 
 <h6>2.1 解锁Jenkins</h6> 
 <ul><li><p style="text-align:left;">进入Jenkins容器：<code>docker exec -it {Jenkins容器名} bash</code></p></li><li><p style="text-align:left;">例如 <code>docker exec -it jenkins bash</code></p></li><li><p style="text-align:left;">查看密码：<code>cat /var/lib/jenkins/secrets/initialAdminPassword</code></p></li><li><p style="text-align:left;">复制密码到输入框里面</p></li></ul> 
 <img src="https://images2.imgbox.com/8e/8c/ceXJ8j9U_o.png" alt="a76d25fdfb4678c29bfda34401138fdf.png"> 
 <h6>2.2 安装插件</h6> 
 <p>选择第一个：安装推荐的插件</p> 
 <img src="https://images2.imgbox.com/70/10/Wk4QVIJX_o.png" alt="9a8b4b329f333b9afee1c1517e72d2dd.png"> 
 <h6>2.3 创建管理员用户</h6> 
 <p>此账户一定要记住哦</p> 
 <h3>三、系统配置</h3> 
 <h5>1. 安装需要插件</h5> 
 <p>进入【首页】–【系统管理】–【插件管理】–【可选插件】</p> 
 <p>搜索以下需要安装的插件，点击安装即可。</p> 
 <img src="https://images2.imgbox.com/2a/aa/8EOK6em5_o.png" alt="6b531fe753bb0f5efc4dc1c9f3b93443.png"> 
 <ul><li><p style="text-align:left;">安装<code>Maven Integration</code></p></li><li><p style="text-align:left;">安装<code>Publish Over SSH</code>(如果不需要远程推送，不用安装)</p></li><li><p style="text-align:left;">如果使用Gitee 码云，安装插件Gitee（Git自带不用安装）</p></li></ul> 
 <h5>2. 配置Maven</h5> 
 <p>进入【首页】–【系统管理】–【全局配置】，拉到最下面maven–maven安装</p> 
 <img src="https://images2.imgbox.com/6c/61/kWhQjqne_o.png" alt="b22b66cb5f6afbcd88600f9af6666aee.png"> 
 <h3>四、创建任务</h3> 
 <h5>1. 新建任务</h5> 
 <p>点击【新建任务】，输入任务名称，点击构建一个自由风格的软件项目</p> 
 <img src="https://images2.imgbox.com/11/95/cpsii99G_o.png" alt="fcbc4afc1268bb419fd8e251e7e7419a.png"> 
 <h5>2. 源码管理</h5> 
 <p>点击【源码管理】–【Git】，输入仓库地址，添加凭证，选择好凭证即可。</p> 
 <img src="https://images2.imgbox.com/92/e4/EDuHoIWw_o.png" alt="233c5a6df1294e2e9b5b8028503d6787.png"> 
 <img src="https://images2.imgbox.com/0d/1d/WGXHsjA2_o.png" alt="467595e526c42b7c7c6de84dfa13efbc.png"> 
 <h5>3.构建触发器</h5> 
 <p>点击【构建触发器】–【构建】–【增加构建步骤】–【调用顶层Maven目标】–【填写配置】–【保存】</p> 
 <p><img src="https://images2.imgbox.com/e8/ba/JozcqEIs_o.png" alt="25fd7148e12772e138974ea88bc87607.png">此处命令只是install，看是否能生成jar包</p> 
 <pre class="has"><code class="language-go">clean install -Dmaven.test.skip=true</code></pre> 
 <img src="https://images2.imgbox.com/fc/2c/GDYGKq8x_o.png" alt="afe36d97b7978e93562ec9e55381e9c4.png"> 
 <h5>4. 保存</h5> 
 <p>点击【保存】按钮即可</p> 
 <h3>五、测试</h3> 
 <p>该功能测试是否能正常打包</p> 
 <h5>1. 构建</h5> 
 <p>点击构建按钮</p> 
 <img src="https://images2.imgbox.com/c7/c9/6Yk0tIUO_o.png" alt="d3776a41474e9ccf136283afbfc1db4e.png"> 
 <h5>2.查看日志</h5> 
 <p>点击正在构建的任务，或者点击任务名称，进入详情页面，查看控制台输出，看是否能成功打成jar包。</p> 
 <p>该处日志第一次可能下载依赖jar包失败，再次点击构建即可成功。</p> 
 <img src="https://images2.imgbox.com/9d/f6/Hv5CN4pl_o.png" alt="17fba1463155cf292238fd786e6c15f8.png"> 
 <img src="https://images2.imgbox.com/eb/6b/YWqsKHFz_o.png" alt="4953f7bc33d5e0e6cd6d1de17075974a.png"> 
 <h5>3. 查看项目位置</h5> 
 <ol><li><p style="text-align:left;"><code>cd /var/jenkins_home/workspace</code></p></li><li><p style="text-align:left;"><code>ll</code> 即可查看是否存在</p></li></ol> 
 <h3>六、运行项目</h3> 
 <p>因为我们项目和jenkins在同一台服务器，所以我们用shell脚本运行项目，原理既是通过dockerfile 打包镜像，然后docker运行即可。</p> 
 <h5>1. Dockerfile</h5> 
 <p>在springboot项目根目录新建一个名为Dockerfile的文件，注意没有后缀名，其内容如下:（大致就是使用jdk8，把jar包添加到docker然后运行prd配置文件。详细可以查看其他教程）</p> 
 <pre class="has"><code class="language-go">FROM jdk:8
VOLUME /tmp
ADD target/zx-order-0.0.1-SNAPSHOT.jar app.jar
EXPOSE 8888
ENTRYPOINT ["java","-Djava.security.egd=file:/dev/./urandom","-jar","/app.jar","--spring.profiles.active=prd"]</code></pre> 
 <h5>2. 修改jenkins任务配置</h5> 
 <p><img src="https://images2.imgbox.com/6a/f0/ObeHlC3A_o.png" alt="20f7a4c4c8ef33d6e6412bb72e671ecf.png">配置如下：</p> 
 <img src="https://images2.imgbox.com/c6/2e/SvK5V490_o.png" alt="ffa02dfee16e7c498364cafb76f647c7.png"> 
 <ul><li><p style="text-align:left;"><code>-t</code>：指定新镜像名</p></li><li><p style="text-align:left;"><code>.</code>：表示Dockfile在当前路径</p></li></ul> 
 <pre class="has"><code class="language-go">cd /var/jenkins_home/workspace/zx-order-api
docker stop zx-order || true
docker rm zx-order || true
docker rmi zx-order || true
docker build -t zx-order .
docker run -d -p 8888:8888 --name zx-order zx-order:latest</code></pre> 
 <p>备注：</p> 
 <ol><li><p style="text-align:left;">我上图用了<code>docker logs -f</code> 是为了方便看日志，真实不要用，因为会一直等待日志，构建任务会失败</p></li><li><p style="text-align:left;">加<code>|| true</code> 是如果命令执行失败也会继续实行，为了防止第一次没有该镜像报错</p></li></ol> 
 <h5>3. 保存</h5> 
 <p>点击保存即可</p> 
 <h5>4. 构建</h5> 
 <p>查看jenkins控制台输出，输出如下，证明成功！</p> 
 <img src="https://images2.imgbox.com/bf/fb/pSL8bW5D_o.png" alt="108d5e9929570ae176d234eded8a98dc.png"> 
 <h5>5. 验证</h5> 
 <ol><li><p style="text-align:left;"><code>docker ps</code> 查看是否有自己的容器</p></li><li><p style="text-align:left;"><code>docker logs</code> 自己的容器名 查看日志是否正确</p></li><li><p style="text-align:left;">浏览器访问项目试一试</p></li></ol> 
 <h4><em>来源：blog.csdn.net/zqqiang0307/article/</em></h4> 
 <h4><em>details/120458586</em></h4> 
 <p style="text-align:center;"><strong>推荐</strong></p> 
 <p style="text-align:center;"><a href="" rel="nofollow">Java面试题宝典</a></p> 
 <p style="text-align:center;"><a href="" rel="nofollow">技术内卷群，一起来学习！！</a><br></p> 
 <p style="text-align:left;"><img src="https://images2.imgbox.com/d2/51/kvGKzGAU_o.png" alt="e7becc22596d4e3edad09437c097a938.jpeg"></p> 
 <p style="text-align:left;">PS：因为公众号平台更改了推送规则，如果不想错过内容，记得读完点一下<strong>“在看”</strong>，加个<strong>“星标”</strong>，这样每次新文章推送才会第一时间出现在你的订阅列表里。点<strong>“在看”</strong>支持我们吧！</p> 
 <p style="text-align:left;"><img src="https://images2.imgbox.com/36/2b/yrujWUJ1_o.gif" alt="c90e24b750e21672dc03e88add69e5a0.gif"></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/42392de226256497f20cfe76e86d39f8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">android开发之UI</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/891acc757c431e456b4908c713e71b9a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Docker镜像制作</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>