<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>20 MFC - 案例总结 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="20 MFC - 案例总结" />
<meta property="og:description" content="1 新建项目 1.1 根据向导创建项目 首先，新建MFC项目(SaleSystem)，基于单文档，MFC标准项目，同时，去掉工具栏：
1.2 添加预处理指令 由于微软在VS2013中不建议再使用C/C&#43;&#43;的传统库函数scanf,strcpy,sprintf等，所以直接使用这些库函数会提示C4996错误。
VS建议采用带_s的函数，如scanf_s、strcpy_s，但这些并不是标准C/C&#43;&#43;函数。要想继续使用此函数，需要添加 _CRT_SECURE_NO_WARNINGS这个预定义。
在项目 -&gt; 属性 -&gt; C/C&#43;±&gt;预处理器 -&gt; 预处理器定中添加 _CRT_SECURE_NO_WARNINGS：
1.3 设置窗口属性 设置图标
打开资源视图，添加本地ICO图标，在res文件夹中添加我们提前准备的图标资源：
在资源的属性中修改ID(IDI_ICON_WIN)：
在CMainFrame的 OnCreate()中添加如下代码：
//设置图标，IDI_ICON_WIN为图标资源ID，此为WINAPI函数 SetClassLong(m_hWnd, GCL_HICON, (LONG)AfxGetApp()-&gt;LoadIconW(IDI_ICON_WIN)); 设置窗口大小和居中显示
还是在CMainFrame的OnCreate()中接着写代码： //设置窗口的位置和大小：CWnd::MoveWindow //0, 0, 起点坐标x和y //800, 500, 窗口宽度和高度 MoveWindow(0, 0, 800, 500); //将窗口移动到屏幕中央，CWnd::CenterWindow CenterWindow(); 设置窗口标题 在CSaleSystemDoc文档类中的OnNewDocument()函数中添加如下代码：
//设置窗口标题，CDocument::SetTitle SetTitle(TEXT(&#34;销售管理系统&#34;)); 程序运行效果图如下：
2 文件处理 2.1 文件内容格式 登陆用户信息：
商品信息：
2.2 设计文件处理类CInfoFile 添加文件处理类CInfoFile
头文件(InfoFile.h)的设计
定义两个配置文件路径宏： #define _F_LOGIN &#34;./login.ini&#34; #define _F_STOCK &#34;./stock.txt&#34; 添加文件信息结构体，具体如下：
struct msg { int id;	//商品id string name;	//商品名，别忘包含相应头文件 int price;	//商品价格 int num;	//商品个数 }; 商品很多，而且要经常添加删除，可以考虑用链表来存储，所以，在成员变量中添加list类型的成员变量：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1fd8f718ea8027c73bdea40cb27706d9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-10-21T14:47:26+08:00" />
<meta property="article:modified_time" content="2019-10-21T14:47:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">20 MFC - 案例总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1__0"></a>1 新建项目</h3> 
<h4><a id="11__1"></a>1.1 根据向导创建项目</h4> 
<p>首先，新建MFC项目(SaleSystem)，基于单文档，MFC标准项目，同时，去掉工具栏：<br> <img src="https://images2.imgbox.com/ef/3c/JLySNBTN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e3/f6/V7Uzb0vs_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/1c/22/Z8GcJxIS_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="12__6"></a>1.2 添加预处理指令</h4> 
<p>由于微软在VS2013中不建议再使用C/C++的传统库函数scanf,strcpy,sprintf等，所以直接使用这些库函数会提示C4996错误。</p> 
<p>VS建议采用带_s的函数，如scanf_s、strcpy_s，但这些并不是标准C/C++函数。要想继续使用此函数，需要添加 <code>_CRT_SECURE_NO_WARNINGS</code>这个预定义。</p> 
<p>在项目 -&gt; 属性 -&gt; C/C+±&gt;预处理器 -&gt; 预处理器定中添加 <code>_CRT_SECURE_NO_WARNINGS：</code></p> 
<p><img src="https://images2.imgbox.com/44/65/F8F6Ad32_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="13__15"></a>1.3 设置窗口属性</h4> 
<ol><li>设置图标<br> 打开资源视图，添加本地ICO图标，在res文件夹中添加我们提前准备的图标资源：<br> <img src="https://images2.imgbox.com/0e/da/bssl2LKT_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/4e/b0/V4CSq19p_o.png" alt="在这里插入图片描述"><br> 在资源的属性中修改ID(IDI_ICON_WIN)：<br> <img src="https://images2.imgbox.com/17/1b/1mruQGAH_o.png" alt="在这里插入图片描述"><br> 在CMainFrame的 OnCreate()中添加如下代码：<br> <img src="https://images2.imgbox.com/28/70/O8rBmimb_o.png" alt="在这里插入图片描述"></li></ol> 
<pre><code class="prism language-c"><span class="token comment">//设置图标，IDI_ICON_WIN为图标资源ID，此为WINAPI函数</span>
<span class="token function">SetClassLong</span><span class="token punctuation">(</span>m_hWnd<span class="token punctuation">,</span> GCL_HICON<span class="token punctuation">,</span> <span class="token punctuation">(</span>LONG<span class="token punctuation">)</span><span class="token function">AfxGetApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">LoadIconW</span><span class="token punctuation">(</span>IDI_ICON_WIN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="2"><li>设置窗口大小和居中显示<br> 还是在CMainFrame的OnCreate()中接着写代码：</li></ol> 
<pre><code class="prism language-c"><span class="token comment">//设置窗口的位置和大小：CWnd::MoveWindow</span>
<span class="token comment">//0, 0, 起点坐标x和y</span>
<span class="token comment">//800, 500, 窗口宽度和高度</span>
<span class="token function">MoveWindow</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//将窗口移动到屏幕中央，CWnd::CenterWindow</span>
<span class="token function">CenterWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="3"><li>设置窗口标题</li></ol> 
<p>在CSaleSystemDoc文档类中的OnNewDocument()函数中添加如下代码：</p> 
<p><img src="https://images2.imgbox.com/f1/b5/HlFjionx_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token comment">//设置窗口标题，CDocument::SetTitle</span>
<span class="token function">SetTitle</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"销售管理系统"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>程序运行效果图如下：<br> <img src="https://images2.imgbox.com/19/b8/wRv1Hbls_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2__55"></a>2 文件处理</h3> 
<h4><a id="21__56"></a>2.1 文件内容格式</h4> 
<p>登陆用户信息：<br> <img src="https://images2.imgbox.com/05/6f/eQ1ki0S5_o.png" alt="在这里插入图片描述"><br> 商品信息：<br> <img src="https://images2.imgbox.com/1f/fa/KWe10GZK_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="22_CInfoFile_61"></a>2.2 设计文件处理类CInfoFile</h4> 
<ol><li>添加文件处理类CInfoFile<br> <img src="https://images2.imgbox.com/e3/df/9EIPgs5M_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/2e/80/41cIpwmp_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bd/2a/qGkGwaJi_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ac/18/kXldWV9b_o.png" alt="在这里插入图片描述"></li><li>头文件(InfoFile.h)的设计<br> 定义两个配置文件路径宏：</li></ol> 
<pre><code class="prism language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _F_LOGIN "./login.ini"</span>
<span class="token macro property">#<span class="token directive keyword">define</span> _F_STOCK "./stock.txt"</span>
</code></pre> 
<p>添加文件信息结构体，具体如下：</p> 
<pre><code class="prism language-c"><span class="token keyword">struct</span> msg
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> id<span class="token punctuation">;</span>		<span class="token comment">//商品id</span>
	string name<span class="token punctuation">;</span>	<span class="token comment">//商品名，别忘包含相应头文件</span>
	<span class="token keyword">int</span> price<span class="token punctuation">;</span>	<span class="token comment">//商品价格</span>
	<span class="token keyword">int</span> num<span class="token punctuation">;</span>	<span class="token comment">//商品个数</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>商品很多，而且要经常添加删除，可以考虑用链表来存储，所以，在成员变量中添加list类型的成员变量：</p> 
<pre><code class="prism language-c">list<span class="token operator">&lt;</span>msg<span class="token operator">&gt;</span> ls<span class="token punctuation">;</span>	<span class="token comment">//存储商品容器，别忘包含相应头文件</span>
<span class="token keyword">int</span> num<span class="token punctuation">;</span>	<span class="token comment">//用来记录商品个数</span>
</code></pre> 
<p>项目中需要读写的文件有两种，用户信息配置文件和商品信息文件。具体 API 接口如下：</p> 
<pre><code class="prism language-c"><span class="token comment">//读取登陆信息</span>
<span class="token keyword">void</span> <span class="token function">ReadLogin</span><span class="token punctuation">(</span>CString <span class="token operator">&amp;</span>name<span class="token punctuation">,</span> CString <span class="token operator">&amp;</span>pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//修改密码</span>
<span class="token keyword">void</span> <span class="token function">WritePwd</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 读取商品数据</span>
<span class="token keyword">void</span> <span class="token function">ReadDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//商品写入文件</span>
<span class="token keyword">void</span> <span class="token function">WirteDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//添加新商品</span>
<span class="token keyword">void</span> <span class="token function">Addline</span><span class="token punctuation">(</span>CString name<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="3__110"></a>3 登陆对话框</h3> 
<h4><a id="31_ui_111"></a>3.1 ui设计</h4> 
<p>1)添加对话框资源(ID修改为DIALOG_LOGIN)，添加所需控件：<br> <img src="https://images2.imgbox.com/f5/bc/g8kjfhnu_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/24/90/od4tYzN2_o.png" alt="在这里插入图片描述"><br> 2)选中对话框 -&gt; 右击 -&gt; 添加类 -&gt; 类名：CLoginDlg<br> <img src="https://images2.imgbox.com/e7/6c/FMyOm93G_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b9/07/DsTaaZnu_o.png" alt="在这里插入图片描述"><br> 3)根据需求，控件关联所需变量<br> <img src="https://images2.imgbox.com/5a/64/phMz3Igy_o.png" alt="在这里插入图片描述"><br> 用户名编辑区关联CString m_user,密码登陆框关联CString m_pwd。</p> 
<h4><a id="32__122"></a>3.2 功能实现</h4> 
<p>1)在对话框类中，重写 OnInitDialog 函数，进行初始化，设置一些默认登录信息。<br> <img src="https://images2.imgbox.com/81/0c/AeX2yh09_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b5/3b/T5Xn0yq7_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">m_user <span class="token operator">=</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"斧头帮帮主"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//用户名</span>
m_pwd <span class="token operator">=</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//密码</span>
<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//内容更新到对应的控件</span>
</code></pre> 
<p>2)登陆窗口的创建</p> 
<p>在应用程序类CSaleSystemApp的InitInstance() 里面的APP 创建之前创建登陆对话框：<br> <img src="https://images2.imgbox.com/e1/63/EW3rmTKU_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">CLoginDlg dlg<span class="token punctuation">;</span>	<span class="token comment">//创建登陆对话框，需要头文件#include "LoginDlg.h"</span>
dlg<span class="token punctuation">.</span><span class="token function">DoModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//以模态方式运行</span>
</code></pre> 
<p>3)登陆按钮功能实现</p> 
<pre><code class="prism language-c"><span class="token comment">//登陆按钮处理函数</span>
<span class="token keyword">void</span> CLoginDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnBnClickedButton1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>

	<span class="token function">UpdateData</span><span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//更新控件的数据到对应的变量</span>

	CInfoFile file<span class="token punctuation">;</span> <span class="token comment">//创建操作文件类对象，需要头文件#include "InfoFile.h" </span>
	CString user<span class="token punctuation">,</span> pwd<span class="token punctuation">;</span>

	<span class="token comment">//读取配置文件，获取用户名密码，参数为引用传递</span>
	file<span class="token punctuation">.</span><span class="token function">ReadLogin</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>m_user <span class="token operator">==</span> user<span class="token punctuation">)</span><span class="token comment">//用户名相等</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>m_pwd <span class="token operator">!=</span> pwd<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"密码错误"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			m_user<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//清空</span>
			m_pwd<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			CDialogEx<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnOK</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"用户名不存在"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_user<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_pwd<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>4)取消按钮功能实现</p> 
<pre><code class="prism language-c"><span class="token comment">//取消按钮功能实现</span>
<span class="token keyword">void</span> CLoginDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnBnClickedButton2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>
	<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//结束整个程序</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>5)右上角关闭按钮功能实现</p> 
<p>选中对话框模板 -&gt; 右击 -&gt; 属性 -&gt; 消息 -&gt; WM_CLOSE<br> <img src="https://images2.imgbox.com/90/bc/A7lQ7SKv_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token comment">//关闭按钮</span>
<span class="token keyword">void</span> CLoginDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加消息处理程序代码和/或调用默认值</span>
	<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//结束整个程序</span>

	CDialogEx<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>6)编辑区回车键关闭对话框问题解决<br> <img src="https://images2.imgbox.com/65/70/r5Dm8oz4_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4d/c3/S6O4CO4D_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4__206"></a>4 静态拆分窗口</h3> 
<h4><a id="41_MFC_207"></a>4.1 自定义MFC视图类</h4> 
<p>自定义两个类：CSelectView和CDispalyView(它的基类必须是视图类)。</p> 
<p>CSelectView继承于CTreeView，CDispalyView继承于CFormView。<br> <img src="https://images2.imgbox.com/6e/ec/WFyswh4P_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e8/3d/DS1Jrfg7_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/22/b8/6psXPCjp_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e3/60/Z1JLHvXv_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ed/8e/EKeH5FaF_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="42_CSplitterWnd_216"></a>4.2 通过CSplitterWnd类拆分窗口</h4> 
<h6><a id="1CMainFrameCSplitterWnd_217"></a>1)CMainFrame类中，声明CSplitterWnd类型的对象：</h6> 
<p><img src="https://images2.imgbox.com/34/e8/APoTbtMb_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">private<span class="token punctuation">:</span>
	CSplitterWnd m_spliter<span class="token punctuation">;</span> <span class="token comment">// 切分窗口类对象</span>
</code></pre> 
<h6><a id="2CMainFrameOnCreateClient_225"></a>2)重写框架类CMainFrame的OnCreateClient函数</h6> 
<p><img src="https://images2.imgbox.com/ca/d9/nulPvQMc_o.png" alt="在这里插入图片描述"><br> 把OnCreateClient()函数的返回值改为Return TRUE:<br> <img src="https://images2.imgbox.com/1d/cb/txLFCB9Z_o.png" alt="在这里插入图片描述"><br> 静态拆分实现代码如下：<img src="https://images2.imgbox.com/21/eb/jPdMXBH8_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">BOOL CMainFrame<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnCreateClient</span><span class="token punctuation">(</span>LPCREATESTRUCT lpcs<span class="token punctuation">,</span> CCreateContext<span class="token operator">*</span> pContext<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加专用代码和/或调用基类</span>

	<span class="token comment">// 静态拆分窗口，1行2列，CSplitterWnd::CreateStatic</span>
	m_spliter<span class="token punctuation">.</span><span class="token function">CreateStatic</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 创建视图：CSplitterWnd::CreateView</span>
	<span class="token comment">//0, 0 ： 放在第0行第0列的位置</span>
	<span class="token comment">//RUNTIME_CLASS(CSelectView) ：需要头文件#include "SelectView.h"， CSelectView在SelectView.h中声明</span>
	<span class="token comment">// CSize(250, 500)：指定视图宽度和高度</span>
	<span class="token comment">//pContext ： 为OnCreateClient()最后一个形参</span>
	m_spliter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>CSelectView<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//0, 1： 放在第0行第1列的位置</span>
	<span class="token comment">//CDispalyView，需要头文件#include "DispalyView.h"</span>
	m_spliter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>CDispalyView<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//return CFrameWnd::OnCreateClient(lpcs, pContext);</span>
	<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>程序运行效果图如下：<br> <img src="https://images2.imgbox.com/38/36/mLAYSRwD_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5__256"></a>5 树视图功能实现</h3> 
<h5><a id="51__257"></a>5.1 添加功能节点</h5> 
<h6><a id="1_258"></a>1)加载图标资源</h6> 
<p><img src="https://images2.imgbox.com/15/0c/Oy0lRjIH_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/79/26/p7VcNoke_o.png" alt="在这里插入图片描述"><br> 图标资源ID改为：IDI_ICON_RE<img src="https://images2.imgbox.com/01/c3/7CPqCVzL_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="2CSelectView_262"></a>2)CSelectView类中声明相应变量：</h6> 
<p><img src="https://images2.imgbox.com/e4/42/A7Ylz6jh_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">	CTreeCtrl <span class="token operator">*</span>m_treeCtrl<span class="token punctuation">;</span>	<span class="token comment">//树控件</span>
	CImageList m_imageList<span class="token punctuation">;</span>	<span class="token comment">//图标列表</span>
</code></pre> 
<h6><a id="3CSelectViewOnInitUpdate_269"></a>3)重写CSelectView的OnInitUpdate函数</h6> 
<p><img src="https://images2.imgbox.com/3a/dd/q3PZ4sIV_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CSelectView<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	CTreeView<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// TODO:  在此添加专用代码和/或调用基类</span>
<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="4CSelectViewOnInitUpdate_280"></a>4)在CSelectView的OnInitUpdate函数中，完成初始化功能</h6> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CSelectView<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	CTreeView<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// TODO:  在此添加专用代码和/或调用基类</span>

	<span class="token comment">//图标资源的加载 CWinApp::LoadIcon</span>
<span class="token comment">//IDI_ICON_RE为图标资源ID</span>
	HICON icon <span class="token operator">=</span> <span class="token function">AfxGetApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">LoadIconW</span><span class="token punctuation">(</span>IDI_ICON_RE<span class="token punctuation">)</span><span class="token punctuation">;</span> 

	<span class="token comment">//图片列表的创建 CImageList::Create</span>
	<span class="token comment">//30, 30：指定图标的宽度和高度</span>
	<span class="token comment">//ILC_COLOR32：图标格式</span>
	<span class="token comment">//1, 1：有多少图标就写多少</span>
	m_imageList<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> ILC_COLOR32<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//图片列表追加图标 CImageList::Add</span>
	m_imageList<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>icon<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//获取数视图中的树控件 CTreeView::GetTreeCtrl</span>
	m_treeCtrl <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token function">GetTreeCtrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//数控件设置图片列表 CTreeCtrl::SetImageList</span>
	m_treeCtrl<span class="token operator">-&gt;</span><span class="token function">SetImageList</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>m_imageList<span class="token punctuation">,</span> TVSIL_NORMAL<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//树控件设置节点 CTreeCtrl::InsertItem</span>
	m_treeCtrl<span class="token operator">-&gt;</span><span class="token function">InsertItem</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"个人信息"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_treeCtrl<span class="token operator">-&gt;</span><span class="token function">InsertItem</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"销售管理"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_treeCtrl<span class="token operator">-&gt;</span><span class="token function">InsertItem</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"库存信息"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_treeCtrl<span class="token operator">-&gt;</span><span class="token function">InsertItem</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"库存添加"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_treeCtrl<span class="token operator">-&gt;</span><span class="token function">InsertItem</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"库存删除"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>程序运行效果图如下：<br> <img src="https://images2.imgbox.com/b4/a6/tH7dgr3D_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="52__319"></a>5.2 功能节点相应消息处理</h4> 
<p><img src="https://images2.imgbox.com/b4/1f/sPr3cDXn_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CSelectView<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnTvnSelchanged</span><span class="token punctuation">(</span>NMHDR <span class="token operator">*</span>pNMHDR<span class="token punctuation">,</span> LRESULT <span class="token operator">*</span>pResult<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	LPNMTREEVIEW pNMTreeView <span class="token operator">=</span> reinterpret_cast<span class="token operator">&lt;</span>LPNMTREEVIEW<span class="token operator">&gt;</span><span class="token punctuation">(</span>pNMHDR<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>
	<span class="token operator">*</span>pResult <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在上面函数，实现获取当前节点选中内容：</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CSelectView<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnTvnSelchanged</span><span class="token punctuation">(</span>NMHDR <span class="token operator">*</span>pNMHDR<span class="token punctuation">,</span> LRESULT <span class="token operator">*</span>pResult<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	LPNMTREEVIEW pNMTreeView <span class="token operator">=</span> reinterpret_cast<span class="token operator">&lt;</span>LPNMTREEVIEW<span class="token operator">&gt;</span><span class="token punctuation">(</span>pNMHDR<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>
	<span class="token operator">*</span>pResult <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token comment">//获取当前节点选中项目 CTreeCtrl::GetSelectedItem</span>
	HTREEITEM item <span class="token operator">=</span> m_treeCtrl<span class="token operator">-&gt;</span><span class="token function">GetSelectedItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//获取选中项的文本内容 CTreeCtrl::GetItemText</span>
	CString str <span class="token operator">=</span> m_treeCtrl<span class="token operator">-&gt;</span><span class="token function">GetItemText</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//MessageBox(str);</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"个人信息"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"销售管理"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"库存信息"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"库存增加"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"库存删除"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="6__363"></a>6 个人信息管理窗口</h3> 
<h4><a id="61_ui_364"></a>6.1 ui设计</h4> 
<h5><a id="1IDDIALOG_USER_365"></a>1)添加对话框资源(ID修改为DIALOG_USER)，添加所需控件：</h5> 
<p><img src="https://images2.imgbox.com/f1/c2/b1UgGO4Z_o.png" alt="在这里插入图片描述"><br> 在窗口属性中，Border改为None，Style改为Child：<br> <img src="https://images2.imgbox.com/d9/0d/SdooJYrt_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4c/87/xoShSTcW_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="2______CUserDlgCFormView_370"></a>2)选中对话框 -&gt; 右击 -&gt; 添加类 -&gt; 类名：CUserDlg，基类选择CFormView</h5> 
<p><img src="https://images2.imgbox.com/cc/d4/B6rCss6w_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="3_372"></a>3)根据需求，控件关联所需变量</h5> 
<p>身份编辑区关联CString m_user，用户名编辑框关联CString m_name，<br> 新密码编辑框关联CString m_newPwd，确定密码编辑框关联CString m_surePwd。<br> <img src="https://images2.imgbox.com/b2/5f/FYhyYJSA_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="62__377"></a>6.2 功能实现</h4> 
<h5><a id="1_OnInitDialog__378"></a>1)在对话框类中，重写 OnInitDialog 函数，进行初始化。</h5> 
<p><img src="https://images2.imgbox.com/cb/b3/OuYn8Ny3_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CUserDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	CFormView<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// TODO:  在此添加专用代码和/或调用基类</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CUserDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	CFormView<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// TODO:  在此添加专用代码和/或调用基类</span>

	CInfoFile file<span class="token punctuation">;</span>	<span class="token comment">//需要头文件#include "InfoFile.h"</span>
	CString name<span class="token punctuation">,</span> pwd<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadLogin</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> pwd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取文件的用户名和密码</span>

	<span class="token comment">//初始化个人信息</span>
	m_user <span class="token operator">=</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"销售员"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//身份</span>
	m_name <span class="token operator">=</span> name<span class="token punctuation">;</span>	<span class="token comment">//用户名</span>

	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//把数据更新到控件上</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="2_406"></a>2)确定修改密码按钮功能实现</h5> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CUserDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnBnClickedButton1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>

	<span class="token function">UpdateData</span><span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//更新控件内容到对应的变量中</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>m_newPwd<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> m_surePwd<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"输入密码不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>m_newPwd <span class="token operator">!=</span> m_surePwd<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"输入密码和确定密码不相等"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	CInfoFile file<span class="token punctuation">;</span>	<span class="token comment">//需要头文件#include "InfoFile.h"</span>
	CString name<span class="token punctuation">,</span> pwd<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadLogin</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> pwd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取文件的用户名和密码</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>m_surePwd <span class="token operator">==</span> pwd<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"输入密码和旧密码相等"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//把用户名和密码的CString类型转为char *</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>tmpName<span class="token punctuation">,</span> <span class="token operator">*</span>tmpPwd<span class="token punctuation">;</span>
	<span class="token comment">//用户名</span>
	CStringA tmp1<span class="token punctuation">;</span>
	tmp1 <span class="token operator">=</span> name<span class="token punctuation">;</span>
	tmpName <span class="token operator">=</span> tmp1<span class="token punctuation">.</span><span class="token function">GetBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//密码</span>
	CStringA tmp2<span class="token punctuation">;</span>
	tmp2 <span class="token operator">=</span> m_surePwd<span class="token punctuation">;</span>
	tmpPwd <span class="token operator">=</span> tmp2<span class="token punctuation">.</span><span class="token function">GetBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	file<span class="token punctuation">.</span><span class="token function">WritePwd</span><span class="token punctuation">(</span>tmpName<span class="token punctuation">,</span> tmpPwd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//修改密码</span>

	<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"密码修改成功"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//输入框内容清空</span>
	m_surePwd<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_newPwd<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//把数据更新到控件上</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="3_458"></a>3)取消按钮功能实现</h5> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CUserDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnBnClickedButton3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>

	<span class="token comment">//输入框内容清空</span>
	m_surePwd<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_newPwd<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//把数据更新到控件上</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="7__471"></a>7 界面挂载</h3> 
<h4><a id="71__472"></a>7.1 自定义信息发送</h4> 
<h5><a id="1CMainFrame__473"></a>1)在CMainFrame 框架类中，添加自定义消息宏</h5> 
<p><img src="https://images2.imgbox.com/26/19/87MEYigD_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token comment">//WM_USER 是用户自定义消息的一个起始值</span>
<span class="token comment">//WM_USER+100是为了区分系统消息和用户消息，避免冲突</span>
<span class="token macro property">#<span class="token directive keyword">define</span> NM_A	(WM_USER + 100)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> NM_B	(WM_USER + 101)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> NM_C	(WM_USER + 102)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> NM_D	(WM_USER + 103)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> NM_E	(WM_USER + 104)</span>
</code></pre> 
<h5><a id="2CMainFrame_485"></a>2)在CMainFrame框架类中添加自定义消息处理函数：</h5> 
<p><img src="https://images2.imgbox.com/49/90/S26FWTWs_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token comment">//自定义消息处理函数</span>
afx_msg LRESULT <span class="token function">OnMyChange</span><span class="token punctuation">(</span>WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="3cpp_493"></a>3)对应的.cpp定义其函数</h5> 
<pre><code class="prism language-c">LRESULT CMainFrame<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnMyChange</span><span class="token punctuation">(</span>WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>

<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="4CMainFrameBEGIN_MESSAGE_MAPEND_MESSAGE_MAP_501"></a>4)在CMainFrame框架类BEGIN_MESSAGE_MAP和END_MESSAGE_MAP之间添加自定义消息入口，与自定义消息处理函数绑定。</h5> 
<p><img src="https://images2.imgbox.com/24/28/YzyGezIn_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token comment">//ON_MESSAGE响应的是自定义消息</span>
<span class="token comment">//产生NM_X消息，自动调用OnMyChange函数</span>
<span class="token function">ON_MESSAGE</span><span class="token punctuation">(</span>NM_A<span class="token punctuation">,</span> OnMyChange<span class="token punctuation">)</span>
<span class="token function">ON_MESSAGE</span><span class="token punctuation">(</span>NM_B<span class="token punctuation">,</span> OnMyChange<span class="token punctuation">)</span>
<span class="token function">ON_MESSAGE</span><span class="token punctuation">(</span>NM_C<span class="token punctuation">,</span> OnMyChange<span class="token punctuation">)</span>
<span class="token function">ON_MESSAGE</span><span class="token punctuation">(</span>NM_D<span class="token punctuation">,</span> OnMyChange<span class="token punctuation">)</span>
<span class="token function">ON_MESSAGE</span><span class="token punctuation">(</span>NM_E<span class="token punctuation">,</span> OnMyChange<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="5_513"></a>5)发送自定义信号</h5> 
<p>在CSelectView的OnTvnSelchanged函数中，发送自定义信号：<br> <img src="https://images2.imgbox.com/2c/34/mM9jmYES_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"个人信息"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//需要包含框架类头文件#include "MainFrm.h" </span>
	<span class="token comment">//CWnd::PostMessage 将一个消息放入窗口的消息队列</span>
	<span class="token comment">//AfxGetMainWnd()：框架窗口对象的指针</span>
	<span class="token comment">//AfxGetMainWnd()-&gt;GetSafeHwnd()：获取返回窗口的句柄，CWnd::GetSafeHwnd</span>
	<span class="token comment">//NM_A：发送自定义消息</span>
	<span class="token comment">//(WPARAM)NM_A：指定了附加的消息信息</span>
	<span class="token comment">//(LPARAM)0：指定了附加的消息信息，此参数这里没有意义</span>
<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_A<span class="token punctuation">,</span> <span class="token punctuation">(</span>WPARAM<span class="token punctuation">)</span>NM_A<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPARAM<span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"销售管理"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_B<span class="token punctuation">,</span> <span class="token punctuation">(</span>WPARAM<span class="token punctuation">)</span>NM_B<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPARAM<span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"库存信息"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_C<span class="token punctuation">,</span> <span class="token punctuation">(</span>WPARAM<span class="token punctuation">)</span>NM_C<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPARAM<span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"库存添加"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_D<span class="token punctuation">,</span> <span class="token punctuation">(</span>WPARAM<span class="token punctuation">)</span>NM_D<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPARAM<span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"库存删除"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_E<span class="token punctuation">,</span> <span class="token punctuation">(</span>WPARAM<span class="token punctuation">)</span>NM_E<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPARAM<span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="72__546"></a>7.2 自定义信息处理</h4> 
<p>在CMainFrame框架类OnMyChange函数中处理相应消息</p> 
<pre><code class="prism language-c">LRESULT CMainFrame<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnMyChange</span><span class="token punctuation">(</span>WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>wParam<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> NM_A<span class="token punctuation">:</span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"NM_A"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> NM_B<span class="token punctuation">:</span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"NM_B"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> NM_C<span class="token punctuation">:</span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"NM_C"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> NM_D<span class="token punctuation">:</span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"NM_D"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> NM_E<span class="token punctuation">:</span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"NM_E"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="73__575"></a>7.3 界面挂载</h4> 
<p>如果是NM_A信号，则挂载CUserDlg窗口，后面界面的挂载以此类推。<br> <img src="https://images2.imgbox.com/cd/fd/QXJJ3dKK_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">CCreateContext   Context<span class="token punctuation">;</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span>wParam<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">case</span> NM_A<span class="token punctuation">:</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//CUserDlg类需要包含头文件#include "UserDlg.h"</span>
	Context<span class="token punctuation">.</span>m_pNewViewClass <span class="token operator">=</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>CUserDlg<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	Context<span class="token punctuation">.</span>m_pCurrentFrame <span class="token operator">=</span> this<span class="token punctuation">;</span>
	Context<span class="token punctuation">.</span>m_pLastView <span class="token operator">=</span> <span class="token punctuation">(</span>CFormView <span class="token operator">*</span><span class="token punctuation">)</span>m_spliter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_spliter<span class="token punctuation">.</span><span class="token function">DeleteView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_spliter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>CUserDlg<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Context<span class="token punctuation">)</span><span class="token punctuation">;</span>
	CUserDlg <span class="token operator">*</span>pNewView <span class="token operator">=</span> <span class="token punctuation">(</span>CUserDlg <span class="token operator">*</span><span class="token punctuation">)</span>m_spliter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_spliter<span class="token punctuation">.</span><span class="token function">RecalcLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	pNewView<span class="token operator">-&gt;</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_spliter<span class="token punctuation">.</span><span class="token function">SetActivePane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
	<span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token keyword">case</span> NM_B<span class="token punctuation">:</span>
<span class="token comment">//……………</span>
</code></pre> 
<p>程序运行效果如下：<br> <img src="https://images2.imgbox.com/60/1f/fGWmOdfi_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="8__602"></a>8 销售管理窗口</h3> 
<h4><a id="81_ui_603"></a>8.1 ui设计</h4> 
<p>1)添加对话框资源(ID修改为DIALOG_SELL)，添加所需控件。<br> <img src="https://images2.imgbox.com/81/50/nDT1IG4D_o.png" alt="在这里插入图片描述"><br> 在窗口属性中，Border改为None，Style改为Child：<br> <img src="https://images2.imgbox.com/2b/10/LzTiTRDE_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/33/60/MUv5tjXY_o.png" alt="在这里插入图片描述"><br> 2)选中对话框 -&gt; 右击 -&gt; 添加类 -&gt; 类名：CSellDlg，基类选择CFormView<br> <img src="https://images2.imgbox.com/96/1a/D2b3DtBi_o.png" alt="在这里插入图片描述"><br> 3)根据需求，控件关联所需变量<br> 商品名组合框关联CComboBox m_combo，单价编辑框关联int m_price，<br> 个数编辑框关联int m_num，销售信息编辑框关联CString m_sellInfo。<br> <img src="https://images2.imgbox.com/0f/16/Mq0mKSOy_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="82__615"></a>8.2 界面挂载</h4> 
<p>在CMainFrame类中OnMyChange函数，添加如下代码：</p> 
<pre><code class="prism language-c"><span class="token keyword">case</span> NM_B<span class="token punctuation">:</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//CSellDlg类需要包含头文件#include "SellDlg.h"</span>
		Context<span class="token punctuation">.</span>m_pNewViewClass <span class="token operator">=</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>CSellDlg<span class="token punctuation">)</span><span class="token punctuation">;</span>
		Context<span class="token punctuation">.</span>m_pCurrentFrame <span class="token operator">=</span> this<span class="token punctuation">;</span>
		Context<span class="token punctuation">.</span>m_pLastView <span class="token operator">=</span> <span class="token punctuation">(</span>CFormView <span class="token operator">*</span><span class="token punctuation">)</span>m_spliter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_spliter<span class="token punctuation">.</span><span class="token function">DeleteView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_spliter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>CSellDlg<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Context<span class="token punctuation">)</span><span class="token punctuation">;</span>
		CSellDlg <span class="token operator">*</span>pNewView <span class="token operator">=</span> <span class="token punctuation">(</span>CSellDlg <span class="token operator">*</span><span class="token punctuation">)</span>m_spliter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_spliter<span class="token punctuation">.</span><span class="token function">RecalcLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		pNewView<span class="token operator">-&gt;</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_spliter<span class="token punctuation">.</span><span class="token function">SetActivePane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
</code></pre> 
<p>程序运行效果图：<br> <img src="https://images2.imgbox.com/9a/73/UAZMJf4R_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="83_636"></a>8.3功能实现</h4> 
<p>1)在对话框类中，重写 OnInitDialog 函数，进行初始化。<br> <img src="https://images2.imgbox.com/4e/fb/ewhfY08P_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CSellDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	CFormView<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// TODO:  在此添加专用代码和/或调用基类</span>

	<span class="token comment">//读取文件，获取商品名，给组合框添加字符串</span>
	<span class="token comment">//需要包含#include "InfoFile.h"</span>
	CInfoFile file<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取商品信息</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>list<span class="token operator">&lt;</span>msg<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it <span class="token operator">=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		m_combo<span class="token punctuation">.</span><span class="token function">AddString</span><span class="token punctuation">(</span><span class="token punctuation">(</span>CString<span class="token punctuation">)</span>it<span class="token operator">-&gt;</span>name<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//清空list的内容</span>

	<span class="token comment">//将第一个商品名设为默认选中项</span>
	m_combo<span class="token punctuation">.</span><span class="token function">SetCurSel</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>2)处理组合框所需控制事件<br> <img src="https://images2.imgbox.com/89/6b/dMimbko0_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CSellDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnCbnSelchangeCombo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>

	CString text<span class="token punctuation">;</span>
	<span class="token comment">//获取当前选中项</span>
	<span class="token keyword">int</span> index <span class="token operator">=</span> m_combo<span class="token punctuation">.</span><span class="token function">GetCurSel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//获取当前内容</span>
	m_combo<span class="token punctuation">.</span><span class="token function">GetLBText</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//需要包含#include "InfoFile.h"</span>
	CInfoFile file<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取商品信息</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>list<span class="token operator">&lt;</span>msg<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it <span class="token operator">=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>text <span class="token operator">==</span> it<span class="token operator">-&gt;</span>name<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			m_price <span class="token operator">=</span> it<span class="token operator">-&gt;</span>price<span class="token punctuation">;</span>
			m_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//内容更新到对应的控件</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//清空list的内容</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>3)购买按钮功能实现</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CSellDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnBnClickedButton1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>
	
	<span class="token comment">//获取控件上的内容，更新到对应关联的变量中</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>m_num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"个数不能为0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	CString type<span class="token punctuation">;</span>
	<span class="token comment">//获取当前选中项</span>
	<span class="token keyword">int</span> index <span class="token operator">=</span> m_combo<span class="token punctuation">.</span><span class="token function">GetCurSel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//获取组合框当前内容</span>
	m_combo<span class="token punctuation">.</span><span class="token function">GetLBText</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>

	CString str<span class="token punctuation">;</span>
	str<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"商品：%s \r\n单价：%d \r\n个数：%d \r\n总价：%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type<span class="token punctuation">,</span> m_price<span class="token punctuation">,</span> m_num<span class="token punctuation">,</span> m_price<span class="token operator">*</span>m_num<span class="token punctuation">)</span><span class="token punctuation">;</span>

	m_sellInfo <span class="token operator">=</span> str<span class="token punctuation">;</span> <span class="token comment">//销售信息</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">MessageBox</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token comment">//需要包含#include "InfoFile.h"</span>
	CInfoFile file<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取商品信息</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>list<span class="token operator">&lt;</span>msg<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it <span class="token operator">=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> it<span class="token operator">-&gt;</span>name<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			it<span class="token operator">-&gt;</span>num <span class="token operator">=</span> it<span class="token operator">-&gt;</span>num <span class="token operator">-</span> m_num<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	file<span class="token punctuation">.</span><span class="token function">WirteDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//更新文件内容</span>

	file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//清空list的内容</span>

	m_sellInfo<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//更新到对应的控件</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>4)取消按钮功能实现</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CSellDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnBnClickedButton3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>

	m_combo<span class="token punctuation">.</span><span class="token function">SetCurSel</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//选择第0项目</span>
	m_sellInfo <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
	m_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">OnCbnSelchangeCombo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="9__755"></a>9 库存信息窗口</h3> 
<h4><a id="91_ui_756"></a>9.1 ui设计</h4> 
<p>1)添加对话框资源(ID修改为DIALOG_INFO)，添加所需控件。<br> <img src="https://images2.imgbox.com/54/b4/uuzE0mos_o.png" alt="在这里插入图片描述"><br> 在窗口属性中，Border改为None，Style改为Child：<br> <img src="https://images2.imgbox.com/d3/99/84KABvSa_o.png" alt="在这里插入图片描述"><br> View 属性为 Report(报表表模式)：<br> <img src="https://images2.imgbox.com/49/02/AAg6bLSz_o.png" alt="在这里插入图片描述"><br> 2)选中对话框 -&gt; 右击 -&gt; 添加类 -&gt; 类名：CInfoDlg，基类选择CFormView<br> <img src="https://images2.imgbox.com/a4/76/Jhr6uvqA_o.png" alt="在这里插入图片描述"><br> 3)根据需求，控件关联所需变量<br> 列表控件关联CListCtrl m_list:<br> <img src="https://images2.imgbox.com/dd/38/cw5sjsKr_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="92__768"></a>9.2 界面挂载</h4> 
<p>在CMainFrame类中OnMyChange函数，添加如下代码：</p> 
<pre><code class="prism language-c"><span class="token keyword">case</span> NM_C<span class="token punctuation">:</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//CInfoDlg类需要包含头文件#include "InfoDlg.h"</span>
		Context<span class="token punctuation">.</span>m_pNewViewClass <span class="token operator">=</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>CInfoDlg<span class="token punctuation">)</span><span class="token punctuation">;</span>
		Context<span class="token punctuation">.</span>m_pCurrentFrame <span class="token operator">=</span> this<span class="token punctuation">;</span>
		Context<span class="token punctuation">.</span>m_pLastView <span class="token operator">=</span> <span class="token punctuation">(</span>CFormView <span class="token operator">*</span><span class="token punctuation">)</span>m_spliter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_spliter<span class="token punctuation">.</span><span class="token function">DeleteView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_spliter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>CInfoDlg<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Context<span class="token punctuation">)</span><span class="token punctuation">;</span>
		CInfoDlg <span class="token operator">*</span>pNewView <span class="token operator">=</span> <span class="token punctuation">(</span>CInfoDlg <span class="token operator">*</span><span class="token punctuation">)</span>m_spliter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_spliter<span class="token punctuation">.</span><span class="token function">RecalcLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		pNewView<span class="token operator">-&gt;</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_spliter<span class="token punctuation">.</span><span class="token function">SetActivePane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
</code></pre> 
<p>程序运行效果图：<br> <img src="https://images2.imgbox.com/67/d4/CTb9YH04_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="93_789"></a>9.3功能实现</h4> 
<p>在对话框类中，重写 OnInitDialog 函数，进行商品信息初始化：<br> <img src="https://images2.imgbox.com/96/ed/e08iVO2J_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CInfoDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	CFormView<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// TODO:  在此添加专用代码和/或调用基类</span>
	<span class="token comment">// 设置扩展风格</span>
	<span class="token comment">//LVS_EX_FULLROWSELECT选中整行，LVS_EX_GRIDLINES网格</span>
	m_list<span class="token punctuation">.</span><span class="token function">SetExtendedStyle</span><span class="token punctuation">(</span>m_list<span class="token punctuation">.</span><span class="token function">GetExtendedStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">|</span> LVS_EX_FULLROWSELECT <span class="token operator">|</span> LVS_EX_GRIDLINES<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 初始化表头</span>
	CString field<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"商品ID"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"商品名称"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"商品价格"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"库存数量"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>field<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		m_list<span class="token punctuation">.</span><span class="token function">InsertColumn</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> field<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> LVCFMT_CENTER<span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//需要包含#include "InfoFile.h"</span>
	CInfoFile file<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取商品信息</span>

	<span class="token comment">//添加数据</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	CString str<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>list<span class="token operator">&lt;</span>msg<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it <span class="token operator">=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		str<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it<span class="token operator">-&gt;</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_list<span class="token punctuation">.</span><span class="token function">InsertItem</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> column <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		m_list<span class="token punctuation">.</span><span class="token function">SetItemText</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> column<span class="token operator">++</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>CString<span class="token punctuation">)</span>it<span class="token operator">-&gt;</span>name<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		str<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it<span class="token operator">-&gt;</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_list<span class="token punctuation">.</span><span class="token function">SetItemText</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> column<span class="token operator">++</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		str<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it<span class="token operator">-&gt;</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_list<span class="token punctuation">.</span><span class="token function">SetItemText</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> column<span class="token operator">++</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		i<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="10__833"></a>10 库存添加窗口</h3> 
<h4><a id="101_ui_834"></a>10.1 ui设计</h4> 
<p>1)添加对话框资源(ID修改为DIALOG_ADD)，添加所需控件。<br> <img src="https://images2.imgbox.com/88/d6/AcFhbvJY_o.png" alt="在这里插入图片描述"><br> 在窗口属性中，Border改为None，Style改为Child：<br> <img src="https://images2.imgbox.com/39/a7/j6e6zOok_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/81/18/qAl3Gjm8_o.png" alt="在这里插入图片描述"><br> 2)选中对话框 -&gt; 右击 -&gt; 添加类 -&gt; 类名：CAddDlg，基类选择CFormView<br> <img src="https://images2.imgbox.com/d3/33/86dSR7tC_o.png" alt="在这里插入图片描述"><br> 3)根据需求，控件关联所需变量<br> 添加个数：<br> 商品组合框关联CComboBox m_combo，单价编辑框关联int m_price1，<br> 个数编辑框关联int m_num1。</p> 
<p>添加新产品：<br> 商品组合框关联CString m_name2，单价编辑框关联int m_price2，<br> 个数编辑框关联int m_num2。<br> <img src="https://images2.imgbox.com/81/7b/rTr9NEGm_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="102__850"></a>10.2 界面挂载</h4> 
<p>在CMainFrame类中OnMyChange函数，添加如下代码：<br> <img src="https://images2.imgbox.com/1d/bd/Q2iT7FfP_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="103_853"></a>10.3功能实现</h4> 
<p>1)在对话框类中，重写 OnInitDialog 函数，进行商品信息初始化：<br> <img src="https://images2.imgbox.com/f7/d2/EI1XNrYK_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CAddDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	CFormView<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// TODO:  在此添加专用代码和/或调用基类</span>

	<span class="token comment">//读取文件，获取商品名，给组合框添加字符串</span>
	<span class="token comment">//需要包含#include "InfoFile.h"</span>
	CInfoFile file<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取商品信息</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>list<span class="token operator">&lt;</span>msg<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it <span class="token operator">=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		m_combo<span class="token punctuation">.</span><span class="token function">AddString</span><span class="token punctuation">(</span><span class="token punctuation">(</span>CString<span class="token punctuation">)</span>it<span class="token operator">-&gt;</span>name<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//清空list的内容</span>

	<span class="token comment">//将第一个商品名设为默认选中项</span>
	m_combo<span class="token punctuation">.</span><span class="token function">SetCurSel</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>2)处理组合框所需控制事件<br> <img src="https://images2.imgbox.com/2b/0a/CLEDYyQ7_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CAddDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnCbnSelchangeCombo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>

	CString text<span class="token punctuation">;</span>
	<span class="token comment">//获取当前选中项</span>
	<span class="token keyword">int</span> index <span class="token operator">=</span> m_combo<span class="token punctuation">.</span><span class="token function">GetCurSel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//获取当前内容</span>
	m_combo<span class="token punctuation">.</span><span class="token function">GetLBText</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//需要包含#include "InfoFile.h"</span>
	CInfoFile file<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取商品信息</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>list<span class="token operator">&lt;</span>msg<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it <span class="token operator">=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>text <span class="token operator">==</span> it<span class="token operator">-&gt;</span>name<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			m_price1 <span class="token operator">=</span> it<span class="token operator">-&gt;</span>price<span class="token punctuation">;</span>
			m_num1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//内容更新到对应的控件</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//清空list的内容</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>3)添加个数按钮实现</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CAddDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnBnClickedButton1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>

	<span class="token comment">//获取控件上的内容，更新到对应关联的变量中</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>m_num1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"个数不能为0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	CString type<span class="token punctuation">;</span>
	<span class="token comment">//获取当前选中项</span>
	<span class="token keyword">int</span> index <span class="token operator">=</span> m_combo<span class="token punctuation">.</span><span class="token function">GetCurSel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//获取组合框当前内容</span>
	m_combo<span class="token punctuation">.</span><span class="token function">GetLBText</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>

	CString str<span class="token punctuation">;</span>
	str<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"添加了 商品：%s \r\n单价：%d \r\n个数：%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type<span class="token punctuation">,</span> m_price1<span class="token punctuation">,</span> m_num1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">MessageBox</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token comment">//需要包含#include "InfoFile.h"</span>
	CInfoFile file<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取商品信息</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>list<span class="token operator">&lt;</span>msg<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it <span class="token operator">=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> it<span class="token operator">-&gt;</span>name<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			it<span class="token operator">-&gt;</span>num <span class="token operator">+</span><span class="token operator">=</span>  m_num1<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	file<span class="token punctuation">.</span><span class="token function">WirteDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//更新文件内容</span>

	file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//清空list的内容</span>

	m_num1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//更新到对应的控件</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>4)添加个数取消按钮实现</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CAddDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnBnClickedButton2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>

	m_combo<span class="token punctuation">.</span><span class="token function">SetCurSel</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_num1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">OnCbnSelchangeCombo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>5)添加新商品按钮实现</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CAddDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnBnClickedButton4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>

	<span class="token function">UpdateData</span><span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取控件内容</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>m_num2 <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> m_price2 <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> m_name2<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"输入信息有误"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//需要包含#include "InfoFile.h"</span>
	CInfoFile file<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取商品信息</span>
	file<span class="token punctuation">.</span><span class="token function">Addline</span><span class="token punctuation">(</span>m_name2<span class="token punctuation">,</span> m_num2<span class="token punctuation">,</span> m_price2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//添加商品</span>
	file<span class="token punctuation">.</span><span class="token function">WirteDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//写文件</span>
	file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//清空list的内容</span>
	<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"添加成功"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	m_name2<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_num2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	m_price2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>6)添加新商品取消按钮实现</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CAddDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnBnClickedButton5</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>
	m_name2<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_num2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	m_price2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="11__1007"></a>11 库存删除窗口</h3> 
<h4><a id="111_ui_1008"></a>11.1 ui设计</h4> 
<p>1)添加对话框资源(ID修改为DIALOG_DEL)，添加所需控件。<br> <img src="https://images2.imgbox.com/b0/ca/gmuI3hA1_o.png" alt="在这里插入图片描述"><br> 在窗口属性中，Border改为None，Style改为Child：<br> <img src="https://images2.imgbox.com/ad/37/ISvMt49m_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/46/7c/x61Nyhxp_o.png" alt="在这里插入图片描述"><br> 2)选中对话框 -&gt; 右击 -&gt; 添加类 -&gt; 类名：CDelDlg，基类选择CFormView<br> <img src="https://images2.imgbox.com/6f/35/T43NZFmS_o.png" alt="在这里插入图片描述"><br> 3)根据需求，控件关联所需变量<br> 商品名组合框关联CComboBox m_combo，单价编辑框关联int m_price，<br> 个数编辑框关联int m_num。<br> <img src="https://images2.imgbox.com/40/ba/qyyU0m9a_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="112__1021"></a>11.2 界面挂载</h4> 
<p>在CMainFrame类中OnMyChange函数，添加如下代码：</p> 
<pre><code class="prism language-c"><span class="token keyword">case</span> NM_E<span class="token punctuation">:</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//CDelDlg类需要包含头文件#include "DelDlg.h"</span>
		Context<span class="token punctuation">.</span>m_pNewViewClass <span class="token operator">=</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>CDelDlg<span class="token punctuation">)</span><span class="token punctuation">;</span>
		Context<span class="token punctuation">.</span>m_pCurrentFrame <span class="token operator">=</span> this<span class="token punctuation">;</span>
		Context<span class="token punctuation">.</span>m_pLastView <span class="token operator">=</span> <span class="token punctuation">(</span>CFormView <span class="token operator">*</span><span class="token punctuation">)</span>m_spliter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_spliter<span class="token punctuation">.</span><span class="token function">DeleteView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_spliter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>CDelDlg<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Context<span class="token punctuation">)</span><span class="token punctuation">;</span>
		CDelDlg <span class="token operator">*</span>pNewView <span class="token operator">=</span> <span class="token punctuation">(</span>CDelDlg <span class="token operator">*</span><span class="token punctuation">)</span>m_spliter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_spliter<span class="token punctuation">.</span><span class="token function">RecalcLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		pNewView<span class="token operator">-&gt;</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_spliter<span class="token punctuation">.</span><span class="token function">SetActivePane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
</code></pre> 
<p>程序运行效果图：<img src="https://images2.imgbox.com/9a/55/nIqAzrMK_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="113_1041"></a>11.3功能实现</h4> 
<p>1)在对话框类中，重写 OnInitDialog 函数，进行初始化。<br> <img src="https://images2.imgbox.com/9d/bd/3i1W08Qe_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CDelDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	CFormView<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//读取文件，获取商品名，给组合框添加字符串</span>
	<span class="token comment">//需要包含#include "InfoFile.h"</span>
	CInfoFile file<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取商品信息</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>list<span class="token operator">&lt;</span>msg<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it <span class="token operator">=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		m_combo<span class="token punctuation">.</span><span class="token function">AddString</span><span class="token punctuation">(</span><span class="token punctuation">(</span>CString<span class="token punctuation">)</span>it<span class="token operator">-&gt;</span>name<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	<span class="token comment">//将第一个商品名设为默认选中项</span>
	m_combo<span class="token punctuation">.</span><span class="token function">SetCurSel</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>2)处理组合框所需控制事件<br> <img src="https://images2.imgbox.com/6a/4f/IXAVfJRi_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CDelDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnCbnSelchangeCombo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>

	CString text<span class="token punctuation">;</span>
	<span class="token comment">//获取当前选中项</span>
	<span class="token keyword">int</span> index <span class="token operator">=</span> m_combo<span class="token punctuation">.</span><span class="token function">GetCurSel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//获取当前内容</span>
	m_combo<span class="token punctuation">.</span><span class="token function">GetLBText</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//需要包含#include "InfoFile.h"</span>
	CInfoFile file<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取商品信息</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>list<span class="token operator">&lt;</span>msg<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it <span class="token operator">=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>text <span class="token operator">==</span> it<span class="token operator">-&gt;</span>name<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			m_price <span class="token operator">=</span> it<span class="token operator">-&gt;</span>price<span class="token punctuation">;</span>
			m_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//内容更新到对应的控件</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	
<span class="token punctuation">}</span>
</code></pre> 
<p>3)确定按钮功能实现</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CDelDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnBnClickedButton1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>

	<span class="token comment">//获取控件上的内容，更新到对应关联的变量中</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>m_num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"个数不能为0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	CString type<span class="token punctuation">;</span>
	<span class="token comment">//获取当前选中项</span>
	<span class="token keyword">int</span> index <span class="token operator">=</span> m_combo<span class="token punctuation">.</span><span class="token function">GetCurSel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//获取组合框当前内容</span>
	m_combo<span class="token punctuation">.</span><span class="token function">GetLBText</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>

	CString str<span class="token punctuation">;</span>
	str<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"删除商品：%s \r\n单价：%d \r\n个数：%d "</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type<span class="token punctuation">,</span> m_price<span class="token punctuation">,</span> m_num<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">MessageBox</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token comment">//需要包含#include "InfoFile.h"</span>
	CInfoFile file<span class="token punctuation">;</span>
	file<span class="token punctuation">.</span><span class="token function">ReadDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取商品信息</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>list<span class="token operator">&lt;</span>msg<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator it <span class="token operator">=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> file<span class="token punctuation">.</span>ls<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> it<span class="token operator">-&gt;</span>name<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			it<span class="token operator">-&gt;</span>num <span class="token operator">=</span> it<span class="token operator">-&gt;</span>num <span class="token operator">-</span> m_num<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	file<span class="token punctuation">.</span><span class="token function">WirteDocline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//更新文件内容</span>

	

	m_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//更新到对应的控件</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>4)取消按钮功能实现</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> CDelDlg<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OnBnClickedButton2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加控件通知处理程序代码</span>

	m_combo<span class="token punctuation">.</span><span class="token function">SetCurSel</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//选择第0项目</span>
	m_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">OnCbnSelchangeCombo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="12__1152"></a>12 菜单栏</h3> 
<p>1)切换到资源视图的Menu，删除掉所有默认(帮助除外)：<img src="https://images2.imgbox.com/75/2d/RRNKORbX_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/df/fc/DMIPnwAS_o.png" alt="在这里插入图片描述"><br> 2) 右键菜单栏项，添加事件处理程序，选择COMMAND 消息类型，添加至CMainFrame框架类中。<br> <img src="https://images2.imgbox.com/e5/64/UDRlgHCp_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e9/10/8F4vqpWk_o.png" alt="在这里插入图片描述"><br> 3)在事件处理函数中发送自定义信号，其它菜单操作类似。</p> 
<pre><code class="prism language-c"><span class="token comment">//个人信息菜单</span>
<span class="token keyword">void</span> CMainFrame<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">On32772</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO:  在此添加命令处理程序代码</span>
<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_A<span class="token punctuation">,</span> <span class="token punctuation">(</span>WPARAM<span class="token punctuation">)</span>NM_A<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPARAM<span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7a7374871e89089f1f9994984aa29a38/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">bootstrap的DataTable行单元格增加按钮并绑定事件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0aee34378d8d25a7558454b35eb1ae60/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">labelImg 使用教程 图像标定工具</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>