<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>深入认识学习ASP应用Cookies的技巧 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="深入认识学习ASP应用Cookies的技巧" />
<meta property="og:description" content="什么是 Cookie？Cookie 其实是一个标签，经常可能听到的中文翻译：小舔饼。当你访问一个需要唯一标识你的站址的 WEB 站点时，它会在你的硬盘上留下一个标记，下一次你访问同一个站点时，站点的页面会查找这个标记。
每个 WEB 站点都有自己的标记，标记的内容可以随时读取，但只能由该站点的页面完成。每个站点的Cookie与其他所有站点的Cookie存在同一文件夹中的不同文件内（你可以在 win98 的 Windows 目录下的 Cookie 文件夹中找到它们，而 win2k 则在 Documents and Settings 文件夹下特定用户的 cookies 文件夹中）。
一个 Cookie 就是一个唯一标识客户的标记，Cookie 可以包含在一个对话期或几个对话期之间某个 WEB 站点的所有页面共享的信息，使用 Cookie 还可以在页面之间交换信息。这项功能经常被使用在要求认证客户密码以及电子公告板、WEB 聊天室等 ASP 程序中。
尽管现在听起来cookie没有什么激动人心的，但实际上利用它，你能实现许多有意义的功能！比如说：你可以在站点上放置一个调查问答表，询问访问者最喜欢的颜色和字体，然后根据这些定制用户的web界面。并且，你还可以保存访问者的登录密码，这样，当访问者再次访问这个站点时，不用再输入密码进行登录。 当然，cookie也有一些不足。首先，由于利用cookie的功能可以编程实现一些不良企图，所以大多数的浏览器中都有安全设定，其中可以设置是否允许或者接受cookie（IE浏览器中“工具”--“Internet选项...”--“安全”--“自定义级别”--“Cookie的使用”；Netscape浏览器中“工具”--“Cookie管理器”--“管理贮存的Cookie”即可），因此这就不能保证随时能使用cookie。再者，访问者可能有意或者无意地删除cookie。当访问者的机器遇到“蓝屏”死机时，或者重新格式化硬盘、安装系统后，原来保存的cookie将全部丢失。最后一点，有一些最初始的浏览器并不能支持cookie。 ◆ 怎样利用cooklie？ 有2种使用cookie的基本方式： 1、将cookie写入访问者的计算机（使用 Response 命令） 2、从访问者的计算机中取回cookie（使用 Request 命令）
◆ 创建cookie的基本语法: Response.Cookies(cookie)[(key)|.attribute]=value 这里的 cookie 是指定 cookie 的名称。 而如果指定了 key，则该 cookie 就是一个字典。 （测试一cookie是否为一个字典可用后面代码显示布尔值：&lt;%=Request.Cookies(&#34;cookiename&#34;).HasKeys%&gt;。为true是字典，false则不是。 ） Attribute 指定 cookie 自身的有关信息。Attribute 参数可以是下列之一 : ①Domain 若被指定，则 cookie 将被发送到对该域的请求中去。域属性表明cookie由哪个网站产生或者读取，默认情况下，cookie的域属性设置为产生它的网站，但你也可以根据需要改变它。（Response.Cookies(&#34;CookieName&#34;).Domain = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/da8aa1db7cb6499c4abec09cdadadc88/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-02-19T21:26:00+08:00" />
<meta property="article:modified_time" content="2011-02-19T21:26:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">深入认识学习ASP应用Cookies的技巧</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>什么是 Cookie？Cookie 其实是一个标签，经常可能听到的中文翻译：小舔饼。当你访问一个需要唯一标识你的站址的 WEB 站点时，它会在你的硬盘上留下一个标记，下一次你访问同一个站点时，站点的页面会查找这个标记。</p> 
<p>每个 WEB 站点都有自己的标记，标记的内容可以随时读取，但只能由该站点的页面完成。每个站点的Cookie与其他所有站点的Cookie存在同一文件夹中的不同文件内（你可以在 win98 的 Windows 目录下的 Cookie 文件夹中找到它们，而 win2k 则在 Documents and Settings 文件夹下特定用户的 cookies 文件夹中）。</p> 
<p>一个 Cookie 就是一个唯一标识客户的标记，Cookie 可以包含在一个对话期或几个对话期之间某个 WEB 站点的所有页面共享的信息，使用 Cookie 还可以在页面之间交换信息。这项功能经常被使用在要求认证客户密码以及电子公告板、WEB 聊天室等 ASP 程序中。</p> 
<p>尽管现在听起来cookie没有什么激动人心的，但实际上利用它，你能实现许多有意义的功能！比如说：你可以在站点上放置一个调查问答表，询问访问者最喜欢的颜色和字体，然后根据这些定制用户的web界面。并且，你还可以保存访问者的登录密码，这样，当访问者再次访问这个站点时，不用再输入密码进行登录。 </p> 
<p>当然，cookie也有一些不足。首先，由于利用cookie的功能可以编程实现一些不良企图，所以大多数的浏览器中都有安全设定，其中可以设置是否允许或者接受cookie（IE浏览器中“工具”--“Internet选项...”--“安全”--“自定义级别”--“Cookie的使用”；Netscape浏览器中“工具”--“Cookie管理器”--“管理贮存的Cookie”即可），因此这就不能保证随时能使用cookie。再者，访问者可能有意或者无意地删除cookie。当访问者的机器遇到“蓝屏”死机时，或者重新格式化硬盘、安装系统后，原来保存的cookie将全部丢失。最后一点，有一些最初始的浏览器并不能支持cookie。 </p> 
<p>◆ 怎样利用cooklie？ <br>有2种使用cookie的基本方式： <br>1、将cookie写入访问者的计算机（使用 Response 命令） <br>2、从访问者的计算机中取回cookie（使用 Request 命令）</p> 
<p>◆ 创建cookie的基本语法: Response.Cookies(cookie)[(key)|.attribute]=value <br>这里的 cookie 是指定 cookie 的名称。 <br>而如果指定了 key，则该 cookie 就是一个字典。 <br>（测试一cookie是否为一个字典可用后面代码显示布尔值：&lt;%=Request.Cookies("cookiename").HasKeys%&gt;。为true是字典，false则不是。 ） <br>Attribute 指定 cookie 自身的有关信息。Attribute 参数可以是下列之一 : </p> 
<p>①Domain 若被指定，则 cookie 将被发送到对该域的请求中去。域属性表明cookie由哪个网站产生或者读取，默认情况下，cookie的域属性设置为产生它的网站，但你也可以根据需要改变它。（Response.Cookies("CookieName").Domain = "www.dwww.cn"）</p> 
<p>②Path 为一路径属性，该属性可以实现更多的安全要求，通过设置网站上精确的路径，就能限制cookie的使用范围。如果未设置该属性，则使用应用程序的路径。（Response.Cookies("CookieName").Path = "/maindir/subdir/path" ）</p> 
<p>③Expires 指定 cookie 的过期日期。为了在会话结束后将 cookie 存储在客户端磁盘上，或在许多时候，我们希望能更长时间地在访问者的计算机上保存cookie。必须设置该日期。若此项属性的设置未超过当前日期，则在任务结束后 cookie 将到期。</p> 
<p>后面的代码，就可以设置cookie的使用到期时间为“2010年1月1日”： Response.Cookies("CookieName").Expires=#January 01, 2010# <br>后面的代码，将设定cookie的过期时间为“cookie的创建时间＋365天”：Response.Cookies("CookieName").Expires=Date+365 <br>但最好不要随便写 Response.Cookies("CookieName").Expires=Date，这样页面之间的调用时值会为空。</p> 
<p>执行下面的代码将会在访问者的计算机中创建一个cookie，名字＝VisitorName，值＝Ken ： <br>Response.Cookies("VisitorName")="Ken" <br>执行下面的代码将会在访问者的计算机中创建一个cookie，名字＝VisitorName，值＝表单中UserName的值 <br>Response.Cookies("VisitorName")=Request.Form("UserName") <br>你可以扩展下面的代码成为Cookie子关键值（CookieSubName），即cookie字典的生成。代码如下： <br>Response.Cookies("VisitorName")("FirstName")="Ken" <br>Response.Cookies("VisitorName")("LastName")="Baumbach" </p> 
<p>◆ 读取cookie的基本语法：Request.Cookies(cookie)[(key)|.attribute]</p> 
<p>cookie 指定要检索其值的 cookie。 <br>key 可选参数，用于从 cookie 字典中检索子关键字的值。 <br>attribe 指定 cookie 自身的有关信息。如：HasKeys 只读，指定 cookie 是否包含关键字。 <br>如果客户端浏览器发送了两个同名的 cookie,那么 Request.Cookie 将返回其中路径结构较深的一个。例如，如果有两个同名的的 cookie，但其中一个的路径属性为 /www/ 而另一个为 /www/home/，客户端浏览器同时将两个 cookie 都发送到 /www/home/ 目录中，那么 Request.Cookie 将只返回第二个 cookie。</p> 
<p>案例分析：</p> 
<p>◆ num.asp（通过留在本地磁盘上的cookie记录一年内访问本站的次数，第一次显示“首次访问”，以后显示“第几次访问”）</p> 
<p>&lt;% <br>dim num <br>num=request.cookies("visitnum") <br>if num &gt; "0" then <br>num=num+1 <br>Response.write "您已是第"&amp;num&amp;"次访问本站点了。" <br>else <br>Response.write "欢迎您首次访问本站。" <br>num=1 <br>end if <br>response.cookies("visitnum")=num <br>response.cookies("visitnum").expires=date+365 <br>%&gt; <br>◆ showcookie.asp（从Cookies文件夹中遍历出浏览器所有的Cookie name，以及相关的字典Cookie的显示（蓝字显示））</p> 
<p>&lt;% <br>For each cookie in Request.Cookies <br>if Request.cookies(cookie).HasKeys =false then <br>Response.write cookie &amp; "=" &amp; Request.Cookies(cookie) <br>Response.write ("<br>") <br>Else <br>for each key in Request.Cookies(cookie) <br>Response.write ("<font color="blue">") <br>Response.write cookie &amp; ".("&amp;key&amp;")" &amp; "=" &amp; Request.Cookies(cookie)(key) <br>Response.write ("</font><br>") <br>next <br>end if <br>next <br>%&gt; <br>◆ check.asp</p> 
<p>'首先，设置页面。然后，检查表单变量（在同一个页面中）。如果表单变量存在，就创建cookie，并设置到期时间。</p> 
<p>&lt;%@ LANGUAGE="VBSCRIPT" %&gt; <br>&lt;% <br>bgcolor = Request.Form("bgcolor") <br>fgcolor = Request.Form("fgcolor") <br>pwd = Request.form("pwd") <br>If bgcolor &lt;&gt;"" or fgcolor &lt;&gt;"" then <br>Response.cookies("check")("bgcolor") = bgcolor <br>Response.Cookies("check")("fgcolor") = fgcolor <br>Response.Cookies("check")("pwd") = pwd <br>Response.Cookies("check").Expires=#may 01, 2004# <br>End if <br>'接着，读取cookie <br>bgcolor = request.cookies("check")("bgcolor") <br>fgcolor = request.cookies("check")("fgcolor") <br>pwd = request.cookies("check")("pwd") <br>'如果cookie在访问者的计算机上不存在，就创建一个表单，询问相关信息 <br>If bgcolor ="" and fgcolor ="" and pwd="" then <br>%&gt; <br> <br> <br> <br></p> 
<div align="CENTER"> 
 <br> 
 <form> 
  <br>Bgcolor: 
  <input type="text" name="bgcolor"> 
  <br> 
  <br>Fgcolor: 
  <input type="text" name="fgcolor"> 
  <br> 
  <br>Password: 
  <input type="password" name="pwd"> 
  <br> 
  <br> 
  <input type="submit" value="Submit"> 
  <br> 
 </form> 
 <br> 
</div> 
<br> 
<br>&lt;% 
<br>End if 
<br>'如果cookie已经存在，并且bgcolor存在，就跳转到color.asp。 
<br>If bgcolor &lt;&gt; "" then 
<br>Response.Redirect "color.asp" 
<br>End if 
<br>%&gt; 
<br>◆ color.asp（显示用户爱好颜色的页面特性） 
<p></p> 
<p>&lt;% <br>bgcolor=request.cookies("check")("bgcolor") <br>fgcolor=request.cookies("check")("fgcolor") <br>pwd=request.cookies("check")("pwd") <br>%&gt; <br>&lt;%response.write("<font color="&amp;fgcolor&amp;">")%&gt; <br>你的密码是： <br>&lt;%response.write(" "&amp;pwd&amp;" ")%&gt;</font></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/853a1eb3171ed1f87fc40c9a60a5945b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">TrueCrypt原理与系统开发(1)：TrueCrypt Format创建加密卷</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/16a8f53dd34668799d147f1bdc99a7f8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何模拟网络不稳定的环境</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>