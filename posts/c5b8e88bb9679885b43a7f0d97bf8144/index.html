<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Dbus通信及使用方法介绍 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Dbus通信及使用方法介绍" />
<meta property="og:description" content="D-Bus是一种高级的进程间通信机制，它由freedesktop.org项目提供，使用GPL许可证发行。D-Bus的主要概念为总线，注册后的进程可通过总线接收或传递消息，进程也可注册后等待内核事件响应，例如等待网络状态的转变或者计算机发出关机指令。
DBus的三层架构：
底层接口层：主要是通过libdbus这个函数库，使进程拥有使用DBus的能力。
总线层：主要是由Dbus 总线守护进程(daemon)提供的，在Linux/Qnx系统启动时运行，负责进程间的消息路由和传递，其中包括内核和桌面环境的消息传递。总线守护进程可同时与多个进程相连，并能把来自一个进程的消息路由到一个或者多个进程。
应用封装层：通过一系列基于特定应用程序框架将DBus的底层接口封装成友好的Wrapper库，供应用开发人员使用。
通信类型：
信号(Signal)，最常用的通信方式。一个进程可以发送一个或多个信号给另一个进程(或多个进程)，发送进程指定Dbus接口(interface)和信号(member)，接收进程通过监听相应的接口和成员来接收信号。
方法(Method)：处理比较复杂或比较大量的数据。通过Dbus调用另一个进程的方法，当方法执行完毕时会通过回调函数(Callback)来通知调用进程，调用进程可以在回调函数内处理返回的数据。
接收信号流程：
1.调用dbus_bus_register进行Dbus总线注册。注册dbus的进程需要设定一个dbus name用来在总线上标识自己，注册完成后会创建一个DBusConnection，相当于该进程与dbus总线的连接点。
2.调用dbus_bus_add_match()添加信号匹配条件，一般是以字符串列表(包含interface和member)的形式添加。告诉dbus总线该进程想要接收信号对应的接口和信号名，当dbus总线接收到对应的信号时就会发送给添加条件的进程。
3.调用dbus_connection_add_filter(conn, function, NULL, NULL)添加接收到消息时的处理函数。当进程接收到dbus总线通知的消息时会进入到该函数，在该函数内可以根据不同接口收到的信号分别进行处理。
发送信号流程：
1.第一步和接收信号流程的第一步一样，需要先进行注册，为dubs连接取名，创建一个发送信号的通道。
2.调用dbus_message_new_signal
(obj_path,interface,member)创建要发送的接口名和信号名。
3.调用dbus_message_append_args 设置发送消息的相关参数
4.调用dbus_connection_send(connection,msg) 把消息发送到指定的dubs连接
调用dbus_connection_flush(connection) 冲刷dbus连接，此时消息就会发送到dbus总线上。
欢迎关注微信公众号“日拱一卒不期而至”获取更多内容及学习资料。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c5b8e88bb9679885b43a7f0d97bf8144/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-26T10:43:58+08:00" />
<meta property="article:modified_time" content="2022-05-26T10:43:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Dbus通信及使用方法介绍</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>D-Bus是一种高级的进程间通信机制，它由freedesktop.org项目提供，使用GPL许可证发行。D-Bus的主要概念为总线，注册后的进程可通过总线接收或传递消息，进程也可注册后等待内核事件响应，例如等待网络状态的转变或者计算机发出关机指令。</p> 
<p>DBus的三层架构：<br> 底层接口层：主要是通过libdbus这个函数库，使进程拥有使用DBus的能力。<br> 总线层：主要是由Dbus 总线守护进程(daemon)提供的，在Linux/Qnx系统启动时运行，负责进程间的消息路由和传递，其中包括内核和桌面环境的消息传递。总线守护进程可同时与多个进程相连，并能把来自一个进程的消息路由到一个或者多个进程。<br> 应用封装层：通过一系列基于特定应用程序框架将DBus的底层接口封装成友好的Wrapper库，供应用开发人员使用。</p> 
<p>通信类型：<br> 信号(Signal)，最常用的通信方式。一个进程可以发送一个或多个信号给另一个进程(或多个进程)，发送进程指定Dbus接口(interface)和信号(member)，接收进程通过监听相应的接口和成员来接收信号。<br> 方法(Method)：处理比较复杂或比较大量的数据。通过Dbus调用另一个进程的方法，当方法执行完毕时会通过回调函数(Callback)来通知调用进程，调用进程可以在回调函数内处理返回的数据。</p> 
<p>接收信号流程：<br> 1.调用dbus_bus_register进行Dbus总线注册。注册dbus的进程需要设定一个dbus name用来在总线上标识自己，注册完成后会创建一个DBusConnection，相当于该进程与dbus总线的连接点。<br> 2.调用dbus_bus_add_match()添加信号匹配条件，一般是以字符串列表(包含interface和member)的形式添加。告诉dbus总线该进程想要接收信号对应的接口和信号名，当dbus总线接收到对应的信号时就会发送给添加条件的进程。<br> 3.调用dbus_connection_add_filter(conn, function, NULL, NULL)添加接收到消息时的处理函数。当进程接收到dbus总线通知的消息时会进入到该函数，在该函数内可以根据不同接口收到的信号分别进行处理。</p> 
<p>发送信号流程：<br> 1.第一步和接收信号流程的第一步一样，需要先进行注册，为dubs连接取名，创建一个发送信号的通道。<br> 2.调用dbus_message_new_signal<br> (obj_path,interface,member)创建要发送的接口名和信号名。<br> 3.调用dbus_message_append_args 设置发送消息的相关参数<br> 4.调用dbus_connection_send(connection,msg) 把消息发送到指定的dubs连接<br> 调用dbus_connection_flush(connection) 冲刷dbus连接，此时消息就会发送到dbus总线上。</p> 
<p>欢迎关注微信公众号“日拱一卒不期而至”获取更多内容及学习资料。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/874db5cf2a9c0431e0f95fdbe74ae5dc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">浅谈域控制器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2073f895a4de5c821977747126775900/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">项目八总结：数据库的安全性维护</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>