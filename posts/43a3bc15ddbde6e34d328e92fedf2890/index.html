<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Faster RCNN训练自己的数据集【傻瓜式教程】 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Faster RCNN训练自己的数据集【傻瓜式教程】" />
<meta property="og:description" content="一、下载源码 本文采用的源码是：https://github.com/dBeker/Faster-RCNN-TensorFlow-Python3
二、配置环境 由于本文是小白教程，光写几个环境怕有人配置不好或者配置版本搞乱。Faster RCNN配置环境比较复杂。我在这直接贴图我的环境版本图：
先安装tensorflow-gpu，然后依次安装cython、opencv-python、easydict、Pillow、matplotlib、scipy，版本的话看我的版本装就行。
三、安装C&#43;&#43;编译环境 根据官网给的安装程序会报错：安装visual studio C&#43;&#43; build tools时遇到安装包缺失或损坏的问题。在这直接下载离线包安装，目前很多博主或者资源都要收费，这里免费共享给大家百度网盘链接：
链接：https://pan.baidu.com/s/1ClJQQ_Tfh9OSME489bNBng
提取码：5czp
下载后解压，右键管理员身份运行，如图：
四、编译环境 首先进入模型文件夹data\coco\PythonAPI下，在这个环境下进入到自己配置的环境中，依次运行以下命令：
python setup.py build_ext --inplace 这里会出现报错：error: command ‘C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\BIN\x86_amd64\link.exe’ failed with exit status 1158
解决方案：在全局搜索工具中搜索rc.exe，没有工具的自行去下。如图
然后一定要退出窗口重新进入到自己配置的环境中，不退出继续执行还是会报这个错。然后重新运行以下命令：
python setup.py build_ext --inplace 接着运行
python setup.py build_ext install 然后进入到模型文件夹./lib/utils下，运行以下命令：
python setup.py build_ext --inplace 做完这一步，环境就算大功告成了。
五、制作自己的数据集 在data文件夹下新建VOC2007文件夹，VOC2007文件夹结构如图：
接下来划分数据集，会在ImageSets/Main下生成4个txt文件，具体看代码：
import os import random trainval_percent = 0.2 train_percent = 0.8 xmlfilepath = &#39;data/VOC2007/Annotations&#39; txtsavepath = &#39;data/VOC2007/ImageSets/Main&#39; total_xml = os." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/43a3bc15ddbde6e34d328e92fedf2890/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-13T22:22:31+08:00" />
<meta property="article:modified_time" content="2023-12-13T22:22:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Faster RCNN训练自己的数据集【傻瓜式教程】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>一、下载源码</h3> 
<p>本文采用的源码是：<a href="https://github.com/dBeker/Faster-RCNN-TensorFlow-Python3">https://github.com/dBeker/Faster-RCNN-TensorFlow-Python3</a></p> 
<h3><a id="_2"></a>二、配置环境</h3> 
<p>由于本文是小白教程，光写几个环境怕有人配置不好或者配置版本搞乱。Faster RCNN配置环境比较复杂。我在这直接贴图我的环境版本图：<br> <img src="https://images2.imgbox.com/9b/b6/1gju5BAd_o.png" alt="在这里插入图片描述"><br> 先安装tensorflow-gpu，然后依次安装cython、opencv-python、easydict、Pillow、matplotlib、scipy，版本的话看我的版本装就行。</p> 
<h3><a id="C_6"></a>三、安装C++编译环境</h3> 
<p>根据官网给的安装程序会报错：安装visual studio C++ build tools时遇到安装包缺失或损坏的问题。在这直接下载离线包安装，目前很多博主或者资源都要收费，这里免费共享给大家百度网盘链接：</p> 
<p>链接：https://pan.baidu.com/s/1ClJQQ_Tfh9OSME489bNBng<br> 提取码：5czp</p> 
<p>下载后解压，右键管理员身份运行，如图：<br> <img src="https://images2.imgbox.com/1c/dc/7bZlTNAC_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_14"></a>四、编译环境</h3> 
<p>首先进入模型文件夹data\coco\PythonAPI下，在这个环境下进入到自己配置的环境中，依次运行以下命令：</p> 
<pre><code>python setup.py build_ext --inplace
</code></pre> 
<p>这里会出现报错：error: command ‘C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\BIN\x86_amd64\link.exe’ failed with exit status 1158<br> 解决方案：在全局搜索工具中搜索rc.exe，没有工具的自行去下。如图<br> <img src="https://images2.imgbox.com/44/99/TqW9J3f4_o.png" alt="在这里插入图片描述"><br> 然后一定要退出窗口重新进入到自己配置的环境中，不退出继续执行还是会报这个错。然后重新运行以下命令：</p> 
<pre><code>python setup.py build_ext --inplace
</code></pre> 
<p>接着运行</p> 
<pre><code>python setup.py build_ext install
</code></pre> 
<p>然后进入到模型文件夹./lib/utils下，运行以下命令：</p> 
<pre><code>python setup.py build_ext --inplace
</code></pre> 
<p>做完这一步，环境就算大功告成了。</p> 
<h3><a id="_38"></a>五、制作自己的数据集</h3> 
<p>在data文件夹下新建VOC2007文件夹，VOC2007文件夹结构如图：<br> <img src="https://images2.imgbox.com/d4/79/0ZTkAoUK_o.png" alt="在这里插入图片描述"><br> 接下来划分数据集，会在ImageSets/Main下生成4个txt文件，具体看代码：</p> 
<pre><code>import os
import random

trainval_percent = 0.2
train_percent = 0.8
xmlfilepath = 'data/VOC2007/Annotations'
txtsavepath = 'data/VOC2007/ImageSets/Main'
total_xml = os.listdir(xmlfilepath)

num = len(total_xml)
list = range(num)
tv = int(num * trainval_percent)
tr = int(tv * train_percent)
trainval = random.sample(list, tv)
train = random.sample(trainval, tr)

ftrainval = open('data/VOC2007/ImageSets/Main/trainval.txt', 'w')
ftest = open('data/VOC2007/ImageSets/Main/test.txt', 'w')
ftrain = open('data/VOC2007/ImageSets/Main/train.txt', 'w')
fval = open('data/VOC2007/ImageSets/Main/val.txt', 'w')

for i in list:
    name = total_xml[i][:-4] + '\n'
    if i in trainval:
        ftrainval.write(name)
        if i in train:
            ftrain.write(name)
        else:
            fval.write(name)
    else:
        ftest.write(name)

ftrainval.close()
ftrain.close()
fval.close()
ftest.close()

</code></pre> 
<p>这样数据集就算做好了。</p> 
<h3><a id="_83"></a>六、开始训练</h3> 
<p>进入自己配置好的环境：</p> 
<pre><code>python train.py
</code></pre> 
<p>运行开始训练。</p> 
<h3><a id="_91"></a>七、解决报错</h3> 
<p>1.AttributeError：module tensorflow no attribute app<br> 解决方案：将import tensorflow as tf 改为import tensorflow.compat.v1 as tf<br> 2.AttributeError: ‘version_info’ object has no attribute ‘version’<br> 解决方案：<br> <img src="https://images2.imgbox.com/c7/45/nfDuVpep_o.png" alt="在这里插入图片描述"><br> 找到箭头所指文件，打开将：</p> 
<pre><code>class version_info(NamedTuple):
    major: int
    minor: int
    micro: int
    releaselevel: str
    serial: int

    @property
    def __version__(self):
        return "{}.{}.{}".format(self.major, self.minor, self.micro) + (
            "{}{}{}".format(
                "r" if self.releaselevel[0] == "c" else "",
                self.releaselevel[0],
                self.serial,
            ),
            "",
        )[self.releaselevel == "final"]

    def __str__(self):
        return "{} {} / {}".format(__name__, self.__version__, __version_time__)

    def __repr__(self):
        return "{}.{}({})".format(
            __name__,
            type(self).__name__,
            ", ".join("{}={!r}".format(*nv) for nv in zip(self._fields, self)),
        )
</code></pre> 
<p>替换为：</p> 
<pre><code>class version_info():
    def __init__(self, major: int, minor: int, micro: int, releaselevel: str, serial: int):
        self.major = major
        self.minor = minor
        self.micro = micro
        self.releaselevel = releaselevel
        self.serial = serial

    @property
    def __version__(self):
        return "{}.{}.{}".format(self.major, self.minor, self.micro) + (
            "{}{}{}".format(
                "r" if self.releaselevel[0] == "c" else "",
                self.releaselevel[0],
                self.serial,
            ),
            "",
        )[self.releaselevel == "final"]

    def __str__(self):
        return "{} {} / {}".format(__name__, self.__version__, __version_time__)

    def __repr__(self):
        return "{}.{}({})".format(
            __name__,
            type(self).__name__,
            ", ".join("{}={!r}".format(*nv) for nv in zip(self._fields, self)),
        )
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ca718911c6f1b19fa3fdb65b76ae789c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">链路追踪详解（四）：分布式链路追踪的事实标准 OpenTelemetry 概述</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fe9a99276acb456e20ccf5641798c2e6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Certbot实现 HTTPS 免费证书(Let‘s Encrypt)自动续期</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>