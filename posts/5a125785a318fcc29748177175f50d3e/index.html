<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python爬虫进阶必备 | 某电竞加密参数分析( 什么花里胡哨，三行代码完成加密)... - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python爬虫进阶必备 | 某电竞加密参数分析( 什么花里胡哨，三行代码完成加密)..." />
<meta property="og:description" content="点击上方“咸鱼学Python”，选择“加为星标”
第一时间关注Python技术干货！
建议收藏 | 最全的 JS 逆向入门教程合集
目标网站：
aHR0cHM6Ly93d3cuamRqMDA3LmNvbS8=
抓包分析与加密定位 首先打开开发者模式，抓包请求【图1-1】
图1-1 可以看到这里的加密参数名为sign
拿到加密参数名，我们现在用两种方法定位加密位置
•xhr 断点•直接搜索参数
使用 xhr 断点只要分析堆栈肯定可以找到这个参数生成的地方，不过很麻烦，建议当你没办法通过检索参数名找到加密位置的线索的时候再使用 xhr 断点。【图1-2】
图1-2 在这个例子当中，直接搜索 sign 就可以找到这个加密的参数位置了。【图1-3】
图1-3 结果不多只有 5 个，逐个检索也可以找到，上图红框中标记的就是 sign 这个参数加密所在文件，我们打开在文件中再次检索。【图1-4】
图1-4 可以看到，这个参数 sign 等于 a ，如果你没办法确认这个位置是不是，你可以打上断点重新加载看看是否会断在这个位置就知道了。
加密分析 找到加密位置之后，我们就来看看这个 a 他的加密到底是个啥。
经过断点可以看到a是在这里生成的。【图2-1】
图2-1 那么a 等于什么呢？就是下面这一串了。
var e, n, r = (new Date).getTime(), o = &#34;timestamp=&#34;.concat(r,&#34;&amp;secret=&#34;).concat(&#34;aHVheWluZ19zZWNyZXRfYXBp&#34;), a = (e = o,n = i()(e),encodeURIComponent(s.a.stringify(n))); 这段代码怎么理解？
其实非常简单，我给大家拆分一下。
a 的值是等于 encodeURIComponent(s.a.stringify(n))
但是生成a中用到了变量n，这个 n又等于i()(e)。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/5a125785a318fcc29748177175f50d3e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-12-24T08:45:00+08:00" />
<meta property="article:modified_time" content="2019-12-24T08:45:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python爬虫进阶必备 | 某电竞加密参数分析( 什么花里胡哨，三行代码完成加密)...</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p style="text-align: center">点击上方“咸鱼学Python”，选择“加为星标”</p> 
 <p style="text-align: center">第一时间关注Python技术干货！</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/65/e3/fbjrLy6Q_o.png"></p> 
 <p style="text-align: center"><a target="_blank" href="https://blog.csdn.net/weixin_43189702/article/details/103171967" rel="noopener noreferrer">建议收藏 | 最全的 JS 逆向入门教程合集</a><br></p> 
 <p style="text-align: left">目标网站：</p> 
 <p style="text-align: left">aHR0cHM6Ly93d3cuamRqMDA3LmNvbS8=</p> 
 <h2>抓包分析与加密定位</h2> 
 <p style="text-align: left">首先打开开发者模式，抓包请求【图1-1】</p> 
 <img src="https://images2.imgbox.com/de/ab/Af6sLTDK_o.png" title="null"> 
 <figcaption> 
  图1-1 
 </figcaption> 
 <p style="text-align: left">可以看到这里的加密参数名为<code>sign</code></p> 
 <p style="text-align: left">拿到加密参数名，我们现在用两种方法定位加密位置</p> 
 <p style="text-align: left">•xhr 断点•直接搜索参数</p> 
 <p style="text-align: left">使用 xhr 断点只要分析堆栈肯定可以找到这个参数生成的地方，不过很麻烦，建议当你没办法通过检索参数名找到加密位置的线索的时候再使用 xhr 断点。【图1-2】</p> 
 <img src="https://images2.imgbox.com/2a/07/MQ1k5Mi6_o.png" title="null"> 
 <figcaption> 
  图1-2 
 </figcaption> 
 <p style="text-align: left">在这个例子当中，直接搜索 sign 就可以找到这个加密的参数位置了。【图1-3】</p> 
 <img src="https://images2.imgbox.com/51/9d/b4BKAImq_o.png" title="null"> 
 <figcaption> 
  图1-3 
 </figcaption> 
 <p style="text-align: left">结果不多只有 5 个，逐个检索也可以找到，上图红框中标记的就是 sign 这个参数加密所在文件，我们打开在文件中再次检索。【图1-4】</p> 
 <img src="https://images2.imgbox.com/6f/38/Xh1UStwv_o.png" title="null"> 
 <figcaption> 
  图1-4 
 </figcaption> 
 <p style="text-align: left">可以看到，这个参数 sign 等于 a ，如果你没办法确认这个位置是不是，你可以打上断点重新加载看看是否会断在这个位置就知道了。</p> 
 <h2>加密分析</h2> 
 <p style="text-align: left">找到加密位置之后，我们就来看看这个 <code>a</code> 他的加密到底是个啥。</p> 
 <p style="text-align: left">经过断点可以看到<code>a</code>是在这里生成的。【图2-1】</p> 
 <img src="https://images2.imgbox.com/e8/a9/uRO1SeRd_o.png" title="null"> 
 <figcaption> 
  图2-1 
 </figcaption> 
 <p style="text-align: left">那么<code>a</code> 等于什么呢？就是下面这一串了。</p> 
 <pre class="has"><code class="language-js">var e, n, r = (new Date).getTime(), o = "timestamp=".concat(r,"&amp;secret=").concat("aHVheWluZ19zZWNyZXRfYXBp"), a = (e = o,n = i()(e),encodeURIComponent(s.a.stringify(n)));
</code></pre> 
 <p style="text-align: left">这段代码怎么理解？</p> 
 <p style="text-align: left">其实非常简单，我给大家拆分一下。</p> 
 <p style="text-align: left"><code>a</code> 的值是等于 <code>encodeURIComponent(s.a.stringify(n))</code></p> 
 <p style="text-align: left">但是生成<code>a</code>中用到了变量<code>n</code>，这个 <code>n</code>又等于<code>i()(e)</code>。</p> 
 <p style="text-align: left">同样的这里还用到了<code>i()</code>与<code>e</code>，这里的<code>e</code> = <code>o</code>就是当前的时间戳，<code>i()</code>这个方法返回了加密方法<code>e</code>。</p> 
 <p style="text-align: left">现在每一部分缺失的都找到了，只要明白这个加密方法<code>e</code>是什么就完成了。</p> 
 <p style="text-align: left">我们追进去看看【图2-2】</p> 
 <img src="https://images2.imgbox.com/33/db/199wvUfx_o.png" title="null"> 
 <figcaption> 
  图2-2 
 </figcaption> 
 <p style="text-align: left">看到这个有没有感觉有点熟悉。</p> 
 <p style="text-align: left">之前我写过一个文章有类似的代码。</p> 
 <p style="text-align: left">当我追到<code>_doFinalize</code>之后看到了下面这段代码。【图2-3】</p> 
 <img src="https://images2.imgbox.com/89/7c/yJ3Xjmlk_o.png" title="null"> 
 <figcaption> 
  图2-3 
 </figcaption> 
 <p style="text-align: left">看到上图红框的地方，我就知道：我好了，你们呢？</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/eb/e1/jk6Ddkh4_o.png"></p> 
 <p style="text-align: left">回顾上面的逻辑，下面这段代码就是<code>sha256</code> + <code>base64</code> 再将结果用 URL 编码一下，完事了。</p> 
 <pre class="has"><code class="language-js">var e, n, r = (new Date).getTime(), o = "timestamp=".concat(r,"&amp;secret=").concat("aHVheWluZ19zZWNyZXRfYXBp"), a = (e = o,n = i()(e),encodeURIComponent(s.a.stringify(n)));
</code></pre> 
 <p style="text-align: left">面对这样的加密，其实只要三行代码就完成了</p> 
 <pre class="has"><code class="language-js">var CryptoJS = require("crypto-js");
var sha256 = CryptoJS.SHA256('timestamp=1577106229851&amp;secret=aHVheWluZ19zZWNyZXRfYXBp')
sha256 = CryptoJS.enc.Base64.stringify(sha256);
// 送一行打印代码
console.log(encodeURIComponent(sha256))
</code></pre> 
 <p style="text-align: left">对于老手或者看过我之前文章的朋友，这个文章太简单了。</p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/1f/08/DjZjqoUw_o.png"></p> 
 <p style="text-align: left">下面是给一些新手朋友的一些搜索关键词和解答一些问题。</p> 
 <p style="text-align: left">第一个，<code>s.a.stringify</code>怎么看出他是 Base64 的 ?</p> 
 <p style="text-align: left">单步调试到下图位置</p> 
 <img src="https://images2.imgbox.com/46/27/4SEm7XMk_o.png" title="null"> 
 <p style="text-align: left">然后使用<code>F11</code>你就看到下面的代码了。</p> 
 <img src="https://images2.imgbox.com/b9/9c/fbFGEDLW_o.png" title="null"> 
 <p style="text-align: left">在这里还是没有看出来的话可以在浏览器中搜索<code>js base64 stringify</code> 就会看到很多类似的文章了。</p> 
 <p style="text-align: left">第二个，实在不知道上面<code>e</code>的加密是什么，就把源字符串复制到网上的在线加密网站上试试。很快就能得出结果了，敢于尝试，反正闲着也是闲着。</p> 
 <p style="text-align: left">如果你这样还看不懂，为师送你一本秘籍，祝你神功大成。<br></p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/a4/13/nxfMBIRN_o.png"></p> 
 <p style="text-align: center">如果本文对你有帮助，不如点个<strong>好看</strong>支持一下？<br></p> 
 <p style="text-align: center"><img src="https://images2.imgbox.com/cc/e5/QwWJsbMB_o.png"></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d9d9ac1b9d5ef1ba718bd35aacacebd8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">机器人学习笔记(3) 正运动学和逆运动学</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dbed505dd4a037fd0dbcce2ff6081f69/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">scrapy设置和查看Cookie</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>