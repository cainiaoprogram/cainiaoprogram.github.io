<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Dart —— 库的可见性 如何实现自己的库 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Dart —— 库的可见性 如何实现自己的库" />
<meta property="og:description" content="Dart汇总请点击这里
库和可见性 import 和 library 指令可以用来创建一个模块化的，可共享的代码库。 库不仅提供了 API ，而且对代码起到了封装的作用： 以下划线 (_) 开头的标识符仅在库内可见。 每个 Dart 应用程序都是一个库 ，虽然没有使用 library 指令。
库可以通过包来分发。有关 pub（集成在SDK中的包管理器）的信息，请参考 在pub上发布自己的库。
使用库 通过import指定一个库命名空间中的内如如何在另一个库中使用。 例如，Dart Web应用程序通常使用dart:html 库，它们可以像这样导入：
import &#39;dart:html&#39;; import参数只需要一个指向库的 URI。 对于内置库，URI 拥有自己特殊的dart:方案。 对于其他的库，使用系统文件路径或者 package:方案 。 package:方案指定由包管理器（如 pub 工具）提供的库。例如：
import &#39;package:test/test.dart&#39;; 提示： URI 代表统一资源标识符。 URL（统一资源定位符）是一种常见的URI。
指定库前缀 如果导入两个存在冲突标识符的库， 则可以为这两个库，或者其中一个指定前缀。 例如，如果 library1 和 library2 都有一个 Element 类， 那么可以通过下面的方式处理：
import &#39;package:lib1/lib1.dart&#39;; import &#39;package:lib2/lib2.dart&#39; as lib2; // 使用 lib1 中的 Element。 Element element1 = Element(); // 使用 lib2 中的 Element。 lib2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/bcb227389ab823f5ae0eb876c7cca2cb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-12-06T18:12:08+08:00" />
<meta property="article:modified_time" content="2019-12-06T18:12:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Dart —— 库的可见性 如何实现自己的库</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>Dart汇总请点击<a href="https://blog.csdn.net/rd_w_csdn/article/details/103524452">这里</a></p> 
</blockquote> 
<h4><a id="_3"></a>库和可见性</h4> 
<p><code>import</code> 和 <code>library</code> 指令可以用来创建一个模块化的，可共享的代码库。 库不仅提供了 API ，而且对代码起到了封装的作用： 以下划线 (_) 开头的标识符仅在库内可见。 每个 Dart 应用程序都是一个库 ，虽然没有使用 <code>library</code> 指令。</p> 
<p>库可以通过包来分发。有关 pub（集成在SDK中的包管理器）的信息，请参考 <a href="https://blog.csdn.net/rd_w_csdn/article/details/103390176">在pub上发布自己的库</a>。</p> 
<h5><a id="_8"></a>使用库</h5> 
<p>通过<code>import</code>指定一个库命名空间中的内如如何在另一个库中使用。 例如，Dart Web应用程序通常使用<code>dart:html</code> 库，它们可以像这样导入：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token string">'dart:html'</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>import</code>参数只需要一个指向库的 URI。 对于内置库，URI 拥有自己特殊的<code>dart:</code>方案。 对于其他的库，使用系统文件路径或者 <code>package:</code>方案 。 <code>package:</code>方案指定由包管理器（如 pub 工具）提供的库。例如：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token string">'package:test/test.dart'</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>提示： URI 代表统一资源标识符。 URL（统一资源定位符）是一种常见的URI。</p> 
</blockquote> 
<h6><a id="_19"></a>指定库前缀</h6> 
<p>如果导入两个存在冲突标识符的库， 则可以为这两个库，或者其中一个指定前缀。 例如，如果 library1 和 library2 都有一个 Element 类， 那么可以通过下面的方式处理：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token string">'package:lib1/lib1.dart'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'package:lib2/lib2.dart'</span> as lib2<span class="token punctuation">;</span>

<span class="token comment">// 使用 lib1 中的 Element。</span>
Element element1 <span class="token operator">=</span> <span class="token function">Element</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用 lib2 中的 Element。</span>
lib2<span class="token punctuation">.</span>Element element2 <span class="token operator">=</span> lib2<span class="token punctuation">.</span><span class="token function">Element</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="_31"></a>导入库的一部分</h6> 
<p>如果你只使用库的一部分功能，则可以选择需要导入的 内容。例如：</p> 
<pre><code class="prism language-java"><span class="token comment">// Import only foo.</span>
<span class="token keyword">import</span> <span class="token string">'package:lib1/lib1.dart'</span> show foo<span class="token punctuation">;</span>

<span class="token comment">// Import all names EXCEPT foo.</span>
<span class="token keyword">import</span> <span class="token string">'package:lib2/lib2.dart'</span> hide foo<span class="token punctuation">;</span>
</code></pre> 
<h6><a id="_40"></a>延迟加载库</h6> 
<p>Deferred loading (也称之为 lazy loading) 可以让应用在需要的时候再加载库。 下面是一些使用延迟加载库的场景：</p> 
<ul><li>减少 APP 的启动时间。</li><li>执行 A/B 测试，例如 尝试各种算法的 不同实现。</li><li>加载很少使用的功能，例如可选的屏幕和对话框。</li><li>要延迟加载一个库，需要先使用 deferred as 来导入：</li></ul> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token string">'package:greetings/hello.dart'</span> deferred as hello<span class="token punctuation">;</span>
</code></pre> 
<p>当需要使用的时候，使用库标识符调用 loadLibrary() 函数来加载库：</p> 
<pre><code class="prism language-js">Future <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">await</span> hello<span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  hello<span class="token punctuation">.</span><span class="token function">printGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在前面的代码，使用 await 关键字暂停代码执行一直到库加载完成。 关于 async 和 await 的更多信息请参考 <a href="https://blog.csdn.net/rd_w_csdn/article/details/103427658">异步支持</a>。</p> 
<p>在一个库上你可以多次调用 <code>loadLibrary()</code>函数。但是该库只是载入一次。</p> 
<p>使用延迟加载库的时候，请注意一下问题：</p> 
<ul><li>延迟加载库的常量在导入的时候是不可用的。 只有当库加载完毕的时候，库中常量才可以使用。</li><li>在导入文件的时候无法使用延迟库中的类型。 如果你需要使用类型，则考虑把接口类型移动到另外一个库中， 让两个库都分别导入这个接口库。</li><li>Dart 隐含的把 loadLibrary() 函数导入到使用 deferred as 的命名空间 中。 loadLibrary() 方法返回一个 Future。</li></ul> 
<blockquote> 
 <p>Dart VM difference: The Dart VM allows access to members of deferred libraries even before the call to loadLibrary(). This behavior might change, so don’t depend on the current VM behavior. For details, see issue #33118.</p> 
</blockquote> 
<h5><a id="_69"></a>实现库</h5> 
<p>有关如何实现库包的建议，请参考 我的另一篇文章 <a href="https://blog.csdn.net/rd_w_csdn/article/details/103390176">在pub上发布自己的库</a>。或者请参考 <a href="https://www.dartcn.com/guides/libraries/create-library-packages" rel="nofollow">Create Library Packages</a> 这里面包括：</p> 
<p>如何组织库的源文件。<br> 如何使用 export 命令。<br> 何时使用 part 命令。<br> 何时使用 library 命令。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9973030d783efda19e99bb4f9c67e36d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">HttpClient实现https的简单例子</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4669f054418cc78e0194c4479028709d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">翻币问题  题解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>