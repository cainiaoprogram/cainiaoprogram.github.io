<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>线阵相机学习笔记（一） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="线阵相机学习笔记（一）" />
<meta property="og:description" content="1、GigE Vision GigE Vision是由自动化影像协会AIA(Automated Imaging Association)发起指定的一种基于千兆以太网的图像传输的标准。
具有传输距离长（无中继时100米）、传输效率高并可向上升级到万兆网、通信控制方便、软硬件互换性强、可靠性高等优点，是未来数字图像领域的主要接口标准，必将被越来越多的商家多采用。
GigE Vision标准委员会的主要成员都是国际知名的图像系统软硬件提供商。
GigE Vision与标准千兆以太网相机，在硬件架构上基本完全一样（对网卡的要求有微小区别），只是在底层的驱动软件上有所区别。他主要解决标准千兆网的两个问题：
1. 数据包小而导致的传输效率低。标准千兆网的数据包为1440字节，而GigE Vision 采用所谓的“Jumbo packet”,其最大数据包可达16224字节。
2. CPU占用率过高。标准千兆网采用TCP/IP协议，在部分使用DMA控制以提高传输效率的情况下，可做到82MB/s时CPU占用率15%。GigE Vision 驱动采用UDP/IP协议，采用完全的DMA控制，大大降低了CPU的占用率，在同等配置情况下可做到108MB/s时CPU占用率为2%。 [1] 2、相机帧率和曝光时间的关系 工业相机参数之帧率相关知识详解：
工业相机是机器视觉系统的重要组成部分之一，在机器视觉系统中有着非常重要的作用。工业相机已经被广泛应用于工业生产线在线检测、智能交通，机器视觉，科研，军事科学，航天航空等众多领域。
工业相机的主要参数包括：分辨率、帧率、像素、像元尺寸、光谱响应特性等。下面我们来对工业相机帧率的相关知识进行讲解：
帧率（Frame rate）是用于测量显示帧数的量度。所谓的测量单位为每秒显示帧数(Frames per Second)，简称：FPS或“赫兹”（Hz）。　由于人类眼睛的特殊生理结构，如果所看画面之帧率高于16fps的时候，就会认为是连贯的，此现象称之为视觉暂留。这也就是为什么电影胶片是一格一格拍摄出来，然后快速播放的。
每秒的帧数(fps)或者说帧率表示图形处理器处理场时每秒钟能够更新的次数。高的帧率可以得到更流畅、更逼真的动画。一般来说30fps就是可以接受的，但是将性能提升至60fps则可以明显提升交互感和逼真感，但是一般来说超过75fps一般就不容易察觉到有明显的流畅度提升了。如果帧率超过屏幕刷新率只会浪费图形处理的能力，因为监视器不能以这么快的速度更新，这样超过刷新率的帧率就浪费掉了。
最大帧率(Frame Rate)/行频(Line Rate)：即相机采集传输图像的速率，对于面阵相机一般为每秒采集的帧数(Frames/Sec.)，对于线阵相机为每秒采集的行数(Hz)。
相机帧率和曝光时间的关系： 有人问，为什么我们在使用工业相机的时候，将相机的曝光时间增加以后，相机的帧率就下降，而且下降得很厉害，相机的帧率和曝光的关系是怎样，如果想要获得固定的帧率，相机的曝光时间应该怎么设置？因此写下本文，解答了朋友的问题，也使用Sentech相机来做过相关的测试，帧率和曝光时间跟本文中所述一致。详细原理见下文所示：
Exposure and Sensor Readout
相机上的图像采集过程包括两个截然不同的部分。第一部分是曝光。曝光完成后，进行第二部分Readout过程即从传感器的寄存器中读出数据并传送出去（Readout过程）。
关于图像采集过程中，相机操作有两种常见的方法：“non-overlapped”的曝光和“overlapped”的曝光。在非重叠(“non-overlapped”)模式中，每个图像采集的周期中，相机在下一个图像采集开始前，均要完成曝光/读出整个过程。如图1所示。
Fig.1 Non-overlapped Exposure
虽然非重叠(“non-overlapped”)的模式，可适合于许多情况下，但它并不是最有效的方式。为了提高相机的帧率，允许在下一帧图像开始曝光时候，将前一帧获得的图像数据读出并传送出去。相机“重叠”(“overlapped”)曝光的方式见图2所示。
从图2中我们可以看到，相机读出数据和下一帧曝光开始出现重叠的情况，在同一个时刻内，相机执行两个操作，导致在同样的单位时间内，在“overlapped”曝光模式下，可以采集到更多的图片，即相机的帧率更高。
Fig.2 overlapped Exposure
从上边两个图中，我们可以知道在“non-overlapped”的曝光和“overlapped”的曝光模式底下，一帧图像的周期存在着这样的关系: &#34;overlapped”的曝光模式下: FramePeriod ≤Exposure Time &#43; ReadoutTime
“non-overlapped”的曝光模式下:FramePeriod &gt; Exposure Time &#43; Readout Time
以STC-A202A为例：
图1 Spec
从Spec中可知，其Pixel Frequency为：36.8181MHz,所以1Clock的时间为1/36.8181Mhz =27." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1b5ccf3e64196202f9a6066e3714939f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-07-25T21:47:07+08:00" />
<meta property="article:modified_time" content="2018-07-25T21:47:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">线阵相机学习笔记（一）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4><strong>1、GigE Vision</strong></h4> 
<p>GigE Vision是由自动化影像协会AIA(Automated Imaging Association)发起指定的一种基于千兆以太网的图像传输的标准。</p> 
<p>具有传输距离长（无中继时100米）、传输效率高并可向上升级到万兆网、通信控制方便、软硬件互换性强、可靠性高等优点，是未来数字图像领域的主要接口标准，必将被越来越多的商家多采用。</p> 
<p>GigE Vision标准委员会的主要成员都是国际知名的图像系统软硬件提供商。</p> 
<p>GigE Vision与标准千兆以太网相机，在硬件架构上基本完全一样（对网卡的要求有微小区别），只是在底层的驱动软件上有所区别。他主要解决标准千兆网的两个问题：</p> 
<p>1. 数据包小而导致的传输效率低。标准千兆网的数据包为1440字节，而GigE Vision 采用所谓的“Jumbo packet”,其最大数据包可达16224字节。</p> 
<p>2. CPU占用率过高。标准千兆网采用TCP/IP协议，在部分使用DMA控制以提高传输效率的情况下，可做到82MB/s时CPU占用率15%。GigE Vision 驱动采用UDP/IP协议，采用完全的DMA控制，大大降低了CPU的占用率，在同等配置情况下可做到108MB/s时CPU占用率为2%。 [1]<a name="ref_%5B1%5D_9983931"> </a></p> 
<p> </p> 
<h2>2、相机帧率和曝光时间的关系</h2> 
<p>工业相机参数之帧率相关知识详解：</p> 
<p>    工业相机是机器视觉系统的重要组成部分之一，在机器视觉系统中有着非常重要的作用。工业相机已经被广泛应用于工业生产线在线检测、智能交通，机器视觉，科研，军事科学，航天航空等众多领域。</p> 
<p>    工业相机的主要参数包括：分辨率、帧率、像素、像元尺寸、光谱响应特性等。下面我们来对工业相机帧率的相关知识进行讲解：<br>     帧率（Frame rate）是用于测量显示帧数的量度。所谓的测量单位为每秒显示帧数(Frames per Second)，简称：FPS或“赫兹”（Hz）。　　       <br>     由于人类眼睛的特殊生理结构，如果所看画面之帧率高于16fps的时候，就会认为是连贯的，此现象称之为视觉暂留。这也就是为什么电影胶片是一格一格拍摄出来，然后快速播放的。<br>     每秒的帧数(fps)或者说帧率表示图形处理器处理场时每秒钟能够更新的次数。高的帧率可以得到更流畅、更逼真的动画。一般来说30fps就是可以接受的，但是将性能提升至60fps则可以明显提升交互感和逼真感，但是一般来说超过75fps一般就不容易察觉到有明显的流畅度提升了。如果帧率超过屏幕刷新率只会浪费图形处理的能力，因为监视器不能以这么快的速度更新，这样超过刷新率的帧率就浪费掉了。<br>     最大帧率(Frame Rate)/行频(Line Rate)：即相机采集传输图像的速率，对于面阵相机一般为每秒采集的帧数(Frames/Sec.)，对于线阵相机为每秒采集的行数(Hz)。</p> 
<p> </p> 
<h3>相机帧率和曝光时间的关系：</h3> 
<p>      有人问，为什么我们在使用工业相机的时候，将相机的曝光时间增加以后，相机的帧率就下降，而且下降得很厉害，相机的帧率和曝光的关系是怎样，如果想要获得固定的帧率，相机的曝光时间应该怎么设置？因此写下本文，解答了朋友的问题，也使用Sentech相机来做过相关的测试，帧率和曝光时间跟本文中所述一致。详细原理见下文所示：</p> 
<p>Exposure and Sensor Readout</p> 
<p>相机上的图像采集过程包括两个截然不同的部分。第一部分是曝光。曝光完成后，进行第二部分Readout过程即从传感器的寄存器中读出数据并传送出去（Readout过程）。</p> 
<p>关于图像采集过程中，相机操作有两种常见的方法：<strong>“non-overlapped”</strong>的曝光和<strong>“overlapped”</strong>的曝光。在非重叠(<strong>“non-overlapped”</strong>)模式中，每个图像采集的周期中，相机在下一个图像采集开始前，均要完成曝光/读出整个过程。如图1所示。</p> 
<p> <img alt="" class="has" src="https://images2.imgbox.com/2d/1c/21gV3t26_o.jpg"></p> 
<p> </p> 
<p>Fig.1 Non-overlapped Exposure</p> 
<p>虽然非重叠(<strong>“non-overlapped”</strong>)的模式，可适合于许多情况下，但它并不是最有效的方式。为了提高相机的帧率，允许在下一帧图像开始曝光时候，将前一帧获得的图像数据读出并传送出去。相机“重叠”(<strong>“overlapped”</strong>)曝光的方式见图2所示。</p> 
<p>从图2中我们可以看到，相机读出数据和下一帧曝光开始出现重叠的情况，在同一个时刻内，相机执行两个操作，导致在同样的单位时间内，在<strong>“overlapped”曝光模式下，</strong>可以采集到更多的图片，即相机的帧率更高。<br><img alt="" class="has" src="https://images2.imgbox.com/55/3f/LZp5aVf5_o.jpg"><br> Fig.2 overlapped Exposure</p> 
<p>      从上边两个图中，我们可以知道在<strong>“non-overlapped”</strong>的曝光和<strong>“overlapped”</strong>的曝光模式底下，一帧图像的周期存在着这样的关系: "overlapped”的曝光模式下: FramePeriod ≤Exposure Time + ReadoutTime</p> 
<p><strong>“non-overlapped”</strong>的曝光模式下<strong>:FramePeriod &gt; Exposure Time + Readout Time</strong></p> 
<p>以STC-A202A为例：<br><img alt="" class="has" src="https://images2.imgbox.com/6a/2b/CmjhMjBn_o.jpg"><br>                                                     图1 Spec</p> 
<p> </p> 
<p>从Spec中可知，其Pixel Frequency为：36.8181MHz,所以1Clock的时间为1/36.8181Mhz =27.3836ns,接下来我们看相机的Timing chart，首先先看HorizontalTiming，见图2所示：<br><img alt="" class="has" src="https://images2.imgbox.com/1d/b4/4RSmZrcW_o.jpg">图2 Horizontal Timing<br>  </p> 
<p>从图2中，我们从中可读到的信息为，1 CLK=27.1605 nseconds，和我们从spec上得到的Pixel Frequency算出来的时间差不多。扫描1Horizontal需要1920CLK，即1H =27.1605*1920 =52148.16ns=52.14816us</p> 
<p>接下来看相机Vertical Timing 见图3所示：<br><img alt="" class="has" src="https://images2.imgbox.com/a1/06/9y5Gtbuw_o.jpg"><br> 图3 Vertical Timing</p> 
<p>从图3中，我们可读出的信息为，1H=52.1482useconds，和我们通过图2计算出来horizontal Scanning的时间一致，而在一帧图像中，需要扫描1252H，其中Effective Pixels为1220H，即1帧图像中，Effective Pixels Read out的时间为1220*52.1482 =63620.804us =63.620804ms，一个VD信号，所用的时间为：1252*52.1482=67793.5464us =67.7935464ms。按照我们前边的理论，一个cycletime内，一帧图像的时间为：<strong>Frame Period = Exposure Time +Readout Time</strong></p> 
<p>而我们知道STC-A202A的帧率为：15fps，即1 Frame Period =1/15 =66.7ms。</p> 
<p>所以在<strong>“non-overlapped”</strong>exposure 模式下，ExposureTime = Frame Period – Readout Time =66.7ms -63.6ms =3.1ms，在此模式下，若是超过3.1ms的曝光时间，其帧率就会比标准帧率15fps低。</p> 
<p>         假如1颗相机Readout Time为：66.7ms，即数据传输时间为A，A=66.7ms，曝光时间为B，B=5ms，则一帧图像的时间为C，则C=A+B=66.7ms + 5ms =71.7ms，则这颗相机的帧率为：1000/71.7 =13.94FPS，则这颗相机的帧率为13.94.</p> 
<p><strong>注意：一般情况下，若我们的相机的帧率为15fps，则表示相机ReadOut数据的时间为1000ms/15 =66.7ms</strong></p> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b59426796391206e7ba1edb584a7dcd5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">android.view.InflateException: Binary XML file line #0: Error inflating class &lt;unknown&gt; 解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/248fd1af71ced63a97cfb1c3c8b7d306/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python3 requests详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>