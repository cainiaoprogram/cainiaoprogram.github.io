<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>零基础入门金融风控-贷款违约预测-机器学习-数据分析 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="零基础入门金融风控-贷款违约预测-机器学习-数据分析" />
<meta property="og:description" content="零基础入门金融风控-贷款违约预测 一、赛题数据 赛题以预测用户贷款是否违约为任务，数据集报名后可见并可下载，该数据来自某信贷平台的贷款记录，总数据量超过120w，包含47列变量信息，其中15列为匿名变量。为了保证比赛的公平性，将会从中抽取80万条作为训练集，20万条作为测试集A，20万条作为测试集B，同时会对employmentTitle、purpose、postCode和title等信息进行脱敏。
数据可在阿里云学习赛中获得。
字段表 idFieldDescription1id为贷款清单分配的唯一信用证标识2loanAmnt贷款金额3term贷款期限（year）4interestRate贷款利率5installment分期付款金额6grade贷款等级7subGrade贷款等级之子级8employmentTitle就业职称9employmentLength就业年限（年）10homeOwnership借款人在登记时提供的房屋所有权状况11annualIncome年收入12verificationStatus验证状态13issueDate贷款发放的月份14purpose借款人在贷款申请时的贷款用途类别15postCode借款人在贷款申请中提供的邮政编码的前3位数字16regionCode地区编码17dti债务收入比18delinquency_2years借款人过去2年信用档案中逾期30天以上的违约事件数19ficoRangeLow借款人在贷款发放时的fico所属的下限范围20ficoRangeHigh借款人在贷款发放时的fico所属的上限范围21openAcc借款人信用档案中未结信用额度的数量22pubRec贬损公共记录的数量23pubRecBankruptcies公开记录清除的数量24revolBal信贷周转余额合计25revolUtil循环额度利用率，或借款人使用的相对于所有可用循环信贷的信贷金额26totalAcc借款人信用档案中当前的信用额度总数27initialListStatus贷款的初始列表状态28applicationType表明贷款是个人申请还是与两个共同借款人的联合申请29earliesCreditLine借款人最早报告的信用额度开立的月份30title借款人提供的贷款名称31policyCode公开可用的策略_代码=1新产品不公开可用的策略_代码=232n系列匿名特征匿名特征n0-n14，为一些贷款人行为计数特征的处理 二、评测标准 提交结果为每个测试样本是1的概率，也就是y为1的概率。评价方法为AUC评估模型效果（越大越好）。
三、代码演示 说明：下面运行结果贴出的是部分图。环境：本案例使用的库 pandas 1.3.2matplotlib 3.4.3seaborn 0.11.2numpy 1.21.2scipy 1.4.1scikit-learn 0.24.2 使用的是jupyter notebook 1. 数据分析及处理 1.1.0导入相关库 import pandas as pd import matplotlib.pyplot as plt import seaborn as sns import numpy as np from scipy import stats import matplotlib as mpl #显示所有列 pd.set_option(&#39;display.max_columns&#39;,None) # 警告处理 import warnings warnings.filterwarnings(&#39;ignore&#39;) %matplotlib inline 1.1.1数据预处理 df_train = pd.read_csv(&#39;train.csv&#39;) df_test = pd.read_csv(&#39;testA.csv&#39;) df_train.shape, df_test.shape df_train[&#39;train_test&#39;] = &#39;train&#39; df_test[&#39;train_test&#39;] = &#39;test&#39; 合并训练集和测试集" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1c84d7a9a3ea89b9a6087889c7a37afe/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-15T19:17:30+08:00" />
<meta property="article:modified_time" content="2021-09-15T19:17:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">零基础入门金融风控-贷款违约预测-机器学习-数据分析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>零基础入门金融风控-贷款违约预测</h2> 
<h3><a id="_1"></a>一、赛题数据</h3> 
<p>赛题以预测用户贷款是否违约为任务，数据集报名后可见并可下载，该数据来自某信贷平台的贷款记录，总数据量超过120w，包含47列变量信息，其中15列为匿名变量。为了保证比赛的公平性，将会从中抽取80万条作为训练集，20万条作为测试集A，20万条作为测试集B，同时会对employmentTitle、purpose、postCode和title等信息进行脱敏。</p> 
<p>数据可在阿里云学习赛中获得。</p> 
<ul><li>字段表</li></ul> 
<table><thead><tr><th>id</th><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>1</td><td>id</td><td>为贷款清单分配的唯一信用证标识</td></tr><tr><td>2</td><td>loanAmnt</td><td>贷款金额</td></tr><tr><td>3</td><td>term</td><td>贷款期限（year）</td></tr><tr><td>4</td><td>interestRate</td><td>贷款利率</td></tr><tr><td>5</td><td>installment</td><td>分期付款金额</td></tr><tr><td>6</td><td>grade</td><td>贷款等级</td></tr><tr><td>7</td><td>subGrade</td><td>贷款等级之子级</td></tr><tr><td>8</td><td>employmentTitle</td><td>就业职称</td></tr><tr><td>9</td><td>employmentLength</td><td>就业年限（年）</td></tr><tr><td>10</td><td>homeOwnership</td><td>借款人在登记时提供的房屋所有权状况</td></tr><tr><td>11</td><td>annualIncome</td><td>年收入</td></tr><tr><td>12</td><td>verificationStatus</td><td>验证状态</td></tr><tr><td>13</td><td>issueDate</td><td>贷款发放的月份</td></tr><tr><td>14</td><td>purpose</td><td>借款人在贷款申请时的贷款用途类别</td></tr><tr><td>15</td><td>postCode</td><td>借款人在贷款申请中提供的邮政编码的前3位数字</td></tr><tr><td>16</td><td>regionCode</td><td>地区编码</td></tr><tr><td>17</td><td>dti</td><td>债务收入比</td></tr><tr><td>18</td><td>delinquency_2years</td><td>借款人过去2年信用档案中逾期30天以上的违约事件数</td></tr><tr><td>19</td><td>ficoRangeLow</td><td>借款人在贷款发放时的fico所属的下限范围</td></tr><tr><td>20</td><td>ficoRangeHigh</td><td>借款人在贷款发放时的fico所属的上限范围</td></tr><tr><td>21</td><td>openAcc</td><td>借款人信用档案中未结信用额度的数量</td></tr><tr><td>22</td><td>pubRec</td><td>贬损公共记录的数量</td></tr><tr><td>23</td><td>pubRecBankruptcies</td><td>公开记录清除的数量</td></tr><tr><td>24</td><td>revolBal</td><td>信贷周转余额合计</td></tr><tr><td>25</td><td>revolUtil</td><td>循环额度利用率，或借款人使用的相对于所有可用循环信贷的信贷金额</td></tr><tr><td>26</td><td>totalAcc</td><td>借款人信用档案中当前的信用额度总数</td></tr><tr><td>27</td><td>initialListStatus</td><td>贷款的初始列表状态</td></tr><tr><td>28</td><td>applicationType</td><td>表明贷款是个人申请还是与两个共同借款人的联合申请</td></tr><tr><td>29</td><td>earliesCreditLine</td><td>借款人最早报告的信用额度开立的月份</td></tr><tr><td>30</td><td>title</td><td>借款人提供的贷款名称</td></tr><tr><td>31</td><td>policyCode</td><td>公开可用的策略_代码=1新产品不公开可用的策略_代码=2</td></tr><tr><td>32</td><td>n系列匿名特征</td><td>匿名特征n0-n14，为一些贷款人行为计数特征的处理</td></tr></tbody></table> 
<h3><a id="_42"></a>二、评测标准</h3> 
<p>提交结果为每个测试样本是1的概率，也就是y为1的概率。评价方法为AUC评估模型效果（越大越好）。</p> 
<h3><a id="_44"></a>三、代码演示</h3> 
<ul><li>说明：下面运行结果贴出的是部分图。</li><li>环境：本案例使用的库 
  <ul><li>pandas 1.3.2</li><li>matplotlib 3.4.3</li><li>seaborn 0.11.2</li><li>numpy 1.21.2</li><li>scipy 1.4.1</li><li>scikit-learn 0.24.2</li></ul> </li><li>使用的是jupyter notebook</li></ul> 
<h4><a id="1__54"></a>1. 数据分析及处理</h4> 
<h5><a id="110_55"></a>1.1.0导入相关库</h5> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> scipy <span class="token keyword">import</span> stats
<span class="token keyword">import</span> matplotlib <span class="token keyword">as</span> mpl
<span class="token comment">#显示所有列</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token comment"># 警告处理 </span>
<span class="token keyword">import</span> warnings
warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>
<span class="token operator">%</span>matplotlib inline
</code></pre> 
<h5><a id="111_71"></a>1.1.1数据预处理</h5> 
<pre><code class="prism language-python">df_train <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'train.csv'</span><span class="token punctuation">)</span>
df_test <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'testA.csv'</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">df_train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> df_test<span class="token punctuation">.</span>shape
</code></pre> 
<p><img src="https://images2.imgbox.com/6f/0f/qbGcaHFW_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">df_train<span class="token punctuation">[</span><span class="token string">'train_test'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'train'</span>
df_test<span class="token punctuation">[</span><span class="token string">'train_test'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'test'</span>
</code></pre> 
<p>合并训练集和测试集</p> 
<pre><code class="prism language-python">df <span class="token operator">=</span> df_train<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df_test<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
display<span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/69/bc/mukAbMaR_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/34/52/EScUcV7U_o.png" alt="在这里插入图片描述"><br> 缺失值处理</p> 
<pre><code class="prism language-python"><span class="token comment"># 需要处理的列名</span>
is_na_cols <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'employmentTitle'</span><span class="token punctuation">,</span> <span class="token string">'employmentLength'</span><span class="token punctuation">,</span> <span class="token string">'postCode'</span><span class="token punctuation">,</span> <span class="token string">'dti'</span><span class="token punctuation">,</span> <span class="token string">'pubRecBankruptcies'</span><span class="token punctuation">,</span>
    <span class="token string">'revolUtil'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">,</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">'</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre> 
<p>对缺失值 用众数填充</p> 
<pre><code class="prism language-python"><span class="token comment"># 对缺失值 用众数填充</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>is_na_cols<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    most_num <span class="token operator">=</span> df<span class="token punctuation">[</span>is_na_cols<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    df<span class="token punctuation">[</span>is_na_cols<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span>is_na_cols<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>most_num<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/32/a0/1T49yFns_o.png" alt="在这里插入图片描述"><br> 分开训练集和测试集</p> 
<pre><code class="prism language-python">df_train <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'train_test'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'train'</span><span class="token punctuation">]</span>
df_test <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'train_test'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'test'</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python">
<span class="token keyword">del</span> df_train<span class="token punctuation">[</span><span class="token string">'train_test'</span><span class="token punctuation">]</span>
<span class="token keyword">del</span> df_test<span class="token punctuation">[</span><span class="token string">'train_test'</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python">df_train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> df_test<span class="token punctuation">.</span>shape
</code></pre> 
<p><img src="https://images2.imgbox.com/80/f7/GM2WXCa5_o.png" alt="在这里插入图片描述"><br> 删除测试集的预测目标</p> 
<pre><code class="prism language-python"><span class="token keyword">del</span> df_test<span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span>
</code></pre> 
<h5><a id="112_140"></a>1.1.2数值型变量和非数值型变量的处理与分析</h5> 
<pre><code class="prism language-python"><span class="token comment"># 非数值型</span>
non_numeric_cols <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'grade'</span><span class="token punctuation">,</span> <span class="token string">'subGrade'</span><span class="token punctuation">,</span> <span class="token string">'employmentLength'</span><span class="token punctuation">,</span> <span class="token string">'issueDate'</span><span class="token punctuation">,</span> <span class="token string">'earliesCreditLine'</span>
<span class="token punctuation">]</span>
<span class="token comment"># 数值型</span>
numeric_cols <span class="token operator">=</span> <span class="token punctuation">[</span>
    x <span class="token keyword">for</span> x <span class="token keyword">in</span> df_test<span class="token punctuation">.</span>columns <span class="token keyword">if</span> x <span class="token keyword">not</span> <span class="token keyword">in</span> non_numeric_cols <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
non_numeric_cols<span class="token punctuation">,</span> numeric_cols
</code></pre> 
<p><img src="https://images2.imgbox.com/44/dc/WlqYufwE_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="113numeric_cols_154"></a>1.1.3数值型(numeric_cols)测试集与训练集分布</h5> 
<p>画箱式图可查看哪些列名是连续型和非连续型变量</p> 
<pre><code class="prism language-python"><span class="token comment"># 画箱式图</span>
column <span class="token operator">=</span> numeric_cols <span class="token comment"># 列表头</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 指定绘图对象宽度和高度</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 13行3列子图</span>
    sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>df<span class="token punctuation">[</span>column<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> orient<span class="token operator">=</span><span class="token string">"v"</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>  <span class="token comment"># 箱式图</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span>column<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2e/2c/aMGWntN7_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="114_167"></a>1.1.4取出数值连续性变量，查看数据分布</h5> 
<pre><code class="prism language-python">continuous_cols <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'loanAmnt'</span><span class="token punctuation">,</span> <span class="token string">'interestRate'</span><span class="token punctuation">,</span> <span class="token string">'installment'</span><span class="token punctuation">,</span> <span class="token string">'employmentTitle'</span><span class="token punctuation">,</span> <span class="token string">'homeOwnership'</span><span class="token punctuation">,</span>
    <span class="token string">'annualIncome'</span><span class="token punctuation">,</span> <span class="token string">'purpose'</span><span class="token punctuation">,</span> <span class="token string">'postCode'</span><span class="token punctuation">,</span> <span class="token string">'regionCode'</span><span class="token punctuation">,</span> <span class="token string">'dti'</span><span class="token punctuation">,</span> <span class="token string">'delinquency_2years'</span><span class="token punctuation">,</span>
    <span class="token string">'ficoRangeLow'</span><span class="token punctuation">,</span> <span class="token string">'ficoRangeHigh'</span><span class="token punctuation">,</span> <span class="token string">'openAcc'</span><span class="token punctuation">,</span> <span class="token string">'pubRec'</span><span class="token punctuation">,</span> <span class="token string">'revolBal'</span><span class="token punctuation">,</span> <span class="token string">'revolUtil'</span><span class="token punctuation">,</span><span class="token string">'totalAcc'</span><span class="token punctuation">,</span>
    <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'n14'</span>
<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">'</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span> 
non_continuous_cols <span class="token operator">=</span> <span class="token punctuation">[</span>
    x <span class="token keyword">for</span> x <span class="token keyword">in</span> numeric_cols <span class="token keyword">if</span> x <span class="token keyword">not</span> <span class="token keyword">in</span> continuous_cols
<span class="token punctuation">]</span>
</code></pre> 
<p>可视化正太分布，查看测试集与训练集的数据是否相同，相同可保留，差距会影响预测结果，就去除。</p> 
<pre><code class="prism language-python">dist_cols <span class="token operator">=</span> <span class="token number">6</span>
dist_rows <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>df_test<span class="token punctuation">[</span>continuous_cols<span class="token punctuation">]</span><span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span>dist_cols<span class="token punctuation">,</span><span class="token number">4</span><span class="token operator">*</span>dist_rows<span class="token punctuation">)</span><span class="token punctuation">)</span>

i<span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">for</span> col <span class="token keyword">in</span> df_test<span class="token punctuation">[</span>continuous_cols<span class="token punctuation">]</span><span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
    ax<span class="token operator">=</span>plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span>dist_rows<span class="token punctuation">,</span>dist_cols<span class="token punctuation">,</span>i<span class="token punctuation">)</span>
    ax <span class="token operator">=</span> sns<span class="token punctuation">.</span>kdeplot<span class="token punctuation">(</span>df_train<span class="token punctuation">[</span>continuous_cols<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"Red"</span><span class="token punctuation">,</span> shade<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    ax <span class="token operator">=</span> sns<span class="token punctuation">.</span>kdeplot<span class="token punctuation">(</span>df_test<span class="token punctuation">[</span>continuous_cols<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"Blue"</span><span class="token punctuation">,</span> shade<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span>col<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Frequency"</span><span class="token punctuation">)</span>
    ax <span class="token operator">=</span> ax<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"train"</span><span class="token punctuation">,</span><span class="token string">"test"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    i<span class="token operator">+=</span><span class="token number">1</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5f/99/zTDENsjT_o.png" alt="在这里插入图片描述"></p> 
<p>画QQ图及正态分布图</p> 
<ul><li>QQ图：曲线越接近直线，越接近正态分布，预测效果更好。</li></ul> 
<pre><code class="prism language-python">train_cols <span class="token operator">=</span> <span class="token number">6</span>
train_rows <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>continuous_cols<span class="token punctuation">]</span><span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span>train_cols<span class="token punctuation">,</span><span class="token number">4</span><span class="token operator">*</span>train_rows<span class="token punctuation">)</span><span class="token punctuation">)</span>

i<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">for</span> col <span class="token keyword">in</span> df<span class="token punctuation">[</span>continuous_cols<span class="token punctuation">]</span><span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
    i<span class="token operator">+=</span><span class="token number">1</span>
    ax<span class="token operator">=</span>plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span>train_rows<span class="token punctuation">,</span>train_cols<span class="token punctuation">,</span>i<span class="token punctuation">)</span>
    sns<span class="token punctuation">.</span>distplot<span class="token punctuation">(</span>df<span class="token punctuation">[</span>continuous_cols<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">,</span>fit<span class="token operator">=</span>stats<span class="token punctuation">.</span>norm<span class="token punctuation">)</span>
    i<span class="token operator">+=</span><span class="token number">1</span>
    ax<span class="token operator">=</span>plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span>train_rows<span class="token punctuation">,</span>train_cols<span class="token punctuation">,</span>i<span class="token punctuation">)</span>
    res <span class="token operator">=</span> stats<span class="token punctuation">.</span>probplot<span class="token punctuation">(</span>df<span class="token punctuation">[</span>continuous_cols<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">,</span> plot<span class="token operator">=</span>plt<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4f/3b/rslr4tNJ_o.png" alt="在这里插入图片描述"><br> 训练集的数据和测试集的数据分布差不多可以将他们整合到一起进行处理</p> 
<h5><a id="115_220"></a>1.1.5查看数值非连续性型数据分布</h5> 
<pre><code class="prism language-python"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>non_continuous_cols<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%s这列的非连续性数据的分布："</span><span class="token operator">%</span>non_continuous_cols<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>non_continuous_cols<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/20/05/irmYTmME_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="116_228"></a>1.1.6查看非数值型数据分布</h5> 
<pre><code class="prism language-python"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>non_numeric_cols<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%s这列非数值型数据的分布：\n"</span><span class="token operator">%</span>non_numeric_cols<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>non_numeric_cols<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8b/a3/Ew9xHBZ5_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2__236"></a>2. 特征工程</h4> 
<h5><a id="211__237"></a>2.1.1 数值非连续性型数据处理</h5> 
<ol><li>policyCode字段</li></ol> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token string">'policyCode'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6e/bc/f8jmL5e0_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 字段只有一个值，不用了</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'policyCode'</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="2"><li>n13字段</li></ol> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token string">'n13'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'n13'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token keyword">if</span> x <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">else</span> x<span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'n13'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/01/87/zRKj9lOW_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="212__256"></a>2.1.2 非数值型数据</h5> 
<ol><li>grade字段</li></ol> 
<pre><code class="prism language-python"><span class="token comment"># 非数值型编码</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> LabelEncoder
le <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span> <span class="token operator">=</span> le<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/06/ce/i5PAPp0M_o.png" alt="在这里插入图片描述"><br> 2. subGrade字段</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> LabelEncoder
le <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'subGrade'</span><span class="token punctuation">]</span> <span class="token operator">=</span> le<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'subGrade'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'subGrade'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/00/15/SnCgijn7_o.png" alt="在这里插入图片描述"><br> 3. employmentLength字段</p> 
<pre><code class="prism language-python"><span class="token comment"># 构造编码函数</span>
<span class="token keyword">def</span> <span class="token function">encoder</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'10+ '</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">10</span>
    <span class="token keyword">elif</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'&lt; 1'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'employmentLength'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'employmentLength'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>encoder<span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'employmentLength'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3f/ba/mHJ7ShlM_o.png" alt="在这里插入图片描述"><br> 4. issueDate字段</p> 
<ul><li>计算离现在多少月就ok了</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">def</span> <span class="token function">encoder1</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    now <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token string">'2020-07-01'</span><span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>
    past <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>
    period <span class="token operator">=</span> now <span class="token operator">-</span> past
    period <span class="token operator">=</span> period<span class="token punctuation">.</span>days
    <span class="token keyword">return</span> <span class="token builtin">round</span><span class="token punctuation">(</span>period <span class="token operator">/</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'issueDate'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'issueDate'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>encoder1<span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'issueDate'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fa/57/AONycp2l_o.png" alt="在这里插入图片描述"><br> 5. earliesCreditLine字段</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">encoder2</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Jan'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">'01-01'</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Feb'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">'02-01'</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Mar'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">'03-01'</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Apr'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">'04-01'</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'May'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">'05-01'</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Jun'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">'06-01'</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Jul'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">'07-01'</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Aug'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">'08-01'</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Sep'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">'09-01'</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Oct'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">'10-01'</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Nov'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">'11-01'</span>
    <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Dec'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">'12-01'</span>
df<span class="token punctuation">[</span><span class="token string">'earliesCreditLine'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'earliesCreditLine'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>encoder2<span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'earliesCreditLine'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e9/83/17y3lQmK_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token string">'earliesCreditLine'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'earliesCreditLine'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>encoder1<span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'earliesCreditLine'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8b/c2/gzW2ro40_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3__345"></a>3. 保存文件</h4> 
<pre><code class="prism language-python">train <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'train_test'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'train'</span><span class="token punctuation">]</span>
test <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'train_test'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'test'</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">del</span> test<span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">del</span> train<span class="token punctuation">[</span><span class="token string">'train_test'</span><span class="token punctuation">]</span>
<span class="token keyword">del</span> test<span class="token punctuation">[</span><span class="token string">'train_test'</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python">train<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'train_process.csv'</span><span class="token punctuation">)</span>
test<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'test_process.csv'</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="4__365"></a>4. 数据建模</h4> 
<h5><a id="411_366"></a>4.1.1数据查看</h5> 
<pre><code class="prism language-python"><span class="token comment"># 数据处理</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 数据可视化</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 特征选择和编码</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> LabelEncoder

<span class="token comment"># 机器学习</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> model_selection<span class="token punctuation">,</span> tree<span class="token punctuation">,</span> preprocessing<span class="token punctuation">,</span> metrics
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier<span class="token punctuation">,</span> GradientBoostingClassifier
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression<span class="token punctuation">,</span> LogisticRegression<span class="token punctuation">,</span> Ridge<span class="token punctuation">,</span> Lasso<span class="token punctuation">,</span> SGDClassifier
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier

<span class="token comment"># 网格搜索、随机搜索</span>
<span class="token keyword">import</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">as</span> st
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> GridSearchCV
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> RandomizedSearchCV

<span class="token comment"># 模型度量（分类）</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> precision_recall_fscore_support<span class="token punctuation">,</span> roc_curve<span class="token punctuation">,</span> auc

<span class="token comment"># 警告处理 </span>
<span class="token keyword">import</span> warnings
warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>

<span class="token comment"># 在Jupyter上画图</span>
<span class="token operator">%</span>matplotlib inline
</code></pre> 
<pre><code class="prism language-python">train <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'train_process.csv'</span><span class="token punctuation">)</span>
test <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'test_process.csv'</span><span class="token punctuation">)</span>
train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> test<span class="token punctuation">.</span>shape
</code></pre> 
<p><img src="https://images2.imgbox.com/25/ec/zpv4D3oD_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">train<span class="token punctuation">.</span>columns<span class="token punctuation">,</span>test<span class="token punctuation">.</span>columns
</code></pre> 
<p><img src="https://images2.imgbox.com/f9/26/h63VDujL_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 删除Unnamed: 0</span>
<span class="token keyword">del</span> train<span class="token punctuation">[</span><span class="token string">'Unnamed: 0'</span><span class="token punctuation">]</span>
<span class="token keyword">del</span> test<span class="token punctuation">[</span><span class="token string">'Unnamed: 0'</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 为了正确评估模型性能，将数据划分为训练集和测试集，并在训练集上训练模型，在测试集上验证模型性能。</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

<span class="token comment">## 选择其类别为0和1的样本 （不包括类别为2的样本）</span>
data_target_part <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span>
data_features_part <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> train<span class="token punctuation">.</span>columns <span class="token keyword">if</span> x <span class="token operator">!=</span> <span class="token string">'isDefault'</span> <span class="token keyword">and</span> <span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token comment">## 测试集大小为20%， 80%/20%分</span>
x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>data_features_part<span class="token punctuation">,</span> data_target_part<span class="token punctuation">,</span> test_size <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">2020</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">x_train<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fd/e9/ehXw4vtS_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">y_train<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/cd/3b/xcjVqfx7_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="411_440"></a>4.1.1选择算法</h5> 
<p>以下是用到的算法.</p> 
<ul><li>Logistic Regression</li><li>Random Forest</li><li>Decision Tree</li><li>Gradient Boosted Trees</li></ul> 
<pre><code class="prism language-python"><span class="token comment"># 绘制AUC曲线</span>
<span class="token keyword">import</span> time
<span class="token keyword">def</span> <span class="token function">plot_roc_curve</span><span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> preds<span class="token punctuation">)</span><span class="token punctuation">:</span>
    fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> threshold <span class="token operator">=</span> metrics<span class="token punctuation">.</span>roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> preds<span class="token punctuation">)</span>
    roc_auc <span class="token operator">=</span> metrics<span class="token punctuation">.</span>auc<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Receiver Operating Characteristic'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'AUC = %0.2f'</span> <span class="token operator">%</span> roc_auc<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc <span class="token operator">=</span> <span class="token string">'lower right'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'r--'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">1.01</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">1.01</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'True Positive Rate'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'False Positive Rate'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># Logistic Regression</span>
clf1 <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span>solver<span class="token operator">=</span><span class="token string">'sag'</span><span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> multi_class<span class="token operator">=</span><span class="token string">'multinomial'</span><span class="token punctuation">)</span>
clf1<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token comment">## 在训练集和测试集上分布利用训练好的模型进行预测</span>
train_predict <span class="token operator">=</span> clf1<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
test_predict <span class="token operator">=</span> clf1<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics

<span class="token comment">## 利用accuracy（准确度）【预测正确的样本数目占总预测样本数目的比例】评估模型效果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span>train_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>test_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2f/85/q0F4OjDy_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 网格搜索</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> GridSearchCV
param_grid <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
              <span class="token string">'penalty'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'l2'</span><span class="token punctuation">,</span> <span class="token string">'l1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token string">'class_weight'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'balanced'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">'intercept_scaling'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
             <span class="token punctuation">}</span>

clf2 <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span>solver<span class="token operator">=</span><span class="token string">'sag'</span><span class="token punctuation">)</span>
rfc <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span>clf2<span class="token punctuation">,</span> param_grid<span class="token punctuation">,</span> scoring <span class="token operator">=</span> <span class="token string">'neg_log_loss'</span><span class="token punctuation">,</span> cv<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> n_jobs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
rfc<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rfc<span class="token punctuation">.</span>best_score_<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rfc<span class="token punctuation">.</span>best_params_<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/be/ea/Bk9pzxsR_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># Logistic Regression</span>
clf1 <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span>solver<span class="token operator">=</span><span class="token string">'sag'</span><span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> penalty<span class="token operator">=</span><span class="token string">'l2'</span><span class="token punctuation">,</span> 
                          class_weight<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> intercept_scaling<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>
model <span class="token operator">=</span> clf1<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token comment">## 在训练集和测试集上分布利用训练好的模型进行预测</span>
train_predict <span class="token operator">=</span> clf1<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
test_predict <span class="token operator">=</span> clf1<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics

<span class="token comment">## 利用accuracy（准确度）【预测正确的样本数目占总预测样本数目的比例】评估模型效果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span>train_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>test_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/82/23/uWUJttXf_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 画图</span>
plot_roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> model<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4e/d0/0nuVZ2jY_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># Random Forest</span>

clf1 <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>
clf1<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token comment">## 在训练集和测试集上分布利用训练好的模型进行预测</span>
train_predict <span class="token operator">=</span> clf1<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
test_predict <span class="token operator">=</span> clf1<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics

<span class="token comment">## 利用accuracy（准确度）【预测正确的样本数目占总预测样本数目的比例】评估模型效果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span>train_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>test_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5b/81/eWnFBuLw_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 决策树</span>
clf1 <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>
model <span class="token operator">=</span> clf1<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token comment">## 在训练集和测试集上分布利用训练好的模型进行预测</span>
train_predict <span class="token operator">=</span> clf1<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
test_predict <span class="token operator">=</span> clf1<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics

<span class="token comment">## 利用accuracy（准确度）【预测正确的样本数目占总预测样本数目的比例】评估模型效果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span>train_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>test_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9b/1d/wrEzsm7v_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">plot_roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> model<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f4/55/8wxKfWBB_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># Gradient Boosting Trees</span>

clf1 <span class="token operator">=</span> GradientBoostingClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>
model <span class="token operator">=</span> clf1<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token comment">## 在训练集和测试集上分布利用训练好的模型进行预测</span>
train_predict <span class="token operator">=</span> clf1<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
test_predict <span class="token operator">=</span> clf1<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics

<span class="token comment">## 利用accuracy（准确度）【预测正确的样本数目占总预测样本数目的比例】评估模型效果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span>train_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>test_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7b/62/6hUXmkFx_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">plot_roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> model<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/64/6d/O0G8RoGX_o.png" alt="在这里插入图片描述"><br> 代码演示结束</p> 
<h3><a id="_577"></a>三、拓展</h3> 
<p>感兴趣的话还可以做一下特征融合、模型融合，做更好地特征工程使得模型AUC得分更高。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/513e1ffad1a57c89a283da636ea5f057/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">微软要给我30万美元的额外奖励，被我拒了！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9055f36f58cf52e96b79ab8182251bc8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">windows10下编译生成hadoop-eclipse-plugin-3.3.1插件（失败）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>