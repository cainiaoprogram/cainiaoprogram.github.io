<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【educoder 机器学习】线性回归 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【educoder 机器学习】线性回归" />
<meta property="og:description" content="线性回归是属于机器学习里面的监督学习，与分类问题不同的是，在回归问题中，其目标是通过对训练样本的学习，得到从样本特征到样本标签直接的映射，其中，在回归问题中，样本的标签是连续值。线性回归是一类重要的回归问题。在线性回归中，目标值与特征直接存在线性关系。
本实训项目的主要内容是基于Python语言搭建出一个线性回归模型，训练出一个能够对房价进行预测的模型。
第1关：简单线性回归与多元线性回归 1.B C 第2关：线性回归的正规方程解 任务描述 本关任务：构建线性回归算法，并利用波斯顿房价数据对模型进行训练，然后对未知的房价数据进行预测。
#encoding=utf8 import numpy as np def mse_score(y_predict,y_test): &#39;&#39;&#39; input:y_predict(ndarray):预测值 y_test(ndarray):真实值 ouput:mse(float):mse损失函数值 该方法计算损失 &#39;&#39;&#39; #********* Begin *********# s = np.square(y_test - y_predict).sum() m = len(y_test) mse = s/m #print(mse) #********* End *********# return mse class LinearRegression : def __init__(self): &#39;&#39;&#39;初始化线性回归模型&#39;&#39;&#39; self.w = None def fit_normal(self,train_data,train_label): &#39;&#39;&#39; input:train_data(ndarray):训练样本 train_label(ndarray):训练标签 该方法求解计算self.w的值 &#39;&#39;&#39; #********* Begin *********# &#39;&#39;&#39;将偏置与train_data拼接到一起 (我们输入特征中并没有那个1，所以我们需要人为的加上去) &lt;np.ones()表示生成一个行数与train_data一致，列数等于1且所有元素都是1的矩阵&gt;&#39;&#39;&#39; x = np.hstack([np.ones((len(train_data),1)), train_data]) #print(train_data) y = train_label #print(train_label) #用正规方程求解参数 self." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/cf1c9f70f5d35804005b401c1560c13e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-28T22:41:03+08:00" />
<meta property="article:modified_time" content="2022-10-28T22:41:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【educoder 机器学习】线性回归</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>线性回归是属于机器学习里面的<strong>监督学习</strong>，与分类问题不同的是，在回归问题中，其目标是通过对训练样本的学习，得到<strong>从样本特征到样本标签直接的映射</strong>，其中，在回归问题中，样本的标签是<strong>连续值</strong>。线性回归是一类重要的回归问题。在线性回归中，目标值与特征直接存在线性关系。</p> 
 <p>本实训项目的主要内容是基于Python语言搭建出一个线性回归模型，训练出一个能够对房价进行预测的模型。</p> 
</blockquote> 
<h2><a id="1_5"></a>第1关：简单线性回归与多元线性回归</h2> 
<pre><code class="prism language-python"><span class="token number">1</span><span class="token punctuation">.</span>B C
</code></pre> 
<h2><a id="2_10"></a>第2关：线性回归的正规方程解</h2> 
<h4><a id="_11"></a>任务描述</h4> 
<p>本关任务：构建线性回归算法，并利用波斯顿房价数据对模型进行训练，然后对未知的房价数据进行预测。</p> 
<pre><code class="prism language-python"><span class="token comment">#encoding=utf8 </span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">def</span> <span class="token function">mse_score</span><span class="token punctuation">(</span>y_predict<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    input:y_predict(ndarray):预测值
          y_test(ndarray):真实值
    ouput:mse(float):mse损失函数值
       该方法计算损失
    '''</span>
    <span class="token comment">#********* Begin *********#</span>
    s <span class="token operator">=</span> np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>y_test <span class="token operator">-</span> y_predict<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    m <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>y_test<span class="token punctuation">)</span>
    mse <span class="token operator">=</span> s<span class="token operator">/</span>m
    <span class="token comment">#print(mse)</span>
    <span class="token comment">#********* End *********#</span>
    <span class="token keyword">return</span> mse


<span class="token keyword">class</span> <span class="token class-name">LinearRegression</span> <span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''初始化线性回归模型'''</span>
        self<span class="token punctuation">.</span>w <span class="token operator">=</span> <span class="token boolean">None</span>
        
    <span class="token keyword">def</span> <span class="token function">fit_normal</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>train_data<span class="token punctuation">,</span>train_label<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        input:train_data(ndarray):训练样本
              train_label(ndarray):训练标签
           该方法求解计算self.w的值
        '''</span>
        <span class="token comment">#********* Begin *********#</span>
        <span class="token triple-quoted-string string">'''将偏置与train_data拼接到一起
        (我们输入特征中并没有那个1，所以我们需要人为的加上去)
        &lt;np.ones()表示生成一个行数与train_data一致，列数等于1且所有元素都是1的矩阵&gt;'''</span>
        x <span class="token operator">=</span> np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>train_data<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> train_data<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment">#print(train_data)</span>
        y <span class="token operator">=</span> train_label
        <span class="token comment">#print(train_label)</span>
        <span class="token comment">#用正规方程求解参数</span>
        self<span class="token punctuation">.</span>w <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>inv<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">#********* End *********#</span>
        <span class="token keyword">return</span> self
    
    <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>test_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        input:test_data(ndarray):测试样本
           该方法对测试样本进行预测
        '''</span>
        <span class="token comment">#********* Begin *********#</span>
        <span class="token triple-quoted-string string">'''将偏置与test_data拼接到一起
        (我们输入特征中并没有那个1，所以我们需要人为的加上去)
        &lt;np.ones()表示生成一个行数与test_data一致，列数等于1且所有元素都是1的矩阵&gt;'''</span>
        t <span class="token operator">=</span> np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>test_data<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> test_data<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment">#根据模型y=wx预测</span>
        pre <span class="token operator">=</span> t<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>self<span class="token punctuation">.</span>w<span class="token punctuation">)</span>
        <span class="token keyword">return</span> pre
        <span class="token comment">#********* End *********#</span>
</code></pre> 
<h2><a id="3_72"></a>第3关：衡量线性回归的性能指标</h2> 
<h4><a id="_73"></a>任务描述</h4> 
<p>本关任务：根据本关卡所学知识，用Python实现线性回归常用评估指标，并对构造的线性回归模型进行评估。</p> 
<pre><code class="prism language-python"><span class="token comment">#encoding=utf8 </span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np


<span class="token comment">#mse</span>
<span class="token keyword">def</span> <span class="token function">mse_score</span><span class="token punctuation">(</span>y_predict<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token punctuation">:</span>
    mse <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">(</span>y_predict<span class="token operator">-</span>y_test<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> mse

<span class="token comment">#r2</span>
<span class="token keyword">def</span> <span class="token function">r2_score</span><span class="token punctuation">(</span>y_predict<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    input:y_predict(ndarray):预测值
          y_test(ndarray):真实值
    output:r2(float):r2值
    '''</span>
    <span class="token comment">#********* Begin *********#</span>
    up <span class="token operator">=</span> np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>y_predict <span class="token operator">-</span> y_test<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    down <span class="token operator">=</span> np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>y_test<span class="token punctuation">)</span> <span class="token operator">-</span>y_test<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    r2 <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> up<span class="token operator">/</span>down
    <span class="token comment">#********* End *********#</span>
    <span class="token keyword">return</span> r2


<span class="token keyword">class</span> <span class="token class-name">LinearRegression</span> <span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''初始化线性回归模型'''</span>
        self<span class="token punctuation">.</span>w <span class="token operator">=</span> <span class="token boolean">None</span>
        
    <span class="token keyword">def</span> <span class="token function">fit_normal</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>train_data<span class="token punctuation">,</span>train_label<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        input:train_data(ndarray):训练样本
              train_label(ndarray):训练标签
        '''</span>
        <span class="token comment">#********* Begin *********#</span>
        x <span class="token operator">=</span> np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>train_data<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>train_data<span class="token punctuation">]</span><span class="token punctuation">)</span>
        y <span class="token operator">=</span> train_label
        self<span class="token punctuation">.</span>w <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>inv<span class="token punctuation">(</span>x<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>x<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
        <span class="token comment">#********* End *********#</span>
        <span class="token keyword">return</span> self
    
    <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>test_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        input:test_data(ndarray):测试样本
        '''</span>
        <span class="token comment">#********* Begin *********#</span>
        x <span class="token operator">=</span> np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>test_data<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>test_data<span class="token punctuation">]</span><span class="token punctuation">)</span>
        pre <span class="token operator">=</span> x<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>self<span class="token punctuation">.</span>w<span class="token punctuation">)</span>
        <span class="token keyword">return</span> pre
        <span class="token comment">#********* End *********#</span>
</code></pre> 
<h2><a id="4sklearn_127"></a>第4关：sklearn中的线性回归</h2> 
<h4><a id="_128"></a>任务描述</h4> 
<p>本关任务：你需要调用 sklearn 中的线性回归模型，并通过波斯顿房价数据集中房价的13种属性与目标房价对线性回归模型进行训练。我们会调用你训练好的线性回归模型，来对房价进行预测。</p> 
<pre><code class="prism language-python"><span class="token comment">#encoding=utf8 </span>

<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression

<span class="token keyword">def</span> <span class="token function">lr_predict</span><span class="token punctuation">(</span>train_data<span class="token punctuation">,</span>train_label<span class="token punctuation">,</span>test_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    input:train_data(ndarray):训练样本特征
          train_label(ndarray):训练样本标签
          test_data(ndarray):测试样本特征
    output:predict(ndarray):测试样本预测标签      
    '''</span>
    <span class="token comment">#********* Begin *********#</span>
    lr <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>
    lr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_data<span class="token punctuation">,</span> train_label<span class="token punctuation">)</span>
    predict <span class="token operator">=</span> lr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_data<span class="token punctuation">)</span>
    <span class="token comment">#********* End *********#</span>
    <span class="token keyword">return</span> predict
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/968123ec8907110d5964e23d57ff4444/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【神经网络与深度学习day10-基于torch使用Lenet实现手写数字识别】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/907465642ad516420a600d5fb04fa9fb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux内核学习 篇-00：构建学习环境并运行一个HelloWorld模块</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>