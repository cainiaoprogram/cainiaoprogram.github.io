<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CTF中简单杂项小结 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CTF中简单杂项小结" />
<meta property="og:description" content="MISC1 参考
CTF Wiki MISC
简介 主要分为几个板块：Recon,Forensic,Stego,Crypto（古典密码）…
Recon：信息收集
主要介绍一些获取信息的渠道和一些利用百度、谷歌等搜索引擎的技巧 Encode（编码转换）
主要介绍在 CTF 比赛中一些常见的编码形式以及转换的技巧和常见方式 Forensic &amp;&amp; Stego（数字取证 &amp;&amp; 隐写分析）
隐写取证是 Misc 中最为重要的一块，包括文件分析、隐写、内存镜像分析和流量抓包分析等等，涉及巧妙的编码、隐藏数据、层层嵌套的文件中的文件，灵活利用搜索引擎获取所需要的信息等等。 一张概图
信息收集技术 网络收集 公开渠道
目标 Web 网页、地理位置、相关组织
组织结构和人员、个人资料、电话、电子邮件
网络配置、安全防护机制的策略和技术细节
通过搜索引擎查找特定安全漏洞或私密信息的方法
Google Hacking Database
科学上网
GoogleHacking
site 指定域名 Intext 正文存在关键字的网页 Intitle 标题存在关键字的网页 Info 一些基本信息 Inurl URL存在关键字的网页 Filetype 搜索指定文件类型 &#43; 强制包含某个字符进行查询 - 忽略某个字符 &#34;&#34;精准匹配某个字符 .匹配单个字符进行查询 *匹配任意字符进行查询 |或者 基本搜索 Google 基本搜索与挖掘技巧保持简单明了的关键词使用最可能出现在要查找的网页上的字词尽量简明扼要地描述要查找的内容选择独特性的描述字词社会公共信息库查询个人信息：人口统计局企业等实体：YellowPage、企业信用信息网网站、域名、IP：whois 等 地图街景 国外：Google Map、Google Earth、Google Street View国内：百度地图、卫星地图、街景从网络世界到物理世界：IP2Locationwhois 数据库GeoIP纯真数据库（QQ IP 查询） 编码技术 Morse 参见 摩尔斯编码 - 维基百科" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/5d5f9574b219a7a4cf421a4df0df94dc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-09T17:33:24+08:00" />
<meta property="article:modified_time" content="2022-03-09T17:33:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CTF中简单杂项小结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="MISC1_0"></a>MISC1</h2> 
<ul><li> <p>参考</p> <p><a href="https://ctf-wiki.github.io/ctf-wiki/misc/picture/introduction/" rel="nofollow">CTF Wiki MISC</a></p> </li></ul> 
<h4><a id="_6"></a>简介</h4> 
<ul><li> <p>主要分为几个板块：Recon,Forensic,Stego,Crypto（古典密码）…</p> 
  <ul><li> <p>Recon：信息收集</p> 
    <ul><li>主要介绍一些获取信息的渠道和一些利用百度、谷歌等搜索引擎的技巧</li></ul> </li><li> <p>Encode（编码转换）</p> 
    <ul><li>主要介绍在 CTF 比赛中一些常见的编码形式以及转换的技巧和常见方式</li></ul> </li><li> <p>Forensic &amp;&amp; Stego（数字取证 &amp;&amp; 隐写分析）</p> 
    <ul><li>隐写取证是 Misc 中最为重要的一块，包括文件分析、隐写、内存镜像分析和流量抓包分析等等，涉及巧妙的编码、隐藏数据、层层嵌套的文件中的文件，灵活利用搜索引擎获取所需要的信息等等。</li></ul> </li></ul> </li><li> <p>一张概图</p> <p><img src="https://images2.imgbox.com/2e/da/ibfV4UKz_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Ny2mh6d0-1646818112876)( MISC.assets\all.png)]"></p> </li></ul> 
<h4><a id="_24"></a>信息收集技术</h4> 
<h6><a id="_26"></a>网络收集</h6> 
<ul><li> <p>公开渠道</p> </li><li> <p>目标 Web 网页、地理位置、相关组织</p> </li><li> <p>组织结构和人员、个人资料、电话、电子邮件</p> </li><li> <p>网络配置、安全防护机制的策略和技术细节</p> </li><li> <p>通过搜索引擎查找特定安全漏洞或私密信息的方法</p> </li><li> <p><a href="https://www.exploit-db.com/google-hacking-database/" rel="nofollow">Google Hacking Database</a></p> </li><li> <p>科学上网</p> </li><li> <p>GoogleHacking</p> <pre><code>site 指定域名
Intext 正文存在关键字的网页
Intitle 标题存在关键字的网页
Info 一些基本信息
Inurl URL存在关键字的网页
Filetype 搜索指定文件类型
+ 强制包含某个字符进行查询
- 忽略某个字符
""精准匹配某个字符
.匹配单个字符进行查询
*匹配任意字符进行查询
|或者
</code></pre> </li></ul> 
<h6><a id="_61"></a>基本搜索</h6> 
<ul><li>Google 基本搜索与挖掘技巧</li><li>保持简单明了的关键词</li><li>使用最可能出现在要查找的网页上的字词</li><li>尽量简明扼要地描述要查找的内容</li><li>选择独特性的描述字词</li><li>社会公共信息库查询</li><li>个人信息：人口统计局</li><li>企业等实体：YellowPage、企业信用信息网</li><li>网站、域名、IP：whois 等</li></ul> 
<h6><a id="_73"></a>地图街景</h6> 
<ul><li>国外：Google Map、Google Earth、Google Street View</li><li>国内：百度地图、卫星地图、街景</li><li>从网络世界到物理世界：IP2Location</li><li>whois 数据库</li><li>GeoIP</li><li>纯真数据库（QQ IP 查询）</li></ul> 
<h4><a id="_82"></a>编码技术</h4> 
<h6><a id="Morse_84"></a>Morse</h6> 
<p>参见 <a href="https://zh.wikipedia.org/wiki/%E6%91%A9%E5%B0%94%E6%96%AF%E7%94%B5%E7%A0%81" rel="nofollow">摩尔斯编码 - 维基百科</a></p> 
<p><img src="https://images2.imgbox.com/d2/e3/HgdA30pF_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-FwSU4tkQ-1646818112877)( MISC.assets\morse.png)]"></p> 
<ul><li> <p>特点</p> 
  <ul><li>只有 <code>.</code> 和 <code>-</code>；</li><li>最多 6 位；</li><li>也可以使用 <code>01</code> 串表示。</li></ul> </li><li> <p>工具</p> 
  <ul><li><a href="http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx" rel="nofollow">摩尔斯编码在线转换</a></li></ul> </li></ul> 
<h6><a id="_99"></a>曼彻斯特编码</h6> 
<ul><li><a href="https://zh.wikipedia.org/wiki/%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81" rel="nofollow">曼彻斯特编码 </a></li></ul> 
<h6><a id="ASCII_103"></a>ASCII</h6> 
<p><img src="https://images2.imgbox.com/e6/9f/g3mvRp00_o.jpg" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-H2GM4u9r-1646818112877)( MISC.assets\ascii.jpg)]"></p> 
<ul><li>变形 
  <ul><li>二进制编码ASCII</li><li>十六进制</li></ul> </li></ul> 
<h6><a id="Base_112"></a>Base编码系列</h6> 
<ul><li> <p>basexx：代表采用多少个字符编码</p> </li><li> <p>base64</p> 
  <ul><li> <p>每6个bit为一个单元，对应某个打印字符</p> </li><li> <p>包括26大小写字母/10个数字/±/末尾使用=补齐</p> </li></ul> </li><li> <p>base32</p> 
  <ul><li>大写A-Z加数字234567，结尾可能最多有3个等号</li></ul> </li><li> <p>base16</p> 
  <ul><li>包括0123456789ABCDEF</li></ul> </li></ul> 
<h6><a id="XXencoding_128"></a>XXencoding</h6> 
<ul><li> <p>XXencode 将输入文本以每三个字节为单位进行编码。如果最后剩下的资料少于三个字节，不够的部份用零补齐。这三个字节共有 24 个 Bit，以<br> 6bit 为单位分为 4 个组，每个组以十进制来表示所出现的数值只会落在 0 到 63 之间。以所对应值的位置字符代替。</p> </li><li> <p>具体信息参见<a href="https://en.wikipedia.org/wiki/Xxencoding" rel="nofollow">XXencoding</a></p> </li></ul> 
<h6><a id="URLUnicode_135"></a>URL编码（Unicode）</h6> 
<ul><li> <p>参见<a href="https://zh.wikipedia.org/wiki/%E7%99%BE%E5%88%86%E5%8F%B7%E7%BC%96%E7%A0%81" rel="nofollow"> URL 编码 </a>。</p> </li><li> <p>特点：大量%</p> </li><li> <p>表现形式</p> 
  <ul><li> <p>原文本<code>The</code></p> <pre><code>&amp;#x [Hex]: &amp;#x0054;&amp;#x0068;&amp;#x0065;

&amp;# [Decimal]: &amp;#00084;&amp;#00104;&amp;#00101;

\U [Hex]: \U0054\U0068\U0065

\U+ [Hex]: \U+0054\U+0068\U+0065
</code></pre> </li></ul> </li></ul> 
<h6><a id="_155"></a>条形码</h6> 
<ul><li>宽度不等的多个黑条和空白，按照一定的编码规则排列，用以表达一组信息的图形标识符</li><li>国际标准</li><li>EAN-13 商品标准，13 位数字</li><li>Code-39：39 字符</li><li>Code-128：128 字符</li><li><a href="https://online-barcode-reader.inliteresearch.com/" rel="nofollow">条形码在线识别</a></li></ul> 
<h6><a id="_164"></a>二维码</h6> 
<ul><li>用某种特定几何图形按一定规律在平面分步的黑白相间的图形记录数据符号信息</li><li>堆叠式 / 行排式二维码：Code 16 k、Code 49、PDF417</li><li>矩阵式二维码：QR CODE</li></ul> 
<h4><a id="_170"></a>取证隐写</h4> 
<p><img src="https://images2.imgbox.com/2b/0b/jDljjQjM_o.jpg" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ehpg6Q9u-1646818112877)( MISC.assets\7.jpg)]"></p> 
<ul><li>要求检查一个静态数据文件从而获取隐藏信息</li></ul> 
<h6><a id="_177"></a>要求</h6> 
<ul><li> <p>了解常见的编码</p> <p>能够对文件中出现的一些编码进行解码，并且对一些特殊的编码（Base64、十六进制、二进制等）有一定的敏感度，对其进行转换并得到最终的 flag。</p> </li><li> <p>能够利用脚本语言（Python 等）去操作二进制数据</p> </li><li> <p>熟知常见文件的文件格式，尤其是各类 <a href="https://en.wikipedia.org/wiki/List_of_file_signatures" rel="nofollow">文件头</a>、协议、结构等</p> </li><li> <p>灵活运用常见的工具</p> </li></ul> 
<h6><a id="Python__httpsctfwikigithubioctfwikimiscprefixpython_189"></a>Python 操作二进制数据 <a href="https://ctf-wiki.github.io/ctf-wiki/misc/prefix/#python" rel="nofollow">¶</a></h6> 
<h6><a id="struct__httpsctfwikigithubioctfwikimiscprefixstruct_191"></a>struct 模块 <a href="https://ctf-wiki.github.io/ctf-wiki/misc/prefix/#struct" rel="nofollow">¶</a></h6> 
<p>有的时候需要用 Python 处理二进制数据，比如，存取文件，socket 操作时。这时候，可以使用 Python 的 struct 模块来完成。</p> 
<p>struct 模块中最重要的三个函数是 <code>pack()</code>、<code>unpack()</code> 和 <code>calcsize()</code></p> 
<ul><li><code>pack(fmt, v1, v2, ...)</code> 按照给定的格式（fmt），把数据封装成字符串（实际上是类似于 c 结构体的字节流）</li><li><code>unpack(fmt, string)</code> 按照给定的格式（fmt）解析字节流 string，返回解析出来的 tuple</li><li><code>calcsize(fmt)</code> 计算给定的格式（fmt）占用多少字节的内存</li></ul> 
<p>这里打包格式 <code>fmt</code> 确定了将变量按照什么方式打包成字节流，其包含了一系列的格式字符串。这里就不再给出不同格式字符串的含义了，详细细节可以参照 <a href="https://docs.python.org/2/library/struct.html" rel="nofollow">Python Doc</a></p> 
<pre><code>&gt;&gt;&gt; import struct
&gt;&gt;&gt; struct.pack('&gt;I',16)
'\x00\x00\x00\x10'
</code></pre> 
<p><code>pack</code> 的第一个参数是处理指令，<code>'&gt;I'</code> 的意思是：<code>&gt;</code> 表示字节顺序是 Big-Endian，也就是网络序，<code>I</code> 表示 4 字节无符号整数。</p> 
<p>后面的参数个数要和处理指令一致。</p> 
<p>读入一个 BMP 文件的前 30 字节，文件头的结构按顺序如下</p> 
<ul><li>两个字节：<code>BM</code> 表示 Windows 位图，<code>BA</code> 表示 OS/2 位图</li><li>一个 4 字节整数：表示位图大小</li><li>一个 4 字节整数：保留位，始终为 0</li><li>一个 4 字节整数：实际图像的偏移量</li><li>一个 4 字节整数：Header 的字节数</li><li>一个 4 字节整数：图像宽度</li><li>一个 4 字节整数：图像高度</li><li>一个 2 字节整数：始终为 1</li><li>一个 2 字节整数：颜色数</li></ul> 
<pre><code>&gt;&gt;&gt; import struct
&gt;&gt;&gt; bmp = '\x42\x4d\x38\x8c\x0a\x00\x00\x00\x00\x00\x36\x00\x00\x00\x28\x00\x00\x00\x80\x02\x00\x00\x68\x01\x00\x00\x01\x00\x18\x00'
&gt;&gt;&gt; struct.unpack('&lt;ccIIIIIIHH',bmp)
('B', 'M', 691256, 0, 54, 40, 640, 360, 1, 24)
</code></pre> 
<h6><a id="bytearray__httpsctfwikigithubioctfwikimiscprefixbytearray_232"></a>bytearray 字节数组 <a href="https://ctf-wiki.github.io/ctf-wiki/misc/prefix/#bytearray" rel="nofollow">¶</a></h6> 
<ul><li>将文件以二进制数组形式读取</li></ul> 
<pre><code>data = bytearray(open('challenge.png', 'rb').read())
</code></pre> 
<p>字节数组就是可变版本的字节</p> 
<pre><code>data[0] = '\x89'
</code></pre> 
<h6><a id="NTFS_246"></a>NTFS隐写</h6> 
<h6><a id="ADS__248"></a>ADS 交换数据流</h6> 
<p>是NTFS磁盘格式的一个特性，在NTFS文件系统下，每个文件都可以存在多个数据流，就是说除了主文件流之外还可以有许多非主文件流寄宿在主文件流中。它使用资源派生来维持与文件相关的信息，虽然我们无法看到数据流文件，但是它却是真实存在于我们的系统中的。创建一个数据交换流文件的方法很简单，命令为"宿主文件:准备与宿主文件关联的数据流文件"。</p> 
<h6><a id="_252"></a>图片分析</h6> 
<ul><li>图像文件有多种复杂的格式，可以用于各种涉及到元数据、信息丢失和无损压缩、校验、隐写或可视化数据编码的分析解密</li></ul> 
<h6><a id="_256"></a>元数据</h6> 
<ul><li> <p>元数据（Metadata），又称中介数据、中继数据，为描述数据的数据（Data about data），主要是描述数据属性（property）的信息，用来支持如指示存储位置、历史数据、资源查找、文件记录等功能。</p> </li><li> <p>元数据中隐藏信息在比赛中是最基本的一种手法，通常用来隐藏一些关键的 <code>Hint</code> 信息或者是一些重要的如 <code>password</code> 等信息。</p> <p>这类元数据你可以 <code>右键 --&gt; 属性</code> 去查看, 也可以通过 <code>strings</code> 命令去查看，一般来说，一些隐藏的信息（奇怪的字符串）常常出现在头部或者尾部。</p> <p><code>identify</code> 命令，这个命令是用来获取一个或多个图像文件的格式和特性。</p> <p><code>-format</code> 用来指定显示的信息，灵活使用它的 <code>-format</code> 参数可以给解题带来不少方便。<a href="https://www.imagemagick.org/script/escape.php" rel="nofollow">format 各个参数具体意义</a></p> </li></ul> 
<h6><a id="PNG_268"></a>PNG</h6> 
<ul><li> <p>文件格式</p> 
  <ul><li>文件头总是由位固定的字节来描述的，剩余部分由3个以上的数据块（Chunk）按照特定的顺序组成</li><li>文件头 <code>89 50 4E 47 0D 0A 1A 0A</code> + 数据块 + 数据块 + 数据块…</li></ul> </li><li> <p>数据块</p> 
  <ul><li>PNG 定义了两种类型的数据块，一种是称为关键数据块（critical chunk），这是标准的数据块，另一种叫做辅助数据块（ancillary<br> chunks），这是可选的数据块。关键数据块定义了 4 个标准数据块，每个 PNG 文件都必须包含它们，PNG<br> 读写软件也都必须要支持这些数据块。</li></ul> 
  <table><thead><tr><th>数据块符号</th><th>数据块名称</th><th>多数据块</th><th>可选否</th><th>位置限制</th></tr></thead><tbody><tr><td>IHDR</td><td>文件头数据块</td><td>否</td><td>否</td><td>第一块</td></tr><tr><td>cHRM</td><td>基色和白色点数据块</td><td>否</td><td>是</td><td>在 PLTE 和 IDAT 之前</td></tr><tr><td>gAMA</td><td>图像γ数据块</td><td>否</td><td>是</td><td>在 PLTE 和 IDAT 之前</td></tr><tr><td>sBIT</td><td>样本有效位数据块</td><td>否</td><td>是</td><td>在 PLTE 和 IDAT 之前</td></tr><tr><td>PLTE</td><td>调色板数据块</td><td>否</td><td>是</td><td>在 IDAT 之前</td></tr><tr><td>bKGD</td><td>背景颜色数据块</td><td>否</td><td>是</td><td>在 PLTE 之后 IDAT 之前</td></tr><tr><td>hIST</td><td>图像直方图数据块</td><td>否</td><td>是</td><td>在 PLTE 之后 IDAT 之前</td></tr><tr><td>tRNS</td><td>图像透明数据块</td><td>否</td><td>是</td><td>在 PLTE 之后 IDAT 之前</td></tr><tr><td>oFFs</td><td>(专用公共数据块）</td><td>否</td><td>是</td><td>在 IDAT 之前</td></tr><tr><td>pHYs</td><td>物理像素尺寸数据块</td><td>否</td><td>是</td><td>在 IDAT 之前</td></tr><tr><td>sCAL</td><td>(专用公共数据块）</td><td>否</td><td>是</td><td>在 IDAT 之前</td></tr><tr><td>IDAT</td><td>图像数据块</td><td>是</td><td>否</td><td>与其他 IDAT 连续</td></tr><tr><td>tIME</td><td>图像最后修改时间数据块</td><td>否</td><td>是</td><td>无限制</td></tr><tr><td>tEXt</td><td>文本信息数据块</td><td>是</td><td>是</td><td>无限制</td></tr><tr><td>zTXt</td><td>压缩文本数据块</td><td>是</td><td>是</td><td>无限制</td></tr><tr><td>fRAc</td><td>(专用公共数据块）</td><td>是</td><td>是</td><td>无限制</td></tr><tr><td>gIFg</td><td>(专用公共数据块）</td><td>是</td><td>是</td><td>无限制</td></tr><tr><td>gIFt</td><td>(专用公共数据块）</td><td>是</td><td>是</td><td>无限制</td></tr><tr><td>gIFx</td><td>(专用公共数据块）</td><td>是</td><td>是</td><td>无限制</td></tr><tr><td>IEND</td><td>图像结束数据</td><td>否</td><td>否</td><td>最后一个数据块</td></tr></tbody></table> 
  <ul><li> <p>每个数据块有4个部分构成</p> 
    <table><thead><tr><th>名称</th><th>字节数</th><th>说明</th></tr></thead><tbody><tr><td>Length（长度）</td><td>4 字节</td><td>指定数据块中数据域的长度，其长度不超过（231－1）字节</td></tr><tr><td>Chunk Type Code（数据块类型码）</td><td>4 字节</td><td>数据块类型码由 ASCII 字母（A - Z 和 a - z）组成</td></tr><tr><td>Chunk Data（数据块数据）</td><td>可变长度</td><td>存储按照 Chunk Type Code 指定的数据</td></tr><tr><td>CRC（循环冗余检测）</td><td>4 字节</td><td>存储用来检测是否有错误的循环冗余码</td></tr></tbody></table></li></ul> </li><li> <p>IHDR（文件头数据块）</p> 
  <ul><li> <p>包含PNG 文件中存储的图像数据的基本信息，由 <strong>13 字节</strong>组成，并要作为第一个数据块出现在 PNG 数据流中，而且一个 PNG 数据流中只能有一个文件头数据块</p> </li><li> <p>关注前8字节</p> 
    <table><thead><tr><th>域的名称</th><th>字节数</th><th>说明</th></tr></thead><tbody><tr><td>Width</td><td>4 bytes</td><td>图像宽度，以像素为单位</td></tr><tr><td>Height</td><td>4 bytes</td><td>图像高度，以像素为单位</td></tr></tbody></table></li></ul> </li><li> <p>PLTE</p> 
  <ul><li>调色板数据块 PLTE（palette chunk）：它包含有与索引彩色图像（indexed-color image）相关的彩色变换数据，它仅与索引彩色图像有关，而且要放在图像数据块（image data<br> chunk）之前。真彩色的 PNG 数据流也可以有调色板数据块，目的是便于非真彩色显示程序用它来量化图像数据，从而显示该图像。</li></ul> </li><li> <p>IDAT</p> 
  <ul><li>图像数据块 IDAT（image data chunk）：它存储实际的数据，在数据流中可包含多个连续顺序的图像数据块 
    <ul><li>储存图像像数数据</li><li>在数据流中可包含多个连续顺序的图像数据块</li><li>采用 LZ77 算法的派生算法进行压缩</li><li>可以用 zlib 解压缩</li></ul> </li></ul> </li><li> <p>IEND</p> </li><li> <p>图像结束数据 IEND（image trailer chunk）：它用来标记 PNG 文件或者数据流已经结束，并且必须要放在文件的尾部</p> </li><li> <p>其余辅助模块</p> 
  <ul><li>背景颜色数据块 bKGD（background color）</li><li>基色和白色度数据块 cHRM（primary chromaticities and white point），所谓白色度是指当 <code>R＝G＝B＝最大值</code> 时在显示器上产生的白色度</li><li>图像 γ 数据块 gAMA（image gamma）</li><li>图像直方图数据块 hIST（image histogram）</li><li>物理像素尺寸数据块 pHYs（physical pixel dimensions）</li><li>样本有效位数据块 sBIT（significant bits）</li><li>文本信息数据块 tEXt（textual data）</li><li>图像最后修改时间数据块 tIME （image last-modification time）</li><li>图像透明数据块 tRNS （transparency）</li><li>压缩文本数据块 zTXt （compressed textual data）</li></ul> </li><li> <p>LSB</p> 
  <ul><li>全称 Least Significant Bit，最低有效位。PNG 文件中的图像像数一般是由 RGB 三原色（红绿蓝）组成，每一种颜色占用 8 位，取值范围为 <code>0x00</code> 至 <code>0xFF</code>，即有 256 种颜色，一共包含了 256 的 3 次方的颜色</li><li>LSB 隐写就是修改 RGB 颜色分量的最低二进制位（LSB），每个颜色会有 8 bit，LSB 隐写就是修改了像数中的最低的 1 bit，而人类的眼睛不会注意到这前后的变化，每个像素可以携带 3 比特的信息。</li></ul> </li></ul> 
<h6><a id="JPG_354"></a>JPG</h6> 
<ul><li> <p>JPEG 是有损压缩格式，将像素信息用 JPEG 保存成文件再读取出来，其中某些像素值会有少许变化。在保存时有个质量参数可在 0 至 100 之间选择，参数越大图片就越保真，但图片的体积也就越大。一般情况下选择 70 或 80 就足够了</p> </li><li> <p>JPEG 没有透明度信息，文件头为FF D8 FF E1，结尾 03 FF D9</p> </li><li> <p>JPG 基本数据结构为两大类型：「段」和经过压缩编码的图像数据。</p> 
  <table><thead><tr><th>名 称</th><th>字节数</th><th>数据</th><th>说明</th></tr></thead><tbody><tr><td>段 标识</td><td>1</td><td>FF</td><td>每个新段的开始标识</td></tr><tr><td>段类型</td><td>1</td><td></td><td>类型编码（称作标记码）</td></tr><tr><td>段长 度</td><td>2</td><td></td><td>包括段内容和段长度本身, 不包括段标识和段类型</td></tr><tr><td>段内容</td><td>2</td><td></td><td>≤65533 字节</td></tr></tbody></table> 
  <ul><li> <p>有些段没有长度描述也没有内容，只有段标识和段类型。文件头和文件尾均属于这种段。</p> </li><li> <p>段与段之间无论有多少 <code>FF</code> 都是合法的，这些 <code>FF</code> 称为「填充字节」，必须被忽略掉</p> </li><li> <p>常见段，<code>0xffd8</code> 和 <code>0xffd9</code>为 JPG 文件的开始结束的标志。</p> <p><img src="https://images2.imgbox.com/2b/34/qGWKYhYk_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-WMgO3Ct1-1646818112878)( MISC.assets\jpgformat.png)]"></p> </li></ul> </li></ul> 
<h6><a id="GIF_377"></a>GIF</h6> 
<ul><li> <p>文件结构</p> 
  <ul><li> <p>文件头</p> 
    <ul><li>GIF 文件署名（Signature）</li><li>版本号（Version）</li></ul> </li><li> <p>数据流</p> 
    <ul><li>控制标识符</li><li>图象块（Image Block）</li><li>其他的一些扩展块</li></ul> </li><li> <p>文件终结器</p> </li></ul> </li></ul> 
<p><img src="https://images2.imgbox.com/68/26/s81EHC29_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-v7f09xIG-1646818112878)( MISC.assets\gif.png)]"></p> 
<ul><li> <p>文件头</p> </li><li> <p>GIF 署名（Signature）和版本号（Version）。GIF 署名用来确认一个文件是否是 GIF 格式的文件，这一部分由三个字符组成：<code>GIF</code>；文件版本号也是由三个字节组成，可以为 <code>87a</code> 或 <code>89a</code>。</p> </li><li> <p>逻辑屏幕标识符</p> </li><li> <p>紧跟在 header 后面。这个块告诉 decoder（解码器）图片需要占用的空间。它的大小固定为 7 个字节，以 canvas width（画布宽度）和 canvas height（画布高度）开始。</p> </li><li> <p>全局颜色列表</p> 
  <ul><li>或用于针对每个子图片集，提供 local color table。每个 color<br> table 由一个 RGB列表组成。</li></ul> </li><li> <p>图像标识符</p> 
  <ul><li> <p>一个 GIF 文件一般包含多个图片。之前的图片渲染模式一般是将多个图片绘制到一个大的（virtual canvas）虚拟画布上，而现在一般将这些图片集用于实现动画。</p> <p>每个 image 都以一个 image descriptor block（图像描述块）作为开头，这个块固定为 10 字节。</p> <p><img src="https://images2.imgbox.com/e3/ea/1aEmH6yT_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ER6UFJ43-1646818112879)( MISC.assets\imagesdescription.png)]"></p> </li></ul> </li><li> <p>图像数据</p> </li><li> <p>由一系列的输出编码（output codes）构成，它们告诉 decoder（解码器）需要绘制在画布上的每个颜色信息。这些编码以字节码的形式组织在这个块中。</p> </li><li> <p>文件终结器</p> </li><li> <p>该块为一个单字段块，用来指示该数据流的结束。取固定值 0x3b.</p> </li><li> <p>更多参见 <a href="http://www.jianshu.com/p/df52f1511cf8" rel="nofollow">gif 格式图片详细解析</a></p> </li><li> <p>空间轴</p> </li><li> <p>由于 GIF 的动态特性，由一帧帧的图片构成，所以每一帧的图片，多帧图片间的结合，都成了隐藏信息的一种载体。</p> </li><li> <p>时间轴</p> 
  <ul><li>GIF 文件每一帧间的时间间隔也可以作为信息隐藏的载体。</li></ul> </li></ul> 
<h6><a id="_434"></a>流量包分析</h6> 
<ul><li>PCAP文件</li><li>流量包修复</li><li>协议分析</li><li>数据提取</li></ul> 
<h6><a id="_441"></a>步骤</h6> 
<ol><li>总体把握 
  <ul><li>协议分级</li><li>端点统计</li></ul> </li><li>过滤赛选 
  <ul><li>过滤语法</li><li>Host，Protocol，contains，特征值</li></ul> </li><li>发现异常 
  <ul><li>特殊字符串</li><li>协议某字段</li><li>flag 位于服务器中</li></ul> </li><li>数据提取 
  <ul><li>字符串取</li><li>文件提取</li></ul> </li></ol> 
<h6><a id="PCAP_457"></a>PCAP文件修复</h6> 
<ul><li> <p>一般文件结构</p> <pre><code> 0                   1                   2                   3   
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Block Type                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                          Block Body                           /
   /          /* variable length, aligned to 32 bits */            /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre> 
  <ul><li> <p>常见块</p> 
    <ul><li> <p>Section Header BlocK(文件头)</p> </li><li> <p>文件的开始</p> <pre><code> 0                   1                   2                   3   
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Byte-Order Magic (0x1A2B3C4D)                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Major Version(主版本号)   |    Minor Version(次版本号)        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                          Section Length                       |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre> </li><li> <p>Interface Description Block(接口描述)</p> </li><li> <p>描述接口特性</p> <pre><code> 0                   1                   2                   3   
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           LinkType            |           Reserved            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  SnapLen(每个数据包最大字节数)                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre> </li><li> <p>Packet Block（数据块）</p> <pre><code> 0                   1                   2                   3   
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Interface ID          |          Drops Count          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Timestamp (High)   标准的Unix格式          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Timestamp (Low)                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         Captured Len                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Packet Len                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                          Packet Data                          /
   /          /* variable length, aligned to 32 bits */            /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                      Options (variable)                       /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre> </li></ul> </li></ul> </li></ul> 
<h6><a id="_545"></a>协议分析</h6> 
<h6><a id="wireshark_547"></a>wireshark</h6> 
<p><a href="https://blog.csdn.net/sinat_32176267/article/details/78297361">链接</a></p> 
<h6><a id="_551"></a>需要注意的协议</h6> 
<ul><li> <p>HTTP</p> 
  <ul><li><code>HTTP</code> ( <code>Hyper Text Transfer Protocol</code> ，也称为超文本传输协议) 是一种用于分布式、协作式和超媒体信息系统的应用层协议。 <code>HTTP</code> 是万维网的数据通信的基础。</li></ul> </li><li> <p>HTTPS</p> 
  <ul><li><code>HTTPs = HTTP + SSL / TLS</code>. 服务端和客户端的信息传输都会通过 TLS 进行加密，所以传输的数据都是加密后的数据</li></ul> </li><li> <p>FTP</p> 
  <ul><li> <p><code>FTP</code> ( <code>File Transfer Protocol</code> ，即文件传输协议) 是 <code>TCP/IP</code> 协议组中的协议之一。 <code>FTP</code> 协议包括两个组成部分，其一为 <code>FTP</code> 服务器，其二为 <code>FTP</code> 客户端。其中 <code>FTP</code> 服务器用来存储文件，用户可以使用 <code>FTP</code> 客户端通过 <code>FTP</code> 协议访问位于 <code>FTP</code> 服务器上的资源。在开发网站的时候，通常利用 <code>FTP</code> 协议把网页或程序传到 <code>Web</code> 服务器上。此外，由于 <code>FTP</code> 传输效率非常高，在网络上传输大的文件时，一般也采用该协议。</p> <p>默认情况下 <code>FTP</code> 协议使用 <code>TCP</code> 端口中的 <code>20</code> 和 <code>21</code> 这两个端口，其中 <code>20</code> 用于传输数据， <code>21</code> 用于传输控制信息。但是，是否使用 <code>20</code> 作为传输数据的端口与 <code>FTP</code> 使用的传输模式有关，如果采用主动模式，那么数据传输端口就是 <code>20</code> ；如果采用被动模式，则具体最终使用哪个端口要服务器端和客户端协商决定。</p> </li></ul> </li><li> <p>DNS</p> 
  <ul><li> <p><code>DNS</code> 通常为 <code>UDP</code> 协议, 报文格式</p> <pre><code>+-------------------------------+
| 报文头                         |
+-------------------------------+
| 问题 (向服务器提出的查询部分)    |
+-------------------------------+
| 回答 (服务器回复的资源记录)      |
+-------------------------------+
| 授权 (权威的资源记录)           |
+-------------------------------+
| 格外的 (格外的资源记录)         |
+-------------------------------+
</code></pre> </li><li> <p>查询包只有头部和问题两个部分， <code>DNS</code> 收到查询包后，根据查询到的信息追加回答信息、授权机构、额外资源记录，并且修改了包头的相关标识再返回给客户端。</p> <p>每个 <code>question</code> 部分</p> <pre><code>   0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
 |                                               |
 /                     QNAME                     /
 /                                               /
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
 |                     QTYPE                     |
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
 |                     QCLASS                    |
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
</code></pre> 
    <ul><li><code>QNAME</code> ：为查询的域名，是可变长的，编码格式为：将域名用. 号划分为多个部分，每个部分前面加上一个字节表示该部分的长度，最后加一个 <code>0</code> 字节表示结束</li><li><code>QTYPE</code> ：占 <code>16</code> 位，表示查询类型，共有 <code>16</code> 种，常用值有：<code>1</code> ( <code>A</code> 记录，请求主机 <code>IP</code> 地址)、<code>2</code> ( <code>NS</code> ，请求授权 <code>DNS</code> 服务器)、<code>5</code> ( <code>CNAME</code> 别名查询）</li></ul> </li></ul> </li><li> <p>WIFI</p> 
  <ul><li> 
    <blockquote> 
     <p><code>802.11</code> 是现今无线局域网通用的标准, 常见认证方式</p> 
     <ul><li>不启用安全‍‍</li><li><code>WEP‍‍</code></li><li><code>WPA/WPA2-PSK</code>（预共享密钥）‍‍</li><li><code>PA/WPA2 802.1X</code> （<code>radius</code> 认证）</li></ul> 
    </blockquote> </li><li> <p>WPA-PSK</p> <p><img src="https://images2.imgbox.com/5a/51/Z4F5vZIx_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-GKA8vdIp-1646818112879)( MISC.assets\wpa-psk.png)]"></p> </li></ul> <p><img src="https://images2.imgbox.com/fa/9d/YNw4tn8J_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-7ccKIZdQ-1646818112879)( MISC.assets\eapol.png)]"></p> 
  <ul><li>4 次握手开始于验证器 (AP)，它产生一个随机的值(ANonce) 发送给请求者</li><li>请求者也产生了它自己的随机 SNonce，然后用这两个 Nonces 以及 PMK 生成了 PTK。请求者回复消息 2 给验证器, 还有一个 MIC（message integrity code，消息验证码）作为 PMK 的验证</li><li>它先要验证请求者在消息 2 中发来的 MIC 等信息，验证成功后，如果需要就生成 GTK。然后发送消息 3</li><li>请求者收到消息 3，验证 MIC，安装密钥，发送消息 4，一个确认信息。验证器收到消息 4，验证 MIC，安装相同的密钥</li></ul> </li><li> <p>USB</p> 
  <ul><li>鼠标协议</li></ul> <p>鼠标移动时表现为连续性，与键盘击键的离散性不一样，不过实际上鼠标动作所产生的数据包也是离散的，毕竟计算机表现的连续性信息都是由大量离散信息构成的</p> <p><img src="https://images2.imgbox.com/d4/98/Hr4ZE92M_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-oBvxQ6zh-1646818112879)( MISC.assets\mouse.png)]"></p> </li></ul> 
<p>每一个数据包的数据区有四个字节，第一个字节代表按键，当取 0x00 时，代表没有按键、为 0x01 时，代表按左键，为 0x02 时，代表当前按键为右键。第二个字节可以看成是一个 signed byte 类型，其最高位为符号位，当这个值为正时，代表鼠标水平右移多少像素，为负时，代表水平左移多少像素。第三个字节与第二字节类似，代表垂直上下移动的偏移。</p> 
<p>得到这些点的信息后, 即可恢复出鼠标移动轨迹</p> 
<ul><li>Tools</li><li><a href="https://github.com/WangYihang/UsbMiceDataHacker">UsbMiceDataHacker</a></li><li>键盘协议</li></ul> 
<p>键盘数据包的数据长度为 8 个字节，击键信息集中在第 3 个字节</p> 
<p><img src="https://images2.imgbox.com/6a/d4/6RskGweP_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-AKbeAeRb-1646818112880)( MISC.assets\keyboard.png)]"></p> 
<p><img src="https://images2.imgbox.com/8c/fe/U2NF9Vgx_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-GCOkmHJY-1646818112881)( MISC.assets\keyboard_pro.png)]"></p> 
<h4><a id="_656"></a>一些工具和使用方法</h4> 
<h6><a id="16_658"></a>16进制查看</h6> 
<p>010Editor： 16进制查看分析器<br> winhex：</p> 
<h6><a id="_661"></a>解压密码</h6> 
<p>ARCHPR： 爆破rar文件解压密码<br> 小技巧：假如密码为abc+三位数字，破解时选择掩码类型，掩码为<code>abc???</code>，再把暴力范围设置为数字即可<br> ziperello ：爆破zip文件解压密码</p> 
<h6><a id="_665"></a>隐写</h6> 
<p>Stegsolve： 图片隐写分析<br> Stegdetect： 识别加密方式，主要是jpeg的隐写查看<br> pngcheck： png图像隐写查看<br> TweakPNG ：查看和修改PNG文件的元信息（适用于文件头无法正常打开）<br> zsteg（kali） LSB隐写分析：把所有的最低位信息显示出来<br> wbstego： bmp，pdf等其他文件解密隐写<br> MP3Steno： 音频隐写读取<br> ntfsstreamseditor NTF：数据流检测和提取</p> 
<h6><a id="_674"></a>加解密</h6> 
<p>Bftools：</p> 
<ol><li>bftools.exe decode braincopter 要解密的图片名称 -o 要输出的文件名</li><li>bftools.exe run 上一步输出的文件<br> jphs ：jpeg图像的隐写，jphide的加密方式<br> outguess(kali): jpg 图像的隐写解密<br> 使用格式：outguess -r 需要揭秘的文件名 输出结果文件名<br> F5 ：一般用于解密文件信息<br> 方法是cd到F5-steganography里面，然后调用<br> <code>java Extract /root/Desktop/123456.jpg -p 123456</code><br> 找到输出文件<code>cat</code>即可</li></ol> 
<h6><a id="_685"></a>其他</h6> 
<p>Bcompare： 综合对比工具，包括文档，zip等<br> Cool-edit：音频文件查看编辑<br> jd-gui jar：文件反编译<br> Opanda： 图片信息查看器，元数据<br> Q-research： 二维码查看器，可反色<br> fireworks ：编辑图像，比ps差一点<br> RouterPassView： 路由文件查看<br> file命令： 识别文件类型<br> binwalk ：固件扫描分析：自动发掘文件中的隐藏文件</p> 
<pre><code>常用的命令
binwalk 文件名（可以用file查看）
提取文件 -e  
</code></pre> 
<p>Foremost： 文件还原工具 ：基于文件文件头和尾部信息以及文件的内建数据结构恢复文件的命令行工具<br> crunch 创建字典</p> 
<pre><code>格式
crunch &lt;min-len&gt; &lt;max-len&gt; [&lt;charset string&gt;] [options]
-b 指定输出文件的大小 类型有效值为KB、MB、GB、KIB，MIB，和GIB。前三种类型是基于1000，而最后三种类型是基于1024，注意数字与类型之间没有空格
-c 指定输出文件的行数，即包含密码的个数
-d 限制出现相同元素的个数(至少出现元素个数)(“@”代表小写字母，“,”代表大写字符，“%”代表数字，“^”代表特殊字符)
-e 定义停止生产密码
-f 从某文件指定字符集，调用密码库文件
-i 改变输出格式 
-o 输出文件名称
-q 读取某文件
-t 指定模式
</code></pre> 
<p>aircrack-ng： 无线渗透工具破解wep，wpa-psk等加密</p> 
<h4><a id="_720"></a>一些常见的套路</h4> 
<h6><a id="_721"></a>文件套路</h6> 
<p>文件类型不同<br> 文件头错误<br> 文件合并</p> 
<h6><a id="_726"></a>压缩文件的处理</h6> 
<p>zip伪加密 ：文件里有一位专门标识了文件是否加密<br> 压缩源文件数据区：50 4B 03 04：这是头文件标记<br> 压缩源文件目录区：<br> 50 4B 01 02：目录中文件文件头标记<br> 3F 00：压缩使用的 pkware 版本<br> 14 00：解压文件所需 pkware 版本<br> 00 00：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 00打开就会提示有密码了）<br> 操作方法就是搜索504B0102，从50开始第九个，奇数表示加密，偶数表示不加密<br> rar伪加密：由于头部有校验，使用伪加密打开文件会报错，这时可以尝试伪加密，16进制打开找到第24个字节（一般是7下第二个）尾数为4表示加密，0表示未加密<br> 压缩源文件目录结束标志 ：50 4B 05 06：目录结束标记</p> 
<h6><a id="_738"></a>图片隐写</h6> 
<p>颜色差别<br> GIF多帧隐藏：颜色通道，对比隐写<br> Exif信息隐藏<br> 图片修复：图片头，尾，CRC校验，长宽高修复<br> 最低有效位LSB隐写<br> 图片加密</p> 
<h6><a id="_746"></a>附加式图片隐写</h6> 
<p>通常是用某种程序或者某种方法在载体文件中直接附加上需要被隐写的目标，然后将载体文件直接传输给接受者或者发布到网站上，然后接受者者根据方法提取出被隐写的消息，大致有两种经典方式，一是直接附加字符串，二是图种的形式出现。</p> 
<ul><li> <p>附加字符串</p> <p>大致操作</p> 
  <ol><li> <p>打开图片确认图片是否异常</p> </li><li> <p>使用strings检查图片</p> <p>附上strings的使用大致方法</p> <p>strings命令在对象文件或二进制文件中查找可打印的字符串。字符串是4个或更多可打印字符的任意序列，以换行符或空字符结束。 strings命令对识别随机对象文件很有用。</p> <p>选项：</p> 
    <ul><li> <p>-a --all：扫描整个文件而不是只扫描目标文件初始化和装载段</p> </li><li> <p>-f –print-file-name：在显示字符串前先显示文件名</p> </li><li> <p>-t --radix={o,d,x} ：输出字符的位置，基于八进制，十进制或者十六进制</p> </li><li> <p>-e --encoding={s,S,b,l,B,L} ：选择字符大小和排列顺序:s = 7-bit, S = 8-bit, {b,l} = 16-bit, {B,L} = 32-bit</p> </li></ul> </li><li> <p>当然可以直接使用如winhex，010editor直接打开图片查看 ps：这个好像更简单！</p> </li></ol> </li><li> <p>图种</p> <p>一种采用特殊方式将图片文件（如jpg格式）与rar文件结合起来的文件。该文件一般保存为jpg格式，可以正常显示图片，当有人获取该图片后，可以修改文件的后缀名，将图片改为rar压缩文件，并得到其中的数据。<br> 图种这是一种以图片文件为载体，通常为jpg格式的图片，然后将zip等压缩包文件附加在图片文件后面。因为操作系统识别的过程中是，从文件头标志，到文件的结束标志位，当系统识别到图片的结束标志位后，默认是不再继续识别的，所以我们在通常情况下只能看到它是只是一张图片。</p> <p>方法就是</p> <p>先用file命令或者binwalk查看一波图片是不是纯图片</p> <p>然后可以用binwalk -e或者foremost 来分离图种，也可以直接修改后缀</p> <p>来个可能没怎么用到的方法 winhex</p> <p>补充一个zip文件头 50 4B 03 04</p> <p>先用它打开图片，然后找到这个文件头，从它开始到结尾的数据复制下来，到一个新文件，然后命名为zip格式即可！</p> </li></ul> 
<h6><a id="_791"></a>基于文件结构的隐写</h6> 
<p>文件结构特指的是图片文件的文件结构，这里特别提一下PNG，尤其要掌握的是文件头数据块即IHDR块：包含宽，高，深度，颜色类型，压缩方法等，还有IDAT数据块，存储实际的数据，转义他可以存在多个，多以个对图片影响不大</p> 
<ul><li> <p>宽度高度的修改的隐写</p> <p>修改高度或者宽度</p> <p>计算crc校验</p> </li><li> <p>隐写信息以IDAT块加入图片</p> <p>利用pngcheck检查</p> <p><code>pngcheck -v</code></p> </li></ul> 
<h6><a id="LSB_807"></a>LSB隐写</h6> 
<p>LSB，最低有效位，英文是Least Significant Bit<br> 。我们知道图像像素一般是由RGB三原色（即红绿蓝）组成的，每一种颜色占用8位，0x00~0xFF，即一共有256种颜色，一共包含了256的3次方的颜色，颜色太多，而人的肉眼能区分的只有其中一小部分，这导致了当我们修改RGB颜色分量种最低的二进制位的时候，我们的肉眼是区分不出来的。</p> 
<p>法宝就是stegsolve，zsteg！！！</p> 
<p>简单一点儿的，直接切换通道就可以看到，复杂的需要提取</p> 
<h6><a id="DCTJPG_816"></a>DCT域的JPG图片隐写</h6> 
<p>JPEG图像格式使用离散余弦变换（Discrete Cosine<br> Transform，DCT）函数来压缩图像，而这个图像压缩方法的核心是：通过识别每个8×8像素块中相邻像素中的重复像素来减少显示图像所需的位数，并使用近似估算法降低其冗余度。因此，我们可以把DCT看作一个用于执行压缩的近似计算方法。因为丢失了部分数据，所以DCT是一种有损压缩（Loss<br> Compression）技术，但一般不会影响图像的视觉效果。</p> 
<p>常见的隐写方法有JSteg、JPHide、Outguess、F5</p> 
<p>敲黑板！！！重点工具来了</p> 
<p>Stegdetect</p> 
<p>通过统计分析技术评估JPEG文件的DCT频率系数</p> 
<pre><code>-q 仅显示可能包含隐藏内容的图像。
-n 启用检查JPEG文件头功能，以降低误报率。如果启用，所有带有批注区域的文件将被视为没有被嵌入信息。如果JPEG文件的JFIF标识符中的版本号不是1.1，则禁用OutGuess检测。
-s 修改检测算法的敏感度，该值的默认值为1。检测结果的匹配度与检测算法的敏感度成正比，算法敏感度的值越大，检测出的可疑文件包含敏感信息的可能性越大。
-d 打印带行号的调试信息。
-t 设置要检测哪些隐写工具（默认检测jopi），可设置的选项如下：
j 检测图像中的信息是否是用jsteg嵌入的。
o 检测图像中的信息是否是用outguess嵌入的。
p 检测图像中的信息是否是用jphide嵌入的。
i 检测图像中的信息是否是用invisible secrets嵌入的。
-V 显示软件版本号。
如果检测结果显示该文件可能包含隐藏信息，那么Stegdetect会在检测结果后面使用1～3颗星来标识
隐藏信息存在的可能性大小，3颗星表示隐藏信息存在的可能性最大。
</code></pre> 
<h6><a id="_845"></a>数字水印隐写</h6> 
<p>数字水印（digital watermark）技术，是指在数字化的数据内容中嵌入不明显的记号。<br> 特征是，被嵌入的记号通常是不可见或不可察的，但是可以通过计算操作检测或者提取。</p> 
<h6><a id="_850"></a>图片容差隐写</h6> 
<p>压缩方法的核心是：通过识别每个8×8像素块中相邻像素中的重复像素来减少显示图像所需的位数，并使用近似估算法降低其冗余度。因此，我们可以把DCT看作一个用于执行压缩的近似计算方法。因为丢失了部分数据，所以DCT是一种有损压缩（Loss<br> Compression）技术，但一般不会影响图像的视觉效果。</p> 
<p>常见的隐写方法有JSteg、JPHide、Outguess、F5</p> 
<p>敲黑板！！！重点工具来了</p> 
<p>Stegdetect</p> 
<p>通过统计分析技术评估JPEG文件的DCT频率系数</p> 
<pre><code>-q 仅显示可能包含隐藏内容的图像。
-n 启用检查JPEG文件头功能，以降低误报率。如果启用，所有带有批注区域的文件将被视为没有被嵌入信息。如果JPEG文件的JFIF标识符中的版本号不是1.1，则禁用OutGuess检测。
-s 修改检测算法的敏感度，该值的默认值为1。检测结果的匹配度与检测算法的敏感度成正比，算法敏感度的值越大，检测出的可疑文件包含敏感信息的可能性越大。
-d 打印带行号的调试信息。
-t 设置要检测哪些隐写工具（默认检测jopi），可设置的选项如下：
j 检测图像中的信息是否是用jsteg嵌入的。
o 检测图像中的信息是否是用outguess嵌入的。
p 检测图像中的信息是否是用jphide嵌入的。
i 检测图像中的信息是否是用invisible secrets嵌入的。
-V 显示软件版本号。
如果检测结果显示该文件可能包含隐藏信息，那么Stegdetect会在检测结果后面使用1～3颗星来标识
隐藏信息存在的可能性大小，3颗星表示隐藏信息存在的可能性最大。
</code></pre> 
<h6><a id="_878"></a>数字水印隐写</h6> 
<p>数字水印（digital watermark）技术，是指在数字化的数据内容中嵌入不明显的记号。<br> 特征是，被嵌入的记号通常是不可见或不可察的，但是可以通过计算操作检测或者提取。</p> 
<h6><a id="_883"></a>图片容差隐写</h6> 
<p>容差，在选取颜色时所设置的选取范围，容差越大，选取的范围也越大，其数值是在0-255之间。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/701d27a84a40f6d2493b57c3d0e6a5be/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">IDEA 中的 @NonNls 注解的引用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/81e0d0e082deaa4ab0f5d9ec6d5314f4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Golang strings.HasPrefix函数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>