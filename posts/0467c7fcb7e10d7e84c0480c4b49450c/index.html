<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>认识数据链路层 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="认识数据链路层" />
<meta property="og:description" content=" #认识以太网 &#34;以太网&#34; 不是一种具体的网络，而是一种技术标准；既包含了数据链路层的内容，也包含了 一些物理层的内容。例如：规定了网络拓扑结构，访问控制方式，传输速率等；例如以太网中的网线必须使用双绞线；传输速率有10M，100M，1000M等； 以太网是当前应用最广泛的局域网技术；和以太网并列的还有令牌环网，无线LAN等；
以太网帧格式 可以看见，在数据链路层传输的数据帧是由IP数据报封装而成的，其中源地址和目的地址是指网卡的硬件地址（也叫MAC地址），长度是48位，是在网卡出厂时固 化的； 帧协议类型字段有三种值，分别对应IP、ARP、RARP； 帧末尾是CRC校验码。
#认识MTU MTU相当于发快递时对包裹尺寸的限制。这个限制是不同的数据链路对应的物理层，产生的限制。
以太网帧中的数据长度规定最小46字节，最大1500字节，ARP数据包的长度不够46字节， 要在后面补填充位；
最大值1500称为以太网的最大传输单元（MTU），不同的网络类型有不同的MTU；
如果一个数据包从以太网路由到拨号链路上，数据包长度大于拨号链路的MTU了，则需要对 数据包进行分片（fragmentation）；
不同的数据链路层标准的MTU是不同的；
MTU对IP协议的影响 由于数据链路层MTU的限制，对于较大的IP数据包要进行分包。
将较大的IP包分成多个小包，并给每个小包打上标签； 每个小包IP协议头的 16位标识（id） 都是相同的； 每个小包的IP协议头的3位标志字段中，第2位置为0，表示允许分片，第3位来表示结束标记 （当前是否是最后一个小包，是的话置为1，否则置为0）； 到达对端时再将这些小包，会按顺序重组，拼装到一起返回给传输层；一旦这些小包中任意一个小包丢失，接收端的重组就会失败。但是IP层不会负责重新传输数据；
MTU对UDP协议的影响 一旦UDP携带的数据超过1472（1500 - 20（IP首部） - 8（UDP首部）），那么就会在网络 层分成多个IP数据报。 这多个IP数据报有任意一个丢失，都会引起接收端网络层重组失败。那么这就意味着，如果 UDP数据报在网络层被分片，整个数据被丢失的概率就大大增加了。 MTU对于TCP协议的影响 TCP的一个数据报也不能无限大，还是受制于MTU。TCP的单个数据报的最大消息长度，称 为MSS（Max Segment Size）；
TCP在建立连接的过程中，通信双方会进行MSS协商。
最理想的情况下，MSS的值正好是在IP不会被分片处理的最大长度（这个长度仍然是受制于 数据链路层的MTU）。
双方在发送SYN的时候会在TCP头部写入自己能支持的MSS值。
然后双方得知对方的MSS值之后，选择较小的作为最终MSS。
MSS的值就是在TCP首部的40字节变长选项中（kind=2）；
MSS和MTU的关系
#ARP协议 虽然我们在这里介绍ARP协议，但是需要强调，ARP不是一个单纯的数据链路层的协议，而是一个介于 数据链路层和网络层之间的协议； ARP协议的作用 ARP协议建立了主机 IP地址 和 MAC地址 的映射关系。 （1）主机和路由器中都保存了一张ARP缓存表：通过IP地址可以找到对应的MAC地址。
（2）根据下一跳设备的IP地址，在ARP缓存表中能找到对应的MAC地址，则可以设置目的MAC并发送数据报。
（3）如果找不到，则发送ARP广播数据报：目的MAC为广播地址，询问下一跳设备的MAC地址。 这个过程类似于QQ群喊话：张三（下一跳设备IP地址），我要给你发快递（发送数据报），请告诉 我你的收货地址（MAC地址）。 " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0467c7fcb7e10d7e84c0480c4b49450c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-22T20:57:19+08:00" />
<meta property="article:modified_time" content="2022-08-22T20:57:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">认识数据链路层</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>#认识以太网</h2> 
<p>"以太网" 不是一种具体的网络，而是一种技术标准；既包含了数据链路层的内容，也包含了 一些物理层的内容。例如：规定了网络拓扑结构，访问控制方式，传输速率等；例如以太网中的网线必须使用双绞线；传输速率有10M，100M，1000M等； 以太网是当前应用最广泛的局域网技术；和以太网并列的还有令牌环网，无线LAN等；</p> 
<h4>以太网帧格式</h4> 
<p><img alt="" height="172" src="https://images2.imgbox.com/59/4a/cu8KiEAF_o.png" width="734">可以看见，在数据链路层传输的数据帧是由IP数据报封装而成的，其中源地址和目的地址是指网卡的硬件地址（也叫MAC地址），长度是48位，是在网卡出厂时固 化的； 帧协议类型字段有三种值，分别对应IP、ARP、RARP； 帧末尾是CRC校验码。</p> 
<h2>#认识MTU</h2> 
<p>MTU相当于发快递时对包裹尺寸的限制。这个限制是不同的数据链路对应的物理层，产生的限制。</p> 
<p>以太网帧中的数据长度规定最小46字节，最大1500字节，ARP数据包的长度不够46字节， 要在后面补填充位；</p> 
<p>最大值1500称为以太网的最大传输单元（MTU），不同的网络类型有不同的MTU；</p> 
<p>如果一个数据包从以太网路由到拨号链路上，数据包长度大于拨号链路的MTU了，则需要对 数据包进行分片（fragmentation）；</p> 
<p>不同的数据链路层标准的MTU是不同的；</p> 
<h4>MTU对IP协议的影响</h4> 
<p>由于数据链路层MTU的限制，对于较大的IP数据包要进行分包。</p> 
<p>将较大的IP包分成多个小包，并给每个小包打上标签； 每个小包IP协议头的 16位标识（id） 都是相同的； 每个小包的IP协议头的3位标志字段中，第2位置为0，表示允许分片，第3位来表示结束标记 （当前是否是最后一个小包，是的话置为1，否则置为0）； 到达对端时再将这些小包，会按顺序重组，拼装到一起返回给传输层；一旦这些小包中任意一个小包丢失，接收端的重组就会失败。但是IP层不会负责重新传输数据；</p> 
<p><img alt="" height="357" src="https://images2.imgbox.com/70/fe/n00xSR0p_o.png" width="738"></p> 
<h4>MTU对UDP协议的影响</h4> 
<p>一旦UDP携带的数据超过1472（1500 - 20（IP首部） - 8（UDP首部）），那么就会在网络 层分成多个IP数据报。 这多个IP数据报有任意一个丢失，都会引起接收端网络层重组失败。那么这就意味着，如果 UDP数据报在网络层被分片，整个数据被丢失的概率就大大增加了。 </p> 
<h4>MTU对于TCP协议的影响</h4> 
<ul><li> <p>TCP的一个数据报也不能无限大，还是受制于MTU。TCP的单个数据报的最大消息长度，称 为MSS（Max Segment Size）；</p> </li><li> <p>TCP在建立连接的过程中，通信双方会进行MSS协商。</p> </li><li> <p>最理想的情况下，MSS的值正好是在IP不会被分片处理的最大长度（这个长度仍然是受制于 数据链路层的MTU）。</p> </li><li> <p>双方在发送SYN的时候会在TCP头部写入自己能支持的MSS值。</p> </li><li> <p>然后双方得知对方的MSS值之后，选择较小的作为最终MSS。</p> </li><li> <p>MSS的值就是在TCP首部的40字节变长选项中（kind=2）；</p> </li></ul> 
<p>MSS和MTU的关系</p> 
<p><img alt="" height="238" src="https://images2.imgbox.com/9e/5e/90Ty8WUF_o.png" width="662"> </p> 
<h2>#ARP协议</h2> 
<p>虽然我们在这里介绍ARP协议，但是需要强调，ARP不是一个单纯的数据链路层的协议，而是一个介于 数据链路层和网络层之间的协议； </p> 
<h4>ARP协议的作用</h4> 
<p>ARP协议建立了主机 IP地址 和 MAC地址 的映射关系。 </p> 
<p>（1）主机和路由器中都保存了一张ARP缓存表：通过IP地址可以找到对应的MAC地址。</p> 
<p>（2）根据下一跳设备的IP地址，在ARP缓存表中能找到对应的MAC地址，则可以设置目的MAC并发送数据报。</p> 
<p>（3）如果找不到，则发送ARP广播数据报：目的MAC为广播地址，询问下一跳设备的MAC地址。 这个过程类似于QQ群喊话：张三（下一跳设备IP地址），我要给你发快递（发送数据报），请告诉 我你的收货地址（MAC地址）。 </p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bbd03e5fcbb8e314e778a779e7457f3f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ubuntu 20.04下vscode的安装（学习总结Day 3）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/02a4aea2708fd3ace7800e6baa13160e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Django--案例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>