<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>小白PX4无人机仿真—OFFBOARD控制资料汇总 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="小白PX4无人机仿真—OFFBOARD控制资料汇总" />
<meta property="og:description" content="1. 仿真环境搭建 这套仿真环境是基于Ubuntu20.04环境下的ROS1＋PX4固件的联合仿真，由于初次接触这方面的仿真环境搭建，几番寻找找到了国内的XTdrone开源无人机仿真平台，跟着这套仿真平台搭建了一个完整的仿真环境，XTdrone这个平台的简介可以参考这个视频：
XTDrone: 基于PX4、ROS和Gazebo的无人机通用仿真平台简介_哔哩哔哩_bilibili
这里再附上XTdrone的gitee链接 ：
XTDrone: 基于PX4、ROS和Gazebo的无人机通用仿真平台
对于无人机仿真来说其实本质需要的就是三大部分，ROS环境，MAVROS包，PX4编译环境，ROS提供通讯和Gazebo仿真环境，PX4固件支持linux编译运行，并通过Gazebo仿真出来，还可连接QGC地面站，MAVROS则是ROS和PX4通讯的桥梁，因为PX4只支持mavlink通讯协议，而ROS则是基于话题，服务等通讯机制，所以需要有一个功能包去把话题和服务转换成mavlink协议，这个功能包就是MAVROS。
XTdrone的搭建有两个版本，一个是基于Ubuntu18.04的但由于Ubuntu18.04已经停止维护，所以更推荐基于Ubuntu20.04的版本，其对应的PX4版本也比较新。下面是搭建的官方教程，最好需要有科学上网的环境，不然配置起来很麻烦，另外官方的教程基于Ubuntu20.04可能安装的人并不多，所以坑还是不少的，每个人的坑也不太一样，不过这些坑基本可以从CSDN上找到解决办法。
此处为语雀内容卡片，点击链接查看：仿真平台基础配置（对应PX4 1.13版） · 语雀
当可以运行键盘控制无人机飞行则表明环境搭建成功
2. 上层控制基础介绍 对于上层控制PX4，飞控端的模式是OFFBOARD，在这个模式下，可以通过mavlink协议，对无人机发送期望位置，期望速度，期望加速度来控制无人机，同时可以通过接收mavlink消息来获取无人机当前姿态。下面这个视频系列对这个模式有详细的介绍：
新手入门无人机&#43;PX4&#43;ROS工程应用开发？看这门课就够了 4.无人机offboard控制_哔哩哔哩_bilibili
同时介绍一下mavros功能包，这个功能包所包含的话题和服务种类很多，这里列举几个常用的消息话题：
【精选】ROS系列——mavros功能包中常用话题和服务介绍，包括消息名称、类型、头文件、成员变量、示例代码_mavros/mission/waypoint-CSDN博客
常用的基本上也就是以下这几个
mavros/statemavros/local_position/posemavros/manual_control/controlmavros/setpoint_position/localmavros/setpoint_velocity/cmd_vel_unstampedmavros/setpoint_attitude/attitudemavros/cmd/armingmavros/set_mode（谨慎使用） 3. 代码分析 3.1 一键起飞例程运行 第一步需要启动PX4官方的一个仿真launch文件
cd ~/PX4_Firmware roslaunch px4 mavros_posix_sitl.launch 此时会启动一个Gazebo的仿真环境，如下图所示
再新开一个终端，并运行
rostopic echo /mavros/state 这是用来订阅/mavros/state这一话题，可以实时查看当前无人机状态，如果connected显示的是True的话,则说明仿真运行正常，MAVROS通讯正常。显示的效果如下图所示：
如果安装了地面站的话执行下面指令打开地面站（到软件包对应目录）
./QGroundControl.AppImage 此时在地面站应该可以看到无人机相关状态信息，随后就进入到了最关键的一步，编写offboard控制节点，这个节点的功能包如果还没创建，可以参考下面这篇文章：
【ROS&#43;Gazebo&#43;px4】打开offboard模式，offboard_node文件内容-CSDN博客
而具体的源码分析，可以参考下面这篇文章：
mavros笔记（一）：mavros概述与offboard例程解析_听风南巷的博客-CSDN博客
3.2 代码分析 首先从最开始运行的 mavros_posix_sitl.launch 这一launch文件说起，下面是这个launch文件源码
&lt;?xml version=&#34;1.0&#34;?&gt; &lt;launch&gt; &lt;!-- MAVROS posix SITL environment launch script --&gt; &lt;!-- launches MAVROS, PX4 SITL, Gazebo environment, and spawns vehicle --&gt; &lt;!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f4ba03fca1c9299dce7fcbcb52cfe85b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-05T17:17:03+08:00" />
<meta property="article:modified_time" content="2023-11-05T17:17:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">小白PX4无人机仿真—OFFBOARD控制资料汇总</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 id="vLKQ5">1. 仿真环境搭建</h2> 
<p id="ucb1592cf">这套仿真环境是基于Ubuntu20.04环境下的ROS1＋PX4固件的联合仿真，由于初次接触这方面的仿真环境搭建，几番寻找找到了国内的XTdrone开源无人机仿真平台，跟着这套仿真平台搭建了一个完整的仿真环境，XTdrone这个平台的简介可以参考这个视频：</p> 
<p><a href="https://www.bilibili.com/video/BV1gh4y1K7Hy?vd_source=42d90548f468e20a0e2891b4bdd52bf0" rel="nofollow" title="XTDrone: 基于PX4、ROS和Gazebo的无人机通用仿真平台简介_哔哩哔哩_bilibili">XTDrone: 基于PX4、ROS和Gazebo的无人机通用仿真平台简介_哔哩哔哩_bilibili</a></p> 
<p id="u0ba74344">这里再附上XTdrone的gitee链接 ：</p> 
<p><a href="https://gitee.com/robin_shaun/XTDrone.git" rel="nofollow" title="XTDrone: 基于PX4、ROS和Gazebo的无人机通用仿真平台">XTDrone: 基于PX4、ROS和Gazebo的无人机通用仿真平台</a></p> 
<p id="u47def0da">对于无人机仿真来说其实本质需要的就是三大部分，ROS环境，MAVROS包，PX4编译环境，ROS提供通讯和Gazebo仿真环境，PX4固件支持linux编译运行，并通过Gazebo仿真出来，还可连接QGC地面站，MAVROS则是ROS和PX4通讯的桥梁，因为PX4只支持mavlink通讯协议，而ROS则是基于话题，服务等通讯机制，所以需要有一个功能包去把话题和服务转换成mavlink协议，这个功能包就是MAVROS。</p> 
<p id="u0671df41">XTdrone的搭建有两个版本，一个是基于Ubuntu18.04的但由于Ubuntu18.04已经停止维护，所以更推荐基于Ubuntu20.04的版本，其对应的PX4版本也比较新。下面是搭建的官方教程，最好需要有科学上网的环境，不然配置起来很麻烦，另外官方的教程基于Ubuntu20.04可能安装的人并不多，所以坑还是不少的，每个人的坑也不太一样，不过这些坑基本可以从CSDN上找到解决办法。</p> 
<p>此处为语雀内容卡片，点击链接查看：<a href="https://www.yuque.com/xtdrone/manual_cn/basic_config_13" rel="nofollow" title="仿真平台基础配置（对应PX4 1.13版） · 语雀">仿真平台基础配置（对应PX4 1.13版） · 语雀</a></p> 
<p id="uad20256f">当可以运行键盘控制无人机飞行则表明环境搭建成功</p> 
<h2 id="ZF3F9">2. 上层控制基础介绍</h2> 
<p id="ub4df7758">对于上层控制PX4，飞控端的模式是OFFBOARD，在这个模式下，可以通过mavlink协议，对无人机发送期望位置，期望速度，期望加速度来控制无人机，同时可以通过接收mavlink消息来获取无人机当前姿态。下面这个视频系列对这个模式有详细的介绍：</p> 
<p><a href="https://www.bilibili.com/video/BV1CK4y1F7uU?vd_source=42d90548f468e20a0e2891b4bdd52bf0" rel="nofollow" title="新手入门无人机+PX4+ROS工程应用开发？看这门课就够了 4.无人机offboard控制_哔哩哔哩_bilibili">新手入门无人机+PX4+ROS工程应用开发？看这门课就够了 4.无人机offboard控制_哔哩哔哩_bilibili</a></p> 
<p id="u66e659aa">同时介绍一下mavros功能包，这个功能包所包含的话题和服务种类很多，这里列举几个常用的消息话题：</p> 
<p><a href="https://blog.csdn.net/jppdss/article/details/128401304?spm=1001.2014.3001.5506" title="【精选】ROS系列——mavros功能包中常用话题和服务介绍，包括消息名称、类型、头文件、成员变量、示例代码_mavros/mission/waypoint-CSDN博客">【精选】ROS系列——mavros功能包中常用话题和服务介绍，包括消息名称、类型、头文件、成员变量、示例代码_mavros/mission/waypoint-CSDN博客</a></p> 
<p id="u7599b244">常用的基本上也就是以下这几个</p> 
<ul><li id="u4827cc9e">mavros/state</li><li id="uc205750e">mavros/local_position/pose</li><li id="u35c3a331">mavros/manual_control/control</li><li id="ub5338a38">mavros/setpoint_position/local</li><li id="u0d99203f">mavros/setpoint_velocity/cmd_vel_unstamped</li><li id="u5ff7b223">mavros/setpoint_attitude/attitude</li><li id="u7e1f7d6d">mavros/cmd/arming</li><li id="u4bf12409">mavros/set_mode（谨慎使用）</li></ul> 
<p id="u9dda4ec9"></p> 
<h2 id="NbDUV">3. 代码分析</h2> 
<h3 id="iiD52"><strong>3.1 一键起飞例程运行</strong></h3> 
<p id="u8a65b882">第一步需要启动PX4官方的一个仿真launch文件</p> 
<pre id="rSF8d">cd ~/PX4_Firmware
roslaunch px4 mavros_posix_sitl.launch</pre> 
<p id="u77f18383">此时会启动一个Gazebo的仿真环境，如下图所示</p> 
<p id="uc767f3bf"></p> 
<p class="img-center"><img alt="" height="1043" id="WzAu8" src="https://images2.imgbox.com/8b/e7/HlfGPc2G_o.png" width="1200"></p> 
<p id="uc443c2cf">再新开一个终端，并运行</p> 
<p id="u3f0d3168"></p> 
<pre id="PoeD3">rostopic echo /mavros/state</pre> 
<p id="u5118bdf5">这是用来订阅/mavros/state这一话题，可以实时查看当前无人机状态，如果connected显示的是True的话,则说明仿真运行正常，MAVROS通讯正常。显示的效果如下图所示：</p> 
<p id="u3ccd6b48"></p> 
<p class="img-center"><img alt="" height="481" id="ub2cc616e" src="https://images2.imgbox.com/4f/08/SeER7zRy_o.png" width="735"></p> 
<p id="uc7eb7ff7">如果安装了地面站的话执行下面指令打开地面站（到软件包对应目录）</p> 
<pre id="GXaaY">./QGroundControl.AppImage </pre> 
<p id="ud68d696e">此时在地面站应该可以看到无人机相关状态信息，随后就进入到了最关键的一步，编写offboard控制节点，这个节点的功能包如果还没创建，可以参考下面这篇文章：</p> 
<p><a href="https://blog.csdn.net/qq_51985653/article/details/130647051?spm=1001.2014.3001.5506" title="【ROS+Gazebo+px4】打开offboard模式，offboard_node文件内容-CSDN博客">【ROS+Gazebo+px4】打开offboard模式，offboard_node文件内容-CSDN博客</a></p> 
<p id="u58d35ee2">而具体的源码分析，可以参考下面这篇文章：</p> 
<p><a href="https://blog.csdn.net/qq_46202265/article/details/129298122?spm=1001.2014.3001.5502" title="mavros笔记（一）：mavros概述与offboard例程解析_听风南巷的博客-CSDN博客">mavros笔记（一）：mavros概述与offboard例程解析_听风南巷的博客-CSDN博客</a></p> 
<p id="ub5a7e572"></p> 
<h3 id="qG6gH"><strong>3.2 代码分析</strong></h3> 
<p id="u3c7d0af1">首先从最开始运行的 mavros_posix_sitl.launch 这一launch文件说起，下面是这个launch文件源码</p> 
<pre id="RKy0c">&lt;?xml version="1.0"?&gt;
&lt;launch&gt;
    &lt;!-- MAVROS posix SITL environment launch script --&gt;
    &lt;!-- launches MAVROS, PX4 SITL, Gazebo environment, and spawns vehicle --&gt;
    &lt;!-- vehicle pose --&gt;
    &lt;arg name="x" default="0"/&gt;
    &lt;arg name="y" default="0"/&gt;
    &lt;arg name="z" default="0"/&gt;
    &lt;arg name="R" default="0"/&gt;
    &lt;arg name="P" default="0"/&gt;
    &lt;arg name="Y" default="0"/&gt;
    &lt;!-- vehicle model and world --&gt;
    &lt;arg name="est" default="ekf2"/&gt;
    &lt;arg name="vehicle" default="iris"/&gt;
    &lt;arg name="world" default="$(find mavlink_sitl_gazebo)/worlds/empty.world"/&gt;
    &lt;arg name="vehicle_sdf" default="iris"/&gt;
    &lt;arg name="sdf" default="$(find mavlink_sitl_gazebo)/models/$(arg vehicle_sdf)/$(arg vehicle_sdf).sdf"/&gt;

    &lt;!-- gazebo configs --&gt;
    &lt;arg name="gui" default="true"/&gt;
    &lt;arg name="debug" default="false"/&gt;
    &lt;arg name="verbose" default="true"/&gt;
    &lt;arg name="paused" default="false"/&gt;
    &lt;arg name="respawn_gazebo" default="false"/&gt;
    &lt;!-- MAVROS configs --&gt;
    &lt;arg name="fcu_url" default="udp://:24540@localhost:34580"/&gt;
    &lt;arg name="respawn_mavros" default="false"/&gt;
    &lt;!-- PX4 configs --&gt;
    &lt;arg name="interactive" default="true"/&gt;
    &lt;!-- PX4 SITL and Gazebo --&gt;
    &lt;include file="$(find px4)/launch/posix_sitl.launch"&gt;
        &lt;arg name="x" value="$(arg x)"/&gt;
        &lt;arg name="y" value="$(arg y)"/&gt;
        &lt;arg name="z" value="$(arg z)"/&gt;
        &lt;arg name="R" value="$(arg R)"/&gt;
        &lt;arg name="P" value="$(arg P)"/&gt;
        &lt;arg name="Y" value="$(arg Y)"/&gt;
        &lt;arg name="world" value="$(arg world)"/&gt;
        &lt;arg name="vehicle" value="$(arg vehicle)"/&gt;
        &lt;arg name="sdf" value="$(arg sdf)"/&gt;
        &lt;arg name="gui" value="$(arg gui)"/&gt;
        &lt;arg name="interactive" value="$(arg interactive)"/&gt;
        &lt;arg name="debug" value="$(arg debug)"/&gt;
        &lt;arg name="verbose" value="$(arg verbose)"/&gt;
        &lt;arg name="paused" value="$(arg paused)"/&gt;
        &lt;arg name="respawn_gazebo" value="$(arg respawn_gazebo)"/&gt;
    &lt;/include&gt;
    &lt;!-- MAVROS --&gt;
    &lt;include file="$(find mavros)/launch/px4.launch"&gt;
        &lt;!-- GCS link is provided by SITL --&gt;
        &lt;arg name="gcs_url" value=""/&gt;
        &lt;arg name="fcu_url" value="$(arg fcu_url)"/&gt;
        &lt;arg name="respawn_mavros" value="$(arg respawn_mavros)"/&gt;
    &lt;/include&gt;
&lt;/launch&gt;
</pre> 
<p id="uda7081d8">&lt;arg&gt;标签在6-11行最开始用于声明一些无人机初始位置和角度的变量，方便后续引入其他launch文件后调用，13-17用于定义世界模型和无人机模型的相关变量，后面根据官方注释的，是对Gazebo，MAVROS，PX4的初始化配置，这里要关注fcu_url这个变量，后续做集群的时候，可能会修改这个变量后面的UDP端口。到了31行，来到了第一个重头戏，这里包含了一个新的launch文件，这个文件的源码如下图所示：</p> 
<pre id="v0elY">&lt;?xml version="1.0"?&gt;
&lt;launch&gt;
    &lt;!-- Posix SITL environment launch script --&gt;
    &lt;!-- launches PX4 SITL, Gazebo environment, and spawns vehicle --&gt;
    &lt;!-- vehicle pose --&gt;
    &lt;arg name="x" default="0"/&gt;
    &lt;arg name="y" default="0"/&gt;
    &lt;arg name="z" default="0"/&gt;
    &lt;arg name="R" default="0"/&gt;
    &lt;arg name="P" default="0"/&gt;
    &lt;arg name="Y" default="0"/&gt;
    &lt;!-- vehicle model and world --&gt;
    &lt;arg name="est" default="ekf2"/&gt;
    &lt;arg name="vehicle" default="iris"/&gt;
    &lt;arg name="world" default="$(find mavlink_sitl_gazebo)/worlds/empty.world"/&gt;
    &lt;arg name="sdf" default="$(find mavlink_sitl_gazebo)/models/$(arg vehicle)/$(arg vehicle).sdf"/&gt;
    &lt;env name="PX4_SIM_MODEL" value="$(arg vehicle)" /&gt;
    &lt;env name="PX4_ESTIMATOR" value="$(arg est)" /&gt;

    &lt;!-- gazebo configs --&gt;
    &lt;arg name="gui" default="true"/&gt;
    &lt;arg name="debug" default="false"/&gt;
    &lt;arg name="verbose" default="false"/&gt;
    &lt;arg name="paused" default="false"/&gt;
    &lt;arg name="respawn_gazebo" default="false"/&gt;
    &lt;!-- PX4 configs --&gt;
    &lt;arg name="interactive" default="true"/&gt;
    &lt;!-- PX4 SITL --&gt;
    &lt;arg unless="$(arg interactive)" name="px4_command_arg1" value="-d"/&gt;
    &lt;arg     if="$(arg interactive)" name="px4_command_arg1" value=""/&gt;
    &lt;node name="sitl" pkg="px4" type="px4" output="screen"
        args="$(find px4)/build/px4_sitl_default/etc -s etc/init.d-posix/rcS $(arg px4_command_arg1)" required="true"/&gt;

    &lt;!-- Gazebo sim --&gt;
    &lt;include file="$(find gazebo_ros)/launch/empty_world.launch"&gt;
        &lt;arg name="gui" value="$(arg gui)"/&gt;
        &lt;arg name="world_name" value="$(arg world)"/&gt;
        &lt;arg name="debug" value="$(arg debug)"/&gt;
        &lt;arg name="verbose" value="$(arg verbose)"/&gt;
        &lt;arg name="paused" value="$(arg paused)"/&gt;
        &lt;arg name="respawn_gazebo" value="$(arg respawn_gazebo)"/&gt;
    &lt;/include&gt;
    &lt;!-- gazebo model --&gt;
    &lt;node name="$(anon vehicle_spawn)" pkg="gazebo_ros" type="spawn_model" output="screen" args="-sdf -file $(arg sdf) -model $(arg vehicle) -x $(arg x) -y $(arg y) -z $(arg z) -R $(arg R) -P $(arg P) -Y $(arg Y)"/&gt;
&lt;/launch&gt;</pre> 
<p id="u97f6e1eb">对这个源码我们简要过一下，前面其实大差不差，在31行启动了px4这个节点，具体源码我没细看，大致应该是运行PX4固件，后面会加载一个空模型，随后又启动了一个gazebo的仿真节点，大致就是这样，我们书归正传，接着分析mavros_posix_sitl.launch这个文件，32-46行，就是把最开始前面定义的节点，统统都赋值到posix_sitl.launch这个launch文件里的变量中，做了一个嵌套替换，到了49行，又引入了一个新的launch文件，这里我依旧把源码附到下面：</p> 
<pre id="kVFCQ">&lt;launch&gt;
	&lt;!-- vim: set ft=xml noet : --&gt;
	&lt;!-- example launch script for PX4 based FCU's --&gt;

	&lt;arg name="fcu_url" default="/dev/ttyACM0:57600" /&gt;
	&lt;arg name="gcs_url" default="" /&gt;
	&lt;arg name="tgt_system" default="1" /&gt;
	&lt;arg name="tgt_component" default="1" /&gt;
	&lt;arg name="log_output" default="screen" /&gt;
	&lt;arg name="fcu_protocol" default="v2.0" /&gt;
	&lt;arg name="respawn_mavros" default="false" /&gt;

	&lt;include file="$(find mavros)/launch/node.launch"&gt;
		&lt;arg name="pluginlists_yaml" value="$(find mavros)/launch/px4_pluginlists.yaml" /&gt;
		&lt;arg name="config_yaml" value="$(find mavros)/launch/px4_config.yaml" /&gt;

		&lt;arg name="fcu_url" value="$(arg fcu_url)" /&gt;
		&lt;arg name="gcs_url" value="$(arg gcs_url)" /&gt;
		&lt;arg name="tgt_system" value="$(arg tgt_system)" /&gt;
		&lt;arg name="tgt_component" value="$(arg tgt_component)" /&gt;
		&lt;arg name="log_output" value="$(arg log_output)" /&gt;
		&lt;arg name="fcu_protocol" value="$(arg fcu_protocol)" /&gt;
		&lt;arg name="respawn_mavros" default="$(arg respawn_mavros)" /&gt;
	&lt;/include&gt;
&lt;/launch&gt;</pre> 
<p id="u0eb0ec2e">这部分是启动mavros的相关节点，在这里又引入了一个新的launch文件 node.launch，这里依旧把源码附到下面：</p> 
<p id="u9fde1532"></p> 
<pre id="TNmhS">&lt;launch&gt;
	&lt;!-- vim: set ft=xml noet : --&gt;
	&lt;!-- base node launch file--&gt;

	&lt;arg name="fcu_url" /&gt;
	&lt;arg name="gcs_url" /&gt;
	&lt;arg name="tgt_system" /&gt;
	&lt;arg name="tgt_component" /&gt;
	&lt;arg name="pluginlists_yaml" /&gt;
	&lt;arg name="config_yaml" /&gt;
	&lt;arg name="log_output" default="screen" /&gt;
	&lt;arg name="fcu_protocol" default="v2.0" /&gt;
	&lt;arg name="respawn_mavros" default="false" /&gt;

	&lt;node pkg="mavros" type="mavros_node" name="mavros" required="$(eval not respawn_mavros)" clear_params="true" output="$(arg log_output)" respawn="$(arg respawn_mavros)"&gt;
		&lt;param name="fcu_url" value="$(arg fcu_url)" /&gt;
		&lt;param name="gcs_url" value="$(arg gcs_url)" /&gt;
		&lt;param name="target_system_id" value="$(arg tgt_system)" /&gt;
		&lt;param name="target_component_id" value="$(arg tgt_component)" /&gt;
		&lt;param name="fcu_protocol" value="$(arg fcu_protocol)" /&gt;

		&lt;!-- load blacklist, config --&gt;
		&lt;rosparam command="load" file="$(arg pluginlists_yaml)" /&gt;
		&lt;rosparam command="load" file="$(arg config_yaml)" /&gt;
	&lt;/node&gt;
&lt;/launch&gt;</pre> 
<p id="uba3a1744">可以看到，最终最核心的，就是启动mavros这个节点，以及上传一些参数到参数服务器。至此对整个框架有了一个大体的认识。</p> 
<p id="ua7cb5afa">在运行完launch文件后，此时启动了许多的话题和服务，通过订阅和发布的方式就可以通过话题去控制和监测无人机，常用的控制指令基本都是基于话题的形式，服务相关目前用到的就是模式切换和无人机上锁解锁这两项，对于仿真而言，由于运行时启动的飞机模式是auto模式，此时就需要对其切换成OFFBOARD模式，而切换OFFBOARD模式必须发送大于100条以上的数据才可，<strong>在实际飞行中，切记不要在程序中切换飞行模式，切记,</strong>后续的offboard控制节点就比较简单了，ROS八股文，订阅消息，发布消息，在上面的CSDN文章也有详细的介绍了。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/57b88bb365c6dd680ea012dcb82fa1d7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">普通人快速逆袭的一个路径:AI赛道&#43;早&#43;下场干</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6baafaff8d74df7b067cdb96d484679f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AD16布线技巧 新手必看</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>