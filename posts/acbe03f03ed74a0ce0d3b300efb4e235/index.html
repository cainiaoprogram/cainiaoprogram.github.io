<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android源码环境搭建（aosp Ubuntu 16.04） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android源码环境搭建（aosp Ubuntu 16.04）" />
<meta property="og:description" content="Android源码环境搭建（aosp Ubuntu 16.04） 作者：千里马
课程要求：
电脑配置：双核，内存最少 16G，硬盘 200G 以上，独立安装 Ubuntu16.4 系统(http://releases.ubuntu.com/16.04/下面的ubuntu-16.04.7-desktop-amd64.iso，如果网速慢自己百度找一个阿里镜像)
（优先考虑直接电脑安装Ubuntu &gt; windows和Ubuntu双系统 &gt; windows上安装VMware方式，不要不建议安装virtualbox）
学员要求：最少 1 年以上应用开发经验，推荐在 3 年左右 Android 应用开发经验，
熟悉 Java 语言，可以看懂 C/C&#43;&#43;
1、安装 ubuntu16.04（因为这个版本可以直接安装 openjdk-8，如果其他版本自行找方法）
2、openjdk 8 的安装
sudo apt-get install openjdk-8-jdk
3、设置默认 java 和 javac(可选)
由于本人当前 Ubuntu 上没有安装其他版本的 jdk，所以跳过此步骤
sudo update-alternatives --config java
sudo update-alternatives --config javac
4、 检查版本
java -version
打印如下：
openjdk version “1.8.0_252”
OpenJDK Runtime Environment (build 1.8.0_252-8u252-b09-1~16.04-b09)
OpenJDK 64-Bit Server VM (build 25." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/acbe03f03ed74a0ce0d3b300efb4e235/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-22T18:29:47+08:00" />
<meta property="article:modified_time" content="2023-05-22T18:29:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android源码环境搭建（aosp Ubuntu 16.04）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="Androidaosp_Ubuntu_1604_0"></a>Android源码环境搭建（aosp Ubuntu 16.04）</h3> 
<p>作者：千里马<br> 课程要求：<br> 电脑配置：双核，内存最少 16G，硬盘 200G 以上，独立安装 Ubuntu16.4 系统(<a href="http://releases.ubuntu.com/16.04/" rel="nofollow">http://releases.ubuntu.com/16.04/</a>下面的ubuntu-16.04.7-desktop-amd64.iso，如果网速慢自己百度找一个阿里镜像)<br> （优先考虑直接电脑安装Ubuntu &gt; windows和Ubuntu双系统 &gt; windows上安装VMware方式，不要不建议安装virtualbox）<br> 学员要求：最少 1 年以上应用开发经验，推荐在 3 年左右 Android 应用开发经验，<br> 熟悉 Java 语言，可以看懂 C/C++<br> 1、安装 ubuntu16.04（因为这个版本可以直接安装 openjdk-8，如果其他版本自行找方法）<br> 2、openjdk 8 的安装<br> sudo apt-get install openjdk-8-jdk<br> 3、设置默认 java 和 javac(可选)<br> 由于本人当前 Ubuntu 上没有安装其他版本的 jdk，所以跳过此步骤<br> sudo update-alternatives --config java<br> sudo update-alternatives --config javac<br> 4、 检查版本<br> java -version<br> 打印如下：<br> openjdk version “1.8.0_252”<br> OpenJDK Runtime Environment (build 1.8.0_252-8u252-b09-1~16.04-b09)<br> OpenJDK 64-Bit Server VM (build 25.252-b09, mixed mode)<br> 5、安装所需的软件软件包（注意一定要拷贝换行问题，最好先拷贝到txt上，再拷贝到命令行）</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> git-core gnupg flex bison gperf build-essential <span class="token function">zip</span> <span class="token function">curl</span> zlib1g-dev gcc-multilib g++-multilib libc6-dev-i386 lib32ncurses5-dev x11proto-core-dev libx11-dev lib32z-dev libgl1-mesa-dev libxml2-utils xsltproc <span class="token function">unzip</span>
</code></pre> 
<p><strong>注意：如果是ubuntu 20.04编译需要额外配置一些：<br> 1、安装两个包：python 和 libncurses5</strong></p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> python libncurses5
</code></pre> 
<p><strong>2、同时还需要在用户目录下的 .bashrc文件中加入以下一行,用vi命令既可以：</strong></p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LC_ALL</span></span><span class="token operator">=</span>C
</code></pre> 
<p>最后还需要source命令：</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">source</span> .bashrc
</code></pre> 
<p>6、源码下载<br> 6.1 网络下载方法：<br> 国内不可以访问 google 故无法下载 aosp 源码，国内清华大学源有相关镜像<br> 参考链接：<br> https://mirror.tuna.tsinghua.edu.cn/help/AOSP/<br> 6.2 本地解压方式<br> 下载链接地址：https://pan.baidu.com/s/1Jwsrb-zwrQO-HEHo5eo9Jg 提取码:uu1j<br> <s>注意下载完成后md5进行一下校验，如果和这里不一样请重新下载</s></p> 
<pre><code class="prism language-bash">test@test-Lenovo:~$ md5sum android-8.1.0_r1.7z 
9c68e5b226494e8ba3accd0d4bcdd744  android-8.1.0_r1.7z
</code></pre> 
<p>百度云下载相关的源码包，进行本地解压,下载我提供的百度云链接 android-8.1.0_r1.7z 文件</p> 
<ol><li>sudo apt-get install p7zip</li><li>7zr x android-8.1.0_r1.7z<br> 会有一个 overwirte 提示直接输入：y 同意既可以 （注意：这里最后会出现一个Sub Item error大家可以忽略）<br> 7、编译 aosp 代码<br> 1、 . build/envsetup.sh<br> 2、lunch<br> 这里我们选择：6 –-- &gt; aosp_x86_64<br> <a href="https://blog.csdn.net/learnframework/article/details/116861979">3、make ANDROID_COMPILE_WITH_JACK=false （建议直接 ：make，但是会产一个jackserver错，解决方法点击这里</a>）<br> 经历大概几个小时等待<br> 出现如下打印代表成功：</li></ol> 
<p>(如果有的机器有dex2oatd 时候报错，直接core dumped了，请使用关闭优化命令：<br> make WITH_DEXPREOPT=false)</p> 
<h5><a id="build_completed_successfully_054408_hhmmss_70"></a>build completed successfully (05:44:08 (hh:mm:ss))</h5> 
<p>4、执行命令：emulator，出现如下图界面<br> <img src="https://images2.imgbox.com/28/cf/Vnk4N1Su_o.png" alt="在这里插入图片描述"><strong>(注意只要terminal关闭后就需要重新进行<br> 1、 . build/envsetup.sh<br> 2、lunch<br> 然后可以直接emulator，没有修改不需要make，有修改需要make<br> )</strong><br> 8、修改自己的第一行代码，在框架运行<br> 安装 vim：<br> sudo apt-get install vim<br> 下载 android studio：http://www.android-studio.org/<br> 9、初始化仓库（因为压缩包只有代码，没有 git仓库，因为 git仓库空间太大，只需要对会修改地方建<br> 立仓库）<br> cd framework<br> git init<br> git add *<br> git commit -m “init first version”<br> 如过还没有设置 git邮箱等<br> git config --global user.email “test@example.com”<br> git config --global user.name “test”<br> 10、添加自己的一句 log打印在 framework上<br> cd framework/base<br> find -name Activity.java<br> vi ./core/java/android/app/Activity.java<br> 在添加 onCreate中添加一句 android.util.Log.i(“test1”, “Activity is onCreate”);<br> 回到根目录：<br> make<br> 或者单独编译单模块make framework，然后push framwork.jar(但是不适合模拟器，只适用于实体debug手机)<br> 11、加载源代码到 AndroidStudio<br> 执行以下四条命令：</p> 
<ol><li>“. build/envsetup.sh” (source可以用 .代替，即". build/envsetup.sh")</li><li>“lunch”，并选择要编译的项目</li><li>“make idegen -j4” (这里的 -j4表示用 4线程来编译，可以不加)</li><li>“development/tools/idegen/idegen.sh” (报错find: ‘out/target/product/generic_x86_64/root/d’: Permission denied没有关系不影响ipr和iml文件生成）</li></ol> 
<h3><a id="81aosp1213android_107"></a>学完8.1后，aosp12/13高版本android环境搭建：</h3> 
<p><a href="https://blog.csdn.net/learnframework/article/details/121345533">ubuntu 20.04 android 12/13<br> https://blog.csdn.net/learnframework/article/details/121345533</a></p> 
<p><a href="https://blog.csdn.net/learnframework/article/details/125269456">手把手教你aosp android 12 pixel 解锁oem 编译刷入大全<br> https://blog.csdn.net/learnframework/article/details/125269456</a></p> 
<p><a href="https://blog.csdn.net/learnframework/article/details/128438325">aosp 12/13/lineageos19.1 framework学习编译刷入小米手机，努比亚<br> https://blog.csdn.net/learnframework/article/details/128438325</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1ea3207cbe475a362063acc8c445abf7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数据结构 -最短路径dijkstra（迪杰斯特拉）算法讲解及代码实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5addb662a79afd858f46712480ec4bae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【嵌入式Linux】U-boot移植</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>