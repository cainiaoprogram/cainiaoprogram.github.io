<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pandas教程（非常详细）（第五部分） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Pandas教程（非常详细）（第五部分）" />
<meta property="og:description" content="接着Pandas教程（非常详细）（第四部分），继续讲述。
二十五、Pandas sample随机抽样 随机抽样，是统计学中常用的一种方法，它可以帮助我们从大量的数据中快速地构建出一组数据分析模型。在 Pandas 中，如果想要对数据集进行随机抽样，需要使用 sample() 函数。
sample() 函数的语法格式如下：
DataFrame.sample(n=None, frac=None, replace=False, weights=None, random_state=None, axis=None) 参数说明如下表所示：
参数名称参数说明n表示要抽取的行数。frac表示抽取的比例，比如 frac=0.5，代表抽取总体数据的50%。replace布尔值参数，表示是否以有放回抽样的方式进行选择，默认为 False，取出数据后不再放回。weights可选参数，代表每个样本的权重值，参数值是字符串或者数组。random_state可选参数，控制随机状态，默认为 None，表示随机数据不会重复；若为 1 表示会取得重复数据。axis表示在哪个方向上抽取数据(axis=1 表示列/axis=0 表示行)。 该函数返回与数据集类型相同的新对象，相当于 numpy.random.choice()。实例如下：
import pandas as pd dict = {&#39;name&#39;:[&#34;Jack&#34;, &#34;Tom&#34;, &#34;Helen&#34;, &#34;John&#34;],&#39;age&#39;: [28, 39, 34, 36],&#39;score&#39;:[98,92,91,89]} info = pd.DataFrame(dict) #默认随机选择两行 info.sample(n=2) #随机选择两列 info.sample(n=2,axis=1) 输出结果：
name age score
3 John 36 89
0 Jack 28 98
score name
0 98 Jack
1 92 Tom
2 91 Helen" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/aef5bdcb40a1b258d8acb60971448d16/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T23:15:06+08:00" />
<meta property="article:modified_time" content="2024-01-05T23:15:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Pandas教程（非常详细）（第五部分）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:justify;"><span style="color:#1c7892;"><strong>接着Pandas教程（非常详细）（第四部分），继续讲述。</strong></span></p> 
<h2 style="text-align:justify;">二十五、Pandas sample随机抽样</h2> 
<p style="text-align:justify;">随机抽样，是统计学中常用的一种方法，它可以帮助我们从大量的数据中快速地构建出一组数据分析模型。在 Pandas 中，如果想要对数据集进行随机抽样，需要使用 <strong><span style="background-color:#a2e043;">sample() 函数</span></strong>。<br><br> sample() 函数的语法格式如下：</p> 
<pre><code class="language-python">DataFrame.sample(n=None, frac=None, replace=False, weights=None, random_state=None, axis=None)</code></pre> 
<p style="text-align:justify;">参数说明如下表所示：</p> 
<table><tbody><tr><th style="text-align:justify;">参数名称</th><th style="text-align:justify;">参数说明</th></tr><tr><td style="text-align:justify;">n</td><td style="text-align:justify;">表示要抽取的行数。</td></tr><tr><td style="text-align:justify;">frac</td><td style="text-align:justify;">表示抽取的比例，比如 frac=0.5，代表抽取总体数据的50%。</td></tr><tr><td style="text-align:justify;">replace</td><td style="text-align:justify;">布尔值参数，表示是否以有放回抽样的方式进行选择，默认为 False，<strong>取出数据后不再放回。</strong></td></tr><tr><td style="text-align:justify;">weights</td><td style="text-align:justify;">可选参数，代表每个样本的权重值，参数值是字符串或者数组。</td></tr><tr><td style="text-align:justify;">random_state</td><td style="text-align:justify;">可选参数，控制随机状态，默认为 None，表示随机数据不会重复；<strong>若为 1 表示会取得重复数据。</strong></td></tr><tr><td style="text-align:justify;">axis</td><td style="text-align:justify;">表示在哪个方向上抽取数据(axis=1 表示列/axis=0 表示行)。</td></tr></tbody></table> 
<p style="text-align:justify;"><strong>该函数返回与数据集类型相同的新对象，相当于<span style="background-color:#a2e043;"> numpy.random.choice()</span>。</strong>实例如下：</p> 
<pre><code class="language-python">import pandas as pd
dict = {'name':["Jack", "Tom", "Helen", "John"],'age': [28, 39, 34, 36],'score':[98,92,91,89]}
info = pd.DataFrame(dict)
#默认随机选择两行
info.sample(n=2)
#随机选择两列
info.sample(n=2,axis=1)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">   name age score</p> 
 <p style="text-align:justify;">3 John   36    89</p> 
 <p style="text-align:justify;">0 Jack    28    98</p> 
 <p style="text-align:justify;"></p> 
 <p style="text-align:justify;">   score name</p> 
 <p style="text-align:justify;">0   98    Jack</p> 
 <p style="text-align:justify;">1   92    Tom</p> 
 <p style="text-align:justify;">2   91   Helen</p> 
 <p style="text-align:justify;">3   89    John</p> 
</blockquote> 
<p style="text-align:justify;">再来看一组示例：</p> 
<pre><code class="language-python">import pandas as pd
info = pd.DataFrame({'data1': [2, 6, 8, 0], 'data2': [2, 5, 0, 8], 'data3': [12, 2, 1, 8]}, index=['John', 'Parker', 'Smith', 'William'])
info
#随机抽取3个数据
info['data1'].sample(n=3)
#总体的50%
info.sample(frac=0.5, replace=True)
#data3序列为权重值，并且允许重复数据出现
info.sample(n=2, weights='data3', random_state=1)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">随机选择3行数据：</p> 
 <p style="text-align:justify;">William 0</p> 
 <p style="text-align:justify;">Smith 8</p> 
 <p style="text-align:justify;">Parker 6</p> 
 <p style="text-align:justify;">Name: data1, dtype: int64</p> 
 <p style="text-align:justify;"></p> 
 <p style="text-align:justify;">         data1 data2 data3</p> 
 <p style="text-align:justify;">John     2        2       12</p> 
 <p style="text-align:justify;">William 0        8        8</p> 
 <p style="text-align:justify;"></p> 
 <p style="text-align:justify;">          data1 data2 data3</p> 
 <p style="text-align:justify;">John       2       2      12</p> 
 <p style="text-align:justify;">William   0       8        8</p> 
</blockquote> 
<h2 style="text-align:justify;">二十六、Pandas resample数据重采样</h2> 
<p style="text-align:justify;">数据重采样是将时间序列从一个频率转换至另一个频率的过程，它主要有两种实现方式，分别是降采样和升采样，<strong>降采样指将高频率的数据转换为低频率，升采样则与其恰好相反，</strong>说明如下：</p> 
<table><tbody><tr><th style="text-align:center;">方法</th><th style="text-align:center;">说明</th></tr><tr><td style="text-align:justify;">降采样</td><td style="text-align:justify;">将高频率(间隔短)数据转换为低频率(间隔长)。</td></tr><tr><td style="text-align:justify;">升采样</td><td style="text-align:justify;">将低频率数据转换为高频率。</td></tr></tbody></table> 
<p style="text-align:justify;">Pandas 提供了<strong><span style="background-color:#a2e043;"> resample() 函数</span></strong>来实现数据的重采样。</p> 
<h3 style="text-align:justify;">1、降采样 resample()</h3> 
<p style="text-align:justify;">通过 <strong><span style="background-color:#a2e043;">resample() 函数</span></strong>完成数据的降采样，比如按天计数的频率转换为按月计数。</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
rng = pd.date_range('1/1/2021',periods=100,freq='D')
ts = pd.Series(np.random.randn(len(rng)),index=rng)
#降采样后并聚合
ts.resample('M').mean()</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">2021-01-31  0.210353</p> 
 <p style="text-align:justify;">2021-02-28 -0.058859</p> 
 <p style="text-align:justify;">2021-03-31 -0.182952</p> 
 <p style="text-align:justify;">2021-04-30  0.205254</p> 
 <p style="text-align:justify;">Freq: M, dtype: float64</p> 
</blockquote> 
<p style="text-align:justify;">如果您只想看到月份，那么您可以设置<strong><code><span style="background-color:#a2e043;">kind=period</span></code></strong>如下所示：</p> 
<pre><code class="language-python">ts.resample('M',kind='period').mean()</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">2021-01 -0.153121</p> 
 <p style="text-align:justify;">2021-02 0.136231</p> 
 <p style="text-align:justify;">2021-03 -0.238975</p> 
 <p style="text-align:justify;">2021-04 -0.309502</p> 
 <p style="text-align:justify;">Freq: M, dtype: float64</p> 
</blockquote> 
<h3 style="text-align:justify;">2、升采样 asfreq()</h3> 
<p style="text-align:justify;">升采样是将低频率（时间间隔）转换为高频率，示例如下：</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
#生成一份时间序列数据
rng = pd.date_range('1/1/2021', periods=20, freq='3D')
ts = pd.Series(np.random.randn(len(rng)), index=rng)
print(ts.head())
#使用asfreq()在原数据基础上实现频率转换
ts.resample('D').asfreq().head()</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>升采样前：</strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>2021-01-01    0.608716 </strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>2021-01-04    1.097451 </strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>2021-01-07   -1.280173 </strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>2021-01-10   -0.175065 </strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>2021-01-13    1.046831 </strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>Freq: 3D, dtype: float64 </strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>升采样后： </strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>2021-01-01    0.608716 </strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>2021-01-02         NaN </strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>2021-01-03         NaN</strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>2021-01-04    1.097451</strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>2021-01-05         NaN </strong></span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>Freq: D, dtype: float64</strong></span></p> 
</blockquote> 
<h3 style="text-align:justify;">3、频率转换 asfreq()</h3> 
<p style="text-align:justify;"><span style="color:#1c7892;"><strong><span style="background-color:#a2e043;">asfreq() 方法</span>不仅能够实现频率转换，还可以保留原频率对应的数值，同时它也可以单独使用</strong></span>，示例如下：</p> 
<pre><code class="language-python">index = pd.date_range('1/1/2021', periods=6, freq='T')
series = pd.Series([0.0, None, 2.0, 3.0,4.0,5.0], index=index)
df = pd.DataFrame({'s':series})
print(df.asfreq("45s"))</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">                                  num</p> 
 <p style="text-align:justify;">2021-01-01 00:00:00 0.0</p> 
 <p style="text-align:justify;">2021-01-01 00:00:45 NaN</p> 
 <p style="text-align:justify;">2021-01-01 00:01:30 NaN</p> 
 <p style="text-align:justify;">2021-01-01 00:02:15 NaN</p> 
 <p style="text-align:justify;">2021-01-01 00:03:00 3.0</p> 
 <p style="text-align:justify;">2021-01-01 00:03:45 NaN</p> 
 <p style="text-align:justify;">2021-01-01 00:04:30 NaN</p> 
</blockquote> 
<h3 style="text-align:justify;">4、插值处理</h3> 
<p style="text-align:justify;">从上述示例不难看出，升采样的结果会产生缺失值，那么<strong>就需要对缺失值进行处理</strong>，一般有以下几种处理方式：</p> 
<table><tbody><tr><th style="text-align:center;">方法</th><th style="text-align:center;">说明</th></tr><tr><td style="text-align:justify;">pad/ffill</td><td style="text-align:justify;">用<strong>前一个非缺失值</strong>去填充缺失值。</td></tr><tr><td style="text-align:justify;">backfill/bfill</td><td style="text-align:justify;">用<strong>后一个非缺失值</strong>去填充缺失值。</td></tr><tr><td style="text-align:justify;">interpolater('linear')</td><td style="text-align:justify;"><strong>线性插值方法</strong>。</td></tr><tr><td style="text-align:justify;">fillna(value)</td><td style="text-align:justify;"><strong>指定一个值</strong>去替换缺失值。</td></tr></tbody></table> 
<p style="text-align:justify;">下面使用插值方法处理 NaN 值，示例如下：</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
#创建时间序列数据
rng = pd.date_range('1/1/2021', periods=20, freq='3D')
ts = pd.Series(np.random.randn(len(rng)), index=rng)
print(ts.resample('D').asfreq().head())
#使用ffill处理缺失值
ts.resample('D').asfreq().ffill().head()</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">2021-01-01 0.555580</p> 
 <p style="text-align:justify;">2021-01-02 NaN</p> 
 <p style="text-align:justify;">2021-01-03 NaN</p> 
 <p style="text-align:justify;">2021-01-04 -0.079324</p> 
 <p style="text-align:justify;">2021-01-05 NaN</p> 
 <p style="text-align:justify;">Freq: D, dtype: float64</p> 
 <p style="text-align:justify;"></p> 
 <p style="text-align:justify;">#插值处理，注意对比</p> 
 <p style="text-align:justify;">2021-01-01 0.555580</p> 
 <p style="text-align:justify;">2021-01-02 0.555580</p> 
 <p style="text-align:justify;">2021-01-03 0.555580</p> 
 <p style="text-align:justify;">2021-01-04 -0.079324</p> 
 <p style="text-align:justify;">2021-01-05 -0.079324</p> 
 <p style="text-align:justify;">Freq: D, dtype: float64</p> 
</blockquote> 
<h2 style="text-align:justify;">二十七、Python Pandas分类对象</h2> 
<p style="text-align:justify;">通常情况下，数据集中会存在许多同一类别的信息，比如相同国家、相同行政编码、相同性别等，当这些相同类别的数据多次出现时，就会给数据处理增添许多麻烦，导致数据集变得臃肿，不能直观、清晰地展示数据。</p> 
<p style="text-align:justify;">针对上述问题，Pandas 提供了分类对象（Categorical Object），该对象能够实现有序排列、自动去重的功能，但是它不能执行运算。本节，我们了解一下分类对象的使用。</p> 
<h3 style="text-align:justify;">1、对象创建</h3> 
<p style="text-align:justify;">我们可以通过多种方式创建分类对象，下面介绍以下两种方法：</p> 
<h4 style="text-align:justify;">（1） 指定dtype创建</h4> 
<pre><code class="language-python">import pandas as pd
s = pd.Series(["a","b","c","a"], dtype="category")
print(s)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">0 a</p> 
 <p style="text-align:justify;">1 b</p> 
 <p style="text-align:justify;">2 c</p> 
 <p style="text-align:justify;">3 a</p> 
 <p style="text-align:justify;">dtype: <strong>category Categories (3, object)</strong>: [a, b, c]</p> 
</blockquote> 
<p style="text-align:justify;">通过上述示例，您可能会注意到，虽然传递给 Series 四个元素值，但是它的类别为 3，这是因为 a 的类别存在重复。</p> 
<h4 style="text-align:justify;">（2） pd.Categorical</h4> 
<p style="text-align:justify;">通过 Category  的构造函数，您可以创建一个类别对象。构造函数，如下所示：</p> 
<pre><code class="language-python">pandas.Categorical(values, categories, ordered)</code></pre> 
<p style="text-align:justify;">values：以列表的形式传参，表示要分类的值。<br> ordered：布尔值，默认为 False，若为 Ture，表示对分类的数据进行排序。<br> dtype：返回一个 category 类型，表示分类对象。<br><br> 示例如下：</p> 
<pre><code class="language-python">import pandas as pd
#自动按a、b、c分类
cat = pd.Categorical(['a', 'b', 'c', 'a', 'b', 'c'])
print(cat)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">[a, b, c, a, b, c]</p> 
 <p style="text-align:justify;"><strong>Categories (3, object):</strong> [a, b, c]</p> 
</blockquote> 
<p style="text-align:justify;">再看一组示例：</p> 
<pre><code class="language-python">import pandas as pd
cat=pd.Categorical(['a','b','c','a','b','c','d'], ['c', 'b', 'a'])
print(cat)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;"><span style="color:#fe2c24;"><strong>[a, b, c, a, b, c, NaN]</strong></span></p> 
 <p style="text-align:justify;">Categories (3, object): [c, b, a]</p> 
</blockquote> 
<p style="text-align:justify;">上述示例中，第二个参数值表示类别，当列表中不存在某一类别时，会自动将类别值设置为 NAN。<br><br> 通过指定<strong><code><span style="background-color:#a2e043;">ordered=True</span></code>来实现有序分类</strong>。示例如下：</p> 
<pre><code class="language-python">import pandas as pd
cat=pd.Categorical(['a','b','c','a','b','c','d'], ['c', 'b', 'a'],ordered=True)
print(cat)
#求最小值
print(cat.min())</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">[a, b, c, a, b, c, NaN]</p> 
 <p style="text-align:justify;">Categories (3, object):<strong><span style="color:#fe2c24;"> [c &lt; b &lt; a] c</span></strong></p> 
</blockquote> 
<h3 style="text-align:justify;">2、获取统计信息 describe()</h3> 
<p style="text-align:justify;">对已经分类的数据使用 <strong><span style="background-color:#a2e043;">describe() 方法</span></strong>，您会得到和数据统计相关的摘要信息。</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
cat = pd.Categorical(["a", "c", "c", np.nan], categories=["b", "a", "c"])
df = pd.DataFrame({"cat":cat, "s":["a", "c", "c", np.nan]})
print(df.describe())
print(df["cat"].describe())</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">         cat  s</p> 
 <p style="text-align:justify;">count  3   3</p> 
 <p style="text-align:justify;">unique 2  2</p> 
 <p style="text-align:justify;">top       c   c</p> 
 <p style="text-align:justify;">freq     2  2</p> 
 <p style="text-align:justify;"></p> 
 <p style="text-align:justify;">count    3</p> 
 <p style="text-align:justify;">unique  2</p> 
 <p style="text-align:justify;">top        c</p> 
 <p style="text-align:justify;">freq       2</p> 
 <p style="text-align:justify;">Name: cat, dtype: object</p> 
</blockquote> 
<h3 style="text-align:justify;">3、获取类别属性 obj.categories</h3> 
<p style="text-align:justify;">使用<strong><code><span style="background-color:#a2e043;">obj.categories</span></code></strong>命令可以获取对象的类别信息。示例如下：</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
s = pd.Categorical(["a", "c", "c", np.nan], categories=["b", "a", "c"])
print (s.categories)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">Index(['b', 'a', 'c'], dtype='object')</p> 
</blockquote> 
<p style="text-align:justify;">通过 <strong>obj.order 可以获取 order 指定的布尔值</strong>：</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
cat = pd.Categorical(["a", "c", "c", np.nan], categories=["b", "a", "c"])
#False表示未指定排序
print (cat.ordered)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<p style="text-align:justify;">False</p> 
<h3 style="text-align:justify;">4、重命名类别 <strong>Series.cat.categories</strong></h3> 
<p style="text-align:justify;">要想对类别实现重命名，可以通过<strong><span style="background-color:#a2e043;"> Series.cat.categories </span></strong>来实现的，示例如下：</p> 
<pre><code class="language-python">import pandas as pd
s = pd.Series(["a","b","c","a"], dtype="category")
#对类名重命名
s.cat.categories = ["Group %s" % g for g in s.cat.categories]
print(s.cat.categories)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">Index(['Group a', 'Group b', 'Group c'], dtype='object')</p> 
</blockquote> 
<h3 style="text-align:justify;">5、追加新类别 s.cat.add_categories()</h3> 
<p style="text-align:justify;">使用 <strong><span style="background-color:#a2e043;">s.cat.add_categories() 方法</span></strong>，可以追加新类别。</p> 
<pre><code class="language-python">import pandas as pd
s = pd.Series(["a","b","c","a"], dtype="category")
#追加新类别
s = s.cat.add_categories([5])
#查看现有类别
print(s.cat.categories)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">Index(['a', 'b', 'c', 5], dtype='object')</p> 
</blockquote> 
<h3 style="text-align:justify;">6、删除类别  remove_categories()</h3> 
<p style="text-align:justify;">使用 <strong><span style="background-color:#a2e043;">remove_categories() 方法</span></strong>，可以删除不需要的类别。示例如下：</p> 
<pre><code class="language-python">import pandas as pd
s = pd.Series(["a","b","c","a"], dtype="category")
#原序列
print(s)
#删除后序列
print(s.cat.remove_categories("a"))</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">0 a</p> 
 <p style="text-align:justify;">1 b</p> 
 <p style="text-align:justify;">2 c</p> 
 <p style="text-align:justify;">3 a</p> 
 <p style="text-align:justify;">dtype: category</p> 
 <p style="text-align:justify;">Categories (3, object): [a, b, c]</p> 
 <p style="text-align:justify;"></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;">0 NaN </span></p> 
 <p style="text-align:justify;">1 b</p> 
 <p style="text-align:justify;">2 c</p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;">3 NaN</span></p> 
 <p style="text-align:justify;">dtype: category</p> 
 <p style="text-align:justify;">Categories (2, object): [b, c]</p> 
</blockquote> 
<h3 style="text-align:justify;">7、分类对象比较</h3> 
<p style="text-align:justify;">在下述两种情况下，我们可以对分类对象进行比较：</p> 
<ul><li style="text-align:justify;">当两个类别对象长度相同时，可以进行比较运算；</li><li style="text-align:justify;">当两个类别的 ordered 均等于 True，并且类别相同时，可以进行比较运算，比如 ==，！=，&gt;，&gt;=，&lt; 和 &lt;=。</li></ul> 
<p style="text-align:justify;">示例如下：</p> 
<pre><code class="language-python">import pandas as pd
s1=['a','a','b','d','c']
#当满足两个类别长度相同时
ss0=pd.Categorical(s1,categories=['a','d','b','c'])
ss1 = pd.Categorical(s1)
print(ss0==ss1)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;"><span style="color:#fe2c24;">array([ True, True, True, True, True])</span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;">这里ss0输出：['a','a','b','d','c']，</span>Categories (4, object): ['a','d','b','c']</p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;">这里ss1输出：['a','a','b','d','c']，</span>Categories (4, object): ['a','b','d','c']</p> 
</blockquote> 
<p style="text-align:justify;">示例如下：</p> 
<pre><code class="language-python">import pandas as pd
s1=['a','a','b','d','c']
s2=['a','b','b','d','c']
#满足上述第二个条件，类别相同，并且ordered均为True
ss0=pd.Categorical(s1,categories=['a','d','b','c'],ordered=True)
ss1 = pd.Categorical(s2,categories=['a','d','b','c'],ordered=True)
print(ss0&lt;ss1)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">array([False, True, False, False, False])</p> 
</blockquote> 
<h2 style="text-align:justify;">二十八、Python Pandas绘图教程</h2> 
<p style="text-align:justify;">Pandas 在数据分析、数据可视化方面有着较为广泛的应用，Pandas 对 Matplotlib 绘图软件包的基础上单独封装了一个<strong><code><span style="background-color:#a2e043;">plot()</span></code><span style="background-color:#a2e043;">接口</span></strong>，通过调用该接口可以实现常用的绘图操作。本节我们深入讲解一下 Pandas 的绘图操作。<br><br> Pandas 之所以能够实现了数据可视化，主要利用了 Matplotlib 库的 plot() 方法，它对 plot() 方法做了简单的封装，因此您可以直接调用该接口。下面看一组简单的示例：</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
#创建包含时间序列的数据
df = pd.DataFrame(np.random.randn(8,4),index=pd.date_range('2/1/2020',periods=8), columns=list('ABCD'))
df.plot()</code></pre> 
<p style="text-align:justify;">输结果图，如下所示：</p> 
<p class="img-center"><img alt="pandas matplotlib" height="240" src="https://images2.imgbox.com/c3/4b/vakQ7hPr_o.png" width="333"></p> 
<p style="text-align:center;">图1：Pandas绘图</p> 
<p style="text-align:justify;">如上图所示，如果行索引中包含日期，Pandas 会自动调用 <strong><span style="background-color:#a2e043;">gct().autofmt_xdate() 来格式化 x 轴</span></strong>。<br><br> 除了使用默认的线条绘图外，您还可以使用其他绘图方式，如下所示：</p> 
<ul><li style="text-align:justify;">柱状图：bar() 或 barh()</li><li style="text-align:justify;">直方图：hist()</li><li style="text-align:justify;">箱状箱：box()</li><li style="text-align:justify;">区域图：area()</li><li style="text-align:justify;">散点图：scatter()</li></ul> 
<p style="text-align:justify;">通过<strong>关键字参数<code>kind</code></strong>可以把上述方法传递给 plot()。</p> 
<h3 style="text-align:justify;">1、柱状图 df.plot.bar()</h3> 
<p style="text-align:justify;">创建一个柱状图，如下所示：</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
df = pd.DataFrame(np.random.rand(10,4),columns=['a','b','c','d','e'])
#或使用df.plot(kind="bar")
df.plot.bar()</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<p class="img-center"><img alt="Pandas bar()" height="245" src="https://images2.imgbox.com/60/47/jfdPHwvw_o.png" width="372"></p> 
<p style="text-align:center;">图2：Pandas绘制柱状图</p> 
<p style="text-align:justify;">通过设置参数<strong><code><span style="background-color:#a2e043;">stacked=True</span></code></strong>可以生成柱状堆叠图，示例如下：</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
df = pd.DataFrame(np.random.rand(10,5),columns=['a','b','c','d','e'])
df.plot(kind="bar",stacked=True)
#或者使用df.plot.bar(stacked="True")</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<p class="img-center"><img alt="pandas bar()" height="242" src="https://images2.imgbox.com/01/6a/ytM9mddg_o.png" width="368"></p> 
<p style="text-align:center;">图3：Pandas绘制柱状图</p> 
<p style="text-align:justify;">如果要绘制水平柱状图，您可以使用以下方法：<strong><span style="background-color:#a2e043;">df.plot.barh()</span></strong></p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
df = pd.DataFrame(np.random.rand(10,4),columns=['a','b','c','d'])
print(df)
df.plot.barh(stacked=True)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<p class="img-center"><img alt="水平柱状图" height="248" src="https://images2.imgbox.com/d1/59/Zhe9aGSq_o.png" width="362"></p> 
<p style="text-align:center;">图4：水平柱状图</p> 
<h3 style="text-align:justify;">2、直方图 plot.hist()</h3> 
<p style="text-align:justify;"><strong><span style="background-color:#a2e043;"> plot.hist() </span></strong>可以实现绘制直方图，并且它还可以指定 bins（构成直方图的箱数）。</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
df = pd.DataFrame({'A':np.random.randn(100)+2,'B':np.random.randn(100),'C':
np.random.randn(100)-2}, columns=['A', 'B', 'C'])
print(df)
#指定箱数为15
df.plot.hist(bins=15)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<p class="img-center"><img alt="pandas直方图" height="248" src="https://images2.imgbox.com/f8/ab/iqLznmrz_o.png" width="382"></p> 
<p style="text-align:center;">图5：绘制直方图</p> 
<p style="text-align:justify;">给<strong>每一列数据都绘制一个直方图</strong>，需要使以下方法：<strong><span style="background-color:#a2e043;">df.diff().hist()</span></strong></p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
df = pd.DataFrame({'A':np.random.randn(100)+2,'B':np.random.randn(100),'C':
np.random.randn(100)-2,'D':np.random.randn(100)+3},columns=['A', 'B', 'C','D'])
#使用diff绘制
df.diff().hist(color="r",alpha=0.5,bins=15)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<p class="img-center"><img alt="直方图" height="264" src="https://images2.imgbox.com/d0/3c/hyssQ5O6_o.png" width="368"></p> 
<p style="text-align:center;">图6：直方图绘制</p> 
<h3 style="text-align:justify;">3、箱型图 box.plot()/boxplot()</h3> 
<p style="text-align:justify;">通过调用 <strong><span style="background-color:#a2e043;">Series.box.plot() 、DataFrame.box.plot() 或者 DataFrame.boxplot() 方法</span></strong>来绘制箱型图，它将每一列数据的分布情况，以可视化的图像展现出来。</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
df = pd.DataFrame(np.random.rand(10, 4), columns=['A', 'B', 'C', 'D'])
df.plot.box()</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<p class="img-center"><img alt="箱型图绘制" height="248" src="https://images2.imgbox.com/0d/5b/hCJqU0Nb_o.png" width="372"></p> 
<p style="text-align:center;">图7：绘制箱型图</p> 
<h3 style="text-align:justify;">4、区域图 plot.area()</h3> 
<p style="text-align:justify;">您可以使用 <strong><span style="background-color:#a2e043;">Series.plot.area() 或 DataFrame.plot.area() </span></strong>方法来绘制区域图。</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np

df = pd.DataFrame(np.random.rand(5, 4), columns=['a', 'b', 'c', 'd'])
df.plot.area()</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<p class="img-center"><img alt="绘制区域图" height="248" src="https://images2.imgbox.com/23/0c/MlReuoS1_o.png" width="372"></p> 
<p style="text-align:center;">图8：绘制区域图</p> 
<h3 style="text-align:justify;">5、散点图 plot.scatter()</h3> 
<p style="text-align:justify;">使用 <strong><span style="background-color:#a2e043;">DataFrame.plot.scatter() 方法</span></strong>来绘制散点图，如下所示：</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
df = pd.DataFrame(np.random.rand(30, 4), columns=['a', 'b', 'c', 'd'])
df.plot.scatter(x='a',y='b')</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<p class="img-center"><img alt="散点图" height="209" src="https://images2.imgbox.com/77/81/poyqAM70_o.png" width="308"></p> 
<p style="text-align:center;">图9：绘制散点图</p> 
<h3 style="text-align:justify;">6、饼状图 plot.pie()</h3> 
<p style="text-align:justify;">饼状图可以通过 <strong><span style="background-color:#a2e043;">DataFrame.plot.pie() 方法</span></strong>来绘制。示例如下：</p> 
<pre><code class="language-python">import pandas as pd
import numpy as np
df = pd.DataFrame(3 * np.random.rand(4), index=['go', 'java', 'c++', 'c'], columns=['L'])
df.plot.pie(subplots=True)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<p class="img-center"><img alt="饼状图" height="206" src="https://images2.imgbox.com/e1/5a/xVJ33JGR_o.png" width="218"></p> 
<p style="text-align:center;">图10：Pandas绘制饼状图</p> 
<h2 style="text-align:justify;">二十九、Python Pandas读取文件</h2> 
<p style="text-align:justify;">当使用 Pandas 做数据分析的时，需要读取事先准备好的数据集，这是做数据分析的第一步。Panda 提供了多种读取数据的方法：</p> 
<ul><li style="text-align:justify;">read_csv() 用于<strong>读取文本文件</strong></li><li style="text-align:justify;">read_json() 用于<strong>读取 json 文件</strong></li><li style="text-align:justify;">read_sql_query() <strong>读取 sql 语句的</strong></li></ul> 
<p style="text-align:justify;">本节将对上述方法做详细介绍。</p> 
<h3 style="text-align:justify;">1、CSV文件读取</h3> 
<p style="text-align:justify;"><strong>CSV 又称逗号分隔值文件</strong>，是一种简单的文件格式，以特定的结构来排列表格数据。 CSV 文件能够以纯文本形式存储表格数据，比如电子表格、数据库文件，并具有数据交换的通用格式。CSV 文件会在 Excel 文件中被打开，其行和列都定义了标准的数据格式。<br><br> 将 CSV 中的数据转换为 DataFrame 对象是非常便捷的。和一般文件读写不一样，它不需要你做打开文件、读取文件、关闭文件等操作。相反，您<strong>只需要一行代码就可以完成上述所有步骤，并将数据存储在 DataFrame 中。</strong><br><br> 下面进行实例演示，首先您需要创建一组数据，并将其保存为 CSV 格式，数据如下：</p> 
<blockquote> 
 <p style="text-align:justify;">Name,Hire Date,Salary,Leaves Remaining</p> 
 <p style="text-align:justify;">John Idle,08/15/14,50000.00,10</p> 
 <p style="text-align:justify;">Smith Gilliam,04/07/15,65000.00,6</p> 
 <p style="text-align:justify;">Parker Chapman,02/21/14,45000.00,7</p> 
 <p style="text-align:justify;">Jones Palin,10/14/13,70000.00,3</p> 
 <p style="text-align:justify;">Terry Gilliam,07/22/14,48000.00,9</p> 
 <p style="text-align:justify;">Michael Palin,06/28/13,66000.00,8</p> 
</blockquote> 
<p style="text-align:justify;">注意：将上述数据保存到<strong><code><span style="background-color:#a2e043;">.txt</span></code></strong>的文本文件中，然后<strong>将文件的扩展名后缀修改为 csv</strong>，即可完成 csv 文件的创建。<br><br> 接下来，我们使用下列代码读写数据： <strong><span style="background-color:#a2e043;">read_csv（）</span></strong></p> 
<pre><code class="language-python">import pandas
#仅仅一行代码就完成了数据读取，但是注意文件路径不要写错
df = pandas.read_csv('C:/Users/Administrator/Desktop/hrd.csv')
print(df)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">   Name                  Hire Date     Salary     Leaves Remaining</p> 
 <p style="text-align:justify;">0 John Idle              08/15/14      50000.0               10</p> 
 <p style="text-align:justify;">1 Smith Gilliam        04/07/15      65000.0                6</p> 
 <p style="text-align:justify;">2 Parker Chapman  02/21/14      45000.0                7</p> 
 <p style="text-align:justify;">3 Jones Palin          10/14/13      70000.0                 3</p> 
 <p style="text-align:justify;">4 Terry Gilliam         07/22/14      48000.0                 9</p> 
 <p style="text-align:justify;">5 Michael Palin        06/28/13      66000.0                 8</p> 
</blockquote> 
<p style="text-align:justify;">在下一节会对 read_csv() 函数做详细讲解。</p> 
<h3 style="text-align:justify;">2、json读取文件   <strong><span style="background-color:#a2e043;">read_csv（）</span></strong></h3> 
<p style="text-align:justify;">您可以通过下列方法来读取一个 json 文件，如下所示：</p> 
<pre><code class="language-python">import pandas as pd
data = pd.read_json('C:/Users/Administrator/Desktop/hrd.json')
print(data)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">   Name                  Hire Date     Salary     Leaves Remaining</p> 
 <p style="text-align:justify;">0 John Idle              08/15/14      50000.0               10</p> 
 <p style="text-align:justify;">1 Smith Gilliam        04/07/15      65000.0                6</p> 
 <p style="text-align:justify;">2 Parker Chapman  02/21/14      45000.0                7</p> 
 <p style="text-align:justify;">3 Jones Palin          10/14/13      70000.0                 3</p> 
 <p style="text-align:justify;">4 Terry Gilliam         07/22/14      48000.0                 9</p> 
 <p style="text-align:justify;">5 Michael Palin        06/28/13      66000.0                 8</p> 
</blockquote> 
<h3 style="text-align:justify;">3、SQL数据库读取</h3> 
<p style="text-align:justify;">如果想要从 SQL 数据库读取数据，首<strong>先</strong>您应该<strong>使用 Python 和数据库建立连接</strong>，然<strong>后将查询语句传递给 read_sql_query() 方法</strong>，下面做简单地演示：</p> 
<h4 style="text-align:justify;">（1） 安装pysqlite3模块</h4> 
<blockquote> 
 <p style="text-align:justify;">pip install pysqlite3</p> 
</blockquote> 
<h4 style="text-align:justify;">（2） 建立数据连接</h4> 
<pre><code class="language-python">import sqlite3 
con = sqlite3.connect("database.db")</code></pre> 
<h4 style="text-align:justify;">（3） 数据库读取数据</h4> 
<p style="text-align:justify;">在 SQLite 数据库中创建一张信息表，您可以随意添加一些信息，最后使用下列方法读取数据即可：</p> 
<pre><code class="language-python">#con参数指定操作数据库的引擎，可以指定，也可默认
df = pd.read_sql_query("SELECT * FROM information",con) </code></pre> 
<h2 style="text-align:justify;">三十、Pandas csv读写文件</h2> 
<p style="text-align:justify;">在<strong>二十九节</strong>中，我们讲解了多种用 Pandas 读写文件的方法。本节我们讲解如何应用这些方法 。<br><br> 我们知道，文件的读写操作属于计算机的 IO 操作，Pandas IO 操作提供了一些读取器函数，比如 <span style="color:#1c7892;"><strong>pd.read_csv()、pd.read_json 等，它们都返回一个 Pandas 对象。</strong></span><br><br> 在 Pandas 中<strong>用于读取文本的函数有两个，分别是： <span style="background-color:#a2e043;">read_csv() 和 read_table() </span></strong>，它们能够自动地将表格数据转换为 DataFrame 对象。其中 read_csv 的语法格式，如下：</p> 
<blockquote> 
 <p style="text-align:justify;">pandas.read_csv(filepath_or_buffer, sep=',', delimiter=None, header='infer',names=None, index_col=None, usecols=None)</p> 
</blockquote> 
<p style="text-align:justify;">下面，新建一个 txt 文件，并添加以下数据：</p> 
<blockquote> 
 <p style="text-align:justify;">ID,Name,Age,City,Salary</p> 
 <p style="text-align:justify;">1,Jack,28,Beijing,22000</p> 
 <p style="text-align:justify;">2,Lida,32,Shanghai,19000</p> 
 <p style="text-align:justify;">3,John,43,Shenzhen,12000</p> 
 <p style="text-align:justify;">4,Helen,38,Hengshui,3500</p> 
</blockquote> 
<p style="text-align:justify;">将<strong> txt 文件另存为 person.csv 文件格式，直接修改文件扩展名即可</strong>。接下来，对此文件进行操作。</p> 
<h3 style="text-align:justify;">1、read_csv()</h3> 
<p style="text-align:justify;">read_csv() 表示从 CSV 文件中读取数据，并创建 DataFrame 对象。</p> 
<pre><code class="language-python">import pandas as pd
#需要注意文件的路径
df=pd.read_csv("C:/Users/Administrator/Desktop/person.csv")
print (df)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">  ID Name Age City Salary</p> 
 <p style="text-align:justify;">0 1 Jack     28 Beijing 22000</p> 
 <p style="text-align:justify;">1 2 Lida      32 Shanghai 19000</p> 
 <p style="text-align:justify;">2 3 John     43 Shenzhen 12000</p> 
 <p style="text-align:justify;">3 4 Helen   38 Hengshui 3500</p> 
</blockquote> 
<h4 style="text-align:justify;">（1） 自定义索引</h4> 
<p style="text-align:justify;">在 CSV 文件中指定了一个列，然后<strong><span style="background-color:#a2e043;">使用</span><code><span style="background-color:#a2e043;">index_col</span></code></strong>可以实现自定义索引。</p> 
<pre><code class="language-python">import pandas as pd
df=pd.read_csv("C:/Users/Administrator/Desktop/person.csv",index_col=['ID'])
print(df)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">ID   Name   Age  City       Salary</p> 
 <p style="text-align:justify;">1    Jack     28 Beijing       22000</p> 
 <p style="text-align:justify;"> 2   Lida      32 Shanghai  19000</p> 
 <p style="text-align:justify;">3    John     43 Shenzhen 12000</p> 
 <p style="text-align:justify;">4    Helen   38 Hengshui    3500</p> 
</blockquote> 
<h4 style="text-align:justify;">（2） 查看每一列的dtype</h4> 
<pre><code class="language-python">import pandas as pd
#转换salary为float类型
df=pd.read_csv("C:/Users/Administrator/Desktop/person.csv",dtype={'Salary':np.float64})
print(df.dtypes)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">ID int64</p> 
 <p style="text-align:justify;">Name object</p> 
 <p style="text-align:justify;">Age int64</p> 
 <p style="text-align:justify;">City object</p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;">Salary float64 </span></p> 
 <p style="text-align:justify;">dtype: object</p> 
</blockquote> 
<p style="text-align:justify;">注意：默认情况下，Salary 列的 dtype 是 int 类型，但结果显示其为 float 类型，因为我们已经在上述代码中做了类型转换。</p> 
<h4 style="text-align:justify;">（3） 更改文件标头名</h4> 
<p style="text-align:justify;">使用 names 参数可以指定头文件的名称。</p> 
<pre><code class="language-python">import pandas as pd
df=pd.read_csv("C:/Users/Administrator/Desktop/person.csv",names=['a','b','c','d','e'])
print(df)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<p style="text-align:justify;"></p> 
<blockquote> 
 <p style="text-align:justify;">     a    b       c      d       e</p> 
 <p style="text-align:justify;">   ID Name Age City Salary</p> 
 <p style="text-align:justify;">0 1 Jack     28 Beijing 22000</p> 
 <p style="text-align:justify;">1 2 Lida      32 Shanghai 19000</p> 
 <p style="text-align:justify;">2 3 John     43 Shenzhen 12000</p> 
 <p style="text-align:justify;">3 4 Helen   38 Hengshui 3500</p> 
</blockquote> 
<p style="text-align:justify;">注意：<span style="color:#fe2c24;"><strong>文件标头名是附加的自定义名称</strong></span>，<strong>但是您会发现，原来的标头名（列标签名）并没有被删除，此时您可以使用<code><span style="background-color:#a2e043;">header</span></code><span style="background-color:#a2e043;">参数</span>来删除它。</strong><br><br> 通过传递标头所在行号实现删除，如下所示：</p> 
<pre><code class="language-python">import pandas as pd
df=pd.read_csv("C:/Users/Administrator/Desktop/person.csv",names=['a','b','c','d','e'],header=0)
print(df)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">   a    b         c       d         e</p> 
 <p style="text-align:justify;">0 1 Jack     28 Beijing 22000</p> 
 <p style="text-align:justify;">1 2 Lida      32 Shanghai 19000</p> 
 <p style="text-align:justify;">2 3 John     43 Shenzhen 12000</p> 
 <p style="text-align:justify;">3 4 Helen   38 Hengshui 3500</p> 
</blockquote> 
<p style="text-align:justify;">假如原标头名并没有定义在第一行，您也可以传递相应的行号来删除它。</p> 
<h4 style="text-align:justify;">（4） 跳过指定的行数</h4> 
<p style="text-align:justify;"><strong><code><span style="background-color:#a2e043;">skiprows</span></code><span style="background-color:#a2e043;">参数</span></strong>表示跳过指定的行数。</p> 
<pre><code class="language-python">import pandas as pd
df=pd.read_csv("C:/Users/Administrator/Desktop/person.csv",skiprows=2)
print(df)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;"><span style="color:#fe2c24;">   2 Lida      32 Shanghai 19000</span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;">0 3 John     43 Shenzhen 12000</span></p> 
 <p style="text-align:justify;"><span style="color:#fe2c24;">1 4 Helen   38 Hengshui    3500</span></p> 
</blockquote> 
<p style="text-align:justify;"><strong><span style="color:#fe2c24;">注意：包含标头所在行。</span></strong></p> 
<h3 style="text-align:justify;">2、to_csv()</h3> 
<p style="text-align:justify;">Pandas 提供的 to_csv() 函数<span style="color:#1c7892;"><strong>用于将 DataFrame 转换为 CSV 数据</strong></span>。如果想要把 CSV 数据写入文件，只需向函数传递一个文件对象即可。否则，CSV 数据将以字符串格式返回。<br><br> 下面看一组简单的示例：</p> 
<pre><code class="language-python">import pandas as pd
data = {'Name': ['Smith', 'Parker'], 'ID': [101, 102], 'Language': ['Python', 'JavaScript']}
info = pd.DataFrame(data)
print('DataFrame Values:\n', info)
#转换为csv数据
csv_data = info.to_csv()
print('\nCSV String Values:\n', csv_data)</code></pre> 
<p style="text-align:justify;">输出结果：</p> 
<blockquote> 
 <p style="text-align:justify;">DataFrame:</p> 
 <p style="text-align:justify;">    Name   ID   Language</p> 
 <p style="text-align:justify;">0 Smith   101   Python</p> 
 <p style="text-align:justify;">1 Parker 102   JavaScript</p> 
 <p style="text-align:justify;"></p> 
 <p style="text-align:justify;">csv数据:</p> 
 <p style="text-align:justify;">  ,Name,ID,Language</p> 
 <p style="text-align:justify;">0,Smith,101,Python</p> 
 <p style="text-align:justify;">1,Parker,102,JavaScript</p> 
</blockquote> 
<p style="text-align:justify;"><span style="color:#1c7892;"><strong>指定 CSV 文件输出时的分隔符，并将其保存在 pandas.csv 文件中</strong></span>，代码如下：</p> 
<pre><code class="language-python">import pandas as pd
#注意：pd.NaT表示null缺失数据
data = {'Name': ['Smith', 'Parker'], 'ID': [101, pd.NaT], 'Language': ['Python', 'JavaScript']}
info = pd.DataFrame(data)
csv_data = info.to_csv("C:/Users/Administrator/Desktop/pandas.csv",sep='|')</code></pre> 
<p style="text-align:justify;"><span style="color:#1c7892;"><strong>后续内容将在Pandas教程（非常详细）（第六部分），继续讲述。</strong></span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/221c9efa85a88bdf8133bdb58ebbbca9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">设计循环队列——oj题622</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/acd1de0edfe559f972bb2ca1d5d6f9c2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">用队列实现栈oj题——225</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>