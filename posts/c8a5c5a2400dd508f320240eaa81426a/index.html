<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Centos下用nodejs实现一个简单的web服务器 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Centos下用nodejs实现一个简单的web服务器" />
<meta property="og:description" content="WebRTC是音视频直播中最常用的一个框架，在使用的过程中，我们就需要实现一个服务器端。本文以nodejs实现一个服务器为例，讲述一下在centos下如何用nodejs实现一个简单的web服务器。
一、安装nodejs 在linux环境下安装nodejs有多重方式，主要分为安装包安装或者源码安装，这里为了方便，我们就直接用安装包的方式来安装。
1、用yum 命令安装 用以下命令来安装nodejs和依赖的npm服务
yum install -y nodejs yum install -y npm 有时候因为没有配置对应的yum源的原因，就会出现找不到nodejs的情况，这个时候找yum源比较麻烦，我们就直接下载安装包来安装
2、用下载安装包的方式来安装nodejs 首先，我们到nodejs的下载网站上下载的包(这里选择了16版本，最新版本需要升级glib，比较麻烦)，复制其下载链接
然后到linux命令行，用wget命令下载
wget https://nodejs.org/dist/v16.14.0/node-v16.14.0-linux-x64.tar.xz 如果没有wget命令，用
yum install -y wget 来安装即可。
等待安装完成以后，先后执行以下命令解压下载的安装包
node-v16.14.0-linux-x64 是我下载的包名，对应到自己下载的包即可
tar -xvf node-v16.14.0-linux-x64.tar.xz 将解压后的文件移动到/usr/local/下面(这样做的目的是为了防止后面误删)
mv node-v16.14.0-linux-x64 /usr/local/node-v16.14.0-linux-x64 部署bin文件(这样就可以在随时随地使用node命令)
ln -s /usr/local/node-v16.14.0-linux-x64/bin/node /usr/bin/node ln -s /usr/local/node-v16.14.0-linux-x64/bin/npm /usr/bin/npm 使用以下命令进行测试
node -v npm -v 结果如下：
二、开发最简单的一个web服务器 1、编写一个简单的js服务文件MyFirstServer.js,内容如下 var http = require(&#39;http&#39;); http.createServer(function (request, response) { // 发送 HTTP 头部 // HTTP 状态值: 200 : OK // 内容类型: text/plain。并用charset=UTF-8解决输出中文乱码 response." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c8a5c5a2400dd508f320240eaa81426a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-22T14:14:47+08:00" />
<meta property="article:modified_time" content="2023-12-22T14:14:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Centos下用nodejs实现一个简单的web服务器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>  WebRTC是音视频直播中最常用的一个框架，在使用的过程中，我们就需要实现一个服务器端。本文以nodejs实现一个服务器为例，讲述一下在centos下如何用nodejs实现一个简单的web服务器。</p> 
<h2><a id="nodejs_1"></a>一、安装nodejs</h2> 
<p>  在linux环境下安装nodejs有多重方式，主要分为安装包安装或者源码安装，这里为了方便，我们就直接用安装包的方式来安装。</p> 
<h3><a id="1yum__3"></a>1、用yum 命令安装</h3> 
<p>用以下命令来安装nodejs和依赖的npm服务</p> 
<pre><code class="prism language-shell">yum <span class="token function">install</span> <span class="token parameter variable">-y</span> nodejs 
yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">npm</span>
</code></pre> 
<p>有时候因为没有配置对应的yum源的原因，就会出现找不到nodejs的情况，这个时候找yum源比较麻烦，我们就直接下载安装包来安装</p> 
<h3><a id="2nodejs_11"></a>2、用下载安装包的方式来安装nodejs</h3> 
<p>首先，我们到<a href="https://nodejs.org/dist/v16.14.0/node-v16.14.0-linux-x64.tar.xz" rel="nofollow">nodejs的下载网站</a>上下载的包(这里选择了16版本，最新版本需要升级glib，比较麻烦)，复制其下载链接</p> 
<p>然后到linux命令行，用wget命令下载</p> 
<pre><code class="prism language-shell"><span class="token function">wget</span> https://nodejs.org/dist/v16.14.0/node-v16.14.0-linux-x64.tar.xz
</code></pre> 
<p>如果没有wget命令，用</p> 
<pre><code class="prism language-shell">yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">wget</span>
</code></pre> 
<p>来安装即可。<br> 等待安装完成以后，先后执行以下命令解压下载的安装包<br> <font color="red">node-v16.14.0-linux-x64 是我下载的包名，对应到自己下载的包即可</font></p> 
<pre><code class="prism language-shell"><span class="token function">tar</span> <span class="token parameter variable">-xvf</span> node-v16.14.0-linux-x64.tar.xz 
</code></pre> 
<p>将解压后的文件移动到/usr/local/下面(这样做的目的是为了防止后面误删)</p> 
<pre><code class="prism language-shell"><span class="token function">mv</span> node-v16.14.0-linux-x64 /usr/local/node-v16.14.0-linux-x64
</code></pre> 
<p>部署bin文件(这样就可以在随时随地使用node命令)</p> 
<pre><code class="prism language-shell"><span class="token function">ln</span> <span class="token parameter variable">-s</span>  /usr/local/node-v16.14.0-linux-x64/bin/node /usr/bin/node
<span class="token function">ln</span> <span class="token parameter variable">-s</span> /usr/local/node-v16.14.0-linux-x64/bin/npm /usr/bin/npm
</code></pre> 
<p>使用以下命令进行测试</p> 
<pre><code class="prism language-shell"><span class="token function">node</span> <span class="token parameter variable">-v</span>
<span class="token function">npm</span> <span class="token parameter variable">-v</span>
</code></pre> 
<p>结果如下：<br> <img src="https://images2.imgbox.com/3b/ce/nPq6Kef5_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web_45"></a>二、开发最简单的一个web服务器</h2> 
<h3><a id="1jsMyFirstServerjs_46"></a>1、编写一个简单的js服务文件MyFirstServer.js,内容如下</h3> 
<pre><code class="prism language-js"><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 发送 HTTP 头部</span>
    <span class="token comment">// HTTP 状态值: 200 : OK</span>
    <span class="token comment">// 内容类型: text/plain。并用charset=UTF-8解决输出中文乱码</span>
    response<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/plain; charset=UTF-8'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token comment">// 下句是发送响应数据</span>
    response<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'Hello World! 这是简单的web服务器测试。\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8888</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 终端打印如下信息</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server running at http://127.0.0.1:8888/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="2node_61"></a>2、在服务端用node命令启动服务器</h3> 
<pre><code class="prism language-shell"><span class="token function">node</span> MyFirstServer.js
</code></pre> 
<p>结果如下：<br> <img src="https://images2.imgbox.com/8a/2a/RatR8dFp_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3http19216886129888819216886129_67"></a>3、浏览器中输入地址http://192.168.86.129:8888/(192.168.86.129是我虚拟机的地址，改成部署服务器的地址即可)，即可看到信息：</h3> 
<p><img src="https://images2.imgbox.com/80/5d/YzcsiZHR_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="httpsweb_69"></a>三、开发一个简单的https的web服务器</h2> 
<h3><a id="1_Centos7httpshttpsblogcsdnnetu012559967articledetails134124633_71"></a>1、生成自签名证书，参考 《<a href="https://blog.csdn.net/u012559967/article/details/134124633">Centos7下生成https自签名证书</a>》</h3> 
<p>在js文件所在的目录新建一个cert的文件夹，将生成的server.key和server.pem复制到cert文件夹中</p> 
<h3><a id="2MyFirstHttpsServerjs__74"></a>2、编写MyFirstHttpsServer.js 文件，内容如下：</h3> 
<pre><code class="prism language-js"><span class="token string">'use strict'</span>

<span class="token keyword">var</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">key</span>  <span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./cert/server.key'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cert</span> <span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./cert/server.pem'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> https<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/plain'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'HTTPS:Hello World! https \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">443</span><span class="token punctuation">,</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<h3><a id="3nodejs_95"></a>3、启动nodejs服务器</h3> 
<pre><code class="prism language-shell"><span class="token function">node</span> MyFirstHttpsServer.js
</code></pre> 
<h3><a id="4https19216886129443_100"></a>4、在浏览器输入：https://192.168.86.129:443,在弹出的页面高级中选择仍然访问，页面如下：</h3> 
<p><img src="https://images2.imgbox.com/b2/6b/410pSJmW_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Web_102"></a>四、开发一个简单的Web服务器</h2> 
<p>上面我们写了一个简单的http和https的服务器，里面的内容是直接写死的，在实际的开发中这样肯定不行，这里我们就用发布的两个模块<strong>serve-index</strong>和<strong>express</strong>，来简单开发一个包含静态文件的web服务器。</p> 
<h3><a id="1MyFirstWebServerjs__105"></a>1、编写服务器的代码文件MyFirstWebServer.js ，内容如下</h3> 
<pre><code class="prism language-js"><span class="token string">'use strict'</span>

<span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">var</span> serveIndex <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'serve-index'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//设置一个app对象</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//映射静态文件</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">serveIndex</span><span class="token punctuation">(</span><span class="token string">'./public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'./public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//启动http服务</span>
<span class="token keyword">var</span> http_server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
http_server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//启动https服务</span>

<span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">key</span>  <span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./cert/server.key'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cert</span> <span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./cert/server.pem'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> https_server <span class="token operator">=</span> https<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
https_server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">443</span><span class="token punctuation">,</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="2_138"></a>2、准备静态文件</h3> 
<p>我们在当前目录下新建一个public文件夹，并在里面新建1111.txt和2222.txt两个文件，结构如下：<br> <img src="https://images2.imgbox.com/e2/0d/mkRnwpRU_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3serveindexexpress_141"></a>3、安装<strong>serve-index</strong>和<strong>express</strong>两个模块</h3> 
<p>用下面的命令安装两个模块</p> 
<pre><code class="prism language-shell"><span class="token function">npm</span> <span class="token function">install</span> express serve-index
</code></pre> 
<p><img src="https://images2.imgbox.com/e0/ce/tXXmnZO1_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_147"></a>4、启动服务器</h3> 
<p>用以下命令启动服务器</p> 
<pre><code class="prism language-shell"><span class="token function">node</span> MyFirstWebServer.js
</code></pre> 
<h3><a id="5_153"></a>5、用浏览器进行测试</h3> 
<p>用http和https方式打开服务器，内容如下<br> <img src="https://images2.imgbox.com/c7/95/FGM9NX4O_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f5/cb/cNqUY48S_o.png" alt="在这里插入图片描述"><br> 打开具体的文件能够访问到文件里面的内容<br> <img src="https://images2.imgbox.com/9d/47/FnRKqNPt_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><em><strong>后记</strong></em><br>   个人总结，欢迎转载、评论、批评指正</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e1614f5e00e0bfde5e1cb0ec200a1145/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Kafka-Eagle】EFAK告警配置与实践</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5cdb1361a977fb7fcf4c01fecaad47d9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">8086汇编程序：8254定时器/计数器实验</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>