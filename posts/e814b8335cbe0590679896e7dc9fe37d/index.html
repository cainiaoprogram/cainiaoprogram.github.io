<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android ImageView设置图片自适应的方法汇总 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android ImageView设置图片自适应的方法汇总" />
<meta property="og:description" content="1.ImageView 通过xml
网络上下载下来的图片自适应： android:adjustViewBounds=&#34;true&#34; //保持比例（其详细解释在下面）
&lt;ImageView android:id=&#34;@&#43;id/dynamic_item_image&#34; android:layout_width=&#34;wrap_content&#34; android:layout_height=&#34;wrap_content&#34; android:layout_gravity=&#34;top&#34; android:layout_marginTop=&#34;5dip&#34; android:adjustViewBounds=&#34;true&#34; android:background=&#34;@drawable/imageview_background&#34; /&gt; 另外，imageview_background.xml是给图片加一个边框
&lt;?xmlversion=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt; &lt;shape xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;&gt; &lt;solid android:color=&#34;@color/white&#34;/&gt; &lt;stroke android:width=&#34;2.0dip&#34; android:color=&#34;#99D9D9D9&#34; /&gt; &lt;cornersandroid:radius=&#34;2.0dip&#34; /&gt; &lt;paddingandroid:left=&#34;5.0dip&#34; android:top=&#34;5.0dip&#34; android:right=&#34;5.0dip&#34; android:bottom=&#34;5.0dip&#34; /&gt; &lt;/shape&gt; ImageView属性说明：
1、类概述 ：显示任意图像，例如图标。ImageView类可以加载各种来源的图片（如资源或图片库），需要计算图像的尺寸，比便它可以在其他布局中使用，并提供例如缩放和着色（渲染）各种显示选项
2、XML属性
属性名称
描述
android:adjustViewBounds
是否保持宽高比。需要与maxWidth、MaxHeight一起使用，否则单独使用没有效果。
android:cropToPadding
是否截取指定区域用空白代替。单独设置无效果，需要与scrollY一起使用，效果如下，实现代码见代码部分：
android:maxHeight
设置View的最大高度，单独使用无效，需要与setAdjustViewBounds一起使用。如果想设置图片固定大小，又想保持图片宽高比，需要如下设置：
1） 设置setAdjustViewBounds为true；
2） 设置maxWidth、MaxHeight；
3） 设置设置layout_width和layout_height为wrap_content。
android:maxWidth
设置View的最大宽度。同上。
android:scaleType
设置图片的填充方式。
matrix
0
用矩阵来绘图
fitXY
1
拉伸图片（不按比例）以填充View的宽高
layout_height:30px
layout_width:120px
fitStart
2
按比例拉伸图片，拉伸后图片的高度为View的高度，且显示在View的左边
fitCenter
3
按比例拉伸图片，拉伸后图片的高度为View的高度，且显示在View的中间" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e814b8335cbe0590679896e7dc9fe37d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-29T23:08:39+08:00" />
<meta property="article:modified_time" content="2021-03-29T23:08:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android ImageView设置图片自适应的方法汇总</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>1.ImageView 通过xml</strong></p> 
<p>网络上下载下来的图片自适应： <strong>android:adjustViewBounds="true"  //保持比例</strong>（其详细解释在下面）</p> 
<pre><code class="language-java">&lt;ImageView
    android:id="@+id/dynamic_item_image"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="top"
    android:layout_marginTop="5dip"
    android:adjustViewBounds="true"
    android:background="@drawable/imageview_background" /&gt;
</code></pre> 
<p>另外，imageview_background.xml是给图片加一个边框</p> 
<pre><code>&lt;?xmlversion="1.0" encoding="utf-8"?&gt;
&lt;shape   xmlns:android="http://schemas.android.com/apk/res/android"&gt;
    &lt;solid android:color="@color/white"/&gt;
    &lt;stroke android:width="2.0dip"
            android:color="#99D9D9D9" /&gt; 
    &lt;cornersandroid:radius="2.0dip" /&gt; 
    &lt;paddingandroid:left="5.0dip" 
        android:top="5.0dip" 
        android:right="5.0dip"
        android:bottom="5.0dip" /&gt;
&lt;/shape&gt;</code></pre> 
<p><strong>ImageView属性说明：</strong></p> 
<p>1、类概述 ：显示任意图像，例如图标。ImageView类可以加载各种来源的图片（如资源或图片库），需要计算图像的尺寸，比便它可以在其他布局中使用，并提供例如缩放和着色（渲染）各种显示选项</p> 
<p>2、XML属性</p> 
<table border="1" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>属性名称</p> </td><td> <p>描述</p> </td></tr><tr><td> <p><strong>android:adjustViewBounds</strong></p> </td><td> <p>是否保持宽高比。需要与maxWidth、MaxHeight一起使用，否则单独使用没有效果。</p> </td></tr><tr><td> <p><strong>android:cropToPadding</strong></p> </td><td> <p>是否截取指定区域用空白代替。单独设置无效果，需要与scrollY一起使用，效果如下，实现代码见代码部分：</p> <p> </p> </td></tr><tr><td> <p><strong>android:maxHeight</strong></p> </td><td> <p>设置View的最大高度，单独使用无效，需要与setAdjustViewBounds一起使用。如果想设置图片固定大小，又想保持图片宽高比，需要如下设置：</p> <p>1） 设置setAdjustViewBounds为true；</p> <p>2） 设置maxWidth、MaxHeight；</p> <p>3） 设置设置layout_width和layout_height为wrap_content。</p> </td></tr><tr><td> <p><strong>android:maxWidth</strong></p> </td><td> <p>设置View的最大宽度。同上。</p> </td></tr><tr><td> <p><strong>android:scaleType</strong></p> </td><td> <p>设置图片的填充方式。</p> 
    <table border="1" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>matrix</p> </td><td> <p>0</p> </td><td style="width:662px;"> <p>用矩阵来绘图</p> </td><td style="width:354px;"> <p> </p> </td></tr><tr><td> <p>fitXY</p> </td><td> <p>1</p> </td><td style="width:662px;"> <p>拉伸图片（不按比例）以填充View的宽高</p> <p><img alt="" src="https://images2.imgbox.com/e7/9f/aA5DV4HY_o.png"></p> <p> </p> </td><td rowspan="4" style="width:354px;"> <p>layout_height:30px</p> <p><br> layout_width:120px</p> </td></tr><tr><td> <p>fitStart</p> </td><td> <p>2</p> </td><td style="width:662px;"> <p>按比例拉伸图片，拉伸后图片的高度为View的高度，且显示在View的左边</p> <p><img alt="" src="https://images2.imgbox.com/99/11/PsDU0kMh_o.png"></p> <p> </p> </td></tr><tr><td> <p>fitCenter</p> </td><td> <p>3</p> </td><td style="width:662px;"> <p>按比例拉伸图片，拉伸后图片的高度为View的高度，且显示在View的中间</p> <p><img alt="" src="https://images2.imgbox.com/65/62/DzLXgL2g_o.png"></p> <p> </p> </td></tr><tr><td> <p>fitEnd</p> </td><td> <p>4</p> </td><td style="width:662px;"> <p>按比例拉伸图片，拉伸后图片的高度为View的高度，且显示在View的右边</p> <p><img alt="" src="https://images2.imgbox.com/29/ce/lzrX8VYI_o.png"></p> <p> </p> </td></tr><tr><td> <p>center</p> </td><td> <p>5</p> </td><td style="width:662px;"> <p>按原图大小显示图片，但图片宽高大于View的宽高时，截图图片中间部分显示<img alt="" name="image_operate_47831323230309109" src="https://images2.imgbox.com/74/c4/wh7BNnpr_o.png"></p> <p> </p> </td><td rowspan="3" style="width:354px;"> <p> </p> <p>layout_height:60px</p> <p><br> layout_width:80px</p> <p><br> padding:10px</p> <p> </p> </td></tr><tr><td> <p>centerCrop</p> </td><td> <p>6</p> </td><td style="width:662px;"> <p>按比例放大原图直至等于某边View的宽高显示。<img alt="" src="https://images2.imgbox.com/84/fc/LvV3JvRo_o.png"></p> <p> </p> </td></tr><tr><td> <p>centerInside</p> </td><td> <p>7</p> </td><td style="width:662px;"> <p>当原图宽高或等于View的宽高时，按原图大小居中显示；反之将原图缩放至View的宽高居中显示。<img alt="" name="image_operate_23631323230309957" src="https://images2.imgbox.com/1f/4b/AolC5XyJ_o.png"></p> <p>说明：<span style="color:#f33b45;">centerInside表示按比例缩放图片，使得图片长 (宽)的小于等于视图的相应维度</span></p> </td></tr></tbody></table></td></tr><tr><td> <p><strong>android:src</strong></p> </td><td> <p>设置View的drawable(如图片，也可以是颜色，但是需要指定View的大小)</p> </td></tr><tr><td> <p><strong>android:tint</strong></p> </td><td> <p>将图片渲染成指定的颜色。见下图：</p> <p><img alt="" src="https://images2.imgbox.com/db/a8/iAW0yNc1_o.png"> 左边为原图，右边为设置后的效果，见后面代码。</p> </td></tr></tbody></table> 
<p><span style="color:#f33b45;">注意：控制的图片为资源而不是背景，即android:src="@drawable/logo"，而非android:background="@drawable/logo"</span></p> 
<p>我就犯了这个低级错误，导致错怪人家scaleType不起作用。程序中动态加载图片也类似，如：应该imgView.setImageResource(R.drawable.* ); 而非imgView.setBackgroundResource(R.drawable.*);</p> 
<h4><strong>2.设置ImageView的属性：</strong></h4> 
<p>//宽度填满屏幕<br> android:layout_width=”match_parent”<br> android:scaleType=”fitXY”   //单独设置图片时，<span style="color:#f33b45;"><strong><em>慎用吧</em></strong></span>fitXY，容易图片变形（记得推荐位的图片变形啦）<br> android:layout_height=”wrap_content”<br><strong><span style="color:#f33b45;">//保持比例，一定要设置</span></strong><br> android:adjustViewBounds=”true”  //记得要配合上面的fitXY，一起使用。</p> 
<h4>3.重写View的onMeasure方法</h4> 
<p>ImageView宽度填满屏幕，高度自适应</p> 
<p>首先试一下默认的ImageView的效果，布局文件如下activity_main_2.xml</p> 
<pre><code class="language-java">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/root"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"&gt;
 
    &lt;ImageView
        android:id="@+id/image"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:src="@drawable/test"
        android:background="#FF0"/&gt;
 
&lt;/LinearLayout&gt;</code></pre> 
<p>MainActivity2.java</p> 
<pre><code class="language-java">public final class MainActivity2 extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main_activity_2);
 
        final ImageView imageView = (ImageView)findViewById(R.id.image);
        ViewTreeObserver vto2 = imageView.getViewTreeObserver();
        vto2.addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {
            @Override
            public void onGlobalLayout() {
                imageView.getViewTreeObserver().removeGlobalOnLayoutListener(this);
                Log.e("TestMeasure","w=" + imageView.getWidth() + "  h=" +         
                imageView.getHeight());
            }
        });
    }
}</code></pre> 
<p>test.jpg（正方形998*998）</p> 
<figure class="image"> 
 <img alt="正方形的测试图片" height="180" src="https://images2.imgbox.com/e1/78/5rCjm99l_o.jpg" width="180"> 
 <figcaption>
   标题 
 </figcaption> 
</figure> 
<p>可以看到，布局文件设置ImageView充满了屏幕，高度自适应，那运行后是我们需要的效果吗？</p> 
<p><img alt="" height="400" src="https://images2.imgbox.com/9c/91/ZJQ1fbbU_o.png" width="300"></p> 
<p>结果令人失望，虽然ImageView的宽度充满了屏幕，但是图片并没有填满屏幕，这是为什么呢？</p> 
<p>原因分析 ---》回头看看ActivityMain2.java中的打印我们看到了ImageView的宽高信息：</p> 
<blockquote> 
 <p>TestMeasure﹕ w=1080 h=998</p> 
</blockquote> 
<p>ImageView的高度是和图片的高度一样的998px。ImageView的宽度和屏幕宽度一样，1080px。</p> 
<p>由于ImageView默认的scaleType是fitCenter，将图片按比例扩大（或缩放）到视图的宽（或高）然后居中显示，所以图片宽度没有充满屏幕的原因就是，ImageView的高度不够，它限制了图片的放大倍数。<br> 那如何才能将ImageView的高度放大，使得图片宽度刚好充满屏幕呢？答案肯定在<span style="color:#f33b45;"><strong>onMeasure方法中,自定义View</strong></span>。</p> 
<pre><code class="language-java">public class ResizableImageView extends ImageView {
 
    public ResizableImageView(Context context) {
        super(context);
    }
 
    public ResizableImageView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }
 
    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec){
        Drawable d = getDrawable();
 
        if(d!=null){
            // ceil not round - avoid thin vertical gaps along the left/right edges
            int width = MeasureSpec.getSize(widthMeasureSpec);
            //高度根据使得图片的宽度充满屏幕计算而得
            int height = (int) Math.ceil((float) width * (float) d.getIntrinsicHeight() / (float) d.getIntrinsicWidth());
            setMeasuredDimension(width, height);
        }else{
            super.onMeasure(widthMeasureSpec, heightMeasureSpec);
        }
    }
 
}</code></pre> 
<p>使用自定义的控件显示图片</p> 
<pre><code class="language-java">&lt;LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/root"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"&gt;
 
    &lt;org.sample.ResizableImageView
        android:id="@+id/image"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:src="@drawable/test"
        android:background="#FF0"/&gt;
 
&lt;/LinearLayout&gt;</code></pre> 
<p>效果图<img alt="" height="400" src="https://images2.imgbox.com/29/8c/DEsrduE4_o.png" width="300"></p> 
<p>图片处理的相关知识参考：<a href="https://blog.csdn.net/jason_996/category_5801405.html?spm=1001.2014.3001.5482">https://blog.csdn.net/jason_996/category_5801405.html?spm=1001.2014.3001.5482</a><br> ————————————————<br> 版权声明：本文为CSDN博主「easion_zms」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br> 原文链接：https://blog.csdn.net/easion_zms/article/details/50263409</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/035e06bedbb27ddad4b5dde472f41f33/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Robotics Toolbox工具箱使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c784d2fce867c596e454262d396c7612/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一文读懂RPA是什么</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>