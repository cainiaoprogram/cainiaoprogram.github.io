<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用Java读取Excel文件，实现数据批处理 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用Java读取Excel文件，实现数据批处理" />
<meta property="og:description" content="一、前言 通过编程方式读取Excel数据能实现数据导入、批量处理、数据比对和更新等任务的自动化。这不仅可以提高工作效率还能减少手动处理的错误风险。此外读取的Excel数据可以与其他系统进行交互或集成，实现数据的无缝传输和共享，满足特定项目的需求。本文将从以下三个方面介绍如何通过Java读取Excel文件中的数据。
读取某个单元格中的数据读取指定单元格范围的数据读取Excel工作表中的数据 二、免费Java库 2.1 安装： 操作Excel的免费Java库为 Free Spire.XLS for Java。该免费库在读写 .xls 格式的 Excel 文档时，有每个文档 5 个工作表，每个工作表 200 行的限制。但在读写 .xlsx 格式的 Excel 文档时是没有任何限制。
我么可以从下面链接下载产品包后手动引入jar包或者直接通过Maven仓库安装也可。
下载免费Java Excel控件https://www.e-iceblue.cn/Downloads/Free-Spire-XLS-JAVA.html
2.2 读取Excel数据的核心方法： 要读取Excel单元格、单元格范围、或者Excel工作表中的数据，我们需要用到Free Spire.XLS for Java库提供的以下接口：
Workbook类、Worksheet类：分别用于代表 Excel 工作簿、和工作簿中的工作表。
CellRange类：用于代表某个特定的单元格或单元格区域。
Worksheet.getCellRange(String name) 方法：获取某个单元格或单元格区域并返回 CellRange 对象。
Worksheet.getAllocatedRange() 方法：获取工作表中包含数据的单元格区域，并返回 CellRange 对象。
CellRange.getValue() 方法：获取单元格中的数值或文本值。（如果单元格有公式，该方法会返回公式而不是公式计算的结果）
三、Java代码示例 3.1 使用Java 读取某个单元格的数据 import com.spire.xls.CellRange; import com.spire.xls.Workbook; import com.spire.xls.Worksheet; public class ReadData { public static void main(String[] args) { //创建Workbook对象 Workbook wb = new Workbook(); //加载Excel文件 wb." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a965e2485679f526832d69339dd18705/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-09T16:20:32+08:00" />
<meta property="article:modified_time" content="2024-01-09T16:20:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用Java读取Excel文件，实现数据批处理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 style="margin-left:0px;">一、前言</h3> 
<p style="margin-left:0;">通过编程方式读取Excel数据能实现数据导入、批量处理、数据比对和更新等任务的自动化。这不仅可以提高工作效率还能减少手动处理的错误风险。此外读取的Excel数据可以与其他系统进行交互或集成，实现数据的无缝传输和共享，满足特定项目的需求。本文将从以下三个方面介绍<strong>如何通过Java读取Excel文件中的数据</strong>。</p> 
<ul><li>读取某个单元格中的数据</li><li>读取指定单元格范围的数据</li><li>读取Excel工作表中的数据</li></ul> 
<p style="margin-left:0;"></p> 
<h3 style="margin-left:0px;">二、免费Java库</h3> 
<h4 style="margin-left:0px;">2.1 安装：</h4> 
<p style="margin-left:0;">操作Excel的免费Java库为 <a href="https://www.e-iceblue.cn/Introduce/Free-Spire-XLS-JAVA.html" rel="nofollow" title="Free Spire.XLS for Java">Free Spire.XLS for Java</a>。该免费库在读写 .xls 格式的 Excel 文档时，有每个文档 5 个工作表，每个工作表 200 行的限制。但在读写 .xlsx 格式的 Excel 文档时是没有任何限制。</p> 
<p style="margin-left:0;">我么可以从下面链接下载产品包后手动引入jar包或者直接通过Maven仓库安装也可。</p> 
<p style="margin-left:0;"><a class="has-card" href="https://www.e-iceblue.cn/Downloads/Free-Spire-XLS-JAVA.html" rel="nofollow" title="下载免费Java Excel控件"><span class="link-card-box"><span class="link-title">下载免费Java Excel控件</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/f9/16/eO79uhdw_o.png" alt="icon-default.png?t=N7T8">https://www.e-iceblue.cn/Downloads/Free-Spire-XLS-JAVA.html</span></span></a></p> 
<p style="margin-left:0;"></p> 
<h4 style="margin-left:0px;">2.2 读取Excel数据的核心方法：</h4> 
<p style="margin-left:0;">要读取Excel单元格、单元格范围、或者Excel工作表中的数据，我们需要用到Free Spire.XLS for Java库提供的以下接口：</p> 
<p style="margin-left:0;"><strong>Workbook</strong>类、<strong>Worksheet</strong>类：分别用于代表 Excel 工作簿、和工作簿中的工作表。</p> 
<p style="margin-left:0;"><strong>CellRange</strong>类：用于代表某个特定的单元格或单元格区域。</p> 
<p style="margin-left:0;"><strong>Worksheet.getCellRange(String name) </strong>方法：获取某个单元格或单元格区域并返回 CellRange 对象。</p> 
<p style="margin-left:0;"><strong>Worksheet.getAllocatedRange() </strong>方法：获取工作表中包含数据的单元格区域，并返回 CellRange 对象。</p> 
<p style="margin-left:0;"><span style="color:#be191c;"><strong>CellRange.getValue()</strong></span> 方法：获取单元格中的数值或文本值。（如果单元格有公式，该方法会返回公式而不是公式计算的结果）</p> 
<p style="margin-left:36pt;"></p> 
<h3 style="margin-left:0px;">三、Java代码示例</h3> 
<h4 style="margin-left:0px;">3.1 使用Java 读取某个单元格的数据</h4> 
<pre><code class="language-java">import com.spire.xls.CellRange;
import com.spire.xls.Workbook;
import com.spire.xls.Worksheet;

public class ReadData {

    public static void main(String[] args) {

        //创建Workbook对象
        Workbook wb = new Workbook();

        //加载Excel文件
        wb.loadFromFile("货物.xlsx");

        //获取第一张工作表
        Worksheet sheet = wb.getWorksheets().get(0);

        //获取指定单元格
        CellRange cell = sheet.getCellRange("A9");

        //获取单元格数据
        System.out.print("A9单元格的值为 " + cell.getValue());
    }
}
</code></pre> 
<p>输入文档：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ae/38/J8XHUsKk_o.jpg"></p> 
<p>读取A9单元格的值：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/4f/03/ghnonzZK_o.jpg"> </p> 
<h4></h4> 
<h4>3.1 使用Java 读取某个单元格范围中的数据 </h4> 
<pre><code class="language-java">import com.spire.xls.CellRange;
import com.spire.xls.Workbook;
import com.spire.xls.Worksheet;

public class ReadData {

    public static void main(String[] args) {

        //创建Workbook对象
        Workbook wb = new Workbook();

        //加载Excel文件
        wb.loadFromFile("货物.xlsx");

        //获取第一张工作表
        Worksheet sheet = wb.getWorksheets().get(0);

        //获取指定单元格区域
        CellRange range = sheet.getCellRange("A11:F15");

        //遍历行和列
        for (int i = 0; i &lt; range.getRows().length; i++) {
            
            for (int j = 0; j &lt; range.getColumnCount(); j++) {

                //获取单元格数据
                System.out.print(range.get(i + 11, j + 1).getValue() + "  ");
            }
            System.out.println();
        }
    }
}
</code></pre> 
<p> 读取Excel单元格范围返回结果：</p> 
<p><img alt="" src="https://images2.imgbox.com/9a/f3/S3H3OICy_o.jpg"></p> 
<p> </p> 
<h4>3.3 读取Excel工作表中的数据 </h4> 
<pre><code class="language-java">import com.spire.xls.CellRange;
import com.spire.xls.Workbook;
import com.spire.xls.Worksheet;

public class ReadData {

    public static void main(String[] args) {

        //创建Workbook对象
        Workbook wb = new Workbook();

        //加载Excel文件
        wb.loadFromFile("货物.xlsx");

        //获取第一张工作表
        Worksheet sheet = wb.getWorksheets().get(0);

        //获取工作表中的数据区域
        CellRange locatedRange = sheet.getAllocatedRange();

        //遍历行和列
        for (int i = 0; i &lt; locatedRange.getRows().length; i++) {

            for (int j = 0; j &lt; locatedRange.getColumnCount(); j++) {

                //获取单元格中的数据
                System.out.print(locatedRange.get(i + 1, j + 1).getValue() + "  ");
            }
            System.out.println();
        }
    }
}
</code></pre> 
<p>读取Excel工作表数据返回结果：</p> 
<p><img alt="" src="https://images2.imgbox.com/90/57/1xSq9r2e_o.jpg"> </p> 
<hr> 
<p>通过以上示例， 我们可以通过Java编程语言来读取Excel文件，实现Excel数据的批量处理。Free Spire.XLS for Java 这个免费库还支持生成、转换、编辑、打印Excel文件等各种功能，有兴趣可前往其<a href="https://www.e-iceblue.cn/spirexlsforjava/spire-xls-for-java-program-guide-content.html" rel="nofollow" title="中文教程">中文教程</a>进行了解。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9a222d3d3108871978e28c321af4dad6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL半同步复制</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/42965909f9db8ded26da4220ffabc0db/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python中的科学计算和数学建模</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>