<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL多表查询：SQL JOIN连接查询各种用法总结 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQL多表查询：SQL JOIN连接查询各种用法总结" />
<meta property="og:description" content="首先，设定两张表，作为下面例子的操作对象。
表1 学生信息表
表2 专业班级表
再来个SQL JOIN连接查询各种用法的大合影，先预热一下。
No.1 【INNER JOIN】内连接 这是最常用的，获取两个表中指定字段满足匹配关系的记录。
内连接通常有两种情况：
等值连接：查找两个表中连接字段相等的记录。
--查询每个学生的学号、姓名、籍贯、年龄、专业、班级 --涉及到student和major两张表，用共有字段“学号”为连接字段 --写法1：使用INNER JOIN SELECT A.学号,A.姓名,A.籍贯,A.年龄,B.专业,B.班级 FROM student A INNER JOIN major B ON A.学号=B.学号 --写法2：--省去了INNER，直接写JOIN，与INNER JOIN没有区别 SELECT A.学号,A.姓名,A.籍贯,A.年龄,B.专业,B.班级 FROM student A JOIN major B ON A.学号=B.学号 --写法3： --使用WHERE，已经逐渐被淘汰 SELECT A.学号,A.姓名,A.籍贯,A.年龄,B.专业,B.班级 FROM studentA,majorB WHERE A.学号=B.学号 --上面三种写法的结果都是一样的，推荐使用写法2 自身连接：就是和自己进行连接查询，给一张表取两个不同的别名，然后附上连接条件。
--要在学生表里查询与 HH 同龄且籍贯也相同的学生信息 SELECT B.学号,B.姓名,B.性别,B.籍贯,B.年龄 FROM student A JOIN student B ON A.年龄=B.年龄 AND A.籍贯=B.籍贯 AND A.姓名=&#39;HH&#39; No.2 【LEFT JOIN】左连接 获取左表中的所有记录，即使在右表没有对应匹配的记录。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/161dd8c0835a99e1df79a6bc3cba6d04/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-16T11:28:55+08:00" />
<meta property="article:modified_time" content="2023-01-16T11:28:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL多表查询：SQL JOIN连接查询各种用法总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <p style="text-align:null;">首先，设定两张表，作为下面例子的操作对象。</p> 
 <p style="text-align:null;">表1 学生信息表</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:357px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:46.4986%;height:0;"> 
    <img src="https://images2.imgbox.com/79/91/Dls6MhOj_o.jpg" style="margin-left:;display:block;width:357px;margin-top:-46.4986%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;">表2 专业班级表</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:357px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:46.218487%;height:0;"> 
    <img src="https://images2.imgbox.com/ae/5e/fODCxiL8_o.jpg" style="margin-left:;display:block;width:357px;margin-top:-46.218487%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;">再来个SQL JOIN连接查询各种用法的大合影，先预热一下。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:615px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:75.44716%;height:0;"> 
    <img src="https://images2.imgbox.com/44/af/zVq3Xv93_o.png" style="margin-left:;display:block;width:615px;margin-top:-75.44716%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">No.1 【INNER JOIN】内连接</span></h3> 
 <p style="text-align:null;">这是最常用的，获取两个表中指定字段满足匹配关系的记录。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:234px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:72.22222%;height:0;"> 
    <img src="https://images2.imgbox.com/6f/90/32g8DcY4_o.jpg" style="margin-left:;display:block;width:234px;margin-top:-72.22222%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;">内连接通常有两种情况：</p> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">等值连接：</span>查找两个表中连接字段相等的记录。</p> 
 <pre class="kdocs-sql"><code class="language-sql">--查询每个学生的学号、姓名、籍贯、年龄、专业、班级
--涉及到student和major两张表，用共有字段“学号”为连接字段

--写法1：使用INNER JOIN
SELECT A.学号,A.姓名,A.籍贯,A.年龄,B.专业,B.班级
FROM student A INNER JOIN major B 
ON A.学号=B.学号

--写法2：--省去了INNER，直接写JOIN，与INNER JOIN没有区别 
SELECT A.学号,A.姓名,A.籍贯,A.年龄,B.专业,B.班级
FROM student A JOIN major B 
ON A.学号=B.学号 

--写法3： --使用WHERE，已经逐渐被淘汰
SELECT A.学号,A.姓名,A.籍贯,A.年龄,B.专业,B.班级
FROM studentA,majorB
WHERE A.学号=B.学号 --上面三种写法的结果都是一样的，推荐使用写法2</code></pre> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:357px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:35.014008%;height:0;"> 
    <img src="https://images2.imgbox.com/0f/3e/HqMFLB7F_o.jpg" style="margin-left:;display:block;width:357px;margin-top:-35.014008%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">自身连接：</span>就是和自己进行连接查询，给一张表取两个不同的别名，然后附上连接条件。</p> 
 <pre class="kdocs-sql"><code class="language-sql">--要在学生表里查询与 HH 同龄且籍贯也相同的学生信息
SELECT B.学号,B.姓名,B.性别,B.籍贯,B.年龄 
FROM student A JOIN student B 
ON A.年龄=B.年龄 AND A.籍贯=B.籍贯 AND A.姓名='HH'</code></pre> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:357px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:17.927172%;height:0;"> 
    <img src="https://images2.imgbox.com/ff/db/ALWNq2Dp_o.jpg" style="margin-left:;display:block;width:357px;margin-top:-17.927172%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">No.2 【LEFT JOIN】左连接</span></h3> 
 <p style="text-align:null;">获取左表中的所有记录，即使在右表没有对应匹配的记录。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:227px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:72.2467%;height:0;"> 
    <img src="https://images2.imgbox.com/cb/52/BvfGuCFK_o.jpg" style="margin-left:;display:block;width:227px;margin-top:-72.2467%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <pre class="kdocs-sql"><code class="language-sql">--左连接：显示左表student所有记录，如右表中没有与之
--匹配的项则以NULL值代替。
SELECT A.学号,A.姓名,A.籍贯,A.年龄,B.专业,B.班级
FROM student A LEFT JOIN major B 
ON A.学号=B.学号</code></pre> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:357px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:47.338936%;height:0;"> 
    <img src="https://images2.imgbox.com/43/6c/ftjOgLvM_o.jpg" style="margin-left:;display:block;width:357px;margin-top:-47.338936%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">No.3 【RIGHT JOIN】右连接</span></h3> 
 <p style="text-align:null;">用于获取右表中的所有记录，即使左表没有对应匹配的记录。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:225px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:72.0%;height:0;"> 
    <img src="https://images2.imgbox.com/dc/ed/GPP7GcxQ_o.jpg" style="margin-left:;display:block;width:225px;margin-top:-72.0%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <pre class="kdocs-sql"><code class="language-sql">--右连接：显示右表major所有记录，如左表中没有与之
--匹配的项则以NULL值代替。
SELECT A.学号,A.姓名,A.籍贯,A.年龄,B.专业,B.班级 
FROM student ARIGHT JOIN major B 
ON A.学号=B.学号</code></pre> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:357px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:46.77871%;height:0;"> 
    <img src="https://images2.imgbox.com/d2/5c/mlTjZkXZ_o.jpg" style="margin-left:;display:block;width:357px;margin-top:-46.77871%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">No.4 【FULL JOIN】 完全连接</span></h3> 
 <p style="text-align:null;">返回两个表中的所有行。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:232px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:71.12069%;height:0;"> 
    <img src="https://images2.imgbox.com/a3/92/rbCoi5V2_o.jpg" style="margin-left:;display:block;width:232px;margin-top:-71.12069%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <pre class="kdocs-sql"><code class="language-sql">--完全连接：显示两张表的并集，如果其中一张表的记录
--在另一张表中没有匹配的行，则对应的数据项填充NULL
SELECT A.学号,A.姓名,A.籍贯,A.年龄,B.专业,B.班级
FROM student A FULL JOIN major B 
ON A.学号=B.学号</code></pre> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:357px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:59.383755%;height:0;"> 
    <img src="https://images2.imgbox.com/75/f5/xdcQb7Ly_o.jpg" style="margin-left:;display:block;width:357px;margin-top:-59.383755%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">No.5 【CROSS JOIN】交叉连接</span></h3> 
 <p style="text-align:null;">结果是笛卡尔积，就是第一个表的行数乘以第二个表的行数。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:243px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:61.728394%;height:0;"> 
    <img src="https://images2.imgbox.com/60/9a/IzPxIgvi_o.jpg" style="margin-left:;display:block;width:243px;margin-top:-61.728394%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <pre class="kdocs-sql"><code class="language-sql">--交叉连接：一张表中的数据依次取出分别与另一张表中的
--每条数据挨个组合，最后记录数量为两张表记录数的乘积

SELECT * 
FROM student CROSS JOIN major --本例student和major都为7条记录，所以结果为7*7=49条记录</code></pre> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:392px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:57.65306%;height:0;"> 
    <img src="https://images2.imgbox.com/53/fa/6LCMMbn0_o.jpg" style="margin-left:;display:block;width:392px;margin-top:-57.65306%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">No.6 延伸【Left Excluding JOIN】左表唯一</span></h3> 
 <p style="text-align:null;">返回左表有但右表没有关联数据的记录。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:238px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:70.588234%;height:0;"> 
    <img src="https://images2.imgbox.com/b8/95/WhQ48ND7_o.jpg" style="margin-left:;display:block;width:238px;margin-top:-70.588234%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <pre class="kdocs-sql"><code class="language-sql">--左表唯一：将右表B以及两张表交集的部分过滤掉，
--得到的记录是左表中唯一存在的。
SELECT A.学号,A.姓名,A.籍贯,A.年龄,B.专业,B.班级
FROM student A LEFT JOIN major B 
ON A.学号=B.学号
WHERE B.学号 IS NULL</code></pre> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:357px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:17.647058%;height:0;"> 
    <img src="https://images2.imgbox.com/63/57/grIBdhPN_o.jpg" style="margin-left:;display:block;width:357px;margin-top:-17.647058%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">No.7 延伸【Right Excluding JOIN】右表唯一</span></h3> 
 <p style="text-align:null;">返回右表有但左表没有关联数据的记录。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:239px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:68.200836%;height:0;"> 
    <img src="https://images2.imgbox.com/2a/2b/DDUF3IH2_o.jpg" style="margin-left:;display:block;width:239px;margin-top:-68.200836%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <pre class="kdocs-sql"><code class="language-sql">--右表唯一：将左表A以及两张表交集的部分过滤掉，
--得到的记录是右表中唯一存在的。
SELECT A.学号,A.姓名,A.籍贯,A.年龄,B.专业,B.班级
FROM student A RIGHT JOIN major B
ON A.学号=B.学号 
WHERE A.学号 IS NULL</code></pre> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:357px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:17.927172%;height:0;"> 
    <img src="https://images2.imgbox.com/61/85/euIU45Rj_o.jpg" style="margin-left:;display:block;width:357px;margin-top:-17.927172%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">No.8 延伸【Outer Excluding JOIN】非交集连接</span></h3> 
 <p style="text-align:null;">返回左表和右表里没有相互关联的记录。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:230px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:78.695656%;height:0;"> 
    <img src="https://images2.imgbox.com/ce/48/Qt0WoQCS_o.jpg" style="margin-left:;display:block;width:230px;margin-top:-78.695656%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <pre class="kdocs-sql"><code class="language-sql">--非交集连接：查找两张表中没有关联的记录项。
SELECT A.学号,A.姓名,A.籍贯,A.年龄,B.专业,B.班级 
FROM student A FULL JOIN major B 
ON A.学号=B.学号
WHERE A.学号 IS NULL OR B.学号 IS NULL</code></pre> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:357px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:29.691877%;height:0;"> 
    <img src="https://images2.imgbox.com/48/fe/OREYGd8q_o.jpg" style="margin-left:;display:block;width:357px;margin-top:-29.691877%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">最后</span></h3> 
 <p style="text-align:null;">谈及 SQL 里的各种 JOIN 之间的区别时，被广为引用的是 CodeProject 上C.L. Moffatt的文章, 本文也有所参考，感兴趣的小伙伴可以去看一下。</p> 
 <p style="text-align:null;"><a class="kdocs-link" style="color:#0A6CFF;" href="https://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins" rel="nofollow noopener noreferrer" target="_blank">https://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins</a></p> 
 <p style="text-align:null;"></p> 
 <p style="text-align:null;"></p> 
 <p style=""></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5e3f3b8e055ea2a857c3cfa447b04d61/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">NumberFormatException: For input string的解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2ac4b8725a441f24f3af256e80d8db5b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">to_hdf提示：ImportError: Missing optional dependency ‘tables‘. Use pip or conda to install tables.</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>