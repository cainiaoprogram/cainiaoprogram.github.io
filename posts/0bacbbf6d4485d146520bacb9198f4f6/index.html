<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于ESP32-CAM的RSTP协议网络摄像头 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于ESP32-CAM的RSTP协议网络摄像头" />
<meta property="og:description" content="本次分享的程序是使用ESP32-CAM进行图像采集并将图像以RTSP协议进行无线传输。在同网络的PC上使用软件对摄像头的图像进行拉取观看。 开发环境：Arduino。
程序语言：C语言。
ESP32-CAM：
ESP32-CAM是安信可最新发布小尺寸的摄像头模组。该模块可以作为最小系统独立工作，尺寸仅为27*40.5*4.5mm，深度睡眠电流最低达到6mA。ESP32-CAM可广泛应用于各种物联网场合，适用于家庭智能设备、工业无线控制、无线监控、QR无线识别，无线定位系统信号以及其它物联网应用，是物联网应用的理想解决方案。ESP32-CAM采用DIP封装，直接插上底板即可使用，实现产品的快速生产，为客户提供高可靠性的连接方式，方便应用于各种物联网硬件终端场合。 体积超小的802.11b/g/n Wi-Fi &#43; BT/BLE SoC模块 ESP32 CAM
产品特性
采用低功耗双核32位CPU，可作应用处理器
主频高达240MHz，运算能力高达 600 DMIPS
内置 520 KB SRAM，外置8MB PSRAM
支持UART/SPI/I2C/PWM/ADC/DAC等接口
支持OV2640和OV7670摄像头，内置闪光灯
支持图片WiFI上传
支持TF卡
支持多种休眠模式。
内嵌Lwip和FreeRTOS。
支持 STA/AP/STA&#43;AP 工作模式。
支持 Smart Config/AirKiss 一键配网。
支持二次开发。
RTSP协议：
Real Time Streaming Protocol，RFC2326，实时流传输协议，RTSP是 TCP/IP 协议体系中的一个应用层协议，该协议定义了一对多应用程序如何有效地通过 IP 网络传送多媒体数据。RTSP在体系结构上位于RTP和RTCP之上，它使用TCP或UDP完成数据传输。HTTP与RTSP相比，HTTP传送HTML，而RTSP传送的是多媒体数据。 RTSP是基于文本的协议，采用ISO10646字符集，使用UTF-8编码方案。行以CRLF中断，包括消息类型、消息头、消息体和消息长。但接收者本身可将CR和LF解释成行终止符。基于文本的协议使其以自描述方式增加可选参数更容易，接口中采用SDP作为描述语言。 本文介绍的方法使用方法是基于Arduino开发环境实现的。用到的开源库名称为：Micro-RTSP。库文件可以在github上搜索到，代码资源也上传到网盘，文末有相应的获取方式。 将Micro-RTSP-master库添加到Arduino软件中。 Micro-RTSP Arduino库
安装成功后，在第三方库示例中就可以找到例程。
库示例
例程打开以后首先需要在wifikeys.h文件中设置一下WiFi名称和WiFi密码。
设置WIFI和密码
然后需要修改宏定义。第一个宏定义是OLED显示器，如果你的ESP32 CAM有I2C接口OLED显示器，可以打开这个宏定义，并设置对应的引脚这样就可以使用显示器显示对应的输出信息；第二个宏定义是接入点模式，这种模式下ESP32会作为接入点，创建一个WIFI；第三个宏定义是使能web服务器，使能web服务器后可以在浏览器访问ESP32的IP地址就可以实时获取其图像信息；第四个是使能RTSP服务器，使能后即可通过RTSP端口获取到图像信息。可以根据需要开启对应的宏定义。 修改完宏定义信息后，还需要根据ESP32 CAM的硬件信息修改下面的配置，我这里使用的是安信可生产的ESP32 CAM，修改对应的配置信息即可。 硬件适配
修改完成后即可上传，上传成功后可以通过串口或路由器配置界面查看EPS32 CAM联网后的IP。然后打开VLC播放器。
VLC
依次选择“媒体”-&gt;“打开网络串流”。然后输入rtsp://“IP地址”:8554/mjpeg/2。最后点击“播放”，等待连接成功后就可以显示出摄像头图像。
RTSP码流地址" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0bacbbf6d4485d146520bacb9198f4f6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-29T11:17:38+08:00" />
<meta property="article:modified_time" content="2022-12-29T11:17:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于ESP32-CAM的RSTP协议网络摄像头</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code>    本次分享的程序是使用ESP32-CAM进行图像采集并将图像以RTSP协议进行无线传输。在同网络的PC上使用软件对摄像头的图像进行拉取观看。
</code></pre> 
<p>开发环境：Arduino。</p> 
<p>程序语言：C语言。</p> 
<p>ESP32-CAM：</p> 
<pre><code>    ESP32-CAM是安信可最新发布小尺寸的摄像头模组。该模块可以作为最小系统独立工作，尺寸仅为27*40.5*4.5mm，深度睡眠电流最低达到6mA。ESP32-CAM可广泛应用于各种物联网场合，适用于家庭智能设备、工业无线控制、无线监控、QR无线识别，无线定位系统信号以及其它物联网应用，是物联网应用的理想解决方案。ESP32-CAM采用DIP封装，直接插上底板即可使用，实现产品的快速生产，为客户提供高可靠性的连接方式，方便应用于各种物联网硬件终端场合。

    体积超小的802.11b/g/n Wi-Fi + BT/BLE SoC模块
</code></pre> 
<p><img src="https://images2.imgbox.com/2c/43/Y4moNrt9_o.png" alt="在这里插入图片描述"><br> ESP32 CAM<br> 产品特性</p> 
<p>采用低功耗双核32位CPU，可作应用处理器</p> 
<p>主频高达240MHz，运算能力高达 600 DMIPS</p> 
<p>内置 520 KB SRAM，外置8MB PSRAM</p> 
<p>支持UART/SPI/I2C/PWM/ADC/DAC等接口</p> 
<p>支持OV2640和OV7670摄像头，内置闪光灯</p> 
<p>支持图片WiFI上传</p> 
<p>支持TF卡</p> 
<p>支持多种休眠模式。</p> 
<p>内嵌Lwip和FreeRTOS。</p> 
<p>支持 STA/AP/STA+AP 工作模式。</p> 
<p>支持 Smart Config/AirKiss 一键配网。</p> 
<p>支持二次开发。</p> 
<p>RTSP协议：</p> 
<pre><code>    Real Time Streaming Protocol，RFC2326，实时流传输协议，RTSP是 TCP/IP 协议体系中的一个应用层协议，该协议定义了一对多应用程序如何有效地通过 IP 网络传送多媒体数据。RTSP在体系结构上位于RTP和RTCP之上，它使用TCP或UDP完成数据传输。HTTP与RTSP相比，HTTP传送HTML，而RTSP传送的是多媒体数据。 
</code></pre> 
<p><img src="https://images2.imgbox.com/08/4a/UynxRQpH_o.png" alt="在这里插入图片描述"></p> 
<pre><code>    RTSP是基于文本的协议，采用ISO10646字符集，使用UTF-8编码方案。行以CRLF中断，包括消息类型、消息头、消息体和消息长。但接收者本身可将CR和LF解释成行终止符。基于文本的协议使其以自描述方式增加可选参数更容易，接口中采用SDP作为描述语言。


    本文介绍的方法使用方法是基于Arduino开发环境实现的。用到的开源库名称为：Micro-RTSP。库文件可以在github上搜索到，代码资源也上传到网盘，文末有相应的获取方式。

    将Micro-RTSP-master库添加到Arduino软件中。
</code></pre> 
<p><img src="https://images2.imgbox.com/39/0d/2R4sLN73_o.png" alt="在这里插入图片描述"><br> Micro-RTSP Arduino库<br> 安装成功后，在第三方库示例中就可以找到例程。<br> <img src="https://images2.imgbox.com/d4/d2/jC0AGp21_o.png" alt=""><br> 库示例<br> 例程打开以后首先需要在wifikeys.h文件中设置一下WiFi名称和WiFi密码。<br> <img src="https://images2.imgbox.com/ee/90/CmR5h0oh_o.png" alt="在这里插设置WIFI和密码入图片描述"><br> 设置WIFI和密码</p> 
<pre><code>    然后需要修改宏定义。第一个宏定义是OLED显示器，如果你的ESP32 CAM有I2C接口OLED显示器，可以打开这个宏定义，并设置对应的引脚这样就可以使用显示器显示对应的输出信息；第二个宏定义是接入点模式，这种模式下ESP32会作为接入点，创建一个WIFI；第三个宏定义是使能web服务器，使能web服务器后可以在浏览器访问ESP32的IP地址就可以实时获取其图像信息；第四个是使能RTSP服务器，使能后即可通过RTSP端口获取到图像信息。可以根据需要开启对应的宏定义。
</code></pre> 
<p><img src="https://images2.imgbox.com/1f/a0/7bm93h4j_o.png" alt="宏定义"></p> 
<pre><code>    修改完宏定义信息后，还需要根据ESP32 CAM的硬件信息修改下面的配置，我这里使用的是安信可生产的ESP32 CAM，修改对应的配置信息即可。
</code></pre> 
<p><img src="https://images2.imgbox.com/9e/87/zlrUheC3_o.png" alt="在这里插入图片描述"><br> 硬件适配<br> 修改完成后即可上传，上传成功后可以通过串口或路由器配置界面查看EPS32 CAM联网后的IP。然后打开VLC播放器。<br> <img src="https://images2.imgbox.com/91/45/LajbDuWZ_o.png" alt="在这里插入图片描述"><br> VLC<br> 依次选择“媒体”-&gt;“打开网络串流”。然后输入rtsp://“IP地址”:8554/mjpeg/2。最后点击“播放”，等待连接成功后就可以显示出摄像头图像。<br> <img src="https://images2.imgbox.com/a4/36/TSlckMWX_o.png" alt="在这里插入图片描述"><br> RTSP码流地址</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4b19df67773be46435a208c1c3212882/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">UG/NX二次开发Siemens官方NXOPEN实例解析—2.1 AssemblyViewer（树列表）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f7542f06c81f780d5b0de4b038047d8b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Cadence17.4操作经验</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>