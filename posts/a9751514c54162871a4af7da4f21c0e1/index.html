<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习（四） -- 模型评估（4） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习（四） -- 模型评估（4）" />
<meta property="og:description" content="系列文章目录 机器学习（一） -- 概述
机器学习（二） -- 数据预处理（1-3）
机器学习（三） -- 特征工程（1-2）
机器学习（四） -- 模型评估（1-4）
未完待续……
目录
机器学习（四） -- 模型评估（1）
机器学习（四） -- 模型评估（2）
机器学习（四） -- 模型评估（3）
---
目录
系列文章目录
前言
四、 聚类模型评估指标
1、外部指标
1.1、兰德指数（RI，Rand index）
1.1.1、调整兰德指数（Adjusted Rand index）
1.2、基于互信息的分数（MI，Mutual Information-based Score）
1.2.1、标准化互信息（NMI，Normalized Mutual Information）
1.2.2、调整互信息（AMI，Adjusted mutual information）
1.3、同质性（Homogeneity Score）和完整性（Completeness Score）以及其调和平均（V-measure）
1.3.1、同质性（Homogeneity Score）
1.3.2、完整性（Completeness Score）
1.3.3、V-measure
1.4、Fowlkes-Mallows Scores（FMI）
2、内部指标
2.1、轮廓系数（Silhouette Coefficient）
2.2、Calinski-Harabaz指数（Calinski-Harabaz Index，也称Variance Ratio Criterion）
2.3、戴维森堡丁指数（DBI，Davies-Bouldin Index）
3、总结
前言 tips：这里只是总结，不是教程哈。
“***”开头的是给好奇心重的宝宝看的，其实不太重要可以跳过。
此处以下所有内容均为暂定，因为我还没找到一个好的，让小白（我自己）也能容易理解（更系统、嗯应该是宏观）的讲解顺序与方式。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a9751514c54162871a4af7da4f21c0e1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-08T19:55:58+08:00" />
<meta property="article:modified_time" content="2024-01-08T19:55:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习（四） -- 模型评估（4）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 id="%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95">系列文章目录</h2> 
<p><a href="https://blog.csdn.net/zqx1473/article/details/135242730" title="机器学习（一） -- 概述">机器学习（一） -- 概述</a></p> 
<p><a href="https://blog.csdn.net/zqx1473/article/details/135280575" title="机器学习（二） -- 数据预处理（1-3）">机器学习（二） -- 数据预处理（1-3）</a></p> 
<p><a href="https://blog.csdn.net/zqx1473/article/details/135307321" title="机器学习（三） -- 特征工程（1-2）">机器学习（三） -- 特征工程（1-2）</a></p> 
<p><a href="https://blog.csdn.net/zqx1473/article/details/135347196" title="机器学习（四） -- 模型评估（1-4）">机器学习（四） -- 模型评估（1-4）</a></p> 
<p></p> 
<p>未完待续……</p> 
<hr> 
<p id="main-toc"><strong>目录</strong></p> 
<p><a href="https://blog.csdn.net/zqx1473/article/details/135347196" title="机器学习（四） -- 模型评估（1）">机器学习（四） -- 模型评估（1）</a></p> 
<p><a href="https://blog.csdn.net/zqx1473/article/details/135371241" title="机器学习（四） -- 模型评估（2）">机器学习（四） -- 模型评估（2）</a></p> 
<p><a href="https://blog.csdn.net/zqx1473/article/details/135397581" title="机器学习（四） -- 模型评估（3）">机器学习（四） -- 模型评估（3）</a></p> 
<p><strong>---</strong></p> 
<p id="%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95-toc" style="margin-left:0px;"></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95-toc" style="margin-left:0px;"><a href="#%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95" rel="nofollow">系列文章目录</a></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="%E5%9B%9B%E3%80%81%20%E8%81%9A%E7%B1%BB%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%20%E8%81%9A%E7%B1%BB%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" rel="nofollow">四、 聚类模型评估指标</a></p> 
<p id="1%E3%80%81%E5%A4%96%E9%83%A8%E6%8C%87%E6%A0%87-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E5%A4%96%E9%83%A8%E6%8C%87%E6%A0%87" rel="nofollow">1、外部指标</a></p> 
<p id="1.1%E3%80%81%E5%85%B0%E5%BE%B7%E6%8C%87%E6%95%B0%EF%BC%88RI%EF%BC%8CRand%20index%EF%BC%89-toc" style="margin-left:80px;"><a href="#1.1%E3%80%81%E5%85%B0%E5%BE%B7%E6%8C%87%E6%95%B0%EF%BC%88RI%EF%BC%8CRand%20index%EF%BC%89" rel="nofollow">1.1、兰德指数（RI，Rand index）</a></p> 
<p id="1.1.1%E3%80%81%E8%B0%83%E6%95%B4%E5%85%B0%E5%BE%B7%E6%8C%87%E6%95%B0%EF%BC%88Adjusted%20Rand%20index%EF%BC%89-toc" style="margin-left:120px;"><a href="#1.1.1%E3%80%81%E8%B0%83%E6%95%B4%E5%85%B0%E5%BE%B7%E6%8C%87%E6%95%B0%EF%BC%88Adjusted%20Rand%20index%EF%BC%89" rel="nofollow">1.1.1、调整兰德指数（Adjusted Rand index）</a></p> 
<p id="1.2%E3%80%81%E5%9F%BA%E4%BA%8E%E4%BA%92%E4%BF%A1%E6%81%AF%E7%9A%84%E5%88%86%E6%95%B0%EF%BC%88MI%EF%BC%8CMutual%20Information-based%20Score%EF%BC%89-toc" style="margin-left:80px;"><a href="#1.2%E3%80%81%E5%9F%BA%E4%BA%8E%E4%BA%92%E4%BF%A1%E6%81%AF%E7%9A%84%E5%88%86%E6%95%B0%EF%BC%88MI%EF%BC%8CMutual%20Information-based%20Score%EF%BC%89" rel="nofollow">1.2、基于互信息的分数（MI，Mutual Information-based Score）</a></p> 
<p id="1.2.1%E3%80%81%E6%A0%87%E5%87%86%E5%8C%96%E4%BA%92%E4%BF%A1%E6%81%AF%EF%BC%88NMI%EF%BC%8CNormalized%20Mutual%20Information%EF%BC%89-toc" style="margin-left:120px;"><a href="#1.2.1%E3%80%81%E6%A0%87%E5%87%86%E5%8C%96%E4%BA%92%E4%BF%A1%E6%81%AF%EF%BC%88NMI%EF%BC%8CNormalized%20Mutual%20Information%EF%BC%89" rel="nofollow">1.2.1、标准化互信息（NMI，Normalized Mutual Information）</a></p> 
<p id="1.2.2%E3%80%81%E8%B0%83%E6%95%B4%E4%BA%92%E4%BF%A1%E6%81%AF%EF%BC%88AMI%EF%BC%8CAdjusted%20mutual%20information%EF%BC%89-toc" style="margin-left:120px;"><a href="#1.2.2%E3%80%81%E8%B0%83%E6%95%B4%E4%BA%92%E4%BF%A1%E6%81%AF%EF%BC%88AMI%EF%BC%8CAdjusted%20mutual%20information%EF%BC%89" rel="nofollow">1.2.2、调整互信息（AMI，Adjusted mutual information）</a></p> 
<p id="1.3%E3%80%81%E5%90%8C%E8%B4%A8%E6%80%A7%EF%BC%88Homogeneity%20Score%EF%BC%89%E5%92%8C%E5%AE%8C%E6%95%B4%E6%80%A7%EF%BC%88Completeness%20Score%EF%BC%89%E4%BB%A5%E5%8F%8A%E5%85%B6%E8%B0%83%E5%92%8C%E5%B9%B3%E5%9D%87%EF%BC%88V-measure%EF%BC%89-toc" style="margin-left:80px;"><a href="#1.3%E3%80%81%E5%90%8C%E8%B4%A8%E6%80%A7%EF%BC%88Homogeneity%20Score%EF%BC%89%E5%92%8C%E5%AE%8C%E6%95%B4%E6%80%A7%EF%BC%88Completeness%20Score%EF%BC%89%E4%BB%A5%E5%8F%8A%E5%85%B6%E8%B0%83%E5%92%8C%E5%B9%B3%E5%9D%87%EF%BC%88V-measure%EF%BC%89" rel="nofollow">1.3、同质性（Homogeneity Score）和完整性（Completeness Score）以及其调和平均（V-measure）</a></p> 
<p id="1.3.1%E3%80%81%E5%90%8C%E8%B4%A8%E6%80%A7%EF%BC%88Homogeneity%20Score%EF%BC%89-toc" style="margin-left:120px;"><a href="#1.3.1%E3%80%81%E5%90%8C%E8%B4%A8%E6%80%A7%EF%BC%88Homogeneity%20Score%EF%BC%89" rel="nofollow">1.3.1、同质性（Homogeneity Score）</a></p> 
<p id="1.3.2%E3%80%81%E5%AE%8C%E6%95%B4%E6%80%A7%EF%BC%88Completeness%20Score%EF%BC%89-toc" style="margin-left:120px;"><a href="#1.3.2%E3%80%81%E5%AE%8C%E6%95%B4%E6%80%A7%EF%BC%88Completeness%20Score%EF%BC%89" rel="nofollow">1.3.2、完整性（Completeness Score）</a></p> 
<p id="1.3.3%E3%80%81V-measure-toc" style="margin-left:120px;"><a href="#1.3.3%E3%80%81V-measure" rel="nofollow">1.3.3、V-measure</a></p> 
<p id="1.4%E3%80%81Fowlkes-Mallows%20Scores%EF%BC%88FMI%EF%BC%89-toc" style="margin-left:80px;"><a href="#1.4%E3%80%81Fowlkes-Mallows%20Scores%EF%BC%88FMI%EF%BC%89" rel="nofollow">1.4、Fowlkes-Mallows Scores（FMI）</a></p> 
<p id="%C2%A02%E3%80%81%E5%86%85%E9%83%A8%E6%8C%87%E6%A0%87-toc" style="margin-left:40px;"><a href="#%C2%A02%E3%80%81%E5%86%85%E9%83%A8%E6%8C%87%E6%A0%87" rel="nofollow"> 2、内部指标</a></p> 
<p id="2.1%E3%80%81%E8%BD%AE%E5%BB%93%E7%B3%BB%E6%95%B0%EF%BC%88Silhouette%20Coefficient%EF%BC%89-toc" style="margin-left:80px;"><a href="#2.1%E3%80%81%E8%BD%AE%E5%BB%93%E7%B3%BB%E6%95%B0%EF%BC%88Silhouette%20Coefficient%EF%BC%89" rel="nofollow">2.1、轮廓系数（Silhouette Coefficient）</a></p> 
<p id="2.2%E3%80%81Calinski-Harabaz%E6%8C%87%E6%95%B0%EF%BC%88Calinski-Harabaz%20Index%EF%BC%8C%E4%B9%9F%E7%A7%B0Variance%20Ratio%20Criterion%EF%BC%89-toc" style="margin-left:80px;"><a href="#2.2%E3%80%81Calinski-Harabaz%E6%8C%87%E6%95%B0%EF%BC%88Calinski-Harabaz%20Index%EF%BC%8C%E4%B9%9F%E7%A7%B0Variance%20Ratio%20Criterion%EF%BC%89" rel="nofollow">2.2、Calinski-Harabaz指数（Calinski-Harabaz Index，也称Variance Ratio Criterion）</a></p> 
<p id="2.3%E3%80%81%E6%88%B4%E7%BB%B4%E6%A3%AE%E5%A0%A1%E4%B8%81%E6%8C%87%E6%95%B0%EF%BC%88DBI%EF%BC%8CDavies-Bouldin%20Index%EF%BC%89-toc" style="margin-left:80px;"><a href="#2.3%E3%80%81%E6%88%B4%E7%BB%B4%E6%A3%AE%E5%A0%A1%E4%B8%81%E6%8C%87%E6%95%B0%EF%BC%88DBI%EF%BC%8CDavies-Bouldin%20Index%EF%BC%89" rel="nofollow">2.3、戴维森堡丁指数（DBI，Davies-Bouldin Index）</a></p> 
<p id="%C2%A03%E3%80%81%E6%80%BB%E7%BB%93-toc" style="margin-left:40px;"><a href="#%C2%A03%E3%80%81%E6%80%BB%E7%BB%93" rel="nofollow"> 3、总结</a></p> 
<hr> 
<h2 id="%E5%89%8D%E8%A8%80"><a id="_12"></a>前言</h2> 
<p><code>tips：这里只是<strong>总结</strong>，不是教程哈。</code></p> 
<p><code>“***”开头的是给好奇心重的宝宝看的，其实不太重要可以跳过。</code></p> 
<p><code>此处以下所有内容均为暂定，因为我还没找到一个好的，让小白（我自己）也能容易理解（更系统、嗯应该是宏观）的讲解顺序与方式。</code></p> 
<p><code>第一文主要简述了一下机器学习大致有哪些东西（当然远远不止这些），对大体框架有了一定了解。接着我们根据机器学习的流程一步步来学习吧，掐掉其他不太用得上我们的步骤，精练起来就4步（数据预处理，特征工程，训练模型，模型评估），其中训练模型则是我们的重头戏，基本上所有算法也都是这一步，so，这个最后写，先把其他三个讲了，然后，在结合这三步来进行算法的学习，兴许会好点（个人拙见）。</code></p> 
<hr> 
<p id="%E4%B8%80%E3%80%81%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AE%80%E4%BB%8B">衡量模型泛化能力的评价标准就是<strong>性能度量（模型评估指标、模型评价标准）</strong>，而针对不同的任务有不同的评价指标。按照数据集的目标值不同，可以把模型评估分为分类模型评估、回归模型评估和聚类模型评估。</p> 
<h2 id="%E5%9B%9B%E3%80%81%20%E8%81%9A%E7%B1%BB%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87">四、 聚类模型评估指标</h2> 
<p>聚类试图将数据集中的样本划分为若干个通常是互不相交的子集，每个子集叫做一个“簇”（cluster），好的聚类算法，一般要求类簇具有：<br>        <strong> 簇内 (intra-cluster) 相似度高<br>         簇间 (inter-cluster) 相似度低</strong><br> 即同一簇尽可能相似，不同簇尽可能不同。</p> 
<p>聚类性能度量大致有两种，<br>         一类是指当数据集的外部信息可用时，通过比较聚类划分与外部准则的匹配度，可以评价不同聚类算法的性能。即将聚类结果于某个“参考模型”（真实值）进行比较。称为“<strong>外部指标</strong>”（external index）；<br>         另一类主要基于数据集的集合结构信息从紧致性、分离性、连通性和重叠度等方面对聚类划分进行评价。即基于数据聚类自身进行评估的。称为“<strong>内部指标</strong>”（internal index）.</p> 
<p>外部指标：【兰德指数（RI，Rand index）、调整兰德指数（Adjusted Rand index）】、<br> 【基于互信息的分数（MI，Mutual Information-based Score）、标准化互信息（NMI，Normalized Mutual Information）、调整互信息（AMI，Adjusted mutual information）】、<br> 【同质性（Homogeneity Score）和完整性（Completeness Score）以及其调和平均（V-measure）】、<br> 【Fowlkes-Mallows Scores（FMI）】</p> 
<p>内部指标：<br> 轮廓系数（Silhouette Coefficient）、Calinski-Harabaz指数（Calinski-Harabaz Index，也称Variance Ratio Criterion）、戴维森堡丁指数（DBI，Davies-Bouldin Index）</p> 
<h3 id="1%E3%80%81%E5%A4%96%E9%83%A8%E6%8C%87%E6%A0%87">1、外部指标</h3> 
<p>首先需要定义几个变量：<br> （可以理解为聚类给出的簇，就是你的模型计算出来的结果，参考模型给出的簇，就是“真实”的簇，实际应该分成这个样子。）。</p> 
<p><img alt="" height="635" src="https://images2.imgbox.com/05/69/rI12TWZn_o.png" width="1200"></p> 
<p>举个例子，参考模型给出的簇与聚类模型给出的簇划分如下：<br>      <em>   编号：    <strong>1， 2， 3， 4， 5， 6</strong></em><br>         聚类簇： 0， 0， 1， 1， 2， 2<br>         参考簇： 0， 0， 0， 1， 1， 1</p> 
<p>那么满足a的样本对就是（1，2）、（5，6）【1号和2号的聚类簇都是0，参考簇都是0；5号和6号的聚类簇都是2，参考簇都是1】，总共有两个样本对满足a，所以a=2。</p> 
<p>同理，满足b的样本对是（3，4）【3号和4号聚类簇都是1，但参考簇不同】，所以b=1。</p> 
<p>同理，满足c的样本对是（1，3）（2，3）（4，5）（4，6）【他们分别都是聚类簇不同，参考簇相同】，所以c=4。</p> 
<p>同理，满足d的样本对是（1，4）（1，5）（1，6）（2，4）（2，5）（2，6）（3，5）（3，6）【他们分别聚类簇不同，参考簇也不同】，所以d=8。</p> 
<p>用代码展示大概就是这个样子。</p> 
<pre><code class="language-python"># 聚类模型给出的簇
y_predict=[0,0,1,1,2,2]
# 参考模型给出的簇
y_true=[0,0,0,1,1,1]

# 计算abcd
def get_abcd(y_predict,y_true):
    a=b=c=d=0
    for i in range(0,(len(y_predict)-1)):
        for j in range(i+1,len(y_predict)):
            if(y_predict[i]==y_predict[j])&amp;(y_true[i]==y_true[j]):
                a=a+1;
            if(y_predict[i]==y_predict[j])&amp;(y_true[i]!=y_true[j]):
                b=b+1;
            if(y_predict[i]!=y_predict[j])&amp;(y_true[i]==y_true[j]):
                c=c+1;
            if(y_predict[i]!=y_predict[j])&amp;(y_true[i]!=y_true[j]):
                d=d+1;
    return a,b,c,d

a,b,c,d=get_abcd(y_predict,y_true)
print(a,',',b,',',c,',',d)</code></pre> 
<p><img alt="" height="584" src="https://images2.imgbox.com/4e/07/LIluDuYY_o.png" width="731"></p> 
<h4 id="1.1%E3%80%81%E5%85%B0%E5%BE%B7%E6%8C%87%E6%95%B0%EF%BC%88RI%EF%BC%8CRand%20index%EF%BC%89">1.1、兰德指数（RI，Rand index）</h4> 
<p>兰德指数衡量的是聚类算法将数据点分配到聚类中的准确程度。兰德指数的范围从0到1，1的值表示两个聚类完全相同，接近0的值表示两个聚类有很大的不同。兰德指数<strong>只能用于评估将样本点分成两个簇的聚类算法</strong>。</p> 
<p><strong>公式</strong>：</p> 
<p>   <img alt="" height="154" src="https://images2.imgbox.com/71/a9/M2D5DNME_o.png" width="953">   </p> 
<p>其中 <img alt="" height="31" src="https://images2.imgbox.com/c2/37/v6ZLymsv_o.png" width="57">和<img alt="" height="32" src="https://images2.imgbox.com/01/1a/k6J6G0NS_o.png" width="35">都是表示任意两个样本为一类有多少种组合，是数据集中可以组成的总元素对数。<br> 用刚才的例子计算出来的结果就是 <img alt="" height="41" src="https://images2.imgbox.com/ff/51/gSqdEZ39_o.png" width="174"> </p> 
<p><strong>API</strong>：</p> 
<pre><code class="language-python">from sklearn.metrics import rand_score

rand_score(y_true,y_predict)</code></pre> 
<p> <img alt="" height="128" src="https://images2.imgbox.com/af/c2/9tfAxbtS_o.png" width="434"> </p> 
<h5 id="1.1.1%E3%80%81%E8%B0%83%E6%95%B4%E5%85%B0%E5%BE%B7%E6%8C%87%E6%95%B0%EF%BC%88Adjusted%20Rand%20index%EF%BC%89">1.1.1、调整兰德指数（Adjusted Rand index）</h5> 
<p>未调整的兰德指数类取值区间为[ 0,1]，没有一个固定的值表示两个随即标签的关系 ；调整的兰德指数将评分规范到了[−1, 1] 之间，以0.0表示两个随机标签的关系。其中值越接近1表示聚类结果越准确，值越接近0表示聚类结果与随机结果相当，值越接近-1表示聚类结果与真实类别完全相反。</p> 
<p>完美的标签的得分为1.0，无相关标签的得分是负数或接近于0.0分。</p> 
<p><strong>公式</strong>：</p> 
<p><img alt="" height="98" src="https://images2.imgbox.com/41/45/13EYpX3l_o.png" width="336"></p> 
<p>其中E(RI)是兰德系数的期望值。【其实就和归一化有点像（不完全一样哈）--死去的记忆突然攻击QwQ】</p> 
<p><strong>API</strong>：</p> 
<pre><code class="language-python">from sklearn.metrics import adjusted_rand_score

adjusted_rand_score(y_true,y_predict)</code></pre> 
<p><img alt="" height="221" src="https://images2.imgbox.com/66/78/rezMzgZf_o.png" width="558"></p> 
<p>调整兰德系数是对称的，交换参数不会改变得分。</p> 
<h4 id="1.2%E3%80%81%E5%9F%BA%E4%BA%8E%E4%BA%92%E4%BF%A1%E6%81%AF%E7%9A%84%E5%88%86%E6%95%B0%EF%BC%88MI%EF%BC%8CMutual%20Information-based%20Score%EF%BC%89">1.2、基于互信息的分数（MI，Mutual Information-based Score）</h4> 
<p>衡量的是聚类结果与真实标签之间的相似性。基于互信息的分数的取值范围为[0,1]，其中值越接近1表示聚类结果越准确，值越接近0表示聚类结果与随机结果相当，值越小表示聚类结果与真实类别之间的差异越大。基于互信息的分数是一种相对指标，它的取值受到真实类别数量的影响。当真实类别数量很大时，基于互信息的分数可能会受到偏差。</p> 
<p><strong>公式</strong>：</p> 
<p>假设U与V是对N个样本标签的分配情况。</p> 
<p><img alt="" height="109" src="https://images2.imgbox.com/55/3e/1pVpkbI8_o.png" width="888"></p> 
<p> <img alt="" height="34" src="https://images2.imgbox.com/98/99/MGLZpGoG_o.png" width="443"></p> 
<p><strong>API</strong>：</p> 
<pre><code class="language-python">from sklearn.metrics import mutual_info_score

mutual_info_score(y_true,y_predict)</code></pre> 
<p><img alt="" height="126" src="https://images2.imgbox.com/0e/d9/z1M9qT8l_o.png" width="510"></p> 
<h5 id="1.2.1%E3%80%81%E6%A0%87%E5%87%86%E5%8C%96%E4%BA%92%E4%BF%A1%E6%81%AF%EF%BC%88NMI%EF%BC%8CNormalized%20Mutual%20Information%EF%BC%89">1.2.1、标准化互信息（NMI，Normalized Mutual Information）</h5> 
<p><strong>公式</strong>：</p> 
<p><img alt="" height="90" src="https://images2.imgbox.com/40/c5/H1vAXPdy_o.png" width="402"></p> 
<p>假设U与V是对N个样本标签的分配情况，则两种分布的熵（熵表示的是不确定程度）：<img alt="" height="119" src="https://images2.imgbox.com/c7/2a/3uq2Ypg1_o.png" width="224"></p> 
<p><strong>API</strong>：</p> 
<pre><code class="language-python">from sklearn.metrics import normalized_mutual_info_score

normalized_mutual_info_score(y_true,y_predict)</code></pre> 
<p> <img alt="" height="139" src="https://images2.imgbox.com/97/6a/VTqlSQG6_o.png" width="610"></p> 
<h5 id="1.2.2%E3%80%81%E8%B0%83%E6%95%B4%E4%BA%92%E4%BF%A1%E6%81%AF%EF%BC%88AMI%EF%BC%8CAdjusted%20mutual%20information%EF%BC%89">1.2.2、调整互信息（AMI，Adjusted mutual information）</h5> 
<p><strong>公式</strong>：</p> 
<p><img alt="" height="81" src="https://images2.imgbox.com/34/50/8MnbMPIf_o.png" width="418"></p> 
<p><strong>API</strong>：</p> 
<pre><code class="language-python">from sklearn.metrics import adjusted_mutual_info_score

adjusted_mutual_info_score(y_true,y_predict)</code></pre> 
<p><img alt="" height="130" src="https://images2.imgbox.com/99/97/cy6uWdNz_o.png" width="584"></p> 
<p><strong>！！！注意</strong>：MI，NMI，AMI这三个的参数也是对称的，互换不影响结果。</p> 
<h4 id="1.3%E3%80%81%E5%90%8C%E8%B4%A8%E6%80%A7%EF%BC%88Homogeneity%20Score%EF%BC%89%E5%92%8C%E5%AE%8C%E6%95%B4%E6%80%A7%EF%BC%88Completeness%20Score%EF%BC%89%E4%BB%A5%E5%8F%8A%E5%85%B6%E8%B0%83%E5%92%8C%E5%B9%B3%E5%9D%87%EF%BC%88V-measure%EF%BC%89">1.3、同质性（Homogeneity Score）和完整性（Completeness Score）以及其调和平均（V-measure）</h4> 
<h5 id="1.3.1%E3%80%81%E5%90%8C%E8%B4%A8%E6%80%A7%EF%BC%88Homogeneity%20Score%EF%BC%89">1.3.1、同质性（Homogeneity Score）</h5> 
<p>每个簇只包含一个类的成员</p> 
<p><strong>公式</strong>：</p> 
<p><img alt="" height="111" src="https://images2.imgbox.com/9d/3c/SqjOZrPL_o.png" width="275"></p> 
<p><strong>API</strong>：</p> 
<pre><code class="language-python">from sklearn.metrics import homogeneity_score

homogeneity_score(y_true,y_predict)</code></pre> 
<p><img alt="" height="129" src="https://images2.imgbox.com/e0/e4/AZJAv9Of_o.png" width="498"></p> 
<h5 id="1.3.2%E3%80%81%E5%AE%8C%E6%95%B4%E6%80%A7%EF%BC%88Completeness%20Score%EF%BC%89">1.3.2、完整性（Completeness Score）</h5> 
<p>给定类的所有成员都分配给同一个簇</p> 
<p><strong>公式</strong>：</p> 
<p><img alt="" height="122" src="https://images2.imgbox.com/33/0a/u5ULIMGX_o.png" width="278"></p> 
<p><strong>API</strong>：</p> 
<pre><code class="language-python">from sklearn.metrics import completeness_score

completeness_score(y_true,y_predict)</code></pre> 
<p><img alt="" height="118" src="https://images2.imgbox.com/fd/6e/cvYArNRL_o.png" width="502"></p> 
<h5 id="1.3.3%E3%80%81V-measure">1.3.3、V-measure</h5> 
<p>V-measure是同质性homogeneity和完整性completeness的调和平均数。</p> 
<p><strong>公式</strong>：</p> 
<p><img alt="" height="127" src="https://images2.imgbox.com/1b/c9/sFsMM9mv_o.png" width="302"></p> 
<p><strong>API</strong>：</p> 
<pre><code class="language-python">from sklearn.metrics import v_measure_score

v_measure_score(y_true,y_predict)</code></pre> 
<p><img alt="" height="124" src="https://images2.imgbox.com/62/d9/GzJJkUUP_o.png" width="471"></p> 
<h4 id="1.4%E3%80%81Fowlkes-Mallows%20Scores%EF%BC%88FMI%EF%BC%89">1.4、Fowlkes-Mallows Scores（FMI）</h4> 
<p>FMI是Precision（精度）和 Recall（召回）的几何平均数。取值范围为 [0,1]，越接近1越好。</p> 
<p><strong>公式</strong>：</p> 
<p><img alt="" height="136" src="https://images2.imgbox.com/fe/d2/pIPIw7Gx_o.png" width="572"></p> 
<p><strong>API</strong>：</p> 
<pre><code class="language-python">from sklearn.metrics import fowlkes_mallows_score

fowlkes_mallows_score(y_true,y_predict)</code></pre> 
<h4 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="128" src="https://images2.imgbox.com/71/b1/cDkMEUSd_o.png" width="546"></h4> 
<h3 id="%C2%A02%E3%80%81%E5%86%85%E9%83%A8%E6%8C%87%E6%A0%87"> 2、内部指标</h3> 
<h4 id="2.1%E3%80%81%E8%BD%AE%E5%BB%93%E7%B3%BB%E6%95%B0%EF%BC%88Silhouette%20Coefficient%EF%BC%89">2.1、轮廓系数（Silhouette Coefficient）</h4> 
<p>轮廓分数使用同一聚类中的点之间的距离，以及下一个临近聚类中的点与所有其他点之间的距离来评估模型的表现。它主要基于样本点与其所属簇内和最近邻簇之间的距离、相似性和紧密度等因素来计算。数值越高，模型性能越好。轮廓系数的取值范围是[-1,1]，同类别样本距离越相近，不同类别样本距离越远，值越大。当值为负数时，说明聚类效果很差。</p> 
<p><strong>公式</strong>：</p> 
<p><img alt="" height="100" src="https://images2.imgbox.com/39/35/ndK4lchB_o.png" width="205"></p> 
<p>其中：<br>         a：样本与同一类别中所有其他点之间的平均距离。 <br>         b：样本与<em>下一个最近的簇中</em>所有其他点之间的平均距离。</p> 
<p><strong>API</strong>：</p> 
<pre><code class="language-python">from sklearn.metrics import silhouette_score</code></pre> 
<pre><code class="language-python">from sklearn.datasets import load_iris

# 加载数据
iris=load_iris()

from sklearn.cluster import KMeans

# 模型训练
kmeans_model = KMeans(n_clusters=3, random_state=1).fit(iris.data)
labels = kmeans_model.labels_


from sklearn.metrics import silhouette_score

# 轮廓系数
silhouette_score(iris.data,labels)</code></pre> 
<p><img alt="" height="418" src="https://images2.imgbox.com/97/7d/q6LoWDUi_o.png" width="697"></p> 
<h4 id="2.2%E3%80%81Calinski-Harabaz%E6%8C%87%E6%95%B0%EF%BC%88Calinski-Harabaz%20Index%EF%BC%8C%E4%B9%9F%E7%A7%B0Variance%20Ratio%20Criterion%EF%BC%89">2.2、Calinski-Harabaz指数（Calinski-Harabaz Index，也称Variance Ratio Criterion）</h4> 
<p>通过计算类中各点与类中心的距离平方和来度量类内的紧密度，通过计算各类中心点与数据集中心点距离平方和来度量数据集的分离度，CH指标由分离度与紧密度的比值得到。从而，CH越大代表着类自身越紧密，类与类之间越分散，即更优的聚类结果。</p> 
<p><strong>公式</strong>：</p> 
<p><img alt="" height="629" src="https://images2.imgbox.com/03/2c/GRvZp7J1_o.png" width="1200"></p> 
<p><strong>API</strong>：</p> 
<pre><code class="language-python">from sklearn.metrics import calinski_harabasz_score

calinski_harabasz_score(iris.data,labels)</code></pre> 
<p><img alt="" height="123" src="https://images2.imgbox.com/cb/91/1gyOJDzF_o.png" width="557"></p> 
<h4 id="2.3%E3%80%81%E6%88%B4%E7%BB%B4%E6%A3%AE%E5%A0%A1%E4%B8%81%E6%8C%87%E6%95%B0%EF%BC%88DBI%EF%BC%8CDavies-Bouldin%20Index%EF%BC%89">2.3、戴维森堡丁指数（DBI，Davies-Bouldin Index）</h4> 
<p>是计算任意两类别的类内距离平均距离之和除以两聚类中心距离求最大值。DB越小，意味着类内距离越小同时类间距离越大。零是可能的最低值，接近零的值表示更好的分区。</p> 
<p><strong>公式</strong>：</p> 
<p><img alt="" height="128" src="https://images2.imgbox.com/39/23/eBfOoFJu_o.png" width="489"></p> 
<p><strong>API</strong>：</p> 
<pre><code class="language-python">from sklearn.metrics import davies_bouldin_score

davies_bouldin_score(iris.data,labels)</code></pre> 
<p><img alt="" height="115" src="https://images2.imgbox.com/d3/97/e0EUzJ5w_o.png" width="538"></p> 
<p></p> 
<h3 id="%C2%A03%E3%80%81%E6%80%BB%E7%BB%93"> 3、总结</h3> 
<p>外部指标：</p> 
<p><strong>Rand Index</strong>：用于衡量聚类结果和真实标签之间的相似度。<br><strong>Adjusted Rand Score</strong>：Rand Index的调整版本，可以对随机结果进行惩罚。<br><strong>Mutual Information Score</strong>：衡量聚类结果和真实标签之间的相似度。<br><strong>Normalized Mutual Information Score</strong>：Mutual Information Score的归一化版本。<br><strong>Adjusted Mutual Information Score</strong>：Normalized Mutual Information Score的调整版本。<br><strong>Homogeneity and Completeness Score</strong>：分别衡量聚类结果的同质性和完整性。<br><strong>V-Measure</strong>：基于Homogeneity和Completeness Score计算的综合评估指标。<br><strong>Fowlkes-Mallows Score</strong>：用于衡量聚类结果和真实标签之间的相似度。</p> 
<p>内部指标：</p> 
<p><strong>Silhouette Score</strong>：用于衡量聚类结果中每个样本点与自身簇和其他簇之间的相似度。<br><strong>Calinski-Harabasz Index</strong>：基于簇内和簇间方差之间的比值来计算聚类性能。<br><strong>Davies-Bouldin Index</strong>：基于簇内的紧密度和簇间的分离度来计算聚类性能。</p> 
<p>一般情况下，主要是对无标签的数据进行聚类操作。如果在评价中用到外部指标，就需通过人工标注等方法获取标签，成本较高，因此内部指标的实际实用性更强。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/164f178b38e32b8936080e38774c4d11/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">机器学习（四） -- 模型评估（2）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1874b4de50f7a72b34b54ddd7f7fa206/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Verilog】期末复习——设计带进位输入和输出的8位全加器，包括测试模块</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>