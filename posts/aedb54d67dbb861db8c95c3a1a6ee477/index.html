<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>图像细化与轮廓操作 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="图像细化与轮廓操作" />
<meta property="og:description" content="目录
1、图像细化
2、轮廓检测
3、轮廓信息统计
4、轮廓外接多边形
1、图像细化 需要安装扩展包
//图像细化 int test1() { //中文字进行细化 Mat img = imread(&#34;LearnCV_black.png&#34;,IMREAD_ANYCOLOR); if (img.empty()) { cout &lt;&lt; &#34;请确认图像文件名称是否正确&#34; &lt;&lt; endl; return -1; } //英文字 &#43; 实心圆和圆环细化 Mat words = Mat::zeros(100,200,CV_8UC1);//创建一个黑色的背景图片 putText(words,&#34;Learn&#34;,Point(30,30),2,1,Scalar(255),2);//添加英文 putText(words,&#34;OpenCV 4&#34;,Point(30,60),2,1,Scalar(255),2); circle(words,Point(80,75),10,Scalar(255), - 1);//添加实心圆 circle(words,Point(130,75),10,Scalar(255),3);//添加圆环 //进行细化 Mat thin1, thin2; ximgproc::thinning(img, thin1, 0);//注意类名 ximgproc::thinning(words,thin2, 0); //显示处理结果 imshow(&#34;thinl&#34;, thin1); imshow(&#34;img&#34;, img); namedWindow(&#34;thin2&#34;,WINDOW_NORMAL); imshow (&#34;thin2&#34;, thin2); namedWindow(&#34;words&#34;,WINDOW_NORMAL); imshow(&#34;words&#34;, words); waitKey(0); return 0; } 2、轮廓检测 #include &lt;iostream&gt; #include &lt;opencv2/opencv." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/aedb54d67dbb861db8c95c3a1a6ee477/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-13T15:28:58+08:00" />
<meta property="article:modified_time" content="2023-07-13T15:28:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">图像细化与轮廓操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1%E3%80%81%E5%9B%BE%E5%83%8F%E7%BB%86%E5%8C%96-toc" style="margin-left:0px;"><a href="#1%E3%80%81%E5%9B%BE%E5%83%8F%E7%BB%86%E5%8C%96" rel="nofollow">1、图像细化</a></p> 
<p id="2%E3%80%81%E8%BD%AE%E5%BB%93%E6%A3%80%E6%B5%8B-toc" style="margin-left:0px;"><a href="#2%E3%80%81%E8%BD%AE%E5%BB%93%E6%A3%80%E6%B5%8B" rel="nofollow">2、轮廓检测</a></p> 
<p id="3%E3%80%81%E8%BD%AE%E5%BB%93%E4%BF%A1%E6%81%AF%E7%BB%9F%E8%AE%A1-toc" style="margin-left:0px;"><a href="#3%E3%80%81%E8%BD%AE%E5%BB%93%E4%BF%A1%E6%81%AF%E7%BB%9F%E8%AE%A1" rel="nofollow">3、轮廓信息统计</a></p> 
<p id="4%E3%80%81%E8%BD%AE%E5%BB%93%E5%A4%96%E6%8E%A5%E5%A4%9A%E8%BE%B9%E5%BD%A2-toc" style="margin-left:0px;"><a href="#4%E3%80%81%E8%BD%AE%E5%BB%93%E5%A4%96%E6%8E%A5%E5%A4%9A%E8%BE%B9%E5%BD%A2" rel="nofollow">4、轮廓外接多边形</a></p> 
<p></p> 
<h2 id="1%E3%80%81%E5%9B%BE%E5%83%8F%E7%BB%86%E5%8C%96">1、图像细化</h2> 
<p><span style="color:#be191c;"><strong>需要安装扩展包</strong></span></p> 
<p><img alt="" height="799" src="https://images2.imgbox.com/ec/87/TY0CrzPb_o.png" width="1200"></p> 
<p> <img alt="" height="528" src="https://images2.imgbox.com/f6/39/W8hRSS0L_o.png" width="1200"></p> 
<p></p> 
<pre><code class="language-cpp">//图像细化
int test1()
{
	//中文字进行细化
	Mat img = imread("LearnCV_black.png",IMREAD_ANYCOLOR); 
	if (img.empty())
	{
		cout &lt;&lt; "请确认图像文件名称是否正确" &lt;&lt; endl;
		return -1;
	}

	//英文字 + 实心圆和圆环细化
	Mat words = Mat::zeros(100,200,CV_8UC1);//创建一个黑色的背景图片
	putText(words,"Learn",Point(30,30),2,1,Scalar(255),2);//添加英文
	putText(words,"OpenCV 4",Point(30,60),2,1,Scalar(255),2);
	circle(words,Point(80,75),10,Scalar(255), - 1);//添加实心圆
	
	circle(words,Point(130,75),10,Scalar(255),3);//添加圆环
	
	//进行细化
	Mat thin1, thin2;
    ximgproc::thinning(img, thin1, 0);//注意类名
	ximgproc::thinning(words,thin2, 0);
	
	//显示处理结果
	imshow("thinl", thin1); 
	imshow("img", img);
	namedWindow("thin2",WINDOW_NORMAL);
	imshow ("thin2", thin2);
	namedWindow("words",WINDOW_NORMAL);
	imshow("words", words);

	waitKey(0);
	return 0;
}</code></pre> 
<h2 id="2%E3%80%81%E8%BD%AE%E5%BB%93%E6%A3%80%E6%B5%8B">2、轮廓检测</h2> 
<p><img alt="" height="670" src="https://images2.imgbox.com/9f/cb/1zI2NlVK_o.png" width="1200"></p> 
<p> <img alt="" height="585" src="https://images2.imgbox.com/29/98/lA8ZrC4B_o.png" width="1200"></p> 
<p> <img alt="" height="630" src="https://images2.imgbox.com/71/7a/tKJngePe_o.png" width="1037"></p> 
<p> <img alt="" height="547" src="https://images2.imgbox.com/0f/84/XGolCBD2_o.png" width="980"></p> 
<p></p> 
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;opencv2/opencv.hpp&gt;

using namespace cv;
using namespace std;
//轮廓检测
int test2()
{
	system("color 02");//更改输出界面颜色

	Mat img = imread("E:/testMap/key.png");
	if (img.empty())
	{
		cout &lt;&lt; "请确认图像文件名称是否正确" &lt;&lt; endl;
		return -1;
	}
	imshow("原图", img);

	Mat gray, binary;
	cvtColor(img, gray, COLOR_BGR2GRAY);//转化成灰度图
	GaussianBlur(gray, gray, Size(13, 13), 4, 4);//平滑滤波
	threshold(gray, binary, 170, 255, THRESH_BINARY | THRESH_OTSU);//自适应二值化

	//轮廓发现与绘制
	vector&lt;vector&lt;Point&gt;&gt; contours;//轮廓
	vector&lt;Vec4i&gt; hierarchy;//存放轮廓结构变量 Vec4i:里面存放4个整数，如{1，2，3，4}
	findContours(binary, contours, hierarchy, RETR_TREE, CHAIN_APPROX_SIMPLE, Point());//轮廓检测函数

	//绘制轮廓
	for (int i = 0; i &lt; hierarchy.size(); i++)
	{
		cout &lt;&lt; hierarchy[i] &lt;&lt; endl;
	}

	for (int t = 0; t &lt; contours.size(); t++)
	{
		drawContours(img, contours, t, Scalar(0, 100, 255), 2, 8);//轮廓绘制函数
		imshow("轮廓检测结果", img);
		waitKey(0);
	}
}
int main()
{
	test2();

	system("pause");
	return 0;
}</code></pre> 
<h2 id="3%E3%80%81%E8%BD%AE%E5%BB%93%E4%BF%A1%E6%81%AF%E7%BB%9F%E8%AE%A1">3、轮廓信息统计</h2> 
<p><img alt="" height="379" src="https://images2.imgbox.com/a0/d4/eFKHw7t0_o.png" width="1200"></p> 
<p><img alt="" height="333" src="https://images2.imgbox.com/6c/13/lcDbRv6N_o.png" width="770"></p> 
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;opencv2/opencv.hpp&gt;

using namespace cv;
using namespace std;

//轮廓信息统计
int test3()
{
	system("color 02");//更改输出界面颜色

	//用四个点表示三角形轮廓
	vector&lt;Point&gt; contour;
	contour.push_back(Point2f(0, 0));
	contour.push_back(Point2f(10, 0));
	contour.push_back(Point2f(10, 10));
	contour.push_back(Point2f(5, 5));

	double area = contourArea(contour);//轮廓面积
	cout &lt;&lt; "area =" &lt;&lt; area &lt;&lt; endl;
	double length0 = arcLength(contour, true);
	double length1 = arcLength(contour, false);
	cout &lt;&lt; "length0 =" &lt;&lt; length0 &lt;&lt; endl;
	cout &lt;&lt; "lengthl =" &lt;&lt; length1 &lt;&lt; endl;
	cout &lt;&lt; "图像轮廓面积" &lt;&lt; endl;

	Mat img = imread("E:/testMap/key.png");
	if(img.empty())
	{
		cout &lt;&lt; "请确认图像文件名称是否正确" &lt;&lt; endl;
		return -1;
	}

	Mat gray, binary;
	cvtColor(img, gray, COLOR_BGR2GRAY); //转化成灰度图
	GaussianBlur(gray, gray, Size(3, 3), 3, 3);//平滑滤波
	threshold(gray, binary, 170, 255, THRESH_BINARY);//二值化

	//轮廓检测
	vector&lt;vector&lt;Point&gt;&gt; contours;//轮廓
	vector&lt;Vec4i&gt; hierarchy;//存放轮廓结构变量
	findContours(binary, contours, hierarchy, RETR_TREE, CHAIN_APPROX_SIMPLE, Point());

	//输出轮廓面积
	for (int t = 0; t &lt; contours.size(); t++)
	{
		double area1 = contourArea(contours[t]);
		cout &lt;&lt; "第" &lt;&lt; t &lt;&lt; "轮廓面积 = " &lt;&lt; area1 &lt;&lt; endl;
	}

	//输出轮廓长度
	for (int t = 0; t &lt; contours.size(); t++)
	{
		double length2 = arcLength(contours[t], false);
		cout &lt;&lt; "第" &lt;&lt; t &lt;&lt; "轮廓长度 = " &lt;&lt; length2 &lt;&lt; endl;
	}

	return 0;
}

int main()
{
	test3();

	system("pause");
	return 0;
}</code></pre> 
<h2 id="4%E3%80%81%E8%BD%AE%E5%BB%93%E5%A4%96%E6%8E%A5%E5%A4%9A%E8%BE%B9%E5%BD%A2">4、轮廓外接多边形</h2> 
<p><img alt="" height="671" src="https://images2.imgbox.com/95/9a/kZdBoGZj_o.png" width="1200"></p> 
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;opencv2/opencv.hpp&gt;

using namespace cv;
using namespace std;

//轮廓外接多边形
void drawapp(Mat result, Mat img2)
{
	for (int i = 0; i &lt; result.rows; i++)
	{
		//最后一个坐标点与第一个坐标点连接
		if (i == result.rows - 1)
		{
			Vec2i point1 = result.at&lt;Vec2i&gt;(i);
			Vec2i point2 = result.at&lt;Vec2i&gt;(0);
			line(img2, point1, point2, Scalar(0, 0, 255), 2, 8, 0);
			break;
		}
		Vec2i point1 = result.at&lt;Vec2i&gt;(i);
		Vec2i point2 = result.at&lt;Vec2i&gt;(i + 1);
		line(img2, point1, point2, Scalar(0, 0, 255), 2, 8, 0);
	}
}

int test4()
{
	Mat img = imread("E:/testMap/stuff.jpg");
	if (img.empty())
	{
		cout &lt;&lt; "请确认图像文件名称是否正确" &lt;&lt; endl;
		return -1;
	}

	Mat img1, img2;
	img.copyTo(img1); //深拷贝用来绘制最大外接矩形
	img.copyTo(img2);//深拷贝用来绘制最小外接矩形
	imshow("img", img);

	//去噪声与二值化
	Mat canny;
	Canny(img, canny, 80, 160, 3, false);
	imshow("", canny);

	//膨胀运算,将细小缝隙填补上
	Mat kernel = getStructuringElement(0, Size(3, 3)); dilate(canny, canny, kernel);

	//轮廓发现与绘制
	vector&lt;vector&lt;Point&gt;&gt; contours;
	vector&lt;Vec4i&gt; hierarchy;
	findContours(canny, contours, hierarchy, 0, 2, Point());//寻找轮廓的外接矩形
	for (int n = 0; n &lt; contours.size(); n++)
	{
		// 最大外接矩形
		Rect rect = boundingRect(contours[n]);
		rectangle(img1, rect, Scalar(0, 0, 255), 2, 8, 0);

		//最小外接矩形
		RotatedRect rrect = minAreaRect(contours[n]); Point2f points[4];
		rrect.points(points);//读取最小外接矩形的四个顶点
		Point2f cpt = rrect.center;//最小外接矩形的中心

		//绘制旋转矩形与中心位置
		for (int i = 0; i &lt; 4; i++)
		{
			if (i == 3)
			{
				line(img2, points[i], points[0], Scalar(0, 255, 0), 2, 8, 0);
				break;
			}
			line(img2, points[i], points[i + 1], Scalar(0, 255, 0), 2, 8, 0);
		}
		//绘制矩形的中心
		circle(img2, cpt, 4, Scalar(255, 0, 0), -8, 0);
	}

	//输出绘制外接矩形的结果
	imshow("max", img1);
	imshow("min", img2);

	cout &lt;&lt; "下面是多边形拟合" &lt;&lt; endl;
	waitKey(0);

	Mat approx = imread("E:/testMap/stuff.jpg");

	if (approx.empty())
	{
		cout &lt;&lt; "请确认图像文件名称是否正确" &lt;&lt; endl;
		return -1;
	}

	//边缘检测
	Mat canny2;
	Canny(approx, canny2, 80, 160, 3, false);

	//膨胀运算
	Mat kernel2 = getStructuringElement(0, Size(3, 3));
	dilate(canny2, canny2, kernel2);

	//轮廓发现与绘制
	vector&lt;vector&lt;Point&gt;&gt; contours2;
	vector&lt;Vec4i&gt; hierarchy2;
	findContours(canny2, contours2, hierarchy2, 0, 2, Point());

	//绘制多边形
	for (int t = 0; t &lt; contours2.size(); t++)
	{
		//用最小外接矩形求取轮廓中心
		RotatedRect rrect = minAreaRect(contours2[t]);
		Point2f center = rrect.center;
		circle(approx, center, 2, Scalar(0, 255, 0), 2, 8, 0);

		Mat result;
		approxPolyDP(contours2[t], result, 4, true); //多边形拟合
		drawapp(result, approx);
		cout &lt;&lt; "corners : " &lt;&lt; result.rows &lt;&lt; endl;

		//判断形状和绘制轮廓
		if (result.rows == 3)
		{
			putText(approx, "triangle", center, 0, 1, Scalar(0, 255, 0), 1, 8);
		}
		if (result.rows == 4)
		{
			putText(approx, "rectangle", center, 0, 1, Scalar(0, 255, 0), 1, 8);
		}
		if (result.rows == 8)
		{
			putText(approx, "poly-8", center, 0, 1, Scalar(0, 255, 0), 1, 8);
		}
		if (result.rows &gt; 12)
		{
			putText(approx, "circle", center, 0, 1, Scalar(0, 255, 0), 1, 8);
		}
	}
	imshow("result", approx);

	//输出绘制外接矩形的结果
	imshow(" max", img1);
	imshow("min", img2);
	waitKey(0);
}

int main()
{
	test4();

	system("pause");
	return 0;
}</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/238eb86a9ea749bb1e909e9ae7e5907e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">长亭WAF社区版联动企业微信报警</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b5db46ebcef997774e7dcfa8a36ad1cd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">移动端声明及meta标签设置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>