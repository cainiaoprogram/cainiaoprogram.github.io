<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>华为 AC&#43;FIT AP 直连二层组网直接转发 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="华为 AC&#43;FIT AP 直连二层组网直接转发" />
<meta property="og:description" content="组网需求
AC组网方式：直连二层组网。DHCP部署方式：AC作为DHCP服务器为AP和STA分配IP地址。业务数据转发方式：直接转发 拓扑图
一、交换机设置
1、基础配置，创建VLAN &lt;Huawei&gt;sys [Huawei]sys SW1 [SW1]un in en [SW1]vlan batch 2 3 2、设置交换机与AP下联接口，默认VLAN为2，以实现上游发送数据时剥离VLAN
[SW1]int g0/0/1 [SW1-GigabitEthernet0/0/1]p l t [SW1-GigabitEthernet0/0/1]p t p v 2 [SW1-GigabitEthernet0/0/1]p t a v a [SW1-GigabitEthernet0/0/1]quit 3、设置交换机与AC上联接口
[SW1]int g0/0/2 [SW1-GigabitEthernet0/0/2]p l t [SW1-GigabitEthernet0/0/2]p t a v a [SW1-GigabitEthernet0/0/2]quit 二、AC控制器设置
1、创建VLAN，为AP跟STA配置DHCP
&lt;AC6005&gt;sys [AC6005]sys AC1 [AC1]un in en [AC1]vlan batch 2 3 [AC1]int g0/0/1 [AC1-GigabitEthernet0/0/1]p l t [AC1-GigabitEthernet0/0/1]p t a v a [AC1-GigabitEthernet0/0/1]quit [AC1]dhcp enable # 配置DHCP为AP分配地址 [AC1]int vlanif 2 [AC1-Vlanif2]ip addr 192." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b5be708577447cd2cd5b9e8dacf3b982/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-27T14:40:58+08:00" />
<meta property="article:modified_time" content="2023-12-27T14:40:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">华为 AC&#43;FIT AP 直连二层组网直接转发</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>组网需求</p> 
<ul id="ZH-CN_TASK_0180383107__zh-cn_task_0176912342_ul_network"><li id="ZH-CN_TASK_0180383107__zh-cn_task_0176912342_li1303718807190921">AC组网方式：直连二层组网。</li><li id="ZH-CN_TASK_0180383107__zh-cn_task_0176912342_li461621668190921">DHCP部署方式：AC作为DHCP服务器为AP和STA分配IP地址。</li><li id="ZH-CN_TASK_0180383107__zh-cn_task_0176912342_li389443281190921">业务数据转发方式：直接转发</li></ul> 
<p>拓扑图</p> 
<p><img alt="" height="829" src="https://images2.imgbox.com/f4/f6/wL3oWU3T_o.png" width="800"></p> 
<p>一、交换机设置</p> 
<p>1、基础配置，创建VLAN </p> 
<pre><code class="language-bash">&lt;Huawei&gt;sys
[Huawei]sys SW1
[SW1]un in en

[SW1]vlan batch 2 3</code></pre> 
<p>2、设置交换机与AP下联接口，默认VLAN为2，以实现上游发送数据时剥离VLAN</p> 
<pre><code class="language-bash">[SW1]int g0/0/1
[SW1-GigabitEthernet0/0/1]p l t
[SW1-GigabitEthernet0/0/1]p t p v 2
[SW1-GigabitEthernet0/0/1]p t a v a
[SW1-GigabitEthernet0/0/1]quit</code></pre> 
<p>3、设置交换机与AC上联接口</p> 
<pre><code class="language-bash">[SW1]int g0/0/2
[SW1-GigabitEthernet0/0/2]p l t
[SW1-GigabitEthernet0/0/2]p t a v a
[SW1-GigabitEthernet0/0/2]quit
</code></pre> 
<p>二、AC控制器设置</p> 
<p>1、创建VLAN，为AP跟STA配置DHCP</p> 
<pre><code class="language-bash">&lt;AC6005&gt;sys
[AC6005]sys AC1
[AC1]un in en

[AC1]vlan batch 2 3

[AC1]int g0/0/1
[AC1-GigabitEthernet0/0/1]p l t
[AC1-GigabitEthernet0/0/1]p t a v a
[AC1-GigabitEthernet0/0/1]quit

[AC1]dhcp enable

# 配置DHCP为AP分配地址
[AC1]int vlanif 2
[AC1-Vlanif2]ip addr 192.168.2.1 24
[AC1-Vlanif2]dhcp select int
[AC1-Vlanif2]quit

# 配置DHCP为STA分配地址
[AC1]int vlanif 3
[AC1-Vlanif3]ip addr 192.168.3.1 24
[AC1-Vlanif3]dhcp select int
[AC1-Vlanif3]dhcp server dns-list 114.114.114.114
[AC1-Vlanif3]quit
</code></pre> 
<p>2、创建名为 "empolyee" 的AP组，并引用默认的域管理模板</p> 
<pre><code class="language-bash">[AC1]wlan
[AC1-wlan-view]ap-group name employee
[AC1-wlan-ap-group-employee]regulatory-domain-profile default
Warning: Modifying the country code will clear channel, power and antenna gain c
onfigurations of the radio and reset the AP. Continue?[Y/N]:y
[AC1-wlan-ap-group-employee]quit
[AC1-wlan-view]quit</code></pre> 
<p>3、配置AC的源接口</p> 
<pre><code class="language-bash">[AC1]capwap source interface Vlanif 2</code></pre> 
<p>4、以MAC认证方式添加AP，并添加到AP组中</p> 
<pre><code class="language-bash">[AC1]wlan
[AC1-wlan-view]ap auth-mode mac-auth
[AC1-wlan-view]ap-id 0 ap-mac 00E0-FC28-0710
[AC1-wlan-ap-0]ap-name area1
[AC1-wlan-ap-0]ap-group employee
Warning: This operation may cause AP reset. If the country code changes, it will
 clear channel, power and antenna gain configurations of the radio, Whether to c
ontinue? [Y/N]:y
[AC1-wlan-ap-0]quit</code></pre> 
<p>5、创建安全模板，配置安全策略</p> 
<pre><code class="language-bash">[AC1-wlan-view]security-profile name employee

# 设置无线密码 "12345678"
[AC1-wlan-sec-prof-employee]security wpa-wpa2 psk pass-phrase 12345678 aes
Warning: The current password is too simple. For the sake of security, you are a
dvised to set a password containing at least two of the following: lowercase let
ters a to z, uppercase letters A to Z, digits, and special characters. Continue?
 [Y/N]:y # 确认
[AC1-wlan-sec-prof-employee]quit</code></pre> 
<p>6、创建SSID模板，并配置SSID名称为 "employee"</p> 
<pre><code class="language-bash">[AC1-wlan-view]ssid-profile name employee
[AC1-wlan-ssid-prof-employee]ssid employee
[AC1-wlan-ssid-prof-employee]quit</code></pre> 
<p>7、创建名VAP模板，配置业务数据转发模式、业务VLAN，并且引用安全模板和SSID模板。</p> 
<pre><code class="language-bash">[AC1-wlan-view]vap-profile name employee
[AC1-wlan-vap-prof-employee]forward-mode direct-forward
[AC1-wlan-vap-prof-employee]service-vlan vlan-id 3
[AC1-wlan-vap-prof-employee]security-profile employee
[AC1-wlan-vap-prof-employee]ssid-profile employee
[AC1-wlan-vap-prof-employee]quit</code></pre> 
<p>8、配置AP组引用VAP模板</p> 
<pre><code class="language-bash">[AC1-wlan-view]ap-group name employee
[AC1-wlan-ap-group-employee]vap-profile employee wlan 1 radio all
[AC1-wlan-ap-group-employee]quit
[AC1-wlan-view]quit
</code></pre> 
<p>9、配置跟外网上联接口</p> 
<pre><code class="language-bash">[AC1]int g0/0/2
[AC1-GigabitEthernet0/0/2]p l a
[AC1-GigabitEthernet0/0/2]p d v 137
[AC1-GigabitEthernet0/0/2]int vlanif 137
[AC1-Vlanif137]ip addr 192.168.137.10 24
[AC1-Vlanif137]quit

# 开启AC控制器WEB管理界面
[AC1]http server enable

# 配置NAT实现上网功能
[AC1]acl 2000
[AC1-acl-basic-2000]rule 5 permit source 192.168.3.0 0.0.0.255
[AC1-acl-basic-2000]int vlanif 137
[AC1-Vlanif137]nat outbound 2000
[AC1-Vlanif137]quit

# 配置DNS
[AC1]dns resolve
[AC1]dns server 114.114.114.114

# 配置默认路由
[AC1]ip route-static 0.0.0.0 0.0.0.0 192.168.137.1</code></pre> 
<p>三、测试</p> 
<p>1、显示AP状态，成功获取管理VLAN网段的IP</p> 
<pre><code>[AC1]dis ap all
Info: This operation may take a few seconds. Please wait for a moment.done.
Total AP information:
nor  : normal          [1]
--------------------------------------------------------------------------------
-------------
ID   MAC            Name  Group    IP            Type            State STA Uptim
e
--------------------------------------------------------------------------------
-------------
0    00e0-fc28-0710 area1 employee 192.168.2.156 AP2050DN        nor   1   27M:2
6S
--------------------------------------------------------------------------------
-------------
Total: 1
</code></pre> 
<p>2、STA连接AP，输入上面设置的密码 "12345678"</p> 
<p><img alt="" height="652" src="https://images2.imgbox.com/bf/67/UbgvL540_o.png" width="963"></p> 
<p>3、STA成功获取业务VLAN网段的IP</p> 
<p><img alt="" height="666" src="https://images2.imgbox.com/d8/06/gFokxmpi_o.png" width="976"></p> 
<p>四、查看AC管理界面</p> 
<blockquote> 
 <p><a href="https://192.168.137.10/" rel="nofollow" title="https://192.168.137.10/">https://192.168.137.10/</a>  </p> 
</blockquote> 
<p>账号：admin / admin@huawei.com </p> 
<p><img alt="" height="648" src="https://images2.imgbox.com/e6/5b/u3NQTzsN_o.png" width="930"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1d4e5155b52d2d5136bdd2d73154e56a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【电商应用提升用户体验：抖音商品详情API的技术实践与优化策略无标题】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/30fb1788081638e64188dbe6c49ffb4d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">香橙派5plus从ssd启动Ubuntu</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>