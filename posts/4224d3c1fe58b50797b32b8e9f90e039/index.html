<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于rk3326的ANDROID11 不息屏不锁屏代码修改 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于rk3326的ANDROID11 不息屏不锁屏代码修改" />
<meta property="og:description" content="一、背景
1.硬件平台：RK3326/RK3566
2、操作系统： ANDROID11
取消自动息屏及锁屏界面，修改如下：
二、修改文件：
1、frameworks/base/packages/SettingsProvider/res/values/defaults.xml diff --git a/packages/SettingsProvider/res/values/defaults.xml b/packages/SettingsProvider/res/values/defaults.xml old mode 100644 new mode 100755 index 761d8bcbed00..7b10dcd8c533 --- a/packages/SettingsProvider/res/values/defaults.xml &#43;&#43;&#43; b/packages/SettingsProvider/res/values/defaults.xml @@ -18,7 &#43;18,7 @@ --&gt; &lt;resources&gt; &lt;bool name=&#34;def_dim_screen&#34;&gt;true&lt;/bool&gt; - &lt;integer name=&#34;def_screen_off_timeout&#34;&gt;60000&lt;/integer&gt; &#43; &lt;integer name=&#34;def_screen_off_timeout&#34;&gt;2147483647&lt;/integer&gt; &lt;!-- 取消熄屏，设置为一个非常大的数值，超过2147483647 --&gt; &lt;integer name=&#34;def_sleep_timeout&#34;&gt;-1&lt;/integer&gt; &lt;bool name=&#34;def_airplane_mode_on&#34;&gt;false&lt;/bool&gt; &lt;bool name=&#34;def_theater_mode_on&#34;&gt;false&lt;/bool&gt; @@ -71,7 &#43;71,7 @@ &lt;string name=&#34;def_desk_undock_sound&#34; translatable=&#34;false&#34;&gt;/product/media/audio/ui/Undock.ogg&lt;/string&gt; &lt;string name=&#34;def_car_dock_sound&#34; translatable=&#34;false&#34;&gt;/product/media/audio/ui/Dock.ogg&lt;/string&gt; &lt;string name=&#34;def_car_undock_sound&#34; translatable=&#34;false&#34;&gt;/product/media/audio/ui/Undock.ogg&lt;/string&gt; - &lt;integer name=&#34;def_lockscreen_sounds_enabled&#34;&gt;1&lt;/integer&gt; &#43; &lt;integer name=&#34;def_lockscreen_sounds_enabled&#34;&gt;0&lt;/integer&gt; &lt;!-- 当解锁或是锁屏时是否播放声音 Settings.System.LOCKSCREEN_SOUNDS_ENABLED 0：不播放 --&gt; &lt;string name=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4224d3c1fe58b50797b32b8e9f90e039/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-14T11:25:22+08:00" />
<meta property="article:modified_time" content="2023-09-14T11:25:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于rk3326的ANDROID11 不息屏不锁屏代码修改</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>一、背景</p> 
<p>         1.硬件平台：<a href="https://so.csdn.net/so/search?q=RK3568&amp;spm=1001.2101.3001.7020" title="RK3326">RK3326</a>/RK3566</p> 
<p>        2、操作系统： ANDROID11</p> 
<p>        取消自动息屏及锁屏界面，修改如下：</p> 
<p>二、修改文件：</p> 
<p>1、frameworks/base/packages/SettingsProvider/res/values/defaults.xml </p> 
<pre><code class="language-XML">diff --git a/packages/SettingsProvider/res/values/defaults.xml b/packages/SettingsProvider/res/values/defaults.xml
old mode 100644
new mode 100755
index 761d8bcbed00..7b10dcd8c533
--- a/packages/SettingsProvider/res/values/defaults.xml
+++ b/packages/SettingsProvider/res/values/defaults.xml
@@ -18,7 +18,7 @@
 --&gt;
 &lt;resources&gt;
     &lt;bool name="def_dim_screen"&gt;true&lt;/bool&gt;
-    &lt;integer name="def_screen_off_timeout"&gt;60000&lt;/integer&gt;
+    &lt;integer name="def_screen_off_timeout"&gt;2147483647&lt;/integer&gt;
     &lt;!-- 取消熄屏，设置为一个非常大的数值，超过2147483647 --&gt;
     &lt;integer name="def_sleep_timeout"&gt;-1&lt;/integer&gt;
     &lt;bool name="def_airplane_mode_on"&gt;false&lt;/bool&gt;
     &lt;bool name="def_theater_mode_on"&gt;false&lt;/bool&gt;
@@ -71,7 +71,7 @@
     &lt;string name="def_desk_undock_sound" translatable="false"&gt;/product/media/audio/ui/Undock.ogg&lt;/string&gt;
     &lt;string name="def_car_dock_sound" translatable="false"&gt;/product/media/audio/ui/Dock.ogg&lt;/string&gt;
     &lt;string name="def_car_undock_sound" translatable="false"&gt;/product/media/audio/ui/Undock.ogg&lt;/string&gt;
-    &lt;integer name="def_lockscreen_sounds_enabled"&gt;1&lt;/integer&gt;
+    &lt;integer name="def_lockscreen_sounds_enabled"&gt;0&lt;/integer&gt;
     &lt;!-- 当解锁或是锁屏时是否播放声音    Settings.System.LOCKSCREEN_SOUNDS_ENABLED  0：不播放  --&gt;
     &lt;string name="def_lock_sound" translatable="false"&gt;/product/media/audio/ui/Lock.ogg&lt;/string&gt;
     &lt;string name="def_unlock_sound" translatable="false"&gt;/product/media/audio/ui/Unlock.ogg&lt;/string&gt;
     &lt;string name="def_trusted_sound" translatable="false"&gt;/product/media/audio/ui/Trusted.ogg&lt;/string&gt;
@@ -82,7 +82,7 @@
     &lt;integer name="def_max_sound_trigger_detection_service_ops_per_day" translatable="false"&gt;1000&lt;/integer&gt;
     &lt;integer name="def_sound_trigger_detection_service_op_timeout" translatable="false"&gt;15000&lt;/integer&gt;

-    &lt;bool name="def_lockscreen_disabled"&gt;false&lt;/bool&gt;
+    &lt;bool name="def_lockscreen_disabled"&gt;true&lt;/bool&gt;
     &lt;!-- 默认锁屏已禁用 --&gt;
     &lt;bool name="def_device_provisioned"&gt;false&lt;/bool&gt;
     &lt;integer name="def_dock_audio_media_enabled"&gt;1&lt;/integer&gt;
</code></pre> 
<p>2、device\rockchip\rk3326\overlay\frameworks\base\packages\SettingsProvider\res\values\defaults.xml</p> 
<pre><code class="language-XML">-    &lt;integer name="def_screen_off_timeout"&gt;60000&lt;/integer&gt;
+    &lt;integer name="def_screen_off_timeout"&gt;2147483647&lt;/integer&gt;
&lt;!-- 修改，或者直接删除这一行配置 --&gt;</code></pre> 
<hr> 
<p>3、</p> 
<p>前面2个修改，验证无效果；搜索def_screen_off_timeout发现</p> 
<p>./device/rockchip/common/overlay_go/frameworks/base/packages/SettingsProvider/res/values/defaults.xml </p> 
<p>文件也有此配置</p> 
<pre><code class="language-XML">--- a/overlay_go/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
+++ b/overlay_go/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
@@ -17,7 +17,7 @@
  */
 --&gt;
 &lt;resources&gt;
-    &lt;integer name="def_screen_off_timeout"&gt;60000&lt;/integer&gt;
+    &lt;integer name="def_screen_off_timeout"&gt;0x7fffffff&lt;/integer&gt;
    &lt;!-- Initial value for the Settings.Secure.IMMERSIVE_MODE_CONFIRMATIONS setting,
          which is a comma separated list of packages that no longer need confirmation
          for immersive mode.
</code></pre> 
<p>原来./device/rockchip/common/device.mk 有配置overlay_go</p> 
<p>DEVICE_PACKAGE_OVERLAYS += device/rockchip/common/overlay_go</p> 
<p>4.</p> 
<p>device/rockchip/common/device.mk</p> 
<pre><code class="language-XML">--- a/device.mk
+++ b/device.mk

 PRODUCT_PROPERTY_OVERRIDES += \
     dalvik.vm.boot-dex2oat-threads=4 \
@@ -902,7 +895,7 @@ ifeq ($(strip $(TARGET_BOARD_PLATFORM_PRODUCT)), box)
       ro.rk.screenoff_time=2147483647
 else
 PRODUCT_PROPERTY_OVERRIDES += \
-    ro.rk.screenoff_time=60000
+       ro.rk.screenoff_time=2147483647
 endif

</code></pre> 
<p>至此修改完所有screen_off_timeout 相关数据，打包验证有效！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3cebb5902b4e6d36858eb6a8201ef19e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">「笔记」OfferCoder：剑指Offer刷题笔记</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/94386d453e2f47586c0682a4d328ca74/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">信息技术--案例分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>