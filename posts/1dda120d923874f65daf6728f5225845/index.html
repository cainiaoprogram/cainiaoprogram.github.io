<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>dataframe数据分析常用操作汇总 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="dataframe数据分析常用操作汇总" />
<meta property="og:description" content="dataframe的常用操作汇总
目录
1.建 1
2.读 2
3.存 2
4.阅 2
5.取 2
6.改 4
7.增 4
8.删 5
9.并 5
10.序 7
1.建 创建只有一列的数据框
df = pd.DataFrame([1, 2, 3, 4, 5], columns=[‘宽度’], index=[‘a’, ‘b’, ‘c’, ‘d’, ‘e’])
创建3行2列的数据框
df = pd.DataFrame([[1, 2], [3, 4], [5, 6]], columns=[‘分数’, ‘长度’], index=[‘a’, ‘b’, ‘c’])
对行命名
df.index.name = ‘公司’
创建3行2列的数据框
df = pd.DataFrame({‘key1’: [1, 2, 3], ‘key2’: [4, 5, 6]})
创建2行3列的数据框
df = pd." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1dda120d923874f65daf6728f5225845/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-24T14:59:59+08:00" />
<meta property="article:modified_time" content="2022-11-24T14:59:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">dataframe数据分析常用操作汇总</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>dataframe的常用操作汇总</p> 
<p>目录<br> 1.建 1<br> 2.读 2<br> 3.存 2<br> 4.阅 2<br> 5.取 2<br> 6.改 4<br> 7.增 4<br> 8.删 5<br> 9.并 5<br> 10.序 7</p> 
<h3><a id="1_14"></a>1.建</h3> 
<p>创建只有一列的数据框</p> 
<p>df = pd.DataFrame([1, 2, 3, 4, 5], columns=[‘宽度’], index=[‘a’, ‘b’, ‘c’, ‘d’, ‘e’])</p> 
<p>创建3行2列的数据框</p> 
<p>df = pd.DataFrame([[1, 2], [3, 4], [5, 6]], columns=[‘分数’, ‘长度’], index=[‘a’, ‘b’, ‘c’])</p> 
<p>对行命名</p> 
<p>df.index.name = ‘公司’</p> 
<p>创建3行2列的数据框</p> 
<p>df = pd.DataFrame({‘key1’: [1, 2, 3], ‘key2’: [4, 5, 6]})</p> 
<p>创建2行3列的数据框</p> 
<p>df = pd.DataFrame.from_dict({‘a’: [1, 3, 5], ‘b’: [2, 4, 6]}, orient=“index”)</p> 
<p>创建3行4列的数据框</p> 
<p>df = pd.DataFrame(np.arange(12).reshape(3, 4), index=[1, 2, 3], columns=[‘A’, ‘B’, ‘C’, ‘D’])</p> 
<p>对索引重命名</p> 
<p>df = df.rename(index={‘A’: ‘万科’, ‘B’: ‘阿里’, ‘C’: ‘百度’}, columns={‘date’: ‘日期’, ‘score’: ‘分数’})</p> 
<p>把某列设置为行索引</p> 
<p>df = df.set_index(‘日期’)</p> 
<p>重置行索引，把索引变成数字索引格式</p> 
<p>df = df.reset_index()</p> 
<p>重新建立索引</p> 
<p>df = df.reset_index(drop=True) # 删除原来的索引，重新建立由0开始的索引</p> 
<h3><a id="2_56"></a>2.读</h3> 
<p>df = pd.read_excel(r’D:\codes\dataframe\wine.xls’) # 读取excel文件<br> df = pd.read_csv(r’D:\codes\dataframe\bigfile.csv’) # 读取csv文件</p> 
<h3><a id="3_61"></a>3.存</h3> 
<p>df.to_excel(r’D:\codes\dataframe\wine1.xls’, index=False) # 保存为excel文件<br> df.to_excel(r’D:\codes\dataframe\data_0.xlsx’, columns=[‘a’, ‘f’], index=False) # 保存a列和f列<br> df.to_csv(r’D:\codes\bigfile1.csv’, encoding=‘utf-8’, index=False) # 保存为csv文件<br> df.to_csv(r’D:\codes\bigfile1.csv’, encoding=‘gb18030’, index=False) # 保存为csv文件</p> 
<h3><a id="4_68"></a>4.阅</h3> 
<p>df.index # 展示数据框的行的名称<br> df.columns # 展示数据框的列的名称<br> df.values # 数控框中间的取值<br> df.size # 数据框值的个数<br> df.ndim<br> df.T.shape<br> df.head() # 查看前5行的数据<br> df.tail() # 查看最后5行的数据<br> df.shape # 查看数据库的要素<br> df.dtypes # 查看数据表的类型<br> df.info() # 查看数据的基本信息<br> df[‘b’].value_counts() # 统计b列中数值出现的次数<br> df.describe() # 查看基本的统计信息（最大、最小、平均、中位、四分位、标准差）</p> 
<h3><a id="5_84"></a>5.取</h3> 
<p>取元素</p> 
<p>df.iloc[0][‘d’] # 选取第1行d列的值<br> df[[‘b’, ‘d’]][0:2] # 选取b列、d列；第1行和第2行的值<br> df.iloc[6, 5] # 选取第7行第6列的值<br> df.iloc[3, 2:4] # 选取第4行，第3、第4列的值<br> df.iloc[6, [5]] # 选取第7行第6列的值，结果类型为Series<br> df.iloc[[6], 5] # 选取第7行第6列的值，结果类型为Series<br> df.iloc[[6], [5]] # 选取第7行第6列的值，结果类型为DataFrame<br> df.iloc[1:3, 2] # 选取第2、第3行叁列的值<br> df.iloc[1:3, [2]] # 选取第2、第3行叁列的值<br> df.iloc[1:3, 2:4] # 选取第2、3行，第3、4列的值<br> df.iloc[1:3, [2, 4]] # 选取第2、3行，第3、4列的值<br> df.iloc[[1, 3], [0]] # 选取第2、3行，第1列的值<br> df.iloc[[1, 3], [0, 4]] # 选取第2、第4行，第1、第5列的值<br> df.iloc[:2, :3] # 选取前两行，前三列的值<br> df.loc[‘one’, [‘b’, ‘d’]] # 返回‘a’行’w’、'x’列，这种用于选取行索引列索引已知<br> df.loc[‘four’, ‘f’] # 选取four行f列的值<br> df1 = df[(df[‘d’] &gt; 1) &amp; (df[‘g’] == 6)] # 取d列大于1且g列等于6的行</p> 
<p>取行 ——单行</p> 
<p>df[1:2] # 选取第2行，返回的是DataFrame<br> df[-1:] # 选取最后1行，返回的是DataFrame<br> df.loc[‘four’] # 选取four列，返回的是Series<br> df.loc[[‘four’]] # 选取four列，返回的是DataFrame<br> df.iloc[-1] # 选取DataFrame最后一行，返回的是Series<br> df.iloc[-1:] # 选取DataFrame最后一行，返回的是DataFrame<br> df.iloc[[-1]] # 选取DataFrame最后一行，返回的是DataFrame<br> df.iloc[0, :] # 选取第1行，返回的是Series<br> df.iloc[0] # 选取第1行，返回的是Series<br> df.iloc[[0]] # 选取第1行，返回的是DataFrame</p> 
<p>取行 ——多行</p> 
<p>df[‘three’:‘six’] # 选取three到six，返回的是<strong>前闭后闭</strong>的DataFrame<br> df.loc[[‘three’, ‘six’]] # 选取three行和six行<br> df.iloc[:2, :] # 选取第1行到第2行<br> df.iloc[:-2] # 选取第1行到倒数第3行<br> df.iloc[[0, 3, 5]] # 选取第1、第4、第6行<br> df.iloc[0:4] # 选取第1到第4行共4行<br> df[0:2] # 取第1行到第2行的所有行，前闭后开，包括前不包括后<br> df.head() # 选取前5行，需要前10行则dta.head(10)<br> df.tail() # 选取后5行，需要后10行则data.tail(10)</p> 
<p>取列 ——单列</p> 
<p>df.e # 取e列, 使用点属性,返回的是Series类型<br> df[‘e’] # 取e列, 使用类字典属性,返回的是Series类型<br> df[[‘e’]] # 取e列，返回的是DataFrame属性<br> df.叁 # 选取叁列, 使用点属性,返回的是Series类型<br> df[‘叁’] # 选取叁列, 使用类字典属性,返回的是Series类型<br> df[[‘叁’]] # 选取叁列，返回的是DataFrame属性<br> df.iloc[:, 0] # 选取第1列，返回的是Series类型<br> df.iloc[:, [0]] # 选取第1列，返回的是DataFrame</p> 
<p>取列 ——多列</p> 
<p>df[[‘a’, ‘d’]] # 选取a、d两列，返回的是DataFrame<br> df.loc[:, ‘a’:‘e’] # 选取从a到e的所有列，返回的是DataFrame<br> df.iloc[:, :3] # 选取第1到第3列，返回的是DataFrame<br> df.iloc[:, 0:4] # 选取第1到第4列，返回的是DataFrame<br> df.iloc[:, [0, 3, 5]] # 选取第1、第4、第6列</p> 
<h3><a id="6_151"></a>6.改</h3> 
<p>df.columns=[‘name1’, ‘name2’] # 修改列索引名称<br> df1 = df.rename({‘one’: ‘一’}) # 把“one”行的名称修改为“一”<br> df1 = df.rename(columns={‘d’: ‘D’}) # 把“d”列的名称修改为“D”<br> df1 = df.rename(index={‘three’: ‘三’, ‘four’: ‘四’}, columns={‘e’: ‘E’, ‘g’: ‘G’}) # 修改行，列的名称<br> df1 = df.set_index(‘g’) # 把g列变成行索引<br> df[‘d’].astype(‘string’) # 把“d”列的int32数据变为字符串<br> df1 = df.reset_index(drop=True) # 删除原来的索引，重新建立由0开始的索引<br> df1 = df.reset_index() # 把行索引变成列名为index的列，行索引修改成按数字排列<br> df1.index.name = ‘中文’ # 对行索引命名为中文<br> print(df1)</p> 
<h3><a id="7_164"></a>7.增</h3> 
<p>增加列<br> df[‘列名称’] = list_data # 增加新的一列<br> df.insert(3,‘列名称’,list_data) # 在索引为3的位置插入新的一行</p> 
<p>增加行<br> df.iloc[1] = list_data # 在索引为1的位置插入行</p> 
<p>合并dataframe<br> df = pd.merge(df1, df2, how=‘left’, on=[‘key1’, ‘key2’])</p> 
<p>df = df1.join(df2, on=[‘key1’, ‘key2’], how=‘inner’)</p> 
<p>df = df.append(df_new)</p> 
<p>df = pd.concat([df1, df2])</p> 
<h3><a id="8_182"></a>8.删</h3> 
<p>df1 = df.drop(columns=‘e’) # 删掉“e”列<br> df1 = df.drop(columns=[‘b’, ‘d’]) # 删掉“b”列和“d”列<br> df1 = df.drop([‘b’, ‘d’], axis=1) # 删掉“b”列和“d”列<br> df1 = df.drop([‘three’, ‘six’]) # 删掉“three”行和“six”行<br> df1 = df.drop([‘three’, ‘six’], axis=0) # 删掉“three”行和“six”行<br> df1 = df.drop(‘four’) # 删掉“four”行<br> df1 = df.drop(index=[‘five’, ‘seven’]) # 删掉“five”行和“seven”行<br> df1 = df[~df[‘a’].isin([0])] # 删除’a’列数据中为0的行（或理解为取出’a’列数据不为0的行）<br> df1 = df[df[‘a’].isin([0])] # 删除’a’列数据不为0的值（或理解为取出’a’列数据为0的行）<br> df1 = df[df[‘f’] &gt; 19] # 删除’f’列数据小于19的行（或理解为取出数据大于19的行）</p> 
<h3><a id="9_195"></a>9.并</h3> 
<p>df = pd.DataFrame(np.arange(49).reshape(7, 7), index=[‘one’, ‘二’, ‘three’, ‘four’, ‘five’, ‘six’, ‘seven’], columns=[‘a’, ‘b’, ‘叁’, ‘d’, ‘e’, ‘f’, ‘g’])<br> df1 = pd.DataFrame(np.arange(14).reshape(2, 7), index=[‘eight’, ‘nine’], columns=[‘a’, ‘b’, ‘叁’, ‘d’, ‘e’, ‘f’, ‘g’])<br> df2 = pd.DataFrame(np.arange(14).reshape(7, 2), index=[‘one’, ‘二’, ‘three’, ‘four’, ‘five’, ‘six’, ‘seven’], columns=[‘h’, ‘i’])<br> df3 = pd.DataFrame(np.arange(14).reshape(2, 7), index=[‘one’, ‘nine’], columns=[‘a’, ‘b’, ‘叁’, ‘d’, ‘e’, ‘f’, ‘g’])<br> df4 = pd.DataFrame(np.arange(14).reshape(7, 2), index=[‘one’, ‘二’, ‘three’, ‘four’, ‘five’, ‘six’, ‘seven’], columns=[‘b’, ‘i’])</p> 
<p>result = pd.concat([df, df2, df4], axis=0) # 3个数据框简单叠加<br> result = pd.concat([df, df1], axis=0) # 两个列索引相同、行索引不同的dataframe按行相加<br> result = pd.concat([df, df1], axis=1) # 两个列索引相同、行索引不同的dataframe按列相加<br> result = pd.concat([df, df3], axis=0) # 两个列索引相同、行索引部分相同的dataframe按行相加<br> result = pd.concat([df, df3], axis=1) # 两个列索引相同、行索引部分相同的dataframe按列相加<br> result = pd.concat([df1, df3], axis=0) # 两个列索引相同、行索引部分相同的dataframe按行相加<br> result = pd.concat([df1, df3], axis=1) # 两个列索引相同、行索引部分相同的dataframe按列相加</p> 
<p>result = df.merge(df3) # 自动找相同的元素合并两个表<br> result = pd.merge(df, df1) # 根据两个表格中相同列中相同元素合并，自动找相同的元素<br> result = pd.merge(df, df1, on=‘a’) # 根据a列合并，两个表中a列相同元素的行保留，<br> result = pd.merge(df, df1, on=[‘a’, ‘f’]) # 根据a列和f列合并，两个表中a列和f列相同元素的行保留<br> result = pd.merge(df, df2) # 没有相同列的两个表格合并，保留最多的列，最少的行<br> result = pd.merge(df2, df) # 没有相同列的两个表格合并，<br> result = pd.merge(df, df4, how=‘outer’) # 两个表合并，取并集，保留所有的行和列<br> result = pd.merge(df, df4, how=‘inner’) # 两个表合并，取交集，保留左右表的共同内容<br> result = pd.merge(df, df4, how=‘left’) # 两个表合并，左表所有内容都保留，右表保留和左表相同的内容<br> result = pd.merge(df, df4, how=‘right’) # 两个表合并，右表所有内容都保留，左表保留和左表相同的内容<br> result = pd.merge(df, df1, left_index=True, right_index=True) # 以两个数据框的行索引合并，相同的索引保留，没有相同的就是空集</p> 
<p>result = df.append(df1) # 两个数据行相加</p> 
<p>pd.merge(df1, # 第1个数据表<br> df2, # 第2个数据表<br> how=‘inner’, # inner交集/outer并集/left左全保留右保留相同的/right右全保留<br> on=None, # 根据某个字段进行连接，必须存在于两个DateFrame中（若未同时存在，则需要分别使用left_on和right_on来设置）<br> left_on=None, # 左连接，以DataFrame1中用作连接键的列<br> right_on=None, # 右连接，以DataFrame2中用作连接键的列<br> left_index=False, # 将DataFrame1行索引用作连接键<br> right_index=False, # 将DataFrame2行索引用作连接键<br> sort=False, # 根据连接键对合并后的数据进行排列，默认为True<br> suffixes=(‘_x’, ‘_y’), # 对两个数据集中出现的重复列，新数据集中加上后缀_x,_y进行区别<br> copy=True,<br> indicator=False,<br> validate=None<br> )<br> pd.concat(objs,<br> axis=0,<br> join=‘outer’,<br> join_axes=None,<br> ignore_index=False,<br> keys=None,<br> levels=None,<br> names=None,<br> verify_integrity=False,<br> sort=None,<br> copy=True<br> )<br> pd.join(other,<br> on=None,<br> how=‘left’,<br> lsuffix=‘’,<br> rsuffix=‘’,<br> sort=False<br> )</p> 
<h3><a id="10_259"></a>10.序</h3> 
<p>df1 = df.sort_index() # 根据行索引升序排列<br> df1 = df.sort_index(axis=0) # 根据行索引升序排列<br> df1 = df.sort_index(axis=1) # 根据列索引升序排列<br> df1 = df.sort_index(ascending=False) # 根据行索引降序排列<br> df1 = df.sort_index(ascending=True) # 根据行索引升序排列<br> df1 = df.sort_index(inplace=False) # 根据索引值排序，原数组df不变。<br> df1 = df.sort_index(inplace=True) # 根据索引值排序，原数组df变化。<br> df1 = df.sort_values(by=‘b’) # 把b列的数据升序排序，其他数据跟随变化<br> df1 = df.sort_values(by=‘b’, ascending=True) # 把b列的数据升序排序，其他数据跟随变化<br> df1 = df.sort_values(by=‘b’, ascending=False) # 把b列的数据降序排序，其他数据跟随变化<br> df1 = df.sort_values(by=[‘a’, ‘d’], ascending=False) # 把a和d列的数据降序排列</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e65591fbd83e5ee32328ad132fb25424/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ubuntu下载cuda</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a470d78945fcb1b9db5bf6e0014a3af7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">脑电数据相关分析参数 定义 后续实现陆续增加</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>