<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python自动化办公:批量识别图片文字并存为Excel - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python自动化办公:批量识别图片文字并存为Excel" />
<meta property="og:description" content="超级无敌干货，第一时间送达！！！
一、背景 大家好，我是程序员晓晓。
也许你还记得，前不久复旦大学一博士生写了130行Python代码，批量识别核酸截图内容的故事。当时还被人民日报公众号报道出来，夸赞用所学贡献青春力量！
其实，批量文字识别（OCR）是Python办公自动化的基本操作，应用在我们工作生活中的方方面面，比如车牌识别、证件识别、银行卡识别、票据识别等等。
Python中OCR第三方库非常多，比如easyocr、PaddleOCR、cnocr等等。当然，直接调用百度API也是可以的，不过超过一定限额后要收费，因此本文主要以开源免费的easyocr来进行介绍。
二、需求 本文以证件识别为例，我网上找了3张虚拟身份证来实验：
运用easyocr进行识别并保存为Excel，效果如下：
三、实战 1.安装模块 在Python中使用 easyocr非常简单，只要使用pip命令安装easyocr 即可（建议使用清华源，否则安装会比较慢）。
pip install easyocr 不过 easyocr 的深度学习算法依赖于另一个著名的第三方模块 pytorch，图形处理部分则会用到 opencv、Pillow 等，所以还需要确保自己电脑上已经安装这些基础模块。
2.识别一张图片 1.easyocr识别图片代码非常简洁，只需要创建一个easyocr.Reader类对象，指定以下两个常用参数：
需要识别的文字属于哪几种语言
是否启用GPU显卡加速
2.调用Reader对象的readtext方法，将图片中所有文字读入一个列表并返回。
&#39;&#39;&#39; 公众号：编程IT资料库 &#39;&#39;&#39; # 导入模块 import easyocr # 图片路径 image = &#39;./id_card/1.jpg&#39; # 创建ocr的reader对象，识别中英文 ocr = easyocr.Reader([&#39;ch_sim&#39;, &#39;en&#39;],gpu=False) # 识别图片文字 content = ocr.readtext(image) print(content) 识别结果如下：
[([[39, 31], [207, 31], [207, 67], [39, 67]], &#39;姓 名 韦小宝&#39;, 0.8973890994570185), ([[40, 82], [159, 82], [159, 119], [40, 119]], &#39;性 别 男&#39;, 0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/51317e17bc807050e25f876f0eb7977a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-11T15:36:42+08:00" />
<meta property="article:modified_time" content="2024-01-11T15:36:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python自动化办公:批量识别图片文字并存为Excel</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>超级无敌干货，第一时间送达！！！</p> 
<p><img src="https://images2.imgbox.com/b1/76/1wWAWAvA_o.jpg" alt=""></p> 
<h3><a id="_8"></a>一、背景</h3> 
<p>大家好，我是程序员晓晓。</p> 
<p>也许你还记得，前不久复旦大学一博士生写了130行<code>Python</code>代码，批量识别核酸截图内容的故事。当时还被人民日报公众号报道出来，夸赞用所学贡献青春力量！</p> 
<p>其实，批量文字识别（<strong>OCR</strong>）是<code>Python</code>办公自动化的基本操作，应用在我们工作生活中的方方面面，比如车牌识别、证件识别、银行卡识别、票据识别等等。</p> 
<p><code>Python</code>中<code>OCR</code>第三方库非常多，比如<code>easyocr</code>、<code>PaddleOCR</code>、<code>cnocr</code>等等。当然，直接调用百度<code>API</code>也是可以的，不过超过一定限额后要收费，因此本文主要以开源免费的<code>easyocr</code>来进行介绍。</p> 
<h3><a id="_19"></a>二、需求</h3> 
<p>本文以证件识别为例，我网上找了3张虚拟身份证来实验：</p> 
<p><img src="https://images2.imgbox.com/0a/ba/nusZp6q1_o.png" alt=""></p> 
<p>运用<code>easyocr</code>进行识别并保存为<code>Excel</code>，效果如下：</p> 
<p><img src="https://images2.imgbox.com/0d/07/aGgXE0AQ_o.png" alt=""></p> 
<h3><a id="_32"></a>三、实战</h3> 
<h4><a id="1_35"></a>1.安装模块</h4> 
<p>在<code>Python</code>中使用 <code>easyocr</code>非常简单，只要使用<code>pip</code>命令安装<code>easyocr</code> 即可（建议使用清华源，否则安装会比较慢）。</p> 
<pre><code>pip install easyocr   
</code></pre> 
<p>不过 <code>easyocr</code> 的深度学习算法依赖于另一个著名的第三方模块 <code>pytorch</code>，图形处理部分则会用到 <code>opencv</code>、<code>Pillow</code> 等，所以还需要确保自己电脑上已经安装这些基础模块。</p> 
<h4><a id="2_45"></a>2.识别一张图片</h4> 
<p>1.<code>easyocr</code>识别图片代码非常简洁，只需要创建一个<code>easyocr.Reader</code>类对象，指定以下两个常用参数：</p> 
<ul><li> <p>需要识别的文字属于哪几种语言</p> </li><li> <p>是否启用GPU显卡加速</p> </li></ul> 
<p>2.调用<code>Reader</code>对象的<code>readtext</code>方法，将图片中所有文字读入一个列表并返回。</p> 
<pre><code class="prism language-bash"><span class="token string">''</span>'
公众号：编程IT资料库
<span class="token string">''</span>'
<span class="token comment"># 导入模块</span>
<span class="token function">import</span> easyocr
<span class="token comment"># 图片路径</span>
image <span class="token operator">=</span> <span class="token string">'./id_card/1.jpg'</span>
<span class="token comment"># 创建ocr的reader对象，识别中英文</span>
ocr <span class="token operator">=</span> easyocr.Reader<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ch_sim'</span>, <span class="token string">'en'</span><span class="token punctuation">]</span>,gpu<span class="token operator">=</span>False<span class="token punctuation">)</span>
<span class="token comment"># 识别图片文字</span>
content <span class="token operator">=</span> ocr.readtext<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
</code></pre> 
<p>识别结果如下：</p> 
<pre><code>[([[39, 31], [207, 31], [207, 67], [39, 67]], '姓  名  韦小宝', 0.8973890994570185), ([[40, 82], [159, 82], [159, 119], [40, 119]], '性  别  男', 0.9799311480828728), ([[178, 86], [272, 86], [272, 116], [178, 116]], '民 族汉', 0.5456928014755249), ([[40, 131], [100, 131], [100, 161], [40, 161]], '出  生', 0.5362269878387451), ([[114, 134], [240, 134], [240, 162], [114, 162]], '1654 年12', 0.6952526392609933), ([[266, 134], [322, 134], [322, 162], [266, 162]], '20日', 0.31329770168285426), ([[42, 181], [395, 181], [395, 213], [42, 213]], '住  址  北京市东城区景山前街4号', 0.48138251996753667), ([[112, 222], [256, 222], [256, 254], [112, 254]], '紫禁城敬事房', 0.9732440311960702), ([[44, 307], [195, 307], [195, 337], [44, 337]], '公民身份证号码', 0.612808391503521), ([[212, 308], [526, 308], [526, 334], [212, 334]], '112044165412202438', 0.7003081027071493)]   
</code></pre> 
<p><code>readtext</code> 返回的列表中，每个元素都是一个元组，内含三个信息：位置、文字、置信度。我们可以在调用<code>readtext</code>时指定一个参数 <code>detail=0</code>，从而只返回文字内容。于是修改后代码和效果如下：</p> 
<pre><code class="prism language-bash"><span class="token function">import</span> easyocr
image <span class="token operator">=</span> <span class="token string">'./id_card/1.jpg'</span>
ocr <span class="token operator">=</span> easyocr.Reader<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ch_sim'</span>, <span class="token string">'en'</span><span class="token punctuation">]</span>,gpu<span class="token operator">=</span>False<span class="token punctuation">)</span>
content <span class="token operator">=</span> ocr.readtext<span class="token punctuation">(</span>image,detail<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
</code></pre> 
<pre><code>['姓  名  韦小宝', '性  别  男', '民 族汉', '出  生', '1654 年12', '20日', '住  址  北京市东城区景山前街4号', '紫禁城敬事房', '公民身份证号码', '112044165412202438']   
</code></pre> 
<h4><a id="3_91"></a>3.批量识别图片</h4> 
<p>批量识别图片无非就是遍历图片文件夹，这里用到了<code>os.listdir()</code>方法以返回文件列表。然后用<code>ocr.readtext()</code>去识别每一张图片文字内容，接着通过字符串切片来获取姓名、性别、民族、出生、住址和身份证号等关键信息，最后统一将这些信息存入列表<code>data</code>中。</p> 
<pre><code class="prism language-bash"><span class="token string">''</span>'
公众号：编程IT资料库
<span class="token string">''</span>'

<span class="token function">import</span> easyocr
<span class="token function">import</span> os

<span class="token comment"># 指明所有图片所在的文件夹</span>
images <span class="token operator">=</span> <span class="token string">'./id_card'</span>
<span class="token comment"># 创建ocr的reader对象，识别中英文</span>
ocr <span class="token operator">=</span> easyocr.Reader<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ch_sim'</span>, <span class="token string">'en'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 识别图片文字</span>
content <span class="token operator">=</span> ocr.readtext<span class="token punctuation">(</span>images,detail<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># 遍历所有图片并识别文字，切片提取有效信息</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">image</span> <span class="token keyword">in</span> os.listdir<span class="token punctuation">(</span>images<span class="token punctuation">)</span>:
    content <span class="token operator">=</span> ocr.readtext<span class="token punctuation">(</span>f<span class="token string">'{images}/{image}'</span>, <span class="token assign-left variable">detail</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    print<span class="token punctuation">(</span>f<span class="token string">"正在识别：{image}"</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> content<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span>:<span class="token punctuation">]</span>
    gender <span class="token operator">=</span> content<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>-1<span class="token punctuation">]</span>
    nation <span class="token operator">=</span> content<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>-1<span class="token punctuation">]</span>
    birth <span class="token operator">=</span> content<span class="token punctuation">[</span>-5<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token string">"月"</span> not <span class="token keyword">in</span> birth:
        birth <span class="token operator">=</span> content<span class="token punctuation">[</span>-6<span class="token punctuation">]</span> + <span class="token string">"月"</span> + content<span class="token punctuation">[</span>-5<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token string">"日"</span> not <span class="token keyword">in</span> birth:
        birth <span class="token operator">=</span> birth<span class="token punctuation">[</span>:-1<span class="token punctuation">]</span> + <span class="token string">"日"</span>
    address <span class="token operator">=</span> content<span class="token punctuation">[</span>-4<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span>:<span class="token punctuation">]</span> + content<span class="token punctuation">[</span>-3<span class="token punctuation">]</span>
    number <span class="token operator">=</span> content<span class="token punctuation">[</span>-1<span class="token punctuation">]</span>
    print<span class="token punctuation">(</span>f<span class="token string">"完成识别：{image}"</span><span class="token punctuation">)</span>
    print<span class="token punctuation">(</span><span class="token string">"-"</span> * <span class="token number">50</span><span class="token punctuation">)</span>
    data.append<span class="token punctuation">(</span><span class="token punctuation">[</span>name, gender, nation, birth, address, number<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="4_129"></a>4.保存数据</h4> 
<p>图片文字识别之后，建议通过<code>pandas</code>输出为<code>Excel</code>，方便简洁。</p> 
<pre><code class="prism language-bash"><span class="token function">import</span> pandas as pd

<span class="token comment"># 保存识别结果至Excel</span>
<span class="token function">df</span> <span class="token operator">=</span> pd.DataFrame<span class="token punctuation">(</span>data, <span class="token assign-left variable">columns</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"姓名"</span>, <span class="token string">"性别"</span>, <span class="token string">"民族"</span>, <span class="token string">"出生"</span>, <span class="token string">"住址"</span>, <span class="token string">"身份证号"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>f<span class="token string">"识别结果如下："</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
df.to_excel<span class="token punctuation">(</span><span class="token string">"识别结果.xlsx"</span>, <span class="token assign-left variable">index</span><span class="token operator">=</span>False<span class="token punctuation">)</span>
</code></pre> 
<p><font face="幼圆" size="4" color="red">感兴趣的小伙伴，赠送全套Python学习资料，包含面试题、简历资料等具体看下方。<br> </font><br> <img src="https://images2.imgbox.com/b8/a3/eF8nfrh4_o.png"></p> 
<p><strong>一、Python所有方向的学习路线</strong></p> 
<p>Python所有方向的技术点做的整理，形成各个领域的知识点汇总，它的用处就在于，你可以按照下面的知识点去找对应的学习资源，保证自己学得较为全面。</p> 
<p><img src="https://images2.imgbox.com/90/70/n7z8VF6I_o.png" alt="img"><br> <img src="https://images2.imgbox.com/fc/28/KIdOl7Yd_o.png" alt="img"></p> 
<p><strong>二、Python必备开发工具</strong></p> 
<p>工具都帮大家整理好了，安装就可直接上手！<img src="https://images2.imgbox.com/d9/ed/qwb94dVO_o.gif" alt="img"></p> 
<p><strong>三、最新Python学习笔记</strong></p> 
<p>当我学到一定基础，有自己的理解能力的时候，会去阅读一些前辈整理的书籍或者手写的笔记资料，这些笔记详细记载了他们对一些技术点的理解，这些理解是比较独到，可以学到不一样的思路。</p> 
<p><img src="https://images2.imgbox.com/b8/8e/1Fh4Y4cE_o.png" alt="img"></p> 
<p><strong>四、Python视频合集</strong></p> 
<p>观看全面零基础学习视频，看视频学习是最快捷也是最有效果的方式，跟着视频中老师的思路，从基础到深入，还是很容易入门的。</p> 
<p><img src="https://images2.imgbox.com/06/e9/ZJVNnpRQ_o.png" alt="img"></p> 
<p><strong>五、实战案例</strong></p> 
<p>纸上得来终觉浅，要学会跟着视频一起敲，要动手实操，才能将自己的所学运用到实际当中去，这时候可以搞点实战案例来学习。</p> 
<p><img src="https://images2.imgbox.com/ab/ef/57YKMEyr_o.png" alt="img"></p> 
<p><strong>六、面试宝典</strong></p> 
<p><img src="https://images2.imgbox.com/b0/95/Misl7igw_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/0f/ed/lt8pkvwJ_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="httpsimgblogcsdnimgcn646863996ac44da8af500c049bb72fbdpngpic_center_189"></a><strong>简历模板</strong><img src="https://images2.imgbox.com/4e/8e/AjTjR37P_o.png" alt="在这里插入图片描述"></h6> 
<img src="https://images2.imgbox.com/ed/e9/igfc8rB3_o.png"> 若有侵权，请联系删除
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/82120df21ffeed3d3743df076a1d7271/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">试用 Coroot，一个基于 eBPF 的可观测性工具，用于 Kubernetes 等</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0f125cc423ee9fabbdcb1d0768008444/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">PDB/AMF格式在线转换</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>