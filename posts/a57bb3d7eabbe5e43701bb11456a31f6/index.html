<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>leetcode4. 寻找两个正序数组的中位数python_二分查找和递归（困难） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="leetcode4. 寻找两个正序数组的中位数python_二分查找和递归（困难）" />
<meta property="og:description" content="题目 给定两个大小分别为 m 和 n 的正序（从小到大）数组 nums1 和 nums2。请你找出并返回这两个正序数组的 中位数 。算法的时间复杂度应该为 O(log (m&#43;n)) 。
示例 1：
输入：nums1 = [1,3], nums2 = [2]
输出：2.00000
解释：合并数组 = [1,2,3] ，中位数 2
示例 2：
输入：nums1 = [1,2], nums2 = [3,4]
输出：2.50000
解释：合并数组 = [1,2,3,4] ，中位数 (2 &#43; 3) / 2 = 2.5
提示：
nums1.length == m
nums2.length == n
0 &lt;= m &lt;= 1000
0 &lt;= n &lt;= 1000
1 &lt;= m &#43; n &lt;= 2000" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a57bb3d7eabbe5e43701bb11456a31f6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-01T10:48:55+08:00" />
<meta property="article:modified_time" content="2022-12-01T10:48:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">leetcode4. 寻找两个正序数组的中位数python_二分查找和递归（困难）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>题目</h3> 
<p>给定两个大小分别为 m 和 n 的正序（从小到大）数组 nums1 和 nums2。请你找出并返回这两个正序数组的 中位数 。算法的时间复杂度应该为 O(log (m+n)) 。<br> 示例 1：<br> 输入：nums1 = [1,3], nums2 = [2]<br> 输出：2.00000<br> 解释：合并数组 = [1,2,3] ，中位数 2</p> 
<p>示例 2：<br> 输入：nums1 = [1,2], nums2 = [3,4]<br> 输出：2.50000<br> 解释：合并数组 = [1,2,3,4] ，中位数 (2 + 3) / 2 = 2.5</p> 
<p>提示：<br> nums1.length == m<br> nums2.length == n<br> 0 &lt;= m &lt;= 1000<br> 0 &lt;= n &lt;= 1000<br> 1 &lt;= m + n &lt;= 2000<br> -106 &lt;= nums1[i], nums2[i] &lt;= 106</p> 
<h3><a id="_20"></a>思路和代码</h3> 
<p>看到这题，先拼接，再sort，根据长度的奇偶返回中间数或中间两个数的平均，一提交，通过。啊，这题也不难啊。</p> 
<p>不对，sort的时间复杂度是O（nlogn），不满足题目要求。</p> 
<p>题解太难，看了好多天（真的很难看下去啊），有点理解，但不多。有两种方法，一种是二分查找，时间复杂度是O(log (min(m,n)))(哎呀，这个太优秀了，题目要求是O(log (m+n)) ) 。另一种方法就是递归，时间复杂度刚好是题目要求的O(log (m+n)) 。</p> 
<p>先看太优秀的二分查找在这题怎么用。</p> 
<h3><a id="1_29"></a><strong>1.二分查找</strong></h3> 
<p>要来一条线，把num1和nums2分成左边一部分和右边一部分。<br> <img src="https://images2.imgbox.com/1c/ae/0NeL6sKb_o.png" alt="在这里插入图片描述"><br> 我这个图画的真的太丑也太形象了。</p> 
<p><strong>这条线需要满足什么条件？</strong></p> 
<p>1.线左边的元素个数和右边的元素个数差不多，如果两个数组总长度是偶数就两边各半，如果是奇数，左边就多分一个。</p> 
<p>2.左边元素的值都小于等于右边元素的值。更具体的，因为对于各自数组来说，左边的必定小于右边的，所以这里需要满足交叉小于等于条件，即nums1[i-1] &lt;= nums2[j] and nums2[j-1] &lt;=nums1[i]。这里的i表示nums1数组位置i前面有i个元素，同理j表示nums2数组位置j前面有j个元素。</p> 
<p><strong>怎么利用二分查找去找到这条线？</strong></p> 
<p>不必在两个数组都找这条分割线，因为左边的元素个数是知道的，当确定第一个数组的分割线位置，推导一下就可以得到第二个数组的分割线位置。</p> 
<p>更具体的，设totalleft为左边分得的元素个数。如果m+n是奇数，左边分的(m+n+1)//2个元素，如果m+n是偶数，左边有(m+n)//2个元素,又因为//是向下取整，当m+n是偶数，(m+n)//2 和 (m+n+1)//2是相等的。故不论奇偶，都可以用totalleft = (m+n+1)//2来表示。</p> 
<p>当数组nums1的分割线是i时，分割线左边有i个元素。nums1分割线左边的值是nums1[i-1],右边的值就是nums1[i]。而此时，数组nums2的分割线j = totalleft - i。nums2分割线左边的值是nums2[j-1],右边的值就是nums2[j]。</p> 
<p>接下来，我们在较短的数组nums1（开始不是nums1的话，nums1和nums2交换一下）利用二分查找找到合适的分割线。注意，查找范围是[0,m] (左闭右闭，因为分割线可能在num1的最右边)。所以初始时left=0，right=m(而不是right=m-1)</p> 
<p>我们要找到满足条件nums1[i-1] &lt;= nums2[j] and nums2[j-1] &lt;=nums1[i]的分割线，对该条件取反，只要其中一个一条不满足即可。</p> 
<p>i是中间的数，即i=left+（right-left）//2。我们判断nums1[i-1] &gt; nums2[j],说明线画的靠右了，要往左边找，故right = i-1，否则left=i。</p> 
<p>注意，当数组只有两个数的时候[left,right],i=left陷入死循环，所以开始求中间位置的时候写成i=left+（right-left+1）//2 。（高，实在是高，我自己肯定想不出来啊，其实懂都没有太懂，反正这样写就可以避免死循环。）</p> 
<p>最后跳出循环，更新一下分割线，i=left,j=totalleft-i 。</p> 
<p>这就结束了么？并不是！还有一些特殊情况需要处理。例如下图：<br> <img src="https://images2.imgbox.com/5e/9f/yyCpd8zn_o.png" alt="在这里插入图片描述"><br> i和j如果为边界值就会报错，所以当 i=0 的时候，分割线在nums1的最左边。左边求最大值，将nums1的分割线左边值设置为负无穷，同理，j=0时，将nums2的分割线左边值设置为负无穷。而当i = m的时候，分割线在nums1的最右边，右边是求最小值，将nums1分割线右边的值设置为正无穷，同理，j=n的时候，将nums2分割线右边的值设置为正无穷。</p> 
<p>最后总长度是奇数返回左边最大值，是偶数返回左边最大值和右边最小值的平均值。</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">findMedianSortedArrays</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> nums1<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nums2<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nums1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nums2<span class="token punctuation">)</span><span class="token punctuation">:</span>
            nums1<span class="token punctuation">,</span> nums2 <span class="token operator">=</span> nums2<span class="token punctuation">,</span> nums1
        m<span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nums1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nums2<span class="token punctuation">)</span>
        left<span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> m
        totalleft <span class="token operator">=</span> <span class="token punctuation">(</span>m <span class="token operator">+</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
        <span class="token keyword">while</span> left <span class="token operator">&lt;</span> right<span class="token punctuation">:</span>
            i <span class="token operator">=</span> left <span class="token operator">+</span> <span class="token punctuation">(</span>right <span class="token operator">-</span> left <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
            j <span class="token operator">=</span> totalleft <span class="token operator">-</span> i
            <span class="token keyword">if</span> nums1<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> nums2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>
                right <span class="token operator">=</span> i<span class="token operator">-</span><span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                left <span class="token operator">=</span> i
        i <span class="token operator">=</span> left
        j <span class="token operator">=</span> totalleft <span class="token operator">-</span> i
        left1 <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">"-inf"</span><span class="token punctuation">)</span> <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> nums1<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        right1 <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">"inf"</span><span class="token punctuation">)</span> <span class="token keyword">if</span> i <span class="token operator">==</span> m <span class="token keyword">else</span> nums1<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        left2 <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">"-inf"</span><span class="token punctuation">)</span> <span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> nums2<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        right2 <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">"inf"</span><span class="token punctuation">)</span> <span class="token keyword">if</span> j <span class="token operator">==</span> n <span class="token keyword">else</span> nums2<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
        <span class="token keyword">return</span> <span class="token builtin">max</span><span class="token punctuation">(</span>left1<span class="token punctuation">,</span>left2<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token operator">+</span>n<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span> <span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>left1<span class="token punctuation">,</span>left2<span class="token punctuation">)</span><span class="token operator">+</span><span class="token builtin">min</span><span class="token punctuation">(</span>right1<span class="token punctuation">,</span>right2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
</code></pre> 
<p>二分查找的时间复杂度是O（log（min（m，n）））。</p> 
<h3><a id="2_90"></a>2.递归</h3> 
<p>在两个数组中找第k小的数，比较nums1[k//2]和nums2[k//2],如果nums1[k//2] &gt; nums2[k//2]，说明nums2的前k//2中的数都不可能是答案，直接舍去。然后不断舍去一些肯定不是答案的值，直到得到最终结果。大概的思路就是这样。</p> 
<p>再说一些细节。</p> 
<p>递归三要素，参数，终止条件和单层递归逻辑。</p> 
<p>首先参数是两个数组，各自的起始位置，和要求的第k个小的数。<br> findmin（self，nums1，start1，end1, nums2, start2, end2, k）。</p> 
<p>终止条件：</p> 
<p>其中两个数组的长度len1，len2分别是end1-start1+1,end2-start2+1。</p> 
<p>1.当较短的数组长度为0时，直接返回较长数组的第k小的数。<br> 2.当k为1的时候，取两个数组首位元素的较小值。</p> 
<p>单层递归逻辑，为了防止越界，nums1的第k小的数位置为i = start1 + min(len1，k//2)-1，j = start2 +min(len2,k//2)-1</p> 
<p>当nums1[i] &gt; nums2[j]，舍去nums2的前部分，nums2的起始位置变成了j+1，要求得的第k小的数，变成了求第k-（j-start2）-1小的数。否则，舍去nums1前面的部分，nums1的起始位置变成了i+1，要求得的第k小的数，变成了求第k-（i-start2）-1小的数。</p> 
<p>代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">findMedianSortedArrays</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> nums1<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nums2<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        m<span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nums1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nums2<span class="token punctuation">)</span>
        left <span class="token operator">=</span> <span class="token punctuation">(</span>m<span class="token operator">+</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
        right <span class="token operator">=</span> <span class="token punctuation">(</span>m<span class="token operator">+</span>n<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>findkmin<span class="token punctuation">(</span>nums1<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>m<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>nums2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>left<span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>findkmin<span class="token punctuation">(</span>nums1<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>m<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>nums2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>right<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>

    <span class="token keyword">def</span> <span class="token function">findkmin</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>nums1<span class="token punctuation">,</span>start1<span class="token punctuation">,</span>end1<span class="token punctuation">,</span>nums2<span class="token punctuation">,</span>start2<span class="token punctuation">,</span>end2<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        len1<span class="token punctuation">,</span> len2 <span class="token operator">=</span> end1 <span class="token operator">-</span> start1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> end2 <span class="token operator">-</span> start2 <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">if</span> len1 <span class="token operator">&gt;</span> len2<span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>findkmin<span class="token punctuation">(</span>nums2<span class="token punctuation">,</span>start2<span class="token punctuation">,</span>end2<span class="token punctuation">,</span>nums1<span class="token punctuation">,</span>start1<span class="token punctuation">,</span>end1<span class="token punctuation">,</span>k<span class="token punctuation">)</span>
        <span class="token keyword">if</span> len1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> nums2<span class="token punctuation">[</span>start2 <span class="token operator">+</span> k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token builtin">min</span><span class="token punctuation">(</span>nums1<span class="token punctuation">[</span>start1<span class="token punctuation">]</span><span class="token punctuation">,</span>nums2<span class="token punctuation">[</span>start2<span class="token punctuation">]</span><span class="token punctuation">)</span>
        i <span class="token operator">=</span> start1 <span class="token operator">+</span> <span class="token builtin">min</span><span class="token punctuation">(</span>k<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">,</span>len1<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span>
        j <span class="token operator">=</span> start2 <span class="token operator">+</span> <span class="token builtin">min</span><span class="token punctuation">(</span>k<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">,</span>len2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">if</span> nums1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> nums2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>findkmin<span class="token punctuation">(</span>nums1<span class="token punctuation">,</span>start1<span class="token punctuation">,</span>end1<span class="token punctuation">,</span>nums2<span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>end2<span class="token punctuation">,</span>k<span class="token operator">-</span><span class="token punctuation">(</span>j<span class="token operator">-</span>start2<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>findkmin<span class="token punctuation">(</span>nums1<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>end1<span class="token punctuation">,</span>nums2<span class="token punctuation">,</span>start2<span class="token punctuation">,</span>end2<span class="token punctuation">,</span>k<span class="token operator">-</span><span class="token punctuation">(</span>i<span class="token operator">-</span>start1<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>时间复杂度是O（log（m+n））。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e9068360ca5253c7762e4e5712030aa6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ORACLE添加只读权限的用户</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/34d1427eb40045aecf0c5a72aa5307f1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Android】Fragment使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>