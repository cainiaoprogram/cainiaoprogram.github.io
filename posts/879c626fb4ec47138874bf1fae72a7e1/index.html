<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>笛卡尔空间轨迹规划（直线、圆弧） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="笛卡尔空间轨迹规划（直线、圆弧）" />
<meta property="og:description" content="目录
毕设(5)—笛卡尔空间轨迹规划（直线、圆弧） 直线轨迹规划圆弧轨迹规划Matlab代码验证 毕设中用到了很多代码，其中一部分我通过看书和看论文学习并实现的代码，会通过Gitee仓库分享出来，这些代码仅用于学习使用，祝各位毕业生顺利完成毕设！
毕设系列内容：毕业设计——四自由度机械臂轨迹规划
毕设(5)—笛卡尔空间轨迹规划（直线、圆弧） 机械臂在笛卡尔空间中常用的规划算法有直线和圆弧两种，他们的具体实现都是通过运动学逆解将运动轨迹转化为关节角度变化序列的方式。
直线轨迹规划 设机械臂任务是从空间中两点\(P_1\)、\(P_2\)间运动，如下图所示
则两点长度\(L\)可得
\[L=\sqrt{(x_1-x_0)^2&#43;(y_1-y_0)^2&#43;(z_1-z_0)^2} \]
在本文中采用的速度规划是匀速，如果有S型之类的速度规划算法也可以采用
\[d=v\cdot t \]
d为一个插补周期内移动的距离，t为插补的时间间隔
圆弧轨迹规划 空间中两两不在同一条直线的三点可确定一个平面，也可以确定一个圆弧。设空间中有三点\(P_1\)、\(P_2\)、\(P_3\)，机械臂需要通过三点沿圆弧轨迹运动，如下图所示
矢量图我用的是AxGlyph软件画的，有需要可以自行到官网购买
公式太多，不再赘述，大致流程如下
求出\(P_{123}\)、\(P_{12}\)和\(P_{23}\)的方程，通过三个平面方程获得圆心\(O_1\)坐标和圆弧半径在\(P_{123}\)平面建立新坐标系，计算两个坐标系之间的齐次变换矩阵在\(P_{123}\)平面计算平面圆弧的轨迹，通过变换矩阵转换为空间圆弧轨迹圆弧轨迹通过运动学逆解转换为各关节角度变化序列 Matlab代码验证 代码有点长，具体函数代码可以到仓库中自行查找
test4.m
clear, clc, close all; L(1) = Link([0 0 0 0 0 0], &#39;modified&#39;); L(2) = Link([0 0 0 -pi / 2 0 0], &#39;modified&#39;); L(3) = Link([0 0 135 0 0 0], &#39;modified&#39;); L(4) = Link([0 0 147 0 0 0], &#39;modified&#39;); L(5) = Link([0 131 61 -pi / 2 0 0], &#39;modified&#39;); robot = SerialLink(L, &#39;name&#39;, &#39;Dobot&#39;); angle1 = [-pi / 3, -pi / 9, pi / 3, -2 * pi / 9, 0]; angle2 = [-pi / 9, -pi / 3, pi / 2, -pi / 6, pi / 9]; angle3 = [7 * pi / 36, -pi / 4, 5 * pi / 12, -pi / 6, 2 * pi / 9]; angle4 = [4 * pi / 9, -pi / 9, 7 * pi / 18, -5 * pi / 18, pi / 3]; angleT = [angle1; angle2; angle3]; for i = 1:size(angleT, 1) fk = myfkine(angleT(i, :)); points(i, :) = [fk(1, 4), fk(2, 4), fk(3, 4)]; theta5(i) = angleT(i, 5); end [q, t] = line_traj(points, theta5, [0, 5], 100); %[q, t] = arc_traj(points, theta5, [0, 5, 10], 40); qdeg = rad2deg(q); figure(1); T = zeros(4, 4, size(q, 1)); for i = 1:size(q, 1) T(:, :, i) = myfkine(q(i, :)); end plot3(squeeze(T(1, 4, :)), squeeze(T(2, 4, :)), squeeze(T(3, 4, :)), &#39;r-&#39;, &#39;LineWidth&#39;, 2); title(&#39;轨迹图&#39;); hold on; plot3(points(:, 1), points(:, 2), points(:, 3), &#39;bo&#39;, &#39;MarkerSize&#39;, 7, &#39;LineWidth&#39;, 2); hold on; robot." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/879c626fb4ec47138874bf1fae72a7e1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-05T17:26:40+08:00" />
<meta property="article:modified_time" content="2022-06-05T17:26:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">笛卡尔空间轨迹规划（直线、圆弧）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>目录</p> 
<ul><li><a href="https://www.likecs.com/show-307478544.html#%E6%AF%95%E8%AE%BE5%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4%E8%BD%A8%E8%BF%B9%E8%A7%84%E5%88%92%E7%9B%B4%E7%BA%BF%E5%9C%86%E5%BC%A7" rel="nofollow" title="毕设(5)—笛卡尔空间轨迹规划（直线、圆弧）">毕设(5)—笛卡尔空间轨迹规划（直线、圆弧）</a> 
  <ul><li><a href="https://www.likecs.com/show-307478544.html#%E7%9B%B4%E7%BA%BF%E8%BD%A8%E8%BF%B9%E8%A7%84%E5%88%92" rel="nofollow" title="直线轨迹规划">直线轨迹规划</a></li><li><a href="https://www.likecs.com/show-307478544.html#%E5%9C%86%E5%BC%A7%E8%BD%A8%E8%BF%B9%E8%A7%84%E5%88%92" rel="nofollow" title="圆弧轨迹规划">圆弧轨迹规划</a></li><li><a href="https://www.likecs.com/show-307478544.html#matlab%E4%BB%A3%E7%A0%81%E9%AA%8C%E8%AF%81" rel="nofollow" title="Matlab代码验证">Matlab代码验证</a></li></ul></li></ul> 
<p></p> 
<p>毕设中用到了很多代码，其中一部分我通过看书和看论文学习并实现的代码，会通过<a href="https://gitee.com/dragonet-Z/My_Graduation_Project" rel="nofollow" title="Gitee仓库">Gitee仓库</a>分享出来，这些代码仅用于学习使用，祝各位毕业生顺利完成毕设！</p> 
<p>毕设系列内容：<a href="https://www.likecs.com/default/index/url?u=aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZHJhZ29uZXQtWi90YWcvJUU2JUFGJTk1JUU0JUI4JTlBJUU4JUFFJUJFJUU4JUFFJUExJUUyJTgwJTk0JUUyJTgwJTk0JUU1JTlCJTlCJUU4JTg3JUFBJUU3JTk0JUIxJUU1JUJBJUE2JUU2JTlDJUJBJUU2JUEyJUIwJUU4JTg3JTgyJUU4JUJEJUE4JUU4JUJGJUI5JUU4JUE3JTg0JUU1JTg4JTkyLw==" rel="nofollow" title="毕业设计——四自由度机械臂轨迹规划">毕业设计——四自由度机械臂轨迹规划</a></p> 
<hr> 
<h2 id="毕设5笛卡尔空间轨迹规划直线圆弧">毕设(5)—笛卡尔空间轨迹规划（直线、圆弧）</h2> 
<p>机械臂在笛卡尔空间中常用的规划算法有直线和圆弧两种，他们的具体实现都是通过运动学逆解将运动轨迹转化为关节角度变化序列的方式。</p> 
<h3 id="直线轨迹规划">直线轨迹规划</h3> 
<p>设机械臂任务是从空间中两点\(P_1\)、\(P_2\)间运动，如下图所示</p> 
<p></p> 
<p>则两点长度\(L\)可得</p> 
<p></p> 
<p>\[L=\sqrt{(x_1-x_0)^2+(y_1-y_0)^2+(z_1-z_0)^2} \]</p> 
<p></p> 
<p>在本文中采用的速度规划是匀速，如果有S型之类的速度规划算法也可以采用</p> 
<p></p> 
<p>\[d=v\cdot t \]</p> 
<p></p> 
<blockquote> 
 <p>d为一个插补周期内移动的距离，t为插补的时间间隔</p> 
</blockquote> 
<h3 id="圆弧轨迹规划">圆弧轨迹规划</h3> 
<p>空间中两两不在同一条直线的三点可确定一个平面，也可以确定一个圆弧。设空间中有三点\(P_1\)、\(P_2\)、\(P_3\)，机械臂需要通过三点沿圆弧轨迹运动，如下图所示</p> 
<p></p> 
<blockquote> 
 <p>矢量图我用的是AxGlyph软件画的，有需要可以自行到<a href="https://www.amyxun.com/" rel="nofollow" title="官网">官网</a>购买</p> 
</blockquote> 
<p>公式太多，不再赘述，大致流程如下</p> 
<ol><li>求出\(P_{123}\)、\(P_{12}\)和\(P_{23}\)的方程，通过三个平面方程获得圆心\(O_1\)坐标和圆弧半径</li><li>在\(P_{123}\)平面建立新坐标系，计算两个坐标系之间的齐次变换矩阵</li><li>在\(P_{123}\)平面计算平面圆弧的轨迹，通过变换矩阵转换为空间圆弧轨迹</li><li>圆弧轨迹通过运动学逆解转换为各关节角度变化序列</li></ol> 
<h3 id="matlab代码验证">Matlab代码验证</h3> 
<p>代码有点长，具体函数代码可以到仓库中自行查找</p> 
<p>test4.m</p> 
<pre><code>clear, clc, close all;

L(1) = Link([0 0 0 0 0 0], 'modified');
L(2) = Link([0 0 0 -pi / 2 0 0], 'modified');
L(3) = Link([0 0 135 0 0 0], 'modified');
L(4) = Link([0 0 147 0 0 0], 'modified');
L(5) = Link([0 131 61 -pi / 2 0 0], 'modified');
robot = SerialLink(L, 'name', 'Dobot');

angle1 = [-pi / 3, -pi / 9, pi / 3, -2 * pi / 9, 0];
angle2 = [-pi / 9, -pi / 3, pi / 2, -pi / 6, pi / 9];
angle3 = [7 * pi / 36, -pi / 4, 5 * pi / 12, -pi / 6, 2 * pi / 9];
angle4 = [4 * pi / 9, -pi / 9, 7 * pi / 18, -5 * pi / 18, pi / 3];
angleT = [angle1; angle2; angle3];

for i = 1:size(angleT, 1)
    fk = myfkine(angleT(i, :));
    points(i, :) = [fk(1, 4), fk(2, 4), fk(3, 4)];
    theta5(i) = angleT(i, 5);
end
[q, t] = line_traj(points, theta5, [0, 5], 100);
%[q, t] = arc_traj(points, theta5, [0, 5, 10], 40);
qdeg = rad2deg(q);

figure(1);
T = zeros(4, 4, size(q, 1));
for i = 1:size(q, 1)
    T(:, :, i) = myfkine(q(i, :));
end
plot3(squeeze(T(1, 4, :)), squeeze(T(2, 4, :)), squeeze(T(3, 4, :)), 'r-', 'LineWidth', 2);
title('轨迹图');
hold on;
plot3(points(:, 1), points(:, 2), points(:, 3), 'bo', 'MarkerSize', 7, 'LineWidth', 2);
hold on;
robot.plot(q);
grid on;
hold on;

figure(2);
plot(t, qdeg);
title('角度图');
legend('q_1', 'q_2', 'q_3', 'q_4', 'q_5');
xlabel('t(s)');
ylabel('deg(°)');
grid on;
hold on;
</code></pre> 
<p>直线规划运行结果如下</p> 
<table><tbody><tr><td> <p>直线轨迹图</p> </td><td> <p>直线角度图</p> </td></tr></tbody></table> 
<p>圆弧规划运行结果如下</p> 
<table><tbody><tr><td> <p>圆弧轨迹图</p> </td><td> <p>圆弧角度图</p> </td></tr></tbody></table> 
<blockquote> 
 <p>可以注意到圆弧角度图在t=5秒时刻有一次跳变，应该是我重新写函数的时候漏了一些东西没写(pointT向量长度是2<em>step+1，而q向量长度为2</em>step，我重写函数的时候直接去掉中间的一位pointT了)</p> 
</blockquote> 
<pre><code>for i = 0:theta13 / (2 * step - 1):theta13 %这个地方我直接减1了，原来我写的函数是没有这个的
    pointT(j, :) = transT * [R * cos(i), R * sin(i), 0, 1]';
    j = j + 1;
end
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f19a07694aa044826c8ccbceb2f696f8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">RSA加解密算法的简单实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9cd95de56fe8f6b2d9a4923bf1a36528/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mysql Blob和Text类型</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>