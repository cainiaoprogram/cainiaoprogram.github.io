<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ES(elasticsearch)安装教程 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ES(elasticsearch)安装教程" />
<meta property="og:description" content="安装过程基本来自互联网, 有一个小问题需要解决.
centos中
ulimit -n (默认是1024), ES需要65536, 所以我们需要修改.
修改的方法, 网上有很多, 大多都不可用.
本人试坑后, 以下可用.
vim /etc/security/limits.conf
添加配置如下：
es(网上大多是*, 导致不生效) soft nofile 65536
es hard nofile 131072
es soft nproc 4096
es hard nproc 4096
作者：有梦想永远年轻
链接：https://www.jianshu.com/p/15d31cf30154
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
一、ES安装需求
硬件环境: Centos7 软件环境: JDK8
二、ES安装(来自网上, 可用)
1.下载elasticsearch
官网可以直接下载，可以选择最新版本，也可以下载历史版本（箭头所示为历史版本），本案例中选择的是6.2.4版本
2.安装elasticsearch
2.1.上传压缩包并解压
tar zxvf elasticsearch-6.2.4.tar.gz
目录重命名：mv elasticsearch-6.2.4 elasticsearch
2.2.创建ES用户
默认ES 6.X 是不允许root用户运行的，否则ES运行的时候会报错，所以我们需要创建新的用户
命令：useradd es
命令：passwd es（设置密码）
修改权限 ： chown -R es:es elasticsearch-6.2.4
切换用户：su es" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/26f93e5fdb146bc9e438a098712d9e16/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-01-03T13:53:58+08:00" />
<meta property="article:modified_time" content="2020-01-03T13:53:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ES(elasticsearch)安装教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>安装过程基本来自互联网, 有一个小问题需要解决.</p> 
<p>centos中</p> 
<p>ulimit -n (默认是1024), ES需要65536, 所以我们需要修改.</p> 
<p>修改的方法, 网上有很多, 大多都不可用.</p> 
<p>本人试坑后, 以下可用.</p> 
<p>vim /etc/security/limits.conf</p> 
<p>添加配置如下：</p> 
<p>es(网上大多是*, 导致不生效) soft nofile 65536</p> 
<p>es hard nofile 131072</p> 
<p>es soft nproc 4096</p> 
<p>es hard nproc 4096</p> 
<p><br><br> 作者：有梦想永远年轻<br> 链接：https://www.jianshu.com/p/15d31cf30154<br> 来源：简书<br> 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p> 
<p> </p> 
<p>一、ES安装需求</p> 
<p>硬件环境: Centos7 </p> 
<p>软件环境: JDK8</p> 
<p>二、ES安装(来自网上, 可用)</p> 
<p><strong>1.下载elasticsearch</strong></p> 
<p>官网可以直接下载，可以选择最新版本，也可以下载历史版本（箭头所示为历史版本），本案例中选择的是6.2.4版本</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/77/39/t1FMVr16_o.png"></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/07/99/c32Yyupq_o.png"></p> 
<p><strong>2.安装elasticsearch</strong></p> 
<p><strong>2.1.上传压缩包并解压</strong></p> 
<p>tar zxvf  elasticsearch-6.2.4.tar.gz</p> 
<p>目录重命名：mv elasticsearch-6.2.4  elasticsearch</p> 
<p><strong>2.2.创建ES用户</strong></p> 
<p>默认ES 6.X 是不允许root用户运行的，否则ES运行的时候会报错，所以我们需要创建新的用户</p> 
<p>命令：useradd es</p> 
<p>命令：passwd es（设置密码）</p> 
<p>修改权限 ： chown -R es:es elasticsearch-6.2.4</p> 
<p>切换用户：su  es</p> 
<p><strong>2.3.修改配置</strong></p> 
<p> 进入config目录，有两个配置文件需要修改：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/e0/3b/L9Er1hsO_o.png"></p> 
<p><strong>2.3.1 修改jvm.options</strong></p> 
<p>命令：vi  jvm.options</p> 
<p>默认配置：</p> 
<p>-Xms1g</p> 
<p>-Xmx1g</p> 
<p>修改配置：内存占用太多，可以调小一点</p> 
<p>-Xms512m</p> 
<p>-Xmx512m</p> 
<p><strong>2.3.2 修改elasticsearch.yml</strong></p> 
<p>命令：vi  elasticsearch.yml</p> 
<p>修改数据和日志目录：</p> 
<p>path.data: /home/yinlian/elasticsearch/data # 数据目录位置</p> 
<p>path.logs: /home/yinlian/elasticsearch/logs # 日志目录位置</p> 
<p>修改绑定的ip：</p> 
<p>network.host: 0.0.0.0 # 绑定到0.0.0.0，允许任何ip来访问（默认是只有本机访问）</p> 
<p><strong>2.3.3 创建data目录</strong></p> 
<p>刚才我们修改配置，把data和logs目录修改指向了elasticsearch的安装目录。但是data目录并不存在，因此我们需要创建出来：</p> 
<p>mkdir /home/yinlian/elasticsearch/data</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/c9/fc/4Mp3S0S3_o.png"></p> 
<p><strong>2.4 运行</strong></p> 
<p>进入elasticsearch/bin目录，执行命令：</p> 
<p>./elasticsearch</p> 
<p>发现报错了，有以下几个错误，逐个解决：</p> 
<p><strong> 错误1：内核过低</strong></p> 
<p>我们使用的是centos6，其linux内核版本为2.6。而Elasticsearch的插件要求至少3.5以上版本。禁用插件即可</p> 
<p>修改elasticsearch.yml文件，在最下面添加如下配置：</p> 
<p>bootstrap.system_call_filter: false</p> 
<p><strong>错误2：文件权限不足</strong></p> 
<p>先切换到root用户，然后再修改如下配置：</p> 
<p>vi /etc/security/limits.conf</p> 
<p>添加配置如下：</p> 
<p>* soft nofile 65536</p> 
<p>* hard nofile 131072</p> 
<p>* soft nproc 4096</p> 
<p>* hard nproc 4096</p> 
<p><strong>错误3：线程不够</strong></p> 
<p>继续修改配置：vi /etc/security/limits.d/90-nproc.conf</p> 
<p>* soft nproc 1024 修改为 * soft nproc 4096</p> 
<p><strong>错误4：elasticsearch用户拥有的内存权限太小</strong></p> 
<p>继续修改配置：vi /etc/sysctl.conf</p> 
<p>添加内容：vm.max_map_count=655360</p> 
<p>然后执行命令：sysctl -p</p> 
<p>所有错误修改完毕，一定要重启你的 Xshell终端，否则配置无效。</p> 
<p>再次启动运行，成功了</p> 
<p><strong>2.5 解决浏览器访问不到的问题</strong></p> 
<p>启动之后可以看到绑定了两个端口:</p> 
<p>9300：集群节点间通讯接口</p> 
<p>9200：客户端访问接口</p> 
<p>浏览器访问：http://192.168.105:9200</p> 
<p>如果访问不到，需要关闭防火墙或<strong>添加端口号9200</strong></p> 
<p>再次访问可以看到如下效果：</p> 
<pre class="has"><code class="language-html">{
  "name" : "-9IC_4c",
  "cluster_name" : "elasticsearch",
  "cluster_uuid" : "hTK55_HrQtGkKpiq-pfH-g",
  "version" : {
    "number" : "6.2.4",
    "build_hash" : "ccec39f",
    "build_date" : "2018-04-12T20:37:28.497551Z",
    "build_snapshot" : false,
    "lucene_version" : "7.2.1",
    "minimum_wire_compatibility_version" : "5.6.0",
    "minimum_index_compatibility_version" : "5.0.0"
  },
  "tagline" : "You Know, for Search"
}</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8bde1cd6907205f91e5ab5d3fc82a891/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">概率统计——三扇门游戏与贝叶斯定理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4688e94f444b25a28697a76594937a06/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JDK11 HttpClient</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>