<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>STM32:OLED屏幕开发 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="STM32:OLED屏幕开发" />
<meta property="og:description" content="一、OLED原理 所谓的屏幕就是由一个个小灯组成，每个小灯称之为一个像素。只要在屏幕上有选择地点亮一部分小灯，就可以显示我们想要的图案。所谓下分辨率就是屏幕上的小灯数量。常见单片机中常见的屏幕分辨率常见的就是128(列长)*64(行高)。如果每个小灯都由单片机直接相连控制，那么需要8000多个引脚才能满足需求，着显然是不切实际的。因此需要借助“屏幕驱动芯片”来控制OLED。我们只需要通过IIC或者SPI等通信协议与屏幕驱动芯片进行通信，就可以操控屏幕上着8000多个小灯的亮灭了。
对于CH1116屏幕驱动芯片，就可以驱动128*64分辨率的屏幕。这类芯片将整个屏幕分成8个页。每页为是128*8.因此每页的行数就成了8行，每一列上有8个数据刚好可以用8个字节0/1表示。CH1116的IIC设备地址为0x7A。
CH1116的关键操作为设置页地址和列地址
指令说明启动IIC通信 0x7A 0x00为OLED的外设地址，指令要以0x00开头设置第0页的页地址0xB0设置第7页的页地址0xB7设置列地址0x5A(低4位)0x0A设置列地址要分为两次，0xYZ设置地址时，要设置0x0Z 和0x1Y。因此设置第90列的像素列，即0x5A需要列0x0A(低4位),0X15(高4位).设置列地址0x5A(高4位)0X15设置数据,即像素亮灭 0x40 发送0x40 0x00 &lt;当前列数据bitmap 下一数据bitmap ....&gt;
。例如确定第0页和列地址为0x5A后，发送:
0x40 0x01 0x03 ;那么屏幕上的第90列的第一个像素点和第91列的前两个像素点就会亮。
CH1116有一个非常方便的特性，就是在设置数据时，当前页和列的数据被设置好后，列地址会自动加1.例如，确定好第0页和第0列后，一股脑发送0x40 0xFF 0xFF .....0xFF(128个0xFF)，那么OLED屏幕的前8行就全部被点亮了。
二、准备工作 新建工程，设置IIC1 的模式，由于要操作的数据要求更新要快，因此要把IIC的速度模式设置成快速模式。此时IIC的时钟频率也变到了400000。一般没做其他操作情况下，STM32的内部时钟一直都采用8M速度运行。
由于我的开发板上有外部晶振，可以给STM32提速。将高速时钟源HSE设置为Crystal/Ceramic Resonator ,随后打开 Clock Configuration 时钟设置。将HCLK这里设置最大值72.。也就是切换到了外部晶振和72MHZ的时钟频率
而后勾选上为每个外设生成对饮的头文件和源文件。保存并生成代码
结合STM32:AHT20温湿度传感器驱动程序开发-CSDN博客中的配置，实现AHT20温湿度测试结果在OLED屏幕上显示。
三、OLED驱动库 (1) 资源下载
https://download.csdn.net/download/superSmart_Dong/88555975 可下载。
其中oled.c/oled.h为oled驱动实现，font.h/font.c为字模图模。aht20.c/aht20.h为AHT驱动实现。
(2)字模图模获取地址。
led.baud-dance.com
(3) 资源库的说明。
在波特律动LED字模生成器获取字模。
获取到的字模放在如下数组中，并调整数组大小和头文件等。这样才可以在OLED显示
获取到的图模数据复制下来，记下图模宽和高。
将复制的数据贴到font.c和在font.h中声明。调用
OLED_DrawPicture(oled_x,oled_y, size_wide,size_hight, iconVardata, OLED_COLOR_NORMAL);" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4e0a33911d7825d099bd505e75acefa7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-20T23:17:50+08:00" />
<meta property="article:modified_time" content="2023-11-20T23:17:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">STM32:OLED屏幕开发</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、OLED原理</h2> 
<p>        所谓的屏幕就是由一个个小灯组成，每个小灯称之为一个像素。只要在屏幕上有选择地点亮一部分小灯，就可以显示我们想要的图案。所谓下分辨率就是屏幕上的小灯数量。常见单片机中常见的屏幕分辨率常见的就是128(列长)*64(行高)。如果每个小灯都由单片机直接相连控制，那么需要8000多个引脚才能满足需求，着显然是不切实际的。因此需要借助“屏幕驱动芯片”来控制OLED。我们只需要通过IIC或者SPI等通信协议与屏幕驱动芯片进行通信，就可以操控屏幕上着8000多个小灯的亮灭了。</p> 
<p>        对于CH1116屏幕驱动芯片，就可以驱动128*64分辨率的屏幕。这类芯片将整个屏幕分成8个页。每页为是128*8.因此每页的行数就成了8行，每一列上有8个数据刚好可以用8个字节0/1表示。CH1116的IIC设备地址为0x7A。</p> 
<p>        CH1116的关键操作为设置页地址和列地址</p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td></td><td style="width:99px;">指令</td><td style="width:297px;">说明</td></tr><tr><td>启动IIC通信  </td><td style="width:99px;">0x7A  0x00</td><td style="width:297px;">为OLED的外设地址，指令要以0x00开头</td></tr><tr><td>设置第0页的页地址</td><td style="width:99px;">0xB0</td><td style="width:297px;"></td></tr><tr><td>设置第7页的页地址</td><td style="width:99px;">0xB7</td><td style="width:297px;"></td></tr><tr><td>设置列地址0x5A(低4位)</td><td style="width:99px;">0x0A</td><td colspan="1" rowspan="2" style="width:297px;">设置列地址要分为两次，0xYZ设置地址时，要设置0x0Z 和0x1Y。因此设置第90列的像素列，即0x5A需要列0x0A(低4位),0X15(高4位).</td></tr><tr><td>设置列地址0x5A(高4位)</td><td style="width:99px;">0X15</td></tr><tr><td>设置数据,即像素亮灭       </td><td style="width:99px;">0x40</td><td colspan="1" style="width:297px;"> <p> 发送0x40 0x00 &lt;当前列数据bitmap 下一数据bitmap  ....&gt;</p> <p>。例如确定第0页和列地址为0x5A后，发送:</p> <p>0x40  0x01 0x03  ;那么屏幕上的第90列的第一个像素点和第91列的前两个像素点就会亮。</p> </td></tr></tbody></table> 
<p>CH1116有一个非常方便的特性，就是在设置数据时，当前页和列的数据被设置好后，列地址会自动加1.例如，确定好第0页和第0列后，一股脑发送0x40 0xFF 0xFF .....0xFF(128个0xFF)，那么OLED屏幕的前8行就全部被点亮了。</p> 
<p><img alt="" height="613" src="https://images2.imgbox.com/3b/fa/ik4XBll8_o.png" width="1200"></p> 
<p></p> 
<h2>二、准备工作</h2> 
<p><img alt="" height="610" src="https://images2.imgbox.com/34/92/bdrllp57_o.png" width="590"></p> 
<p>        新建工程，设置IIC1 的模式，由于要操作的数据要求更新要快，因此要把IIC的速度模式设置成快速模式。此时IIC的时钟频率也变到了400000。一般没做其他操作情况下，STM32的内部时钟一直都采用8M速度运行。</p> 
<p>        由于我的开发板上有外部晶振，可以给STM32提速。将高速时钟源HSE设置为Crystal/Ceramic Resonator ,随后打开 Clock Configuration 时钟设置。将HCLK这里设置最大值72.。也就是切换到了外部晶振和72MHZ的时钟频率</p> 
<p><img alt="" height="468" src="https://images2.imgbox.com/f4/b2/SHydGYjV_o.png" width="606"></p> 
<p><img alt="" height="576" src="https://images2.imgbox.com/52/c4/5a8tIBJP_o.png" width="971"></p> 
<p>而后勾选上为每个外设生成对饮的头文件和源文件。保存并生成代码</p> 
<p><img alt="" height="337" src="https://images2.imgbox.com/cf/56/K2jfsiSy_o.png" width="991"></p> 
<p>结合<a href="https://blog.csdn.net/superSmart_Dong/article/details/134129930?spm=1001.2014.3001.5501" title="STM32:AHT20温湿度传感器驱动程序开发-CSDN博客">STM32:AHT20温湿度传感器驱动程序开发-CSDN博客</a>中的配置，实现AHT20温湿度测试结果在OLED屏幕上显示。</p> 
<h2>三、OLED驱动库</h2> 
<p>(1) 资源下载</p> 
<p><a href="https://download.csdn.net/download/superSmart_Dong/88555975" title="https://download.csdn.net/download/superSmart_Dong/88555975">https://download.csdn.net/download/superSmart_Dong/88555975</a> 可下载。</p> 
<p>其中oled.c/oled.h为oled驱动实现，font.h/font.c为字模图模。aht20.c/aht20.h为AHT驱动实现。</p> 
<p>(2)字模图模获取地址。</p> 
<p>led.baud-dance.com</p> 
<p>(3) 资源库的说明。</p> 
<p>在<a href="https://led.baud-dance.com/" rel="nofollow" title="波特律动LED字模生成器">波特律动LED字模生成器</a>获取字模。</p> 
<p><img alt="" height="1083" src="https://images2.imgbox.com/23/af/2VEJgtk6_o.png" width="1200"></p> 
<p>获取到的字模放在如下数组中，并调整数组大小和头文件等。这样才可以在OLED显示</p> 
<p><img alt="" height="736" src="https://images2.imgbox.com/2c/41/qCnEw9SY_o.png" width="1200"></p> 
<p>获取到的图模数据复制下来，记下图模宽和高。</p> 
<p><img alt="" height="1039" src="https://images2.imgbox.com/25/e5/NM9QSRBt_o.png" width="1200"></p> 
<p>将复制的数据贴到font.c和在font.h中声明。调用</p> 
<blockquote> 
 <p>OLED_DrawPicture(oled_x,oled_y, size_wide,size_hight, iconVardata, OLED_COLOR_NORMAL);</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/237523b53f0946aa1f2c36cd7be229b5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">javascript的基本特点有哪些,javascript的特性有哪些</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/50e5cae6e48a5fd18deb836caf03f7ec/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">文生图一致性角色生成！谷歌最新文本到图片扩散模型工作</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>