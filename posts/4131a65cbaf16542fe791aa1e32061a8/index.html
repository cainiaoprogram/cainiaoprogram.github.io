<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Spoon Kettle 合并排序详解（Merge join） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Spoon Kettle 合并排序详解（Merge join）" />
<meta property="og:description" content="文章目录 1 概述2 示例2.1 转换图2.2 表输入2.3 记录集连接2.4 Excel 输出2.5 执行结果 3 扩展3.1 警告：&#39;合并连接&#39; 算法要求输入流事先排好序3.2 警告的解决方案：排序记录 1 概述 合并排序（Merge join） 可理解为数据库中的连接方式（left join、right join、join） 警告：关联的字段需先排序，否则会遗漏数据 2 示例 2.1 转换图 2.2 表输入 测试数据：
1、表输入 with t_test_a as ( select 1 sno, &#39;a&#39; name from dual union all select 2 sno, &#39;b&#39; name from dual union all select 3 sno, &#39;c&#39; name from dual ) select * from t_test_a 2、表输出 with t_test_b as ( SELECT 1 sno, &#39;男&#39; sex FROM dual UNION ALL SELECT 2 sno, &#39;女&#39; sex FROM dual ) select * from t_test_b 表输入：（表输出同理）" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4131a65cbaf16542fe791aa1e32061a8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-21T09:27:43+08:00" />
<meta property="article:modified_time" content="2022-11-21T09:27:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Spoon Kettle 合并排序详解（Merge join）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1__2" rel="nofollow">1 概述</a></li><li><a href="#2__10" rel="nofollow">2 示例</a></li><li><ul><li><a href="#21__11" rel="nofollow">2.1 转换图</a></li><li><a href="#22__13" rel="nofollow">2.2 表输入</a></li><li><a href="#23__37" rel="nofollow">2.3 记录集连接</a></li><li><a href="#24_Excel__39" rel="nofollow">2.4 Excel 输出</a></li><li><a href="#25__45" rel="nofollow">2.5 执行结果</a></li></ul> 
  </li><li><a href="#3__54" rel="nofollow">3 扩展</a></li><li><ul><li><a href="#31___55" rel="nofollow">3.1 警告：'合并连接' 算法要求输入流事先排好序</a></li><li><a href="#32__64" rel="nofollow">3.2 警告的解决方案：排序记录</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1__2"></a>1 概述</h2> 
<div class="mermaid sequence-diagram"> 
 <svg id="mermaid-svg-4r0xiCCUOgrLS8lm" width="100%" xmlns="http://www.w3.org/2000/svg" height="158" style="max-width: 702.2166748046875px;" viewbox="0 0 702.2166748046875 158"> 
  <style>#mermaid-svg-4r0xiCCUOgrLS8lm {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-4r0xiCCUOgrLS8lm .error-icon{fill:#552222;}#mermaid-svg-4r0xiCCUOgrLS8lm .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-4r0xiCCUOgrLS8lm .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-4r0xiCCUOgrLS8lm .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-4r0xiCCUOgrLS8lm .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-4r0xiCCUOgrLS8lm .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-4r0xiCCUOgrLS8lm .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-4r0xiCCUOgrLS8lm .marker{fill:#333333;stroke:#333333;}#mermaid-svg-4r0xiCCUOgrLS8lm .marker.cross{stroke:#333333;}#mermaid-svg-4r0xiCCUOgrLS8lm svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-4r0xiCCUOgrLS8lm .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-4r0xiCCUOgrLS8lm .cluster-label text{fill:#333;}#mermaid-svg-4r0xiCCUOgrLS8lm .cluster-label span{color:#333;}#mermaid-svg-4r0xiCCUOgrLS8lm .label text,#mermaid-svg-4r0xiCCUOgrLS8lm span{fill:#333;color:#333;}#mermaid-svg-4r0xiCCUOgrLS8lm .node rect,#mermaid-svg-4r0xiCCUOgrLS8lm .node circle,#mermaid-svg-4r0xiCCUOgrLS8lm .node ellipse,#mermaid-svg-4r0xiCCUOgrLS8lm .node polygon,#mermaid-svg-4r0xiCCUOgrLS8lm .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-4r0xiCCUOgrLS8lm .node .label{text-align:center;}#mermaid-svg-4r0xiCCUOgrLS8lm .node.clickable{cursor:pointer;}#mermaid-svg-4r0xiCCUOgrLS8lm .arrowheadPath{fill:#333333;}#mermaid-svg-4r0xiCCUOgrLS8lm .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-4r0xiCCUOgrLS8lm .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-4r0xiCCUOgrLS8lm .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-4r0xiCCUOgrLS8lm .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-4r0xiCCUOgrLS8lm .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-4r0xiCCUOgrLS8lm .cluster text{fill:#333;}#mermaid-svg-4r0xiCCUOgrLS8lm .cluster span{color:#333;}#mermaid-svg-4r0xiCCUOgrLS8lm div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-4r0xiCCUOgrLS8lm :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style> 
  <g> 
   <g class="output"> 
    <g class="clusters"></g> 
    <g class="edgePaths"> 
     <g class="edgePath LS-A LE-B" style="opacity: 1;" id="L-A-B"> 
      <path class="path" d="M161.72030798594156,56L172.20858897103201,51.833333333333336C182.69686995612247,47.666666666666664,203.67343192630344,39.333333333333336,218.32837957806058,35.166666666666664C232.98332722981772,31,241.31666056315103,31,245.48332722981772,31L249.64999389648438,31" marker-end="url(#arrowhead35)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead35" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-A LE-C" style="opacity: 1;" id="L-A-C"> 
      <path class="path" d="M161.72030798594156,102L172.20858897103201,106.16666666666667C182.69686995612247,110.33333333333333,203.67343192630344,118.66666666666667,227.04226711061267,122.83333333333333C250.41110229492188,127,276.1722106933594,127,289.0527648925781,127L301.9333190917969,127" marker-end="url(#arrowhead36)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead36" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path> 
       </marker> 
      </defs> 
     </g> 
    </g> 
    <g class="edgeLabels"> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-A-C" class="edgeLabel L-LS-A' L-LE-C"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
    </g> 
    <g class="nodes"> 
     <g class="node default" style="opacity: 1;" id="flowchart-A-28" transform="translate(103.82499694824219,79)"> 
      <rect rx="0" ry="0" x="-95.82499694824219" y="-23" width="191.64999389648438" height="46" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-85.82499694824219,-13)"> 
        <foreignobject width="171.64999389648438" height="26"> 
         <div style="display: inline-block; white-space: nowrap;">
           合并排序（Merge join） 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-B-29" transform="translate(471.9333190917969,31)"> 
      <rect rx="5" ry="5" x="-222.2833251953125" y="-23" width="444.566650390625" height="46" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-212.2833251953125,-13)"> 
        <foreignobject width="424.566650390625" height="26"> 
         <div style="display: inline-block; white-space: nowrap;">
           可理解为数据库中的连接方式（left join、right join、join） 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-C-31" transform="translate(471.9333190917969,127)"> 
      <rect rx="5" ry="5" x="-170" y="-23" width="340" height="46" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-160,-13)"> 
        <foreignobject width="320" height="26"> 
         <div style="display: inline-block; white-space: nowrap;">
           警告：关联的字段需先排序，否则会遗漏数据 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
    </g> 
   </g> 
  </g> 
 </svg> 
</div> 
<h2><a id="2__10"></a>2 示例</h2> 
<h3><a id="21__11"></a>2.1 转换图</h3> 
<p><img src="https://images2.imgbox.com/6a/bb/Vs6Fh5yS_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="22__13"></a>2.2 表输入</h3> 
<p><strong>测试数据：</strong></p> 
<pre><code class="prism language-sql"><span class="token number">1</span>、表输入
<span class="token keyword">with</span> t_test_a <span class="token keyword">as</span> <span class="token punctuation">(</span>
  <span class="token keyword">select</span> <span class="token number">1</span> sno<span class="token punctuation">,</span> <span class="token string">'a'</span> name <span class="token keyword">from</span> dual <span class="token keyword">union</span> <span class="token keyword">all</span>
  <span class="token keyword">select</span> <span class="token number">2</span> sno<span class="token punctuation">,</span> <span class="token string">'b'</span> name <span class="token keyword">from</span> dual <span class="token keyword">union</span> <span class="token keyword">all</span>
  <span class="token keyword">select</span> <span class="token number">3</span> sno<span class="token punctuation">,</span> <span class="token string">'c'</span> name <span class="token keyword">from</span> dual
<span class="token punctuation">)</span>
<span class="token keyword">select</span> <span class="token operator">*</span> 
  <span class="token keyword">from</span> t_test_a

<span class="token number">2</span>、表输出
<span class="token keyword">with</span> t_test_b <span class="token keyword">as</span> <span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> <span class="token number">1</span> sno<span class="token punctuation">,</span> <span class="token string">'男'</span> sex <span class="token keyword">FROM</span> dual <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
  <span class="token keyword">SELECT</span> <span class="token number">2</span> sno<span class="token punctuation">,</span> <span class="token string">'女'</span> sex <span class="token keyword">FROM</span> dual
<span class="token punctuation">)</span>
<span class="token keyword">select</span> <span class="token operator">*</span> 
  <span class="token keyword">from</span> t_test_b
</code></pre> 
<p><strong>表输入：</strong>（表输出同理）<br> <img src="https://images2.imgbox.com/87/fa/hEUPxOms_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="23__37"></a>2.3 记录集连接</h3> 
<p><img src="https://images2.imgbox.com/65/99/V9de6OHd_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="24_Excel__39"></a>2.4 Excel 输出</h3> 
<p><img src="https://images2.imgbox.com/fa/d7/PQR3JlyO_o.png" alt="在这里插入图片描述"></p> 
<p><strong>Excel 设置：</strong><br> <img src="https://images2.imgbox.com/1c/6f/oY9sjgX8_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="25__45"></a>2.5 执行结果</h3> 
<p><img src="https://images2.imgbox.com/5a/48/WunLJG4A_o.png" alt="在这里插入图片描述"></p> 
<ul><li>控件右上角图标含义： 
  <ul><li><font color="green">√：执行成本</font></li><li><font color="red">×：执行失败</font></li></ul> </li></ul> 
<p><strong>最终写入 Excel：</strong><br> <img src="https://images2.imgbox.com/05/b1/k4XeLIvr_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3__54"></a>3 扩展</h2> 
<h3><a id="31___55"></a>3.1 警告：‘合并连接’ 算法要求输入流事先排好序</h3> 
<p><img src="https://images2.imgbox.com/0f/fc/TXPjHIA0_o.png" alt="在这里插入图片描述"></p> 
<p><strong>上述示例中，sno 是按顺序排列的，若打乱，则会影响最终结果</strong><br> <img src="https://images2.imgbox.com/1f/44/mLl6plOA_o.png" alt="在这里插入图片描述"></p> 
<p><strong>sno 顺序打乱后，其余不变，测试结果如下：</strong><br> <img src="https://images2.imgbox.com/73/cc/npaSamUG_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="32__64"></a>3.2 警告的解决方案：排序记录</h3> 
<p><strong>转换图：</strong></p> 
<p><img src="https://images2.imgbox.com/3b/36/wbbVcPHO_o.png" alt="在这里插入图片描述"></p> 
<p><strong>转换 - 排序记录：</strong><br> <img src="https://images2.imgbox.com/bc/38/OIxTfkxE_o.png" alt="在这里插入图片描述"></p> 
<p><strong>请注意：需修改 “记录集连接 Merge join” 中的 “第一个步骤”</strong><br> <img src="https://images2.imgbox.com/c8/d1/7WAH2T5a_o.png" alt="在这里插入图片描述"></p> 
<p><strong>最终写入 Excel 结果：</strong><br> <img src="https://images2.imgbox.com/23/a8/JdefZlit_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/183ebbc2e998244ed7bb02b5a2d6a27d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【高级篇】Java JVM实战 之 内存调优</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/633dbac6dbaf56e6664ca46e8a76ada8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">电脑没有声音了怎么恢复？恢复声音的6个方法【图解】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>