<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习-4.朴素贝叶斯分类器 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习-4.朴素贝叶斯分类器" />
<meta property="og:description" content="EduCoder：机器学习—朴素贝叶斯分类器 第1关：条件概率 第2关：贝叶斯公式 第3关：朴素贝叶斯分类算法流程 编程要求：
根据提示，完成fit与predict函数，分别实现模型的训练与预测。（PS:在fit函数中需要将预测时需要的概率保存到self.label_prob和self.condition_prob这两个变量中）
其中fit函数参数解释如下：
feature：训练集数据，类型为ndarray；
label：训练集标签，类型为ndarray；
return：无返回。
predict函数参数解释如下：
feature：测试数据集所有特征组成的ndarray。（PS：feature中有多条数据）；
return：模型预测的结果。（PS：feature中有多少条数据，就需要返回长度为多少的list或者ndarry）。
代码如下：
import numpy as np class NaiveBayesClassifier(object): def __init__(self): &#39;&#39;&#39; self.label_prob表示每种类别在数据中出现的概率 例如，{0:0.333, 1:0.667}表示数据中类别0出现的概率为0.333，类别1的概率为0.667 &#39;&#39;&#39; self.label_prob = {} &#39;&#39;&#39; self.condition_prob表示每种类别确定的条件下各个特征出现的概率 例如训练数据集中的特征为 [[2, 1, 1], [1, 2, 2], [2, 2, 2], [2, 1, 2], [1, 2, 3]] 标签为[1, 0, 1, 0, 1] 那么当标签为0时第0列的值为1的概率为0.5，值为2的概率为0.5; 当标签为0时第1列的值为1的概率为0.5，值为2的概率为0.5; 当标签为0时第2列的值为1的概率为0，值为2的概率为1，值为3的概率为0; 当标签为1时第0列的值为1的概率为0.333，值为2的概率为0.666; 当标签为1时第1列的值为1的概率为0.333，值为2的概率为0.666; 当标签为1时第2列的值为1的概率为0.333，值为2的概率为0.333,值为3的概率为0.333; 因此self.label_prob的值如下： { 0:{ 0:{ 1:0.5 2:0.5 } 1:{ 1:0.5 2:0.5 } 2:{ 1:0 2:1 3:0 } } 1: { 0:{ 1:0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8b71dbecfbcc063dc3c9ca29595cdb03/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-08T02:39:39+08:00" />
<meta property="article:modified_time" content="2023-01-08T02:39:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习-4.朴素贝叶斯分类器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="EduCoder_4"></a>EduCoder：机器学习—朴素贝叶斯分类器</h2> 
<h3><a id="1_7"></a>第1关：条件概率</h3> 
<p><img src="https://images2.imgbox.com/31/dc/qXlVVJZp_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_12"></a>第2关：贝叶斯公式</h3> 
<p><img src="https://images2.imgbox.com/d5/be/TIomMRdc_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_16"></a>第3关：朴素贝叶斯分类算法流程</h3> 
<p><strong>编程要求：</strong><br> 根据提示，完成fit与predict函数，分别实现模型的训练与预测。（PS:在fit函数中需要将预测时需要的概率保存到self.label_prob和self.condition_prob这两个变量中）</p> 
<p>其中fit函数参数解释如下：</p> 
<ul><li> <p>feature：训练集数据，类型为ndarray；</p> </li><li> <p>label：训练集标签，类型为ndarray；</p> </li><li> <p>return：无返回。</p> </li></ul> 
<p>predict函数参数解释如下：</p> 
<ul><li> <p>feature：测试数据集所有特征组成的ndarray。（PS：feature中有多条数据）；</p> </li><li> <p>return：模型预测的结果。（<strong>PS：feature中有多少条数据，就需要返回长度为多少的list或者ndarry</strong>）。</p> </li></ul> 
<p><strong>代码如下：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np


<span class="token keyword">class</span> <span class="token class-name">NaiveBayesClassifier</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        self.label_prob表示每种类别在数据中出现的概率
        例如，{0:0.333, 1:0.667}表示数据中类别0出现的概率为0.333，类别1的概率为0.667
        '''</span>
        self<span class="token punctuation">.</span>label_prob <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
        <span class="token triple-quoted-string string">'''
        self.condition_prob表示每种类别确定的条件下各个特征出现的概率
        例如训练数据集中的特征为 [[2, 1, 1],
                              [1, 2, 2],
                              [2, 2, 2],
                              [2, 1, 2],
                              [1, 2, 3]]
        标签为[1, 0, 1, 0, 1]
        那么当标签为0时第0列的值为1的概率为0.5，值为2的概率为0.5;
        当标签为0时第1列的值为1的概率为0.5，值为2的概率为0.5;
        当标签为0时第2列的值为1的概率为0，值为2的概率为1，值为3的概率为0;
        当标签为1时第0列的值为1的概率为0.333，值为2的概率为0.666;
        当标签为1时第1列的值为1的概率为0.333，值为2的概率为0.666;
        当标签为1时第2列的值为1的概率为0.333，值为2的概率为0.333,值为3的概率为0.333;
        因此self.label_prob的值如下：     
        {
            0:{
                0:{
                    1:0.5
                    2:0.5
                }
                1:{
                    1:0.5
                    2:0.5
                }
                2:{
                    1:0
                    2:1
                    3:0
                }
            }
            1:
            {
                0:{
                    1:0.333
                    2:0.666
                }
                1:{
                    1:0.333
                    2:0.666
                }
                2:{
                    1:0.333
                    2:0.333
                    3:0.333
                }
            }
        }
        '''</span>
        self<span class="token punctuation">.</span>condition_prob <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">def</span> <span class="token function">fit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> feature<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        对模型进行训练，需要将各种概率分别保存在self.label_prob和self.condition_prob中
        :param feature: 训练数据集所有特征组成的ndarray
        :param label:训练数据集中所有标签组成的ndarray
        :return: 无返回
        '''</span>

        <span class="token comment">#********* Begin *********#</span>
        row_num<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span>
        col_num<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>feature<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> c <span class="token keyword">in</span> label<span class="token punctuation">:</span>
            <span class="token keyword">if</span> c <span class="token keyword">in</span> self<span class="token punctuation">.</span>label_prob<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>label_prob<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>label_prob<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> key <span class="token keyword">in</span>  self<span class="token punctuation">.</span>label_prob<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>label_prob<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">/=</span>row_num
            self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>col_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
                <span class="token keyword">for</span> k <span class="token keyword">in</span> np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>feature<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>feature<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> feature<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>feature<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>feature<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>
        <span class="token keyword">for</span> label_key <span class="token keyword">in</span> self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> k <span class="token keyword">in</span> self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label_key<span class="token punctuation">]</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                total<span class="token operator">=</span><span class="token number">0</span>
                <span class="token keyword">for</span> v <span class="token keyword">in</span> self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label_key<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    total <span class="token operator">+=</span>v
                <span class="token keyword">for</span> kk <span class="token keyword">in</span> self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label_key<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label_key<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>kk<span class="token punctuation">]</span> <span class="token operator">/=</span>total

        <span class="token comment">#********* End *********#</span>

    <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> feature<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        对数据进行预测，返回预测结果
        :param feature:测试数据集所有特征组成的ndarray
        :return:
        '''</span>
        <span class="token comment"># ********* Begin *********#</span>
        result <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i<span class="token punctuation">,</span>f <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span><span class="token punctuation">:</span>
            prob<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>label_prob<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            ii<span class="token operator">=</span><span class="token number">0</span>
            <span class="token keyword">for</span> label<span class="token punctuation">,</span>label_prob <span class="token keyword">in</span> self<span class="token punctuation">.</span>label_prob<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                prob<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token operator">=</span>label_prob
                <span class="token keyword">for</span>  j  <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>feature<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    prob<span class="token punctuation">[</span>ii<span class="token punctuation">]</span> <span class="token operator">*=</span> self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span>
                ii<span class="token operator">+=</span><span class="token number">1</span>
            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>label_prob<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>prob<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token comment">#********* End *********#</span>
    
</code></pre> 
<h3><a id="4_156"></a>第4关：拉普拉斯平滑</h3> 
<p><strong>编程要求：</strong><br> 根据提示，完成fit函数，实现模型的训练功能。（PS:在fit函数中需要将预测时需要的概率保存到self.label_prob和self.condition_prob这两个变量中）<br> 其中fit函数参数解释如下：</p> 
<ul><li> <p>feature：训练集数据，类型为ndarray；</p> </li><li> <p>label：训练集标签，类型为ndarray；</p> </li><li> <p>return：无返回。</p> </li></ul> 
<p><strong>代码如下：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">class</span> <span class="token class-name">NaiveBayesClassifier</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        self.label_prob表示每种类别在数据中出现的概率
        例如，{0:0.333, 1:0.667}表示数据中类别0出现的概率为0.333，类别1的概率为0.667
        '''</span>
        self<span class="token punctuation">.</span>label_prob <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
        <span class="token triple-quoted-string string">'''
        self.condition_prob表示每种类别确定的条件下各个特征出现的概率
        例如训练数据集中的特征为 [[2, 1, 1],
                              [1, 2, 2],
                              [2, 2, 2],
                              [2, 1, 2],
                              [1, 2, 3]]
        标签为[1, 0, 1, 0, 1]
        那么当标签为0时第0列的值为1的概率为0.5，值为2的概率为0.5;
        当标签为0时第1列的值为1的概率为0.5，值为2的概率为0.5;
        当标签为0时第2列的值为1的概率为0，值为2的概率为1，值为3的概率为0;
        当标签为1时第0列的值为1的概率为0.333，值为2的概率为0.666;
        当标签为1时第1列的值为1的概率为0.333，值为2的概率为0.666;
        当标签为1时第2列的值为1的概率为0.333，值为2的概率为0.333,值为3的概率为0.333;
        因此self.label_prob的值如下：     
        {
            0:{
                0:{
                    1:0.5
                    2:0.5
                }
                1:{
                    1:0.5
                    2:0.5
                }
                2:{
                    1:0
                    2:1
                    3:0
                }
            }
            1:
            {
                0:{
                    1:0.333
                    2:0.666
                }
                1:{
                    1:0.333
                    2:0.666
                }
                2:{
                    1:0.333
                    2:0.333
                    3:0.333
                }
            }
        }
        '''</span>
        self<span class="token punctuation">.</span>condition_prob <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

    <span class="token keyword">def</span> <span class="token function">fit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> feature<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        对模型进行训练，需要将各种概率分别保存在self.label_prob和self.condition_prob中
        :param feature: 训练数据集所有特征组成的ndarray
        :param label:训练数据集中所有标签组成的ndarray
        :return: 无返回
        '''</span>

        <span class="token comment">#********* Begin *********#</span>
        row_num<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span>
        col_num<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>feature<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        unique_label_count<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> c <span class="token keyword">in</span> label<span class="token punctuation">:</span>
            <span class="token keyword">if</span> c <span class="token keyword">in</span> self<span class="token punctuation">.</span>label_prob<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>label_prob<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>label_prob<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>
        <span class="token keyword">for</span> key <span class="token keyword">in</span> self<span class="token punctuation">.</span>label_prob<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>label_prob<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>
            self<span class="token punctuation">.</span>label_prob<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">/=</span><span class="token punctuation">(</span>unique_label_count<span class="token operator">+</span>row_num<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>col_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
                <span class="token keyword">for</span> k <span class="token keyword">in</span> np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>feature<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>feature<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> feature<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>feature<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>
        
        <span class="token keyword">for</span> label_key <span class="token keyword">in</span> self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> k <span class="token keyword">in</span> self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label_key<span class="token punctuation">]</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                total <span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label_key<span class="token punctuation">]</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> v <span class="token keyword">in</span> self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label_key<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    total<span class="token operator">+=</span>v
                <span class="token keyword">for</span> kk <span class="token keyword">in</span> self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label_key<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label_key<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>kk<span class="token punctuation">]</span><span class="token operator">/=</span>total
                <span class="token comment">#********* End *********#</span>


    <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> feature<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        对数据进行预测，返回预测结果
        :param feature:测试数据集所有特征组成的ndarray
        :return:
        '''</span>

        result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment"># 对每条测试数据都进行预测</span>
        <span class="token keyword">for</span> i<span class="token punctuation">,</span> f <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 可能的类别的概率</span>
            prob <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>label_prob<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            ii <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> label<span class="token punctuation">,</span> label_prob <span class="token keyword">in</span> self<span class="token punctuation">.</span>label_prob<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># 计算概率</span>
                prob<span class="token punctuation">[</span>ii<span class="token punctuation">]</span> <span class="token operator">=</span> label_prob
                <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>feature<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    prob<span class="token punctuation">[</span>ii<span class="token punctuation">]</span> <span class="token operator">*=</span> self<span class="token punctuation">.</span>condition_prob<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span>
                ii <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token comment"># 取概率最大的类别作为结果</span>
            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>label_prob<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>prob<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        
</code></pre> 
<h3><a id="5_293"></a>第5关：新闻文本主题分类</h3> 
<p><strong>编程要求：</strong><br> 填写news_predict(train_sample, train_label, test_sample)函数完成新闻文本主题分类任务，其中：</p> 
<ul><li> <p>train_sample：原始训练样本，类型为ndarray；</p> </li><li> <p>train_label：训练标签，类型为ndarray；</p> </li><li> <p>test_sample：原始测试样本，类型为ndarray。</p> </li></ul> 
<p><strong>代码如下：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> CountVectorizer
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> MultinomialNB
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> TfidfTransformer

<span class="token keyword">def</span> <span class="token function">news_predict</span><span class="token punctuation">(</span>train_sample<span class="token punctuation">,</span> train_label<span class="token punctuation">,</span> test_sample<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    训练模型并进行预测，返回预测结果
    :param train_sample:原始训练集中的新闻文本，类型为ndarray
    :param train_label:训练集中新闻文本对应的主题标签，类型为ndarray
    :param test_sample:原始测试集中的新闻文本，类型为ndarray
    :return 预测结果，类型为ndarray
    '''</span>
    <span class="token comment">#********* Begin *********#</span>
    vec<span class="token operator">=</span>CountVectorizer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    train_sample<span class="token operator">=</span>vec<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>train_sample<span class="token punctuation">)</span>
    test_sample<span class="token operator">=</span>vec<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>test_sample<span class="token punctuation">)</span>
    
    tfidf<span class="token operator">=</span>TfidfTransformer<span class="token punctuation">(</span><span class="token punctuation">)</span>

    train_sample <span class="token operator">=</span>tfidf<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>train_sample<span class="token punctuation">)</span>
    test_sample<span class="token operator">=</span>tfidf<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>test_sample<span class="token punctuation">)</span>
    mnb<span class="token operator">=</span>MultinomialNB<span class="token punctuation">(</span>alpha<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span>
    mnb<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_sample<span class="token punctuation">,</span>train_label<span class="token punctuation">)</span>
    predict<span class="token operator">=</span>mnb<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_sample<span class="token punctuation">)</span>
    <span class="token keyword">return</span> predict
    <span class="token comment">#********* End *********#</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9cd3e7a233915898ea8bb5192de5373a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java写一段程序，自动检测文件的字符集并返回</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f246ed52438975332864697c140d2fd3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">机器学习-5.模型评估、选择与验证</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>