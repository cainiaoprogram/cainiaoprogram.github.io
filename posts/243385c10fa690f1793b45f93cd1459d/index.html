<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python中Pandas库教学（1） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python中Pandas库教学（1）" />
<meta property="og:description" content="Python中Pandas库教学（1） 什么是Pandas库？ Pandas是一个数据处理库，用于数据分析、数据清洗和数据转换等任务。它提供了快速、灵活和富有表现力的数据结构，可以方便地进行数据操作和分析。
安装Pandas库 在安装Pandas库之前，你需要安装Python。安装Python的方法可以在Python官网找到。
安装Pandas库的方法有两种：
1.使用pip工具安装：在命令行(windows&#43;R&#43;cmd)中运行以下命令：pip install pandas
2.使用conda工具安装：在命令行中运行以下命令：conda install pandas
导入Pandas库 在使用Pandas库之前，你需要导入它。可以使用以下代码导入Pandas库：
import pandas as pd
Pandas库的数据结构 Pandas库提供了两种主要的数据结构：Series和DataFrame。
Series Series是一种类似于一维数组的数据结构，它可以存储任意类型的数据，例如数字、字符串和Python对象等。Series的重要特性是它具有索引，它可以让你对数据进行标记和引用。
你可以使用以下代码创建一个Series：
import pandas as pd data = [1, 2, 3, 4, 5] s = pd.Series(data) print(s) 输出结果：
0 1 1 2 2 3 3 4 4 5 dtype: int64 DataFrame DataFrame是一种二维表格数据结构，它可以存储多种类型的数据，例如数字、字符串和Python对象等。DataFrame的重要特性是它具有行索引和列索引，它可以让你对数据进行标记和引用。
你可以使用以下代码创建一个DataFrame：
import pandas as pd data = { &#39;name&#39;: [&#39;Alice&#39;, &#39;Bob&#39;, &#39;Charlie&#39;, &#39;David&#39;], &#39;age&#39;: [25, 32, 18, 47], &#39;city&#39;: [&#39;New York&#39;, &#39;Paris&#39;, &#39;London&#39;, &#39;Tokyo&#39;] } df = pd." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/243385c10fa690f1793b45f93cd1459d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-20T14:49:42+08:00" />
<meta property="article:modified_time" content="2023-03-20T14:49:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python中Pandas库教学（1）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="PythonPandas1_0"></a>Python中Pandas库教学（1）</h2> 
<h2><a id="Pandas_2"></a>什么是Pandas库？</h2> 
<p>Pandas是一个数据处理库，用于数据分析、数据清洗和数据转换等任务。它提供了快速、灵活和富有表现力的数据结构，可以方便地进行数据操作和分析。</p> 
<h3><a id="Pandas_6"></a>安装Pandas库</h3> 
<p>在安装Pandas库之前，你需要安装Python。安装Python的方法可以在Python官网找到。</p> 
<p>安装Pandas库的方法有两种：</p> 
<p>1.<strong>使用pip工具安装</strong>：在命令行(windows+R+cmd)中运行以下命令：<strong>pip install pandas</strong></p> 
<p>2.<strong>使用conda工具安装</strong>：在命令行中运行以下命令：<strong>conda install pandas</strong></p> 
<h3><a id="Pandas_17"></a>导入Pandas库</h3> 
<p>在使用Pandas库之前，你需要导入它。可以使用以下代码导入Pandas库：<br> <strong>import pandas as pd</strong></p> 
<h3><a id="Pandas_21"></a>Pandas库的数据结构</h3> 
<p>Pandas库提供了两种主要的数据结构：<mark>Series</mark>和<mark>DataFrame</mark>。</p> 
<h3><a id="Series_25"></a>Series</h3> 
<p>Series是一种类似于一维数组的数据结构，它可以存储任意类型的数据，例如<mark>数字</mark>、<mark>字符串</mark>和<mark>Python对象</mark>等。Series的重要特性是它具有索引，它可以让你对数据进行<strong>标记</strong>和<strong>引用</strong>。</p> 
<p>你可以使用以下代码创建一个Series：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
</code></pre> 
<p>输出结果：</p> 
<pre><code class="prism language-python"><span class="token number">0</span>    <span class="token number">1</span>
<span class="token number">1</span>    <span class="token number">2</span>
<span class="token number">2</span>    <span class="token number">3</span>
<span class="token number">3</span>    <span class="token number">4</span>
<span class="token number">4</span>    <span class="token number">5</span>
dtype<span class="token punctuation">:</span> int64
</code></pre> 
<h3><a id="DataFrame_45"></a>DataFrame</h3> 
<p>DataFrame是一种二维表格数据结构，它可以存储多种类型的数据，例如<mark>数字</mark>、<mark>字符串</mark>和<mark>Python对象</mark>等。DataFrame的重要特性是它具有行索引和列索引，它可以让你对数据进行<strong>标记</strong>和<strong>引用</strong>。</p> 
<p>你可以使用以下代码创建一个DataFrame：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Charlie'</span><span class="token punctuation">,</span> <span class="token string">'David'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'city'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'New York'</span><span class="token punctuation">,</span> <span class="token string">'Paris'</span><span class="token punctuation">,</span> <span class="token string">'London'</span><span class="token punctuation">,</span> <span class="token string">'Tokyo'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>输出结果：</p> 
<pre><code class="prism language-python">       name  age      city
<span class="token number">0</span>     Alice   <span class="token number">25</span>  New York
<span class="token number">1</span>       Bob   <span class="token number">32</span>     Paris
<span class="token number">2</span>   Charlie   <span class="token number">18</span>    London
<span class="token number">3</span>     David   <span class="token number">47</span>     Tokyo
</code></pre> 
<h3><a id="Pandas_69"></a>Pandas库的数据操作</h3> 
<p>Pandas库提供了各种数据操作方法，例如<strong>数据筛选</strong>、<strong>数据排序</strong>和<strong>数据统计</strong>等。</p> 
<h3><a id="_71"></a>数据筛选</h3> 
<p>你可以使用以下代码选择DataFrame中的特定列：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Charlie'</span><span class="token punctuation">,</span> <span class="token string">'David'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'city'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'New York'</span><span class="token punctuation">,</span> <span class="token string">'Paris'</span><span class="token punctuation">,</span> <span class="token string">'London'</span><span class="token punctuation">,</span> <span class="token string">'Tokyo'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 选择'name'列</span>
name_col <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>name_col<span class="token punctuation">)</span>
</code></pre> 
<p>输出结果：</p> 
<pre><code class="prism language-pyhton">0      Alice
1        Bob
2    Charlie
3      David
Name: name, dtype: object
</code></pre> 
<h3><a id="_97"></a>数据排序</h3> 
<p>你可以使用以下代码对DataFrame中的数据进行排序：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Charlie'</span><span class="token punctuation">,</span> <span class="token string">'David'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'city'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'New York'</span><span class="token punctuation">,</span> <span class="token string">'Paris'</span><span class="token punctuation">,</span> <span class="token string">'London'</span><span class="token punctuation">,</span> <span class="token string">'Tokyo'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 按照年龄升序排序</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>输出结果：</p> 
<pre><code class="prism language-python">       name  age      city
<span class="token number">2</span>   Charlie   <span class="token number">18</span>    London
<span class="token number">0</span>     Alice   <span class="token number">25</span>  New York
<span class="token number">1</span>       Bob   <span class="token number">32</span>     Paris
<span class="token number">3</span>     David   <span class="token number">47</span>     Tokyo
</code></pre> 
<h3><a id="_123"></a>数据统计</h3> 
<p>你可以使用以下代码对DataFrame中的数据进行统计：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Charlie'</span><span class="token punctuation">,</span> <span class="token string">'David'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'city'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'New York'</span><span class="token punctuation">,</span> <span class="token string">'Paris'</span><span class="token punctuation">,</span> <span class="token string">'London'</span><span class="token punctuation">,</span> <span class="token string">'Tokyo'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 计算年龄的平均值</span>
mean_age <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Mean age:'</span><span class="token punctuation">,</span> mean_age<span class="token punctuation">)</span>
</code></pre> 
<p>输出结果：</p> 
<pre><code class="prism language-python">Mean age<span class="token punctuation">:</span> <span class="token number">30.5</span>
</code></pre> 
<h3><a id="Pandas_145"></a>Pandas库的数据清洗</h3> 
<p>Pandas库提供了各种<mark>数据清洗</mark>方法，例如<mark>处理缺失值</mark>和<mark>处理重复数据</mark>等。</p> 
<h3><a id="_147"></a>处理缺失值</h3> 
<p>1.<strong>删除缺失值</strong>：可以使用==dropna()==函数删除包含缺失值的行或列。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># 删除包含缺失值的行</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment"># 删除包含缺失值的列</span>
</code></pre> 
<p>2.<strong>填充缺失值</strong>：可以使用==fillna()==函数将缺失值替换为指定值或用前一个或后一个值进行填充。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>   <span class="token comment"># 将缺失值替换为0</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'ffill'</span><span class="token punctuation">)</span>   <span class="token comment"># 用前一个值进行填充</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'bfill'</span><span class="token punctuation">)</span>   <span class="token comment"># 用后一个值进行填充</span>
</code></pre> 
<p>3.<strong>插值缺失值</strong>：可以使用==interpolate()==函数通过线性或多项式插值方法填充缺失值。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>interpolate<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">)</span>   <span class="token comment"># 线性插值</span>
df<span class="token punctuation">.</span>interpolate<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'polynomial'</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment"># 二次多项式插值</span>
</code></pre> 
<h3><a id="_170"></a>处理重复数据</h3> 
<p>1.<strong>查找重复行</strong>:利用函数<mark>duplicated</mark>定位重复行</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建一个包含重复行的DataFrame</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">,</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'John'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 查找重复行</span>
duplicate_rows_df <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"重复行："</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>duplicate_rows_df<span class="token punctuation">)</span>
</code></pre> 
<p>输出结果</p> 
<pre><code class="prism language-python">重复行：
   Name  Age
<span class="token number">4</span>  John   <span class="token number">25</span>
</code></pre> 
<p>2.<strong>删除重复行</strong>:利用函数<mark>drop_duplicates</mark>:</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建一个包含重复行的DataFrame</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">,</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'John'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 删除重复行</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>输出结果：</p> 
<pre><code class="prism language-python">   Name  Age
<span class="token number">0</span>  John   <span class="token number">25</span>
<span class="token number">1</span>  Jack   <span class="token number">30</span>
<span class="token number">2</span>  Alice  <span class="token number">28</span>
<span class="token number">3</span>  Bob   <span class="token number">22</span>
</code></pre> 
<p>3.<strong>查找重复列</strong>:利用函数<mark>transpose</mark>进行行列转换</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建一个包含重复列的DataFrame</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">,</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 查找重复列</span>
duplicate_cols_series <span class="token operator">=</span> df<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"重复列："</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>duplicate_cols_series<span class="token punctuation">[</span>duplicate_cols_series<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出结果：</p> 
<pre><code class="prism language-python重复列：">1    True
dtype: bool
</code></pre> 
<p>4.<strong>删除重复列</strong>:</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建一个包含重复列的DataFrame</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">,</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 删除重复列</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>输出结果：</p> 
<pre><code class="prism language-python">   Name  Age
<span class="token number">0</span>  John   <span class="token number">30</span>
<span class="token number">1</span>  Jack   <span class="token number">25</span>
<span class="token number">2</span>  Alice  <span class="token number">22</span>
<span class="token number">3</span>  Bob   <span class="token number">28</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7282e9d8c2d577979903028b63c89541/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">plsql：关于查询结果中汉字显示为问号和以汉字当别名出现ORA-00911：invadlid character的问题。</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bf0b68f2585407896fce40dbc7683eb2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">宝塔快速搭建网站</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>