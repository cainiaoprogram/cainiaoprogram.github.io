<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>独家 | 一文读懂最大似然估计(附R代码) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="独家 | 一文读懂最大似然估计(附R代码)" />
<meta property="og:description" content="作者：阿尼·辛格
翻译： 陈之炎
校对：丁楠雅
本文约4200字，建议阅读10&#43;分钟。
本文将研究MLE是如何工作的，以及它如何用于确定具有任何分布的模型的系数。
简介
解释模型如何工作是数据科学中最为基本最为关键的问题之一。当你建立了一个模型之后，它给了你预期的结果，但是它背后的过程是什么呢？作为一个数据科学家，你需要对这个经常被问到的问题做出解答。
例如，假设您建立了一个预测公司股价的模型。您注意到夜深人静的时候，股票价格上涨得很快。背后可能有多种原因，找出可能性最大的原因便是最大似然估计的意义所在。这一概念常被用于经济学、MRIs、卫星成像等领域。
来源：YouTube 在这篇文章中，我们将研究最大似然估计(以下简称MLE)是如何工作的，以及它如何用于确定具有任何分布的模型的系数。理解MLE将涉及到概率和数学，但我将尝试通过例子使它更通俗易懂。
注：如前所述，本文假设您已经了解概率论的基本知识。您可以通过阅读这篇文章来澄清一些基本概念：
《每个数据科学专业人员都应该知道的概率分布常识》：
https://www.analyticsvidhya.com/blog/2017/09/6-probability-distributions-data-science/
目录 为什么要使用最大似然估计(MLE)？
通过一个实例了解MLE
进一步了解技术细节
分布参数
似然
对数似然
最大似然估计
利用MLE确定模型系数
R语言的MLE实现
为什么要使用最大似然估计(MLE)？ 假设我们想预测活动门票的销售情况。数据的直方图和密度如下。
你将如何为这个变量建模？该变量不是正态分布的，而且是不对称的，因此不符合线性回归的假设。一种常用的方法是对变量进行对数、平方根（sqrt）、倒数等转换，使转换后的变量服从正态分布，并进行线性回归建模。
让我们试试这些转换，看看结果如何：
对数转换：
平方根转换：
倒数转换：
所有这些都不接近正态分布，那么我们应该如何对这些数据进行建模，才能不违背模型的基本假设？如何利用正态分布以外的其他分布来建模这些数据呢？如果我们使用了不同的分布，又将如何来估计系数？
这便是最大似然估计(MLE)的主要优势。
举一个例子来加深对MLE的理解 在研究统计和概率时，你肯定遇到过诸如x＞100的概率，因为x服从正态分布，平均值为50，标准差为10。在这些问题中，我们已经知道分布（在这种情况下是正态分布）及其参数（均值和标准差），但在实际生活问题中，这些参数是未知的，并且必须从数据中估计出来。MLE可以帮助我们确定给定数据的分布参数。
让我们用一个例子来加深理解：假设我们用数据来表示班级中学生的体重(以kg为单位)。数据如下图所示(还提供了用于生成数据图的R代码)：
图 1 x = as.data.frame(rnorm(50,50,10))
ggplot(x, aes(x = x)) &#43; geom_dotplot()
这似乎遵循正态分布。但是我们如何得到这个分布的均值和标准差呢？一种方法是直接计算给定数据的平均值和标准差，分别为49.8公斤和11.37公斤。这些值能很好地表示给定的数据，但还不能最好地描述总体情况。
我们可以使用MLE来获得更稳健的参数估计。因此，MLE可以定义为从样本数据中估计总体参数(如均值和方差、泊松率(Lambda)等)的方法，从而使获得观测数据的概率(可能性)最大化。
为了加深对MLE的理解，尝试猜测下列哪一项会使观察上述数据的概率最大化？
1. 均值=100，标准差=10
2. 均值=50 ，标准差=10
显然，如果均值为100，我们就不太可能观察到上述数据分布图形。
进一步了解技术细节 知道MLE能做什么之后，我们就可以深入了解什么是真正的似然估计，以及如何对它最大化。首先，我们从快速回顾分布参数开始。
分布参数 首先，来了解一下分布参数。维基百科对这个词的定义如下：“它是一个概率分布的量化指数”，可以将它视为样本总数的数值特征或一个统计模型。通过下面的图表来理解它：
图 2
钟形曲线的宽度和高度的两个参数决定均值和方差。这就是正态分布的分布参数。同样，泊松分布由一个参数lambda控制，即事件在时间或空间间隔内发生的次数。
图 3
大多数分布都有一个或两个参数，但有些分布可以有多达4个参数，比如4参数β分布。
似然 从图2和图3中我们可以看到，给定一组分布参数，一些数据值比其他数据的概率更大。从图1中，我们已经看到，当平均值是50而不是100时，给定的数据更有可能发生。然而，在现实中，我们已经观察到了这些数据。因此，我们面临着一个逆向问题：给定观测数据和一个感兴趣的模型，我们需要在所有概率密度中找到一个最有可能产生数据的概率密度函数/概率质量函数(f(x_\θ)。
为解决这一逆向问题，我们通过逆转f(x=θ)中数据向量x和(分布)参数向量θ来定义似然函数，即：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6618e5145ae194d091c17a4f0a722823/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-09-21T07:30:00+08:00" />
<meta property="article:modified_time" content="2018-09-21T07:30:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">独家 | 一文读懂最大似然估计(附R代码)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="rich_media_content" id="js_content"> 
 <p style="min-height:1em;color:rgb(51,51,51);"><img style="line-height:25.6px;" src="https://images2.imgbox.com/f4/30/Rz1dSg9T_o.png" alt="640?wx_fmt=png"></p> 
 <p style="line-height:1.5em;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">作者：阿尼·辛格</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">翻译： 陈之炎</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">校对：丁楠雅</span></p> 
 <p style="min-height:1em;line-height:normal;">本文约<strong><span style="color:rgb(166,91,203);">4200字</span></strong>，建议阅读<span style="color:rgb(166,91,203);"><strong>10+分钟</strong></span>。<br></p> 
 <p><span style="letter-spacing:1px;">本文将研究MLE是如何工作的，以及它如何用于确定具有任何分布的模型的系数。</span></p> 
 <p style="line-height:1.5em;"><br></p> 
 <p style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="font-size:15px;letter-spacing:1px;">简介</span></strong></span></p> 
 <p style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="font-size:15px;letter-spacing:1px;"><br></span></strong></span></p> 
 <p style="line-height:1.5em;"><strong><span style="font-size:15px;letter-spacing:1px;">解释模型如何工作是数据科学中最为基本最为关键的问题之一。</span></strong><span style="font-size:15px;letter-spacing:1px;">当你建立了一个模型之后，它给了你预期的结果，但是它背后的过程是什么呢？作为一个数据科学家，你需要对这个经常被问到的问题做出解答。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">例如，假设您建立了一个预测公司股价的模型。您注意到夜深人静的时候，股票价格上涨得很快。背后可能有多种原因，找出可能性最大的原因便是最大似然估计的意义所在。这一概念常被用于经济学、MRIs、卫星成像等领域。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/70/65/hV5wem75_o.png" alt="640?wx_fmt=png"></p> 
 <p style="text-align:center;line-height:normal;"><span style="color:rgb(136,136,136);font-size:14px;letter-spacing:normal;">来源：YouTube </span><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">在这篇文章中，我们将研究最大似然估计(以下简称MLE)是如何工作的，以及它如何用于确定具有任何分布的模型的系数。理解MLE将涉及到概率和数学，但我将尝试通过例子使它更通俗易懂。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <blockquote> 
  <p style="line-height:1.5em;"><strong><span style="color:rgb(136,136,136);font-size:14px;letter-spacing:normal;">注：</span></strong><span style="color:rgb(136,136,136);font-size:14px;letter-spacing:normal;">如前所述，本文假设您已经了解概率论的基本知识。您可以通过阅读这篇文章来澄清一些基本概念：</span></p> 
 </blockquote> 
 <blockquote> 
  <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 </blockquote> 
 <blockquote> 
  <p style="line-height:normal;"><span style="font-size:14px;"><strong><span style="color:rgb(136,136,136);letter-spacing:normal;"><span style="letter-spacing:1px;">《每个数据科学专业人员都应该知道的概率分布常识》</span>：</span></strong></span></p> 
  <p style="line-height:normal;"><span style="color:rgb(136,136,136);font-size:14px;letter-spacing:normal;">https://www.analyticsvidhya.com/blog/2017/09/6-probability-distributions-data-science/</span></p> 
 </blockquote> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <h3 style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="color:rgb(166,91,203);font-size:15px;letter-spacing:1px;">目录</span></strong></span></h3> 
 <p><span style="color:rgb(166,91,203);"><strong><span style="color:rgb(166,91,203);font-size:15px;letter-spacing:1px;"><br></span></strong></span></p> 
 <ul class="list-paddingleft-2" style="list-style-type:disc;"><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">为什么要使用最大似然估计(MLE)？</span></p></li><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">通过一个实例了解MLE</span></p></li><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">进一步了解技术细节</span></p></li></ul> 
 <ul class="list-paddingleft-2" style="list-style-type:square;"><li> 
   <ul class="list-paddingleft-2" style="list-style-type:circle;"><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">分布参数</span></p></li><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">似然</span></p></li><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">对数似然</span></p></li><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">最大似然估计</span></p></li></ul></li></ul> 
 <ul class="list-paddingleft-2" style="list-style-type:disc;"><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">利用MLE确定模型系数</span></p></li><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">R语言的MLE实现</span></p></li></ul> 
 <h3 style="line-height:1.5em;"><span style="color:rgb(166,91,203);"><strong><span style="color:rgb(166,91,203);font-size:15px;letter-spacing:1px;"><br></span></strong></span></h3> 
 <h3 style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="color:rgb(166,91,203);font-size:15px;letter-spacing:1px;">为什么要使用最大似然估计(MLE)？</span></strong></span></h3> 
 <p><span style="color:rgb(166,91,203);"><strong><span style="color:rgb(166,91,203);font-size:15px;letter-spacing:1px;"><br></span></strong></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">假设我们想预测活动门票的销售情况。数据的直方图和密度如下。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img style="width:434px;" src="https://images2.imgbox.com/eb/91/XadPVCYX_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">你将如何为这个变量建模？该变量不是正态分布的，而且是不对称的，因此不符合线性回归的假设。一种常用的方法是对变量进行对数、平方根（sqrt）、倒数等转换，使转换后的变量服从正态分布，并进行线性回归建模。</span><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">让我们试试这些转换，看看结果如何：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <ul class="list-paddingleft-2" style="list-style-type:disc;"><li><p style="line-height:1.5em;"><strong><span style="font-size:15px;letter-spacing:1px;">对数转换：</span></strong></p></li></ul> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img style="width:468px;" src="https://images2.imgbox.com/6a/41/QjLuPEj1_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <ul class="list-paddingleft-2" style="list-style-type:disc;"><li><p style="line-height:1.5em;"><strong><span style="font-size:15px;letter-spacing:1px;">平方根转换：</span><br></strong></p></li></ul> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img style="width:448px;" src="https://images2.imgbox.com/ed/e5/bEDrS9Kj_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <ul class="list-paddingleft-2" style="list-style-type:disc;"><li><p style="line-height:1.5em;"><strong><span style="font-size:15px;letter-spacing:1px;">倒数转换：</span><br></strong></p></li></ul> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img style="width:470px;" src="https://images2.imgbox.com/9c/4c/P4GhcFhc_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">所有这些都不接近正态分布，那么我们应该如何对这些数据进行建模，才能不违背模型的基本假设？如何利用正态分布以外的其他分布来建模这些数据呢？如果我们使用了不同的分布，又将如何来估计系数？</span><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">这便是<strong>最大似然估计</strong>(MLE)的主要优势。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <h3 style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="color:rgb(166,91,203);font-size:15px;letter-spacing:1px;">举一个例子来加深对MLE的理解</span></strong></span></h3> 
 <p><span style="color:rgb(166,91,203);"><strong><span style="color:rgb(166,91,203);font-size:15px;letter-spacing:1px;"><br></span></strong></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">在研究统计和概率时，你肯定遇到过诸如x＞100的概率，因为x服从正态分布，平均值为50，标准差为10。在这些问题中，我们已经知道分布（在这种情况下是正态分布）及其参数（均值和标准差），但在实际生活问题中，这些参数是未知的，并且必须从数据中估计出来。<strong>MLE可以帮助我们确定给定数据的分布参数。</strong></span></p> 
 <p style="line-height:1.5em;"><strong><span style="font-size:15px;letter-spacing:1px;"> </span></strong></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">让我们用一个例子来加深理解：假设我们用数据来表示班级中学生的体重(以kg为单位)。数据如下图所示(还提供了用于生成数据图的R代码)：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/40/da/elGTbjww_o.png" alt="640?wx_fmt=png"></p> 
 <p style="line-height:normal;text-align:center;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">图 1 <br></span></p> 
 <p style="line-height:normal;text-align:center;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;"><br></span></p> 
 <blockquote> 
  <p style="line-height:normal;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">x = as.data.frame(rnorm(50,50,10))</span></p> 
  <p style="line-height:normal;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">ggplot(x, aes(x = x)) + geom_dotplot()</span></p> 
 </blockquote> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">这似乎遵循正态分布。但是我们如何得到这个分布的均值和标准差呢？一种方法是直接计算给定数据的平均值和标准差，分别为49.8公斤和11.37公斤。这些值能很好地表示给定的数据，但还不能最好地描述总体情况。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">我们可以使用MLE来获得更稳健的参数估计。因此，<strong>MLE可以定义为从样本数据中估计总体参数(如均值和方差、泊松率(Lambda)等)的方法，从而使获得观测数据的概率(可能性)最大化。</strong></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">为了加深对MLE的理解，尝试猜测下列哪一项会使观察上述数据的概率最大化？</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <blockquote> 
  <p style="line-height:1.5em;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">1. 均值=100，标准差=10</span></p> 
  <p style="line-height:1.5em;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">2. 均值=50 ，标准差=10</span></p> 
 </blockquote> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">显然，如果均值为100，我们就不太可能观察到上述数据分布图形。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <h3 style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="color:rgb(166,91,203);font-size:15px;letter-spacing:1px;">进一步了解技术细节</span></strong></span></h3> 
 <p><span style="color:rgb(166,91,203);"><strong><span style="color:rgb(166,91,203);font-size:15px;letter-spacing:1px;"><br></span></strong></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">知道MLE能做什么之后，我们就可以深入了解什么是真正的似然估计，以及如何对它最大化。首先，我们从快速回顾分布参数开始。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <ul class="list-paddingleft-2" style="list-style-type:disc;"><li><h4 style="line-height:1.5em;"><strong><span style="font-size:15px;letter-spacing:1px;">分布参数</span></strong></h4></li></ul> 
 <p><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">首先，来了解一下分布参数。维基百科对这个词的定义如下：<strong>“它是一个概率分布的量化指数”</strong>，可以将它视为样本总数的数值特征或一个统计模型。通过下面的图表来理解它：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/bc/2e/oKOQk61d_o.png" alt="640?wx_fmt=png"></p> 
 <p style="text-align:center;"><span style="color:rgb(136,136,136);font-size:14px;text-align:center;">图 2</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">钟形曲线的宽度和高度的两个参数决定均值和方差。这就是正态分布的分布参数。同样，泊松分布由一个参数lambda控制，即事件在时间或空间间隔内发生的次数。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/4f/95/9i0NCCT4_o.png" alt="640?wx_fmt=png"></p> 
 <p style="text-align:center;"><span style="color:rgb(136,136,136);font-size:14px;text-align:center;">图 3</span></p> 
 <p style="text-align:center;"><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">大多数分布都有一个或两个参数，但有些分布可以有多达4个参数，比如4参数β分布。</span><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <ul class="list-paddingleft-2" style="list-style-type:disc;"><li><h4 style="line-height:1.5em;"><strong><span style="font-size:15px;letter-spacing:1px;">似然</span></strong></h4></li></ul> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">从图2和图3中我们可以看到，给定一组分布参数，一些数据值比其他数据的概率更大。从图1中，我们已经看到，当平均值是50而不是100时，给定的数据更有可能发生。然而，在现实中，我们已经观察到了这些数据。因此，我们面临着一个逆向问题：给定观测数据和一个感兴趣的模型，我们需要在所有概率密度中找到一个最有可能产生数据的概率密度函数/概率质量函数(f(x_\θ)。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">为解决这一逆向问题，我们通过逆转f(x=θ)中数据向量x和(分布)参数向量θ来定义似然函数，即：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;text-align:center;"><span style="font-size:15px;letter-spacing:1px;">L(θ;x) = f(x| θ)</span></p> 
 <p style="line-height:1.5em;text-align:center;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">在MLE中，可以假定我们有一个似然函数L(θ；x)，其中θ是分布参数向量，x是观测集。我们感兴趣的是寻找具有给定观测值(x值)的最大可能性的θ值。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <ul class="list-paddingleft-2" style="list-style-type:disc;"><li><h4 style="line-height:1.5em;"><strong><span style="font-size:15px;letter-spacing:1px;">对数似然</span></strong></h4></li></ul> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">如果假设观测集(Xi)是独立的同分布随机变量，概率分布为f0(其中f0=正态分布，例如图1)，那么手头的数学问题就变得简单了。似然函数可以简化为：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/6b/40/4BmCzPOx_o.png" alt="640?wx_fmt=png"></p> 
 <p style="text-align:center;"><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">为了求这个函数的极大值/极小值，我们可以取此函数w.r.tθ的导数，并将其设为0(因为零斜率表示最大值或极小值)。因为我们这里有乘积，所以需要应用链式规则，这对乘积来说是相当麻烦的。<strong>一个聪明的诀窍是取似然函数的对数，并使其最大化。</strong>这将乘积转换为加法，并且由于对数是一个严格递增的函数，因此不会影响θ的结果值。所以我们有：</span><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="text-align:center;"><img style="width:461px;" src="https://images2.imgbox.com/82/c2/GeSyWvdN_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <ul class="list-paddingleft-2" style="list-style-type:disc;"><li><h4 style="line-height:1.5em;"><strong><span style="font-size:15px;letter-spacing:1px;">最大化似然</span></strong></h4></li></ul> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">为找到对数似然函数LL（Th；x）的极大值，我们可以：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <ul class="list-paddingleft-2" style="list-style-type:circle;"><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">取LL(θ；x)函数w.r.tθ的<strong>一阶</strong>导数，并将其等价于0；</span></p></li><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">取LL(θ；x)函数w.r.tθ的<strong>二阶</strong>导数，并确认其为负值。</span></p></li></ul> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">在许多情况下，微积分对最大化似然估计没有直接帮助，但最大值仍然可以很容易地识别出来。在寻找最大对数似然值的参数值时，没有任何东西比一阶导数等于零具有更为 “优先”或特殊的位置。当需要估计一些参数时，它仅仅是一个方便的工具而已。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">在通常情况下，能对函数求最大值的argmax的方法都可能适合于寻找log似然函数的最大值。这是一个无约束的非线性优化问题。我们寻求一种优化算法以下列方式工作：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <ul class="list-paddingleft-2" style="list-style-type:circle;"><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">从任意起始点可靠地收敛到局部最小化</span></p></li><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">速度尽可能快</span></p></li></ul> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">使用优化技术来最大化似然是非常常见的，可以有多种方法来实现(比如：牛顿法、Fisher评分法、各种基于共轭梯度的方法、最陡下降法、Nder-Mead型(单纯形)方法、BFGS法和多种其他技术)。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">结果表明，当模型假设为高斯时，MLE估计等价于一般的最小二乘法。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">你可以参考下面这篇文章来证明它：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <blockquote> 
  <p style="line-height:normal;"><strong><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">link：</span></strong></p> 
  <p style="line-height:normal;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">http://people.math.gatech.edu/~ecroot/3225/maximum_likelihood.pdf</span></p> 
 </blockquote> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <h3 style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="font-size:15px;letter-spacing:1px;">用MLE确定模型系数</span></strong></span></h3> 
 <p><span style="color:rgb(166,91,203);"><strong><span style="font-size:15px;letter-spacing:1px;"><br></span></strong></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">现在让我们看看如何使用MLE来确定预测模型的系数。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">假设我们有一个n个观测量y1，y2，…，yn的样本，它们可以被看作是独立的泊松随机变量：Yi ∼ P(µi)。此外，假设我们希望让均值i(方差也同样！)依赖于变量xi组成的向量。我们可以构成如下简单的线性模型：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img style="width:91px;" src="https://images2.imgbox.com/63/1e/0AxP9VPr_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">中θ是模型系数的向量。这个模型的缺点是右边的线性预测器可以假定为任何实际值，而表示期望计数的左侧泊松均值必须是非负的。这个问题的一个简单的解决办法是用线性模型来模拟平均值的对数。因此，我们考虑了一个具有对数链接对数的广义线性模型，它可以写成如下所示：</span><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img style="width:143px;" src="https://images2.imgbox.com/d8/68/DJzOoEzH_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <p style="line-height:1.5em;"><strong><span style="font-size:15px;letter-spacing:1px;">我们的目的是利用MLE找到θ。</span><br></strong></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">现在，泊松分布如下：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img style="width:206px;" src="https://images2.imgbox.com/74/2e/EnrCCinB_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">利用在上一节中学到的对数似然概念来求θ。取上述方程的对数，忽略包含log(y！)的常数，我们得到的对数似然函数是：</span><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img style="width:354px;" src="https://images2.imgbox.com/e0/6d/0a5CAOGh_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">其中，µi依赖协变量xi和θ系数的向量。我们可以用变元µi = exp(xi’θ)代替，求解方程，得到最大似然值θ。得到了θ向量之后，我们就可以通过乘以xi和θ向量来预测平均值的期望值。</span><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <h3 style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="font-size:15px;letter-spacing:1px;">用R语言实现MLE</span></strong></span></h3> 
 <p><span style="color:rgb(166,91,203);"><strong><span style="font-size:15px;letter-spacing:1px;"><br></span></strong></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">在本节中，我们将采用一个真实的数据集，运用前面学到的概念，来解决一个问题。您可以从此链接下载数据集：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <blockquote> 
  <p style="line-height:normal;"><span style="font-size:14px;letter-spacing:normal;color:rgb(136,136,136);">https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2018/07/ Train_Tickets.csv</span></p> 
 </blockquote> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><strong><span style="font-size:15px;letter-spacing:1px;">数据集中的示例如下：</span></strong><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><strong><span style="font-size:15px;letter-spacing:1px;"><br></span></strong></span></p> 
 <p style="line-height:1.5em;text-align:center;"><span style="font-size:15px;letter-spacing:1px;">             售票日期           计票     </span></p> 
 <p style="line-height:1.5em;text-align:center;"><span style="font-size:15px;letter-spacing:1px;">25-08-2012 00:00      8</span></p> 
 <p style="line-height:1.5em;text-align:center;"><span style="font-size:15px;letter-spacing:1px;">25-08-2012 01:00      2</span></p> 
 <p style="line-height:1.5em;text-align:center;"><span style="font-size:15px;letter-spacing:1px;">25-08-2012 02:00      6</span></p> 
 <p style="line-height:1.5em;text-align:center;"><span style="font-size:15px;letter-spacing:1px;">25-08-2012 03:00      2</span></p> 
 <p style="line-height:1.5em;text-align:center;"><span style="font-size:15px;letter-spacing:1px;">25-08-2012 04:00      2</span></p> 
 <p style="line-height:1.5em;text-align:center;"><span style="font-size:15px;letter-spacing:1px;">25-08-2012 05:00      2</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">它有从2012年8月25日到2014年9月25日每小时售出的门票数量(约18K记录)。我们的目的是预测每小时售出的门票数量。这是本文第一节中讨论的同一个数据集。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><strong><span style="font-size:15px;letter-spacing:1px;">这个问题可以用回归、时间序列等技术来解决。</span></strong><span style="font-size:15px;letter-spacing:1px;">在这里，我们将使用我们已经学习到的统计建模技术，用R语言实现。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">首先，分析一下数据。在统计建模中，我们更关心的是目标变量是如何分布的。让我们看一看计数的分布：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <blockquote> 
  <p style="line-height:normal;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">hist(Y$Count, breaks = 50,probability = T ,main = "Histogram of Count Variable")</span></p> 
  <p style="line-height:normal;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">lines(density(Y$Count), col="red", lwd=2)</span></p> 
 </blockquote> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"></span></p> 
 <p style="text-align:center;"><br></p> 
 <p style="text-align:center;"><img style="width:433px;" src="https://images2.imgbox.com/e5/07/slk741fc_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">这可以看作是泊松分布，或者我们甚至可以尝试拟合指数分布。</span><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">由于手头的变量是票的计数，泊松分布是一个更合适的模型。指数分布通常用于模拟事件之间的时间间隔。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">让我们来计算一下这两年售出的票的数量：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img style="width:476px;" src="https://images2.imgbox.com/e5/c5/dvR57mpx_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">看上去随着时间的推移，门票的销售有了很大的增长。为了将问题简单化，让我们仅将时间作为一个因子来建模，其中时间定义为2012年8月25日以来几个星期。我们可以把它写成：</span><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img style="width:430px;" src="https://images2.imgbox.com/46/36/0e2zi7M1_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">其中，µ（售出的票数）是泊松分布的平均值，而θ0和θ1是我们需要估计的系数。</span><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">组合方程1和2，我们得到如下的对数似然函数：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img style="width:434px;" src="https://images2.imgbox.com/bb/d9/1L8UHkWj_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">我们可以使用Rstats 4包中的mle() 函数来估计系数θ0和θ1。它需要下列主要参数：</span><br></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <ul class="list-paddingleft-2" style="list-style-type:disc;"><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">需要<strong>最小化的负似然函数</strong>：这与我们刚刚导出的函数相同，但前面有一个负号[最大对数似然度等于最小化负对数似然]。</span></p></li><li><p style="line-height:1.5em;"><strong><span style="font-size:15px;letter-spacing:1px;">系数向量的起点：</span></strong><span style="font-size:15px;letter-spacing:1px;">这是系数的初始预测值。结果可以根据这些值而变化，因为函数可能达到局部最小值。因此，通过运行不同起点的函数来验证结果是很好的办法。</span></p></li><li><p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><strong>BFGS</strong>是默认的对似然函数进行优化的方法。</span></p></li></ul> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;">在我们的示例中，负对数似然函数的编码如下：</span></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <blockquote> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">nll &lt;- function(theta0,theta1) {<!-- --></span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">    x &lt;- Y$age[-idx]</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">    y &lt;- Y$Count[-idx]</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">    mu = exp(theta0 + x*theta1)</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">    -sum(y*(log(mu)) - mu)</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">}</span></p> 
 </blockquote> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;">我将数据分为训练集和测试集，以便客观地评价模型的性能。idx是测试集中行的指数。</span></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <blockquote> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">set.seed(200)</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">idx &lt;- createDataPartition(Y$Count, p=0.25,list=FALSE)</span></p> 
 </blockquote> 
 <p style="line-height:normal;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:normal;text-align:left;"><span style="font-size:15px;letter-spacing:1px;">接下来，调用mle函数来获得参数：</span></p> 
 <p style="line-height:normal;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <blockquote> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">est &lt;- stats4::mle(minuslog=nll, start=list(theta0=2,theta1=0))</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">summary(est)</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;"> </span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">Maximum likelihood estimation</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">Call:</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">stats4::mle(minuslogl = nll, start = list(theta0 = 2, theta1 = 0))</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;"> </span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">Coefficients:</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">         Estimate  Std. Error</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">theta0 2.68280754 2.548367e-03</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">theta1 0.03264451 2.998218e-05</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;"> </span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">-2 log L: -16594396</span></p> 
 </blockquote> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">我们得到了系数的估计值，利用RMSE作为获得测试集结果的评估度量：</span></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <blockquote> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">pred.ts &lt;- (exp(coef(est)['theta0'] + Y$age[idx]*coef(est)['theta1'] ))</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">rmse(pred.ts, Y$Count[idx])</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;"> </span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">86.95227</span></p> 
 </blockquote> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;">现在，让我们看看我们的模型和标准线性模型(正态分布的误差)的对比，本模型是用对数计数建模。</span></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <blockquote> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">lm.fit &lt;-  lm(log(Count)~age, data=Y[-idx,])</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;"> </span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">Coefficients:</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">             Estimate Std. Error t value Pr(&gt;|t|)    </span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">(Intercept) 1.9112992 0.0110972   172.2 &lt;2e-16 ***</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">age         0.0414107 0.0001768   234.3 &lt;2e-16 ***</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">pred.lm &lt;- predict(lm.fit, Y[idx,])</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">rmse(exp(pred.lm), Y$Count[idx]) </span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;"> </span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">93.77393</span></p> 
 </blockquote> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">可以看出来，标准线性模型的RMSE比我们的泊松分布模型要高。让我们比较这两个模型在样本上的残差图，看看这些模型在不同的区域中表现如何：</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/e2/ed/izEGOe2X_o.png" alt="640?wx_fmt=png"></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">与常规线性回归相比，泊松回归的误差更接近于零。</span><br></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;">在Python中，也可以通过使用<strong>scipy.optimize.minimize()</strong>函数来实现目标函数的最小化，对初始值的估计同BFGS、L-BFGS等参数和方法类似。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">在R语言中，使用stats包中的glm 函数建模更加简单。它支持泊松，伽玛，二项分布，Quasi，逆高斯，拟二项分布，拟泊松分布等等。对于上面所示的示例，可以使用以下命令直接获得系数：</span></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <blockquote> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">glm(Count ~ age, family = "poisson", data = Y)</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;"> </span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">Coefficients:</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">             Estimate Std. Error z value Pr(&gt;|z|)    </span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">(Intercept) 2.669     2.218e-03    1203 &lt;2e-16 ***</span></p> 
  <p style="line-height:normal;text-align:left;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">age         0.03278   2.612e-05    1255 &lt;2e-16 ***</span></p> 
 </blockquote> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">在Python中也可以使用pymc.glm()函数，并设置为<span style="font-size:15px;letter-spacing:normal;">pm.glm.Familes.Poisson()</span>系列。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <h3 style="line-height:1.5em;text-align:center;"><strong><span style="font-size:15px;letter-spacing:1px;color:rgb(166,91,203);">尾注</span></strong></h3> 
 <p><strong><span style="font-size:15px;letter-spacing:1px;color:rgb(166,91,203);"><br></span></strong></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;">对上述例子的一种思考是，参数空间中是否存在比标准线性模型估计更好的系数。正态分布是缺省分布，也是最广泛使用的分布形式，但如果采用其它更为正确的分布，则可以得到更好的结果<strong>。最大似然估计是一种可以用于估计分布参数而不考虑所使用的分布的技术。</strong>因此，下次当您手头有建模问题时，首先看看数据的分布情况，看看有没有比正态分布更有意义的分布！</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;">详细的代码和数据在我的Gizub存储库中可以找到。</span></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p> 
 <p style="line-height:1.5em;text-align:left;"><span style="font-size:15px;letter-spacing:1px;">有关使用年龄变量的数据读取、格式化和建模的示例，请参阅<span style="font-size:15px;letter-spacing:normal;">“ModelingSingleVariables.R”</span>文件。此外，我还使用了多个变量进行建模，它保存于</span><span style="font-size:15px;letter-spacing:normal;">“ModelingMultipleVariables.R”</span><span style="font-size:15px;letter-spacing:1px;">文件中。</span></p> 
 <p style="line-height:1.5em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p> 
 <p style="line-height:normal;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">原文标题：</span></p> 
 <p style="line-height:normal;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">An Introductory Guide to Maximum Likelihood Estimation (with a case study in R)</span></p> 
 <p style="line-height:normal;"><span style="color:rgb(136,136,136);font-size:14px;letter-spacing:1px;">原文链接：</span></p> 
 <p style="line-height:normal;"><span style="font-size:14px;color:rgb(136,136,136);letter-spacing:normal;">https://www.analyticsvidhya.com/blo</span><span style="color:rgb(136,136,136);font-size:14px;">g/2018/07/introductory-guide-maximum-likelihood-estimation-case-study-r/</span></p> 
 <p style="line-height:normal;"><span style="color:rgb(136,136,136);font-size:14px;"><br></span></p> 
 <p><strong>译者简介</strong></p> 
 <img style="width:111.993px;" src="https://images2.imgbox.com/ab/2a/xFS5qERg_o.png" alt="640?wx_fmt=png"> 
 <p style="clear:none;"><strong>陈之炎，</strong>北京交通大学通信与控制工程专业毕业，获得工学硕士学位，历任长城计算机软件与系统公司工程师，大唐微电子公司工程师，现任北京吾译超群科技有限公司技术支持。目前从事智能化翻译教学系统的运营和维护，在人工智能深度学习和自然语言处理（NLP）方面积累有一定的经验。业余时间喜爱翻译创作，翻译作品主要有：IEC-ISO 7816、伊拉克石油工程项目、新财税主义宣言等等，其中中译英作品“新财税主义宣言”在GLOBAL TIMES正式发表。能够利用业余时间加入到THU 数据派平台的翻译志愿者小组，希望能和大家一起交流分享，共同进步</p> 
 <p><strong>翻译组招募信息</strong></p> 
 <p><strong>工作内容：</strong>需要一颗细致的心，将选取好的外文文章翻译成流畅的中文。如果你是数据科学/统计学/计算机类的留学生，或在海外从事相关工作，或对自己外语水平有信心的朋友欢迎加入翻译小组。<br></p> 
 <p><strong>你能得到：</strong>定期的翻译培训提高志愿者的翻译水平，提高对于数据科学前沿的认知，海外的朋友可以和国内技术应用发展保持联系，THU数据派产学研的背景为志愿者带来好的发展机遇。</p> 
 <p><strong>其他福利：</strong>来自于名企的数据科学工作者，北大清华以及海外等名校学生他们都将成为你在翻译小组的伙伴。</p> 
 <p><br></p> 
 <p style="text-align:center;"><strong>点击文末“<span style="color:rgb(166,92,203);">阅读原文</span>”加入数据派团队~</strong></p> 
 <p style="min-height:1em;text-align:center;"><span style="color:rgb(166,91,203);"><strong>转载须知</strong></span></p> 
 <p style="min-height:1em;">如需转载，请在开篇显著位置注明作者和出处（转自：数据派ID：datapi），并在文章结尾放置数据派醒目二维码。有原创标识文章，请发送【文章名称-待授权公众号名称及ID】至联系邮箱，申请白名单授权并按要求编辑。</p> 
 <p style="min-height:1em;">发布后请将链接反馈至联系邮箱（见下方）。未经许可的转载以及改编者，我们将依法追究其法律责任。<br></p> 
 <br> 
 <p style="min-height:1em;"><img style="color:rgb(51,51,51);" src="https://images2.imgbox.com/27/79/KDnAvu1l_o.png" alt="640?wx_fmt=png"><img style="line-height:1.6;" src="https://images2.imgbox.com/95/8b/aLAXYXuQ_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p>点击<strong>“阅读原文”</strong>拥抱组织</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7241d1e7e1dfc4aced396185d603ebcf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【NOIP2017普及组】跳房子</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1e069c3cfcf18d71b24546de9497213a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">bootstrap-select selectpicker动态设置选中无效</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>