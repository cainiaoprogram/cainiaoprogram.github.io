<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>kmeans聚类算法及matlab实现 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="kmeans聚类算法及matlab实现" />
<meta property="og:description" content="一、kmeans聚类算法介绍： kmeans算法是一种经典的无监督机器学习算法，名列数据挖掘十大算法之一。作为一个非常好用的聚类算法，kmeans的思想和实现都比较简单。kmeans的主要思想：把数据划分到各个区域(簇)，使得数据与区域中心的距离之和最小。换个角度来说，kmeans算法把数据量化为聚类中心，其目标函数就是使量化过程中损失的“信息”最少。kmeans算法求解目标函数的过程也可以看做是EM(Expectation maximization)迭代优化。
二、kmeans目标函数及优化： 定义：数据集 XN×D ，聚类中心 UK×D ，指示矩阵 rN×K 。 其中 rnk=1 如果第n个样本属于第k个聚类，否则 rnk=0 。kmeans 聚类算法的目标是让数据与相应的聚类中心的距离之和最小： P=∑n=1N∑k=1Krnk∥xn−uk∥2 迭代优化：未知变量是两个矩阵–聚类中心 UK×D 和指示矩阵 rN×K ，直接进行优化太困难（NP问题），所以需要迭代优化这两个变量来得到一个局部最优解。 1、固定聚类中心 UK×D ，优化指示矩阵 rN×K ：如果第n个样本距离第k个聚类最近，则赋值 rnk=1 ，否则赋值 rnk=0 。 2、固定指示矩阵 rN×K ，优化聚类中心 UK×D ：拆分目标函数，分开优化每一个聚类中心（聚类中心之间没有耦合关系），推导如下 P=∑k=1K∑n=1Nrnk∥xn−uk∥2min∑n=1Nrnk∥xn−uk∥2,k=1,...,K平方误差函数，直接求导：2∑n=1Nrnk(xn−uk)=0uk=(∑n=1Nrnkxn)/(∑n=1Nrnk),即率属于第k个聚类的数据均值 从EM角度来看：把指示矩阵 rN×K 当做隐变量，聚类中心 UK×D 当做模型参数，更新 rN×K 和 UK×D 就分别对应于EM算法的E步和M步。 三、判停标准： kmeans算法的迭代优化过程一直持续直到满足某个判停标准，如果在这一轮迭代中：
1、训练样本所属类别不再发生改变或者只有很少几个训练样本改变； 2、目标函数变化很小或者聚类中心向量变化很小； 3、达到最大迭代次数。
满足其中一个条件，即可停止训练。如果满足条件1或2，说明算法已经收敛。
四、K值的选取： 随着聚类数K的增大，目标函数呈减小趋势。但是另一方面K值的增大会导致存储空间和计算量的增加。那么如何选择合适的K值呢？ 1.经验法：根据问题的性质和先验知识，人为指定聚类的数目。 2.爬山法：但当聚类数目到达一定值以后，聚类数目的增加目标函数的变化很小，这个拐点可以认为是最优聚类数目。
五、matlab计算数据与聚类中心之间的距离 matlab诞生的初衷就是为了矩阵运算的方便，所以如果用for循环来计算数据与聚类中心的距离从而得到指示矩阵 rN×K 这种速度极慢的方法是不可取的。对欧氏距离函数做个小小的变换： ∥xn−uk∥2=(xn−uk)⋅(xn−uk)⊤,n=1,...,N,k=1,...,K=xn⋅x⊤n&#43;uk⋅u⊤k−2xn⋅u⊤k=∥xn∥2&#43;∥uk∥2−2xn⋅u⊤k matlab代码（借鉴一下大牛的代码）：
function n2 = sp_dist2(x, c) % DIST2 Calculates squared distance between two sets of points." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/42a002e86e7df1cb4ff2d71109bf8695/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-11-12T19:25:10+08:00" />
<meta property="article:modified_time" content="2015-11-12T19:25:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">kmeans聚类算法及matlab实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3 id="一kmeans聚类算法介绍"><strong>一、kmeans聚类算法介绍</strong>：</h3> 
<p>　　 kmeans算法是一种经典的无监督机器学习算法，名列数据挖掘十大算法之一。作为一个非常好用的聚类算法，kmeans的思想和实现都比较简单。kmeans的主要思想：把数据划分到各个区域(簇)，使得数据与区域中心的距离之和最小。换个角度来说，kmeans算法把数据量化为聚类中心，其目标函数就是使量化过程中损失的“信息”最少。kmeans算法求解目标函数的过程也可以看做是EM(Expectation maximization)迭代优化。</p> 
<h3 id="二kmeans目标函数及优化"><strong>二、kmeans目标函数及优化</strong>：</h3> 
<p>定义：数据集<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-60-Frame"> 
   
   <span class="math" id="MathJax-Span-1244" style="width: 3.416em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.723em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.496em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1245"><span class="msubsup" id="MathJax-Span-1246"><span style="display: inline-block; position: relative; width: 2.669em; height: 0px;"><span style="position: absolute; clip: rect(1.709em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1247" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.856em;"><span class="texatom" id="MathJax-Span-1248"><span class="mrow" id="MathJax-Span-1249"><span class="mi" id="MathJax-Span-1250" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1251" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-60">X_{N\times D}</script>，聚类中心<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-61-Frame"> 
   
   <span class="math" id="MathJax-Span-1253" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.563em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.496em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1254"><span class="msubsup" id="MathJax-Span-1255"><span style="display: inline-block; position: relative; width: 2.509em; height: 0px;"><span style="position: absolute; clip: rect(1.709em 1000em 2.776em -0.477em); top: -2.557em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1256"><span class="mrow" id="MathJax-Span-1257"><span class="mi" id="MathJax-Span-1258" style="font-family: MathJax_Caligraphic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.643em;"><span class="texatom" id="MathJax-Span-1259"><span class="mrow" id="MathJax-Span-1260"><span class="mi" id="MathJax-Span-1261" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1262" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1263" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-61">\mathcal{U}_{K\times D}</script>，指示矩阵<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-62-Frame"> 
   
   <span class="math" id="MathJax-Span-1264" style="width: 3.043em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1265"><span class="msubsup" id="MathJax-Span-1266"><span style="display: inline-block; position: relative; width: 2.349em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1267" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1268"><span class="mrow" id="MathJax-Span-1269"><span class="mi" id="MathJax-Span-1270" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1271" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1272" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-62">r_{N \times K}</script>。 <br> 其中<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-63-Frame"> 
   
   <span class="math" id="MathJax-Span-1273" style="width: 3.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.149em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.923em 1000em 3.043em -0.477em); top: -2.717em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1274"><span class="msubsup" id="MathJax-Span-1275"><span style="display: inline-block; position: relative; width: 1.336em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1276" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1277"><span class="mrow" id="MathJax-Span-1278"><span class="mi" id="MathJax-Span-1279" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1280" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1281" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-1282" style="font-family: MathJax_Main; padding-left: 0.269em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.137em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-63">r_{nk}=1</script>如果第n个样本属于第k个聚类，否则<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-64-Frame"> 
   
   <span class="math" id="MathJax-Span-1283" style="width: 3.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.149em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.923em 1000em 3.043em -0.477em); top: -2.717em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1284"><span class="msubsup" id="MathJax-Span-1285"><span style="display: inline-block; position: relative; width: 1.336em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1286" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1287"><span class="mrow" id="MathJax-Span-1288"><span class="mi" id="MathJax-Span-1289" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1290" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1291" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-1292" style="font-family: MathJax_Main; padding-left: 0.269em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.137em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-64">r_{nk}=0</script>。kmeans 聚类算法的目标是让数据与相应的聚类中心的距离之和最小： <br> <span class="MathJax_Preview"></span></p> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-65-Frame"> 
   
   <span class="math" id="MathJax-Span-1293" style="width: 14.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.896em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.176em 1000em 4.429em -0.477em); top: -3.037em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1294"><span class="texatom" id="MathJax-Span-1295"><span class="mrow" id="MathJax-Span-1296"><span class="mi" id="MathJax-Span-1297" style="font-family: MathJax_AMS;">P</span></span></span><span class="mo" id="MathJax-Span-1298" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="munderover" id="MathJax-Span-1299" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(2.669em 1000em 4.376em -0.424em); top: -3.784em; left: 0.003em;"><span class="mo" id="MathJax-Span-1300" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.789em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.776em -0.477em); top: -1.437em; left: 0.109em;"><span class="texatom" id="MathJax-Span-1301"><span class="mrow" id="MathJax-Span-1302"><span class="mi" id="MathJax-Span-1303" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1304" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1305" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span><span style="position: absolute; clip: rect(1.709em 1000em 2.616em -0.477em); top: -3.624em; left: 0.429em;"><span class="mi" id="MathJax-Span-1306" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1307" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(2.669em 1000em 4.376em -0.424em); top: -3.784em; left: 0.003em;"><span class="mo" id="MathJax-Span-1308" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.789em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.776em -0.424em); top: -1.384em; left: 0.109em;"><span class="texatom" id="MathJax-Span-1309"><span class="mrow" id="MathJax-Span-1310"><span class="mi" id="MathJax-Span-1311" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1312" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1313" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span><span style="position: absolute; clip: rect(1.709em 1000em 2.616em -0.477em); top: -3.624em; left: 0.429em;"><span class="mi" id="MathJax-Span-1314" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1315" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 1.336em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1316" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1317"><span class="mrow" id="MathJax-Span-1318"><span class="mi" id="MathJax-Span-1319" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1320" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1321" style="font-family: MathJax_Main; padding-left: 0.269em;">∥</span><span class="msubsup" id="MathJax-Span-1322" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1323" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1324" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1325" style="font-family: MathJax_Main; padding-left: 0.216em;">−</span><span class="msubsup" id="MathJax-Span-1326" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1327" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1328" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1329"><span style="display: inline-block; position: relative; width: 0.963em; height: 0px;"><span style="position: absolute; clip: rect(1.816em 1000em 3.149em -0.371em); top: -2.717em; left: 0.003em;"><span class="mo" id="MathJax-Span-1330" style="font-family: MathJax_Main;">∥</span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span><span style="position: absolute; top: -2.984em; left: 0.536em;"><span class="mn" id="MathJax-Span-1331" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.043em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.803em; vertical-align: -1.597em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-65">\begin{equation}
    \mathbb{P} = \sum_{n=1}^N \sum_{k=1}^K r_{nk} \parallel x_n - u_k\parallel^2
\end{equation}</script> 
<br> 　　迭代优化：未知变量是两个矩阵–聚类中心 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-66-Frame"> 
  
  <span class="math" id="MathJax-Span-1332" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.563em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.496em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1333"><span class="msubsup" id="MathJax-Span-1334"><span style="display: inline-block; position: relative; width: 2.509em; height: 0px;"><span style="position: absolute; clip: rect(1.709em 1000em 2.776em -0.477em); top: -2.557em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1335"><span class="mrow" id="MathJax-Span-1336"><span class="mi" id="MathJax-Span-1337" style="font-family: MathJax_Caligraphic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.643em;"><span class="texatom" id="MathJax-Span-1338"><span class="mrow" id="MathJax-Span-1339"><span class="mi" id="MathJax-Span-1340" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1341" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1342" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-66">\mathcal{U}_{K\times D}</script>和指示矩阵 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-67-Frame"> 
  
  <span class="math" id="MathJax-Span-1343" style="width: 3.043em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1344"><span class="msubsup" id="MathJax-Span-1345"><span style="display: inline-block; position: relative; width: 2.349em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1346" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1347"><span class="mrow" id="MathJax-Span-1348"><span class="mi" id="MathJax-Span-1349" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1350" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1351" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-67">r_{N \times K}</script>，直接进行优化太困难（NP问题），所以需要迭代优化这两个变量来得到一个局部最优解。 
<br> 1、固定聚类中心 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-68-Frame"> 
  
  <span class="math" id="MathJax-Span-1352" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.563em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.496em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1353"><span class="msubsup" id="MathJax-Span-1354"><span style="display: inline-block; position: relative; width: 2.509em; height: 0px;"><span style="position: absolute; clip: rect(1.709em 1000em 2.776em -0.477em); top: -2.557em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1355"><span class="mrow" id="MathJax-Span-1356"><span class="mi" id="MathJax-Span-1357" style="font-family: MathJax_Caligraphic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.643em;"><span class="texatom" id="MathJax-Span-1358"><span class="mrow" id="MathJax-Span-1359"><span class="mi" id="MathJax-Span-1360" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1361" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1362" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-68">\mathcal{U}_{K\times D}</script>，优化指示矩阵 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-69-Frame"> 
  
  <span class="math" id="MathJax-Span-1363" style="width: 3.043em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1364"><span class="msubsup" id="MathJax-Span-1365"><span style="display: inline-block; position: relative; width: 2.349em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1366" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1367"><span class="mrow" id="MathJax-Span-1368"><span class="mi" id="MathJax-Span-1369" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1370" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1371" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-69">r_{N \times K}</script>：如果第n个样本距离第k个聚类最近，则赋值 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-70-Frame"> 
  
  <span class="math" id="MathJax-Span-1372" style="width: 3.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.149em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.923em 1000em 3.043em -0.477em); top: -2.717em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1373"><span class="msubsup" id="MathJax-Span-1374"><span style="display: inline-block; position: relative; width: 1.336em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1375" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1376"><span class="mrow" id="MathJax-Span-1377"><span class="mi" id="MathJax-Span-1378" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1379" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1380" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-1381" style="font-family: MathJax_Main; padding-left: 0.269em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.137em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-70">r_{nk}=1</script>，否则赋值 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-71-Frame"> 
  
  <span class="math" id="MathJax-Span-1382" style="width: 3.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.149em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.923em 1000em 3.043em -0.477em); top: -2.717em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1383"><span class="msubsup" id="MathJax-Span-1384"><span style="display: inline-block; position: relative; width: 1.336em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1385" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1386"><span class="mrow" id="MathJax-Span-1387"><span class="mi" id="MathJax-Span-1388" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1389" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1390" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-1391" style="font-family: MathJax_Main; padding-left: 0.269em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.137em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-71">r_{nk}=0</script>。 
<br> 2、固定指示矩阵 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-72-Frame"> 
  
  <span class="math" id="MathJax-Span-1392" style="width: 3.043em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1393"><span class="msubsup" id="MathJax-Span-1394"><span style="display: inline-block; position: relative; width: 2.349em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1395" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1396"><span class="mrow" id="MathJax-Span-1397"><span class="mi" id="MathJax-Span-1398" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1399" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1400" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-72">r_{N \times K}</script>，优化聚类中心 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-73-Frame"> 
  
  <span class="math" id="MathJax-Span-1401" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.563em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.496em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1402"><span class="msubsup" id="MathJax-Span-1403"><span style="display: inline-block; position: relative; width: 2.509em; height: 0px;"><span style="position: absolute; clip: rect(1.709em 1000em 2.776em -0.477em); top: -2.557em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1404"><span class="mrow" id="MathJax-Span-1405"><span class="mi" id="MathJax-Span-1406" style="font-family: MathJax_Caligraphic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.643em;"><span class="texatom" id="MathJax-Span-1407"><span class="mrow" id="MathJax-Span-1408"><span class="mi" id="MathJax-Span-1409" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1410" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1411" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-73">\mathcal{U}_{K\times D}</script>：拆分目标函数，分开优化每一个聚类中心（聚类中心之间没有耦合关系），推导如下 
<br> 
<span class="MathJax_Preview"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-74-Frame"> 
   
   <span class="math" id="MathJax-Span-1412" style="width: 29.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(-4.371em 1000em 8.589em -0.317em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1413"><span class="mtable" id="MathJax-Span-1414" style="padding-right: 0.163em; padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 22.829em; height: 0px;"><span style="position: absolute; clip: rect(5.709em 1000em 15.736em -0.477em); top: -10.717em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.003em; height: 0px;"><span style="position: absolute; clip: rect(3.843em 1000em 4.163em -0.477em); top: -8.851em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1415"><span class="mrow" id="MathJax-Span-1416"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.843em 1000em 4.163em -0.477em); top: -5.597em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1456"><span class="mrow" id="MathJax-Span-1457"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.843em 1000em 4.163em -0.477em); top: -2.344em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1496"><span class="mrow" id="MathJax-Span-1497"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.843em 1000em 4.163em -0.477em); top: 0.856em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1527"><span class="mrow" id="MathJax-Span-1528"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.723em;"></span></span><span style="position: absolute; clip: rect(6.936em 1000em 19.896em -0.477em); top: -13.651em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 22.829em; height: 0px;"><span style="position: absolute; clip: rect(1.176em 1000em 4.429em -0.477em); top: -7.891em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1417"><span class="mrow" id="MathJax-Span-1418"><span class="texatom" id="MathJax-Span-1419"><span class="mrow" id="MathJax-Span-1420"><span class="mi" id="MathJax-Span-1421" style="font-family: MathJax_AMS;">P</span></span></span><span class="mo" id="MathJax-Span-1422" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="munderover" id="MathJax-Span-1423" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(2.669em 1000em 4.376em -0.424em); top: -3.784em; left: 0.003em;"><span class="mo" id="MathJax-Span-1424" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.789em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.776em -0.424em); top: -1.384em; left: 0.109em;"><span class="texatom" id="MathJax-Span-1425"><span class="mrow" id="MathJax-Span-1426"><span class="mi" id="MathJax-Span-1427" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1428" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1429" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span><span style="position: absolute; clip: rect(1.709em 1000em 2.616em -0.477em); top: -3.624em; left: 0.429em;"><span class="mi" id="MathJax-Span-1430" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1431" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(2.669em 1000em 4.376em -0.424em); top: -3.784em; left: 0.003em;"><span class="mo" id="MathJax-Span-1432" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.789em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.776em -0.477em); top: -1.437em; left: 0.109em;"><span class="texatom" id="MathJax-Span-1433"><span class="mrow" id="MathJax-Span-1434"><span class="mi" id="MathJax-Span-1435" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1436" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1437" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span><span style="position: absolute; clip: rect(1.709em 1000em 2.616em -0.477em); top: -3.624em; left: 0.429em;"><span class="mi" id="MathJax-Span-1438" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1439" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 1.336em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1440" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1441"><span class="mrow" id="MathJax-Span-1442"><span class="mi" id="MathJax-Span-1443" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1444" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1445" style="font-family: MathJax_Main; padding-left: 0.269em;">∥</span><span class="msubsup" id="MathJax-Span-1446" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1447" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1448" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1449" style="font-family: MathJax_Main; padding-left: 0.216em;">−</span><span class="msubsup" id="MathJax-Span-1450" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1451" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1452" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1453"><span style="display: inline-block; position: relative; width: 0.963em; height: 0px;"><span style="position: absolute; clip: rect(1.816em 1000em 3.149em -0.371em); top: -2.717em; left: 0.003em;"><span class="mo" id="MathJax-Span-1454" style="font-family: MathJax_Main;">∥</span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span><span style="position: absolute; top: -2.984em; left: 0.536em;"><span class="mn" id="MathJax-Span-1455" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.043em;"></span></span><span style="position: absolute; clip: rect(0.856em 1000em 4.056em -0.211em); top: -4.317em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1458"><span class="mrow" id="MathJax-Span-1459"><span class="mo" id="MathJax-Span-1460" style="font-family: MathJax_Main; padding-left: 0.216em; padding-right: 0.323em;">min</span><span class="munderover" id="MathJax-Span-1461"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(2.669em 1000em 4.376em -0.424em); top: -3.784em; left: 0.003em;"><span class="mo" id="MathJax-Span-1462" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.789em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.776em -0.477em); top: -1.437em; left: 0.109em;"><span class="texatom" id="MathJax-Span-1463"><span class="mrow" id="MathJax-Span-1464"><span class="mi" id="MathJax-Span-1465" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1466" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1467" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span><span style="position: absolute; clip: rect(1.709em 1000em 2.616em -0.477em); top: -3.624em; left: 0.429em;"><span class="mi" id="MathJax-Span-1468" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1469" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 1.336em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1470" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1471"><span class="mrow" id="MathJax-Span-1472"><span class="mi" id="MathJax-Span-1473" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1474" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1475" style="font-family: MathJax_Main; padding-left: 0.269em;">∥</span><span class="msubsup" id="MathJax-Span-1476" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1477" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1478" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1479" style="font-family: MathJax_Main; padding-left: 0.216em;">−</span><span class="msubsup" id="MathJax-Span-1480" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1481" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1482" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1483" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 0.963em; height: 0px;"><span style="position: absolute; clip: rect(1.816em 1000em 3.149em -0.371em); top: -2.717em; left: 0.003em;"><span class="mo" id="MathJax-Span-1484" style="font-family: MathJax_Main;">∥</span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span><span style="position: absolute; top: -2.984em; left: 0.536em;"><span class="mn" id="MathJax-Span-1485" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span><span class="mo" id="MathJax-Span-1486" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1487" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">k</span><span class="mo" id="MathJax-Span-1488" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-1489" style="font-family: MathJax_Main; padding-left: 0.269em;">1</span><span class="mo" id="MathJax-Span-1490" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1491" style="font-family: MathJax_Main; padding-left: 0.163em;">.</span><span class="mo" id="MathJax-Span-1492" style="font-family: MathJax_Main; padding-left: 0.163em;">.</span><span class="mo" id="MathJax-Span-1493" style="font-family: MathJax_Main; padding-left: 0.163em;">.</span><span class="mo" id="MathJax-Span-1494" style="font-family: MathJax_Main; padding-left: 0.163em;">,</span><span class="mi" id="MathJax-Span-1495" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span><span style="position: absolute; clip: rect(0.856em 1000em 4.056em -0.477em); top: -1.064em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1498"><span class="mrow" id="MathJax-Span-1499"><span class="mtext" id="MathJax-Span-1500"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">平</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">方</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">误</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">差</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">函</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">数</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">，</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">直</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">接</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">求</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">导</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">：</span></span><span class="mn" id="MathJax-Span-1501" style="font-family: MathJax_Main;">2</span><span class="munderover" id="MathJax-Span-1502" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(2.669em 1000em 4.376em -0.424em); top: -3.784em; left: 0.003em;"><span class="mo" id="MathJax-Span-1503" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.789em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.776em -0.477em); top: -1.437em; left: 0.109em;"><span class="texatom" id="MathJax-Span-1504"><span class="mrow" id="MathJax-Span-1505"><span class="mi" id="MathJax-Span-1506" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1507" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1508" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span><span style="position: absolute; clip: rect(1.709em 1000em 2.616em -0.477em); top: -3.624em; left: 0.429em;"><span class="mi" id="MathJax-Span-1509" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1510" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 1.336em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1511" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1512"><span class="mrow" id="MathJax-Span-1513"><span class="mi" id="MathJax-Span-1514" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1515" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1516" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1517"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1518" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1519" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1520" style="font-family: MathJax_Main; padding-left: 0.216em;">−</span><span class="msubsup" id="MathJax-Span-1521" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1522" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1524" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1525" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-1526" style="font-family: MathJax_Main; padding-left: 0.269em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span><span style="position: absolute; clip: rect(0.856em 1000em 4.056em -0.477em); top: 2.136em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1529"><span class="mrow" id="MathJax-Span-1530"><span class="msubsup" id="MathJax-Span-1531"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1532" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1533" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1534" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mo" id="MathJax-Span-1535" style="font-family: MathJax_Main; padding-left: 0.269em;">(</span><span class="munderover" id="MathJax-Span-1536"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(2.669em 1000em 4.376em -0.424em); top: -3.784em; left: 0.003em;"><span class="mo" id="MathJax-Span-1537" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.789em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.776em -0.477em); top: -1.437em; left: 0.109em;"><span class="texatom" id="MathJax-Span-1538"><span class="mrow" id="MathJax-Span-1539"><span class="mi" id="MathJax-Span-1540" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1541" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1542" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span><span style="position: absolute; clip: rect(1.709em 1000em 2.616em -0.477em); top: -3.624em; left: 0.429em;"><span class="mi" id="MathJax-Span-1543" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1544" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 1.336em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1545" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1546"><span class="mrow" id="MathJax-Span-1547"><span class="mi" id="MathJax-Span-1548" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1549" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1550"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1551" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1552" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1553" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1554"><span class="mrow" id="MathJax-Span-1555"><span class="mo" id="MathJax-Span-1556" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-1557" style="font-family: MathJax_Main;">(</span><span class="munderover" id="MathJax-Span-1558"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(2.669em 1000em 4.376em -0.424em); top: -3.784em; left: 0.003em;"><span class="mo" id="MathJax-Span-1559" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.789em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.776em -0.477em); top: -1.437em; left: 0.109em;"><span class="texatom" id="MathJax-Span-1560"><span class="mrow" id="MathJax-Span-1561"><span class="mi" id="MathJax-Span-1562" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1563" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1564" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span><span style="position: absolute; clip: rect(1.709em 1000em 2.616em -0.477em); top: -3.624em; left: 0.429em;"><span class="mi" id="MathJax-Span-1565" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1566" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 1.336em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1567" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1568"><span class="mrow" id="MathJax-Span-1569"><span class="mi" id="MathJax-Span-1570" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1571" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1572" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1573" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1574" style="padding-left: 0.163em;"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">即</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">率</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">属</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">于</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">第</span><span style="font-family: MathJax_Main;">k</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">个</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">聚</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">类</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">的</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">数</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">据</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">均</span><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 80%; font-style: normal; font-weight: normal;">值</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span></span><span style="display: inline-block; width: 0px; height: 13.656em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 15.937em; vertical-align: -7.663em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-74">\begin{equation}
    \begin{split}
        &\mathbb{P} = \sum_{k=1}^K \sum_{n=1}^N r_{nk} \parallel x_n - u_k\parallel^2\\
        &\min \sum_{n=1}^N r_{nk} \parallel x_n - u_k\parallel^2, k = 1,...,K\\
        &\text{平方误差函数，直接求导：} 2\sum_{n=1}^N r_{nk} ( x_n - u_k) = 0\\
        &u_k = (\sum_{n=1}^N r_{nk}x_n) / (\sum_{n=1}^N r_{nk}),\text{即率属于第k个聚类的数据均值}\\
    \end{split}
\end{equation}</script> 
<br> 　　从EM角度来看：把指示矩阵 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-75-Frame"> 
  
  <span class="math" id="MathJax-Span-1575" style="width: 3.043em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1576"><span class="msubsup" id="MathJax-Span-1577"><span style="display: inline-block; position: relative; width: 2.349em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1578" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1579"><span class="mrow" id="MathJax-Span-1580"><span class="mi" id="MathJax-Span-1581" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1582" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1583" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-75">r_{N \times K}</script>当做隐变量，聚类中心 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-76-Frame"> 
  
  <span class="math" id="MathJax-Span-1584" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.563em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.496em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1585"><span class="msubsup" id="MathJax-Span-1586"><span style="display: inline-block; position: relative; width: 2.509em; height: 0px;"><span style="position: absolute; clip: rect(1.709em 1000em 2.776em -0.477em); top: -2.557em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1587"><span class="mrow" id="MathJax-Span-1588"><span class="mi" id="MathJax-Span-1589" style="font-family: MathJax_Caligraphic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.643em;"><span class="texatom" id="MathJax-Span-1590"><span class="mrow" id="MathJax-Span-1591"><span class="mi" id="MathJax-Span-1592" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1593" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1594" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-76">\mathcal{U}_{K\times D}</script>当做模型参数，更新 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-77-Frame"> 
  
  <span class="math" id="MathJax-Span-1595" style="width: 3.043em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1596"><span class="msubsup" id="MathJax-Span-1597"><span style="display: inline-block; position: relative; width: 2.349em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1598" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1599"><span class="mrow" id="MathJax-Span-1600"><span class="mi" id="MathJax-Span-1601" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1602" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1603" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-77">r_{N \times K}</script> 和 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-78-Frame"> 
  
  <span class="math" id="MathJax-Span-1604" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.563em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.496em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1605"><span class="msubsup" id="MathJax-Span-1606"><span style="display: inline-block; position: relative; width: 2.509em; height: 0px;"><span style="position: absolute; clip: rect(1.709em 1000em 2.776em -0.477em); top: -2.557em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1607"><span class="mrow" id="MathJax-Span-1608"><span class="mi" id="MathJax-Span-1609" style="font-family: MathJax_Caligraphic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.643em;"><span class="texatom" id="MathJax-Span-1610"><span class="mrow" id="MathJax-Span-1611"><span class="mi" id="MathJax-Span-1612" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1613" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1614" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-78">\mathcal{U}_{K\times D}</script>就分别对应于EM算法的E步和M步。 
<p></p> 
<h3 id="三判停标准"><strong>三、判停标准</strong>：</h3> 
<p>kmeans算法的迭代优化过程一直持续直到满足某个判停标准，如果在这一轮迭代中：</p> 
<p>1、训练样本所属类别不再发生改变或者只有很少几个训练样本改变； <br> 2、目标函数变化很小或者聚类中心向量变化很小； <br> 3、达到最大迭代次数。</p> 
<p>满足其中一个条件，即可停止训练。如果满足条件1或2，说明算法已经收敛。</p> 
<h3 id="四k值的选取"><strong>四、K值的选取</strong>：</h3> 
<p>　　随着聚类数K的增大，目标函数呈减小趋势。但是另一方面K值的增大会导致存储空间和计算量的增加。那么如何选择合适的K值呢？ <br> 1.经验法：根据问题的性质和先验知识，人为指定聚类的数目。 <br> 2.爬山法：但当聚类数目到达一定值以后，聚类数目的增加目标函数的变化很小，这个拐点可以认为是最优聚类数目。</p> 
<p></p> 
<center> 
 <img src="https://images2.imgbox.com/fb/db/KCXLeq9N_o.png" alt="这里写图片描述" title=""> 
</center> 
<p></p> 
<h3 id="五matlab计算数据与聚类中心之间的距离"><strong>五、matlab计算数据与聚类中心之间的距离</strong></h3> 
<p>　　matlab诞生的初衷就是为了矩阵运算的方便，所以如果用for循环来计算数据与聚类中心的距离从而得到指示矩阵<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-83-Frame"> 
   
   <span class="math" id="MathJax-Span-1875" style="width: 3.043em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1876"><span class="msubsup" id="MathJax-Span-1877"><span style="display: inline-block; position: relative; width: 2.349em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1878" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.344em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1879"><span class="mrow" id="MathJax-Span-1880"><span class="mi" id="MathJax-Span-1881" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-1882" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-1883" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-83">r_{N \times K}</script>这种速度极慢的方法是不可取的。对欧氏距离函数做个小小的变换： <br> <span class="MathJax_Preview"></span></p> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-84-Frame"> 
   
   <span class="math" id="MathJax-Span-1884" style="width: 35.416em; display: inline-block;"><span style="display: inline-block; position: relative; width: 28.323em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(-0.157em 1000em 4.376em -0.317em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1885"><span class="mtable" id="MathJax-Span-1886" style="padding-right: 0.163em; padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 27.949em; height: 0px;"><span style="position: absolute; clip: rect(2.403em 1000em 5.709em -0.477em); top: -3.997em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.003em; height: 0px;"><span style="position: absolute; clip: rect(3.843em 1000em 4.163em -0.477em); top: -5.437em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1887"><span class="mrow" id="MathJax-Span-1888"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.843em 1000em 4.163em -0.477em); top: -4.051em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1944"><span class="mrow" id="MathJax-Span-1945"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.843em 1000em 4.163em -0.477em); top: -2.451em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1976"><span class="mrow" id="MathJax-Span-1977"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(2.723em 1000em 7.256em -0.211em); top: -5.224em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 27.949em; height: 0px;"><span style="position: absolute; clip: rect(1.603em 1000em 3.149em -0.104em); top: -4.157em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1889"><span class="mrow" id="MathJax-Span-1890"><span class="mo" id="MathJax-Span-1891" style="font-family: MathJax_Main; padding-left: 0.216em; padding-right: 0.323em;">∥</span><span class="msubsup" id="MathJax-Span-1892"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1893" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1894" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1895" style="font-family: MathJax_Main; padding-left: 0.216em;">−</span><span class="msubsup" id="MathJax-Span-1896" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1897" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1898" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1899" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 0.963em; height: 0px;"><span style="position: absolute; clip: rect(1.816em 1000em 3.149em -0.371em); top: -2.717em; left: 0.003em;"><span class="mo" id="MathJax-Span-1900" style="font-family: MathJax_Main;">∥</span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span><span style="position: absolute; top: -2.984em; left: 0.536em;"><span class="mn" id="MathJax-Span-1901" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span><span class="mo" id="MathJax-Span-1902" style="font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-1903" style="font-family: MathJax_Main; padding-left: 0.269em;">(</span><span class="msubsup" id="MathJax-Span-1904"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1905" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1906" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1907" style="font-family: MathJax_Main; padding-left: 0.216em;">−</span><span class="msubsup" id="MathJax-Span-1908" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1909" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1910" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1911" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1912" style="font-family: MathJax_Main; padding-left: 0.216em;">⋅</span><span class="mo" id="MathJax-Span-1913" style="font-family: MathJax_Main; padding-left: 0.216em;">(</span><span class="msubsup" id="MathJax-Span-1914"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1915" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1916" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1917" style="font-family: MathJax_Main; padding-left: 0.216em;">−</span><span class="msubsup" id="MathJax-Span-1918" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1919" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1920" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1921"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.816em 1000em 3.149em -0.424em); top: -2.717em; left: 0.003em;"><span class="mo" id="MathJax-Span-1922" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span><span style="position: absolute; top: -2.984em; left: 0.429em;"><span class="mi" id="MathJax-Span-1923" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span><span class="mo" id="MathJax-Span-1924" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1925" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">n</span><span class="mo" id="MathJax-Span-1926" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-1927" style="font-family: MathJax_Main; padding-left: 0.269em;">1</span><span class="mo" id="MathJax-Span-1928" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1929" style="font-family: MathJax_Main; padding-left: 0.163em;">.</span><span class="mo" id="MathJax-Span-1930" style="font-family: MathJax_Main; padding-left: 0.163em;">.</span><span class="mo" id="MathJax-Span-1931" style="font-family: MathJax_Main; padding-left: 0.163em;">.</span><span class="mo" id="MathJax-Span-1932" style="font-family: MathJax_Main; padding-left: 0.163em;">,</span><span class="mi" id="MathJax-Span-1933" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1934" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1935" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">k</span><span class="mo" id="MathJax-Span-1936" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-1937" style="font-family: MathJax_Main; padding-left: 0.269em;">1</span><span class="mo" id="MathJax-Span-1938" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1939" style="font-family: MathJax_Main; padding-left: 0.163em;">.</span><span class="mo" id="MathJax-Span-1940" style="font-family: MathJax_Main; padding-left: 0.163em;">.</span><span class="mo" id="MathJax-Span-1941" style="font-family: MathJax_Main; padding-left: 0.163em;">.</span><span class="mo" id="MathJax-Span-1942" style="font-family: MathJax_Main; padding-left: 0.163em;">,</span><span class="mi" id="MathJax-Span-1943" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span><span style="position: absolute; clip: rect(1.763em 1000em 3.203em -0.211em); top: -2.771em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1946"><span class="mrow" id="MathJax-Span-1947"><span class="mo" id="MathJax-Span-1948" style="font-family: MathJax_Main; padding-left: 0.216em; padding-right: 0.323em;">=</span><span class="msubsup" id="MathJax-Span-1949"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1950" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1951" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1952" style="font-family: MathJax_Main; padding-left: 0.216em;">⋅</span><span class="msubsup" id="MathJax-Span-1953" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.229em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1954" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.669em -0.424em); top: -2.824em; left: 0.589em;"><span class="mi" id="MathJax-Span-1955" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span><span style="position: absolute; clip: rect(1.976em 1000em 2.616em -0.477em); top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1956" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1957" style="font-family: MathJax_Main; padding-left: 0.216em;">+</span><span class="msubsup" id="MathJax-Span-1958" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1959" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1960" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1961" style="font-family: MathJax_Main; padding-left: 0.216em;">⋅</span><span class="msubsup" id="MathJax-Span-1962" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.229em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1963" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.669em -0.424em); top: -2.824em; left: 0.589em;"><span class="mi" id="MathJax-Span-1964" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span><span style="position: absolute; clip: rect(1.816em 1000em 2.616em -0.424em); top: -2.131em; left: 0.589em;"><span class="mi" id="MathJax-Span-1965" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1966" style="font-family: MathJax_Main; padding-left: 0.216em;">−</span><span class="mn" id="MathJax-Span-1967" style="font-family: MathJax_Main; padding-left: 0.216em;">2</span><span class="msubsup" id="MathJax-Span-1968"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1969" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1970" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-1971" style="font-family: MathJax_Main; padding-left: 0.216em;">⋅</span><span class="msubsup" id="MathJax-Span-1972" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.229em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1973" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.669em -0.424em); top: -2.824em; left: 0.589em;"><span class="mi" id="MathJax-Span-1974" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span><span style="position: absolute; clip: rect(1.816em 1000em 2.616em -0.424em); top: -2.131em; left: 0.589em;"><span class="mi" id="MathJax-Span-1975" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span><span style="position: absolute; clip: rect(1.603em 1000em 3.203em -0.211em); top: -1.171em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1978"><span class="mrow" id="MathJax-Span-1979"><span class="mo" id="MathJax-Span-1980" style="font-family: MathJax_Main; padding-left: 0.216em; padding-right: 0.323em;">=<span style="font-family: MathJax_Main;">∥</span></span><span class="msubsup" id="MathJax-Span-1981"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1982" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1983" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1984" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 0.963em; height: 0px;"><span style="position: absolute; clip: rect(1.816em 1000em 3.149em -0.371em); top: -2.717em; left: 0.003em;"><span class="mo" id="MathJax-Span-1985" style="font-family: MathJax_Main;">∥</span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span><span style="position: absolute; top: -2.984em; left: 0.536em;"><span class="mn" id="MathJax-Span-1986" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span><span class="mo" id="MathJax-Span-1987" style="font-family: MathJax_Main; padding-left: 0.269em;">+</span><span class="mo" id="MathJax-Span-1988" style="font-family: MathJax_Main; padding-left: 0.269em;">∥</span><span class="msubsup" id="MathJax-Span-1989" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1990" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1991" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1992" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 0.963em; height: 0px;"><span style="position: absolute; clip: rect(1.816em 1000em 3.149em -0.371em); top: -2.717em; left: 0.003em;"><span class="mo" id="MathJax-Span-1993" style="font-family: MathJax_Main;">∥</span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span><span style="position: absolute; top: -2.984em; left: 0.536em;"><span class="mn" id="MathJax-Span-1994" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span></span></span><span class="mo" id="MathJax-Span-1995" style="font-family: MathJax_Main; padding-left: 0.269em;">−</span><span class="mn" id="MathJax-Span-1996" style="font-family: MathJax_Main;">2</span><span class="msubsup" id="MathJax-Span-1997"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-1998" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="mi" id="MathJax-Span-1999" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-2000" style="font-family: MathJax_Main; padding-left: 0.216em;">⋅</span><span class="msubsup" id="MathJax-Span-2001" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.229em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-2002" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.669em -0.424em); top: -2.824em; left: 0.589em;"><span class="mi" id="MathJax-Span-2003" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 2.509em;"></span></span><span style="position: absolute; clip: rect(1.816em 1000em 2.616em -0.424em); top: -2.131em; left: 0.589em;"><span class="mi" id="MathJax-Span-2004" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.723em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.229em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.403em; vertical-align: -2.397em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-84">\begin{equation}
    \begin{split}
        &\parallel x_n - u_k\parallel^2 = (x_n - u_k)\cdot (x_n - u_k)^\top, n=1,...,N, k = 1,...,K\\
        &=x_n \cdot x_n^\top + u_k \cdot u_k^\top - 2x_n \cdot u_k^\top\\
        &=\parallel x_n \parallel^2 + \parallel u_k \parallel^2 - 2x_n \cdot u_k^\top\\
    \end{split}
\end{equation}</script> 
<p></p> 
<p>matlab代码（借鉴一下大牛的代码）：</p> 
<pre><code>function n2 = sp_dist2(x, c)
% DIST2 Calculates squared distance between two sets of points.
% Adapted from Netlab neural network software:
% http://www.ncrg.aston.ac.uk/netlab/index.php
%
%   Description
%   D = DIST2(X, C) takes two matrices of vectors and calculates the
%   squared Euclidean distance between them.  Both matrices must be of
%   the same column dimension.  If X has M rows and N columns, and C has
%   L rows and N columns, then the result has M rows and L columns.  The
%   I, Jth entry is the  squared distance from the Ith row of X to the
%   Jth row of C.
%
%
%   Copyright (c) Ian T Nabney (1996-2001)

[ndata, dimx] = size(x);
[ncentres, dimc] = size(c);
if dimx ~= dimc
    error('Data dimension does not match dimension of centres')
end

n2 = (ones(ncentres, 1) * sum((x.^2)', 1))' + ...
  ones(ndata, 1) * sum((c.^2)',1) - ...
  2.*(x*(c'));

% Rounding errors occasionally cause negative entries in n2
if any(any(n2&lt;0))
  n2(n2&lt;0) = 0;
end
</code></pre> 
<h3 id="六matlab实现kmeans"><strong>六、matlab实现kmeans</strong></h3> 
<h4 id="kmeans聚类算法实现"><strong>kmeans聚类算法实现</strong>：</h4> 
<p>　　 <br> 使用上述代码部分来完成kmeans聚类算法（sp_dist2函数）：</p> 
<pre><code>function [centres, options, post, errlog] = sp_kmeans(centres, data, options)
% KMEANS    Trains a k means cluster model.
% Adapted from Netlab neural network software:
% http://www.ncrg.aston.ac.uk/netlab/index.php
%
%   Description
%    CENTRES = KMEANS(CENTRES, DATA, OPTIONS) uses the batch K-means
%   algorithm to set the centres of a cluster model. The matrix DATA
%   represents the data which is being clustered, with each row
%   corresponding to a vector. The sum of squares error function is used.
%   The point at which a local minimum is achieved is returned as
%   CENTRES.  The error value at that point is returned in OPTIONS(8).
%
%   [CENTRES, OPTIONS, POST, ERRLOG] = KMEANS(CENTRES, DATA, OPTIONS)
%   also returns the cluster number (in a one-of-N encoding) for each
%   data point in POST and a log of the error values after each cycle in
%   ERRLOG.    The optional parameters have the following
%   interpretations.
%
%   OPTIONS(1) is set to 1 to display error values; also logs error
%   values in the return argument ERRLOG. If OPTIONS(1) is set to 0, then
%   only warning messages are displayed.  If OPTIONS(1) is -1, then
%   nothing is displayed.
%
%   OPTIONS(2) is a measure of the absolute precision required for the
%   value of CENTRES at the solution.  If the absolute difference between
%   the values of CENTRES between two successive steps is less than
%   OPTIONS(2), then this condition is satisfied.
%
%   OPTIONS(3) is a measure of the precision required of the error
%   function at the solution.  If the absolute difference between the
%   error functions between two successive steps is less than OPTIONS(3),
%   then this condition is satisfied. Both this and the previous
%   condition must be satisfied for termination.
%
%   OPTIONS(14) is the maximum number of iterations; default 100.
%
%   Copyright (c) Ian T Nabney (1996-2001)

[ndata, data_dim] = size(data);
[ncentres, dim] = size(centres);

if dim ~= data_dim
  error('Data dimension does not match dimension of centres')
end

if (ncentres &gt; ndata)
  error('More centres than data')
end

% Sort out the options
if (options(14))
  niters = options(14);
else
  niters = 100;
end

store = 0;
if (nargout &gt; 3)
  store = 1;
  errlog = zeros(1, niters);
end

% Check if centres and posteriors need to be initialised from data
if (options(5) == 1)
  % Do the initialisation
  perm = randperm(ndata);
  perm = perm(1:ncentres);

  % Assign first ncentres (permuted) data points as centres
  centres = data(perm, :);
end
% Matrix to make unit vectors easy to construct
id = eye(ncentres);

% Main loop of algorithm
for n = 1:niters

  % Save old centres to check for termination
  old_centres = centres;

  % Calculate posteriors based on existing centres
  d2 = sp_dist2(data, centres);
  % Assign each point to nearest centre
  [minvals, index] = min(d2', [], 1);
  post = id(index,:);

  num_points = sum(post, 1);
  % Adjust the centres based on new posteriors
  for j = 1:ncentres
    if (num_points(j) &gt; 0)
      centres(j,:) = sum(data(find(post(:,j)),:), 1)/num_points(j);
    end
  end

  % Error value is total squared distance from cluster centres
  e = sum(minvals);
  if store
    errlog(n) = e;
  end
  if options(1) &gt; 0
    fprintf(1, 'Cycle %4d  Error %11.6f\n', n, e);
  end

  if n &gt; 1
    % Test for termination
    if max(max(abs(centres - old_centres))) &lt; options(2) &amp; ...
        abs(old_e - e) &lt; options(3)
      options(8) = e;
      return;
    end
  end
  old_e = e;
end

% If we get here, then we haven't terminated in the given number of 
% iterations.
options(8) = e;
if (options(1) &gt;= 0)
  disp('Warning: Maximum number of iterations has been exceeded');
end
</code></pre> 
<h4 id="用法示例"><strong>用法示例</strong>：</h4> 
<pre><code>options = zeros(1,14);
options(1) = 1; % display
options(2) = 1;
options(3) = 0.1; % precision
options(5) = 1; % initialization
options(14) = 100; % maximum iterations
data = random('Normal',0,1,10000,1000);
centres = zeros(100, 1000);
[centres, options, post, errlog] = sp_kmeans(centres, data, options);
Cycle    1  Error 17938493.427068
Cycle    2  Error 9830031.343386
Cycle    3  Error 9820962.377269
Cycle    4  Error 9817432.475919
Cycle    5  Error 9815699.935060
Cycle    6  Error 9814457.480926
Cycle    7  Error 9813788.116749
Cycle    8  Error 9813344.693653
Cycle    9  Error 9812973.717258
Cycle   10  Error 9812774.174316
Cycle   11  Error 9812574.730180
Cycle   12  Error 9812428.284545
Cycle   13  Error 9812320.224245
Cycle   14  Error 9812214.447799
Cycle   15  Error 9812136.019543
Cycle   16  Error 9812084.447704
Cycle   17  Error 9812069.131204
Cycle   18  Error 9812069.131204
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a36069b72c42ed3b1d64f0b493a7136d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VBScript，提取字符串中的一部分</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/74aadb543c337deab3d6b3f12d52c1f6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">用Struts2框架将jsp的form表单数据提交到action处理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>