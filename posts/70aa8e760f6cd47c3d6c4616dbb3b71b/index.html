<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C复习-查缺补漏-更新中 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C复习-查缺补漏-更新中" />
<meta property="og:description" content="Q ：
编写一条scanf语句，读取两个整数，保存至quantity和price，再读取一个字符串，保存至字符数组department中
scanf(&#34;%d %d %s&#34;, &amp;quantity, &amp;price, department); Q ：
while( gets( input ) != NULL ) {}这句代码可能出现什么问题？
如果输入行很长，input数组会溢出。使用fgets并提供数组长度是更好的选择。
Q ：
编写程序，从标准输入读取再打印到标准输出中，并在每行前面加上行号。需要保证输入行的长度没有限制。
因为不限制行长度，所以使用getchar，另外判断行尾。
int main() { int ch; int line = 0; // 行号 int at_beginning = 1; // 表示是否在开头 while ((ch = getchar()) != EOF) { // 先打印行号 if (at_beginning == 1) { printf(&#34;%d &#34;, line); line &#43;= 1; at_beginning = 0; } // 打印字符 putchar(ch); if (ch == &#39;\n&#39;) at_beginning = 1; } return 0; } Q ：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/70aa8e760f6cd47c3d6c4616dbb3b71b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-25T15:57:51+08:00" />
<meta property="article:modified_time" content="2023-12-25T15:57:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C复习-查缺补漏-更新中</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>Q</strong> ：<br> 编写一条scanf语句，读取两个整数，保存至quantity和price，再读取一个字符串，保存至字符数组department中</p> 
<pre><code class="prism language-c"><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %s"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>quantity<span class="token punctuation">,</span> <span class="token operator">&amp;</span>price<span class="token punctuation">,</span> department<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>Q</strong> ：<br> while( gets( input ) != NULL ) {}这句代码可能出现什么问题？<br> 如果输入行很长，input数组会溢出。使用fgets并提供数组长度是更好的选择。</p> 
<p><strong>Q</strong> ：<br> 编写程序，从标准输入读取再打印到标准输出中，并在每行前面加上行号。需要保证输入行的长度没有限制。</p> 
<p>因为不限制行长度，所以使用getchar，另外判断行尾。</p> 
<pre><code class="prism language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> ch<span class="token punctuation">;</span>
	<span class="token keyword">int</span> line <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 行号</span>
	<span class="token keyword">int</span> at_beginning <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 表示是否在开头</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">EOF</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 先打印行号</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>at_beginning <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">;</span>
			line <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
			at_beginning <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 打印字符</span>
		<span class="token function">putchar</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token char">'\n'</span><span class="token punctuation">)</span>
			at_beginning <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>Q</strong> ：<br> 假如一个程序需要运行在两台机器上，两台的缺省int长度分别是16和32位，长整型缺省是32和64位。程序使用的某些变量值足够存到int中，某些需要long，为了减少移植时的修改，应该怎么写？</p> 
<p>创建一个int_size.h的文件(编写的时候指定位数)，然后使用#define指令</p> 
<p>32位机器的可以这样写</p> 
<pre><code class="prism language-c"><span class="token keyword">typedef</span> <span class="token keyword">signed</span> <span class="token keyword">char</span> int8<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">short</span> <span class="token keyword">int</span> int16<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">int</span> int32<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">int</span> defint8<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">int</span> defint16<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">int</span> defint32<span class="token punctuation">;</span>
</code></pre> 
<p>16位机器可以这样写</p> 
<pre><code class="prism language-c"><span class="token keyword">typedef</span> <span class="token keyword">signed</span> <span class="token keyword">char</span> int8<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">short</span> <span class="token keyword">int</span> int16<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">int</span> int32<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">int</span> defint8<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">int</span> defint16<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">int</span> defint32<span class="token punctuation">;</span>
</code></pre> 
<p><strong>Q</strong> ：<br> 如果按%s输出一个enum变量，会打印出什么？</p> 
<p>编译器可能会报错，输出未知。应该使用%d输出。</p> 
<p><strong>Q</strong> ：<br> 假定一个函数包含了一个自动变量，这个函数在同一行被调用了两次，那么函数第二次调用开始时该自动变量的值和第一次调用即将结束时的值是相同的吗？</p> 
<p>可能不相同，也可能相同。在某些架构的机器中，一个硬件中断将把机器的状态信息压到堆栈伤，它们将破坏这些变量。</p> 
<blockquote> 
 <p>自动变量auto，只有定义时才创建，当定义它们的函数返回时，系统回收变量所占的存储空间。一般情况下，不作专门说明的局部变量都是自动变量（也可以用auto说明）。举例：块语句中的变量、函数的形参</p> 
</blockquote> 
<p><strong>Q</strong> ：</p> 
<pre><code class="prism language-jsx">int func() {
	static int counter = 1;
	return ++counter;
}

int answer = func() - func() * func();
</code></pre> 
<p>问answer的值是多少？</p> 
<p>-和*的计算顺序没问题，但是func()的调用顺序是由编译器决定的，所以answer的值是不一定的。可能是-10 , -5, -2</p> 
<p><strong>Q</strong> ：<br> 下面的表达式有何不同？</p> 
<pre><code class="prism language-c"><span class="token function">memchr</span><span class="token punctuation">(</span> buffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> SIZE <span class="token punctuation">)</span> <span class="token operator">-</span> buffer
<span class="token function">strlen</span><span class="token punctuation">(</span> buffer <span class="token punctuation">)</span>
</code></pre> 
<p>主要是第一句。这句也是计算字符串长度的，但是结果的类型是ptrdiff_t，但strlen的结果是size_t。而且如果buffer的数据不是以NUL结尾的话，memchr会返回一个NULL指针，那么减buffer是一个无意义的值；但strlen会在buffer后继续查找，直到找到一个NUL字节</p> 
<p><strong>Q</strong> ：<br> 有些C编译器提供了一个称为alloca的函数，它与malloc的区别在于它再堆栈上分配内存。这种类型的分配有什么优点和缺点？</p> 
<p>优点：当分配内存的函数返回时，这块内存会自动释放，这是由堆栈的工作方式决定的，可以保证不会出现内存泄漏。缺点：由于函数返回时，被分配的内存将消失，所以它不能用于存储那些需要回传给调用程序的数据。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8a74406e350a6864112dba7a4b7733b8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">怎样查询oracle被锁的表</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cdf7fc5b2972827415ad64de48ea7d82/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【摄影基础】镜头分类</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>