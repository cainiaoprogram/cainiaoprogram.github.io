<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>springboot集成es 插入和查询的简单使用 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="springboot集成es 插入和查询的简单使用" />
<meta property="og:description" content="第一步：引入依赖 &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;/artifactId&gt; &lt;version&gt;2.2.5.RELEASE&lt;/version&gt; &lt;/dependency&gt; 第二步：配置yml文件，在spring下面加上这个 elasticsearch: rest: # ip是服务器ip地址 uris: http://127.0.0.1:9200 然后启动项目，看到出现这个就是成功了
第三步： 创建一个常量类，用于存储我们一会儿要用到的名称 public class OrderEs { public static final String INDEX_NAME = &#34;order_index&#34;; public static final String ID = &#34;id&#34;; public static final String ORDER_NO = &#34;order_no&#34;; public static final String ORDER_BUYER = &#34;order_buyer&#34;; public static final String ORDER_PHONE = &#34;order_phone&#34;; public static final String REAL_PAY = &#34;real_pay&#34;; public static final String ACCOUNT = &#34;account&#34;; } 第四步：创建Es实体类，注意要加上@Document注解 @Document(indexName = OrderEs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/d54ea7d9293fd98d6eb2fdd97d4a5dc6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-29T13:34:14+08:00" />
<meta property="article:modified_time" content="2023-08-29T13:34:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">springboot集成es 插入和查询的简单使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>第一步：引入依赖</h4> 
<pre><code class="language-java">        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;/artifactId&gt;
            &lt;version&gt;2.2.5.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre> 
<h4>第二步：配置yml文件，在spring下面加上这个</h4> 
<pre><code class="language-java">  elasticsearch:
    rest:
      # ip是服务器ip地址
      uris: http://127.0.0.1:9200
</code></pre> 
<p>然后启动项目，看到出现这个就是成功了</p> 
<p><img alt="" height="314" src="https://images2.imgbox.com/14/09/43r1OLRs_o.png" width="1118"></p> 
<h4>第三步： 创建一个常量类，用于存储我们一会儿要用到的名称</h4> 
<pre><code class="language-java">public class OrderEs {
    public static final String INDEX_NAME = "order_index";

    public static final String ID = "id";

    public static final String ORDER_NO = "order_no";

    public static final String ORDER_BUYER = "order_buyer";

    public static final String ORDER_PHONE = "order_phone";

    public static final String REAL_PAY = "real_pay";

    public static final String ACCOUNT = "account";
}</code></pre> 
<h4>第四步：创建Es实体类，注意要加上@Document注解</h4> 
<pre><code class="language-java">@Document(indexName = OrderEs.INDEX_NAME)
@Data
public class OrderEsPO {

    @Id
    @Field(type = FieldType.Keyword,name = OrderEs.ID)
    private String id;

    @Field(type = FieldType.Keyword,name = OrderEs.ORDER_NO)
    private String orderNo;

    @Field(type = FieldType.Keyword,name = OrderEs.ORDER_BUYER)
    private String orderBuyer;

    @Field(type = FieldType.Keyword,name = OrderEs.ORDER_PHONE)
    private String orderPhone;

    @Field(type = FieldType.Keyword,name = OrderEs.REAL_PAY)
    private String realPay;

    @Field(type = FieldType.Keyword,name = OrderEs.ACCOUNT)
    private String account;

}</code></pre> 
<h4>第五步：写测试接口，这里展示了插入和查询两个方法</h4> 
<pre><code class="language-java">@RestController
@RequestMapping("/order")
@CrossOrigin
public class OrderController 

    @Resource
    private ElasticsearchRestTemplate elasticsearchRestTemplate;

    /**
     * es插入
     *
     * @return {@link String}
     */

    @GetMapping("/esinsert")
    @Transactional
    public String esInsert(){
        OrderEsPO orderEsPO = new OrderEsPO();
        orderEsPO.setOrderNo("1234455");
        orderEsPO.setOrderBuyer("张三");
        orderEsPO.setOrderPhone("13191892075");
        orderEsPO.setRealPay("100000");
        orderEsPO.setAccount("1008611");
        elasticsearchRestTemplate.save(orderEsPO);
        return "success";
    }

    /**
     * es搜索
     *
     * @param orderEsPO 订单es参数
     * @return {@link String}
     */
    @GetMapping("/essearch")
    @Transactional
    public String esSearch(OrderEsPO orderEsPO){
        /**构造查询对象**/
        BoolQueryBuilder booleanQueryBuilder = QueryBuilders.boolQuery();
        /**编写查询条件**/
        booleanQueryBuilder.should(QueryBuilders.termQuery(OrderEs.ORDER_NO,orderEsPO.getOrderNo()));
        /**构造query对象**/
        NativeSearchQuery nativeSearchQuery = new NativeSearchQuery(booleanQueryBuilder);
        /**搜索**/
        SearchHits&lt;OrderEsPO&gt; search = elasticsearchRestTemplate.search(nativeSearchQuery, OrderEsPO.class, IndexCoordinates.of(OrderEs.INDEX_NAME));
        List&lt;OrderEsPO&gt; collect = search.getSearchHits().stream().map(SearchHit::getContent).collect(Collectors.toList());
        return collect.toString();
    }
}</code></pre> 
<p>然后我们启动项目，先调用插入接口，由于这个索引一开始是不存在的，第一次调用后会默认创建索引，然后打开我们的可视化界面，就能看到这里的索引</p> 
<p><img alt="" height="166" src="https://images2.imgbox.com/b4/f6/5J5Ye5e6_o.png" width="646"></p> 
<p> 再调用查询，就能看到如下信息了</p> 
<p><img alt="" height="88" src="https://images2.imgbox.com/51/41/CJPjUKwo_o.png" width="1200"></p> 
<p> 说明两个接口都能被调用成功，es的简单使用就完成了</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ddbfe7f61b41684941f1f116103f2964/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Chrome浏览器的跨域设置----包含新老版本两种设置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2af7e500f11e49a07ce140ef4a8c85e2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java中抽象类</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>