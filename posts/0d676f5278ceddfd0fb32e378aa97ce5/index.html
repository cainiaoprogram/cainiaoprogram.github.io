<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql2安装与使用 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql2安装与使用" />
<meta property="og:description" content="nodejs中mysql2模块 安装 npm i mysql2 -S 使用 const mysql2 = require(&#34;mysql2&#34;); 配置和数据库之间的连接 const connection = mysql2.createConnection({ host: &#39;localhost&#39;, //主机 user: &#34;root&#34;, //用户名 password: &#34;102327&#34;, //自己设置的密码 database: &#34;js05&#34;, //表名 charset: &#34;utf8&#34; }); app.use(static(__dirname &#43; &#34;/static&#34;)); // app.use(views(__dirname &#43; &#34;/views&#34;)); router.get(&#34;/&#34;, async ctx =&gt; { let mydata; let sql = &#34;SELECT age,hobby FROM user WHERE id&lt;=2&#34;;//引用数据库中的数据操作 curd操作 // connection.query(sql, (err, result) =&gt; { // if (err) { // console.log(err); // } // console." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0d676f5278ceddfd0fb32e378aa97ce5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-29T19:26:40+08:00" />
<meta property="article:modified_time" content="2021-03-29T19:26:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql2安装与使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="nodejsmysql2_0"></a>nodejs中mysql2模块</h4> 
<h5><a id="_1"></a>安装</h5> 
<pre><code class="prism language-javascript">npm i mysql2 <span class="token operator">-</span><span class="token constant">S</span>
</code></pre> 
<h4><a id="_6"></a>使用</h4> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> mysql2 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"mysql2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
配置和数据库之间的连接
<span class="token keyword">const</span> connection <span class="token operator">=</span> mysql2<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    host<span class="token punctuation">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>  <span class="token comment">//主机</span>
    user<span class="token punctuation">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token comment">//用户名</span>
    password<span class="token punctuation">:</span> <span class="token string">"102327"</span><span class="token punctuation">,</span> <span class="token comment">//自己设置的密码</span>
    database<span class="token punctuation">:</span> <span class="token string">"js05"</span><span class="token punctuation">,</span> <span class="token comment">//表名</span>
    charset<span class="token punctuation">:</span> <span class="token string">"utf8"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">static</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">"/static"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// app.use(views(__dirname + "/views"));</span>
router<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token keyword">async</span> ctx <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> mydata<span class="token punctuation">;</span>
    
    <span class="token keyword">let</span> sql <span class="token operator">=</span> <span class="token string">"SELECT age,hobby FROM user WHERE id&lt;=2"</span><span class="token punctuation">;</span><span class="token comment">//引用数据库中的数据操作 curd操作</span>
    
    <span class="token comment">// connection.query(sql, (err, result) =&gt; {<!-- --></span>
    <span class="token comment">//     if (err) {<!-- --></span>
    <span class="token comment">//         console.log(err);</span>
    <span class="token comment">//     }</span>
    <span class="token comment">//     console.log(result);</span>
    <span class="token comment">//     mydata = result;</span>
    <span class="token comment">// })</span>
    <span class="token comment">// console.log(mydata);</span>

    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//解构赋值   块级作用域</span>
        <span class="token keyword">let</span> <span class="token punctuation">[</span>rows<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> connection<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mydata <span class="token operator">=</span> rows<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">err</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//数组</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> mydata<span class="token punctuation">;</span> <span class="token comment">//页面显示</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mydata<span class="token punctuation">)</span><span class="token comment">//数组[ TextRow { age: 20, hobby: '篮球' }, TextRow { age: 15, hobby: '学医' } ]</span>
    
        <span class="token comment">// ctx.body = "hello"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8844</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="vsc_50"></a>vsc与图形化结合</h4> 
<ul><li>冒泡排序 快速排序 折半查找</li></ul> 
<pre><code class="prism language-javascript">添加内容  图形化
    年龄小于<span class="token number">20</span> 且姓王的数据
    <span class="token keyword">let</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM user WHERE age&lt;20 AND username LIKE '佳佳'"</span><span class="token punctuation">;</span>

    年龄的按序排列的数据   <span class="token constant">ORDER</span>  <span class="token constant">BY</span>  条件 <span class="token constant">ASC</span><span class="token function">正序</span><span class="token punctuation">(</span>省略<span class="token punctuation">)</span>  <span class="token constant">DESC</span>倒叙
    <span class="token keyword">let</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM user WHERE age &gt;15 ORDER BY age ASC"</span><span class="token punctuation">;</span> <span class="token comment">//正序</span>

    限制查询  <span class="token constant">LIMIT</span>   <span class="token comment">//分页</span>
    <span class="token keyword">let</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM user LIMIT 2,2"</span>

    别名 ： <span class="token constant">AS</span>
    连表查询    附表  <span class="token constant">LEFT</span> <span class="token constant">JOIN</span>  主表
                <span class="token constant">ON</span><span class="token punctuation">:</span>  表之间的数据连接
</code></pre> 
<pre><code class="prism language-javascript">别名 ： <span class="token constant">AS</span>
    <span class="token keyword">let</span> sql <span class="token operator">=</span> <span class="token string">"SELECT u.username,u.age FROM user AS u "</span>


    连表查询    附表  <span class="token constant">LEFT</span> <span class="token constant">JOIN</span>  主表
                <span class="token constant">ON</span><span class="token punctuation">:</span>  表之间的数据连接
    <span class="token keyword">let</span> sql <span class="token operator">=</span> <span class="token string">"SELECT u.username,p.pname FROM  products AS p LEFT JOIN user AS u ON p.uid=u.id "</span>
</code></pre> 
<h4><a id="jsonnode_77"></a>将json数据用node添加到图形化</h4> 
<pre><code class="prism language-javascript"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">inserData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> newsData<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> title <span class="token operator">=</span> newsData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">;</span>
        <span class="token keyword">let</span> content <span class="token operator">=</span> newsData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>content<span class="token punctuation">;</span>
        <span class="token keyword">let</span> addTime <span class="token operator">=</span> newsData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>addTime<span class="token punctuation">;</span>
        <span class="token keyword">let</span> country <span class="token operator">=</span> newsData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>type<span class="token punctuation">;</span>
        <span class="token keyword">let</span> type <span class="token operator">=</span> newsData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>type<span class="token punctuation">;</span>
        <span class="token keyword">let</span> imgUrl <span class="token operator">=</span> newsData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>imgUrl<span class="token punctuation">;</span>

        <span class="token keyword">let</span> sql <span class="token operator">=</span> <span class="token string">"INSERT INTO news (title,content,addTime,country,type,imgUrl) VALUES (?,?,?,?,?,?)"</span><span class="token punctuation">;</span>
        <span class="token keyword">await</span> connection<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">[</span>title<span class="token punctuation">,</span> content<span class="token punctuation">,</span> addTime<span class="token punctuation">,</span> country<span class="token punctuation">,</span> type<span class="token punctuation">,</span> imgUrl<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a4/68/a5E4R17X_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_95"></a>配置和数据库之间的连接</h5> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> connection <span class="token operator">=</span> mysql2<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    host<span class="token punctuation">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
    user<span class="token punctuation">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token comment">//名</span>
    password<span class="token punctuation">:</span> <span class="token string">"102327"</span><span class="token punctuation">,</span> <span class="token comment">//自己设置的密码</span>
    database<span class="token punctuation">:</span> <span class="token string">"js05"</span><span class="token punctuation">,</span> <span class="token comment">//表名</span>
    charset<span class="token punctuation">:</span> <span class="token string">"utf8"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_106"></a>新闻列表数据展示</h4> 
<ul><li>安装需求</li></ul> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> KOa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"koa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"koa-router"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">static</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"koa-static"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Views <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"koa-views"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> mysql2 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"mysql2"</span><span class="token punctuation">)</span>
</code></pre> 
<p>再加一个 npm i pug</p> 
<pre><code class="prism language-javascript">    <span class="token comment">//配置和数据库之间的连接</span>
<span class="token keyword">const</span> connection <span class="token operator">=</span> mysql2<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    host<span class="token punctuation">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
    user<span class="token punctuation">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token comment">//名</span>
    password<span class="token punctuation">:</span> <span class="token string">"102327"</span><span class="token punctuation">,</span> <span class="token comment">//自己设置的密码</span>
    database<span class="token punctuation">:</span> <span class="token string">"js05"</span><span class="token punctuation">,</span> <span class="token comment">//表名</span>
    charset<span class="token punctuation">:</span> <span class="token string">"utf8"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">static</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">"/static"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">Views</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">"/views"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
    extension<span class="token punctuation">:</span> <span class="token string">"pug"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> ctx <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// ctx.body = "hello";</span>
    ctx<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">,</span> <span class="token keyword">async</span> ctx <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> perPage <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>p<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token comment">// let newData = JSON.parse(JSON.stringify(data)).splice((p - 1) * perPage, p);</span>
    <span class="token comment">//获取对饮的数据</span>
    <span class="token keyword">let</span> <span class="token punctuation">[</span>data<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> connection<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"SELECT * FROM news"</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> <span class="token punctuation">[</span>newData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> connection<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"SELECT * FROM news LIMIT ?,?"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> perPage<span class="token punctuation">,</span> perPage<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">//限制查询  LIMIT</span>
    <span class="token keyword">let</span> totalPage <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>length <span class="token operator">/</span> perPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        newData<span class="token punctuation">,</span>
        totalPage<span class="token punctuation">,</span>
        data<span class="token punctuation">,</span>
        p
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0b5cc4eaa92e7e4e114feb8da66893e9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">springcloud上传文件提示wMissingServletRequestPartException: Required request part ‘advert‘ is not present]</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/035e06bedbb27ddad4b5dde472f41f33/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Robotics Toolbox工具箱使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>