<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>妙用CSS变量，让你的CSS变得更心动 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="妙用CSS变量，让你的CSS变得更心动" />
<meta property="og:description" content="作者：JowayYoung
仓库：Github、CodePen
博客：掘金、思否、知乎、简书、头条、CSDN
公众号：IQ前端
联系我：关注公众号后有我的微信哟
特别声明：原创不易，未经授权不得对此文章进行转载或抄袭，否则按侵权处理，如需转载或开通公众号白名单可联系我，希望各位尊重原创的知识产权
前言 CSS变量又叫CSS自定义属性，为什么会突然提起这个很少人用到的东西呢？因为最近在重构个人官网，不知道为什么突然喜欢用上CSS变量，可能其自身隐藏的魅力，让笔者对它刮目相看。
谈到为什么会在CSS中使用变量，下面举个栗子，估计大家一看就会明白。
/* 不使用CSS变量 */ .title { background-color: red; } .desc { background-color: red; } /* 使用CSS变量 */ :root { --bg-color: red; } .title { background-color: var(--bg-color); } .desc { background-color: var(--bg-color); } 看完可能会觉得使用CSS变量的代码量多了一点，但是有没有想到突然某天万恶的策划小哥哥和设计小姐姐说要做一个换肤功能。按照平常的思路，估计有些同学就会按照默认颜色主题增加一份对照的新颜色主题CSS文件。这样每次新增需求都同时维护几套主题颜色多麻烦啊。
此时CSS变量就派上用场了，提前跟设计小姐姐规范好各种需要变换的颜色并通过CSS变量进行定义，通过JS批量操作这些定义好的CSS变量即可。这也是变换主题颜色的一种解决方案之一，好处在于只需写一套CSS代码。
[&#34;red&#34;, &#34;blue&#34;, &#34;green&#34;].forEach(v =&gt; { const btn = document.getElementById(`${v}-theme-btn`); btn.addEventListener(&#34;click&#34;, () =&gt; document.body.style.setProperty(&#34;--bg-color&#34;, v)); }); 在此总结下CSS使用变量的好处：
减少样式代码的重复性增加样式代码的扩展性提高样式代码的灵活性增多一种CSS与JS的通讯方式不用深层遍历DOM改变某个样式 可能有些同学会问，Sass和Less早就实现了变量这个特性，何必再多此一举呢。可是细想一下，CSS变量对比Sass和Less的变量，又有它的过人之处。
浏览器原生特性，无需经过任何转译就可直接运行DOM对象一员，极大便利了CSS与JS之间的联系 认识 本来打算用一半篇幅讲述CSS变量的规范和用法，但是网上一搜一大把就感觉没必要了，贴上阮一峰老师写的教程《CSS变量教程》。同时笔者也对CSS变量的细节地方进行一个整理，方便大家记忆。
声明：--变量名读取：var(--变量名, 默认值)类型 普通：只能用作属性值不能用作属性名字符：与字符串拼接 &#34;Hello, &#34;var(--name)数值：使用calc()与数值单位连用 var(--width) * 10px 作用域 范围：在当前元素块作用域及其子元素块作用域下有效优先级别：内联样式 &gt; ID选择器 &gt; 类选择器 = 属性选择器 = 伪类选择器 &gt; 标签选择器 = 伪元素选择器 接下来使用几个特别的场景展示CSS变量的魅力。还是那句话，一样东西有使用的场景，那自然就会有它的价值，那么用的人也会越来越多。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/79dcf361dec554da57becd2e1e25c1a9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-11T11:03:31+08:00" />
<meta property="article:modified_time" content="2020-03-11T11:03:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">妙用CSS变量，让你的CSS变得更心动</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>作者：<a rel="nofollow">JowayYoung</a><br> 仓库：<a href="https://github.com/JowayYoung">Github</a>、<a href="https://codepen.io/JowayYoung" rel="nofollow">CodePen</a><br> 博客：<a href="https://juejin.im/user/584ec3a661ff4b006cd6383e/posts" rel="nofollow">掘金</a>、<a href="https://segmentfault.com/blog/jowayyoung" rel="nofollow">思否</a>、<a href="https://zhuanlan.zhihu.com/c_1169597485852360704" rel="nofollow">知乎</a>、<a href="https://jianshu.com/c/1cfedb18ef77" rel="nofollow">简书</a>、<a href="https://toutiao.com/c/user/100806618527015/#mid=1652682740784139" rel="nofollow">头条</a>、<a href="https://me.csdn.net/JowayYoung" rel="nofollow">CSDN</a><br> 公众号：<a href="https://yangzw.vip/static/frontend/account/IQ%E5%89%8D%E7%AB%AF%E5%85%AC%E4%BC%97%E5%8F%B7.jpg" rel="nofollow">IQ前端</a><br> 联系我：关注公众号后有我的<strong>微信</strong>哟<br> 特别声明：原创不易，未经授权不得对此文章进行转载或抄袭，否则按侵权处理，如需转载或开通公众号白名单可联系我，希望各位尊重原创的知识产权</p> 
</blockquote> 
<h4><a id="_7"></a>前言</h4> 
<p><strong>CSS变量</strong>又叫<strong>CSS自定义属性</strong>，为什么会突然提起这个很少人用到的东西呢？因为最近在重构个人官网，不知道为什么突然喜欢用上<strong>CSS变量</strong>，可能其自身隐藏的魅力，让笔者对它刮目相看。</p> 
<p>谈到为什么会在CSS中使用变量，下面举个栗子，估计大家一看就会明白。</p> 
<pre><code class="prism language-css"><span class="token comment">/* 不使用CSS变量 */</span>
<span class="token selector">.title</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.desc</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 使用CSS变量 */</span>
<span class="token selector">:root</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">--bg-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.title</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--bg-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.desc</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--bg-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>看完可能会觉得使用<strong>CSS变量</strong>的代码量多了一点，但是有没有想到突然某天万恶的策划小哥哥和设计小姐姐说要做一个换肤功能。按照平常的思路，估计有些同学就会按照<code>默认颜色主题</code>增加一份对照的<code>新颜色主题</code>CSS文件。这样每次新增需求都同时维护几套主题颜色多麻烦啊。</p> 
<p>此时<strong>CSS变量</strong>就派上用场了，提前跟设计小姐姐规范好各种需要变换的颜色并通过<strong>CSS变量</strong>进行定义，通过JS批量操作这些定义好的<strong>CSS变量</strong>即可。这也是<strong>变换主题颜色</strong>的一种解决方案之一，好处在于只需写一套CSS代码。</p> 
<pre><code class="prism language-js"><span class="token punctuation">[</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>v<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-theme-btn`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--bg-color"</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在此总结下CSS使用变量的好处：</p> 
<ul><li>减少样式代码的重复性</li><li>增加样式代码的扩展性</li><li>提高样式代码的灵活性</li><li>增多一种CSS与JS的通讯方式</li><li>不用深层遍历DOM改变某个样式</li></ul> 
<p>可能有些同学会问，Sass和Less早就实现了变量这个特性，何必再多此一举呢。可是细想一下，<strong>CSS变量</strong>对比Sass和Less的变量，又有它的过人之处。</p> 
<ul><li>浏览器原生特性，无需经过任何转译就可直接运行</li><li>DOM对象一员，极大便利了CSS与JS之间的联系</li></ul> 
<h4><a id="_58"></a>认识</h4> 
<p>本来打算用一半篇幅讲述<strong>CSS变量</strong>的规范和用法，但是网上一搜一大把就感觉没必要了，贴上阮一峰老师写的教程<a href="http://www.ruanyifeng.com/blog/2017/05/css-variables.html" rel="nofollow">《CSS变量教程》</a>。同时笔者也对<strong>CSS变量</strong>的细节地方进行一个整理，方便大家记忆。</p> 
<ul><li>声明：<code>--变量名</code></li><li>读取：<code>var(--变量名, 默认值)</code></li><li>类型 
  <ul><li>普通：只能用作<code>属性值</code>不能用作<code>属性名</code></li><li>字符：与字符串拼接 <code>"Hello, "var(--name)</code></li><li>数值：使用<code>calc()</code>与数值单位连用 <code>var(--width) * 10px</code></li></ul> </li><li>作用域 
  <ul><li>范围：在<code>当前元素块作用域</code>及其<code>子元素块作用域</code>下有效</li><li>优先级别：<code>内联样式 &gt; ID选择器 &gt; 类选择器 = 属性选择器 = 伪类选择器 &gt; 标签选择器 = 伪元素选择器</code></li></ul> </li></ul> 
<p>接下来使用几个特别的场景展示<strong>CSS变量</strong>的魅力。还是那句话，<strong>一样东西有使用的场景，那自然就会有它的价值</strong>，那么用的人也会越来越多。</p> 
<h4><a id="_74"></a>使用场景</h4> 
<p>其实<strong>CSS变量</strong>有一个特别好用的场景，那就是结合List元素集合使用。如果不明白这是什么，请继续往下看。</p> 
<pre><code class="prism language-!">以下所有演示代码基于Vue文件，但HTML、CSS和JS分开书写，为了简化CSS的书写而使用Sass进行预处理，方便代码演示
</code></pre> 
<h6><a id="_82"></a>条形加载条</h6> 
<p>一个条形加载条通常由几条线条组成，并且每条线条对应一个存在不同时延的相同动画，通过时间差运行相同的动画，从而产生加载效果。估计大部分的同学可能会把CSS代码写成以下这样。</p> 
<p><img src="https://images2.imgbox.com/81/05/lcJGKohp_o.gif" alt="strip-loading"></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>strip-loading flex-ct-x<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v in 6<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<pre><code class="prism language-scss">.loading {
    width: 200px;
    height: 200px;
    li {
        border-radius: 3px;
        width: 6px;
        height: 30px;
        background-color: #f66;
        animation: beat 1s ease-in-out infinite;
        &amp; + li {
            margin-left: 5px;
        }
        &amp;:nth-child(2) {
            animation-delay: 200ms;
        }
        &amp;:nth-child(3) {
            animation-delay: 400ms;
        }
        &amp;:nth-child(4) {
            animation-delay: 600ms;
        }
        &amp;:nth-child(5) {
            animation-delay: 800ms;
        }
        &amp;:nth-child(6) {
            animation-delay: 1s;
        }
    }
}
</code></pre> 
<p>分析代码发现，每个<code>&lt;li&gt;</code>只是存在<code>animation-delay</code>不同，而其余代码则完全相同，换成其他类似的List元素集合场景，那岂不是有10个<code>&lt;li&gt;</code>就写10个<code>:nth-child</code>。</p> 
<p>显然这种方法不灵活也不容易封装成组件，如果能像JS那样封装成一个函数，并根据参数输出不同的样式效果，那就更棒了。说到这里，很明显就是为了铺垫<strong>CSS变量</strong>的开发技巧了。</p> 
<p>对于HTML部分的修改，让每个<code>&lt;li&gt;</code>拥有一个自己作用域下的<strong>CSS变量</strong>。对于CSS部分的修改，就需要分析哪些属性是随着<code>index</code>递增而发生规律变化的，对规律变化的部分使用<strong>CSS变量</strong>表达式代替即可。</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>strip-loading flex-ct-x<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v in 6<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v<span class="token punctuation">"</span></span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token selector">`--line-index: $</span><span class="token punctuation">{<!-- --></span>v<span class="token punctuation">}</span>`</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<pre><code class="prism language-scss">.strip-loading {
    width: 200px;
    height: 200px;
    li {
        --time: calc((var(--line-index) - 1) * 200ms);
        border-radius: 3px;
        width: 6px;
        height: 30px;
        background-color: #f66;
        animation: beat 1.5s ease-in-out var(--time) infinite;
        &amp; + li {
            margin-left: 5px;
        }
    }
}
</code></pre> 
<pre><code class="prism language-!">源码链接可在文章结尾处获取
</code></pre> 
<p>代码中的变量<code>--line-index</code>和<code>--time</code>使每个<code>&lt;li&gt;</code>拥有一个属于自己的作用域。例如第2个<code>&lt;li&gt;</code>，<code>--line-index</code>的值为2，<code>--time</code>的计算值为<code>200ms</code>，换成第3个<code>&lt;li&gt;</code>后这两个值又会不同了。</p> 
<p>这就是<strong>CSS变量</strong>的作用范围所致(<code>在当前元素块作用域及其子元素块作用域下有效</code>)，因此在<code>.strip-loading</code>的块作用域下调用<code>--line-index</code>是无效的。</p> 
<pre><code class="prism language-scss">/* flex属性无效 */
.loading {
    display: flex;
    align-items: center;
    flex: var(--line-index);
}
</code></pre> 
<p>通过妙用<strong>CSS变量</strong>，也把CSS代码从<code>29行</code>缩减到<code>15行</code>，对于那些含有List元素集合越多的场景，效果就更明显。而且这样写也更加美观更加容易维护，某天说加载效果的时间差不明显，直接将<code>calc((var(--line-index) - 1) * 200ms)</code>里的<code>200ms</code>调整成<code>400ms</code>即可。就无需对每个<code>:nth-child(n)</code>进行修改了。</p> 
<h6><a id="_175"></a>心形加载条</h6> 
<p>前段时间刷掘金看到<code>陈大鱼头兄</code>的心形加载条，觉得挺漂亮的，很带感觉。</p> 
<p><img src="https://images2.imgbox.com/93/35/02WcLb0l_o.gif" alt="h-loading"></p> 
<p>通过动图分析，发现每条线条的背景色和动画时延不一致，另外动画运行时的高度也不一致。细心的你可能还会发现，第1条和第9条的高度一致，第2条和第8条的高度一致，依次类推，得到<code>高度变换相同类</code>的公式：<code>对称index = 总数 + 1 - index</code>。</p> 
<p>背景色使用了滤镜的色相旋转<code>hue-rotate</code>函数，目的是为了使颜色过渡得更加自然；动画时延的设置和上面<code>条形加载条</code>的设置一致。下面就用<strong>CSS变量</strong>根据看到的动图实现一番。</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>heart-loading flex-ct-x<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">--line-count</span><span class="token punctuation">:</span> 9</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v in 9<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v<span class="token punctuation">"</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>`line-${v}`<span class="token punctuation">"</span></span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token selector">`--line-index: $</span><span class="token punctuation">{<!-- --></span>v<span class="token punctuation">}</span>`</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<pre><code class="prism language-scss">.heart-loading {
    width: 200px;
    height: 200px;
    ul {
        display: flex;
        justify-content: space-between;
        width: 150px;
        height: 10px;
    }
    li {
        --Θ: calc(var(--line-index) / var(--line-count) * .5turn);
        --time: calc((var(--line-index) - 1) * 40ms);
        border-radius: 5px;
        width: 10px;
        height: 10px;
        background-color: #3c9;
        filter: hue-rotate(var(--Θ));
        animation-duration: 1s;
        animation-delay: var(--time);
        animation-iteration-count: infinite;
    }
    .line-1,
    .line-9 {
        animation-name: line-move-1;
    }
    .line-2,
    .line-8 {
        animation-name: line-move-2;
    }
    .line-3,
    .line-7 {
        animation-name: line-move-3;
    }
    .line-4,
    .line-6 {
        animation-name: line-move-4;
    }
    .line-5 {
        animation-name: line-move-5;
    }
}
</code></pre> 
<pre><code class="prism language-!">源码链接可在文章结尾处获取
</code></pre> 
<p>一波操作后就有了下面的效果。和<code>陈大鱼头兄</code>的心形加载条对比一下，颜色、波动曲线和跳动频率有点不一样，在暖色调的蔓延和肾上腺素的飙升下，这是一种心动的感觉。想起自己曾经写的一首诗：<code>我见犹怜，爱不释手，雅俗共赏，君子好逑</code>。</p> 
<p><img src="https://images2.imgbox.com/01/c9/wHL2u23j_o.gif" alt="heart-loading"></p> 
<h6><a id="_245"></a>标签导航栏</h6> 
<p>上面通过两个加载条演示了<strong>CSS变量</strong>在CSS中的运用以及一些妙用技巧，现在通过标签导航栏演示<strong>CSS变量</strong>在JS中的运用。</p> 
<p>JS中主要有3个操作<strong>CSS变量</strong>的API，看上去简单易记，分别如下：</p> 
<ul><li>读取变量：<code>elem.style.getPropertyValue()</code></li><li>设置变量：<code>elem.style.setProperty()</code></li><li>删除变量：<code>elem.style.removeProperty()</code></li></ul> 
<p>先上效果图，效果中主要是使用<strong>CSS变量</strong>标记每个Tab的背景色和切换Tab的显示状态。</p> 
<p><img src="https://images2.imgbox.com/57/88/awcx8YVM_o.gif" alt="tab-navbar"></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tab-navbar<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(v, i) in list<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v<span class="token punctuation">"</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{ active: index === i }<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>select(i)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>标题{<!-- -->{i + 1}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tabs<span class="token punctuation">"</span></span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token selector">`--tab-count: $</span><span class="token punctuation">{<!-- --></span>list.length<span class="token punctuation">}</span>`</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(v, i) in list<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v<span class="token punctuation">"</span></span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token selector">`--bg-color: $</span><span class="token punctuation">{<!-- --></span>v<span class="token punctuation">}</span>`</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>内容{<!-- -->{i + 1}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<pre><code class="prism language-scss">.tab-navbar {
    display: flex;
    overflow: hidden;
    flex-direction: column-reverse;
    border-radius: 10px;
    width: 300px;
    height: 400px;
    nav {
        display: flex;
        height: 40px;
        background-color: #f0f0f0;
        line-height: 40px;
        text-align: center;
        a {
            flex: 1;
            cursor: pointer;
            transition: all 300ms;
            &amp;.active {
                background-color: #66f;
                font-weight: bold;
                color: #fff;
            }
        }
    }
    div {
        flex: 1;
        ul {
            --tab-index: 0;
            --tab-width: calc(var(--tab-count) * 100%);
            --tab-move: calc(var(--tab-index) / var(--tab-count) * -100%);
            display: flex;
            flex-wrap: nowrap;
            width: var(--tab-width);
            height: 100%;
            transform: translate3d(var(--tab-move), 0, 0);
            transition: all 300ms;
        }
        li {
            display: flex;
            justify-content: center;
            align-items: center;
            flex: 1;
            background-color: var(--bg-color);
            font-weight: bold;
            font-size: 20px;
            color: #fff;
        }
    }
}
</code></pre> 
<pre><code class="prism language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
            index<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            list<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"#f66"</span><span class="token punctuation">,</span> <span class="token string">"#09f"</span><span class="token punctuation">,</span> <span class="token string">"#3c9"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">select</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">=</span> i<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>tabs<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--tab-index"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-!">源码链接可在文章结尾处获取
</code></pre> 
<p>在<code>&lt;ul&gt;</code>上定义<code>--tab-index</code>表示Tab当前的索引，当点击按钮时重置<code>--tab-index</code>的值，就可实现不操作DOM来移动<code>&lt;ul&gt;</code>的位置显示指定的Tab。不操作DOM而可移动<code>&lt;ul&gt;</code>是因为定义了<code>--tab-move</code>，通过<code>calc()</code>计算<code>--tab-index</code>与<code>--tab-move</code>的关系，从而操控<code>transform: translate3d()</code>来移动<code>&lt;ul&gt;</code>。</p> 
<p>另外在<code>&lt;li&gt;</code>上定义<code>--bg-color</code>表示Tab的背景色，也是一种比较简洁的模板赋值方式，总比写<code>&lt;li :style="backgroundColor: ${color}"&gt;</code>要好看。如果多个CSS属性依赖一个变量赋值，那么使用<strong>CSS变量</strong>赋值到style上就更方便了，那些CSS属性可在CSS文件里进行计算与赋值，这样可帮助JS分担一些属性计算工作。</p> 
<p>当然，这个标签导航栏也可通过纯CSS实现，有兴趣的同学可看看笔者之前一篇文章里的<a href="https://juejin.im/post/5d4d0ec651882549594e7293#heading-63" rel="nofollow">纯CSS标签导航栏</a>。</p> 
<h6><a id="_351"></a>悬浮跟踪按钮</h6> 
<p>通过几个栗子实践了<strong>CSS变量</strong>在CSS和JS上的运用，相信大家已经掌握了其用法和技巧。之前在某个网站看过一个比较酷炫的鼠标悬浮特效，好像也是使用<strong>CSS变量</strong>实现的。笔者凭着记忆也使用<strong>CSS变量</strong>实现一番。</p> 
<p>其实思路也比较简单，先对按钮进行布局和着色，然后使用伪元素标记鼠标的位置，定义<code>--x</code>和<code>--y</code>表示伪元素在按钮里的坐标，通过JS获取鼠标在按钮上的<code>offsetLeft</code>和<code>offsetLeft</code>分别赋值给<code>--x</code>和<code>--y</code>，再对伪元素添加径向渐变的背景色，大功告成，一个酷炫的鼠标悬浮跟踪特效就这样诞生了。</p> 
<p><img src="https://images2.imgbox.com/8c/8a/lhMcWlf8_o.gif" alt="track-btn"></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>track-btn pr tac<span class="token punctuation">"</span></span> <span class="token attr-name">@mousemove</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>move<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>妙用CSS变量，让你的CSS变得更心动<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<pre><code class="prism language-scss">.track-btn {
    display: block;
    overflow: hidden;
    border-radius: 100px;
    width: 400px;
    height: 50px;
    background-color: #66f;
    line-height: 50px;
    cursor: pointer;
    font-weight: bold;
    font-size: 18px;
    color: #fff;
    span {
        position: relative;
    }
    &amp;::before {
        --size: 0;
        position: absolute;
        left: var(--x);
        top: var(--y);
        width: var(--size);
        height: var(--size);
        background-image: radial-gradient(circle closest-side, #09f, transparent);
        content: "";
        transform: translate3d(-50%, -50%, 0);
        transition: all 200ms ease;
    }
    &amp;:hover::before {
        --size: 400px;
    }
}
</code></pre> 
<pre><code class="prism language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    name<span class="token punctuation">:</span> <span class="token string">"track-btn"</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">move</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">const</span> x <span class="token operator">=</span> e<span class="token punctuation">.</span>pageX <span class="token operator">-</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">;</span>
            <span class="token keyword">const</span> y <span class="token operator">=</span> e<span class="token punctuation">.</span>pageY <span class="token operator">-</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>offsetTop<span class="token punctuation">;</span>
            e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--x"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--y"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-!">源码链接可在文章结尾处获取
</code></pre> 
<p>其实可结合鼠标事件来完成更多的酷炫效果，例如<code>动画关联</code>、<code>事件响应</code>等操作。没有做不到，只有想不到，尽情发挥你的想象力啦。</p> 
<p>之前在CodePen上还看到一个挺不错的栗子，一个<a href="https://t.co/qE0woiNip8" rel="nofollow">悬浮视差按钮</a>，具体代码涉及到一些3D变换的知识。看完源码后，按照其思路自己也实现一番，顺便对代码稍加改良并封装成Vue组件，存放到本课件示例代码中。感觉录制的GIF有点别扭，显示效果不太好，有兴趣的同学可下载本课件示例代码，自己运行看看效果。</p> 
<p><img src="https://images2.imgbox.com/8f/a2/YLXUZr90_o.gif" alt="parallax-btn"></p> 
<h4><a id="_423"></a>兼容</h4> 
<p>对于现代浏览器来说，<strong>CSS变量</strong>的兼容性其实还是蛮好的，所以大家可放心使用。毕竟现在都是各大浏览器厂商快速迭代的时刻，产品对于用户体验来说是占了很大比重，因此在条件允许的情况下还是大胆尝新，不要被一些过去的所谓的规范所约束着。</p> 
<p><img src="https://images2.imgbox.com/ed/a0/XBgaaBhm_o.png" alt="caniuse-css-var"></p> 
<p>试问现在还有多少人愿意去维护IE6~IE9的兼容性，如果一个产品的用户体验受限于远古浏览器的压制(<code>可能政务Web应用和金融Web应用除外吧</code>)，相信这个产品也不会走得很远。</p> 
<p>我们在完成一个产品的过程中，不仅仅是为了完成工作任务，如果在保证进度的同时能花点心思点缀一下，可能会有意外的收获。<strong>用心写好每一段代码，才是享受写代码的真谛</strong>。</p> 
<h4><a id="_433"></a>总结</h4> 
<p>本文通过循序渐进的方式探讨了<strong>CSS变量</strong>的运用和技巧，对于一个这么好用的特性，当然是不能放过啦。其实多多思考，就能把<strong>CSS变量</strong>用在很多场景上。笔者把本文提到的示例统一组成一个Demo，也方便有兴趣的同学通过课件示例代码进行学习，思考一些可能在阅读本文时没有注意到的细节。</p> 
<ul><li>Demo示例：<code>条形加载条</code>、<code>心形加载条</code>、<code>标签导航栏</code>、<code>悬浮跟踪按钮</code>、<code>悬浮视差按钮</code></li><li>Demo地址：关注<code>IQ前端</code>，扫描<code>文章底部二维码</code>，后台回复<code>变量</code>，获取<strong>整套课件示例代码</strong></li><li>Demo运行：里面的<code>readme.html</code>有详细说明，记得看喔</li></ul> 
<p>写到最后，送给大家一个大大的彩蛋，一个暖心彩虹色调🌈搭配的爱心点赞按钮。如果你觉得本文写得棒棒哒，请给笔者一个赞喔，就像下面那样。当然，彩蛋源码也在课件示例代码里啦。想了解更多的CSS开发技巧，可移步到笔者19年写的一篇<code>9.2万阅读量</code>的爆款文章<a href="https://juejin.im/post/5d4d0ec651882549594e7293" rel="nofollow">《灵活运用CSS开发技巧(66个骚操作案例)》</a>，保证满足你的眼球。</p> 
<p><img src="https://images2.imgbox.com/bb/cc/Eq60IoyG_o.gif" alt="like-btn"></p> 
<h4><a id="_445"></a>结语</h4> 
<p><strong>❤️关注+点赞+收藏+评论+转发❤️</strong>，原创不易，鼓励笔者创作更好的文章</p> 
<p><strong>关注公众号<code>IQ前端</code>，一个专注于CSS/JS开发技巧的前端公众号，更多前端小干货等着你喔</strong></p> 
<ul><li>关注后回复<code>关键词</code>免费领取视频教程</li><li>关注后添加<code>我微信</code>拉你进技术交流群</li><li>欢迎关注<code>IQ前端</code>，更多<strong>CSS/JS开发技巧</strong>只在公众号推送</li></ul> 
<p><img src="https://images2.imgbox.com/30/c5/V83sD0KL_o.png" alt=""></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/de52d1a7b552050757da2276155ff46e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【C&#43;&#43;】VS Code提示“include 错误，请更新includepath”</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/20ff0f696b4eb8e388d46aed75f86487/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">51单片机重定向printf函数 打印数值不正确问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>