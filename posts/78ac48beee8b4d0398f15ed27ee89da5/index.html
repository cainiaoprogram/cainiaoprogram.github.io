<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>手把手教你实现printf函数（C语言方式） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="手把手教你实现printf函数（C语言方式）" />
<meta property="og:description" content="引言 在日常的嵌入式开发过程中，常常会用到格式化输出的功能。比如在LCD屏幕上，显示需要的字符，如果没有格式化输出，用起来将会是十分麻烦。本文运用变参函数的知识，提供一种实现printf的格式化输出的实现方法供大家参考。
实现思路 通过一个个读取需要打印的字符，如果遇到格式化输出的字符，则根据格式化规则，用变参函数的方式取读取到参数，然后将参数拆解输出出来。
参考工程 使用VS17编译的工程：代码打包下载
主要难点为变参函数，下面介绍变参函数。
变参函数学习 1. 定义 即：函数数目可变的函数。
变参函数原型 type VarArgFunc(type FixedArg1, type FixedArg2, …); 参数分两部分：固定参数&#43;数目可变参数。
固定参数：至少一个。
可变参数： 大于等于0个。使用“…”表示。
2. 变参函数举例 printf（及其家族），原型：
int printf(const char* format, ...); 实际调用形式：
printf(&#34;string&#34;); printf(&#34;%d&#34;, i); printf(&#34;%s&#34;, s); printf(&#34;number is %d, string is:%s&#34;, i, s); 3.实现原理 使用到的宏： 需要#include &lt;stdarg.h&gt;
C调用约定下可使用va_list系列变参宏实现变参函数，此处va意为variable-argument(可变参数)。
val_list: 原型：
type va_arg(va_list argptr, type); 是在C语言中解决变参问题的一组宏，用于获取不确定个数的参数。
va_start: 原型：
void va_start(va_list argptr,last_parm); 读取可变参数的过程其实就是在栈区中，使用指针,遍历栈区中的参数列表,从低地址到高地址一个一个地把参数内容读出来的过程。实现功能类似变参的初始化。
// vc 6.0定义 #define va_start(ap,v) ( ap = (va_list)&amp;v &#43; _INTSIZEOF(v) ) //ap 为val_list变量。v为最后一个固定参数地址 va_arg： 宏定义：type va_arg (va_list ap, type)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/78ac48beee8b4d0398f15ed27ee89da5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-10T14:06:15+08:00" />
<meta property="article:modified_time" content="2022-12-10T14:06:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">手把手教你实现printf函数（C语言方式）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>引言</h3> 
<p>在日常的嵌入式开发过程中，常常会用到格式化输出的功能。比如在LCD屏幕上，显示需要的字符，如果没有格式化输出，用起来将会是十分麻烦。本文运用变参函数的知识，提供一种实现printf的格式化输出的实现方法供大家参考。</p> 
<h3><a id="_3"></a>实现思路</h3> 
<p>通过一个个读取需要打印的字符，如果遇到格式化输出的字符，则根据格式化规则，用变参函数的方式取读取到参数，然后将参数拆解输出出来。</p> 
<h3><a id="_9"></a>参考工程</h3> 
<p>使用VS17编译的工程：<a href="https://download.csdn.net/download/qq_44078824/20027817?spm=1001.2014.3001.5501">代码打包下载</a></p> 
<p>主要难点为变参函数，下面介绍变参函数。</p> 
<h3><a id="_13"></a>变参函数学习</h3> 
<h4><a id="1__15"></a>1. 定义</h4> 
<p>即：函数数目可变的函数。</p> 
<ul><li>变参函数原型</li></ul> 
<pre><code class="prism language-c">type <span class="token function">VarArgFunc</span><span class="token punctuation">(</span>type FixedArg1<span class="token punctuation">,</span> type FixedArg2<span class="token punctuation">,</span> …<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>参数分两部分：固定参数+数目可变参数。</p> 
<p>固定参数：至少一个。<br> 可变参数： 大于等于0个。使用“…”表示。</p> 
<h4><a id="2__27"></a>2. 变参函数举例</h4> 
<p>printf（及其家族），原型：</p> 
<pre><code class="prism language-c"><span class="token keyword">int</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>实际调用形式：</p> 
<pre><code class="prism language-c"><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"string"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"number is %d, string is:%s"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="3_44"></a>3.实现原理</h4> 
<p><strong>使用到的宏：</strong> 需要#include &lt;stdarg.h&gt;</p> 
<p>C调用约定下可使用va_list系列变参宏实现变参函数，此处va意为variable-argument(可变参数)。</p> 
<h4><a id="val_list_48"></a>val_list:</h4> 
<p>原型：</p> 
<pre><code class="prism language-c">type <span class="token function">va_arg</span><span class="token punctuation">(</span>va_list argptr<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>是在C语言中解决变参问题的一组宏，用于获取不确定个数的参数。</p> 
<h4><a id="va_start_57"></a>va_start:</h4> 
<p>原型：</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">va_start</span><span class="token punctuation">(</span>va_list argptr<span class="token punctuation">,</span>last_parm<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>读取可变参数的过程其实就是在栈区中，使用指针,遍历栈区中的参数列表,从低地址到高地址一个一个地把参数内容读出来的过程。实现功能类似变参的初始化。</p> 
<pre><code class="prism language-c"><span class="token comment">// vc 6.0定义</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">va_start</span><span class="token expression"><span class="token punctuation">(</span>ap<span class="token punctuation">,</span>v<span class="token punctuation">)</span> <span class="token punctuation">(</span> ap <span class="token operator">=</span> <span class="token punctuation">(</span>va_list<span class="token punctuation">)</span><span class="token operator">&amp;</span>v <span class="token operator">+</span> <span class="token function">_INTSIZEOF</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">)</span> </span><span class="token comment">//ap 为val_list变量。v为最后一个固定参数地址</span></span>
</code></pre> 
<h4><a id="va_arg_68"></a>va_arg：</h4> 
<p>宏定义：type va_arg (va_list ap, type)<br> 该宏用于变参数函数调用过程中，type是当前参数类型，调用该宏后，ap指向变参数列表中的下一个参数，返回ap指向的参数值，是一个类型为type的表达式。</p> 
<h4><a id="va_end_72"></a>va_end:</h4> 
<p>原型：</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">va_end</span><span class="token punctuation">(</span>va_list argptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>指针va_list置为无效，结束变参的获取</p> 
<h3><a id="_79"></a>典型用法如下：</h3> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdarg.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">VarArgFunc</span><span class="token punctuation">(</span><span class="token keyword">int</span> dwFixedArg<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token comment">//以固定参数的地址为起点依次确定各变参的内存起始地址</span>

    va_list pArgs <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  <span class="token comment">//定义va_list类型的指针pArgs，用于存储参数地址</span>

    <span class="token function">va_start</span><span class="token punctuation">(</span>pArgs<span class="token punctuation">,</span> dwFixedArg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//初始化pArgs指针，使其指向第一个可变参数。该宏第二个参数是变参列表的前一个参数，即最后一个固定参数</span>

    <span class="token keyword">int</span> dwVarArg <span class="token operator">=</span> <span class="token function">va_arg</span><span class="token punctuation">(</span>pArgs<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//该宏返回变参列表中的当前变参值并使pArgs指向列表中的下个变参。该宏第二个参数是要返回的当前变参类型</span>

    <span class="token comment">//若函数有多个可变参数，则依次调用va_arg宏获取各个变参</span>

    <span class="token function">va_end</span><span class="token punctuation">(</span>pArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//将指针pArgs置为无效，结束变参的获取</span>

    <span class="token comment">/* Code Block using variable arguments */</span>

<span class="token punctuation">}</span>

<span class="token comment">//可在头文件中声明函数为extern int VarArgFunc(int dwFixedArg, ...);，调用时用VarArgFunc(FixedArg, VarArg);</span>
</code></pre> 
<h3><a id="_103"></a>代码实现</h3> 
<p>本工程包括main.c , myPrintf.c ,myPrintf.h , send.c , send.h这几个代码文件。</p> 
<p>头文件写了函数的声明，源文件写了函数的实现过程。</p> 
<p>1.send.c就是底层实现打一个字符的函数，演示暂时使用printf %c 来模拟。可以将这个打印字符的函数替换成自己需要的底层函数。</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"./../ins/send.h"</span></span>

<span class="token comment">// 底层打印字符函数</span>
<span class="token keyword">void</span> <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token keyword">char</span> chr<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 可以替换成自己的函数，比如LCD显示字符</span>
    <span class="token comment">// LCD_Show_Char(chr);   // 注意移动光标位置</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span> chr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre> 
<p>send.h文件</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_MYPRINTF_H_</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_MYPRINTF_H_</span></span>

<span class="token comment">// 底层打印字符函数</span>
<span class="token keyword">void</span> <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token keyword">char</span> chr<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

</code></pre> 
<p>2.myPrintf.c 文件简单写了一个计算n的m次幂函数，用于数据的拆分显示。其次则是Print函数。</p> 
<p>Print函数首先对一些参数进行了定义和对va_start进行初始化，然后循环变量字符串。在循环里面，嵌套swich来来进行格式化输出。第一层switch用于匹配一些转义字符%，\r，\t，\n等转义字符。当遇到%时，则进入第二层switch用于匹配格式化输出的规则。比如：当遇到%d时，则调用va_arg读出一个整型参数，然后对该参数进行拆分打印处理。</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdarg.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"./../ins/myPrintf.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"./../ins/send.h"</span></span>
<span class="token keyword">extern</span> <span class="token keyword">void</span> <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token keyword">char</span> chr<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 计算m^n</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> m<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> ret <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        ret <span class="token operator">*=</span> m<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 返回值为打印字符的个数</span>
<span class="token comment">// 支持%d，%o, %x，%s，%c，%f（只打印6位数字）</span>
<span class="token keyword">int</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> ret_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 返回打印字符的个数</span>
    <span class="token keyword">char</span><span class="token operator">*</span> pStr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>str<span class="token punctuation">;</span><span class="token comment">// 指向str</span>
    <span class="token keyword">int</span> ArgIntVal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">// 接收整型</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> ArgHexVal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 接十六进制</span>
    <span class="token keyword">char</span><span class="token operator">*</span> ArgStrVal <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  <span class="token comment">// 接收字符型</span>
    <span class="token keyword">double</span> ArgFloVal <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span> <span class="token comment">// 接受浮点型</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> val_seg <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">// 数据切分</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> val_temp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">// 临时保存数据</span>
    <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token comment">// 数据长度计数</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    
    va_list pArgs<span class="token punctuation">;</span> <span class="token comment">// 定义va_list类型指针，用于存储参数的地址</span>
    <span class="token function">va_start</span><span class="token punctuation">(</span>pArgs<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化pArgs</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>pStr <span class="token operator">!=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token operator">*</span>pStr<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">case</span> <span class="token char">' '</span><span class="token operator">:</span>
            <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token operator">*</span>pStr<span class="token punctuation">)</span><span class="token punctuation">;</span> ret_num<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token char">'\t'</span><span class="token operator">:</span>
            <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token operator">*</span>pStr<span class="token punctuation">)</span><span class="token punctuation">;</span> ret_num <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token char">'\r'</span><span class="token operator">:</span>
            <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token operator">*</span>pStr<span class="token punctuation">)</span><span class="token punctuation">;</span> ret_num<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token char">'\n'</span><span class="token operator">:</span>
            <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token operator">*</span>pStr<span class="token punctuation">)</span><span class="token punctuation">;</span> ret_num<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token char">'%'</span><span class="token operator">:</span>
            pStr<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token comment">// % 格式解析</span>
            <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token operator">*</span>pStr<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">case</span> <span class="token char">'%'</span><span class="token operator">:</span>
                <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token char">'%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// %%，输出%</span>
                ret_num<span class="token operator">++</span><span class="token punctuation">;</span>
                pStr<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token char">'c'</span><span class="token operator">:</span>
                ArgIntVal <span class="token operator">=</span> <span class="token function">va_arg</span><span class="token punctuation">(</span>pArgs<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// %c，输出char</span>
                <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>ArgIntVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
                ret_num<span class="token operator">++</span><span class="token punctuation">;</span>
                pStr<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token char">'d'</span><span class="token operator">:</span>
                <span class="token comment">// 接收整型</span>
                ArgIntVal <span class="token operator">=</span> <span class="token function">va_arg</span><span class="token punctuation">(</span>pArgs<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ArgIntVal <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">// 如果为负数打印，负号</span>
                <span class="token punctuation">{<!-- --></span>
                    ArgIntVal <span class="token operator">=</span> <span class="token operator">-</span>ArgIntVal<span class="token punctuation">;</span><span class="token comment">// 取相反数</span>

                    <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token char">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    ret_num<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                val_seg <span class="token operator">=</span> ArgIntVal<span class="token punctuation">;</span><span class="token comment">// 赋值给 val_seg处理数据</span>
                <span class="token comment">// 计算ArgIntVal长度</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ArgIntVal<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>val_seg<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        cnt<span class="token operator">++</span><span class="token punctuation">;</span>
                        val_seg <span class="token operator">/=</span> <span class="token number">10</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> cnt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">// 数字0的长度为1</span>

                ret_num <span class="token operator">+=</span> cnt<span class="token punctuation">;</span><span class="token comment">// 字符个数加上整数的长度</span>

                <span class="token comment">// 将整数转为单个字符打印</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>cnt<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    val_seg <span class="token operator">=</span> ArgIntVal <span class="token operator">/</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    ArgIntVal <span class="token operator">%=</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>val_seg <span class="token operator">+</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cnt<span class="token operator">--</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                pStr<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token char">'o'</span><span class="token operator">:</span>
                <span class="token comment">// 接收整型</span>
                ArgIntVal <span class="token operator">=</span> <span class="token function">va_arg</span><span class="token punctuation">(</span>pArgs<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ArgIntVal <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">// 如果为负数打印，负号</span>
                <span class="token punctuation">{<!-- --></span>
                    ArgIntVal <span class="token operator">=</span> <span class="token operator">-</span>ArgIntVal<span class="token punctuation">;</span><span class="token comment">// 取相反数</span>

                    <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token char">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    ret_num<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                val_seg <span class="token operator">=</span> ArgIntVal<span class="token punctuation">;</span><span class="token comment">// 赋值给 val_seg处理数据</span>
                <span class="token comment">// 计算ArgIntVal长度</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ArgIntVal<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>val_seg<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        cnt<span class="token operator">++</span><span class="token punctuation">;</span>
                        val_seg <span class="token operator">/=</span> <span class="token number">8</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> cnt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">// 数字0的长度为1</span>

                ret_num <span class="token operator">+=</span> cnt<span class="token punctuation">;</span><span class="token comment">// 字符个数加上整数的长度</span>

                <span class="token comment">// 将整数转为单个字符打印</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>cnt<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    val_seg <span class="token operator">=</span> ArgIntVal <span class="token operator">/</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    ArgIntVal <span class="token operator">%=</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>val_seg <span class="token operator">+</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cnt<span class="token operator">--</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                pStr<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token char">'x'</span><span class="token operator">:</span>
                <span class="token comment">// 接收16进制</span>
                ArgHexVal <span class="token operator">=</span> <span class="token function">va_arg</span><span class="token punctuation">(</span>pArgs<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                val_seg <span class="token operator">=</span> ArgHexVal<span class="token punctuation">;</span>
                <span class="token comment">// 计算ArgIntVal长度</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ArgHexVal<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>val_seg<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        cnt<span class="token operator">++</span><span class="token punctuation">;</span>
                        val_seg <span class="token operator">/=</span> <span class="token number">16</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> cnt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">// 数字0的长度为1</span>

                ret_num <span class="token operator">+=</span> cnt<span class="token punctuation">;</span><span class="token comment">// 字符个数加上整数的长度</span>
                <span class="token comment">// 将整数转为单个字符打印</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>cnt<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    val_seg <span class="token operator">=</span> ArgHexVal <span class="token operator">/</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    ArgHexVal <span class="token operator">%=</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>val_seg <span class="token operator">&lt;=</span> <span class="token number">9</span><span class="token punctuation">)</span>
                        <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>val_seg <span class="token operator">+</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{<!-- --></span>
						<span class="token comment">//my_send_char((char)val_seg - 10 + 'a'); //小写字母</span>
                        <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>val_seg <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token char">'A'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    cnt<span class="token operator">--</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                pStr<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token char">'b'</span><span class="token operator">:</span>
                <span class="token comment">// 接收整型</span>
                ArgIntVal <span class="token operator">=</span> <span class="token function">va_arg</span><span class="token punctuation">(</span>pArgs<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                val_seg <span class="token operator">=</span> ArgIntVal<span class="token punctuation">;</span>
                <span class="token comment">// 计算ArgIntVal长度</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ArgIntVal<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>val_seg<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        cnt<span class="token operator">++</span><span class="token punctuation">;</span>
                        val_seg <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> cnt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">// 数字0的长度为1</span>

                ret_num <span class="token operator">+=</span> cnt<span class="token punctuation">;</span><span class="token comment">// 字符个数加上整数的长度</span>
                <span class="token comment">// 将整数转为单个字符打印</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>cnt<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    val_seg <span class="token operator">=</span> ArgIntVal <span class="token operator">/</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    ArgIntVal <span class="token operator">%=</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>val_seg <span class="token operator">+</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cnt<span class="token operator">--</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                pStr<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token char">'s'</span><span class="token operator">:</span>
                <span class="token comment">// 接收字符</span>
                ArgStrVal <span class="token operator">=</span> <span class="token function">va_arg</span><span class="token punctuation">(</span>pArgs<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                ret_num <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">strlen</span><span class="token punctuation">(</span>ArgStrVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>ArgStrVal<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token operator">*</span>ArgStrVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    ArgStrVal<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                pStr<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>

            <span class="token keyword">case</span> <span class="token char">'f'</span><span class="token operator">:</span>
                <span class="token comment">// 接收浮点型 保留6为小数，不采取四舍五入</span>
                ArgFloVal <span class="token operator">=</span> <span class="token function">va_arg</span><span class="token punctuation">(</span>pArgs<span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                val_seg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span>ArgFloVal<span class="token punctuation">;</span><span class="token comment">// 取整数部分</span>
                val_temp <span class="token operator">=</span> val_seg<span class="token punctuation">;</span>      <span class="token comment">// 临时保存整数部分数据</span>
                ArgFloVal <span class="token operator">=</span> ArgFloVal <span class="token operator">-</span> val_seg<span class="token punctuation">;</span><span class="token comment">// 得出余下的小数部分</span>
                <span class="token comment">// 计算整数部分长度</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>val_seg<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>val_seg<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        cnt<span class="token operator">++</span><span class="token punctuation">;</span>
                        val_seg <span class="token operator">/=</span> <span class="token number">10</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> cnt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">// 数字0的长度为1</span>
                ret_num <span class="token operator">+=</span> cnt<span class="token punctuation">;</span><span class="token comment">// 字符个数加上整数的长度</span>
                <span class="token comment">// 将整数转为单个字符打印</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>cnt<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    val_seg <span class="token operator">=</span> val_temp <span class="token operator">/</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    val_temp <span class="token operator">%=</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>val_seg <span class="token operator">+</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cnt<span class="token operator">--</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// 打印小数点</span>
                <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token char">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                ret_num<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token comment">// 开始输出小数部分</span>
                ArgFloVal <span class="token operator">*=</span> <span class="token number">1000000</span><span class="token punctuation">;</span>
                <span class="token comment">// printf("\r\n %f\r\n", ArgFloVal);</span>
                cnt <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
                val_temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>ArgFloVal<span class="token punctuation">;</span><span class="token comment">// 取整数部分</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>cnt<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    val_seg <span class="token operator">=</span> val_temp <span class="token operator">/</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    val_temp <span class="token operator">%=</span> <span class="token function">m_pow_n</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>val_seg <span class="token operator">+</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cnt<span class="token operator">--</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                ret_num <span class="token operator">+=</span> <span class="token number">6</span><span class="token punctuation">;</span>
                pStr<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span><span class="token comment">// % 匹配错误，暂输出空格</span>
				<span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token char">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ret_num<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>


        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token function">my_send_char</span><span class="token punctuation">(</span><span class="token operator">*</span>pStr<span class="token punctuation">)</span><span class="token punctuation">;</span> ret_num<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        pStr<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">va_end</span><span class="token punctuation">(</span>pArgs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 结束取参数</span>

    <span class="token keyword">return</span> ret_num<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>myPrintf.h则写了Print的声明。</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_MYPRINTF_H_</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_MYPRINTF_H_</span></span>


<span class="token comment">// 返回值为打印字符的个数</span>
<span class="token comment">// 支持%d，%x，%s，%c，%f（只打印6位数字）</span>
<span class="token keyword">int</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>


</code></pre> 
<p>3.main写了一些简要测的测试，测试全部正常。</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdarg.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"./ins/myPrintf.h"</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>

	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"% \r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"%%d\r\n"</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"%d(int0)\r\n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"%d(int100)\r\n"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"int(-123) =%d\r\n"</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"%d(int 123)\r\n"</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"%d(int 0x1234=4660)\r\n"</span><span class="token punctuation">,</span> <span class="token number">0x1234</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"%d(int 0x12345678=305419896)\r\n"</span><span class="token punctuation">,</span> <span class="token number">0x12345678</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"oct %o(int 0x1234=011064)\r\n"</span><span class="token punctuation">,</span> <span class="token number">0x1234</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"oct %o(int 0x12345678=02215053170)\r\n"</span><span class="token punctuation">,</span> <span class="token number">0x12345678</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"hex(0x0)=%x\r\n"</span><span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"hex(0x100)=%x\r\n"</span><span class="token punctuation">,</span> <span class="token number">0x100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"hex(0x1234)=%x\r\n"</span><span class="token punctuation">,</span> <span class="token number">0x1234</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"hex(0x7fffffff)=0x%x\r\n"</span><span class="token punctuation">,</span> <span class="token number">0x7fffffff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"hex(0xffffffff)=0x%x\r\n"</span><span class="token punctuation">,</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"bin(0xff)=%b\r\n"</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"%b(bin 0xff)\r\n"</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"str=%s\r\n"</span><span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"%s(str)\r\n"</span><span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"ch =%c\r\n"</span><span class="token punctuation">,</span> <span class="token char">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"%c(ch)\r\n"</span><span class="token punctuation">,</span> <span class="token char">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"float(3.141592) = %f\r\n"</span><span class="token punctuation">,</span> <span class="token number">3.141592</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"=====pinrf:float= %f\r\n\r\n"</span><span class="token punctuation">,</span> <span class="token number">3.141592</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"float(123456789.123456789) = %f\r\n"</span><span class="token punctuation">,</span> <span class="token number">123456789.123456789</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"=========pinrf:float = %f\r\n\r\n"</span><span class="token punctuation">,</span> <span class="token number">123456789.123456789</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"float(123456.123456789) = %f\r\n"</span><span class="token punctuation">,</span> <span class="token number">123456.123456789</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"==========pinrf:float = %f\r\n\r\n"</span><span class="token punctuation">,</span> <span class="token number">123456.123456789</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"%d%s\r\n\r\n"</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_473"></a>程序运行结果</h3> 
<p>注：<code>%f</code>保留6位置小数，不采取四舍五入</p> 
<pre><code class="prism language-c">
<span class="token operator">%</span>d
<span class="token number">0</span><span class="token punctuation">(</span>int0<span class="token punctuation">)</span>
<span class="token number">100</span><span class="token punctuation">(</span>int100<span class="token punctuation">)</span>
<span class="token keyword">int</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">123</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">-</span><span class="token number">123</span>
<span class="token number">123</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token number">123</span><span class="token punctuation">)</span>
<span class="token number">4660</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token number">0x1234</span><span class="token operator">=</span><span class="token number">4660</span><span class="token punctuation">)</span>
<span class="token number">305419896</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token number">0x12345678</span><span class="token operator">=</span><span class="token number">305419896</span><span class="token punctuation">)</span>
oct <span class="token number">11064</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token number">0x1234</span><span class="token operator">=</span><span class="token number">011064</span><span class="token punctuation">)</span>
oct <span class="token number">2215053170</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token number">0x12345678</span><span class="token operator">=</span><span class="token number">02215053170</span><span class="token punctuation">)</span>
<span class="token function">hex</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token function">hex</span><span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">100</span>
<span class="token function">hex</span><span class="token punctuation">(</span><span class="token number">0x1234</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1234</span>
<span class="token function">hex</span><span class="token punctuation">(</span><span class="token number">0x7fffffff</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0x7FFFFFFF</span>
<span class="token function">hex</span><span class="token punctuation">(</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0xFFFFFFFF</span>
<span class="token function">bin</span><span class="token punctuation">(</span><span class="token number">0xff</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">11111111</span>
<span class="token number">11111111</span><span class="token punctuation">(</span>bin <span class="token number">0xff</span><span class="token punctuation">)</span>
str<span class="token operator">=</span>hello
<span class="token function">hello</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
ch <span class="token operator">=</span>a
<span class="token function">a</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span>
<span class="token keyword">float</span><span class="token punctuation">(</span><span class="token number">3.141592</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3.141592</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>pinrf<span class="token operator">:</span><span class="token keyword">float</span><span class="token operator">=</span> <span class="token number">3.141592</span>

<span class="token keyword">float</span><span class="token punctuation">(</span><span class="token number">123456789.123456789</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">123456789.123456</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>pinrf<span class="token operator">:</span><span class="token keyword">float</span> <span class="token operator">=</span> <span class="token number">123456789.123457</span>

<span class="token keyword">float</span><span class="token punctuation">(</span><span class="token number">123456.123456789</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">123456.123456</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>pinrf<span class="token operator">:</span><span class="token keyword">float</span> <span class="token operator">=</span> <span class="token number">123456.123457</span>

<span class="token number">123</span>abc


</code></pre> 
<h3><a id="_511"></a>总结：</h3> 
<p>暂未做数据安全性检查，规范使用可以正常输出。<br> 使用VS2017进行编译测试，结果符合预期。</p> 
<p><strong>本文到此结束，感谢大家的阅读。</strong></p> 
<p><strong>欢迎大家评论交流。</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/11ba6a3c0584960cdb0ee89985b4dd0f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">linux系统中如何验证网络端口通不通</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d531e4bf75be8c56b7bc76814f8a7680/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Git安装包（window64版本，附有下载教程）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>