<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SharedPreferences.Editor 的apply()与commit()方法的区别 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SharedPreferences.Editor 的apply()与commit()方法的区别" />
<meta property="og:description" content="commit()的文档 官方文档如下:
Commit your preferences changes back from this Editor to the SharedPreferences object it is editing. This atomically performs the requested modifications, replacing whatever is currently in the SharedPreferences.
Note that when two editors are modifying preferences at the same time, the last one to call commit wins.
If you don&#39;t care about the return value and you&#39;re using this from your application&#39;s main thread, consider using apply() instead." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/dc9244e7393275d89571983f34412f89/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-07-20T16:57:00+08:00" />
<meta property="article:modified_time" content="2016-07-20T16:57:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SharedPreferences.Editor 的apply()与commit()方法的区别</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown"> 
 <h3 id="commit的文档">commit()的文档</h3> 
 <p>官方文档如下:</p> 
 <p>Commit your preferences changes back from this Editor to the SharedPreferences object it is editing. This atomically performs the requested modifications, replacing whatever is currently in the SharedPreferences.</p> 
 <p>Note that when two editors are modifying preferences at the same time, the last one to call commit wins.</p> 
 <p>If you don't care about the return value and you're using this from your application's main thread, consider using apply() instead.</p> 
 <h3 id="apply的文档">apply()的文档</h3> 
 <p>官方文档如下:</p> 
 <p>Commit your preferences changes back from this Editor to the SharedPreferences object it is editing. This atomically performs the requested modifications, replacing whatever is currently in the SharedPreferences.</p> 
 <p>Note that when two editors are modifying preferences at the same time, the last one to call apply wins.</p> 
 <p>Unlike commit(), which writes its preferences out to persistent storage synchronously, apply() commits its changes to the in-memory SharedPreferences immediately but starts an asynchronous commit to disk and you won't be notified of any failures. If another editor on this SharedPreferences does a regular commit() while a apply() is still outstanding, the commit() will block until all async commits are completed as well as the commit itself.</p> 
 <p>As SharedPreferences instances are singletons within a process, it's safe to replace any instance of commit() with apply() if you were already ignoring the return value.</p> 
 <p>You don't need to worry about Android component lifecycles and their interaction with apply() writing to disk. The framework makes sure in-flight disk writes from apply() complete before switching states.</p> 
 <h3 id="解释说明">解释说明</h3> 
 <ol><li>需要注意的是<code>commit()</code>方法是<code>Added in API level 1</code>的,也就是<code>sdk1</code>就已经存在了.</li><li><code>apply()</code>方法是<code>Added in API level 9</code>的.</li><li><code>commit()</code>有返回值,成功返回<code>true</code>,失败返回<code>false</code>.<code>commit()</code>方法是<strong>同步</strong>提交到硬件磁盘，因此，在多个并发的提交commit的时候，他们会等待正在处理的commit保存到磁盘后在操作，从而降低了效率。</li><li><code>apply()</code>没有返回值.<code>apply()</code>是将修改的数据提交到内存, 而后<strong>异步</strong>真正的提交到硬件磁盘.</li></ol> 
 <h3 id="为什么建议使用apply替代commit">为什么建议使用apply()替代commit() ?</h3> 
 <p>答:<strong>因为Android的设计人员发现,开发人员对commit的返回值不感兴趣,而且在数据并发处理时使用commit要比apply效率低,所以推荐使用apply.</strong></p> 
</div> 
<p>转载于:https://www.cnblogs.com/didikee/p/5688991.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0a6d5699106bb868ba858b12a7d189f9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">poj 几道简单的dp题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8cd305981bca5d0fa06ceffefdc625a3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">快学scala 第十章 特质 读书笔记及习题答案代码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>