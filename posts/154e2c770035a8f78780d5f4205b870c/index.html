<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vb中文件的打开、文件的关闭 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vb中文件的打开、文件的关闭" />
<meta property="og:description" content="数据文件的操作按以下步骤进行：
打开数据文件（首次操作为建立数据文件并且打开）
进行读写操作
关闭数据文件
1、文件的打开
格式：
Open 文件名 For 方式 [Access 存取类型] [lock] As [#]文件号 [Len=记录长度]
文件名：数据文件的名字，该文件名可能还包括目录、文件夹及驱动器。
方式：指定文件方式，有 Append、Binary、Input、Output、或 Random 方式。如果未指定方式，则以 Random 访问方式打开文件。
Append：顺序输出（写入数据文件）
Binary：二进制方式（读写）
Input：顺序输入（读出数据）
Output：顺序输出（写入数据文件）
Random：随机(读写)
存取类型：说明打开的文件可以进行的操作，有 Read（读）、Write（写）、或 Read Write（读写） 操作。
Read（读）：只读文件
Write（写）：只写文件
Read Write（读写）：读写文件，在随机文件和二进制文件和Append方式下有效。
Lock：说明限定于其它进程打开的文件的操作。有 Shared、Lock Read、Lock Write、和 Lock Read Write 操作。
Lodk Shared：所有进程都可以对此数据文件进行读写操作。
Lock Read：不允许其他进程进行读操作。
Lock Write：不允许其他进程进行写操作。
Lock Read Write：不允许其他进程进行读写操作。
文件号：一个有效的文件号，范围在 1 到 511 之间。
记录长度：对于用随机访问方式打开的文件，该值就是记录长度。对于顺序文件，该值就是缓冲字符数。
功能：
打开指定的文件。
如果指定的文件不存在，在用 Append、Binary、Output、或 Random 方式打开文件时，可以建立这一文件。
如果文件已由其它进程打开，而且不允许指定的访问类型，则 Open 操作失败，而且会有错误发生。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/154e2c770035a8f78780d5f4205b870c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-10-13T10:00:09+08:00" />
<meta property="article:modified_time" content="2014-10-13T10:00:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vb中文件的打开、文件的关闭</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 数据文件的操作按以下步骤进行：</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 打开数据文件（首次操作为建立数据文件并且打开）</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 进行读写操作</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 关闭数据文件</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 　</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 1、文件的打开</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 格式：</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Open 文件名 For 方式 [Access 存取类型] [lock] As [#]文件号 [Len=记录长度]</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 文件名：数据文件的名字，该文件名可能还包括目录、文件夹及驱动器。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 方式：指定文件方式，有 Append、Binary、Input、Output、或 Random 方式。如果未指定方式，则以 Random 访问方式打开文件。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Append：顺序输出（写入数据文件）</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Binary：二进制方式（读写）</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Input：顺序输入（读出数据）</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Output：顺序输出（写入数据文件）</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Random：随机(读写)</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 存取类型：说明打开的文件可以进行的操作，有 Read（读）、Write（写）、或 Read Write（读写） 操作。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Read（读）：只读文件</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Write（写）：只写文件</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Read Write（读写）：读写文件，在随机文件和二进制文件和Append方式下有效。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Lock：说明限定于其它进程打开的文件的操作。有 Shared、Lock Read、Lock Write、和 Lock Read Write 操作。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Lodk Shared：所有进程都可以对此数据文件进行读写操作。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Lock Read：不允许其他进程进行读操作。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Lock Write：不允许其他进程进行写操作。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Lock Read Write：不允许其他进程进行读写操作。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 文件号：一个有效的文件号，范围在 1 到 511 之间。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 记录长度：对于用随机访问方式打开的文件，该值就是记录长度。对于顺序文件，该值就是缓冲字符数。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 功能：</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 打开指定的文件。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 如果指定的文件不存在，在用 Append、Binary、Output、或 Random 方式打开文件时，可以建立这一文件。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 如果文件已由其它进程打开，而且不允许指定的访问类型，则 Open 操作失败，而且会有错误发生。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 如果方式是 Binary 方式，则 Len 子句会被忽略掉。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 注意：在 Binary、Input 和 Random 方式下可以用不同的文件号打开同一文件，而不必先将该文件关闭。在 Append 和 Output 方式下，如果要用不同的文件号打开同一文件，则必须在打开文件之前先关闭该文件。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 举例：</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Open "d:\student.txt" For Output As #1</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Open "d:\txl.txt" For Append  <span style="color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; line-height:28px"> As </span>#2</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Open "d:\address.txt" For Input Read <span style="color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; line-height:28px"> As</span> #3</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Open "d:\cj.txt" For Random <span style="color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; line-height:28px">  As </span>#4 len=40</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px">  </p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 2、文件关闭</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 格式：</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Close [[#]文件号][,[#]文件号][,[#]文件号][,[#]文件号]......</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 文件号：打开文件时指定的文件号。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 功能：</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 关闭指定的文件号连接的文件。如果不指定文件号将关闭所有打开的数据文件。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 关闭的操作主要是将缓冲区中的数据写入文件中，并且取消文件号与文件的关联。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 除了Close外，当程序运行结束时，也会关闭所有的数据文件。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 举例：</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Close #1</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> Close #2，#3</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px">  </p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 本文来自CSDN博客，转载请标明出处：<a target="_blank" rel="nofollow noopener noreferrer" href="http://blog.csdn.net/qinson/archive/2004/10/09/128860.aspx" style="text-decoration:none; color:rgb(255,70,102)">http://blog.csdn.net/qinson/archive/2004/10/09/128860.aspx</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dbff5e70cd4015ac45efce05be675e4d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">oc 常量与变量</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f8c9f3ec0944bd29c97280e84599b4fe/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">分布式搜索elasticsearch 索引文档的增删改查 入门</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>