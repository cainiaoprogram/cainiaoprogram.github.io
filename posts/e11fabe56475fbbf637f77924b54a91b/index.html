<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CNN&#43;LSTM 的模型结合（keras代码实现） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CNN&#43;LSTM 的模型结合（keras代码实现）" />
<meta property="og:description" content="CNN-LSTM模型 运行环境：python3.6.5 、Keras 2.1.5 、tensorflow 2.3.1等
CNN-LSTM的Sequential()写法：
from keras.models import Sequential from keras.layers import Dense, Dropout, Activation from keras.layers import Convolution1D, MaxPooling1D from keras.layers import LSTM #模型参数 time_step=100 # Convolution 卷积 filter_length = 5 # 滤波器长度 nb_filter = 64 # 滤波器个数 pool_length = 4 # 池化长度 # LSTM lstm_output_size = 70 # LSTM 层输出尺寸 # Training 训练参数 batch_size = 30 # 批数据量大小 nb_epoch = 2 # 迭代次数 # 构建模型 model = Sequential() model." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e11fabe56475fbbf637f77924b54a91b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-05T23:32:03+08:00" />
<meta property="article:modified_time" content="2020-12-05T23:32:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CNN&#43;LSTM 的模型结合（keras代码实现）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>CNN-LSTM模型</h2> 
<p><strong>运行环境：</strong>python3.6.5 、Keras 2.1.5 、tensorflow 2.3.1等</p> 
<p>CNN-LSTM的Sequential()写法：</p> 
<pre><code>from keras.models import Sequential
from keras.layers import Dense, Dropout, Activation
from keras.layers import Convolution1D, MaxPooling1D
from keras.layers import LSTM
#模型参数
time_step=100
# Convolution  卷积
filter_length = 5    # 滤波器长度
nb_filter = 64       # 滤波器个数
pool_length = 4      # 池化长度
# LSTM
lstm_output_size = 70   # LSTM 层输出尺寸
# Training   训练参数
batch_size = 30   # 批数据量大小
nb_epoch = 2      # 迭代次数
# 构建模型
model = Sequential()
model.add(Input(shape=(time_step, 128))  # 输入特征接收维度)  # 词嵌入层
model.add(Dropout(0.25))       # Dropout层
# 1D 卷积层，对词嵌入层输出做卷积操作
model.add(Convolution1D(nb_filter=nb_filter,
                        filter_length=filter_length,
                        border_mode='valid',
                        activation='relu',
                        subsample_length=1))
# 池化层
model.add(MaxPooling1D(pool_length=pool_length))
# LSTM 循环层
model.add(LSTM(lstm_output_size))
# 全连接层，只有一个神经元，输入是否为正面情感值
model.add(Dense(1))
model.add(Activation('sigmoid'))  # sigmoid判断情感（此处来做文本的情感分类问题）
model.summary()   # 模型概述
model.compile(loss='binary_crossentropy',
              optimizer='adam',
              metrics=['accuracy'])
# 训练
model.fit(X_train, y_train, batch_size=batch_size, nb_epoch=nb_epoch,
          validation_data=(X_test, y_test))</code></pre> 
<p>输入[100, 128]的序列（100为序列长度，50为词嵌入维度），经过（池化层为MaxPooling1D，） Convlution1D(nb_filters=64, filter_length=5) 后，变为 [96, 64]，再经过 MaxPooling1D(pool_length=4) 后，变成了 [24, 64]。其模型维度结构如图所示：</p> 
<pre><code>Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
embedding_1 (Embedding)          (None, 100, 128)      2560000     embedding_input_1[0][0]
____________________________________________________________________________________________________
dropout_1 (Dropout)              (None, 100, 128)      0           embedding_1[0][0]
____________________________________________________________________________________________________
convolution1d_1 (Convolution1D)  (None, 96, 64)        41024       dropout_1[0][0]
____________________________________________________________________________________________________
maxpooling1d_1 (MaxPooling1D)    (None, 24, 64)        0           convolution1d_1[0][0]
____________________________________________________________________________________________________
lstm_1 (LSTM)                    (None, 70)            37800       maxpooling1d_1[0][0]
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 1)             71          lstm_1[0][0]
____________________________________________________________________________________________________
activation_1 (Activation)        (None, 1)             0           dense_1[0][0]
====================================================================================================</code></pre> 
<p>CNN-LSTM的结构化写法：</p> 
<pre><code>inputs = Input(shape=(1, 3))  # 输入特征接收维度
    a=Dropout(0.25)(inputs)
    conv=Convolution1D(10, 1,strides=1,padding="valid", dilation_rate=1)(a)#filters, kernel_size, strides=1
    max=MaxPooling1D(pool_length=pool_length)(conv)
    lstm1=LSTM(lstm_output_size)(max)
    output = Dense(1, activation='linear')(lstm1)  # 输出类别（此次来做简单的线性预测问题）
    model = Model(inputs=inputs, outputs=output)  # 初始命名训练的模型为model
    model.summary()</code></pre> 
<p>其模型维度结构如图所示：</p> 
<pre><code>_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 1, 3)              0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 1, 3)              0         
_________________________________________________________________
conv1d_1 (Conv1D)            (None, 1, 10)             40        
_________________________________________________________________
max_pooling1d_1 (MaxPooling1 (None, 1, 10)             0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 70)                22680     
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 71        
=================================================================
Total params: 22,791
Trainable params: 22,791
Non-trainable params: 0
_________________________________________________________________</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/202c8a43e2d80877639c426292b23205/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">numpy读取txt_Numpy库学习笔记2-Numpy数据存储与函数</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2ca6050bc3310c93bbf79dd055872313/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">opencv两个图像相减_图像处理知识梳理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>