<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MyCat 2全套学习笔记（完整配置【主从&#43;集群】&#43;理论解析 &#43; 大厂真实业务理解） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MyCat 2全套学习笔记（完整配置【主从&#43;集群】&#43;理论解析 &#43; 大厂真实业务理解）" />
<meta property="og:description" content="目录
入门概述
MyCat概念
MyCat的作用
读写分离
数据分片 多数据源整合
MyCat 解决问题的思路
MyCat 和MySQL的区别
MyCat原理 MyCAT2的安装
前言
下载压缩包和jar包
安装MyCAT2
创建/data/tools
进入/data/tools目录
下载 下载完成
解压并移动到data目录下
修改权限
把所需的jar复制到mycat/lib目录
MyCAT的目录结构
启动一个3306的MySQL
配置物理库地址
启动MyCAT
连接MyCAT
MyCat2 配置文件介绍
用户（user）
数据源（datasource）
逻辑库与逻辑表（logicaltable）
序列号（sequence）
服务器（server）
MyCat2 注释配置
重置配置
用户相关
创建用户
删除用户
显示用户
数据源相关
创建数据源
删除数据源
显示数据源
集群相关
创建集群
删除集群
显示集群
MySQL 主从搭建 主从介绍 主从复制实现步骤
搭建主从复制
环境说明（使用Docker启动两个）
修改配置文件
主机的配置m1.cnf
从机的配置m1s1.cnf
配置文件修改后，复制到容器里面 执行SQL语句
进入主机里面执行相关配置
进入从机里面执行相关配置 搭建失败的原因
第一个不是yes，是connecting
第二个不是yes，是no
第一个不是yes，是no
MySQL主从的操作规范
测试" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c47e2c8585cbb706685f3818b3b896d9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-17T15:09:09+08:00" />
<meta property="article:modified_time" content="2023-10-17T15:09:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MyCat 2全套学习笔记（完整配置【主从&#43;集群】&#43;理论解析 &#43; 大厂真实业务理解）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p id="main-toc"><strong>目录</strong></p> 
 <p id="%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B-toc" style="margin-left:0px;"></p> 
 <p id="%E5%85%A5%E9%97%A8%E6%A6%82%E8%BF%B0-toc" style="margin-left:0px;"><a href="#%E5%85%A5%E9%97%A8%E6%A6%82%E8%BF%B0" rel="nofollow">入门概述</a></p> 
 <p id="MyCat%E6%A6%82%E5%BF%B5-toc" style="margin-left:40px;"><a href="#MyCat%E6%A6%82%E5%BF%B5" rel="nofollow">MyCat概念</a></p> 
 <p id="MyCat%E7%9A%84%E4%BD%9C%E7%94%A8-toc" style="margin-left:40px;"><a href="#MyCat%E7%9A%84%E4%BD%9C%E7%94%A8" rel="nofollow">MyCat的作用</a></p> 
 <p id="%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB-toc" style="margin-left:80px;"><a href="#%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB" rel="nofollow">读写分离</a></p> 
 <p id="%E6%95%B0%E6%8D%AE%E5%88%86%E7%89%87%C2%A0-toc" style="margin-left:80px;"><a href="#%E6%95%B0%E6%8D%AE%E5%88%86%E7%89%87%C2%A0" rel="nofollow">数据分片 </a></p> 
 <p id="%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E6%95%B4%E5%90%88-toc" style="margin-left:80px;"><a href="#%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E6%95%B4%E5%90%88" rel="nofollow">多数据源整合</a></p> 
 <p id="MyCat%C2%A0%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98%E7%9A%84%E6%80%9D%E8%B7%AF-toc" style="margin-left:40px;"><a href="#MyCat%C2%A0%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98%E7%9A%84%E6%80%9D%E8%B7%AF" rel="nofollow">MyCat 解决问题的思路</a></p> 
 <p id="MyCat%20%E5%92%8CMySQL%E7%9A%84%E5%8C%BA%E5%88%AB-toc" style="margin-left:40px;"><a href="#MyCat%20%E5%92%8CMySQL%E7%9A%84%E5%8C%BA%E5%88%AB" rel="nofollow">MyCat 和MySQL的区别</a></p> 
 <p id="MyCat%E5%8E%9F%E7%90%86%C2%A0-toc" style="margin-left:40px;"><a href="#MyCat%E5%8E%9F%E7%90%86%C2%A0" rel="nofollow">MyCat原理 </a></p> 
 <p id="MyCAT2%E7%9A%84%E5%AE%89%E8%A3%85-toc" style="margin-left:0px;"><a href="#MyCAT2%E7%9A%84%E5%AE%89%E8%A3%85" rel="nofollow">MyCAT2的安装</a></p> 
 <p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:40px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
 <p id="%E4%B8%8B%E8%BD%BD%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%92%8Cjar%E5%8C%85-toc" style="margin-left:40px;"><a href="#%E4%B8%8B%E8%BD%BD%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%92%8Cjar%E5%8C%85" rel="nofollow">下载压缩包和jar包</a></p> 
 <p id="%E5%AE%89%E8%A3%85MyCAT2-toc" style="margin-left:40px;"><a href="#%E5%AE%89%E8%A3%85MyCAT2" rel="nofollow">安装MyCAT2</a></p> 
 <p id="%E5%88%9B%E5%BB%BA%2Fdata%2Ftools-toc" style="margin-left:80px;"><a href="#%E5%88%9B%E5%BB%BA%2Fdata%2Ftools" rel="nofollow">创建/data/tools</a></p> 
 <p id="%E8%BF%9B%E5%85%A5%2Fdata%2Ftools%E7%9B%AE%E5%BD%95-toc" style="margin-left:80px;"><a href="#%E8%BF%9B%E5%85%A5%2Fdata%2Ftools%E7%9B%AE%E5%BD%95" rel="nofollow">进入/data/tools目录</a></p> 
 <p id="%E4%B8%8B%E8%BD%BD%20%C2%A0-toc" style="margin-left:80px;"><a href="#%E4%B8%8B%E8%BD%BD%20%C2%A0" rel="nofollow">下载  </a></p> 
 <p id="%E4%B8%8B%E8%BD%BD%E5%AE%8C%E6%88%90-toc" style="margin-left:80px;"><a href="#%E4%B8%8B%E8%BD%BD%E5%AE%8C%E6%88%90" rel="nofollow">下载完成</a></p> 
 <p id="%E8%A7%A3%E5%8E%8B%E5%B9%B6%E7%A7%BB%E5%8A%A8%E5%88%B0data%E7%9B%AE%E5%BD%95%E4%B8%8B-toc" style="margin-left:80px;"><a href="#%E8%A7%A3%E5%8E%8B%E5%B9%B6%E7%A7%BB%E5%8A%A8%E5%88%B0data%E7%9B%AE%E5%BD%95%E4%B8%8B" rel="nofollow">解压并移动到data目录下</a></p> 
 <p id="%E4%BF%AE%E6%94%B9%E6%9D%83%E9%99%90-toc" style="margin-left:80px;"><a href="#%E4%BF%AE%E6%94%B9%E6%9D%83%E9%99%90" rel="nofollow">修改权限</a></p> 
 <p id="%E6%8A%8A%E6%89%80%E9%9C%80%E7%9A%84jar%E5%A4%8D%E5%88%B6%E5%88%B0mycat%2Flib%E7%9B%AE%E5%BD%95-toc" style="margin-left:80px;"><a href="#%E6%8A%8A%E6%89%80%E9%9C%80%E7%9A%84jar%E5%A4%8D%E5%88%B6%E5%88%B0mycat%2Flib%E7%9B%AE%E5%BD%95" rel="nofollow">把所需的jar复制到mycat/lib目录</a></p> 
 <p id="MyCAT%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84-toc" style="margin-left:40px;"><a href="#MyCAT%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84" rel="nofollow">MyCAT的目录结构</a></p> 
 <p id="%E5%90%AF%E5%8A%A8%E4%B8%80%E4%B8%AA3306%E7%9A%84MySQL-toc" style="margin-left:40px;"><a href="#%E5%90%AF%E5%8A%A8%E4%B8%80%E4%B8%AA3306%E7%9A%84MySQL" rel="nofollow">启动一个3306的MySQL</a></p> 
 <p id="%E9%85%8D%E7%BD%AE%E7%89%A9%E7%90%86%E5%BA%93%E5%9C%B0%E5%9D%80-toc" style="margin-left:40px;"><a href="#%E9%85%8D%E7%BD%AE%E7%89%A9%E7%90%86%E5%BA%93%E5%9C%B0%E5%9D%80" rel="nofollow">配置物理库地址</a></p> 
 <p id="%E5%90%AF%E5%8A%A8MyCAT-toc" style="margin-left:40px;"><a href="#%E5%90%AF%E5%8A%A8MyCAT" rel="nofollow">启动MyCAT</a></p> 
 <p id="%E8%BF%9E%E6%8E%A5MyCAT-toc" style="margin-left:40px;"><a href="#%E8%BF%9E%E6%8E%A5MyCAT" rel="nofollow">连接MyCAT</a></p> 
 <p id="MyCat2%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BB%8B%E7%BB%8D-toc" style="margin-left:0px;"><a href="#MyCat2%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BB%8B%E7%BB%8D" rel="nofollow">MyCat2 配置文件介绍</a></p> 
 <p id="%E7%94%A8%E6%88%B7%EF%BC%88user%EF%BC%89-toc" style="margin-left:40px;"><a href="#%E7%94%A8%E6%88%B7%EF%BC%88user%EF%BC%89" rel="nofollow">用户（user）</a></p> 
 <p id="%E6%95%B0%E6%8D%AE%E6%BA%90%EF%BC%88datasource%EF%BC%89-toc" style="margin-left:40px;"><a href="#%E6%95%B0%E6%8D%AE%E6%BA%90%EF%BC%88datasource%EF%BC%89" rel="nofollow">数据源（datasource）</a></p> 
 <p id="%E9%80%BB%E8%BE%91%E5%BA%93%E4%B8%8E%E9%80%BB%E8%BE%91%E8%A1%A8%EF%BC%88logicaltable%EF%BC%89-toc" style="margin-left:40px;"><a href="#%E9%80%BB%E8%BE%91%E5%BA%93%E4%B8%8E%E9%80%BB%E8%BE%91%E8%A1%A8%EF%BC%88logicaltable%EF%BC%89" rel="nofollow">逻辑库与逻辑表（logicaltable）</a></p> 
 <p id="%E5%BA%8F%E5%88%97%E5%8F%B7%EF%BC%88sequence%EF%BC%89-toc" style="margin-left:40px;"><a href="#%E5%BA%8F%E5%88%97%E5%8F%B7%EF%BC%88sequence%EF%BC%89" rel="nofollow">序列号（sequence）</a></p> 
 <p id="%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88server%EF%BC%89-toc" style="margin-left:40px;"><a href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88server%EF%BC%89" rel="nofollow">服务器（server）</a></p> 
 <p id="MyCat2%20%E6%B3%A8%E9%87%8A%E9%85%8D%E7%BD%AE-toc" style="margin-left:0px;"><a href="#MyCat2%20%E6%B3%A8%E9%87%8A%E9%85%8D%E7%BD%AE" rel="nofollow">MyCat2 注释配置</a></p> 
 <p id="%E9%87%8D%E7%BD%AE%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px;"><a href="#%E9%87%8D%E7%BD%AE%E9%85%8D%E7%BD%AE" rel="nofollow">重置配置</a></p> 
 <p id="%E7%94%A8%E6%88%B7%E7%9B%B8%E5%85%B3-toc" style="margin-left:40px;"><a href="#%E7%94%A8%E6%88%B7%E7%9B%B8%E5%85%B3" rel="nofollow">用户相关</a></p> 
 <p id="%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7-toc" style="margin-left:80px;"><a href="#%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7" rel="nofollow">创建用户</a></p> 
 <p id="%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7-toc" style="margin-left:80px;"><a href="#%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7" rel="nofollow">删除用户</a></p> 
 <p id="%E6%98%BE%E7%A4%BA%E7%94%A8%E6%88%B7-toc" style="margin-left:80px;"><a href="#%E6%98%BE%E7%A4%BA%E7%94%A8%E6%88%B7" rel="nofollow">显示用户</a></p> 
 <p id="%E6%95%B0%E6%8D%AE%E6%BA%90%E7%9B%B8%E5%85%B3-toc" style="margin-left:40px;"><a href="#%E6%95%B0%E6%8D%AE%E6%BA%90%E7%9B%B8%E5%85%B3" rel="nofollow">数据源相关</a></p> 
 <p id="%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E6%BA%90-toc" style="margin-left:80px;"><a href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E6%BA%90" rel="nofollow">创建数据源</a></p> 
 <p id="%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%BA%90-toc" style="margin-left:80px;"><a href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%BA%90" rel="nofollow">删除数据源</a></p> 
 <p id="%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E6%BA%90-toc" style="margin-left:80px;"><a href="#%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E6%BA%90" rel="nofollow">显示数据源</a></p> 
 <p id="%E9%9B%86%E7%BE%A4%E7%9B%B8%E5%85%B3-toc" style="margin-left:40px;"><a href="#%E9%9B%86%E7%BE%A4%E7%9B%B8%E5%85%B3" rel="nofollow">集群相关</a></p> 
 <p id="%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4-toc" style="margin-left:80px;"><a href="#%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4" rel="nofollow">创建集群</a></p> 
 <p id="%E5%88%A0%E9%99%A4%E9%9B%86%E7%BE%A4-toc" style="margin-left:80px;"><a href="#%E5%88%A0%E9%99%A4%E9%9B%86%E7%BE%A4" rel="nofollow">删除集群</a></p> 
 <p id="%E6%98%BE%E7%A4%BA%E9%9B%86%E7%BE%A4-toc" style="margin-left:80px;"><a href="#%E6%98%BE%E7%A4%BA%E9%9B%86%E7%BE%A4" rel="nofollow">显示集群</a></p> 
 <p id="MySQL%20%E4%B8%BB%E4%BB%8E%E6%90%AD%E5%BB%BA%C2%A0-toc" style="margin-left:0px;"><a href="#MySQL%20%E4%B8%BB%E4%BB%8E%E6%90%AD%E5%BB%BA%C2%A0" rel="nofollow">MySQL 主从搭建 </a></p> 
 <p id="%E4%B8%BB%E4%BB%8E%E4%BB%8B%E7%BB%8D%C2%A0-toc" style="margin-left:40px;"><a href="#%E4%B8%BB%E4%BB%8E%E4%BB%8B%E7%BB%8D%C2%A0" rel="nofollow">主从介绍 </a></p> 
 <p id="%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4-toc" style="margin-left:40px;"><a href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4" rel="nofollow">主从复制实现步骤</a></p> 
 <p id="%E6%90%AD%E5%BB%BA%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-toc" style="margin-left:40px;"><a href="#%E6%90%AD%E5%BB%BA%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6" rel="nofollow">搭建主从复制</a></p> 
 <p id="%E7%8E%AF%E5%A2%83%E8%AF%B4%E6%98%8E%EF%BC%88%E4%BD%BF%E7%94%A8Docker%E5%90%AF%E5%8A%A8%E4%B8%A4%E4%B8%AA%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E7%8E%AF%E5%A2%83%E8%AF%B4%E6%98%8E%EF%BC%88%E4%BD%BF%E7%94%A8Docker%E5%90%AF%E5%8A%A8%E4%B8%A4%E4%B8%AA%EF%BC%89" rel="nofollow">环境说明（使用Docker启动两个）</a></p> 
 <p id="%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-toc" style="margin-left:80px;"><a href="#%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" rel="nofollow">修改配置文件</a></p> 
 <p id="%E4%B8%BB%E6%9C%BA%E7%9A%84%E9%85%8D%E7%BD%AEm1.cnf-toc" style="margin-left:120px;"><a href="#%E4%B8%BB%E6%9C%BA%E7%9A%84%E9%85%8D%E7%BD%AEm1.cnf" rel="nofollow">主机的配置m1.cnf</a></p> 
 <p id="%E4%BB%8E%E6%9C%BA%E7%9A%84%E9%85%8D%E7%BD%AEm1s1.cnf-toc" style="margin-left:120px;"><a href="#%E4%BB%8E%E6%9C%BA%E7%9A%84%E9%85%8D%E7%BD%AEm1s1.cnf" rel="nofollow">从机的配置m1s1.cnf</a></p> 
 <p id="%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BF%AE%E6%94%B9%E5%90%8E%EF%BC%8C%E5%A4%8D%E5%88%B6%E5%88%B0%E5%AE%B9%E5%99%A8%E9%87%8C%E9%9D%A2%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-toc" style="margin-left:120px;"><a href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BF%AE%E6%94%B9%E5%90%8E%EF%BC%8C%E5%A4%8D%E5%88%B6%E5%88%B0%E5%AE%B9%E5%99%A8%E9%87%8C%E9%9D%A2%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0" rel="nofollow">配置文件修改后，复制到容器里面     </a></p> 
 <p id="%E6%89%A7%E8%A1%8CSQL%E8%AF%AD%E5%8F%A5-toc" style="margin-left:80px;"><a href="#%E6%89%A7%E8%A1%8CSQL%E8%AF%AD%E5%8F%A5" rel="nofollow">执行SQL语句</a></p> 
 <p id="%E8%BF%9B%E5%85%A5%E4%B8%BB%E6%9C%BA%E9%87%8C%E9%9D%A2%E6%89%A7%E8%A1%8C%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE-toc" style="margin-left:120px;"><a href="#%E8%BF%9B%E5%85%A5%E4%B8%BB%E6%9C%BA%E9%87%8C%E9%9D%A2%E6%89%A7%E8%A1%8C%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE" rel="nofollow">进入主机里面执行相关配置</a></p> 
 <p id="%E8%BF%9B%E5%85%A5%E4%BB%8E%E6%9C%BA%E9%87%8C%E9%9D%A2%E6%89%A7%E8%A1%8C%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE%C2%A0-toc" style="margin-left:120px;"><a href="#%E8%BF%9B%E5%85%A5%E4%BB%8E%E6%9C%BA%E9%87%8C%E9%9D%A2%E6%89%A7%E8%A1%8C%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE%C2%A0" rel="nofollow">进入从机里面执行相关配置 </a></p> 
 <p id="%E6%90%AD%E5%BB%BA%E5%A4%B1%E8%B4%A5%E7%9A%84%E5%8E%9F%E5%9B%A0-toc" style="margin-left:40px;"><a href="#%E6%90%AD%E5%BB%BA%E5%A4%B1%E8%B4%A5%E7%9A%84%E5%8E%9F%E5%9B%A0" rel="nofollow">搭建失败的原因</a></p> 
 <p id="%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%B8%8D%E6%98%AFyes%EF%BC%8C%E6%98%AFconnecting-toc" style="margin-left:80px;"><a href="#%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%B8%8D%E6%98%AFyes%EF%BC%8C%E6%98%AFconnecting" rel="nofollow">第一个不是yes，是connecting</a></p> 
 <p id="%E7%AC%AC%E4%BA%8C%E4%B8%AA%E4%B8%8D%E6%98%AFyes%EF%BC%8C%E6%98%AFno-toc" style="margin-left:80px;"><a href="#%E7%AC%AC%E4%BA%8C%E4%B8%AA%E4%B8%8D%E6%98%AFyes%EF%BC%8C%E6%98%AFno" rel="nofollow">第二个不是yes，是no</a></p> 
 <p id="%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%B8%8D%E6%98%AFyes%EF%BC%8C%E6%98%AFno-toc" style="margin-left:80px;"><a href="#%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%B8%8D%E6%98%AFyes%EF%BC%8C%E6%98%AFno" rel="nofollow">第一个不是yes，是no</a></p> 
 <p id="MySQL%E4%B8%BB%E4%BB%8E%E7%9A%84%E6%93%8D%E4%BD%9C%E8%A7%84%E8%8C%83-toc" style="margin-left:80px;"><a href="#MySQL%E4%B8%BB%E4%BB%8E%E7%9A%84%E6%93%8D%E4%BD%9C%E8%A7%84%E8%8C%83" rel="nofollow">MySQL主从的操作规范</a></p> 
 <p id="%E6%B5%8B%E8%AF%95-toc" style="margin-left:40px;"><a href="#%E6%B5%8B%E8%AF%95" rel="nofollow">测试</a></p> 
 <p id="MyCAT2%E7%9A%84%E4%B8%BB%E4%BB%8E%E9%85%8D%E7%BD%AE-toc" style="margin-left:0px;"><a href="#MyCAT2%E7%9A%84%E4%B8%BB%E4%BB%8E%E9%85%8D%E7%BD%AE" rel="nofollow">MyCAT2的主从配置</a></p> 
 <p id="%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E6%BA%90-toc" style="margin-left:40px;"><a href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E6%BA%90" rel="nofollow">创建数据源</a></p> 
 <p id="%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E6%BA%90-toc" style="margin-left:40px;"><a href="#%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E6%BA%90" rel="nofollow">查询数据源</a></p> 
 <p id="%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4-toc" style="margin-left:40px;"><a href="#%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4" rel="nofollow">创建集群</a></p> 
 <p id="%E6%9F%A5%E8%AF%A2%E9%9B%86%E7%BE%A4-toc" style="margin-left:40px;"><a href="#%E6%9F%A5%E8%AF%A2%E9%9B%86%E7%BE%A4" rel="nofollow">查询集群</a></p> 
 <p id="%E5%88%9B%E5%BB%BA%E9%80%BB%E8%BE%91%E5%BA%93-toc" style="margin-left:40px;"><a href="#%E5%88%9B%E5%BB%BA%E9%80%BB%E8%BE%91%E5%BA%93" rel="nofollow">创建逻辑库</a></p> 
 <p id="%E4%BF%AE%E6%94%B9%E9%80%BB%E8%BE%91%E5%BA%93%E7%9A%84%E6%95%B0%E6%8D%AE%E6%BA%90-toc" style="margin-left:40px;"><a href="#%E4%BF%AE%E6%94%B9%E9%80%BB%E8%BE%91%E5%BA%93%E7%9A%84%E6%95%B0%E6%8D%AE%E6%BA%90" rel="nofollow">修改逻辑库的数据源</a></p> 
 <p id="%E6%9F%A5%E7%9C%8B%E9%9B%86%E7%BE%A4%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-toc" style="margin-left:40px;"><a href="#%E6%9F%A5%E7%9C%8B%E9%9B%86%E7%BE%A4%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" rel="nofollow">查看集群的配置文件</a></p> 
 <p id="%E6%B5%8B%E8%AF%95%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F(%E5%9C%A8MyCAT%E9%87%8C%E9%9D%A2%E6%B5%8B%E8%AF%95)-toc" style="margin-left:40px;"><a href="#%E6%B5%8B%E8%AF%95%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F%28%E5%9C%A8MyCAT%E9%87%8C%E9%9D%A2%E6%B5%8B%E8%AF%95%29" rel="nofollow">测试读写分离是否成功(在MyCAT里面测试)</a></p> 
 <p id="MySQL%20%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%EF%BC%88%E5%8F%8C%E4%B8%BB%E5%8F%8C%E9%87%8D%EF%BC%89-toc" style="margin-left:0px;"><a href="#MySQL%20%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%EF%BC%88%E5%8F%8C%E4%B8%BB%E5%8F%8C%E9%87%8D%EF%BC%89" rel="nofollow">MySQL 的集群搭建（双主双重）</a></p> 
 <p id="%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E6%A6%82%E8%BF%B0%C2%A0-toc" style="margin-left:40px;"><a href="#%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E6%A6%82%E8%BF%B0%C2%A0" rel="nofollow">集群搭建概述 </a></p> 
 <p id="%E4%BC%98%E7%82%B9-toc" style="margin-left:80px;"><a href="#%E4%BC%98%E7%82%B9" rel="nofollow">优点</a></p> 
 <p id="%E7%BC%BA%E7%82%B9-toc" style="margin-left:80px;"><a href="#%E7%BC%BA%E7%82%B9" rel="nofollow">缺点</a></p> 
 <p id="%E6%90%AD%E5%BB%BA%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C-toc" style="margin-left:40px;"><a href="#%E6%90%AD%E5%BB%BA%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C" rel="nofollow">搭建准备工作</a></p> 
 <p id="%E4%BD%BF%E7%94%A8Docker%E5%90%AF%E5%8A%A85%E5%8F%B0MySQL%EF%BC%88%E8%87%B3%E5%B0%91%E8%A6%815%E5%8F%B0%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E4%BD%BF%E7%94%A8Docker%E5%90%AF%E5%8A%A85%E5%8F%B0MySQL%EF%BC%88%E8%87%B3%E5%B0%91%E8%A6%815%E5%8F%B0%EF%BC%89" rel="nofollow">使用Docker启动5台MySQL（至少要5台）</a></p> 
 <p id="%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E4%BF%AE%E6%94%B9-toc" style="margin-left:80px;"><a href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E4%BF%AE%E6%94%B9" rel="nofollow">配置文件的修改</a></p> 
 <p id="%C2%A0%E9%87%8D%E5%90%AF%E6%96%B0%E5%BB%BA%E7%9A%84%E4%B8%89%E4%B8%AA%E5%AE%B9%E5%99%A8-toc" style="margin-left:80px;"><a href="#%C2%A0%E9%87%8D%E5%90%AF%E6%96%B0%E5%BB%BA%E7%9A%84%E4%B8%89%E4%B8%AA%E5%AE%B9%E5%99%A8" rel="nofollow"> 重启新建的三个容器</a></p> 
 <p id="%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8%E6%89%A7%E8%A1%8CSQL-toc" style="margin-left:40px;"><a href="#%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8%E6%89%A7%E8%A1%8CSQL" rel="nofollow">进入容器执行SQL</a></p> 
 <p id="%E9%AA%8C%E8%AF%81%E9%9B%86%E7%BE%A4%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F-toc" style="margin-left:40px;"><a href="#%E9%AA%8C%E8%AF%81%E9%9B%86%E7%BE%A4%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F" rel="nofollow">验证集群是否成功</a></p> 
 <p id="MyCAT2%E6%93%8D%E4%BD%9C%E5%8F%8C%E4%B8%BB%E5%8F%8C%E4%BB%8E-toc" style="margin-left:0px;"><a href="#MyCAT2%E6%93%8D%E4%BD%9C%E5%8F%8C%E4%B8%BB%E5%8F%8C%E4%BB%8E" rel="nofollow">MyCAT2操作双主双从</a></p> 
 <p id="%E8%A7%92%E8%89%B2%E8%AF%B4%E6%98%8E-toc" style="margin-left:40px;"><a href="#%E8%A7%92%E8%89%B2%E8%AF%B4%E6%98%8E" rel="nofollow">角色说明</a></p> 
 <p id="%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E6%BA%90%C2%A0-toc" style="margin-left:40px;"><a href="#%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E6%BA%90%C2%A0" rel="nofollow">添加数据源 </a></p> 
 <p id="%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E9%9B%86%E7%BE%A4-toc" style="margin-left:40px;"><a href="#%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E9%9B%86%E7%BE%A4" rel="nofollow">修改配置集群</a></p> 
 <p id="%E9%87%8D%E5%90%AFMyCAT%E6%B5%8B%E8%AF%95-toc" style="margin-left:40px;"><a href="#%E9%87%8D%E5%90%AFMyCAT%E6%B5%8B%E8%AF%95" rel="nofollow">重启MyCAT测试</a></p> 
 <p id="%E9%87%8D%E5%90%AFMyCAT-toc" style="margin-left:80px;"><a href="#%E9%87%8D%E5%90%AFMyCAT" rel="nofollow">重启MyCAT</a></p> 
 <p id="%E5%BC%80%E5%A7%8B%E6%B5%8B%E8%AF%95-toc" style="margin-left:80px;"><a href="#%E5%BC%80%E5%A7%8B%E6%B5%8B%E8%AF%95" rel="nofollow">开始测试</a></p> 
 <p id="MyCAT2%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8-toc" style="margin-left:0px;"><a href="#MyCAT2%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8" rel="nofollow">MyCAT2分库分表</a></p> 
 <p id="h_605884141_0-toc" style="margin-left:40px;"><a href="#h_605884141_0" rel="nofollow">什么是分库分表？</a></p> 
 <p id="h_605884141_1-toc" style="margin-left:80px;"><a href="#h_605884141_1" rel="nofollow">分库</a></p> 
 <p id="h_605884141_2-toc" style="margin-left:80px;"><a href="#h_605884141_2" rel="nofollow">分表</a></p> 
 <p id="h_605884141_3-toc" style="margin-left:80px;"><a href="#h_605884141_3" rel="nofollow">分库分表</a></p> 
 <p id="%E5%A6%82%E4%BD%95%E5%88%87%E5%88%86%E5%BA%93%E5%92%8C%E8%A1%A8%EF%BC%9F-toc" style="margin-left:40px;"><a href="#%E5%A6%82%E4%BD%95%E5%88%87%E5%88%86%E5%BA%93%E5%92%8C%E8%A1%A8%EF%BC%9F" rel="nofollow">如何切分库和表？</a></p> 
 <p id="h_605884141_5-toc" style="margin-left:80px;"><a href="#h_605884141_5" rel="nofollow">水平切分</a></p> 
 <p id="h_605884141_6-toc" style="margin-left:80px;"><a href="#h_605884141_6" rel="nofollow">垂直切分</a></p> 
 <p id="%E6%B7%B7%E5%90%88%E5%88%87%E5%88%86-toc" style="margin-left:80px;"><a href="#%E6%B7%B7%E5%90%88%E5%88%87%E5%88%86" rel="nofollow">混合切分</a></p> 
 <p id="%E5%88%87%E5%88%86%E7%AD%96%E7%95%A5-toc" style="margin-left:40px;"><a href="#%E5%88%87%E5%88%86%E7%AD%96%E7%95%A5" rel="nofollow">切分策略</a></p> 
 <p id="h_605884141_16-toc" style="margin-left:80px;"><a href="#h_605884141_16" rel="nofollow">Range 范围</a></p> 
 <p id="h_605884141_17-toc" style="margin-left:80px;"><a href="#h_605884141_17" rel="nofollow">Hash切分</a></p> 
 <p id="h_605884141_18-toc" style="margin-left:80px;"><a href="#h_605884141_18" rel="nofollow">映射表</a></p> 
 <p id="%E5%88%86%E7%89%87%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B-toc" style="margin-left:40px;"><a href="#%E5%88%86%E7%89%87%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B" rel="nofollow">分片算法简介</a></p> 
 <p id="%E5%8F%96%E6%A8%A1%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87%20MOD_HASH-toc" style="margin-left:80px;"><a href="#%E5%8F%96%E6%A8%A1%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87%20MOD_HASH" rel="nofollow">取模哈希分片 MOD_HASH</a></p> 
 <p id="%E8%8C%83%E5%9B%B4%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87%20RANGE_HASH-toc" style="margin-left:80px;"><a href="#%E8%8C%83%E5%9B%B4%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87%20RANGE_HASH" rel="nofollow">范围哈希分片 RANGE_HASH</a></p> 
 <p id="%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87%20UNI_HASH-toc" style="margin-left:80px;"><a href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87%20UNI_HASH" rel="nofollow">字符串哈希分片 UNI_HASH</a></p> 
 <p id="%E6%97%A5%E6%9C%9F%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87%20YYYYDD-toc" style="margin-left:80px;"><a href="#%E6%97%A5%E6%9C%9F%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87%20YYYYDD" rel="nofollow">日期哈希分片 YYYYDD</a></p> 
 <p id="MyCAT2%E5%85%A8%E5%B1%80ID%E7%9A%84%E7%94%9F%E6%88%90%E6%96%B9%E5%BC%8F-toc" style="margin-left:40px;"><a href="#MyCAT2%E5%85%A8%E5%B1%80ID%E7%9A%84%E7%94%9F%E6%88%90%E6%96%B9%E5%BC%8F" rel="nofollow">MyCAT2全局ID的生成方式</a></p> 
 <p id="%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%85%A8%E5%B1%80ID-toc" style="margin-left:80px;"><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%85%A8%E5%B1%80ID" rel="nofollow">为什么要全局ID</a></p> 
 <p id="%E5%A4%A7%E5%8E%82%E5%AE%9E%E9%99%85%E4%B8%9A%E5%8A%A1%E4%BD%93%E4%BC%9A%C2%A0-toc" style="margin-left:40px;"><a href="#%E5%A4%A7%E5%8E%82%E5%AE%9E%E9%99%85%E4%B8%9A%E5%8A%A1%E4%BD%93%E4%BC%9A%C2%A0" rel="nofollow">大厂实际业务体会 </a></p> 
 <p id="%E6%90%AD%E5%BB%BA%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E6%9E%B6%E6%9E%84%C2%A0-toc" style="margin-left:40px;"><a href="#%E6%90%AD%E5%BB%BA%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E6%9E%B6%E6%9E%84%C2%A0" rel="nofollow">搭建分库分表架构</a></p> 
</blockquote> 
<h2 id="%E5%85%A5%E9%97%A8%E6%A6%82%E8%BF%B0"><strong>入门概述</strong></h2> 
<h3 id="MyCat%E6%A6%82%E5%BF%B5" style="background-color:transparent;">MyCat概念</h3> 
<p>        MyCAT 是目前最流行的<span style="color:#0d0016;"><strong>分布式数据库中间插件</strong></span>，是一个开源的分布式数据库系统，是一个实现了 MySQL 协议的服务器。前端用户可以把它看作一个数据库代理，用 MySQL客户端工具和命令行访问，其后端可以用 MySQL 原生协议与多个 MySQL 服务器通信，也可以用JDBC协议与大多数主流数据库服务器通信，其核心功能是<span style="color:#0d0016;"><strong>分表分库</strong></span>，即将个大表水平分割为 N个小表，存储在后端 MySQL 服务器里或者其他数据库里<br>         MyCAT 发展到目前,已经不是一个单纯的 MySQL代理了,它的后端可以<span style="color:#0d0016;"><strong>支持 MySQL、SQL Server Oracle、DB2PostqreSQL等主流数据库，也支持 MonoDB 这种新型 NOSQL方式</strong></span>的存储。未来，它还会支持更多类型的存储<br>         不过，无论是哪种存储方式，<span style="color:#0d0016;"><strong>在最终用户看，MyCAT里都是一个传统的数据库表，支持标准的 SQL 语句进行数据的操作</strong></span>，这样一来，对前端业务系统来说，可以大幅降低开发难度，提升开发速度</p> 
<blockquote> 
 <p>更多解释见官网        </p> 
 <p>        <a class="link-info" href="http://www.mycat.org.cn/" rel="nofollow" title="http://www.mycat.org.cn/">http://www.mycat.org.cn/</a></p> 
 <p>项目地址:源码地址</p> 
 <p>        <a class="link-info" href="https://github.com/MyCATApache/Mycat2" title="https://github.com/MyCATApache/Mycat2">https://github.com/MyCATApache/Mycat2</a></p> 
 <p>        <a class="link-info" href="https://gitee.com/MycatOne/Mycat2" rel="nofollow" title="https://gitee.com/MycatOne/Mycat2">https://gitee.com/MycatOne/Mycat2</a></p> 
</blockquote> 
<p><img alt="" height="413" src="https://images2.imgbox.com/a4/d4/nFurIY52_o.png" width="1200"></p> 
<p>        随着互联网的发展，数据的量级也是呈指数的增长，从 GB 到TB 到 PB，操作数据也是愈加的困难，传统的关系性数据库已经无法满足快速查询与插入数据的需求<br>         而 NoSQL的出现暂时解决了这一危机。<br>         NoSQL 通过降低数据的安全性，减少对事务的支持，减少对复杂查询的支持来提升性能。但是，NoSQL 存在无法满足某些使用场景的情况，比如，有些使用场景绝对要有事务与安全指标。这时 NOSQL 肯定无法满足。<br>         所以，我们还是需要使用关系型数据库.<br>         那么，如何使用关系型数据库解决海量存储的问题呢?此时就需要做数据库集群，为了提高查询性能<span style="color:#0d0016;"><strong>将一个数据库的数据分散到不同的数据库中存储</strong></span>，为应对该问题，MyCAT 就出现了 </p> 
<h3 id="MyCat%E7%9A%84%E4%BD%9C%E7%94%A8">MyCat的作用</h3> 
<h4 id="%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB"><span style="color:#000000;"><strong>读写分离</strong></span></h4> 
<p class="img-center"><img alt="" height="229" src="https://images2.imgbox.com/4d/65/ZcrYPRwZ_o.png" width="492"></p> 
<h4 id="%E6%95%B0%E6%8D%AE%E5%88%86%E7%89%87%C2%A0"><span style="color:#000000;"><strong>数据分片</strong></span> </h4> 
<div style="text-align:center;"> 
 <strong><span style="color:#000000;">垂直拆分（分库）、水平拆分（分表）、垂直</span><span style="color:#000000;">+</span><span style="color:#000000;">水平拆分（分库分表）</span></strong> 
</div> 
<p class="img-center"><img alt="" height="359" src="https://images2.imgbox.com/5e/21/0Eg3KAMC_o.png" width="526"></p> 
<h4 id="%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E6%95%B4%E5%90%88"><span style="color:#000000;"><strong>多数据源整合</strong></span></h4> 
<p class="img-center"><img alt="" height="276" src="https://images2.imgbox.com/8e/5c/etc673vH_o.png" width="525"></p> 
<h3 id="MyCat%C2%A0%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98%E7%9A%84%E6%80%9D%E8%B7%AF">MyCat 解决问题的思路</h3> 
<p class="img-center"><img alt="" height="158" src="https://images2.imgbox.com/d9/ca/Aump3Q4t_o.png" width="460"></p> 
<p class="img-center"><img alt="" height="187" src="https://images2.imgbox.com/c1/d0/kLDhKJsn_o.png" width="450"></p> 
<p class="img-center"><img alt="" height="181" src="https://images2.imgbox.com/b0/6b/VuQuV8Ik_o.png" width="447"></p> 
<h3 id="MyCat%20%E5%92%8CMySQL%E7%9A%84%E5%8C%BA%E5%88%AB">MyCat 和MySQL的区别</h3> 
<p>        我们可以把上层看作是对下层的<span style="color:#0d0016;"><strong>抽象</strong></span>，例如操作系统是对各类计算机硬件的抽象。那么我们什么时候需要抽象?<br>         假设一个项目只需要一个人完成时，我们不需要 Leader，但是当需要几十人完成时，就应该有一个管理者，发挥沟通协调等作用，这个管理者对于他的上层来说就是对项目组的抽象<br>         同样的，当我们的应用只需要一台数据库服务器时，我们并不需要 MyCAT，<span style="color:#0d0016;"><strong>如果你需要分库甚至分表，这时候应用要面对很多个数据库时</strong></span>，这时，就需要对数据库层做一个抽象，来管理这些数据库，最上面的应用只需要面对一个数据库层的抽象或者说数据库中间件就好了，这就是 MyCAT 的核心作用。<br> 所以你可以这样理解:</p> 
<blockquote> 
 <p><span style="color:#0d0016;"><strong>数据库是对底层存储文件的抽象，而 MyCAT 是对数据库的抽象</strong></span></p> 
</blockquote> 
<h3 id="MyCat%E5%8E%9F%E7%90%86%C2%A0" style="background-color:transparent;">MyCat原理 </h3> 
<p>        简单来说就是<span style="color:#0d0016;"><strong>拦截</strong></span>用户发来的SQL语句，对SQL语句<span style="color:#0d0016;"><strong>做了一些特定的分析</strong></span>，如分片分析，路由分析，读写分离分析，缓存分析等，然后将此SQL发往后端的真实数据库，并将返回的结果<span style="color:#0d0016;"><strong>做适当处理</strong></span>，最终返回给用户。</p> 
<p><img alt="" height="481" src="https://images2.imgbox.com/47/77/ts9i4UIZ_o.png" width="1200"></p> 
<div> 
 <span style="color:#000000;">这种方式把数据库的分布式从代码中解耦出来，程序员察觉不出来后台使用Mycat 还是 </span> 
 <span style="color:#000000;">MySQL</span> 
</div> 
<div> 
 <hr> 
 <h2 id="MyCAT2%E7%9A%84%E5%AE%89%E8%A3%85" style="text-align:justify;"><strong><strong><strong>MyCAT</strong></strong><strong><strong>2</strong></strong><strong><strong>的安装</strong></strong></strong></h2> 
 <h3 id="%E5%89%8D%E8%A8%80" style="text-align:justify;"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>前言</strong></span></strong></strong></span></h3> 
 <p style="margin-left:.0001pt;text-align:justify;">        使用MyCAT 2要安装JDK，也可以直接使用yum -y install java-1.8.0-openjdk.x86_64 因为MyCAT 是基于JDK1.8开发的。</p> 
 <h3 id="%E4%B8%8B%E8%BD%BD%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%92%8Cjar%E5%8C%85" style="text-align:justify;"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>下载压缩包</strong></span></strong><strong><span style="color:#000000;"><strong>和jar包</strong></span></strong></strong></span></h3> 
 <ul><li>安装程序包：<a class="link-info" href="http://dl.mycat.org.cn/2.0/install-template/mycat2-install-template-1.21.zip%C2%A0" rel="nofollow" title="http://dl.mycat.org.cn/2.0/install-template/mycat2-install-template-1.21.zip ">http://dl.mycat.org.cn/2.0/install-template/mycat2-install-template-1.21.zip </a></li><li>jar包：<a class="link-info" href="http://dl.mycat.org.cn/2.0/1.21-release/mycat2-1.21-release-jar-with-dependencies.jar" rel="nofollow" title="http://dl.mycat.org.cn/2.0/1.21-release/mycat2-1.21-release-jar-with-dependencies.jar">http://dl.mycat.org.cn/2.0/1.21-release/mycat2-1.21-release-jar-with-dependencies.jar</a></li><li>wget：<a class="link-info" href="http://dl.mycat.org.cn/2.0/install-template/mycat2-install-template-1.21.zip" rel="nofollow" title="http://dl.mycat.org.cn/2.0/install-template/mycat2-install-template-1.21.zip">http://dl.mycat.org.cn/2.0/install-template/mycat2-install-template-1.21.zip</a></li><li>wget：<a class="link-info" href="http://dl.mycat.org.cn/2.0/1.21-release/mycat2-1.21-release-jar-with-dependencies.jar%C2%A0" rel="nofollow" title="http://dl.mycat.org.cn/2.0/1.21-release/mycat2-1.21-release-jar-with-dependencies.jar ">http://dl.mycat.org.cn/2.0/1.21-release/mycat2-1.21-release-jar-with-dependencies.jar </a></li></ul> ​ 
 <p class="img-center"><img alt="" height="118" src="https://images2.imgbox.com/6b/f8/OihzS5cM_o.png" width="411"></p> 
 <h3 id="%E5%AE%89%E8%A3%85MyCAT2" style="text-align:justify;"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>安装My</strong></span></strong><strong><span style="color:#000000;"><strong>CAT</strong></span></strong><strong><span style="color:#000000;"><strong>2</strong></span></strong></strong></span></h3> 
 <h4 id="%E5%88%9B%E5%BB%BA%2Fdata%2Ftools" style="text-align:justify;"><span style="color:#70ad47;"><strong><strong><span style="color:#000080;"><strong>创建/data/tools</strong></span></strong></strong></span></h4> 
 <pre><code class="language-XML">mkdir -p  /data/tools</code></pre> 
 <h4 id="%E8%BF%9B%E5%85%A5%2Fdata%2Ftools%E7%9B%AE%E5%BD%95" style="text-align:justify;"><span style="color:#70ad47;"><strong><strong><span style="color:#000080;"><strong>进入/data/tools目录</strong></span></strong></strong></span></h4> 
 <pre><code class="language-XML">cd /data/tools</code></pre> 
 <h4 id="%E4%B8%8B%E8%BD%BD%20%C2%A0"><span style="color:#70ad47;"><strong><strong><span style="color:#000080;"><strong>下载  </strong></span></strong></strong></span></h4> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#000000;"><strong>如果没有wget</strong></span></strong><strong><span style="color:#000000;"><strong>，</strong></span></strong><strong><span style="color:#000000;"><strong>就执行yum -y install wget</strong></span></strong></p> 
 <p style="margin-left:.0001pt;text-align:justify;">wget <a href="http://dl.mycat.org.cn/2.0/install-template/mycat2-install-template-1.21.zip" rel="nofollow" title="http://dl.mycat.org.cn/2.0/install-template/mycat2-install-template-1.21.zip">http://dl.mycat.org.cn/2.0/install-template/mycat2-install-template-1.21.zip</a></p> 
 <p style="margin-left:.0001pt;text-align:justify;">wget <a href="http://dl.mycat.org.cn/2.0/1.21-release/mycat2-1.21-release-jar-with-dependencies.jar" rel="nofollow" title="http://dl.mycat.org.cn/2.0/1.21-release/mycat2-1.21-release-jar-with-dependencies.jar">http://dl.mycat.org.cn/2.0/1.21-release/mycat2-1.21-release-jar-with-dependencies.jar</a></p> 
 <h4 id="%E4%B8%8B%E8%BD%BD%E5%AE%8C%E6%88%90" style="background-color:transparent;margin-left:.0001pt;text-align:justify;"><span style="color:#000080;">下载完成</span></h4> 
 <h2 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="93" src="https://images2.imgbox.com/86/22/GSD3PKvx_o.png" width="1200"></h2> 
 <h4 id="%E8%A7%A3%E5%8E%8B%E5%B9%B6%E7%A7%BB%E5%8A%A8%E5%88%B0data%E7%9B%AE%E5%BD%95%E4%B8%8B"><span style="color:#70ad47;"><strong><strong><span style="color:#000080;"><strong>解压并移动到data目录下</strong></span></strong></strong></span></h4> 
 <pre><code class="language-XML">yum -y install unzip
unzip mycat2-install-template-1.21.zip
mv mycat ../</code></pre> 
 <h4 id="%E4%BF%AE%E6%94%B9%E6%9D%83%E9%99%90" style="margin-left:.0001pt;text-align:justify;"><span style="color:#000080;">修改权限</span></h4> 
 <p style="margin-left:.0001pt;text-align:justify;">把bin目录的文件加执行权限：</p> 
 <pre><code class="language-XML">cd /data/mycat/bin
chmod +x *</code></pre> 
 <h4 id="%E6%8A%8A%E6%89%80%E9%9C%80%E7%9A%84jar%E5%A4%8D%E5%88%B6%E5%88%B0mycat%2Flib%E7%9B%AE%E5%BD%95" style="margin-left:.0001pt;text-align:justify;"><span style="color:#000080;">把所需的jar复制到mycat/lib目录</span></h4> 
 <pre><code class="language-XML">cd /data/mycat/lib/
cp /data/tools/mycat2-1.21-release-jar-with-dependencies.jar ./</code></pre> 
 <h3 id="MyCAT%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84" style="margin-left:.0001pt;text-align:justify;">MyCAT的目录结构</h3> 
 <h2><img alt="" height="195" src="https://images2.imgbox.com/6e/0d/a1wVxPiQ_o.png" width="1077"></h2> 
 <p style="margin-left:.0001pt;text-align:justify;">其中：</p> 
 <blockquote> 
  <p style="margin-left:.0001pt;text-align:justify;">1）bin 执行命令的目录 </p> 
  <p style="margin-left:.0001pt;text-align:justify;">2）conf 配置文件</p> 
  <p style="margin-left:.0001pt;text-align:justify;">3）lib  依赖包</p> 
  <p style="margin-left:.0001pt;text-align:justify;">4）logs 日志包</p> 
 </blockquote> 
 <h3 id="%E5%90%AF%E5%8A%A8%E4%B8%80%E4%B8%AA3306%E7%9A%84MySQL"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>启动一个3306的MySQL</strong></span></strong></strong></span></h3> 
 <p style="margin-left:.0001pt;text-align:justify;">会为mycat代理连接启动时<span style="color:#0d0016;"><strong>需要有一个默认的数据源，所以我们在启动的时候先为其准备一个数据源</strong></span>，接下来我们使用docker启动</p> 
 <pre><code class="language-XML">docker run --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 --lower_case_table_names=1</code></pre> 
 <h3 id="%E9%85%8D%E7%BD%AE%E7%89%A9%E7%90%86%E5%BA%93%E5%9C%B0%E5%9D%80" style="text-align:justify;"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>配置物理库地址</strong></span></strong></strong></span></h3> 
 <p style="margin-left:.0001pt;text-align:justify;">在启动之前我们要配置物理库的地址，要不然MyCAT启动就会报错。</p> 
 <p style="margin-left:.0001pt;text-align:justify;">配置文件位置: mycat/conf/datasources/prototypeDs.datasource.json</p> 
 <blockquote> 
  <p style="margin-left:.0001pt;text-align:justify;">主要配置<span style="color:#0d0016;"><strong>user</strong></span>、<span style="color:#0d0016;"><strong>password</strong></span>、<span style="color:#0d0016;"><strong>url</strong></span>三个字段，其他的字段是默认值，不用管</p> 
 </blockquote> 
 <pre><code class="language-XML">{
	"dbType":"mysql",
	"idleTimeout":60000,
	"initSqls":[],
	"initSqlsGetConnection":true,
	"instanceType":"READ_WRITE",
	"maxCon":1000,
	"maxConnectTimeout":3000,
	"maxRetryCount":5,
	"minCon":1,
	"name":"prototypeDs",
	"password":"123456",
	"type":"JDBC",
	"url":"jdbc:mysql://localhost:3306?useUnicode=true&amp;serverTimezone=Asia/Shanghai&amp;characterEncoding=UTF-8",
	"user":"root",
	"weight":0
}</code></pre> 
 <h3 id="%E5%90%AF%E5%8A%A8MyCAT" style="text-align:justify;"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>启动My</strong></span></strong><strong><span style="color:#000000;"><strong>CAT</strong></span></strong></strong></span></h3> 
 <pre><code class="language-XML">cd /data/mycat/bin
./mycat start 启动
./mycat stop 停止
./mycat console 前台运行
./mycat install 添加到系统自动启动
./mycat remove 取消随系统自动启动
./mycat restart 重启
./mycat pause 暂停
./mycat status 查看启动状态</code></pre> 
 <h3 id="%E8%BF%9E%E6%8E%A5MyCAT" style="text-align:justify;">连接MyCAT</h3> 
 <p style="margin-left:.0001pt;text-align:justify;">我们在外面看MyCAT，认为MyCAT 就是一个MySQL，怎么连接MySQL？</p> 
 <p style="margin-left:.0001pt;text-align:justify;">1）Navicat for MySQL 对MyCAT支持查询</p> 
 <p style="margin-left:.0001pt;text-align:justify;">2）SQLyog 操作MyCAT更友好</p> 
 <p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="197" src="https://images2.imgbox.com/e2/fa/E3ozA0bj_o.png" width="167"></p> 
 <p style="margin-left:.0001pt;text-align:justify;">输入IP地址、用户名，和端口号<strong><strong>（</strong></strong><strong><strong>注意端口号为8066</strong></strong><strong><strong>）。</strong></strong></p> 
 <p style="text-align:justify;"><img alt="" height="270" src="https://images2.imgbox.com/d3/b7/xyIHFENk_o.png" width="335"><img alt="" height="273" src="https://images2.imgbox.com/4a/81/cfgJ6TD2_o.png" width="340"></p> 
 <p style="margin-left:.0001pt;text-align:center;"><strong><strong>如果出现上面的弹出框，说明</strong></strong><strong><strong>MyCAT</strong></strong><strong><strong>安装成功。</strong></strong></p> 
 <hr> 
 <h2 id="MyCat2%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BB%8B%E7%BB%8D">MyCat2 配置文件介绍</h2> 
 <blockquote> 
  <p><span style="color:#0d0016;">本章节配置基于MyCat的配置文件，内容繁多，了解即可，下一章节的<strong>注释配置</strong>才是硬菜</span></p> 
 </blockquote> 
 <h3 id="%E7%94%A8%E6%88%B7%EF%BC%88user%EF%BC%89"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>用户（user）</strong></span></strong></strong></span></h3> 
 <p style="margin-left:.0001pt;text-align:justify;">配置文件位置mycat/conf/user/{用户名}.user.json。这个配置文件主要是用来配置MyCAT的登录用户的，也就是我们连接8066这个端口的用户信息。</p> 
 <pre><code class="language-XML">{
	"dialect":"mysql",
	"ip":null,
	"password":"123456",
	"transactionType":"proxy",
	"username":"root",
     "isolation":3 
}</code></pre> 
 <ul><li style="margin-left:.0001pt;text-align:justify;"><strong><strong>配置说明                </strong></strong></li></ul> 
 <ul><li><strong><strong>dialect：数据库(方言)类型</strong></strong></li><li><strong><strong>ip：配置白名单使用，一般写null 如果要限制这个用户</strong></strong></li><li><strong><strong>password：配置MyCAT用户的密码（明文）</strong></strong></li><li><strong><strong>isolation：设置初始化的事务隔离级别</strong></strong> 
   <ul><li><strong><strong>READ_UNCOMMITTED：1</strong></strong></li><li><strong><strong>READ_COMMITTED：2</strong></strong></li><li><strong><strong>REPEATED_READ：3，默认</strong></strong></li><li><strong><strong>SERIALIZABLE：4</strong></strong></li></ul></li><li><strong><strong>transactionType</strong></strong> 
   <ul><li><strong><strong>默认值：proxy（本地事务，在涉及大于1个数据库的事务，commit阶段失败会导致不一致，但是兼容性最好）</strong></strong></li><li><strong><strong>可选值：xa（事务，需要确认存储节点集群类型是否支持XA）</strong></strong></li></ul></li></ul> 
 <hr> 
 <h3 id="%E6%95%B0%E6%8D%AE%E6%BA%90%EF%BC%88datasource%EF%BC%89" style="margin-left:.0001pt;text-align:justify;">数据源（datasource）</h3> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>作用</strong></strong><strong><strong>：</strong></strong>配置MyCAT连接后端的物理库的数据源。</p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>配置文位置</strong></strong><strong><strong>：</strong></strong>mycat/conf/datasources/{数据源名字}.datasource.json</p> 
 <pre><code class="language-XML">{
	"dbType": "mysql",
	"idleTimeout": 60000,
	"initSqls": [],
	"initSqlsGetConnection": true,
	"instanceType": "READ_WRITE",
	"maxCon": 1000,
	"maxConnectTimeout": 3000,
	"maxRetryCount": 5,
	"minCon": 1,
	"name": "prototype",
	"password": "123456",
	"type": "JDBC",
	"url": "jdbc:mysql://127.0.0.1:3306/mysql?useUnicode=true&amp;serverTimezone=UTC",
	"user": "root",
	"weight": 0,
    "queryTimeout":30,//mills
}</code></pre> 
 <p>配置说明</p> 
 <ul><li>dbType：数据源类型</li><li>name：数据源名字</li><li>password：后端MySQL的密码</li><li>url：后端MySQL的JDBC连接地址 </li><li>user：后端MySQL的用户名</li><li>weight：配置数据源负载均衡的使用权重</li></ul> 
 <hr> 
 <h3 id="%E9%80%BB%E8%BE%91%E5%BA%93%E4%B8%8E%E9%80%BB%E8%BE%91%E8%A1%A8%EF%BC%88logicaltable%EF%BC%89"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>逻辑库与逻辑表（logicaltable）</strong></span></strong></strong></span></h3> 
 <p style="margin-left:.0001pt;text-align:justify;">作用：配置MyCAT里面和MySQL对应的逻辑表。</p> 
 <p style="margin-left:.0001pt;text-align:justify;">配置位置：mycat/conf/schemas/{库名}.schema.json</p> 
 <pre><code class="language-XML">{
	"customTables": {},
	"globalTables": {},
	"normalTables": {},
	"schemaName": "test",
	"shardingTables": {},
	"targetName": "prototype"
}</code></pre> 
 <p>配置说明</p> 
 <ul><li>customTables：自定义表</li><li>globalTables：全局表</li><li>normalTables：默认表</li><li>schemaName：库名</li><li>shardingTables：分片表</li><li>targetName：数据源名，也可以是集群名</li></ul> 
 <hr> 
 <h3 id="%E5%BA%8F%E5%88%97%E5%8F%B7%EF%BC%88sequence%EF%BC%89"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>序列号（sequence）</strong></span></strong></strong></span></h3> 
 <p style="margin-left:.0001pt;text-align:justify;">作用：使用序列号的分片表,对应的自增主键要在建表SQL中体现。</p> 
 <p style="margin-left:.0001pt;text-align:justify;">配置位置: mycat/conf/sequences/{数据库名字}_{表名字}.sequence.json（后面细说）。</p> 
 <hr> 
 <h3 id="%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88server%EF%BC%89"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>服务器（server）</strong></span></strong></strong></span></h3> 
 <p style="margin-left:.0001pt;text-align:justify;">这个是针对MyCAT的服务器的配置，一般情况下默认就行了，不用怎么配置。</p> 
 <hr> 
 <h2 id="MyCat2%20%E6%B3%A8%E9%87%8A%E9%85%8D%E7%BD%AE">MyCat2 注释配置</h2> 
 <blockquote> 
  <p>本章节的注释指令要求是在MyCat上执行，通常做法是通过<strong>MySQL图形化连接工具</strong>直连MyCat</p> 
  <p class="img-center"><img alt="" height="316" src="https://images2.imgbox.com/4b/77/GrWNAACu_o.png" width="532"></p> 
 </blockquote> 
 <h3 id="%E9%87%8D%E7%BD%AE%E9%85%8D%E7%BD%AE" style="text-align:justify;"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>重置配置</strong></span></strong></strong></span></h3> 
 <pre><code class="language-XML">/*+ mycat:resetConfig{} */</code></pre> 
 <h3 id="%E7%94%A8%E6%88%B7%E7%9B%B8%E5%85%B3" style="text-align:justify;"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>用户相关</strong></span></strong></strong></span></h3> 
 <h4 id="%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7">创建用户</h4> 
 <pre><code class="language-XML">/*+ mycat:createUser{
  "username":"user",
  "password":"",
  "ip":"127.0.0.1",
  "transactionType":"xa"
} */</code></pre> 
 <h4 id="%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7">删除用户</h4> 
 <pre><code class="language-XML">/*+ mycat:dropUser{
  "username":"user"} */</code></pre> 
 <h4 id="%E6%98%BE%E7%A4%BA%E7%94%A8%E6%88%B7">显示用户</h4> 
 <pre><code class="language-XML">/*+ mycat:showUsers */</code></pre> 
 <h3 id="%E6%95%B0%E6%8D%AE%E6%BA%90%E7%9B%B8%E5%85%B3">数据源相关</h3> 
 <h4 id="%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E6%BA%90">创建数据源</h4> 
 <blockquote> 
  <p><strong>这个只需要设置name、password、type、url、user几个字段就行了</strong></p> 
 </blockquote> 
 <pre><code class="language-XML">/*+ mycat:createDataSource{
  "dbType":"mysql",
  "idleTimeout":60000,
  "initSqls":[],
  "initSqlsGetConnection":true,
  "instanceType":"READ_WRITE",
  "maxCon":1000,
  "maxConnectTimeout":3000,
  "maxRetryCount":5,
  "minCon":1,
  "name":"dc1",
  "password":"123456",
  "type":"JDBC",
  "url":"jdbc:mysql://127.0.0.1:3306?useUnicode=true&amp;serverTimezone=UTC&amp;characterEncoding=UTF-8",
  "user":"root",
  "weight":0
} */;</code></pre> 
 <h4 id="%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%BA%90">删除数据源</h4> 
 <blockquote> 
  <p>这个只要设置<strong>name</strong>字段就行，其他的直接CV大法</p> 
 </blockquote> 
 <pre><code class="language-XML">/*+ mycat:dropDataSource{
  "dbType":"mysql",
  "idleTimeout":60000,
  "initSqls":[],
  "initSqlsGetConnection":true,
  "instanceType":"READ_WRITE",
  "maxCon":1000,
  "maxConnectTimeout":3000,
  "maxRetryCount":5,
  "minCon":1,
  "name":"dc1",
  "type":"JDBC",
  "weight":0
} */;</code></pre> 
 <h4 id="%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E6%BA%90">显示数据源</h4> 
 <pre><code class="language-XML">/*+ mycat:showDataSources{} */</code></pre> 
 <h3 id="%E9%9B%86%E7%BE%A4%E7%9B%B8%E5%85%B3">集群相关</h3> 
 <h4 id="%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4">创建集群</h4> 
 <pre><code class="language-XML">/*! mycat:createCluster{
  "clusterType":"MASTER_SLAVE",
  "heartbeat":{
    "heartbeatTimeout":1000,
    "maxRetry":3,
    "minSwitchTimeInterval":300,
    "slaveThreshold":0
  },
  "masters":[
    "dc1" //主节点
  ],
  "maxCon":2000,
  "name":"c0",
  "readBalanceType":"BALANCE_ALL",
  "replicas":[
    "dc2" //从节点
  ],
  "switchType":"SWITCH"
} */;</code></pre> 
 <h4 id="%E5%88%A0%E9%99%A4%E9%9B%86%E7%BE%A4">删除集群</h4> 
 <pre><code class="language-XML">/*! mycat:dropCluster{
  "name":"c0"
} */;</code></pre> 
 <h4 id="%E6%98%BE%E7%A4%BA%E9%9B%86%E7%BE%A4">显示集群</h4> 
 <pre><code class="language-XML">/*+ mycat:showClusters{} */</code></pre> 
</div> 
<hr> 
<h2 id="MySQL%20%E4%B8%BB%E4%BB%8E%E6%90%AD%E5%BB%BA%C2%A0">MySQL 主从搭建 </h2> 
<p style="text-align:center;"><strong><span style="color:#0d0016;">因为 MyCAT 只能路由、分发，不能把多个数据库里面的数据进行同步，所以要数据同步必须还要使用 MySQL 的读写分离，主从复制。</span></strong></p> 
<h3 id="%E4%B8%BB%E4%BB%8E%E4%BB%8B%E7%BB%8D%C2%A0">主从介绍 </h3> 
<p>​​​​​​       <span style="color:#4d4d4d;font-size:16px;">MySQL的主从复制是一种常见的数据库复制技术，用于实现</span><strong><span style="color:#0d0016;"><span style="font-size:16px;">数据在多个数据库服务器之间的同步</span></span></strong><span style="color:#4d4d4d;font-size:16px;">。</span></p> 
<blockquote> 
 <p><span style="color:#4d4d4d;">主从作用有：</span><span style="color:#0d0016;"><strong>实时灾备，用于故障切换;读写分离，提供查询服务;备份，避免影响业务</strong></span></p> 
</blockquote> 
<p>        在主从复制中，有<span style="color:#0d0016;"><strong>一个主数据库（Master）</strong></span>和<strong><span style="color:#0d0016;">一个或多个从数据库（Slave）</span></strong>。主数据库负责处理<span style="color:#0d0016;"><strong>事务操作（INSERT、UPDATE、DELETE）</strong></span>，并将这些操作的<span style="color:#0d0016;"><strong>日志（binlog）</strong></span>传送给从数据库。从数据库通过解析主数据库的日志并<span style="color:#0d0016;"><strong>执行相同的操作</strong></span>，在从库上实现数据的同步。</p> 
<p><img alt="" height="941" src="https://images2.imgbox.com/07/26/XVmmfePz_o.png" width="1200"></p> 
<h3 id="%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4">主从复制实现步骤</h3> 
<ol><li>主库将数据的<span style="color:#0d0016;"><strong>事务操作（DML）</strong></span>记录到一个<span style="color:#0d0016;"><strong>二进制日志</strong></span>中（即：binary log），也就是配置文件中指定的log-bin指定的文件就是日志文件。</li><li>从库会<span style="color:#0d0016;"><strong>监听主库的binary log日志文件变化</strong></span>，当发生数据变化后，将主库的日志文件拷贝到他的<span style="color:#0d0016;"><strong>中继日志</strong></span>即配置文件中指定的relay log日志文件中，I/O线程去请求主库的bin-log日志，并将日志写入到relay log中继日志中，此时主库会生成<strong><span style="color:#0d0016;">一个log dump线程</span></strong>，用来给从库I/O线程<span style="color:#0d0016;"><strong>传输bin-log日志文件</strong></span>。</li><li>从库会更新relay log文件中的操作，<span style="color:#0d0016;"><strong>将数据的改变在从库中进行数据重演即重新执行一次</strong></span>，即SQL线程执行操作，将日志文件中的记录变为数据操作行为再次执行，以达到主从数据最终一致性的目的。</li></ol> 
<p><img alt="" height="649" src="https://images2.imgbox.com/80/fe/vspisgn8_o.png" width="1200"></p> 
<h3 id="%E6%90%AD%E5%BB%BA%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6">搭建主从复制</h3> 
<ol><li>确保从数据库与主数据库里的数据一致</li><li>在主数据库里创建一个同步账户授权给从数据库使用</li><li>配置主数据库 (修改配置文件)</li><li>配置从数据库 (修改配置文件)</li><li>需求</li><li>搭建两台 MySQL 服务器一台作为从服务器，主服务器进行写操作，从服务器进行读操作一台作为主服务器</li></ol> 
<h4 id="%E7%8E%AF%E5%A2%83%E8%AF%B4%E6%98%8E%EF%BC%88%E4%BD%BF%E7%94%A8Docker%E5%90%AF%E5%8A%A8%E4%B8%A4%E4%B8%AA%EF%BC%89">环境说明（使用Docker启动两个）</h4> 
<p><img alt="" height="455" src="https://images2.imgbox.com/c9/0a/LS3t3LZ4_o.png" width="1200"></p> 
<pre><code class="language-XML">docker run --name M1 -p 3307:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 --lower_case_table_names=1

docker run --name M1S1 -p 3308:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 --lower_case_table_names=1</code></pre> 
<h4 id="%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" style="background-color:transparent;margin-left:.0001pt;text-align:justify;">修改配置文件</h4> 
<p style="margin-left:.0001pt;text-align:justify;">将容器里面的配置文件复制出来，主要修改服务器的配置；在root目录下创建一个mysqlms的目录存放从Docker容器里面复制过来的配置文件。进入目录：cd /mysqlms</p> 
<p class="img-center"><img alt="" height="102" src="https://images2.imgbox.com/f1/ad/weVYXB7w_o.png" width="419"></p> 
<pre><code class="language-XML">docker cp M1:/etc/mysql/conf.d/docker.cnf m1.cnf

docker cp M1S1:/etc/mysql/conf.d/docker.cnf m1s1.cnf</code></pre> 
<h2><img alt="" height="261" src="https://images2.imgbox.com/b1/8d/2ei9Apfv_o.png" width="1200"></h2> 
<h5 id="%E4%B8%BB%E6%9C%BA%E7%9A%84%E9%85%8D%E7%BD%AEm1.cnf" style="background-color:transparent;">主机的配置m1.cnf</h5> 
<p>主机里面要记录SQL 语句，以后从机会把该SQL 语句拷贝过去 </p> 
<p><img alt="" height="336" src="https://images2.imgbox.com/93/38/yEkTqUFn_o.png" width="720"></p> 
<pre><code class="language-XML">server-id=1
log-bin=master.bin</code></pre> 
<h5 id="%E4%BB%8E%E6%9C%BA%E7%9A%84%E9%85%8D%E7%BD%AEm1s1.cnf" style="background-color:transparent;">从机的配置m1s1.cnf</h5> 
<p><img alt="" height="188" src="https://images2.imgbox.com/a9/b2/lFvPaqLc_o.png" width="293"></p> 
<pre><code class="language-XML">server-id=2</code></pre> 
<h5 id="%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BF%AE%E6%94%B9%E5%90%8E%EF%BC%8C%E5%A4%8D%E5%88%B6%E5%88%B0%E5%AE%B9%E5%99%A8%E9%87%8C%E9%9D%A2%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0" style="background-color:transparent;">配置文件修改后，复制到容器里面     </h5> 
<pre><code class="language-XML">docker cp m1.cnf M1:/etc/mysql/conf.d/docker.cnf
docker cp m1s1.cnf M1S1:/etc/mysql/conf.d/docker.cnf</code></pre> 
<p><img alt="" height="87" src="https://images2.imgbox.com/82/69/8cr1Zsvo_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>重启</strong></strong><strong><strong>MySQL</strong></strong><strong><strong>（m1,m1s1）</strong></strong><strong><strong>：</strong></strong></p> 
<pre><code class="language-XML">docker restart M1 M1S1</code></pre> 
<p><img alt="" height="187" src="https://images2.imgbox.com/14/e5/TQ8FdZSs_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>测试连接</strong></strong><strong><strong>：</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="224" src="https://images2.imgbox.com/32/b5/BzQMCRUf_o.png" width="231"></p> 
<h4 id="%E6%89%A7%E8%A1%8CSQL%E8%AF%AD%E5%8F%A5">执行SQL语句</h4> 
<h5 id="%E8%BF%9B%E5%85%A5%E4%B8%BB%E6%9C%BA%E9%87%8C%E9%9D%A2%E6%89%A7%E8%A1%8C%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE">进入主机里面执行相关配置</h5> 
<pre><code class="language-XML">docker exec -it M1 bash
mysql -uroot -p123456</code></pre> 
<p><img alt="" height="709" src="https://images2.imgbox.com/6a/62/Eo5Cu197_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>创建用户</strong></strong><strong><strong>：</strong></strong></p> 
<pre><code class="language-XML">create user 'rep'@'%' identified by '123456';</code></pre> 
<p><img alt="" height="143" src="https://images2.imgbox.com/2d/0f/DpVCPeYB_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>给该用户授予权限：</strong></strong></p> 
<pre><code class="language-XML">grant replication slave on *.* to 'rep'@'%';</code></pre> 
<p><img alt="" height="167" src="https://images2.imgbox.com/61/31/tk6tAYy6_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>刷新权限</strong></strong><strong><strong>：</strong></strong></p> 
<pre><code class="language-XML">flush privileges;</code></pre> 
<p><img alt="" height="161" src="https://images2.imgbox.com/5b/97/KWzgLdsA_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;">至此，M1 里面已经创建了一个用户：rep 123456 拥有所有库，所有表replication slave。  </p> 
<p style="margin-left:.0001pt;text-align:justify;">接下来，我们尝试使用M1 里面的rep 用户登录：</p> 
<p><img alt="" height="581" src="https://images2.imgbox.com/2a/f3/bwBGMhAT_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="512" src="https://images2.imgbox.com/76/9e/4Y5qWHsM_o.png" width="433"></p> 
<h5 id="%E8%BF%9B%E5%85%A5%E4%BB%8E%E6%9C%BA%E9%87%8C%E9%9D%A2%E6%89%A7%E8%A1%8C%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE%C2%A0"><span style="color:#000080;">进入从机里面执行相关配置</span> </h5> 
<pre><code class="language-XML">docker exec -it M1S1 bash
mysql -u root -p123456</code></pre> 
<p><img alt="" height="697" src="https://images2.imgbox.com/85/4c/rlIYOYVX_o.png" width="1200"></p> 
<pre><code class="language-XML">change master to master_host="192.168.106.133",master_port=3307,master_user="rep",master_password="123456",master_log_file="master.000001",master_log_pos=745;</code></pre> 
<p>其中，master_log_file：该文件具体叫什么名称，需要从主机里面去看看。进入M1 里面使用root 用户登录M1，执行下面的SQL：<strong><strong>show master status;</strong></strong> </p> 
<p><img alt="" height="267" src="https://images2.imgbox.com/df/7e/flbVurAG_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>修改上面的SQL执行</strong></strong><strong><strong>：</strong></strong></p> 
<p><img alt="" height="53" src="https://images2.imgbox.com/27/f4/BHwUGYjZ_o.png" width="1108"></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>启动主从：（在M1S1里面执行）</strong></strong><strong><strong>：</strong></strong>start slave ;</p> 
<p><img alt="" height="124" src="https://images2.imgbox.com/70/ff/EyJr9IcW_o.png" width="856"></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>查询主从的状态（M1S1）</strong></strong><strong><strong>：</strong></strong>show slave status \G;</p> 
<p><img alt="" height="83" src="https://images2.imgbox.com/33/d0/uvQcGfJl_o.png" width="688"></p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>成功的标志：</strong></strong></p> 
<p><img alt="" height="190" src="https://images2.imgbox.com/f7/b4/QRvemzhW_o.png" width="973"></p> 
<h3 id="%E6%90%AD%E5%BB%BA%E5%A4%B1%E8%B4%A5%E7%9A%84%E5%8E%9F%E5%9B%A0" style="margin-left:.0001pt;text-align:justify;">搭建失败的原因</h3> 
<h4 id="%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%B8%8D%E6%98%AFyes%EF%BC%8C%E6%98%AFconnecting" style="margin-left:.0001pt;text-align:justify;"><span style="color:#000080;">第一个不是yes</span><span style="color:#000080;">，</span><span style="color:#000080;">是connecting</span></h4> 
<p style="margin-left:.0001pt;text-align:justify;">是因为从机使用你配置的主机信息没有登陆到主机里面！修改(从机里面)</p> 
<pre><code class="language-XML">stop slave;
change master to master_host="192.168.106.133",master_port=3307,master_user="rep",master_password="123456",master_log_file="master.000001",master_log_pos=745;
start slave;</code></pre> 
<h4 id="%E7%AC%AC%E4%BA%8C%E4%B8%AA%E4%B8%8D%E6%98%AFyes%EF%BC%8C%E6%98%AFno">第二个不是yes，是no</h4> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>原因是主机和从机里的数据不一致</strong></strong><strong><strong>：</strong></strong></p> 
<p><img alt="" height="208" src="https://images2.imgbox.com/a3/c8/4NHNQGPV_o.png" width="1107"></p> 
<p style="margin-left:.0001pt;text-align:justify;">从机会复制主机里面的SQL语句，来自己执行！实验时先把从机里面的db3 删除—&gt;再把主机里面的db3 删除-&gt;从机里面复制该删除的命令-&gt;从机执行删除的命令（db3），事务无法提交，将一直阻塞！</p> 
<p><img alt="" height="53" src="https://images2.imgbox.com/a9/36/ejx3MbTy_o.png" width="1107"></p> 
<p style="margin-left:.0001pt;text-align:justify;">现在从机里面要删除db3 ，但是没有db3，导致一直阻塞，以后的主从复制不会进行了。解决：在从机新建一个db3，然后停止主从，启动主从：</p> 
<p><img alt="" height="253" src="https://images2.imgbox.com/9f/42/D5vpM9S8_o.png" width="728"></p> 
<h4 id="%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%B8%8D%E6%98%AFyes%EF%BC%8C%E6%98%AFno">第一个不是yes，是no</h4> 
<p style="margin-left:.0001pt;text-align:justify;">就是你的server-id 没有配置成功的原因，需要重新修改配置文件，复制配置文件到容器里面，然后重启就ok</p> 
<h4 id="MySQL%E4%B8%BB%E4%BB%8E%E7%9A%84%E6%93%8D%E4%BD%9C%E8%A7%84%E8%8C%83">MySQL主从的操作规范</h4> 
<ul><li>只能在主机里面执行DML 语句，不能在从机里面执行DML语句（会破坏主从）</li><li>在从机里面可以执行查询语句</li><li>主机只有一台，但是从机可以有多台</li></ul> 
<h3 id="%E6%B5%8B%E8%AF%95">测试</h3> 
<p style="margin-left:.0001pt;text-align:justify;">在M1 里面创建数据库，看M1S1 有没有复制过去</p> 
<p><img alt="" height="382" src="https://images2.imgbox.com/6d/41/nBEgSaEU_o.png" width="166"></p> 
<hr> 
<h2 id="MyCAT2%E7%9A%84%E4%B8%BB%E4%BB%8E%E9%85%8D%E7%BD%AE">MyCAT2的主从配置</h2> 
<blockquote> 
 <p>前提，<span style="color:#0d0016;"><strong>先搭建好 MySQL的主从配置</strong></span>，登录 MyCAT 2在 MyCAT2 里面操作，也就是连接 8066 这个端口</p> 
</blockquote> 
<h3>创建数据源</h3> 
<pre><code class="language-XML">添加读写的数据源
/*+ mycat:createDataSource{
  "dbType":"mysql",
  "idleTimeout":60000,
  "initSqls":[],
  "initSqlsGetConnection":true,
  "instanceType":"READ_WRITE",
  "maxCon":1000,
  "maxConnectTimeout":3000,
  "maxRetryCount":5,
  "minCon":1,
  "name":"m1",
  "password":"123456",
  "type":"JDBC",
  "url":"jdbc:mysql://127.0.0.1:3307/db1?useUnicode=true&amp;serverTimezone=UTC&amp;characterEncoding=UTF-8",
  "user":"root",
  "weight":0
} */;</code></pre> 
<pre><code class="language-XML">添加读的数据源
/*+ mycat:createDataSource{
  "dbType":"mysql",
  "idleTimeout":60000,
  "initSqls":[],
  "initSqlsGetConnection":true,
  "instanceType":"READ",
  "maxCon":1000,
  "maxConnectTimeout":3000,
  "maxRetryCount":5,
  "minCon":1,
  "name":"m1s1",
  "password":"123456",
  "type":"JDBC",
  "url":"jdbc:mysql://127.0.0.1:3308/db1?useUnicode=true&amp;serverTimezone=UTC&amp;characterEncoding=UTF-8",
  "user":"root",
  "weight":0
} */;</code></pre> 
<h3 id="%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E6%BA%90">查询数据源</h3> 
<pre><code class="language-XML">/*+ mycat:showDataSources{} */</code></pre> 
<h3>创建集群</h3> 
<pre><code class="language-XML">/*! mycat:createCluster{
  "clusterType":"MASTER_SLAVE",
  "heartbeat":{
    "heartbeatTimeout":1000,
    "maxRetry":3,
    "minSwitchTimeInterval":300,
    "slaveThreshold":0
  },
  "masters":[
    "m1"
  ],
  "maxCon":2000,
  "name":"prototype",
  "readBalanceType":"BALANCE_ALL",
  "replicas":[
    "m1s1"
  ],	
  "switchType":"SWITCH"
} */;</code></pre> 
<h3 id="%E6%9F%A5%E8%AF%A2%E9%9B%86%E7%BE%A4">查询集群</h3> 
<pre><code class="language-XML">/*+ mycat:showClusters{} */</code></pre> 
<h3 id="%E5%88%9B%E5%BB%BA%E9%80%BB%E8%BE%91%E5%BA%93">创建逻辑库</h3> 
<pre><code class="language-XML">CREATE DATABASE db1 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;</code></pre> 
<h3 id="%E4%BF%AE%E6%94%B9%E9%80%BB%E8%BE%91%E5%BA%93%E7%9A%84%E6%95%B0%E6%8D%AE%E6%BA%90" style="margin-left:.0001pt;text-align:justify;">修改逻辑库的数据源</h3> 
<pre><code class="language-XML">修改conf/schemas/db1.schema.json
vim /data/mycat/conf/schemas/db1.schema.json
在里面添加  
"targetName":"prototype",</code></pre> 
<h3 id="%E6%9F%A5%E7%9C%8B%E9%9B%86%E7%BE%A4%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" style="margin-left:.0001pt;text-align:justify;">查看集群的配置文件</h3> 
<p style="margin-left:.0001pt;text-align:justify;">我们查看集群配置的结果，发现文件里面自动帮我们添加了。</p> 
<h3 id="%E6%B5%8B%E8%AF%95%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F(%E5%9C%A8MyCAT%E9%87%8C%E9%9D%A2%E6%B5%8B%E8%AF%95)">测试读写分离是否成功(在MyCAT里面测试)</h3> 
<p style="margin-left:.0001pt;text-align:justify;">重启MyCAT：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="121" src="https://images2.imgbox.com/9b/53/scOhlCuE_o.png" width="1200"></p> 
<p><strong>在MyCAT里面创建一个sys_user表：</strong></p> 
<pre><code class="language-XML">CREATE TABLE SYS_USER(
    ID BIGINT PRIMARY KEY,
    USERNAME VARCHAR(200) NOT NULL,
    ADDRESS  VARCHAR(500)
)</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>通过注释生成物理库和物理表</strong></strong><strong><strong>：</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">如果物理表不存在，在 MyCAT2 能正常启动的情况下，根据当前配置自动创建分片表，全局表和物理表：</p> 
<pre><code class="language-XML">/*+ mycat:repairPhysicalTable{} */;</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>查看后端物理库</strong></strong><strong><strong>：</strong></strong>发现物理库和物理表都生成了。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>在</strong></strong><strong><strong>M</strong></strong><strong><strong>y</strong></strong><strong><strong>CAT</strong></strong><strong><strong>里面向sys_user表添加一条数据</strong></strong><strong><strong>：</strong></strong><strong> </strong></p> 
<pre><code class="language-XML">INSERT INTO SYS_USER(ID,USERNAME,ADDRESS) VALUES(1,"XIAOMING","WUHAN");</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>修改</strong></strong><strong><strong>MySQL</strong></strong><strong><strong>里面的让数据不一样</strong></strong><strong><strong>：</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="109" src="https://images2.imgbox.com/2f/eb/vAC3Zfj8_o.png" width="473"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="86" src="https://images2.imgbox.com/24/19/3kZcSMSg_o.png" width="466"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>在</strong></strong><strong><strong>M</strong></strong><strong><strong>y</strong></strong><strong><strong>CAT</strong></strong><strong><strong>里面查询数据，会发现每次查询的结果不一样</strong></strong><strong><strong>：</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="145" src="https://images2.imgbox.com/a3/07/AW8Az9hm_o.png" width="473"></p> 
<p style="margin-left:.0001pt;text-align:center;"><strong><strong>到此</strong></strong><strong><strong>，</strong></strong><strong><strong>我们使用</strong></strong><strong><strong>M</strong></strong><strong><strong>y</strong></strong><strong><strong>CAT2</strong></strong><strong><strong>主从搭建就完成了</strong></strong><strong><strong>。</strong></strong></p> 
<hr> 
<h2 id="MySQL%20%E7%9A%84%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%EF%BC%88%E5%8F%8C%E4%B8%BB%E5%8F%8C%E9%87%8D%EF%BC%89">MySQL 的集群搭建（双主双重）</h2> 
<h3 id="%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E6%A6%82%E8%BF%B0%C2%A0">集群搭建概述 </h3> 
<p>        集群(Cluster)是一种较新的技术，通过集群技术，可以在付出较低成本的情况下，获得在性能、可靠性、灵活性方面的相对较高的收益，其<span style="color:#0d0016;"><strong>任务调度</strong></span>则是集群系统中的核心技术<br>         MySQL 集群技术在分布式系统中为 MySQL 数据提供了几余特性，增强了安全性，<span style="color:#0d0016;"><strong>使得单 MSQL 服务器故障不会对系统产生巨大的负面效应，系统的稳定性得到保障</strong></span>。</p> 
<p class="img-center"><img alt="" height="311" src="https://images2.imgbox.com/21/ac/wzk4PtMr_o.png" width="558"></p> 
<blockquote> 
 <p>在MySQL集群中，节点之间的数据是<span style="color:#0d0016;"><strong>实时同步</strong></span>的。</p> 
 <p>MySQL集群通过使用同步复制机制来确保数据在各个节点之间的一致性。当在主节点上进行写操作时，这些写操作会立即被复制到其他节点。因此，所有节点上的数据都是同步的，可以保持一致性。</p> 
</blockquote> 
<h4 id="%E4%BC%98%E7%82%B9">优点</h4> 
<ul><li><strong>高可伸缩性：</strong>服务器集群具有很强的可伸缩性，随着需求和负荷的增长，<strong>可以向集群系统添加更多的服务器</strong>，在这样的配置中，可以有多台服务器执行相同的应用和数据库操作。</li><li><strong>高可用性：</strong>在不需要操作者干预的情况下，防止系统发生故障或从故障中自动恢复的能力。通过把故障服务器上的应用程序转移到备份服务器上运行，<strong>集群系统能够把正常运行时间提高到大于 99.9%，大大减少服务器和应用程序的停机时间</strong>。</li></ul> 
<h4 id="%E7%BC%BA%E7%82%B9">缺点</h4> 
<ul><li> <p><span style="color:#0d0016;"><strong>数据一致性：</strong></span>由于MySQL集群是分布式的，数据同步和一致性是一个挑战。在极端情况下，例如网络故障或节点故障，可能会导致<span style="color:#0d0016;"><strong>数据不一致</strong></span>的情况发生，需要通过其他机制来处理这种情况。</p> </li><li> <p><span style="color:#0d0016;"><strong>性能损耗：</strong></span>MySQL集群需要进行<span style="color:#0d0016;"><strong>数据分片和数据同步</strong></span>，这可能会对性能产生一定的损耗。特别是在高并发的情况下，<span style="color:#0d0016;"><strong>数据同步的延迟可能会导致读写操作的延迟</strong></span>。</p> </li></ul> 
<h3 id="%E6%90%AD%E5%BB%BA%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">搭建准备工作</h3> 
<h4 id="%E4%BD%BF%E7%94%A8Docker%E5%90%AF%E5%8A%A85%E5%8F%B0MySQL%EF%BC%88%E8%87%B3%E5%B0%91%E8%A6%815%E5%8F%B0%EF%BC%89" style="margin-left:.0001pt;text-align:justify;"><span style="color:#000080;">使用</span><span style="color:#000080;">D</span><span style="color:#000080;">ocker启动5台My</span><span style="color:#000080;">SQL</span><span style="color:#000080;">（</span><span style="color:#000080;">至少要5台</span><span style="color:#000080;">）</span></h4> 
<p><img alt="" height="391" src="https://images2.imgbox.com/65/99/m3Wv6iN4_o.png" width="1200"></p> 
<p>前面主从已启动了两个，所以只用启动三个就够了</p> 
<pre><code class="language-XML">docker run --name M1 -p 3307:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 --lower_case_table_names=1
docker run --name M1S1 -p 3308:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 --lower_case_table_names=1
docker run --name M1S2 -p 3309:3306 -e MYSQL_ROOT_PASSWORD=123456  -d mysql:5.7 --lower_case_table_names=1
docker run --name M2 -p 3310:3306 -e MYSQL_ROOT_PASSWORD=123456  -d mysql:5.7 --lower_case_table_names=1
docker run --name M2S1 -p 3311:3306 -e MYSQL_ROOT_PASSWORD=123456  -d mysql:5.7 --lower_case_table_names=1</code></pre> 
<p><img alt="" height="98" src="https://images2.imgbox.com/aa/2e/KWSKkLj3_o.png" width="1108"></p> 
<h4 id="%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E4%BF%AE%E6%94%B9"><span style="color:#000080;">配置文件的修改</span></h4> 
<p><strong><strong>先准备5 个配置文件</strong></strong><strong><strong>：</strong></strong></p> 
<p><img alt="" height="348" src="https://images2.imgbox.com/4a/a7/A6jUHhXf_o.png" width="1108"></p> 
<p style="margin-left:.0001pt;text-align:justify;">分别修改。</p> 
<p style="margin-left:.0001pt;text-align:justify;">1）因为在上面的主从里面已有两个配置文件，所以只用创建三个就够了：m1s2.cnf、m2.cnf、m2s1.cnf</p> 
<p style="margin-left:.0001pt;text-align:justify;">2）M2 需要添加一个配置项(具体配置看下面截图)</p> 
<p style="margin-left:.0001pt;text-align:justify;">3）M2 会从M1 复制数据，但是M2 从M1复制的数据，不会记录下来，则M2S1 里面没有数据！</p> 
<p style="margin-left:.0001pt;text-align:justify;">4）我们需要打开M2的级联复制功能，让M2 也能记录从M1 里面复制的数据。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>最后结果</strong></strong><strong><strong>如下</strong></strong><strong><strong>：</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="327" src="https://images2.imgbox.com/25/23/EzRxZUBN_o.png" width="457"></p> 
<p style="margin-left:.0001pt;text-align:justify;">配置文件修改好了后，复制到容器里面，并且重启容器！</p> 
<pre><code class="language-XML">#docker cp m1.cnf M1:/etc/mysql/conf.d/docker.cnf
#docker cp m1s1.cnf M1S1:/etc/mysql/conf.d/docker.cnf
docker cp m1s2.cnf M1S2:/etc/mysql/conf.d/docker.cnf
docker cp m2.cnf M2:/etc/mysql/conf.d/docker.cnf
docker cp m2s1.cnf M2S1:/etc/mysql/conf.d/docker.cnf</code></pre> 
<h4 id="%C2%A0%E9%87%8D%E5%90%AF%E6%96%B0%E5%BB%BA%E7%9A%84%E4%B8%89%E4%B8%AA%E5%AE%B9%E5%99%A8"> 重启新建的三个容器</h4> 
<pre><code class="language-XML">docker restart M1S2 M2 M2S1</code></pre> 
<p><img alt="" height="177" src="https://images2.imgbox.com/56/7d/YZUd3W5H_o.png" width="184"></p> 
<h3 id="%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8%E6%89%A7%E8%A1%8CSQL">进入容器执行SQL</h3> 
<p style="margin-left:.0001pt;text-align:justify;">在搭建MySQL的集群时，先清空所有机器里面的数据。</p> 
<p style="margin-left:.0001pt;text-align:justify;">现在有数据的是：M1 M1S1，只需要清空M1的数据，就都没有了。</p> 
<p style="margin-left:.0001pt;text-align:justify;">将之前新建的db1删除就ok。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="199" src="https://images2.imgbox.com/d1/9d/ETOSIheO_o.png" width="235"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#a52a00;"><strong>4.1，M1修改</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">因为前面搭建好了，所有不用修改</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#a52a00;"><strong>4.2，M1S1修改</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">同理上面的4.1</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#a52a00;"><strong>4.3，M1S2修改（从机）</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">给它设置一个主机就ok</p> 
<pre><code class="language-XML">docker exec -it M1S2 bash
mysql -uroot -p123456</code></pre> 
<p><img alt="" height="398" src="https://images2.imgbox.com/96/89/4Aj9m8jG_o.png" width="1108"></p> 
<p><strong><strong>关联主机</strong></strong><strong><strong>：</strong></strong> </p> 
<pre><code class="language-XML">change master to master_host="192.168.106.133",master_port=3307,master_user="rep",master_password="123456",master_log_file="master.000001",master_log_pos=3574;</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>启动主从</strong></strong><strong><strong>：</strong></strong>start slave ;</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>查看状态</strong></strong><strong><strong>：</strong></strong>show slave status \G;</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="467" src="https://images2.imgbox.com/20/80/vlIO7ti9_o.png" width="1108"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#a52a00;"><strong>4.4，M2修改</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">进入M2使用Root登录</p> 
<pre><code class="language-XML">docker exec -it M2 bash

mysql -uroot -p123456</code></pre> 
<ol><li style="text-align:justify;"><strong><strong>新建用户</strong></strong><strong><strong>：</strong></strong>create user 'rep1'@'%' identified by '123456';</li><li style="text-align:justify;"><strong><strong>给用户授权</strong></strong><strong><strong>：</strong></strong>grant replication slave on *.* to 'rep1'@'%';</li><li style="text-align:justify;"><strong><strong>刷新权限</strong></strong><strong><strong>：</strong></strong>flush privileges;</li><li style="text-align:justify;"><strong><strong>使用新的用户尝试登录</strong></strong><strong><strong>：</strong></strong></li></ol> 
<p><img alt="" height="294" src="https://images2.imgbox.com/6a/c9/JI9hwtxq_o.png" width="802"></p> 
<p><img alt="" height="610" src="https://images2.imgbox.com/ae/b3/DGL4rDBP_o.png" width="534"> </p> 
<p style="margin-left:.0001pt;text-align:justify;">M2 作为M1的从机需要执行的SQL：（登录M2时要使用root用户）</p> 
<pre><code class="language-XML">change master to master_host="192.168.106.133",master_port=3307,master_user="rep",master_password="123456",master_log_file="master.000001",master_log_pos=3574;</code></pre> 
<pre><code class="language-XML">start slave ;
show slave status \G;</code></pre> 
<p><img alt="" height="352" src="https://images2.imgbox.com/81/83/lXSSsn5t_o.png" width="833"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#a52a00;"><strong>4.5，M2S1修改</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">进入容器</p> 
<pre><code class="language-XML">docker exec -it M2S1 bash
mysql -uroot -p123456</code></pre> 
<p><img alt="" height="439" src="https://images2.imgbox.com/25/33/eRweoVCG_o.png" width="1108"></p> 
<p style="margin-left:.0001pt;text-align:justify;">M2S1 是M2的从机，执行的SQL</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>进入M2查看pos</strong></strong><strong><strong>：</strong></strong>show master status;</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="192" src="https://images2.imgbox.com/3d/50/tGOozNci_o.png" width="1108"></p> 
<p><strong><strong>在M2S1里面执行下面的命令</strong></strong><strong><strong>：</strong></strong> </p> 
<pre><code class="language-XML">change master to master_host="192.168.106.133",master_port=3310,master_user="rep1",master_password="123456",master_log_file="master.000001",master_log_pos=747;</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>启动主从</strong></strong><strong><strong>：</strong></strong>start slave ;</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="71" src="https://images2.imgbox.com/04/38/Y0FwWEnO_o.png" width="1108"></p> 
<p>show slave status \G;</p> 
<p><img alt="" height="473" src="https://images2.imgbox.com/f1/66/yJPGsI1U_o.png" width="1108"></p> 
<h3 id="%E9%AA%8C%E8%AF%81%E9%9B%86%E7%BE%A4%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F">验证集群是否成功</h3> 
<p>使用工具连接上所有的MySQL </p> 
<p><img alt="" height="401" src="https://images2.imgbox.com/17/c4/8duPBNCI_o.png" width="211"><img alt="" height="409" src="https://images2.imgbox.com/61/6b/sZqchlBr_o.png" width="165"></p> 
<p style="margin-left:.0001pt;text-align:justify;">1）往M1 写数据，看 M2S1</p> 
<p style="margin-left:.0001pt;text-align:justify;">2）在M1 新建数据库</p> 
<p style="margin-left:.0001pt;text-align:justify;">3）观察M2S1</p> 
<p style="margin-left:.0001pt;text-align:justify;">4）往M1 写数据，看M1S1</p> 
<hr> 
<h2 id="MyCAT2%E6%93%8D%E4%BD%9C%E5%8F%8C%E4%B8%BB%E5%8F%8C%E4%BB%8E">MyCAT2操作双主双从</h2> 
<p style="margin-left:.0001pt;text-align:center;"><strong><strong>目的：在</strong></strong><strong><strong>MyCAT</strong></strong><strong><strong>中集群配置实现双主双从</strong></strong><strong><strong>。</strong></strong></p> 
<h3 id="%E8%A7%92%E8%89%B2%E8%AF%B4%E6%98%8E" style="margin-left:.0001pt;"><strong><strong>角色说明</strong></strong></h3> 
<p></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">M1 主机</p> 
 <p style="margin-left:.0001pt;text-align:justify;">M1S1 是M1的从机</p> 
 <p style="margin-left:.0001pt;text-align:justify;">M1S2 是M1的从机</p> 
 <p style="margin-left:.0001pt;text-align:justify;">M2 主机</p> 
 <p style="margin-left:.0001pt;text-align:justify;">M2S1 是M2的从机</p> 
</blockquote> 
<h3 id="%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E6%BA%90%C2%A0">添加数据源 </h3> 
<pre><code class="language-XML">添加M1S2读的数据源
/*+ mycat:createDataSource{
  "dbType":"mysql",
  "idleTimeout":60000,
  "initSqls":[],
  "initSqlsGetConnection":true,
  "instanceType":"READ",
  "maxCon":1000,
  "maxConnectTimeout":3000,
  "maxRetryCount":5,
  "minCon":1,
  "name":"m1s2",
  "password":"123456",
  "type":"JDBC",
  "url":"jdbc:mysql://127.0.0.1:3309?useUnicode=true&amp;serverTimezone=UTC&amp;characterEncoding=UTF-8",
  "user":"root",
  "weight":0
} */;
添加M2的数据源
/*+ mycat:createDataSource{
  "dbType":"mysql",
  "idleTimeout":60000,
  "initSqls":[],
  "initSqlsGetConnection":true,
  "instanceType":"READ_WRITE",
  "maxCon":1000,
  "maxConnectTimeout":3000,
  "maxRetryCount":5,
  "minCon":1,
  "name":"m2",
  "password":"123456",
  "type":"JDBC",
  "url":"jdbc:mysql://127.0.0.1:3310?useUnicode=true&amp;serverTimezone=UTC&amp;characterEncoding=UTF-8",
  "user":"root",
  "weight":0
} */;
添加M2S1的数据源
/*+ mycat:createDataSource{
  "dbType":"mysql",
  "idleTimeout":60000,
  "initSqls":[],
  "initSqlsGetConnection":true,
  "instanceType":"READ",
  "maxCon":1000,
  "maxConnectTimeout":3000,
  "maxRetryCount":5,
  "minCon":1,
  "name":"m2s1",
  "password":"123456",
  "type":"JDBC",
  "url":"jdbc:mysql://127.0.0.1:3311?useUnicode=true&amp;serverTimezone=UTC&amp;characterEncoding=UTF-8",
  "user":"root",
  "weight":0
} */;</code></pre> 
<h3 id="%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E9%9B%86%E7%BE%A4">修改配置集群</h3> 
<p style="margin-left:.0001pt;text-align:justify;">因为我们现在后端的MySQL集群结构发生了变化，现在修改集群的配置<strong><strong>【只是修改】</strong></strong></p> 
<pre><code class="language-XML">{
	"clusterType":"MASTER_SLAVE",
	"heartbeat":{
		"heartbeatTimeout":1000,
		"maxRetryCount":0,
		"minSwitchTimeInterval":300,
		"showLog":true,
		"slaveThreshold":0.0
	},
	"masters":[
		"m1","m2"
	],
	"maxCon":2000,
	"name":"prototype",
	"readBalanceType":"BALANCE_ALL",
	"replicas":[
		"m1s1","m1s2","m2s1"
	],
	"switchType":"SWITCH"
}</code></pre> 
<h3 id="%E9%87%8D%E5%90%AFMyCAT%E6%B5%8B%E8%AF%95">重启MyCAT测试</h3> 
<h4 id="%E9%87%8D%E5%90%AFMyCAT">重启MyCAT</h4> 
<pre><code class="language-XML">cd /data/mycat/bin
./mycat restart	</code></pre> 
<h4 id="%E5%BC%80%E5%A7%8B%E6%B5%8B%E8%AF%95">开始测试</h4> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>在</strong></strong><strong><strong>MyCAT</strong></strong><strong><strong>创建db1库</strong></strong><strong><strong>：</strong></strong></p> 
<pre><code class="language-XML">CREATE DATABASE db1 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>在</strong></strong><strong><strong>MyCAT</strong></strong><strong><strong>创建表</strong></strong><strong><strong>：</strong></strong></p> 
<pre><code class="language-XML">create table sys_user(
    id bigint primary key,
    username varchar(200) not null,
    address  varchar(500)
)</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>刷新逻辑表到物理库</strong></strong></p> 
<pre><code class="language-XML">/*+ mycat:repairPhysicalTable{} */;</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">刷新完成之后我们可以在后台的MySQL里面看到数据表已创建完成。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>在</strong></strong><strong><strong>MyCAT</strong></strong><strong><strong>里面添加数据</strong></strong><strong><strong>：</strong></strong></p> 
<pre><code class="language-XML">insert INTO sys_user(id,username,address) values(1,"xiaofang","wuhan");</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">完成之后刷新后端MySQL物理库，我们发现有数据了。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>在</strong></strong><strong><strong>MyCAT</strong></strong><strong><strong>里查询测试</strong></strong><strong><strong>：</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">修改上面5个MySQL数据库中db1库中sys_user表里面的数据，让它不一样，再在MyCAT里面执行查询 结果如下:</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="153" src="https://images2.imgbox.com/fe/5d/tNw0iDzw_o.png" width="432"></p> 
<hr> 
<h2 id="MyCAT2%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8" style="margin-left:.0001pt;text-align:justify;">MyCAT2分库分表</h2> 
<h3 id="h_605884141_0">什么是分库分表？</h3> 
<h4 id="h_605884141_1">分库</h4> 
<p>分库是指在表数量不变的情况下对库进行切分。</p> 
<p>举例：如下图，数据库A 中存放了 user 和 order 两张表，将两张表切分到两个数据库中，user表放到 database A，order表放到 database B。</p> 
<p class="img-center"><img alt="" height="250" src="https://images2.imgbox.com/d8/20/ASyFXPnW_o.png" width="413"></p> 
<h4 id="h_605884141_2">分表</h4> 
<p>分表是指在库数量不变的情况下对表进行切分。</p> 
<p>举例：如下图，数据库 A 中存放了 user表，将 user表切分成 user1 和 user2 两张表并放到 database A中。</p> 
<p class="img-center"><img alt="" height="158" src="https://images2.imgbox.com/76/a1/AzH74fvM_o.png" width="577"></p> 
<h4 id="h_605884141_3">分库分表</h4> 
<p>分库分表是指库和表都切分，数量都发生变化。</p> 
<p>举例：如下图，数据库 A 中存放了 user表，将 user表切分成 user1、user2、user3、user4 四张表，user1 和 user2 放到 database A中，user3 和 user4 放到 database B 中。</p> 
<p class="img-center"><img alt="" height="255" src="https://images2.imgbox.com/a2/9c/xZuRRpli_o.png" width="425"></p> 
<hr> 
<h3 id="%E5%A6%82%E4%BD%95%E5%88%87%E5%88%86%E5%BA%93%E5%92%8C%E8%A1%A8%EF%BC%9F">如何切分库和表？</h3> 
<p style="text-align:center;"><span style="color:#0d0016;"><strong>主流的切分方式有 3种：水平切分、垂直切分和混合切分</strong></span></p> 
<h4 id="h_605884141_5">水平切分</h4> 
<p style="text-align:center;"><span style="color:#0d0016;"><strong>水平切分包含水平分库和水平分表。</strong></span></p> 
<p><strong>水平分表</strong></p> 
<p>水平分表指的表结构不变，将单表数据切分成多表。切分后的结果：</p> 
<ul><li>每个表的结构一样；</li><li>每个表的数据不一样；</li><li>所有表的数据并集为全量数据；</li></ul> 
<p>切分抽象图如下：</p> 
<p></p> 
<p class="img-center"><img alt="" height="289" src="https://images2.imgbox.com/13/9b/zaj7Qcqc_o.png" width="428"></p> 
<p>举例：如下图，order表，按照 oder_id 的数据范围水平切分后变成了 order1 和 order2 表，两个表的结构一样，数据不同。</p> 
<p></p> 
<p class="img-center"><img alt="" height="256" src="https://images2.imgbox.com/b0/d8/6hnvUyJj_o.png" width="622"></p> 
<p><strong>2.1.2 水平分库</strong></p> 
<p>水平分库是指，将表水平切分后分到不同的数据库，使得每个库具有相同的表，表中的数据不相同，水平分库一般是伴随水平分表。</p> 
<p>举例：如下图，order 表，水平切分后，分到 database A 和 database B 中，这样原来一个库就被拆分成 2个库。</p> 
<p></p> 
<p class="img-center"><img alt="" height="290" src="https://images2.imgbox.com/68/b4/Ywo2GNBU_o.png" width="510"></p> 
<h4 id="h_605884141_6">垂直切分</h4> 
<p style="text-align:center;"><span style="color:#0d0016;"><strong>垂直切分包含垂直分库和垂直分表。</strong></span></p> 
<p><strong>垂直分表</strong></p> 
<p>垂直分表指将存在一张表中的字段切分到多张表。切分后的结果：</p> 
<ul><li>每个表的结构不一样；</li><li>每个表的数据不一样；</li><li>所有表的字段并集是原表的字段；</li></ul> 
<p>切分抽象图如下：</p> 
<p></p> 
<p class="img-center"><img alt="" height="273" src="https://images2.imgbox.com/b2/b9/Q17J8xcX_o.png" width="479"></p> 
<p>举例：如下图，order 表，根据字段垂直切分，切分后 order_base表包含一部分字段的数据 和 order_info表包含另一部分字段的数据。</p> 
<p></p> 
<p class="img-center"><img alt="" height="341" src="https://images2.imgbox.com/98/c8/nM4nkcOp_o.png" width="588"></p> 
<p><strong>垂直分库</strong></p> 
<p>垂直分库指的是，将单个库中的表分到多个库，每个库包含的表不一样。</p> 
<p>举例：如下图，database A 中的 order 表 和 user表，垂直分库为 database A 包含 order表，database B 包含 user 表。</p> 
<p></p> 
<p class="img-center"><img alt="" height="271" src="https://images2.imgbox.com/2a/8b/3euuDOx3_o.png" width="502"></p> 
<hr> 
<h4 id="%E6%B7%B7%E5%90%88%E5%88%87%E5%88%86">混合切分</h4> 
<p>混合切分其实就是水平切分和垂直切分的组合，切分抽象图如下：</p> 
<p></p> 
<p class="img-center"><img alt="" height="217" src="https://images2.imgbox.com/60/b8/eblCu6mc_o.png" width="537"></p> 
<p>举例：如下图，order表，按照 oder_id数据范围做了水平切分，并且按照表字段做了垂直切分。</p> 
<p></p> 
<p class="img-center"><img alt="" height="279" src="https://images2.imgbox.com/8c/fc/sCDiKhZT_o.png" width="651"></p> 
<p><strong>说明： 上面的举例只是为了更好的展示如何切分，并不包含真实业务内容。</strong></p> 
<hr> 
<h3 id="%E5%88%87%E5%88%86%E7%AD%96%E7%95%A5">切分策略</h3> 
<p style="text-align:center;"><span style="color:#0d0016;"><strong>主流的切分策略有3种：Range 范围、hash切分、映射表。</strong></span></p> 
<blockquote> 
 <p><strong>分库分表的依据--分库分表字段的选择</strong> </p> 
 <p>    <a href="https://so.csdn.net/so/search?q=%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8&amp;spm=1001.2101.3001.7020" title="分库分表">分库分表</a>首先要确定根据哪个字段、或者哪几个字段进行路由，一般的原则<strong>是按使用频率最高维度的字段去分库分表，尽量保证高使用维度下只查询单表</strong>。 </p> 
</blockquote> 
<hr> 
<h4 id="h_605884141_16">Range 范围</h4> 
<p>Range 范围是指按某个字段的数据区间来进行切分。</p> 
<p>比如：user表按照 user_id 的数据范围切分成多张表，每 1000万条数据存放一张表，切分后的表可以放到同一个数据库，也可以放到不同的数据库，示例图如下：</p> 
<p></p> 
<p class="img-center"><img alt="" height="338" src="https://images2.imgbox.com/36/76/1fOCvNgm_o.png" width="1121"></p> 
<p><strong>优点</strong></p> 
<ul><li>方便扩容，每次数据量达到 range值就新加一张表，可以通过代码实现自动化扩容；</li></ul> 
<p><strong>缺点</strong></p> 
<ul><li>存在写偏移，可能有热点问题；</li></ul> 
<blockquote> 
 <p><strong>举例</strong> 比如用户注册场景：user表，因为新注册的用户数据都是写新表，通常来说新用户的活跃度高，所以读写流量全部集中在最新的 user表，因此，新表可能存在热点问题。</p> 
</blockquote> 
<hr> 
<h4 id="h_605884141_17">Hash切分</h4> 
<p>通过对分表键 key 进行一定的运算（通常有取余、取模运算，比如：key % m，key / m，hash(key)/m 等等），通过运算结果来决定路由的库和表。目前大多数互联网公司主要采用该方法。</p> 
<p><strong>优点</strong></p> 
<ul><li>数据分片比较均匀，大大降低热点问题；</li></ul> 
<p><strong>缺点</strong></p> 
<ul><li>hash 算法选择不合理，后期扩容可能需要迁移数据；</li><li>数据被切分到不同的库和表中，可能存在跨节点查询和分页等问题；</li></ul> 
<blockquote> 
 <p><strong>举例</strong></p> 
 <p>比如：user表信息，根据 user_id 对 10 取余，这样就可以通过 user_id 尾号 hash 到 user_0 到 user_9 10张表中：</p> 
 <p></p> 
 <p class="img-center"><img alt="" height="209" src="https://images2.imgbox.com/4c/6b/QfQfKqSi_o.png" width="485"></p> 
</blockquote> 
<hr> 
<h4 id="h_605884141_18" style="background-color:transparent;">映射表</h4> 
<p>映射表其实是 Range范围 和 hash切分的混合模式，将分表键和数据库的映射关系记录在一个单独的表（表的形式可以是 数据库表，文件或者配置中心）。</p> 
<p><strong>优点</strong></p> 
<ul><li>可以灵活设置路由规则；</li></ul> 
<p><strong>缺点：</strong></p> 
<ul><li>方案比较复杂；</li><li>映射表可能也会随着业务量的增大，同样需要分库分表，带来更多的问题；</li></ul> 
<blockquote> 
 <p><strong>举例</strong></p> 
 <p>某社区电商下单场景，因为全国仓库的数量有限，所以分库直接使用了仓编编码-数据库映射表（后期新增加仓库，只要在表中增加映射关系），为了保证履约的时效性，用户下单时，商城端会选择最近的仓库，服务器在映射表中根据仓库编码查询并路由到对应的数据库，最后在库中进行 order表的操作，交互如下图：</p> 
 <p></p> 
 <p class="img-center"><img alt="" height="380" src="https://images2.imgbox.com/f1/76/8rWdvMWc_o.png" width="606"></p> 
 <p></p> 
</blockquote> 
<hr> 
<h3 id="%E5%88%86%E7%89%87%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>分片算法简介</strong></span></strong></strong></span></h3> 
<h4 id="%E5%8F%96%E6%A8%A1%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87%20MOD_HASH" style="text-align:justify;"><span style="color:#70ad47;"><strong><strong><span style="color:#000080;"><strong>取模哈希分片 MOD_HASH</strong></span></strong></strong></span></h4> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">1）如果分片值是字符串则先对字符串进行Hash转换为数值类型</p> 
 <p style="margin-left:.0001pt;text-align:justify;">2）分库键和分表键是同键</p> 
 <p style="margin-left:.0001pt;text-align:justify;">3）分表下标=分片值%(分库数量*分表数量)</p> 
 <p style="margin-left:.0001pt;text-align:justify;">4）分库下标=分表下标/分表数量</p> 
 <p style="margin-left:.0001pt;text-align:justify;">5）分库键和分表键是不同键</p> 
 <p style="margin-left:.0001pt;text-align:justify;">6）分表下标= 分片值%分表数量</p> 
 <p style="margin-left:.0001pt;text-align:justify;">7）分库下标= 分片值%分库数量</p> 
</blockquote> 
<table cellspacing="0"><tbody><tr><td style="background-color:#f1f1f1;width:464.4pt;"> <p style="margin-left:.0001pt;text-align:justify;">create table travelrecord (</p> <p style="margin-left:.0001pt;text-align:justify;"> ....</p> <p style="margin-left:.0001pt;text-align:justify;">) ENGINE=InnoDB DEFAULT CHARSET=utf8</p> <p style="margin-left:.0001pt;text-align:justify;">dbpartition by MOD_HASH (id) dbpartitions 6</p> <p style="margin-left:.0001pt;text-align:justify;">tbpartition by MOD_HASH (id) tbpartitions 6;</p> </td></tr></tbody></table> 
<h4 id="%E8%8C%83%E5%9B%B4%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87%20RANGE_HASH" style="text-align:justify;"><span style="color:#70ad47;"><strong><strong><span style="color:#000080;"><strong>范围哈希分片 RANGE_HASH</strong></span></strong></strong></span></h4> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">1）RANGE_HASH(字段1, 字段2, 截取开始下标)</p> 
 <p style="margin-left:.0001pt;text-align:justify;">2）仅支持数值类型，字符串类型</p> 
 <p style="margin-left:.0001pt;text-align:justify;">3）当时字符串类型时候，第三个参数生效</p> 
 <p style="margin-left:.0001pt;text-align:justify;">4）计算时候优先选择第一个字段,找不到选择第二个字段</p> 
 <p style="margin-left:.0001pt;text-align:justify;">5）如果是字符串则根据下标截取其后部分字符串，然后该字符串hash成数值</p> 
 <p style="margin-left:.0001pt;text-align:justify;">6）根据数值按分片数取余</p> 
 <p style="margin-left:.0001pt;text-align:justify;">7）要求截取下标不能少于实际值的长度</p> 
 <p style="margin-left:.0001pt;text-align:justify;">8）两个字段的数值类型要求一致</p> 
</blockquote> 
<table cellspacing="0" style="margin-left:8.3pt;"><tbody><tr><td style="background-color:#f1f1f1;width:456.1pt;"> <p style="margin-left:.0001pt;text-align:justify;">create table travelrecord(</p> <p style="margin-left:.0001pt;text-align:justify;">...</p> <p style="margin-left:.0001pt;text-align:justify;">)ENGINE=InnoDB DEFAULT CHARSET=utf8</p> <p style="margin-left:.0001pt;text-align:justify;">dbpartition by RANGE_HASH(id,user_id,3) dbpartitions 3</p> <p style="margin-left:.0001pt;text-align:justify;">tbpartition by RANGE_HASH(id,user_id,3) tbpartitions 3;</p> </td></tr></tbody></table> 
<h4 id="%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87%20UNI_HASH" style="text-align:justify;"><span style="color:#70ad47;"><strong><strong><span style="color:#000080;"><strong>字符串哈希分片 UNI_HASH</strong></span></strong></strong></span></h4> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">1）如果分片值是字符串则先对字符串进行hash转换为数值类型</p> 
 <p style="margin-left:.0001pt;text-align:justify;">2）分库键和分表键是同键</p> 
 <p style="margin-left:.0001pt;text-align:justify;">3）分库下标=分片值%分库数量</p> 
 <p style="margin-left:.0001pt;text-align:justify;">4）分表下标=(分片值%分库数量)*分表数量+(分片值/分库数量)%分表数量</p> 
 <p style="margin-left:.0001pt;text-align:justify;">5）分库键和分表键是不同键</p> 
 <p style="margin-left:.0001pt;text-align:justify;">6）分表下标= 分片值%分表数量</p> 
 <p style="margin-left:.0001pt;text-align:justify;">7）分库下标=分片值%分库数量</p> 
</blockquote> 
<table cellspacing="0"><tbody><tr><td style="background-color:#f1f1f1;width:464.4pt;"> <p style="margin-left:.0001pt;text-align:justify;">create table travelrecord (</p> <p style="margin-left:.0001pt;text-align:justify;"> ....</p> <p style="margin-left:.0001pt;text-align:justify;">) ENGINE=InnoDB DEFAULT CHARSET=utf8</p> <p style="margin-left:.0001pt;text-align:justify;">dbpartition by UNI_HASH (id) dbpartitions 6</p> <p style="margin-left:.0001pt;text-align:justify;">tbpartition by UNI_HASH (id) tbpartitions 6;</p> </td></tr></tbody></table> 
<h4 id="%E6%97%A5%E6%9C%9F%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87%20YYYYDD" style="text-align:justify;"><span style="color:#70ad47;"><strong><strong><span style="color:#000080;"><strong>日期哈希分片 YYYYDD</strong></span></strong></strong></span></h4> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">1）仅用于分库</p> 
 <p style="margin-left:.0001pt;text-align:justify;">2）DD是一年之中的天数</p> 
 <p style="margin-left:.0001pt;text-align:justify;">3）(YYYY*366+DD)%分库数</p> 
</blockquote> 
<table cellspacing="0"><tbody><tr><td style="background-color:#f1f1f1;width:464.4pt;"> <p style="margin-left:.0001pt;text-align:justify;">create table travelrecord (</p> <p style="margin-left:.0001pt;text-align:justify;"> ....</p> <p style="margin-left:.0001pt;text-align:justify;">) ENGINE=InnoDB DEFAULT CHARSET=utf8</p> <p style="margin-left:.0001pt;text-align:justify;">dbpartition by YYYYDD(xxx) dbpartitions 8</p> <p style="margin-left:.0001pt;text-align:justify;">tbpartition by xxx(xxx) tbpartitions 12;</p> </td></tr></tbody></table> 
<hr> 
<h3 id="MyCAT2%E5%85%A8%E5%B1%80ID%E7%9A%84%E7%94%9F%E6%88%90%E6%96%B9%E5%BC%8F" style="text-align:justify;"><strong><strong><strong>MyCAT</strong></strong><strong><strong>2</strong></strong><strong><strong>全局</strong></strong><strong><strong>ID</strong></strong><strong><strong>的生成方式</strong></strong></strong></h3> 
<h4 id="%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%85%A8%E5%B1%80ID" style="text-align:justify;"><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>为什么要全局ID</strong></span></strong></strong></span></h4> 
<p style="margin-left:.0001pt;text-align:justify;">        在复杂的分布式系统中，需要对大量的数据和消息进行唯一标识。如在阿里，淘宝，支付，等系统中，数据日渐增长，对数据分库分表后需要有一个<span style="color:#0d0016;"><strong>唯一ID来标识一条数据或消息</strong></span>；还有如美团和饿了吗的骑手ID 商家ID  优惠券ID等，从以上可以得出，一个能够生成全局唯一ID的系统是非常必要的</p> 
<p style="margin-left:.0001pt;text-align:center;">在MyCAT2中，自动默认使用<span style="color:#0d0016;"><strong>雪花片法</strong></span>生成全局序列号。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">如果不需要MyCAT默认全局序列，可以通过配置关闭自动加全局序列；建表语句方式关闭全局序列。</p> 
<p style="margin-left:.0001pt;text-align:justify;">如果不需要使用MyCAT的自增序列，而使用MySQL本身的自增主键的功能。需要在配置中更改对应的建表SQL。不设置auto_increment关键字，这样 MyCAT就不认为这个表有自增主键的功能。就不会使用MyCAT全局序列号，这样，对应的插入SQL在MySQL中去处理，由MySQL的自增主键功能补全。</p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;"><strong>雪花算法：引入了时间戳的ID保持自增的分布式ID生成算法。</strong></span></p> 
<p></p> 
<p><span style="color:#000000;"><strong><strong><span style="color:#000000;"><strong>使用默认的雪花算法验证</strong></span></strong></strong></span></p> 
<p style="margin-left:.0001pt;text-align:justify;">        如果不需要使用MyCAT的自增序列，而使用MySQL本身的自增主键的功能，需要在配置中更改对应的建表SQL,不设置AUTO_INCREMENT关键字，这样MyCAT就不认为这个表有自增主键的功能，就不会使用MyCAT的全局序列号。对应的插入SQL在MySQL处理，由MySQL的自增主键功能补全自增值。</p> 
<p style="text-align:justify;"><span style="color:#70ad47;"><strong><strong><span style="color:#000080;"><strong>向订单表里面添加数据</strong></span></strong></strong></span></p> 
<table cellspacing="0" style="margin-left:6.6pt;"><tbody><tr><td style="background-color:#f1f1f1;width:457.8pt;"> <p style="margin-left:.0001pt;text-align:justify;">INSERT INTO ORDERS(ORDER_TYPE,CUSTOMER_ID,AMOUNT) VALUES(103,102,102102);</p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;">上面的SQL里面没有使用添加ID，那么后台是怎么处理的呢？查看后台数据发现使用的雪花算法</p> 
<p><img alt="" height="230" src="https://images2.imgbox.com/11/38/7fjUXyXP_o.png" width="1102"></p> 
<hr> 
<h3 id="%E5%A4%A7%E5%8E%82%E5%AE%9E%E9%99%85%E4%B8%9A%E5%8A%A1%E4%BD%93%E4%BC%9A%C2%A0">大厂实际业务体会 </h3> 
<blockquote> 
 <p id="h_605884141_28" style="background-color:transparent;text-align:center;"><strong>分库分表如何落地？</strong></p> 
 <p>敲黑板……重点，重点，重点，重要的事情说三遍！！！</p> 
 <p>互联网业内有句经典名言”Talk is cheap.Show me your code”，理论讲再多，无法付诸实际生产都是空谈。</p> 
 <p>这里以某大厂社区电商订单业务的真实案例来分享如何落地分库分表。</p> 
 <p><strong>场景：社区电商下每日 3000万下单场景</strong></p> 
 <p><strong>评估库和表的总数</strong></p> 
 <p>一般评估的标准是：当前日订单峰值 M * 支持最大的爆发增长速率 R * 业务能支撑 Y 年发展 * 365天/年，单表存储 1000万数据按。</p> 
 <p>预估数据总数：日订单 3000万，一年按 365天计数，最大支持日订单 10倍的增长速度（即日订单量 1亿），业务能支撑 10年发展，因此，需要存储的总订单量 Total = 3000w * 365 * 10 * 10 ≈ 10000亿，万亿级。</p> 
 <p>评估库和表的总数：每张表按 1000万存储（库总数 * 表总数 = 10000亿 / 1000万），因此，库总数 * 表总数 = 10万，组合方式有『1个库 * 10万张表、10个库 * 1万张表、100个库 * 1000张表 等』，整体来看，”100个库 * 1000张表”这种组合数据离散比较均匀， 在计算机中，一般采用 2^n 来计数。所以，100个库 * 1000张表可以比较接近 2^7 * 2^10 = 128 * 1024，所以最终 128个库，每个库 1024张表。</p> 
 <p><strong>分库分表字段的选择</strong></p> 
 <p>在单库单表中，可以直接进行 join查询和分页操作，分库分表后，数据会分到不同的数据库和表上，可能会导致跨库查询等问题，因此，分表字段的选择，决定了能否将原本需要进行分页的数据划分到同一张表上，从而避免跨库查询。</p> 
 <p>So，如何选择分库分表字段？</p> 
 <p>有用过社区电商产品（橙心优选，美团优选，多多买菜，盒马邻里）的小伙伴应该知道，社区电商的模式是：当日购买，次日履约。</p> 
 <p>为了保证履约的时效，用户在下单时，商城端都是把订单下到最近的仓库，因此，可以根据仓库编码来分库。</p> 
 <p></p> 
 <p class="img-center"><img alt="" height="237" src="https://images2.imgbox.com/8d/e7/VKbG14m0_o.png" width="513"></p> 
 <p>在整个销售链路和履约链路中，有几个高发的订单查询场景，因此分表字段的选择必须满足这些场景：</p> 
 <p>用户视角：查询自己所有的订单，因此，可以通过 user_id 分表，把某用户所有的订单放到同一张表。</p> 
 <p>团长视角：查询用户下给自己的所有订单，因此，可以通过 tuan_user_id 分表，把某团长的所有的订单放到同一张表。</p> 
 <p>商家视角：查询用户下给自己的所有订单，因此，可以通过 merchant_id 分表，把某商家的所有的订单放到同一张表。</p> 
 <p>客服视角：通过订单号查询某个订单，因此，通过 order_id 分表能够快速查询订单信息。</p> 
 <p>上述 4种场景都是订单表高发查询的场景，但是目前常用的分库分表中间件都只能支持一个分表字段，该如何解决上面 4种查询问题呢？</p> 
 <p>通常的做法有：冗余数据和关系索引表。</p> 
 <p>其实在计算中的世界很多时候都是时间和空间的一个权衡问题，是拿时间换空间，还是拿空间换时间？冗余数据和关系索引表就很好的体现了时间和空间的权衡关系。</p> 
 <p><strong>冗余数据：</strong> 相同的数据保存多份，每份数据使用不同的分表字段，从而满足各种查询需求。如下图所示：通过 user_id、tuan_user_id、merchant_id、order_id 4个字段来分表，因此需要冗余 4份相同数据的 order表。</p> 
 <p></p> 
 <p class="img-center"><img alt="" height="472" src="https://images2.imgbox.com/ad/2b/KdKbFJKH_o.png" width="861"></p> 
 <p></p> 
 <p class="img-center"><img alt="" height="494" src="https://images2.imgbox.com/69/9b/AEsPPkm1_o.png" width="859"></p> 
 <p></p> 
 <p>很显然，冗余数据是通过空间换时间的做法，优点是只要一次查询请求就能满足业务需求，缺点就是相同数据保存多份，浪费了空间，增加了成本。</p> 
 <p>淘宝的订单表采用的是数据冗余，拆分买家库和卖家库两个库，一个订单，在买家和卖家库里都存储了一份。</p> 
 <p><strong>关系索引表：</strong>它是指建立查询条件和基表分表键的索引关系。如下图，订单表是基表，通过建立 user_id 和 order_id，tuan_user_id 和 order_id，merchant_id 和 order_id 的关系索引表来满足几种查询场景：</p> 
 <p></p> 
 <p class="img-center"><img alt="" height="494" src="https://images2.imgbox.com/29/8e/N84mDjMJ_o.png" width="1003"></p> 
 <p>很显然，关系索引表是通过时间换空间的做法，优点是相对数据冗余法节省了空间和成本，缺点是多了一次索引表的查询，因此时间相对就增加了。该方式额外增加的时间在高并发特别大的场景就能显现出来。</p> 
 <p>因此，最后分库分表模型是根据仓库编码 warehouse_code 来分库，根据分表字段路由到 order表，如下图：</p> 
 <p></p> 
 <p class="img-center"><img alt="" height="246" src="https://images2.imgbox.com/0e/0d/2wPdJ1Eo_o.png" width="824"></p> 
 <p><strong>疑问：</strong></p> 
 <p>疑问1：上述案例的数据库只能支撑 10年，10年以后的数据怎么存储？</p> 
 <p>有过网购经验的小伙伴应该都很少去查询3年前的数据，因此，我们可以设置一个冷热数据，比如按 3年划分，3年内数据可以放到数据库做热数据，3年前的数据可以归档到 ElasticSearch/hive，做冷数据查询。</p> 
 <p>疑问2：如何查询某一段时间的订单？</p> 
 <p>可以同步到 ElasticSearch/hive，这样就可以很方便的按时间段来查询。</p> 
 <p>疑问3：上述案例完全是新业务，如果已经有线上服务和数据，该如何分库分表？</p> 
 <p>这个场景是很多公司面临的问题，因此这里给出一个切分的标准处理流程 SOP（Standard operating procedure：</p> 
 <p><strong>立项讨论：</strong></p> 
 <p>这个步骤需要完成和相关部门以及人员确认分库分表事项、实施日程、后期周知、风险以及应对方案等事宜。</p> 
 <p><strong>技术方案：</strong></p> 
 <p>技术方案需要给出详细迁移方案，包括分库分表方案，代码改造，服务器过渡到新库新表方案，数据迁移方案，风险处理方案等。</p> 
 <p><strong>代码改造：</strong></p> 
 <p>代码改造，主要会涉及到几个部分：服务如何过渡到新库新表，如何灵活支持灰度读写操作，如何进行数据全量迁移、一致性校验等任务。</p> 
 <p><strong>分库分表方案：</strong></p> 
 <p>分库分表方案需要确认分库分表的字段，库和表的数量等问题，可以参考上文 社区电商分库分表落地方案。</p> 
 <p><strong>数据同步：</strong></p> 
 <p>数据同步有全量数据迁移、增量数据同步以及数据校验、优化和补偿。</p> 
 <p>数据全量迁移常用方案：开发代码将老库数据迁移到新库；使用中间件同步工具（比如：阿里的 canal）将老库数据同步到新库。</p> 
 <p>增量数据同步常用方案：同步双写，在写数据库的地方修改成写两份数据；异步双写，写老库，监听binlog异步同步到新库；中间件同步：通过中间件（比如：阿里的 canal）将数据同步到目标库表。</p> 
 <p>数据校验常用方案：增量数据校验 和 全量数据校验 和 人工抽检。</p> 
 <p>数据校验核心流程：分别读取老库数据和新库数据，然后比较，数据一致则继续比较下一条数据，数据不一致则进行补偿。</p> 
 <p>数据补偿核心流程：新库存在老库不存在，则新库删除数据； 新库不存在老库存在，则新库插入数据；新库存在老库存在，则比较所有字段，不一致则将新库更新为老库数据。</p> 
 <p><strong>风险处理方案：</strong></p> 
 <p>风险处理包含部门间配合，技术方案的处理（服务回滚，数据修复等）</p> 
</blockquote> 
<hr> 
<h3 id="%E6%90%AD%E5%BB%BA%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E6%9E%B6%E6%9E%84%C2%A0">搭建分库分表架构 </h3> 
<p style="text-align:center;"><span style="color:#0d0016;"><strong>这里好鬼复杂，不记录了，想要搭建的自己找篇文章照着搭一下吧</strong></span></p> 
<p style="text-align:center;"><span style="color:#0d0016;"><strong>理论学习下就好，工作中数据库分库分表的搭建一般也轮不到我们写Java的来搞，这些配置类的东西要么丢给DBA做，要么找篇文章一步步跟着来，咱儿重心还是放在CRUD上吧.....</strong></span></p> 
<p style="text-align:center;"><img alt="" height="293" src="https://images2.imgbox.com/0e/78/KfAhkLEb_o.png" width="301"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fd4ed4448aec9bc129762b098d83dff9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">FastJson中JSONString与各个对象的的转换关系及API示例</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fd781050f9a7bfb5be71b96d7b6f44a6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[记录]基于Flask Web全栈开发实战-项目实战·上篇（黄勇 • 著）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>