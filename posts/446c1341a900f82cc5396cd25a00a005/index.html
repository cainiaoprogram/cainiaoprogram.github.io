<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CVPR 2022 | 清华&amp;字节提出FGD：针对目标检测的重点与全局知识蒸馏 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CVPR 2022 | 清华&amp;字节提出FGD：针对目标检测的重点与全局知识蒸馏" />
<meta property="og:description" content=" 点击下方卡片，关注“CVer”公众号
AI/CV重磅干货，第一时间送达
作者：美索不达米亚平原 | 已授权转载（源：知乎）编辑：CVer
https://zhuanlan.zhihu.com/p/477707304
本文介绍我们CVPR2022关于目标检测的知识蒸馏工作: Focal and Global Knowledge Distillation for Detectors，只需要30行代码就可以在anchor-base, anchor-free的单阶段、两阶段各种检测器上稳定涨点，现在代码已经开源，欢迎大家试用～
Focal and Global Knowledge Distillation for Detectors
文章链接：arxiv.org/abs/2111.11837
代码链接：github.com/yzd-v/FGD
一、针对问题 1. 目标检测中前背景不平衡问题 前背景的不平衡对于目标检测而言是一个重要的问题，这个问题同样影响着知识蒸馏。
知识蒸馏旨在使学生学习教师的知识，以获得相似的输出从而提升性能。为了探索学生与教师在特征层面的差异，我们首先对二者的特征图进行了可视化。可以看到在空间与通道注意力上，教师与学生均存在较大的差异。其中在空间注意力上，二者在前景中的差异较大，在背景中的差异较小，这会给蒸馏中的学生带来不同的学习难度。
为了进一步探索前背景对于知识蒸馏的影响，我们分离出前背景进行了蒸馏实验，全图一起蒸馏会导致蒸馏性能的下降，将前景与背景分开学生能够获得更好的表现。
针对学生与教师注意力的差异，前景与背景的差异，我们提出了重点蒸馏Focal Distillation：分离前背景，并利用教师的空间与通道注意力作为权重，指导学生进行知识蒸馏，计算重点蒸馏损失。
2.全局信息的丢失 如前所述，Focal Distillation将前景与背景分开进行蒸馏，割断了前背景的联系，缺乏了特征的全局信息的蒸馏。为此，我们提出了全局蒸馏Global Distillation：利用GcBlock分别提取学生与教师的全局信息，并进行全局蒸馏损失的计算。
二、整体框架 FGD仅需要获取学生与教师的特征图，便可完成重点蒸馏损失与全局蒸馏损失的计算，可以很方便的应用到各种类型的检测器上。
三、实验结果 我们对anchor-based与anchor-free的单阶段与二阶段检测器进行了实验，在COCO2017上学生检测器均获得了大幅的AP和AR提升。
我们采用了具有更强的检测器对学生进行蒸馏，发现当使用更强的模型作为教师进行蒸馏时，FGD为模型能带来更大的性能的提升。例如RetinaNet-R50在ResNet-101和ResNeXt-101的老师蒸馏下，分别可达到39.7和40.7的mAP。
对于使用FGD蒸馏完成后的学生模型，我们再次进行了注意力的可视化。可以看到，经过FGD训练后的学生，空间注意力和通道注意力的分布与教师都非常相似，这表明学生通过蒸馏学到了教师的知识并获得了更好的特征，由此实现了性能的提升。
四、更多蒸馏设置 我们已将代码开源：github.com/yzd-v/FGD 代码基于MMDetection实现，易于复现，且已添加更多的教师与学生蒸馏设置，相关结果也在代码中给出，欢迎大家使用。
ICCV和CVPR 2021论文和代码下载 后台回复：CVPR2021，即可下载CVPR 2021论文和代码开源的论文合集 后台回复：ICCV2021，即可下载ICCV 2021论文和代码开源的论文合集 后台回复：Transformer综述，即可下载最新的3篇Transformer综述PDF CVer-目标检测交流群成立 扫码添加CVer助手，可申请加入CVer-目标检测 微信交流群，方向已涵盖：目标检测、图像分割、目标跟踪、人脸检测&amp;识别、OCR、姿态估计、超分辨率、SLAM、医疗影像、Re-ID、GAN、NAS、深度估计、自动驾驶、强化学习、车道线检测、模型剪枝&amp;压缩、去噪、去雾、去雨、风格迁移、遥感图像、行为识别、视频理解、图像融合、图像检索、论文投稿&amp;交流、PyTorch和TensorFlow等群。 一定要备注：研究方向&#43;地点&#43;学校/公司&#43;昵称（如目标检测&#43;上海&#43;上交&#43;卡卡），根据格式备注，可更快被通过且邀请进群 ▲长按加小助手微信，进交流群 CVer学术交流群（知识星球）来了！想要了解最新最快最好的CV/DL/ML论文速递、优质开源项目、学习教程和实战训练等资料，欢迎扫描下方二维码，加入CVer学术交流群，已汇集数千人！ ▲扫码进群 ▲点击上方卡片，关注CVer公众号 整理不易，请点赞和在看 " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/446c1341a900f82cc5396cd25a00a005/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-09T13:05:00+08:00" />
<meta property="article:modified_time" content="2022-03-09T13:05:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CVPR 2022 | 清华&amp;字节提出FGD：针对目标检测的重点与全局知识蒸馏</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p style="text-align:center;">点击下方<strong>卡片</strong>，关注“<strong>CVer</strong>”公众号</p> 
 <p style="text-align:center;">AI/CV重磅干货，第一时间送达</p> 
 <p><strong>作者</strong><strong>：美索不达米亚平原  |  </strong><strong>已授权转载（源：知乎）编辑：CVer</strong><br></p> 
 <p><strong>https://zhuanlan.zhihu.com/p/477707304</strong></p> 
 <p style="text-align:justify;">本文介绍我们CVPR2022关于目标检测的知识蒸馏工作: Focal and Global Knowledge Distillation for Detectors，只需要30行代码就可以在anchor-base, anchor-free的单阶段、两阶段各种检测器上稳定涨点，现在代码已经开源，欢迎大家试用～</p> 
 <p style="text-align:justify;"><strong>Focal and Global Knowledge Distillation for Detectors</strong></p> 
 <p style="text-align:justify;">文章链接：arxiv.org/abs/2111.11837</p> 
 <p style="text-align:justify;">代码链接：github.com/yzd-v/FGD</p> 
 <img width="1200" src="https://images2.imgbox.com/fd/b2/SWJHkyOA_o.png" alt="cf0c9b2e23950ba19dfdc0336dde5179.png"> 
 <h3><strong>一、针对问题</strong></h3> 
 <h4><strong>1. 目标检测中前背景不平衡问题</strong></h4> 
 <p style="text-align:justify;">前背景的不平衡对于目标检测而言是一个重要的问题，这个问题同样影响着知识蒸馏。</p> 
 <p style="text-align:justify;">知识蒸馏旨在使学生学习教师的知识，以获得相似的输出从而提升性能。为了探索学生与教师在特征层面的差异，我们首先对二者的特征图进行了可视化。可以看到在空间与通道注意力上，教师与学生均存在较大的差异。其中在空间注意力上，二者在前景中的差异较大，在背景中的差异较小，这会给蒸馏中的学生带来不同的学习难度。</p> 
 <img width="1200" src="https://images2.imgbox.com/fd/df/eHVWqLDe_o.png" alt="df9891dc05d877fb9ea5f02ee28c688f.png"> 
 <p>为了进一步探索前背景对于知识蒸馏的影响，我们分离出前背景进行了蒸馏实验，全图一起蒸馏会导致蒸馏性能的下降，将前景与背景分开学生能够获得更好的表现。</p> 
 <img width="1200" src="https://images2.imgbox.com/72/8f/JuTo0LLD_o.png" alt="ee4d11e1d57763b99469e128a4465fca.png"> 
 <p>针对学生与教师注意力的差异，前景与背景的差异，我们提出了重点蒸馏Focal Distillation：分离前背景，并利用教师的空间与通道注意力作为权重，指导学生进行知识蒸馏，计算重点蒸馏损失。</p> 
 <h4><strong>2.全局信息的丢失</strong></h4> 
 <p>如前所述，Focal Distillation将前景与背景分开进行蒸馏，割断了前背景的联系，缺乏了特征的全局信息的蒸馏。为此，我们提出了全局蒸馏Global Distillation：利用GcBlock分别提取学生与教师的全局信息，并进行全局蒸馏损失的计算。</p> 
 <img width="1200" src="https://images2.imgbox.com/6b/8e/BxAtPmdB_o.png" alt="c9a75138c063753347bc0cec46efd96b.png"> 
 <h3><br></h3> 
 <h3><strong>二、整体框架</strong></h3> 
 <p>FGD仅需要获取学生与教师的特征图，便可完成重点蒸馏损失与全局蒸馏损失的计算，可以很方便的应用到各种类型的检测器上。</p> 
 <img width="1200" src="https://images2.imgbox.com/8f/54/vOJAT5km_o.png" alt="7684b9049d7392c83a0183b4034b1c51.png"> 
 <h3><strong>三、实验结果</strong></h3> 
 <p>我们对anchor-based与anchor-free的单阶段与二阶段检测器进行了实验，在COCO2017上学生检测器均获得了大幅的AP和AR提升。</p> 
 <img width="1122" src="https://images2.imgbox.com/7e/69/QVX9IXs4_o.png" alt="7d38fc92e96c7f250b0f27b64970b3be.png"> 
 <p>我们采用了具有更强的检测器对学生进行蒸馏，发现当使用更强的模型作为教师进行蒸馏时，FGD为模型能带来更大的性能的提升。例如RetinaNet-R50在ResNet-101和ResNeXt-101的老师蒸馏下，分别可达到39.7和40.7的mAP。</p> 
 <img width="1200" src="https://images2.imgbox.com/93/49/om8NGVoD_o.png" alt="5669b29d088dda85caa009eea26dfbf1.png"> 
 <p>对于使用FGD蒸馏完成后的学生模型，我们再次进行了注意力的可视化。可以看到，经过FGD训练后的学生，空间注意力和通道注意力的分布与教师都非常相似，这表明学生通过蒸馏学到了教师的知识并获得了更好的特征，由此实现了性能的提升。</p> 
 <img width="1200" src="https://images2.imgbox.com/92/b8/q0bb94vu_o.png" alt="776f4b943150dc53cdcb3bdf32f4fa8a.png"> 
 <h3><strong><br></strong></h3> 
 <h3><strong>四、更多蒸馏设置</strong></h3> 
 <p>我们已将代码开源：github.com/yzd-v/FGD <br>代码基于MMDetection实现，易于复现，且已添加更多的教师与学生蒸馏设置，相关结果也在代码中给出，欢迎大家使用。</p> 
 <img width="1200" src="https://images2.imgbox.com/5e/f0/WRr0Na3q_o.png" alt="8481ac0251eea4b0c6ca652e302ccffb.png"> 
 <pre class="has"><code class="language-go">ICCV和CVPR 2021论文和代码下载

后台回复：CVPR2021，即可下载CVPR 2021论文和代码开源的论文合集

后台回复：ICCV2021，即可下载ICCV 2021论文和代码开源的论文合集

后台回复：Transformer综述，即可下载最新的3篇Transformer综述PDF
CVer-目标检测交流群成立
扫码添加CVer助手，可申请加入CVer-目标检测 微信交流群，方向已涵盖：目标检测、图像分割、目标跟踪、人脸检测&amp;识别、OCR、姿态估计、超分辨率、SLAM、医疗影像、Re-ID、GAN、NAS、深度估计、自动驾驶、强化学习、车道线检测、模型剪枝&amp;压缩、去噪、去雾、去雨、风格迁移、遥感图像、行为识别、视频理解、图像融合、图像检索、论文投稿&amp;交流、PyTorch和TensorFlow等群。
一定要备注：研究方向+地点+学校/公司+昵称（如目标检测+上海+上交+卡卡），根据格式备注，可更快被通过且邀请进群

▲长按加小助手微信，进交流群
CVer学术交流群（知识星球）来了！想要了解最新最快最好的CV/DL/ML论文速递、优质开源项目、学习教程和实战训练等资料，欢迎扫描下方二维码，加入CVer学术交流群，已汇集数千人！

▲扫码进群
▲点击上方卡片，关注CVer公众号

整理不易，请点赞和在看</code></pre> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3f1d8fd014cf20a27f5d54dc58563831/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【ROS&amp;GAZEBO】解决“is neither a launch file in package ”的问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e29145cae19c1b34be5fcc6d208edbb9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JDK1.8新特性 Optional判空详解，简化判空操作</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>