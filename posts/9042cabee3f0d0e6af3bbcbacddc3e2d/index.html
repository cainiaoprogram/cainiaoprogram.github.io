<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Duilib界面库使用简介 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Duilib界面库使用简介" />
<meta property="og:description" content="Duilib简介 windows下一款非常好的界面库，实现了UI和逻辑代码的分离，详细介绍百度即可。 使用步骤 如何下载编译duilib我就不说了，github上有编译好的，这里假设你已经有了duilib库的编译好的文件 1.引入头文件，库文件 /引入duilib头文件和库文件 #include &lt;OAIdl.h&gt;//duilib依赖这个vc头文件，如果没有引入的话要引入以下 #include &lt;UIlib.h&gt; using namespace DuiLib; #ifdef _DEBUG # ifdef _UNICODE # pragma comment(lib, &#34;DuiLib_ud.lib&#34;) # else # pragma comment(lib, &#34;DuiLib_d.lib&#34;) # endif #else # ifdef _UNICODE # pragma comment(lib, &#34;DuiLib_u.lib&#34;) # else # pragma comment(lib, &#34;DuiLib.lib&#34;) # endif #endif 2.自定义duilib窗口类，继承CWindowWnd和INotifyUI，实现相关虚函数 详细代码下面会贴出 3.在程序入口函数中创建自定义类对象显示窗口即可 int APIENTRY _tWinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPTSTR lpCmdLine, int nCmdShow) { //设置程序实例句柄 CPaintManagerUI::SetInstance(hInstance); //创建并显示窗口 CDuiFrameWnd duiFrame; duiFrame.Create(NULL, _T(&#34;DUIWnd&#34;), UI_WNDSTYLE_FRAME, WS_EX_WINDOWEDGE); duiFrame." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/9042cabee3f0d0e6af3bbcbacddc3e2d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-09-07T16:23:39+08:00" />
<meta property="article:modified_time" content="2016-09-07T16:23:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Duilib界面库使用简介</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>Duilib简介</h2> 
<div>
  windows下一款非常好的界面库，实现了UI和逻辑代码的分离，详细介绍百度即可。 
</div> 
<h2>使用步骤</h2> 
<div>
  如何下载编译duilib我就不说了，github上有编译好的，这里假设你已经有了duilib库的编译好的文件 
</div> 
<h3>1.引入头文件，库文件</h3> 
<div> 
 <pre><code class="language-cpp">/引入duilib头文件和库文件
#include &lt;OAIdl.h&gt;//duilib依赖这个vc头文件，如果没有引入的话要引入以下
#include &lt;UIlib.h&gt;

using namespace DuiLib;

#ifdef _DEBUG
#   ifdef _UNICODE
#       pragma comment(lib, "DuiLib_ud.lib")
#   else
#       pragma comment(lib, "DuiLib_d.lib")
#   endif
#else
#   ifdef _UNICODE
#       pragma comment(lib, "DuiLib_u.lib")
#   else
#       pragma comment(lib, "DuiLib.lib")
#   endif
#endif</code></pre> 
</div> 
<h3>2.自定义duilib窗口类，继承CWindowWnd和INotifyUI，实现相关虚函数</h3> 
<div>
  详细代码下面会贴出 
</div> 
<h3>3.在程序入口函数中创建自定义类对象显示窗口即可</h3> 
<div> 
 <pre><code class="language-cpp">int APIENTRY _tWinMain(HINSTANCE hInstance,
                     HINSTANCE hPrevInstance,
                     LPTSTR    lpCmdLine,
                     int       nCmdShow)
{
	//设置程序实例句柄
	CPaintManagerUI::SetInstance(hInstance);
	//创建并显示窗口
	CDuiFrameWnd duiFrame;
	duiFrame.Create(NULL, _T("DUIWnd"), UI_WNDSTYLE_FRAME, WS_EX_WINDOWEDGE);
	duiFrame.ShowModal();

	return 0;
}</code></pre> 
 <h2>完整源码</h2> 
 <h3>HelloDuilib.cpp</h3> 
 <div> 
  <pre><code class="language-cpp">// HelloDuilib.cpp : 定义应用程序的入口点。
//

#include "stdafx.h"
#include "HelloDuilib.h"

//引入duilib头文件和库文件
#include &lt;OAIdl.h&gt;//duilib依赖这个vc头文件，如果没有引入的话要引入以下
#include &lt;UIlib.h&gt;

using namespace DuiLib;

#ifdef _DEBUG
#   ifdef _UNICODE
#       pragma comment(lib, "DuiLib_ud.lib")
#   else
#       pragma comment(lib, "DuiLib_d.lib")
#   endif
#else
#   ifdef _UNICODE
#       pragma comment(lib, "DuiLib_u.lib")
#   else
#       pragma comment(lib, "DuiLib.lib")
#   endif
#endif

//自定义duilib窗口类
class CDuiFrameWnd : public CWindowWnd, public INotifyUI
{
public:
	//---------------虚函数-------------：
	//获取窗口类名
	virtual LPCTSTR GetWindowClassName() const { return _T("DUIMainFrame"); }
	//消息通知
	virtual void Notify(TNotifyUI&amp; msg) 
	{
		if(msg.sType == _T("click"))
		{
			if(msg.pSender-&gt;GetName() == _T("btnHello")) 
			{
				::MessageBox(NULL, _T("点击了按钮"), _T("提示"), NULL);
			}
		}

	}
	//消息循环处理
	virtual LRESULT HandleMessage(UINT uMsg, WPARAM wParam, LPARAM lParam)
	{
		LRESULT lRes = 0;

		if( uMsg == WM_CREATE ) 
		{
			m_PaintManager.Init(m_hWnd);

			CControlUI *pWnd = NULL;
#if 0
			//代码方式创建UI
			//创建一个button
			pWnd = new CButtonUI;
			pWnd-&gt;SetName(_T("btnHello"));//名字是唯一的，用来唯一区分该控件
			pWnd-&gt;SetText(_T("Hello duilib"));   // 设置文字
			pWnd-&gt;SetBkColor(0xFFC7EDCC);       // 设置背景色（护眼绿）
#else
			//xml方式创建控件
			//声明窗口构造器
			CDialogBuilder builder;
			//根据xml创建UI
			pWnd = builder.Create(_T("duilib.xml"), (UINT)0, NULL, &amp;m_PaintManager);   // duilib.xml需要放到exe目录下
			ASSERT(pWnd &amp;&amp; "Failed to parse XML");
#endif

			//关联创建的ui
			m_PaintManager.AttachDialog(pWnd);
			//将当前类添加进duilib的消息循环，这样我们的Notify才能收到通知
			m_PaintManager.AddNotifier(this);
			return lRes;
		}
		// 以下3个消息WM_NCACTIVATE、WM_NCCALCSIZE、WM_NCPAINT用于屏蔽系统标题栏
		else if( uMsg == WM_NCACTIVATE ) 
		{
			if( !::IsIconic(m_hWnd) ) 
			{
				return (wParam == 0) ? TRUE : FALSE;
			}
		}
		else if( uMsg == WM_NCCALCSIZE ) 
		{
			return 0;
		}
		else if( uMsg == WM_NCPAINT ) 
		{
			return 0;
		}

		if( m_PaintManager.MessageHandler(uMsg, wParam, lParam, lRes) ) 
		{
			return lRes;
		}

		return __super::HandleMessage(uMsg, wParam, lParam);
	}

protected:
	CPaintManagerUI m_PaintManager;
};
int APIENTRY _tWinMain(HINSTANCE hInstance,
                     HINSTANCE hPrevInstance,
                     LPTSTR    lpCmdLine,
                     int       nCmdShow)
{
	//设置程序实例句柄
	CPaintManagerUI::SetInstance(hInstance);
	// 设置资源的默认路径（此处设置为和exe在同一目录），使用xml创建布局时在此目录下查找xml文件
	CPaintManagerUI::SetResourcePath(CPaintManagerUI::GetInstancePath());  
	//创建并显示窗口
	CDuiFrameWnd duiFrame;
	duiFrame.Create(NULL, _T("DUIWnd"), UI_WNDSTYLE_FRAME, WS_EX_WINDOWEDGE);
	duiFrame.CenterWindow();
	duiFrame.ShowModal();

	return 0;
}</code></pre> 
  <h3>duilib.xml</h3> 
 </div> 
 <div> 
  <pre><code class="language-html">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Window size="800,600"&gt; &lt;!-- 窗口的初始尺寸 --&gt;
    &lt;HorizontalLayout bkcolor="0xFFC7EDCC"&gt; &lt;!-- 整个窗口的背景 --&gt;
        &lt;Button name="btnHello" text="Hello duilib"/&gt; &lt;!-- 按钮的属性，如名称、文本 --&gt;
    &lt;/HorizontalLayout&gt;
&lt;/Window&gt;</code></pre> 
  <h2>关键步骤说明</h2> 
  <div>
    完整源码中的注释已经够详细了，这里再总结一下几个步骤 
  </div> 
  <h3>响应事件步骤</h3> 
  <div>
    1. WM_CREATE的时候 
  </div> 
  <div>
    //将当前类添加进duilib的消息循环，这样我们的Notify才能收到通知 
   <br> m_PaintManager.AddNotifier(this); 
   <br> 
  </div> 
  <div>
    2. 在Notify函数中， 根据消息类型和控件名称（控件要设置了名称）来响应点击事件 
  </div> 
  <h3>XML配置界面步骤</h3> 1.设置布局文件路径 
 </div> 
 <div>
   // 设置资源的默认路径（此处设置为和exe在同一目录），使用xml创建布局时在此目录下查找xml文件 
  <br> 
  <span style="white-space:pre"></span>CPaintManagerUI::SetResourcePath(CPaintManagerUI::GetInstancePath());   
  <br> 
 </div> 
 <div>
   2. xml方式创建控件 
  <br> 
  <span style="white-space:pre"></span>//声明窗口构造器 
  <br> 
  <span style="white-space:pre"></span>CDialogBuilder builder; 
  <br> 
  <span style="white-space:pre"></span>//根据xml创建UI 
  <br> 
  <span style="white-space:pre"></span>pWnd = builder.Create(_T("duilib.xml"), (UINT)0, NULL, &amp;m_PaintManager);   // duilib.xml需要放到exe目录下 
  <br> 
  <span style="white-space:pre"></span>ASSERT(pWnd &amp;&amp; "Failed to parse XML"); 
 </div> 
 <br> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e2f44a923bb85b3e2d376d51b2bde8d7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">solve the error : Could not open lock file /var/lib/apt/lists/lock</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b48be36a8ab37823c05df00b0262baf4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#编程启航（一）visual studio 2015 的安装与语言包</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>