<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MYCAT链接及集群搭建 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MYCAT链接及集群搭建" />
<meta property="og:description" content="1 准备(windows版操作) JDK1.7以上
TOMCAT（8.5）
MYCAT（windows） server 1.6.7
mycat下载连接：The domain name Mycat.io is for sale （免安装）
配置mycat环境变量： MYCAT_HOME=安装路径
PATH = $MYCAT_HOME$\bin
2 修改mycat配置信息 2.1安装路径\conf 下 server.xml 配置mycat用户名及密码，以及mycat逻辑库名，权限（可忽略）等
&lt;user name=&#34;root&#34; defaultAccount=&#34;true&#34;&gt; &lt;!--mycat 连接密码--&gt; &lt;property name=&#34;password&#34;&gt;123456&lt;/property&gt; &lt;!--mycat 逻辑库名 与配置文件相同--&gt; &lt;property name=&#34;schemas&#34;&gt;DB2&lt;/property&gt; &lt;!--读取权限--&gt; &lt;!--&lt;property name=&#34;readOnly&#34;&gt;false&lt;/property&gt;--&gt; &lt;/user&gt; 2.2 安装路径\conf 下 schema.xml
配置mycat与实际数据库的绑定
&lt;mycat:schema xmlns:mycat=&#34;http://io.mycat/&#34;&gt; &lt;schema name=&#34;DB2&#34; checkSQLschema=&#34;false&#34; dataNode=&#39;dn1&#39; sqlMaxLimit=&#34;100&#34;&gt;&lt;/schema&gt; &lt;dataNode name=&#34;dn1&#34; dataHost=&#34;localhost1&#34; database=&#34;数据库名称&#34; /&gt; &lt;dataHost name=&#34;localhost1&#34; maxCon=&#34;1000&#34; minCon=&#34;10&#34; balance=&#34;0&#34; writeType=&#34;0&#34; dbType=&#34;mysql&#34; dbDriver=&#34;native&#34; switchType=&#34;1&#34; slaveThreshold=&#34;100&#34;&gt; &lt;heartbeat&gt;select user()&lt;/heartbeat&gt; &lt;!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ecc17f2fca99b008b705a546fa053204/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-14T15:36:05+08:00" />
<meta property="article:modified_time" content="2022-11-14T15:36:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MYCAT链接及集群搭建</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="margin-left:0pt;">1 准备(windows版操作)</h2> 
<p style="margin-left:0pt;">JDK1.7以上</p> 
<p style="margin-left:0pt;">TOMCAT（8.5）</p> 
<p style="margin-left:0pt;">MYCAT（windows） server 1.6.7</p> 
<p style="margin-left:0pt;">mycat下载连接：<u><span style="color:#0000ff;"><u><a href="http://www.mycat.io" rel="nofollow" title="The domain name Mycat.io is for sale">The domain name Mycat.io is for sale</a>   （免安装）</u></span></u></p> 
<p style="margin-left:0pt;">配置mycat环境变量： MYCAT_HOME=安装路径</p> 
<p style="margin-left:0pt;">PATH = $MYCAT_HOME$\bin</p> 
<h2 style="margin-left:0pt;">2 修改mycat配置信息</h2> 
<h3 style="margin-left:0pt;">2.1安装路径\conf   下 server.xml</h3> 
<p style="margin-left:0pt;">配置mycat用户名及密码，以及mycat逻辑库名，权限（可忽略）等</p> 
<pre class="has"><code class="language-html">&lt;user name="root" defaultAccount="true"&gt;

&lt;!--mycat 连接密码--&gt;

&lt;property name="password"&gt;123456&lt;/property&gt;

&lt;!--mycat 逻辑库名 与配置文件相同--&gt;

&lt;property name="schemas"&gt;DB2&lt;/property&gt;

&lt;!--读取权限--&gt;

&lt;!--&lt;property name="readOnly"&gt;false&lt;/property&gt;--&gt;

&lt;/user&gt;</code></pre> 
<p style="margin-left:0pt;">2.2 安装路径\conf  下 schema.xml</p> 
<p style="margin-left:0pt;">配置mycat与实际数据库的绑定</p> 
<pre class="has"><code class="language-html">&lt;mycat:schema xmlns:mycat="http://io.mycat/"&gt;

&lt;schema name="DB2" checkSQLschema="false" dataNode='dn1' sqlMaxLimit="100"&gt;&lt;/schema&gt;

&lt;dataNode name="dn1" dataHost="localhost1" database="数据库名称" /&gt;

&lt;dataHost name="localhost1" maxCon="1000" minCon="10" balance="0"

  writeType="0" dbType="mysql" dbDriver="native" switchType="1"  slaveThreshold="100"&gt;

&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;

&lt;!-- can have multi write hosts --&gt;

&lt;writeHost host="hostM1" url="127.0.0.1:3306" user="root"

   password="***"&gt;

&lt;!-- can have multi read hosts --&gt;

&lt;!--&lt;readHost host="hostS2" url="127.0.0.1:3306" user="root" password="***" /&gt;--&gt;

&lt;/writeHost&gt;

&lt;!--默认第一个writeHost，出现问题切换正常的下一个writeHost --&gt;

&lt;writeHost host="hostM2" url="127.0.0.2:3306" user="root"

   password="***"&gt;&lt;/writeHost&gt;

&lt;/dataHost&gt;

&lt;/mycat:schema&gt;</code></pre> 
<p style="margin-left:0pt;">2.3设置防火墙拦截，使其允许mycat请求</p> 
<p style="margin-left:0pt;">2.4 启动失败修改启动插件的内存分配</p> 
<pre class="has"><code class="language-java">打开mycat\conf里面的startup_nowrap.bat 为了降低资源占用，mycat的jvm设置在startup_nowrap.bat 可以清楚看到如下配置： 
“%JAVA_CMD%” -server -Xms1G -Xmx2G -XX:MaxPermSize=64M -XX:+AggressiveOpts -XX:MaxDirectMemorySize=1G -DMYCAT_HOME=%MYCAT_HOME% -cp “..\conf;..\lib*” io.mycat.MycatStartup 
这里将-Xms1G改成-Xms512M，-Xmx2G改成-Xmx1024M，保存后重新启动即可。</code></pre> 
<h2 style="margin-left:0pt;">3修改mysql配置文件</h2> 
<h3 style="margin-left:0pt;">3.1安装路径  下 my.ini  或者 my.cnf</h3> 
<p style="margin-left:0pt;">server_id=1</p> 
<p style="margin-left:0pt;">log-bin=mysql-bin</p> 
<p style="margin-left:0pt;">relay_log=mysql-relay-bin</p> 
<p style="margin-left:0pt;"><span style="color:#ff0000;">注：server_id 不可重复</span></p> 
<h2 style="margin-left:0pt;"><span style="color:#000000;">4 设置mysql主服务设置（master）</span></h2> 
<h3 style="margin-left:0pt;"><span style="color:#000000;">4.1登录mysql服务,创建用户（用于从服务与主服务的链接）</span></h3> 
<p style="margin-left:0pt;">GRANT REPLICATION SLAVE,RELOAD,SUPER ON *.* TO 用户@'允许端口' IDENTIFIED BY '密码';</p> 
<p style="margin-left:0pt;">例：GRANT REPLICATION SLAVE,RELOAD,SUPER ON *.* TO backup@'192.168.31.177' IDENTIFIED BY '123456';</p> 
<p style="margin-left:0pt;">用户生效指令：flush privileges;</p> 
<h3 style="margin-left:0pt;"><span style="color:#000000;">4.2 重启mysql;</span></h3> 
<p style="margin-left:0pt;"><span style="color:#000000;">查看主服务状态指令：show master status;（存在即创建成功）</span></p> 
<p style="margin-left:0pt;"><span style="color:#000000;">查看链接列表指令：show processlist\G;（可查询当前主服务下的链接信息）</span></p> 
<p style="margin-left:0pt;"><span style="color:#000000;">备注：1关于mycat主从切换链接：</span><a href="https://blog.csdn.net/liurui321/article/details/78978457" title="mysql主从复制+主备切换_蹦擦擦擦的博客-CSDN博客_mysql主从复制+主备切换">mysql主从复制+主备切换_蹦擦擦擦的博客-CSDN博客_mysql主从复制+主备切换</a></p> 
<p style="margin-left:0pt;"><span style="color:#000000;">2 关于mycat负载均衡链接：</span><a href="https://www.cnblogs.com/songpingyi/p/9953362.html" rel="nofollow" title="windows环境安装haproxy及初步配置负载均衡使用示例 - songpingyi - 博客园">windows环境安装haproxy及初步配置负载均衡使用示例 - songpingyi - 博客园</a></p> 
<p style="margin-left:0pt;"><span style="color:#000000;">3 Haproxy下载链接：</span><a href="https://src.fedoraproject.org/repo/pkgs/haproxy/" rel="nofollow" title="Index of /repo/pkgs/haproxy">Index of /repo/pkgs/haproxy</a></p> 
<p style="margin-left:0pt;"><span style="color:#000000;">4 haproxy集成mycat负载均衡链接：https://blog.51cto.com/goome/2056522</span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ad69a8b70a9cebed96bbabbfdf96f351/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">打开eclipse后，出现BUG的错误提示，原因及说明</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d402e367dfcc24d77cc600f01ceb14d0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mac os 通过vs code连接远程服务器 （ssh方法）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>