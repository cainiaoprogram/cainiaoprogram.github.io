<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>通用SQL数据库查询语句精华使用简介(1) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="通用SQL数据库查询语句精华使用简介(1)" />
<meta property="og:description" content="一、 简单查询 简单的Transact-SQL查询只包括选择列表、FROM子句和WHERE子句。它们分别说明所查询列、查询的表或视图、以及搜索条件等。 例如，下面的语句查询testtable表中姓名为“张三”的nickname字段和email字段。 SELECT nickname,email FROM testtable WHERE name=&#39;张三&#39; (一) 选择列表 选择列表(select_list)指出所查询列，它可以是一组列名列表、星号、表达式、变量(包括局部变量和全局变量)等构成。 1、选择所有列 例如，下面语句显示testtable表中所有列的数据： SELECT * FROM testtable 2、选择部分列并指定它们的显示次序 查询结果集合中数据的排列顺序与选择列表中所指定的列名排列顺序相同。 例如： SELECT nickname,email FROM testtable 3、更改列标题 在选择列表中，可重新指定列标题。定义格式为： 列标题=列名 列名 列标题 如果指定的列标题不是标准的标识符格式时，应使用引号定界符，例如，下列语句使用汉字显示列标题： SELECT 昵称=nickname,电子邮件=email FROM testtable 4、删除重复行 SELECT语句中使用ALL或DISTINCT选项来显示表中符合条件的所有行或删除其中重复的数据行，默认为ALL。使用DISTINCT选项时，对于所有重复的数据行在SELECT返回的结果集合中只保留一行。 5、限制返回的行数 使用TOP n [PERCENT]选项限制返回的数据行数，TOP n说明返回n行，而TOP n PERCENT时，说明n是表示一百分数，指定返回的行数等于总行数的百分之几。 例如： SELECT TOP 2 *FROM testtable SELECT TOP 20 PERCENT * FROM testtable (二)FROM子句 FROM子句指定SELECT语句查询及与查询相关的表或视图。在FROM子句中最多可指定256个表或视图，它们之间用逗号分隔。 在FROM子句同时指定多个表或视图时，如果选择列表中存在同名列，这时应使用对象名限定这些列所属的表或视图。例如在usertable和citytable表中同时存在cityid列，在查询两个表中的cityid时应使用下面语句格式加以限定： SELECT username,citytable.cityid FROM usertable,citytable WHERE usertable.cityid=citytable.cityid 在FROM子句中可用以下两种格式为表或视图指定别名： 表名 as 别名 表名 别名 (二) FROM子句 FROM子句指定SELECT语句查询及与查询相关的表或视图。在FROM子句中最多可指定256个表或视图，它们之间用逗号分隔。 在FROM子句同时指定多个表或视图时，如果选择列表中存在同名列，这时应使用对象名限定这些列所属的表或视图。例如在usertable和citytable表中同时存在cityid列，在查询两个表中的cityid时应使用下面语句格式加以限定： SELECT username,citytable." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/155db83bcd2aac5fdabc8b9f9281d7fd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2006-04-10T18:39:00+08:00" />
<meta property="article:modified_time" content="2006-04-10T18:39:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">通用SQL数据库查询语句精华使用简介(1)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    一、 简单查询 
<br> 
<br>　　简单的Transact-SQL查询只包括选择列表、FROM子句和WHERE子句。它们分别说明所查询列、查询的表或视图、以及搜索条件等。 
<br> 
<br>　　例如，下面的语句查询testtable表中姓名为“张三”的nickname字段和email字段。 
<br> 
<br>　　SELECT nickname,email 
<br>　　FROM testtable 
<br>　　WHERE name='张三'   
<br> 
<br>　　(一) 选择列表 
<br> 
<br>　　选择列表(select_list)指出所查询列，它可以是一组列名列表、星号、表达式、变量(包括局部变量和全局变量)等构成。 
<br> 
<br>　　1、选择所有列 
<br> 
<br>　　例如，下面语句显示testtable表中所有列的数据： 
<br> 
<br>　　SELECT * 
<br>　　FROM testtable   
<br> 
<br>　　2、选择部分列并指定它们的显示次序 
<br> 
<br>　　查询结果集合中数据的排列顺序与选择列表中所指定的列名排列顺序相同。 
<br> 
<br>　　例如： 
<br> 
<br>　　SELECT nickname,email 
<br>　　FROM testtable   
<br> 
<br>　　3、更改列标题 
<br> 
<br>　　在选择列表中，可重新指定列标题。定义格式为： 
<br> 
<br>　　列标题=列名 
<br>　　列名 列标题 
<br> 
<br>　　如果指定的列标题不是标准的标识符格式时，应使用引号定界符，例如，下列语句使用汉字显示列标题： 
<br> 
<br>　　SELECT 昵称=nickname,电子邮件=email 
<br>　　FROM testtable   
<br> 
<br>　　4、删除重复行 
<br> 
<br>　　SELECT语句中使用ALL或DISTINCT选项来显示表中符合条件的所有行或删除其中重复的数据行，默认为ALL。使用DISTINCT选项时，对于所有重复的数据行在SELECT返回的结果集合中只保留一行。 
<br> 
<br>　　5、限制返回的行数 
<br> 
<br>　　使用TOP n [PERCENT]选项限制返回的数据行数，TOP n说明返回n行，而TOP n PERCENT时，说明n是表示一百分数，指定返回的行数等于总行数的百分之几。 
<br> 
<br>　　例如： 
<br> 
<br>　　SELECT TOP 2 *FROM testtable SELECT TOP 20 PERCENT * FROM testtable 
<br> 
<br>　　(二)FROM子句 
<br> 
<br>　　FROM子句指定SELECT语句查询及与查询相关的表或视图。在FROM子句中最多可指定256个表或视图，它们之间用逗号分隔。 
<br> 
<br>　　在FROM子句同时指定多个表或视图时，如果选择列表中存在同名列，这时应使用对象名限定这些列所属的表或视图。例如在usertable和citytable表中同时存在cityid列，在查询两个表中的cityid时应使用下面语句格式加以限定： 
<br> 
<br>　　SELECT username,citytable.cityid 
<br>　　FROM usertable,citytable 
<br>　　WHERE usertable.cityid=citytable.cityid   
<br> 
<br>　　在FROM子句中可用以下两种格式为表或视图指定别名： 
<br> 
<br>　　表名 as 别名 
<br>　　表名 别名 
<br> 
<br>　　(二) FROM子句 
<br> 
<br>　　FROM子句指定SELECT语句查询及与查询相关的表或视图。在FROM子句中最多可指定256个表或视图，它们之间用逗号分隔。 
<br> 
<br>　　在FROM子句同时指定多个表或视图时，如果选择列表中存在同名列，这时应使用对象名限定这些列所属的表或视图。例如在usertable和citytable表中同时存在cityid列，在查询两个表中的cityid时应使用下面语句格式加以限定： 
<br> 
<br>　　SELECT username,citytable.cityid 
<br>　　FROM usertable,citytable 
<br>　　WHERE usertable.cityid=citytable.cityid   
<br> 
<br>　　在FROM子句中可用以下两种格式为表或视图指定别名： 
<br> 
<br>　　表名 as 别名 
<br>　　表名 别名 
<br> 
<br>　　例如上面语句可用表的别名格式表示为： 
<br> 
<br>　　SELECT username,b.cityid 
<br>　　FROM usertable a,citytable b 
<br>　　WHERE a.cityid=b.cityid   
<br> 
<br>　　SELECT不仅能从表或视图中检索数据，它还能够从其它查询语句所返回的结果集合中查询数据。 
<br> 
<br>　　例如： 
<br> 
<br>　　SELECT a.au_fname+a.au_lname 
<br>　　FROM authors a,titleauthor ta 
<br>　　(SELECT title_id,title 
<br>　　FROM titles 
<br>　　WHERE ytd_sales&gt;10000 
<br>　　) AS t 
<br>　　WHERE a.au_id=ta.au_id 
<br>　　AND ta.title_id=t.title_id   
<br> 
<br>　　此例中，将SELECT返回的结果集合给予一别名t，然后再从中检索数据。 
<br> 
<br>　　(三) 使用WHERE子句设置查询条件 
<br> 
<br>　　WHERE子句设置查询条件，过滤掉不需要的数据行。例如下面语句查询年龄大于20的数据： 
<br> 
<br>　　SELECT * 
<br>　　FROM usertable 
<br>　　WHERE age&gt;20   
<br> 
<br>　　WHERE子句可包括各种条件运算符： 
<br> 
<br>　　比较运算符(大小比较)：&gt;、&gt;=、=、&lt;、&lt;=、&lt;&gt;、!&gt;、!&lt; 
<br>　　范围运算符(表达式值是否在指定的范围)：BETWEEN…AND… 
<br>　　NOT BETWEEN…AND… 
<br>　　列表运算符(判断表达式是否为列表中的指定项)：IN (项1,项2……) 
<br>　　NOT IN (项1,项2……) 
<br>　　模式匹配符(判断值是否与指定的字符通配格式相符):LIKE、NOT LIKE 
<br>　　空值判断符(判断表达式是否为空)：IS NULL、NOT IS NULL 
<br>　　逻辑运算符(用于多条件的逻辑连接)：NOT、AND、OR 
<br> 
<br>　　1、范围运算符例：age BETWEEN 10 AND 30相当于age&gt;=10 AND age&lt;=30 
<br> 
<br>　　2、列表运算符例：country IN ('Germany','China') 
<br> 
<br>　　3、模式匹配符例：常用于模糊查找，它判断列值是否与指定的字符串格式相匹配。可用于char、varchar、text、ntext、datetime和smalldatetime等类型查询。 
<br> 
<br>　　可使用以下通配字符： 
<br> 
<br>　　百分号%：可匹配任意类型和长度的字符，如果是中文，请使用两个百分号即%%。 
<br> 
<br>　　下划线_：匹配单个任意字符，它常用来限制表达式的字符长度。 
<br> 
<br>　　方括号[]：指定一个字符、字符串或范围，要求所匹配对象为它们中的任一个。[^]：其取值也[] 相同，但它要求所匹配对象为指定字符以外的任一个字符。 
<br> 
<br>　　例如： 
<br> 
<br>　　限制以Publishing结尾，使用LIKE '%Publishing' 
<br> 
<br>　　限制以A开头：LIKE '[A]%' 
<br> 
<br>　　限制以A开头外：LIKE '[^A]%' 
<br> 
<br>　　4、空值判断符例WHERE age IS NULL 
<br> 
<br>　　5、逻辑运算符：优先级为NOT、AND、OR 
<br> 
<br>　　(四)查询结果排序 
<br> 
<br>　　使用ORDER BY子句对查询返回的结果按一列或多列排序。ORDER BY子句的语法格式为： 
<br> 
<br>　　ORDER BY {column_name [ASC|DESC]} [,…n] 
<br> 
<br>　　其中ASC表示升序，为默认值，DESC为降序。ORDER BY不能按ntext、text和image数据类型进行排序。 
<br> 
<br>　　例如： 
<br> 
<br>　　SELECT * 
<br>　　FROM usertable 
<br>　　ORDER BY age desc,userid ASC   
<br> 
<br>　　另外，可以根据表达式进行排序。 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bbcdfc5abfa4ec9565c0e5405e6fd8c1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java Web中的入侵检测及简单实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fdcf8a852dcda0730aa179288612ec69/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Debian 下 PPPOE拨号设置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>