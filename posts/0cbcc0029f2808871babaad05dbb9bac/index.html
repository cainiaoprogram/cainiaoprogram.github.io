<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[uniapp] uni-ui&#43;vue3.2小程序评论列表组件 回复评论 点赞和删除 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[uniapp] uni-ui&#43;vue3.2小程序评论列表组件 回复评论 点赞和删除" />
<meta property="og:description" content="先看效果 下载地址 uni-app官方插件市场: cc-comment组件
环境 基于vue3.2和uni-ui开发;
依赖版本参考如下:
&#34;dependencies&#34;: { &#34;@dcloudio/uni-mp-weixin&#34;: &#34;3.0.0-3090820231124001&#34;, &#34;@dcloudio/uni-ui&#34;: &#34;^1.4.28&#34;, &#34;uni-ui&#34;: &#34;^1.0.0&#34;, &#34;vue&#34;: &#34;^3.2.45&#34; }, &#34;devDependencies&#34;: { &#34;vite&#34;: &#34;4.0.3&#34; } } 小程序调试基础库: 3.3.0
场景 即拿即用, 组件有详细注释内容, 方便二次开发;
目前仅在小程序使用, 其他平台能否使用请评论留言反馈谢谢, 祝大家使用愉快.
附言 主要是插件市场没找到满意的, 诸多用着也不顺, 所以有了cc-comment, 如有Bug请留言或Email, 开源不易且用且珍惜, 感谢使用.
关于功能样式, 主打一个借鉴如下;
参考[小红书]App的评论回复功能: 点击评论内容展示回复弹窗, 二级评论默认显示一条, 点击展开查看更多, 无评论收起功能.
参考[什么值得买]App的多层级回复评论title显示效果
功能 已实现 无评论显示场景 √显示评论数量(新增和删除动态更新数量) √发起新评论 √点击评论内容回复 √回复一级评论 √回复二级评论 √展开二级评论 √展开超长评论内容 √不能回复自身评论 √删除 √仅可删除自身评论 √可选三类删除模式 √点赞 √点赞大于100显示99&#43; √ 待实现 图片上传 × 有其他需求的评论区留言" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0cbcc0029f2808871babaad05dbb9bac/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-09T15:36:33+08:00" />
<meta property="article:modified_time" content="2024-01-09T15:36:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[uniapp] uni-ui&#43;vue3.2小程序评论列表组件 回复评论 点赞和删除</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_2"></a>先看效果</h2> 
<p><img src="https://images2.imgbox.com/2b/2d/FQqwrBAb_o.gif" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d7/80/nnZvLp43_o.gif" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/69/95/r5R7tS50_o.gif" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/fa/de/rVmvO2nE_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_11"></a>下载地址</h2> 
<p><a href="https://ext.dcloud.net.cn/plugin?id=16266" rel="nofollow">uni-app官方插件市场: cc-comment组件</a></p> 
<h2><a id="_14"></a>环境</h2> 
<p>基于vue3.2和uni-ui开发;<br> 依赖版本参考如下:</p> 
<pre><code class="prism language-{​">    "dependencies": {
    "@dcloudio/uni-mp-weixin": "3.0.0-3090820231124001",
    "@dcloudio/uni-ui": "^1.4.28",
    "uni-ui": "^1.0.0",
    "vue": "^3.2.45"
  },
 "devDependencies": {
    "vite": "4.0.3"
  }
}
</code></pre> 
<p>小程序调试基础库: 3.3.0</p> 
<h2><a id="_30"></a>场景</h2> 
<p>即拿即用, 组件有详细注释内容, 方便二次开发;<br> 目前仅在小程序使用, 其他平台能否使用请评论留言反馈谢谢, 祝大家使用愉快.</p> 
<h2><a id="_34"></a>附言</h2> 
<p>主要是插件市场没找到满意的, 诸多用着也不顺, 所以有了cc-comment, 如有Bug请留言或Email, 开源不易且用且珍惜, 感谢使用.<br> 关于功能样式, 主打一个借鉴如下;<br> 参考[<em>小红书</em>]App的评论回复功能: 点击评论内容展示回复弹窗, 二级评论默认显示一条, 点击展开查看更多, 无评论收起功能.<br> 参考[<em>什么值得买</em>]App的多层级回复评论title显示效果</p> 
<h2><a id="_40"></a>功能</h2> 
<h5><a id="_41"></a>已实现</h5> 
<ul><li>无评论显示场景 √</li><li>显示评论数量(新增和删除动态更新数量) √</li><li>发起新评论 √</li><li>点击评论内容回复 √</li><li>回复一级评论 √</li><li>回复二级评论 √</li><li>展开二级评论 √</li><li>展开超长评论内容 √</li><li>不能回复自身评论 √</li><li>删除 √</li><li>仅可删除自身评论 √</li><li>可选三类删除模式 √</li><li>点赞 √</li><li>点赞大于100显示99+ √</li></ul> 
<h5><a id="_57"></a>待实现</h5> 
<ul><li>图片上传 ×</li></ul> 
<p>有其他需求的评论区留言</p> 
<h2><a id="props__62"></a>:props 属性</h2> 
<table><thead><tr><th>属性名</th><th>说明</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>ref</td><td>实例</td><td>Object</td><td>-</td><td>true</td><td></td></tr><tr><td>tableData</td><td>评论列表</td><td>Array</td><td>[ ]</td><td>true</td><td></td></tr><tr><td>tableTotal</td><td>评论总数</td><td>Number</td><td>0</td><td>true</td><td></td></tr><tr><td>deleteMode</td><td>评论删除模式</td><td>String</td><td>all</td><td>false</td><td>bind-当被删除的一级评论存在回复评论, 那么该评论内容变更显示为[当前评论内容已被移除] only-仅删除当前评论(后端删除相关联的回复评论, 否则总数显示不对) all-删除所有评论包括回复评论</td></tr></tbody></table> 
<p>deleteMode</p> 
<h2><a id="event__74"></a>@event 事件</h2> 
<table><thead><tr><th>属性名</th><th>说明</th><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>likeClick</td><td>点赞事件</td><td>{<!-- -->{params},callback}</td><td>{ params: 评论id }, callback回调函数, 请求后端接口后调用, 执行后续逻辑</td></tr><tr><td>replyClick</td><td>回复事件</td><td>{<!-- -->{params},callback}</td><td>{ params:评论参数 }, callback回调函数, 请求后端接口后调用, 执行后续逻辑</td></tr><tr><td>deleteClick</td><td>删除事件</td><td>{<!-- -->{params,mode},callback}</td><td>{ params: 评论数组id, mode:删除模式[all,bind,only] }, callback回调函数, 请求后端接口后调用, 执行后续逻辑</td></tr></tbody></table> 
<h2><a id="ref__82"></a>$ref 实例可调用属性&amp;事件</h2> 
<table><thead><tr><th>属性名</th><th>说明</th><th>回调参数</th><th>说明</th><th>平台差异说明</th></tr></thead><tbody><tr><td>newCommentFun</td><td>发起新评论</td><td>-</td><td>event</td><td>-</td></tr></tbody></table> 
<h2><a id="_88"></a>数据说明</h2> 
<pre><code class="prism language-javascript=">// 用户信息
type userInfoKeys = {
      id: number // 用户id
      user_name: string // 用户名
      user_avatar: string // 用户头像地址
}
// 评论表
type tableDataKeys = {
      id: number // 评论id
      parent_id: number // 父级评论id
      reply_id: number // 被回复人评论id
      reply_name: string // 被回复人名称
      user_name: string // 用户名
      user_avatar: string // 评论者头像地址
      user_content: string // 评论内容
      is_like: boolean // 是否点赞
      like_count: number // 点赞数统计
      create_time: string // 创建时间
}
</code></pre> 
<h2><a id="_111"></a>使用方法</h2> 
<pre><code class="prism language-javascript=">&lt;template&gt;
  &lt;CComment
    ref="ccRef"
    v-model:userInfo="userInfo"
    v-model:tableData="tableData"
    v-model:tableTotal="tableTotal"
    @likeFun="likeFun"
    @replyFun="replyFun"
    @deleteFun="deleteFun"
    :deleteMode="deleteMode"
  &gt;&lt;/CComment&gt;
  &lt;view @tap="openComment"&gt;评论&lt;/view&gt;
&lt;/template&gt;

&lt;script setup&gt;
import CComment from "@/components/cc-comment";

// 发起新评论
let ccRef = ref(null);
function openComment() {
  ccRef.value.newCommentFun();
}

// 点赞回调事件
function likeFun({ params }, callback) {
  console.log("likeFun", params);
  // 当请求失败, 调用callback重置点赞效果;
  // Demo如下:
  // axios.post("http://xxx/like", { id: params }).then((res) =&gt; {
  //   if (res.code !== 0) {
  //     callback(res);
  //   }
  // });
}

// 回复回调事件
function replyFun({ params }, callback) {
  console.log("replyFun", params);
  // 当请求成功, 调用callback执行评论插入;
  // Demo如下:
  // axios.post("http://xxx/reply", { ...params }).then((res) =&gt; {
  //   if (res.code === 0) {
  //     callback(res);
  //   }
  // });
  const res = { id: Math.random() }; // 很重要的回参! 必须拿到后端返回评论id! 删除需要!
  setTimeout(() =&gt; callback(res), 500); // 目前为了展示效果, 直接执行callback
}

/** 删除回调事件
 * mode 删除模式
 * -- bind: 当被删除的一级评论存在回复评论, 那么该评论内容变更显示为[当前评论内容已被移除]
 * -- only: 仅删除当前评论(后端删除相关联的回复评论, 否则总数显示不对)
 * -- all : 删除所有评论包括回复评论
 */
const deleteMode = ref("all");
function deleteFun({ params, mode }, callback) {
  console.log("deleteFun", { params, mode });
  // 当请求成功, 调用callback执行评论删除;
  switch (deleteMode) {
    case "bind":
      // 逻辑: 调用接口进行评论内容修改 update
      setTimeout(() =&gt; callback(), 500); // 目前为了展示效果, 直接执行callback
      break;
    case "only":
      // 逻辑: 调用接口删除一个评论 delete
      setTimeout(() =&gt; callback(), 500); // 目前为了展示效果, 直接执行callback
      break;
    default:
      // all
      // 逻辑: 调用接口删除多个评论 [delete]
      // Demo如下:
      // axios.post("http://xxx/delete", { ids: params }).then((res) =&gt; {
      //   if (res.code === 0) {
      //     callback(res);
      //   }
      // });
      setTimeout(() =&gt; callback(), 500); // 目前为了展示效果, 直接执行callback
      break;
  }
}

// ----模拟数据------模拟数据------模拟数据----
// 当前登录用户信息
let userInfo = reactive({
  id: 120, // 评论id
  user_name: "ikun", // 用户名
  user_avatar:
    "https://pic1.zhimg.com/80/v2-a79071a705f55c5d88f6c74e6111fe84_720w.webp", // 用户头像
});
let tableTotal = ref(4);// 评论总数
let tableData = reactive([
  {
    id: 120, // 评论id
    parent_id: null, // 父级评论id
    reply_id: null, // 被回复人评论id
    reply_name: null, // 被回复人名称
    user_name: "ikun", // 用户名
    user_avatar:
      "https://pic1.zhimg.com/80/v2-a79071a705f55c5d88f6c74e6111fe84_720w.webp", // 评论者头像地址
    user_content: "唱,跳,rap,篮球", // 评论内容
    is_like: false, // 是否点赞
    like_count: 120, // 点赞数统计
    create_time: "2024-01-01 09:16", // 创建时间
  },
  {
    id: 130,
    parent_id: 120, // 评论的父级id
    reply_id: 120, // 被回复评论id
    reply_name: "ikun", // 被回复人名称
    user_name: "小黑子", // 用户名
    user_avatar:
      "https://pic2.zhimg.com/80/v2-06eade66ec837713d765b1557bf20b25_720w.webp", // 评论者头像地址
    user_content: "姬霓太美", // 评论内容
    is_like: false, // 是否点赞
    like_count: 67, // 点赞数统计
    create_time: "2024-01-01 17:06", // 创建时间
  },
  {
    id: 140,
    parent_id: 120, // 评论的父级id
    reply_id: 130, // 被回复评论id
    reply_name: "小黑子", // 被回复人名称
    user_name: "守护宗主维护宗门", // 用户名
    user_avatar:
      "https://pic3.zhimg.com/80/v2-244696a62fa750b8570cf56bfaa5b26a_720w.webp", // 评论者头像地址
    user_content: "你露出鸡脚了", // 评论内容
    is_like: false, // 是否点赞
    like_count: 16, // 点赞数统计
    create_time: "2024-01-02 23:08", // 创建时间
  },
  {
    id: 150,
    parent_id: null, // 评论的父级id
    reply_id: null, // 被回复评论id
    reply_name: null, // 被回复人名称
    user_name: "音乐制作人", // 用户名
    user_avatar:
      "https://pic2.zhimg.com/80/v2-88ec6f8c6d3305122664dd18a28730e5_720w.webp", // 评论者头像地址
    user_content:
      "只因你太美baby 只因你太美baby 只因你实在是太美baby 只因你太美baby 迎面走来的你让我如此蠢蠢欲动 这种感觉我从未有 Cause I got a crush on you who you 你是我的 我是你的 谁 再多一眼看一眼就会爆炸 再近一点靠近点快被融化", // 评论内容
    is_like: true, // 是否点赞
    like_count: 8, // 点赞数统计
    create_time: "2024-01-08 00:45", // 创建时间
  },
]);// 评论表

&lt;/script&gt;
</code></pre> 
<h2><a id="_263"></a>再放一遍下载地址</h2> 
<p><a href="https://ext.dcloud.net.cn/plugin?id=16266" rel="nofollow">uni-app官方插件市场: cc-comment组件</a></p> 
<p>感谢使用</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1b1882a81af8d19852e7bed25fe3931f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">小白向：搭建企业培训APP的完整技术指南</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1d91e4ecc4b84cfd50cdf47a75e38faa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">阿里云服务器经济型e实例和云服务器u1实例区别？哪个性能优？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>