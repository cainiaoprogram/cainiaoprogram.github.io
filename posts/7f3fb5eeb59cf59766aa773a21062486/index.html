<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>rest_framework_django学习笔记一(序列化器) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="rest_framework_django学习笔记一(序列化器)" />
<meta property="og:description" content="rest_framework_django学习笔记一(序列化器) 一、引入Django Rest Framework 1、安装 pip install djangorestframework 2、引入 INSTALLED_APPS = [ ... &#39;rest_framework&#39;, ] 3、原始RESTful接口写法 models.py
from django.db import models &#39;&#39;&#39; 测试数据 仅供参考 INSERT INTO `demo_app_author` VALUES (1, &#39;令狐冲&#39;, 25, 1); INSERT INTO `demo_app_author` VALUES (2, &#39;任我行&#39;, 58, 2); INSERT INTO `demo_app_author` VALUES (3, &#39;任盈盈&#39;, 23, 3); INSERT INTO `demo_app_author` VALUES (4, &#39;扫地僧&#39;, 99, 4); INSERT INTO `demo_app_author` VALUES (5, &#39;乔峰&#39;, 99, 5); INSERT INTO `demo_app_authordetail` VALUES (1, 1, &#39;13432335433&#39;, &#39;华山&#39;, &#39;1994-05-23&#39;); INSERT INTO `demo_app_authordetail` VALUES (2, 1, &#39;13943454554&#39;, &#39;黑木崖&#39;, &#39;1961-08-13&#39;); INSERT INTO `demo_app_authordetail` VALUES (3, 0, &#39;13878934322&#39;, &#39;黑木崖&#39;, &#39;1996-05-20&#39;); INSERT INTO `demo_app_authordetail` VALUES (4, 0, &#39;13878938322&#39;, &#39;少林&#39;, &#39;1996-05-20&#39;); INSERT INTO `demo_app_authordetail` VALUES (5, 0, &#39;13878939322&#39;, &#39;大宋&#39;, &#39;1996-05-20&#39;); INSERT INTO `demo_app_book` VALUES (1, &#39;笑傲江湖&#39;, 33." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/7f3fb5eeb59cf59766aa773a21062486/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-30T14:19:04+08:00" />
<meta property="article:modified_time" content="2023-11-30T14:19:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">rest_framework_django学习笔记一(序列化器)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="rest_framework_django_0"></a>rest_framework_django学习笔记一(序列化器)</h2> 
<h2><a id="Django_Rest_Framework_3"></a>一、引入Django Rest Framework</h2> 
<h3><a id="1_5"></a>1、安装</h3> 
<pre><code class="prism language-sh">pip <span class="token function">install</span> djangorestframework
</code></pre> 
<h3><a id="2_13"></a>2、引入</h3> 
<pre><code class="prism language-python">INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token string">'rest_framework'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> 
<h3><a id="3RESTful_22"></a>3、原始RESTful接口写法</h3> 
<p>models.py</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models

<span class="token triple-quoted-string string">''' 测试数据 仅供参考
INSERT INTO `demo_app_author` VALUES (1, '令狐冲', 25, 1);
INSERT INTO `demo_app_author` VALUES (2, '任我行', 58, 2);
INSERT INTO `demo_app_author` VALUES (3, '任盈盈', 23, 3);
INSERT INTO `demo_app_author` VALUES (4, '扫地僧', 99, 4);
INSERT INTO `demo_app_author` VALUES (5, '乔峰', 99, 5);
INSERT INTO `demo_app_authordetail` VALUES (1, 1, '13432335433', '华山', '1994-05-23');
INSERT INTO `demo_app_authordetail` VALUES (2, 1, '13943454554', '黑木崖', '1961-08-13');
INSERT INTO `demo_app_authordetail` VALUES (3, 0, '13878934322', '黑木崖', '1996-05-20');
INSERT INTO `demo_app_authordetail` VALUES (4, 0, '13878938322', '少林', '1996-05-20');
INSERT INTO `demo_app_authordetail` VALUES (5, 0, '13878939322', '大宋', '1996-05-20');
INSERT INTO `demo_app_book` VALUES (1, '笑傲江湖', 33.30, '2023-11-11', 1);
INSERT INTO `demo_app_book` VALUES (2, '天龙八部', 33.30, '2023-11-11', 1);
INSERT INTO `demo_app_book_authors` VALUES (1, 1, 1);
INSERT INTO `demo_app_book_authors` VALUES (2, 1, 2);
INSERT INTO `demo_app_book_authors` VALUES (3, 2, 1);
INSERT INTO `demo_app_book_authors` VALUES (4, 2, 2);
INSERT INTO `demo_app_publish` VALUES (1, '华山出版社', '华山', 'ceshi1@qq.com');
INSERT INTO `demo_app_publish` VALUES (2, '明教出版社', '黑木崖', 'ceshi2@qq.com');
INSERT INTO `demo_app_publish` VALUES (2, '萧峰版社', '大宋', 'ceshi3@qq.com');
'''</span>

<span class="token keyword">class</span> <span class="token class-name">Book</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
	title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
	price <span class="token operator">=</span> models<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
	pub_date <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span>
	publish <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span><span class="token string">"Publish"</span><span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
	authors <span class="token operator">=</span> models<span class="token punctuation">.</span>ManyToManyField<span class="token punctuation">(</span><span class="token string">"Author"</span><span class="token punctuation">)</span>
	<span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
		verbose_name <span class="token operator">=</span> <span class="token string">'书籍表'</span>

<span class="token keyword">class</span> <span class="token class-name">Publish</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
	name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
	city <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span>
	email <span class="token operator">=</span> models<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
		verbose_name <span class="token operator">=</span> <span class="token string">'出版社表'</span>

<span class="token keyword">class</span> <span class="token class-name">Author</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
	name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
	age <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span><span class="token punctuation">)</span>
	au_detail <span class="token operator">=</span> models<span class="token punctuation">.</span>OneToOneField<span class="token punctuation">(</span><span class="token string">"AuthorDetail"</span><span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
	<span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
		verbose_name <span class="token operator">=</span> <span class="token string">'作者表'</span>


<span class="token keyword">class</span> <span class="token class-name">AuthorDetail</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
	gender_choices <span class="token operator">=</span> <span class="token punctuation">(</span>
	<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"女"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"男"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"保密"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">)</span>
	gender <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>gender_choices<span class="token punctuation">)</span>
	tel <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
	addr <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span>
	birthday <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
		verbose_name <span class="token operator">=</span> <span class="token string">'作者详情表'</span>
</code></pre> 
<p>urls.py</p> 
<pre><code class="prism language-python">urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
	path<span class="token punctuation">(</span><span class="token string">'books/'</span><span class="token punctuation">,</span>BookListView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
	path<span class="token punctuation">(</span><span class="token string">'books/&lt;int:id&gt;/'</span><span class="token punctuation">,</span>BookDataView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>
</code></pre> 
<p>vuew.py</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> JsonResponse<span class="token punctuation">,</span> HttpResponse
<span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render
<span class="token keyword">from</span> django<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>html <span class="token keyword">import</span> escape
<span class="token comment"># Create your views here.</span>
<span class="token triple-quoted-string string">'''
GET  /books/         提供所有数据
POST /books/         增加一条数据
GET  /books/&lt;pk&gt;/    提供指定id的记录
PUT  /books/&lt;pk&gt;/    修改指定ID的记录
DELETE /books/&lt;pk&gt;/  删除指定id的记录  
'''</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>views <span class="token keyword">import</span> View
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">class</span> <span class="token class-name">BookListView</span><span class="token punctuation">(</span>View<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">'''
	列表视图
	'''</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">'''查询所有数据'''</span>
		<span class="token comment"># 1、查询出所有图书模型</span>
		book_list <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>order_by<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>
		<span class="token comment"># 2、遍历出里面的每个数据模型对象，把模型对象转换成json对象</span>
		data_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
		<span class="token keyword">for</span> book <span class="token keyword">in</span> book_list<span class="token punctuation">:</span>
			book_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
				<span class="token string">'id'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
				<span class="token string">'title'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
				<span class="token string">'price'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
				<span class="token string">'pub_date'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>pub_date<span class="token punctuation">,</span>
				<span class="token string">'publish'</span><span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
					<span class="token string">'id'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
					<span class="token string">'name'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
					<span class="token string">'city'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>city<span class="token punctuation">,</span>
					<span class="token string">'email'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
			<span class="token comment"># 多堆对多</span>
			authors_list <span class="token operator">=</span> book<span class="token punctuation">.</span>authors<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			authors_data_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
			<span class="token keyword">for</span> authors <span class="token keyword">in</span> authors_list<span class="token punctuation">:</span>
				authors_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
						<span class="token string">'id'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
						<span class="token string">'name'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
						<span class="token string">'age'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
						<span class="token string">'gender'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>gender<span class="token punctuation">,</span>
						<span class="token string">'tel'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>tel<span class="token punctuation">,</span>
						<span class="token string">'addr'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>addr<span class="token punctuation">,</span>
				<span class="token punctuation">}</span>
				authors_data_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>authors_dict<span class="token punctuation">)</span>

			book_dict<span class="token punctuation">[</span><span class="token string">'authors'</span><span class="token punctuation">]</span> <span class="token operator">=</span> authors_data_list
			data_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>book_dict<span class="token punctuation">)</span>
		<span class="token comment"># 3、响应</span>
		<span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span>data_list<span class="token punctuation">,</span>safe<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		title <span class="token operator">=</span> escape<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		price <span class="token operator">=</span> escape<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'price'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		pub_date <span class="token operator">=</span> escape<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'pub_date'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		publish_id <span class="token operator">=</span> escape<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'publish_id'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		publish <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>publish_id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>

		book <span class="token operator">=</span> Book<span class="token punctuation">(</span>
			title <span class="token operator">=</span> title<span class="token punctuation">,</span>
			price <span class="token operator">=</span> price<span class="token punctuation">,</span>
			pub_date <span class="token operator">=</span> pub_date<span class="token punctuation">,</span>
			publish <span class="token operator">=</span> publish
		<span class="token punctuation">)</span>
		book<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token comment"># 新增关联</span>
		authors <span class="token operator">=</span> Author<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk__in<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
		book<span class="token punctuation">.</span>authors<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token operator">*</span>authors<span class="token punctuation">)</span>
		book_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
			<span class="token string">'id'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
			<span class="token string">'title'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
			<span class="token string">'price'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
			<span class="token string">'pub_date'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>pub_date<span class="token punctuation">,</span>
			<span class="token string">'publish'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token string">'id'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
				<span class="token string">'name'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
				<span class="token string">'city'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>city<span class="token punctuation">,</span>
				<span class="token string">'email'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
		authors_list <span class="token operator">=</span> book<span class="token punctuation">.</span>authors<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		authors_data_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
		<span class="token keyword">for</span> authors <span class="token keyword">in</span> authors_list<span class="token punctuation">:</span>
			authors_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
				<span class="token string">'id'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
				<span class="token string">'name'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
				<span class="token string">'age'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
				<span class="token string">'gender'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>gender<span class="token punctuation">,</span>
				<span class="token string">'tel'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>tel<span class="token punctuation">,</span>
				<span class="token string">'addr'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>addr<span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
			authors_data_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>authors_dict<span class="token punctuation">)</span>

		book_dict<span class="token punctuation">[</span><span class="token string">'authors'</span><span class="token punctuation">]</span> <span class="token operator">=</span> authors_data_list
		<span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span>book_dict<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">BookDataView</span><span class="token punctuation">(</span>View<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 详情视图 '''</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 指定某个 图书接口'''</span>
		<span class="token comment"># 1、获取出指定id的那个模型对象</span>
		book <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token comment"># 2、模型对象字典</span>
		<span class="token keyword">if</span> <span class="token keyword">not</span> book<span class="token punctuation">:</span>
			<span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'msg'</span><span class="token punctuation">:</span><span class="token string">"未查询到数据"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		book_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
			<span class="token string">'id'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
			<span class="token string">'title'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
			<span class="token string">'price'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
			<span class="token string">'pub_date'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>pub_date<span class="token punctuation">,</span>
			<span class="token string">'publish'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token string">'id'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
				<span class="token string">'name'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
				<span class="token string">'city'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>city<span class="token punctuation">,</span>
				<span class="token string">'email'</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
		authors_list <span class="token operator">=</span> book<span class="token punctuation">.</span>authors<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		authors_data_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
		<span class="token keyword">for</span> authors <span class="token keyword">in</span> authors_list<span class="token punctuation">:</span>
			authors_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
				<span class="token string">'id'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
				<span class="token string">'name'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
				<span class="token string">'age'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
				<span class="token string">'gender'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>gender<span class="token punctuation">,</span>
				<span class="token string">'tel'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>tel<span class="token punctuation">,</span>
				<span class="token string">'addr'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>addr<span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
			authors_data_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>authors_dict<span class="token punctuation">)</span>

		book_dict<span class="token punctuation">[</span><span class="token string">'authors'</span><span class="token punctuation">]</span> <span class="token operator">=</span> authors_data_list
		<span class="token comment"># 3、响应</span>
		<span class="token keyword">return</span>  JsonResponse<span class="token punctuation">(</span>book_dict<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 修改 '''</span>
		<span class="token comment"># 1、先获取前端传入的新数据</span>
		<span class="token comment"># 2、将后端传入的数据就行赋值</span>
		book_obj <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token keyword">not</span> book_obj<span class="token punctuation">:</span>
			<span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'msg'</span><span class="token punctuation">:</span><span class="token string">"未查询到信息"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		title <span class="token operator">=</span> escape<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		price <span class="token operator">=</span> escape<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'price'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		pub_date <span class="token operator">=</span> escape<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'pub_date'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		publish_id <span class="token operator">=</span> escape<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'publish_id'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

		<span class="token keyword">if</span> title<span class="token punctuation">:</span>
			book_obj<span class="token punctuation">.</span>title <span class="token operator">=</span> title
		<span class="token keyword">if</span> price<span class="token punctuation">:</span>
			book_obj<span class="token punctuation">.</span>price <span class="token operator">=</span> price
		<span class="token keyword">if</span> pub_date<span class="token punctuation">:</span>
			book_obj<span class="token punctuation">.</span>pub_date <span class="token operator">=</span> pub_date
		<span class="token keyword">if</span> publish_id<span class="token punctuation">:</span>
			publish <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>publish_id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
			book_obj<span class="token punctuation">.</span>publish <span class="token operator">=</span> publish
		book_obj<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token comment"># 3、返回</span>
		book_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
			<span class="token string">'id'</span><span class="token punctuation">:</span> book_obj<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
			<span class="token string">'title'</span><span class="token punctuation">:</span> book_obj<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
			<span class="token string">'price'</span><span class="token punctuation">:</span> book_obj<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
			<span class="token string">'pub_date'</span><span class="token punctuation">:</span> book_obj<span class="token punctuation">.</span>pub_date<span class="token punctuation">,</span>
			<span class="token string">'publish'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token string">'id'</span><span class="token punctuation">:</span> book_obj<span class="token punctuation">.</span>publish<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
				<span class="token string">'name'</span><span class="token punctuation">:</span> book_obj<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
				<span class="token string">'city'</span><span class="token punctuation">:</span> book_obj<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>city<span class="token punctuation">,</span>
				<span class="token string">'email'</span><span class="token punctuation">:</span> book_obj<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
		authors_list <span class="token operator">=</span> book_obj<span class="token punctuation">.</span>authors<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		authors_data_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
		<span class="token keyword">for</span> authors <span class="token keyword">in</span> authors_list<span class="token punctuation">:</span>
			authors_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
				<span class="token string">'id'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
				<span class="token string">'name'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
				<span class="token string">'age'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
				<span class="token string">'gender'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>gender<span class="token punctuation">,</span>
				<span class="token string">'tel'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>tel<span class="token punctuation">,</span>
				<span class="token string">'addr'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>addr<span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
			authors_data_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>authors_dict<span class="token punctuation">)</span>

		book_dict<span class="token punctuation">[</span><span class="token string">'authors'</span><span class="token punctuation">]</span> <span class="token operator">=</span> authors_data_list
		<span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span>book_dict<span class="token punctuation">)</span>


	<span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 删除 '''</span>
		delete <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'msg'</span><span class="token punctuation">:</span><span class="token string">"删除成功"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/60/2e/DEnbOScj_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/32/e1/XY04JCu7_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f3/f4/8NifPps5_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_298"></a>4、快速上手</h3> 
<p>urls.py</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>routers <span class="token keyword">import</span> DefaultRouter
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
<span class="token keyword">from</span> <span class="token punctuation">.</span>views <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> rest_fromwork_views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

router <span class="token operator">=</span> DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 创建路由器</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'book'</span><span class="token punctuation">,</span>rest_fromwork_views<span class="token punctuation">.</span>BookView<span class="token punctuation">)</span><span class="token comment"># 注册路由</span>
urlpatterns <span class="token operator">+=</span> router<span class="token punctuation">.</span>urls<span class="token comment"># 把生成好的路由拼接到urlpatterns中去</span>
</code></pre> 
<p>views.py</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
GET  /book/         提供所有数据
POST /book/         增加一条数据
GET  /book/&lt;pk&gt;/    提供指定id的记录
PUT  /book/&lt;pk&gt;/    修改指定ID的记录
DELETE /book/&lt;pk&gt;/  删除指定id的记录  
'''</span>
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> ModelViewSet
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">class</span> <span class="token class-name">BookViews</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 定义类视图 '''</span>
	<span class="token comment"># 1、指定查询集  queryset </span>
	queryset <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment"># 2、指定序列化器  serializer_class</span>
	serializer_class <span class="token operator">=</span> BookSerializer
</code></pre> 
<p>serializers.py</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author

<span class="token keyword">class</span> <span class="token class-name">PublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Publish
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>

<span class="token keyword">class</span> <span class="token class-name">AuthorSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Author
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>

<span class="token keyword">class</span> <span class="token class-name">BookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    publish <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    authors <span class="token operator">=</span> AuthorSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Book
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a7/af/tfMH72nE_o.png" alt="在这里插入图片描述"></p> 
<p>浏览器发起请求<br> <img src="https://images2.imgbox.com/6a/52/H3rtSg9m_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_368"></a>二、序列化器</h2> 
<h3><a id="1_370"></a>1、序列化器的作用</h3> 
<h4><a id="11__372"></a>1.1 对数据进行转换</h4> 
<p>序列化（输出、read_only）和反序列化（输入、write_only）</p> 
<h4><a id="12_376"></a>1.2进行数据的校验</h4> 
<p>判断用户发送的数据是否合法（is_valid(raise_exception=True)）</p> 
<h3><a id="2_380"></a>2、序列化器</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author

<span class="token keyword">class</span> <span class="token class-name">PublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Publish
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">AuthorSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Author
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">BookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    publish <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    authors <span class="token operator">=</span> AuthorSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Book
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">NewBookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"ID"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment"># read_only=True只能做输出不能做输入；write_only=True:输入</span>
        title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"标题"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment"># required=True 必传，不写默认 True;只有当模型中 有默认值和允许为空才可以为 False</span>
        price <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"价格"</span><span class="token punctuation">,</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
        pub_date <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span>
        publish <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
        authors <span class="token operator">=</span> AuthorSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="3_409"></a>3、字段与选项</h3> 
<h4><a id="_411"></a>选项参数</h4> 
<table><thead><tr><th>参数名称</th><th>作用</th></tr></thead><tbody><tr><td>max_length</td><td>最大长度</td></tr><tr><td>min_length</td><td>最小长度</td></tr><tr><td>allow_blank</td><td>是否允许为空</td></tr><tr><td>trim_whitespace</td><td>是否截断空白字符</td></tr><tr><td>max_value</td><td>最小值</td></tr><tr><td>min_value</td><td>最大值</td></tr></tbody></table> 
<h4><a id="_422"></a>通用类型</h4> 
<table><thead><tr><th>参数名称</th><th>说明</th></tr></thead><tbody><tr><td>read_only</td><td>表明该字段仅用于序列化输出，默认False</td></tr><tr><td>write_only</td><td>表明该字段仅用于反序列化输入，默认False</td></tr><tr><td>default</td><td>反序列化时使用的默认值</td></tr><tr><td>allow_null</td><td>表明该字段是否允许传入None，默认False</td></tr><tr><td>validators</td><td>该字段使用的验证器</td></tr><tr><td>error_messages</td><td>包含错误编号与错误的信息的字典</td></tr><tr><td>label</td><td>用于HTML展示API页面时，显示的字段名称</td></tr><tr><td>help_text</td><td>用于HTML展示API页面时，显示的字段帮助提示信息</td></tr><tr><td>required</td><td>表明该字段的反序列化时必须虚入，默认值为True</td></tr></tbody></table> 
<h3><a id="4Serializer_436"></a>4、Serializer</h3> 
<p><img src="https://images2.imgbox.com/c7/2b/MoIIXUpb_o.png" alt="在这里插入图片描述"></p> 
<p>反序列化内容 中没有具体的 保存和修改方法，需要自己重写保存和修改方法。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">class</span> <span class="token class-name">NewPublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"ID"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"出版社名称"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    city <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"城市"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> serializers<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"邮箱"</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        使用方法
        NewPublishSerializer（data=data）
        当调用序列化器的 save() 方法时，如果当初创建序列化器对象是没有 instance 传参数
        :param validated_data: 得到的是 反序列化后的字段数据
        :return:
        '''</span>
        <span class="token comment"># 创建内容</span>
        publish <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token operator">**</span>validated_data<span class="token punctuation">)</span>
        <span class="token keyword">return</span> publish

    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        使用方法：
         NewPublishSerializer（instance=publish,data=data）
        重写 update 方法  NewPublishSerializer（instance=publish,data=data）
        如果创建序列化器时给 instance 传了参数，在调用序列化器的 save() 方法时实现时机会调用当前的 update
        :param instance: 要修改的模型对象
        :param validated_data:得到的是 反序列化后的字段数据
        :return: 返回修改后的模型对象
        '''</span>
        instance<span class="token punctuation">.</span>name <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>city <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'city'</span><span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>email <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> instance

</code></pre> 
<h4><a id="_480"></a>新增</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>test <span class="token keyword">import</span> TestCase
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'武当山出版社'</span><span class="token punctuation">,</span>
	<span class="token string">'city'</span><span class="token punctuation">:</span><span class="token string">'武当山'</span><span class="token punctuation">,</span>
	<span class="token string">'email'</span><span class="token punctuation">:</span><span class="token string">'1235698@qq.com'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
serializer <span class="token operator">=</span> NewPublishSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
is_valid <span class="token operator">=</span> serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 调用序列化的校验方法  True 或 False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'校验是否通过is_valid:'</span><span class="token punctuation">,</span>is_valid<span class="token punctuation">)</span>
errors <span class="token operator">=</span> serializer<span class="token punctuation">.</span>errors <span class="token comment"># 获取校验的错误信息</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'校验不通过内容原因errors:'</span><span class="token punctuation">,</span>errors<span class="token punctuation">)</span>
<span class="token comment">#serializer.validated_data # 获取反序列化校验后的数据还是字段</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>validated_data<span class="token punctuation">)</span>
publish <span class="token operator">=</span> serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/11/6a/rFVLiRsT_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_503"></a>修改方法</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'武当山出版社'</span><span class="token punctuation">,</span>
	<span class="token string">'city'</span><span class="token punctuation">:</span><span class="token string">'武当山1111'</span><span class="token punctuation">,</span>
	<span class="token string">'email'</span><span class="token punctuation">:</span><span class="token string">'1235698@qq.com'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
publish_obj <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 调用</span>
serializer <span class="token operator">=</span> NewPublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>publish_obj<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
is_valid <span class="token operator">=</span> serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
publish <span class="token operator">=</span> serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/76/9f/IVrcRSI8_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_521"></a>说明</h4> 
<p>调用序列化器的 <strong>.save()</strong> 方法，调用save 时会判断当初始创建序列化器时是否传入 instance ,如果传了 instance 也传了data 那么调用 <strong>save</strong> 实际调用序列化器中的 <strong>update()</strong> 方法反之就是调用序列化器中的 <strong>create</strong> 方法。</p> 
<h3><a id="5ModelSerializer_525"></a>5、ModelSerializer</h3> 
<p>如果我们想要使用序列化器对应的是django的模型类，DRF为我们提供了<strong>ModelSerializer</strong>模型类序列化器来帮助我们快速创建一个Serializer类。</p> 
<p><strong>ModelSerilizer</strong>与常规的<strong>Serializer</strong> 相同，但提供了：</p> 
<ul><li>ModelSerializer可以工具模型自动生成序列化器中的字段</li><li>ModelSerializer它里面已经帮我们实现了create和update方法</li></ul> 
<h4><a id="1_534"></a>1、定义</h4> 
<p>创建BookSerializer</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author<span class="token punctuation">,</span>AuthorDetail
<span class="token keyword">class</span> <span class="token class-name">PublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Publish
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">AuthorSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Author
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">BookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    publish <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 外键</span>
    authors <span class="token operator">=</span> AuthorSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment"># 多对多</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Book
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
</code></pre> 
<ul><li><strong>model</strong> 指明参照那个模型类</li><li><strong>fields</strong> 指明为模型类的哪些字段生成</li></ul> 
<p>通过 ModelSerializer 实现字段自动生成</p> 
<p><img src="https://images2.imgbox.com/80/80/ERlfF26M_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="11_fields_565"></a>1.1 fields</h5> 
<p>只要一部分字段实现<strong>方法1 fields</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author<span class="token punctuation">,</span>AuthorDetail
<span class="token keyword">class</span> <span class="token class-name">PublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Publish
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">AuthorSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Author
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">AuthorDetailSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> AuthorDetail
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">BookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    publish <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    authors <span class="token operator">=</span> AuthorSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Book
        <span class="token comment"># fields = '__all__' # 全部字段</span>
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token string">'title'</span><span class="token punctuation">,</span><span class="token string">'publish'</span><span class="token punctuation">,</span><span class="token string">'authors'</span><span class="token punctuation">]</span><span class="token comment"># 只要list中的字段</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6b/57/b2OnU4mB_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="12_exclude_595"></a>1.2 exclude</h5> 
<p>只要一部分字段实现<strong>方法2 exclude</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author<span class="token punctuation">,</span>AuthorDetail
<span class="token keyword">class</span> <span class="token class-name">PublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Publish
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">AuthorSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Author
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">AuthorDetailSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> AuthorDetail
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">BookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    publish <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    authors <span class="token operator">=</span> AuthorSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Book
        <span class="token comment"># fields = '__all__' # 全部字段</span>
        <span class="token comment"># fields = ['id','title','publish','authors']# 只要list中的字段</span>
        exclude <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'pub_date'</span><span class="token punctuation">]</span> <span class="token comment">#除了 pub_date 字段不映射 其他字段都要</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/50/8b/dKhi7LMP_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="13_extra_kwargs_627"></a>1.3 extra_kwargs</h5> 
<p>其中自动生成的 字段中有些默认值会出现 问题例如 authors 中的 age字段 最小值是 -32768 在实际中最小值不可能小于0因此可以通过 extra_kwargs 来进行自定义限制</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author<span class="token punctuation">,</span>AuthorDetail
<span class="token keyword">class</span> <span class="token class-name">AuthorSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Author
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
        <span class="token comment"># 对 额外的字段进行修改</span>
        extra_kwargs <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'age'</span><span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span><span class="token string">'min_value'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token comment"># age 是对应字段名，min_value 对应的校验属性，都是以字典的形式</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/91/d7/umxXDMuJ_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="14_read_only_fields_647"></a>1.4 read_only_fields</h5> 
<p>只对某些字段进行序列化</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author<span class="token punctuation">,</span>AuthorDetail
<span class="token keyword">class</span> <span class="token class-name">AuthorSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Author
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
        <span class="token comment"># 对 额外的字段进行修改</span>
        <span class="token comment"># extra_kwargs = {<!-- --></span>
        <span class="token comment">#     'age':{'min_value':0}</span>
        <span class="token comment"># }</span>
        read_only_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span> <span class="token comment"># 只对某些字段进行序列化</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f2/31/1ztuN98F_o.png" alt="在这里插入图片描述"></p> 
<p>我们可以在python manage.py shell 中查看自动生成的 BookSerializer 的具体实现</p> 
<p>我们可以在python manage.py shell 中查看自动生成的 BookSerializer 的具体实现</p> 
<h3><a id="_674"></a>三、序列化</h3> 
<p>提供了定义序列化器Serializer的方法，可以快速根据 Django ORM 或者其他库自动和反序列化；</p> 
<p>提供了丰富的类视图、Mixin扩展类，简化视图的编写；</p> 
<p>丰富的定制层级：函数视图、类视图、视图集合到自动生成API，满足各种需求；</p> 
<p>多种身份认证和权限认证的支持；</p> 
<p>内置限流系统；</p> 
<p>只管的API web界面；</p> 
<p>扩展性，插件丰富；</p> 
<p><strong>序列化器的作用：</strong></p> 
<pre><code>1、进行数据的校验。
2、对数据对象进行转换。
</code></pre> 
<h3><a id="1_697"></a>1、提示</h3> 
<p>在开发REST API 接口时，视图中的主要有三件事：</p> 
<ol><li>将 请求的数据（如JSON格式）转换为模型类对象（反序列化）</li><li>操作数据库</li><li>将模型类对象转换为响应的数据（如JSON格式）（序列化）</li></ol> 
<h3><a id="2Serializer_707"></a>2、序列化（Serializer）</h3> 
<h4><a id="21__709"></a>2.1 概念</h4> 
<p>将程序中的一个数据结构类型转换为其他格式（字典、JSON、XML等）</p> 
<h4><a id="22__713"></a>2.2 序列化行为</h4> 
<pre><code class="prism language-python"><span class="token keyword">for</span> book <span class="token keyword">in</span> book_list<span class="token punctuation">:</span>
    book_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'id'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
        <span class="token string">'title'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
        <span class="token string">'price'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
        <span class="token string">'pub_date'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>pub_date<span class="token punctuation">,</span>
        <span class="token string">'publish'</span><span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
            <span class="token string">'id'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
            <span class="token string">'name'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            <span class="token string">'city'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>city<span class="token punctuation">,</span>
            <span class="token string">'email'</span><span class="token punctuation">:</span>book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># 多对多</span>
    authors_list <span class="token operator">=</span> book<span class="token punctuation">.</span>authors<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    authors_data_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> authors <span class="token keyword">in</span> authors_list<span class="token punctuation">:</span>
        authors_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'id'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
            <span class="token string">'name'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            <span class="token string">'age'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
            <span class="token string">'gender'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>gender<span class="token punctuation">,</span>
            <span class="token string">'tel'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>tel<span class="token punctuation">,</span>
            <span class="token string">'addr'</span><span class="token punctuation">:</span> authors<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>addr<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        authors_data_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>authors_dict<span class="token punctuation">)</span>

book_dict<span class="token punctuation">[</span><span class="token string">'authors'</span><span class="token punctuation">]</span> <span class="token operator">=</span> authors_data_list
data_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>book_dict<span class="token punctuation">)</span>
<span class="token comment"># 3、响应</span>
<span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span>data_list<span class="token punctuation">,</span>safe<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="23_749"></a>2.3序列化时机</h4> 
<p>当前端需给前端响应模型数据时，需要将模型数据序列化成前端需要的格式。</p> 
<h4><a id="24__753"></a>2.4 使用方式</h4> 
<p>在序列化器中有两个属性 <strong>instance</strong> 和 <strong>data</strong>；</p> 
<p>instance参数： 模型、查询集、字典</p> 
<pre><code class="prism language-python"><span class="token comment">#如果只给  instance 形参传递参数表示做序列化</span>
serializer <span class="token operator">=</span> BookSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">)</span>
serializer<span class="token punctuation">.</span>data <span class="token comment"># 就可以获取序列化后的数据</span>
</code></pre> 
<p><strong>测试一</strong></p> 
<p>tests.py</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>test <span class="token keyword">import</span> TestCase
<span class="token comment"># Create your tests here.</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
datas <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"查询出的数据内容有多少条："</span><span class="token punctuation">,</span>datas<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
serializer <span class="token operator">=</span> NewBookSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>datas<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment"># many=True:表示有多条数据，当只有一条数据的时候就不用many=False;默认many=False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
<span class="token comment"># 执行上述代码使用</span>
<span class="token triple-quoted-string string">'''
python manage.py test
'''</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/29/74/m42aYbeE_o.png" alt="在这里插入图片描述"></p> 
<p><strong>测试二</strong></p> 
<p>在序列化器中多增加一列</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''serializers.py'''</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">class</span> <span class="token class-name">NewBookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"标题"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
    price <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"价格"</span><span class="token punctuation">,</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
    pub_date <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    publish <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    authors <span class="token operator">=</span> AuthorSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    helle <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 多余字段</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''tests.py'''</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>test <span class="token keyword">import</span> TestCase
<span class="token comment"># Create your tests here.</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>helle <span class="token operator">=</span> <span class="token string">"测试多增加字段内容"</span>
<span class="token comment"># print("查询出的数据内容有多少条：",data.count())</span>
serializer <span class="token operator">=</span> NewBookSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token comment"># many=True:表示有多条数据，当只有一条数据的时候就不用many</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
python manage.py test
'''</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/28/92/Soq5tKzO_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="25__825"></a>2.5 外键序列化器</h4> 
<h5><a id="251_PrimaryKeyRelatedField_827"></a>2.5.1 <strong>PrimaryKeyRelatedField</strong>（正向）</h5> 
<p>主要字段 serializers.<strong>PrimaryKeyRelatedField</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">NewBookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"标题"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
    price <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"价格"</span><span class="token punctuation">,</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
    pub_date <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># read_only = True :只做序列化</span>
    <span class="token comment"># queryset=Publish.objects.all() 当输入查询时不是Publish这里面的数据就会 报错</span>
    <span class="token comment"># PrimaryKeyRelatedField 外键关联</span>
    publish <span class="token operator">=</span> serializers<span class="token punctuation">.</span>PrimaryKeyRelatedField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"出版社"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>queryset<span class="token operator">=</span>Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>helle <span class="token operator">=</span> <span class="token string">"测试多增加字段内容"</span>
<span class="token comment"># print("查询出的数据内容有多少条：",data.count())</span>
serializer <span class="token operator">=</span> NewBookSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token comment"># many=True:表示有多条数据，当只有一条数据的时候就不用many</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5b/2e/nCaHpdi4_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>**注意：**默认是将 关联的id查询出来。</p> 
</blockquote> 
<h5><a id="252_StringRelatedField_860"></a>2.5.2 <strong>StringRelatedField（正向）</strong></h5> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">NewBookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"标题"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
    price <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"价格"</span><span class="token punctuation">,</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
    pub_date <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># read_only = True :只做序列化</span>
    <span class="token comment"># queryset=Publish.objects.all() 当输入查询时不是Publish这里面的数据就会 报错</span>
    <span class="token comment"># PrimaryKeyRelatedField 外键关联</span>
    publish <span class="token operator">=</span> serializers<span class="token punctuation">.</span>StringRelatedField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"出版社"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token comment"># publish = PublishSerializer()</span>
    <span class="token comment"># authors = AuthorSerializer(many=True)</span>
    <span class="token comment"># helle = serializers.CharField()# 多余字段</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>test <span class="token keyword">import</span> TestCase
<span class="token comment"># Create your tests here.</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>helle <span class="token operator">=</span> <span class="token string">"测试多增加字段内容"</span>
<span class="token comment"># print("查询出的数据内容有多少条：",data.count())</span>
serializer <span class="token operator">=</span> NewBookSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token comment"># many=True:表示有多条数据，当只有一条数据的时候就不用many</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9d/bb/HfMiHtLm_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>**注意：**返回值是 对象 obje (*) 的字符串</p> 
</blockquote> 
<h5><a id="253___894"></a>2.5.3 外键序列化器（正向）</h5> 
<p>将关联模型对象的序列化器中所有字段序列化出来</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author

<span class="token keyword">class</span> <span class="token class-name">PublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Publish
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">NewBookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"标题"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
    price <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"价格"</span><span class="token punctuation">,</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
    pub_date <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># read_only = True :只做序列化</span>
    <span class="token comment"># queryset=Publish.objects.all() 当输入查询时不是Publish这里面的数据就会 报错</span>
    <span class="token comment"># PrimaryKeyRelatedField 外键关联</span>
    <span class="token comment"># publish = serializers.StringRelatedField(label="出版社",read_only=True)</span>
    publish <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># authors = AuthorSerializer(many=True)</span>
    <span class="token comment"># helle = serializers.CharField()# 多余字段</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/13/c5/fYU8xCF0_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="254___923"></a>2.5.4 外键反向序列化</h5> 
<p>出版社反向获取 书籍；</p> 
<pre><code class="prism language-python"><span class="token comment"># coding=utf-8</span>
<span class="token triple-quoted-string string">'''
@date：2023/11/15 11:48
@mail：xiaochun235@qq.com
@Content: 序列化器
'''</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author

<span class="token keyword">class</span> <span class="token class-name">AuthorSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Author
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">NewBookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"标题"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
    price <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"价格"</span><span class="token punctuation">,</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
    pub_date <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># publish = PublishSerializer()</span>
    <span class="token comment"># authors = AuthorSerializer(many=True)</span>
    <span class="token comment"># helle = serializers.CharField()# 多余字段</span>

<span class="token keyword">class</span> <span class="token class-name">NewPublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"ID"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"出版社名称"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    city <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"城市"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> serializers<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"邮箱"</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    book_set <span class="token operator">=</span> NewBookSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 注意</span>

</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>test <span class="token keyword">import</span> TestCase
<span class="token comment"># Create your tests here.</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>helle <span class="token operator">=</span> <span class="token string">"测试多增加字段内容"</span>
<span class="token comment"># print("查询出的数据内容有多少条：",data.count())</span>
serializer <span class="token operator">=</span> NewPublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token comment"># many=True:表示有多条数据，当只有一条数据的时候就不用many</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/15/33/mIOtdMR9_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>**注意：**使用 modesel名小写 + _set</p> 
</blockquote> 
<h4><a id="26__978"></a>2.6 多对多序列化</h4> 
<h5><a id="261__980"></a>2.6.1 使用对应的序列化器（正向）</h5> 
<pre><code class="prism language-python"><span class="token comment"># coding=utf-8</span>
<span class="token triple-quoted-string string">'''
@date：2023/11/15 11:48
@mail：xiaochun235@qq.com
@Content: 序列化
'''</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author
<span class="token keyword">class</span> <span class="token class-name">PublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Publish
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">AuthorSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Author
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
<span class="token keyword">class</span> <span class="token class-name">NewBookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"标题"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
    price <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"价格"</span><span class="token punctuation">,</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
    pub_date <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    publish <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    authors <span class="token operator">=</span> AuthorSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment"># 注意多对多 时 many=True</span>
    <span class="token comment"># helle = serializers.CharField()# 多余字段</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>test <span class="token keyword">import</span> TestCase
<span class="token comment"># Create your tests here.</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>helle <span class="token operator">=</span> <span class="token string">"测试多增加字段内容"</span>
<span class="token comment"># print("查询出的数据内容有多少条：",data.count())</span>
serializer <span class="token operator">=</span> NewBookSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token comment"># many=True:表示有多条数据，当只有一条数据的时候就不用many</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2f/b6/B6Yt3byf_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="262____1026"></a>2.6.2 多对多 （反向）</h5> 
<pre><code class="prism language-python"><span class="token comment"># coding=utf-8</span>
<span class="token triple-quoted-string string">'''
@date：2023/11/15 11:48
@mail：xiaochun235@qq.com
@Content: 序列化器
'''</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author<span class="token punctuation">,</span>AuthorDetail

<span class="token keyword">class</span> <span class="token class-name">PublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Publish
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>

<span class="token keyword">class</span> <span class="token class-name">AuthorDetailSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> AuthorDetail
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>

<span class="token keyword">class</span> <span class="token class-name">NewBookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"标题"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
    price <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"价格"</span><span class="token punctuation">,</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
    pub_date <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># publish = PublishSerializer()</span>
    <span class="token comment"># authors = AuthorSerializer(many=True)</span>
    <span class="token comment"># helle = serializers.CharField()# 多余字段</span>

<span class="token keyword">class</span> <span class="token class-name">NewAuthSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"姓名"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
    age <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"年龄"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
    au_detail <span class="token operator">=</span> AuthorDetailSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    book_set <span class="token operator">=</span> NewBookSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>test <span class="token keyword">import</span> TestCase
<span class="token comment"># Create your tests here.</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> Author<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>helle <span class="token operator">=</span> <span class="token string">"测试多增加字段内容"</span>
<span class="token comment"># print("查询出的数据内容有多少条：",data.count())</span>
serializer <span class="token operator">=</span> NewAuthSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token comment"># many=True:表示有多条数据，当只有一条数据的时候就不用many</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/47/bf/5JyTg8Wy_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>注意：</strong> 反向序列化使用 模型名+_set 即可</p> 
</blockquote> 
<h4><a id="_1086"></a>总结</h4> 
<ol><li><strong>注意 many 的使用，many默认为 False；当需要序列化多个是记得 Many=True;</strong></li><li><strong>注意需求，序列化的反向正向；</strong></li><li><strong>将模型转换为JSON数据步骤：</strong> 
  <ol><li>定义序列化器类（模型名 / 类视图名+Serializer） 继承 Sarializer;</li><li>定义序列化器中的字段参照模型（序列化器中的字段可以比模型多或少 如果表示是模型中的字段在序列化器中这个字段名应该和模型中字段名一致）</li></ol> </li><li><strong>如果在多里面关联序列化一（外键）如果在一里面关联序列化多（多的一方模型小写_set）</strong></li><li><strong>如果在一的一方关联序列化多时，需要指定关联字段many=True</strong></li><li><strong>将要序列化模型或查询集 传给序列化器类的 instance 参数 如果传的是查询集 多指定 many=True</strong></li><li><strong>获取序列化后的数据 序列化器对象 .data 属性</strong></li></ol> 
<h3><a id="3Serializer_1102"></a>3、反序列化(Serializer)</h3> 
<p>拿到前端传入的数据 —》 序列化器的data --》 调用序列化器的 .is_valid() 方法进行校验 —》 调用序列化器的 .save() 方法。</p> 
<h4><a id="31__1106"></a>3.1 概念</h4> 
<p>将其他格式（字典、JSON、XML等）转换为程序中的数据，例如JSON字符串转换为django中的模型类对象。</p> 
<h4><a id="32_1110"></a>3.2反序列化行为</h4> 
<pre><code class="prism language-python">title <span class="token operator">=</span> escape<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
price <span class="token operator">=</span> escape<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'price'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pub_date <span class="token operator">=</span> escape<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'pub_date'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
publish_id <span class="token operator">=</span> escape<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'publish_id'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
publish <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>publish_id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
book <span class="token operator">=</span> Book<span class="token punctuation">(</span>
    title <span class="token operator">=</span> title<span class="token punctuation">,</span>
    price <span class="token operator">=</span> price<span class="token punctuation">,</span>
    pub_date <span class="token operator">=</span> pub_date<span class="token punctuation">,</span>
    publish <span class="token operator">=</span> publish
<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="33__1126"></a>3.3 反序列化时机</h4> 
<p>当需要将用户发送的数据存储到数据库之前，需要使用反序列化。</p> 
<h4><a id="34__1130"></a>3.4 使用方式</h4> 
<p>在序列化器中有两个属性 <strong>instance</strong> 和 <strong>data</strong>；</p> 
<pre><code>#如果只给  instance 形参传递参数表示做序列化
serializer = BookSerializer(data=jsondata)
serializer.data # 就可以获取反序列化数据
</code></pre> 
<p>反序列化 = 前端发送的数据 —》 经过验证 --》python字典 —》 save --》 模型对象</p> 
<p>**案例使用 Serializer **</p> 
<p>反序列化内容 中没有具体的 保存和修改方法，需要自己重写保存和修改方法。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">class</span> <span class="token class-name">NewPublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"ID"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"出版社名称"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    city <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"城市"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> serializers<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"邮箱"</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        使用方法
        NewPublishSerializer（data=data）
        当调用序列化器的 save() 方法时，如果当初创建序列化器对象是没有 instance 传参数
        :param validated_data: 得到的是 反序列化后的字段数据
        :return:
        '''</span>
        <span class="token comment"># 创建内容</span>
        publish <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token operator">**</span>validated_data<span class="token punctuation">)</span>
        <span class="token keyword">return</span> publish

    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        使用方法：
         NewPublishSerializer（instance=publish,data=data）
        重写 update 方法  NewPublishSerializer（instance=publish,data=data）
        如果创建序列化器时给 instance 传了参数，在调用序列化器的 save() 方法时实现时机会调用当前的 update
        :param instance: 要修改的模型对象
        :param validated_data:得到的是 反序列化后的字段数据
        :return: 返回修改后的模型对象
        '''</span>
        instance<span class="token punctuation">.</span>name <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>city <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'city'</span><span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>email <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> instance

</code></pre> 
<p><strong>新增</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>test <span class="token keyword">import</span> TestCase
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'武当山出版社'</span><span class="token punctuation">,</span>
	<span class="token string">'city'</span><span class="token punctuation">:</span><span class="token string">'武当山'</span><span class="token punctuation">,</span>
	<span class="token string">'email'</span><span class="token punctuation">:</span><span class="token string">'1235698@qq.com'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
serializer <span class="token operator">=</span> NewPublishSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
is_valid <span class="token operator">=</span> serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 调用序列化的校验方法  True 或 False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'校验是否通过is_valid:'</span><span class="token punctuation">,</span>is_valid<span class="token punctuation">)</span>
errors <span class="token operator">=</span> serializer<span class="token punctuation">.</span>errors <span class="token comment"># 获取校验的错误信息</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'校验不通过内容原因errors:'</span><span class="token punctuation">,</span>errors<span class="token punctuation">)</span>
<span class="token comment">#serializer.validated_data # 获取反序列化校验后的数据还是字段</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>validated_data<span class="token punctuation">)</span>
publish <span class="token operator">=</span> serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/20/7d/IdaL5xhL_o.png" alt="在这里插入图片描述"></p> 
<p><strong>修改方法</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'武当山出版社'</span><span class="token punctuation">,</span>
	<span class="token string">'city'</span><span class="token punctuation">:</span><span class="token string">'武当山1111'</span><span class="token punctuation">,</span>
	<span class="token string">'email'</span><span class="token punctuation">:</span><span class="token string">'1235698@qq.com'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
publish_obj <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 调用</span>
serializer <span class="token operator">=</span> NewPublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>publish_obj<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
is_valid <span class="token operator">=</span> serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
publish <span class="token operator">=</span> serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/0f/31/4FHFkbsy_o.png" alt="在这里插入图片描述"></p> 
<p>调用序列化器的 <strong>.save()</strong> 方法，调用save 时会判断当初始创建序列化器时是否传入 instance ,如果传了 instance 也传了data 那么调用 <strong>save</strong> 实际调用序列化器中的 <strong>update()</strong> 方法反之就是调用序列化器中的 <strong>create</strong> 方法。</p> 
<h4><a id="34_1229"></a>3.4、要属性和方法</h4> 
<h5><a id="1_is_valid_1231"></a>1 is_valid()</h5> 
<p>在获取反序列化的数据前，必须调用 is_valid() 方法进行验证，验证成功返回True，否则返回False</p> 
<h5><a id="2error__1235"></a>2error 属性</h5> 
<p>验证失败，可以通过序列化器对象的error属性获取错误学习，返回字典，包含了字段和字 段的错误。</p> 
<h5><a id="3validated_data_1239"></a>3validated_data属性</h5> 
<p>验证成功，可以通过序列化器对象的 validated_data 属性获取数据。</p> 
<h5><a id="4context__1243"></a>4context 参数是额外的添加数据</h5> 
<pre><code class="prism language-python"><span class="token comment"># 可以通过序列化器 进行context 进行传输数据</span>
publish <span class="token operator">=</span> NewPublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>context<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'request'</span><span class="token punctuation">:</span>request<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># 获取context 中的数据</span>
<span class="token keyword">class</span> <span class="token class-name">NewPublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"ID"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"出版社名称"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>
                                 required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>validators<span class="token operator">=</span><span class="token punctuation">[</span>custom_fun1<span class="token punctuation">,</span>custom_fun2<span class="token punctuation">]</span>
                                 <span class="token punctuation">)</span>
    city <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"城市"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> serializers<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"邮箱"</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        当调用序列化器的 save() 方法时，如果当初创建序列化器对象是没有 instance 传参数
        :param validated_data: 得到的是 反序列化后的字段数据
        :return:
        '''</span>
        <span class="token comment"># 创建内容</span>
        publish <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token operator">**</span>validated_data<span class="token punctuation">)</span>
        <span class="token keyword">return</span> publish

    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        重写 update 方法
        如果创建序列化器时给 instance 传了参数，在调用序列化器的 save() 方法时实现时机会调用当前的 update
        :param instance: 要修改的模型对象
        :param validated_data:得到的是 反序列化后的字段数据
        :return: 返回修改后的模型对象
        '''</span>
        request <span class="token operator">=</span> self<span class="token punctuation">.</span>context<span class="token punctuation">[</span><span class="token string">'request'</span><span class="token punctuation">]</span>
        instance<span class="token punctuation">.</span>name <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>city <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'city'</span><span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>email <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> instance
</code></pre> 
<h4><a id="35_1285"></a>3.5、反序列化自定义校验字段</h4> 
<h5><a id="1_validate__1287"></a>1 单个字段校验（validate_+字段名称）</h5> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">NewPublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"ID"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"出版社名称"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    city <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"城市"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> serializers<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"邮箱"</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token comment"># 序列化器中单独增加校验逻辑</span>
    <span class="token keyword">def</span> <span class="token function">validate_name</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        复杂校验内容数据   validate_+字段名称
        :param value:  当前字段值
        :return: 返回value
        '''</span>
        <span class="token keyword">if</span> <span class="token string">'出版社'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> value<span class="token punctuation">:</span>
            <span class="token comment"># 只要在序列化器中  抛出的异常都叫做  ValidationError 异常</span>
            <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span><span class="token string">'名称中不包含 出版社等字'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> value <span class="token comment"># 将校验内容返回回去</span>
</code></pre> 
<p>测试代码</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'武当'</span><span class="token punctuation">,</span>
	<span class="token comment"># 'city':'武当山',</span>
	<span class="token string">'email'</span><span class="token punctuation">:</span><span class="token string">'1235698@qq.com'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
serializer <span class="token operator">=</span> NewPublishSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
is_valid <span class="token operator">=</span> serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 调用序列化的校验方法  True 或 False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'校验是否通过is_valid:'</span><span class="token punctuation">,</span>is_valid<span class="token punctuation">)</span>
<span class="token comment">#is_valid2 = serializer.is_valid(raise_exception=True)# raise_exception=True 如果有异常会自动输出异常# 就不用在.error 获取异常</span>
<span class="token comment">#print('校验是否通过is_valid2:',is_valid2)</span>
errors <span class="token operator">=</span> serializer<span class="token punctuation">.</span>errors <span class="token comment"># 获取校验的错误信息</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'校验不通过内容原因errors:'</span><span class="token punctuation">,</span>errors<span class="token punctuation">)</span>
serializer<span class="token punctuation">.</span>validated_data <span class="token comment"># 获取反序列化校验后的数据还是字段</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/e5/c3/pyn4iFEE_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="2_validate_1332"></a>2多个字段联合校验（ validate）</h5> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">NewPublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"ID"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"出版社名称"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    city <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"城市"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> serializers<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"邮箱"</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">validate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>attrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        同时校验多个字段  联合校验
        :param attrs: 里面是前端 传入过来的所有数据
        :return: 返回数据
        # 在联合校验中，可以对单个字段进行校验也可以对多个字段进行校验
        # 也可以对在传入的字段中增加 一个属性
        '''</span>
        name <span class="token operator">=</span> attrs<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>attrs<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">'出版社'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> name<span class="token punctuation">:</span>
            <span class="token comment"># 只要在序列化器中  抛出的异常都叫做  ValidationError 异常</span>
            <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span><span class="token string">'名称中不包含 出版社等字'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> attrs
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'武当'</span><span class="token punctuation">,</span>
	<span class="token string">'city'</span><span class="token punctuation">:</span><span class="token string">'武当山'</span><span class="token punctuation">,</span>
	<span class="token string">'email'</span><span class="token punctuation">:</span><span class="token string">'1235698@qq.com'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
serializer <span class="token operator">=</span> NewPublishSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
is_valid <span class="token operator">=</span> serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 调用序列化的校验方法  True 或 False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'校验是否通过is_valid:'</span><span class="token punctuation">,</span>is_valid<span class="token punctuation">)</span>
errors <span class="token operator">=</span> serializer<span class="token punctuation">.</span>errors <span class="token comment"># 获取校验的错误信息</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'校验不通过内容原因errors:'</span><span class="token punctuation">,</span>errors<span class="token punctuation">)</span>
<span class="token comment"># serializer.validated_data # 获取反序列化校验后的数据还是字段</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/77/84/0TGGDrBD_o.png" alt="在这里插入图片描述"></p> 
<p><strong>注意：</strong></p> 
<ul><li>校验字段 统一写法为 validate_+字段名称；</li><li>校验不通过统一抛出异常：serializers.ValidationError()；</li><li>校验顺序：序列化器中定义的校验先开始，才走 单个字段校验，最后才是联合校验；</li></ul> 
<h5><a id="3__validators_1380"></a>3 自定义方法校验（validators参数）</h5> 
<p>在字段中添加 validators 选项参数，可以补充验证行为；</p> 
<p>**使用：**当多个字段存在相同的校验就可以使用自定义的方法校验。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">custom_fun1</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">'出版社'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> value<span class="token punctuation">:</span>
        <span class="token comment"># 只要在序列化器中  抛出的异常都叫做  ValidationError 异常</span>
        <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span><span class="token string">'名称中不包含 出版社等字'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> value
<span class="token keyword">def</span> <span class="token function">custom_fun2</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">'python'</span> <span class="token keyword">in</span> value<span class="token punctuation">:</span>
        <span class="token comment"># 只要在序列化器中  抛出的异常都叫做  ValidationError 异常</span>
        <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span><span class="token string">'名称中不能包含 python'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> value

<span class="token keyword">class</span> <span class="token class-name">NewPublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"ID"</span><span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"出版社名称"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>
                                 required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>validators<span class="token operator">=</span><span class="token punctuation">[</span>custom_fun1<span class="token punctuation">,</span>custom_fun2<span class="token punctuation">]</span>
                                 <span class="token punctuation">)</span>
    city <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"城市"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> serializers<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"邮箱"</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>test <span class="token keyword">import</span> TestCase
<span class="token keyword">from</span> demo_app<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'武当python'</span><span class="token punctuation">,</span>
	<span class="token string">'city'</span><span class="token punctuation">:</span><span class="token string">'武当山'</span><span class="token punctuation">,</span>
	<span class="token string">'email'</span><span class="token punctuation">:</span><span class="token string">'1235698@qq.com'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
serializer <span class="token operator">=</span> NewPublishSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
is_valid <span class="token operator">=</span> serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 调用序列化的校验方法  True 或 False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'校验是否通过is_valid:'</span><span class="token punctuation">,</span>is_valid<span class="token punctuation">)</span>
errors <span class="token operator">=</span> serializer<span class="token punctuation">.</span>errors <span class="token comment"># 获取校验的错误信息</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'校验不通过内容原因errors:'</span><span class="token punctuation">,</span>errors<span class="token punctuation">)</span>
<span class="token comment"># serializer.validated_data # 获取反序列化校验后的数据还是字段</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/67/8b/hNJbzTLB_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_1428"></a>4、总结</h3> 
<p>在开发REST API接口时，我们在视图中需要做的最核心的事是：</p> 
<ul><li>将数据库数据序列化为前端所需要的格式并返回；</li><li>将前端发送的数据反序列化为模型类对象，并保存到数据库中；</li><li>反序列化步骤： 
  <ul><li>获取前端楚然的缴纳字典数据；</li><li>创建序列化器给序列化器的 data参数传参（要以关键字方式传递）；</li><li>调用序列化器的 .is_valid(raise_excption=True)进行校验，如果校验出错会自动抛出错误信息；</li><li>如果校验成功，就调用save() 方法。（当调用序列化器的save方法时，会执行序列化器中的 create方法或update方法。如果要使用update方法那么就需要将 BookSerializer(instance=book,data=data)，只有传了模型此时修改，否则就是新增。）查看序列化器的；</li></ul> </li><li>使用<strong>Serializer</strong>构造序列化器时，调用序列化器的 <strong>.save()</strong> 方法，调用save 时会判断当初始创建序列化器时是否传入 instance ,如果传了 instance 也传了data 那么调用 <strong>save</strong> 实际调用序列化器中的 <strong>update()</strong> 方法反之就是调用序列化器中的 <strong>create</strong> 方法。（代码实现：四 --》 4 Serializer）；</li><li>反序列化会自动完成序列化；</li><li>序列化就是将模型转为字典；</li></ul> 
<h2><a id="_1445"></a>其他笔记</h2> 
<h3><a id="_1446"></a>序列化器</h3> 
<h3><a id="httpsblogcsdnnetweixin_51715424articledetails134681622_1447"></a><a href="https://blog.csdn.net/weixin_51715424/article/details/134681622">视图路由</a></h3>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7f256c7f6915f319e822625e61d19d81/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">OpenCV快速入门：彩蛋——小游戏制作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/32d81269b55019db66393fa8b2da6036/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">rest_framework_django 学习笔记二（视图路由）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>