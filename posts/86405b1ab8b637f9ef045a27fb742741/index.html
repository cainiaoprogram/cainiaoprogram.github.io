<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android13音频录制适配 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android13音频录制适配" />
<meta property="og:description" content="Android13音频录制适配 前言： 之前写过一篇音频录制的文章，当时是在Android10以下的手机可以成功录制和播放，但是Android10及以上手机提示创建文件失败，最近做过Android13的适配，索性一起把之前的录音也适配了，记录一下适配的过程。
1.Manifest添加Android13文件读写适配： &lt;!--存储图像或者视频权限--&gt; &lt;uses-permission android:name=&#34;android.permission.READ_EXTERNAL_STORAGE&#34; android:maxSdkVersion=&#34;32&#34; /&gt; &lt;uses-permission android:name=&#34;android.permission.WRITE_EXTERNAL_STORAGE&#34; tools:ignore=&#34;ScopedStorage&#34; android:maxSdkVersion=&#34;32&#34;/&gt; &lt;!--录制音频权限--&gt; &lt;uses-permission android:name=&#34;android.permission.READ_MEDIA_AUDIO&#34;/&gt; &lt;uses-permission android:name=&#34;android.permission.READ_MEDIA_VIDEO&#34;/&gt; &lt;uses-permission android:name=&#34;android.permission.READ_MEDIA_IMAGES&#34;/&gt; 2.Android13文件读写权限请求： private void requestBasicPermission() { final RxPermissions rxPermissions = new RxPermissions(this); StringBuilder rationaleSb = new StringBuilder(); StringBuilder deniedSb = new StringBuilder(); if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.TIRAMISU) { permissions = new String[]{ Manifest.permission.READ_MEDIA_AUDIO, Manifest.permission.READ_MEDIA_VIDEO, Manifest.permission.READ_MEDIA_IMAGES, Manifest.permission.RECORD_AUDIO, }; } else { permissions = new String[]{ Manifest.permission.RECORD_AUDIO, Manifest.permission.WRITE_EXTERNAL_STORAGE,}; } rxPermissions.requestEach(permissions).subscribe(new Observer&lt;Permission&gt;() { @Override public void onSubscribe(@NonNull Disposable d) { } @Override public void onNext(@NonNull Permission permission) { if (permission." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/86405b1ab8b637f9ef045a27fb742741/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-18T19:07:56+08:00" />
<meta property="article:modified_time" content="2023-12-18T19:07:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android13音频录制适配</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Android13_0"></a>Android13音频录制适配</h2> 
<h2><a id="_2"></a>前言：</h2> 
<p>之前写过一篇音频录制的文章，当时是在Android10以下的手机可以成功录制和播放，但是Android10及以上手机提示创建文件失败，最近做过Android13的适配，索性一起把之前的录音也适配了，记录一下适配的过程。</p> 
<h2><a id="1ManifestAndroid13_6"></a>1.Manifest添加Android13文件读写适配：</h2> 
<pre><code class="prism language-kotlin"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>存储图像或者视频权限<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string-literal singleline"><span class="token string">"android.permission.READ_EXTERNAL_STORAGE"</span></span>
    android<span class="token operator">:</span>maxSdkVersion<span class="token operator">=</span><span class="token string-literal singleline"><span class="token string">"32"</span></span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string-literal singleline"><span class="token string">"android.permission.WRITE_EXTERNAL_STORAGE"</span></span>
    tools<span class="token operator">:</span>ignore<span class="token operator">=</span><span class="token string-literal singleline"><span class="token string">"ScopedStorage"</span></span> android<span class="token operator">:</span>maxSdkVersion<span class="token operator">=</span><span class="token string-literal singleline"><span class="token string">"32"</span></span><span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>录制音频权限<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string-literal singleline"><span class="token string">"android.permission.READ_MEDIA_AUDIO"</span></span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string-literal singleline"><span class="token string">"android.permission.READ_MEDIA_VIDEO"</span></span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string-literal singleline"><span class="token string">"android.permission.READ_MEDIA_IMAGES"</span></span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> 
<h2><a id="2Android13_21"></a>2.Android13文件读写权限请求：</h2> 
<pre><code class="prism language-kotlin"><span class="token keyword">private</span> void <span class="token function">requestBasicPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">final</span> RxPermissions rxPermissions <span class="token operator">=</span> new <span class="token function">RxPermissions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    StringBuilder rationaleSb <span class="token operator">=</span> new <span class="token function">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    StringBuilder deniedSb <span class="token operator">=</span> new <span class="token function">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Build<span class="token punctuation">.</span>VERSION<span class="token punctuation">.</span>SDK_INT <span class="token operator">&gt;=</span> Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>TIRAMISU<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        permissions <span class="token operator">=</span> new String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>
                Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>READ_MEDIA_AUDIO<span class="token punctuation">,</span>
                Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>READ_MEDIA_VIDEO<span class="token punctuation">,</span>
                Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>READ_MEDIA_IMAGES<span class="token punctuation">,</span>
                Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>RECORD_AUDIO<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        permissions <span class="token operator">=</span> new String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>
                Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>RECORD_AUDIO<span class="token punctuation">,</span> Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>WRITE_EXTERNAL_STORAGE<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    rxPermissions<span class="token punctuation">.</span><span class="token function">requestEach</span><span class="token punctuation">(</span>permissions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>new Observer<span class="token operator">&lt;</span>Permission<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token annotation builtin">@Override</span>
        <span class="token keyword">public</span> void <span class="token function">onSubscribe</span><span class="token punctuation">(</span><span class="token annotation builtin">@NonNull</span> Disposable d<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token punctuation">}</span>

        <span class="token annotation builtin">@Override</span>
        <span class="token keyword">public</span> void <span class="token function">onNext</span><span class="token punctuation">(</span><span class="token annotation builtin">@NonNull</span> Permission permission<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>permission<span class="token punctuation">.</span>granted<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 用户已经同意该权限</span>
                Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"权限："</span></span> <span class="token operator">+</span> permission<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string-literal singleline"><span class="token string">" 已开启"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>permission<span class="token punctuation">.</span>shouldShowRequestPermissionRationale<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 用户拒绝了该权限，没有选中『不再询问』（Never ask again）,那么下次再次启动时。还会提示请求权限的对话框</span>
                Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"权限："</span></span> <span class="token operator">+</span> permission<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string-literal singleline"><span class="token string">" 权限拒绝，但没有选中 不再询问"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>rationaleSb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">getPermissionName</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span>permission<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                rationaleSb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">getPermissionName</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span>permission<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                rationaleSb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"、"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 用户拒绝了该权限，而且选中『不再询问』</span>
                Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"权限："</span></span> <span class="token operator">+</span> permission<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string-literal singleline"><span class="token string">" 权限拒绝，并且选中 不再询问"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>deniedSb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">getPermissionName</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span>permission<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                deniedSb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">getPermissionName</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span>permission<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                deniedSb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"、"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token annotation builtin">@Override</span>
        <span class="token keyword">public</span> void <span class="token function">onError</span><span class="token punctuation">(</span><span class="token annotation builtin">@NonNull</span> Throwable e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"permission  onError"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation builtin">@Override</span>
        <span class="token keyword">public</span> void <span class="token function">onComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>rationaleSb<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>deniedSb<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"permission.name ,权限已经允许"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">startAudioRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>deniedSb<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token function">showTipDialog</span><span class="token punctuation">(</span>deniedSb<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>rationaleSb<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token function">showTipDialog</span><span class="token punctuation">(</span>rationaleSb<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/eb/ad/lhfkNPsC_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3_95"></a>3.权限请求弹框：</h2> 
<pre><code class="prism language-kotlin">    <span class="token keyword">private</span> void <span class="token function">showPermissionDialog</span><span class="token punctuation">(</span>StringBuilder permissionName<span class="token punctuation">,</span> int permissionType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> mPermissionDialog <span class="token operator">&amp;&amp;</span> mPermissionDialog<span class="token punctuation">.</span><span class="token function">isShowing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            mPermissionDialog<span class="token punctuation">.</span><span class="token function">dismiss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mPermissionDialog <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> permissionType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            mPermissionDialog <span class="token operator">=</span> new <span class="token function">PermissionDialog</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span>
                    <span class="token string-literal singleline"><span class="token string">"请授权相关权限以确保相关功能能正常运行："</span></span> <span class="token operator">+</span> permissionName
                            <span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> permissionName<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> PermissionDialog<span class="token punctuation">.</span>BUTTON_RIGHT_FLAG<span class="token punctuation">,</span>
                    <span class="token string-literal singleline"><span class="token string">"确定"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"知道了"</span></span><span class="token punctuation">,</span>
                    <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">::</span>startAudioRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mPermissionDialog<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> permissionType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            mPermissionDialog <span class="token operator">=</span> new <span class="token function">PermissionDialog</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span>
                    <span class="token string-literal singleline"><span class="token string">"请授权相关权限以确保相关功能能正常运行："</span></span> <span class="token operator">+</span> permissionName
                            <span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> permissionName<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> PermissionDialog<span class="token punctuation">.</span>BUTTON_RIGHT_FLAG<span class="token punctuation">,</span>
                    <span class="token string-literal singleline"><span class="token string">"取消"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"知道了"</span></span><span class="token punctuation">,</span>
                    <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">::</span>startAudioRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mPermissionDialog<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h2><a id="4dialog_121"></a>4.完整的权限请求dialog类：</h2> 
<pre><code class="prism language-kotlin"><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>audiorecorddemo<span class="token punctuation">.</span>dialog<span class="token punctuation">;</span>

<span class="token keyword">import</span> android<span class="token punctuation">.</span>app<span class="token punctuation">.</span>Dialog<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>Context<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Bundle<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>text<span class="token punctuation">.</span>TextUtils<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>View<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>Window<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>TextView<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>audiorecorddemo<span class="token punctuation">.</span>R<span class="token punctuation">;</span>


<span class="token comment">/**
 * 权限请求弹框
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> PermissionDialog extends Dialog implements View<span class="token punctuation">.</span><span class="token function">OnClickListener</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> TextView mTvTitle<span class="token punctuation">,</span> mTvTip<span class="token punctuation">,</span> mTvLeftBtn<span class="token punctuation">,</span> mTvRightBtn<span class="token punctuation">;</span>
    <span class="token keyword">private</span> View mLineTip<span class="token punctuation">;</span>

    <span class="token keyword">private</span> Window mWindow<span class="token punctuation">;</span>

    <span class="token keyword">private</span> String mTileStr<span class="token punctuation">,</span> mTipStr<span class="token punctuation">;</span>
    <span class="token keyword">private</span> int mBtnSelectType<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String mLeftStr<span class="token punctuation">,</span> mRightStr<span class="token punctuation">;</span>

    <span class="token keyword">private</span> DialogTipLeftClickListener mLeftClickListener<span class="token punctuation">;</span>
    <span class="token keyword">private</span> DialogTipRightClickListener mRightClickListener<span class="token punctuation">;</span>
    <span class="token comment">// 左右button显示</span>
    <span class="token keyword">public</span> static <span class="token keyword">final</span> int BUTTON_BOTH_FLAG <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">// 仅左button显示</span>
    <span class="token keyword">public</span> static <span class="token keyword">final</span> int BUTTON_LEFT_FLAG <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token comment">// 仅右button显示</span>
    <span class="token keyword">public</span> static <span class="token keyword">final</span> int BUTTON_RIGHT_FLAG <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>


    <span class="token keyword">private</span> boolean needShowCheck <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">PermissionDialog</span><span class="token punctuation">(</span>Context context<span class="token punctuation">,</span> String titleStr<span class="token punctuation">,</span> String tipStr<span class="token punctuation">,</span> int buttonType<span class="token punctuation">,</span> String leftStr<span class="token punctuation">,</span>
                            String rightStr<span class="token punctuation">,</span> DialogTipLeftClickListener leftClickListener<span class="token punctuation">,</span>
                            DialogTipRightClickListener rightClickListener<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWindow <span class="token operator">=</span> <span class="token function">getWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTileStr <span class="token operator">=</span> titleStr<span class="token punctuation">;</span>
        mTipStr <span class="token operator">=</span> tipStr<span class="token punctuation">;</span>
        mBtnSelectType <span class="token operator">=</span> buttonType<span class="token punctuation">;</span>
        mLeftStr <span class="token operator">=</span> leftStr<span class="token punctuation">;</span>
        mRightStr <span class="token operator">=</span> rightStr<span class="token punctuation">;</span>
        mLeftClickListener <span class="token operator">=</span> leftClickListener<span class="token punctuation">;</span>
        mRightClickListener <span class="token operator">=</span> rightClickListener<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">PermissionDialog</span><span class="token punctuation">(</span>Context context<span class="token punctuation">,</span> String tipStr<span class="token punctuation">,</span> int buttonType<span class="token punctuation">,</span> String leftStr<span class="token punctuation">,</span>
                            String rightStr<span class="token punctuation">,</span> DialogTipLeftClickListener leftClickListener<span class="token punctuation">,</span>
                            DialogTipRightClickListener rightClickListener<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> tipStr<span class="token punctuation">,</span> buttonType<span class="token punctuation">,</span> leftStr<span class="token punctuation">,</span> rightStr<span class="token punctuation">,</span> leftClickListener<span class="token punctuation">,</span> rightClickListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">PermissionDialog</span><span class="token punctuation">(</span>Context context<span class="token punctuation">,</span> String tipStr<span class="token punctuation">,</span> String leftStr<span class="token punctuation">,</span> String rightStr<span class="token punctuation">,</span>
                            DialogTipLeftClickListener leftClickListener<span class="token punctuation">,</span>
                            DialogTipRightClickListener rightClickListener<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> tipStr<span class="token punctuation">,</span> BUTTON_BOTH_FLAG<span class="token punctuation">,</span> leftStr<span class="token punctuation">,</span> rightStr<span class="token punctuation">,</span> leftClickListener<span class="token punctuation">,</span> rightClickListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">PermissionDialog</span><span class="token punctuation">(</span>Context context<span class="token punctuation">,</span> String tipStr<span class="token punctuation">,</span> String rightStr<span class="token punctuation">,</span>
                            DialogTipLeftClickListener leftClickListener<span class="token punctuation">,</span>
                            DialogTipRightClickListener rightClickListener<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> tipStr<span class="token punctuation">,</span> BUTTON_BOTH_FLAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> rightStr<span class="token punctuation">,</span> leftClickListener<span class="token punctuation">,</span> rightClickListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">PermissionDialog</span><span class="token punctuation">(</span>Context context<span class="token punctuation">,</span> String tipStr<span class="token punctuation">,</span> DialogTipLeftClickListener leftClickListener<span class="token punctuation">,</span>
                            DialogTipRightClickListener rightClickListener<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> tipStr<span class="token punctuation">,</span> BUTTON_BOTH_FLAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> leftClickListener<span class="token punctuation">,</span> rightClickListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">PermissionDialog</span><span class="token punctuation">(</span>Context context<span class="token punctuation">,</span> String titleStr<span class="token punctuation">,</span> String tipStr<span class="token punctuation">,</span> int buttonType<span class="token punctuation">,</span> String leftStr<span class="token punctuation">,</span>
                            String rightStr<span class="token punctuation">,</span> DialogTipLeftClickListener leftClickListener<span class="token punctuation">,</span>
                            DialogTipRightClickListener rightClickListener<span class="token punctuation">,</span> boolean needShowCheck<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> titleStr<span class="token punctuation">,</span> tipStr<span class="token punctuation">,</span> buttonType<span class="token punctuation">,</span> leftStr<span class="token punctuation">,</span> rightStr<span class="token punctuation">,</span> leftClickListener<span class="token punctuation">,</span> rightClickListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>needShowCheck <span class="token operator">=</span> needShowCheck<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation builtin">@Override</span>
    <span class="token keyword">protected</span> void <span class="token function">onCreate</span><span class="token punctuation">(</span>Bundle savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>layout_permiss_dialog<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setCancelable</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">initView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> void <span class="token function">initView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        mTvTitle <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>tv_dialog_corner_title<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTvTip <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>tv_dialog_corner_tip<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mLineTip <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>view_dialog_corner_line<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTvLeftBtn <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>tv_dialog_corner_left<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTvRightBtn <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>tv_dialog_corner_right<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">// 初始化监听</span>
        <span class="token function">initListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 初始化数据</span>
        <span class="token function">initData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> void <span class="token function">initData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// title</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>mTileStr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            mTvTitle<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>mTileStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mTvTitle<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            mTvTitle<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>GONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 提示</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>mTipStr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            mTvTip<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>mTipStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mTvTip<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            mTvTip<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>GONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 左边按钮</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>mLeftStr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            mTvLeftBtn<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>mLeftStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 右边按钮</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>mRightStr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            mTvRightBtn<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>mRightStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 按钮状态</span>
        <span class="token function">setButtonSelect</span><span class="token punctuation">(</span>mBtnSelectType<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> void <span class="token function">initListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        mTvLeftBtn<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTvRightBtn<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> void <span class="token function">setButtonSelect</span><span class="token punctuation">(</span>int selectType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mTvLeftBtn <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> mTvRightBtn <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> mLineTip <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">switch</span> <span class="token punctuation">(</span>selectType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            case BUTTON_LEFT_FLAG<span class="token operator">:</span>
                mTvLeftBtn<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                mTvRightBtn<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>GONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                mLineTip<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>GONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            case BUTTON_RIGHT_FLAG<span class="token operator">:</span>
                mTvLeftBtn<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>GONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                mTvRightBtn<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                mLineTip<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>GONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            case BUTTON_BOTH_FLAG<span class="token operator">:</span>
            default<span class="token operator">:</span>
                mTvLeftBtn<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                mTvRightBtn<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                mLineTip<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation builtin">@Override</span>
    <span class="token keyword">public</span> void <span class="token function">onClick</span><span class="token punctuation">(</span>View view<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        int viewId <span class="token operator">=</span> view<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>tv_dialog_corner_left <span class="token operator">==</span> viewId<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>mLeftClickListener <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                mLeftClickListener<span class="token punctuation">.</span><span class="token function">onTipLeftClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isShowing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">dismiss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>tv_dialog_corner_right <span class="token operator">==</span> viewId<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>mRightClickListener <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                mRightClickListener<span class="token punctuation">.</span><span class="token function">onTipRightClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isShowing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">dismiss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">interface</span> DialogTipLeftClickListener <span class="token punctuation">{<!-- --></span>
        void <span class="token function">onTipLeftClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">interface</span> DialogTipRightClickListener <span class="token punctuation">{<!-- --></span>
        void <span class="token function">onTipRightClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="5_315"></a>5.文件管理类：</h2> 
<pre><code class="prism language-kotlin"><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>audiorecorddemo<span class="token punctuation">.</span>utils<span class="token punctuation">;</span>

<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>ContentResolver<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>ContentValues<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>Context<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>Intent<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>net<span class="token punctuation">.</span>Uri<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Environment<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>MediaStore<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>text<span class="token punctuation">.</span>TextUtils<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Log<span class="token punctuation">;</span>

<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>NonNull<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>audiorecorddemo<span class="token punctuation">.</span>app<span class="token punctuation">.</span>MyApp<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>File<span class="token punctuation">;</span>

<span class="token comment">/**
 * @author: njb
 * @date: 2023/8/15 17:13
 * @desc:
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> FileManager <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 媒体模块根目录</span>
    <span class="token keyword">private</span> static <span class="token keyword">final</span> String SAVE_MEDIA_ROOT_DIR <span class="token operator">=</span> Environment<span class="token punctuation">.</span>DIRECTORY_DCIM<span class="token punctuation">;</span>
    <span class="token comment">// 媒体模块存储路径</span>
    <span class="token keyword">private</span> static <span class="token keyword">final</span> String SAVE_MEDIA_DIR <span class="token operator">=</span> SAVE_MEDIA_ROOT_DIR <span class="token operator">+</span> <span class="token string-literal singleline"><span class="token string">"/RecordManager"</span></span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> static <span class="token keyword">final</span> String SAVE_MEDIA_PHOTO_DIR <span class="token operator">=</span> SAVE_MEDIA_DIR <span class="token operator">+</span> <span class="token string-literal singleline"><span class="token string">"/photo"</span></span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> static <span class="token keyword">final</span> String SAVE_MEDIA_AUDIO_DIR <span class="token operator">=</span> SAVE_MEDIA_DIR <span class="token operator">+</span> <span class="token string-literal singleline"><span class="token string">"/audio"</span></span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> static <span class="token keyword">final</span> String SAVE_MEDIA_VIDEO_DIR <span class="token operator">=</span> SAVE_MEDIA_DIR <span class="token operator">+</span> <span class="token string-literal singleline"><span class="token string">"/video"</span></span><span class="token punctuation">;</span>
    <span class="token comment">// JPG后缀</span>
    <span class="token keyword">public</span> static <span class="token keyword">final</span> String JPG_SUFFIX <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">".jpg"</span></span><span class="token punctuation">;</span>
    <span class="token comment">// PNG后缀</span>
    <span class="token keyword">public</span> static <span class="token keyword">final</span> String PNG_SUFFIX <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">".png"</span></span><span class="token punctuation">;</span>
    <span class="token comment">// MP4后缀</span>
    <span class="token keyword">public</span> static <span class="token keyword">final</span> String MP4_SUFFIX <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">".mp4"</span></span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 保存图片到系统相册
     *
     * @param context
     * @param file
     */</span>
    <span class="token keyword">public</span> static String <span class="token function">saveImage</span><span class="token punctuation">(</span>Context context<span class="token punctuation">,</span> File file<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        ContentResolver localContentResolver <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ContentValues localContentValues <span class="token operator">=</span> <span class="token function">getImageContentValues</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> file<span class="token punctuation">,</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        localContentResolver<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>Media<span class="token punctuation">.</span>EXTERNAL_CONTENT_URI<span class="token punctuation">,</span> localContentValues<span class="token punctuation">)</span><span class="token punctuation">;</span>

        Intent localIntent <span class="token operator">=</span> new <span class="token function">Intent</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"android.intent.action.MEDIA_SCANNER_SCAN_FILE"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> Uri localUri <span class="token operator">=</span> Uri<span class="token punctuation">.</span><span class="token function">fromFile</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
        localIntent<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>localUri<span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">sendBroadcast</span><span class="token punctuation">(</span>localIntent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> file<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> static ContentValues <span class="token function">getImageContentValues</span><span class="token punctuation">(</span>Context paramContext<span class="token punctuation">,</span> File paramFile<span class="token punctuation">,</span> long paramLong<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        ContentValues localContentValues <span class="token operator">=</span> new <span class="token function">ContentValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        localContentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"title"</span></span><span class="token punctuation">,</span> paramFile<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        localContentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"_display_name"</span></span><span class="token punctuation">,</span> paramFile<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        localContentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"mime_type"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"image/jpeg"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        localContentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"datetaken"</span></span><span class="token punctuation">,</span> Long<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>paramLong<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        localContentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"date_modified"</span></span><span class="token punctuation">,</span> Long<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>paramLong<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        localContentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"date_added"</span></span><span class="token punctuation">,</span> Long<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>paramLong<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        localContentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"orientation"</span></span><span class="token punctuation">,</span> Integer<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        localContentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"_data"</span></span><span class="token punctuation">,</span> paramFile<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        localContentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"_size"</span></span><span class="token punctuation">,</span> Long<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>paramFile<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> localContentValues<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取App存储根目录
     */</span>
    <span class="token keyword">public</span> static String <span class="token function">getAppRootDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        String path <span class="token operator">=</span> <span class="token function">getStorageRootDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        FileUtil<span class="token punctuation">.</span><span class="token function">createOrExistsDir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> path<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取文件存储根目录
     */</span>
    <span class="token keyword">public</span> static String <span class="token function">getStorageRootDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        File filePath <span class="token operator">=</span> MyApp<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getExternalFilesDir</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String path<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>filePath <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            path <span class="token operator">=</span> filePath<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            path <span class="token operator">=</span> MyApp<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFilesDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> path<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 图片地址
     */</span>
    <span class="token keyword">public</span> static String <span class="token function">getCameraPhotoPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">getFolderDirPath</span><span class="token punctuation">(</span>SAVE_MEDIA_PHOTO_DIR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>



    <span class="token comment">/**
     * 视频地址
     */</span>
    <span class="token keyword">public</span> static String <span class="token function">getCameraVideoPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">getFolderDirPath</span><span class="token punctuation">(</span>SAVE_MEDIA_VIDEO_DIR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> static String <span class="token function">getCameraAudioPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">getSaveDir</span><span class="token punctuation">(</span>SAVE_MEDIA_AUDIO_DIR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> static String <span class="token function">getFolderDirPath</span><span class="token punctuation">(</span>String dstDirPathToCreate<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        File dstFileDir <span class="token operator">=</span> new <span class="token function">File</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span><span class="token function">getExternalStorageDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dstDirPathToCreate<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>dstFileDir<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>dstFileDir<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            Log<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Failed to create file"</span></span><span class="token punctuation">,</span> dstDirPathToCreate<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> dstFileDir<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取具体模块存储目录
     */</span>
    <span class="token keyword">public</span> static String <span class="token function">getSaveDir</span><span class="token punctuation">(</span><span class="token annotation builtin">@NonNull</span> String directory<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        String path <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>directory<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string-literal singleline"><span class="token string">"/"</span></span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>directory<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            path <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>directory<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"/"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            path <span class="token operator">=</span> directory<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            path <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"/"</span></span> <span class="token operator">+</span> directory<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        path <span class="token operator">=</span> <span class="token function">getAppRootDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> path<span class="token punctuation">;</span>
        FileUtil<span class="token punctuation">.</span><span class="token function">createOrExistsDir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> path<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="6_459"></a>6.录音方法：</h2> 
<p>主要就是文件的生成和创建，由于Android10以后不能随意创建私有文件，所以生成的audio文件放到系统的DCIM、MUSIC、Download目录下，并且是项目自己包名下：</p> 
<p><img src="https://images2.imgbox.com/7e/33/V4hrVsWa_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-kotlin"><span class="token keyword">public</span> void <span class="token function">startRecord</span><span class="token punctuation">(</span>WeakReference<span class="token operator">&lt;</span>Context<span class="token operator">&gt;</span> weakReference<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>weakReference <span class="token operator">=</span> weakReference<span class="token punctuation">;</span>
    LogUtils<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"开始录音"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//生成PCM文件</span>
    String fileName <span class="token operator">=</span> DateFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"yyyy-MMdd-HHmmss"</span></span><span class="token punctuation">,</span> Calendar<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>Locale<span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string-literal singleline"><span class="token string">".pcm"</span></span><span class="token punctuation">;</span>
    File file <span class="token operator">=</span> new <span class="token function">File</span><span class="token punctuation">(</span>FileManager<span class="token punctuation">.</span><span class="token function">getCameraAudioPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"/ACC音频/"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        file<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    String audioSaveDir <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    LogUtils<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> audioSaveDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    recordFile <span class="token operator">=</span> new <span class="token function">File</span><span class="token punctuation">(</span>audioSaveDir<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    LogUtils<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"生成文件"</span></span> <span class="token operator">+</span> recordFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//如果存在，就先删除再创建</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>recordFile<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        recordFile<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        LogUtils<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"删除文件"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        recordFile<span class="token punctuation">.</span><span class="token function">createNewFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        LogUtils<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"创建文件"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>IOException e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        LogUtils<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"未能创建"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> new <span class="token function">IllegalStateException</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"未能创建"</span></span> <span class="token operator">+</span> recordFile<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>filePathList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        filePathList<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    filePathList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>recordFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//输出流</span>
        OutputStream os <span class="token operator">=</span> new <span class="token function">FileOutputStream</span><span class="token punctuation">(</span>recordFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
        BufferedOutputStream bos <span class="token operator">=</span> new <span class="token function">BufferedOutputStream</span><span class="token punctuation">(</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span>
        DataOutputStream dos <span class="token operator">=</span> new <span class="token function">DataOutputStream</span><span class="token punctuation">(</span>bos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        int bufferSize <span class="token operator">=</span> AudioRecord<span class="token punctuation">.</span><span class="token function">getMinBufferSize</span><span class="token punctuation">(</span>sampleRateInHz<span class="token punctuation">,</span> AudioFormat<span class="token punctuation">.</span>CHANNEL_IN_STEREO<span class="token punctuation">,</span> audioEncoding<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ActivityCompat<span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span>weakReference<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>RECORD_AUDIO<span class="token punctuation">)</span> <span class="token operator">!=</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
       audioRecord <span class="token operator">=</span> new <span class="token function">AudioRecord</span><span class="token punctuation">(</span>MediaRecorder<span class="token punctuation">.</span>AudioSource<span class="token punctuation">.</span>MIC<span class="token punctuation">,</span> sampleRateInHz<span class="token punctuation">,</span> AudioFormat<span class="token punctuation">.</span>CHANNEL_IN_STEREO<span class="token punctuation">,</span> audioEncoding<span class="token punctuation">,</span> bufferSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        short<span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> new short<span class="token punctuation">[</span>bufferSize<span class="token punctuation">]</span><span class="token punctuation">;</span>
        audioRecord<span class="token punctuation">.</span><span class="token function">startRecording</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        LogUtils<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"开始录音"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        isRecording <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>isRecording<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            int bufferReadResult <span class="token operator">=</span> audioRecord<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> bufferSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> bufferReadResult<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                dos<span class="token punctuation">.</span><span class="token function">writeShort</span><span class="token punctuation">(</span>buffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        audioRecord<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>Exception e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        LogUtils<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"录音失败"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">showToast</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"录音失败"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="7_528"></a>7.启动录音：</h2> 
<pre><code class="prism language-kotlin">btnRecord<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span>new View<span class="token punctuation">.</span><span class="token function">OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation builtin">@Override</span>
    <span class="token keyword">public</span> void <span class="token function">onClick</span><span class="token punctuation">(</span>View v<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">buttonEnabled</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">startAudioRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="8_540"></a>8.停止录音:</h2> 
<pre><code>btnStop.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        new Handler().post(new Runnable() {
            @Override
            public void run() {
                buttonEnabled(true, true, false);
                mHandler.post(() -&gt; Toast.makeText(MainActivity.this, "停止录音", Toast.LENGTH_LONG).show());
                AudioManagerUtils.getInstance().pauseAudio();
            }
        });
    }
});
</code></pre> 
<h2><a id="9_558"></a>9.开始播放：</h2> 
<pre><code class="prism language-kotlin">btnPlay<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span>new View<span class="token punctuation">.</span><span class="token function">OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation builtin">@Override</span>
    <span class="token keyword">public</span> void <span class="token function">onClick</span><span class="token punctuation">(</span>View v<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        AudioManagerUtils<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">playPcm</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">buttonEnabled</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="10_570"></a>10.完整的测试代码：</h2> 
<pre><code class="prism language-kotlin"><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>audiorecorddemo<span class="token punctuation">;</span>

<span class="token keyword">import</span> android<span class="token punctuation">.</span>Manifest<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Build<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Bundle<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Handler<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>text<span class="token punctuation">.</span>TextUtils<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Log<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>View<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>Button<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>Toast<span class="token punctuation">;</span>

<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>NonNull<span class="token punctuation">;</span>
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>appcompat<span class="token punctuation">.</span>app<span class="token punctuation">.</span>AppCompatActivity<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>blankj<span class="token punctuation">.</span>utilcode<span class="token punctuation">.</span>util<span class="token punctuation">.</span>LogUtils<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>audiorecorddemo<span class="token punctuation">.</span>dialog<span class="token punctuation">.</span>PermissionDialog<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>audiorecorddemo<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>AudioManagerUtils<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>audiorecorddemo<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>StringUtils<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>tbruyelle<span class="token punctuation">.</span>rxpermissions3<span class="token punctuation">.</span>Permission<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>tbruyelle<span class="token punctuation">.</span>rxpermissions3<span class="token punctuation">.</span>RxPermissions<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ref<span class="token punctuation">.</span>WeakReference<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>Executors<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>LinkedBlockingDeque<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>ThreadPoolExecutor<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>TimeUnit<span class="token punctuation">;</span>

<span class="token keyword">import</span> io<span class="token punctuation">.</span>reactivex<span class="token punctuation">.</span>rxjava3<span class="token punctuation">.</span>core<span class="token punctuation">.</span>Observer<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>reactivex<span class="token punctuation">.</span>rxjava3<span class="token punctuation">.</span>disposables<span class="token punctuation">.</span>Disposable<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> MainActivity extends AppCompatActivity <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> Button btnRecord<span class="token punctuation">,</span> btnPlay<span class="token punctuation">,</span> btnStop<span class="token punctuation">;</span>
    ThreadPoolExecutor threadPoolExecutor <span class="token operator">=</span> new <span class="token function">ThreadPoolExecutor</span><span class="token punctuation">(</span>
            <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token number">1</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>MINUTES<span class="token punctuation">,</span>
            new LinkedBlockingDeque<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            Executors<span class="token punctuation">.</span><span class="token function">defaultThreadFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            new ThreadPoolExecutor<span class="token punctuation">.</span><span class="token function">AbortPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> permissions <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> PermissionDialog mPermissionDialog <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 被用户拒绝的权限列表
     */</span>
    <span class="token keyword">private</span> static <span class="token keyword">final</span> int MY_PERMISSIONS_REQUEST <span class="token operator">=</span> <span class="token number">1001</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> String TAG <span class="token operator">=</span> MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> Handler mHandler <span class="token operator">=</span> new <span class="token function">Handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation builtin">@Override</span>
    <span class="token keyword">protected</span> void <span class="token function">onCreate</span><span class="token punctuation">(</span>Bundle savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">requestBasicPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">initView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> void <span class="token function">requestBasicPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">final</span> RxPermissions rxPermissions <span class="token operator">=</span> new <span class="token function">RxPermissions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        StringBuilder rationaleSb <span class="token operator">=</span> new <span class="token function">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        StringBuilder deniedSb <span class="token operator">=</span> new <span class="token function">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Build<span class="token punctuation">.</span>VERSION<span class="token punctuation">.</span>SDK_INT <span class="token operator">&gt;=</span> Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>TIRAMISU<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            permissions <span class="token operator">=</span> new String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>
                    Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>READ_MEDIA_AUDIO<span class="token punctuation">,</span>
                    Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>READ_MEDIA_VIDEO<span class="token punctuation">,</span>
                    Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>READ_MEDIA_IMAGES<span class="token punctuation">,</span>
                    Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>RECORD_AUDIO<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            permissions <span class="token operator">=</span> new String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>
                    Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>RECORD_AUDIO<span class="token punctuation">,</span> Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>WRITE_EXTERNAL_STORAGE<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        rxPermissions<span class="token punctuation">.</span><span class="token function">requestEach</span><span class="token punctuation">(</span>permissions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>new Observer<span class="token operator">&lt;</span>Permission<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token annotation builtin">@Override</span>
            <span class="token keyword">public</span> void <span class="token function">onSubscribe</span><span class="token punctuation">(</span><span class="token annotation builtin">@NonNull</span> Disposable d<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token punctuation">}</span>

            <span class="token annotation builtin">@Override</span>
            <span class="token keyword">public</span> void <span class="token function">onNext</span><span class="token punctuation">(</span><span class="token annotation builtin">@NonNull</span> Permission permission<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>permission<span class="token punctuation">.</span>granted<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    LogUtils<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"权限："</span></span> <span class="token operator">+</span> permission<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string-literal singleline"><span class="token string">" 已开启"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>permission<span class="token punctuation">.</span>shouldShowRequestPermissionRationale<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    LogUtils<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"权限："</span></span> <span class="token operator">+</span> permission<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string-literal singleline"><span class="token string">" 权限拒绝，但没有选中 不再询问"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rationaleSb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">getPermissionName</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span>permission<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    rationaleSb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">getPermissionName</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span>permission<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    rationaleSb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"、"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    LogUtils<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"权限："</span></span> <span class="token operator">+</span> permission<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string-literal singleline"><span class="token string">" 权限拒绝，并且选中 不再询问"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>deniedSb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">getPermissionName</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span>permission<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    deniedSb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">getPermissionName</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span>permission<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    deniedSb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"、"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token annotation builtin">@Override</span>
            <span class="token keyword">public</span> void <span class="token function">onError</span><span class="token punctuation">(</span><span class="token annotation builtin">@NonNull</span> Throwable e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                LogUtils<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"permission  onError"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token annotation builtin">@Override</span>
            <span class="token keyword">public</span> void <span class="token function">onComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>rationaleSb<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>deniedSb<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    LogUtils<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"permission.name ,权限已经允许"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">startAudioRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>deniedSb<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">showPermissionDialog</span><span class="token punctuation">(</span>deniedSb<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>TextUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>rationaleSb<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">showPermissionDialog</span><span class="token punctuation">(</span>rationaleSb<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> void <span class="token function">showPermissionDialog</span><span class="token punctuation">(</span>StringBuilder permissionName<span class="token punctuation">,</span> int permissionType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> mPermissionDialog <span class="token operator">&amp;&amp;</span> mPermissionDialog<span class="token punctuation">.</span><span class="token function">isShowing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            mPermissionDialog<span class="token punctuation">.</span><span class="token function">dismiss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mPermissionDialog <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> permissionType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            mPermissionDialog <span class="token operator">=</span> new <span class="token function">PermissionDialog</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span>
                    <span class="token string-literal singleline"><span class="token string">"请授权相关权限以确保相关功能能正常运行："</span></span> <span class="token operator">+</span> permissionName
                            <span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> permissionName<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> PermissionDialog<span class="token punctuation">.</span>BUTTON_RIGHT_FLAG<span class="token punctuation">,</span>
                    <span class="token string-literal singleline"><span class="token string">"确定"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"知道了"</span></span><span class="token punctuation">,</span>
                    <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">::</span>startAudioRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mPermissionDialog<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> permissionType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            mPermissionDialog <span class="token operator">=</span> new <span class="token function">PermissionDialog</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span>
                    <span class="token string-literal singleline"><span class="token string">"请授权相关权限以确保相关功能能正常运行："</span></span> <span class="token operator">+</span> permissionName
                            <span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> permissionName<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> PermissionDialog<span class="token punctuation">.</span>BUTTON_RIGHT_FLAG<span class="token punctuation">,</span>
                    <span class="token string-literal singleline"><span class="token string">"取消"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"知道了"</span></span><span class="token punctuation">,</span>
                    <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">::</span>startAudioRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mPermissionDialog<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> void <span class="token function">initView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        btnRecord <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>btn_record<span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnPlay <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>btn_play<span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnStop <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>btn_stop<span class="token punctuation">)</span><span class="token punctuation">;</span>

        btnRecord<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span>new View<span class="token punctuation">.</span><span class="token function">OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token annotation builtin">@Override</span>
            <span class="token keyword">public</span> void <span class="token function">onClick</span><span class="token punctuation">(</span>View v<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">buttonEnabled</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">startAudioRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        btnPlay<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span>new View<span class="token punctuation">.</span><span class="token function">OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token annotation builtin">@Override</span>
            <span class="token keyword">public</span> void <span class="token function">onClick</span><span class="token punctuation">(</span>View v<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                AudioManagerUtils<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">playPcm</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">buttonEnabled</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnStop<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span>new View<span class="token punctuation">.</span><span class="token function">OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token annotation builtin">@Override</span>
            <span class="token keyword">public</span> void <span class="token function">onClick</span><span class="token punctuation">(</span>View v<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                new <span class="token function">Handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>new <span class="token function">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token annotation builtin">@Override</span>
                    <span class="token keyword">public</span> void <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">buttonEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        mHandler<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"停止录音"</span></span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_LONG<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        AudioManagerUtils<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pauseAudio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> void <span class="token function">startAudioRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        threadPoolExecutor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
            mHandler<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"开始录音"</span></span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_LONG<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            AudioManagerUtils<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startRecord</span><span class="token punctuation">(</span>new WeakReference<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> void <span class="token function">buttonEnabled</span><span class="token punctuation">(</span>boolean record<span class="token punctuation">,</span> boolean play<span class="token punctuation">,</span> boolean stop<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        btnRecord<span class="token punctuation">.</span><span class="token function">setEnabled</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnPlay<span class="token punctuation">.</span><span class="token function">setEnabled</span><span class="token punctuation">(</span>play<span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnStop<span class="token punctuation">.</span><span class="token function">setEnabled</span><span class="token punctuation">(</span>stop<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation builtin">@Override</span>
    <span class="token keyword">protected</span> void <span class="token function">onStop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onStop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        AudioManagerUtils<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pauseAudio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation builtin">@Override</span>
    <span class="token keyword">protected</span> void <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        AudioManagerUtils<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">releaseAudio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="11_776"></a>11.实现的效果如下：</h2> 
<p><img src="https://images2.imgbox.com/95/fa/kAkk0LsY_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="12_781"></a>12.总结：</h2> 
<ul><li>以上就是今天的内容，录制音频时适配Android13.</li><li>Android13文件读写细分为三个权限 READ_MEDIA_AUDIO、READ_MEDIA_VIDEO、READ_MEDIA_IMAGES.</li><li>Android10以上文件创建和生成需要在公共目录，不能随意创建和读写.</li></ul> 
<h2><a id="13_787"></a>13.项目的源码地址：</h2> 
<p><a href="https://gitee.com/jackning_admin/audio-record-demo-a" rel="nofollow">https://gitee.com/jackning_admin/audio-record-demo-a</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1e2959ef45218158ba17c971bcd5d018/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于代码一步一步教你深度学习中循环神经网络(RNN)的原理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/649b2560a300f81b30668e81acefa6f2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Termux安装图形桌面xfce4</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>