<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Centos配置DNS服务 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Centos配置DNS服务" />
<meta property="og:description" content="主DNS服务器：
IP地址 : 192.168.101.10/24 DNS：192.168.101.10
备DNS服务器：
IP地址：192.168.101.20/24 DNS: 192.168.101.10
要求：【利用 bind9 软件，1配置 Linux1 为主 DNS 服务器，采用 rndc 技术提供不间断 的 DNS 服务；2配置 Linux2 为备用 DNS 服务器，为所有 Linux 主机提供冗余 DNS 正反向解析服务。】
主机器DNS配置 配置静态IP 配置静态IP为192.168.101.10/24 DNS为191.168.101.10
vim /etc/sysconfig/network-scripts/ifcfg-ens33 TYPE=&#34;Ethernet&#34; PROXY_METHOD=&#34;none&#34; BROWSER_ONLY=&#34;no&#34; BOOTPROTO=&#34;static&#34; #将dhcp修改为static DEFROUTE=&#34;yes&#34; IPV4_FAILURE_FATAL=&#34;no&#34; IPV6INIT=&#34;yes&#34; IPV6_AUTOCONF=&#34;yes&#34; IPV6_DEFROUTE=&#34;yes&#34; IPV6_FAILURE_FATAL=&#34;no&#34; IPV6_ADDR_GEN_MODE=&#34;stable-privacy&#34; NAME=&#34;ens33&#34; UUID=&#34;e493a4a8-5777-412c-9497-6a2631bffcd1&#34; DEVICE=&#34;ens33&#34; ONBOOT=&#34;yes&#34; #将yes修改为no IPADDR=192.168.101.10 #服务器IP NETMASK=255.255.255.0 #子网掩码 GATEWAY=192.168.101.2 #网关地址 DNS1=192.168.101.10 #DNS [root@192 ~]#systemctl restart network //重启网卡命令 配置本地yum源 cd /etc/yum.repos.d #切换到yum源路径配置 //本地yum源模板文件 CentOS-Linux-Media." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/df7083c3eda9dd6bc7401c31bb282bad/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-15T20:37:12+08:00" />
<meta property="article:modified_time" content="2023-02-15T20:37:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Centos配置DNS服务</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>主DNS服务器：</p> 
<p>IP地址 :  192.168.101.10/24  DNS：192.168.101.10</p> 
<p>备DNS服务器：</p> 
<p>IP地址：192.168.101.20/24  DNS: 192.168.101.10</p> 
<p>要求：【利用 bind9 软件，<span style="color:#0d0016;"><span style="background-color:#fff5e6;">1配置 Linux1 为主 DNS 服务器</span></span>，采用 rndc 技术提供不间断 的 DNS 服务；<span style="background-color:#fff5e6;">2配置 Linux2 为备用 DNS 服务器</span>，为所有 Linux 主机提供<span style="color:#fe2c24;">冗余 DNS </span>正反向解析服务。】</p> 
<h2>主机器DNS配置</h2> 
<h3>配置静态IP</h3> 
<p>配置静态IP为192.168.101.10/24  DNS为191.168.101.10</p> 
<pre><code class="language-bash">vim  /etc/sysconfig/network-scripts/ifcfg-ens33
TYPE="Ethernet"
PROXY_METHOD="none"
BROWSER_ONLY="no"
BOOTPROTO="static"  #将dhcp修改为static
DEFROUTE="yes"
IPV4_FAILURE_FATAL="no"
IPV6INIT="yes"
IPV6_AUTOCONF="yes"
IPV6_DEFROUTE="yes"
IPV6_FAILURE_FATAL="no"
IPV6_ADDR_GEN_MODE="stable-privacy"
NAME="ens33"
UUID="e493a4a8-5777-412c-9497-6a2631bffcd1"
DEVICE="ens33"
ONBOOT="yes"     #将yes修改为no
IPADDR=192.168.101.10  #服务器IP
NETMASK=255.255.255.0  #子网掩码
GATEWAY=192.168.101.2   #网关地址
DNS1=192.168.101.10    #DNS
[root@192 ~]#systemctl restart network   //重启网卡命令</code></pre> 
<h3>配置本地yum源</h3> 
<pre><code class="language-bash">cd  /etc/yum.repos.d  #切换到yum源路径配置
//本地yum源模板文件 CentOS-Linux-Media.repo
[root@192 yum.repos.d]# mv CentOS-Linux-* 123             //剪切路径下文件到123
[root@192 yum.repos.d]# cp -p 123/CentOS-Linux-Media.repo 1.repo    //复制本地yum配置文件   注：1.repo   x.repo   .repo 结尾的文件
[root@192 yum.repos.d]#vi 1.repo
[c7-media]								//仓库名称
name=CentOS Linux $releasever - Media //仓库注释
baseurl=file:///mnt                      	//仓库挂载位置
gpgcheck=0									//1改为0  ，不启用gpg
enabled=1									//0改为1，启用yum源仓库
</code></pre> 
<p><img alt="" height="139" src="https://images2.imgbox.com/e1/f8/noU4QJMI_o.png" width="865"></p> 
<p><strong> 挂载文件</strong></p> 
<pre><code class="language-bash">[root@192 yum.repos.d]# mount /dev/cdrom /mnt           //挂载文件到mnt下
mount: /mnt: WARNING: device write-protected, mounted read-only.    //挂载成功</code></pre> 
<h2>1.配置主DNS服务</h2> 
<pre><code class="language-bash">[root@192 ~]# yum -y install bind bind-chroot   //安装dns包
[root@192 ~]# vi /etc/named.conf    //全局配置文件
options {
        listen-on port 53 { 127.0.0.1; };       //监听端口，127.0.0.1改为any
        listen-on-v6 port 53 { ::1; };
        directory       "/var/named";
        dump-file       "/var/named/data/cache_dump.db";
        statistics-file "/var/named/data/named_stats.txt";
        memstatistics-file "/var/named/data/named_mem_stats.txt";
        secroots-file   "/var/named/data/named.secroots";
        recursing-file  "/var/named/data/named.recursing";
        allow-query     { localhost; };       //localhost 改为any

</code></pre> 
<p><img alt="" height="233" src="https://images2.imgbox.com/c1/07/H8V8w1Gp_o.png" width="865"></p> 
<p><span style="color:#0d0016;"> 配置区域解析文件</span></p> 
<pre><code class="language-bash">正向区域模板：
zone "localhost.localdomain" IN {          //localhost.localdomain   域名
        type master;                   //master主要区域
        file "named.localhost";          //named.localhost   正向解析文件名
        allow-update { none; };			//从哪里下载解析文件
};
反向区域模板：
zone "1.0.0.127.in-addr.arpa" IN {        //1.0.0.127.in-addr.arpa 1.0.0.127改为本机网段
        type master;					// master主要区域
        file "named.loopback";        //named.loopback    反向解析文件名
        allow-update { none; };		   //从哪里下载解析文件  none空
};
</code></pre> 
<div> 
 <blockquote> 
  <p style="margin-left:0;text-align:justify;">Vim  非编辑模式下按下5yy键，到文件底部按下p键</p> 
  <p style="margin-left:0;text-align:justify;">5yy复制5行   p粘贴</p> 
 </blockquote> 
</div> 
<p><img alt="" height="683" src="https://images2.imgbox.com/8b/0c/8ow0xfcM_o.png" width="865"></p> 
<h4> 区域解析文件配置</h4> 
<pre><code class="language-bash">[root@192 ~]# cd /var/named/         //区域解析文件位置
[root@192 named]# ls
chroot  dynamic   named.empty      named.loopback  //反向模板文件
data    named.ca  named.localhost //正向模板文件  slaves
[root@192 named]# cp -p named.localhost   1       //复制正向模板
[root@192 named]# cp -p named.loopback   2		//复制反向模板
[root@192 named]# vi    1 						//编辑正向解析文件</code></pre> 
<p><img alt="" height="239" src="https://images2.imgbox.com/b7/c4/AyABBilf_o.png" width="865"></p> 
<p> [root@192 named]# vi     2                                        //编辑反向解析文件</p> 
<p><img alt="" height="203" src="https://images2.imgbox.com/27/1c/weRN4jzk_o.png" width="865"></p> 
<p> [root@192 named]# systemctl restart named    </p> 
<p style="margin-left:0;text-align:justify;">[root@192 named]# yum -y install bind-utils      //nslookup包</p> 
<h4 style="margin-left:0px;text-align:justify;">验证配置</h4> 
<p style="margin-left:0;text-align:justify;">服务正常运行，并测试成功</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="245" src="https://images2.imgbox.com/49/97/7zdmwwfx_o.png" width="865"></p> 
<h2>2. 配置备用DNS</h2> 
<p>主机配置 </p> 
<p>关闭防火墙 systemctl disablesd firewalld</p> 
<p>vim /etc/selinux/config  #重启机器reboot</p> 
<p><img alt="" height="310" src="https://images2.imgbox.com/27/54/6t6Z54F4_o.png" width="865"></p> 
<p></p> 
<p style="margin-left:0;text-align:justify;">[root@localhost ~]# systemctl  enable named</p> 
<p style="margin-left:0;text-align:justify;">Created symlink from /etc/systemd/system/multi-user.target.wants/named.service to /usr/lib/systemd/system/named.service.  //打开成功</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">[root@localhost ~]# vim   /etc/named.rfc1912.zones</p> 
<p style="margin-left:0;text-align:justify;">[root@localhost ~]# vim   /etc/named.rfc1912.zones</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="551" src="https://images2.imgbox.com/aa/1c/uMYyUFKE_o.png" width="683"></p> 
<p> [root@localhost ~]# systemctl restart  named</p> 
<p style="margin-left:0;text-align:justify;"><strong>备用机器配置  </strong></p> 
<p style="margin-left:0;text-align:justify;">配置静态IP地址  vi  /etc/sysconfig/network-scripts/ifcfg-ens33</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="474" src="https://images2.imgbox.com/cf/14/0pUtr04h_o.png" width="669"></p> 
<p></p> 
<p style="margin-left:0;text-align:justify;">[root@localhost network-scripts]# systemctl restart network</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h3 style="margin-left:0px;text-align:justify;">yum源配置</h3> 
<p style="margin-left:0;text-align:justify;">[root@localhost yum.repos.d]# mkdir  123</p> 
<p style="margin-left:0;text-align:justify;">[root@localhost yum.repos.d]# mv CentOS-* 123</p> 
<p style="margin-left:0;text-align:justify;">[root@localhost yum.repos.d]# ls</p> 
<p style="margin-left:0;text-align:justify;">123</p> 
<p style="margin-left:0;text-align:justify;">[root@localhost yum.repos.d]# cp  -p 123/CentOS-Media.repo 1.repo</p> 
<p style="margin-left:0;text-align:justify;">[root@localhost yum.repos.d]# vi 1.repo</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="179" src="https://images2.imgbox.com/f3/d7/UQkPMIRC_o.png" width="713"></p> 
<p></p> 
<p style="margin-left:0;text-align:justify;">[root@localhost yum.repos.d]# yum -y install vim bind bind-chroot  bind-utils</p> 
<p style="margin-left:0;text-align:justify;">使用xftp将镜像文件传输到/root下</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="557" src="https://images2.imgbox.com/0d/83/tocLovUu_o.png" width="865"></p> 
<p></p> 
<p style="margin-left:0;text-align:justify;">关闭防火墙systemctl disabled  firewalld</p> 
<p style="margin-left:0;text-align:justify;">vim  /etc/selinux/config   #关机reboot</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="305" src="https://images2.imgbox.com/27/89/Nh7eZWER_o.png" width="865"></p> 
<p style="margin-left:0;text-align:justify;">[root@localhost ~]# vim /etc/named.conf</p> 
<p style="margin-left:0;text-align:justify;">[root@localhost ~]# vim  /etc/named.rfc1912.zones</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="625" src="https://images2.imgbox.com/36/a9/eSSnaRhX_o.png" width="865"></p> 
<p> [root@localhost ~]# systemctl restart named</p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/907ffabd09386deba7c456fd6bf59045/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">matlab常用快捷键</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ce81ceb3703c8bb81abe221240447031/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">用IDEA设计登录页面完成假登录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>