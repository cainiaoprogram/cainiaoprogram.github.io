<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java获取用户ip地址 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java获取用户ip地址" />
<meta property="og:description" content="/** * 获取请求IP * 参考：https://www.cnblogs.com/mypath/articles/5239687.html * A同学和B同学在同一局域网内请求接口 https://xxx.com/abc-service/vcode/send 得到的结果（经过了nginx）： * * A同学: * X-Real-IP：1.96.130.81 * X-Forwarded-For： 121.125.171.194, 1.96.130.81 * * B同学: * X-Real-IP：1.96.119.104 * X-Forwarded-For： 121.125.171.194, 1.96.119.104 * * * @param request * @return */ public static String getRequestIpAddress(HttpServletRequest request) { String ipAddress = null; if (org.apache.commons.lang3.StringUtils.isEmpty(ipAddress) || org.apache.commons.lang3.StringUtils.isBlank(ipAddress) || &#34;unknown&#34;.equalsIgnoreCase(ipAddress)) ipAddress = request.getHeader(&#34;X-Real-IP&#34;); if (org.apache.commons.lang3.StringUtils.isEmpty(ipAddress) || org.apache.commons.lang3.StringUtils.isBlank(ipAddress) || &#34;unknown&#34;.equalsIgnoreCase(ipAddress)) ipAddress = request.getHeader(&#34;X-Forwarded-For&#34;); // 对于通过多个代理的情况，第一个IP为客户端真实IP,多个IP按照&#39;,&#39;分割 if (ipAddress != null &amp;&amp; ipAddress." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/20178e3988af97a8dd8681a5ac99169f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-11T19:53:55+08:00" />
<meta property="article:modified_time" content="2023-05-11T19:53:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java获取用户ip地址</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code class="language-java">/**
     * 获取请求IP
     * 参考：https://www.cnblogs.com/mypath/articles/5239687.html
     * A同学和B同学在同一局域网内请求接口 https://xxx.com/abc-service/vcode/send 得到的结果（经过了nginx）：
     *
     * A同学:
     * X-Real-IP：1.96.130.81
     * X-Forwarded-For： 121.125.171.194, 1.96.130.81
     *
     * B同学:
     * X-Real-IP：1.96.119.104
     * X-Forwarded-For： 121.125.171.194, 1.96.119.104
     *
     *
     * @param request
     * @return
     */
    public static String getRequestIpAddress(HttpServletRequest request) {
        String ipAddress = null;

        if (org.apache.commons.lang3.StringUtils.isEmpty(ipAddress) || org.apache.commons.lang3.StringUtils.isBlank(ipAddress) || "unknown".equalsIgnoreCase(ipAddress))
            ipAddress = request.getHeader("X-Real-IP");
        if (org.apache.commons.lang3.StringUtils.isEmpty(ipAddress) || org.apache.commons.lang3.StringUtils.isBlank(ipAddress) || "unknown".equalsIgnoreCase(ipAddress))
            ipAddress = request.getHeader("X-Forwarded-For");
        // 对于通过多个代理的情况，第一个IP为客户端真实IP,多个IP按照','分割
        if (ipAddress != null &amp;&amp; ipAddress.length() &gt; 15) {
            if (ipAddress.indexOf(",") &gt; 0) {
                ipAddress = ipAddress.substring(0, ipAddress.indexOf(","));
            }
        }
        return ipAddress;
    }</code></pre> 
<p>通过java获取请求用户IP地址：</p> 
<p>一定要看下这个文章再往下看: https://www.cnblogs.com/mypath/articles/5239687.html</p> 
<p>A同学和B同学在同一局域网内请求接口 https://xxx.com/abc-service/vcode/send 得到的结果（经过了nginx）：</p> 
<p>A同学:</p> 
<p>X-Real-IP：1.96.130.81</p> 
<p>X-Forwarded-For： 121.125.171.194, 1.96.130.81</p> 
<p></p> 
<p>B同学:</p> 
<p>X-Real-IP：1.96.119.104</p> 
<p>X-Forwarded-For： 121.125.171.194, 1.96.119.104</p> 
<p> </p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/24d5f0c501ca4e30f760bbe2fb5363a2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">springboot集成nacos配置管理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/196b853ccd68c514f1ee50e24e48d8b3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">calHist()-使用OpenCV和C&#43;&#43;计算直方图</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>