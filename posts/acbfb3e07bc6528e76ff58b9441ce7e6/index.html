<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ZooKeeper - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ZooKeeper" />
<meta property="og:description" content="文章目录 1、ZooKeeper是什么2、应用场景（1）维护配置信息（2）集群管理&amp;注册中心（3）分布式锁（4）生成分布式唯一ID 3、数据模型4、Zookeeper使用 1、ZooKeeper是什么 zooKeeper致力于为分布式应用提供一个高性能、高可用，且具有严格顺序访问控制能力的分布式协调服务。
1、高性能
zooKeeper将全量数据存储在内存中，并直接服务于客户端的所有非事务请求，尤其适用于以读为主的应用场景。
2、高可用
zooKeeper一般以集群的方式对外提供服务，一般3 ~ 5台机器就可以组成一个可用的zookeeper集群了，每台机器都会在内存中维护当前的服务器状态，并且每台机器之间都相互保持着通信。只要集群中超过一半的机器都能够正常工作，那么整个集群就能够正常对外服务。
3、严格顺序访问
对于来自客户端的每个更新请求，ZooKeeper都会分配一个全局唯一的递增编号，这个编号反映了所有事务操作的先后顺序。
2、应用场景 ZooKeeper是一个经典的分布式数据一致性解决方案，致力于为分布式应用提供一个高性能、高可用，且具有严格顺序访问控制能力的分布式协调存储服务。
注册中心、配置中心、集群管理、分布式锁、生成分布式唯一ID
（1）维护配置信息 zooKeeper、config、nacos都可以当做配置中心使用。分布式兴起，许多服务使用相同的配置文件，如果配置文件发送变化，运维上需要逐个修改服务的配置文件，非常繁琐。通常会将配置文件部署在一个集群上，提供服务，高效快速且可靠地完成配置项的更改等操作，并能够保证各配置项在每台服务器上的数据一致性。
zookeeper就可以提供这样一种服务，其使用Zab这种一致性协议来保证一致性。现在有很多开源项目使用zookeeper来维护配置，比如在hbase中，客户端就是连接 一个zookeeper，获得必要的hbase集群的配置信息，然后才可以进一步操作。还有在开源的消息队列kafka中，也使用zookeeper来维护broker的信息。在alibaba开源的soa框架dubbo中也广泛的使用zookeeper管理一些配置来实现服务治理。
（2）集群管理&amp;注册中心 一个集群有时会因为各种软硬件故障或者网络故障，出现某些服务器挂掉而被移除集群，而某些服务器加入到集群中的情况，zookeeper会将这些服务器加入/移出的情况 通知给集群中的其他正常工作的服务器，以及及时调整存储和计算等任务的分配和执行等。此外zookeeper还会对故障的服务器做出诊断并尝试修复。
（3）分布式锁 多台服务器上运行着同一种服务，要协调各服务的进度，有时候需要保证当某个服务在进行某个操作时，其他的服务都不能进行该操作，即对该操作进行加锁，如果当前机器挂掉后，释放锁并fail over 到其他的机器继续执行该服务。
（4）生成分布式唯一ID 单库单表型系统中，通常可以使用数据库字段自带的auto_increment属性来自动为每条记录生成一个唯一的ID。但是分库分表后，就无法在依靠数据库的 auto_increment属性来唯一标识一条记录了。此时我们就可以用zookeeper在分布式环境下生成全局唯一ID。做法如下：每次要生成一个新Id时，创建一个持久顺序节点，创建操作返回的节点序号，即为新Id，然后把比自己节点小的删除即可。
3、数据模型 zookeeper的数据节点可以视为树状结构（或者目录），树中的各节点被称为znode（即zookeeper node），类似Linux的文件系统，一个znode可以有多个子节点。zookeeper节点在结构上表现为树状；使用路径path来定位某个znode，比如/ns-1/itcast/mysql/schema1/table1，此处ns-1、itcast、mysql、schema1、table1分别是根节点、2级节点、3级节点以及4级节点；其中ns-1是itcast的父节点，itcast是ns-1的子节点，itcast是mysql的父节点，mysql是itcast的子节点，以此类推。
znode，兼具文件和目录两种特点。既像文件一样维护着数据、元信息、ACL、时间戳等数据结构，又像目录一样可以作为路径标识的一部分。
节点类型：
zookeeper中的节点有两种，分别为临时节点和永久节点。节点的类型在创建时即被确定，并且不能改变。
临时节点：该节点的生命周期依赖于创建它们的会话。一旦会话(Session)结束，临时节点将被自动删除，当然也可以手动删除。虽然每个临时的Znode都会绑定到一个客户端会话，但他们对所有的客户端还是可见的。另外，ZooKeeper的临时节点不允许拥有子节点。
持久化节点：该节点的生命周期不依赖于会话，并且只有在客户端显示执行删除操作的时候，他们才能被删除。
4、Zookeeper使用 参考链接：https://blog.csdn.net/java_66666/article/details/81015302?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/acbfb3e07bc6528e76ff58b9441ce7e6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-16T21:08:23+08:00" />
<meta property="article:modified_time" content="2023-12-16T21:08:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ZooKeeper</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1ZooKeeper_11" rel="nofollow">1、ZooKeeper是什么</a></li><li><a href="#2_19" rel="nofollow">2、应用场景</a></li><li><ul><li><a href="#1_22" rel="nofollow">（1）维护配置信息</a></li><li><a href="#2_28" rel="nofollow">（2）集群管理&amp;注册中心</a></li><li><a href="#3_31" rel="nofollow">（3）分布式锁</a></li><li><a href="#4ID_33" rel="nofollow">（4）生成分布式唯一ID</a></li></ul> 
  </li><li><a href="#3_35" rel="nofollow">3、数据模型</a></li><li><a href="#4Zookeeper_45" rel="nofollow">4、Zookeeper使用</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="1ZooKeeper_11"></a>1、ZooKeeper是什么</h2> 
<p>zooKeeper致力于为分布式应用提供一个高性能、高可用，且具有严格顺序访问控制能力的分布式协调服务。</p> 
<blockquote> 
 <p>1、高性能<br> zooKeeper将全量数据存储在内存中，并直接服务于客户端的所有非事务请求，尤其适用于以读为主的应用场景。<br> 2、高可用<br> zooKeeper一般以集群的方式对外提供服务，一般3 ~ 5台机器就可以组成一个可用的zookeeper集群了，每台机器都会在内存中维护当前的服务器状态，并且每台机器之间都相互保持着通信。只要集群中超过一半的机器都能够正常工作，那么整个集群就能够正常对外服务。<br> 3、严格顺序访问<br> 对于来自客户端的每个更新请求，ZooKeeper都会分配一个全局唯一的递增编号，这个编号反映了所有事务操作的先后顺序。</p> 
</blockquote> 
<h2><a id="2_19"></a>2、应用场景</h2> 
<p>ZooKeeper是一个经典的<mark>分布式数据一致性</mark>解决方案，致力于为分布式应用提供一个高性能、高可用，且具有严格顺序访问控制能力的分布式协调存储服务。<br> 注册中心、配置中心、集群管理、分布式锁、生成分布式唯一ID</p> 
<h3><a id="1_22"></a>（1）维护配置信息</h3> 
<p>zooKeeper、config、nacos都可以当做配置中心使用。分布式兴起，许多服务使用相同的配置文件，如果配置文件发送变化，运维上需要逐个修改服务的配置文件，非常繁琐。通常会将配置文件部署在一个集群上，提供服务，高效快速且可靠地完成配置项的更改等操作，并能够保证各配置项在每台服务器上的数据一致性。</p> 
<p>zookeeper就可以提供这样一种服务，其使用Zab这种一致性协议来保证一致性。现在有很多开源项目使用zookeeper来维护配置，比如在hbase中，客户端就是连接 一个zookeeper，获得必要的hbase集群的配置信息，然后才可以进一步操作。还有在开源的消息队列kafka中，也使用zookeeper来维护broker的信息。在alibaba开源的soa框架dubbo中也广泛的使用zookeeper管理一些配置来实现服务治理。<br> <img src="https://images2.imgbox.com/c8/b2/vucmhdwF_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_28"></a>（2）集群管理&amp;注册中心</h3> 
<p>一个集群有时会因为各种软硬件故障或者网络故障，出现某些服务器挂掉而被移除集群，而某些服务器加入到集群中的情况，zookeeper会将这些服务器加入/移出的情况 通知给集群中的其他正常工作的服务器，以及及时调整存储和计算等任务的分配和执行等。此外zookeeper还会对故障的服务器做出诊断并尝试修复。<br> <img src="https://images2.imgbox.com/8d/41/ki43HF5F_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_31"></a>（3）分布式锁</h3> 
<p>多台服务器上运行着同一种服务，要协调各服务的进度，有时候需要保证当某个服务在进行某个操作时，其他的服务都不能进行该操作，即对该操作进行加锁，如果当前机器挂掉后，释放锁并fail over 到其他的机器继续执行该服务。</p> 
<h3><a id="4ID_33"></a>（4）生成分布式唯一ID</h3> 
<p>单库单表型系统中，通常可以使用数据库字段自带的auto_increment属性来自动为每条记录生成一个唯一的ID。但是分库分表后，就无法在依靠数据库的 auto_increment属性来唯一标识一条记录了。此时我们就可以用zookeeper在分布式环境下生成全局唯一ID。做法如下：每次要生成一个新Id时，创建一个持久顺序节点，创建操作返回的节点序号，即为新Id，然后把比自己节点小的删除即可。</p> 
<h2><a id="3_35"></a>3、数据模型</h2> 
<p>zookeeper的数据节点可以视为树状结构（或者目录），树中的各节点被称为znode（即zookeeper node），类似Linux的文件系统，一个znode可以有多个子节点。zookeeper节点在结构上表现为树状；使用路径path来定位某个znode，比如/ns-1/itcast/mysql/schema1/table1，此处ns-1、itcast、mysql、schema1、table1分别是根节点、2级节点、3级节点以及4级节点；其中ns-1是itcast的父节点，itcast是ns-1的子节点，itcast是mysql的父节点，mysql是itcast的子节点，以此类推。</p> 
<p>znode，兼具文件和目录两种特点。既像文件一样维护着数据、元信息、ACL、时间戳等数据结构，又像目录一样可以作为路径标识的一部分。</p> 
<blockquote> 
 <p><mark>节点类型：</mark><br> zookeeper中的节点有两种，分别为临时节点和永久节点。节点的类型在创建时即被确定，并且不能改变。<br> 临时节点：该节点的生命周期依赖于创建它们的会话。一旦会话(Session)结束，临时节点将被自动删除，当然也可以手动删除。虽然每个临时的Znode都会绑定到一个客户端会话，但他们对所有的客户端还是可见的。另外，ZooKeeper的临时节点不允许拥有子节点。<br> 持久化节点：该节点的生命周期不依赖于会话，并且只有在客户端显示执行删除操作的时候，他们才能被删除。</p> 
</blockquote> 
<h2><a id="4Zookeeper_45"></a>4、Zookeeper使用</h2> 
<p>参考链接：<a href="https://blog.csdn.net/java_66666/article/details/81015302?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170270241316800184153223%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=170270241316800184153223&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-81015302-null-null.142%5Ev96%5Epc_search_result_base6&amp;utm_term=zookeeper&amp;spm=1018.2226.3001.4187">https://blog.csdn.net/java_66666/article/details/81015302?</a></p> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/72a403d4f27f0ad751f9d4d177b02e44/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">介绍 Docker 的基本概念和优势，以及在应用程序开发中的实际应用。</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dff7242e5459044a04615992c521aa48/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">年底总结-基于战略落地的年度经营计划</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>