<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>前缀和算法 -- [模版]二维前缀和 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="前缀和算法 -- [模版]二维前缀和" />
<meta property="og:description" content="个人主页：Lei宝啊 愿所有美好如期而遇
本题链接 【模板】二维前缀和_牛客题霸_牛客网 输入描述 n是行，m是列，q是查询次数，x1，y1，x2，y2是二维数组的下标。
输出描述 通过两对下标，计算这两对下标构成的这个子矩阵的和。
算法分析 算法一：暴力求解 直接遍历数组，我们考虑最坏情况就是q次查询都是从头遍历到尾，时间复杂度就是O(n*m*q)，这绝对是超时的。
算法二：前缀和 我们不希望每次查询时都要遍历去计算和，所以我们就有了创建dp表并进行预处理。
预处理二维dp表 首先我们要明白dp表每一个位置代表的状态，也就是说，dp[i][j] 就代表着从 [1,1] 到 [i,j] 这个子矩阵的和， 同时，我们创建dp表时下标从1开始，也就是说，不仅仅是数组下标从1开始，为什么要从1开始？一个是题目的m和n就是大于等于1的，另一个原因在于使用dp表进行计算时防止越界。
我们先创建这样的数组(示例一)： 接下来就是创建dp表，并进行预处理，但是我们怎么填充dp表呢？暴力遍历吗？分析一下时间复杂度，dp表我们有m*n个元素需要填充，每个元素都代表着子矩阵的和，也就是需要遍历数组，所以整体的时间复杂度就是O(m*n*m*n)， 这样的时间复杂度甚至不如直接暴力求解，我们需要其他方法。
小学的时候，我们计算过面积，计算一块面积有时候直接算并不好算，于是我们分割了图形，求每个部分图形的和。
同理，直接算矩阵和不好算，我们将他分割成A，B，C，D四块，dp[i][j]的值就是A &#43; B &#43; C &#43; D，但是我们发现A好算，就是dp[i-1][j-1]，B和C并不好算，但是A&#43;B呢？A&#43;C呢？
所以我们也就有了思路：
最终我们得到dp表：
使用dp表计算 现在我们有了[1,1]到任意一个下标这个子矩阵的和，现在我们要算任意两个下标构成的子矩阵的和，我们看图：
我们似乎仍然能像面积一样进行分割：
解题源码 #include &lt;iostream&gt; #include &lt;vector&gt; using namespace std; int main() { //n行，m列，q次 int n, m, q; cin &gt;&gt; n &gt;&gt; m &gt;&gt; q; //创建二维数组 vector&lt;vector&lt;int&gt;&gt; vv(n&#43;1,vector&lt;int&gt;(m&#43;1, 0)); for(int i=1; i&lt;n&#43;1; i&#43;&#43;) { for(int j=1; j&lt;m&#43;1; j&#43;&#43;) { cin &gt;&gt; vv[i][j]; } } //创建dp表并填充 vector&lt;vector&lt;long long&gt;&gt; dp(n&#43;1,vector&lt;long long&gt;(m&#43;1, 0)); for(int i=1; i&lt;n&#43;1; i&#43;&#43;) { for(int j=1; j&lt;m&#43;1; j&#43;&#43;) { dp[i][j] = dp[i-1][j] &#43;dp[i][j-1] - dp[i-1][j-1] &#43; vv[i][j]; } } while(q--) { int x1, y1, x2, y2; cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2; long long sum = dp[x2][y2] - dp[x1-1][y2] - dp[x2][y1-1] &#43;dp[x1-1][y1-1]; cout &lt;&lt; sum &lt;&lt; endl; } } // 64 位输出请用 printf(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6140dfcbc5cf2a99b645897ca081f608/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-02T14:33:48+08:00" />
<meta property="article:modified_time" content="2024-01-02T14:33:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">前缀和算法 -- [模版]二维前缀和</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p class="img-center"><img alt="" height="80" src="https://images2.imgbox.com/b0/c5/foDp51FR_o.gif" width="640"></p> 
<p style="text-align:center;"><span style="color:#956fe7;"> 个人主页：<a href="https://blog.csdn.net/m0_74824254?spm=1011.2266.3001.5343" title="Lei宝啊">Lei宝啊</a> </span></p> 
<p style="text-align:center;"><span style="color:#faa572;">愿所有美好如期而遇</span></p> 
<hr> 
<p><img alt="" height="1126" src="https://images2.imgbox.com/6d/b1/VYOlsH7v_o.png" width="1134"></p> 
<p><img alt="" height="463" src="https://images2.imgbox.com/1d/08/cEAXhGhF_o.png" width="925"> </p> 
<h4>本题链接</h4> 
<p><a href="https://www.nowcoder.com/practice/99eb8040d116414ea3296467ce81cbbc?tpId=230&amp;tqId=2023819&amp;ru=/exam/oj&amp;qru=/ta/dynamic-programming/question-ranking&amp;sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3D%25E7%25AE%2597%25E6%25B3%2595%25E7%25AF%2587%26topicId%3D196" rel="nofollow" title="【模板】二维前缀和_牛客题霸_牛客网">【模板】二维前缀和_牛客题霸_牛客网</a> </p> 
<h4>输入描述</h4> 
<p>n是行，m是列，q是查询次数，x1，y1，x2，y2是二维数组的下标。</p> 
<h4>输出描述</h4> 
<p>通过两对下标，计算这两对下标构成的这个子矩阵的和。</p> 
<h4>算法分析</h4> 
<h5>算法一：暴力求解</h5> 
<p>直接遍历数组，我们考虑最坏情况就是q次查询都是从头遍历到尾，时间复杂度就是O(n*m*q)，这绝对是超时的。</p> 
<h5>算法二：前缀和</h5> 
<p>我们不希望每次查询时都要遍历去计算和，所以我们就有了创建dp表并进行预处理。</p> 
<h6>预处理二维dp表</h6> 
<p>首先我们要明白dp表每一个位置代表的状态，也就是说，dp[i][j] 就代表着从 [1,1] 到 [i,j] 这个子矩阵的和， 同时，我们创建dp表时下标从1开始，也就是说，不仅仅是数组下标从1开始，为什么要从1开始？一个是题目的m和n就是大于等于1的，另一个原因在于使用dp表进行计算时防止越界。</p> 
<p>我们先创建这样的数组(示例一)： </p> 
<p><img alt="" height="284" src="https://images2.imgbox.com/54/1c/b2oOJ35t_o.png" width="490"></p> 
<p>接下来就是创建dp表，并进行预处理，但是我们怎么填充dp表呢？暴力遍历吗？分析一下时间复杂度，dp表我们有m*n个元素需要填充，每个元素都代表着子矩阵的和，也就是需要遍历数组，所以整体的时间复杂度就是O(m*n*m*n)， 这样的时间复杂度甚至不如直接暴力求解，我们需要其他方法。</p> 
<p>小学的时候，我们计算过面积，计算一块面积有时候直接算并不好算，于是我们分割了图形，求每个部分图形的和。</p> 
<p><img alt="" height="514" src="https://images2.imgbox.com/16/65/ziNXV8Td_o.png" width="1054"></p> 
<p>同理，直接算矩阵和不好算，我们将他分割成A，B，C，D四块，dp[i][j]的值就是A + B + C + D，但是我们发现A好算，就是dp[i-1][j-1]，B和C并不好算，但是A+B呢？A+C呢？</p> 
<p>所以我们也就有了思路：</p> 
<p><img alt="" height="885" src="https://images2.imgbox.com/d3/99/FMYbWcyI_o.png" width="1200"></p> 
<p>最终我们得到dp表：</p> 
<p><img alt="" height="297" src="https://images2.imgbox.com/bc/7a/wH1KctrR_o.png" width="464"> </p> 
<h6>使用dp表计算</h6> 
<p>现在我们有了[1,1]到任意一个下标这个子矩阵的和，现在我们要算任意两个下标构成的子矩阵的和，我们看图：</p> 
<p><img alt="" height="460" src="https://images2.imgbox.com/68/cb/vjpVLxWW_o.png" width="1200"></p> 
<p>我们似乎仍然能像面积一样进行分割：</p> 
<p><img alt="" height="544" src="https://images2.imgbox.com/5a/cd/3xDQUN48_o.png" width="1086"> <img alt="" height="942" src="https://images2.imgbox.com/04/40/fhlOl7fl_o.png" width="1200"></p> 
<h4>解题源码</h4> 
<pre><code class="hljs">#include &lt;iostream&gt;
#include &lt;vector&gt;
using namespace std;

int main() 
{
    
    //n行，m列，q次
    int n, m, q;
    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;

    //创建二维数组
    vector&lt;vector&lt;int&gt;&gt; vv(n+1,vector&lt;int&gt;(m+1, 0));
    for(int i=1; i&lt;n+1; i++)
    {
        for(int j=1; j&lt;m+1; j++)
        {
            cin &gt;&gt; vv[i][j];
        }
    }

    //创建dp表并填充
    vector&lt;vector&lt;long long&gt;&gt; dp(n+1,vector&lt;long long&gt;(m+1, 0));
    for(int i=1; i&lt;n+1; i++)
    {
        for(int j=1; j&lt;m+1; j++)
        {
            dp[i][j] = dp[i-1][j] +dp[i][j-1] - dp[i-1][j-1] + vv[i][j];
        }
    }

    while(q--)
    {
        int x1, y1, x2, y2;
        cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;

        long long sum = dp[x2][y2] - dp[x1-1][y2] - dp[x2][y1-1] 
                                                          +dp[x1-1][y1-1];
        cout &lt;&lt; sum &lt;&lt; endl;
    }

}
// 64 位输出请用 printf("%lld")</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b5df49ef1b93142d252ba8aa52c6b988/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">网页设计与制作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a550d3de8b2bed78aa438bca3db89c85/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Vue开发者必备！手把手教你实现类似Element Plus的全局提示组件！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>