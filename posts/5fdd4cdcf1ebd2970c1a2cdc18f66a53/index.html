<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python 中任务 6.3 构建并评分分类模型(SVM模型)   学习笔记3 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python 中任务 6.3 构建并评分分类模型(SVM模型)   学习笔记3" />
<meta property="og:description" content="文章目录 任务6.3 构建并评价分类模型6.3.1 使用sklearn 估计器构建分类模型代码6-17 使用sklearn估计器构建SVM模型sklearn 库常用分类算法函数代码 6-18 分类结果的混淆矩阵与准确率 6.3.2 评价分类模型代码6-19 分类模型常用评价方法代码6-20 分类模型评价报告代码6-21 绘制ROC曲线ROC曲线 6.3.3 任务实现使用sklearn构建鲍鱼年龄预测的步骤如下 1 构建SVM分类模型代码 6-22 鲍鱼年龄预测2. 评价构建的SVM分类模型代码 6-23 评价构建的SVM分类模型 任务6.3 构建并评价分类模型 6.3.1 使用sklearn 估计器构建分类模型 代码6-17 使用sklearn估计器构建SVM模型 在数据分析领域，分类算法有很多，其原理千差万别，有基于样本距离的最近邻算法，有基于特征信息熵的决策树，有基于bagging的随机森林 ，有基于boosting的梯度提升分类树 ，但其实现的过程相差不大。过程如图所示。
%%html &lt;img style=&#34;float: left;&#34; src=&#34;./image/6-17.png&#34; width=300 height=400&gt; sklearn 库常用分类算法函数 sklearn中提供的分类算法非常多，分别存在于不同的模块中。常用的分类算法如下表所示。
%%html &lt;img style=&#34;float: left;&#34; src=&#34;./image/6-17-2.png&#34; width=400 height=400&gt; import numpy as np from sklearn.datasets import load_breast_cancer from sklearn.svm import SVC from sklearn.model_selection import train_test_split#划分数据 from sklearn.preprocessing import StandardScaler #标准差 cancer = load_breast_cancer() cancer_data = cancer[&#39;data&#39;] cancer_target = cancer[&#39;target&#39;] cancer_names = cancer[&#39;feature_names&#39;] ## 将数据划分为训练集测试集 cancer_data_train,cancer_data_test, \ cancer_target_train,cancer_target_test = \ train_test_split(cancer_data,cancer_target, test_size = 0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/5fdd4cdcf1ebd2970c1a2cdc18f66a53/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-23T11:08:20+08:00" />
<meta property="article:modified_time" content="2020-12-23T11:08:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python 中任务 6.3 构建并评分分类模型(SVM模型)   学习笔记3</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#63__1" rel="nofollow">任务6.3 构建并评价分类模型</a></li><li><ul><li><a href="#631_sklearn__3" rel="nofollow">6.3.1 使用sklearn 估计器构建分类模型</a></li><li><ul><li><a href="#617_sklearnSVM_5" rel="nofollow">代码6-17 使用sklearn估计器构建SVM模型</a></li><li><a href="#sklearn__19" rel="nofollow">sklearn 库常用分类算法函数</a></li><li><a href="#_618__72" rel="nofollow">代码 6-18 分类结果的混淆矩阵与准确率</a></li></ul> 
   </li><li><a href="#632__89" rel="nofollow">6.3.2 评价分类模型</a></li><li><ul><li><a href="#619__105" rel="nofollow">代码6-19 分类模型常用评价方法</a></li><li><a href="#620__130" rel="nofollow">代码6-20 分类模型评价报告</a></li><li><a href="#621_ROC_152" rel="nofollow">代码6-21 绘制ROC曲线</a></li><li><a href="#ROC_175" rel="nofollow">ROC曲线</a></li></ul> 
   </li><li><a href="#633__179" rel="nofollow">6.3.3 任务实现</a></li><li><ul><li><ul><li><a href="#sklearn_181" rel="nofollow">使用sklearn构建鲍鱼年龄预测的步骤如下</a></li></ul> 
    </li><li><a href="#1_SVM_183" rel="nofollow">1 构建SVM分类模型</a></li><li><a href="#_622__184" rel="nofollow">代码 6-22 鲍鱼年龄预测</a></li><li><a href="#2_SVM_222" rel="nofollow">2. 评价构建的SVM分类模型</a></li><li><a href="#_623_SVM_223" rel="nofollow">代码 6-23 评价构建的SVM分类模型</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="63__1"></a>任务6.3 构建并评价分类模型</h2> 
<h3><a id="631_sklearn__3"></a>6.3.1 使用sklearn 估计器构建分类模型</h3> 
<h4><a id="617_sklearnSVM_5"></a>代码6-17 使用sklearn估计器构建SVM模型</h4> 
<p>在数据分析领域，分类算法有很多，其原理千差万别，有基于样本距离的最近邻算法，有基于特征信息熵的<mark>决策树</mark>，有基于bagging的<mark>随机森林</mark> ，有基于boosting的梯度提升<mark>分类树</mark> ，但其实现的过程相差不大。过程如图所示。</p> 
<pre><code class="prism language-python"><span class="token operator">%</span><span class="token operator">%</span>html
<span class="token operator">&lt;</span>img style<span class="token operator">=</span><span class="token string">"float: left;"</span> src<span class="token operator">=</span><span class="token string">"./image/6-17.png"</span> width<span class="token operator">=</span><span class="token number">300</span> height<span class="token operator">=</span><span class="token number">400</span><span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2c/3a/Tk2xVOFy_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="sklearn__19"></a>sklearn 库常用分类算法函数</h4> 
<p>sklearn中提供的分类算法非常多，分别存在于不同的模块中。常用的分类算法如下表所示。</p> 
<pre><code class="prism language-python"><span class="token operator">%</span><span class="token operator">%</span>html
<span class="token operator">&lt;</span>img style<span class="token operator">=</span><span class="token string">"float: left;"</span> src<span class="token operator">=</span><span class="token string">"./image/6-17-2.png"</span> width<span class="token operator">=</span><span class="token number">400</span> height<span class="token operator">=</span><span class="token number">400</span><span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8a/63/0sLT0GpS_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_breast_cancer
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token comment">#划分数据</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler    <span class="token comment">#标准差</span>
cancer <span class="token operator">=</span> load_breast_cancer<span class="token punctuation">(</span><span class="token punctuation">)</span>
cancer_data <span class="token operator">=</span> cancer<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>
cancer_target <span class="token operator">=</span> cancer<span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span>
cancer_names <span class="token operator">=</span> cancer<span class="token punctuation">[</span><span class="token string">'feature_names'</span><span class="token punctuation">]</span>
<span class="token comment">## 将数据划分为训练集测试集</span>
cancer_data_train<span class="token punctuation">,</span>cancer_data_test<span class="token punctuation">,</span> \
cancer_target_train<span class="token punctuation">,</span>cancer_target_test <span class="token operator">=</span> \
train_test_split<span class="token punctuation">(</span>cancer_data<span class="token punctuation">,</span>cancer_target<span class="token punctuation">,</span>
      test_size <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span>random_state <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">)</span>
<span class="token comment">## 数据标准化</span>
stdScaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>cancer_data_train<span class="token punctuation">)</span>
cancer_trainStd <span class="token operator">=</span> stdScaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>cancer_data_train<span class="token punctuation">)</span>
cancer_testStd <span class="token operator">=</span> stdScaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>cancer_data_test<span class="token punctuation">)</span>
<span class="token comment">## 建立SVM模型</span>
svm <span class="token operator">=</span> SVC<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>cancer_trainStd<span class="token punctuation">,</span>cancer_target_train<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'建立的SVM模型为：\n'</span><span class="token punctuation">,</span>svm<span class="token punctuation">)</span>

<span class="token comment"># 预测训练结果</span>
cancer_target_pred <span class="token operator">=</span> svm<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>cancer_testStd<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'预测前20个结果为: \n'</span><span class="token punctuation">,</span>cancer_target_pred<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>建立的SVM模型为：
 SVC(C=1.0, break_ties=False, cache_size=200, class_weight=None, coef0=0.0,
    decision_function_shape='ovr', degree=3, gamma='scale', kernel='rbf',
    max_iter=-1, probability=False, random_state=None, shrinking=True,
    tol=0.001, verbose=False)
预测前20个结果为: 
 [1 0 0 0 1 1 1 1 1 1 1 1 0 1 1 1 0 0 1 1]
</code></pre> 
<h4><a id="_618__72"></a>代码 6-18 分类结果的混淆矩阵与准确率</h4> 
<pre><code class="prism language-python">true <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>cancer_target_pred <span class="token operator">==</span> cancer_target_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'预测对的结果数目为：'</span><span class="token punctuation">,</span> true<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'预测错的的结果数目为：'</span><span class="token punctuation">,</span> cancer_target_test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span>true<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'预测结果准确率为：'</span><span class="token punctuation">,</span> true<span class="token operator">/</span>cancer_target_test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>预测对的结果数目为： 111
预测错的的结果数目为： 3
预测结果准确率为： 0.9736842105263158
</code></pre> 
<p>SVM模型预测结果的准确率约为97.4%,只有3个测试样本识别错误,说明了整体模型效果理想</p> 
<h3><a id="632__89"></a>6.3.2 评价分类模型</h3> 
<p>分类模型对测试集进行预测而得出的准确率并不能很好地反映模型的性能，为了有效判断一个预测模型的性能表现，需要结合真实值，计算出精确率、召回率、F1值和Cohen’s Kappa系数等指标来衡量。常规分类模型的评价指标如表所示。分类模型评价方法前4种都是分值越高越好，其使用方法基本相同。<br> sklearn的metrics模块还提供了一个能够输出分类模型评价报告的函数classfication_report。</p> 
<pre><code class="prism language-python"><span class="token operator">%</span><span class="token operator">%</span>html
<span class="token operator">&lt;</span>img style<span class="token operator">=</span><span class="token string">"float: left;"</span> src<span class="token operator">=</span><span class="token string">"./image/6-19.png"</span> width<span class="token operator">=</span><span class="token number">600</span> height<span class="token operator">=</span><span class="token number">400</span><span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7e/b7/whzvpbX1_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="619__105"></a>代码6-19 分类模型常用评价方法</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score<span class="token punctuation">,</span>precision_score<span class="token punctuation">,</span> \
recall_score<span class="token punctuation">,</span>f1_score<span class="token punctuation">,</span>cohen_kappa_score
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'使用SVM预测breast_cancer数据的准确率为：'</span><span class="token punctuation">,</span>
      accuracy_score<span class="token punctuation">(</span>cancer_target_test<span class="token punctuation">,</span>cancer_target_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'使用SVM预测breast_cancer数据的精确率为：'</span><span class="token punctuation">,</span>
      precision_score<span class="token punctuation">(</span>cancer_target_test<span class="token punctuation">,</span>cancer_target_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'使用SVM预测breast_cancer数据的召回率为：'</span><span class="token punctuation">,</span>
      recall_score<span class="token punctuation">(</span>cancer_target_test<span class="token punctuation">,</span>cancer_target_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'使用SVM预测breast_cancer数据的F1值为：'</span><span class="token punctuation">,</span>
      f1_score<span class="token punctuation">(</span>cancer_target_test<span class="token punctuation">,</span>cancer_target_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'使用SVM预测breast_cancer数据的Cohen’s Kappa系数为：'</span><span class="token punctuation">,</span>
      cohen_kappa_score<span class="token punctuation">(</span>cancer_target_test<span class="token punctuation">,</span>cancer_target_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>使用SVM预测breast_cancer数据的准确率为： 0.9736842105263158
使用SVM预测breast_cancer数据的精确率为： 0.9594594594594594
使用SVM预测breast_cancer数据的召回率为： 1.0
使用SVM预测breast_cancer数据的F1值为： 0.9793103448275862
使用SVM预测breast_cancer数据的Cohen’s Kappa系数为： 0.9432082364662903
</code></pre> 
<h4><a id="620__130"></a>代码6-20 分类模型评价报告</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'使用SVM预测iris数据的分类报告:'</span><span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">,</span>
     classification_report<span class="token punctuation">(</span>cancer_target_test<span class="token punctuation">,</span>
                          cancer_target_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>使用SVM预测iris数据的分类报告: 
               precision    recall  f1-score   support

           0       1.00      0.93      0.96        43
           1       0.96      1.00      0.98        71

    accuracy                           0.97       114
   macro avg       0.98      0.97      0.97       114
weighted avg       0.97      0.97      0.97       114
</code></pre> 
<h4><a id="621_ROC_152"></a>代码6-21 绘制ROC曲线</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> roc_curve
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment">## 求出ROC曲线的x轴和y轴</span>
fpr <span class="token punctuation">,</span>tpr <span class="token punctuation">,</span>thresholds <span class="token operator">=</span> \
roc_curve<span class="token punctuation">(</span>cancer_target_test<span class="token punctuation">,</span>cancer_target_pred<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">##设定x轴的范围</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span><span class="token number">1.1</span><span class="token punctuation">)</span>  <span class="token comment"># 设定y轴的范围</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'False Postive Rate'</span><span class="token punctuation">)</span> <span class="token comment">#伪阳性率</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'True Postive Rate'</span><span class="token punctuation">)</span>  <span class="token comment">#真阳性率</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span>tpr<span class="token punctuation">,</span>linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>linestyle<span class="token operator">=</span><span class="token string">'-'</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ff/9e/x7iYHpFH_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Rh53V5bk-1608692846401)(output_17_0.png)]"></p> 
<h4><a id="ROC_175"></a>ROC曲线</h4> 
<p>除了使用数值，表格形式评估分类模型的性能，还可通过绘制ROC曲线的方式来评估分类模型。<br> ROC曲线横纵坐标范围为[0,1]，通常情况下ROC曲线与X轴形成的面积越大，表示模型性能越好。但是当ROC曲线处于下图中蓝色虚线的位置，就表明了模型的计算结果基本都是随机得来的，在此种情况下模型起到的作用几乎为零。故在实际中ROC曲线离图中蓝色虚线越远表示模型效果越好。</p> 
<h3><a id="633__179"></a>6.3.3 任务实现</h3> 
<p>常规的鲍鱼的年龄是通过显微镜查看切割,染色后的外壳上环的数量得到的,十分耗时.一些常规的物理量(如性别,长度,宽度,壳体重量等)的测量十分容易获取,若能够使用这些物理量预测年龄,将节省大量时间</p> 
<h5><a id="sklearn_181"></a>使用sklearn构建鲍鱼年龄预测的步骤如下</h5> 
<h4><a id="1_SVM_183"></a>1 构建SVM分类模型</h4> 
<h4><a id="_622__184"></a>代码 6-22 鲍鱼年龄预测</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
abalone <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../data/abalone.data'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
<span class="token comment"># 将数据和标签拆开</span>
abalone_data <span class="token operator">=</span> abalone<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span>
abalone_target <span class="token operator">=</span> abalone<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span>
<span class="token comment">#连续型特征离散化</span>
sex <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>abalone_data<span class="token punctuation">[</span><span class="token string">'sex'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
abalone_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>abalone_data<span class="token punctuation">,</span>sex<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
abalone_data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'sex'</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>inplace <span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># 划分训练集,测试集</span>
abalone_train<span class="token punctuation">,</span>abalone_test<span class="token punctuation">,</span>\
abalone_target_train<span class="token punctuation">,</span>abalone_target_test <span class="token operator">=</span> \
train_test_split<span class="token punctuation">(</span>abalone_data<span class="token punctuation">,</span>abalone_target<span class="token punctuation">,</span>
                train_size <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span>random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
<span class="token comment"># 标准化</span>
stdScaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>abalone_train<span class="token punctuation">)</span>
abalone_std_train <span class="token operator">=</span> stdScaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>abalone_train<span class="token punctuation">)</span>
abalone_std_test <span class="token operator">=</span> stdScaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>abalone_test<span class="token punctuation">)</span>
<span class="token comment">## 建模</span>
svm_abalone <span class="token operator">=</span> SVC<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>abalone_std_train<span class="token punctuation">,</span>abalone_target_train<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'建立的SVM模型为：'</span><span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">,</span>svm_abalone<span class="token punctuation">)</span>
</code></pre> 
<pre><code>建立的SVM模型为： 
 SVC(C=1.0, break_ties=False, cache_size=200, class_weight=None, coef0=0.0,
    decision_function_shape='ovr', degree=3, gamma='scale', kernel='rbf',
    max_iter=-1, probability=False, random_state=None, shrinking=True,
    tol=0.001, verbose=False)
</code></pre> 
<h4><a id="2_SVM_222"></a>2. 评价构建的SVM分类模型</h4> 
<h4><a id="_623_SVM_223"></a>代码 6-23 评价构建的SVM分类模型</h4> 
<p>代码6-23 的结果显示了本次模型每个类别的精确率,召回率和F1值,其中除了对鲍鱼年龄为4的预测结果较好外,其他的预测结果欠佳,后期还需要仔细调整</p> 
<pre><code class="prism language-python">abalone_target_pred <span class="token operator">=</span> svm_abalone<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>abalone_std_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'abalone数据集的SVM分类报告为: \n'</span><span class="token punctuation">,</span>
     classification_report<span class="token punctuation">(</span>abalone_target_test<span class="token punctuation">,</span>abalone_target_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>abalone数据集的SVM分类报告为: 
               precision    recall  f1-score   support

           3       0.00      0.00      0.00         3
           4       0.45      0.69      0.55        13
           5       0.54      0.22      0.31        32
           6       0.40      0.33      0.36        48
           7       0.41      0.44      0.42        84
           8       0.37      0.36      0.37        99
           9       0.28      0.57      0.38       142
          10       0.24      0.33      0.28       139
          11       0.25      0.25      0.25        93
          12       0.00      0.00      0.00        51
          13       0.00      0.00      0.00        31
          14       0.00      0.00      0.00        26
          15       0.00      0.00      0.00        21
          16       0.00      0.00      0.00        13
          17       0.00      0.00      0.00         8
          18       0.00      0.00      0.00        12
          19       0.00      0.00      0.00         7
          20       0.00      0.00      0.00         4
          21       0.00      0.00      0.00         3
          22       0.00      0.00      0.00         3
          23       0.00      0.00      0.00         4

    accuracy                           0.31       836
   macro avg       0.14      0.15      0.14       836
weighted avg       0.25      0.31      0.26       836



D:\Study\anaconda\lib\site-packages\sklearn\metrics\_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9715ddade41f1b944e0e902b54297227/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue elementui前端异步方法转同步记录</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dfc3c728ff21b2d74931b8ed71a65a2d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">oracle 使用to_number转换字符型时报错：无效的数字</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>