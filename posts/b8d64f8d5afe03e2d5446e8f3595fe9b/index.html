<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>org.quartz.JobPersistenceException: Couldn&#39;t retrieve trigger: Table &#39;leo_quartz.QRTZ_TSSDRS&#39; does - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="org.quartz.JobPersistenceException: Couldn&#39;t retrieve trigger: Table &#39;leo_quartz.QRTZ_TSSDRS&#39; does" />
<meta property="og:description" content="org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;schedulerFactoryBean&#39; defined in class path resource [cn/leopard/service/quartz/SchedulerConfig.class]: Invocat ion of init method failed; nested exception is org.quartz.JobPersistenceException: Couldn&#39;t retrieve trigger: Table &#39;leo_quartz.QRTZ_TSSDRS&#39; doesn&#39;t exist [See nested exception: com.mysql.jdbc.excep tions.jdbc4.MySQLSyntaxErrorException: Table &#39;leo_quartz.QRTZ_TSSDRS&#39; doesn&#39;t exist] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1628) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:555) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:483) at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306) at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230) at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302) at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197) at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:742) at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:866) at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:542) at org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.refresh(EmbeddedWebApplicationContext.java:122) at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:737) at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:370) at org.springframework.boot.SpringApplication.run(SpringApplication.java:314) at org.springframework.boot.SpringApplication.run(SpringApplication.java:1162) at org." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b8d64f8d5afe03e2d5446e8f3595fe9b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-04-18T15:00:51+08:00" />
<meta property="article:modified_time" content="2018-04-18T15:00:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">org.quartz.JobPersistenceException: Couldn&#39;t retrieve trigger: Table &#39;leo_quartz.QRTZ_TSSDRS&#39; does</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h6></h6> 
<pre><code class="language-java">org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'schedulerFactoryBean' defined in class path resource [cn/leopard/service/quartz/SchedulerConfig.class]: Invocat
ion of init method failed; nested exception is org.quartz.JobPersistenceException: Couldn't retrieve trigger: Table 'leo_quartz.QRTZ_TSSDRS' doesn't exist [See nested exception: com.mysql.jdbc.excep
tions.jdbc4.MySQLSyntaxErrorException: Table 'leo_quartz.QRTZ_TSSDRS' doesn't exist]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1628)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:555)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:483)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:742)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:866)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:542)
	at org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.refresh(EmbeddedWebApplicationContext.java:122)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:737)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:370)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:314)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1162)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1151)
	at cn.leopard.service.ipc.Application.main(Application.java:26)</code></pre> 
<span style="color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;font-size:12px;background-color:rgb(255,255,255);">使用到了 Quartz 集群的特性，所以建了 MySql 的中间表，此错误显示的“QRTZ_TSSDRS”表是存在，但却找不出，查找网上资料，可能是由于linux对大小写敏感判断导致，<span style="color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;font-size:12px;background-color:rgb(255,255,255);">代码中的 sql 语句表明也都是用小写，所以未碰到。现在 Quartz 偏喜欢大写，问题也就这样来了。</span></span> 
<p style="margin-top:.6em;margin-bottom:1.2em;border:0px;font-size:12px;vertical-align:baseline;background:rgb(255,255,255);color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;">知道原因，找解决办法就可有的放矢了，google mysql linux 表名不区分大小写，答案立马找到：</p> 
<p style="margin-top:.6em;margin-bottom:1.2em;border:0px;font-size:12px;vertical-align:baseline;background:rgb(255,255,255);color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;">需要改 MySQL 的配置文件，Linux 下 MySQL 的配置文件可能是 /etc/my.cnf，或 /etc/mysql/my.cnf，这依赖于你的安装方式。假如是 /etc/my.cnf，那么执行</p> 
<pre><code class="language-ruby">sudo vi /etc/my.cnf</code></pre> 
<p style="margin-top:.6em;margin-bottom:1.2em;border:0px;font-size:12px;vertical-align:baseline;background:rgb(255,255,255);color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;">在 [mysqld] 节中添加：</p> 
<div class="ezAdsense adsense adsense-midtext" style="margin:12px;padding:0px;border:0px;font-size:12px;vertical-align:baseline;background:rgb(255,255,255);color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;float:left;"> 
 <span class="inner_copyright" style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background:transparent;"></span> 
</div> 
<pre><code class="language-ruby">lower_case_table_names=1</code></pre> 
<p style="margin-top:.6em;margin-bottom:1.2em;border:0px;font-size:12px;vertical-align:baseline;background:rgb(255,255,255);color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;">然后保存，用 sudo /etc/init.d/mysql restart 重启 MySQL 服务便让 Linux 系统对表名大小写不敏感了。</p> 
<p style="margin-top:.6em;margin-bottom:1.2em;border:0px;font-size:12px;vertical-align:baseline;background:rgb(255,255,255);color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;">其实准确来说不是说 Linux 对于 MySQL 表名忽略大小写，而是应用上面的配置后，MySQL 服务程序会来自于应用程序里的请求的表名转换为小写，如你查询 select*  UNMI_TABLE，MySQL 会认为是查询的 select * from unmi_table，所以在加入</p> 
<p style="margin-top:.6em;margin-bottom:1.2em;border:0px;font-size:12px;vertical-align:baseline;background:rgb(255,255,255);color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;">lower_case_table_names=1</p> 
<p style="margin-top:.6em;margin-bottom:1.2em;border:0px;font-size:12px;vertical-align:baseline;background:rgb(255,255,255);color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;">之前时你必须把表名都改为小写。也就是在创建表时都用小写名字，如果创建的表名为 UNMI_TABLE，那么程序中无论是执行 select * from UNMI_TABLE 还是执行 select * from unmi_table 都会碰到类似下面的错误：</p> 
<p style="margin-top:.6em;margin-bottom:1.2em;border:0px;font-size:12px;vertical-align:baseline;background:rgb(255,255,255);color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;">Invocation of init method failed; nested exception is org.quartz.JobPersistenceException: Couldn't retrieve trigger: Table 'unmijob.qrtz_triggers' doesn't exist [See nested exception: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Table 'unmijob.qrtz_triggers' doesn't exist]</p> 
<p style="margin-top:.6em;margin-bottom:1.2em;border:0px;font-size:12px;vertical-align:baseline;background:rgb(255,255,255);color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;">因为 MySQL 服务程序认为表名就是小写的 unmi_table，而在数据库中的表名不是这样子的。</p> 
<p style="margin-top:.6em;margin-bottom:1.2em;border:0px;font-size:12px;vertical-align:baseline;background:rgb(255,255,255);color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;">而且此时在 MySQL 客户端都无法把 <span style="color:rgb(73,73,73);font-family:'Comic Sans MS', 'Microsoft Yahei', SimSun, Arial;font-size:12px;font-weight:700;background-color:rgb(255,255,255);">QRTZ_TSSDRS</span> 改成 qrtz_triggers. 因为表名的大小写是与文件系统中的数据目录下的 frm 文件相对应的。</p>文章参考链接：https://unmi.cc/linux-mysql-lower-case-table-names/
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6daa5231038a311c7100a07ec7b1beaf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java Web开发常见异常及排查方法记录</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/183e26e3df8835a3c29750ed5fb23588/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">WPF 使用Font Awesome</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>