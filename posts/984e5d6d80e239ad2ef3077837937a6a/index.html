<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>LayaBox入门基础之JS代码实现按钮删除功能 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="LayaBox入门基础之JS代码实现按钮删除功能" />
<meta property="og:description" content="2.2.3 实现List增加功能删除功能
​ 实现List删除功能需要实现多选框checkbox功能、删除按钮的鼠标侦听，删除操作后的数据重新渲染。详情直接查看代码与注释：
(function() { //------&gt;用于显示UI组件 var Stage= Laya.Stage; //定义变量Stage为Laya的封装好的Stage var Handler= Laya.Handler; var Loader= Laya.Loader; var Event = Laya.Event; //点击鼠标的时候事件监听需要引用这个包 var WebGL= Laya.WebGL; var CheckBox = Laya.CheckBox; //实现多选框checkbox功能需要导入Laya提供的包 var ListDemoView; //定义整个界面的UI为一个变量 var arr; (function() { Laya.init(640,1136,WebGL); //Laya引擎的初始化 Laya.stage.bgColor = &#34;#ffffff&#34;; //设置为缩放模式 Laya.stage.scaleMode = Stage.SCALE_SHOWALL; //预加载资源文件（图集路径根据自己的项目实际情况定）后执行回调 Laya.loader.load([&#34;res/atlas/comp.atlas&#34;,&#34;res/atlas/template/ButtonTab.atlas&#34;],Handler.create(this,onLoaded)); })(); //要执行的回调函数 function onLoaded(){ ListDemoView = new ListPageUI(); //这个ListPageUI类是在layaUI.max.all.js中发布UI的时候自动生成的 Laya.stage.addChild(ListDemoView); //这舞台中添加这个ListPage的UI组件 //获取List模拟数据，并渲染 getListData(); //侦听增加按钮点击事件 ListDemoView.add.on(Event.CLICK,this,onAddClick); //on()方法：四个入参，一个返回值；入参：type：事件的类型，caller：事件侦听函数的执行域，listener：事件侦听函数，args：事件侦听函数的回调参数 //返回值：EventDispatcher :此EventDispatcher对象 //侦听删除按钮点击事件 ListDemoView.del.on(Event.CLICK,this,onRemoveClick); } //&lt;------用于显示UI组件 //-------&gt;编写代码逻辑，实现List序号逻辑 //要实现List序号的数据添加，需要用到&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/984e5d6d80e239ad2ef3077837937a6a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-12-11T18:11:00+08:00" />
<meta property="article:modified_time" content="2018-12-11T18:11:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">LayaBox入门基础之JS代码实现按钮删除功能</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <p>2.2.3 实现List增加功能删除功能</p> 
 <p>​ 实现List删除功能需要实现多选框checkbox功能、删除按钮的鼠标侦听，删除操作后的数据重新渲染。详情直接查看代码与注释：</p> 
 <div class="cnblogs_code"> 
  <pre>(<span style="color:#0000ff;">function</span><span style="color:#000000;">()
{
    </span><span style="color:#008000;">//</span><span style="color:#008000;">------&gt;用于显示UI组件</span>
    <span style="color:#0000ff;">var</span> Stage= Laya.Stage;  <span style="color:#008000;">//</span><span style="color:#008000;">定义变量Stage为Laya的封装好的Stage</span>
    <span style="color:#0000ff;">var</span> Handler=<span style="color:#000000;"> Laya.Handler;
    </span><span style="color:#0000ff;">var</span> Loader=<span style="color:#000000;"> Laya.Loader;
    </span><span style="color:#0000ff;">var</span> Event = Laya.Event;   <span style="color:#008000;">//</span><span style="color:#008000;">点击鼠标的时候事件监听需要引用这个包</span>
    <span style="color:#0000ff;">var</span> WebGL=<span style="color:#000000;"> Laya.WebGL;
    </span><span style="color:#0000ff;">var</span> CheckBox = Laya.CheckBox;  <span style="color:#008000;">//</span><span style="color:#008000;">实现多选框checkbox功能需要导入Laya提供的包</span>

    <span style="color:#0000ff;">var</span> ListDemoView;   <span style="color:#008000;">//</span><span style="color:#008000;">定义整个界面的UI为一个变量</span>
    <span style="color:#0000ff;">var</span><span style="color:#000000;"> arr;
    (</span><span style="color:#0000ff;">function</span><span style="color:#000000;">()
    {

       Laya.init(</span>640,1136,WebGL);     <span style="color:#008000;">//</span><span style="color:#008000;">Laya引擎的初始化</span>
       Laya.stage.bgColor = "#ffffff"<span style="color:#000000;">;
       </span><span style="color:#008000;">//</span><span style="color:#008000;">设置为缩放模式</span>
       Laya.stage.scaleMode =<span style="color:#000000;"> Stage.SCALE_SHOWALL;
       </span><span style="color:#008000;">//</span><span style="color:#008000;">预加载资源文件（图集路径根据自己的项目实际情况定）后执行回调</span>
       Laya.loader.load(["res/atlas/comp.atlas","res/atlas/template/ButtonTab.atlas"],Handler.create(<span style="color:#0000ff;">this</span><span style="color:#000000;">,onLoaded));

       
    })();
     
    </span><span style="color:#008000;">//</span><span style="color:#008000;">要执行的回调函数</span>
    <span style="color:#0000ff;">function</span><span style="color:#000000;"> onLoaded(){
        ListDemoView </span>= <span style="color:#0000ff;">new</span> ListPageUI();    <span style="color:#008000;">//</span><span style="color:#008000;">这个ListPageUI类是在layaUI.max.all.js中发布UI的时候自动生成的</span>
        Laya.stage.addChild(ListDemoView);   <span style="color:#008000;">//</span><span style="color:#008000;">这舞台中添加这个ListPage的UI组件</span>

        <span style="color:#008000;">//</span><span style="color:#008000;">获取List模拟数据，并渲染</span>
<span style="color:#000000;">        getListData();
 
        </span><span style="color:#008000;">//</span><span style="color:#008000;">侦听增加按钮点击事件</span>
<span style="color:#000000;">        
        ListDemoView.add.on(Event.CLICK,</span><span style="color:#0000ff;">this</span><span style="color:#000000;">,onAddClick);
        </span><span style="color:#008000;">//</span><span style="color:#008000;">on()方法：四个入参，一个返回值；入参：type：事件的类型，caller：事件侦听函数的执行域，listener：事件侦听函数，args：事件侦听函数的回调参数</span>
        <span style="color:#008000;">//</span><span style="color:#008000;">返回值：EventDispatcher :此EventDispatcher对象</span>


        <span style="color:#008000;">//</span><span style="color:#008000;">侦听删除按钮点击事件</span>
        ListDemoView.del.on(Event.CLICK,<span style="color:#0000ff;">this</span><span style="color:#000000;">,onRemoveClick);
    }
    </span><span style="color:#008000;">//</span><span style="color:#008000;">&lt;------用于显示UI组件</span>

    <span style="color:#008000;">//</span><span style="color:#008000;">-------&gt;编写代码逻辑，实现List序号逻辑</span>
    <span style="color:#008000;">//</span><span style="color:#008000;">要实现List序号的数据添加，需要用到"laya.ui.List"  API中的list数据源赋值array，</span>
    <span style="color:#008000;">//</span><span style="color:#008000;">单元格渲染处理器renderHandler，以及"laya.display.Node"API通过子节点名字获取子节点对象的方法getChildByName</span>
    

     
     <span style="color:#0000ff;">function</span><span style="color:#000000;"> getListData(){
         </span><span style="color:#008000;">//</span><span style="color:#008000;">添加list数据</span>
         arr =<span style="color:#000000;"> [];
         </span><span style="color:#0000ff;">for</span>(<span style="color:#0000ff;">var</span> i = 1;i&lt;=30;i++<span style="color:#000000;">){
             arr.push({listNumber:{text:i}});  </span><span style="color:#008000;">//</span><span style="color:#008000;">listNumber是lable的Name属性值，text也是属性名</span>
<span style="color:#000000;">         }

         ListDemoView._list.vScrollBarSkin</span>='';   <span style="color:#008000;">//</span><span style="color:#008000;">添加list滚动条功能(UI不可显示)，_list是list组件的变量名</span>
         ListDemoView._list.array = arr;  <span style="color:#008000;">//</span><span style="color:#008000;">数据赋值</span>

         <span style="color:#008000;">//</span><span style="color:#008000;">list渲染函数</span>
         ListDemoView._list.renderHandler = <span style="color:#0000ff;">new</span> Handler(<span style="color:#0000ff;">this</span><span style="color:#000000;">,onRender);

         </span><span style="color:#008000;">//</span><span style="color:#008000;">mouseHandler:list单元格鼠标事件处理器</span>
         ListDemoView._list.mouseHandler = <span style="color:#0000ff;">new</span> Handler(<span style="color:#0000ff;">this</span><span style="color:#000000;">,onMouse);
     }

     </span><span style="color:#0000ff;">function</span><span style="color:#000000;"> onRender(cell,index){
         </span><span style="color:#008000;">//</span><span style="color:#008000;">如果索引不再可索引范围，则终止该函数</span>
         <span style="color:#0000ff;">if</span>(index&gt;arr.length)<span style="color:#0000ff;">return</span><span style="color:#000000;">;
         </span><span style="color:#008000;">//</span><span style="color:#008000;">获取当前渲染条目的数据</span>
        <span style="color:#0000ff;">var</span> data =<span style="color:#000000;"> arr[index];
        </span><span style="color:#008000;">//</span><span style="color:#008000;">根据子节点的名字listNumber，获取子节点对象</span>
        <span style="color:#0000ff;">var</span> listNumber = cell.getChildByName("listNumber"<span style="color:#000000;">);
        </span><span style="color:#008000;">//</span><span style="color:#008000;">label渲染列表文本（序号）</span>
        listNumber.text=<span style="color:#000000;">data.listNumber.text;

         </span><span style="color:#008000;">//</span><span style="color:#008000;">获取当前渲染的check组件</span>
         <span style="color:#0000ff;">var</span> check=cell.getChildByName("check"<span style="color:#000000;">);
         </span><span style="color:#008000;">//</span><span style="color:#008000;">根据isCheck的值，确定当前check组件是否为勾选状态（可以避免出现其他多余的选中状态）</span>
         <span style="color:#0000ff;">if</span><span style="color:#000000;">(data.isCheck)
         {
             check.selected</span>=<span style="color:#0000ff;">true</span><span style="color:#000000;">;
         }
         </span><span style="color:#0000ff;">else</span><span style="color:#000000;">
         {
             check.selected</span>=<span style="color:#0000ff;">false</span><span style="color:#000000;">;
         }

     }
     </span><span style="color:#008000;">//</span><span style="color:#008000;">&lt;------编写代码逻辑，实现List序号逻辑</span>

     <span style="color:#008000;">//</span><span style="color:#008000;">实现List增加功能，需要用到LayaAir引擎laya.display.Sprite中的事件侦听on()方法对鼠标点击事件CLICK进行侦听</span>
     <span style="color:#008000;">//</span><span style="color:#008000;">以及laya.ui.List  API中添加单元格数据源的方法addItem();</span>
     
     <span style="color:#0000ff;">function</span><span style="color:#000000;"> onAddClick(){
         console.log(</span>"test"<span style="color:#000000;">);
         </span><span style="color:#008000;">//</span><span style="color:#008000;">添加单元格数据源</span>
         ListDemoView._list.addItem({listNumber:{text:arr.length+1<span style="color:#000000;">}});
     }

     </span><span style="color:#008000;">//</span><span style="color:#008000;">实现List删除功能需要实现多选框checkbox功能，删除按钮的鼠标事件侦听，删除 操作后的数据重新渲染</span>

     <span style="color:#0000ff;">function</span><span style="color:#000000;"> onRemoveClick(){
         </span><span style="color:#008000;">//</span><span style="color:#008000;">创建一个新的数组，存放移除条目后的数据</span>
         <span style="color:#0000ff;">var</span> temp =<span style="color:#000000;"> [];
         </span><span style="color:#0000ff;">for</span>(<span style="color:#0000ff;">var</span> i=0;i&lt;arr.length;i++<span style="color:#000000;">)
         {
              </span><span style="color:#008000;">//</span><span style="color:#008000;">将非选中状态的条目数据存储起来</span>
              <span style="color:#0000ff;">if</span>(!<span style="color:#000000;">arr[i].isCheck)
              {
                   temp.push(arr[i]);
              }
         }
         arr</span>=<span style="color:#000000;">temp;
         </span><span style="color:#008000;">//</span><span style="color:#008000;">将新的数组赋值给list</span>
         ListDemoView._list.array =<span style="color:#000000;"> arr;
     }

     </span><span style="color:#0000ff;">function</span><span style="color:#000000;"> onMouse(e,index)
     {  
         </span><span style="color:#008000;">//</span><span style="color:#008000;">鼠标单击事件触发</span>
         <span style="color:#0000ff;">if</span>(e.type ==<span style="color:#000000;"> Event.CLICK)
         {
            </span><span style="color:#008000;">//</span><span style="color:#008000;">判断点击事件类型，如果点中的是checkBox组件执行</span>
            <span style="color:#0000ff;">if</span>((e.target) <span style="color:#0000ff;">instanceof</span><span style="color:#000000;"> CheckBox)
            {
               </span><span style="color:#008000;">//</span><span style="color:#008000;">记录当前条目所包含组件的数据信息（必秒后续删除条目后数据结构显示错误）</span>
               <span style="color:#0000ff;">var</span> temObj =<span style="color:#000000;"> arr[index];
               </span><span style="color:#008000;">//</span><span style="color:#008000;">根据check的选中状态，设置条目的数据信息</span>
               <span style="color:#0000ff;">if</span><span style="color:#000000;">((e.target).selected)
               {
                  ListDemoView._list.setItem(index,{listNumber:{text:temObj.listNumber.text},isCheck:</span><span style="color:#0000ff;">true</span><span style="color:#000000;">});
               }
               </span><span style="color:#0000ff;">else</span><span style="color:#000000;">
               {
                   ListDemoView._list.setItem(index,{listNumber:{text:temObj.listNumber.text},isCheck:</span><span style="color:#0000ff;">false</span><span style="color:#000000;">});
               }
            }
         }
     }
     
})();</span></pre> 
 </div> 
 <p> </p> 
 <p> </p> 
 <p>运行效果如图28所示：</p> 
 <p>​ <img src="https://images2.imgbox.com/d3/ab/6Mq9Q5iE_o.png" alt="28"><br>​ （图28）删除2、3、4条后的效果</p> 
</div> 
<p>转载于:https://www.cnblogs.com/hqutcy/p/10103931.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7c7ab83971665945c5e8976387a7e208/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">LayaBox入门基础之JS代码实现按钮增加功能</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/103154315f5f5944722afa2f6b58108f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java 数组转list</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>