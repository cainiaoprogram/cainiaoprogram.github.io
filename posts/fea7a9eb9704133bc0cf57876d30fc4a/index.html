<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>React学习笔记6：React Hooks API总结 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="React学习笔记6：React Hooks API总结" />
<meta property="og:description" content="useState-保存状态（惰性初始化） 作用 函数组件添加状态 注意事项 初始化以及更新state用来声明状态变量 使用步骤（使用useState来创建状态） 引入import React,{useState} from &#34;react&#34;接收一个参数作为初始值返回一个数组，第一个值为状态，第二个为改变状态的函数 useEffect-解决副效应 只要是副效应，都可以使用useEffect()引入。
useEffect，就是执行有副作用的操作，默认情况下，它在第一次渲染之后和每次更新之后都会执行。 可以把 useEffect Hook 看做 componentDidMount，componentDidUpdate 和 componentWillUnmount这三个函数的组合。
作用/用途
给没有生命周期的组件，添加结束渲染的信号获取数据事件监听或订阅改变DOM输出日志 注意事项
在render之后执行使用useEffect()时，如果有多个副效应，应该调用多个useEffect()，而不应该合并写在一起。 使用步骤
引入import React,{useEffect} from &#34;react&#34;接收一个函数作为参数接收第二个参数（依赖列表），只有依赖更新时，才会执行函数返回一个函数。先执行返回函数，再执行参数函数 示例
import React, { useState, useEffect } from &#39;react&#39; function EffectFunction() { const [num, setNum] = useState(1) //以下函数先输出1，再输出2 useEffect(() =&gt; { console.log(&#34;2&#34;) document.body.addEventListener(&#39;todo&#39;, () =&gt; { }) return () =&gt; { document.body.removeEventListener(&#39;todo&#39;, () =&gt; { }) console.log(&#34;1&#34;) } }, [num]) return ( &lt;div onClick={() =&gt; setNum(num =&gt; num &#43; 1)}&gt; 这是一个函数组件-{num} &lt;/div&gt; ) } export default EffectFunction useLayoutEffect-监测DOM 作用" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/fea7a9eb9704133bc0cf57876d30fc4a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-13T23:01:26+08:00" />
<meta property="article:modified_time" content="2021-02-13T23:01:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">React学习笔记6：React Hooks API总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h5><a id="useState_1"></a>useState-保存状态（惰性初始化）</h5> 
<ul><li>作用 
  <ul><li>函数组件添加状态</li></ul> </li><li>注意事项 
  <ul><li>初始化以及更新state</li><li>用来声明状态变量</li></ul> </li><li>使用步骤（使用useState来创建状态） 
  <ol><li>引入<code>import React,{useState} from "react"</code></li><li>接收一个参数作为初始值</li><li>返回一个数组，<strong>第一个值为状态，第二个为改变状态的函数</strong></li></ol> </li></ul> 
<h5><a id="useEffect_13"></a>useEffect-解决副效应</h5> 
<p>只要是副效应，都可以使用<code>useEffect()</code>引入。</p> 
<p>useEffect，就是执行有副作用的操作，默认情况下，它在第一次渲染之后和每次更新之后都会执行。 可以把 useEffect Hook 看做 <code>componentDidMount，componentDidUpdate 和 componentWillUnmount</code>这三个函数的组合。</p> 
<ul><li> <p>作用/用途</p> 
  <ul><li>给没有生命周期的组件，添加结束渲染的信号</li><li>获取数据</li><li>事件监听或订阅</li><li>改变DOM</li><li>输出日志</li></ul> </li><li> <p>注意事项</p> 
  <ul><li>在render之后执行</li><li>使用<code>useEffect()</code>时，如果有多个副效应，应该调用多个<code>useEffect()</code>，而不应该合并写在一起。</li></ul> </li><li> <p>使用步骤</p> 
  <ol><li>引入<code>import React,{useEffect} from "react"</code></li><li>接收一个函数作为参数</li><li>接收第二个参数（<strong>依赖列表</strong>），只有依赖更新时，才会执行函数</li><li>返回一个函数。<strong>先执行返回函数，再执行参数函数</strong></li></ol> </li><li> <p>示例</p> <pre><code class="prism language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">function</span> <span class="token function">EffectFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>num<span class="token punctuation">,</span> setNum<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment">//以下函数先输出1，再输出2</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'todo'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'todo'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setNum</span><span class="token punctuation">(</span>num <span class="token operator">=&gt;</span> num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            这是一个函数组件<span class="token operator">-</span><span class="token punctuation">{<!-- --></span>num<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> EffectFunction
</code></pre> </li></ul> 
<h5><a id="useLayoutEffectDOM_65"></a>useLayoutEffect-监测DOM</h5> 
<ul><li> <p>作用</p> 
  <ul><li>dom更新完成后执行某个操作</li></ul> </li><li> <p>注意事项</p> 
  <ul><li>有dom操作的副效应hooks</li><li>在dom更新之后执行</li></ul> </li><li> <p>使用步骤</p> 
  <ol><li>引入<code>import React,{useLayoutEffect} from "react"</code></li><li>接收一个函数作为参数</li><li>接收第二个参数（<strong>依赖列表</strong>），只有依赖更新时，才会执行函数</li><li>返回一个函数。<strong>先执行返回函数，再执行参数函数</strong></li></ol> </li><li> <p>示例</p> <pre><code class="prism language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useLayoutEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">function</span> <span class="token function">EffectFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>num<span class="token punctuation">,</span> setNum<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token function">useLayoutEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"useLayoutEffect"</span><span class="token punctuation">)</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'layout'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'layout'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"useEffect"</span><span class="token punctuation">)</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'todo'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'todo'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setNum</span><span class="token punctuation">(</span>num <span class="token operator">=&gt;</span> num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            这是一个函数组件<span class="token operator">-</span><span class="token punctuation">{<!-- --></span>num<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> EffectFunction
</code></pre> </li><li> <p><strong>useEffect与useLayoutEffect区别</strong></p> 
  <ul><li>useEffect执行时机在render之后</li><li>useLayoutEffect是在dom更新之后</li></ul> </li></ul> 
<h5><a id="useMemo_121"></a>useMemo-组件跟随状态更新</h5> 
<ul><li> <p>概述</p> <p>当父组件因为自身状态改变而重新渲染时，会带动子组件的重新渲染，及时此时子组件的状态并没有发生改变，为了解决子组件的非必要渲染，可以使用memo函数来包装子组件，这样当子组件的props没有发生改变时，及时父组件重新渲染了，子组件也不会重新渲染。</p> </li><li> <p>作用</p> 
  <ul><li>让组件中的函数跟随状态更新</li></ul> </li><li> <p>注意事项</p> 
  <ul><li>优化函数组件中的功能函数</li></ul> </li><li> <p>使用步骤</p> 
  <ol><li>引入<code>import React,{useMemo} from "react"</code></li><li>接收一个函数作为参数</li><li>接收第二个参数（<strong>依赖列表</strong>），只有依赖更新时，才会执行函数</li><li><strong>返回的是一个数值</strong></li></ol> </li><li> <p>适用场景</p> 
  <ul><li>有些计算开销很大，就需要「记住」它的返回值，避免每次render都去重新计算。</li><li>由于值的引用发生变化，导致下游组件重新渲染，也需要「记住」这个值。</li></ul> </li><li> <p>示例</p> <pre><code class="prism language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useMemo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">function</span> <span class="token function">EffectFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>num<span class="token punctuation">,</span> setNum<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span>

    <span class="token comment">// function getDoubleNum(){<!-- --></span>
    <span class="token comment">//     console.log("获取双倍的num")</span>
    <span class="token comment">//     return 2 * num</span>
    <span class="token comment">// }</span>

    <span class="token comment">//useMemo使用方法</span>
    <span class="token comment">//1.接收一个函数作为参数</span>
    <span class="token comment">//2.第二个参数为依赖列表</span>
    <span class="token comment">//3.返回的是一个数值</span>
    <span class="token keyword">const</span> getDoubleNum <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"获取双倍的num"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token operator">*</span>num
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setNum</span><span class="token punctuation">(</span>num <span class="token operator">=&gt;</span> num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            这是一个函数组件<span class="token operator">-</span><span class="token punctuation">{<!-- --></span>getDoubleNum<span class="token punctuation">}</span><span class="token punctuation">,</span>age的值为<span class="token operator">--</span><span class="token operator">--</span><span class="token punctuation">{<!-- --></span>age<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> EffectFunction
</code></pre> </li></ul> 
<h5><a id="useCallback_179"></a>useCallback-组件跟随状态更新</h5> 
<ul><li>作用 
  <ul><li>跟随状态更新执行</li></ul> </li><li>注意事项 
  <ul><li>只有依赖项改变的时候才会执行</li></ul> </li><li>使用场景 
  <ul><li>在组件内部，那些会成为其他useEffect依赖项的方法，建议用 useCallback 包裹，或者直接编写在引用它的useEffect中 这种情况通常出现在reset等等这些函数，可能还有多个地方调用这个函数。</li><li>如果你的function会作为props传递给子组件，请一定要使用 useCallback 包裹，对于子组件来说，如果每次render都会导致你传递的函数发生变化，可能会对它造成非常大的困扰。同时也不利于react做渲染优化。</li></ul> </li></ul> 
<h5><a id="useRef_189"></a>useRef-长久保存数据</h5> 
<ul><li> <p>概述</p> 
  <ul><li><code>useRef</code>返回的 ref 对象在组件的整个生命周期内保持不变，也就是说每次重新渲染函数组件时，返回的ref 对象都是同一个。从概念上讲，可以认为 refs 就像是一个 class 的实例变量。<br> -<code>useRef</code>不仅仅是用来管理DOM ref的它可以存放任何变量，更改<code>.current</code>属性不会导致重新渲染。</li></ul> </li><li> <p>作用</p> 
  <ul><li>长久保存数据</li></ul> </li><li> <p>注意事项</p> 
  <ul><li>返回一个子元素索引，此索引在整个生命周期中保持不变</li><li>对象发生改变，不通知。属性变更不重新渲染</li></ul> </li><li> <p>使用场景</p> 
  <ul><li>希望一个变量在这个组件中，即使组建重新渲染，这个值也不会变。</li><li>保存子组件提供的某一个值（可能是一个DOM元素，也可能就是一个普通对象）</li></ul> </li><li> <p>示例</p> <pre><code class="prism language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">function</span> <span class="token function">EffectFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>num<span class="token punctuation">,</span> setNum<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">//1.保存一个值，在整个生命周期中维持不变</span>
    <span class="token comment">//2.重新赋值ref.current不会触发重新渲染</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        ref<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">setNum</span><span class="token punctuation">(</span>num <span class="token operator">=&gt;</span> num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"超过10了"</span><span class="token punctuation">,</span> ref<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
            <span class="token function">clearInterval</span><span class="token punctuation">(</span>ref<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            这是一个函数组件<span class="token operator">-</span><span class="token punctuation">{<!-- --></span>num<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> EffectFunction
</code></pre> </li></ul> 
<h5><a id="useContext_242"></a>useContext-组件之间共享状态</h5> 
<ul><li> <p>作用</p> 
  <ul><li>带着子组件去更新（游荡或者流浪）</li></ul> </li><li> <p>注意事项</p> 
  <ul><li>上层数据发生改变，肯定会触发重新渲染</li><li>当 Provider 的 value 值发生变化时，它内部的所有消费组件都会重新渲染</li><li>react 中数据是通过 props 属性自上而下（由父及子）进行传递的，但这种做法对于多层级父子关系的组件传值是极其繁琐的。react 提供了<code>context</code> api 来实现在组件之间共享此类值的方式，而不必显式地通过组件树的逐层传递 props。React 16.3之后的<code>context</code>api 较之前的好用</li><li><code>Context.Provider</code>，接收一个 value 属性，传递给消费组件。一个 Provider 可以和多个消费组件有对应关系。多个 Provider 也可以嵌套使用，里层的会覆盖外层的数据</li></ul> </li><li> <p>使用步骤（<strong>单数据源、父组件向子组件通信</strong>）</p> 
  <ol><li>需要引入<code>useContext</code>、<code>createContext</code>两个内容</li><li>通过<code>createContext</code>创建一个context句柄</li><li><code>Context.Provider</code>来确定数据共享范围</li><li>通过<code>value</code>来分发内容</li><li>在子组件中，通过<code>useContext(context句柄)</code>来获取数据</li></ol> </li><li> <p>使用<code>Context.Provider</code>，具体使用方法如下：</p> 
  <ol><li>使用 <code>createContext()</code> 创建一个context 对象（内容为需要传递的数据），参数为默认值；</li><li>在父组件外层使用 <code>&lt;.Provider&gt;</code> 将当前 context 的值传递给内部所有的组件树。当使用了 <code>&lt;.Provider&gt;</code> 后，<strong>不再读取上面的默认值</strong>，需要设置 value 属性来进行数据传递。</li><li>当组件需要读取数据时，指定 <code>contextType</code> 读取当前的 context 对象（即刚开始创建的 context）；</li><li>通过<code>useContext(context句柄)</code>，获取到当前 context 内的数据</li></ol> </li><li> <p>示例</p> <pre><code class="prism language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> useState<span class="token punctuation">,</span> useContext<span class="token punctuation">,</span> createContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token comment">//1.需要引入useContext、createContext两个内容</span>
<span class="token comment">//2.通过createContext创建一个context句柄</span>
<span class="token comment">//3.Conext.Provider来确定数据共享范围</span>
<span class="token comment">//4.通过value来分发内容</span>
<span class="token comment">//5.在子组件中，通过useContext(context句柄)来获取数据</span>

<span class="token keyword">const</span> ShowNumContext <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">EffectFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>num<span class="token punctuation">,</span> setNum<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>


    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            这是一个函数组件<span class="token operator">-</span><span class="token punctuation">{<!-- --></span>num<span class="token punctuation">}</span>
            
            <span class="token comment">// 使用Provider 将当前context的值传递给下面的组件树</span>
            <span class="token operator">&lt;</span>ShowNumContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>num<span class="token punctuation">}</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Item1<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Item1<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Item2<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Item2<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>ShowNumContext<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
 * 子组件1
 */</span>
<span class="token keyword">function</span> <span class="token function">Item1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//指定contextType 读取当前的context</span>
  <span class="token comment">//react 会往上找到最近的 Provider，然后使用它的值</span>
    <span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>ShowNumContext<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            子组件<span class="token punctuation">{<!-- --></span>num<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 子组件2
 */</span>
<span class="token keyword">function</span> <span class="token function">Item2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>ShowNumContext<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            子组件<span class="token punctuation">{<!-- --></span>num <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> EffectFunction
</code></pre> </li></ul> 
<p>上面的方法中，我们实现了<strong>跨组件的数据传递</strong>，这种方式的缺点是<strong>只能有一个共享的数据源</strong>，也就是在 <code>Item1 组件</code>和<code>Item2组件</code>中，指定 <code>num的值只能是一个</code>。那么如果我们有多个数据源都需要进行跨组件传递，应该怎么做呢？可以使用 <code>&lt;.Consumer&gt;</code> 来实现对多个数据源进行共享（<strong>多数据源跨组件通信</strong>）</p> 
<ul><li> <p>Context的使用场景</p> <p>Context 主要应用场景在于<strong>很多不同层级的组件需要访问同样一些的数据</strong>。谨慎使用，因为这会使得组件的复用性变差。如果用组件组合可以解决的问题，就不要使用 Context 。</p> <p>使用 context 的通用的场景包括<strong>管理当前的 locale，theme，或者一些缓存数据。</strong></p> </li></ul> 
<h5><a id="useReducer_334"></a>useReducer-复杂逻辑简单化</h5> 
<ul><li> <p>作用</p> 
  <ul><li>去其他地方借用资源</li></ul> </li><li> <p>使用步骤</p> 
  <ol><li>需要创建<strong>数据仓库store</strong>和<strong>管理者reducer</strong></li><li>通过<code>useReducer(reducer,store)</code>来获取state和dispatch</li></ol> </li><li> <p>注意事项</p> 
  <ul><li>函数组件的redux的操作</li></ul> </li><li> <p>示例</p> <pre><code class="prism language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> useReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token comment">//redux必须的内容——store，reducer</span>

<span class="token comment">//useReducer使用方法</span>
<span class="token comment">//1.需要创建  数据仓库store和管理者reducer</span>
<span class="token comment">//2.通过useReducer(reducer,store)来获取state和dispatch</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    num<span class="token punctuation">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">case</span> <span class="token string">"changeNum"</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
                <span class="token operator">...</span>state<span class="token punctuation">,</span>
                num<span class="token punctuation">:</span> action<span class="token punctuation">.</span>num
            <span class="token punctuation">}</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
                <span class="token operator">...</span>state
            <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">EffectFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> store<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                type<span class="token punctuation">:</span> <span class="token string">'changeNum'</span><span class="token punctuation">,</span>
                num<span class="token punctuation">:</span> <span class="token number">100</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            这是一个函数组件<span class="token operator">-</span><span class="token punctuation">{<!-- --></span>state<span class="token punctuation">.</span>num<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> EffectFunction
</code></pre> </li></ul> 
<h5><a id="Hooks_391"></a>自定义Hooks</h5> 
<ul><li> <p>作用</p> 
  <ul><li>自定义Hooks以支持特殊场景</li></ul> </li><li> <p>使用步骤</p> 
  <ol><li>引入react和自己需要的hook</li><li>创建自己的hook函数</li><li>返回一个数组，<strong>数组中第一个内容是数据，第二个是修改数据的函数</strong></li><li>将自己定义的hook函数暴露出去</li><li>在自己的业务组件中，引入并使用</li></ol> </li><li> <p>示例</p> <pre><code class="prism language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token comment">/**
 * 自定义Hooks步骤
 * 1.引入react和自己需要的hook
 * 2.创建自己的hook函数
 * 3.返回一个数组，数组中第一个内容是数据，第二个是修改数据的函数
 * 4.将自己定义的hook函数暴露出去
 * 5.在自己的业务组件中，引入并使用
 */</span>

<span class="token comment">//如何实现模拟的数据接口请求功能</span>
<span class="token keyword">function</span> <span class="token function">userLoadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>num<span class="token punctuation">,</span> setNum<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        num<span class="token punctuation">,</span>
        setNum
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> userLoadData
</code></pre> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/de008631c7cb8b4c0783c9c7a5a52cc0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Js 获取对象属性个数</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8ffc9bb72a6ebf3dac01d0199229ab77/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Ubuntu Server 20.04 设置静态 IP</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>