<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>跨模态神经搜索实践VCED 基于Streamlit实现前端页面设计和逻辑 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="跨模态神经搜索实践VCED 基于Streamlit实现前端页面设计和逻辑" />
<meta property="og:description" content="1. Streamlit入门 1.1 Streamlit介绍 Streamlit是基于Python的Web应用程序框架，它可以使用Python代码轻松构建机器学习/数据科学相关的仪表板，其特点包括：
跨平台：支持Windows、macOS、Linux只需要掌握Python：不需要前端的任何基础开源：社区资源丰富，包括社区和开源地址 1.2 Streamlit快速开始 安装：pip install streamlit
运行demo：streamlit hello
运行结果如下：
通过demo可以看出Streamlit构建的整体风格，其将页面从左至右分为两部分，分别是：
导航栏：上图中的左边导航栏，用于显示多页面内容栏：展示当前页面的内容，包含下拉框 且在右上角包括设置按钮。
1.3 Streamlit相关概念 Streamlit的整个运行流程可以参考链接中的Data flow，这里给出简单说明。
Streamlit的架构每当修改了源代码或用户与Streamlit的任意组件进行交互，都会产生一个on_change或on_click的回调(callback)，它会尝试执行剩下的代码（通常是整个代码文件）。
总的来说，这里将Streamlit粗略地分为：
输入：用户可以点击、选择、输入的部分；输出：页面展示给用户的部分，如表格、序列、图表、文字、代码等；其它：如布局、缓存、多页面等。 为了方便描述，后文使用st来替代streamlit
1.3.1 Streamlit输出 st.write()：所有变量都可以通过该方法输出；st的magic特性：在代码中编写一个包含值的变量，会默认使用streamlit.write()方法输出；st.dataframe()：用于输出dataframe，且可以传入额外的参数来自定义行为；st.table()：将参数以表格形式输出；st.line_chart()：将参数以折线图输出；st.map()：将参数以地图的形式输出。 上述方法的第一个参数即为需要输出到页面中的具体参数，可以是list、dataframe、字符串等多种类型。
除了以上的输出，还有其他输出，如：
st.progress()：展示进度条，该方法通常只需要一个参数，表示当前进度st.empty()：通过其text方法可以输出placeholder，即st.empty().text(&#39;xxx&#39;) 1.3.2 Streamlit输入 Streamlit的输入通常对应着Streamlit中的组件(widgets)，这里给出部分例子，详见官方的API文档：
st.slider()：显示在页面的滑动条st.text_input()：输入文本框st.checkbox()：复选框，返回True/Falsest.selectbox()：下拉跨 上述方法的第一个参数通常是组件的描述，可以传入一个命名参数key，给其设置一个唯一值，然后通过st.session_state.{key}访问该值，其中的{key}是创建组件时设置的参数值。
1.3.3 其它 布局 页面的布局可以通过多种方式设置，一种常用的方式是将组件(用户输入)都放到导航栏处，这个时候只需要将前文的st改为st.sidebar即可，如st.sidebar.slider()表示在导航栏中创建一个滑动条。
还可以使用st.columns()将页面分为多列，再使用st.expander合并列的方式完成页面的布局。
主题：可以通过设置来修改；
缓存：通过@st.cache装饰器来为方法增加cache；
多页面：只需要在当前文件夹创建多个py文件，然后使用streamlit run命令运行主文件即可。
2. VCED本项目的前端页面设计 首先需要明确整个页面的原型设计，这里直接给出最终版本的页面如下：
可以发现页面内部一共由五个部分组成，除此之外，可以发现页面的title和icon也有修改，因此一共六个部分。
这里首先设计页面，然后再设计整个页面的逻辑。
2.1 前端页面设计 页面title和icon：st.set_page_config(page_title=&#34;VCED&#34;, page_icon=&#34;🔍&#34;)页面标题：st.title(&#39;Welcome to VCED!&#39;)页面上传文件处：uploaded_file = st.file_uploader(&#34;Choose a video&#34;)描述输入文本框：可以发现这里包括标签、placeholder和帮助信息，因此都需要输入，即text_prompt = st.text_input(&#34;Description&#34;, placeholder=&#34;please input the description&#34;, help=&#39;The description of clips from the video&#39;)TopN输入文本框：与描述输入文本框同理搜索按钮：st." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/9ee2ffccf8f53f71293d8881f2657206/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-20T22:59:21+08:00" />
<meta property="article:modified_time" content="2022-11-20T22:59:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">跨模态神经搜索实践VCED 基于Streamlit实现前端页面设计和逻辑</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1_Streamlit_0"></a>1. Streamlit入门</h2> 
<h3><a id="11_Streamlit_2"></a>1.1 Streamlit介绍</h3> 
<p>Streamlit是基于Python的Web应用程序框架，它可以使用Python代码轻松构建机器学习/数据科学相关的仪表板，其特点包括：</p> 
<ul><li>跨平台：支持Windows、macOS、Linux</li><li>只需要掌握Python：不需要前端的任何基础</li><li>开源：社区资源丰富，包括<a href="https://discuss.streamlit.io/" rel="nofollow">社区</a>和<a href="https://github.com/streamlit/streamlit/">开源地址</a></li></ul> 
<h3><a id="12_Streamlit_10"></a>1.2 Streamlit快速开始</h3> 
<p>安装：<code>pip install streamlit</code></p> 
<p>运行demo：<code>streamlit hello</code></p> 
<p>运行结果如下：</p> 
<p><img src="https://images2.imgbox.com/c0/f0/dzQcu2Zl_o.png" alt="在这里插入图片描述"></p> 
<p>通过demo可以看出Streamlit构建的整体风格，其将页面从左至右分为两部分，分别是：</p> 
<ul><li>导航栏：上图中的左边导航栏，用于显示多页面</li><li>内容栏：展示当前页面的内容，包含下拉框</li></ul> 
<p>且在右上角包括设置按钮。</p> 
<h3><a id="13_Streamlit_28"></a>1.3 Streamlit相关概念</h3> 
<p>Streamlit的整个运行流程可以参考<a href="https://docs.streamlit.io/library/get-started/main-concepts" rel="nofollow">链接</a>中的Data flow，这里给出简单说明。</p> 
<p>Streamlit的架构每当修改了源代码或用户与Streamlit的任意组件进行交互，都会产生一个on_change或on_click的回调(callback)，它会尝试执行剩下的代码（通常是整个代码文件）。</p> 
<p>总的来说，这里将Streamlit<strong>粗略</strong>地分为：</p> 
<ul><li>输入：用户可以点击、选择、输入的部分；</li><li>输出：页面展示给用户的部分，如表格、序列、图表、文字、代码等；</li><li>其它：如布局、缓存、多页面等。</li></ul> 
<p>为了方便描述，后文使用st来替代streamlit</p> 
<h4><a id="131_Streamlit_42"></a>1.3.1 Streamlit输出</h4> 
<ul><li>st.write()：所有变量都可以通过该方法输出；</li><li>st的magic特性：在代码中编写一个包含值的变量，会默认使用streamlit.write()方法输出；</li><li>st.dataframe()：用于输出dataframe，且可以传入额外的参数来自定义行为；</li><li>st.table()：将参数以表格形式输出；</li><li>st.line_chart()：将参数以折线图输出；</li><li>st.map()：将参数以地图的形式输出。</li></ul> 
<p>上述方法的第一个参数即为需要输出到页面中的具体参数，可以是list、dataframe、字符串等多种类型。</p> 
<p>除了以上的输出，还有其他输出，如：</p> 
<ul><li>st.progress()：展示进度条，该方法通常只需要一个参数，表示当前进度</li><li>st.empty()：通过其text方法可以输出placeholder，即<code>st.empty().text('xxx')</code></li></ul> 
<h4><a id="132_Streamlit_58"></a>1.3.2 Streamlit输入</h4> 
<p>Streamlit的输入通常对应着Streamlit中的组件(widgets)，这里给出部分例子，详见官方的<a href="https://docs.streamlit.io/library/api-reference" rel="nofollow">API文档</a>：</p> 
<ul><li>st.slider()：显示在页面的滑动条</li><li>st.text_input()：输入文本框</li><li>st.checkbox()：复选框，返回True/False</li><li>st.selectbox()：下拉跨</li></ul> 
<p>上述方法的第一个参数通常是组件的描述，可以传入一个命名参数key，给其设置一个唯一值，然后通过<code>st.session_state.{key}</code>访问该值，其中的<code>{key}</code>是创建组件时设置的参数值。</p> 
<h4><a id="133__69"></a>1.3.3 其它</h4> 
<ul><li>布局</li></ul> 
<p>页面的布局可以通过多种方式设置，一种常用的方式是将组件(用户输入)都放到导航栏处，这个时候只需要将前文的st改为st.sidebar即可，如<code>st.sidebar.slider()</code>表示在导航栏中创建一个滑动条。</p> 
<p>还可以使用<code>st.columns()</code>将页面分为多列，再使用<code>st.expander</code>合并列的方式完成页面的布局。</p> 
<ul><li> <p>主题：可以通过设置来修改；</p> </li><li> <p>缓存：通过<code>@st.cache</code>装饰器来为方法增加cache；</p> </li><li> <p>多页面：只需要在当前文件夹创建多个py文件，然后使用<code>streamlit run</code>命令运行主文件即可。</p> </li></ul> 
<h2><a id="2_VCED_82"></a>2. VCED本项目的前端页面设计</h2> 
<p>首先需要明确整个页面的原型设计，这里直接给出最终版本的页面如下：</p> 
<p><img src="https://images2.imgbox.com/ba/0a/Bspcva37_o.png" alt="在这里插入图片描述"></p> 
<p>可以发现页面内部一共由五个部分组成，除此之外，可以发现页面的title和icon也有修改，因此一共六个部分。</p> 
<p>这里首先设计页面，然后再设计整个页面的逻辑。</p> 
<h3><a id="21__93"></a>2.1 前端页面设计</h3> 
<ul><li>页面title和icon：<code>st.set_page_config(page_title="VCED", page_icon="🔍")</code></li><li>页面标题：<code>st.title('Welcome to VCED!')</code></li><li>页面上传文件处：<code>uploaded_file = st.file_uploader("Choose a video")</code></li><li>描述输入文本框：可以发现这里包括标签、placeholder和帮助信息，因此都需要输入，即<code>text_prompt = st.text_input("Description", placeholder="please input the description", help='The description of clips from the video')</code></li><li>TopN输入文本框：与描述输入文本框同理</li><li>搜索按钮：<code>st.button("Search")</code></li></ul> 
<p>最终整个页面设计的代码如下（文件名为app.py）：</p> 
<pre><code class="prism language-python"><span class="token comment"># 导入需要的包</span>
<span class="token keyword">import</span> streamlit <span class="token keyword">as</span> st

<span class="token comment"># 设置标签栏</span>
st<span class="token punctuation">.</span>set_page_config<span class="token punctuation">(</span>page_title<span class="token operator">=</span><span class="token string">"VCED"</span><span class="token punctuation">,</span> page_icon<span class="token operator">=</span><span class="token string">"🔍"</span><span class="token punctuation">)</span>
<span class="token comment"># 设置标题</span>
st<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Welcome to VCED!'</span><span class="token punctuation">)</span>

<span class="token comment"># 视频上传组件</span>
uploaded_file <span class="token operator">=</span> st<span class="token punctuation">.</span>file_uploader<span class="token punctuation">(</span><span class="token string">"Choose a video"</span><span class="token punctuation">)</span>

<span class="token comment"># 文本输入框</span>
text_prompt <span class="token operator">=</span> st<span class="token punctuation">.</span>text_input<span class="token punctuation">(</span>
    <span class="token string">"Description"</span><span class="token punctuation">,</span> placeholder<span class="token operator">=</span><span class="token string">"please input the description"</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'The description of clips from the video'</span><span class="token punctuation">)</span>

<span class="token comment"># top k 输入框</span>
topn_value <span class="token operator">=</span> st<span class="token punctuation">.</span>text_input<span class="token punctuation">(</span>
    <span class="token string">"Top N"</span><span class="token punctuation">,</span> placeholder<span class="token operator">=</span><span class="token string">"please input an integer"</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'The number of results. By default, n equals 1'</span><span class="token punctuation">)</span>

<span class="token comment"># 搜索按钮</span>
st<span class="token punctuation">.</span>button<span class="token punctuation">(</span><span class="token string">"Search"</span><span class="token punctuation">)</span>
</code></pre> 
<p>使用<code>streamlit run app.py</code>可以发现页面效果与设计一致。</p> 
<h3><a id="22__130"></a>2.2 前端页面交互逻辑</h3> 
<p>整个页面的处理逻辑非常简单，这里可以直接查看代码即可，这里给出整体的逻辑如下：</p> 
<ul><li>判断是否点击搜索按钮</li><li>判断是否上传文件</li><li>判断是否输入描述文本</li><li>判断是否输入topn，没有输入，则默认topn为1</li><li>使用CLIP进行搜索，以列表返回结果，对应<code>search_clip()</code>方法</li><li>对结果中的开始位置和结束位置使用ffmpeg裁剪视频，对应<code>cutVideo()</code>方法</li></ul> 
<p>以上就是整个逻辑，可以发现非常简单，查询结果之后，最后通过<code>st.video()</code>将结果展示出来，其输入是视频文件的路径。</p> 
<h2><a id="References_143"></a>References</h2> 
<ol><li><a href="https://github.com/datawhalechina/vced/tree/main/docs/source/user_guide/Frontend">VCED 前端介绍</a></li><li><a href="https://docs.streamlit.io/" rel="nofollow">Streamlit官方文档</a></li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2872ef0c4ac21bb6fcd6be6af19295bc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">npm ERR! notarget No matching version found for xxx@^1.0.64. npm 插件安装失败</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/183ebbc2e998244ed7bb02b5a2d6a27d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【高级篇】Java JVM实战 之 内存调优</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>