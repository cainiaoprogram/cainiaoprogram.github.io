<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Excel】乱序不同行数的两列数据对比匹配 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【Excel】乱序不同行数的两列数据对比匹配" />
<meta property="og:description" content="1 情境 表格需求：
以上乱序不同行数的两个表格分别为总名单和签到表，需要在总名单中找到未签到人员。
表格特点：
[表2：签到表] 为 [表1：总名单] 的子集；两表顺序错乱；不同姓名对应身份证号前十五位有完全相同的情况。 注意事项：
匹配数据应以身份证号为索引，且18位数字完全匹配，因为有重名和身份证号多位相同可能性，且部分函数只能处理15位字符串。
2 实现方案 2.1 方法一：countif 函数 所需函数：
countif(数据列，单元格数据) = 单元格数据在数据列中出现的次数if(判断语句，成立输出，不成立输出) 输入如下公式：
=IF(COUNTIF($E$3:$E$18,B3&amp;&#34;*&#34;)=1,&#34;已签到&#34;,&#34;未签到&#34;) 下拉即可，如图：
注意：
使用$绝对引用(快捷键:F4)数据列，防止相对引用下拉变动；countif函数只能识别15位数字，而身份证号有18位，若两组数据前15位相同则输出结果会产生错误，故需在单元格B3后连接通配符*，即B3&amp;&#34;*&#34;，强制其以文本形式匹配。 2.2 方法二：vlookup / xlookup 函数 所需函数：
vlookup(查找值, 查找区域, 返回查找区域的第几列数据, 精确查找输入参数&#34;0&#34;or&#34;false&#34; 或 模糊查找输入参数&#34;1&#34;or&#34;true&#34;)#注意第一参数查找值必须位于第二参数查找区域的第一列；匹配索引需格式统一。iferror(条件, 条件错误时的返回值)#这里用于处理vlookup产生的#N/A错误值，使之不影响后续公式运行；这个需求也可由功能更强大的xlookup函数第四参数替代，用法见4。len(条件) = 字符串长度xlookup(【第一参数】查找值(多条件查询用&#34;&amp;&#34;连接)，【第二参数】查找区域，【第三参数】值返回区域，【第四参数(可选参数)】无匹配结果返回值(省略则返回#N/A)，【第五参数(可选参数)】匹配类型(-1,0,1,2)，【第六参数(可选参数)】搜索模式(-2,-1,1,2))
匹配类型： 0 - 完全匹配。 如果未找到，则返回 #N/A。 这是默认选项。-1 - 完全匹配。 如果没有找到，则返回下一个较小的项。1 - 完全匹配。 如果没有找到，则返回下一个较大的项。2 - 通配符匹配，其中 *, ? 和 ~ 有特殊含义。
搜索模式：1 - 从第一项开始执行搜索。 这是默认选项。-1 - 从最后一项开始执行反向搜索。2 - 执行依赖于 lookup_array 按升序排序的二进制搜索。 如果未排序，将返回无效结果。2 - 执行依赖于 lookup_array 按降序排序的二进制搜索。 如果未排序，将返回无效结果。 输入如下公式：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/15a3cdba5ac93f5c6e3e17231ecd6765/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-02T14:28:04+08:00" />
<meta property="article:modified_time" content="2022-11-02T14:28:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Excel】乱序不同行数的两列数据对比匹配</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1__1"></a>1 情境</h2> 
<p><strong>表格需求：</strong><br> <img src="https://images2.imgbox.com/e3/97/x9Zb1ijF_o.png" alt="在这里插入图片描述"><br> 以上乱序不同行数的两个表格分别为总名单和签到表，需要在总名单中找到未签到人员。</p> 
<p><strong>表格特点：</strong></p> 
<ol><li><em>[表2：签到表]</em> 为 <em>[表1：总名单]</em> 的子集；</li><li>两表顺序错乱；</li><li>不同姓名对应身份证号前十五位有完全相同的情况。</li></ol> 
<p><strong>注意事项：</strong><br> 匹配数据应以身份证号为索引，且18位数字完全匹配，因为有重名和身份证号多位相同可能性，且部分函数只能处理15位字符串。</p> 
<h2><a id="2__14"></a>2 实现方案</h2> 
<h3><a id="21_countif__15"></a>2.1 方法一：countif 函数</h3> 
<blockquote> 
 <p><strong>所需函数：</strong></p> 
 <ol><li><code>countif(数据列，单元格数据) = 单元格数据在数据列中出现的次数</code></li><li><code>if(判断语句，成立输出，不成立输出)</code></li></ol> 
</blockquote> 
<p>输入如下公式：</p> 
<pre><code>=IF(COUNTIF($E$3:$E$18,B3&amp;"*")=1,"已签到","未签到")
</code></pre> 
<p>下拉即可，如图：<br> <img src="https://images2.imgbox.com/b3/32/xfKjHgYQ_o.png" alt="在这里插入图片描述"></p> 
<p><font color="red"><strong>注意：</strong></font></p> 
<ol><li>使用<code>$</code>绝对引用(快捷键:F4)数据列，防止相对引用下拉变动；</li><li><code>countif</code>函数只能识别15位数字，而身份证号有18位，若两组数据前15位相同则输出结果会产生错误，故需在单元格<code>B3</code>后连接通配符<code>*</code>，即<code>B3&amp;"*"</code>，强制其以文本形式匹配。</li></ol> 
<h3><a id="22_vlookup__xlookup__32"></a>2.2 方法二：vlookup / xlookup 函数</h3> 
<blockquote> 
 <p><strong>所需函数：</strong></p> 
 <ol><li><code>vlookup(查找值, 查找区域, 返回查找区域的第几列数据, 精确查找输入参数"0"or"false" 或 模糊查找输入参数"1"or"true")</code>#注意第一参数查找值必须位于第二参数查找区域的第一列；匹配索引需格式统一。</li><li><code>iferror(条件, 条件错误时的返回值)</code>#这里用于处理vlookup产生的#N/A错误值，使之不影响后续公式运行；这个需求也可由功能更强大的xlookup函数第四参数替代，用法见4。</li><li><code>len(条件) = 字符串长度</code></li><li><code>xlookup(【第一参数】查找值(多条件查询用"&amp;"连接)，【第二参数】查找区域，【第三参数】值返回区域，【第四参数(可选参数)】无匹配结果返回值(省略则返回#N/A)，【第五参数(可选参数)】匹配类型(-1,0,1,2)，【第六参数(可选参数)】搜索模式(-2,-1,1,2))</code><br> <strong>匹配类型：</strong></li></ol> 
 <ul><li>0 - 完全匹配。 如果未找到，则返回 #N/A。 这是默认选项。</li><li>-1 - 完全匹配。 如果没有找到，则返回下一个较小的项。</li><li>1 - 完全匹配。 如果没有找到，则返回下一个较大的项。</li><li>2 - 通配符匹配，其中 *, ? 和 ~ 有特殊含义。<br> <strong>搜索模式：</strong></li><li>1 - 从第一项开始执行搜索。 这是默认选项。</li><li>-1 - 从最后一项开始执行反向搜索。</li><li>2 - 执行依赖于 lookup_array 按升序排序的二进制搜索。 如果未排序，将返回无效结果。</li><li>2 - 执行依赖于 lookup_array 按降序排序的二进制搜索。 如果未排序，将返回无效结果。</li></ul> 
</blockquote> 
<p>输入如下公式：</p> 
<pre><code>=VLOOKUP(A3,D:E,2,0)
</code></pre> 
<p>下拉公式，无数据匹配处即为未签到人，如图：<br> <img src="https://images2.imgbox.com/7e/6a/E2RG8PQz_o.png" alt="在这里插入图片描述"></p> 
<p>进一步，考虑利用字符串长度作为限定来添加标签，由 iferror 函数将 #N/A 值赋为0，于是得到公式：</p> 
<pre><code>=IF(LEN(IFERROR(VLOOKUP(A3,D:E,2,0),0))&gt;1,"已签到","未签到")
</code></pre> 
<p>结果如下：<br> <img src="https://images2.imgbox.com/42/95/8HETQpvQ_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3__63"></a>3 相关情境</h2> 
<h3><a id="31__64"></a>3.1 重复项问题</h3> 
<h4><a id="311__65"></a>3.1.1 单表格查找重复项</h4> 
<h5><a id="_66"></a>方法一：高级筛选</h5> 
<p>开始&gt;&gt;筛选&gt;&gt;高级筛选：勾选 <strong>选择不重复的记录</strong>，选择 <strong>在原有区域显示筛选结果</strong> 则覆盖原表，选择 <strong>将筛选结果复制到其他位置</strong> 则生成无重复数据的新表。</p> 
<p><img src="https://images2.imgbox.com/c1/43/8Meppw7r_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_71"></a>方法二：条件格式</h5> 
<p><img src="https://images2.imgbox.com/3e/4e/1aSvRLDZ_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="312__74"></a>3.1.2 双表格对比重复项</h4> 
<p>首先应当利用3.1.1的方法剔除单表格中的重复项，否则会导致 countif、sumproduct 等函数计数出现问题。</p> 
<h5><a id="_77"></a>方法一：排序</h5> 
<p>数据量较少情况下可排序后自行比对。</p> 
<h5><a id="countif__sumproduct__80"></a>方法二：countif / sumproduct 函数</h5> 
<p>统计一个表格元素在另一表格中出现的次数，从而知晓两个表格的重合项。</p> 
<h5><a id="vlookup__xlookup__83"></a>方法三：vlookup / xlookup 函数</h5> 
<p>返回值</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/947d4e33b3e7171f81e0b869ea425ad1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">为什么评论会被折叠？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a5367413779ae4770fd915676e5c2bd4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于quartz的定时任务动态启停实现分析（人人平台为例）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>