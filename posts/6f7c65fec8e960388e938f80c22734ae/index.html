<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>从0开始python学习-35.allure报告企业定制 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="从0开始python学习-35.allure报告企业定制" />
<meta property="og:description" content="目录
1. 搭建allure环境
2. 生成报告
3. logo定制
4. 企业级报告内容或层级定制
5. allure局域网查看
1. 搭建allure环境 1.1 JDK，使用PyCharm
找到pycharm安装目录找到java.exe记下jbr目录的完整路径，eg: C:\Program Files\JetBrains\PyCharm Community Edition 2022.3\jbr\bin将地址添加进入环境变量重启 1.2 allure程序
下载地址：https://github.com/allure-framework/allure2/releases解压到指定路径。eg: D:\study\allure-2.25.0\allure-2.25.0\bin执行allurePath 追加allure安装路径验证是否安装成功：在dos窗口和Pycharm（需要重启加载环境变量）中都需要验证：allure --version 2. 生成报告 2.1 生成临时的json格式的报告
addopts = -vs --alluredir=./temps --clean-alluredir ; --clean-alluredir生成临时报告并清除 2.2 生成HTML的allure报告
if __name__ == &#34;__main__&#34;: pytest.main([&#39;./test_study/test_fixture.py&#39;]) os.system(&#34;allure generate ./temps -o ./reports --clean&#34;) # -o 指定输出测试报告路径 # --clean 清空历史数据 # ./temps 表示用来生成html的JSON临时文件目录 # ./reports 表示html文件生成目录 3. logo定制 3.1 在D:\study\allure-2.25.0\allure-2.25.0\config目录下的allure.yml中配置自定义的logo插件【- custom-logo-plugin】
3.2 重新运行并生成allue报告" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6f7c65fec8e960388e938f80c22734ae/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-24T22:31:13+08:00" />
<meta property="article:modified_time" content="2023-12-24T22:31:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">从0开始python学习-35.allure报告企业定制</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="1.%20%E6%90%AD%E5%BB%BAallure%E7%8E%AF%E5%A2%83-toc" style="margin-left:0px;"><a href="#1.%20%E6%90%AD%E5%BB%BAallure%E7%8E%AF%E5%A2%83" rel="nofollow">1. 搭建allure环境</a></p> 
<p id="2.%20%E7%94%9F%E6%88%90%E6%8A%A5%E5%91%8A-toc" style="margin-left:0px;"><a href="#2.%20%E7%94%9F%E6%88%90%E6%8A%A5%E5%91%8A" rel="nofollow">2. 生成报告</a></p> 
<p id="3.%20logo%E5%AE%9A%E5%88%B6-toc" style="margin-left:0px;"><a href="#3.%20logo%E5%AE%9A%E5%88%B6" rel="nofollow">3. logo定制</a></p> 
<p id="4.%20%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%8A%A5%E5%91%8A%E5%86%85%E5%AE%B9%E6%88%96%E5%B1%82%E7%BA%A7%E5%AE%9A%E5%88%B6-toc" style="margin-left:0px;"><a href="#4.%20%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%8A%A5%E5%91%8A%E5%86%85%E5%AE%B9%E6%88%96%E5%B1%82%E7%BA%A7%E5%AE%9A%E5%88%B6" rel="nofollow">4. 企业级报告内容或层级定制</a></p> 
<p id="5.%20allure%E5%B1%80%E5%9F%9F%E7%BD%91%E6%9F%A5%E7%9C%8B-toc" style="margin-left:0px;"><a href="#5.%20allure%E5%B1%80%E5%9F%9F%E7%BD%91%E6%9F%A5%E7%9C%8B" rel="nofollow">5. allure局域网查看</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="1.%20%E6%90%AD%E5%BB%BAallure%E7%8E%AF%E5%A2%83">1. 搭建allure环境</h2> 
<p>1.1 JDK，使用PyCharm</p> 
<ol><li>找到pycharm安装目录</li><li>找到java.exe</li><li>记下jbr目录的完整路径，eg: C:\Program Files\JetBrains\PyCharm Community Edition 2022.3\jbr\bin</li><li>将地址添加进入环境变量</li><li>重启</li></ol> 
<p><img alt="" height="285" src="https://images2.imgbox.com/c0/bc/rsMm0vnI_o.png" width="534"></p> 
<p>1.2 allure程序</p> 
<ol><li>下载地址：https://github.com/allure-framework/allure2/releases</li><li>解压到指定路径。eg: D:\study\allure-2.25.0\allure-2.25.0\bin</li><li>执行allure</li><li>Path 追加allure安装路径</li><li>验证是否安装成功：在dos窗口和Pycharm（需要重启加载环境变量）中都需要验证：allure --version</li></ol> 
<p><img alt="" height="129" src="https://images2.imgbox.com/99/8d/1ITQ6RmT_o.png" width="368"></p> 
<p><img alt="" height="104" src="https://images2.imgbox.com/a1/ab/fGXLhriU_o.png" width="477"></p> 
<h2 id="2.%20%E7%94%9F%E6%88%90%E6%8A%A5%E5%91%8A">2. 生成报告</h2> 
<p>2.1 生成临时的json格式的报告</p> 
<pre><code class="language-python">addopts = -vs --alluredir=./temps --clean-alluredir
; --clean-alluredir生成临时报告并清除</code></pre> 
<p>2.2 生成HTML的allure报告</p> 
<pre><code class="language-python">if __name__ == "__main__":
    pytest.main(['./test_study/test_fixture.py'])
    os.system("allure generate ./temps -o ./reports --clean") 
    # -o 指定输出测试报告路径
    # --clean 清空历史数据
    # ./temps 表示用来生成html的JSON临时文件目录
    # ./reports 表示html文件生成目录</code></pre> 
<h2 id="3.%20logo%E5%AE%9A%E5%88%B6">3. logo定制</h2> 
<p>3.1 在D:\study\allure-2.25.0\allure-2.25.0\config目录下的allure.yml中配置自定义的logo插件【- custom-logo-plugin】</p> 
<p><img alt="" height="311" src="https://images2.imgbox.com/98/7e/Ns7QzYyt_o.png" width="351"></p> 
<p>3.2 重新运行并生成allue报告</p> 
<p>3.3 增加一个自己的logo文件并修改D:\study\allure-2.25.0\allure-2.25.0\plugins\custom-logo-plugin\static路径下的styles.css文件里面的样式（最好将需要修改的logo也放在custom-logo-plugin目录下）</p> 
<pre><code class="language-css">.side-nav__brand {
  background: url('1.png') no-repeat left center !important; //将你需要的logo图片地址放在这里
  margin-left: 22px; //调整方位
  height: 90px; //调整大小
  background-size: contain !important;
}
//去掉图片后边 allure 文本
.side-nav__brand-text{
   display: none; 
}
//配置logo 后面的字体样式与字体大小
.side-nav__brand:after {
  content: "测试测试";
  margin-left: 18px;
  height: 20px;
  font-family: Arial;
  font-size: 13px;
}</code></pre> 
<p> 注：logo图片和文字可以同时存在，也可以只要一个</p> 
<p><img alt="" height="524" src="https://images2.imgbox.com/49/6c/8i4m2Epl_o.png" width="1082"></p> 
<h2 id="4.%20%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%8A%A5%E5%91%8A%E5%86%85%E5%AE%B9%E6%88%96%E5%B1%82%E7%BA%A7%E5%AE%9A%E5%88%B6">4. 企业级报告内容或层级定制</h2> 
<p>左边：</p> 
<p>1. 项目名称（史诗）：@allure.epic("测试报告")</p> 
<p>2. 模块名称（特性）：@allure.feature("测试模块")</p> 
<p>3. 接口名称（分组）：@allure.story("测试接口")</p> 
<pre><code class="language-python">@allure.epic('测试报告')
@allure.feature('测试模块')
class TestA:
    @allure.story('测试1')
    def test_1(self):
        print('11111')

    @allure.story('测试2')
    def test_2(slef):
        print('22222')</code></pre> 
<p><img alt="" height="256" src="https://images2.imgbox.com/7b/2e/VsqeoEQL_o.png" width="887"> 将多个用例写到一个组：</p> 
<pre><code class="language-python">@allure.story('测试1')
@allure.title('用例1')
def test_1(self):
    print('11111')

@allure.story('测试1')
def test_2(slef):
    allure.dynamic.title('用例2')
    print('22222')</code></pre> 
<p><img alt="" height="340" src="https://images2.imgbox.com/9d/7d/469fsKmn_o.png" width="1137">4. 用例标题：@allure.title("用例1") or allure.dynamic.title('用例2') 两种方法都可以实现</p> 
<pre><code class="language-python">@allure.title('用例1') //方法1
def test_1(self):
    print('11111')

@allure.story('测试2')
def test_2(slef):
    allure.dynamic.title('用例2') //方法2
    print('22222')</code></pre> 
<p><img alt="" height="230" src="https://images2.imgbox.com/72/f4/HJqzWYKu_o.png" width="886"></p> 
<p> 右边：</p> 
<p>1. 测试用例严重级别：@allure.severity(allure.severity_level.BLOCKER) //BLOCKER(致命)，CRITICAL（严重）,NORMAL(一般)，MINOR（提示），TRIVIAL（轻微），一般默认为NORMAL</p> 
<pre><code class="language-python">@allure.severity(allure.severity_level.TRIVIAL)
@allure.story('测试3')
def test_3(slef):
    print('33333')</code></pre> 
<p><img alt="" height="371" src="https://images2.imgbox.com/ec/84/4vv6jCKw_o.png" width="1200"> 2. 测试用例的描述：@allure.description("测试用例的描述")</p> 
<pre><code class="language-python">@allure.description("测试用例的描述方法1")
@allure.title('测试4')
def test_4(slef):
    print('44444')

@allure.title('测试5')
def test_5(slef):
    allure.dynamic.description("测试用例的描述方法2")
    print('55555')</code></pre> 
<p><img alt="" height="327" src="https://images2.imgbox.com/00/8c/ks8zE8IV_o.png" width="1155">3. 接口访问链接：@allure.link("接口链接")</p> 
<p>4. BUG链接：@allure.issue("bug链接")</p> 
<p>5. 测试用例链接：@allure.testcase("用例链接")</p> 
<pre><code class="language-python">@allure.story('测试6')
@allure.link('https://www.baidu.com/0',name='接口链接')
@allure.issue('https://www.baidu.com/',name='bug链接')
@allure.testcase('https://www.baidu.com/',name='用例链接')
def test_6(slef):
    print('66666')</code></pre> 
<p><img alt="" height="379" src="https://images2.imgbox.com/be/c7/Txeh5735_o.png" width="1200"></p> 
<p>6. 测试用例的操作步骤：allure.step("第"+str(i)+"步"):</p> 
<pre><code class="language-python">@allure.story('测试1')
def test_7(self):
    for i in range(0,10):
        with allure.step("第"+str(i)+"步"):
            pass</code></pre> 
<p><img alt="" height="637" src="https://images2.imgbox.com/49/07/mM4d2nuF_o.png" width="1200"></p> 
<p>7. 测试附件：allure.attach(body=content,name="错误截图",attachment_type=allure.attachment_type.PNG) //一般用于错误截图（常用于web自动化测试）</p> 
<pre><code class="language-python">@allure.story('测试1')
def test_8(self):
    # 附件上传需要使用二进制，可以是图片，可以是文本，可以是其它文件
    with open(r'D:\study\allure-2.25.0\allure-2.25.0\plugins\custom-logo-plugin\static\1.png',mode='rb') as f:
        content = f.read()
        allure.attach(body=content,name='错误截图',attachment_type=allure.attachment_type.PNG)</code></pre> 
<p><img alt="" height="756" src="https://images2.imgbox.com/40/4c/V7sIxelJ_o.png" width="1200"></p> 
<p>8. 文本内容的定制：一般应用于接口自动化</p> 
<pre><code class="language-python">@allure.story('测试1')
def test_9(self):
    # 请求
    allure.attach('https://www.baidu.com/0',name='接口地址',attachment_type=allure.attachment_type.TEXT)
    allure.attach('接口参数，一般从yaml中获取',name='接口参数',attachment_type=allure.attachment_type.TEXT)
    allure.attach('请求方式：get/post',name='请求方式',attachment_type=allure.attachment_type.TEXT)
    allure.attach('请求头，一般从yaml中获取',name='请求头',attachment_type=allure.attachment_type.TEXT)

    # 响应
    allure.attach('响应文本，一般从yaml中获取', name='响应文本', attachment_type=allure.attachment_type.TEXT)
    allure.attach('执行结果：成功/失败', name='执行结果', attachment_type=allure.attachment_type.TEXT)</code></pre> 
<p><img alt="" height="615" src="https://images2.imgbox.com/a8/f0/pA7ztwQg_o.png" width="1200"></p> 
<p>9. 数据驱动：</p> 
<pre><code class="language-python">@allure.story('测试1')
@pytest.mark.parametrize('x', ['这是第1个测试值', "这是第2个测试值"])
def test_a(self,x):
    print(f'test_a中的X值为{x}')</code></pre> 
<p><img alt="" height="534" src="https://images2.imgbox.com/27/1f/a7TjI06Q_o.png" width="1200"></p> 
<p> 由于使用数据驱动，用例标题会展示参数数据化驱动中的所有参数，若不想要显示则需要修改allure配置</p> 
<pre><code class="language-python"># 修改前
test_result.parameters.extend(
    [Parameter(name=name, value=represent(value)) for name, value in params.items()
     if name not in current_param_names])
     
# 修改后 （将列表内容去除即可）     
test_result.parameters.extend([])</code></pre> 
<p><img alt="" height="535" src="https://images2.imgbox.com/96/54/6DsSk2ut_o.png" width="1190"></p> 
<p><img alt="" height="479" src="https://images2.imgbox.com/0f/4d/NVRN0dI9_o.png" width="1200"></p> 
<h2 id="5.%20allure%E5%B1%80%E5%9F%9F%E7%BD%91%E6%9F%A5%E7%9C%8B">5. allure局域网查看</h2> 
<p>局域网（内网）：allure open ./reports</p> 
<pre><code class="language-python">if __name__ == "__main__":
    pytest.main(['./test_study/test_allure.py'])
    os.system("allure generate ./temps -o ./reports --clean")
    os.system("allure open ./reports")</code></pre> 
<p><img alt="" height="640" src="https://images2.imgbox.com/b0/0a/p7Lqpb2d_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/aeab0943eabe09c93d56505f2345a6df/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【期末考试】计算机网络、网络及其计算 考试重点</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/430a3b76b877cc5f4b8fbffd0863198e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mac zsh: command not found: python</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>