<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Jetson nanoéƒ¨ç½²YOLOv8 - èœé¸Ÿç¨‹åºå‘˜åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Jetson nanoéƒ¨ç½²YOLOv8" />
<meta property="og:description" content="ç›®å½• å‰è¨€ä¸€ã€YOLOv8æ¨¡å‹è®­ç»ƒ1. é¡¹ç›®çš„å…‹éš†å’Œå¿…è¦çš„ç¯å¢ƒä¾èµ–1.1 é¡¹ç›®çš„å…‹éš†1.2 é¡¹ç›®ä»£ç ç»“æ„æ•´ä½“ä»‹ç»1.3 ç¯å¢ƒå®‰è£… 2. æ•°æ®é›†å’Œé¢„è®­ç»ƒæƒé‡çš„å‡†å¤‡2.1 æ•°æ®é›†2.2 é¢„è®­ç»ƒæƒé‡å‡†å¤‡ 3. è®­ç»ƒæ¨¡å‹3.1 ä¿®æ”¹æ•°æ®é…ç½®æ–‡ä»¶3.2 ä¿®æ”¹æ¨¡å‹é…ç½®æ–‡ä»¶3.3 è®­ç»ƒæ¨¡å‹3.4 æ¨ç†æµ‹è¯• äºŒã€YOLOv8æ¨¡å‹éƒ¨ç½²1. æºç ä¸‹è½½2. ç¯å¢ƒé…ç½®2.1 trtexecç¯å¢ƒå˜é‡è®¾ç½® 3. ONNXå¯¼å‡º3.1 é™æ€batchå¯¼å‡º3.1.1 TransposeèŠ‚ç‚¹çš„æ·»åŠ 3.1.2 ResizeèŠ‚ç‚¹è§£æçš„é—®é¢˜ 3.2 åŠ¨æ€batchå¯¼å‡º3.2.1 exporter.pyä¿®æ”¹3.2.2 TransposeèŠ‚ç‚¹æ·»åŠ 3.2.3 ResizeèŠ‚ç‚¹è§£æçš„é—®é¢˜ 4. è¿è¡Œ4.1 engineç”Ÿæˆ4.2 æºç ä¿®æ”¹4.3 ç¼–è¯‘è¿è¡Œ4.4 æ‹“å±•-æ‘„åƒå¤´æ£€æµ‹4.5 æ‹“å±•-trtexecå‚æ•° ç»“è¯­ä¸‹è½½é“¾æ¥å‚è€ƒ å‰è¨€ å¼€å§‹YOLOv8çš„æ¨¡å‹éƒ¨ç½²ï¼Œç›®çš„æ˜¯ä¸ºå¤§å®¶æ¨èä¸€ä¸ªå…¨æ–°çš„tensorrtä»“åº“https://github.com/shouxieai/inferï¼Œå¤§å®¶å¯ä»¥æŸ¥çœ‹æˆ‘ä¹‹å‰çš„JetsonåµŒå…¥å¼ç³»åˆ—æ¨¡å‹éƒ¨ç½²æ•™ç¨‹ï¼Œå¾ˆå¤šç»†èŠ‚è¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚è€ƒè™‘åˆ°nanoçš„ç®—åŠ›ï¼Œè¿™é‡Œé‡‡ç”¨yolov8n.ptæ¨¡å‹ï¼Œæœ¬æ–‡ä¸»è¦åˆ†äº«yolov8æ¨¡å‹è®­ç»ƒå’Œjetson nanoéƒ¨ç½²yolov8ä¸¤æ–¹é¢çš„å†…å®¹ã€‚è‹¥æœ‰é—®é¢˜æ¬¢è¿å„ä½çœ‹å®˜æ‰¹è¯„æŒ‡æ­£!!!ğŸ˜„
ä¸€ã€YOLOv8æ¨¡å‹è®­ç»ƒ å…ˆæ¥æ¬£èµä¸‹YOLOv8çš„ç½‘ç»œç»“æ„ğŸ˜…
yolov8çš„ä»£ç é£æ ¼å’Œyolov5ç›¸å·®è¾ƒå¤§ï¼Œè®­ç»ƒæµç¨‹ä¹Ÿç¨æœ‰å·®å¼‚ã€‚åšä¸»ä¸»è¦å‚è€ƒé­”é¬¼é¢å…·çš„YOLOv8æœ€å¼ºæ“ä½œ.
1. é¡¹ç›®çš„å…‹éš†å’Œå¿…è¦çš„ç¯å¢ƒä¾èµ– 1.1 é¡¹ç›®çš„å…‹éš† yolov8çš„ä»£ç æ˜¯å¼€æºçš„å¯ç›´æ¥ä»githubå®˜ç½‘ä¸Šä¸‹è½½ï¼Œæºç ä¸‹è½½åœ°å€æ˜¯https://github.com/ultralytics/ultralyticsï¼Œç”±äºyolov8åˆšå‘å¸ƒä¸ä¹…ä¸€ä¸ªå›ºå®šç‰ˆæœ¬éƒ½æ²¡æœ‰ï¼Œæ•…åªèƒ½é‡‡ç”¨ä¸»åˆ†æ”¯è¿›è¡Œæ¨¡å‹çš„è®­ç»ƒå’Œéƒ¨ç½²å·¥ä½œ(PS:ç”±äºä»£ç æ›´æ–°é¢‘ç¹ï¼Œå¯èƒ½å¤§å®¶ä¼šé‡åˆ°ä¸åŒçš„bug)ã€‚Linuxä¸‹ä»£ç å…‹éš†æŒ‡ä»¤å¦‚ä¸‹
git clone https://github.com/ultralytics/ultralytics.git ä¹Ÿå¯æ‰‹åŠ¨ç‚¹å‡»ä¸‹è½½ï¼Œç‚¹å‡»å³ä¸Šè§’çš„CodeæŒ‰é”®ï¼Œå°†ä»£ç ä¸‹è½½ä¸‹æ¥ã€‚è‡³æ­¤æ•´ä¸ªé¡¹ç›®å°±å·²ç»å‡†å¤‡å¥½äº†ã€‚ä¹Ÿå¯ä»¥ç‚¹å‡»here[pwd:yolo]ä¸‹è½½åšä¸»å‡†å¤‡å¥½çš„ä»£ç (æ³¨æ„ä»£ç ä¸‹è½½äº2023/3/14æ—¥ï¼Œè‹¥æœ‰æ”¹åŠ¨è¯·å‚è€ƒæœ€æ–°)
1.2 é¡¹ç›®ä»£ç ç»“æ„æ•´ä½“ä»‹ç» å°†ä¸‹è½½åçš„yolov8çš„ä»£ç è§£å‹ï¼Œå…¶ä»£ç ç›®å½•å¦‚ä¸‹å›¾
åªéœ€è¦å…³æ³¨ultralyticsè¿™ä¸ªæ–‡ä»¶å¤¹çš„å†…å®¹å³å¯ï¼Œä¸‹é¢å¯¹è¿™ä¸ªæ–‡ä»¶å¤¹çš„æ•´ä½“ç›®å½•åšä¸€ä¸ªä»‹ç»
|-assetsï¼šå­˜æ”¾æµ‹è¯•å›¾ç‰‡|-datasetsï¼šå­˜æ”¾ä¸€äº›è¶…å‚æ•°çš„é…ç½®æ–‡ä»¶ä»¥åŠé…ç½®è®­ç»ƒé›†å’ŒéªŒè¯é›†è·¯å¾„çš„coco.yamlæ–‡ä»¶ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹è‡ªå·±çš„æ•°æ®é›†ï¼Œé‚£ä¹ˆéœ€è¦ä¿®æ”¹å…¶ä¸­çš„yamlæ–‡ä»¶|-hubï¼špytorchæ‰©å±•æ¨¡å‹|-modelsï¼šå­˜æ”¾ä¸åŒæ¨¡å‹çš„yamlæ–‡ä»¶ï¼ŒåŒ…æ‹¬v3ã€v5å’Œv8|-nnï¼šå­˜æ”¾yolov8æ•´ä½“ç½‘ç»œæ¨¡å‹æ­å»ºçš„pyæ–‡ä»¶|-trackerï¼šå­˜æ”¾yolov8ç›®æ ‡è·Ÿè¸ªçš„pyæ–‡ä»¶|-yoloï¼šå­˜æ”¾yolov8æ¨¡å‹é¢„æµ‹ã€è®­ç»ƒã€å¯¼å‡ºçš„pyæ–‡ä»¶ cfgï¼šå­˜æ”¾yolov8çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬è®­ç»ƒæ—¶çš„å‚æ•°æŒ‡å®šå¦‚epochã€batchç­‰ä»¥åŠè¶…å‚æ•°è®¾ç½®ï¼Œæ‰€æœ‰çš„ç›¸å…³é…ç½®éƒ½å¯é€šè¿‡è¿™ä¸ªæ–‡ä»¶è®¾ç½®(é‡ç‚¹å…³æ³¨cfg/default.yamlæ–‡ä»¶)dataï¼šå­˜æ”¾æ•°æ®åŠ è½½çš„pyæ–‡ä»¶engineï¼šå­˜æ”¾æ¨¡å‹å¯¼å‡ºçš„pyæ–‡ä»¶utilsï¼šå­˜æ”¾å·¥å…·ç±»å‡½æ•°ï¼ŒåŒ…æ‹¬lossã€metricsã€plotså‡½æ•°ç­‰v8ï¼šå­˜æ”¾yolov8åˆ†ç±»ã€æ£€æµ‹ã€åˆ†å‰²ç­‰ä¸åŒä»»åŠ¡çš„é¢„æµ‹ã€è®­ç»ƒä»¥åŠéªŒè¯çš„pyæ–‡ä»¶(é‡ç‚¹å…³æ³¨) 1.3 ç¯å¢ƒå®‰è£… å…³äºæ·±åº¦å­¦ä¹ çš„ç¯å¢ƒå®‰è£…å¯å‚è€ƒç‚®å“¥çš„åˆ©ç”¨Anacondaå®‰è£…pytorchå’Œpaddleæ·±åº¦å­¦ä¹ ç¯å¢ƒ&#43;pycharmå®‰è£…â€”å…é¢å¤–å®‰è£…CUDAå’Œcudnn(é€‚åˆå°ç™½çš„ä¿å§†çº§æ•™å­¦)ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚å¦‚æœä¹‹å‰é…ç½®è¿‡yolov5çš„ç¯å¢ƒï¼Œyolov8å¯ç›´æ¥ä½¿ç”¨ã€‚
2. æ•°æ®é›†å’Œé¢„è®­ç»ƒæƒé‡çš„å‡†å¤‡ 2.1 æ•°æ®é›† è¿™é‡Œé‡‡ç”¨çš„æ•°æ®é›†æ˜¯å£ç½©è¯†åˆ«ï¼Œæ¥æºäºBç«™UPä¸»HamlinZhengçš„å£ç½©è¯†åˆ«æ•°æ®é›†ï¼Œè¿™é‡Œç»™å‡ºä¸‹è½½é“¾æ¥Baidu Drive[password:yolo]ï¼Œåšä¸»å°†åŸæ•°æ®é›†æ•´åˆäº†ä¸‹ï¼Œæ–¹ä¾¿åç»­çš„è®­ç»ƒï¼Œè§£å‹åæ•´ä¸ªæ•°æ®é›†ç›®å½•ç»“æ„å¦‚ä¸‹
VOCdevkit â””â”€VOC2007 â”œâ”€Annotations â””â”€JPEGImages å…¶ä¸­JPEGImagesä¸­å­˜æ”¾çš„å›¾åƒæ–‡ä»¶ï¼ŒAnnotationså­˜æ”¾çš„æ˜¯å¯¹åº”çš„XMLæ ‡ç­¾æ–‡ä»¶ã€‚å…³äºæ ‡ç­¾çš„åˆ¶ä½œå¯å‚è€ƒBç«™UPä¸»éœ¹é›³å§å•¦Wzçš„PASCAL VOC2012æ•°æ®é›†è®²è§£ä¸åˆ¶ä½œè‡ªå·±çš„æ•°æ®é›†ï¼Œç”±äºlabelimgæ ‡æ³¨çš„æ˜¯VOCæ ¼å¼æ ‡ç­¾çš„XMLæ–‡ä»¶ï¼Œéœ€è¦è½¬åŒ–ä¸ºYOLOæ ¼å¼æ ‡ç­¾çš„txtæ–‡ä»¶ï¼Œå…³äºè½¬æ¢çš„ä»£ç å¯å‚è€ƒç‚®å“¥çš„ç›®æ ‡æ£€æµ‹â€”æ•°æ®é›†æ ¼å¼è½¬åŒ–åŠè®­ç»ƒé›†å’ŒéªŒè¯é›†åˆ’åˆ†ï¼Œä¸‹é¢ç»™å‡ºVOCæ ¼å¼è½¬YOLOæ ¼å¼çš„ä»£ç ï¼š" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1e32b081712e140f9539d0cf2633f600/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-11T22:04:17+08:00" />
<meta property="article:modified_time" content="2023-07-11T22:04:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="èœé¸Ÿç¨‹åºå‘˜åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">èœé¸Ÿç¨‹åºå‘˜åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Jetson nanoéƒ¨ç½²YOLOv8</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>ç›®å½•</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">å‰è¨€</a></li><li><a href="#YOLOv8_6" rel="nofollow">ä¸€ã€YOLOv8æ¨¡å‹è®­ç»ƒ</a></li><li><ul><li><a href="#1__15" rel="nofollow">1. é¡¹ç›®çš„å…‹éš†å’Œå¿…è¦çš„ç¯å¢ƒä¾èµ–</a></li><li><ul><li><a href="#11__17" rel="nofollow">1.1 é¡¹ç›®çš„å…‹éš†</a></li><li><a href="#12__29" rel="nofollow">1.2 é¡¹ç›®ä»£ç ç»“æ„æ•´ä½“ä»‹ç»</a></li><li><a href="#13__49" rel="nofollow">1.3 ç¯å¢ƒå®‰è£…</a></li></ul> 
    </li><li><a href="#2__53" rel="nofollow">2. æ•°æ®é›†å’Œé¢„è®­ç»ƒæƒé‡çš„å‡†å¤‡</a></li><li><ul><li><a href="#21__55" rel="nofollow">2.1 æ•°æ®é›†</a></li><li><a href="#22__250" rel="nofollow">2.2 é¢„è®­ç»ƒæƒé‡å‡†å¤‡</a></li></ul> 
    </li><li><a href="#3__255" rel="nofollow">3. è®­ç»ƒæ¨¡å‹</a></li><li><ul><li><a href="#31__261" rel="nofollow">3.1 ä¿®æ”¹æ•°æ®é…ç½®æ–‡ä»¶</a></li><li><a href="#32__276" rel="nofollow">3.2 ä¿®æ”¹æ¨¡å‹é…ç½®æ–‡ä»¶</a></li><li><a href="#33__288" rel="nofollow">3.3 è®­ç»ƒæ¨¡å‹</a></li><li><a href="#34__297" rel="nofollow">3.4 æ¨ç†æµ‹è¯•</a></li></ul> 
   </li></ul> 
   </li><li><a href="#YOLOv8_313" rel="nofollow">äºŒã€YOLOv8æ¨¡å‹éƒ¨ç½²</a></li><li><ul><li><a href="#1__317" rel="nofollow">1. æºç ä¸‹è½½</a></li><li><a href="#2__327" rel="nofollow">2. ç¯å¢ƒé…ç½®</a></li><li><ul><li><a href="#21_trtexec_336" rel="nofollow">2.1 trtexecç¯å¢ƒå˜é‡è®¾ç½®</a></li></ul> 
    </li><li><a href="#3_ONNX_358" rel="nofollow">3. ONNXå¯¼å‡º</a></li><li><ul><li><a href="#31_batch_377" rel="nofollow">3.1 é™æ€batchå¯¼å‡º</a></li><li><ul><li><a href="#311_Transpose_379" rel="nofollow">3.1.1 TransposeèŠ‚ç‚¹çš„æ·»åŠ </a></li><li><a href="#312_Resize_457" rel="nofollow">3.1.2 ResizeèŠ‚ç‚¹è§£æçš„é—®é¢˜</a></li></ul> 
     </li><li><a href="#32_batch_545" rel="nofollow">3.2 åŠ¨æ€batchå¯¼å‡º</a></li><li><ul><li><a href="#321_exporterpy_547" rel="nofollow">3.2.1 exporter.pyä¿®æ”¹</a></li><li><a href="#322_Transpose_588" rel="nofollow">3.2.2 TransposeèŠ‚ç‚¹æ·»åŠ </a></li><li><a href="#323_Resize_592" rel="nofollow">3.2.3 ResizeèŠ‚ç‚¹è§£æçš„é—®é¢˜</a></li></ul> 
    </li></ul> 
    </li><li><a href="#4__657" rel="nofollow">4. è¿è¡Œ</a></li><li><ul><li><a href="#41_engine_659" rel="nofollow">4.1 engineç”Ÿæˆ</a></li><li><a href="#42__685" rel="nofollow">4.2 æºç ä¿®æ”¹</a></li><li><a href="#43__713" rel="nofollow">4.3 ç¼–è¯‘è¿è¡Œ</a></li><li><a href="#44__825" rel="nofollow">4.4 æ‹“å±•-æ‘„åƒå¤´æ£€æµ‹</a></li><li><a href="#45_trtexec_887" rel="nofollow">4.5 æ‹“å±•-trtexecå‚æ•°</a></li></ul> 
   </li></ul> 
   </li><li><a href="#_916" rel="nofollow">ç»“è¯­</a></li><li><a href="#_920" rel="nofollow">ä¸‹è½½é“¾æ¥</a></li><li><a href="#_929" rel="nofollow">å‚è€ƒ</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_2"></a>å‰è¨€</h3> 
<blockquote> 
 <p>å¼€å§‹YOLOv8çš„æ¨¡å‹éƒ¨ç½²ï¼Œç›®çš„æ˜¯ä¸ºå¤§å®¶æ¨èä¸€ä¸ªå…¨æ–°çš„tensorrtä»“åº“<a href="https://github.com/shouxieai/infer">https://github.com/shouxieai/infer</a>ï¼Œå¤§å®¶å¯ä»¥æŸ¥çœ‹æˆ‘ä¹‹å‰çš„<a href="https://blog.csdn.net/qq_40672115/category_11970990.html?spm=1001.2014.3001.5482">JetsonåµŒå…¥å¼ç³»åˆ—æ¨¡å‹éƒ¨ç½²æ•™ç¨‹</a>ï¼Œå¾ˆå¤šç»†èŠ‚è¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚è€ƒè™‘åˆ°nanoçš„ç®—åŠ›ï¼Œè¿™é‡Œé‡‡ç”¨yolov8n.ptæ¨¡å‹ï¼Œæœ¬æ–‡ä¸»è¦åˆ†äº«yolov8æ¨¡å‹è®­ç»ƒå’Œjetson nanoéƒ¨ç½²yolov8ä¸¤æ–¹é¢çš„å†…å®¹ã€‚è‹¥æœ‰é—®é¢˜æ¬¢è¿å„ä½çœ‹å®˜æ‰¹è¯„æŒ‡æ­£!!!ğŸ˜„</p> 
</blockquote> 
<h3><a id="YOLOv8_6"></a>ä¸€ã€YOLOv8æ¨¡å‹è®­ç»ƒ</h3> 
<p>å…ˆæ¥æ¬£èµä¸‹YOLOv8çš„ç½‘ç»œç»“æ„ğŸ˜…</p> 
<p><img src="https://images2.imgbox.com/b9/0a/JB7vHxgX_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>yolov8çš„ä»£ç é£æ ¼å’Œyolov5ç›¸å·®è¾ƒå¤§ï¼Œè®­ç»ƒæµç¨‹ä¹Ÿç¨æœ‰å·®å¼‚ã€‚åšä¸»ä¸»è¦å‚è€ƒé­”é¬¼é¢å…·çš„<a href="https://blog.csdn.net/qq_37706472/article/details/128679699?spm=1001.2014.3001.5502">YOLOv8æœ€å¼ºæ“ä½œ.</a></p> 
<h4><a id="1__15"></a>1. é¡¹ç›®çš„å…‹éš†å’Œå¿…è¦çš„ç¯å¢ƒä¾èµ–</h4> 
<h5><a id="11__17"></a>1.1 é¡¹ç›®çš„å…‹éš†</h5> 
<p>yolov8çš„ä»£ç æ˜¯å¼€æºçš„å¯ç›´æ¥ä»githubå®˜ç½‘ä¸Šä¸‹è½½ï¼Œæºç ä¸‹è½½åœ°å€æ˜¯<a href="https://github.com/ultralytics/ultralytics">https://github.com/ultralytics/ultralytics</a>ï¼Œç”±äºyolov8åˆšå‘å¸ƒä¸ä¹…ä¸€ä¸ªå›ºå®šç‰ˆæœ¬éƒ½æ²¡æœ‰ï¼Œæ•…åªèƒ½é‡‡ç”¨<strong>ä¸»åˆ†æ”¯è¿›è¡Œæ¨¡å‹çš„è®­ç»ƒå’Œéƒ¨ç½²å·¥ä½œ</strong>(PS:ç”±äºä»£ç æ›´æ–°é¢‘ç¹ï¼Œå¯èƒ½å¤§å®¶ä¼šé‡åˆ°ä¸åŒçš„bug)ã€‚Linuxä¸‹ä»£ç å…‹éš†æŒ‡ä»¤å¦‚ä¸‹</p> 
<pre><code class="prism language-shell"><span class="token function">git</span> clone https://github.com/ultralytics/ultralytics.git
</code></pre> 
<p>ä¹Ÿå¯æ‰‹åŠ¨ç‚¹å‡»ä¸‹è½½ï¼Œç‚¹å‡»å³ä¸Šè§’çš„<code>Code</code>æŒ‰é”®ï¼Œå°†ä»£ç ä¸‹è½½ä¸‹æ¥ã€‚è‡³æ­¤æ•´ä¸ªé¡¹ç›®å°±å·²ç»å‡†å¤‡å¥½äº†ã€‚ä¹Ÿå¯ä»¥ç‚¹å‡»<a href="https://pan.baidu.com/s/1c50iU7PLwhJfAsCDYs9bvw" rel="nofollow">here[pwd:yolo]</a>ä¸‹è½½åšä¸»å‡†å¤‡å¥½çš„ä»£ç (<strong>æ³¨æ„ä»£ç ä¸‹è½½äº2023/3/14æ—¥ï¼Œè‹¥æœ‰æ”¹åŠ¨è¯·å‚è€ƒæœ€æ–°</strong>)</p> 
<p><img src="https://images2.imgbox.com/94/36/Npm3mAmk_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h5><a id="12__29"></a>1.2 é¡¹ç›®ä»£ç ç»“æ„æ•´ä½“ä»‹ç»</h5> 
<p>å°†ä¸‹è½½åçš„yolov8çš„ä»£ç è§£å‹ï¼Œå…¶ä»£ç ç›®å½•å¦‚ä¸‹å›¾</p> 
<p><img src="https://images2.imgbox.com/da/47/IFofOGrK_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> åªéœ€è¦å…³æ³¨ultralyticsè¿™ä¸ªæ–‡ä»¶å¤¹çš„å†…å®¹å³å¯ï¼Œä¸‹é¢å¯¹è¿™ä¸ªæ–‡ä»¶å¤¹çš„æ•´ä½“ç›®å½•åšä¸€ä¸ªä»‹ç»</p> 
<ul><li><strong>|-assets</strong>ï¼šå­˜æ”¾æµ‹è¯•å›¾ç‰‡</li><li><strong>|-datasets</strong>ï¼šå­˜æ”¾ä¸€äº›è¶…å‚æ•°çš„é…ç½®æ–‡ä»¶ä»¥åŠé…ç½®è®­ç»ƒé›†å’ŒéªŒè¯é›†è·¯å¾„çš„coco.yamlæ–‡ä»¶ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹è‡ªå·±çš„æ•°æ®é›†ï¼Œé‚£ä¹ˆéœ€è¦ä¿®æ”¹å…¶ä¸­çš„yamlæ–‡ä»¶</li><li><strong>|-hub</strong>ï¼špytorchæ‰©å±•æ¨¡å‹</li><li><strong>|-models</strong>ï¼šå­˜æ”¾ä¸åŒæ¨¡å‹çš„yamlæ–‡ä»¶ï¼ŒåŒ…æ‹¬v3ã€v5å’Œv8</li><li><strong>|-nn</strong>ï¼šå­˜æ”¾yolov8æ•´ä½“ç½‘ç»œæ¨¡å‹æ­å»ºçš„pyæ–‡ä»¶</li><li><strong>|-tracker</strong>ï¼šå­˜æ”¾yolov8ç›®æ ‡è·Ÿè¸ªçš„pyæ–‡ä»¶</li><li><strong>|-yolo</strong>ï¼šå­˜æ”¾yolov8æ¨¡å‹é¢„æµ‹ã€è®­ç»ƒã€å¯¼å‡ºçš„pyæ–‡ä»¶ 
  <ul><li><strong>cfg</strong>ï¼šå­˜æ”¾yolov8çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬è®­ç»ƒæ—¶çš„å‚æ•°æŒ‡å®šå¦‚epochã€batchç­‰ä»¥åŠè¶…å‚æ•°è®¾ç½®ï¼Œæ‰€æœ‰çš„ç›¸å…³é…ç½®éƒ½å¯é€šè¿‡è¿™ä¸ªæ–‡ä»¶è®¾ç½®(<strong>é‡ç‚¹å…³æ³¨cfg/default.yamlæ–‡ä»¶</strong>)</li><li><strong>data</strong>ï¼šå­˜æ”¾æ•°æ®åŠ è½½çš„pyæ–‡ä»¶</li><li><strong>engine</strong>ï¼šå­˜æ”¾æ¨¡å‹å¯¼å‡ºçš„pyæ–‡ä»¶</li><li><strong>utils</strong>ï¼šå­˜æ”¾å·¥å…·ç±»å‡½æ•°ï¼ŒåŒ…æ‹¬lossã€metricsã€plotså‡½æ•°ç­‰</li><li><strong>v8</strong>ï¼šå­˜æ”¾yolov8åˆ†ç±»ã€æ£€æµ‹ã€åˆ†å‰²ç­‰ä¸åŒä»»åŠ¡çš„é¢„æµ‹ã€è®­ç»ƒä»¥åŠéªŒè¯çš„pyæ–‡ä»¶(<strong>é‡ç‚¹å…³æ³¨</strong>)</li></ul> </li></ul> 
<h5><a id="13__49"></a>1.3 ç¯å¢ƒå®‰è£…</h5> 
<p>å…³äºæ·±åº¦å­¦ä¹ çš„ç¯å¢ƒå®‰è£…å¯å‚è€ƒç‚®å“¥çš„<a href="https://blog.csdn.net/didiaopao/article/details/119787139?spm=1001.2014.3001.5501">åˆ©ç”¨Anacondaå®‰è£…pytorchå’Œpaddleæ·±åº¦å­¦ä¹ ç¯å¢ƒ+pycharmå®‰è£…â€”å…é¢å¤–å®‰è£…CUDAå’Œcudnn(é€‚åˆå°ç™½çš„ä¿å§†çº§æ•™å­¦)</a>ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚å¦‚æœä¹‹å‰é…ç½®è¿‡yolov5çš„ç¯å¢ƒï¼Œyolov8å¯ç›´æ¥ä½¿ç”¨ã€‚</p> 
<h4><a id="2__53"></a>2. æ•°æ®é›†å’Œé¢„è®­ç»ƒæƒé‡çš„å‡†å¤‡</h4> 
<h5><a id="21__55"></a>2.1 æ•°æ®é›†</h5> 
<p>è¿™é‡Œé‡‡ç”¨çš„æ•°æ®é›†æ˜¯å£ç½©è¯†åˆ«ï¼Œæ¥æºäº<a href="https://space.bilibili.com/73270408" rel="nofollow">Bç«™UPä¸»HamlinZheng</a>çš„<a href="https://www.bilibili.com/video/BV1i7411376y?spm_id_from=333.337.search-card.all.click&amp;vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">å£ç½©è¯†åˆ«æ•°æ®é›†</a>ï¼Œè¿™é‡Œç»™å‡ºä¸‹è½½é“¾æ¥<a href="https://pan.baidu.com/s/1oeBugM-bqRN6QFnVgXi5HQ" rel="nofollow">Baidu Drive[password:yolo]</a>ï¼Œåšä¸»å°†åŸæ•°æ®é›†æ•´åˆäº†ä¸‹ï¼Œæ–¹ä¾¿åç»­çš„è®­ç»ƒï¼Œè§£å‹åæ•´ä¸ªæ•°æ®é›†ç›®å½•ç»“æ„å¦‚ä¸‹</p> 
<pre><code class="prism language-shell">VOCdevkit
   â””â”€VOC2007
       â”œâ”€Annotations
       â””â”€JPEGImages
</code></pre> 
<p>å…¶ä¸­JPEGImagesä¸­å­˜æ”¾çš„å›¾åƒæ–‡ä»¶ï¼ŒAnnotationså­˜æ”¾çš„æ˜¯å¯¹åº”çš„XMLæ ‡ç­¾æ–‡ä»¶ã€‚å…³äºæ ‡ç­¾çš„åˆ¶ä½œå¯å‚è€ƒ<a href="https://space.bilibili.com/18161609?spm_id_from=333.337.0.0" rel="nofollow">Bç«™UPä¸»éœ¹é›³å§å•¦Wz</a>çš„<a href="https://www.bilibili.com/video/BV1kV411k7D8?vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">PASCAL VOC2012æ•°æ®é›†è®²è§£ä¸åˆ¶ä½œè‡ªå·±çš„æ•°æ®é›†</a>ï¼Œ<strong>ç”±äºlabelimgæ ‡æ³¨çš„æ˜¯VOCæ ¼å¼æ ‡ç­¾çš„XMLæ–‡ä»¶ï¼Œéœ€è¦è½¬åŒ–ä¸ºYOLOæ ¼å¼æ ‡ç­¾çš„txtæ–‡ä»¶</strong>ï¼Œå…³äºè½¬æ¢çš„ä»£ç å¯å‚è€ƒç‚®å“¥çš„<a href="https://blog.csdn.net/didiaopao/article/details/120022845?spm=1001.2014.3001.5502">ç›®æ ‡æ£€æµ‹â€”æ•°æ®é›†æ ¼å¼è½¬åŒ–åŠè®­ç»ƒé›†å’ŒéªŒè¯é›†åˆ’åˆ†</a>ï¼Œä¸‹é¢ç»™å‡ºVOCæ ¼å¼è½¬YOLOæ ¼å¼çš„ä»£ç ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># voc2yolo.py</span>
<span class="token keyword">import</span> xml<span class="token punctuation">.</span>etree<span class="token punctuation">.</span>ElementTree <span class="token keyword">as</span> ET
<span class="token keyword">import</span> pickle
<span class="token keyword">import</span> os
<span class="token keyword">from</span> os <span class="token keyword">import</span> listdir<span class="token punctuation">,</span> getcwd
<span class="token keyword">from</span> os<span class="token punctuation">.</span>path <span class="token keyword">import</span> join
<span class="token keyword">import</span> random
<span class="token keyword">from</span> shutil <span class="token keyword">import</span> copyfile

<span class="token comment"># 1. ä¿®æ”¹ä¸ºè‡ªåˆ¶æ•°æ®é›†éœ€æ£€æµ‹çš„ç±»åˆ«æ•°</span>
classes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"have_mask"</span><span class="token punctuation">,</span> <span class="token string">"no_mask"</span><span class="token punctuation">]</span>

<span class="token comment"># 2. è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„æ¯”ä¾‹</span>
TRAIN_RATIO <span class="token operator">=</span> <span class="token number">80</span>


<span class="token keyword">def</span> <span class="token function">clear_hidden_files</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    dir_list <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> dir_list<span class="token punctuation">:</span>
        abspath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>abspath<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"._"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>abspath<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            clear_hidden_files<span class="token punctuation">(</span>abspath<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">convert</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> box<span class="token punctuation">)</span><span class="token punctuation">:</span>
    dw <span class="token operator">=</span> <span class="token number">1.</span> <span class="token operator">/</span> size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    dh <span class="token operator">=</span> <span class="token number">1.</span> <span class="token operator">/</span> size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    x <span class="token operator">=</span> <span class="token punctuation">(</span>box<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> box<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span>
    y <span class="token operator">=</span> <span class="token punctuation">(</span>box<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> box<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span>
    w <span class="token operator">=</span> box<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> box<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    h <span class="token operator">=</span> box<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> box<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    x <span class="token operator">=</span> x <span class="token operator">*</span> dw
    w <span class="token operator">=</span> w <span class="token operator">*</span> dw
    y <span class="token operator">=</span> y <span class="token operator">*</span> dh
    h <span class="token operator">=</span> h <span class="token operator">*</span> dh
    <span class="token keyword">return</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">convert_annotation</span><span class="token punctuation">(</span>image_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
    in_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'VOCdevkit/VOC2007/Annotations/%s.xml'</span> <span class="token operator">%</span> image_id<span class="token punctuation">)</span>
    out_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'VOCdevkit/VOC2007/YOLOLabels/%s.txt'</span> <span class="token operator">%</span> image_id<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>
    tree <span class="token operator">=</span> ET<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>in_file<span class="token punctuation">)</span>
    root <span class="token operator">=</span> tree<span class="token punctuation">.</span>getroot<span class="token punctuation">(</span><span class="token punctuation">)</span>
    size <span class="token operator">=</span> root<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'size'</span><span class="token punctuation">)</span>
    w <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>size<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    h <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>size<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'height'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>

    <span class="token keyword">for</span> obj <span class="token keyword">in</span> root<span class="token punctuation">.</span><span class="token builtin">iter</span><span class="token punctuation">(</span><span class="token string">'object'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        difficult <span class="token operator">=</span> obj<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'difficult'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
        cls <span class="token operator">=</span> obj<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token keyword">if</span> cls <span class="token keyword">not</span> <span class="token keyword">in</span> classes <span class="token keyword">or</span> <span class="token builtin">int</span><span class="token punctuation">(</span>difficult<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        cls_id <span class="token operator">=</span> classes<span class="token punctuation">.</span>index<span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
        xmlbox <span class="token operator">=</span> obj<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'bndbox'</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>xmlbox<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'xmin'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">(</span>xmlbox<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'xmax'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">(</span>xmlbox<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'ymin'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span>
             <span class="token builtin">float</span><span class="token punctuation">(</span>xmlbox<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'ymax'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
        bb <span class="token operator">=</span> convert<span class="token punctuation">(</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
        out_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>cls_id<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">for</span> a <span class="token keyword">in</span> bb<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
    in_file<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    out_file<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


wd <span class="token operator">=</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span>
wd <span class="token operator">=</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span>
data_base_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>wd<span class="token punctuation">,</span> <span class="token string">"VOCdevkit/"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>data_base_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>data_base_dir<span class="token punctuation">)</span>
work_sapce_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_base_dir<span class="token punctuation">,</span> <span class="token string">"VOC2007/"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>work_sapce_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>work_sapce_dir<span class="token punctuation">)</span>
annotation_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>work_sapce_dir<span class="token punctuation">,</span> <span class="token string">"Annotations/"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>annotation_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>annotation_dir<span class="token punctuation">)</span>
clear_hidden_files<span class="token punctuation">(</span>annotation_dir<span class="token punctuation">)</span>
image_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>work_sapce_dir<span class="token punctuation">,</span> <span class="token string">"JPEGImages/"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>image_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>image_dir<span class="token punctuation">)</span>
clear_hidden_files<span class="token punctuation">(</span>image_dir<span class="token punctuation">)</span>
yolo_labels_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>work_sapce_dir<span class="token punctuation">,</span> <span class="token string">"YOLOLabels/"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>yolo_labels_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>yolo_labels_dir<span class="token punctuation">)</span>
clear_hidden_files<span class="token punctuation">(</span>yolo_labels_dir<span class="token punctuation">)</span>
yolov5_images_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_base_dir<span class="token punctuation">,</span> <span class="token string">"images/"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>yolov5_images_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>yolov5_images_dir<span class="token punctuation">)</span>
clear_hidden_files<span class="token punctuation">(</span>yolov5_images_dir<span class="token punctuation">)</span>
yolov5_labels_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_base_dir<span class="token punctuation">,</span> <span class="token string">"labels/"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>yolov5_labels_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>yolov5_labels_dir<span class="token punctuation">)</span>
clear_hidden_files<span class="token punctuation">(</span>yolov5_labels_dir<span class="token punctuation">)</span>
yolov5_images_train_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>yolov5_images_dir<span class="token punctuation">,</span> <span class="token string">"train/"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>yolov5_images_train_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>yolov5_images_train_dir<span class="token punctuation">)</span>
clear_hidden_files<span class="token punctuation">(</span>yolov5_images_train_dir<span class="token punctuation">)</span>
yolov5_images_test_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>yolov5_images_dir<span class="token punctuation">,</span> <span class="token string">"val/"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>yolov5_images_test_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>yolov5_images_test_dir<span class="token punctuation">)</span>
clear_hidden_files<span class="token punctuation">(</span>yolov5_images_test_dir<span class="token punctuation">)</span>
yolov5_labels_train_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>yolov5_labels_dir<span class="token punctuation">,</span> <span class="token string">"train/"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>yolov5_labels_train_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>yolov5_labels_train_dir<span class="token punctuation">)</span>
clear_hidden_files<span class="token punctuation">(</span>yolov5_labels_train_dir<span class="token punctuation">)</span>
yolov5_labels_test_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>yolov5_labels_dir<span class="token punctuation">,</span> <span class="token string">"val/"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>yolov5_labels_test_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>yolov5_labels_test_dir<span class="token punctuation">)</span>
clear_hidden_files<span class="token punctuation">(</span>yolov5_labels_test_dir<span class="token punctuation">)</span>

train_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>wd<span class="token punctuation">,</span> <span class="token string">"yolov5_train.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>
test_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>wd<span class="token punctuation">,</span> <span class="token string">"yolov5_val.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>
train_file<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
test_file<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
train_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>wd<span class="token punctuation">,</span> <span class="token string">"yolov5_train.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span>
test_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>wd<span class="token punctuation">,</span> <span class="token string">"yolov5_val.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span>
list_imgs <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>image_dir<span class="token punctuation">)</span>  <span class="token comment"># list image files</span>
prob <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Probability: %d"</span> <span class="token operator">%</span> prob<span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_imgs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>image_dir<span class="token punctuation">,</span> list_imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        image_path <span class="token operator">=</span> image_dir <span class="token operator">+</span> list_imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        voc_path <span class="token operator">=</span> list_imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token punctuation">(</span>nameWithoutExtention<span class="token punctuation">,</span> extention<span class="token punctuation">)</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span>voc_nameWithoutExtention<span class="token punctuation">,</span> voc_extention<span class="token punctuation">)</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>voc_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
        annotation_name <span class="token operator">=</span> nameWithoutExtention <span class="token operator">+</span> <span class="token string">'.xml'</span>
        annotation_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>annotation_dir<span class="token punctuation">,</span> annotation_name<span class="token punctuation">)</span>
        label_name <span class="token operator">=</span> nameWithoutExtention <span class="token operator">+</span> <span class="token string">'.txt'</span>
        label_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>yolo_labels_dir<span class="token punctuation">,</span> label_name<span class="token punctuation">)</span>
    prob <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Probability: %d"</span> <span class="token operator">%</span> prob<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>prob <span class="token operator">&lt;</span> TRAIN_RATIO<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># train dataset</span>
        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>annotation_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
            train_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>image_path <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
            convert_annotation<span class="token punctuation">(</span>nameWithoutExtention<span class="token punctuation">)</span>  <span class="token comment"># convert label</span>
            copyfile<span class="token punctuation">(</span>image_path<span class="token punctuation">,</span> yolov5_images_train_dir <span class="token operator">+</span> voc_path<span class="token punctuation">)</span>
            copyfile<span class="token punctuation">(</span>label_path<span class="token punctuation">,</span> yolov5_labels_train_dir <span class="token operator">+</span> label_name<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># test dataset</span>
        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>annotation_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
            test_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>image_path <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
            convert_annotation<span class="token punctuation">(</span>nameWithoutExtention<span class="token punctuation">)</span>  <span class="token comment"># convert label</span>
            copyfile<span class="token punctuation">(</span>image_path<span class="token punctuation">,</span> yolov5_images_test_dir <span class="token operator">+</span> voc_path<span class="token punctuation">)</span>
            copyfile<span class="token punctuation">(</span>label_path<span class="token punctuation">,</span> yolov5_labels_test_dir <span class="token operator">+</span> label_name<span class="token punctuation">)</span>
train_file<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
test_file<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>ä»£ç æ€»å…±éœ€è¦ä¿®æ”¹ä¸¤å¤„</p> 
<ul><li><strong>ç¬¬11è¡Œï¼Œä¿®æ”¹è¦æ£€æµ‹çš„ç±»åˆ«åç§°</strong></li><li><strong>ç¬¬14è¡Œï¼Œä¿®æ”¹è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„åˆ’åˆ†æ¯”ä¾‹</strong></li></ul> 
<p>æ•´ä¸ªç›®å½•ç»“æ„å¦‚ä¸‹ï¼Œæ³¨æ„<code>voc2yolo.py</code>ä¸<code>VOCdevkit</code>å¤„äº<strong>åŒä¸€çº§ç›®å½•</strong></p> 
<pre><code class="prism language-shell">VOCdevkit
   â””â”€VOC2007
       â”œâ”€Annotations
       â””â”€JPEGImages
voc2yolo.py
</code></pre> 
<p><strong>æ³¨</strong>ï¼šç›®å½•ç»“æ„ä¸€å®šè¦ä¸åšä¸»çš„ä¸€è‡´ï¼Œå› ä¸ºç¨‹åºå·²ç»å°†å¯¹åº”ç›®å½•å†™æ­»ã€‚</p> 
<p>è¿è¡Œ<code>voc2yolo.py</code>ä»£ç ä¹‹åå¾—åˆ°å¦‚ä¸‹ç»“æœ<br> <img src="https://images2.imgbox.com/b3/2b/Bya0ep2B_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å¯ä»¥çœ‹åˆ°ç›®å½•ä¸‹æœ‰ä¸€äº›æ–°çš„æ–‡ä»¶ç”Ÿæˆï¼Œé¦–å…ˆVOCdevkitæ–‡ä»¶å¤¹ä¸‹åˆ†åˆ«ç”Ÿæˆäº†imageså’Œlabelsæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«å­˜æ”¾ç€å›¾åƒå’Œå¯¹åº”çš„<strong>yoloæ ¼å¼çš„æ ‡ç­¾æ–‡ä»¶</strong>ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹ä¸‹åˆ†åˆ«åŒ…å«trainå’Œvalä¸¤ä¸ªå­æ–‡ä»¶å¤¹ï¼Œä»£è¡¨å„è‡ªå¯¹åº”çš„è®­ç»ƒé›†å’ŒéªŒè¯é›†ã€‚VOC2007æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆäº†YOLOLabelsæ–‡ä»¶å¤¹ï¼Œå­˜æ”¾ç€å¯¹åº”yoloæ ¼å¼çš„æ ‡ç­¾æ–‡ä»¶ã€‚ç„¶åè¿˜ç”Ÿæˆäº†<code>yolov5_train.txt</code>ä»¥åŠ<code>yolov5_val.txt</code>ä¸¤ä¸ªtxtæ–‡ä»¶ï¼Œå­˜æ”¾ç€è®­ç»ƒé›†å’ŒéªŒè¯é›†å›¾ç‰‡çš„å®Œæ•´è·¯å¾„ã€‚<strong>yolov8çš„è®­ç»ƒåªéœ€è¦VOCdevkitç›®å½•ä¸‹çš„imageså’Œlabelsä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œå…¶å®ƒå‡ä¸éœ€è¦</strong>ï¼Œæ•…æœ€ç»ˆçš„ç›®å½•ç»“æ„å¦‚ä¸‹</p> 
<pre><code class="prism language-shell">VOCdevkit
    â”œâ”€images
    â”‚  â”œâ”€train
    â”‚  â””â”€val
    â””â”€labels
        â”œâ”€train
        â””â”€val
</code></pre> 
<p>è‡³æ­¤ï¼Œæ•°æ®é›†çš„å‡†å¤‡å·¥ä½œå®Œæ¯•ã€‚</p> 
<h5><a id="22__250"></a>2.2 é¢„è®­ç»ƒæƒé‡å‡†å¤‡</h5> 
<p>yolov8é¢„è®­ç»ƒæƒé‡å¯ä»¥é€šè¿‡<a href="https://github.com/ultralytics/ultralytics">here</a>æ‰¾åˆ°ä¸‹å›¾çš„Modelsï¼Œç„¶åç‚¹å‡»ä¸åŒå¤§å°çš„æƒé‡å³å¯ä¸‹è½½ï¼Œåšä¸»ä¹Ÿæä¾›ä¸‹è½½å¥½çš„å‡ ä¸ªé¢„è®­ç»ƒæƒé‡<a href="https://pan.baidu.com/s/1zvqKaalugR-zKhugDikfDA" rel="nofollow">Baidu Drive[pwd:yolo]</a>ï¼Œ<strong>æ³¨æ„è¿™æ˜¯yolov8æ²¡å›ºå®šç‰ˆæœ¬çš„é¢„è®­ç»ƒæƒé‡ï¼Œè‹¥åç»­æœ‰ç‰ˆæœ¬æ›´æ–°ï¼Œè®°å¾—æ›¿æ¢</strong>ã€‚æœ¬æ¬¡è®­ç»ƒè‡ªå·±çš„æ•°æ®é›†ä½¿ç”¨çš„é¢„è®­ç»ƒæƒé‡ä¸º<code>yolov8n.pt</code></p> 
<p><img src="https://images2.imgbox.com/7d/8e/vP7hx8zt_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h4><a id="3__255"></a>3. è®­ç»ƒæ¨¡å‹</h4> 
<p>å°†å‡†å¤‡å¥½çš„æ•°æ®é›†æ–‡ä»¶å¤¹å³VOCdevkitå¤åˆ¶åˆ°yolov8é¡¹ç›®ç¯å¢ƒä¸­çš„<code>ultralytics-main/ultralytics/datasets</code>æ–‡ä»¶å¤¹ä¸‹ï¼Œå°†å‡†å¤‡å¥½çš„é¢„è®­ç»ƒæƒé‡<code>yolov8n.pt</code>å¤åˆ¶åˆ°yolov8é¡¹ç›®ç¯å¢ƒä¸­çš„<code>ultralytics-main/ultralytics/yolo/v8/detect</code>æ–‡ä»¶å¤¹ä¸‹ã€‚è®­ç»ƒç›®æ ‡æ£€æµ‹æ¨¡å‹ä¸»è¦ä¿®æ”¹æ¨¡å‹é…ç½®æ–‡ä»¶<code>ultralytics-main/ultralytics/yolo/cfg/default.yaml</code>ä»¥åŠæ•°æ®é…ç½®æ–‡ä»¶<code>ultralytics-main/ultralytics/datasets/coco128.yaml</code>ï¼Œé¡¹ç›®ç»“æ„å¦‚ä¸‹æ‰€ç¤º</p> 
<p><img src="https://images2.imgbox.com/2e/13/njcVPlsN_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h5><a id="31__261"></a>3.1 ä¿®æ”¹æ•°æ®é…ç½®æ–‡ä»¶</h5> 
<p>ä¿®æ”¹ultralytics/datasetsç›®å½•ä¸‹ç›¸åº”çš„yamlæ–‡ä»¶ï¼Œæ‰¾åˆ°è¯¥ç›®å½•ä¸‹çš„<code>coco128.yaml</code>æ–‡ä»¶ï¼Œä¸»è¦ä¿®æ”¹å¦‚ä¸‹ï¼š</p> 
<ul><li> <p><strong>1.ä¿®æ”¹ç¬¬11è¡Œçš„æ•°æ®é›†çš„è·¯å¾„</strong></p> </li><li> <p><strong>2.ä¿®æ”¹ç¬¬12è¡Œçš„trainçš„è·¯å¾„</strong></p> </li><li> <p><strong>3.ä¿®æ”¹ç¬¬13è¡Œçš„valè·¯å¾„</strong></p> </li><li> <p><strong>4.ä¿®æ”¹ç¬¬17è¡Œçš„éœ€è¦æ£€æµ‹çš„ç±»åˆ«åç§°</strong></p> </li><li> <p><strong>5.æ³¨é‡Šæœ€åä¸€è¡Œï¼Œå–æ¶ˆcocoæ•°æ®é›†çš„ä¸‹è½½</strong></p> </li></ul> 
<p><img src="https://images2.imgbox.com/bc/70/nTa2qpmA_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h5><a id="32__276"></a>3.2 ä¿®æ”¹æ¨¡å‹é…ç½®æ–‡ä»¶</h5> 
<p>ä¿®æ”¹ultralytics/yolo/cfgç›®å½•ä¸‹å¯¹åº”çš„yamlæ–‡ä»¶ï¼Œæ‰¾åˆ°è¯¥ç›®å½•ä¸‹çš„<code>default.yaml</code>æ–‡ä»¶ï¼Œä¸»è¦ä¿®æ”¹å¦‚ä¸‹ï¼š</p> 
<ul><li> <p><strong>1.ä¿®æ”¹ç¬¬8è¡Œçš„æ¨¡å‹æ–‡ä»¶ï¼ŒæŒ‡å®šyolov8n.pt</strong></p> </li><li> <p><strong>2.ä¿®æ”¹ç¬¬9è¡Œçš„æ•°æ®æ–‡ä»¶è·¯å¾„ï¼Œå³3.1èŠ‚çš„coco128.yaml</strong></p> </li></ul> 
<p><img src="https://images2.imgbox.com/0c/13/HlbYbnkR_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>è¿˜æœ‰å…¶å®ƒå‚æ•°åšä¸»å¹¶æœªä¿®æ”¹ï¼Œå¦‚<strong>epoches</strong>è®­ç»ƒè½®æ•°ã€<strong>batch</strong>æ‰¹å¤„ç†é‡ç­‰ç­‰ï¼Œ<strong>å¤§å®¶ä¸€å®šè¦æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µ(å¦‚æ˜¾å¡ç®—åŠ›ç­‰)æŒ‡å®šä¸åŒçš„å‚æ•°</strong>ï¼Œå¦‚æœä½ ä¹‹å‰è®­ç»ƒè¿‡yolov5ï¼Œé‚£æˆ‘ç›¸ä¿¡è¿™å¯¹ä½ æ¥è¯´åº”è¯¥æ˜¯å°caseğŸ˜„</p> 
<h5><a id="33__288"></a>3.3 è®­ç»ƒæ¨¡å‹</h5> 
<p>æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤å®Œæˆä¿®æ”¹åå¯ä»¥æ‰¾åˆ°yolo/v8/detect/train.pyæ–‡ä»¶ï¼Œç‚¹å‡»è¿è¡Œå³å¯å¼€å§‹è®­ç»ƒã€‚</p> 
<p>åšä¸»è®­ç»ƒçš„æ¨¡å‹ä¸ºyolov8n.ptä¸”ä½¿ç”¨çš„æ˜¯å•ä¸ªGPUè¿›è¡Œè®­ç»ƒï¼Œæ˜¾å¡ä¸ºRTX3060ï¼Œæ“ä½œç³»ç»Ÿä¸ºWindows10ï¼Œpytorchç‰ˆæœ¬ä¸º1.12.1ï¼Œè®­ç»ƒæ—¶é•¿å¤§æ¦‚1.6ä¸ªå°æ—¶ã€‚</p> 
<p><img src="https://images2.imgbox.com/5e/b8/o9YlIQFl_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> è®­ç»ƒå®Œæˆåçš„æ¨¡å‹æƒé‡ä¿å­˜åœ¨runs/detect/train/weightsæ–‡ä»¶å¤¹ä¸‹ï¼Œåç»­ä½¿ç”¨<code>best.pt</code>è¿›è¡Œåç»­æ¨¡å‹éƒ¨ç½²å·¥ä½œå³å¯ï¼Œè¿™é‡Œæä¾›åšä¸»è®­ç»ƒå¥½çš„æƒé‡æ–‡ä»¶ä¸‹è½½é“¾æ¥<a href="https://pan.baidu.com/s/193prud3xw-SmG8ercjZlug" rel="nofollow">Baidu Driver[pwd:yolo]</a></p> 
<h5><a id="34__297"></a>3.4 æ¨ç†æµ‹è¯•</h5> 
<p>åˆ©ç”¨é¡¹ç›®ä¸­çš„<code>yolo/v8/detect/predict.py</code>æ–‡ä»¶è¿›è¡Œæµ‹è¯•ï¼Œå°†éœ€è¦æ¨ç†çš„å›¾ç‰‡æ”¾å…¥ultralytics/assetsæ–‡ä»¶å¤¹ä¸‹ï¼Œå°†åˆšè®­ç»ƒçš„å£ç½©è¯†åˆ«æƒé‡æ–‡ä»¶æ”¾å…¥yolo/v8/detectæ–‡ä»¶å¤¹ä¸‹ï¼Œæœ€ååœ¨predict.pyæ–‡ä»¶ç¬¬86è¡ŒæŒ‡å®šåˆšè®­ç»ƒçš„æ¨¡å‹æƒé‡æ–‡ä»¶best.ptå¦‚ä¸‹æ‰€ç¤ºï¼Œç‚¹å‡»è¿è¡Œpredict.pyå³å¯æ‰§è¡Œæµ‹è¯•</p> 
<pre><code class="prism language-python">model <span class="token operator">=</span> <span class="token string">'best.pt'</span>   <span class="token comment"># predict.pyç¬¬86è¡Œä¿®æ”¹</span>
</code></pre> 
<p>æ¨ç†å®Œæˆåä¼šåœ¨detect/runsæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸€ä¸ªdetect/trainç›®å½•ï¼Œæ¨ç†çš„ç»“æœä¿å­˜åœ¨æ­¤ç›®å½•ä¸‹ï¼Œæ¨ç†ç»“æœå¦‚ä¸‹æ‰€ç¤º</p> 
<p><img src="https://images2.imgbox.com/18/06/eg9jn8gg_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <img src="https://images2.imgbox.com/4c/d3/cnSHnXqk_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>è‡³æ­¤ï¼Œyolov8æ¨¡å‹è®­ç»ƒå·²ç»å®Œæ¯•ï¼Œä¸‹é¢å¼€å§‹jetson nanoä¸Šçš„éƒ¨ç½²å·¥ä½œã€‚</p> 
<h3><a id="YOLOv8_313"></a>äºŒã€YOLOv8æ¨¡å‹éƒ¨ç½²</h3> 
<blockquote> 
 <p>Jetson nanoä¸Šyolov8æ¨¡å‹éƒ¨ç½²æµç¨‹å’Œyolov5ã€yolov7ç›¸å·®è¾ƒå¤§ï¼Œä¸»è¦æ¢äº†ä¸€ä¸ªéƒ¨ç½²æ¡†æ¶ï¼Œå¤§å®¶å¯¹jetsonæ¨¡å‹éƒ¨ç½²æ„Ÿå…´è¶£çš„å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰å‘çš„<a href="https://blog.csdn.net/qq_40672115/category_11970990.html?spm=1001.2014.3001.5482">JetsonåµŒå…¥å¼ç³»åˆ—æ¨¡å‹éƒ¨ç½²</a>æ–‡ç« ï¼Œè¿™æ¬¡å¸¦å¤§å®¶äº†è§£ä¸‹ä¸€ä¸ªå…¨æ–°çš„tensorrtå°è£…ï¼Œéƒ¨ç½²ä½¿ç”¨åˆ°çš„Githubä»“åº“æ˜¯<a href="https://github.com/shouxieai/infer">infer</a>ã€‚è¯¥ä»“åº“é€šè¿‡<code>trtexec</code>å·¥å…·å®Œæˆæ¨¡å‹çš„æ„å»ºå·¥ä½œã€‚å¯¹æ¨¡å‹éƒ¨ç½²æœ‰ç–‘é—®çš„å¯ä»¥å‚è€ƒ<a href="https://blog.csdn.net/qq_40672115/article/details/126386680?spm=1001.2014.3001.5502">JetsonåµŒå…¥å¼ç³»åˆ—æ¨¡å‹éƒ¨ç½²-1</a>ï¼Œæƒ³äº†è§£é€šè¿‡<code>TensorRT</code>çš„<code>Layer API</code>ä¸€å±‚å±‚å®Œæˆæ¨¡å‹çš„æ­å»ºå·¥ä½œå¯å‚è€ƒ<a href="https://blog.csdn.net/qq_40672115/article/details/126368779?spm=1001.2014.3001.5502">JetsonåµŒå…¥å¼ç³»åˆ—æ¨¡å‹éƒ¨ç½²-2</a>ï¼Œæƒ³äº†è§£é€šè¿‡<code>TensorRT</code>çš„<code>ONNX parser</code>è§£æONNXæ–‡ä»¶æ¥å®Œæˆæ¨¡å‹çš„æ­å»ºå·¥ä½œå¯å‚è€ƒ<a href="https://blog.csdn.net/qq_40672115/article/details/126369675?spm=1001.2014.3001.5502">JetsonåµŒå…¥å¼æ¨¡å‹éƒ¨ç½²-3</a>ã€<a href="https://blog.csdn.net/qq_40672115/article/details/126668443?spm=1001.2014.3001.5502">Jetson nanoéƒ¨ç½²YOLOv7</a>ã€‚æœ¬æ–‡ä¸»è¦é’ˆå¯¹<a href="https://github.com/shouxieai/infer">infer</a>é¡¹ç›®ä¸­çš„yolov8å®ŒæˆåµŒå…¥å¼æ¨¡å‹éƒ¨ç½²ï¼Œæœ¬æ–‡å‚è€ƒè‡ª<a href="https://github.com/shouxieai/infer">inferçš„README.md</a>ï¼Œå…·ä½“æ“ä½œæµç¨‹ä½œè€…æè¿°éå¸¸è¯¦ç»†ï¼Œè¿™é‡Œå†ç®€å•è¿‡ä¸€éï¼Œæœ¬æ¬¡è®­ç»ƒçš„æ¨¡å‹ä½¿ç”¨yolov8nï¼Œç±»åˆ«æ•°ä¸º2ï¼Œä¸ºå£ç½©è¯†åˆ«ğŸ˜·ã€‚</p> 
</blockquote> 
<h4><a id="1__317"></a>1. æºç ä¸‹è½½</h4> 
<p>inferçš„ä»£ç å¯ä»¥ç›´æ¥ä»githubå®˜ç½‘ä¸Šä¸‹è½½ï¼Œæºç ä¸‹è½½åœ°å€æ˜¯<a href="https://github.com/shouxieai/infer">https://github.com/shouxieai/infer</a>ï¼Œç”±äºinferéƒ¨ç½²æ¡†æ¶åˆšå‘å¸ƒä¸ä¹…ä¸€ä¸ªå›ºå®šçš„ç‰ˆæœ¬éƒ½æ²¡æœ‰ï¼Œæ•…åªèƒ½é‡‡ç”¨<strong>ä¸»åˆ†æ”¯è¿›è¡Œyolov8çš„éƒ¨ç½²å·¥ä½œ</strong>(PS:ç”±äºä»£ç æ›´æ–°é¢‘ç¹ï¼Œå¯èƒ½å¤§å®¶ä¼šé‡åˆ°ä¸åŒçš„bug)ã€‚Linuxä¸‹ä»£ç å…‹éš†æŒ‡ä»¤å¦‚ä¸‹</p> 
<pre><code class="prism language-shell">$ <span class="token function">git</span> clone https://github.com/shouxieai/infer.git
</code></pre> 
<p>ä¹Ÿå¯æ‰‹åŠ¨ç‚¹å‡»ä¸‹è½½ï¼Œç‚¹å‡»å³ä¸Šè§’çš„<code>Code</code>æŒ‰é”®ï¼Œå°†ä»£ç ä¸‹è½½ä¸‹æ¥ã€‚è‡³æ­¤æ•´ä¸ªé¡¹ç›®å°±å·²ç»å‡†å¤‡å¥½äº†ã€‚ä¹Ÿå¯ä»¥ç‚¹å‡»<a href="https://pan.baidu.com/s/1T47jZ1AswHnaX32GOkqR_Q" rel="nofollow">here[pwd:yolo]</a>ä¸‹è½½åšä¸»å‡†å¤‡å¥½çš„æºä»£ç (<strong>æ³¨æ„ä»£ç ä¸‹è½½äº2023/3/15æ—¥ï¼Œè‹¥æœ‰æ”¹åŠ¨è¯·å‚è€ƒæœ€æ–°</strong>)</p> 
<h4><a id="2__327"></a>2. ç¯å¢ƒé…ç½®</h4> 
<blockquote> 
 <p>éœ€è¦ä½¿ç”¨çš„è½¯ä»¶ç¯å¢ƒæœ‰<code>TensorRTã€CUDAã€CUDNNã€OpenCV</code>ã€‚æ‰€æœ‰è½¯ä»¶ç¯å¢ƒåœ¨JetPacké•œåƒä¸­å·²ç»å®‰è£…å®Œæˆï¼Œåªéœ€è¦æ·»åŠ ä¸‹<code>trtexec</code>å·¥å…·çš„ç¯å¢ƒå˜é‡å³å¯ã€‚åšä¸»ä½¿ç”¨çš„jetpackç‰ˆæœ¬ä¸ºJetPack4.6.1(PS:å…³äºjetson nanoåˆ·æœºå°±ä¸å†èµ˜è¿°äº†ï¼Œéœ€è¦å„ä½çœ‹å®˜è‡ªè¡Œé…ç½®å¥½ç›¸å…³ç¯å¢ƒğŸ˜„ï¼Œå¤–ç½‘è®¿é—®è¾ƒæ…¢ï¼Œè¿™é‡Œæä¾›Jetson nanoçš„<a href="https://pan.baidu.com/s/1RW8Z-EQK--NtPgIe6mmKIQ?_at_=1660636990470#list/path=%2F" rel="nofollow">JetPacké•œåƒä¸‹è½½é“¾æ¥Baidu Drive[password:nano]ã€æ›´æ–°å®Œæ¯•!!!ã€‘</a>å‡ ä¸ª(<strong>PS:æä¾›4.6å’Œ4.6.1ä¸¤ä¸ªç‰ˆæœ¬ï¼Œæ³¨æ„4GBå’Œ2GBçš„åŒºåˆ«ï¼Œä¸è¦åˆ·é”™äº†</strong>)ï¼Œå…³äºJetson Nano 2GBå’Œ4GBçš„åŒºåˆ«å¯å‚è€ƒé“¾æ¥<a href="https://zhuanlan.zhihu.com/p/339225116" rel="nofollow">Jetson NANOæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é€‰ï¼Ÿ</a>ã€‚(åæ§½ä¸‹è¿™ç©æ„ä¸Šä¼ å¿’æ…¢äº†ï¼Œè¶…çº§ä¼šå‘˜ä¸é¡¶ç”¨å‘€ï¼Œç»ˆäºä¸Šä¼ å®Œäº†ï¼ŒæŠ˜ç£¨!!!)</p> 
</blockquote> 
<p>åšä¸»çš„Jetpackå¯¹åº”çš„è½¯ä»¶ç¯å¢ƒå¦‚ä¸‹</p> 
<p><img src="https://images2.imgbox.com/7f/6b/60v158Md_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h5><a id="21_trtexec_336"></a>2.1 trtexecç¯å¢ƒå˜é‡è®¾ç½®</h5> 
<p>trtexecç¯å¢ƒå˜é‡çš„æ·»åŠ ä¸»è¦å‚è€ƒ<a href="https://blog.csdn.net/Max_ZhangJF/article/details/120966773">è¿™é‡Œ</a>ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å‡ æ­¥</p> 
<p><strong>1</strong>.æ‰“å¼€bashrcæ–‡ä»¶</p> 
<pre><code class="prism language-shell"><span class="token function">vim</span> ~/.bashrc
</code></pre> 
<p><strong>2</strong>.æŒ‰iè¿›å…¥è¾“å…¥æ¨¡å¼ï¼Œåœ¨æœ€åä¸€è¡Œæ·»åŠ å¦‚ä¸‹è¯­å¥</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/src/tensorrt/bin:<span class="token environment constant">$PATH</span>
</code></pre> 
<p><strong>3</strong>.æŒ‰ä¸‹escï¼Œè¾“å…¥:wq!ä¿å­˜é€€å‡ºå³å¯ï¼Œæœ€ååˆ·æ–°ä¸‹ç¯å¢ƒå˜é‡</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">source</span> ~/.bashrc
</code></pre> 
<h4><a id="3_ONNX_358"></a>3. ONNXå¯¼å‡º</h4> 
<ul><li>è®­ç»ƒçš„æ¨¡å‹ä½¿ç”¨yolov8n.ptï¼Œtorchç‰ˆæœ¬1.12.1ï¼Œonnxç‰ˆæœ¬1.13.1</li><li>å‚è€ƒè‡ª<a href="https://www.bilibili.com/video/BV15Y41167B5/?spm_id_from=333.999.0.0&amp;vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">YoloV8çš„åŠ¨æ€é™æ€batchå¦‚ä½•ç†è§£å’Œä½¿ç”¨</a></li></ul> 
<p>å…³äºé™æ€batchå’ŒåŠ¨æ€batchæœ‰ä»¥ä¸‹å‡ ç‚¹è¯´æ˜ï¼Œæ›´å¤šç»†èŠ‚è¯·æŸ¥çœ‹<a href="https://www.bilibili.com/video/BV15Y41167B5/?spm_id_from=333.999.0.0&amp;vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">è§†é¢‘</a></p> 
<p><strong>é™æ€batch</strong></p> 
<ul><li>å¯¼å‡ºçš„onnxæŒ‡å®šæ‰€æœ‰ç»´åº¦å‡ä¸ºæ˜ç¡®çš„æ•°å­—ï¼Œæ˜¯é™æ€shapeæ¨¡å‹</li><li>åœ¨æ¨ç†çš„æ—¶å€™ï¼Œå®ƒæ°¸è¿œéƒ½æ˜¯åŒæ ·çš„batchæ¨ç†ï¼Œå³ä½¿ä½ ç›®å‰åªæœ‰ä¸€ä¸ªå›¾æ¨ç†ï¼Œå®ƒä¹Ÿéœ€è¦nä¸ªbatchçš„è€—æ—¶</li><li>é€‚ç”¨äºå¤§éƒ¨åˆ†åœºæ™¯ï¼Œæ•´ä¸ªä»£ç é€»è¾‘éå¸¸ç®€å•</li></ul> 
<p><strong>åŠ¨æ€batch</strong></p> 
<ul><li>å¯¼å‡ºçš„æ—¶å€™æŒ‡å®šç‰¹å®šç»´åº¦ä¸ºdynamicï¼Œä¹Ÿå°±æ˜¯ä¸ç¡®å®šçŠ¶æ€</li><li>æ¨¡å‹æ¨ç†æ—¶æ‰å†³å®šæ‰€éœ€æ¨ç†çš„batchå¤§å°ï¼Œè€—æ—¶æœ€ä¼˜ï¼Œä½†onnxå¤æ‚åº¦æé«˜äº†</li><li>é€‚ç”¨äºå¦‚serveræœ‰å¤§é‡ä¸å‡åŒ€çš„è¯·æ±‚æ—¶çš„åœºæ™¯</li></ul> 
<h5><a id="31_batch_377"></a>3.1 é™æ€batchå¯¼å‡º</h5> 
<h6><a id="311_Transpose_379"></a>3.1.1 TransposeèŠ‚ç‚¹çš„æ·»åŠ </h6> 
<p>å°†è®­ç»ƒå¥½çš„å£ç½©è¯†åˆ«æƒé‡<code>best.pt</code>æ”¾åœ¨ultralytics-mainä¸»ç›®å½•ä¸‹ï¼Œæ–°å»ºå¯¼å‡ºæ–‡ä»¶<strong>export.py</strong>ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œæ‰§è¡Œå®Œæˆåå°†ä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆå¯¼å‡ºçš„<code>best.onnx</code>æ¨¡å‹</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> ultralytics <span class="token keyword">import</span> YOLO

model <span class="token operator">=</span> YOLO<span class="token punctuation">(</span><span class="token string">"best.pt"</span><span class="token punctuation">)</span>

success <span class="token operator">=</span> model<span class="token punctuation">.</span>export<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span><span class="token string">"onnx"</span><span class="token punctuation">,</span> batch<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>æ¨¡å‹éœ€è¦å®Œæˆä¿®æ”¹æ‰èƒ½æ­£ç¡®è¢«<strong>infer</strong>æ¡†æ¶ä½¿ç”¨ï¼Œæ­£å¸¸æ¨¡å‹å¯¼å‡ºçš„è¾“å‡ºä¸º[1,6,8400]ï¼Œå…¶ä¸­1ä»£è¡¨batchï¼Œ6åˆ†åˆ«ä»£è¡¨cx,cy,w,h,ä»¥åŠhave_maskã€no_maskä¸¤ä¸ªç±»åˆ«åˆ†æ•°ï¼Œ8400ä»£è¡¨æ¡†çš„ä¸ªæ•°ã€‚é¦–å…ˆ<strong>infer</strong>æ¡†æ¶çš„è¾“å‡ºåªæ”¯æŒ[1,8400,6]è¿™ç§å½¢å¼çš„è¾“å‡ºï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨åŸå§‹onnxçš„è¾“å‡ºä¹‹å‰æ·»åŠ ä¸€ä¸ª<strong>Transpose</strong>èŠ‚ç‚¹ï¼Œ<strong>infer</strong>ä»“åº“workspace/v8trans.pyå°±æ˜¯å¸®æˆ‘ä»¬åšè¿™ä¹ˆä¸€ä»¶äº‹æƒ…ï¼Œv8trans.pyå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># v8trans.py</span>
<span class="token keyword">import</span> onnx
<span class="token keyword">import</span> onnx<span class="token punctuation">.</span>helper <span class="token keyword">as</span> helper
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> os

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Usage:\n python v8trans.py yolov8n.onnx"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span>

    <span class="token builtin">file</span> <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Not exist path: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">file</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span>

    prefix<span class="token punctuation">,</span> suffix <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
    dst <span class="token operator">=</span> prefix <span class="token operator">+</span> <span class="token string">".transd"</span> <span class="token operator">+</span> suffix

    model <span class="token operator">=</span> onnx<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
    node  <span class="token operator">=</span> model<span class="token punctuation">.</span>graph<span class="token punctuation">.</span>node<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

    old_output <span class="token operator">=</span> node<span class="token punctuation">.</span>output<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    node<span class="token punctuation">.</span>output<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"pre_transpose"</span>

    <span class="token keyword">for</span> specout <span class="token keyword">in</span> model<span class="token punctuation">.</span>graph<span class="token punctuation">.</span>output<span class="token punctuation">:</span>
        <span class="token keyword">if</span> specout<span class="token punctuation">.</span>name <span class="token operator">==</span> old_output<span class="token punctuation">:</span>
            shape0 <span class="token operator">=</span> specout<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">.</span>tensor_type<span class="token punctuation">.</span>shape<span class="token punctuation">.</span>dim<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            shape1 <span class="token operator">=</span> specout<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">.</span>tensor_type<span class="token punctuation">.</span>shape<span class="token punctuation">.</span>dim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            shape2 <span class="token operator">=</span> specout<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">.</span>tensor_type<span class="token punctuation">.</span>shape<span class="token punctuation">.</span>dim<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
            new_out <span class="token operator">=</span> helper<span class="token punctuation">.</span>make_tensor_value_info<span class="token punctuation">(</span>
                specout<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                specout<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">.</span>tensor_type<span class="token punctuation">.</span>elem_type<span class="token punctuation">,</span>
                <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token punctuation">)</span>
            new_out<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">.</span>tensor_type<span class="token punctuation">.</span>shape<span class="token punctuation">.</span>dim<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CopyFrom<span class="token punctuation">(</span>shape0<span class="token punctuation">)</span>
            new_out<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">.</span>tensor_type<span class="token punctuation">.</span>shape<span class="token punctuation">.</span>dim<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CopyFrom<span class="token punctuation">(</span>shape1<span class="token punctuation">)</span>
            new_out<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">.</span>tensor_type<span class="token punctuation">.</span>shape<span class="token punctuation">.</span>dim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CopyFrom<span class="token punctuation">(</span>shape2<span class="token punctuation">)</span>
            specout<span class="token punctuation">.</span>CopyFrom<span class="token punctuation">(</span>new_out<span class="token punctuation">)</span>

    model<span class="token punctuation">.</span>graph<span class="token punctuation">.</span>node<span class="token punctuation">.</span>append<span class="token punctuation">(</span>
        helper<span class="token punctuation">.</span>make_node<span class="token punctuation">(</span><span class="token string">"Transpose"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"pre_transpose"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>old_output<span class="token punctuation">]</span><span class="token punctuation">,</span> perm<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Model save to </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>dst<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    onnx<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model<span class="token punctuation">,</span> dst<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">0</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>åœ¨å‘½ä»¤è¡Œç»ˆç«¯è¾“å…¥å¦‚ä¸‹æŒ‡ä»¤å³å¯æ·»åŠ TransposeèŠ‚ç‚¹ï¼Œæ‰§è¡Œå®Œæˆä¹‹ååœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆ<code>best.transd.onnx</code>æ¨¡å‹ï¼Œè¯¥æ¨¡å‹æ·»åŠ äº†TransposeèŠ‚ç‚¹ã€‚</p> 
<pre><code class="prism language-shell">python v8trans.py best.onnx
</code></pre> 
<p>ä¸‹å›¾å¯¹æ¯”äº†åŸå§‹çš„best.onnxå’Œbest.transd.onnxä¹‹é—´çš„åŒºåˆ«ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºè½¬æ¢åçš„onnxæ¨¡å‹åœ¨è¾“å‡ºä¹‹å‰å¤šäº†ä¸€ä¸ªTransposeèŠ‚ç‚¹ï¼Œä¸”è¾“å‡ºçš„1ï¼Œ2ç»´åº¦è¿›è¡Œäº†äº¤æ¢ï¼Œç¬¦åˆ<strong>infer</strong>æ¡†æ¶ã€‚</p> 
<p><img src="https://images2.imgbox.com/2c/2f/XrrE2Tqy_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h6><a id="312_Resize_457"></a>3.1.2 ResizeèŠ‚ç‚¹è§£æçš„é—®é¢˜</h6> 
<p>å…ˆå‰§é€ä¸‹ï¼Œå½“ä½¿ç”¨<strong>trtexec</strong>å·¥å…·æ„å»ºengineæ—¶ä¼šå‡ºç°é”™è¯¯ï¼Œæˆ‘ä»¬ä¸€å¹¶è§£å†³ï¼Œåˆ°æ—¶å€™å¯ç›´æ¥ç”Ÿæˆengineï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯è¯´Resize_120è¿™ä¸ªèŠ‚ç‚¹çš„scalesæ²¡æœ‰åˆå§‹åŒ–(åº”è¯¥æ˜¯è¿™æ ·ç†è§£çš„å§ğŸ¤”)</p> 
<p><img src="https://images2.imgbox.com/b9/26/6lKSPeQM_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>æˆ‘ä»¬å…ˆé€šè¿‡<a href="https://netron.app/" rel="nofollow">Netron</a>å·¥å…·æ‰“å¼€<code>best.transd.onnx</code>æ¨¡å‹æŸ¥çœ‹ä¸‹Resize_120è¿™ä¸ªèŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯ï¼Œåœ¨æ‰¾æ‰¾å…¶å®ƒçš„ResizeèŠ‚ç‚¹å¯¹æ¯”çœ‹çœ‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå·¦è¾¹æ˜¯Resize_103èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯ï¼Œå³è¾¹æ˜¯Resize_120èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°å…¶å¯¹åº”çš„Scalesç¡®å®å­˜åœ¨åŒºåˆ«ï¼ŒResize_120èŠ‚ç‚¹Scalesæ²¡æœ‰initializerï¼Œæ²¡æœ‰æ˜ç¡®çš„å€¼ã€‚</p> 
<p><img src="https://images2.imgbox.com/61/33/5L1hqa1n_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ä¸‹é¢æ¥çœ‹è§£å†³æ–¹æ¡ˆï¼Œæä¾›ä¸¤ç§</p> 
<p><strong>è§£å†³æ–¹æ¡ˆ1-onnxsim(æ¨è)</strong></p> 
<p>onnxoptimizerã€onnxsimè¢«èª‰ä¸ºonnxçš„ä¼˜åŒ–åˆ©å™¨ï¼Œå…¶ä¸­onnxsimå¯ä»¥ä¼˜åŒ–å¸¸é‡ï¼Œonnxoptimizerå¯ä»¥å¯¹èŠ‚ç‚¹è¿›è¡Œå‹ç¼©ï¼Œå‚è€ƒè‡ª<a href="https://www.codetd.com/article/14303045" rel="nofollow">onnxoptimizerã€onnxsimä½¿ç”¨è®°å½•</a>ã€‚æ–°å»ºä¸€ä¸ª<code>v8onnxsim.py</code>æ–‡ä»¶ï¼Œç”¨äºä¼˜åŒ–onnxæ–‡ä»¶ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> onnx
<span class="token keyword">from</span> onnxsim <span class="token keyword">import</span> simplify

onnx_model <span class="token operator">=</span> onnx<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">"best.transd.onnx"</span><span class="token punctuation">)</span>
model_simp<span class="token punctuation">,</span> check <span class="token operator">=</span> simplify<span class="token punctuation">(</span>onnx_model<span class="token punctuation">)</span>
<span class="token keyword">assert</span> check<span class="token punctuation">,</span> <span class="token string">"Simplified ONNX model could not be Validated"</span>
onnx<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model_simp<span class="token punctuation">,</span> <span class="token string">"best.trand.sim.onnx"</span><span class="token punctuation">)</span>
</code></pre> 
<p>è¿è¡Œåä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ç”Ÿæˆä¸€ä¸ª<code>best.transd.sim.onnx</code>æ¨¡å‹ï¼Œç°åœ¨å¯ä»¥æŸ¥çœ‹å¯¹åº”çš„Resize_120èŠ‚ç‚¹å‘ç”Ÿäº†æ”¹å˜</p> 
<p><img src="https://images2.imgbox.com/ec/18/tKGDeP2D_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>è§£å†³æ–¹æ¡ˆ2-è‡ªå·±åŠ¨æ‰‹</strong></p> 
<p>ä¿—è¯è¯´è‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿï¼Œçœ‹äº†onnxsimä¼˜åŒ–çš„ç»“æœï¼Œçªç„¶æœ‰ç§è‡ªå·±åŠ¨æ‰‹æ“ä½œçš„æ¬²æœ›(PS:å¤§å®¶çœ‹ä¸ªçƒ­é—¹å³å¯ğŸ˜™)ã€‚ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š</p> 
<ul><li>1.åŠ è½½ONNXæ¨¡å‹</li><li>2.éå†æ¨¡å‹çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œæ‰¾åˆ°è¦æ“ä½œçš„Resize_120</li><li>3.ä¿®æ”¹å…¶è¾“å…¥ä»onnx::Resize_432å˜æˆonnx::Resize_431</li><li>4.åˆ é™¤Identit_2èŠ‚ç‚¹</li><li>5.ä¿å­˜æ¨¡å‹</li></ul> 
<p>åœ¨å½“å‰ç›®å½•ä¸‹æ–°å»º<code>v8Resize.py</code>æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-python">
<span class="token keyword">import</span> onnx
<span class="token keyword">import</span> onnx<span class="token punctuation">.</span>helper <span class="token keyword">as</span> helper
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> os

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># 1.åŠ è½½ONNXæ¨¡å‹æ–‡ä»¶</span>
    model <span class="token operator">=</span> onnx<span class="token punctuation">.</span>load<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
    resize_node <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token comment"># 2.éå†æ¨¡å‹çš„æ‰€æœ‰èŠ‚ç‚¹ï¼ŒæŸ¥æ‰¾resizeèŠ‚ç‚¹</span>
    <span class="token comment"># Resize_103 Resize_120</span>
    <span class="token keyword">for</span> node <span class="token keyword">in</span> model<span class="token punctuation">.</span>graph<span class="token punctuation">.</span>node<span class="token punctuation">:</span>
        <span class="token keyword">if</span> node<span class="token punctuation">.</span>op_type <span class="token operator">==</span> <span class="token string">"Resize"</span> <span class="token keyword">and</span> node<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">"Resize_120"</span><span class="token punctuation">:</span>
            resize_node <span class="token operator">=</span> node
            <span class="token keyword">break</span>

    <span class="token keyword">if</span> resize_node <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"Resize node not found in the model."</span><span class="token punctuation">)</span>

    <span class="token comment"># 3.ä¿®æ”¹è¾“å…¥</span>
    resize_node<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"onnx::Resize_431"</span>

    <span class="token comment"># 4.åˆ é™¤Identity_2èŠ‚ç‚¹</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>graph<span class="token punctuation">.</span>node<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> model<span class="token punctuation">.</span>graph<span class="token punctuation">.</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">"Identity_2"</span><span class="token punctuation">:</span>
            <span class="token keyword">del</span> model<span class="token punctuation">.</span>graph<span class="token punctuation">.</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            <span class="token keyword">break</span>

    <span class="token comment"># 5.ä¿å­˜æ–°æ¨¡å‹</span>
    onnx<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model<span class="token punctuation">,</span> <span class="token string">"best.transd.my.onnx"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"new model save done."</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    file_path <span class="token operator">=</span> <span class="token string">"./best.transd.onnx"</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>main<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>è¿è¡Œè¯¥æ–‡ä»¶åä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆ<code>best.transd.my.onnx</code>æ¨¡å‹ï¼Œç°åœ¨å¯ä»¥æŸ¥çœ‹å¯¹åº”çš„Resize_120èŠ‚ç‚¹å‘ç”Ÿäº†æ”¹å˜<br> <img src="https://images2.imgbox.com/59/e9/aR4wPJgN_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>è‡³æ­¤ï¼Œé™æ€batchæ¨¡å‹å¯¼å‡ºå‘Šä¸€æ®µè½ï¼Œåç»­é€šè¿‡<code>trtexec</code>å·¥å…·å¯æ­£å¸¸ç”Ÿæˆengineæ–‡ä»¶äº†ï¼Œä¸»è¦è§£å†³ä¸¤ä¸ªæ–¹é¢çš„é—®é¢˜ï¼Œä¸€æ˜¯è¾“å‡ºå¿…é¡»åŠ ä¸€ä¸ªTransposeè½¬æ¢ï¼ŒäºŒæ˜¯è§£å†³ResizeèŠ‚ç‚¹æ— æ³•è§£æé—®é¢˜ã€‚</p> 
<h5><a id="32_batch_545"></a>3.2 åŠ¨æ€batchå¯¼å‡º</h5> 
<h6><a id="321_exporterpy_547"></a>3.2.1 exporter.pyä¿®æ”¹</h6> 
<p>åŠ¨æ€batchçš„å¯¼å‡ºéœ€è¦ä¿®æ”¹<strong>ultralytics/yolo/engine/exporter.py</strong>æ–‡ä»¶ç¬¬303è¡Œçš„å†…å®¹ï¼Œç¡®ä¿å¯¼å‡ºçš„batchæŒ‡å®šä¸ºåŠ¨æ€ï¼Œå…¶å®ƒç»´åº¦ä¸æŒ‡å®šï¼Œä¿®æ”¹çš„å†…å®¹å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># -----exporter.pyç¬¬303è¡Œ-----</span>
<span class="token comment"># dynamic = self.args.dynamic</span>
<span class="token comment"># if dynamic:</span>
<span class="token comment">#     dynamic = {'images': {0: 'batch', 2: 'height', 3: 'width'}}  # shape(1,3,640,640)</span>
<span class="token comment">#     if isinstance(self.model, SegmentationModel):</span>
<span class="token comment">#         dynamic['output0'] = {0: 'batch', 1: 'anchors'}  # shape(1,25200,85)</span>
<span class="token comment">#         dynamic['output1'] = {0: 'batch', 2: 'mask_height', 3: 'mask_width'}  # shape(1,32,160,160)</span>
<span class="token comment">#     elif isinstance(self.model, DetectionModel):</span>
<span class="token comment">#         dynamic['output0'] = {0: 'batch', 1: 'anchors'}  # shape(1,25200,85)</span>

<span class="token comment"># -----ä¿®æ”¹ä¸ºå¦‚ä¸‹ä»£ç -----</span>
dynamic <span class="token operator">=</span> self<span class="token punctuation">.</span>args<span class="token punctuation">.</span>dynamic
dynamic <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">if</span> dynamic<span class="token punctuation">:</span>
    dynamic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'images'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'batch'</span><span class="token punctuation">}</span><span class="token punctuation">}</span>  <span class="token comment"># shape(1,3,640,640)</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>model<span class="token punctuation">,</span> SegmentationModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
        dynamic<span class="token punctuation">[</span><span class="token string">'output0'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'batch'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'anchors'</span><span class="token punctuation">}</span>  <span class="token comment"># shape(1,25200,85)</span>
        dynamic<span class="token punctuation">[</span><span class="token string">'output1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'batch'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">'mask_height'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">'mask_width'</span><span class="token punctuation">}</span>  <span class="token comment"># shape(1,32,160,160)</span>
    <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>model<span class="token punctuation">,</span> DetectionModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
        dynamic<span class="token punctuation">[</span><span class="token string">'output0'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'batch'</span><span class="token punctuation">}</span>  <span class="token comment"># shape(1,25200,85)</span>
</code></pre> 
<p>ç„¶åå°†è®­ç»ƒå¥½çš„å£ç½©è¯†åˆ«æƒé‡<code>best.pt</code>æ”¾åœ¨ultralytics-mainç›®å½•ä¸‹ï¼Œæ–°å»ºå¯¼å‡ºæ–‡ä»¶<strong>export.py</strong>ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œæ‰§è¡Œå®Œæˆåå°†ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆå¯¼å‡ºçš„<code>best.onnx</code>æ¨¡å‹</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> ultralytics <span class="token keyword">import</span> YOLO

model <span class="token operator">=</span> YOLO<span class="token punctuation">(</span><span class="token string">"best.pt"</span><span class="token punctuation">)</span>

success <span class="token operator">=</span> model<span class="token punctuation">.</span>export<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'onnx'</span><span class="token punctuation">,</span> batch<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>å¯¼å‡ºçš„onnxæ¨¡å‹å¦‚ä¸‹ï¼š</p> 
<p><img src="https://images2.imgbox.com/5e/08/EiktwIjM_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h6><a id="322_Transpose_588"></a>3.2.2 TransposeèŠ‚ç‚¹æ·»åŠ </h6> 
<p>ç”±äº<strong>infer</strong>æ¡†æ¶åªæ”¯æŒ[1,8400,6]è¿™ç§å½¢å¼çš„è¾“å‡ºï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨åŸå§‹onnxä¹‹å‰æ·»åŠ ä¸€ä¸ª<strong>Transpose</strong>èŠ‚ç‚¹ï¼Œ<strong>infer</strong>ä»“åº“workspace/v8trans.pyå°±æ˜¯å¸®æˆ‘ä»¬åšè¿™ä¹ˆä¸€ä»¶äº‹æƒ…ï¼Œv8trans.pyå…·ä½“å†…å®¹å¯å‚è€ƒ3.1.1å°èŠ‚ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p> 
<h6><a id="323_Resize_592"></a>3.2.3 ResizeèŠ‚ç‚¹è§£æçš„é—®é¢˜</h6> 
<p>åŒæ ·çš„å½“ä½¿ç”¨<strong>trtexec</strong>å·¥å…·æ„å»ºengineæ—¶ï¼Œä¼šå‡ºç°ResizeèŠ‚ç‚¹è§£æé”™è¯¯</p> 
<p><img src="https://images2.imgbox.com/da/cf/yqDrpNDT_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>åºŸè¯å°‘è¯´ï¼Œç›´æ¥ä¸Šè§£å†³æ–¹æ¡ˆ</p> 
<p><strong>è§£å†³æ–¹æ¡ˆ1-onnxsim</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> onnx
<span class="token keyword">from</span> onnxsim <span class="token keyword">import</span> simplify

onnx_model <span class="token operator">=</span> onnx<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">"best.onnx"</span><span class="token punctuation">)</span>
model_simp<span class="token punctuation">,</span> check <span class="token operator">=</span> simplify<span class="token punctuation">(</span>onnx_model<span class="token punctuation">)</span>
<span class="token keyword">assert</span> check<span class="token punctuation">,</span> <span class="token string">"Simplified ONNX model could not be Validated"</span>
onnx<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model_simp<span class="token punctuation">,</span> <span class="token string">"best.sim.onnx"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>è§£å†³æ–¹æ¡ˆ2-è‡ªå·±åŠ¨æ‰‹</strong></p> 
<pre><code class="prism language-python">
<span class="token keyword">import</span> onnx
<span class="token keyword">import</span> onnx<span class="token punctuation">.</span>helper <span class="token keyword">as</span> helper
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> os

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># 1.åŠ è½½ONNXæ¨¡å‹æ–‡ä»¶</span>
    model <span class="token operator">=</span> onnx<span class="token punctuation">.</span>load<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
    resize_node <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token comment"># 2.éå†æ¨¡å‹çš„æ‰€æœ‰èŠ‚ç‚¹ï¼ŒæŸ¥æ‰¾resizeèŠ‚ç‚¹</span>
    <span class="token comment"># Resize_106 Resize_123</span>
    <span class="token keyword">for</span> node <span class="token keyword">in</span> model<span class="token punctuation">.</span>graph<span class="token punctuation">.</span>node<span class="token punctuation">:</span>
        <span class="token keyword">if</span> node<span class="token punctuation">.</span>op_type <span class="token operator">==</span> <span class="token string">"Resize"</span> <span class="token keyword">and</span> node<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">"Resize_123"</span><span class="token punctuation">:</span>
            resize_node <span class="token operator">=</span> node
            <span class="token keyword">break</span>

    <span class="token keyword">if</span> resize_node <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"Resize node not found in the model."</span><span class="token punctuation">)</span>

    <span class="token comment"># 3.ä¿®æ”¹è¾“å…¥</span>
    resize_node<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"onnx::Resize_437"</span>

    <span class="token comment"># 4.åˆ é™¤Identity_5èŠ‚ç‚¹</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>graph<span class="token punctuation">.</span>node<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> model<span class="token punctuation">.</span>graph<span class="token punctuation">.</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">"Identity_5"</span><span class="token punctuation">:</span>
            <span class="token keyword">del</span> model<span class="token punctuation">.</span>graph<span class="token punctuation">.</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            <span class="token keyword">break</span>

    <span class="token comment"># 5.ä¿å­˜æ–°æ¨¡å‹</span>
    onnx<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model<span class="token punctuation">,</span> <span class="token string">"best.my.onnx"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"new model save done."</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    file_path <span class="token operator">=</span> <span class="token string">"./best.onnx"</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>main<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>è‡³æ­¤ï¼Œæ¨¡å‹å¯¼å‡ºå·²ç»å®Œæ¯•ï¼Œåç»­é€šè¿‡å¯¼å‡ºçš„æ¨¡å‹å®Œæˆåœ¨jetson nanoä¸Šçš„éƒ¨ç½²å·¥ä½œï¼Œå¯¼å‡ºçš„æ¨¡å‹æ–‡ä»¶å¯ç‚¹å‡»<a href="https://pan.baidu.com/s/193prud3xw-SmG8ercjZlug" rel="nofollow">here[pwd:yolo]</a>ä¸‹è½½</p> 
<h4><a id="4__657"></a>4. è¿è¡Œ</h4> 
<h5><a id="41_engine_659"></a>4.1 engineç”Ÿæˆ</h5> 
<p>ä¸tensorRT_Proæ¨¡å‹æ„å»ºæ–¹å¼ä¸åŒï¼Œinferæ¡†æ¶ç›´æ¥é€šè¿‡trtexecå·¥å…·ç”Ÿæˆengineï¼Œ<strong>infer</strong>æ¡†æ¶æ‹¥æœ‰ä¸€ä¸ªå…¨æ–°çš„tensorrtå°è£…ï¼Œå¯è½»æ˜“ç»§æ‰¿å„ç±»ä»»åŠ¡ï¼Œç›¸æ¯”äºtensorRT_Proä¼˜ç‚¹å¦‚ä¸‹ï¼š</p> 
<ul><li>è½»æ˜“å®ç°å„ç±»ä»»åŠ¡çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å‹ï¼Œå¹¶è¿›è¡Œé«˜æ€§èƒ½æ¨ç†</li><li>æ²¡æœ‰å¤æ‚çš„å°è£…ï¼Œå½»åº•è§£å¼€è€¦åˆ!</li><li>å‚è€ƒè‡ª<a href="https://www.bilibili.com/video/BV1F24y1h7LW/?spm_id_from=333.999.0.0&amp;vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">å¦‚ä½•é«˜æ•ˆä½¿ç”¨TensorRT</a></li></ul> 
<p>å°†ç¬¬3èŠ‚å¯¼å‡ºçš„ONNXæ¨¡å‹æ”¾å…¥åˆ°infer/workspaceæ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶ååœ¨jetson nanoç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤(<strong>ä»¥å¯¼å‡ºçš„é™æ€batchæ¨¡å‹ä¸ºä¾‹</strong>)</p> 
<pre><code class="prism language-css">trtexec --onnx=workspace/best.transd.sim.onnx --saveEngine=workspace/best.transd.sim.engine
</code></pre> 
<p>å›¾è§£å¦‚ä¸‹æ‰€ç¤º(PS:æ¨¡å‹æ„æ¶éœ€è¦ä¸€æ®µæ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…)</p> 
<p><img src="https://images2.imgbox.com/71/25/Vj1yByeh_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>æ¨¡å‹æ„å»ºå®Œæˆåå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œengineæ‹¿åˆ°æ‰‹åå°±å¯ä»¥å¼€å¹²äº†ğŸ‘¨â€ğŸ­</p> 
<p><img src="https://images2.imgbox.com/0e/5c/sq5ospIZ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <strong>æ³¨</strong>ï¼š<strong>å¯¼å‡ºåŠ¨æ€batchæ¨¡å‹æ‰§è¡Œçš„æŒ‡ä»¤ä¸é™æ€batchä¸åŒ</strong>ï¼ï¼ï¼ï¼Œå…·ä½“å¯å‚è€ƒinfer/workspace/build.shæ–‡ä»¶ä¸­çš„å†…å®¹ï¼ŒæŒ‡ä»¤å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-css">trtexec --onnx=best.transd.sim.onnx --minShapes=<span class="token property">images</span><span class="token punctuation">:</span>1x3x640x640 --maxShapes=<span class="token property">images</span><span class="token punctuation">:</span>16x3x640x640 --optShapes=<span class="token property">images</span><span class="token punctuation">:</span>1x3x640x640 --saveEngine=best.transd.sim.engine
</code></pre> 
<h5><a id="42__685"></a>4.2 æºç ä¿®æ”¹</h5> 
<blockquote> 
 <p>yoloæ¨¡å‹çš„æ¨ç†ä»£ç ä¸»è¦åœ¨<code>src/main.cpp</code>æ–‡ä»¶ä¸­ï¼Œéœ€è¦æ¨ç†çš„å›¾ç‰‡æ”¾åœ¨<code>workspace/inference</code>æ–‡ä»¶å¤¹ä¸­ï¼Œæºç ä¿®æ”¹è¾ƒç®€å•ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p> 
</blockquote> 
<ul><li> <p><strong>1.main.cpp 134ï¼Œ135è¡Œæ³¨é‡Šï¼Œåªè¿›è¡Œå•å¼ å›¾ç‰‡çš„æ¨ç†</strong></p> </li><li> <p><strong>2.main.cpp 104è¡Œ ä¿®æ”¹åŠ è½½çš„æ¨¡å‹ä¸ºbest.transd.sim.engineä¸”ç±»å‹ä¸ºV8</strong></p> </li><li> <p><strong>3.main.cpp 10è¡Œ æ–°å¢mylabelsæ•°ç»„ï¼Œæ·»åŠ è‡ªè®­ç»ƒæ¨¡å‹çš„ç±»åˆ«åç§°</strong></p> </li><li> <p><strong>4.mian.cpp 115è¡Œ cocolabelsä¿®æ”¹ä¸ºmylabels</strong></p> </li></ul> 
<p>å…·ä½“ä¿®æ”¹å¦‚ä¸‹</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// perf();					//ä¿®æ”¹1 134 135è¡Œæ³¨é‡Š</span>
  <span class="token comment">// batch_inference();			</span>
  <span class="token function">single_inference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">auto</span> yolo <span class="token operator">=</span> yolo<span class="token double-colon punctuation">::</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">"best.transd.sim.engine"</span><span class="token punctuation">,</span> yolo<span class="token double-colon punctuation">::</span>Type<span class="token double-colon punctuation">::</span>V8<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//  ä¿®æ”¹2</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>mylabels<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"have_mask"</span><span class="token punctuation">,</span> <span class="token string">"no_mask"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>	<span class="token comment">// ä¿®æ”¹3 æ–°å¢mylabelsæ•°ç»„</span>

<span class="token keyword">auto</span> name <span class="token operator">=</span> mylabels<span class="token punctuation">[</span>obj<span class="token punctuation">.</span>class_label<span class="token punctuation">]</span>		<span class="token comment">// ä¿®æ”¹4 cocolabelsä¿®æ”¹ä¸ºmylabels</span>
</code></pre> 
<h5><a id="43__713"></a>4.3 ç¼–è¯‘è¿è¡Œ</h5> 
<p>ç¼–è¯‘ç”¨åˆ°çš„Makefileæ–‡ä»¶éœ€è¦ä¿®æ”¹ï¼Œä¿®æ”¹åçš„Makefileæ–‡ä»¶å¦‚ä¸‹ï¼Œè¯¦ç»†çš„Makefileæ–‡ä»¶çš„åˆ†æå¯æŸ¥çœ‹<a href="https://blog.csdn.net/qq_40672115/article/details/129795117?spm=1001.2014.3001.5502">Mkaefileå®æˆ˜</a></p> 
<pre><code class="prism language-cpp">cc        <span class="token operator">:</span><span class="token operator">=</span> g<span class="token operator">++</span>
nvcc      <span class="token operator">=</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>cuda<span class="token operator">-</span><span class="token number">10.2</span><span class="token operator">/</span>bin<span class="token operator">/</span>nvcc

cpp_srcs  <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>shell find src <span class="token operator">-</span>name <span class="token string">"*.cpp"</span><span class="token punctuation">)</span>
cpp_objs  <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>cpp_srcs<span class="token operator">:</span><span class="token punctuation">.</span>cpp<span class="token operator">=</span><span class="token punctuation">.</span>cpp<span class="token punctuation">.</span>o<span class="token punctuation">)</span>
cpp_objs  <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>cpp_objs<span class="token operator">:</span>src<span class="token operator">/</span><span class="token operator">%=</span>objs<span class="token operator">/</span><span class="token operator">%</span><span class="token punctuation">)</span>
cpp_mk	  <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>cpp_objs<span class="token operator">:</span><span class="token punctuation">.</span>cpp<span class="token punctuation">.</span>o<span class="token operator">=</span><span class="token punctuation">.</span>cpp<span class="token punctuation">.</span>mk<span class="token punctuation">)</span>

cu_srcs	  <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>shell find src <span class="token operator">-</span>name <span class="token string">"*.cu"</span><span class="token punctuation">)</span>
cu_objs   <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>cu_srcs<span class="token operator">:</span><span class="token punctuation">.</span>cu<span class="token operator">=</span><span class="token punctuation">.</span>cu<span class="token punctuation">.</span>o<span class="token punctuation">)</span>
cu_objs	  <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>cu_objs<span class="token operator">:</span>src<span class="token operator">/</span><span class="token operator">%=</span>objs<span class="token operator">/</span><span class="token operator">%</span><span class="token punctuation">)</span>
cu_mk	  <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>cu_objs<span class="token operator">:</span><span class="token punctuation">.</span>cu<span class="token punctuation">.</span>o<span class="token operator">=</span><span class="token punctuation">.</span>cu<span class="token punctuation">.</span>mk<span class="token punctuation">)</span>

include_paths <span class="token operator">:</span><span class="token operator">=</span> src        \
			<span class="token operator">/</span>usr<span class="token operator">/</span>include<span class="token operator">/</span>opencv4 \
			<span class="token operator">/</span>usr<span class="token operator">/</span>include<span class="token operator">/</span>aarch64<span class="token operator">-</span>linux<span class="token operator">-</span>gnu \
			<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>cuda<span class="token operator">-</span><span class="token number">10.2</span><span class="token operator">/</span>include

library_paths <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>aarch64<span class="token operator">-</span>linux<span class="token operator">-</span>gnu \
			<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>cuda<span class="token operator">-</span><span class="token number">10.2</span><span class="token operator">/</span>lib64

link_librarys <span class="token operator">:</span><span class="token operator">=</span> opencv_core opencv_highgui opencv_imgproc opencv_videoio opencv_imgcodecs \
			nvinfer nvinfer_plugin nvonnxparser \
			cuda cublas cudart cudnn \
			stdc<span class="token operator">++</span> dl

empty		  <span class="token operator">:</span><span class="token operator">=</span>
export_path   <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>subst $<span class="token punctuation">(</span>empty<span class="token punctuation">)</span> $<span class="token punctuation">(</span>empty<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span>$<span class="token punctuation">(</span>library_paths<span class="token punctuation">)</span><span class="token punctuation">)</span>

run_paths     <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>foreach item<span class="token punctuation">,</span>$<span class="token punctuation">(</span>library_paths<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span>Wl<span class="token punctuation">,</span><span class="token operator">-</span>rpath<span class="token operator">=</span>$<span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
include_paths <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>foreach item<span class="token punctuation">,</span>$<span class="token punctuation">(</span>include_paths<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span>I$<span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
library_paths <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>foreach item<span class="token punctuation">,</span>$<span class="token punctuation">(</span>library_paths<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span>L$<span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
link_librarys <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>foreach item<span class="token punctuation">,</span>$<span class="token punctuation">(</span>link_librarys<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span>l$<span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>

cpp_compile_flags <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">-</span>std<span class="token operator">=</span>c<span class="token operator">++</span><span class="token number">11</span> <span class="token operator">-</span>fPIC <span class="token operator">-</span>w <span class="token operator">-</span>g <span class="token operator">-</span>pthread <span class="token operator">-</span>fopenmp <span class="token operator">-</span>O0
cu_compile_flags  <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">-</span>std<span class="token operator">=</span>c<span class="token operator">++</span><span class="token number">11</span> <span class="token operator">-</span>g <span class="token operator">-</span>w <span class="token operator">-</span>O0 <span class="token operator">-</span>Xcompiler <span class="token string">"$(cpp_compile_flags)"</span>
link_flags        <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">-</span>pthread <span class="token operator">-</span>fopenmp <span class="token operator">-</span>Wl<span class="token punctuation">,</span><span class="token operator">-</span>rpath<span class="token operator">=</span><span class="token char">'$$ORIGIN'</span>

cpp_compile_flags <span class="token operator">+=</span> $<span class="token punctuation">(</span>include_paths<span class="token punctuation">)</span>
cu_compile_flags  <span class="token operator">+=</span> $<span class="token punctuation">(</span>include_paths<span class="token punctuation">)</span>
link_flags        <span class="token operator">+=</span> $<span class="token punctuation">(</span>library_paths<span class="token punctuation">)</span> $<span class="token punctuation">(</span>link_librarys<span class="token punctuation">)</span> $<span class="token punctuation">(</span>run_paths<span class="token punctuation">)</span>

<span class="token function">ifneq</span> <span class="token punctuation">(</span>$<span class="token punctuation">(</span>MAKECMDGOALS<span class="token punctuation">)</span><span class="token punctuation">,</span> clean<span class="token punctuation">)</span>
<span class="token operator">-</span>include $<span class="token punctuation">(</span>cpp_mk<span class="token punctuation">)</span> $<span class="token punctuation">(</span>cu_mk<span class="token punctuation">)</span>
endif

pro	   <span class="token operator">:</span><span class="token operator">=</span> workspace<span class="token operator">/</span>pro
expath <span class="token operator">:</span><span class="token operator">=</span> library_path<span class="token punctuation">.</span>txt

library_path<span class="token punctuation">.</span>txt <span class="token operator">:</span> 
	@echo LD_LIBRARY_PATH<span class="token operator">=</span>$<span class="token punctuation">(</span>export_path<span class="token punctuation">)</span><span class="token operator">:</span><span class="token string">"$$"</span>LD_LIBRARY_PATH <span class="token operator">&gt;</span> $@

workspace<span class="token operator">/</span>pro <span class="token operator">:</span> $<span class="token punctuation">(</span>cpp_objs<span class="token punctuation">)</span> $<span class="token punctuation">(</span>cu_objs<span class="token punctuation">)</span>
		@echo Link $@
		@mkdir <span class="token operator">-</span>p $<span class="token punctuation">(</span>dir $@<span class="token punctuation">)</span>
		@$<span class="token punctuation">(</span>cc<span class="token punctuation">)</span> $<span class="token operator">^</span> <span class="token operator">-</span>o $@ $<span class="token punctuation">(</span>link_flags<span class="token punctuation">)</span>

objs<span class="token operator">/</span><span class="token operator">%</span><span class="token punctuation">.</span>cpp<span class="token punctuation">.</span>o <span class="token operator">:</span> src<span class="token operator">/</span><span class="token operator">%</span><span class="token punctuation">.</span>cpp
	@echo Compile CXX $<span class="token operator">&lt;</span>
	@mkdir <span class="token operator">-</span>p $<span class="token punctuation">(</span>dir $@<span class="token punctuation">)</span>
	@$<span class="token punctuation">(</span>cc<span class="token punctuation">)</span> <span class="token operator">-</span>c $<span class="token operator">&lt;</span> <span class="token operator">-</span>o $@ $<span class="token punctuation">(</span>cpp_compile_flags<span class="token punctuation">)</span>

objs<span class="token operator">/</span><span class="token operator">%</span><span class="token punctuation">.</span>cu<span class="token punctuation">.</span>o <span class="token operator">:</span> src<span class="token operator">/</span><span class="token operator">%</span><span class="token punctuation">.</span>cu
	@echo Compile CUDA $<span class="token operator">&lt;</span>
	@mkdir <span class="token operator">-</span>p $<span class="token punctuation">(</span>dir $@<span class="token punctuation">)</span>
	@$<span class="token punctuation">(</span>nvcc<span class="token punctuation">)</span> <span class="token operator">-</span>c $<span class="token operator">&lt;</span> <span class="token operator">-</span>o $@ $<span class="token punctuation">(</span>cu_compile_flags<span class="token punctuation">)</span>

objs<span class="token operator">/</span><span class="token operator">%</span><span class="token punctuation">.</span>cpp<span class="token punctuation">.</span>mk <span class="token operator">:</span> src<span class="token operator">/</span><span class="token operator">%</span><span class="token punctuation">.</span>cpp
	@echo Compile depends CXX $<span class="token operator">&lt;</span>
	@mkdir <span class="token operator">-</span>p $<span class="token punctuation">(</span>dir $@<span class="token punctuation">)</span>
	@$<span class="token punctuation">(</span>cc<span class="token punctuation">)</span> <span class="token operator">-</span>M $<span class="token operator">&lt;</span> <span class="token operator">-</span>MF $@ <span class="token operator">-</span>MT $<span class="token punctuation">(</span>@<span class="token operator">:</span><span class="token punctuation">.</span>cpp<span class="token punctuation">.</span>mk<span class="token operator">=</span><span class="token punctuation">.</span>cpp<span class="token punctuation">.</span>o<span class="token punctuation">)</span> $<span class="token punctuation">(</span>cpp_compile_flags<span class="token punctuation">)</span>
	
objs<span class="token operator">/</span><span class="token operator">%</span><span class="token punctuation">.</span>cu<span class="token punctuation">.</span>mk <span class="token operator">:</span> src<span class="token operator">/</span><span class="token operator">%</span><span class="token punctuation">.</span>cu
	@echo Compile depends CUDA $<span class="token operator">&lt;</span>
	@mkdir <span class="token operator">-</span>p $<span class="token punctuation">(</span>dir $@<span class="token punctuation">)</span>
	@$<span class="token punctuation">(</span>nvcc<span class="token punctuation">)</span> <span class="token operator">-</span>M $<span class="token operator">&lt;</span> <span class="token operator">-</span>MF $@ <span class="token operator">-</span>MT $<span class="token punctuation">(</span>@<span class="token operator">:</span><span class="token punctuation">.</span>cu<span class="token punctuation">.</span>mk<span class="token operator">=</span><span class="token punctuation">.</span>cu<span class="token punctuation">.</span>o<span class="token punctuation">)</span> $<span class="token punctuation">(</span>cu_compile_flags<span class="token punctuation">)</span>

run   <span class="token operator">:</span> workspace<span class="token operator">/</span>pro
		  @cd workspace <span class="token operator">&amp;&amp;</span> <span class="token punctuation">.</span><span class="token operator">/</span>pro

clean <span class="token operator">:</span>
	@rm <span class="token operator">-</span>rf objs workspace<span class="token operator">/</span>pro
	@rm <span class="token operator">-</span>rf library_path<span class="token punctuation">.</span>txt
	@rm <span class="token operator">-</span>rf workspace<span class="token operator">/</span>Result<span class="token punctuation">.</span>jpg

# å¯¼å‡ºç¬¦å·ï¼Œä½¿å¾—è¿è¡Œæ—¶èƒ½å¤Ÿé“¾æ¥ä¸Š
<span class="token keyword">export</span> LD_LIBRARY_PATH<span class="token operator">:</span><span class="token operator">=</span>$<span class="token punctuation">(</span>export_path<span class="token punctuation">)</span><span class="token operator">:</span>$<span class="token punctuation">(</span>LD_LIBRARY_PATH<span class="token punctuation">)</span>
</code></pre> 
<p>OK!æºç ä¹Ÿä¿®æ”¹å¥½äº†ï¼ŒMakefileæ–‡ä»¶ä¹Ÿæå®šäº†ï¼Œå¯ä»¥ç¼–è¯‘è¿è¡Œäº†ï¼Œç›´æ¥åœ¨ç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤å³å¯</p> 
<pre><code class="prism language-shell"><span class="token function">make</span> run
</code></pre> 
<p>å›¾è§£å¦‚ä¸‹æ‰€ç¤ºï¼š</p> 
<p><img src="https://images2.imgbox.com/ea/60/4daD1ZrY_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ç¼–è¯‘è¿è¡Œåçš„å°†åœ¨worksapceä¸‹ç”ŸæˆResult.jpgä¸ºæ¨ç†åçš„å›¾ç‰‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°æ•ˆæœè¿˜æ˜¯æ¯”è¾ƒOKçš„ã€‚</p> 
<p><img src="https://images2.imgbox.com/4b/b5/fno5ZYII_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/57/5b/8JNW4rM9_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h5><a id="44__825"></a>4.4 æ‹“å±•-æ‘„åƒå¤´æ£€æµ‹</h5> 
<blockquote> 
 <p>ç®€å•å†™äº†ä¸€ä¸ªæ‘„åƒå¤´æ£€æµ‹çš„demoï¼Œä¸»è¦ä¿®æ”¹ä»¥ä¸‹å‡ ç‚¹ï¼š</p> 
</blockquote> 
<ul><li> <p><strong>1.main.cpp æ–°å¢yolo_video_demo()å‡½æ•°ï¼Œå…·ä½“å†…å®¹å‚è€ƒä¸‹é¢</strong></p> </li><li> <p><strong>2.main.cpp æ–°å¢è°ƒç”¨yolo_video_demo()å‡½æ•°ä»£ç ï¼Œå…·ä½“å†…å®¹å‚è€ƒä¸‹é¢</strong></p> </li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">yolo_video_demo</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> engine_file<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>		<span class="token comment">// ä¿®æ”¹1 æ–°å¢å‡½æ•°</span>
  <span class="token keyword">auto</span> yolo <span class="token operator">=</span> yolo<span class="token double-colon punctuation">::</span><span class="token function">load</span><span class="token punctuation">(</span>engine_file<span class="token punctuation">,</span> yolo<span class="token double-colon punctuation">::</span>Type<span class="token double-colon punctuation">::</span>V8<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>yolo <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>  <span class="token keyword">return</span><span class="token punctuation">;</span>
  
  <span class="token comment">// auto remote_show = create_zmq_remote_show();</span>

  cv<span class="token double-colon punctuation">::</span>Mat frame<span class="token punctuation">;</span>
  cv<span class="token double-colon punctuation">::</span>VideoCapture <span class="token function">cap</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cap<span class="token punctuation">.</span><span class="token function">isOpened</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Engine is nullptr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    cap<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>frame<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">auto</span> objs <span class="token operator">=</span> yolo<span class="token operator">-&gt;</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token function">cvimg</span><span class="token punctuation">(</span>frame<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&amp;</span>obj <span class="token operator">:</span> objs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">uint8_t</span> b<span class="token punctuation">,</span> g<span class="token punctuation">,</span> r<span class="token punctuation">;</span>
      <span class="token function">tie</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> g<span class="token punctuation">,</span> r<span class="token punctuation">)</span> <span class="token operator">=</span> yolo<span class="token double-colon punctuation">::</span><span class="token function">random_color</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>class_label<span class="token punctuation">)</span><span class="token punctuation">;</span>
      cv<span class="token double-colon punctuation">::</span><span class="token function">rectangle</span><span class="token punctuation">(</span>frame<span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span><span class="token function">Point</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>left<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>top<span class="token punctuation">)</span><span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span><span class="token function">Point</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>right<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>bottom<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    cv<span class="token double-colon punctuation">::</span><span class="token function">Scalar</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> g<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
      <span class="token keyword">auto</span> name <span class="token operator">=</span> mylabels<span class="token punctuation">[</span>obj<span class="token punctuation">.</span>class_label<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">auto</span> caption <span class="token operator">=</span> cv<span class="token double-colon punctuation">::</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%s %.2f"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>confidence<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> width <span class="token operator">=</span> cv<span class="token double-colon punctuation">::</span><span class="token function">getTextSize</span><span class="token punctuation">(</span>caption<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
      cv<span class="token double-colon punctuation">::</span><span class="token function">rectangle</span><span class="token punctuation">(</span>frame<span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span><span class="token function">Point</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>left <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>top <span class="token operator">-</span> <span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    cv<span class="token double-colon punctuation">::</span><span class="token function">Point</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>left <span class="token operator">+</span> width<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>top<span class="token punctuation">)</span><span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span><span class="token function">Scalar</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> g<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      cv<span class="token double-colon punctuation">::</span><span class="token function">putText</span><span class="token punctuation">(</span>frame<span class="token punctuation">,</span> caption<span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span><span class="token function">Point</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>left<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>top <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span><span class="token class-name">Scalar</span><span class="token double-colon punctuation">::</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
      <span class="token function">imshow</span><span class="token punctuation">(</span><span class="token string">"frame"</span><span class="token punctuation">,</span> frame<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// remote_show-&gt;post(frame);</span>
      <span class="token keyword">int</span> key <span class="token operator">=</span> cv<span class="token double-colon punctuation">::</span><span class="token function">waitKey</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token number">27</span><span class="token punctuation">)</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  cap<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  cv<span class="token double-colon punctuation">::</span><span class="token function">destroyAllWindows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>	<span class="token comment">// ä¿®æ”¹2 è°ƒç”¨è¯¥å‡½æ•°</span>
  <span class="token comment">// perf();</span>
  <span class="token comment">// batch_inference();</span>
  <span class="token comment">// single_inference();</span>
  <span class="token function">yolo_video_demo</span><span class="token punctuation">(</span><span class="token string">"best.transd.sim.engine"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>ä¿®æ”¹å®Œæˆåæ‰§è¡Œmake runå³å¯çœ‹åˆ°å¯¹åº”çš„ç”»é¢æ˜¾ç¤ºäº†</p> 
<h5><a id="45_trtexec_887"></a>4.5 æ‹“å±•-trtexecå‚æ•°</h5> 
<p><strong>trtexec</strong>æ˜¯NVIDIA TensorRT SDKä¸­çš„ä¸€ä¸ªå®ç”¨å·¥å…·ï¼Œå®ƒå…è®¸ç”¨æˆ·ä»å‘½ä»¤è¡Œè½»æ¾è¿è¡Œå’Œæµ‹è¯•TensorRTå¼•æ“ã€‚trtexecå‘½ä»¤è¡Œå·¥å…·å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‚æ•°ï¼š</p> 
<pre><code class="prism language-css"><span class="token selector">./trtexec [-h] [--uff model.uff [model.uff ...]] [--onnx model.onnx] [--model=model.plan] [--deploy=&lt;deploy.prototxt&gt;] [--output=&lt;output_name&gt;] [--batch=N] [--device=N] [--workspace=N] [--fp16] [--int8] [--calib=&lt;dir&gt;] [--useDLA=N] [--allowGPUFallback] [--iterations=N] [--avgRuns=N] [--verbose] [--nshapes=N] [--optShapes=NxN ... NxN] [--minShapes=NxN ... NxN] [--maxShapes=NxN ... NxN] [--shapeInput=</span><span class="token punctuation">{<!-- --></span>0<span class="token punctuation">,</span>1<span class="token punctuation">,</span>2<span class="token punctuation">,</span>...<span class="token punctuation">}</span>] [--tacticSources] [--loadEngine=&lt;filename&gt;] [--saveEngine=&lt;filename&gt;] [--plugins=&lt;XML file&gt;] [--dumpOutput=&lt;filename&gt;] [--excludePlugin=&lt;name&gt;] [--start=&lt;tag&gt;] [--streams=N] [--batchTile] [--engine=&lt;filename&gt;] [--uffInput=input_name<span class="token punctuation">,</span>input_shape] [--uffNHWC] [--uffNCHW] [--uffHW=&lt;value&gt;] [--workspaceSize=&lt;size&gt;] [--buildOnly] [--engineFormat=&lt;format&gt;] [--refit] [--saveRefinedEngine=&lt;filename&gt;] [--calibrator=&lt;classname&gt;] [--detach] [--check] [--fp16Char] [--int8Calib=&lt;dir&gt;] [--int8IO] [--disableTensorCores] [--useSpinWait] [--shapes=&lt;shape&gt;] [--maxBatch=&lt;size&gt;]
</code></pre> 
<p>å…¶ä¸­ä¸€äº›é‡è¦çš„å‚æ•°å¦‚ä¸‹ï¼š</p> 
<ul><li><code>--uff</code>ï¼šæŒ‡å®šè¾“å…¥ä¸ºUFFæ¨¡å‹ï¼Œåé¢è·Ÿä¸Šæ¨¡å‹æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><code>--onnx</code>ï¼šæŒ‡å®šè¾“å…¥ä¸ºONNXæ¨¡å‹ï¼Œåé¢è·Ÿä¸Šæ¨¡å‹æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><code>--model</code>ï¼šæŒ‡å®šè¾“å…¥ä¸ºåºåˆ—åŒ–çš„å¼•æ“æ–‡ä»¶ï¼Œåé¢è·Ÿä¸Šæ–‡ä»¶è·¯å¾„ã€‚</li><li><code>--deploy</code>ï¼šæŒ‡å®šè¾“å…¥ä¸ºCaffe deployæ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><code>--output</code>ï¼šæŒ‡å®šè¾“å‡ºTensoråç§°ã€‚</li><li><code>--batch</code>ï¼šæŒ‡å®šæ‰§è¡Œæ¨ç†æ—¶æ¯ä¸ªbatchçš„å¤§å°ï¼Œé»˜è®¤ä¸º1ã€‚</li><li><code>--device</code>ï¼šæŒ‡å®šæ‰§è¡Œæ¨ç†çš„è®¾å¤‡ç¼–å·ï¼Œé»˜è®¤ä¸º0ã€‚</li><li><code>--workspace</code>ï¼šæŒ‡å®šGPUå†…å­˜çš„æœ€å¤§ä½¿ç”¨é‡ï¼Œé»˜è®¤ä¸º1GBã€‚</li><li><code>--fp16</code>ï¼šå¯ç”¨FP16ç²¾åº¦ï¼Œå¯æé«˜æ¨ç†æ€§èƒ½å’Œå‡å°‘å†…å­˜ä½¿ç”¨ã€‚</li><li><code>--int8</code>ï¼šå¯ç”¨INT8ç²¾åº¦ï¼Œå¯è¿›ä¸€æ­¥æé«˜æ¨ç†æ€§èƒ½å’Œå‡å°‘å†…å­˜ä½¿ç”¨ã€‚</li><li><code>--calib</code>ï¼šæŒ‡å®šINT8æ ¡å‡†æ•°æ®é›†çš„è·¯å¾„ã€‚</li><li><code>--useDLA</code>ï¼šæŒ‡å®šä½¿ç”¨å“ªä¸ªDLAï¼Œä»¥åŠåœ¨DLAä¸Šè¿è¡Œå“ªäº›å±‚ã€‚</li><li><code>--allowGPUFallback</code>ï¼šå¦‚æœä½¿ç”¨DLAï¼Œå½“æŸäº›å±‚æ— æ³•åœ¨DLAä¸Šè¿è¡Œæ—¶ï¼Œæ˜¯å¦å…è®¸å°†å…¶å›é€€åˆ°GPUã€‚</li><li><code>--iterations</code>ï¼šæŒ‡å®šæµ‹è¯•è¿­ä»£æ¬¡æ•°ã€‚</li><li><code>--avgRuns</code>ï¼šæŒ‡å®šå¹³å‡è¿è¡Œæ¬¡æ•°ã€‚</li><li><code>--verbose</code>ï¼šæ‰“å°æ›´è¯¦ç»†çš„è¾“å‡ºä¿¡æ¯ã€‚</li><li><code>--loadEngine</code>ï¼šæŒ‡å®šåŠ è½½çš„TensorRTå¼•æ“æ–‡ä»¶ï¼Œåé¢è·Ÿä¸Šæ–‡ä»¶è·¯å¾„</li><li><code>--saveEngine</code>ï¼šæŒ‡å®šç”Ÿæˆçš„TensorRTå¼•æ“æ–‡ä»¶ï¼Œåé¢è·Ÿä¸Šæ–‡ä»¶è·¯å¾„</li></ul> 
<h3><a id="_916"></a>ç»“è¯­</h3> 
<blockquote> 
 <p>æœ¬ç¯‡åšå®¢ä»‹ç»äº†å…³äºyolov8æ¨¡å‹è®­ç»ƒçš„æµç¨‹ï¼Œä»¥åŠåœ¨jetson nanoåµŒå…¥å¼ä¸Šçš„éƒ¨ç½²å·¥ä½œï¼Œå¹¶å®‰åˆ©äº†ä¸€ä¸ªå…¨æ–°çš„æ¨ç†éƒ¨ç½²æ¡†æ¶inferã€‚åšä¸»åœ¨è¿™é‡Œåªåšäº†æœ€åŸºç¡€çš„æ¼”ç¤ºï¼Œå¦‚æœæœ‰æ›´å¤šçš„éœ€æ±‚éœ€è¦å„ä½çœ‹å®˜è‡ªå·±å»æŒ–æ˜å•¦ğŸ˜„ã€‚æ„Ÿè°¢å„ä½çœ‹åˆ°æœ€åï¼Œåˆ›ä½œä¸æ˜“ï¼Œè¯»åæœ‰æ”¶è·çš„çœ‹å®˜è¯·å¸®å¿™ç‚¹ä¸ªğŸ‘â­ï¸ã€‚</p> 
</blockquote> 
<h3><a id="_920"></a>ä¸‹è½½é“¾æ¥</h3> 
<ul><li><a href="https://pan.baidu.com/s/1c50iU7PLwhJfAsCDYs9bvw" rel="nofollow">yolov8æºç [pwd:yolo]</a></li><li><a href="https://pan.baidu.com/s/1oeBugM-bqRN6QFnVgXi5HQ" rel="nofollow">å£ç½©è¯†åˆ«æ•°æ®é›†[password:yolo]</a></li><li><a href="https://pan.baidu.com/s/1u8SaxfJLXnHZoyAmHqculw" rel="nofollow">yolov8é¢„è®­ç»ƒæƒé‡[pwd:yolo]</a></li><li><a href="https://pan.baidu.com/s/193prud3xw-SmG8ercjZlug" rel="nofollow">yolov8å£ç½©è¯†åˆ«æƒé‡[pwd:yolo]</a></li><li><a href="https://pan.baidu.com/s/1T47jZ1AswHnaX32GOkqR_Q" rel="nofollow">inferæºç [pwd:yolo]</a></li><li><a href="https://pan.baidu.com/s/1RW8Z-EQK--NtPgIe6mmKIQ?_at_=1660636990470#list/path=%2F" rel="nofollow">JetPacké•œåƒ[password:nano]</a></li></ul> 
<h3><a id="_929"></a>å‚è€ƒ</h3> 
<ul><li> <p><a href="https://github.com/shouxieai/infer">infer</a></p> </li><li> <p><a href="https://blog.csdn.net/qq_40672115/category_11970990.html?spm=1001.2014.3001.5482">JetsonåµŒå…¥å¼ç³»åˆ—æ¨¡å‹éƒ¨ç½²æ•™ç¨‹</a></p> </li><li> <p><a href="https://blog.csdn.net/qq_37706472/article/details/128679699?spm=1001.2014.3001.5502">YOLOv8æœ€å¼ºæ“ä½œ.</a></p> </li><li> <p><a href="https://github.com/ultralytics/ultralytics">yolov8</a></p> </li><li> <p><a href="https://blog.csdn.net/didiaopao/article/details/119787139?spm=1001.2014.3001.5501">åˆ©ç”¨Anacondaå®‰è£…pytorchå’Œpaddleæ·±åº¦å­¦ä¹ ç¯å¢ƒ+pycharmå®‰è£…â€”å…é¢å¤–å®‰è£…CUDAå’Œcudnn(é€‚åˆå°ç™½çš„ä¿å§†çº§æ•™å­¦)</a></p> </li><li> <p><a href="https://www.bilibili.com/video/BV1i7411376y?spm_id_from=333.337.search-card.all.click&amp;vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">å£ç½©ä½©æˆ´è¯†åˆ«Demo</a></p> </li><li> <p><a href="https://www.bilibili.com/video/BV1kV411k7D8?vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">PASCAL VOC2012æ•°æ®é›†è®²è§£ä¸åˆ¶ä½œè‡ªå·±çš„æ•°æ®é›†</a></p> </li><li> <p><a href="https://blog.csdn.net/didiaopao/article/details/120022845?spm=1001.2014.3001.5502">ç›®æ ‡æ£€æµ‹â€”æ•°æ®é›†æ ¼å¼è½¬åŒ–åŠè®­ç»ƒé›†å’ŒéªŒè¯é›†åˆ’åˆ†</a></p> </li><li> <p><a href="https://zhuanlan.zhihu.com/p/339225116" rel="nofollow">Jetson NANOæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é€‰ï¼Ÿ</a></p> </li><li> <p><a href="https://blog.csdn.net/Max_ZhangJF/article/details/120966773">trtexecæ·»åŠ ç¯å¢ƒå˜é‡</a></p> </li><li> <p><a href="https://www.bilibili.com/video/BV15Y41167B5/?spm_id_from=333.999.0.0&amp;vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">YoloV8çš„åŠ¨æ€é™æ€batchå¦‚ä½•ç†è§£å’Œä½¿ç”¨</a></p> </li><li> <p><a href="https://www.codetd.com/article/14303045" rel="nofollow">onnxoptimizerã€onnxsimä½¿ç”¨è®°å½•</a></p> </li><li> <p><a href="https://www.bilibili.com/video/BV1F24y1h7LW/?spm_id_from=333.999.0.0&amp;vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">å¦‚ä½•é«˜æ•ˆä½¿ç”¨TensorRT</a></p> </li><li> <p><a href="https://www.bilibili.com/video/BV1i7411376y?spm_id_from=333.337.search-card.all.click&amp;vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">å£ç½©ä½©æˆ´è¯†åˆ«Demo</a></p> </li><li> <p><a href="https://www.bilibili.com/video/BV1kV411k7D8?vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">PASCAL VOC2012æ•°æ®é›†è®²è§£ä¸åˆ¶ä½œè‡ªå·±çš„æ•°æ®é›†</a></p> </li><li> <p><a href="https://blog.csdn.net/didiaopao/article/details/120022845?spm=1001.2014.3001.5502">ç›®æ ‡æ£€æµ‹â€”æ•°æ®é›†æ ¼å¼è½¬åŒ–åŠè®­ç»ƒé›†å’ŒéªŒè¯é›†åˆ’åˆ†</a></p> </li><li> <p><a href="https://zhuanlan.zhihu.com/p/339225116" rel="nofollow">Jetson NANOæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é€‰ï¼Ÿ</a></p> </li><li> <p><a href="https://blog.csdn.net/Max_ZhangJF/article/details/120966773">trtexecæ·»åŠ ç¯å¢ƒå˜é‡</a></p> </li><li> <p><a href="https://www.bilibili.com/video/BV15Y41167B5/?spm_id_from=333.999.0.0&amp;vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">YoloV8çš„åŠ¨æ€é™æ€batchå¦‚ä½•ç†è§£å’Œä½¿ç”¨</a></p> </li><li> <p><a href="https://www.codetd.com/article/14303045" rel="nofollow">onnxoptimizerã€onnxsimä½¿ç”¨è®°å½•</a></p> </li><li> <p><a href="https://www.bilibili.com/video/BV1F24y1h7LW/?spm_id_from=333.999.0.0&amp;vd_source=2306b3f342c070c8a11931c94eafa8e3" rel="nofollow">å¦‚ä½•é«˜æ•ˆä½¿ç”¨TensorRT</a></p> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8ac544ff1a373e498ddb53889e7ef630/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">HWè‡ªå­¦ï¼šè“é˜Ÿåˆçº§åˆ°ä¸­çº§</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d6d896b79f2a84ea39d30a38ce4910c0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">masm32 é“¾æ¥é—®é¢˜</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 èœé¸Ÿç¨‹åºå‘˜åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>