<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CNN&#43;SVM模型实现图形多分类任务（SVM替换softmax分类器） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CNN&#43;SVM模型实现图形多分类任务（SVM替换softmax分类器）" />
<meta property="og:description" content="目录
摘要
模型构建
读取数据集：
CNN模型构建：
模型结构：
训练模型：
结果对比分析：
结束：
摘要 为解决采用 softmax 作为卷积神经网络分类器导致图形分类识别模型泛化能力的不足，不能较好适用图像分类等问题，本次博客使用SVM代替CNN网络的softmax分类层，即CNN提取特征后利用SVM进行分类。为了验证模型更改后的效果，本次在随机构建的垃圾分类数据集上做了一个简单的验证性实验。以验证SVM替换softmax分类器正确进行图像分类的效果。
模型构建 垃圾图像数据为随机选择的一部分数据，总共2143张图片，6个类别。采用train_test_split函数进行随机分割数据，75%作为训练集，其他的作为测试集。为了加快训练速度，采用resize函数实现图像的缩小。这也是导致整体准确率不高的一个原因。
读取数据集： for imagePath in imagePaths: # load the image, pre-process it, and store it in the data list image = cv2.imread(imagePath) image = cv2.resize(image, (norm_size, norm_size)) image = img_to_array(image) data.append(image) # extract the class label from the image path and update the # labels list label = int(imagePath.split(os.path.sep)[-2]) labels.append(label) data = np.array(data, dtype=&#34;float&#34;) / 255." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/34c1460d6456f5fdc29d7bc7b4c3a120/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-03T01:19:40+08:00" />
<meta property="article:modified_time" content="2020-05-03T01:19:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CNN&#43;SVM模型实现图形多分类任务（SVM替换softmax分类器）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E6%91%98%E8%A6%81-toc" style="margin-left:40px;"><a href="#%E6%91%98%E8%A6%81" rel="nofollow">摘要</a></p> 
<p id="%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA-toc" style="margin-left:40px;"><a href="#%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA" rel="nofollow">模型构建</a></p> 
<p id="%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9A" rel="nofollow">读取数据集：</a></p> 
<p id="CNN%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA%EF%BC%9A-toc" style="margin-left:80px;"><a href="#CNN%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA%EF%BC%9A" rel="nofollow">CNN模型构建：</a></p> 
<p id="%E6%A8%A1%E5%9E%8B%E7%BB%93%E6%9E%84%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E6%A8%A1%E5%9E%8B%E7%BB%93%E6%9E%84%EF%BC%9A" rel="nofollow">模型结构：</a></p> 
<p id="%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B%EF%BC%9A" rel="nofollow">训练模型：</a></p> 
<p id="%E7%BB%93%E6%9E%9C%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E7%BB%93%E6%9E%9C%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90%EF%BC%9A" rel="nofollow">结果对比分析：</a></p> 
<p id="%E7%BB%93%E6%9D%9F%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%E7%BB%93%E6%9D%9F%EF%BC%9A" rel="nofollow">结束：</a></p> 
<h3 id="%E6%91%98%E8%A6%81">摘要</h3> 
<p>为解决采用 softmax 作为卷积神经网络分类器导致图形分类识别模型泛化能力的不足，不能较好适用图像分类等问题，本次博客使用SVM代替CNN网络的softmax分类层，即CNN提取特征后利用SVM进行分类。为了验证模型更改后的效果，本次在随机构建的垃圾分类数据集上做了一个简单的验证性实验。以验证SVM替换softmax分类器正确进行图像分类的效果。</p> 
<h3 id="%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA">模型构建</h3> 
<p>垃圾图像数据为随机选择的一部分数据，总共2143张图片，6个类别。采用train_test_split函数进行随机分割数据，75%作为训练集，其他的作为测试集。为了加快训练速度，采用resize函数实现图像的缩小。这也是导致整体准确率不高的一个原因。</p> 
<h4 id="%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9A">读取数据集：</h4> 
<pre><code> for imagePath in imagePaths:
        # load the image, pre-process it, and store it in the data list
        image = cv2.imread(imagePath)
        image = cv2.resize(image, (norm_size, norm_size))
        image = img_to_array(image)
        data.append(image)

        # extract the class label from the image path and update the
        # labels list
        label = int(imagePath.split(os.path.sep)[-2])
        labels.append(label)

    data = np.array(data, dtype="float") / 255.0
    labels = np.array(labels)
    (trainX, testX, trainY, testY) = train_test_split(data,labels, test_size=0.25, random_state=42)
    # convert the labels from integers to vectors
    trainY = to_categorical(trainY, num_classes=CLASS_NUM)
    trainY = np.array(trainY)
    trainY = np.argmax(trainY, axis=1)

    testY = to_categorical(testY, num_classes=CLASS_NUM)
    testY = np.array(testY)
    testY = np.argmax(testY, axis=1)</code></pre> 
<h4 id="CNN%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA%EF%BC%9A">CNN模型构建：</h4> 
<pre><code> model = Sequential()
        inputShape = (64, 64, 3)
        model.add(Conv2D(20, (5, 5), padding="same", input_shape=inputShape))
        model.add(Activation("relu"))
        model.add(MaxPooling2D(pool_size=(2, 2), strides=(2, 2)))
        # second set of CONV =&gt; RELU =&gt; POOL layers
        model.add(Conv2D(50, (5, 5), padding="same"))
        model.add(Activation("relu"))
        model.add(MaxPooling2D(pool_size=(2, 2), strides=(2, 2)))
        # first (and only) set of FC =&gt; RELU layers
        model.add(Flatten())
        model.add(Dense(500))
        model.add(Activation("relu"))
        # softmax classifier
        model.add(Dense(6))
        model.add(Activation("softmax"))

        model.compile(optimizer='rmsprop',
              loss='categorical_crossentropy',
              metrics=['accuracy'])

        return model</code></pre> 
<h4 id="%E6%A8%A1%E5%9E%8B%E7%BB%93%E6%9E%84%EF%BC%9A">模型结构：</h4> 
<p style="text-align:center;"><img alt="" height="427" src="https://images2.imgbox.com/fb/80/0wpwnX5E_o.png" width="423"></p> 
<h4 id="%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B%EF%BC%9A">训练模型：</h4> 
<pre><code>from keras_svm.model_svm_wrapper import ModelSVMWrapper#导入SVM包，上篇博客给出了源码
    wrapper = ModelSVMWrapper(build_model())
    wrapper.model.summary()
    train_images=trainX
    train_labels=trainY
    test_images=testX
    test_labels=testY

    for j in range(5):
        wrapper = ModelSVMWrapper(build_model())
        epochs = 10
        performance = {
            "cnnwith_svm-acc": [],
            "cnnwithout_svm-acc": []
        }
        for i in range(epochs):
            print('Starting epoch: {}'.format(i + 1))
            wrapper.fit(train_images, train_labels, epochs=1, batch_size=64)
            performance["cnnwith_svm-acc"].append(wrapper.evaluate(test_images, test_labels))
            performance["cnnwithout_svm-acc"].append(
                wrapper.model.evaluate(test_images, to_categorical(test_labels))[1])</code></pre> 
<h4 id="%E7%BB%93%E6%9E%9C%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90%EF%BC%9A">结果对比分析：</h4> 
<p>训练同样批次后，为了实现精确的结果比较，其每次训练完成后在测试集上得到的结果输出为：</p> 
<p style="text-align:center;"><img alt="" height="211" src="https://images2.imgbox.com/3e/30/4zASqWvu_o.png" width="432"></p> 
<p>{'cnnwith_svm-acc': [0.5018656716417911, 0.48880597014925375, 0.5485074626865671, 0.6044776119402985, 0.5802238805970149, 0.6324626865671642, 0.6231343283582089, 0.5597014925373134, 0.582089552238806, 0.5970149253731343], 'cnnwithout_svm-acc': [0.24067164179104478, 0.21828358208955223, 0.38619403029555704, 0.3302238810418257, 0.39738805970149255, 0.5018656720866018, 0.4626865676089899, 0.44589552194324894, 0.44029850701787576, 0.42910447850156186]}<br>  </p> 
<p style="text-align:center;"><img alt="" height="389" src="https://images2.imgbox.com/0a/b4/xWhiccUf_o.png" width="511"></p> 
<h3 id="%E7%BB%93%E6%9D%9F%EF%BC%9A">结束：</h3> 
<p>本次针对图像分类任务上采用 softmax 作为卷积神经网络分类器导致模型泛化能力不足，不能较好适应垃圾图像分类的问题，测试了采用SVM方法替换softmax分类函数的性能。充分利用卷积神经网络自动提取特还能征的优势，及SVM分类器能够增强模型的鲁棒性和泛化性。通过对垃圾分类数据集的实现结果比较，证明SVM替换Softmax对测试集来说确实具有一定的泛化性能。但是仍有不足之处，疑点主要是两个问题：</p> 
<p>1.如果训练次数及卷积神经网络模型层数足够多，训练卷积过程足够好，softmax分类器同样能够取得不错结果，那么SVM作为分类器还能有效果的提升吗？</p> 
<p>2.SVM只是进行了图像分类任务，且大图像被处理为64*64形式，如果采用原始图像特征作为输入，SVM泛化性还能得到彰显吗？</p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2ba533dcf6fbd8b049a005fd5ee5e86e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vue 中路由导航守卫的介绍及使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/265a8662f42fbbee742d50f104264b67/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[深度学习]-基于tensorflow的CNN和RNN-LSTM文本情感分析对比</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>