<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>RT-Thread零基础快速入门第5讲——外部中断 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="RT-Thread零基础快速入门第5讲——外部中断" />
<meta property="og:description" content="目录 一、前言源码链接 二、编程讲解三、项目实战四、结束语 一、前言 这一讲，我要讲的是外部中断，也不知道是太简单了还是没有人用，我没找到比较完整的关于RT-thread外部中断的教程，只发现RT-thread文档中心的PIN设备里面有提及中断相关的函数。不管怎样，我觉得外部中断平常用的还是很多的，至少我在使用RT-thread之前是经常会用到，好了，废话不多说，马上开始进入我们的教程。
源码链接 我发布的所有关于RT-thread的教程源代码都在下面这个链接里面，随着我教程的更新，新的代码也会加入进去。
教程源码下载链接：https://pan.baidu.com/s/1N2D8dM31deKIqNqaIQfPiA
提取码：7nsx
二、编程讲解 第一步：配置外部中断
从这个函数的描述我们可以很清楚的看到，只要调用上面这个函数就可以配置成外部中断脚，中断触发的方式，以及回调函数（等同于中断服务函数），而且回调函数的名称我们还可以自由定义，不像我们用裸机程序的时候，中断服务函数是已经固定了的。
第二步：使能中断
直接调用下面这个函数即可。
第三步：自己定义一个回调函数
因为RT-thread的外部中断没有固定的中断服务函数，所以我们需要自己定义一个，示例如下：
/* 自己定义一个回调函数，相当于中断服务函数 */ void IQR_HANDALE_KEY0(void *args) { rt_pin_write(LED0_PIN, PIN_LOW);//点亮LED0 } 三、项目实战 因为这个两个函数原本在pin.c里面就有定义，所以我们也不需要自己去写，直接调用就行了。
我这里用两个按键，KEY0按下，触发外部中断，点亮LED0，KEY1按下，熄灭LED0，示例代码如下：
#include &lt;rtthread.h&gt; #include &lt;rtdevice.h&gt; #include &lt;board.h&gt; #define LED0_PIN GET_PIN(F, 9) #define LED1_PIN GET_PIN(F, 10) #define KEY0_PIN GET_PIN(E, 4) #define KEY1_PIN GET_PIN(E, 3) /* 自己定义KEY0的回调函数，相当于中断服务函数 */ void IQR_HANDALE_KEY0(void *args) { rt_pin_write(LED0_PIN, PIN_LOW);//点亮LED0 } /* 自己定义KEY1的回调函数，相当于中断服务函数 */ void IQR_HANDALE_KEY1(void *args) { rt_pin_write(LED0_PIN, PIN_HIGH);//熄灭LED0 } int main(void) { int i = 0; /* 把LED引脚设置为输出 */ rt_pin_mode(LED0_PIN, PIN_MODE_OUTPUT); rt_pin_mode(LED1_PIN, PIN_MODE_OUTPUT); /* 先把两个灯关掉 */ rt_pin_write(LED0_PIN, PIN_HIGH); rt_pin_write(LED1_PIN, PIN_HIGH); /* 把KEY引脚设置为输入 */ rt_pin_mode(KEY0_PIN, PIN_MODE_INPUT); rt_pin_mode(KEY1_PIN, PIN_MODE_INPUT); /* 绑定中断，下降沿模式，回调函数名为IQR_HANDALE_KEY0 */ rt_pin_attach_irq(KEY0_PIN, PIN_IRQ_MODE_FALLING, IQR_HANDALE_KEY0, RT_NULL); /* 使能中断 */ rt_pin_irq_enable(KEY0_PIN, PIN_IRQ_ENABLE); /* 绑定中断，下降沿模式，回调函数名为IQR_HANDALE_KEY1 */ rt_pin_attach_irq(KEY1_PIN, PIN_IRQ_MODE_FALLING, IQR_HANDALE_KEY1, RT_NULL); /* 使能中断 */ rt_pin_irq_enable(KEY1_PIN, PIN_IRQ_ENABLE); while (1) { rt_pin_write(LED1_PIN, PIN_LOW);//点亮LED1 rt_thread_mdelay(1000); rt_pin_write(LED1_PIN, PIN_HIGH);//熄灭LED1 rt_thread_mdelay(1000); } } 四、结束语 好了，关于外部中断的编程讲解就到这里，如果还有什么问题可以私信给我。如果需要本文对应的源码的话可以在博文前言部分的链接下载。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e7355bb72fa33b9492d68b6d9d719f56/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-16T20:40:11+08:00" />
<meta property="article:modified_time" content="2023-11-16T20:40:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">RT-Thread零基础快速入门第5讲——外部中断</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">一、前言</a></li><li><ul><li><a href="#_6" rel="nofollow">源码链接</a></li></ul> 
   </li><li><a href="#_12" rel="nofollow">二、编程讲解</a></li><li><a href="#_32" rel="nofollow">三、项目实战</a></li><li><a href="#_94" rel="nofollow">四、结束语</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_2"></a>一、前言</h3> 
<p>这一讲，我要讲的是外部中断，也不知道是太简单了还是没有人用，我没找到比较完整的关于RT-thread外部中断的教程，只发现RT-thread文档中心的PIN设备里面有提及中断相关的函数。不管怎样，我觉得外部中断平常用的还是很多的，至少我在使用RT-thread之前是经常会用到，好了，废话不多说，马上开始进入我们的教程。</p> 
<h4><a id="_6"></a>源码链接</h4> 
<p>我发布的所有关于RT-thread的教程源代码都在下面这个链接里面，随着我教程的更新，新的代码也会加入进去。<br> 教程源码下载链接：<a href="https://pan.baidu.com/s/1N2D8dM31deKIqNqaIQfPiA" rel="nofollow">https://pan.baidu.com/s/1N2D8dM31deKIqNqaIQfPiA</a><br> 提取码：7nsx</p> 
<h3><a id="_12"></a>二、编程讲解</h3> 
<p><strong>第一步：配置外部中断</strong><br> <img src="https://images2.imgbox.com/1a/72/mIirJ2HR_o.png" alt="在这里插入图片描述"><br> 从这个函数的描述我们可以很清楚的看到，只要调用上面这个函数就可以配置成外部中断脚，中断触发的方式，以及回调函数（等同于中断服务函数），而且回调函数的名称我们还可以自由定义，不像我们用裸机程序的时候，中断服务函数是已经固定了的。<br> <strong>第二步：使能中断</strong><br> 直接调用下面这个函数即可。<br> <img src="https://images2.imgbox.com/65/63/I1UOtlRT_o.png" alt="在这里插入图片描述"><br> <strong>第三步：自己定义一个回调函数</strong><br> 因为RT-thread的外部中断没有固定的中断服务函数，所以我们需要自己定义一个，示例如下：</p> 
<pre><code class="prism language-c"><span class="token comment">/* 自己定义一个回调函数，相当于中断服务函数 */</span>
<span class="token keyword">void</span> <span class="token function">IQR_HANDALE_KEY0</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>args<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">rt_pin_write</span><span class="token punctuation">(</span>LED0_PIN<span class="token punctuation">,</span> PIN_LOW<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//点亮LED0</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_32"></a>三、项目实战</h3> 
<p>因为这个两个函数原本在pin.c里面就有定义，所以我们也不需要自己去写，直接调用就行了。<br> 我这里用两个按键，KEY0按下，触发外部中断，点亮LED0，KEY1按下，熄灭LED0，示例代码如下：</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;rtthread.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;rtdevice.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;board.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LED0_PIN</span>    <span class="token expression"><span class="token function">GET_PIN</span><span class="token punctuation">(</span>F<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LED1_PIN</span>    <span class="token expression"><span class="token function">GET_PIN</span><span class="token punctuation">(</span>F<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY0_PIN</span>    <span class="token expression"><span class="token function">GET_PIN</span><span class="token punctuation">(</span>E<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY1_PIN</span>    <span class="token expression"><span class="token function">GET_PIN</span><span class="token punctuation">(</span>E<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span></span></span>

<span class="token comment">/* 自己定义KEY0的回调函数，相当于中断服务函数 */</span>
<span class="token keyword">void</span> <span class="token function">IQR_HANDALE_KEY0</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>args<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">rt_pin_write</span><span class="token punctuation">(</span>LED0_PIN<span class="token punctuation">,</span> PIN_LOW<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//点亮LED0</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 自己定义KEY1的回调函数，相当于中断服务函数 */</span>
<span class="token keyword">void</span> <span class="token function">IQR_HANDALE_KEY1</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>args<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">rt_pin_write</span><span class="token punctuation">(</span>LED0_PIN<span class="token punctuation">,</span> PIN_HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//熄灭LED0</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">/* 把LED引脚设置为输出 */</span>
    <span class="token function">rt_pin_mode</span><span class="token punctuation">(</span>LED0_PIN<span class="token punctuation">,</span> PIN_MODE_OUTPUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">rt_pin_mode</span><span class="token punctuation">(</span>LED1_PIN<span class="token punctuation">,</span> PIN_MODE_OUTPUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
    <span class="token comment">/* 先把两个灯关掉 */</span>
    <span class="token function">rt_pin_write</span><span class="token punctuation">(</span>LED0_PIN<span class="token punctuation">,</span> PIN_HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">rt_pin_write</span><span class="token punctuation">(</span>LED1_PIN<span class="token punctuation">,</span> PIN_HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/* 把KEY引脚设置为输入 */</span>
    <span class="token function">rt_pin_mode</span><span class="token punctuation">(</span>KEY0_PIN<span class="token punctuation">,</span> PIN_MODE_INPUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">rt_pin_mode</span><span class="token punctuation">(</span>KEY1_PIN<span class="token punctuation">,</span> PIN_MODE_INPUT<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/* 绑定中断，下降沿模式，回调函数名为IQR_HANDALE_KEY0 */</span>
    <span class="token function">rt_pin_attach_irq</span><span class="token punctuation">(</span>KEY0_PIN<span class="token punctuation">,</span> PIN_IRQ_MODE_FALLING<span class="token punctuation">,</span> IQR_HANDALE_KEY0<span class="token punctuation">,</span> RT_NULL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/* 使能中断 */</span>
    <span class="token function">rt_pin_irq_enable</span><span class="token punctuation">(</span>KEY0_PIN<span class="token punctuation">,</span> PIN_IRQ_ENABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/* 绑定中断，下降沿模式，回调函数名为IQR_HANDALE_KEY1 */</span>
    <span class="token function">rt_pin_attach_irq</span><span class="token punctuation">(</span>KEY1_PIN<span class="token punctuation">,</span> PIN_IRQ_MODE_FALLING<span class="token punctuation">,</span> IQR_HANDALE_KEY1<span class="token punctuation">,</span> RT_NULL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/* 使能中断 */</span>
    <span class="token function">rt_pin_irq_enable</span><span class="token punctuation">(</span>KEY1_PIN<span class="token punctuation">,</span> PIN_IRQ_ENABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">rt_pin_write</span><span class="token punctuation">(</span>LED1_PIN<span class="token punctuation">,</span> PIN_LOW<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//点亮LED1</span>
        <span class="token function">rt_thread_mdelay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">rt_pin_write</span><span class="token punctuation">(</span>LED1_PIN<span class="token punctuation">,</span> PIN_HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//熄灭LED1</span>
        <span class="token function">rt_thread_mdelay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_94"></a>四、结束语</h3> 
<p><strong>好了，关于外部中断的编程讲解就到这里，如果还有什么问题可以私信给我。如果需要本文对应的源码的话可以在博文前言部分的链接下载。<br> 如果觉得这篇文章对你有用，点赞+关注支持一下博主呗。<br> 后续我会继续更新RT-thread入门教程系列，如果感兴趣的同学可以关注一下博主，谢谢！</strong></p> 
<p>RT-thread相关教程汇总：<a href="https://blog.csdn.net/ShenZhen_zixian/article/details/120563891">https://blog.csdn.net/ShenZhen_zixian/article/details/120563891</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7d214f84ebdaf8354a5e9ee175a2177d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">颜色标记txt和多根走线【Cadance进阶】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7a336c35e21b784f3924b947bec1d8a0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">永磁同步电机矢量控制——转速环 PI 参数整定</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>