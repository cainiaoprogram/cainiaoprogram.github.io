<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>javaee 操作excel文件 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="javaee 操作excel文件" />
<meta property="og:description" content="在http://jareye.com/上下载JXL架包操作 读取工作薄：Workbook workbook=Workbook.getWorkbook(new File(“myfile.xls”));
读取工作表：Sheet sheet=workbook.getSheet(0);
读取单元格：Cell c2=sheet.getCell(2,1);//单元格是从（0,0）开始的
读取单元格的值：1.通过cell的getContents方法
String string2=c2.getContents();
2.cell提供一个getType()方法
能够返回单元格的类型信息，同时JXL提供了一个CellType类用来预设Excel中的类型信息，而且JXL提供了一些Cell类的子类用来分别用来表示各种类型的单元格，如LabelCell，NumberCell，DateCell分别表示字符、数值、日期类型的单元格
if (c2.getType() == CellType. LABEL) { LabelCell nc = (LabelCell) c2; String number b2 = nc. getString();
}
if (c2.getType() == CellType. DATE) { DateCell nc = (DateCell) c2; Date number b2 = nc. getDate();
}
if (c2.getType() == CellType.NUMBER) { NumberCell nc = (NumberCell) c2; double number b2 = nc.getValue();
}
每次操作完都要释放资源 workbook.close();写excle操作 4.1通过WritableWorkbook WritableSheet Label可以实现对EXcle文件的插入工作" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c42d96eeeff4aba9d5a370c44dd2cc04/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-08-10T16:15:40+08:00" />
<meta property="article:modified_time" content="2018-08-10T16:15:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">javaee 操作excel文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <ol><li>在http://jareye.com/上下载JXL架包</li><li><span style="color:#4f4f4f;">操作</span></li></ol> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">读取工作薄：Workbook workbook=Workbook.getWorkbook(new File(</span><span style="color:#4f4f4f;">“</span><span style="color:#4f4f4f;">myfile.xls</span><span style="color:#4f4f4f;">”</span><span style="color:#4f4f4f;">));</span></p> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">读取工作表：Sheet sheet=workbook.getSheet(0);</span></p> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">读取单元格：Cell c2=sheet.getCell(2,1);//单元格是从（0,0）开始的</span></p> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">读取单元格的值：1.通过cell的getContents方法</span></p> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">String string2=c2.getContents();</span></p> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">2.cell提供一个getType()方法</span></p> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">能够返回单元格的类型信息，同时JXL提供了一个CellType类用来预设Excel中的类型信息，而且JXL提供了一些Cell类的子类用来分别用来表示各种类型的单元格，如LabelCell，NumberCell，DateCell分别表示字符、数值、日期类型的单元格</span><br><span style="color:#4f4f4f;">if (c2.getType() == CellType. LABEL) </span><br><span style="color:#4f4f4f;">{ </span><br><span style="color:#4f4f4f;">LabelCell nc = (LabelCell) c2; </span><br><span style="color:#4f4f4f;">String number b2 = nc. getString();</span><br><span style="color:#4f4f4f;">}</span><br><span style="color:#4f4f4f;">if (c2.getType() == CellType. DATE) </span><br><span style="color:#4f4f4f;">{ </span><br><span style="color:#4f4f4f;">DateCell nc = (DateCell) c2; </span><br><span style="color:#4f4f4f;">Date number b2 = nc. getDate();</span><br><span style="color:#4f4f4f;">}</span><br><br><span style="color:#4f4f4f;">if (c2.getType() == CellType.NUMBER) </span><br><span style="color:#4f4f4f;">{ </span><br><span style="color:#4f4f4f;">NumberCell nc = (NumberCell) c2; </span><br><span style="color:#4f4f4f;">double number b2 = nc.getValue();</span><br><span style="color:#4f4f4f;">}</span></p> 
<ol><li><span style="color:#4f4f4f;">每次操作完都要释放资源 workbook.close();</span></li><li><span style="color:#4f4f4f;">写excle操作</span></li></ol> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">   4.1通过WritableWorkbook WritableSheet Label可以实现对EXcle文件的插入工作</span></p> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">       4.1.1：创建Excle工作薄 创建工作表 创建单元格</span></p> 
<ol><li><span style="color:#4f4f4f;">创建工作薄：WritableWorkbook wwb=Workbook.createWorkbook(new File(</span><span style="color:#4f4f4f;">“</span><span style="color:#4f4f4f;">d.xsl</span><span style="color:#4f4f4f;">”</span><span style="color:#4f4f4f;">));</span></li><li><span style="color:#4f4f4f;">将WritetableWorkbook直接写入输入流</span></li></ol> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">OutputStream os =</span><span style="color:#4f4f4f;"> new FileOutputStream(targetfile);</span></p> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">WritableWorkbook wwb = Workbook.createWorkbook(os);</span></p> 
<ol><li><span style="color:#4f4f4f;">创建工作表</span><br><span style="color:#4f4f4f;">WritableSheet ws = wwb.createSheet("通讯录", 0);//创建sheet</span></li><li><span style="color:#4f4f4f;">创建单元格</span></li></ol> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">添加文本类单元格</span><br><span style="color:#4f4f4f;">Label labelC = new Label(0, 0, "This is a Label cell");</span></p> 
<p style="margin-left:0pt;"><span style="color:#4f4f4f;">ws.addCell(label</span><span style="color:#4f4f4f;">C</span><span style="color:#4f4f4f;">);</span></p> 
<pre class="has"><code class="language-java">/// 导入，更新学生数据（已经有的excle表格）
	public String importExcleStudent() throws IOException {
		createTime = getTime();
		String path = "/excleFile";
		String realpath = ServletActionContext.getServletContext().getRealPath(path);
		File target = new File(realpath, importStudentFileName);
		FileWriter writer =createFileWirter(realpath+"/importExcleStudent.log");
		if (target.exists()) {
			target.delete();
		}
		try {
			FileUtils.copyFile(importStudent, target);
			System.out.println("学生信息文件上传成功");
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		try {
			FileInputStream fi = new FileInputStream(target);
			Workbook rwb = Workbook.getWorkbook(fi);
			Sheet rs = rwb.getSheet(0);
			int rows = rs.getRows();// 所有行
			int clos = rs.getColumns();// 所有列
			// System.out.println(rows+","+clos);
			Boolean sex = false;
			String stuId, stuName = null, stuSex = null, stuSchool = null, stuCollege = null, stuProfession = null,
					stuClass = null, stuClassType = null, stuJobstatus = null, stuTutor = null, stuPhone = null,
					stuIdcard = null;
			StudentsId stuI = null;
			Students student = null;
			Students stu = null;
			int number=1,j=0;
			for (int i = 1; i &lt; rows; i++) {
				//System.out.println(i+",,"+rows);
				 j = 0;
					stuId = rs.getCell(j++, i).getContents().trim();
					stuName = rs.getCell(j++, i).getContents();
					stuSex = rs.getCell(j++, i).getContents();
					stuSchool = rs.getCell(j++, i).getContents();
					stuCollege = rs.getCell(j++, i).getContents();
					stuProfession = rs.getCell(j++, i).getContents();
					stuClass = rs.getCell(j++, i).getContents();
					stuClassType = rs.getCell(j++, i).getContents();
					stuJobstatus = rs.getCell(j++, i).getContents();
					stuTutor = rs.getCell(j++, i).getContents();
					stuPhone = rs.getCell(j++, i).getContents();
					stuIdcard = rs.getCell(j++, i).getContents();
					if (stuSex.equals("男")) {
						sex = false;
					} else if (stuSex.equals("女")) {
						sex = true;
					}
					stuI = new StudentsId();
					stuI.setSStudentId(stuId);
					student = null;
					student = studentDao.isexist(stuId);
					if (student != null) {// 表中存在该学生，则更新
						stuI.setSId(student.getId().getSId());
						stu = new Students(stuI, stuName, sex, stuSchool, stuCollege, stuProfession, stuClass,
								stuClassType, stuJobstatus, stuTutor, stuPhone, stuIdcard,
								MD5Util.MD5(stuId.substring(stuId.length() - 6)));
					//	System.out.println(stuId + "--" + stuId.length() + "&gt;&gt;" + stuId.substring(stuId.length() - 6));
						stu.setSCreateTime(student.getSCreateTime());
						stu.setSChangeTime(getTime());
						studentDao.updatestudent(stu);
						writer.write("第"+(number++)+"记录"+stuId+"更新成功\r\n");
					} else {// 表中不存在该学生，则添加
						System.out.println(stuId + "--" + stuId.length() + "&gt;&gt;" + stuId.substring(stuId.length() - 6));
						stu = new Students(stuI, stuName, sex, stuSchool, stuCollege, stuProfession, stuClass,
								stuClassType, stuJobstatus, stuTutor, stuPhone, stuIdcard,
								MD5Util.MD5(stuId.length()&gt;6?stuId.substring(stuId.length() - 6):("1234567"+stuId).substring(("1234567"+stuId).length() - 6)));
						stu.setSCreateTime(createTime);
						stu.setSChangeTime(createTime);
						stu.setSPicture("https://sdsy.zzjc.edu.cn/SDSYw/image/1.jpg");
						studentDao.addstudent(stu);
						writer.write("第"+(number++)+"记录"+stuId+"添加成功\r\n");
					}
					writer.flush();
				}
			writer.close();
			fi.close();
		}
		catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (BiffException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}catch(Exception e){
			System.out.println(e);
		}finally{
			
		} 
		s = JSONTools.createJsonObject("s", "OK");
		return "success";
	}


// 导出预约活动学生数据
	public String exportActStudent() {
		try {
			System.out.println("名单导出");
			WritableWorkbook wwb = null;
			// 默认保存在d盘
			String path = ServletActionContext.getServletContext().getRealPath("/excleFile");
			File file = new File(path + "/mingdan.xls");
			// System.out.println(file);
			if (!file.exists()) {
				file.createNewFile();
			}
			wwb = Workbook.createWorkbook(file);
			WritableSheet ws = wwb.createSheet("sheet0", 0);
			List&lt;Activiting&gt; list = actRecordDao.JionActStudent(id);
			Label labelSId = new Label(0, 0, "学号");
			Label laelName = new Label(1, 0, "姓名");
			Label labelSchool = new Label(2, 0, "学院");
			Label labelClass = new Label(3, 0, "班级");
			Label labelPhone = new Label(4, 0, "联系方式");

			ws.addCell(labelSId);
			ws.addCell(laelName);
			ws.addCell(labelSchool);
			ws.addCell(labelClass);
			ws.addCell(labelPhone);
			int i = 1;
			for (Activiting actR : list) {
				ws.addCell(new Label(0, i, actR.getId().getASId()));
				ws.addCell(new Label(1, i, actR.getStudent().getSName()));
				ws.addCell(new Label(2, i, actR.getStudent().getSCollege()));
				ws.addCell(new Label(3, i, actR.getStudent().getSClass()));
				ws.addCell(new Label(4, i++, actR.getStudent().getSPhone()));
			}
			wwb.write();
			wwb.close();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (RowsExceededException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (WriteException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

		s = JSONTools.createJsonObject("data", "OK");
		return "success";
	}
</code></pre> 
<p> 参考：<a href="https://blog.csdn.net/lalioCAT/article/details/50580020">https://blog.csdn.net/lalioCAT/article/details/50580020</a></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bcb98b1768807a4082241614b22a0b8f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Oracle数据库的了解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e3216bc05b4859bad87be5cdf5844e86/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">KBEngine使用记录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>