<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Windows vbs脚本获取系统信息 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Windows vbs脚本获取系统信息" />
<meta property="og:description" content="Windows vbs脚本获取系统信息 运行的进程硬盘序列号获取制造商获取型号获取生产日期获取主板信息获取SN号获取系统类型及安装日期获取CPU信息获取内存信息获取显卡信息获取声卡型号获取硬盘信息获取光驱信息获取显示器信息获取Network 网卡信息获取Network enable信息获取MAC地址获取IP地址获取计算机名获取CPU使用率获取剩余内存获取内存使用率获取DNS地址获取指定文本中指定内容获取当前时间获取系统补丁包信息获取系统补丁最后更新时间获取管理员用户获取共享文件获取系统补丁更新服务器地址获取已安装软件获取当前登录用户获取系统类型32 64输出格式为json串 strComputer = &#34;.&#34; Set objWMIService = GetObject(&#34;winmgmts:\\&#34; &amp; strComputer &amp; &#34;\root\CIMV2&#34;) set oReg=Getobject(&#34;winmgmts:\\&#34; &amp; strComputer &amp; &#34;\root\default:StdRegProv&#34;) On Error Resume Next Set fso=CreateObject(&#34;Scripting.FileSystemObject&#34;) set obshell = wscript.createobject(&#34;wscript.shell&#34;) Set openFile=fso.OpenTextFile(&#34;C:/temp/wmic/opports.txt&#34;,1,true) alllines =&#34;&#34; Do while not openfile.atendofstream line = openfile.readline &#39;Wscript.Echo &#34;line: &#34; &amp; line if instr(line,&#34;LISTENING&#34;) then alllines = alllines &amp; line &amp; vbnewline end if loop opports=alllines set openFile=nothing &#39;Wscript.Echo opports REM &#39;运行的进程&#39; Set colItems = objWMIService." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/9936da9c9468a84b14a7b3e48d03f26d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-10T17:22:12+08:00" />
<meta property="article:modified_time" content="2022-03-10T17:22:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Windows vbs脚本获取系统信息</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h6><a id="Windows_vbs_0"></a>Windows vbs脚本获取系统信息</h6> 
<ul><li>运行的进程</li><li>硬盘序列号</li><li>获取制造商</li><li>获取型号</li><li>获取生产日期</li><li>获取主板信息</li><li>获取SN号</li><li>获取系统类型及安装日期</li><li>获取CPU信息</li><li>获取内存信息</li><li>获取显卡信息</li><li>获取声卡型号</li><li>获取硬盘信息</li><li>获取光驱信息</li><li>获取显示器信息</li><li>获取Network 网卡信息</li><li>获取Network enable信息</li><li>获取MAC地址</li><li>获取IP地址</li><li>获取计算机名</li><li>获取CPU使用率</li><li>获取剩余内存</li><li>获取内存使用率</li><li>获取DNS地址</li><li>获取指定文本中指定内容</li><li>获取当前时间</li><li>获取系统补丁包信息</li><li>获取系统补丁最后更新时间</li><li>获取管理员用户</li><li>获取共享文件</li><li>获取系统补丁更新服务器地址</li><li>获取已安装软件</li><li>获取当前登录用户</li><li>获取系统类型32 64</li><li>输出格式为json串</li></ul> 
<pre><code>strComputer = "." 
Set objWMIService = GetObject("winmgmts:\\" &amp; strComputer &amp; "\root\CIMV2") 
set oReg=Getobject("winmgmts:\\" &amp; strComputer &amp; "\root\default:StdRegProv")

On Error Resume Next

Set fso=CreateObject("Scripting.FileSystemObject")
set obshell = wscript.createobject("wscript.shell")
Set openFile=fso.OpenTextFile("C:/temp/wmic/opports.txt",1,true)
alllines ="" 
Do while not openfile.atendofstream
line = openfile.readline
'Wscript.Echo "line: " &amp; line
if instr(line,"LISTENING") then
alllines = alllines &amp; line &amp; vbnewline
end if
loop
opports=alllines
set openFile=nothing
'Wscript.Echo  opports


REM '运行的进程' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_Process ",,48)  
For Each objItem in colItems
	proc_c1=objItem.Caption
        proc_c = proc_c1  &amp; " ; " &amp; proc_c
Next
'Wscript.Echo "Process:" &amp; proc_c


REM '硬盘序列号' 
Set colItems = objWMIService.ExecQuery("Select * from Win32_PhysicalMedia",,48)
For Each objItem in colItems
    disksn1 = objItem.SerialNumber
    disksn = disksn1 &amp; " ! " &amp; disksn
Next
'WScript.Echo "SerialNumber: " &amp; disksn


REM '获取制造商' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_ComputerSystem",,48)  
For Each objItem in colItems  
	Mauf=objItem.Manufacturer
	'Wscript.Echo "Mauf: " &amp; Mauf 
Next

REM '获取型号' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_ComputerSystem",,48)  
For Each objItem in colItems  
	Model=objItem.Model
	'Wscript.Echo "Model: " &amp; Model
Next

REM '获取生产日期' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_BIOS",,48)  
For Each objItem in colItems  
	OpDte=objItem.ReleaseDate
	'Wscript.Echo "ReleaseDate: " &amp; OpDte
Next

REM '获取主板信息' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_BaseBoard",,48)  
For Each objItem in colItems 
	MdBd=objItem.Manufacturer &amp; "/" &amp; objItem.Product &amp; "/" &amp; objItem.Version
	'Wscript.Echo "MdBd:" &amp; MdBd
Next  

REM '获取SN号' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_BIOS",,48)  
For Each objItem in colItems  
	Sn=objItem.SerialNumber 
	'Wscript.Echo "Sn: " &amp; Sn
Next

REM '获取系统类型及安装日期' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_OperatingSystem",,48)  
For Each objItem in colItems  
	OS=objItem.Caption 
        check1=objItem.InstallDate
	'Wscript.Echo "OS: " &amp; OS
Next


REM '获取CPU信息' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_Processor",,48)  
For Each objItem in colItems 
	Processor=objItem.Name 
	'Wscript.Echo "Processors:         " &amp; Processor 
Next

REM '获取内存信息' 
memcap=0 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_PhysicalMemory",,48)  
For Each objItem in colItems 
	Mem= objItem.Manufacturer &amp; "/" &amp; objItem.Speed
	MemCap=MemCap+objItem.Capacity
Next
Mem=Mem &amp; "/" &amp; round(MemCap/1024^3) &amp; "GB"
'Wscript.Echo "Memory: " &amp; Mem

'REM '获取显卡信息' 
'Set colItems = objWMIService.ExecQuery( _ 
'	"SELECT * FROM Win32_VideoController",,48)  
'For Each objItem in colItems 
'	Vdo=objItem.Name
	'Wscript.Echo "Vdo:" &amp; Vdo
'Next

REM '获取声卡型号' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_SoundDevice",,48)  
For Each objItem in colItems  
	Snd=objItem.Name
	'Wscript.Echo "Snd: " &amp; Snd
	exit for '默认声卡为第一个
Next
  
REM '获取硬盘信息' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_DiskDrive",,48)  
For Each objItem in colItems  
	Dsk=objItem.Model 
	'Wscript.Echo "Dsk: " &amp; Dsk
	Exit For
Next

REM '获取光驱信息' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM CIM_CDROMDrive",,48)  
For Each objItem in colItems 
	Cdr=objItem.Name
	'Wscript.Echo "Cdr:" &amp; Cdr
Next

REM '获取显示器信息' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_DesktopMonitor",,48)  
For Each objItem in colItems 
	Monitor=objItem.PNPDeviceID
Next

REM '获取Network 网卡信息' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_NetworkAdapterConfiguration WHERE  IPEnabled = True",,48)  
For Each objItem in colItems 
	Network1=Mid(objItem.Caption,InStr(objItem.Caption,"]")+1) &amp; " ; " &amp; objItem.MACAddress &amp; " ; " &amp; objItem.IPAddress(0)
        Network=Network1 &amp; " ! " &amp; Network
	'Wscript.Echo "Network: " &amp; Network 
Next

'REM '获取Network enable信息' 
'Set colItems = objWMIService.ExecQuery( _ 
'	"SELECT * FROM Win32_NetworkAdapterConfiguration WHERE  IPEnabled = 'True",,48)  
'i=0
'redim arr_network(8) 
'For Each objItem in colItems 
'	Network1=Mid(objItem.Caption,InStr(objItem.Caption,"]")+1) &amp; " ; " &amp; 'objItem.MACAddress &amp; " ; " &amp; objItem.IPAddress(0)
'        Network=Network1 &amp; " ! " &amp; Network
'        arr_network(i)=Network1
'	'Wscript.Echo "Network: " &amp;  arr_network(i)
'i=i+1
'Next
'network=arr_network(0)
'network2=arr_network(1)
'Wscript.Echo "Network: " &amp;  network
'Wscript.Echo "Network2: " &amp;  network2

REM '获取MAC地址' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_NetworkAdapterConfiguration WHERE  IPEnabled = True",,48)  
For Each objItem in colItems  
	Mac=objItem.MACAddress 
	'Wscript.Echo "MACAddress: " &amp; Mac 
Next

REM '获取IP地址' 
REM '判断DNS是否为空，判断IP地址开头是否为10或192' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled=TRUE",,48)  
For Each objItem in colItems  
	If isNULL(objItem.DNSServerSearchOrder) Then
	Else
		IPX=objItem.IPAddress(0)  
		LefIP=split(IPX,".")(0) 
		If LefIP="10" OR LefIP="192" Then
			IP=IPX 
			'Wscript.Echo "ip:" &amp; IP 
		End If
	End If
Next

REM '获取计算机名' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_ComputerSystem",,48)  
For Each objItem in colItems  
	HostName=objItem.Name 
	'Wscript.Echo "HostName:" &amp; HostName 
Next






REM '获取CPU使用率'
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_Processor",,48)  
For Each objItem in colItems  
	cpuUse=objItem.LoadPercentage 
	'Wscript.Echo "cpuUse:" &amp; cpuUse 
Next

REM '获取剩余内存'
REM Set colItems = objWMIService.ExecQuery( _ 
REM 	"SELECT * FROM Win32_PerfRawData_PerfOS_Memory",,48)  
REM For Each objItem in colItems  
REM 	freeMemory=objItem.AvailableMBytes / 1024
REM 	'Wscript.Echo "freeMemory:" &amp; freeMemory 
REM Next



REM '获取内存使用率'
Set colItems = objWMIService.InstancesOf("Win32_OperatingSystem")  
For Each objItem in colItems  
	useMemory=((objItem.TotalVisibleMemorySize - objItem.FreePhysicalMemory) / objItem.TotalVisibleMemorySize)*100
	LeftUseMemory=split(useMemory,".")(0) 
	'Wscript.Echo "LeftUseMemory:" &amp; LeftUseMemory
Next


REM '获取CPU描述信息' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_Processor",,48)  
For Each objItem in colItems 
	cName=objItem.Name
	Caption=objItem.Caption 
	cpuCaption = cName &amp; ":" &amp; Caption
	'Wscript.Echo "cpuCaption: " &amp; cpuCaption 
Next


REM '获取显卡描述信息' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_DisplayConfiguration")  
For Each objItem in colItems 
	Version=objItem.DriverVersion 
	DeviceName=objItem.DeviceName
	DriverVersion = DeviceName &amp; ":" &amp; DeviceName
	'Wscript.Echo "DriverVersion: " &amp; DriverVersion 
Next

REM '获取DNS地址' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled=TRUE",,48)  
For Each objItem in colItems  
	DNS = objItem.DNSServerSearchOrder(0)
	'Wscript.Echo "DNS:" &amp; DNS 
Next


REM '厂商SP版本信息'
REM '厂商信息'
maufinfo = split(createobject("scripting.filesystemobject").opentextfile("C:\SPVersion.txt").readall,vbcrlf)
For i = 0 to ubound(maufinfo)
	if instr(maufinfo(i),"厂商") then 
		SPMauf = split(maufinfo(i),":")(1)
		'WScript.Echo "SPMauf:" &amp; SPMauf
	end if
Next
REM '厂商对应SP版本信息'
spversion = split(createobject("scripting.filesystemobject").opentextfile("C:\SPVersion.txt").readall,vbcrlf)
For i = 0 to ubound(spversion)
	if instr(spversion(i),"SP版本") then 
		spv = split(spversion(i),":")(1)
		'WScript.Echo "spv:" &amp; spv
	end if
Next

REM '厂商对应设备机型信息'
model = split(createobject("scripting.filesystemobject").opentextfile("C:\SPVersion.txt").readall,vbcrlf)
For i = 0 to ubound(model)
	if instr(model(i),"机型") then 
		maufModel = split(model(i),":")(1)
		'WScript.Echo "maufModel:" &amp; maufModel
	end if
Next


REM '信息收集日期'
CurrentDate = year(Now) &amp;"-"&amp; Month(Now) &amp;"-"&amp; day(Now)
CurrentTime = Hour(Now) &amp;":"&amp; Minute(Now) &amp;":"&amp; Second(Now)
'Wscript.Echo "CurrentTime:" &amp; CurrentDate &amp;"/"&amp; CurrentTime

REM '获取亚信软件版本'
Const sBaseKey = _
     "Software\Microsoft\Windows\CurrentVersion\Uninstall\"
 oReg.EnumKey HKEY_LOCAL_MACHINE, sBaseKey, arrSubKeys

Set objFSO = CreateObject("Scripting.FileSystemObject")
Const ForWriting = 2
REM Set textWritrFile = objFSO.OpenTextFile(FilePath &amp; ucase(strComputerName) &amp;".txt",ForWriting,True,True)
Set textWritrFile = objFSO.OpenTextFile("C:\software.txt",ForWriting,True,True)
For Each strSubKey In arrSubKeys
	intRet = oReg.GetStringValue(HKEY_LOCAL_MACHINE, sBaseKey &amp; strSubKey, _
		"DisplayName", strValue)  
	intver = oReg.GetStringValue(HKEY_LOCAL_MACHINE, sBaseKey &amp; strSubKey, _
		"DisplayVersion", strValue4)
	If intRet &lt;&gt; 0 Then
		intRet = oReg.GetStringValue(HKEY_LOCAL_MACHINE, sBaseKey &amp; strSubKey, _
		"QuietDisplayName", strValue)
	End If
	
	If (strValue &lt;&gt; "") and (intRet = 0)   Then
        sf4=strValue4
        sf3= strValue &amp; " | " &amp; strValue4 
        yxsf= sf3  &amp; " ; " &amp; vbLf &amp;   yxsf
        'WScript.Echo sf3
		
    End If
	REM textWritrFile.WriteLine(sf)
	REM textWritrFile.Close
	
	yx = InStr(yxsf,"亚信安全")
	if yx &lt;&gt; 0 Then
		sof = split(yxsf,"亚信安全 |")(1)
		yxsoftw = split(sof,";")(0)
		'WScript.Echo "softw:" &amp; softw
	REM else
	REM	softw = "没有查询到亚信安全软件信息"
	end if
Next




REM 获取机器运行时长
Set WMI = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2")
Set colLoggedEvents = WMI.ExecQuery("Select * from Win32_NTLogEvent Where Logfile = 'System' And EventCode = '6005' Or EventCode = '6006'")
For Each objEvent In colLoggedEvents
    Flag = Flag +1
    If Flag = 1 Then
        startTime=UTCtoNow(objEvent.TimeWritten)
    End If
Next

CurrentDate = year(Now) &amp;"-"&amp; Month(Now) &amp;"-"&amp; day(Now)
CurrentTime = Hour(Now) &amp;":"&amp; Minute(Now) &amp;":"&amp; Second(Now)

currentTime = CurrentDate &amp;" "&amp; CurrentTime

difMinute = datediff("s",startTime,currentTime ) / 60 / 60
difM = round(difMinute,2)
min=split(difM,".")(1)*60/100
m=Round(min,0)
hou=split(difM,".")(0)

diftime = hou &amp;" 小时 "&amp; m &amp;" 分钟"
REM Wscript.Echo "difM:" &amp; h &amp;" 小时 "&amp; m &amp;" 分钟"
REM Wscript.Echo "diftime" &amp; diftime
Function UTCtoNow(nD)
    If Not IsNull(nD) Then
    Set SWDT = CreateObject("WbemScripting.SWbemDateTime")
    SWDT.Value = nD
    UTCtoNow = SWDT.GetVarDate(True)
    End If
End Function



	
REM '获取系统补丁包信息' 
checkhot= "KB4012212"
checkhot2="KB4012598"
checkhot3="KB4012215"
checkhot4="KB4493470"
checkhot5="KB4462923"
checkhot6="KB4489878"
checkhot7="KB4471318"
checkhot8="KB4467684"
checkhot9="KB4489882"
cve07081="KB4499175"
cve07082="KB4499164"
cve07083="KB4500331"
cve10401="KB4503269"
cve10402="KB4503267"
cve10403="KB4503292"
cve20200601="KB4534270"
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_QuickFixEngineering",,48)  
Hotfix2 = 0
fixdate = 0
For Each objQuickFix in colItems  
	Hotfix1=objQuickFix.HotFixID
        fixdate1=objQuickFix.installedon
        IF fixdate1 &lt;&gt; "" then
         IF Cdate(fixdate) &lt; Cdate(fixdate1)  then 
         fixdate = fixdate1
         end if
        lfixdate = fixdate1
        end if
        If objQuickFix.HotFixID = checkhot or objQuickFix.HotFixID = checkhot2 or objQuickFix.HotFixID = checkhot3 or  objQuickFix.HotFixID = checkhot4  or  objQuickFix.HotFixID = checkhot5 or  objQuickFix.HotFixID = checkhot6  or  objQuickFix.HotFixID = checkhot7 or  objQuickFix.HotFixID = checkhot8 or objQuickFix.HotFixID = checkhot9 Then 
        'Wscript.Echo "KB4012212 KB4012215 KB4462923 KB4471318 KB4489878 (win7) or KB4012598(winxp) or KB4493470 KB4467684 KB4489882(win10)已安装"
        chkhotfix = "KB4012212 KB4012215 KB4462923 KB4471318 KB4489878 (win7) or KB4012598(winxp)已安装 or KB4493470 KB4467684 KB4489882(win10)已安装"
        End If

       If objQuickFix.HotFixID = cve07081 or objQuickFix.HotFixID = cve07082 or objQuickFix.HotFixID = cve07083 Then 
       'Wscript.Echo "KB4499164  KB4499175 (win7) or KB4500331(winxp) cve20190708补丁已安装"
        vdo = "KB4499164  KB4499175 (win7) or KB4500331(winxp) cve20190708补丁已安装"
        End If

       If objQuickFix.HotFixID = cve10401 or objQuickFix.HotFixID = cve10402  or objQuickFix.HotFixID = cve10403 Then 
       'Wscript.Echo "KB4503269  KB4503292(win7) or KB4503267(win10) cve20191040补丁已安装"
        chkfix1 = "KB4503269  KB4503292(win7) or KB4503267(win10) cve20191040补丁已安装"
        End If

       If objQuickFix.HotFixID = cve20200601  Then 
       'Wscript.Echo "KB4534270(win10) cve20200601补丁已安装"
       chkfix3 = "KB4534270(win10) cve20200601补丁已安装"
        End If

        'Hotfix=Hotfix &amp; " " &amp; Hotfix1
        Hotfix2 = Hotfix2 + 1
	'Wscript.Echo "Hotfix:" &amp; Hotfix2 
Next

REM '获取系统补丁最后更新时间' 
Hotfix3 = cstr(Hotfix2)
'fixdate= cstr(fixdate)
fixdate= RIGHT(fixdate,4)&amp;"/"&amp;LEFT(fixdate,LEN(fixdate)-5)
'Wscript.Echo "Hotfix: " &amp; fixdate 
'Wscript.Echo "Hotfix: " &amp; Hotfix3 
'Wscript.Echo "Hotfix:" &amp; lfixdate


REM '获取管理员用户' 
dim strTemp
dim strTemp1
Set objGroup = GetObject("WinNT://./administrators")
adcount2=0
For each objMember in objGroup.Members
 if objMember.Name &lt;&gt; ("Domain Admins") and objMember.Name &lt;&gt; ("lc-admin")then
 'Wscript.Echo objMember.class &amp; "=" &amp; objMember.Name
 set objAd = GetObject("WinNT://" &amp; strComputer &amp; "/" &amp; objMember.name)
 'Wscript.Echo objMember.Name &amp; ":" &amp; objAd.AccountDisabled
strTemp = objMember.class &amp; "=" &amp; objMember.Name  &amp; "|" &amp; objAd.AccountDisabled
strTemp1 = strTemp   &amp; " ; " &amp;   strTemp1
adcount2=adcount2 + 1 
 end if
Next
set objAd = GetObject("WinNT://" &amp; strComputer &amp; "/Guest")
guests=  "Guest|" &amp; objAd.AccountDisabled
strTemp1 = strTemp1  &amp; " ; " &amp; guests
aduser = strTemp1
adcount = cstr(adcount2)
'Wscript.Echo "administrator count:" &amp; adcount
'Wscript.Echo "administrator:" &amp; strTemp1 

REM '获取共享文件' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_Share where type=0",,48)  
For Each objItem in colItems
	hs=objItem.Name
        hsTemp = objItem.Name
        hshare = hstemp  &amp; " ; " &amp;   hshare
	'Wscript.Echo "hshare:" &amp; hshare
Next

REM '获取系统补丁更新服务器地址' 
Const HKEY_LOCAL_MACHINE = &amp;H80000002
strkeypath="SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate"
strvaluename="WUServer"
strvaluename1="WUStatusServer"
oReg.GetStringValue HKEY_LOCAL_MACHINE,strkeypath,strvaluename1,strValue
wuserver = strValue
'Wscript.Echo "Wuserver：" &amp; wuserver

REM 'Mcafee杀毒软件更新日期'
mcfkeypath="SOFTWARE\McAfee\AVEngine"
mcfkeypath64="SOFTWARE\Wow6432Node\McAfee\AVEngine"
mcfvaluename="AVDatDate"
oReg.GetStringValue HKEY_LOCAL_MACHINE,mcfkeypath,mcfvaluename,mcf
oReg.GetStringValue HKEY_LOCAL_MACHINE,mcfkeypath64,mcfvaluename,mcf64
mcfdate=mcf &amp; mcf64
'Wscript.Echo "Mcafeeupdate：" &amp;  mcfdate

REM 'USB口使用状态'
usbkeypath="SYSTEM\CurrentControlSet\Services\USBSTOR"
usbvaluename="Start"
oReg.GetDwordValue HKEY_LOCAL_MACHINE,usbkeypath,usbvaluename,usbValue
usbstat = usbValue
'Wscript.Echo "Usbstat：" &amp; usbstat

'获取已安装软件'
Const strBaseKey = _
     "Software\Microsoft\Windows\CurrentVersion\Uninstall\"
oReg.EnumKey HKEY_LOCAL_MACHINE, strBaseKey, arrSubKeys
 
For Each strSubKey In arrSubKeys
    intRet = oReg.GetStringValue(HKEY_LOCAL_MACHINE, strBaseKey &amp; strSubKey, _
        "DisplayName", strValue)
    inttime = oReg.GetStringValue(HKEY_LOCAL_MACHINE, strBaseKey &amp; strSubKey, _
        "Installdate", strValue2)
    intver = oReg.GetStringValue(HKEY_LOCAL_MACHINE, strBaseKey &amp; strSubKey, _
        "DisplayVersion", strValue4)
    intSC= oReg.GetDwordValue(HKEY_LOCAL_MACHINE, strBaseKey &amp; strSubKey, _
        "SystemComponent", strValue5)
    intpkn= oReg.GetStringValue(HKEY_LOCAL_MACHINE, strBaseKey &amp; strSubKey, _
        "ParentKeyName", strValue6)
    If intRet &lt;&gt; 0 Then
        intRet = oReg.GetStringValue(HKEY_LOCAL_MACHINE, strBaseKey &amp; strSubKey, _
        "QuietDisplayName", strValue)
    End If

    If (strValue &lt;&gt; "") and (intRet = 0)   Then
       sf1=strValue
       sf2=strValue2
       sf4=strValue4
       sf3= strValue &amp; " | " &amp; strValue2 &amp; " | " &amp; strValue4 &amp; " |  SC=" &amp; strValue5 &amp; " |  PKN=" &amp; strValue6
       sf= sf3  &amp; " ; " &amp;   sf
       'WScript.Echo sf3
     End If
  Next

'WScript.Echo sf



REM '获取当前登录用户' 
Set colItems = objWMIService.ExecQuery( _ 
	"SELECT * FROM Win32_ComputerSystem",,48)  
For Each objItem in colItems  
	cuser=objItem.UserName
        optype=objItem.SystemType
	'Wscript.Echo "cuser: " &amp; cuser 
        'Wscript.Echo "optype: " &amp; optype
Next

REM '获取系统类型32 64' 
REM OS=OS  &amp; " ; " &amp; optype
'Wscript.Echo "OS: " &amp; OS


REM '定义查询sql串'
dim sqlStr

REM sqlStr = "{" &amp; chr(34) &amp; "Mauf" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; SPMauf &amp; ":" &amp; maufModel &amp; chr(34) &amp; "," &amp; chr(34) &amp; "DNS" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; DNS &amp; chr(34) &amp; "," &amp; chr(34) &amp; "Processor" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; Processor &amp; chr(34) &amp; "," &amp; chr(34) &amp; "Mem" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; Mem &amp; chr(34) &amp; ","	&amp; chr(34) &amp; "DESKINFO" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; disksn &amp; chr(34) &amp; ","	&amp; chr(34) &amp; "Mainboard" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; MdBd &amp; chr(34) &amp; ","	&amp; chr(34) &amp; "cpuUse" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; cpuUse &amp; "%" &amp; chr(34) &amp; "," &amp; chr(34) &amp; "UseMemory" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; LeftUseMemory &amp; "%" &amp; chr(34) &amp; ","	&amp; chr(34) &amp; "MainboardTemp" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; MainboardTemp &amp; chr(34) &amp; "," &amp; chr(34) &amp; "Driver" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; cpuCaption &amp; "/" &amp; DriverVersion &amp; "/" &amp; Network &amp; chr(34) &amp; ","	&amp; chr(34) &amp; "MaufSp" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; SPMauf &amp; ":" &amp; spv &amp; chr(34) &amp; "," 	&amp; chr(34) &amp; "Virus" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; softw &amp; chr(34) &amp; "," &amp; chr(34) &amp; "Mac" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; Mac &amp; chr(34) &amp;  ","  &amp; chr(34) &amp; "script_name" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; "C:\\EntegorAgent\\scripts\\collect\\code.vbs"  &amp; chr(34) &amp; ","&amp; chr(34) &amp; "diftime" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; diftime &amp; chr(34) &amp; "}"
sqlStr = "{" &amp; chr(34) &amp; "Mauf" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; SPMauf &amp; ":" &amp; maufModel &amp; chr(34) &amp; "," &amp; chr(34) &amp; "DNS" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; DNS &amp; chr(34) &amp; "," &amp; chr(34) &amp; "Processor" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; Processor &amp; chr(34) &amp; "," &amp; chr(34) &amp; "Mem" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; Mem &amp; chr(34) &amp; ","	&amp; chr(34) &amp; "DESKINFO" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; disksn &amp; chr(34) &amp; ","	&amp; chr(34) &amp; "Mainboard" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; MdBd &amp; chr(34) &amp; ","	&amp; chr(34) &amp; "cpuUse" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; cpuUse &amp; "%" &amp; chr(34) &amp; "," &amp; chr(34) &amp; "UseMemory" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; LeftUseMemory &amp; "%" &amp; chr(34) &amp; ","	&amp; chr(34) &amp; "MainboardTemp" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; MainboardTemp &amp; chr(34) &amp; "," &amp; chr(34) &amp; "Driver" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; cpuCaption &amp; " / " &amp; DriverVersion &amp; " / " &amp; Network &amp; chr(34) &amp; ","	&amp; chr(34) &amp; "MaufSp" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; SPMauf &amp; ":" &amp; spv &amp; chr(34) &amp; "," 	&amp; chr(34) &amp; "Virus" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; softw &amp; chr(34) &amp; "," &amp; chr(34) &amp; "Mac" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; Mac &amp; chr(34) &amp;  ","  &amp; chr(34) &amp; "script_name" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; "C:\\EntegorAgent\\scripts\\collect\\code.vbs"  &amp; chr(34) &amp; "," &amp; chr(34) &amp; "Model" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; Model &amp; chr(34) &amp; "," &amp; chr(34) &amp; "OpDte" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; OpDte &amp; chr(34) &amp; "," &amp; chr(34) &amp; "sn" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; sn &amp; chr(34) &amp; "," &amp; chr(34) &amp; "OS" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; OS &amp; chr(34) &amp; "," &amp; chr(34) &amp; "IP" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; IP &amp; chr(34) &amp; "," &amp; chr(34) &amp; "HostName" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; HostName &amp; chr(34) &amp; ","&amp; chr(34) &amp; "dte" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; CurrentDate &amp;"-"&amp; CurrentTime &amp; chr(34) &amp; ","&amp; chr(34) &amp; "aduser" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; aduser &amp; chr(34) &amp; ","&amp; chr(34) &amp; "chkhotfix" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; chkhotfix &amp; chr(34) &amp; ","&amp; chr(34) &amp; "software" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; sf &amp; chr(34) &amp; ","&amp; chr(34) &amp; "usbstat" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; usbstat &amp; chr(34) &amp; ","&amp; chr(34) &amp; "mcfdate" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; mcfdate &amp; chr(34) &amp; ","&amp; chr(34) &amp; "fixdate" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; fixdate &amp; chr(34) &amp; ","&amp; chr(34) &amp; "diftime" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; diftime &amp; chr(34) &amp; ","&amp; chr(34) &amp; "backName" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; backName &amp; chr(34) &amp; "}"
REM sqlStr = "{" &amp; chr(34) &amp; "Model" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; Model &amp; chr(34) &amp; "," &amp; chr(34) &amp; "OpDte" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; OpDte &amp; chr(34) &amp; "," &amp; chr(34) &amp; "sn" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; sn &amp; chr(34) &amp; "," &amp; chr(34) &amp; "OS" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; OS &amp; chr(34) &amp; "," &amp; chr(34) &amp; "IP" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; IP &amp; chr(34) &amp; "," &amp; chr(34) &amp; "HostName" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; HostName &amp; chr(34) &amp; ","&amp; chr(34) &amp; "dte" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; CurrentDate &amp;"-"&amp; CurrentTime &amp; chr(34) &amp; ","&amp; chr(34) &amp; "aduser" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; aduser &amp; chr(34) &amp; ","&amp; chr(34) &amp; "chkhotfix" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; chkhotfix &amp; chr(34) &amp; ","&amp; chr(34) &amp; "software" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; sf &amp; chr(34) &amp; ","&amp; chr(34) &amp; "usbstat" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; usbstat &amp; chr(34) &amp; ","&amp; chr(34) &amp; "mcfdate" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; mcfdate &amp; chr(34) &amp; ","&amp; chr(34) &amp; "fixdate" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; fixdate &amp; chr(34) &amp; ","&amp; chr(34) &amp; "diftime" &amp; chr(34) &amp; ":" &amp; chr(34) &amp; diftime &amp; chr(34) &amp; "}"


Wscript.Echo sqlStr

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/158fda2dc1806aa2682d7f4f63ac9bb1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL中并发事务会带来哪些问题？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6cafb2044ab4b41f5f49aae9659d4a7a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">杰魔（Geomagic Design）逆向工程软件学习0-产品逆向工程介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>