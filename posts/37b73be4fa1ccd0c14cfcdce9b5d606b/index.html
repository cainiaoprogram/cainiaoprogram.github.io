<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HarmonyOS应用开发学习笔记 UI布局学习 List(){}创建列表 列表形式显示 简单使用 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="HarmonyOS应用开发学习笔记 UI布局学习 List(){}创建列表 列表形式显示 简单使用" />
<meta property="og:description" content="List 创建列表 列表形式显示
官方文档：创建列表（List）
关键代码
List(){} 列表控件ListItem() {} 子元素 例如
1、简单使用代码 List(){} List() { ListItem() { Row() { Image($r(&#39;app.media.iconE&#39;)) .width(40) .height(40) .margin(10) Text(&#39;小明&#39;) .fontSize(20) } } ListItem() { Row() { Image($r(&#39;app.media.iconF&#39;)) .width(40) .height(40) .margin(10) Text(&#39;小红&#39;) .fontSize(20) } } } 2、迭代列表内容 ForEach import util from &#39;@ohos.util&#39;; class Contact { key: string = util.generateRandomUUID(true); name: string; icon: Resource; constructor(name: string, icon: Resource) { this.name = name; this.icon = icon; } } @Entry @Component struct SimpleContacts { private contacts = [ new Contact(&#39;小明&#39;, $r(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/37b73be4fa1ccd0c14cfcdce9b5d606b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-10T15:51:49+08:00" />
<meta property="article:modified_time" content="2024-01-10T15:51:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">HarmonyOS应用开发学习笔记 UI布局学习 List(){}创建列表 列表形式显示 简单使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>List 创建列表 列表形式显示</strong></p> 
<p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/arkts-layout-development-create-list-0000001451074018-V2#section53882053105520" rel="nofollow">官方文档：创建列表（List）</a></p> 
<p><strong>关键代码</strong></p> 
<ul><li>List(){} 列表控件</li><li>ListItem() {} 子元素</li></ul> 
<p><strong>例如</strong><br> <img src="https://images2.imgbox.com/21/a1/M09ZRfVj_o.png" alt="在这里插入图片描述" width="400" height="190"></p> 
<h3><a id="1__List_11"></a>1、简单使用代码 List(){}</h3> 
<pre><code>List() {
  ListItem() {
    Row() {
      Image($r('app.media.iconE'))
        .width(40)
        .height(40)
        .margin(10)

      Text('小明')
        .fontSize(20)
    }
  }

  ListItem() {
    Row() {
      Image($r('app.media.iconF'))
        .width(40)
        .height(40)
        .margin(10)

      Text('小红')
        .fontSize(20)
    }
  }
}
</code></pre> 
<h3><a id="2_ForEach_40"></a>2、迭代列表内容 ForEach</h3> 
<pre><code>import util from '@ohos.util';

class Contact {
  key: string = util.generateRandomUUID(true);
  name: string;
  icon: Resource;

  constructor(name: string, icon: Resource) {
    this.name = name;
    this.icon = icon;
  }
}

@Entry
@Component
struct SimpleContacts {
  private contacts = [
    new Contact('小明', $r("app.media.iconA")),
    new Contact('小红', $r("app.media.iconB")),
    ...
  ]

  build() {
    List() {
      ForEach(this.contacts, (item: Contact) =&gt; {
        ListItem() {
          Row() {
            Image(item.icon)
              .width(40)
              .height(40)
              .margin(10)
            Text(item.name).fontSize(20)
          }
          .width('100%')
          .justifyContent(FlexAlign.Start)
        }
      }, item =&gt; item.key)
    }
    .width('100%')
  }
}
</code></pre> 
<h3><a id="3_listDirection_86"></a>3、列表方向 listDirection</h3> 
<p><strong>关键代码:listDirection(Axis.Horizontal)</strong></p> 
<ul><li>默认竖直方向 Axis.Vertical</li></ul> 
<pre><code>List() {
  ...
}
.listDirection(Axis.Horizontal) //列表水平方向
</code></pre> 
<h3><a id="4_space_99"></a>4、设置内容间距 space</h3> 
<pre><code>List({ space: 10 }) {
  ...
}
</code></pre> 
<h3><a id="5_divider_107"></a>5、分隔符的设置 divider</h3> 
<pre><code>List() {
  ...
}
.divider({
  strokeWidth: 1,
  startMargin: 60,
  endMargin: 10,
  color: '#ffe9f0f0'
})
</code></pre> 
<ul><li> 
  <ol><li>分隔线的宽度会使ListItem之间存在一定间隔，当List设置的内容间距小于分隔线宽度时，ListItem之间的间隔会使用分隔线的宽度。</li></ol> </li><li> 
  <ol start="2"><li>当List存在多列时，分割线的startMargin和endMargin作用于每一列上。</li></ol> </li><li> 
  <ol start="3"><li>List组件的分隔线画在两个ListItem之间，第一个ListItem上方和最后一个ListItem下方不会绘制分隔线。</li></ol> </li></ul> 
<h3><a id="6_scrollBar_125"></a>6、滚动条的设置 scrollBar（）</h3> 
<ul><li>BarState.on 打开</li><li>BarState.Off 关闭</li><li>BarState.Auto 自动 （滚动时显示，2秒后隐藏）</li></ul> 
<pre><code>List() {
  ...
}
.scrollBar(BarState.Auto)
</code></pre> 
<h3><a id="7_itemHead_137"></a>7、支持分组列表 itemHead</h3> 
<p><img src="https://images2.imgbox.com/5a/d5/Y10zJXSq_o.png" alt="在这里插入图片描述" width="300" height="250"></p> 
<pre><code>@Component
struct ContactsList {
  ...
  
  @Builder itemHead(text: string) {
    // 列表分组的头部组件，对应联系人分组A、B等位置的组件
    Text(text)
      .fontSize(20)
      .backgroundColor('#fff1f3f5')
      .width('100%')
      .padding(5)
  }

  build() {
    List() {
      ListItemGroup({ header: this.itemHead('A') }) {
        // 循环渲染分组A的ListItem
        ...
      }
      ...

      ListItemGroup({ header: this.itemHead('B') }) {
        // 循环渲染分组B的ListItem
        ...
      }
      ...
    }
  }
}
</code></pre> 
<h3><a id="8__stickyStickyStyleHeader_173"></a>8、添加粘性标题 .sticky(StickyStyle.Header)</h3> 
<ul><li>如果需要支持吸底效果，可以通过footer参数初始化ListItemGroup的底部组件，并将sticky属性设置为StickyStyle.Footer</li></ul> 
<p><img src="https://images2.imgbox.com/9c/24/eaktNTZf_o.png" alt="在这里插入图片描述" width="600" height="250"></p> 
<pre><code>@Component
struct ContactsList {
  // 定义分组联系人数据集合contactsGroups数组
  ...
 
  @Builder itemHead(text: string) {
    // 列表分组的头部组件，对应联系人分组A、B等位置的组件
    Text(text)
      .fontSize(20)
      .backgroundColor('#fff1f3f5')
      .width('100%')
      .padding(5)
  }

  build() {
    List() {
      // 循环渲染ListItemGroup，contactsGroups为多个分组联系人contacts和标题title的数据集合
      ForEach(this.contactsGroups, item =&gt; {
        ListItemGroup({ header: this.itemHead(item.title) }) {
          // 循环渲染ListItem
          ForEach(item.contacts, (contact) =&gt; {
            ListItem() {
              ...
            }
          }, item =&gt; item.key)
        }
        ...
      })
    }
    .sticky(StickyStyle.Header)  // 设置吸顶，实现粘性标题效果
  }
}
</code></pre> 
<h3><a id="9list_214"></a>9、list快速返回列表顶部</h3> 
<p><strong>1） 首先，需要创建一个Scroller的对象listScroller</strong></p> 
<pre><code>private listScroller: Scroller = new Scroller();
</code></pre> 
<p><strong>2）然后，通过将listScroller用于初始化List组件的scroller参数，完成listScroller与列表的绑定。在需要跳转的位置指定scrollToIndex的参数为0，表示返回列表顶部。</strong></p> 
<pre><code>Stack({ alignContent: Alignment.BottomEnd }) {
  // 将listScroller用于初始化List组件的scroller参数，完成listScroller与列表的绑定。
  List({ space: 20, scroller: this.listScroller }) {
    ...
  }
  ...

  Button() {
    ...
  }
  .onClick(() =&gt; {
    // 点击按钮时，指定跳转位置，返回列表顶部
    this.listScroller.scrollToIndex(0)
  })
  ...
}
</code></pre> 
<h3><a id="10_AlphabetIndexer_241"></a>10、响应滚动位置 AlphabetIndexer</h3> 
<p><img src="https://images2.imgbox.com/86/32/WaadZ5jc_o.png" alt="在这里插入图片描述"></p> 
<pre><code>...
const alphabets = ['#', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K',
  'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];

@Entry
@Component
struct ContactsList {
  @State selectedIndex: number = 0;
  private listScroller: Scroller = new Scroller();
  ...

  build() {
    Stack({ alignContent: Alignment.End }) {
      List({ scroller: this.listScroller }) {
        ...
      }
      .onScrollIndex((firstIndex: number) =&gt; {
          this.selectedIndex = firstIndex
        // 根据列表滚动到的索引值，重新计算对应联系人索引栏的位置this.selectedIndex
        ...
      })
      ...
      // 字母表索引组件
      AlphabetIndexer({ arrayValue: alphabets, selected: 0 })
        .selected(this.selectedIndex)
      ...
    }
  }
}
</code></pre> 
<h3><a id="11list__275"></a>11、list 响应列表项侧滑</h3> 
<p><img src="https://images2.imgbox.com/b6/54/2XTqslAi_o.png" alt="在这里插入图片描述"></p> 
<pre><code>@Entry
@Component
struct MessageList {
  @State messages: object[] = [
    // 初始化消息列表数据
    ...
  ];

  @Builder itemEnd(index: number) {
    // 侧滑后尾端出现的组件
    Button({ type: ButtonType.Circle }) {
      Image($r('app.media.ic_public_delete_filled'))
        .width(20)
        .height(20)
    }
    .onClick(() =&gt; {
      this.messages.splice(index, 1);
    })
    ...
  }
  build() {
    ...
      List() {
        ForEach(this.messages, (item, index) =&gt; {
          ListItem() {
            ...
          }
          .swipeAction({ end: this.itemEnd.bind(this, index) }) // 设置侧滑属性
        }, item =&gt; item.id.toString())
      }
    ...
  }
}
</code></pre> 
<h3><a id="12list__LazyForEach_cachedCount_313"></a>12、list 懒加载 LazyForEach cachedCount</h3> 
<p><strong>原因：</strong><br> 当数据量多的时候，为了减少内存，一般用懒加载缓存，显示屏幕内容，和渲染一定数量的缓存，当滑动的时候再加载没有渲染的内容，释放缓存外的内容，达到释放缓存的目的</p> 
<p><strong>目的：</strong></p> 
<ul><li>cachedCount的增加会增大UI的CPU、内存开销。使用时需要根据实际情况，综合性能和用户体验进行调整。</li><li>列表使用数据懒加载时，除了显示区域的列表项和前后缓存的列表项，其他列表项会被销毁。</li></ul> 
<p><strong>关键代码：</strong></p> 
<ul><li>LazyForEach</li><li>.cachedCount(3)</li></ul> 
<pre><code>List() {
  LazyForEach(this.dataSource, item =&gt; {
    ListItem() {
      ...
    }
  })
}.cachedCount(3)	
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c1bbbe4a41f1e76e8f4feda982515522/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">理解Herbrand Equivalence</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/98a4e6cc4063885d7f7e3cf6d6dba722/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">评测集开放丨中文读唇总动员：CNVSRC 2023 中文连续视觉语音识别挑战赛</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>