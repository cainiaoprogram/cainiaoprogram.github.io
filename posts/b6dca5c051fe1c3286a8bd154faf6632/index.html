<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>利用R语言heatmap.2函数进行聚类并画热图 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="利用R语言heatmap.2函数进行聚类并画热图" />
<meta property="og:description" content="数据聚类然后展示聚类热图是生物信息中组学数据分析的常用方法，在R语言中有很多函数可以实现，譬如heatmap,kmeans等，除此外还有一个用得比较多的就是heatmap.2。最近在网上看到一个笔记文章关于《一步一步学heatmap.2函数》，在此与大家分享。由于原作者不详，暂未标记来源，请原作者前来认领哦，O(∩_∩)O哈哈~
数据如下：
library(gplots)data(mtcars)x &lt;- as.matrix(mtcars)rc &lt;- rainbow(nrow(x), start=0, end=.3)cc &lt;- rainbow(ncol(x), start=0, end=.3) X就是一个矩阵，里面是我们需要画热图的数据。
Rc是一个调色板，有32个颜色，渐进的
Cc也是一个调色板，有11个颜色，也是渐进的
首先画一个默认的图：
heatmap.2(x) 然后可以把聚类数可以去掉：就是控制这个dendrogram参数
heatmap.2(x, dendrogram=“none”) 然后我们控制一下聚类树
heatmap.2(x, dendrogram=“row”) # 只显示行向量的聚类情况heatmap.2(x, dendrogram=“col”) #只显示列向量的聚类情况 下面还是在调控聚类树，但是我没看懂跟上面的参数有啥子区别！
heatmap.2(x, keysize=2) ## default - dendrogram plotted and reordering done.heatmap.2(x, Rowv=FALSE, dendrogram=“both”) ## generate warning!heatmap.2(x, Rowv=NULL, dendrogram=“both”) ## generate warning!heatmap.2(x, Colv=FALSE, dendrogram=“both”) ## generate warning! 接下来我们可以调控行列向量的label的字体大小方向
首先我们调控列向量，也就是x轴的label
heatmap.2(x, srtCol=NULL)heatmap.2(x, srtCol=0, adjCol = c(0.5,1) )heatmap.2(x, srtCol=45, adjCol = c(1,1) )heatmap.2(x, srtCol=135, adjCol = c(1,0) )heatmap." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b6dca5c051fe1c3286a8bd154faf6632/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-08T00:33:02+08:00" />
<meta property="article:modified_time" content="2023-12-08T00:33:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">利用R语言heatmap.2函数进行聚类并画热图</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<p>数据聚类然后展示聚类热图是生物信息中组学数据分析的常用方法，在R语言中有很多函数可以实现，譬如heatmap,kmeans等，除此外还有一个用得比较多的就是heatmap.2。最近在网上看到一个笔记文章关于《一步一步学heatmap.2函数》，在此与大家分享。由于原作者不详，暂未标记来源，请原作者前来认领哦，O(∩_∩)O哈哈~</p> 
<p>数据如下：</p> 
<div class="codebox"> 
 <div class="btn-clipboard bgt" title="Copy"> 
  <i class="be be-clipboard"></i> 
 </div> 
 <pre class="brush: r; gutter: true; first-line: 1 prettyprint linenums prettyprinted">  
  <ol class="linenums"><li class="L0"><span class="pln">library</span><span class="pun">(</span><span class="pln">gplots</span><span class="pun">)</span></li><li class="L1"><span class="pln">data</span><span class="pun">(</span><span class="pln">mtcars</span><span class="pun">)</span></li><li class="L2"><span class="pln">x </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="kwd">as</span><span class="pun">.</span><span class="pln">matrix</span><span class="pun">(</span><span class="pln">mtcars</span><span class="pun">)</span></li><li class="L3"><span class="pln">rc </span><span class="pun">&lt;-</span><span class="pln"> rainbow</span><span class="pun">(</span><span class="pln">nrow</span><span class="pun">(</span><span class="pln">x</span><span class="pun">),</span><span class="pln"> start</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">end</span><span class="pun">=.</span><span class="lit">3</span><span class="pun">)</span></li><li class="L4"><span class="pln">cc </span><span class="pun">&lt;-</span><span class="pln"> rainbow</span><span class="pun">(</span><span class="pln">ncol</span><span class="pun">(</span><span class="pln">x</span><span class="pun">),</span><span class="pln"> start</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">end</span><span class="pun">=.</span><span class="lit">3</span><span class="pun">)</span></li></ol></pre> 
</div> 
<p><img class="aligncenter size-full wp-image-10050" src="https://images2.imgbox.com/b8/35/kKBDq9Mk_o.png" alt="利用R语言heatmap.2函数进行聚类并画热图-图片1" width="562" height="157"></p> 
<p>X就是一个矩阵，里面是我们需要画热图的数据。</p> 
<p>Rc是一个调色板，有32个颜色，渐进的</p> 
<p>Cc也是一个调色板，有11个颜色，也是渐进的</p> 
<p>首先画一个默认的图：</p> 
<div class="codebox"> 
 <div class="btn-clipboard bgt" title="Copy"> 
  <i class="be be-clipboard"></i> 
 </div> 
 <pre class="brush: r; gutter: true; first-line: 1 prettyprint linenums prettyprinted">  
  <ol class="linenums"><li class="L0"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span></li></ol></pre> 
</div> 
<p><a href="https://static.plob.org//wp-content/uploads/2016/08/heatmap2plot20160826-2.png" rel="nofollow"><img class="aligncenter size-medium wp-image-10051" src="https://images2.imgbox.com/71/40/q7TCTO5g_o.png" alt="利用R语言heatmap.2函数进行聚类并画热图-图片2" width="700" height="429"></a></p> 
<p>然后可以把聚类数可以去掉：就是控制这个dendrogram参数</p> 
<div class="codebox"> 
 <div class="btn-clipboard bgt" title="Copy"> 
  <i class="be be-clipboard"></i> 
 </div> 
 <pre class="brush: r; gutter: true; first-line: 1 prettyprint linenums prettyprinted">  
  <ol class="linenums"><li class="L0"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> dendrogram</span><span class="pun">=</span><span class="str">“none”</span><span class="pun">)</span></li></ol></pre> 
</div> 
<p><a href="https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fstatic.plob.org%2F%2Fwp-content%2Fuploads%2F2016%2F08%2Fheatmap2plot20160826-3.png&amp;pos_id=img-DEXBTi5M-1701966776927%29" rel="nofollow"><img class="aligncenter size-full wp-image-10052" src="https://images2.imgbox.com/8e/f6/JDu8M2ba_o.png" alt="利用R语言heatmap.2函数进行聚类并画热图-图片3"></a></p> 
<p>然后我们控制一下聚类树</p> 
<div class="codebox"> 
 <div class="btn-clipboard bgt" title="Copy"> 
  <i class="be be-clipboard"></i> 
 </div> 
 <pre class="brush: r; gutter: true; first-line: 1 prettyprint linenums prettyprinted">  
  <ol class="linenums"><li class="L0"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> dendrogram</span><span class="pun">=</span><span class="str">“row”</span><span class="pun">)</span><span class="pln"> </span><span class="com"># 只显示行向量的聚类情况</span></li><li class="L1"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> dendrogram</span><span class="pun">=</span><span class="str">“col”</span><span class="pun">)</span><span class="pln"> </span><span class="com">#只显示列向量的聚类情况</span></li></ol></pre> 
</div> 
<p> </p> 
<p>下面还是在调控聚类树，但是我没看懂跟上面的参数有啥子区别！</p> 
<div class="codebox"> 
 <div class="btn-clipboard bgt" title="Copy"> 
  <i class="be be-clipboard"></i> 
 </div> 
 <pre class="brush: r; gutter: true; first-line: 1 prettyprint linenums prettyprinted">  
  <ol class="linenums"><li class="L0"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> keysize</span><span class="pun">=</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="com">## default - dendrogram plotted and reordering done.</span></li><li class="L1"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Rowv</span><span class="pun">=</span><span class="pln">FALSE</span><span class="pun">,</span><span class="pln"> dendrogram</span><span class="pun">=</span><span class="str">“both”</span><span class="pun">)</span><span class="pln"> </span><span class="com">## generate warning!</span></li><li class="L2"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Rowv</span><span class="pun">=</span><span class="pln">NULL</span><span class="pun">,</span><span class="pln"> dendrogram</span><span class="pun">=</span><span class="str">“both”</span><span class="pun">)</span><span class="pln"> </span><span class="com">## generate warning!</span></li><li class="L3"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Colv</span><span class="pun">=</span><span class="pln">FALSE</span><span class="pun">,</span><span class="pln"> dendrogram</span><span class="pun">=</span><span class="str">“both”</span><span class="pun">)</span><span class="pln"> </span><span class="com">## generate warning!</span></li></ol></pre> 
</div> 
<p>接下来我们可以调控行列向量的label的字体大小方向</p> 
<p>首先我们调控列向量，也就是x轴的label</p> 
<div class="codebox"> 
 <div class="btn-clipboard bgt" title="Copy"> 
  <i class="be be-clipboard"></i> 
 </div> 
 <pre class="brush: r; gutter: true; first-line: 1 prettyprint linenums prettyprinted">  
  <ol class="linenums"><li class="L0"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="pln">NULL</span><span class="pun">)</span></li><li class="L1"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> adjCol </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">(</span><span class="lit">0.5</span><span class="pun">,</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span></li><li class="L2"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">45</span><span class="pun">,</span><span class="pln"> adjCol </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span></li><li class="L3"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">135</span><span class="pun">,</span><span class="pln"> adjCol </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span></li><li class="L4"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">180</span><span class="pun">,</span><span class="pln"> adjCol </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">(</span><span class="lit">0.5</span><span class="pun">,</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span></li><li class="L5"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">225</span><span class="pun">,</span><span class="pln"> adjCol </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="com">## not very useful</span></li><li class="L6"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">270</span><span class="pun">,</span><span class="pln"> adjCol </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0.5</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span></li><li class="L7"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">315</span><span class="pun">,</span><span class="pln"> adjCol </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span></li><li class="L8"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">360</span><span class="pun">,</span><span class="pln"> adjCol </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">(</span><span class="lit">0.5</span><span class="pun">,</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span></li></ol></pre> 
</div> 
<p><img class="aligncenter size-full wp-image-10053" src="https://images2.imgbox.com/0b/79/dD2Ll3U0_o.png" alt="利用R语言heatmap.2函数进行聚类并画热图-图片4" width="1135" height="607"></p> 
<p>然后我们调控一下行向量，也就是y轴的label</p> 
<div class="codebox"> 
 <div class="btn-clipboard bgt" title="Copy"> 
  <i class="be be-clipboard"></i> 
 </div> 
 <pre class="brush: r; gutter: true; first-line: 1 prettyprint linenums prettyprinted">  
  <ol class="linenums"><li class="L0"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtRow</span><span class="pun">=</span><span class="lit">45</span><span class="pun">,</span><span class="pln"> adjRow</span><span class="pun">=</span><span class="pln">c</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span></li><li class="L1"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtRow</span><span class="pun">=</span><span class="lit">45</span><span class="pun">,</span><span class="pln"> adjRow</span><span class="pun">=</span><span class="pln">c</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">45</span><span class="pun">,</span><span class="pln"> adjCol</span><span class="pun">=</span><span class="pln">c</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span></li><li class="L2"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtRow</span><span class="pun">=</span><span class="lit">45</span><span class="pun">,</span><span class="pln"> adjRow</span><span class="pun">=</span><span class="pln">c</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">270</span><span class="pun">,</span><span class="pln"> adjCol</span><span class="pun">=</span><span class="pln">c</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0.5</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span></li></ol></pre> 
</div> 
<p><img class="aligncenter size-full wp-image-10054" src="https://images2.imgbox.com/b0/a6/NqfQv2sH_o.png" alt="利用R语言heatmap.2函数进行聚类并画热图-图片5" width="334" height="450"></p> 
<p>设置 offsetRow/offsetCol 可以把label跟热图隔开！</p> 
<div class="codebox"> 
 <div class="btn-clipboard bgt" title="Copy"> 
  <i class="be be-clipboard"></i> 
 </div> 
 <pre class="brush: r; gutter: true; first-line: 1 prettyprint linenums prettyprinted">  
  <ol class="linenums"><li class="L0"><span class="com">## Show effect of offsetRow/offsetCol (only works when srtRow/srtCol is </span></li><li class="L1"><span class="com">## not also present) heatmap.2(x, offsetRow=0, offsetCol=0)</span></li><li class="L2"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> offsetRow</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> offsetCol</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span></li><li class="L3"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> offsetRow</span><span class="pun">=</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> offsetCol</span><span class="pun">=</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span></li><li class="L4"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> offsetRow</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> offsetCol</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span></li><li class="L5"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtRow</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">90</span><span class="pun">,</span><span class="pln"> offsetRow</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> offsetCol</span><span class="pun">=</span><span class="lit">0</span><span class="pun">)</span></li><li class="L6"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtRow</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">90</span><span class="pun">,</span><span class="pln"> offsetRow</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> offsetCol</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span></li><li class="L7"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtRow</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">90</span><span class="pun">,</span><span class="pln"> offsetRow</span><span class="pun">=</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> offsetCol</span><span class="pun">=</span><span class="lit">2</span><span class="pun">)</span></li><li class="L8"><span class="pln">heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> srtRow</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> srtCol</span><span class="pun">=</span><span class="lit">90</span><span class="pun">,</span><span class="pln"> offsetRow</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> offsetCol</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">)</span></li></ol></pre> 
</div> 
<p><img class="aligncenter size-full wp-image-10055" src="https://images2.imgbox.com/3a/b8/vw8WI2oL_o.png" alt="利用R语言heatmap.2函数进行聚类并画热图-图片6" width="838" height="586"></p> 
<div class="codebox"> 
 <div class="btn-clipboard bgt" title="Copy"> 
  <i class="be be-clipboard"></i> 
 </div> 
 <pre class="brush: r; gutter: true; first-line: 1 prettyprint linenums prettyprinted">  
  <ol class="linenums"><li class="L0"><span class="com">## Show effect of z-score scaling within columns, blue-red color scale </span></li><li class="L1"><span class="pln">hv </span><span class="pun">&lt;-</span><span class="pln"> heatmap</span><span class="pun">.</span><span class="lit">2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> col</span><span class="pun">=</span><span class="pln">bluered</span><span class="pun">,</span><span class="pln"> scale</span><span class="pun">=</span><span class="str">“column”</span><span class="pun">,</span><span class="pln"> tracecol</span><span class="pun">=</span><span class="str">“#303030”</span><span class="pun">)</span></li></ol></pre> 
</div> 
<p>hv是一个热图对象！！！</p> 
<div class="codebox"> 
 <div class="btn-clipboard bgt" title="Copy"> 
  <i class="be be-clipboard"></i> 
 </div> 
 <pre class="brush: r; gutter: true; first-line: 1 prettyprint linenums prettyprinted">  
  <ol class="linenums"><li class="L0"><span class="pun">&gt;</span><span class="pln"> names</span><span class="pun">(</span><span class="pln">hv</span><span class="pun">)</span><span class="pln"> </span><span class="com"># 可以看到hv对象里面有很多子对象</span></li><li class="L1"><span class="pun">&gt;</span><span class="pln"> </span><span class="str">“rowInd”</span><span class="pln"> </span><span class="str">“colInd”</span><span class="pln"> </span><span class="str">“call”</span><span class="pln"> </span><span class="str">“colMeans”</span><span class="pln"> </span><span class="str">“colSDs”</span><span class="pln"> </span><span class="str">“carpet”</span><span class="pln"> </span><span class="str">“rowDendrogram”</span><span class="pln"> </span><span class="str">“colDendrogram”</span><span class="pln"> </span><span class="str">“breaks”</span><span class="pln"> </span><span class="str">“col”</span><span class="pln"> </span><span class="str">“vline”</span><span class="pln"> </span><span class="str">“colorTable”</span><span class="pln"> </span><span class="com">## Show the mapping of z-score values to color bins hv<span class="katex--inline">KaTeX parse error: Expected 'EOF', got '#' at position 638: …an class="com"&gt;#̲# Extract the r…</span>colorTable</span><span class="pun">[</span><span class="pln">hv<span class="katex--inline">KaTeX parse error: Expected 'EOF', got '#' at position 124: …n class="str"&gt;"#̲FFFFFF"&lt;/span&gt;&lt;…</span>colorTable</span><span class="pun">[</span><span class="pln">hv<span class="katex--inline">KaTeX parse error: Expected 'EOF', got '#' at position 124: …n class="str"&gt;"#̲FFFFFF"&lt;/span&gt;&lt;…</span>colSDs </span><span class="pun">+</span><span class="pln"> hv<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             c 
            
           
             o 
            
           
             l 
            
           
             M 
            
           
             e 
            
           
             a 
            
           
             n 
            
           
             s 
            
           
             &lt; 
            
           
             / 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             &gt; 
            
           
             &lt; 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             c 
            
           
             l 
            
           
             a 
            
           
             s 
            
           
             s 
            
           
             = 
            
           
             " 
            
           
             p 
            
           
             u 
            
           
             n 
            
           
             " 
            
           
             &gt; 
            
           
             , 
            
           
             &lt; 
            
           
             / 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             &gt; 
            
           
             &lt; 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             c 
            
           
             l 
            
           
             a 
            
           
             s 
            
           
             s 
            
           
             = 
            
           
             " 
            
           
             p 
            
           
             l 
            
           
             n 
            
           
             " 
            
           
             &gt; 
            
           
             w 
            
           
             h 
            
           
             i 
            
           
             t 
            
           
             e 
            
           
             B 
            
           
             i 
            
           
             n 
            
           
             &lt; 
            
           
             / 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             &gt; 
            
           
             &lt; 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             c 
            
           
             l 
            
           
             a 
            
           
             s 
            
           
             s 
            
           
             = 
            
           
             " 
            
           
             p 
            
           
             u 
            
           
             n 
            
           
             " 
            
           
             &gt; 
            
           
             [ 
            
           
             &lt; 
            
           
             / 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             &gt; 
            
           
             &lt; 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             c 
            
           
             l 
            
           
             a 
            
           
             s 
            
           
             s 
            
           
             = 
            
           
             " 
            
           
             l 
            
           
             i 
            
           
             t 
            
           
             " 
            
           
             &gt; 
            
           
             2 
            
           
             &lt; 
            
           
             / 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             &gt; 
            
           
             &lt; 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             c 
            
           
             l 
            
           
             a 
            
           
             s 
            
           
             s 
            
           
             = 
            
           
             " 
            
           
             p 
            
           
             u 
            
           
             n 
            
           
             " 
            
           
             &gt; 
            
           
             ] 
            
           
             &lt; 
            
           
             / 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             &gt; 
            
           
             &lt; 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             c 
            
           
             l 
            
           
             a 
            
           
             s 
            
           
             s 
            
           
             = 
            
           
             " 
            
           
             p 
            
           
             l 
            
           
             n 
            
           
             " 
            
           
             &gt; 
            
           
             &lt; 
            
           
             / 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             &gt; 
            
           
             &lt; 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             c 
            
           
             l 
            
           
             a 
            
           
             s 
            
           
             s 
            
           
             = 
            
           
             " 
            
           
             p 
            
           
             u 
            
           
             n 
            
           
             " 
            
           
             &gt; 
            
           
             ∗ 
            
           
             &lt; 
            
           
             / 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             &gt; 
            
           
             &lt; 
            
           
             s 
            
           
             p 
            
           
             a 
            
           
             n 
            
           
             c 
            
           
             l 
            
           
             a 
            
           
             s 
            
           
             s 
            
           
             = 
            
           
             " 
            
           
             p 
            
           
             l 
            
           
             n 
            
           
             " 
            
           
             &gt; 
            
           
             h 
            
           
             v 
            
           
          
            colMeans&lt;/span&gt;&lt;span class="pun"&gt;,&lt;/span&gt;&lt;span class="pln"&gt; whiteBin&lt;/span&gt;&lt;span class="pun"&gt;[&lt;/span&gt;&lt;span class="lit"&gt;2&lt;/span&gt;&lt;span class="pun"&gt;]&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;*&lt;/span&gt;&lt;span class="pln"&gt; hv 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7335em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal" style="margin-right: 0.109em;">lM</span><span class="mord mathnormal">e</span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord">"</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord">"</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height: 0.7335em; vertical-align: -0.1944em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord">"</span><span class="mord mathnormal" style="margin-right: 0.0197em;">pl</span><span class="mord mathnormal">n</span><span class="mord">"</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7335em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mord mathnormal">in</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord">"</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord">"</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7335em; vertical-align: -0.0391em;"></span><span class="mord">"</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord">"</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6835em; vertical-align: -0.0391em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord">"</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord">"</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord">"</span><span class="mord mathnormal" style="margin-right: 0.0197em;">pl</span><span class="mord mathnormal">n</span><span class="mord">"</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord">"</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord">"</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord">∗</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">an</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord">"</span><span class="mord mathnormal" style="margin-right: 0.0197em;">pl</span><span class="mord mathnormal">n</span><span class="mord">"</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span></span></span></span></span>colSDs </span><span class="pun">+</span><span class="pln"> hv<span class="katex--inline">KaTeX parse error: Expected 'EOF', got '#' at position 1148: …n class="str"&gt;"#̲303030"&lt;/span&gt;&lt;…</span>Type</span><span class="pun">)],</span></li><li class="L4"><span class="pln"> xlab</span><span class="pun">=</span><span class="str">‘CellLines’</span><span class="pun">,</span></li><li class="L5"><span class="pln"> ylab</span><span class="pun">=</span><span class="str">‘Probes’</span><span class="pun">,</span></li><li class="L6"><span class="pln"> main</span><span class="pun">=</span><span class="typ">Cluster_Method</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span></li><li class="L7"><span class="pln"> col</span><span class="pun">=</span><span class="pln">greenred</span><span class="pun">(</span><span class="lit">64</span><span class="pun">))</span></li><li class="L8"><span class="pln"> dev</span><span class="pun">.</span><span class="pln">off</span><span class="pun">()</span></li><li class="L9"><span class="pun">}</span></li></ol></pre> 
</div> 
<p> </p> 
<p>这样就可以一下子把七种cluster的方法依次用到heatmap上面来。而且通过对cluster树的比较，我们可以从中挑选出最好、最稳定到cluster方法，为后续分析打好基础！</p> 
<p> </p> 
<p>对下面这个数据聚类：</p> 
<p><a href="https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fstatic.plob.org%2F%2Fwp-content%2Fuploads%2F2016%2F08%2Fheatmap2plot20160826-12.png&amp;pos_id=img-5KR0UeVY-1701966778956%29" rel="nofollow"><img class="aligncenter size-full wp-image-10061" src="https://images2.imgbox.com/f1/33/TgP8TU1r_o.png" alt="利用R语言heatmap.2函数进行聚类并画热图-图片12" width="363" height="154"></a></p> 
<div class="codebox"> 
 <div class="btn-clipboard bgt" title="Copy"> 
  <i class="be be-clipboard"></i> 
 </div> 
 <pre class="brush: r; gutter: true; first-line: 1 prettyprint linenums prettyprinted">  
  <ol class="linenums"><li class="L0"><span class="kwd">require</span><span class="pun">(</span><span class="pln">graphics</span><span class="pun">)</span></li><li class="L1"><span class="pln">hc </span><span class="pun">&lt;-</span><span class="pln"> hclust</span><span class="pun">(</span><span class="pln">dist</span><span class="pun">(</span><span class="typ">USArrests</span><span class="pun">),</span><span class="pln"> </span><span class="str">“ave”</span><span class="pun">)</span></li><li class="L2"><span class="pln">plot</span><span class="pun">(</span><span class="pln">hc</span><span class="pun">)</span></li></ol></pre> 
</div> 
<p><a href="https://static.plob.org//wp-content/uploads/2016/08/heatmap2plot20160826-13.png" rel="nofollow"><img class="aligncenter size-medium wp-image-10062" src="https://images2.imgbox.com/9b/5d/1dbuEHqK_o.png" alt="利用R语言heatmap.2函数进行聚类并画热图-图片13" width="700" height="469"></a></p> 
<p>首先对一个数据框用dist函数处理得到一个dist对象！</p> 
<p><a href="https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fstatic.plob.org%2F%2Fwp-content%2Fuploads%2F2016%2F08%2Fheatmap2plot20160826-14.png&amp;pos_id=img-XMP67BuN-1701966780390%29" rel="nofollow"><img class="aligncenter size-full wp-image-10063" src="https://images2.imgbox.com/89/bf/BT8HSKcX_o.png" alt="利用R语言heatmap.2函数进行聚类并画热图-图片14" width="567" height="97"></a></p> 
<p>Dist对象比较特殊，专门为hclust函数来画聚类树的！</p> 
<p><a href="https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fstatic.plob.org%2F%2Fwp-content%2Fuploads%2F2016%2F08%2Fheatmap2plot20160826-15.png&amp;pos_id=img-0i7rhyva-1701966780959%29" rel="nofollow"><img class="aligncenter size-full wp-image-10064" src="https://images2.imgbox.com/4d/75/nPU2CvNd_o.png" alt="利用R语言heatmap.2函数进行聚类并画热图-图片15" width="643" height="122"></a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/587256c6e2c4aca32141c170cae537f0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用InfluxDB 3.0提高性能并降低存储成本</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/088e122d38ce2e3733253f89129a01f2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AI创作系统ChatGPT网站源码，AI绘画，支持GPT联网提问/即将支持TSS语音对话功能</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>