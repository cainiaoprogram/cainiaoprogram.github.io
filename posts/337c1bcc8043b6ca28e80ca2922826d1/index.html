<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>node项目自动打zip压缩包 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="node项目自动打zip压缩包" />
<meta property="og:description" content="node项目自动打zip压缩包 普通node项目 参考文章：
https://www.cnblogs.com/xieqian/p/10973324.htmlhttps://blog.csdn.net/weixin_43968658/article/details/102949470
安装依赖 yarn add compressing -D yarn add dayjs -D 脚本 node执行以下脚本，就可以实现将dist目录打包到./zip目录下，自定义zip文件名
const path = require(&#34;path&#34;); const fs = require(&#34;fs&#34;); const chalk = require(&#34;chalk&#34;); // 这个是主角 const compressing = require(&#34;compressing&#34;); const dayjs = require(&#34;dayjs&#34;); const resolve = dir =&gt; path.join(__dirname, &#34;..&#34;, dir); const publishPath = resolve(&#34;publish&#34;); const zipName = (() =&gt; `.zip/dist_sit_${dayjs().format(&#34;YYYYMMDDHHmm&#34;)}.zip`)(); // 判断是否存在当前publish路径，没有就新增 if (!fs.existsSync(publishPath)) { fs.mkdirSync(publishPath); } compressing.zip .compressDir(resolve(&#34;dist/&#34;), resolve(zipName)) .then(() =&gt; { console.log(chalk.yellow(`Tip: 文件压缩成功，已压缩至【${resolve(zipName)}】`)); }) ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/337c1bcc8043b6ca28e80ca2922826d1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-23T18:21:57+08:00" />
<meta property="article:modified_time" content="2020-12-23T18:21:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">node项目自动打zip压缩包</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <article class="_2rhmJa" style="font-size: 16px;"> 
 <h2>node项目自动打zip压缩包</h2> 
 <h3>普通node项目</h3> 
 <p>参考文章：</p> 
 <p><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.cnblogs.com%2Fxieqian%2Fp%2F10973324.html" rel="nofollow noopener noreferrer" target="_blank">https://www.cnblogs.com/xieqian/p/10973324.html</a><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fblog.csdn.net%2Fweixin_43968658%2Farticle%2Fdetails%2F102949470" rel="nofollow noopener noreferrer" target="_blank">https://blog.csdn.net/weixin_43968658/article/details/102949470</a></p> 
 <h4>安装依赖</h4> 
 <pre class="has"><code class="shell">yarn add compressing -D
yarn add dayjs -D</code></pre> 
 <h4>脚本</h4> 
 <p>node执行以下脚本，就可以实现将dist目录打包到./zip目录下，自定义zip文件名</p> 
 <pre class="has"><code class="js">const path = require("path");
const fs = require("fs");
const chalk = require("chalk");
// 这个是主角
const compressing = require("compressing");
const dayjs = require("dayjs");

const resolve = dir =&gt; path.join(__dirname, "..", dir);
const publishPath = resolve("publish");
const zipName = (() =&gt; `.zip/dist_sit_${dayjs().format("YYYYMMDDHHmm")}.zip`)();

// 判断是否存在当前publish路径，没有就新增
if (!fs.existsSync(publishPath)) {
  fs.mkdirSync(publishPath);
}

compressing.zip
  .compressDir(resolve("dist/"), resolve(zipName))
  .then(() =&gt; {
    console.log(chalk.yellow(`Tip: 文件压缩成功，已压缩至【${resolve(zipName)}】`));
  })
  .catch(err =&gt; {
    console.log(chalk.red("Tip: 压缩报错"));
    console.error(err);
  });</code></pre> 
 <h3>vue-cli2项目</h3> 
 <h4>安装依赖</h4> 
 <pre class="has"><code class="shell">yarn add filemanager-webpack-plugin@2.0.5 -D
yarn add dayjs -D</code></pre> 
 <h4>脚本</h4> 
 <pre class="has"><code class="js">const FileManagerWebpackPlugin = require('filemanager-webpack-plugin')
const dayjs = require("dayjs")
const zipName = `.zip/dist_sit_${dayjs().format("YYYYMMDDHHmm")}.zip`

let kkm = new FileManagerWebpackPlugin ({  // 需要在 plugins 数组里添加
  onEnd: {
    // delete: [
    //   './zip/xxxx.zip', // 删除之前已经存在的压缩包
    // ],
    mkdir: ['.zip'], // 需要先创建.zip文件夹，否则压缩会报找不到路径
    archive: [
      {source: './dist', destination: zipName},
    ]
  }
})

webpackConfig.plugins.push(kkm)

module.exports = webpackConfig</code></pre> 
 <h3>vue-cli3项目</h3> 
 <h4>安装依赖</h4> 
 <pre class="has"><code class="shell">yarn add filemanager-webpack-plugin@2.0.5 -D
yarn add dayjs -D</code></pre> 
 <h4>脚本</h4> 
 <pre class="has"><code class="js">const FileManagerPlugin = require('filemanager-webpack-plugin')
const dayjs = require('dayjs')

module.exports = {
  // 方式一：
  configureWebpack: { // webpack的相关配置在这里
    plugins: [
      new FileManagerPlugin({ // 初始化 filemanager-webpack-plugin 插件实例
        onEnd: {
          // delete: [ // 首先需要删除项目根目录下的dist.zip
          //   './projectName.zip'
          // ],
          mkdir: ['.zip'], // 需要先创建.zip文件夹，否则压缩会报找不到路径
          archive: [ // 然后我们选择dist文件夹将之打包成dist.zip并放在根目录
            { source: './dist', destination: `.zip/dist_sit_${dayjs().format('YYYYMMDDHHmm')}.zip` }
          ]
        }
      })
    ]
  }

  // 方式二：
  // chainWebpack: webpackConfig =&gt; {
  //   webpackConfig.plugin('zip').use(require('filemanager-webpack-plugin'), [
  //     {
  //       onEnd: {
  //         mkdir: ['.zip'], // 需要先创建.zip文件夹，否则压缩会报找不到路径
  //         archive: [
  //           {
  //             source: 'dist',
  //             destination: `.zip/dist_sit_${dayjs().format('YYYYMMDDHHmm')}.zip`
  //           }
  //         ]
  //       }
  //     }
  //   ])
  // }
}</code></pre> 
</article>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6dc36211b392e298aa730845fa963cf0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">List转array（数组）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/69297f7a8372994599d137dfa46ba323/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ios10前台收到推送_ios app 在前台时，个推推送的消息，receive 收到消息后创建本地消息（plus.push.createmessage()）,无限执行，是怎么回事?怎么判断呢？...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>