<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Tensorflow Android Demo 测试 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Tensorflow Android Demo 测试" />
<meta property="og:description" content="目录
下载源码:
​​​​​安装 Android Studio:
编译
调试手机连接问题
应用安装
主要参考文献:
测试环境: Ubuntu 18.04
下载源码: 实际只是用examples/android文件夹下的,但是tensorflow没有提供单独的文件夹下载,所以这里要下载整个tensorflow
git clone --recurse-submodules https://github.com/tensorflow/tensorflow.git ​​​​​安装 Android Studio: 在AS官网下载页面https://developer.android.com/studio#downloads 选择相应系统版本的压缩包下载.
参考https://developer.android.com/studio/install?hl=zh-cn 安装 AS, SDK和NDK
NDK不需要单独下载,在选择好要使用的版本的SDK后,在SDK tools 里勾选NDK即可,如下图
编译 打开前面下载的tensorflow中的android文件夹为工程文件夹
将 Gradle Scripts/build.gradle中的第45行
def nativeBuildSystem = &#39;bazel&#39; 修改为 def nativeBuildSystem = &#39;none&#39; 然后就可以编译了.
调试手机连接问题 编译成功后,在用手机调试安装时,我又遇到了AS无法识别手机的情况(尽管开启了USB调试),然后参照https://blog.csdn.net/w19961009/article/details/54952777这篇博文进行设置
首先在未连接手机的情况下,在terminal 中输入lsusb,获取当前usb设备列表
然后将手机与电脑连接,再次输入lsusb获取新的usb列表,前后对比即可找到自己的手机usbid,主要找到 xxxx:yyyy一共八位字符,然后
sudo vim /etc/udev/rules.d/90-android.rules 新建90-android.rules文件(此处推测前面的数字与手机的系统版本有关,之前试过51不起作用,换成90就可以了,我的系统是安卓9.0),将上面找到的xxxx:yyyy 分别写入下面的位置
SUBSYSTEM==&#34;usb&#34;, ATTRS{idVendor}==&#34;xxxx&#34;, ATTRS{idProduct}==&#34;yyyy&#34;, MODE=&#34;0666&#34; 然后保存退出,修改文件权限
chmod a&#43;x /etc/udev/rules.d/90-android.rules 随后执行下面命令,重启udev
sudo /etc/init.d/udev restart 然后在AS上面工具栏手机列表位置下拉选择Troubleshoot device connections" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/949dccfa06b7f46668864cbfbd42ef84/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-09-05T14:12:08+08:00" />
<meta property="article:modified_time" content="2019-09-05T14:12:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Tensorflow Android Demo 测试</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81%3A-toc" style="margin-left:40px;"><a href="#%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81%3A" rel="nofollow">下载源码:</a></p> 
<p id="%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E5%AE%89%E8%A3%85%20Android%20Studio%3A-toc" style="margin-left:40px;"><a href="#%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E5%AE%89%E8%A3%85%20Android%20Studio%3A" rel="nofollow">​​​​​安装 Android Studio:</a></p> 
<p id="-toc" style="margin-left:40px;"> </p> 
<p id="%E7%BC%96%E8%AF%91-toc" style="margin-left:40px;"><a href="#%E7%BC%96%E8%AF%91" rel="nofollow">编译</a></p> 
<p id="%E8%B0%83%E8%AF%95%E6%89%8B%E6%9C%BA%E8%BF%9E%E6%8E%A5%E9%97%AE%E9%A2%98-toc" style="margin-left:80px;"><a href="#%E8%B0%83%E8%AF%95%E6%89%8B%E6%9C%BA%E8%BF%9E%E6%8E%A5%E9%97%AE%E9%A2%98" rel="nofollow">调试手机连接问题</a></p> 
<p id="%E5%BA%94%E7%94%A8%E5%AE%89%E8%A3%85-toc" style="margin-left:40px;"><a href="#%E5%BA%94%E7%94%A8%E5%AE%89%E8%A3%85" rel="nofollow">应用安装</a></p> 
<p id="%E4%B8%BB%E8%A6%81%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%3A-toc" style="margin-left:40px;"><a href="#%E4%B8%BB%E8%A6%81%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%3A" rel="nofollow">主要参考文献:</a></p> 
<hr id="hr-toc"> 
<p>测试环境: Ubuntu 18.04</p> 
<p> </p> 
<h3 id="%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81%3A">下载源码:</h3> 
<p style="text-indent:33px;">实际只是用examples/android文件夹下的,但是tensorflow没有提供单独的文件夹下载,所以这里要下载整个tensorflow</p> 
<pre class="has"><code>git clone --recurse-submodules https://github.com/tensorflow/tensorflow.git</code></pre> 
<h3 id="%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E5%AE%89%E8%A3%85%20Android%20Studio%3A"><a href="https://github.com/tensorflow/tensorflow.git">​​​​​</a>安装 Android Studio:</h3> 
<p style="text-indent:33px;">在AS官网下载页面<a href="https://developer.android.com/studio#downloads" rel="nofollow">https://developer.android.com/studio#downloads</a> 选择相应系统版本的压缩包下载.</p> 
<p style="text-indent:33px;">参考<a href="https://developer.android.com/studio/install?hl=zh-cn" rel="nofollow">https://developer.android.com/studio/install?hl=zh-cn</a> 安装 AS, SDK和NDK</p> 
<p style="text-indent:33px;">NDK不需要单独下载,在选择好要使用的版本的SDK后,在SDK tools 里勾选NDK即可,如下图</p> 
<p style="text-indent:33px;"><img alt="" class="has" height="366" src="https://images2.imgbox.com/e3/4d/Ijt9YfNm_o.png" width="731"></p> 
<h3> </h3> 
<h3 id="%E7%BC%96%E8%AF%91">编译</h3> 
<p style="text-indent:33px;">打开前面下载的tensorflow中的android文件夹为工程文件夹</p> 
<p style="text-indent:33px;">将 Gradle Scripts/build.gradle中的第45行</p> 
<pre class="has"><code>def nativeBuildSystem = 'bazel' 修改为
def nativeBuildSystem = 'none'</code></pre> 
<p style="text-indent:33px;"><img alt="" class="has" height="50" src="https://images2.imgbox.com/a7/bf/3bJK3tzj_o.png" width="382"></p> 
<p style="text-indent:33px;">然后就可以编译了.</p> 
<h4 id="%E8%B0%83%E8%AF%95%E6%89%8B%E6%9C%BA%E8%BF%9E%E6%8E%A5%E9%97%AE%E9%A2%98">调试手机连接问题</h4> 
<p style="text-indent:33px;">编译成功后,在用手机调试安装时,我又遇到了AS无法识别手机的情况(尽管开启了USB调试),然后参照<a href="https://blog.csdn.net/w19961009/article/details/54952777">https://blog.csdn.net/w19961009/article/details/54952777</a>这篇博文进行设置</p> 
<p style="text-indent:33px;">首先在未连接手机的情况下,在terminal 中输入lsusb,获取当前usb设备列表</p> 
<p style="text-indent:33px;">然后将手机与电脑连接,再次输入lsusb获取新的usb列表,前后对比即可找到自己的手机usbid,主要找到 xxxx:yyyy一共八位字符,然后</p> 
<pre class="has"><code>sudo vim /etc/udev/rules.d/90-android.rules</code></pre> 
<p style="text-indent:33px;">新建90-android.rules文件(此处推测前面的数字与手机的系统版本有关,之前试过51不起作用,换成90就可以了,我的系统是安卓9.0),将上面找到的xxxx:yyyy 分别写入下面的位置</p> 
<pre class="has"><code>SUBSYSTEM=="usb", ATTRS{idVendor}=="xxxx", ATTRS{idProduct}=="yyyy", MODE="0666"</code></pre> 
<p style="text-indent:33px;">然后保存退出,修改文件权限</p> 
<pre class="has"><code>chmod a+x /etc/udev/rules.d/90-android.rules</code></pre> 
<p style="text-indent:33px;">随后执行下面命令,重启udev</p> 
<pre class="has"><code>sudo /etc/init.d/udev restart </code></pre> 
<p style="text-indent:33px;">然后在AS上面工具栏手机列表位置下拉选择Troubleshoot device connections</p> 
<p style="text-indent:33px;"><img alt="" class="has" height="187" src="https://images2.imgbox.com/72/4a/GB2goez8_o.png" width="428"></p> 
<p style="text-indent:33px;">在打开窗口中next-&gt;next-&gt;到最后一个页面,点击Restart ADB server</p> 
<p style="text-indent:33px;"><img alt="" class="has" height="118" src="https://images2.imgbox.com/7b/04/F9PRrAjs_o.png" width="369"></p> 
<p style="text-indent:33px;">等ADB重启后应该就可以正确识别手机设备了,可以插拔两次试试,注意手机屏幕弹出的调试请求要确认</p> 
<p> </p> 
<h3 id="%E5%BA%94%E7%94%A8%E5%AE%89%E8%A3%85">应用安装</h3> 
<p style="text-indent:33px;">本来以为这样应该就可以了,没想到又碰到了下载模型一直连接失败,多次尝试发现应该是GFW的原因,连接不上storage.google,试了各种代理也不行(此处吐槽一下AS的代理是真的难用),后面找到了下载models的网址就直接在浏览器下载后copy到对应文件夹了</p> 
<p style="text-indent:33px;">就是这几个models:</p> 
<p style="text-indent:33px;"><img alt="" class="has" height="178" src="https://images2.imgbox.com/7e/83/UvzVGljo_o.png" width="479"></p> 
<p style="text-indent:33px;">我上传到了限速云,有需要的可以自取:</p> 
<p style="text-indent:33px;">链接: https://pan.baidu.com/s/1aIu7R37ChRAM1eH-oz-Elg 提取码: mmy5 复制这段内容后打开百度网盘手机App，操作更方便哦</p> 
<p> </p> 
<p style="text-indent:33px;">因为手动下载了需要的models,所以需要把原来下载的代码注释掉,在android文件夹下面的Gradle Scripts/download-models.gradle中找到下面内容全部注释</p> 
<p style="text-indent:33px;"><img alt="" class="has" height="146" src="https://images2.imgbox.com/ec/62/76WzpEiu_o.png" width="534"></p> 
<p style="text-indent:33px;">然后把下载的models(不要copy文件夹,直接复制文件)到project.ext.TMP_DIR</p> 
<p style="text-indent:33px;">在build.gradle中可以找到TMP_DIR的定义(project.ext.TMP_DIR = project.buildDir.toString() + '/downloads')所以应该知道copy到哪了吧</p> 
<p style="text-indent:33px;">然后重新构建,在运行就可以正常启动了~安装成功后手机上会多出4个APP.</p> 
<p style="text-indent:33px;"> </p> 
<p style="text-indent:33px;"> </p> 
<h3 id="%E4%B8%BB%E8%A6%81%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%3A" style="text-indent:0px;">主要参考文献:</h3> 
<p style="text-indent:0;">官方源码文档readme: <a href="https://github.com/tensorflow/tensorflow/tree/master/tensorflow/examples/android">https://github.com/tensorflow/tensorflow/tree/master/tensorflow/examples/android</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1e0f0259ae6fdd2f0aef206f31906490/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">shell脚本: 删除系统中所有的[共享内存、信号量、消息队列]</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/11cc90f4937a89b1b9f37c3890305d96/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">脏读、脏写、不可重复读、更新丢失、写偏差、幻读</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>