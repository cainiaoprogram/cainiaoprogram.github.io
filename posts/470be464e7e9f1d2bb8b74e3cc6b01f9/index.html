<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用Python将一个excel的某些内容导入到新的excel中 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用Python将一个excel的某些内容导入到新的excel中" />
<meta property="og:description" content=" 工作中经常要汇总数据，每周的报告选取一些需要的列然后汇总成月报，每周的报告列的项目都是一样的，下面的数值不一样，目标就是用Python实现将多个excel的内容汇总到一个新的excel表格中。
在网上参考了好多例子都没有成功，最后找到了这个：https://blog.csdn.net/qq_45731111/article/details/102472406 亲测有效，感谢原博。
用我小白的编程水平完成了第一步。。。将一个excel的某些列导入到新的excel中。贴上代码：
import xlrd import xlwt datas=xlrd.open_workbook(&#39;D:\\1. Yield management\\1.FT yield summary\\XXXXXX Weekly report\\FT yield summary\\1750_202027FT_WEEKLY_SUMMARY.xlsx&#39;) #打开需要做处理的文件 table=datas.sheet_by_name(&#39;1750_202027FT_WEEKLY_SUMMARY&#39;) #通过名称获取工作表 sheet_name=datas.sheet_names() #获取所有的表名 nrows=table.nrows #获取工作表中所有行数 ncols=table.ncols #获取工作表中所有列数 wb=xlwt.Workbook() #新建一个excel文件 ws=wb.add_sheet(&#39;June FT yield&#39;) #新增一个表格，并且取名June FT yield for rownum in range(6,nrows): #相当于for rownum=6;rownum&#43;&#43;;rownum&lt;nrows，从6开始是因为summary里面第6行开始才是需要的数值 row=table.row_values(rownum) #从第6行开始到nrows最大值，获取每行的数值，整合成数组的形式 Date=str(row[0]) MoNumber=str(row[1]) PKG=str(row[2]) Device=str(row[3]) CustomerOrder=str(row[4]) WaferLot=str(row[5]) ProgramName=str(row[6]) Input=str(row[7]) Output=str(row[8]) Yield=str(row[9]) ws.write(rownum,0,label=Date) ws.write(rownum,1,label=MoNumber) ws.write(rownum,2,label=PKG) ws.write(rownum,3,label=Device) ws.write(rownum,4,label=CustomerOrder) ws.write(rownum,5,label=WaferLot) ws.write(rownum,6,label=ProgramName) ws.write(rownum,7,label=Input) ws.write(rownum,8,label=Output) ws.write(rownum,9,label=Yield) wb.save(&#39;example.xls&#39;) " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/470be464e7e9f1d2bb8b74e3cc6b01f9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-07-20T14:29:24+08:00" />
<meta property="article:modified_time" content="2020-07-20T14:29:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用Python将一个excel的某些内容导入到新的excel中</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>工作中经常要汇总数据，每周的报告选取一些需要的列然后汇总成月报，每周的报告列的项目都是一样的，下面的数值不一样，目标就是用Python实现将多个excel的内容汇总到一个新的excel表格中。<br> 在网上参考了好多例子都没有成功，最后找到了这个：https://blog.csdn.net/qq_45731111/article/details/102472406 亲测有效，感谢原博。<br> 用我小白的编程水平完成了第一步。。。将一个excel的某些列导入到新的excel中。贴上代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> xlrd
<span class="token keyword">import</span> xlwt
 
datas<span class="token operator">=</span>xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">'D:\\1. Yield management\\1.FT yield summary\\XXXXXX Weekly report\\FT yield summary\\1750_202027FT_WEEKLY_SUMMARY.xlsx'</span><span class="token punctuation">)</span>   <span class="token comment">#打开需要做处理的文件</span>
table<span class="token operator">=</span>datas<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span><span class="token string">'1750_202027FT_WEEKLY_SUMMARY'</span><span class="token punctuation">)</span>   <span class="token comment">#通过名称获取工作表</span>

sheet_name<span class="token operator">=</span>datas<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">#获取所有的表名</span>
nrows<span class="token operator">=</span>table<span class="token punctuation">.</span>nrows   <span class="token comment">#获取工作表中所有行数</span>
ncols<span class="token operator">=</span>table<span class="token punctuation">.</span>ncols   <span class="token comment">#获取工作表中所有列数</span>

wb<span class="token operator">=</span>xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">#新建一个excel文件</span>
ws<span class="token operator">=</span>wb<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">'June FT yield'</span><span class="token punctuation">)</span>   <span class="token comment">#新增一个表格，并且取名June FT yield</span>

<span class="token keyword">for</span> rownum <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span>nrows<span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token comment">#相当于for rownum=6;rownum++;rownum&lt;nrows，从6开始是因为summary里面第6行开始才是需要的数值</span>
    row<span class="token operator">=</span>table<span class="token punctuation">.</span>row_values<span class="token punctuation">(</span>rownum<span class="token punctuation">)</span>   <span class="token comment">#从第6行开始到nrows最大值，获取每行的数值，整合成数组的形式</span>
    Date<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
    MoNumber<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    PKG<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Device<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    CustomerOrder<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    WaferLot<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ProgramName<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Input<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Output<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Yield<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    ws<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rownum<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>label<span class="token operator">=</span>Date<span class="token punctuation">)</span>
    ws<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rownum<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>label<span class="token operator">=</span>MoNumber<span class="token punctuation">)</span>
    ws<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rownum<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>label<span class="token operator">=</span>PKG<span class="token punctuation">)</span>
    ws<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rownum<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>label<span class="token operator">=</span>Device<span class="token punctuation">)</span>
    ws<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rownum<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span>label<span class="token operator">=</span>CustomerOrder<span class="token punctuation">)</span>
    ws<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rownum<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>label<span class="token operator">=</span>WaferLot<span class="token punctuation">)</span>
    ws<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rownum<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span>label<span class="token operator">=</span>ProgramName<span class="token punctuation">)</span>
    ws<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rownum<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span>label<span class="token operator">=</span>Input<span class="token punctuation">)</span>
    ws<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rownum<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span>label<span class="token operator">=</span>Output<span class="token punctuation">)</span>
    ws<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rownum<span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span>label<span class="token operator">=</span>Yield<span class="token punctuation">)</span>
    wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'example.xls'</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/11dfba110707a733348ba63756409485/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CLion使用remote host在本地进行远程Linux程序调试</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3359ec734ee399858b6adefe877039fe/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">后台如何接收LocalDateTime类型</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>