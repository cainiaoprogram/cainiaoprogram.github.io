<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>概率笔记12——多维正态分布的最大似然估计 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="概率笔记12——多维正态分布的最大似然估计" />
<meta property="og:description" content="我们在前面的章节中见识过二维正态分布，(X,Y)服从参数为μ1, μ2, σ1, σ2, ρ的二维正态分布，记作(X, Y)~N(μ1, μ2, σ1, σ2, ρ)，它的密度函数：
其中μ1是第1维度的均值，σ12是第1维度的方差，ρ是将两个维度的相关性规范到-1到&#43;1之间的统计量，称为样本的相关系数，定义为：
对于二维正态随机变量(X,Y)，X和Y相互独立的充要条件是二者的协方差为0，也就是参数ρ=0。由于一维随机变量没有是否独立一说，ρ一定是0，因此没有在一维随机变量的正态分布中体现ρ。
下图是一个标准二维正态分布和其在x-z，y-z平面的投影：
多维正态分布 现在推广到多维，为了便于表达，我们用向量的形式表示随机变量和参数，对于n维随机变量：
这里只考虑所有维度变量互相独立的情况，即ρ=0的情况，此时密度函数可表示为：
上面的结果告诉我们，在各维度相互独立的情况下，多维正态分布的概率密度其实就是各个维度的正态分布密度函数的乘积。
在①中：
σi2表示xi的方差，如此看来，中间那个矩阵实际上是协方差矩阵的逆矩阵：
根据行列式的性质，上三角矩阵的行列式等于主对角线所有元素的乘积，斜对角矩阵当然也是一个上三角矩阵，因此协方差矩阵的行列式是：
将②、③代入①中，得到最终结果：
最大似然估计量 n维相互独立的随机变量x服从正态分布：
在求最大似然估计量时和一维随机变量有所区别，根据上一节的最终结果：
假设有m个可观察样本，那么最大似然函数是：
其对数似然函数是：
其中m和n是已知的，C 是一个常数。
求极值需要对μ和∑求偏导：
μ和∑是矩阵，涉及到矩阵的求导法则。先看对μ的求导，lnL由3个因子组成，只有一个因子含有μ，因此：
其中：
上式中：
因此：
将该结论代入∂lnL/∂μ中：
μ和∑是矩阵，根据矩阵的求导法则：
因为∑-1是一个对称矩阵，因此：
根据矩阵的求导法则：
将a1，a2代入∂lnL/∂μ 中：
再看对∑求偏导：
∑和∑-1都是实对称矩阵，根据矩阵的求导法则，当A是实对称矩阵时：
再看b2。设ωpq是∑第p行第q列的元素，Epq是一个第p行第q列元素为1，其它元素全为0的矩阵，E与∑-1同阶。根据矩阵的求导公式：
已经知道了∑-1是一个对称矩阵，矩阵乘法满足结合律，在不改变矩阵顺序的条件下可以任意加括号：
其中(∑-1(x(i)-μ))T是一个1*n的矩阵，(∑-1(x(i)-μ))Tp表示矩阵中的第p个元素；∑-1(x(i)-μ)是一个n*1的矩阵，(∑-1(x(i)-μ))q表示矩阵中的第q个元素。将该结论推广到矩阵对矩阵的的求导，根据矩阵对矩阵的求导公式：
其中：
在A1中，(∑-1(x(i)-μ))T是一个1*n的矩阵，(∑-1(x(i)-μ))Ti表示矩阵中的第i个元素，是一个标量；∑-1(x(i)-μ)是一个n*1的矩阵，(∑-1(x(i)-μ))i表示矩阵中的第i个元素，也是一个标量，因此：
终于可以求得b2了：
现在可以看看最终的似然函数：
I是单位矩阵，∑-1I=∑-1：
等号两侧同时左乘∑：
两侧同时右乘∑：
最终解得：
最终结论，多维正态分布的最大似然估计量是：
作者：我是8位的
出处：http://www.cnblogs.com/bigmonkey
本文以学习、研究和分享为主，如需转载，请联系本人，标明作者和出处，非商业用途！ 扫描二维码关注公作者众号“我是8位的”" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/9da7fe284741d81833a3a804b1bbd22a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-08-19T19:33:18+08:00" />
<meta property="article:modified_time" content="2019-08-19T19:33:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">概率笔记12——多维正态分布的最大似然估计</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>　　我们在前面的章节中见识过二维正态分布，(X,Y)服从参数为μ1, μ2, σ1, σ2, ρ的二维正态分布，记作(X, Y)~N(μ1, μ2, σ1, σ2, ρ)，它的密度函数：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/9f/4b/8fwVlQCT_o.png"></p> 
<p>　　其中μ1是第1维度的均值，σ12是第1维度的方差，ρ是将两个维度的相关性规范到-1到+1之间的统计量，称为样本的相关系数，定义为：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/29/e9/RdAXN0SL_o.png"></p> 
<p>　　对于二维正态随机变量(X,Y)，X和Y相互独立的充要条件是二者的协方差为0，也就是参数ρ=0。由于一维随机变量没有是否独立一说，ρ一定是0，因此没有在一维随机变量的正态分布中体现ρ。</p> 
<p>　　下图是一个标准二维正态分布和其在x-z，y-z平面的投影：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/37/69/R6pLa8Ds_o.png"></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/3f/09/iOh1Pwqr_o.png"></p> 
<h3>多维正态分布</h3> 
<p>　　现在推广到多维，为了便于表达，我们用向量的形式表示随机变量和参数，对于n维随机变量：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/95/6d/aI59OgKy_o.png"></p> 
<p>　　这里只考虑所有维度变量互相独立的情况，即ρ=0的情况，此时密度函数可表示为：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/3b/9d/XBU017uz_o.png"></p> 
<p>　　上面的结果告诉我们，在各维度相互独立的情况下，多维正态分布的概率密度其实就是各个维度的正态分布密度函数的乘积。</p> 
<p>　　在①中：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/b4/a2/0mH1D8Oe_o.png"></p> 
<p>　　σi2表示xi的方差，如此看来，中间那个矩阵实际上是协方差矩阵的逆矩阵：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/22/62/0StLPDOb_o.png"></p> 
<p>　　根据行列式的性质，上三角矩阵的行列式等于主对角线所有元素的乘积，斜对角矩阵当然也是一个上三角矩阵，因此协方差矩阵的行列式是：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/a5/d9/vt3cSqxT_o.png"></p> 
<p>　　将②、③代入①中，得到最终结果：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/a8/9c/BXSEa57R_o.png"></p> 
<h3>最大似然估计量</h3> 
<p>　　n维相互独立的随机变量x服从正态分布：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/a5/2c/y6OU1hSg_o.png"></p> 
<p>　　在求最大似然估计量时和一维随机变量有所区别，根据上一节的最终结果：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/69/2f/f0Kk5yOo_o.png"></p> 
<p>　　假设有m个可观察样本，那么最大似然函数是：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/56/1c/lXeCGC63_o.png"></p> 
<p>　　其对数似然函数是：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/d8/13/A5iQPVS4_o.png"></p> 
<p>　　其中m和n是已知的，C 是一个常数。</p> 
<p>　　求极值需要对μ和∑求偏导：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/5c/68/dsLfkfmT_o.png"></p> 
<p>　　μ和∑是矩阵，涉及到矩阵的求导法则。先看对μ的求导，lnL由3个因子组成，只有一个因子含有μ，因此：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/34/d4/OfBcIa8D_o.png"></p> 
<p>　　其中：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/d2/3a/NEK2gZY7_o.png"></p> 
<p>　　上式中：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/72/c1/8JNwHjzu_o.png"></p> 
<p>　　因此：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/7f/a4/kcbaJgRE_o.png"></p> 
<p>　　将该结论代入∂lnL/∂μ中：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/ef/e4/ko3GcNKo_o.png"></p> 
<p>　　μ和∑是矩阵，根据矩阵的求导法则：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/c4/2b/B39BKemz_o.png"></p> 
<p>　　因为∑-1是一个对称矩阵，因此：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/e4/a0/I7gkqRSO_o.png"></p> 
<p>　　根据矩阵的求导法则：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/7e/08/gfr3XH5d_o.png"></p> 
<p>　　将a1，a2代入∂lnL/∂μ 中：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/16/6d/tDOTO70X_o.png"></p> 
<p>　　</p> 
<p>　　</p> 
<p>　　再看对∑求偏导：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/a8/41/GLK0XIpt_o.png"></p> 
<p>　　∑和∑-1都是实对称矩阵，根据矩阵的求导法则，当<strong>A</strong>是实对称矩阵时：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/17/5f/FCo29yeC_o.png"></p> 
<p>　　再看b2。设ωpq是∑第p行第q列的元素，Epq是一个第p行第q列元素为1，其它元素全为0的矩阵，E与∑-1同阶。根据矩阵的求导公式：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/c4/55/5AYTAbBZ_o.png"></p> 
<p>　　已经知道了∑-1是一个对称矩阵，矩阵乘法满足结合律，在不改变矩阵顺序的条件下可以任意加括号：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/50/89/e2GA9ugX_o.png"></p> 
<p>　　其中(∑-1(x(i)-μ))T是一个1*n的矩阵，(∑-1(x(i)-μ))Tp表示矩阵中的第p个元素；∑-1(x(i)-μ)是一个n*1的矩阵，(∑-1(x(i)-μ))q表示矩阵中的第q个元素。将该结论推广到矩阵对矩阵的的求导，根据矩阵对矩阵的求导公式：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/1c/f7/kIXuhM16_o.png"></p> 
<p>　　其中：</p> 
<p><img alt="" class="has" height="39" src="https://images2.imgbox.com/b8/0f/LYIqCjbp_o.png" width="533"></p> 
<p>　　在A1中，(∑-1(x(i)-μ))T是一个1*n的矩阵，(∑-1(x(i)-μ))Ti表示矩阵中的第i个元素，是一个标量；∑-1(x(i)-μ)是一个n*1的矩阵，(∑-1(x(i)-μ))i表示矩阵中的第i个元素，也是一个标量，因此：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/4c/73/IoiEtuuA_o.png"></p> 
<p>　　终于可以求得b2了：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/94/2f/xZ5c4BVL_o.png"></p> 
<p>　　现在可以看看最终的似然函数：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/9d/5c/5tt9WEz4_o.png"></p> 
<p>　　<strong><em>I</em></strong>是单位矩阵，∑-1<strong><em>I=</em></strong>∑-1：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/5e/2b/tCR74YCi_o.png"></p> 
<p>　　等号两侧同时左乘∑：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/7e/08/96wwqXRv_o.png"></p> 
<p>　　两侧同时右乘∑：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/49/a2/LbAOSHfa_o.png"></p> 
<p>　　最终解得：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/de/14/4tTwl3Ya_o.png"></p> 
<p>　　最终结论，多维正态分布的最大似然估计量是：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/97/36/ShC7jbqA_o.png"></p> 
<p>　　</p> 
<hr> 
<p>　　作者：我是8位的</p> 
<p>　　出处：<a href="http://www.cnblogs.com/bigmonkey" rel="nofollow">http://www.cnblogs.com/bigmonkey</a></p> 
<p>　　本文以学习、研究和分享为主，如需转载，请联系本人，标明作者和出处，非商业用途！ </p> 
<p>　　扫描二维码关注公作者众号“我是8位的”</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/0b/58/OtYvz1yR_o.png"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/878b70717776ae642eae63fa5b7214d1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java内存分配参数设置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c4f63d7ac16a397c23bb99dd18750266/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">解决1235 - This version of MySQL doesn&#39;t yet support &#39;LIMIT &amp; IN/ALL/ANY/SOME subquery&#39;</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>