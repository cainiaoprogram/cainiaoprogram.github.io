<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android——2个activity之间的数据传递返回 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android——2个activity之间的数据传递返回" />
<meta property="og:description" content="老版本2个activity之间传递反回数据，实例如：https://www.cnblogs.com/xiaobaibailongma/p/16440432.html
新版本如下：https://blog.csdn.net/freezingxu/article/details/124953918?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-2-124953918-blog-133701756.235%5Ev40%5Epc_relevant_3m_sort_dl_base3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-2-124953918-blog-133701756.235%5Ev40%5Epc_relevant_3m_sort_dl_base3&amp;utm_relevant_index=3
在需要调用系统Intent之前，我们需要定义所需的Launcher：
1、protected ActivityResultLauncher activityResultLauncher;
2、protected ActivityResultLauncher takePhotoLauncher;
3、protected ActivityResultLauncher selectImageLauncher;
4、protected ActivityResultLauncher selectFileLauncher;
此处我定义了4个不同的Launcher，分别用来处理普通的Intent跳转、拍照、选择相册中已有的图片和选择手机中的文件。
activityResultLauncher：处理普通的Intent跳转，并携带参数往返；
takePhotoLauncher：打开照相机进行拍照，并获得照片；
selectImageLauncher：打开系统Intent选择手机上的图片；
selectFileLauncher：打开系统Intent选择手机里的文件。
原文链接：https://blog.csdn.net/freezingxu/article/details/124953918
=============================================================================
第一个布局：
&lt;LinearLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34; android:layout_width=&#34;match_parent&#34; android:layout_height=&#34;match_parent&#34; android:orientation=&#34;vertical&#34; &gt; &lt;TextView android:id=&#34;@&#43;id/tv_request&#34; android:layout_width=&#34;match_parent&#34; android:layout_height=&#34;wrap_content&#34; android:paddingLeft=&#34;5dp&#34; android:paddingTop=&#34;5dp&#34; android:textColor=&#34;#000000&#34; android:textSize=&#34;17sp&#34; /&gt; &lt;Button android:id=&#34;@&#43;id/btn_request&#34; android:layout_width=&#34;match_parent&#34; android:layout_height=&#34;wrap_content&#34; android:gravity=&#34;center&#34; android:text=&#34;传送请求数据&#34; android:textColor=&#34;#000000&#34; android:textSize=&#34;17sp&#34; /&gt; &lt;TextView android:id=&#34;@&#43;id/tv_response&#34; android:layout_width=&#34;match_parent&#34; android:layout_height=&#34;wrap_content&#34; android:paddingLeft=&#34;5dp&#34; android:textColor=&#34;#000000&#34; android:textSize=&#34;17sp&#34; /&gt; &lt;/LinearLayout&gt; activity：
package com.example.myapplication; import android.content.Intent; import android.os.Bundle; import android.view.View; import android.widget.TextView; import androidx.activity.result.ActivityResultLauncher; import androidx." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/5267366c575301039696ead862ba39e3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-10T16:27:00+08:00" />
<meta property="article:modified_time" content="2024-01-10T16:27:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android——2个activity之间的数据传递返回</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html" style="font-size: 16px;"> 
 <p>老版本2个activity之间传递反回数据，实例如：https://www.cnblogs.com/xiaobaibailongma/p/16440432.html</p> 
 <p>新版本如下：https://blog.csdn.net/freezingxu/article/details/124953918?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-2-124953918-blog-133701756.235%5Ev40%5Epc_relevant_3m_sort_dl_base3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-2-124953918-blog-133701756.235%5Ev40%5Epc_relevant_3m_sort_dl_base3&amp;utm_relevant_index=3</p> 
 <p>在需要调用系统Intent之前，我们需要定义所需的Launcher：</p> 
 <p>1、protected ActivityResultLauncher activityResultLauncher;<br>2、protected ActivityResultLauncher takePhotoLauncher;<br>3、protected ActivityResultLauncher selectImageLauncher;<br>4、protected ActivityResultLauncher selectFileLauncher;</p> 
 <p>此处我定义了4个不同的Launcher，分别用来处理普通的Intent跳转、拍照、选择相册中已有的图片和选择手机中的文件。</p> 
 <p>activityResultLauncher：处理普通的Intent跳转，并携带参数往返；</p> 
 <p>takePhotoLauncher：打开照相机进行拍照，并获得照片；</p> 
 <p>selectImageLauncher：打开系统Intent选择手机上的图片；</p> 
 <p>selectFileLauncher：打开系统Intent选择手机里的文件。</p> 
 <p><br>原文链接：https://blog.csdn.net/freezingxu/article/details/124953918</p> 
 <p><img src="https://images2.imgbox.com/fb/fc/FXubYAzf_o.png" alt="" style="outline: none;"></p> 
 <p>=============================================================================</p> 
 <p>第一个布局：</p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" &gt;

    &lt;TextView
        android:id="@+id/tv_request"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:paddingLeft="5dp"
        android:paddingTop="5dp"
        android:textColor="#000000"
        android:textSize="17sp" /&gt;

    &lt;Button
        android:id="@+id/btn_request"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:text="传送请求数据"
        android:textColor="#000000"
        android:textSize="17sp" /&gt;

    &lt;TextView
        android:id="@+id/tv_response"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:paddingLeft="5dp"
        android:textColor="#000000"
        android:textSize="17sp" /&gt;

&lt;/LinearLayout&gt;</code>
</pre> 
 </div> 
 <p>activity：</p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">package com.example.myapplication;

import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.TextView;
import androidx.activity.result.ActivityResultLauncher;
import androidx.activity.result.contract.ActivityResultContracts;
import androidx.appcompat.app.AppCompatActivity;


public class MainActivity extends AppCompatActivity implements View.OnClickListener
{

    private String mRrequest = "你吃饭了吗？来我家吃吧";

    private TextView tv_response; // 声明一个文本视图对象

    private ActivityResultLauncher mLauncher; // 声明一个活动结果启动器对象

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_register_result);


        // 从布局文件中获取名叫tv_request的文本视图
        TextView tv_request = findViewById(R.id.tv_request);
        tv_request.setText("待发送的消息为："+mRrequest);

        // 从布局文件中获取名叫tv_response的文本视图
        tv_response = findViewById(R.id.tv_response);


        findViewById(R.id.btn_request).setOnClickListener(this);


        // 注册一个善后工作的活动结果启动器
        mLauncher = registerForActivityResult(new ActivityResultContracts.StartActivityForResult(), result -&gt; {
            if (result.getResultCode()==RESULT_OK &amp;&amp; result.getData()!=null)
            {
                Bundle bundle = result.getData().getExtras(); // 从返回的意图中获取快递包裹

                // 从包裹中取出名叫response_time的字符串
                String response_time = bundle.getString("response_time");

                // 从包裹中取出名叫response_content的字符串
                String response_content = bundle.getString("response_content");

                String desc = String.format("收到返回消息：\n应答时间为：%s\n应答内容为：%s", response_time, response_content);

                tv_response.setText(desc); // 把返回消息的详情显示在文本视图上
            }
        });
    }

    @Override
    public void onClick(View v) {
        if (v.getId() == R.id.btn_request) {

            // 创建一个意图对象，准备跳到指定的活动页面
            Intent intent = new Intent(this, ActResponseActivity.class);

            Bundle bundle = new Bundle(); // 创建一个新包裹

            // 往包裹存入名叫request_time的字符串
            bundle.putString("request_time", DateUtil.getNowTime());

            // 往包裹存入名叫request_content的字符串
            bundle.putString("request_content", mRrequest);

            intent.putExtras(bundle); // 把快递包裹塞给意图

            mLauncher.launch(intent); // 活动结果启动器开动了
        }
    }

}</code>
</pre> 
 </div> 
 <p><img src="https://images2.imgbox.com/d0/10/wRxjl38K_o.png" alt="" style="outline: none;"></p> 
 <p>第二个布局：</p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" &gt;

    &lt;TextView
        android:id="@+id/tv_request"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:paddingLeft="5dp"
        android:paddingTop="5dp"
        android:textColor="#000000"
        android:textSize="17sp" /&gt;

    &lt;Button
        android:id="@+id/btn_response"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:text="返回应答数据"
        android:textColor="#000000"
        android:textSize="17sp" /&gt;

    &lt;TextView
        android:id="@+id/tv_response"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:paddingLeft="5dp"
        android:textColor="#000000"
        android:textSize="17sp" /&gt;

&lt;/LinearLayout&gt;</code>
</pre> 
 </div> 
 <p>第二个activity：</p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">package com.example.myapplication;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.TextView;

import androidx.appcompat.app.AppCompatActivity;

public class ActResponseActivity extends AppCompatActivity implements View.OnClickListener
{

    private String mResponse = "我吃过了，还是你来我家吃";

    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_act_response);


        // 从布局文件中获取名叫tv_request的文本视图
        TextView tv_request = findViewById(R.id.tv_request);

        findViewById(R.id.btn_response).setOnClickListener(this);

        // 从布局文件中获取名叫tv_response的文本视图
        TextView tv_response = findViewById(R.id.tv_response);


        tv_response.setText("待返回的消息为："+mResponse);



        // 从上一个页面传来的意图中获取快递包裹
        Bundle bundle = getIntent().getExtras();

        // 从包裹中取出名叫request_time的字符串
        String request_time = bundle.getString("request_time");

        // 从包裹中取出名叫request_content的字符串
        String request_content = bundle.getString("request_content");

        String desc = String.format("收到请求消息：\n请求时间为：%s\n请求内容为：%s", request_time, request_content);

        tv_request.setText(desc); // 把请求消息的详情显示在文本视图上
    }

    @Override
    public void onClick(View v)
    {
        if (v.getId() == R.id.btn_response)
        {
            Intent intent = new Intent(); // 创建一个新意图
            Bundle bundle = new Bundle(); // 创建一个新包裹

            // 往包裹存入名叫response_time的字符串
            bundle.putString("response_time", DateUtil.getNowTime());

            // 往包裹存入名叫response_content的字符串
            bundle.putString("response_content", mResponse);

            intent.putExtras(bundle); // 把快递包裹塞给意图

            // 携带意图返回上一个页面。RESULT_OK表示处理成功
            setResult(Activity.RESULT_OK, intent);

            finish(); // 结束当前的活动页面
        }
    }
}</code>
</pre> 
 </div> 
 <p><img src="https://images2.imgbox.com/de/28/NQy5k3xT_o.png" alt="" style="outline: none;"></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f6ee294653bd7740cd6560580bb7e086/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CUDA驱动深度学习发展 - 技术全解与实战</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/31d87ac8f64524b5269d0aa2f9dcaaab/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【从零开始学习微服务 | 第一篇】什么是微服务</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>