<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>kettle输出步骤 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="kettle输出步骤" />
<meta property="og:description" content="一、概述 数据库表：
• 表输出
• 更新，删除，插入/更新
• 批量加载（mysql，oracle）
• 数据同步
文件：
• SQL 文件输出
• 文本文件输出
• XML 输出
• Excel Output/Excel Writer
其他（报表、应用）
二、数据库输出 1.表输出
使用SQL的方式向数据库插入数据（INSERT）
支持批量提交
支持分区（Date分区）
支持字段映射
支持返回自增列
这里提示一下出现表输出的中文乱码问题的解决方案：
设置连接编码：characterEncoding utf8
设置连接编码一般就可以正常输出不乱吗的字符了。如果还有问题，可以继续设置客户端编码
设置客户端：set names utf8;
一个测试的表输出如下：
如果选择分区，需要选择Date字段进行分区，并且需要手动创建表（例如按月分区，有201804 201805两个月，则需要创建tb_201804 tb_201805两个表）
2.返回自增主键
表输出的配置如下：
预览即可查看返回的主键：
3.数据库字段映射
前面步骤可以后后面表输出进行字段映射匹配：
表输出配置如下：
字段映射：
使用猜一猜可以进行名称匹配，如果需要手动匹配，可以左右分别选择，点击Add即可！
并且映射完成之后也可以删除丢弃某些字段
4.其它操作——删除、更新、插入更新
删除：
根据关键字匹配，删除数据库中已有的数据。
更新：
根据关键字匹配，更新数据库中已有的数据。
插入更新：
有则更新，无则插入。
操作都是类似，上面进行匹配，下面进行处理：
5.数据同步
基于比较的同步方式。根据一个flag字段执行相应的插入/更新/删除操作。
配置图如下：使用合并后的flag字段（可能有new deleteed等flag），后续再根据此flag，同步变化的数据到表
6.批量加载
MySQL批量加载需要在Linux环境运行（有命令只能在Linux下运行）
Oracle需要本地有oracle客户端（sqlldr文件，在Oracle安装目录下查找）
三、文件输出 1.SQL文件输出
根据选中的数据库类型，生成相应的 SQL 脚本（DDL，DML）。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/7d4f524899568f7219e2d66790392377/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-04-03T10:49:49+08:00" />
<meta property="article:modified_time" content="2020-04-03T10:49:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">kettle输出步骤</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 id="kettle输出步骤-一、概述"><strong>一、概述</strong></h3> 
<p>　　数据库表：<br> 　　　　• 表输出<br> 　　　　• 更新，删除，插入/更新<br> 　　　　• 批量加载（mysql，oracle）<br> 　　　　• 数据同步<br> 　　文件：<br> 　　　　• SQL 文件输出<br> 　　　　• 文本文件输出<br> 　　　　• XML 输出<br> 　　　　• Excel Output/Excel Writer<br> 　　其他（报表、应用）</p> 
<h3 id="kettle输出步骤-二、数据库输出"><strong>二、数据库输出</strong></h3> 
<p>　　<strong>1.表输出</strong></p> 
<p>　　　　使用SQL的方式向数据库插入数据（INSERT）</p> 
<p>　　　　支持批量提交</p> 
<p>　　　　支持分区（Date分区）</p> 
<p>　　　　支持字段映射</p> 
<p>　　　　支持返回自增列</p> 
<p>　　<strong>这里提示一下出现表输出的中文乱码问题的解决方案：</strong></p> 
<p>　　设置连接编码：characterEncoding utf8</p> 
<p><img alt="" height="496" src="https://images2.imgbox.com/ff/bc/Nd2aW6jq_o.png" width="663"></p> 
<p>设置连接编码一般就可以正常输出不乱吗的字符了。如果还有问题，可以继续设置客户端编码</p> 
<p>设置客户端：set names utf8;</p> 
<p><img alt="" height="503" src="https://images2.imgbox.com/1b/5c/lL9sMobc_o.png" width="663"></p> 
<p>一个测试的表输出如下：</p> 
<p><img alt="" height="95" src="https://images2.imgbox.com/ad/4a/rjgj9ls4_o.png" width="329"></p> 
<p>如果选择分区，需要选择Date字段进行分区，并且需要手动创建表（例如按月分区，有201804 201805两个月，则需要创建tb_201804 tb_201805两个表）</p> 
<p>　　<strong>2.返回自增主键</strong></p> 
<p>　　表输出的配置如下：</p> 
<p><img alt="" height="555" src="https://images2.imgbox.com/53/1a/6I7B8wIA_o.png" width="484"></p> 
<p>　　预览即可查看返回的主键：</p> 
<p><img alt="" height="282" src="https://images2.imgbox.com/88/4f/T3sEFHZn_o.png" width="699"></p> 
<p><strong>3.数据库字段映射</strong></p> 
<p>　　　　前面步骤可以后后面表输出进行字段映射匹配：</p> 
<p>　　　　表输出配置如下：</p> 
<p><img alt="" height="556" src="https://images2.imgbox.com/a1/5b/g3AGDnZ9_o.png" width="457"></p> 
<p>字段映射：</p> 
<p>　　　　使用猜一猜可以进行名称匹配，如果需要手动匹配，可以左右分别选择，点击Add即可！</p> 
<p>　　　　并且映射完成之后也可以删除丢弃某些字段</p> 
<p><img alt="" height="341" src="https://images2.imgbox.com/a2/19/r3VfcRcb_o.png" width="609"></p> 
<p><strong>4.其它操作——删除、更新、插入更新</strong></p> 
<p>　　　　删除：</p> 
<p>　　　　　　根据关键字匹配，删除数据库中已有的数据。</p> 
<p>　　　　更新：</p> 
<p>　　　　　　根据关键字匹配，更新数据库中已有的数据。</p> 
<p>　　　　插入更新：</p> 
<p>　　　　　　有则更新，无则插入。</p> 
<p>　　操作都是类似，上面进行匹配，下面进行处理：</p> 
<p> </p> 
<p><img alt="" height="510" src="https://images2.imgbox.com/21/10/17fg1vPE_o.png" width="457"></p> 
<p><strong>5.数据同步</strong></p> 
<p>　　　　基于比较的同步方式。根据一个flag字段执行相应的插入/更新/删除操作。</p> 
<p>　　　　配置图如下：使用合并后的flag字段（可能有new deleteed等flag），后续再根据此flag，同步变化的数据到表</p> 
<p><img alt="" height="209" src="https://images2.imgbox.com/4b/29/KcCLFZUa_o.png" width="479"></p> 
<p><strong>6.批量加载</strong></p> 
<p><img alt="" height="302" src="https://images2.imgbox.com/d0/6c/qZbavmaR_o.png" width="366"></p> 
<p>MySQL批量加载需要在Linux环境运行（有命令只能在Linux下运行）</p> 
<p>Oracle需要本地有oracle客户端（sqlldr文件，在Oracle安装目录下查找）</p> 
<h3 id="kettle输出步骤-三、文件输出"><strong> 三、文件输出</strong></h3> 
<p>　　<strong>1.SQL文件输出</strong></p> 
<p>　　　　根据选中的数据库类型，生成相应的 SQL 脚本（DDL，DML）。</p> 
<p><img alt="" height="100" src="https://images2.imgbox.com/5e/aa/U5WyKoUb_o.png" width="325"></p> 
<p><strong>2.excel文件输出</strong></p> 
<p>　　　　注意2007以前的版本有65536的行数限制</p> 
<p><strong>3.文本文件输出</strong></p> 
<p>　　　　比如txt json等，暂不赘述</p> 
<h3 id="kettle输出步骤-四、其它输出"><strong> 四、其它输出</strong></h3> 
<p>　　<strong>1.报表输出</strong></p> 
<p><strong>　　　　</strong>生成报表（pdf，excel，html等格式），需要事先定义好报表模板。</p> 
<p>　　<strong>2.XML输出</strong></p> 
<p>　　　　同样，暂不赘述</p> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/774174267a8626c9e0de3c70dc7f57fa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">kettle资源库、运行方式与日志</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e7b2fb3843e6e979e457a8b4161128bf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python机器学习——模型评估与选择</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>