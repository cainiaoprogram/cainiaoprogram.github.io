<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#读取和写入文件（干货分享） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#读取和写入文件（干货分享）" />
<meta property="og:description" content="一、读取文件 读取的文件内容不多： 可以使用 File.ReadAllText(FilePath) 可以指定编码方式 File.ReadAllText(FilePath, Encoding)的方法。可以使用File.ReadAllLines(FilePath)可以指定编码方式File.ReadAllLines(FilePath, Encoding)的方法 这些方法都是一次将文本内容全部读完，
前两种方法返回一个包含全部文本内容的字符串；
后两种返回一个字符串数组，每一行都是一个数组元素。
如何使用：
string str = File.ReadAllText(@&#34;c:\temp\ascii.txt&#34;);//第一种 string str2 = File.ReadAllText(@&#34;c:\temp\ascii.txt&#34;, Encoding.ASCII);//第二种 string[] strs = File.ReadAllLines(@&#34;c:\temp\ascii.txt&#34;); //第三种 string[] strs2 = File.ReadAllLines(@&#34;c:\temp\ascii.txt&#34;, Encoding.ASCII);//第四种 读取的文件内容较多：
我们就不要将文本内容一次读完，而应该采用流（Stream）的方式来读取内容。.Net为我们封装了StreamReader类。初始化StreamReader类有很多种方式。
可以使用StreamReader（FilePath）可以指定编码方式 StreamReader(FilePath, Encoding)可以使用StreamReader（FileStream）可以指定编码方式StreamReader(FileStream, Encoding) 可以使用File.OpenText（FilePath）可以使用FileInfo.OpenText() 如何使用：
StreamReader sr1 = new StreamReader(@&#34;c:\temp\utf-8.txt&#34;); //第一种 StreamReader sr2 = new StreamReader(@&#34;c:\temp\utf-8.txt&#34;, Encoding.UTF8);//第二种 FileStream fs = new FileStream(@&#34;C:\temp\utf-8.txt&#34;, FileMode.Open, FileAccess.Read, FileShare.None); //初始化FileStream StreamReader sr3 = new StreamReader(fs); //第三种 StreamReader sr4 = new StreamReader(fs, Encoding." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/16123ab594c38721d9d2c91f5572c682/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-24T15:41:59+08:00" />
<meta property="article:modified_time" content="2022-11-24T15:41:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#读取和写入文件（干货分享）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2></h2> 
<h2><strong>一、读取文件</strong></h2> 
<h4><strong>读取的文件内容不多：</strong></h4> 
<ol><li><strong>可以使用 File.ReadAllText(FilePath) </strong></li><li><strong>可以指定编码方式  File.ReadAllText(FilePath, Encoding)的方法。</strong></li><li><strong>可以使用File.ReadAllLines(FilePath)</strong></li><li><strong>可以指定编码方式File.ReadAllLines(FilePath, Encoding)的方法</strong></li></ol> 
<p>这些方法都是一次将文本内容全部读完，</p> 
<p>前两种方法返回一个包含全部文本内容的字符串；</p> 
<p>后两种返回一个字符串数组，每一行都是一个数组元素。</p> 
<p><strong>如何使用：</strong></p> 
<pre><code class="language-cs">string str = File.ReadAllText(@"c:\temp\ascii.txt");//第一种
string str2 = File.ReadAllText(@"c:\temp\ascii.txt", Encoding.ASCII);//第二种

string[] strs = File.ReadAllLines(@"c:\temp\ascii.txt"); //第三种
string[] strs2 = File.ReadAllLines(@"c:\temp\ascii.txt", Encoding.ASCII);//第四种</code></pre> 
<p><strong>读取的文件内容较多：</strong></p> 
<p>       我们就不要将文本内容一次读完，而应该采用流（Stream）的方式来读取内容。.Net为我们封装了StreamReader类。初始化StreamReader类有很多种方式。</p> 
<ol><li><strong>可以使用StreamReader（FilePath）</strong></li><li><strong>可以指定编码方式 StreamReader(FilePath, Encoding)</strong></li><li><strong>可以使用StreamReader（FileStream）</strong></li><li><strong>可以指定编码方式StreamReader(FileStream, Encoding) </strong></li><li><strong>可以使用File.OpenText（FilePath）</strong></li><li><strong>可以使用FileInfo.OpenText()</strong></li></ol> 
<p><strong>如何使用：</strong></p> 
<pre><code class="language-cs">StreamReader sr1 = new StreamReader(@"c:\temp\utf-8.txt"); //第一种
StreamReader sr2 = new StreamReader(@"c:\temp\utf-8.txt", Encoding.UTF8);//第二种

FileStream fs = new FileStream(@"C:\temp\utf-8.txt", FileMode.Open, FileAccess.Read, FileShare.None); //初始化FileStream
StreamReader sr3 = new StreamReader(fs); //第三种
StreamReader sr4 = new StreamReader(fs, Encoding.UTF8);//第四种

FileInfo myFile = new FileInfo(@"C:\temp\utf-8.txt"); //初始化FileInfo
// OpenText 创建一个UTF-8 编码的StreamReader对象 
StreamReader sr5 = myFile.OpenText();//第五种
StreamReader sr6 = File.OpenText(@"C:\temp\utf-8.txt");//第六种</code></pre> 
<p>　　初始化完成之后，你可以每次读一行，也可以每次读一个字符 ，还可以每次读几个字符，甚至也可以一次将所有内容读完。</p> 
<pre><code class="language-cs">// 读一行 
string nextLine = sr.ReadLine();
// 读一个字符 
int nextChar = sr.Read();
// 读100个字符 
int nChars = 100; 
char[] charArray = new char[nChars]; 
int nCharsRead = sr.Read(charArray, 0, nChars);      
// 全部读完 
string restOfStream = sr.ReadToEnd();
//使用完StreamReader之后，关闭它：
sr.Close();</code></pre> 
<p>　　<strong>假如我们需要一行一行的读，将整个文本文件读完，下面看一个完整的例子：</strong></p> 
<pre><code class="language-cs">StreamReader sr = File.OpenText(@"C:\temp\ascii.txt"); 
string nextLine; 
while ((nextLine = sr.ReadLine()) != null) 
{ 
　　Console.WriteLine(nextLine); 
} 
sr.Close();</code></pre> 
<h2><strong>二、写入文件</strong></h2> 
<h4>　　<strong>写入的文件内容不多：</strong></h4> 
<ol><li><strong>可以使用File.WriteAllText（FilePath,String）</strong></li><li><strong>可以指定编码方式File.WriteAllText(FilePath, String,Encoding)</strong></li><li><strong>可以使用File.WriteAllLines</strong>（<strong>FilePath，String[]</strong>）</li><li><strong>可以指定编码方式File.WriteAllLines</strong>（<strong>FilePath，String[]，Encoding</strong>）</li></ol> 
<p>　　 前面两种写入的是一个字符串，后面两种写入的是一个字符串数组。</p> 
<p>        使用File.WriteAllText或File.WriteAllLines方法时，如果指定的文件路径不存在，会创建一个新文件；如果文件已经存在，则会覆盖原文件。</p> 
<pre><code class="language-cs">string str1 = "Good Morning!";//需要写入的字符串

File.WriteAllText(@"c:\temp\test\ascii.txt", str1);//第一种

File.WriteAllText(@"c:\temp\test\ascii-2.txt", str1, Encoding.ASCII);//第二种


string[] strs = { "Good Morning!", "Good Afternoon!" };//需要写入的字符串数组

File.WriteAllLines(@"c:\temp\ascii.txt", strs);//第三种

File.WriteAllLines(@"c:\temp\ascii-2.txt", strs, Encoding.ASCII);//第四种</code></pre> 
<h4>　   <strong>写入的文件内容较多：</strong></h4> 
<p>　　同样也要使用流（Stream）的方式写入。.Net封装的类是StreamWriter。</p> 
<p>　　初始化StreamWriter类同样有很多方式：</p> 
<ol><li><strong>可以使用StreamWriter​​(FilePath)</strong></li><li><strong>可以指定编码方式 StreamWriter(FilePath, bool append,Encoding)</strong></li><li><strong>可以使用FileStream(FileStream); </strong></li><li><strong>可以指定编码方式StreamWriter(FileStream, Encoding) </strong></li><li><strong>可以使用File.CreateText</strong><strong>（FilePath）</strong></li><li><strong>可以使用FileInfo.CreateText()</strong></li></ol> 
<pre><code class="language-cs">// 如果文件不存在，创建文件； 如果存在，覆盖文件 
StreamWriter sw1 = new StreamWriter(@"c:\temp\utf-8.txt"); //第一种
// 也可以指定编码方式 
// true 是 append text, false 为覆盖原文件 
StreamWriter sw2 = new StreamWriter(@"c:\temp\utf-8.txt", true, Encoding.UTF8);//第二种

// FileMode.CreateNew: 如果文件不存在，创建文件；如果文件已经存在，抛出异常 
FileStream fs = new FileStream(@"C:\temp\utf-8.txt", FileMode.CreateNew, FileAccess.Write, FileShare.Read); 
// UTF-8 为默认编码 
StreamWriter sw3 = new StreamWriter(fs); //第三种
StreamWriter sw4 = new StreamWriter(fs, Encoding.UTF8);//第四种

// 如果文件不存在，创建文件； 如果存在，覆盖文件 
FileInfo myFile = new FileInfo(@"C:\temp\utf-8.txt"); 
StreamReader sr6 = File.CreateText(@"C:\temp\utf-8.txt");//第五种
StreamWriter sw5 = myFile.CreateText();//第六种</code></pre> 
<p><strong>　　</strong>初始化完成后，可以用StreamWriter对象一次写入一行，一个字符，一个字符数组，甚至一个字符数组的一部分。　　　　　　</p> 
<pre><code class="language-cs">// 写一个字符            
sw.Write('a');

// 写一个字符数组 
char[] charArray = new char[100]; 
// initialize these characters 
sw.Write(charArray);

// 写一个字符数组的一部分 
sw.Write(charArray, 10, 15);

//使用完后关闭它
sw.Close();</code></pre> 
<p>　　<strong>最后来看一个完整的使用StreamWriter一次写入一行的例子：</strong></p> 
<pre><code class="language-cs">FileInfo myFile = new FileInfo(@"C:\temp\utf-8.txt"); 
StreamWriter sw = myFile.CreateText();

string[] strs = { "早上好", "下午好" };            
foreach (var s in strs) 
{ 
　　sw.WriteLine(s); 
} 
sw.Close();</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0d6bd176846a53e4cb255ad590b65d6c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">攻防世界 crypto---simpleRSA wp</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/468ebf1dfdfa68a60d59e1e64048d7f0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">goland2022.2取消自动删除暂未使用的包</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>