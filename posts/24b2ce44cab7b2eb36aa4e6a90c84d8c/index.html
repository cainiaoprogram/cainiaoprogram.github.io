<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>介绍OpenVINO 2023.1: 在边缘端赋能生成式AI - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="介绍OpenVINO 2023.1: 在边缘端赋能生成式AI" />
<meta property="og:description" content="作者：Yury Gorbachev；翻译：武卓，杨亦诚
在过去的一年里，我们看到了生成式AI用例和模型的爆炸式增长。现在几乎每周都会针对不同的领域发布新的值得注意的生成式模型，这些模型在不断增加的数据集上训练，具有各种计算复杂性。使用像LoRA这样的方法，可以在非常适度的训练加速器上微调大模型，这解锁了对基础模型的更多修改。由于资源消耗，部署这些模型仍然是挑战，并且高度依赖于在云端部署模型。
随着 OpenVINO™ 2023.1 版本的发布，我们希望将生成式 AI 的强大功能引入常规台式机和笔记本电脑，让这些模型可以运行在在资源受限的本地环境中，，并被您尝试集成到自己的应用程序中。我们在整个产品中针对这些场景进行了优化，实现了一些关键功能，并为我们的下一步工作计划奠定了基础。 也就是说，我们的变化不仅限于生成式AI，我们还改进了产品的其它部分，并希望它能使您的工作更轻松，并为您带来额外的价值。 让我们来看看这些变化到底是什么。。 生成式 AI 功能 大模型的整体堆栈优化。来自生成式AI家族的模型有一个共同点——它们亟需资源。模型尺寸巨大，运行它们所需的内存量非常高，对内存带宽的需求也非常大。例如不必要的权重搬运这样简单的问题，都可能会导致由于内存不足而无法运行模型。
为了更好地适应这一点，我们已经跨推理堆栈工作，包括 CPU 和 GPU（集成显卡和独立显卡），目标就是优化我们使用这些模型的方式，包括优化读取和编译模型所需的内存，优化如何处理模型的输入和输出张量以及其他内部结构，从而缩短模型执行时间。
大型语言模型的权重量化。LLM 在执行时需要大量的内存带宽。为了对此进行优化，我们在 NNCF（神经网络压缩框架） 优化框架和 CPU 推理中实现了 int8 LLM 权重量化功能。
使用此功能时，NNCF 将生成优化的 IR 模型文件，与精度为 fp16 的常规模型文件相比，该文件能够将尺寸减小一半。IR 文件将在 CPU 插件中被执行额外的优化，这将改善延迟并减少运行时内存消耗。GPU 的类似功能正在实施中，并将在后续发布的版本中提供。
更容易转换模型。大多数LLM目前来自基于PyTorch的环境。要转换这些模型，您现在可以使用我们的直接 PyTorch 转换功能。对于LLM，与我们之前通过ONNX格式的路径相比，这大大加快了转换时间并减少了内存需求。
总体而言，由于我们的优化，我们能够在CPU和GPU上均能提高 LLM 性能。[WZ1] 此外，我们还按 倍数级减少了运行这些模型所需的内存量。在某些情况下，新版本OpenVINO可以让我们运行那些以前由于内存不足而失败的模型。我们一直在数十个不同规模和不同任务的LLM上验证我们的工作，以确保我们的方法能够很好地扩展到我们所有的平台和支持的操作系统。
我们的转换 API 和权重量化功能也集成到Hugging Face optimum-intel扩展中，允许您使用 OpenVINO 作为推理堆栈运行生成式模型，或以方便的方式将模型导出为 OpenVINO 格式。
[WZ1]找不到性能方面的公开描述，在这里考虑了简化描述。
简化您的工作流 不再需要开发包，提供统一的工具。从 2023.1 版本开始，我们不再要求您为运行时和开发环境分别安装单独的软件包。我们一直致力于简化我们的工具，并将所有必要的组件集成到单个 OpenVINO 软件包中。这也意味着模型转换和推理可以通过所有OpenVINO分发机制以统一的方式获得：pip，conda，brew和archive。
此外，从此版本开始，OpenVINO Python API 可从所有支持最低要求 Python 版本 （3.7） 的软件包中获得。这意味着除了以前可用的 pip 之外，还有conda、brew和指定的 apt 版本。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/24b2ce44cab7b2eb36aa4e6a90c84d8c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-18T11:09:31+08:00" />
<meta property="article:modified_time" content="2023-10-18T11:09:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">介绍OpenVINO 2023.1: 在边缘端赋能生成式AI</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0px;">作者：Yury Gorbachev；翻译：武卓，杨亦诚</p> 
<p style="margin-left:0;"><span style="background-color:#fdfdfd;"><span style="color:#000000;">在过去的一年里，我们看到了生成式</span><span style="color:#000000;">AI</span><span style="color:#000000;">用例和模型的爆炸式增长。现在几乎每周都会针对不同的领域发布新的值得注意的生成式模型，这些模型在不断增加的数据集上训练，具有各种计算复杂性。使用像</span><span style="color:#000000;">LoRA</span><span style="color:#000000;">这样的方法，可以在非常适度的训练加速器上微调大模型，这解锁了对基础模型的更多修改。由于资源消耗，部署这些模型仍然是挑战，并且高度依赖于在云端部署模型。</span></span></p> 
<p style="margin-left:0;"><span style="background-color:#fdfdfd;"><span style="color:#000000;">随着</span><span style="color:#000000;"> OpenVINO</span><span style="color:#000000;">™</span><span style="color:#000000;">  2023.1 </span><span style="color:#000000;">版本的发布，我们希望将生成式</span><span style="color:#000000;"> AI 的强大功能引入常规台式机和笔记本电脑，让这些模型可以运行在在资源受限的本地环境中，，并被您尝试集成到自己的应用程序中。我们在整个产品中针对这些场景进行了优化，实现了一些关键功能，并为我们的下一步工作计划奠定了基础。 </span></span></p> 
<p style="margin-left:0;"><span style="background-color:#fdfdfd;"><span style="color:#000000;">也就是说，我们的变化不仅限于生成式</span><span style="color:#000000;">AI</span><span style="color:#000000;">，我们还改进了产品的其它部分，并希望它能使您的工作更轻松，并为您带来额外的价值。 让我们来看看这些变化到底是什么。。 </span></span></p> 
<h2 style="margin-left:0px;"><span style="color:#2f5496;">生成式 AI 功能</span></h2> 
<p style="margin-left:0;"><strong>大模型的整体堆栈优化。</strong>来自生成式AI家族的模型有一个共同点——它们亟需资源。模型尺寸巨大，运行它们所需的内存量非常高，对内存带宽的需求也非常大。例如不必要的权重搬运这样简单的问题，都可能会导致由于内存不足而无法运行模型。</p> 
<p style="margin-left:0;"><span style="background-color:#fdfdfd;"><span style="color:#000000;">为了更好地适应这一点</span><span style="color:#000000;">，我们已经<span style="background-color:#d4d4d4;">跨</span>推理堆栈<span style="background-color:#d4d4d4;">工作</span>，包括 </span><span style="color:#000000;">CPU</span> <span style="color:#000000;">和 </span><span style="color:#000000;">GPU</span><span style="color:#000000;">（集成显卡和独立显卡），目标就是优化我们使用这些模型的方式，包括优化读取和编译模型所需的内存，优化如何处理模型的输入和输出张量以及其他内部结构，从而缩短模型执行时间。</span></span></p> 
<p style="margin-left:0;"><strong>大型语言模型的权重量化</strong>。LLM 在执行时需要大量的内存带宽。为了对此进行优化，我们在 NNCF（神经网络压缩框架） 优化框架和 CPU 推理中实现了 int8 LLM 权重量化功能。</p> 
<p style="margin-left:0;">使用此功能时，NNCF 将生成优化的 IR 模型文件，与精度为 fp16 的常规模型文件相比，该文件能够将尺寸减小一半。IR 文件将在 CPU 插件中被执行额外的优化，这将改善延迟并减少运行时内存消耗。GPU 的类似功能正在实施中，并将在后续发布的版本中提供。</p> 
<p style="margin-left:0;"><strong>更容易转换模型。</strong>大多数LLM目前来自基于PyTorch的环境。要转换这些模型，您现在可以使用我们的直接 PyTorch 转换功能。对于LLM，与我们之前通过ONNX格式的路径相比，这大大加快了转换时间并减少了内存需求。</p> 
<p style="margin-left:0;">总体而言，由于我们的优化，我们能够在CPU和GPU上均能提高 LLM 性能。<a class="msocomanchor" href="#_msocom_1" rel="nofollow" id="_anchor_1" name="_msoanchor_1">[WZ1]</a> 此外，我们还按 倍数级减少了运行这些模型所需的内存量。在某些情况下，新版本OpenVINO可以让我们运行那些以前由于内存不足而失败的模型。我们一直在数十个不同规模和不同任务的LLM上验证我们的工作，以确保我们的方法能够很好地扩展到我们所有的平台和支持的操作系统。</p> 
<p style="margin-left:0;">我们的转换 API 和权重量化功能也集成到Hugging Face optimum-intel扩展中，允许您使用 OpenVINO 作为推理堆栈运行生成式模型，或以方便的方式将模型导出为 OpenVINO 格式。</p> 
<div> 
 <hr> 
 <div> 
  <div id="_com_1"> 
   <a name="_msocom_1"></a> 
   <p style="margin-left:0;"> <a class="msocomoff" href="#_msoanchor_1" rel="nofollow">[WZ1]</a>找不到性能方面的公开描述，在这里考虑了简化描述。</p> 
  </div> 
 </div> 
</div> 
<h2 style="margin-left:0px;"><span style="color:#2f5496;">简化您的工作流</span></h2> 
<p style="margin-left:0;"><strong>不再需要开发包，提供统一的工具。</strong>从 2023.1 版本开始，我们不再要求您为运行时和开发环境分别安装单独的软件包。我们一直致力于简化我们的工具，并将所有必要的组件集成到单个 OpenVINO 软件包中。这也意味着模型转换和推理可以通过所有OpenVINO分发机制以统一的方式获得：pip，conda，brew和archive。</p> 
<p style="margin-left:0;">此外，从此版本开始，OpenVINO Python API 可从所有支持最低要求 Python 版本 （3.7） 的软件包中获得。这意味着除了以前可用的 pip 之外，还有conda、brew和指定的 apt 版本。</p> 
<p style="margin-left:0;"><strong>更高效、更友好的模型转换。</strong>我们正在推出 OpenVINO 模型转换工具 （OVC），该工具正在取代我们众所周知的离线模型转换任务中的模型优化器 （MO） 工具。该工具以OpenVINO 包形式提供，依靠内部模型前端来读取框架格式，不需要原始框架来执行模型转换。例如，如果您想将TF模型转换为OpenVINO，则不需要安装TensorFlow。同样，如果您想简单地在 OpenVINO 运行时中读取此模型以进行推理而无需转换，同样也不需要 TensorFlow。</p> 
<p style="margin-left:0;">为了在 Python 脚本中转换模型，我们进一步改进了convert_model API。例如，它允许将模型从 PyTorch 对象转换为 OpenVINO 模型，并编译模型以进行推理或将其保存到 IR格式，请参见以下示例：</p> 
<p style="margin-left:0;"><img alt="" height="856" src="https://images2.imgbox.com/84/94/tlVP0YIb_o.png" width="1200"></p> 
<p style="margin-left:0;">请注意，我们还简化了我们的Python API，可以直接从OpenVINO命名空间获得这些API，因此这一切变得更简单了。您仍然可以从旧命名空间访问函数，如果您需要 mo 工具，可以安装 openvino-dev。这个工具本身也仍然可用，但我们建议迁移到 ovc 工具。</p> 
<p style="margin-left:0;"><strong>默认切换到</strong><strong> fp16 IR</strong><strong>。</strong>随着转换工具的变化，我们现在切换到使用 fp16 精度作为 IR 中的数据类型。这允许将模型大小减小 一半（相对FP32精度的模型），并且根据我们执行的测试对准确性没有影响。值得一提的是，IR 精度不会影响硬件插件的执行精度，默认情况下，插件始终以最佳性能继续执行。</p> 
<h2 style="margin-left:0px;"><span style="background-color:#fdfdfd;"><span style="color:#2f5496;">更好的</span><span style="color:#2f5496;"> PyTorch </span><span style="color:#2f5496;">兼容性</span></span></h2> 
<p style="margin-left:0;">前面已经提到，直接转换PyTorch模型的功能现在已经成熟，该方案已经被集成在我们的 HuggingFace optimum-intel中进行模型转换。因此，现在转换模型更容易，因为您绕过了 ONNX 格式的额外步骤（我们仍然无限制地支持）。</p> 
<p style="margin-left:0;">为了使OpenVINO更接近PyTorch生态系统，我们引入了对torch.compile和相应后端的支持。您现在可以通过 OpenVINO 堆栈运行您的模型，方法是通过 torch.compile 编译它并指定 openvino 作为后端！</p> 
<p style="margin-left:0;">如下例所示：</p> 
<p style="margin-left:0;"><img alt="" height="158" src="https://images2.imgbox.com/a6/b2/G3lP6KDC_o.png" width="1200"></p> 
<p style="margin-left:0;">此功能正在积极增强，我们期待更好的性能和操作覆盖范围，但它已经在我们的集成中使用，例如Stable Diffusion WebUI（链接）。</p> 
<h2 style="margin-left:0px;"><span style="background-color:#fdfdfd;"><span style="color:#2f5496;">令人兴奋的新</span><span style="color:#2f5496;">Notebook</span><span style="color:#2f5496;">用例</span></span></h2> 
<p style="margin-left:0;">为了展示您可以直接从笔记本电脑上试用的新功能，我们制作了一些Jupyter notebooks示例并更新了现有notebooks。以下是最令我们兴奋的：</p> 
<p style="margin-left:0;">基于大语言模型的聊天机器人（LLM Chatbot）：</p> 
<p style="margin-left:0;"><a href="https://github.com/openvinotoolkit/openvino_notebooks/tree/main/notebooks/254-llm-chatbot" title="https://github.com/openvinotoolkit/openvino_notebooks/tree/main/notebooks/254-llm-chatbot">https://github.com/openvinotoolkit/openvino_notebooks/tree/main/notebooks/254-llm-chatbot</a></p> 
<p style="margin-left:0;"><img alt="" height="941" src="https://images2.imgbox.com/22/2c/rUzyD24Q_o.png" width="1200"></p> 
<p style="margin-left:0;">文生图模型StableDiffusion XL：</p> 
<p style="margin-left:0;"><a href="https://github.com/openvinotoolkit/openvino_notebooks/tree/main/notebooks/248-stable-diffusion-xl" title="https://github.com/openvinotoolkit/openvino_notebooks/tree/main/notebooks/248-stable-diffusion-xl">https://github.com/openvinotoolkit/openvino_notebooks/tree/main/notebooks/248-stable-diffusion-xl</a></p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;text-align:center;"><img alt="" height="743" src="https://images2.imgbox.com/11/cd/ZkAOv8jE_o.png" width="1200"></p> 
<p style="margin-left:0;">文生图模型 Tiny SD：</p> 
<p style="margin-left:0;"><a href="https://github.com/openvinotoolkit/openvino_notebooks/tree/main/notebooks/251-tiny-sd-image-generation" title="https://github.com/openvinotoolkit/openvino_notebooks/tree/main/notebooks/251-tiny-sd-image-generation">https://github.com/openvinotoolkit/openvino_notebooks/tree/main/notebooks/251-tiny-sd-image-generation</a></p> 
<p style="margin-left:0;"><img alt="" height="512" src="https://images2.imgbox.com/d3/8c/xkSfIDTo_o.png" width="512"></p> 
<p style="margin-left:0;">生成音乐模型 MusicGen：</p> 
<p style="margin-left:0;"><a href="https://github.com/openvinotoolkit/openvino_notebooks/blob/main/notebooks/250-music-generation" title="https://github.com/openvinotoolkit/openvino_notebooks/blob/main/notebooks/250-music-generation">https://github.com/openvinotoolkit/openvino_notebooks/blob/main/notebooks/250-music-generation</a></p> 
<p style="margin-left:0;">生成视频模型Text-to-video：</p> 
<p style="margin-left:0;"><a href="https://github.com/openvinotoolkit/openvino_notebooks/tree/main/notebooks/253-zeroscope-text2video" title="https://github.com/openvinotoolkit/openvino_notebooks/tree/main/notebooks/253-zeroscope-text2video">https://github.com/openvinotoolkit/openvino_notebooks/tree/main/notebooks/253-zeroscope-text2video</a></p> 
<table cellspacing="0"><thead><tr><td style="background-color:#ffffff;"> <p style="margin-left:0;text-align:center;"><strong><span style="color:#1f2328;">Darth Vader is surfing on waves</span></strong></p> </td></tr></thead><tbody><tr><td style="background-color:#ffffff;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;"><a class="has-card" href="https://camo.githubusercontent.com/64eec6e52d060ca971c5a3be3f0d60e712907c98b4661b454d7e3e9575c2bc6b/68747470733a2f2f68756767696e67666163652e636f2f64617461736574732f68756767696e67666163652f646f63756d656e746174696f6e2d696d616765732f7265736f6c76652f6d61696e2f6469666675736572732f646172746876616465725f63657270656e73652e676966" rel="nofollow" title="​编辑"><span class="link-card-box"><span class="link-title">​编辑</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/63/b7/8giyR7CB_o.png" alt="icon-default.png?t=N7T8">https://camo.githubusercontent.com/64eec6e52d060ca971c5a3be3f0d60e712907c98b4661b454d7e3e9575c2bc6b/68747470733a2f2f68756767696e67666163652e636f2f64617461736574732f68756767696e67666163652f646f63756d656e746174696f6e2d696d616765732f7265736f6c76652f6d61696e2f6469666675736572732f646172746876616465725f63657270656e73652e676966</span></span></a></span></p> </td></tr></tbody></table> 
<p style="margin-left:0;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/815fe7ecea58da820aea76b3d9f54c51/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">BGP基本配置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/89a083658ad532551aa7827beee17f3e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">three.js加载gltf模型并更换材质贴图遇到了一个问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>