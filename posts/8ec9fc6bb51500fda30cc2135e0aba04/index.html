<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>FreeRTOS——操作系统介绍、手动移植代码与CubeMx创建FreeRTOS - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="FreeRTOS——操作系统介绍、手动移植代码与CubeMx创建FreeRTOS" />
<meta property="og:description" content="FreeRTOS简介
1.嵌入式操作系统
嵌入式操作系统是为了区别于通用的计算机操作系统，人们把嵌入到对象体系中，为实现对象体系智能化控制的计算机操作系统，称作嵌入式计算机操作系统，简称嵌入式操作系统。
嵌入式操作系统分类：
②按对外部事件的响应能力来分类，嵌入式操作系统分实时操作系统和分时操作系统。
如果操作系统能及时的响应外部事件请求，并能控制所有实时设备和实时任务协调运行，且能在一个规定的时间内完成对事件的处理，那么这种系统就称为实时操作系统。
如果操作系统按时间片轮转完成各个任务，任务没有优先级，这种系统就称为分时操作系统。
②按时间的严格程度来分，实时操作系统又分为强实时操作系统和弱实时操作系统。系统必须在极其严格的时间内完成的任务叫做硬实时操作系统，比如飞机系统；如果不是很严格的话就是弱实时操作系统，比如信息采集系统。
2.FreeRTOS 实时操作系统
FreeRTOS 是一款开源免费的实时操作系统，商业使用的话不需要用户公开源代码，也不存在任何版权问题，是当前小型嵌入式操作系统市场使用率最高的。
FreeRTOS 的移植比较简单，只需要用户添加需要的源码文件，不需要做任何的底层工作，再添加几个宏定义即可。
裸机系统与多任务系统
1.裸机系统
裸机编程时，先初始化相关的硬件，然后让主程序在一个死循环里面不断地循环，顺序地处理各种事件。对于紧急事件，采用中断功能进行快速响应。
比如：
2.多任务系统
相比于裸机系统，多任务系统的事件处理是在任务中完成的，对于紧急事件，同样采用中断功能进行快速响应。
多任务系统通常包含多个任务，彼此独立，方便编程，同时，任务具有优先级，高优先级任务可以打断低优先级任务，系统的实时性进一步得到提高。
比如：
引入操作系统后，在编程时不需要精心设计程序执行流，任务间不存在干扰。当然，系统需要占用一定的RAM和FLASH资源。 手动移植FreeRTOS代码
第一步：官网下载FreeRTOS源码
官网网址：http://www.freertos.org,进入后点击 下载FreeRTOS
第二步：准备基础工程，这里用的是之前使用的流水灯工程为基础（或自行建立一个工程即可），延时时钟基准由SysTick改到Tim2（任意空闲的定时器都行），删除主循环内的代码。
FreeRTOS操作系统使用SysTick作为基准时钟
第三步：将FreeRTOS源码添加至工程中，设置头文件路径，编译工程。
将FreeRTOS源码复制到工程中，另外，将portable与RVDS文件夹多余的文件删除 Keil工程新建2个Groups-FreeRTOS/Source与FreeRTOS/Port，同时添加相应的文件 添加头文件路径 第四步：将FreeRTOSConfig.h文件（位于Demo-CORTEX-STM32F103_Keil工程中）添加至工程MyApplication文件内，方便打开与修改，同时添加至MyApplication组内，再次编译。
第五步：修改FreeRTOSConfig.h文件并编译。
这一步编译后还会出现3个错误，原因是图中下面框中的3个自行增加的宏定义与中断文件，即stm32f1xx_it.c中的3个函数定义重合，将中断文件里的3个函数注射掉即可。下图是其中1个函数。
进行这一步的原因是为了FreeRTOS操作系统中的3个函数名与实际相联系，便于理解操作。
第六步：工程添加MyTask.c文件，用于以后建立任务（使用结构体的方式创建任务），同时MyApplication.h头文件中添加FreeRTOS与MyTask的头文件。
MyTask_t MyTask = { AppTaskCreate }; /* * @name AppTaskCreate * @brief 创建应用任务 * @param None * @retval None */ static void AppTaskCreate() { xTaskCreate(vTaskLED1, &#34;vTaskLED1&#34;, 512, NULL, 1, &amp;xHandleTaskLED1); xTaskCreate(vTaskLED2, &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8ec9fc6bb51500fda30cc2135e0aba04/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-01T18:27:09+08:00" />
<meta property="article:modified_time" content="2023-08-01T18:27:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">FreeRTOS——操作系统介绍、手动移植代码与CubeMx创建FreeRTOS</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p><strong>FreeRTOS简介</strong></p> 
</blockquote> 
<p><strong>1.嵌入式操作系统</strong></p> 
<p>嵌入式操作系统是为了区别于通用的计算机操作系统，人们把嵌入到对象体系中，为实现对象体系智能化控制的计算机操作系统，称作嵌入式计算机操作系统，简称嵌入式操作系统。<br> 嵌入式操作系统分类：<br> ②按对外部事件的响应能力来分类，嵌入式操作系统分实时操作系统和分时操作系统。<br> 如果操作系统能及时的响应外部事件请求，并能控制所有实时设备和实时任务协调运行，且能在一个规定的时间内完成对事件的处理，那么这种系统就称为实时操作系统。<br> 如果操作系统按时间片轮转完成各个任务，任务没有优先级，这种系统就称为分时操作系统。<br> ②按时间的严格程度来分，实时操作系统又分为强实时操作系统和弱实时操作系统。系统必须在极其严格的时间内完成的任务叫做硬实时操作系统，比如飞机系统；如果不是很严格的话就是弱实时操作系统，比如信息采集系统。</p> 
<p><strong>2.FreeRTOS 实时操作系统</strong><br>  FreeRTOS 是一款开源免费的实时操作系统，商业使用的话不需要用户公开源代码，也不存在任何版权问题，是当前小型嵌入式操作系统市场使用率最高的。<br>  FreeRTOS 的移植比较简单，只需要用户添加需要的源码文件，不需要做任何的底层工作，再添加几个宏定义即可。</p> 
<p><strong>裸机系统与多任务系统</strong></p> 
<p><strong>1.裸机系统</strong></p> 
<p>裸机编程时，先初始化相关的硬件，然后让主程序在一个死循环里面不断地循环，顺序地处理各种事件。对于紧急事件，采用中断功能进行快速响应。</p> 
<p>比如：</p> 
<p><img alt="" height="392" src="https://images2.imgbox.com/f8/aa/cdumlqwU_o.png" width="170"></p> 
<p> 2.多任务系统</p> 
<p>相比于裸机系统，多任务系统的事件处理是在任务中完成的，对于紧急事件，同样采用中断功能进行快速响应。</p> 
<p>多任务系统通常包含多个任务，彼此独立，方便编程，同时，任务具有优先级，高优先级任务可以打断低优先级任务，系统的实时性进一步得到提高。</p> 
<p>比如：</p> 
<p><img alt="" height="408" src="https://images2.imgbox.com/ec/de/1F7IEC68_o.png" width="452"></p> 
<p><img alt="" height="757" src="https://images2.imgbox.com/63/05/yMDmXSv5_o.png" width="316"> </p> 
<p>引入操作系统后，在编程时不需要精心设计程序执行流，任务间不存在干扰。当然，系统需要占用一定的RAM和FLASH资源。 </p> 
<p></p> 
<blockquote> 
 <p><strong>手动移植FreeRTOS代码</strong></p> 
</blockquote> 
<p>第一步：官网下载FreeRTOS源码</p> 
<p>官网网址：<a class="link-info" href="http://www.freertos.org" rel="nofollow" title="http://www.freertos.org">http://www.freertos.org</a>,进入后点击 下载FreeRTOS</p> 
<p><img alt="" height="525" src="https://images2.imgbox.com/f1/36/eT6nw8aE_o.png" width="1200"></p> 
<p> 第二步：准备基础工程，这里用的是之前使用的流水灯工程为基础（或自行建立一个工程即可），延时时钟基准由SysTick改到Tim2（任意空闲的定时器都行），删除主循环内的代码。</p> 
<p><span style="color:#fe2c24;">FreeRTOS操作系统使用SysTick作为基准时钟</span></p> 
<p><img alt="" height="354" src="https://images2.imgbox.com/e2/a1/dddWhx9d_o.png" width="817"></p> 
<p> 第三步：将FreeRTOS源码添加至工程中，设置头文件路径，编译工程。</p> 
<ul><li>将FreeRTOS源码复制到工程中，另外，将portable与RVDS文件夹多余的文件删除</li></ul> 
<p><img alt="" height="410" src="https://images2.imgbox.com/f2/2b/nh11svcC_o.png" width="1053"></p> 
<p><img alt="" height="231" src="https://images2.imgbox.com/f0/74/MHCWs0n4_o.png" width="1098"> </p> 
<p><img alt="" height="145" src="https://images2.imgbox.com/00/26/ATZSh9Yo_o.png" width="1085"> </p> 
<ul><li>Keil工程新建2个Groups-FreeRTOS/Source与FreeRTOS/Port，同时添加相应的文件</li></ul> 
<p><img alt="" height="418" src="https://images2.imgbox.com/f3/ef/xEQyLFdl_o.png" width="354"> </p> 
<ul><li>添加头文件路径</li></ul> 
<p><img alt="" height="443" src="https://images2.imgbox.com/a8/dd/6ugRVYRS_o.png" width="697"></p> 
<p>第四步：将FreeRTOSConfig.h文件（位于Demo-CORTEX-STM32F103_Keil工程中）添加至工程MyApplication文件内，方便打开与修改，同时添加至MyApplication组内，再次编译。</p> 
<p><img alt="" height="598" src="https://images2.imgbox.com/41/6e/tMjOa0Ha_o.png" width="840"></p> 
<p>第五步：修改FreeRTOSConfig.h文件并编译。</p> 
<p><img alt="" height="584" src="https://images2.imgbox.com/29/a0/xygYCzls_o.png" width="1200"> 这一步编译后还会出现3个错误，原因是图中下面框中的3个自行增加的宏定义与中断文件，即stm32f1xx_it.c中的3个函数定义重合，将中断文件里的3个函数注射掉即可。下图是其中1个函数。</p> 
<p><span style="color:#fe2c24;">进行这一步的原因是为了FreeRTOS操作系统中的3个函数名与实际相联系，便于理解操作。</span></p> 
<p><img alt="" height="291" src="https://images2.imgbox.com/81/66/0krJkfDK_o.png" width="652"></p> 
<p> 第六步：工程添加MyTask.c文件，用于以后建立任务（使用结构体的方式创建任务），同时MyApplication.h头文件中添加FreeRTOS与MyTask的头文件。</p> 
<p><img alt="" height="387" src="https://images2.imgbox.com/c2/e1/AjOKW9jO_o.png" width="620"></p> 
<p> </p> 
<pre><code class="language-cs">MyTask_t MyTask = 
{
	AppTaskCreate
};      

/*
	* @name   AppTaskCreate
	* @brief  创建应用任务
	* @param  None
	* @retval None      
*/
static void AppTaskCreate()
{
	xTaskCreate(vTaskLED1,  
  "vTaskLED1",            
  512,                    
  NULL,                   
  1,                      
  &amp;xHandleTaskLED1);     
	
	xTaskCreate(vTaskLED2,  
  "vTaskLED2",           
  512,                    
  NULL,                  
  2,                      
  &amp;xHandleTaskLED2);     
	
	xTaskCreate(vTaskLED3,  //任务函数
  "vTaskLED3",            //任务名称
  512,                    //任务栈大小
  NULL,                   //任务参数
  3,                      //任务优先级
  &amp;xHandleTaskLED3);      //任务句柄，需实现定义
}</code></pre> 
<blockquote> 
 <p><strong> 使用CubeMx创建FreeRTOS</strong></p> 
</blockquote> 
<p>准备基础工程，这里用的是之前使用的流水灯工程为基础（或自行建立一个工程即可），延时时钟基准由SysTick改到Tim2（任意空闲的定时器都行），删除主循环内的代码。</p> 
<p><img alt="" height="354" src="https://images2.imgbox.com/96/89/4OvRlv83_o.png" width="817"></p> 
<p>点击Middleware卡，点击FreeRTOS，选择interface</p> 
<p>interfa选择说明：</p> 
<p>        Disable：禁用FreeRTOS</p> 
<p>        CMSIS_V1：CMSIS-RTOS版本为V1.02，一般选择这个</p> 
<p>        CMSIS_V2：CMSIS-RTOS版本为V2.00，兼容更多的CPU架构，但代码量大</p> 
<p><img alt="" height="649" src="https://images2.imgbox.com/0f/7e/KQ6vOwA7_o.png" width="568"></p> 
<p> 最后根据需求点击下面参数配置，再创建工程就可以了</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/071be8026dedb77914417dd251317621/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JS中的defineProperty</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eb1d63c0e1546676589504ec0e9c5ad4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">scrapy框架简单实现豆瓣评分爬取案例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>