<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>论文阅读：基于MCMC的能量模型最大似然学习剖析 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="论文阅读：基于MCMC的能量模型最大似然学习剖析" />
<meta property="og:description" content="On the Anatomy of MCMC-Based Maximum Likelihood Learning of Energy-Based Models
相关代码：点击
本文只介绍关于MCMC训练的部分，由此可知，MCMC常常被用于训练EBM。最后一张图源于Implicit Generation and Modeling with Energy-Based Models
本研究调查了马尔可夫链蒙特卡罗 (MCMC) 采样在无监督最大似然 (ML) 学习中的效果。 我们的注意力仅限于非归一化概率密度族，其中负对数密度（或能量函数）是 ConvNet。 我们发现，之前研究中用于稳定训练的许多技术都是不必要的。 具有 ConvNet 潜力的 ML 学习只需要几个超参数，并且不需要正则化。 使用这个最小框架，我们确定了仅取决于 MCMC 采样实施的各种 ML 学习成果。
一方面，我们表明训练基于能量的模型很容易，该模型可以使用短期 Langevin 对真实图像进行采样。 即使 MCMC 样本在整个训练过程中比真正的稳态样本具有更高的能量，ML 也可以是有效且稳定的。 基于这一见解，我们引入了一种 ML 方法，该方法具有纯噪声初始化的 MCMC、高质量短期合成，以及与具有信息性 MCMC 初始化（例如 CD 或 PCD）的 ML 相同的预算。 与以前的模型不同，我们的能量模型可以在训练后从噪声信号中获得真实的高多样性样本。
另一方面，使用非收敛 MCMC 学习的 ConvNet 势不具有有效的稳态，并且不能被视为近似训练数据的非标准化密度，因为长期运行的 MCMC 样本与观察到的图像有很大差异。 我们表明，训练 ConvNet 学习真实图像稳态的潜力要困难得多。 据我们所知，所有先前模型的长期 MCMC 样本都失去了短期样本的真实性。 通过正确调整 Langevin 噪声，我们训练了第一个 ConvNet 电位，其中长期和稳态 MCMC 样本是真实图像。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/24372ac3b134f26fa856e0060b91e739/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-02T13:31:19+08:00" />
<meta property="article:modified_time" content="2024-01-02T13:31:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">论文阅读：基于MCMC的能量模型最大似然学习剖析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><a href="https://arxiv.org/pdf/1903.12370.pdf" rel="nofollow">On the Anatomy of MCMC-Based Maximum Likelihood Learning of Energy-Based Models</a><br> 相关代码：<a href="https://github.com/point0bar1/ebm-anatomy?tab=readme-ov-file">点击</a></p> 
<blockquote> 
 <p>本文只介绍关于MCMC训练的部分，由此可知，MCMC常常被用于训练EBM。最后一张图源于<a href="https://arxiv.org/pdf/1903.08689.pdf" rel="nofollow">Implicit Generation and Modeling with Energy-Based Models</a></p> 
</blockquote> 
<p>本研究调查了马尔可夫链蒙特卡罗 (MCMC) 采样在无监督最大似然 (ML) 学习中的效果。 我们的注意力仅限于非归一化概率密度族，其中负对数密度（或能量函数）是 ConvNet。 我们发现，之前研究中用于稳定训练的许多技术都是不必要的。 具有 ConvNet 潜力的 ML 学习只需要几个超参数，并且不需要正则化。 使用这个最小框架，我们确定了仅取决于 MCMC 采样实施的各种 ML 学习成果。</p> 
<p>一方面，我们表明训练基于能量的模型很容易，该模型可以使用短期 Langevin 对真实图像进行采样。 即使 MCMC 样本在整个训练过程中比真正的稳态样本具有更高的能量，ML 也可以是有效且稳定的。 基于这一见解，我们引入了一种 ML 方法，该方法具有纯噪声初始化的 MCMC、高质量短期合成，以及与具有信息性 MCMC 初始化（例如 CD 或 PCD）的 ML 相同的预算。 与以前的模型不同，我们的能量模型可以在训练后从噪声信号中获得真实的高多样性样本。</p> 
<p>另一方面，使用非收敛 MCMC 学习的 ConvNet 势不具有有效的稳态，并且不能被视为近似训练数据的非标准化密度，因为长期运行的 MCMC 样本与观察到的图像有很大差异。 我们表明，训练 ConvNet 学习真实图像稳态的潜力要困难得多。 据我们所知，所有先前模型的长期 MCMC 样本都失去了短期样本的真实性。 通过正确调整 Langevin 噪声，我们训练了第一个 ConvNet 电位，其中长期和稳态 MCMC 样本是真实图像。</p> 
<h3><a id="1_Introduction_10"></a>1 Introduction</h3> 
<h4><a id="11__11"></a>1.1 诊断基于能量的模型</h4> 
<p>高维信号的统计建模是许多学科和实际应用中遇到的一项具有挑战性的任务。 我们在这项工作中研究图像信号。 当图像没有注释或标签时，深度监督学习的有效工具就无法应用，而必须使用无监督技术。 这项工作重点关注具有 ConvNet 势函数 (2) 的基于能量的模型 (1) 的无监督范式。</p> 
<p>之前研究ConvNet势的最大似然（ML）训练的工作，例如（Xie et al. 2016；2018a；Gao et al. 2018），在学习过程中使用Langevin MCMC样本来近似未知且棘手的对数划分函数的梯度。 作者普遍发现，经过足够的模型更新后，短期 Langevin 从信息初始化（参见第 2.3 节）生成的 MCMC 样本是与数据相似的真实图像。<br> <img src="https://images2.imgbox.com/65/ae/tMSfj7bW_o.png" alt="在这里插入图片描述"></p> 
<p>图 2：Oxford Flowers 102 数据集从数据样本到亚稳态样本的长期 MH 调整 Langevin 路径。 使用算法 1 的两种变体来训练模型：使用来自噪声初始化的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         L 
        
       
         = 
        
       
         100 
        
       
      
        L = 100 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">100</span></span></span></span></span> MCMC 步骤训练的非收敛 ML（顶部），以及使用来自持久初始化的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         L 
        
       
         = 
        
       
         500 
        
       
      
        L = 500 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">500</span></span></span></span></span> MCMC 步骤训练的收敛 ML（底部）。</p> 
<p>然而，我们发现，无论 MCMC 初始化、网络结构和辅助训练参数如何，先前工作学习的能量函数都存在重大缺陷。先前所有实现的能量函数的长期和稳态 MCMC 样本都是过饱和图像，具有显着的过饱和图像。 能量低于观测到的数据（见图 2 顶部和图 3）。 在这种情况下，将学习模型描述为训练集的近似密度是不合适的，因为该模型将不成比例的高概率质量分配给与观察数据显着不同的图像。 高质量短期样本和低质量长期样本之间的系统差异是一个关键现象，但在之前的研究中似乎没有被注意到。<br> <img src="https://images2.imgbox.com/0e/29/caDzT6bO_o.png" alt="在这里插入图片描述"><br> 图 3：近期基于能量的模型的长期 Langevin 样本。 概率质量集中在具有不真实外观的图像上。 从左到右：牛津花上的 Wasserstein-GAN 评论家（Arjovsky、Chintala 和 Bottou，2017 年）、牛津花上的 WINN（Lee 等人，2018 年）、ImageNet 上的条件 EBM（Du 和 Mordatch，2019 年）。 W-GAN 批评者并未接受非标准化密度训练，但我们提供了样本以供参考。</p> 
<h4><a id="12_Our_Contributions_23"></a>1.2 Our Contributions</h4> 
<p>在这项工作中，我们提出了对通过基于 MCMC 的 ML 学习 ConvNet 潜力的基本理解。 我们诊断学习过程中出现的以前未识别的并发症，并提炼我们的见解来训练具有新功能的模型。 我们的主要贡献是：</p> 
<ul><li>识别两个不同的轴，它们表征基于MCMC的ML学习中的每个参数更新：1）正负样本的能量差异，以及2）MCMC收敛或不收敛。 与普遍预期相反，高质量合成不需要收敛。 参见图 1 和第 3 节。</li><li>第一个 ConvNet 势是使用 ML 和纯噪声初始化 MCMC 进行训练的。 与之前的模型不同，我们的模型在仅根据噪声进行训练后可以有效地生成真实且多样化的样本。 参见图 7。我们的配套工作（Nijkamp 等人，2019）进一步探讨了这种方法。</li><li>第一个具有真实稳态样本的 ConvNet 潜力。 据我们所知，所有以前的训练实现都无法获得在图像空间中具有真实 MCMC 采样的 ConvNet 潜力。 我们参考（Kumar et al. 2019）进行讨论。 请参见图 2（底部）和图 8（中栏和右栏）。</li><li>利用磁化能量景观中的扩散来映射图像空间能量函数的宏观结构，以进行无监督的簇发现。 见图9</li></ul> 
<h4><a id="13_Related_Work_29"></a>1.3 Related Work</h4> 
<p><strong>基于能量的图像模型</strong> 基于能量的模型定义状态空间上的非归一化概率密度，以表示给定系统中的状态分布。 Hopfield 网络（Hopfield 1982）将 Ising 能量模型改编为能够表示任意观测数据的模型。 RBM（受限玻尔兹曼机）（Hinton 2012）和 FRAME（滤波器、随机场和最大熵）（Zhu、Wu 和 Mumford 1998；Wu、Zhu 和 Liu 2000）模型引入了具有更大表征能力的能量函数。 RBM 使用与可观察图像像素具有联合密度的隐藏单元。 FRAME模型使用卷积滤波器和直方图匹配来学习数据特征。</p> 
<p>开创性的工作（Hinton 等人，2006）研究了基于能量的分层模型。 （Ngiam 等人，2011）是一项重要的早期工作，提出了前馈神经网络来模拟能量函数。 (2) 形式的基于能量的模型在 (Dai, Lu, and Wu 2015) 中介绍。 FRAME 模型的深度变体（Xie 等人，2016 年；Lu、Zhu 和 Wu，2016 年）是第一个通过 ConvNet 势和 Langevin 采样实现真实合成的模型。 (Du and Mordatch 2019) 中应用了类似的方法。多网格模型（Gao et al. 2018）学习不同尺度图像的 ConvNet 势的集合。 (Kim and Bengio 2016; Dai et al. 2017; Xie et al. 2018b; 2018a; Han et al. 2019; Kumar et al. 2019) 中探讨了使用生成器网络作为近似直接采样器来学习 ConvNet 势。 这些作品（Jin、Lazarow 和 Tu 2017；Lazarow、Jin 和 Tu 2017；Lee 等人 2018）在判别框架中学习 ConvNet 潜力。</p> 
<p>尽管其中许多工作声称将能量 (2) 训练为观察图像的近似非标准化密度，但生成的能量函数不具有反映数据的稳态（见图 3）。 来自信息初始化的短期 Langevin 样本呈现为近似稳态样本，但进一步的研究表明长期 Langevin 始终破坏短期图像的真实性。 我们的工作首先是解决和纠正所有先前实现的系统性不收敛问题。</p> 
<h3><a id="2_Learning_EnergyBased_Models_35"></a>2. Learning Energy-Based Models</h3> 
<p>在本节中，我们回顾了先前作品中基于 MCMC 的 ML 学习的既定原则（Hinton 2002；Zhu、Wu 和 Mumford 1998；Xie 等人 2016）。</p> 
<h4><a id="21_Maximum_Likelihood_Estimation_37"></a>2.1 Maximum Likelihood Estimation</h4> 
<p>基于能量的模型是吉布斯-玻尔兹曼密度<img src="https://images2.imgbox.com/6f/57/hDaRNcu9_o.png" alt="在这里插入图片描述"></p> 
<p>在信号 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
         ∈ 
        
       
         X 
        
       
         ⊂ 
        
        
        
          R 
         
        
          N 
         
        
       
      
        x ∈ X ⊂ R^N 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7224em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.109em;">N</span></span></span></span></span></span></span></span></span></span></span></span> 上。 势能 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         U 
        
       
         ( 
        
       
         x 
        
       
         ; 
        
       
         θ 
        
       
         ) 
        
       
      
        U(x; θ) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">U</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mclose">)</span></span></span></span></span> 属于参数族 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         u 
        
       
         = 
        
       
         { 
        
       
         U 
        
       
         ( 
        
       
         ⋅ 
        
       
         ; 
        
       
         θ 
        
       
         ) 
        
       
         : 
        
       
         θ 
        
       
         ∈ 
        
       
         θ 
        
       
         } 
        
       
      
        u = \{U(· ; θ) : θ ∈ θ\} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{<!-- --></span><span class="mord mathnormal" style="margin-right: 0.109em;">U</span><span class="mopen">(</span><span class="mpunct">⋅;</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7335em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mclose">}</span></span></span></span></span>。 棘手的常数 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Z 
        
       
         ( 
        
       
         θ 
        
       
         ) 
        
       
      
        Z(\theta) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mclose">)</span></span></span></span></span> 从未被明确使用，因为势 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         U 
        
       
         ( 
        
       
         x 
        
       
         ; 
        
       
         θ 
        
       
         ) 
        
       
      
        U(x; θ) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">U</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mclose">)</span></span></span></span></span> 为 MCMC 采样提供了足够的信息。 在本文中，我们将注意力集中在形式为的能量势上<br> <img src="https://images2.imgbox.com/d9/e8/62mej8jR_o.png" alt="在这里插入图片描述"><br> 其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         F 
        
       
         ( 
        
       
         x 
        
       
         ; 
        
       
         θ 
        
       
         ) 
        
       
      
        F(x; θ) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mclose">)</span></span></span></span></span> 是具有单个输出通道和权重 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         θ 
        
       
         ∈ 
        
        
        
          R 
         
        
          D 
         
        
       
      
        θ ∈ R^D 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7335em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">D</span></span></span></span></span></span></span></span></span></span></span></span> 的卷积神经网络.<br> 在机器学习中，我们寻求找到 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         θ 
        
       
         ∈ 
        
       
         Θ 
        
       
      
        θ ∈ \Theta 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7335em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">Θ</span></span></span></span></span>，使得参数模型 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          p 
         
        
          θ 
         
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
      
        p_θ(x) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> 非常接近数据分布 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         q 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
      
        q(x) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>。 衡量接近程度的一种方法是 KullbackLeibler (KL) 散度。 学习通过解决问题来进行<br> <img src="https://images2.imgbox.com/0a/03/BUdFcgbP_o.png" alt="在这里插入图片描述"><br> 我们可以通过求导数的根来最小化 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         L 
        
       
         ( 
        
       
         θ 
        
       
         ) 
        
       
      
        L(θ) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mclose">)</span></span></span></span></span><br> <img src="https://images2.imgbox.com/d3/e1/g4P4cF34_o.png" alt="在这里插入图片描述"><br> 其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         { 
        
        
        
          X 
         
        
          i 
         
        
          + 
         
        
        
        
          } 
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
        
          n 
         
        
       
      
        \{X^+_i \} ^n_{i=1} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0883em; vertical-align: -0.2769em;"></span><span class="mopen">{<!-- --></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8115em;"><span class="" style="top: -2.4231em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span class="" style="top: -3.1031em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2769em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2587em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
         . 
        
       
         i 
        
       
         . 
        
       
         d 
        
       
         . 
        
       
      
        i.i.d. 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">i</span><span class="mord">.</span><span class="mord mathnormal">i</span><span class="mord">.</span><span class="mord mathnormal">d</span><span class="mord">.</span></span></span></span></span> 来自数据分布 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         q 
        
       
      
        q 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">q</span></span></span></span></span> 的样本（称为正样本，因为概率增加），并且 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         { 
        
        
        
          X 
         
        
          i 
         
        
          − 
         
        
        
        
          } 
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
        
          m 
         
        
       
      
        \{X^−_i \} ^m_{i=1} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0883em; vertical-align: -0.2769em;"></span><span class="mopen">{<!-- --></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8115em;"><span class="" style="top: -2.4231em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span class="" style="top: -3.1031em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2769em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2587em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
         . 
        
       
         i 
        
       
         . 
        
       
         d 
        
       
      
        i.i.d 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">i</span><span class="mord">.</span><span class="mord mathnormal">i</span><span class="mord">.</span><span class="mord mathnormal">d</span></span></span></span></span> 来自当前学习分布 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          p 
         
        
          θ 
         
        
       
      
        p_θ 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的样本（称为负样本，因为概率降低了）。 实际上，正样本<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         { 
        
        
        
          X 
         
        
          i 
         
        
          + 
         
        
        
        
          } 
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
        
          n 
         
        
       
      
        \{X^+_i \} ^n_{i=1} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0883em; vertical-align: -0.2769em;"></span><span class="mopen">{<!-- --></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8115em;"><span class="" style="top: -2.4231em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span class="" style="top: -3.1031em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2769em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2587em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是一批训练图像，负样本 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         { 
        
        
        
          X 
         
        
          i 
         
        
          − 
         
        
        
        
          } 
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
        
          m 
         
        
       
      
        \{X^−_i \} ^m_{i=1} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0883em; vertical-align: -0.2769em;"></span><span class="mopen">{<!-- --></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8115em;"><span class="" style="top: -2.4231em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span class="" style="top: -3.1031em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2769em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2587em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是经过<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         L 
        
       
      
        L 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></span> 次MCMC采样迭代后得到的。<br> <img src="https://images2.imgbox.com/c6/38/9RGqf59r_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/662517880033ba2f5a7fefe81a54b5ea/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JavaWeb小项目练习(基于三层架构实现登录，对表增，删，改，查的操作)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2bd3dfb2ebd2096385b5107c743b4f70/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">RabbitMQ 教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>