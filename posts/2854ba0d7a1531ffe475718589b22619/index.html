<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于QT的TCP通信实现(TCPServer和TCPClient) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于QT的TCP通信实现(TCPServer和TCPClient)" />
<meta property="og:description" content="文章目录 一、软件介绍1.1 TCPServer服务端界面1.2 TCPClient客户端界面1.3 服务端和客户端建立连接并通信演示 二、QT实现TCPServer和TCPClient2.1 TCPClient客户端2.1 TCPServer服务端 三、代码分享 近期因为测试需要用到 TCPServer（TCP服务端）和 TCPClient（TCP客户端）来进行通信和数据的发送以及接受，所以用QT分别写了TCP服务端和TCP客户端，本文分享以下基于QT开发TCPServer和TCPClient的经验， 文中包括源码，在文末处包含项目的源码文件。 一、软件介绍 TCPServer可以绑定一个ip地址并监听一个端口，在TCPServer绑定并监听状态时，可以使用TCPClient来连接服务端绑定的ip地址和端口，连接成功后便可进行通信了。下面首先演示以下服务端和客户端界面以及通信流程。
1.1 TCPServer服务端界面 在服务端的界面中，“开始监听”按钮可以在设置“监听地址”、“监听端口”后点击既开始对此ip地址和端口进行监听，当有TCPClient客户端针对此ip地址和端口进行请求连接时便可进行连接，随后开始通信。“停止监听”可以停止对ip地址和端口号的监听。“清空文本框”按钮可以清空消息记录，方便连续信息的阅读。“退出”按钮即关闭此软件。“发送消息”可发送已经输入的内容。
1.2 TCPClient客户端界面 在客户端的界面中，“连接”按钮可以在设置“连接地址”、“端口”后点击既开始对此ip地址和端口进行请求连接，当有TCPServer服务端针对此ip地址和端口进行监听时便可进行连接，随后开始通信。“断开连接”可以讲服务端和客户端已经建立的连接断开。“清空文本框”按钮可以清空消息记录，方便连续信息的阅读。“发送消息”和“清除”按钮分别可发送和清除已经输入的内容。“退出”按钮即关闭此软件。
1.3 服务端和客户端建立连接并通信演示 首先在Server端我们绑定ip:192.168.31.222，端口:1200，然后点击“开始监听”按钮，这时服务端就开始等待Client端请求建立连接。
接下来我们使用客户端，连接地址和端口号设置为服务端所绑定的ip:192.168.31.222，端口:1200，然后点击“连接”按钮，可以看到双方建立连接成功，软件出现连接成功建立提示信息。
双方建立连接成功便可以开始通信，我们首先点击“清空文本框”把提示信息清除，然后使用TCPServer服务端发送一条信息“Hello，I’m TCPServer~”，可以看到客户端成功收到服务端发送的信息，[in]后边的内容为本端收到的信息，[out]后边的内容为本端发送的信息。
接下来我们使用TCPClient客户端给服务端发送一条信息“Hi，I’m TCPClient!”，可以看到服务端成功收到信息。
二、QT实现TCPServer和TCPClient 我们想要在QT中实现TCP通信需要在.pro文件中添加下面一行代码：
QT &#43;= network 2.1 TCPClient客户端 首先我们应该包含下面三个头文件来支持我们调用内部的通信函数： #include &lt;QTcpSocket&gt; #include &lt;QHostAddress&gt; #include &lt;QHostInfo&gt; 创建QTcpSocket套接字对象 tcpClient = new QTcpSocket(this); 使用tcpClient 对象连接服务器 tcpClient -&gt;connectToHost(IP, port); 然后我们用write()函数向服务器发送数据 tcpClient -&gt;write(data); 当tcpClient 接收缓冲区有新数据到来时，会发出readRead()信号，因此为该信号添加槽函数以读取数据 connect(tcpClient,SIGNAL(readyRead()),this,SLOT(onSocketReadyRead())); void MainWindow::onSocketReadyRead() {//readyRead()信号槽函数 while(tcpClient-&gt;canReadLine()) ui-&gt;plainTextEdit-&gt;appendPlainText(&#34;[in] &#34;&#43;tcpClient-&gt;readLine()); } 在我们通信完毕后需要断开连接 void MainWindow::on_actDisconnect_triggered() {//断开与服务器的连接 if (tcpClient-&gt;state()==QAbstractSocket::ConnectedState) tcpClient-&gt;disconnectFromHost(); } 下面给出TCPClient的代码" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2854ba0d7a1531ffe475718589b22619/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-24T01:05:10+08:00" />
<meta property="article:modified_time" content="2023-03-24T01:05:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于QT的TCP通信实现(TCPServer和TCPClient)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">一、软件介绍</a></li><li><ul><li><a href="#11_TCPServer_4" rel="nofollow">1.1 TCPServer服务端界面</a></li><li><a href="#12_TCPClient_11" rel="nofollow">1.2 TCPClient客户端界面</a></li><li><a href="#13__18" rel="nofollow">1.3 服务端和客户端建立连接并通信演示</a></li></ul> 
   </li><li><a href="#QTTCPServerTCPClient_27" rel="nofollow">二、QT实现TCPServer和TCPClient</a></li><li><ul><li><a href="#21_TCPClient_33" rel="nofollow">2.1 TCPClient客户端</a></li><li><a href="#21_TCPServer_317" rel="nofollow">2.1 TCPServer服务端</a></li></ul> 
   </li><li><a href="#_643" rel="nofollow">三、代码分享</a></li></ul> 
 </li></ul> 
</div> 
<br> 近期因为测试需要用到 
<font color="red">TCPServer（TCP服务端）</font>和 
<font color="red">TCPClient（TCP客户端）</font>来进行通信和数据的发送以及接受，所以用QT分别写了TCP服务端和TCP客户端，本文分享以下基于QT开发TCPServer和TCPClient的经验， 
<font color="red">文中包括源码，在文末处包含项目的源码文件</font>。 
<p></p> 
<h3><a id="_2"></a>一、软件介绍</h3> 
<p>TCPServer可以绑定一个ip地址并监听一个端口，在TCPServer绑定并监听状态时，可以使用TCPClient来连接服务端绑定的ip地址和端口，连接成功后便可进行通信了。下面首先演示以下服务端和客户端界面以及通信流程。</p> 
<h4><a id="11_TCPServer_4"></a>1.1 TCPServer服务端界面</h4> 
<ul><li>在服务端的界面中，“开始监听”按钮可以在设置“监听地址”、“监听端口”后点击既开始对此ip地址和端口进行监听，当有TCPClient客户端针对此ip地址和端口进行请求连接时便可进行连接，随后开始通信。</li><li>“停止监听”可以停止对ip地址和端口号的监听。</li><li>“清空文本框”按钮可以清空消息记录，方便连续信息的阅读。</li><li>“退出”按钮即关闭此软件。</li><li>“发送消息”可发送已经输入的内容。<br> <img src="https://images2.imgbox.com/bc/c8/JRt6mIrA_o.png" alt="在这里插入图片描述"></li></ul> 
<h4><a id="12_TCPClient_11"></a>1.2 TCPClient客户端界面</h4> 
<ul><li>在客户端的界面中，“连接”按钮可以在设置“连接地址”、“端口”后点击既开始对此ip地址和端口进行请求连接，当有TCPServer服务端针对此ip地址和端口进行监听时便可进行连接，随后开始通信。</li><li>“断开连接”可以讲服务端和客户端已经建立的连接断开。</li><li>“清空文本框”按钮可以清空消息记录，方便连续信息的阅读。</li><li>“发送消息”和“清除”按钮分别可发送和清除已经输入的内容。</li><li>“退出”按钮即关闭此软件。<br> <img src="https://images2.imgbox.com/bf/82/GzMmGnpY_o.png" alt="在这里插入图片描述"></li></ul> 
<h4><a id="13__18"></a>1.3 服务端和客户端建立连接并通信演示</h4> 
<ul><li>首先在Server端我们绑定ip:192.168.31.222，端口:1200，然后点击“开始监听”按钮，这时服务端就开始等待Client端请求建立连接。<br> <img src="https://images2.imgbox.com/d9/d3/koy0qhn0_o.png" alt="在这里插入图片描述"></li><li>接下来我们使用客户端，连接地址和端口号设置为服务端所绑定的ip:192.168.31.222，端口:1200，然后点击“连接”按钮，可以看到双方建立连接成功，软件出现连接成功建立提示信息。<br> <img src="https://images2.imgbox.com/64/05/ZoM6MWgl_o.png" alt="在这里插入图片描述"></li><li>双方建立连接成功便可以开始通信，我们首先点击“清空文本框”把提示信息清除，然后使用TCPServer服务端发送一条信息“Hello，I’m TCPServer~”，可以看到客户端成功收到服务端发送的信息，[in]后边的内容为本端收到的信息，[out]后边的内容为本端发送的信息。<br> <img src="https://images2.imgbox.com/35/1c/Bttk7eUV_o.png" alt="在这里插入图片描述"></li><li>接下来我们使用TCPClient客户端给服务端发送一条信息“Hi，I’m TCPClient!”，可以看到服务端成功收到信息。<br> <img src="https://images2.imgbox.com/ef/ab/lXUUPYJI_o.png" alt="在这里插入图片描述"></li></ul> 
<h3><a id="QTTCPServerTCPClient_27"></a>二、QT实现TCPServer和TCPClient</h3> 
<p>我们想要在QT中实现TCP通信需要在.pro文件中添加下面一行代码：</p> 
<pre><code class="prism language-cpp">QT       <span class="token operator">+=</span> network
</code></pre> 
<h4><a id="21_TCPClient_33"></a>2.1 TCPClient客户端</h4> 
<ul><li>首先我们应该包含下面三个头文件来支持我们调用内部的通信函数：</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QTcpSocket&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QHostAddress&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QHostInfo&gt;</span></span>
</code></pre> 
<ul><li>创建QTcpSocket套接字对象</li></ul> 
<pre><code class="prism language-cpp">tcpClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTcpSocket</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>使用tcpClient 对象连接服务器</li></ul> 
<pre><code class="prism language-cpp">tcpClient <span class="token operator">-&gt;</span><span class="token function">connectToHost</span><span class="token punctuation">(</span>IP<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>然后我们用write()函数向服务器发送数据</li></ul> 
<pre><code class="prism language-cpp">tcpClient <span class="token operator">-&gt;</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>当tcpClient 接收缓冲区有新数据到来时，会发出readRead()信号，因此为该信号添加槽函数以读取数据</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">connect</span><span class="token punctuation">(</span>tcpClient<span class="token punctuation">,</span><span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">readyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onSocketReadyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">onSocketReadyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token comment">//readyRead()信号槽函数</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>tcpClient<span class="token operator">-&gt;</span><span class="token function">canReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"[in] "</span><span class="token operator">+</span>tcpClient<span class="token operator">-&gt;</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>在我们通信完毕后需要断开连接</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_actDisconnect_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token comment">//断开与服务器的连接</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tcpClient<span class="token operator">-&gt;</span><span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>QAbstractSocket<span class="token double-colon punctuation">::</span>ConnectedState<span class="token punctuation">)</span>
        tcpClient<span class="token operator">-&gt;</span><span class="token function">disconnectFromHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>下面给出TCPClient的代码</p> 
<ul><li>main.cpp</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"mainwindow.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QApplication&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QFile&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QApplication <span class="token function">a</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    MainWindow w<span class="token punctuation">;</span>
    w<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">700</span><span class="token punctuation">,</span><span class="token number">900</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    w<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> a<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<ul><li>mainwindow.h</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">MAINWINDOW_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAINWINDOW_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QMainWindow&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QTcpSocket&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QLabel&gt;</span></span>

<span class="token keyword">namespace</span> Ui <span class="token punctuation">{<!-- --></span>
<span class="token keyword">class</span> <span class="token class-name">MainWindow</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MainWindow</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QMainWindow</span></span>
<span class="token punctuation">{<!-- --></span>
    Q_OBJECT
<span class="token keyword">private</span><span class="token operator">:</span>
    QTcpSocket <span class="token operator">*</span>tcpClient<span class="token punctuation">;</span>  <span class="token comment">//socket</span>
    QLabel <span class="token operator">*</span>LabSocketState<span class="token punctuation">;</span>  <span class="token comment">//状态栏显示标签</span>

    QString <span class="token function">getLocalIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取本机IP地址</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">closeEvent</span><span class="token punctuation">(</span>QCloseEvent <span class="token operator">*</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">explicit</span> <span class="token function">MainWindow</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">MainWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> slots<span class="token operator">:</span>
<span class="token comment">//自定义槽函数</span>
    <span class="token keyword">void</span> <span class="token function">onConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">onDisconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">onSocketStateChange</span><span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>SocketState socketState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">onSocketReadyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//读取socket传入的数据</span>

    <span class="token keyword">void</span> <span class="token function">on_actConnect_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_actDisconnect_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_actClear_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_btnSend_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_btnClear_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_actionTimeCurrent_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    Ui<span class="token double-colon punctuation">::</span>MainWindow <span class="token operator">*</span>ui<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// MAINWINDOW_H</span></span>

</code></pre> 
<ul><li>mainwindow.cpp</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">execution_character_set</span><span class="token punctuation">(</span></span><span class="token string">"utf-8"</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"mainwindow.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_mainwindow.h"</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QHostAddress&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QHostInfo&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QDateTime&gt;</span></span>

<span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">MainWindow</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span>
    <span class="token function">QMainWindow</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>MainWindow<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    tcpClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTcpSocket</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建socket变量</span>

    LabSocketState <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QLabel</span><span class="token punctuation">(</span><span class="token string">"Socket状态："</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//状态栏标签</span>
    LabSocketState<span class="token operator">-&gt;</span><span class="token function">setMinimumWidth</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>statusBar<span class="token operator">-&gt;</span><span class="token function">addWidget</span><span class="token punctuation">(</span>LabSocketState<span class="token punctuation">)</span><span class="token punctuation">;</span>

    QString localIP<span class="token operator">=</span><span class="token function">getLocalIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//本机IP</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"TCP客户端"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>comboServer<span class="token operator">-&gt;</span><span class="token function">addItem</span><span class="token punctuation">(</span>localIP<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">setFocusPolicy</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>StrongFocus<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">installEventFilter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token function">connect</span><span class="token punctuation">(</span>tcpClient<span class="token punctuation">,</span><span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">connected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">connect</span><span class="token punctuation">(</span>tcpClient<span class="token punctuation">,</span><span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">disconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onDisconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">connect</span><span class="token punctuation">(</span>tcpClient<span class="token punctuation">,</span><span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">stateChanged</span><span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>SocketState<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onSocketStateChange</span><span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>SocketState<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">connect</span><span class="token punctuation">(</span>tcpClient<span class="token punctuation">,</span><span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">readyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onSocketReadyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">MainWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">onConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span> <span class="token comment">//connected()信号槽函数</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"**已连接到服务器"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"**peer address:"</span><span class="token operator">+</span>tcpClient<span class="token operator">-&gt;</span><span class="token function">peerAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"**peer port:"</span><span class="token operator">+</span><span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>tcpClient<span class="token operator">-&gt;</span><span class="token function">peerPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>actConnect<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>actDisconnect<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">getLocalIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString hostName <span class="token operator">=</span> <span class="token class-name">QHostInfo</span><span class="token double-colon punctuation">::</span><span class="token function">localHostName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//本地主机名</span>
    QHostInfo hostInfo <span class="token operator">=</span> <span class="token class-name">QHostInfo</span><span class="token double-colon punctuation">::</span><span class="token function">fromName</span><span class="token punctuation">(</span>hostName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString localIP <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

    QList<span class="token operator">&lt;</span>QHostAddress<span class="token operator">&gt;</span> addList<span class="token operator">=</span>hostInfo<span class="token punctuation">.</span><span class="token function">addresses</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>addList<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>addList<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        QHostAddress aHost <span class="token operator">=</span> addList<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>IPv4Protocol <span class="token operator">==</span> aHost<span class="token punctuation">.</span><span class="token function">protocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            localIP<span class="token operator">=</span>aHost<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> localIP<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">closeEvent</span><span class="token punctuation">(</span>QCloseEvent <span class="token operator">*</span>event<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tcpClient<span class="token operator">-&gt;</span><span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> QAbstractSocket<span class="token double-colon punctuation">::</span>ConnectedState<span class="token punctuation">)</span>
        tcpClient<span class="token operator">-&gt;</span><span class="token function">disconnectFromHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    event<span class="token operator">-&gt;</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">onDisconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token comment">//disConnected()信号槽函数</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"**已断开与服务器的连接"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>actConnect<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>actDisconnect<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">onSocketReadyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token comment">//readyRead()信号槽函数</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>tcpClient<span class="token operator">-&gt;</span><span class="token function">canReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"[in] "</span><span class="token operator">+</span>tcpClient<span class="token operator">-&gt;</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">onSocketStateChange</span><span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>SocketState socketState<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token comment">//stateChange()信号槽函数</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>socketState<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>UnconnectedState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：UnconnectedState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>HostLookupState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：HostLookupState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>ConnectingState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：ConnectingState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>

    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>ConnectedState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：ConnectedState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>

    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>BoundState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：BoundState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>

    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>ClosingState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：ClosingState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>

    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>ListeningState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：ListeningState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_actConnect_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token comment">//连接到服务器</span>
    QString addr<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>comboServer<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    quint16 port<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>spinPort<span class="token operator">-&gt;</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tcpClient<span class="token operator">-&gt;</span><span class="token function">connectToHost</span><span class="token punctuation">(</span>addr<span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_actDisconnect_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token comment">//断开与服务器的连接</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tcpClient<span class="token operator">-&gt;</span><span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>QAbstractSocket<span class="token double-colon punctuation">::</span>ConnectedState<span class="token punctuation">)</span>
        tcpClient<span class="token operator">-&gt;</span><span class="token function">disconnectFromHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_actClear_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_btnSend_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token comment">//发送数据</span>

    QString msg<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>editMsg<span class="token operator">-&gt;</span><span class="token function">toPlainText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"[out] "</span><span class="token operator">+</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>

    ui<span class="token operator">-&gt;</span>editMsg<span class="token operator">-&gt;</span><span class="token function">setFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    QByteArray str <span class="token operator">=</span> msg<span class="token punctuation">.</span><span class="token function">toLatin1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tcpClient<span class="token operator">-&gt;</span><span class="token function">write</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_btnClear_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span>editMsg<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_actionTimeCurrent_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString msg<span class="token operator">=</span><span class="token class-name">QDateTime</span><span class="token double-colon punctuation">::</span><span class="token function">currentDateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd hh:mm:ss.zzz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token string">" [out] "</span><span class="token operator">+</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>

    ui<span class="token operator">-&gt;</span>editMsg<span class="token operator">-&gt;</span><span class="token function">setFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    QByteArray str <span class="token operator">=</span> msg<span class="token punctuation">.</span><span class="token function">toLatin1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\r\n\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tcpClient<span class="token operator">-&gt;</span><span class="token function">write</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<ul><li>ui界面<br> <img src="https://images2.imgbox.com/51/b5/T9EkI6Ee_o.png" alt="在这里插入图片描述"></li></ul> 
<h4><a id="21_TCPServer_317"></a>2.1 TCPServer服务端</h4> 
<ul><li>首先需要包含下面的头文件来提供我们需要调用的函数：</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QTcpServer&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtNetwork&gt;</span></span>
</code></pre> 
<ul><li>然后创建TCPServer对象</li></ul> 
<pre><code class="prism language-cpp">tcpServer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">QTcpServer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>绑定ip并监听端口功能，为客户端可以通过这个端口访问服务器</li></ul> 
<pre><code class="prism language-cpp">tcpServer<span class="token operator">-&gt;</span><span class="token function">listen</span><span class="token punctuation">(</span>addr<span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>当tcpServer被tcpClient访问时，会发出newConnection()信号，因此为该信号添加槽函数，并用一个QTcpSocket对象接受客户端访问</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">connect</span><span class="token punctuation">(</span>tcpServer<span class="token punctuation">,</span><span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">newConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onNewConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">onNewConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    tcpSocket <span class="token operator">=</span> tcpServer<span class="token operator">-&gt;</span><span class="token function">nextPendingConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建socket</span>

    <span class="token function">connect</span><span class="token punctuation">(</span>tcpSocket<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">connected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onClientConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onClientConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">connect</span><span class="token punctuation">(</span>tcpSocket<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">disconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onClientDisconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">connect</span><span class="token punctuation">(</span>tcpSocket<span class="token punctuation">,</span><span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">stateChanged</span><span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>SocketState<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onSocketStateChange</span><span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>SocketState<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onSocketStateChange</span><span class="token punctuation">(</span>tcpSocket<span class="token operator">-&gt;</span><span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">connect</span><span class="token punctuation">(</span>tcpSocket<span class="token punctuation">,</span><span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">readyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onSocketReadyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>使用tcpSocket的write()函数向客户端发送数据</li></ul> 
<pre><code class="prism language-cpp">tcpSocket<span class="token operator">-&gt;</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>当tcpSocket接收缓冲区有新数据到来时，会发出readRead()信号，因此为该信号添加槽函数以读取数据</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">connect</span><span class="token punctuation">(</span>tcpSocket<span class="token punctuation">,</span><span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">readyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onSocketReadyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">onSocketReadyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>tcpSocket<span class="token operator">-&gt;</span><span class="token function">canReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"[in] "</span><span class="token operator">+</span>tcpSocket<span class="token operator">-&gt;</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>停止监听</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_actStop_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tcpServer<span class="token operator">-&gt;</span><span class="token function">isListening</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//tcpServer正在监听</span>
    <span class="token punctuation">{<!-- --></span>
        tcpServer<span class="token operator">-&gt;</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//停止监听</span>
        ui<span class="token operator">-&gt;</span>actStart<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>actStop<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        LabListen<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"监听状态：已停止监听"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>下面给出TCPServer的代码</p> 
<ul><li>main.cpp</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"mainwindow.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QApplication&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QApplication <span class="token function">a</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    MainWindow w<span class="token punctuation">;</span>
    w<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span><span class="token number">700</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    w<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> a<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<ul><li>mainwindow.h</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">MAINWINDOW_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAINWINDOW_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QMainWindow&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QTcpServer&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QLabel&gt;</span></span>

<span class="token keyword">namespace</span> Ui <span class="token punctuation">{<!-- --></span>
<span class="token keyword">class</span> <span class="token class-name">MainWindow</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MainWindow</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QMainWindow</span></span>
<span class="token punctuation">{<!-- --></span>
    Q_OBJECT

<span class="token keyword">protected</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">closeEvent</span><span class="token punctuation">(</span>QCloseEvent <span class="token operator">*</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//关闭窗口时停止监听</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">explicit</span> <span class="token function">MainWindow</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">MainWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> slots<span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">onNewConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//QTcpServer的newConnection()信号</span>
    <span class="token keyword">void</span> <span class="token function">onSocketStateChange</span><span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>SocketState socketState<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//底部socket状态变化</span>
    <span class="token keyword">void</span> <span class="token function">onClientConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//客户端接入时</span>
    <span class="token keyword">void</span> <span class="token function">onClientDisconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//客户端断开连接时</span>
    <span class="token keyword">void</span> <span class="token function">onSocketReadyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//读取socket传入的数据</span>

    <span class="token keyword">void</span> <span class="token function">on_actStart_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开始监听</span>
    <span class="token keyword">void</span> <span class="token function">on_actStop_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//停止监听</span>
    <span class="token keyword">void</span> <span class="token function">on_actClear_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清空</span>
    <span class="token keyword">void</span> <span class="token function">on_btnSend_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//发送消息</span>
    <span class="token keyword">void</span> <span class="token function">on_actHostInfo_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取本机地址</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    Ui<span class="token double-colon punctuation">::</span>MainWindow <span class="token operator">*</span>ui<span class="token punctuation">;</span>
    QLabel <span class="token operator">*</span>LabListen<span class="token punctuation">;</span><span class="token comment">//状态栏标签</span>
    QLabel <span class="token operator">*</span>LabSocketState<span class="token punctuation">;</span><span class="token comment">//状态栏标签</span>
    QTcpServer <span class="token operator">*</span>tcpServer<span class="token punctuation">;</span> <span class="token comment">//TCP服务器</span>
    QTcpSocket <span class="token operator">*</span>tcpSocket<span class="token punctuation">;</span><span class="token comment">//TCP通讯的Socket</span>
    QString <span class="token function">getLocalIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取本机IP地址</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// MAINWINDOW_H</span></span>

</code></pre> 
<ul><li>mainwindow.cpp</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">execution_character_set</span><span class="token punctuation">(</span></span><span class="token string">"utf-8"</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"mainwindow.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_mainwindow.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtNetwork&gt;</span></span>

<span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">MainWindow</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span>
    <span class="token function">QMainWindow</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>MainWindow<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    LabListen<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">QLabel</span><span class="token punctuation">(</span><span class="token string">"监听状态:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    LabListen<span class="token operator">-&gt;</span><span class="token function">setMinimumWidth</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>statusBar<span class="token operator">-&gt;</span><span class="token function">addWidget</span><span class="token punctuation">(</span>LabListen<span class="token punctuation">)</span><span class="token punctuation">;</span>

    LabSocketState<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">QLabel</span><span class="token punctuation">(</span><span class="token string">"Socket状态："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    LabSocketState<span class="token operator">-&gt;</span><span class="token function">setMinimumWidth</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>statusBar<span class="token operator">-&gt;</span><span class="token function">addWidget</span><span class="token punctuation">(</span>LabSocketState<span class="token punctuation">)</span><span class="token punctuation">;</span>

    QString localIP<span class="token operator">=</span><span class="token function">getLocalIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//本机IP</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">windowTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"----本机IP："</span><span class="token operator">+</span>localIP<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>comboIP<span class="token operator">-&gt;</span><span class="token function">addItem</span><span class="token punctuation">(</span>localIP<span class="token punctuation">)</span><span class="token punctuation">;</span>

    tcpServer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">QTcpServer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">connect</span><span class="token punctuation">(</span>tcpServer<span class="token punctuation">,</span><span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">newConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onNewConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">MainWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">getLocalIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString hostName<span class="token operator">=</span><span class="token class-name">QHostInfo</span><span class="token double-colon punctuation">::</span><span class="token function">localHostName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//本地主机名</span>
    QHostInfo hostInfo<span class="token operator">=</span><span class="token class-name">QHostInfo</span><span class="token double-colon punctuation">::</span><span class="token function">fromName</span><span class="token punctuation">(</span>hostName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString localIP<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span>

    QList<span class="token operator">&lt;</span>QHostAddress<span class="token operator">&gt;</span> addList<span class="token operator">=</span>hostInfo<span class="token punctuation">.</span><span class="token function">addresses</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>addList<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>addList<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        QHostAddress aHost<span class="token operator">=</span>addList<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>IPv4Protocol<span class="token operator">==</span>aHost<span class="token punctuation">.</span><span class="token function">protocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            localIP<span class="token operator">=</span>aHost<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> localIP<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">closeEvent</span><span class="token punctuation">(</span>QCloseEvent <span class="token operator">*</span>event<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tcpServer<span class="token operator">-&gt;</span><span class="token function">isListening</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        tcpServer<span class="token operator">-&gt;</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//停止网络监听</span>
    event<span class="token operator">-&gt;</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">onNewConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    tcpSocket <span class="token operator">=</span> tcpServer<span class="token operator">-&gt;</span><span class="token function">nextPendingConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建socket</span>

    <span class="token function">connect</span><span class="token punctuation">(</span>tcpSocket<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">connected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onClientConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onClientConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">connect</span><span class="token punctuation">(</span>tcpSocket<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">disconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onClientDisconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">connect</span><span class="token punctuation">(</span>tcpSocket<span class="token punctuation">,</span><span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">stateChanged</span><span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>SocketState<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onSocketStateChange</span><span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>SocketState<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onSocketStateChange</span><span class="token punctuation">(</span>tcpSocket<span class="token operator">-&gt;</span><span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">connect</span><span class="token punctuation">(</span>tcpSocket<span class="token punctuation">,</span><span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">readyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onSocketReadyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">onSocketStateChange</span><span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>SocketState socketState<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"走到这了"</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>socketState<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>UnconnectedState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：UnconnectedState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>HostLookupState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：HostLookupState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>ConnectingState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：ConnectingState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>ConnectedState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：ConnectedState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>BoundState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：BoundState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>ClosingState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：ClosingState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> QAbstractSocket<span class="token double-colon punctuation">::</span>ListeningState<span class="token operator">:</span>
        LabSocketState<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"scoket状态：ListeningState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">onClientConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"**client socket connected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"**peer address:"</span><span class="token operator">+</span>tcpSocket<span class="token operator">-&gt;</span><span class="token function">peerAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"**peer port:"</span><span class="token operator">+</span><span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>tcpSocket<span class="token operator">-&gt;</span><span class="token function">peerPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">onClientDisconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"**client socket disconnected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tcpSocket<span class="token operator">-&gt;</span><span class="token function">deleteLater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//    deleteLater();//QObject::deleteLater();</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">onSocketReadyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>tcpSocket<span class="token operator">-&gt;</span><span class="token function">canReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"[in] "</span><span class="token operator">+</span>tcpSocket<span class="token operator">-&gt;</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_actStart_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString IP<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>comboIP<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//IP地址</span>
    quint16 port<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>spinPort<span class="token operator">-&gt;</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//端口</span>
    QHostAddress <span class="token function">addr</span><span class="token punctuation">(</span>IP<span class="token punctuation">)</span><span class="token punctuation">;</span>
    tcpServer<span class="token operator">-&gt;</span><span class="token function">listen</span><span class="token punctuation">(</span>addr<span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"**开始监听..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"**服务器地址："</span><span class="token operator">+</span>tcpServer<span class="token operator">-&gt;</span><span class="token function">serverAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"**服务器端口："</span><span class="token operator">+</span><span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>tcpServer<span class="token operator">-&gt;</span><span class="token function">serverPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    ui<span class="token operator">-&gt;</span>actStart<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>actStop<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    LabListen<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"监听状态：正在监听"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_actStop_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tcpServer<span class="token operator">-&gt;</span><span class="token function">isListening</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//tcpServer正在监听</span>
    <span class="token punctuation">{<!-- --></span>
        tcpServer<span class="token operator">-&gt;</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//停止监听</span>
        ui<span class="token operator">-&gt;</span>actStart<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>actStop<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        LabListen<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"监听状态：已停止监听"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_actClear_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_btnSend_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString msg<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>editMsg<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"[out] "</span><span class="token operator">+</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>editMsg<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>editMsg<span class="token operator">-&gt;</span><span class="token function">setFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    QByteArray str<span class="token operator">=</span>msg<span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一个换行符</span>
    tcpSocket<span class="token operator">-&gt;</span><span class="token function">write</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_actHostInfo_triggered</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString hostName<span class="token operator">=</span><span class="token class-name">QHostInfo</span><span class="token double-colon punctuation">::</span><span class="token function">localHostName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//本地主机名</span>
    ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"本机主机名："</span><span class="token operator">+</span>hostName<span class="token operator">+</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QHostInfo hostInfo<span class="token operator">=</span><span class="token class-name">QHostInfo</span><span class="token double-colon punctuation">::</span><span class="token function">fromName</span><span class="token punctuation">(</span>hostName<span class="token punctuation">)</span><span class="token punctuation">;</span>

    QList<span class="token operator">&lt;</span>QHostAddress<span class="token operator">&gt;</span> addList<span class="token operator">=</span>hostInfo<span class="token punctuation">.</span><span class="token function">addresses</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>addList<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>addList<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        QHostAddress aHost<span class="token operator">=</span>addList<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>QAbstractSocket<span class="token double-colon punctuation">::</span>IPv4Protocol<span class="token operator">==</span>aHost<span class="token punctuation">.</span><span class="token function">protocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            QString IP<span class="token operator">=</span>aHost<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ui<span class="token operator">-&gt;</span>plainTextEdit<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"本机IP地址："</span><span class="token operator">+</span>aHost<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>comboIP<span class="token operator">-&gt;</span><span class="token function">findText</span><span class="token punctuation">(</span>IP<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
                ui<span class="token operator">-&gt;</span>comboIP<span class="token operator">-&gt;</span><span class="token function">addItem</span><span class="token punctuation">(</span>IP<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<ul><li>ui界面<br> <img src="https://images2.imgbox.com/ec/d4/uMSeIRQt_o.png" alt="在这里插入图片描述"></li></ul> 
<h3><a id="_643"></a>三、代码分享</h3> 
<p>后续会写基于QT实现的UDP通信工具，下面给出代码。</p> 
<ul><li>百度网盘<br> <a href="https://pan.baidu.com/s/1FWrrIgOPP5PxcpBZ7P0D5w" rel="nofollow">TCPClient提取码1234</a><br> <a href="https://pan.baidu.com/s/1GL9DAbkScOylhfmip7wUCQ" rel="nofollow">TCPServer提取码1234</a></li><li>CSDN资源<br> <a href="https://download.csdn.net/download/weixin_43672168/87609585">TCPServer</a><br> <a href="https://download.csdn.net/download/weixin_43672168/87609586">TCPClient</a></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/712f995903b631e54790903c29204c1f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">try-catch 处理异常 以及一些基础的使用方法（重点）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9190ab38903a792f23fdaa9a3963ceb2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Mybatis数据库一对多查询</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>