<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CRNN文本识别模型 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CRNN文本识别模型" />
<meta property="og:description" content="CRNN文本识别模型 描述模型结构CNNRNNCTC 描述 CRNN是一种简单高效的文本识别模型。相比与Attention类型的文本识别模型，其具有如下优缺点。
优点：
容易训练，模型容易收敛，且鲁棒性较高。易于部署，模型结构简单，inference速度快且支持变长输入，适合文本长度变化较大的生产环境。 缺点：
识别准确率相对较低，在包含大量中文字符集情况下，会比RARE类型的Attention模型低不少，英文字符集的情况下会低更多。对于艺术字等有较大形变的短文本，或自然场景下的变化较大的文本，CRNN识别准确率较低。 模型结构 CRNN模型是由图片特征提取层（CNN）、序列化建模层（BiLSTM）以及解码层（CTC）组成。模型结构如图所示：
CNN 图片在输入网络前会进行长度的补充与缩放用于组成固定形状的batch送入模型训练。一般选择的固定长度是由数据集决定的，包含95%左右数据的长度是比较合适的。选择过大的长度可能容易出现CTC loss 不稳定甚至无法训练的情况。所有图片的高度都是固定的，一般选择32。宽度大于batch宽度的可以直接resize，小于batch宽度的需要补0或1。
CNN结构用于提取图片特征。一般情况下选择resnet18就够用了，在特别复杂的情况下也可以选择更复杂的模型，如resnet50等。但是由于模型更加复杂，batchsize需要适当减少，模型收敛时间也会相对变长。
为了将图片特征提取变成高度为1的特征序列，resnet18需要做一些调整，使其高度方向的stride为32，宽度方向的stride为4。实验证明，在CNN模型最有使用kernel size为（2，2）的maxpooling有助于提升模型的鲁棒性。
RNN RNN通常使用BiLSTM。尝试过BiGRU以及transformer，效果没有BiLSTM好。LSTM是一种时序模型，其结构如下。
LSTM包含三个门，第一个为遗忘门，其决定了cell state的保存比例。第二个门是输入门，该门将当前输入及上次输出组合后添加至cell state。最后一个门为输出门，将cell state与ht-1以及xt 结合后输出，作为ht。
CTC CTC用于对齐输出的文本，它分为前向与反向两个阶段。前向时只需要按照CTC解码的方式解码就行，反向时需要求CTC Loss。CTC Loss为给定输入x的情况下所有可能结果为l的路径的概率的和。
其中pi代表经过 B变化后等于l的路径" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/58c080915ceffa6eba74b7622ad9feeb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-28T22:15:51+08:00" />
<meta property="article:modified_time" content="2021-06-28T22:15:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CRNN文本识别模型</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>CRNN文本识别模型</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">描述</a></li><li><a href="#_10" rel="nofollow">模型结构</a></li><li><a href="#CNN_13" rel="nofollow">CNN</a></li><li><a href="#RNN_19" rel="nofollow">RNN</a></li><li><a href="#CTC_23" rel="nofollow">CTC</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>描述</h3> 
<p>CRNN是一种简单高效的文本识别模型。相比与Attention类型的文本识别模型，其具有如下优缺点。<br> 优点：</p> 
<ol><li>容易训练，模型容易收敛，且鲁棒性较高。</li><li>易于部署，模型结构简单，inference速度快且支持变长输入，适合文本长度变化较大的生产环境。</li></ol> 
<p>缺点：</p> 
<ol><li>识别准确率相对较低，在包含大量中文字符集情况下，会比RARE类型的Attention模型低不少，英文字符集的情况下会低更多。</li><li>对于艺术字等有较大形变的短文本，或自然场景下的变化较大的文本，CRNN识别准确率较低。</li></ol> 
<h3><a id="_10"></a>模型结构</h3> 
<p>CRNN模型是由图片特征提取层（CNN）、序列化建模层（BiLSTM）以及解码层（CTC）组成。模型结构如图所示：<br> <img src="https://images2.imgbox.com/fe/1d/fgPMBoB6_o.png" alt="Alt"></p> 
<h3><a id="CNN_13"></a>CNN</h3> 
<p>图片在输入网络前会进行长度的补充与缩放用于组成固定形状的batch送入模型训练。一般选择的固定长度是由数据集决定的，包含95%左右数据的长度是比较合适的。选择过大的长度可能容易出现CTC loss 不稳定甚至无法训练的情况。所有图片的高度都是固定的，一般选择32。宽度大于batch宽度的可以直接resize，小于batch宽度的需要补0或1。</p> 
<p>CNN结构用于提取图片特征。一般情况下选择resnet18就够用了，在特别复杂的情况下也可以选择更复杂的模型，如resnet50等。但是由于模型更加复杂，batchsize需要适当减少，模型收敛时间也会相对变长。</p> 
<p>为了将图片特征提取变成高度为1的特征序列，resnet18需要做一些调整，使其高度方向的stride为32，宽度方向的stride为4。实验证明，在CNN模型最有使用kernel size为（2，2）的maxpooling有助于提升模型的鲁棒性。</p> 
<h3><a id="RNN_19"></a>RNN</h3> 
<p>RNN通常使用BiLSTM。尝试过BiGRU以及transformer，效果没有BiLSTM好。LSTM是一种时序模型，其结构如下。<br> <img src="https://images2.imgbox.com/d3/14/fMnCe9xz_o.png" alt="Alt"><br> LSTM包含三个门，第一个为遗忘门，其决定了cell state的保存比例。第二个门是输入门，该门将当前输入及上次输出组合后添加至cell state。最后一个门为输出门，将cell state与h<sub>t-1</sub>以及x<sub>t</sub> 结合后输出，作为h<sub>t</sub>。</p> 
<h3><a id="CTC_23"></a>CTC</h3> 
<p>CTC用于对齐输出的文本，它分为前向与反向两个阶段。前向时只需要按照CTC解码的方式解码就行，反向时需要求CTC Loss。CTC Loss为给定输入x的情况下所有可能结果为l的路径的概率的和。<br> <img src="https://images2.imgbox.com/97/1e/f4jDjna4_o.png" alt="Alt"><br> 其中pi代表经过 B变化后等于l的路径<br> <img src="https://images2.imgbox.com/ad/92/r1h1WQZh_o.png" alt="Alt"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/187a95fc6f3a8d8314c7407393abf41a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">对于大学里计算机方向的专业哪些比较好？近年出现的大数据和云计算专业有何看法？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/870a51ba2a9edfadc62ce99af52cabd1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">函数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>