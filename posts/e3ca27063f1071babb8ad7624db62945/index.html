<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android 系统时间设置 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android 系统时间设置" />
<meta property="og:description" content="一、自动确定时间
/** * Get if the user prefers the date, time and timezone to be automatically fetched from the network * @param context Context * @return ture=yes, false=no */ public static boolean getTimeSettingAuto(Context context) { //Settings.System.AUTO_TIME was deprecated in API level 17. //Use Settings.Global.AUTO_TIME instead. int state = Settings.System.getInt(context.getContentResolver(), Settings.System.AUTO_TIME, 1); return (state == 1) ? true : false; } public static void setTimeSettingAuto(Context context, boolean isAuto) { Settings.System.putInt(context.getContentResolver(), Settings." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e3ca27063f1071babb8ad7624db62945/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-11-06T15:33:16+08:00" />
<meta property="article:modified_time" content="2013-11-06T15:33:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android 系统时间设置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong><span style="font-size:18px">一、自动确定时间</span></strong></p> 
<p></p> 
<pre><code class="language-java">    /**
     * Get if the user prefers the date, time and timezone to be automatically fetched from the network 
     * @param context Context
     * @return ture=yes, false=no
     */
    public static boolean getTimeSettingAuto(Context context) {
        //Settings.System.AUTO_TIME was deprecated in API level 17.
        //Use Settings.Global.AUTO_TIME instead.
        int state = Settings.System.getInt(context.getContentResolver(), Settings.System.AUTO_TIME, 1);
        return (state == 1) ? true : false;
    }
    
    public static void setTimeSettingAuto(Context context, boolean isAuto) {
        Settings.System.putInt(context.getContentResolver(), Settings.System.AUTO_TIME, (isAuto ? 1 : 0));
    }</code></pre> 
<p><br> </p> 
<span style="font-size:18px"><strong>二、自动确定时区</strong></span> 
<span style="font-size:12px">（API11开始生效）</span> 
<p></p> 
<pre><code class="language-java">    /**
     * Get if the user prefers the timezone to be automatically fetched from the network 
     * @param context Context
     * @return ture=yes, false=no
     */
    public static boolean getTimezoneSettingAuto(Context context) {
        //Settings.System.AUTO_TIME_ZONE was useful from API 11.
        //Settings.System.AUTO_TIME_ZONE was deprecated in API level 17.
        //Use Settings.Global.AUTO_TIME_ZONE instead.
        int state = Settings.System.getInt(context.getContentResolver(), Settings.System.AUTO_TIME_ZONE, 1);
        return (state == 1) ? true : false;
    }
    
    public static void setTimezoneSettingAuto(Context context, boolean isAuto) {
        Settings.System.putInt(context.getContentResolver(), Settings.System.AUTO_TIME_ZONE, (isAuto ? 1 : 0));
    }</code></pre> 
<br> 
<strong><span style="font-size:18px">三、时间格式24/12</span></strong> 
<br> 
<p></p> 
<pre><code class="language-java">    /**
     * Get Display times style(12 or 24 hours)
     * @param context Context
     * @return ture=24, false=12
     */
    public static boolean is24HourFormat(Context context) {
        //Can use this to instand
        //return DateFormat.is24HourFormat(context);
        int state = Settings.System.getInt(context.getContentResolver(), Settings.System.TIME_12_24, 24);
        return (state == 24) ? true : false;
    }
    
    public static void set24HourFormat(Context context, boolean is24Style) {
        Settings.System.putInt(context.getContentResolver(), Settings.System.TIME_12_24, (is24Style ? 24 : 12));
        //Do not forget to inform system.
        Intent intent = new Intent(Intent.ACTION_TIME_CHANGED);
        context.sendBroadcast(intent);
    }</code></pre> 
<br> 
<strong><span style="font-size:18px">四、时区</span></strong> 
<p></p> 
<pre><code class="language-java">    public static String getTimezoneId() {
        final TimeZone timeZone = TimeZone.getDefault();
        String id = timeZone.getID();
        return id;
    }
    
    public static void setTimezone(Context context, String zoneId) {
        final AlarmManager alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
        alarmManager.setTimeZone(zoneId);
        //DO not need send Intent.ACTION_TIMEZONE_CHANGED
        //Because system will send itself, and we do not have permission
    }</code></pre> 设置时区时需要添加权限 
<p></p> 
<p></p> 
<pre><code class="language-html">&lt;uses-permission android:name="android.permission.SET_TIME_ZONE" /&gt;</code></pre> 
<p>获取以及设置时区用到的都是TimezoneID，它们以字符串的形式存在。</p> 
<p>可以用诸如<code>"GMT+05:00"</code>, <code>"GMT+0500"</code>, <code>"GMT+5:00"</code>,<code>"GMT+500"</code>,<code>"GMT+05"</code>, and<code>"GMT+5",<span style="font-family:monospace">"GMT-05:00"</span>的ID</code></p> 
<p>Android系统用的ID一般为</p> 
<p></p> 
<pre><code class="language-html">&lt;timezone id="Asia/Shanghai"&gt;中国标准时间 (北京)&lt;/timezone&gt;
&lt;timezone id="Asia/Hong_Kong"&gt;香港时间 (香港)&lt;/timezone&gt;
&lt;timezone id="Asia/Taipei"&gt;台北时间 (台北)&lt;/timezone&gt;
&lt;timezone id="Asia/Seoul"&gt;首尔&lt;/timezone&gt;
&lt;timezone id="Asia/Tokyo"&gt;日本时间 (东京)&lt;/timezone&gt;</code></pre> 
<p><br> </p> 
<p><span style="font-size:18px"><strong>五、系统时间</strong></span></p> 
<p></p> 
<pre><code class="language-java">        Calendar calendar = Calendar.getInstance();
        mTimePicker.setIs24HourView(DateFormat.is24HourFormat(this));
        mTimePicker.setCurrentHour(calendar.get(Calendar.HOUR_OF_DAY));
        mTimePicker.setCurrentMinute(calendar.get(Calendar.MINUTE));</code></pre> 
<pre><code class="language-java">    public static void setTime(int hour, int minute) {
        Calendar calendar = Calendar.getInstance();
        
        //Calendar.HOUR_OF_DAY use 24 hour format
        //Calendar.HOUR_OF use 12 hour format, and we have to use calendar.set(Calendar.AM_PM, Calendar.PM);
        calendar.set(Calendar.HOUR_OF_DAY, hour);
        calendar.set(Calendar.MINUTE, minute);
        calendar.set(Calendar.SECOND, 0);
        
        long millis = calendar.getTimeInMillis();
        if ((millis / 1000) &lt; Integer.MAX_VALUE) {
            SystemClock.setCurrentTimeMillis(millis);
        }
    }</code></pre> 但是SystemClock.setCurrentTimeMillis(millis);需要系统权限，解决办法请参见  
<a target="_blank" href="http://terryblog.blog.51cto.com/1764499/389843" rel="nofollow noopener noreferrer">增加修改系统时间权限</a> 
<p></p> 
<p>或者调出系统时间设置界面 startActivityForResult(new Intent(android.provider.Settings.ACTION_DATE_SETTINGS), 1);<br> <br> <strong><span style="font-size:18px">六、日期格式</span></strong></p> 
<p></p> 
<pre><code class="language-java">    public static String getDateFormat(Context context) {
        String fromat = Settings.System.getString(context.getContentResolver(), Settings.System.DATE_FORMAT);
        return fromat;
    }
    
    public static void setDateFormat(Context context, String dateFormat) {
        Settings.System.putString(context.getContentResolver(), Settings.System.DATE_FORMAT, dateFormat);
    }</code></pre> 日期格式一般的形式为：yyyy/MM/dd、yyyy MMM d、yyyy-MM-dd、yyyyMMdd 
<p><br> </p> 
<p><strong><span style="font-size:18px">七、系统日期</span></strong></p> 
<p></p> 
<pre><code class="language-java">        Calendar calendar = Calendar.getInstance();
        mDatePicker.updateDate(calendar.get(Calendar.YEAR), calendar.get(Calendar.MONTH), calendar.get(Calendar.DATE));</code></pre> 
<pre><code class="language-java">    public static void setDate(int year, int month, int day) {
        Calendar calendar = Calendar.getInstance();
        calendar.set(Calendar.YEAR, year);
        calendar.set(Calendar.MONTH, month);
        calendar.set(Calendar.DATE, day);
        
        long millis = calendar.getTimeInMillis();
        if ((millis / 1000) &lt; Integer.MAX_VALUE) {
            SystemClock.setCurrentTimeMillis(millis);
        }
    }</code></pre> 同样的，SystemClock.setCurrentTimeMillis(millis);需要系统权限，解决办法请参见  
<a target="_blank" href="http://terryblog.blog.51cto.com/1764499/389843" rel="nofollow noopener noreferrer">增加修改系统时间权限</a> 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b889a9cb49b2c6f23f71be16b631c261/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">让WTL支持CString和CRect,CPoint等类</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/aa678913e7825d3899bbf5813f3fca32/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">linux 挂载错误解决mount: cannot mount block device</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>