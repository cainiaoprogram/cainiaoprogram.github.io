<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>shell 变量 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="shell 变量" />
<meta property="og:description" content="文章目录 1. 自定义变量2.环境变量：3. 多个脚本之间共享变量4. 位置变量5. 预定义变量6. 强引用和弱引用、反引号和括号7. 变量的运算7. 小数运算8. 变量内容 删除9. 索引及切片10.内容替换11.变量替代12. 条件测试13. 是字符串比较14.总结 1. 自定义变量 定义变量： 变量名=变量值 eg：ip=192.168.1.14 引用变量：$变量名 或 ${变量名} eg：$ip ${ip} 查看变量：echo $变量名 eg: echo ${ip} 取消变量： unset 变量名 eg: unset ip 作用范围： 仅在当前shell中有效 2.环境变量： 定义环境变量：法一： export ip=192.168.1.14 法二：ip=192.168.1.14 export ip 查看当前环境变量： env | grep ip # 读取变量 ip read ip # 提示读取 read -p &#34;please input ip &#34; ip # 倒计时 read -t 5 -p &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/fbf4f11306f35ad94ea2adc377728aaa/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-21T19:05:49+08:00" />
<meta property="article:modified_time" content="2023-12-21T19:05:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">shell 变量</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><ul><li><a href="#1___1" rel="nofollow">1. 自定义变量</a></li><li><a href="#2_12" rel="nofollow">2.环境变量：</a></li><li><a href="#3___28" rel="nofollow">3. 多个脚本之间共享变量</a></li><li><a href="#4__38" rel="nofollow">4. 位置变量</a></li><li><a href="#5__41" rel="nofollow">5. 预定义变量</a></li><li><a href="#6__75" rel="nofollow">6. 强引用和弱引用、反引号和括号</a></li><li><a href="#7__91" rel="nofollow">7. 变量的运算</a></li><li><a href="#7__134" rel="nofollow">7. 小数运算</a></li><li><a href="#8___140" rel="nofollow">8. 变量内容 删除</a></li><li><a href="#9__150" rel="nofollow">9. 索引及切片</a></li><li><a href="#10_155" rel="nofollow">10.内容替换</a></li><li><a href="#11_158" rel="nofollow">11.变量替代</a></li><li><a href="#12__176" rel="nofollow">12. 条件测试</a></li><li><a href="#13__205" rel="nofollow">13. 是字符串比较</a></li><li><a href="#14_219" rel="nofollow">14.总结</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h4><a id="1___1"></a>1. 自定义变量</h4> 
<pre><code>定义变量： 变量名=变量值
eg：ip=192.168.1.14
引用变量：$变量名 或 ${变量名}
eg：$ip ${ip}
查看变量：echo $变量名
eg: echo ${ip}
取消变量： unset 变量名
eg: unset ip
作用范围： 仅在当前shell中有效
</code></pre> 
<h4><a id="2_12"></a>2.环境变量：</h4> 
<pre><code>定义环境变量：法一： export ip=192.168.1.14
				法二：ip=192.168.1.14
					export ip
 查看当前环境变量： env | grep ip
</code></pre> 
<pre><code class="prism language-bash"><span class="token comment"># 读取变量 ip</span>
<span class="token builtin class-name">read</span> <span class="token function">ip</span>
<span class="token comment"># 提示读取</span>
<span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">"please input ip "</span> <span class="token function">ip</span>
<span class="token comment"># 倒计时</span>
<span class="token builtin class-name">read</span> <span class="token parameter variable">-t</span> <span class="token number">5</span> <span class="token parameter variable">-p</span> <span class="token string">"please input ip: "</span> <span class="token function">ip</span>
<span class="token comment">#  限制宽度</span>
<span class="token builtin class-name">read</span> <span class="token parameter variable">-n</span> <span class="token number">2</span> <span class="token function">ip</span>

</code></pre> 
<h4><a id="3___28"></a>3. 多个脚本之间共享变量</h4> 
<pre><code>eg: sc1.sh
</code></pre> 
<pre><code class="prism language-bash"><span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token number">192.168</span>.1.14
</code></pre> 
<pre><code>sc2.sh 脚本 要使用 sc1.sh 中变量
</code></pre> 
<pre><code class="prism language-bash"><span class="token builtin class-name">.</span> sc1.sh  <span class="token comment"># 点 执行或 source 执行</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${ip}</span>
</code></pre> 
<h4><a id="4__38"></a>4. 位置变量</h4> 
<pre><code>$1 $2 $3 $4 $5 $6 $7 $8 $9 $(10]
</code></pre> 
<h4><a id="5__41"></a>5. 预定义变量</h4> 
<pre><code>$0	    脚本名
$*		所有的参数
$@	    所有的参数
$#        参数的个数
$$       当前进程的PID
$!			上一个后台进程的PID
$?		上一个命令的返回值

basename  文件名 不包含 路径
dirname   文件路径
</code></pre> 
<pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># 参数个数为零</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$#</span> <span class="token parameter variable">-ef</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	<span class="token builtin class-name">echo</span> <span class="token string">"usage: <span class="token variable"><span class="token variable">`</span><span class="token function">basename</span> $0<span class="token variable">`</span></span> file"</span>
	<span class="token builtin class-name">exit</span> 
<span class="token keyword">if</span>
<span class="token comment"># 第一个参数不是文件</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-f</span> <span class="token variable">$1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	<span class="token builtin class-name">echo</span> <span class="token string">"error file"</span>
	<span class="token builtin class-name">exit</span>
<span class="token keyword">if</span>
<span class="token comment"># ping 所有的 ip</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">ip</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> $1<span class="token variable">`</span></span>
<span class="token keyword">do</span>
	<span class="token function">ping</span> <span class="token parameter variable">-c1</span> <span class="token variable">$ip</span> <span class="token operator">&amp;&gt;</span>/dev/null
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token parameter variable">-ef</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
		<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$ip</span> is up."</span>
	<span class="token keyword">else</span>
		<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$ip</span> is down"</span>
	<span class="token keyword">if</span>
<span class="token keyword">done</span>
</code></pre> 
<h4><a id="6__75"></a>6. 强引用和弱引用、反引号和括号</h4> 
<pre><code>“ ” 弱引用
' ' 强引用
</code></pre> 
<pre><code class="prism language-bash"><span class="token assign-left variable">school</span><span class="token operator">=</span>1000p
<span class="token comment"># 打印结果 1000p is goof</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">${school}</span> is goog"</span>
<span class="token comment"># 原样打印</span>
<span class="token builtin class-name">echo</span> <span class="token string">'${school} is good'</span>
</code></pre> 
<pre><code>`` 等价于$() : 反引号和括号中的命令会被先执行
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">touch</span> <span class="token variable"><span class="token variable">`</span><span class="token function">date</span> +%F<span class="token variable">`</span></span>_file1.txt
<span class="token function">touch</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%F<span class="token variable">)</span></span>_file2.txt
</code></pre> 
<h4><a id="7__91"></a>7. 变量的运算</h4> 
<pre><code>1. 整数运算
	方法一：expr
		expr 1 + 2
		expr $num1 + $num2   
		+ - \* %
 	方法二：$(())  + - * /  %
 		echo $(($num1+$num2))
		echo $((num1+num2))
		echo $((5-3*2))
		echo $((2**3))
		sum=$((1+2));echo $sum
 方法三：$[]  + - * /  %
 		echo $[5+2]
 		echo $[5**2] 	
 方法四：let
 		let sum=2+3;echo $sum
 		let i++;echo $i	
</code></pre> 
<pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token number">10.18</span>.42.1
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">}</span>
<span class="token keyword">do</span>
	<span class="token function">ping</span> <span class="token parameter variable">-c1</span> <span class="token variable">$ip</span> <span class="token operator">&amp;&gt;</span>/dev/null
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
		<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$ip</span> is up..."</span>
	<span class="token keyword">fi</span>
<span class="token keyword">done</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token number">10.18</span>.42.1
<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> <span class="token parameter variable">-le</span> <span class="token number">5</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
	<span class="token function">ping</span> <span class="token parameter variable">-c1</span> <span class="token variable">$ip</span> <span class="token operator">&amp;&gt;</span>/dev/null
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
		<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$ip</span> is up..."</span>
	<span class="token keyword">fi</span>
	<span class="token builtin class-name">let</span> i++
<span class="token keyword">done</span>
</code></pre> 
<h4><a id="7__134"></a>7. 小数运算</h4> 
<pre><code>echo "2*4" | bc
echo "2^4" | bc
echo "scale=2;6/4" | bc
awk 'BEGIN{print 1/2}'
echo "print 5.0/2" | python
</code></pre> 
<h4><a id="8___140"></a>8. 变量内容 删除</h4> 
<pre><code>url=www.baidu.com
echo ${#url}   # 获取变量的长度
echo ${url} # 标准查看
echo ${url#*.}  # 从前往后， 最短匹配
ehco ${url##*.} # 从前往后，最长匹配，贪婪匹配
echo ${url%.*}  # 从后往前，最短匹配
echo ${url%%.*} # 从后往前，最长匹配，贪婪匹配
</code></pre> 
<h4><a id="9__150"></a>9. 索引及切片</h4> 
<pre><code>echo ${url:0:5}  # 索引0 开始向后 5个
echo ${url:5:5}  
echo ${url:5}
</code></pre> 
<h4><a id="10_155"></a>10.内容替换</h4> 
<pre><code>echo ${url/baidu/google} 
echo ${url//n/N}  # 贪婪匹配
</code></pre> 
<h4><a id="11_158"></a>11.变量替代</h4> 
<pre><code>echo ${var1}
echo ${var1-bbbb} # 若没有定义 var1 则默认值为bbbb
${变量名-新的变量值}
	变量没有被赋值：会使用 新的变量值 替代
	变量有被赋值(包括空值)：不会被替代
${变量名:-新的变量值}
	变量没有被赋值：会使用新的变量值替代
	变量有被赋值(包括空值): 不会被替代
var=  # 空值
echo ${var:-aaa} # 空值不会被替代

echo ${var:+aaa}  #仅在变量非空才输出
echo ${var+aaa} #  就算变量为空也会输出

echo ${var3=aaa} # var3 不存在或 为空值 赋值 为aaaa
echo ${var3:=aaa} # var3 不存在 或者为空值
</code></pre> 
<h4><a id="12__176"></a>12. 条件测试</h4> 
<pre><code>格式1：test 条件表达式
格式2： [ 条件表达式 ]
格式3：[[ 条件表达式 ]]
-e :文件或目录是否存在
-d: 是否是一个路径
-f:  是否存在，而且是文件
-r :  当前用户是否有读权限
-x:  是否有执行权限
-w: 是否有写权限
-L: 是否为一个存在的软链接

数值比较：
[ 1 -gt 10 ] 大于
[ 1 -lt 10 ] 小于
[ 1 -eq 10 ] 等于
[ 1 -ne 10] 不等于
[ 1 -ge 10] 大于等于
[1 -le 10] 小于等于

c语言风格的数值比较
	((1&lt;2))
	((1==2))
	((1&gt;2))
	((1&gt;=2))
	((1&lt;=2))
	((1!=2))
	((`id -u`&gt;0))
	(($UID==0))
</code></pre> 
<h4><a id="13__205"></a>13. 是字符串比较</h4> 
<pre><code>使用双引号
[ "$USER" = "root" ]
[ "$USER" == "root" ]
[ -z  $var ] #字符长度为0
[ -n $var ]  # 字符串长度不为0

# 条件测试  
[ 1 -lt 2 -a 5 -gt 10 ];echo $?
[ 1 -lt 2 -o 5 -gt 10 ];echo $?
#  双中括号用法
[[ 1 -lt 2 &amp;&amp; 5 -gt 10 ]];echo $?
[[ 1 -lt -2 || 5 -gt 10 ]];echo $?
[[ "$USER" = ~ r ]];echo $?
</code></pre> 
<h4><a id="14_219"></a>14.总结</h4> 
<pre><code>()  子shell中执行
(()) 数值比较，运算C语言
$()  命令替换
$(())  整数运算

{}
${}

[] 条件测试
[[]] 条件测试，支持正则  =~
$[]  整数运算
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ca37290e38d505f71a74cb4fa6a76df6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">下午好~ 我的论文【yolov5】（第四期）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8ff8d27c7162ed5457f0ea70b5d8ef77/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Sustainable architecture: Past, present, and future</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>