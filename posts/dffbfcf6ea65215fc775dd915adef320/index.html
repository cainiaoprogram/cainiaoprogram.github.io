<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python实现自动化打印 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python实现自动化打印" />
<meta property="og:description" content="这次真的是出于实际需要，想要用python写个小脚本
老板发给我一份包含几百个人信息的pdf文件，如果一份一份打开文件，点打印我感觉要看到眼花。
但是我可是学过python的（虽然面向对象还没有学完），但是调用第三方库是学了呀，如果有别人的代码看看我还是能改改的。 说干就干 查资料，看别人已经写出来的内容 发现调用电脑程序需要用到win32这个库，而且初略的看了下就发现此库非常NB，怎么说，这个库可以同计算机进行交互，比如弹出提示框，或者调用系统内置一些程序。范围太广，而且不是学习目的，以后再讨论。
最终，发现主要用到的两个库是 win32api和win32print（估计这个就是管打印机的）。 安装win32，直接就 pip install pywin32 或者下面这个通过豆瓣镜像安装的
pip install -i http://pypi.douban.com/simple/ pywin32 --trusted-host pypi.douban.com
其他方法类似，pip安装不多说
在查资料，发现基本上都会用到下面这个代码
import win32print import tempfile import win32api def print_file(filename): open(filename,&#34;r&#34;) win32api.ShellExecute( 0, &#34;print&#34;, filename, &#39;/d:&#34;%s&#34;&#39; % win32print.GetDefaultPrinter(), &#34;.&#34;, 0 ) 需要注意，这个代码中filename应该是文件路径，具体到文件
eg,要打印11.pdf文件 C:\Users\mik\Desktop\py_word\11.pdf
下面就容易了，写一个得到全部文件内容的代码，然后调用print_file就行了 path = r&#34;C:\Users\mik\Desktop\打印&#34; for i in os.listdir(path): file_path = os.path.join(path,i) print(&#34;你要打印的文件是%s&#34;%i) print_file(file_path) 哈哈，nb，至此大功告成，后来发现，每一个pdf有十几页，而我要把他们都订起来。。。。 下次我可能就要写一个自动订文件打印机的程序了 后记，打印机选择是默认的打印机，我用的是单面打印的打印机，如果是双面打印，可以修改系统默认打印机的设置，这个网上找就行了；我看有的教程需要安装GSPRINT和Ghostscript，并将其添加到系统环境中，但是我并没有安装也可以（如果有特别要求可能要用到“Ghostscript，GhostView”，比如打印特定的页码，这篇文章有涉及可以参考）；当然也在于在最后查找文件的时候写一些小范围，比如只打印word之类的。 if i.endswith(“docx”)：
print_file(file_path)
2020.10.23" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/dffbfcf6ea65215fc775dd915adef320/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-10-23T20:44:54+08:00" />
<meta property="article:modified_time" content="2020-10-23T20:44:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python实现自动化打印</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>这次真的是出于实际需要，想要用python写个小脚本<br> 老板发给我一份包含几百个人信息的pdf文件，如果一份一份打开文件，点打印我感觉要看到眼花。</p> 
<h3><a id="python_2"></a>但是我可是学过python的（虽然面向对象还没有学完），但是调用第三方库是学了呀，如果有别人的代码看看我还是能改改的。</h3> 
<h4><a id="_3"></a>说干就干</h4> 
<h3><a id="_4"></a>查资料，看别人已经写出来的内容</h3> 
<p>发现调用电脑程序需要用到win32这个库，而且初略的看了下就发现此库非常NB，怎么说，这个库可以同计算机进行交互，比如弹出提示框，或者调用系统内置一些程序。范围太广，而且不是学习目的，以后再讨论。</p> 
<h3><a id="_win32apiwin32print_6"></a>最终，发现主要用到的两个库是 win32api和win32print（估计这个就是管打印机的）。</h3> 
<blockquote> 
 <p>安装win32，直接就 pip install pywin32 或者下面这个通过豆瓣镜像安装的<br> pip install -i http://pypi.douban.com/simple/ pywin32 --trusted-host pypi.douban.com<br> 其他方法类似，pip安装不多说</p> 
</blockquote> 
<p>在查资料，发现基本上都会用到下面这个代码</p> 
<pre><code>import win32print
import tempfile
import win32api
def print_file(filename):
    open(filename,"r")
    win32api.ShellExecute(
        0,
        "print",
        filename,
        '/d:"%s"' % win32print.GetDefaultPrinter(),
        ".",
        0
    )
</code></pre> 
<p>需要注意，这个代码中filename应该是文件路径，具体到文件</p> 
<h4><a id="eg11pdf_29"></a>eg,要打印11.pdf文件</h4> 
<blockquote> 
 <p>C:\Users\mik\Desktop\py_word\11.pdf</p> 
</blockquote> 
<h3><a id="print_file_32"></a>下面就容易了，写一个得到全部文件内容的代码，然后调用print_file就行了</h3> 
<pre><code>path = r"C:\Users\mik\Desktop\打印"
for i in os.listdir(path):
    file_path = os.path.join(path,i)
    print("你要打印的文件是%s"%i)
    print_file(file_path)
</code></pre> 
<h2><a id="nbpdf_41"></a>哈哈，nb，至此大功告成，后来发现，每一个pdf有十几页，而我要把他们都订起来。。。。</h2> 
<h2><a id="_42"></a>下次我可能就要写一个自动订文件打印机的程序了</h2> 
<h3><a id="GSPRINTGhostscriptGhostscriptGhostViewhttpswwwcnblogscomonelangp10631350htmlword_43"></a>后记，打印机选择是默认的打印机，我用的是单面打印的打印机，如果是双面打印，可以修改系统默认打印机的设置，这个网上找就行了；我看有的教程需要安装GSPRINT和Ghostscript，并将其添加到系统环境中，但是我并没有安装也可以（如果有特别要求可能要用到“Ghostscript，GhostView”，比如打印特定的页码，<a href="https://www.cnblogs.com/onelang/p/10631350.html" rel="nofollow">这篇文章</a>有涉及可以参考）；当然也在于在最后查找文件的时候写一些小范围，比如只打印word之类的。</h3> 
<blockquote> 
 <p>if i.endswith(“docx”)：<br> print_file(file_path)</p> 
</blockquote> 
<p>2020.10.23</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e459d36ac3835fae6df63322694423b6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux 教程: （Linux基础&#43;命令大全）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a5b571047da0915320537895411e75ab/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">三、Linux 教程-基础命令(181~完)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>