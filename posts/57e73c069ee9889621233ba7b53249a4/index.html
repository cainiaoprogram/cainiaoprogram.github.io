<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用Kinect相机获取像素点对应世界坐标系下三维坐标的公式 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用Kinect相机获取像素点对应世界坐标系下三维坐标的公式" />
<meta property="og:description" content=" Kinect相关topic （1）RGB图像：/camera/rgb/image_color
ROS数据格式：sensor_msgs/Image
OPENCV数据格式：Mat
图像尺寸：640*480
像素数据类型：8UC3
（2）深度图像：/camera/depth/image
ROS数据格式：sensor_msgs/Image
OPENCV数据格式：Mat
图像尺寸：640*480
像素数据类型：32FC1 或 16UC1
（3）点云数据（无整合RGB）: /camera/depth/points
ROS数据格式：sensor_msgs/Image
PCL点云库数据格式：pcl::PointCloud&lt;pcl::PointXYZ&gt;
图像尺寸：有序点云，640*480
像素数据类型：double
RGB以及深度图像的像素数据类型非常关键，一旦出错便不能得到正确的坐标
像素坐标系到世界坐标系的转化 [u,v,d]----&gt;[x,y,z] // 相机内参 const double camera_factor=1000; const double camera_cx=325.5; const double camera_cy=253.5; const double camera_fx=518.0; const double camera_fy=519.0; //深度图中(m,n)处的值 ushort d = depth.ptr&lt;ushort&gt;(m)[n]; //点P的世界坐标 p.z = double(d)/camera_factor; p.x = (n-camera_cx)*p.z/camera_fx; p.y = (m-camera_cy)*p.z/camera_fy; camera_factor是深度图里给的数据与实际距离的比例。
由于深度图给的都是short (mm单位)，camera_factor通常为1000。
[x,y,z]----&gt;[u,v,d] u = (x*fx)/z &#43; cx ; v = (y*fy)/z &#43; cy ; d = z*camera_factor " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/57e73c069ee9889621233ba7b53249a4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-08-02T01:47:03+08:00" />
<meta property="article:modified_time" content="2019-08-02T01:47:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用Kinect相机获取像素点对应世界坐标系下三维坐标的公式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>Kinect相关topic</h4> 
<p>（1）RGB图像：/camera/rgb/image_color</p> 
<p>    ROS数据格式：sensor_msgs/Image<br>     OPENCV数据格式：Mat<br>     图像尺寸：640*480<br>     像素数据类型：8UC3</p> 
<p><br> （2）深度图像：/camera/depth/image</p> 
<p>    ROS数据格式：sensor_msgs/Image<br>     OPENCV数据格式：Mat<br>     图像尺寸：640*480<br>     像素数据类型：32FC1 或 16UC1</p> 
<p><br> （3）点云数据（无整合RGB）: /camera/depth/points</p> 
<p>    ROS数据格式：sensor_msgs/Image<br>     PCL点云库数据格式：pcl::PointCloud&lt;pcl::PointXYZ&gt;<br>     图像尺寸：有序点云，640*480<br>     像素数据类型：double</p> 
<p><span style="color:#f33b45;">RGB以及深度图像的像素数据类型非常关键，一旦出错便不能得到正确的坐标</span></p> 
<p> </p> 
<h4>像素坐标系到世界坐标系的转化</h4> 
<h4>[u,v,d]----&gt;[x,y,z]</h4> 
<pre class="has"><code>// 相机内参
const double camera_factor=1000;
const double camera_cx=325.5;
const double camera_cy=253.5;
const double camera_fx=518.0;
const double camera_fy=519.0;</code></pre> 
<pre class="has"><code>//深度图中(m,n)处的值
ushort d = depth.ptr&lt;ushort&gt;(m)[n];

//点P的世界坐标
p.z = double(d)/camera_factor;
p.x = (n-camera_cx)*p.z/camera_fx;
p.y = (m-camera_cy)*p.z/camera_fy;</code></pre> 
<p>camera_factor是深度图里给的数据与实际距离的比例。</p> 
<p>由于深度图给的都是short (mm单位)，camera_factor通常为1000。</p> 
<p> </p> 
<h4>[x,y,z]----&gt;[u,v,d]</h4> 
<pre class="has"><code>u = (x*fx)/z + cx ;
v = (y*fy)/z + cy ;
d = z*camera_factor</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7b3465dcc0898d39fc3318e0fc635ac1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Jquery操作复选框(CheckBox)的取值赋值实现代码</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9a36dae2ea5ec652b6378e0c9784a352/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">获取port端口时，javax.management.ObjectName；ObjectName报异常</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>