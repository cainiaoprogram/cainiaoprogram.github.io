<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AlphaFold2算法详解 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="AlphaFold2算法详解" />
<meta property="og:description" content="正文：https://www.nature.com/articles/s41586-021-03819-2
补充文件：https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-03819-2/MediaObjects/41586_2021_3819_MOESM1_ESM.pdfhttps://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-03819-2/MediaObjects/41586_2021_3819_MOESM1_ESM.pdf学习视频（强烈推荐）：
【公开课】基于AI预测蛋白质折叠的三维空间结构——AlphaFold2原理及安装使用_哔哩哔哩_bilibili
1. 搜索同源序列和模板： 去按序列数据库以及PDB数据库中去搜索同源序列和模板
给定序列A，到Uniref90、MGnify、Uniclust30、BFD数据库中搜索他的同源序列，从Unire90中得到MSA。然后到PDB70中搜索同源模板得到对应的mmCif文件
1）当相似度高于50%，常推测检测序列和目标序列有可能是同源序列。
2）MSA
MSA是Multiple Sequence Alignment的缩写，即多序列对齐，这个技术用于从一个大的数据库中抽取和输入氨基酸序列相近的序列，并且顺便进行对齐。抽取这个特征的原因是类似的氨基酸序列一般来说折叠方式也类似，相当于在特征中就加入了相近的序列结构信息。
这里我们举个例子，HHblit工具也可以用来做MSA，在网站中输入用于举例的59个氨基酸组成的序列，HHblit工具就会在数据库中开始搜索序列与之相近的氨基酸序列，并且进行对齐。检索完成后会显示查询结果，而这些氨基酸序列与输入序列的对齐也会作为输出的一部分：
那么这样一来，这些比较接近的氨基酸序列和其结构也可以作为特征的一部分来辅助模型判断，这是一个很典型的将专家知识加入机器学习系统的方法。作者也提到如果不加上MAS特征，准确率会掉将近10个点。所以MSA特征是AlphaFold的一个重要组成部分。
2 特征构造 通过同源序列和模板表示成深度学习可以作为输入的矩阵结构
21：one-hot&#43;unknown
49：
25：
剩下的维度没看明白。
3 特征表示 用这6个矩阵构造MSA和pair respresentation矩阵
如下图，MSA包含了多物种信息特征，pair representation只包含一个物种的信息
Input feature embeddings. Dimension names: r: residues, f: features, c: channels, sc: clustered MSA sequences, se: extra MSA sequences, st: template sequences.
4 MSA表示与残基对表示之间互换交换信息 由于物种进化的共变信息是蛋白质结构预测的重要信息来源，将共变信息融合到单一物种是通过Evoformer结构实现的。
1）从MSA中提取蛋白质的共变信息
a. MSA row-wise gated self-attention with pair bias
每次取一条（行）序列进行更新：self-attention并加入残基对的信息,构建残基之间的进化关系 。
b. MSA column-wise gated self-attention
每次取1列：来自不同序列的相同残基交换信息" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/720b3aa5603c6062cbef06489023a158/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-04T15:53:01+08:00" />
<meta property="article:modified_time" content="2022-01-04T15:53:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">AlphaFold2算法详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:.0001pt;text-align:justify;">正文：https://www.nature.com/articles/s41586-021-03819-2</p> 
<p style="margin-left:.0001pt;text-align:justify;">补充文件：<a class="has-card" href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-03819-2/MediaObjects/41586_2021_3819_MOESM1_ESM.pdf" rel="nofollow" title="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-03819-2/MediaObjects/41586_2021_3819_MOESM1_ESM.pdf"><span class="link-card-box"><span class="link-title">https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-03819-2/MediaObjects/41586_2021_3819_MOESM1_ESM.pdf</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/23/6a/VZdZ5VUh_o.png" alt="icon-default.png?t=LBL2">https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-03819-2/MediaObjects/41586_2021_3819_MOESM1_ESM.pdf</span></span></a>学习视频（强烈推荐）：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><a href="https://www.bilibili.com/video/av504954705?zw" rel="nofollow" title="【公开课】基于AI预测蛋白质折叠的三维空间结构——AlphaFold2原理及安装使用_哔哩哔哩_bilibili">【公开课】基于AI预测蛋白质折叠的三维空间结构——AlphaFold2原理及安装使用_哔哩哔哩_bilibili</a></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="513" src="https://images2.imgbox.com/d5/6b/j0yqP68e_o.png" width="994"></p> 
<h2 style="margin-left:0;text-align:justify;">1. 搜索同源序列和模板：</h2> 
<p style="margin-left:.0001pt;text-align:justify;">去按序列数据库以及PDB数据库中去搜索同源序列和模板</p> 
<p style="margin-left:.0001pt;text-align:justify;">给定序列A，到Uniref90、MGnify、Uniclust30、BFD数据库中搜索他的<u>同源序列</u>，从Unire90中得到<u>MSA。</u>然后到PDB70中搜索同源模板得到对应的mmCif文件</p> 
<p style="margin-left:.0001pt;text-align:justify;">1）当相似度高于50%，常推测检测序列和目标序列有可能是同源序列。</p> 
<p style="margin-left:.0001pt;text-align:justify;">2）MSA</p> 
<p style="margin-left:.0001pt;text-align:justify;">MSA是Multiple Sequence Alignment的缩写，即多序列对齐，这个技术用于从一个大的数据库中抽取和输入氨基酸序列相近的序列，并且顺便进行对齐。抽取这个特征的原因是类似的氨基酸序列一般来说折叠方式也类似，相当于在特征中就加入了相近的序列结构信息。</p> 
<p style="margin-left:.0001pt;text-align:justify;">这里我们举个例子，HHblit工具也可以用来做MSA，在网站中输入用于举例的59个氨基酸组成的序列，HHblit工具就会在数据库中开始搜索序列与之相近的氨基酸序列，并且进行对齐。检索完成后会显示查询结果，而这些氨基酸序列与输入序列的对齐也会作为输出的一部分：</p> 
<p style="text-align:center;"><img alt="https://pic2.zhimg.com/80/v2-92d6e895ace704cf767efe4389080e71_1440w.jpg" height="379" src="https://images2.imgbox.com/eb/9c/Jg0460bL_o.png" width="609"></p> 
<p style="margin-left:.0001pt;text-align:justify;">那么这样一来，这些比较接近的氨基酸序列和其结构也可以作为特征的一部分来辅助模型判断，这是一个很典型的将专家知识加入机器学习系统的方法。作者也提到如果不加上MAS特征，准确率会掉将近10个点。所以MSA特征是AlphaFold的一个重要组成部分。</p> 
<h2 style="margin-left:0;text-align:justify;">2 特征构造</h2> 
<p style="margin-left:.0001pt;text-align:justify;">通过同源序列和模板表示成深度学习可以作为输入的矩阵结构</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="467" src="https://images2.imgbox.com/98/8f/Jq7XymOR_o.png" width="863"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">21：one-hot+unknown</p> 
<p style="margin-left:.0001pt;text-align:justify;">49：</p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="439" src="https://images2.imgbox.com/ad/6e/KOzM1pLb_o.png" width="977"></p> 
<p style="margin-left:.0001pt;text-align:justify;">25：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="223" src="https://images2.imgbox.com/4a/4e/YxpKQFuw_o.png" width="979"></p> 
<p style="margin-left:.0001pt;text-align:justify;">剩下的维度没看明白。</p> 
<h2 style="margin-left:0;text-align:justify;">3 特征表示</h2> 
<p style="margin-left:.0001pt;text-align:justify;">用这6个矩阵构造MSA和pair respresentation矩阵</p> 
<p style="margin-left:.0001pt;text-align:justify;">如下图，MSA包含了多物种信息特征，pair representation只包含一个物种的信息</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="547" src="https://images2.imgbox.com/75/7b/eTNembvT_o.png" width="808"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;">Input feature embeddings. Dimension names: r: residues, f: features, c: channels, sc: clustered MSA sequences, se: extra MSA sequences, st: template sequences.</p> 
<h2 style="margin-left:0;text-align:justify;">4 MSA表示与残基对表示之间互换交换信息</h2> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="405" src="https://images2.imgbox.com/14/5f/46CuvDBm_o.png" width="865"></p> 
<p style="margin-left:.0001pt;text-align:justify;">由于物种进化的共变信息是蛋白质结构预测的重要信息来源，将共变信息融合到单一物种是通过Evoformer结构实现的。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="331" src="https://images2.imgbox.com/eb/76/MFVSFMcb_o.png" width="881"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;">1）从MSA中提取蛋白质的共变信息</p> 
<p style="margin-left:.0001pt;text-align:justify;">a. MSA row-wise gated self-attention with pair bias</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="597" src="https://images2.imgbox.com/bc/46/VueFvWPs_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;">每次取一条（行）序列进行更新：self-attention并加入残基对的信息,构建残基之间的进化关系 。</p> 
<p style="margin-left:.0001pt;text-align:justify;">b. MSA column-wise gated self-attention</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="324" src="https://images2.imgbox.com/88/41/76oTtw8D_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;">每次取1列：来自不同序列的相同残基交换信息</p> 
<p style="margin-left:.0001pt;text-align:justify;">c.Transition</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="190" src="https://images2.imgbox.com/4e/af/rkq4CBoJ_o.png" width="854"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="393" src="https://images2.imgbox.com/8a/86/6I6imv1A_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;">把通道*4，再恢复成原来的通道数</p> 
<p style="margin-left:.0001pt;text-align:justify;">2）把蛋白共变的信息加入到残基对表示中</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="332" src="https://images2.imgbox.com/7c/36/vkFbZiA2_o.png" width="897"></p> 
<p style="margin-left:.0001pt;text-align:justify;">取任意一对残基的特征，计算外积取均值以后更新到残基对中表示</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="480" src="https://images2.imgbox.com/d2/74/seco9pyL_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;">3）通过周围的残基对来更新当前的残基对：有助于学习到位置信息</p> 
<p style="margin-left:.0001pt;text-align:justify;">Triangular multiplicative——outgoing</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="302" src="https://images2.imgbox.com/24/a0/Oc9tnERI_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="308" src="https://images2.imgbox.com/15/69/TDPT4PGR_o.png" width="459"></p> 
<p style="margin-left:.0001pt;text-align:justify;">使用和残基i以及残基j共起点活共终点的边来更新边</p> 
<p style="margin-left:.0001pt;text-align:justify;">Triangular self-attention</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="591" src="https://images2.imgbox.com/cc/29/kwUcUUPf_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="321" src="https://images2.imgbox.com/c4/2e/JFiwu8Tp_o.png" width="479"></p> 
<p style="margin-left:.0001pt;text-align:justify;">使用从i出发或者终止的所有边来更新边（i，j）</p> 
<h2 style="margin-left:0;text-align:justify;">5 残基的抽象表示转换成具体的三维空间坐标</h2> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="570" src="https://images2.imgbox.com/75/ea/SpHgnmyh_o.png" width="481"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;">Fram与蛋白质结构的关系</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="463" src="https://images2.imgbox.com/50/a1/0w4YxkZ8_o.png" width="865"></p> 
<p style="margin-left:.0001pt;text-align:justify;">C原子转到全局坐标系下，*Fram；对Fram求逆，得到局部坐标系</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="536" src="https://images2.imgbox.com/9a/cb/M48EaPVp_o.png" width="865"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="404" src="https://images2.imgbox.com/6f/39/VdSpCERJ_o.png" width="651"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="407" src="https://images2.imgbox.com/2b/9d/lyFhNAPg_o.png" width="701"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;">取MSA第一行，代表的是当前氨基酸的簇，</p> 
<p style="margin-left:.0001pt;text-align:justify;">1）Single repr得到方法：IPA</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="896" src="https://images2.imgbox.com/6c/db/bsuxDfBU_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;">绿色的表示三维空间中距离越近的残基对，注意力越高，最终更新</p> 
<p style="margin-left:.0001pt;text-align:justify;">2）backbone得到方法</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="636" src="https://images2.imgbox.com/ec/45/9HoTnHYw_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;">上图4元组是Fram的另外一种表示方法，表示一个对象在三维空间中的方向和旋转的一种方式，可以等价替换为旋转矩阵，通过公式计算Fram，对原来的Fram进行调整</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>6 </strong><strong>计算Loss（FAPE）</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="1164" src="https://images2.imgbox.com/fd/8d/pvn764Lm_o.png" width="1200"></p> 
<p style="margin-left:.0001pt;text-align:justify;"> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/77fabf287982de633d68bdc28d7d4c65/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用for循环打印出大写字母的ASCII码对照表（c语言实现）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9992a951af26508fcea60aca7d7d330f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Windows10系统添加虚拟网卡(Microsoft Loopback Adapter)的方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>