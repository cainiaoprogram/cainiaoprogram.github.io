<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>maya_mel语言中多边形点的提取和遍历操作方法 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="maya_mel语言中多边形点的提取和遍历操作方法" />
<meta property="og:description" content="一、问题分析： 有老同事问我，想用maya mel语言为模型选择点，沿法向方向移动。如下图：
并使用了如下代码操作单个定点,成功了，：
string $pp[]; string $obj; $pp = `ls -sl`; for ($obj in $pp) { select -cl; select $obj; move -r -cs -ls -wd 1 0 0 ; } 之后，又同时选择多个点操作，出现了如下错误。
点不再沿着法线移动而是垂直向上了。
二、解决方法： 分析研究后发现，maya对元素点线面的选择时，会以一种集合方式操作。必须使用 filterExpand 命令来转化为独立的单个元素，才能在for循环里调用：
用editplus文本编辑器,批量文件搜索工具在maya官方scripts脚本中查找filterExpand 用法：如下图：
发现了各类元素的分解方法：
看看多边形点的分解方式：
// Copyright 2017 Autodesk, Inc. All rights reserved. // // Use of this software is subject to the terms of the Autodesk license // agreement provided at the time of installation or download, or which // otherwise accompanies this software in either electronic or hard copy form." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3948ab96e611d093e43c45d2fbcfb646/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-23T14:24:38+08:00" />
<meta property="article:modified_time" content="2023-09-23T14:24:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">maya_mel语言中多边形点的提取和遍历操作方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>一、问题分析：</h3> 
<p>有老同事问我，想用maya mel语言为模型选择点，沿法向方向移动。如下图：<br> <img src="https://images2.imgbox.com/a8/63/L3Rl8WNo_o.jpg" alt="在这里插入图片描述"><br> 并使用了如下代码操作单个定点,成功了，：</p> 
<pre><code>string $pp[];
string $obj;
$pp = `ls -sl`;
for ($obj in $pp)
{   
    select -cl;
    select $obj;
    move -r -cs -ls -wd  1 0 0 ;
}
</code></pre> 
<p>之后，又同时选择多个点操作，出现了如下错误。<br> <img src="https://images2.imgbox.com/e9/e7/oTaDoRHX_o.png" alt="请添加图片描述"><br> 点不再沿着法线移动而是垂直向上了。</p> 
<h3><a id="_18"></a>二、解决方法：</h3> 
<p>分析研究后发现，maya对元素点线面的选择时，会以一种集合方式操作。必须使用 filterExpand 命令来转化为独立的单个元素，才能在for循环里调用：</p> 
<p>用editplus文本编辑器,批量文件搜索工具在maya官方scripts脚本中查找filterExpand 用法：如下图：<br> <img src="https://images2.imgbox.com/9a/d8/DKO53iI9_o.png" alt="在这里插入图片描述"><br> 发现了各类元素的分解方法：<br> 看看多边形点的分解方式：</p> 
<pre><code>// Copyright 2017 Autodesk, Inc. All rights reserved.
//
// Use of this software is subject to the terms of the Autodesk license
// agreement provided at the time of installation or download, or which
// otherwise accompanies this software in either electronic or hard copy form.
// 
global proc string[] getVerts()
{
	select -r `polyListComponentConversion -tv`;
	string $result[]=`filterExpand -ex true -sm 31`;
	return $result;
}
</code></pre> 
<p>以上程序可以把选择多边形元素转换为独立点集合。之后在用for就可以操作了。如下代码再测试一下：</p> 
<pre><code>string $pp[];
string $v;
$pp =` getVerts `;

for ($v in $pp)
{    
    select -cl;
    select $v;
    move -r -cs -ls -wd  1 0 0 ;   
}
</code></pre> 
<p>成功了！阿弥陀佛<br> <img src="https://images2.imgbox.com/a4/cf/bYBalj3a_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="filterExpand_edge_55"></a>三、官方的filterExpand 命令文档如下：（通过edge浏览器翻译为中文）</h3> 
<pre><code>命令 （MEL）	
过滤器展开
在类别中： 建模， NURBS
无帧

转到：剧情简介。返回值。相关。标志。MEL 示例。

概要
filterExpand [-expand boolean] [-fullPath boolean] [-selectionMask int] [-symActive] [-symNegative] [-symPositive] [-symSeam]

filterExpand 是不可操作、不可查询且不可编辑的。

根据选定的组件（或在命令行上指定的组件），命令将筛选和/或扩展给定选项的列表。返回包含所有匹配选择项的字符串数组。选择蒙版如下所示：
对象类型	面具
处理	0
努尔斯曲线	9
努尔布斯表面	10
努尔布斯曲面曲线	11
多边形	12
定位器 XYZ	22
方向定位器	23
紫外线定位器	24
控制顶点 （CV）	28
编辑点	30
多边形顶点	31
多边形边	32
多边形面	34
多边形 UV	35
细分网格点	36
细分网格边	37
细分网格面	38
曲线参数点	39
曲线结	40
曲面参数点	41
表面结	42
表面范围	43
修剪表面边缘	44
表面等臂	45
晶格点	46
粒子	47
缩放透视表	49
旋转枢轴	50
选择手柄	51
细分曲面	68
多边形顶点面	70
NURBS 表面面	72
细分网格 UV	73
返回值
字符串[]	命令结果
相关
选择类型
标志
expand， fullPath， selectionMask， symActive， symNegative， symPositive， symSeam
长名称（短名称）	参数类型	性能
-expand(-ex)	boolean	创造
如果这是真的，则每个项目都是一个实体。默认值为 true。
-fullPath(-fp)	boolean	创造
如果为 true 并且选择项是 DAG 对象，则仅当此值为 false 时，才返回其完整的选择路径，而不是对象的名称。默认值为 false。
-selectionMask(-sm)	int	创造多用途
指定选择蒙版
-symActive(-sma)		创造
如果启用了对称性，则仅返回对象活动对称侧的组件。如果对称性不处于活动状态，则此标志不起作用。
-symNegative(-smn)		创造
如果启用了对称性，则仅返回对象负侧相对于当前对称平面的分量。如果对称性不处于活动状态，则此标志不起作用。
-symPositive(-smp)		创造
If symmetry is enabled only return the components on the positive side of the object relative to the current symmetry plane. This flag has no effect if symmetry is not active.
-symSeam(-sms)		create
If symmetry is enabled only return the components that lie equally on both sides of the object relative to the current symmetry plane. This flag has no effect if symmetry is not active.
 Flag can appear in Create mode of command	 Flag can appear in Edit mode of command
 Flag can appear in Query mode of command	 Flag can be used more than once in a command.
MEL examples
// Returns any selected isoparms (mask 45) as individual items
// (because of "-ex true").
filterExpand -ex true -sm 45;

// Returns any selected CVs (mask 28) as compact items.  For example,
//   if curve.cv[0:3] is selected, then "curve.cv[0:3]" is returned.
//   If "-ex true", then four items are returned, one for each CV.
filterExpand -ex false -sm 28;

// Returns any selected CVs (mask 28) and edit points (mask 30).
filterExpand -sm 28 -sm 30;

// Returns any selected nurbs curves.
filterExpand -sm 9;

// Returns any selected nurbs curves-on-surface.
filterExpand -sm 11;

// return the poly faces (mask 34) from the specified arguments
filterExpand -sm 34 "pCube1.f[1]" "pCube1.f[4]" "pCube1.vtx[0:3]";

</code></pre> 
<p>南无阿弥陀佛，哈哈哈。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4f84ba4151e6d4cdf5ccb0b141101105/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C#异步委托的三种实现 BeginInvoke / EndInvoke / IsCompleted</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/773807c027fba29ec7b51abba347b127/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#线程详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>