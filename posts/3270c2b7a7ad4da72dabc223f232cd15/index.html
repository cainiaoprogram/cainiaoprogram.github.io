<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>flask基础根据知了课堂整理 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="flask基础根据知了课堂整理" />
<meta property="og:description" content="1安装Python2.7： Mac下使用Python2.7.Windows下安装Python2.7. 从python官网下载python2.7的版本。双击python2.7，然后选择安装路径，一顿下一步就可以了。设置环境变量，把python的安装路径添加到PATH变量中。还需要设置一个环境变量，一定要设置，不然后面就不能正常安装flask了。 2Python虚拟环境介绍与安装： 因为python的框架更新迭代太快了，有时候需要在电脑上存在一个框架的多个版本，这时候虚拟环境就可以解决这个问题。通过以下命令安装虚拟环境：pip install virtualenv开辟新的虚拟环境：virtualenv [virtualenv-name]激活虚拟环境： [类linux]：source [虚拟环境的目录]/bin/activate[windows]：直接进入到虚拟环境的目录，然后执行activate退出虚拟环境：deactivate 3pip安装flask： 执行activate脚本，进入指定的虚拟环境。在该虚拟环境中，执行以下命令安装：pip install flask验证flask是否安装成功： 进入python命令行。 import flask
print flask.version
认识url： 如果使用的是http协议，那么浏览器就会使用80端口去请求这个服务器的资源。如果使用的是https协议，那么浏览器会使用443端口去请求这个服务器的资源。
http://www.jianshu.com/
https://www.baidu.com/
https://www.baidu.com/s?ie=utf-8&amp;f=8 http://baike.baidu.com/link?url=ELcglgxAgFQ9WlMytXEhxu-WBtI7mTlDj3TJ-Ht6ZSecAYt0hgqY0euqaB60opaEEZ7JChin5vUd_YkOgMi7BT5kc3E85ZXeoVL2iVfKZu_jHMcNabK8NXilqnfJknKs
http://baike.baidu.com/link?url=ELcglgxAgFQ9WlMytXEhxu-WBtI7mTlDj3TJ-Ht6ZSecAYt0hgqY0euqaB60opaEEZ7JChin5vUd_YkOgMi7BT5kc3E85ZXeoVL2iVfKZu_jHMcNabK8NXilqnfJknKs#3
http://baike.baidu.com/link?url=ELcglgxAgFQ9WlMytXEhxu-WBtI7mTlDj3TJ-Ht6ZSecAYt0hgqY0euqaB60opaEEZ7JChin5vUd_YkOgMi7BT5kc3E85ZXeoVL2iVfKZu_jHMcNabK8NXilqnfJknKs#5
4URL详解 URL是Uniform Resource Locator的简写，统一资源定位符。
一个URL由以下几部分组成：
scheme://host:port/path/?query-string=xxx#anchor scheme：代表的是访问的协议，一般为http或者https以及ftp等。
host：主机名，域名，比如www.baidu.com。
port：端口号。当你访问一个网站的时候，浏览器默认使用80端口。
path：查找路径。比如：www.jianshu.com/trending/now，后面的trending/now就是path。
query-string：查询字符串，比如：www.baidu.com/s?wd=python，后面的wd=python就是查询字符串。
anchor：锚点，后台一般不用管，前端用来做页面定位的。
5web服务器和应用服务器以及web应用框架： web服务器：负责处理http请求，响应静态文件，常见的有Apache，Nginx以及微软的IIS.
应用服务器：负责处理逻辑的服务器。比如php、python的代码，是不能直接通过nginx这种web服务器来处理的，只能通过应用服务器来处理，常见的应用服务器有uwsgi、tomcat等。
web应用框架：一般使用某种语言，封装了常用的web功能的框架就是web应用框架，flask、Django以及Java中的SSH(Structs2&#43;Spring3&#43;Hibernate3)框架都是web应用框架。
01Flask基础 6第一个flask程序讲解： 第一次创建项目的时候，要添加flask的虚拟环境。添加虚拟环境的时候，一定要选择到python这个执行文件。
比如你的flask的虚拟环境的目录在/User/Virtualenv/flask-env/bin/python。flask程序代码的详细解释：# 从flask这个框架中导入Flask这个类 from flask import Flask # 初始化一个Flask对象 # Flaks() # 需要传递一个参数__name__ # 1. 方便flask框架去寻找资源 # 2. 方便flask插件比如Flask-Sqlalchemy出现错误的时候，好去寻找问题所在的位置 app = Flask(__name__) # @app.route是一个装饰器 # @开头，并且在函数的上面，说明是装饰器 # 这个装饰器的作用，是做一个url与视图函数的映射 # 127." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3270c2b7a7ad4da72dabc223f232cd15/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-16T09:26:07+08:00" />
<meta property="article:modified_time" content="2020-12-16T09:26:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">flask基础根据知了课堂整理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="1Python27_0"></a>1安装Python2.7：</h4> 
<ol><li>Mac下使用Python2.7.</li><li>Windows下安装Python2.7. 
  <ul><li>从python官网下载python2.7的版本。</li><li>双击python2.7，然后选择安装路径，一顿下一步就可以了。</li><li>设置环境变量，把python的安装路径添加到PATH变量中。</li><li>还需要设置一个环境变量，一定要设置，不然后面就不能正常安装flask了。</li></ul> </li></ol> 
<h4><a id="2Python_8"></a>2Python虚拟环境介绍与安装：</h4> 
<ol><li>因为python的框架更新迭代太快了，有时候需要在电脑上存在一个框架的多个版本，这时候虚拟环境就可以解决这个问题。</li><li>通过以下命令安装虚拟环境：pip install virtualenv</li><li>开辟新的虚拟环境：virtualenv [virtualenv-name]</li><li>激活虚拟环境： 
  <ul><li>[类linux]：source [虚拟环境的目录]/bin/activate</li><li>[windows]：直接进入到虚拟环境的目录，然后执行activate</li><li>退出虚拟环境：deactivate</li></ul> </li></ol> 
<h4><a id="3pipflask_17"></a>3pip安装flask：</h4> 
<ol><li>执行activate脚本，进入指定的虚拟环境。</li><li>在该虚拟环境中，执行以下命令安装：pip install flask</li><li>验证flask是否安装成功： 
  <ul><li>进入python命令行。</li></ul> 
  <blockquote> 
   <blockquote> 
    <blockquote> 
     <p>import flask<br> print flask.<strong>version</strong></p> 
    </blockquote> 
   </blockquote> 
  </blockquote> </li></ol> 
<h4><a id="url_24"></a>认识url：</h4> 
<ol><li>如果使用的是http协议，那么浏览器就会使用80端口去请求这个服务器的资源。</li><li>如果使用的是https协议，那么浏览器会使用443端口去请求这个服务器的资源。<br> http://www.jianshu.com/<br> https://www.baidu.com/<br> https://www.baidu.com/s?ie=utf-8&amp;f=8</li></ol> 
<p>http://baike.baidu.com/link?url=ELcglgxAgFQ9WlMytXEhxu-WBtI7mTlDj3TJ-Ht6ZSecAYt0hgqY0euqaB60opaEEZ7JChin5vUd_YkOgMi7BT5kc3E85ZXeoVL2iVfKZu_jHMcNabK8NXilqnfJknKs</p> 
<p>http://baike.baidu.com/link?url=ELcglgxAgFQ9WlMytXEhxu-WBtI7mTlDj3TJ-Ht6ZSecAYt0hgqY0euqaB60opaEEZ7JChin5vUd_YkOgMi7BT5kc3E85ZXeoVL2iVfKZu_jHMcNabK8NXilqnfJknKs#3</p> 
<p>http://baike.baidu.com/link?url=ELcglgxAgFQ9WlMytXEhxu-WBtI7mTlDj3TJ-Ht6ZSecAYt0hgqY0euqaB60opaEEZ7JChin5vUd_YkOgMi7BT5kc3E85ZXeoVL2iVfKZu_jHMcNabK8NXilqnfJknKs#5</p> 
<h4><a id="4URL_39"></a>4URL详解</h4> 
<p>URL是Uniform Resource Locator的简写，统一资源定位符。</p> 
<p>一个URL由以下几部分组成：</p> 
<pre><code>scheme://host:port/path/?query-string=xxx#anchor
</code></pre> 
<p>scheme：代表的是访问的协议，一般为http或者https以及ftp等。<br> host：主机名，域名，比如www.baidu.com。<br> port：端口号。当你访问一个网站的时候，浏览器默认使用80端口。<br> path：查找路径。比如：www.jianshu.com/trending/now，后面的trending/now就是path。<br> query-string：查询字符串，比如：www.baidu.com/s?wd=python，后面的wd=python就是查询字符串。<br> anchor：锚点，后台一般不用管，前端用来做页面定位的。</p> 
<h4><a id="5webweb_52"></a>5web服务器和应用服务器以及web应用框架：</h4> 
<p>web服务器：负责处理http请求，响应静态文件，常见的有Apache，Nginx以及微软的IIS.<br> 应用服务器：负责处理逻辑的服务器。比如php、python的代码，是不能直接通过nginx这种web服务器来处理的，只能通过应用服务器来处理，常见的应用服务器有uwsgi、tomcat等。<br> web应用框架：一般使用某种语言，封装了常用的web功能的框架就是web应用框架，flask、Django以及Java中的SSH(Structs2+Spring3+Hibernate3)框架都是web应用框架。</p> 
<p><img src="https://images2.imgbox.com/10/ac/hwzvPCNF_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="01Flask_66"></a>01Flask基础</h3> 
<h4><a id="6flask_68"></a>6第一个flask程序讲解：</h4> 
<ol><li>第一次创建项目的时候，要添加flask的虚拟环境。添加虚拟环境的时候，一定要选择到python这个执行文件。<br> 比如你的flask的虚拟环境的目录在/User/Virtualenv/flask-env/bin/python。</li><li>flask程序代码的详细解释：<pre><code># 从flask这个框架中导入Flask这个类
from flask import Flask

# 初始化一个Flask对象
# Flaks()
# 需要传递一个参数__name__
# 1. 方便flask框架去寻找资源
# 2. 方便flask插件比如Flask-Sqlalchemy出现错误的时候，好去寻找问题所在的位置
app = Flask(__name__)


# @app.route是一个装饰器
# @开头，并且在函数的上面，说明是装饰器
# 这个装饰器的作用，是做一个url与视图函数的映射
# 127.0.0.1:5000/   -&gt;  去请求hello_world这个函数，然后将结果返回给浏览器
@app.route('/')
def hello_world():
    return '我是第一个flask程序'


# 如果当前这个文件是作为入口程序运行，那么就执行app.run()
if __name__ == '__main__':
    # app.run()
    # 启动一个应用服务器，来接受用户的请求
    # while True:
    #   listen()
    app.run()
</code></pre> </li></ol> 
<h4><a id="7debug_102"></a>7设置debug模式：</h4> 
<ol><li>在app.run()中传入一个关键字参数debug,app.run(debug=True)，就设置当前项目为debug模式。</li><li>debug模式的两大功能： 
  <ul><li>当程序出现问题的时候，可以在页面中看到错误信息和出错的位置。不然网页只会现实internal server error</li><li>只要修改了项目中的<code>python</code>文件，程序会自动加载，不需要手动重新启动服务器。</li></ul> </li></ol> 
<h4><a id="8_108"></a>8使用配置文件：</h4> 
<ol><li>新建一个<code>config.py</code>文件</li><li>在主app文件中导入这个文件，并且配置到<code>app</code>中，示例代码如下：</li></ol> 
<pre><code class="prism language-c"> 比如上一步写的 app<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>debug<span class="token operator">=</span>True<span class="token punctuation">)</span>
    可以直接在在config<span class="token punctuation">.</span>py内写   DEBUG<span class="token operator">=</span>True
    app<span class="token punctuation">.</span>py中仍是app<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

但是要在app<span class="token punctuation">.</span>py要引入
    import config
    app<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function">from_object</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
</code></pre> 
<ol start="3"><li>还有许多的其他参数，都是放在这个配置文件中，比如<code>SECRET_KEY</code>和<code>SQLALCHEMY</code>这些配置，都是在这个文件中。</li></ol> 
<h4><a id="9url_126"></a>9url传参数：</h4> 
<ol><li>参数的作用：可以在相同的URL，但是指定不同的参数，来加载不同的数据。</li><li>在flask中如何使用参数：<pre><code>@app.route('/article/&lt;id&gt;')
def article(id):
    return u'您请求的 参数是：%s' % id
</code></pre> </li></ol> 
<p><img src="https://images2.imgbox.com/59/e5/IMQj7I9w_o.png" alt="在这里插入图片描述"><br> 如图传进去的是这样的id<br> * 参数需要放在两个尖括号中。<br> * 视图函数中需要放和url中的参数同名的参数。<br> 效果如下<br> <img src="https://images2.imgbox.com/a3/9e/JuHioint_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="10URL_141"></a>10反转URL：</h4> 
<ol><li>什么叫做反转URL：从视图函数到url的转换叫做反转url</li><li>反转url的用处： 
  <ul><li> <p>在页面重定向（redirect）的时候，会使用url反转。<br> <img src="https://images2.imgbox.com/67/d5/lWkkKjQz_o.png" alt="在这里插入图片描述"></p> </li><li> <p>在模板中，也会使用url反转。<br> <img src="https://images2.imgbox.com/da/a9/ektfVHiL_o.png" alt="在这里插入图片描述"></p> </li></ul> </li></ol> 
<p><img src="https://images2.imgbox.com/bd/a0/LGzf8erc_o.png" alt="在这里插入图片描述"></p> 
<p>通过视图函数my_list和article 来找到他们的url 效果如下<img src="https://images2.imgbox.com/63/0f/gSbGRJum_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="11_156"></a>11页面跳转和重定向：</h4> 
<ol><li>用处：在用户访问一些需要登录的页面的时候，如果用户没有登录，那么可以让她重定向到登录页面。</li><li>代码实现：<pre><code>from flask import redirect,url
redirect(url_for('login'))
</code></pre> </li></ol> 
<p>点击发布问答的时候 如果登录的时候就可以发布问答<br> 没有登陆的话就要重定向去登录<br> 简单模拟效果如下：<br> <img src="https://images2.imgbox.com/2c/fd/IgasUDMm_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">@app<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">'/question/&lt;is_login&gt;/'</span><span class="token punctuation">)</span>   # <span class="token operator">&lt;</span>is_login<span class="token operator">&gt;</span>是参数
def <span class="token function">question</span><span class="token punctuation">(</span>is_login<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>is_login<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> u<span class="token string">"这是发布问答页面"</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token function">url_for</span><span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>效果：传入1表示登录 0表示未登录<br> <img src="https://images2.imgbox.com/1d/fe/CT2hyS5B_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="02_183"></a>02模板笔记</h3> 
<h4><a id="12FlaskJinja2_185"></a>12Flask渲染Jinja2模板和传参：</h4> 
<ol><li>如何渲染模板： 
  <ul><li>模板放在<code>templates</code>文件夹下</li><li>从<code>flask</code>中导入<code>render_template</code>函数。</li><li>在视图函数中，使用<code>render_template</code>函数，渲染模板。注意：只需要填写模板的名字，不需要填写<code>templates</code>这个文件夹的路径。(仅仅限html直接在template文件夹下)</li></ul> </li><li>模板传参： 
  <ul><li>如果只有一个或者少量参数，直接在<code>render_template</code>函数中添加关键字参数就可以了。<br> 如：</li></ul> </li></ol> 
<pre><code class="prism language-php">@app<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">)</span>
def <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token function">render_template</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'index.html'</span><span class="token punctuation">,</span>usename<span class="token operator">=</span>u<span class="token single-quoted-string string">'黄勇'</span><span class="token punctuation">)</span><span class="token shell-comment comment">#传参</span>
</code></pre> 
<p>如果有多个参数的时候，那么可以先把所有的参数放在字典中，然后在<code>render_template</code>中，<br> 使用两个星号，把字典转换成关键参数传递进去，这样的代码更方便管理和使用。</p> 
<pre><code class="prism language-c">@app<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
def <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      
    context<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> u<span class="token string">'黄勇'</span><span class="token punctuation">,</span>
        <span class="token string">'gender'</span><span class="token punctuation">:</span><span class="token string">'男'</span><span class="token punctuation">,</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">render_template</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token operator">*</span>context<span class="token punctuation">)</span>#传参
</code></pre> 
<p>页面显示如下：<br> <img src="https://images2.imgbox.com/26/5f/5Ae8uoX9_o.png" alt="在这里插入图片描述"><br> 在index.html中描写如下：<br> <img src="https://images2.imgbox.com/b3/ae/K0QkwwTQ_o.png" alt="在这里插入图片描述"></p> 
<ol start="3"><li>在模板中，如果要使用一个变量，语法是：<code>{<!-- -->{params}}</code></li><li>访问模型中的属性或者是字典，可以通过<code>{<!-- -->{params.property}}</code>的形式，或者是使用<code>{<!-- -->{params['age']}}</code>.</li></ol> 
<pre><code class="prism language-php">def <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>
        name<span class="token operator">=</span>u<span class="token single-quoted-string string">'喜喜'</span>
        age<span class="token operator">=</span><span class="token number">18</span>
    P<span class="token operator">=</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


    context<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
        <span class="token single-quoted-string string">'username'</span><span class="token punctuation">:</span> u<span class="token single-quoted-string string">'黄勇'</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'gender'</span><span class="token punctuation">:</span><span class="token single-quoted-string string">'男'</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'person'</span><span class="token punctuation">:</span>P<span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'websites'</span><span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
            <span class="token single-quoted-string string">'baidu'</span><span class="token punctuation">:</span><span class="token single-quoted-string string">'www.baidu.'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'google'</span><span class="token punctuation">:</span><span class="token single-quoted-string string">'www.google'</span><span class="token punctuation">,</span>

        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">render_template</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'index.html'</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token operator">*</span>context<span class="token punctuation">)</span><span class="token shell-comment comment">#传参</span>
</code></pre> 
<p>html如下：</p> 
<pre><code class="prism language-php"><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span> 用户名：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> username <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span> 性别：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> gender <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>hr<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>名字：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> person<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>年龄：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> person<span class="token punctuation">.</span>age <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>hr<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>百度：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> websites<span class="token punctuation">.</span>baidu<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="13if_263"></a>13if判断：</h4> 
<ol><li>语法：<pre><code>{% if xxx %}
{% else %}
{% endif %}
</code></pre> </li><li>if的使用，可以和python中相差无几。<br> 实现简单的登录时右上角显示“xxxx（用户名），注销”的功能：<br> <img src="https://images2.imgbox.com/af/0a/OzUQnvS9_o.png" alt="在这里插入图片描述"></li></ol> 
<p><img src="https://images2.imgbox.com/42/f5/VWg6EgWL_o.png" alt="在这里插入图片描述"><br> 登录了：<img src="https://images2.imgbox.com/74/07/27Pu3RqN_o.png" alt="在这里插入图片描述"><br> 没登录：<br> <img src="https://images2.imgbox.com/cb/33/ST68Zv6B_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="14for_280"></a>14for循环遍历列表和字典：</h4> 
<ol><li>字典的遍历，语法和<code>python</code>一样，可以使用<code>items()</code>、<code>keys()</code>、<code>values()</code>、<code>iteritems()</code>、<code>iterkeys()</code>、<code>itervalues()</code><pre><code>{% for k,v in user.items() %}
    &lt;p&gt;{<!-- -->{ k }}：{<!-- -->{ v }}&lt;/p&gt;
{% endfor %}
</code></pre> </li></ol> 
<p>python中的用法 k、v分别指代key和value<img src="https://images2.imgbox.com/7a/7d/mQSxr10D_o.png" alt="在这里插入图片描述"><br> 同理 html里面用法一样 只是k v是变量要用{<!-- -->{k}} ：{<!-- -->{v}} 表示<br> <img src="https://images2.imgbox.com/f3/86/3q4l4axb_o.png" alt="在这里插入图片描述"><br> 效果：<br> <img src="https://images2.imgbox.com/8f/d8/FxcRbioP_o.png" alt="在这里插入图片描述"></p> 
<ol start="2"><li>列表的遍历：语法和<code>python</code>一样。<pre><code>{% for website in websites %}
    &lt;p&gt;{<!-- -->{ website }}&lt;/p&gt;
{% endfor %}


</code></pre> </li></ol> 
<p><img src="https://images2.imgbox.com/17/aa/QiJaTSvK_o.png" alt="在这里插入图片描述"><br> 小例子：</p> 
<pre><code class="prism language-php"><span class="token operator">&lt;</span>table<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>thead<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token constant">TH</span><span class="token operator">&gt;</span>书名<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token constant">TH</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>th<span class="token operator">&gt;</span>作者<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>th<span class="token operator">&gt;</span>价格<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>thead<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>tbody<span class="token operator">&gt;</span>
    <span class="token punctuation">{<!-- --></span><span class="token operator">%</span> <span class="token keyword">for</span> book in books <span class="token operator">%</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> book<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> book<span class="token punctuation">.</span>author <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> book<span class="token punctuation">.</span>price <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>

    <span class="token punctuation">{<!-- --></span><span class="token operator">%</span> <span class="token keyword">endfor</span> <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>tbody<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-bash">@app.route<span class="token punctuation">(</span><span class="token string">'/test/'</span><span class="token punctuation">)</span>
def test<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    books<span class="token operator">=</span><span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string">'name'</span>:u<span class="token string">'西游记'</span>,
            <span class="token string">'author'</span><span class="token keyword">:</span> u<span class="token string">'吴承恩'</span>,
            <span class="token string">'price'</span><span class="token keyword">:</span> 109

        <span class="token punctuation">}</span>,
        <span class="token punctuation">{<!-- --></span>
            <span class="token string">'name'</span><span class="token keyword">:</span> u<span class="token string">'红楼梦'</span>,
            <span class="token string">'author'</span><span class="token keyword">:</span> u<span class="token string">'曹雪芹'</span>,
            <span class="token string">'price'</span><span class="token keyword">:</span> 99

        <span class="token punctuation">}</span>,
        <span class="token punctuation">{<!-- --></span>
            <span class="token string">'name'</span><span class="token keyword">:</span> u<span class="token string">'三国演义'</span>,
            <span class="token string">'author'</span><span class="token keyword">:</span> u<span class="token string">'罗贯中'</span>,
            <span class="token string">'price'</span><span class="token keyword">:</span> 88

        <span class="token punctuation">}</span>,

    <span class="token punctuation">]</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'test.html'</span>,books<span class="token operator">=</span>books<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/95/05/MysY86I7_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="16_350"></a>16过滤器：</h4> 
<p><img src="https://images2.imgbox.com/51/7e/wCr3rL8o_o.png" alt="在这里插入图片描述"><br> 过滤器作用：有头像显示头像没头像显示默认的图片<img src="https://images2.imgbox.com/d8/2a/bEupvrB5_o.png" alt="在这里插入图片描述"></p> 
<ol><li>介绍和语法： 
  <ul><li>介绍：过滤器可以处理变量，把原始的变量经过处理后再展示出来。作用的对象是变量。</li><li>语法：<pre><code>{<!-- -->{ avatar|default('xxx') }}#  |是管道符号
</code></pre> </li></ul> </li><li>default过滤器：如果当前变量不存在，这时候可以指定默认值。</li><li>length过滤器：求列表或者字符串或者字典或者元组的长度。<br> 比如评论求长括号内显示有几条<br> <img src="https://images2.imgbox.com/ff/e4/VRaBY75M_o.png" alt="在这里插入图片描述"><br> 操作如下：<br> <img src="https://images2.imgbox.com/c3/33/plnxUnbG_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/da/20/4x5DbnlX_o.png" alt="在这里插入图片描述"></li></ol> 
<p>效果如下 没传头像时候是默认头像 评论数长度是两条<img src="https://images2.imgbox.com/a2/8e/DgVGCBfN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/94/ad/T4IQYAdr_o.png" alt="在这里插入图片描述"></p> 
<ol start="4"><li> <p>常用的过滤器：<br> abs(value)：返回一个数值的绝对值。示例：-1|abs<br> default(value,default_value,boolean=false)：如果当前变量没有值，则会使用参数中的值来代替。示例：name|default(‘xiaotuo’)——如果name不存在，则会使用xiaotuo来替代。boolean=False默认是在只有这个变量为undefined的时候才会使用default中的值，如果想使用python的形式判断是否为false，则可以传递boolean=true。也可以使用or来替换。<br> escape(value)或e：转义字符，会将&lt;、&gt;等符号转义成HTML中的符号。示例：content|escape或content|e。<br> first(value)：返回一个序列的第一个元素。示例：names|first<br> format(value,*arags,**kwargs)：格式化字符串。比如：</p> <p>{<!-- -->{ “%s” - “%s”|format(‘Hello?’,“Foo!”) }}<br> 将输出：Helloo? - Foo!<br> last(value)：返回一个序列的最后一个元素。示例：names|last。</p> <p>length(value)：返回一个序列或者字典的长度。示例：names|length。<br> join(value,d=u’’)：将一个序列用d这个参数的值拼接成字符串。<br> safe(value)：如果开启了全局转义，那么safe过滤器会将变量关掉转义。示例：content_html|safe。<br> int(value)：将值转换为int类型。<br> float(value)：将值转换为float类型。<br> lower(value)：将字符串转换为小写。<br> upper(value)：将字符串转换为小写。<br> replace(value,old,new)： 替换将old替换为new的字符串。<br> truncate(value,length=255,killwords=False)：截取length长度的字符串。<br> striptags(value)：删除字符串中所有的HTML标签，如果出现多个空格，将替换成一个空格。<br> trim：截取字符串前面和后面的空白字符。<br> string(value)：将变量转换成字符串。<br> wordcount(s)：计算一个长字符串中单词的个数。</p> </li></ol> 
<h4><a id="17block_400"></a>17继承和block：</h4> 
<p>继承的作用 如下图导览条位置都是相同的<img src="https://images2.imgbox.com/e8/ec/xaVCQzph_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/17/c9/ChFq3WtK_o.png" alt="在这里插入图片描述"><br> 所以可以把导航条内容都放在base里面 之后再去继承<br> 1.继承作用和语法：<br> python中的继承<br> * 作用：可以把一些公共的代码放在父模板中，避免每个模板写同样的代码。<br> * 语法：<br> <code>子模板写 {% extends 'base.html' %}</code><br> 在父模板中写</p> 
<blockquote> 
 <p>{% block main%}{% endblock %}</p> 
</blockquote> 
<ol start="2"><li>block实现： 
  <ul><li>作用：可以让子模板实现一些自己的需求。父模板需要提前定义好。相当于父模板定义一个接口然后让子模板实现</li></ul> </li></ol> 
<ul><li>注意点：字模板中的代码，必须放在block块中。可以有多个block</li></ul> 
<pre><code class="prism language-bash"><span class="token punctuation">{<!-- --></span>% extends <span class="token string">'base.html'</span> %<span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span>% block main%<span class="token punctuation">}</span>
<span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>
    这是首页啊啊
<span class="token operator">&lt;</span>/h1<span class="token operator">&gt;</span>
<span class="token punctuation">{<!-- --></span>% endblock %<span class="token punctuation">}</span>
</code></pre> 
<p>父模板：<img src="https://images2.imgbox.com/94/f6/Jzvqm5XJ_o.png" alt="在这里插入图片描述"><br> 子模板：<br> <img src="https://images2.imgbox.com/24/cc/XfKflT8V_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="18url_434"></a>18url链接：</h4> 
<p>使用<code>url_for(视图函数名称)</code>可以反转成url。<br> url_for(‘login’)</p> 
<p>等价于’/login/’</p> 
<h4><a id="19_443"></a>19加载静态文件：</h4> 
<ol><li>语法：<code>url_for('static',filename='路径')</code></li><li>静态文件，flask会从<code>static</code>文件夹中开始寻找，所以不需要再写<code>static</code>这个路径了。</li><li>可以加载<code>css</code>文件，可以加载<code>js</code>文件，还有<code>image</code>文件。(CSS内放一些背景 字体的设置 js放警告框之类)<pre><code>第一个：加载css文件
&lt;link rel="stylesheet" href="{<!-- -->{ url_for('static',filename='css/index.css') }}"&gt;
第二个：加载js文件
&lt;script src="{<!-- -->{ url_for('static',filename='js/index.js') }}"&gt;&lt;/script&gt;
第三个：加载图片文件
&lt;img src="{<!-- -->{ url_for('static',filename='images/zhiliao.png') }}" alt=""&gt;

</code></pre> </li></ol> 
<h3><a id="20_MacWindows_456"></a>20 Mac和Windows下数据库的安装：</h3> 
<ol><li>Mysql为例</li><li>https://dev.mysql.com/downloads/mysql/</li><li>Mac上安装Mysql很简单，直接一顿下一步安装就可以了。</li><li>设置初始化密码的命令是：<pre><code>mysqladmin -uroot password [password]
</code></pre> </li><li>windows:<br> *. 如果没有安装.net Framework 4，就在那个提示框中，找到下载的url，下载下来，安装即可。<br> *. 如果没有安装Microsoft Visual C++ x64，那么就需要谷歌或者百度下载这个软件进行安装即可。</li></ol> 
<h4><a id="21MySQLpython_469"></a>21MySQL-python中间件的介绍与安装：</h4> 
<ol><li>如果是在类unix系统上，直接进入虚拟环境，输入<code>sudo pip install mysql-python</code>。</li><li>如果是在windows系统上，那么在这里下载<code>http://www.lfd.uci.edu/~gohlke/pythonlibs/#mysql-python</code>下载<code>MySQL_python‑1.2.5‑cp27‑none‑win_amd64.whl</code>，然后在命令行中，进入到<code>MySQL_python‑1.2.5‑cp27‑none‑win_amd64.whl</code>所在的目录，输入以下命令进行安装：<pre><code>pip install MySQL_python‑1.2.5‑cp27‑none‑win_amd64.whl
</code></pre> </li></ol> 
<p>注意：1.Mysql驱动:</p> 
<p>eg:mysql-connector-odbc-5.1.5-win32.msi</p> 
<p>2.Python安装模块</p> 
<p>Python2.x 版本要安装mysql-python，而Python3.x版本要安装 mysqlclient ！</p> 
<p>具体操作如链接：</p> 
<p>https://blog.csdn.net/weixin_40947719/article/details/86323073。<br> 所以我们要安装mysqlclient</p> 
<p><img src="https://images2.imgbox.com/aa/07/FaWimpAX_o.png" alt="先"><br> 先看</p> 
<h4><a id="22FlaskSQLAlchemy_491"></a>22Flask-SQLAlchemy的介绍与安装：</h4> 
<ol><li>ORM：Object Relationship Mapping（模型关系映射）。</li><li>flask-sqlalchemy是一套ORM框架。</li><li>ORM的好处：可以让我们操作数据库跟操作对象是一样的，非常方便。因为一个表就抽象成一个类，一条数据就抽象成该类的一个对象。</li><li>安装<code>flask-sqlalchemy</code>：<code>sudo pip install flask-sqlalchemy</code>。</li></ol> 
<p><img src="https://images2.imgbox.com/75/03/73VHXVY8_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="23FlaskSQLAlchemy_501"></a>23Flask-SQLAlchemy的使用：</h4> 
<ol><li> <p>初始化和设置数据库配置信息：</p> 
  <ul><li>使用flask_sqlalchemy中的SQLAlchemy进行初始化：<pre><code>from flask_sqlalchemy import SQLAlchemy
app = Flask(__name__)
db = SQLAlchemy(app)
</code></pre> </li></ul> <p><img src="https://images2.imgbox.com/f1/bc/KZDJRF4w_o.png" alt="在这里插入图片描述"></p> </li><li> <p>设置配置信息：在<code>config.py</code>文件中添加以下配置信息：</p> <pre><code># dialect+driver://username:password@host:port/database
DIALECT = 'mysql'
DRIVER = 'mysqldb'
USERNAME = 'root'
PASSWORD = 'root'
HOST = '127.0.0.1'
PORT = '3306'
DATABASE = 'db_demo1'

SQLALCHEMY_DATABASE_URI = "{}+{}://{}:{}@{}:{}/{}?charset=utf8".format(DIALECT,DRIVER,USERNAME,PASSWORD,HOST
                                             ,PORT,DATABASE)

SQLALCHEMY_TRACK_MODIFICATIONS = False
</code></pre> </li><li> <p>在主<code>app</code>文件中，添加配置文件：</p> <pre><code>app = Flask(__name__)
app.config.from_object(config)
db = SQLAlchemy(app)
</code></pre> </li><li> <p>做测试，看有没有问题：</p> <pre><code>db.create_all()
</code></pre> <p>如果没有报错，说明配置没有问题，如果有错误，可以根据错误进行修改。</p> </li></ol> 
<h4><a id="24FlaskSQLAlchemy_541"></a>24使用Flask-SQLAlchemy创建模型与表的映射：</h4> 
<p>一张表就是一个模型</p> 
<ol><li>模型需要继承自<code>db.Model</code>，然后需要映射到表中的属性，必须写成<code>db.Column</code>的数据类型。</li><li>数据类型： 
  <ul><li><code>db.Integer</code>代表的是整形.</li><li><code>db.String</code>代表的是<code>varchar</code>，需要指定最长的长度。</li><li><code>db.Text</code>代表的是<code>text</code>。</li></ul> </li><li>其他参数： 
  <ul><li><code>primary_key</code>：代表的是将这个字段设置为主键。</li><li><code>autoincrement</code>：代表的是这个主键为自增长的。</li><li><code>nullable</code>：代表的是这个字段是否可以为空，默认可以为空，可以将这个值设置为<code>False</code>，在数据库中，这个值就不能为空了。</li></ul> </li></ol> 
<p><img src="https://images2.imgbox.com/cf/da/1lrSG8HF_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-go">   class <span class="token function">Article</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    __tablename__<span class="token operator">=</span><span class="token string">'article'</span>
    id<span class="token operator">=</span>db<span class="token punctuation">.</span><span class="token function">Column</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>Integer<span class="token punctuation">,</span>primary_key<span class="token operator">=</span>True<span class="token punctuation">,</span>autoincrement<span class="token operator">=</span>True<span class="token punctuation">)</span>
    title<span class="token operator">=</span>db<span class="token punctuation">.</span><span class="token function">Column</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>nullable<span class="token operator">=</span>False<span class="token punctuation">)</span>
    content<span class="token operator">=</span>db<span class="token punctuation">.</span><span class="token function">Column</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>Text<span class="token punctuation">,</span>nullable<span class="token operator">=</span>False<span class="token punctuation">)</span>

db<span class="token punctuation">.</span><span class="token function">create_all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-go">cmd中

create database test_demo charset utf8
use test_demo<span class="token punctuation">;</span>
 show tables<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-go"> __tablename__   加下划线表示被保护字段
</code></pre> 
<p>在数据库应用中，我们经常需要用到自动递增的唯一编号来标识记录。在MySQL中，可通过数据列的auto_increment属性来自动生成。可在建表时可用“auto_increment=n”选项来指定一个自增的初始值。可用“alter table table_name auto_increment=n”命令来重设自增的起始值，当然在设置的时候Mysql会取数据表中auto_increment列的最大值 + 1与n中的较大者作为新的auto_increment值。</p> 
<ol start="4"><li>最后需要调用<code>db.create_all</code>来将模型真正的创建到数据库中。</li></ol> 
<h4><a id="25FlaskSQLAlchemysession_584"></a>25Flask-SQLAlchemy数据的增、删、改、查：通过session字段</h4> 
<ol><li> <p>增：</p> <pre><code>

# 增加：
article1 = Article(title='aaa',content='bbb')
db.session.add(article1)
# 事务
db.session.commit()
</code></pre> </li><li> <p>查：</p> <pre><code> 
# select * from article where article.title='aaa';
article1 = Article.query.filter(Article.title == 'aaa').first()
#没有first（）的话 返回的是一个query对象 相当于一个list 其实 Article.query.filter(Article.title == 'aaa')的地层就是sql语句 select * from article where article.title='aaa';
print 'title:%s' % article1.title
print 'content:%s' % article1.content
</code></pre> </li><li> <p>改：</p> <pre><code># 改：
# 1. 先把你要更改的数据查找出来
article1 = Article.query.filter(Article.title == 'aaa').first()
# 2. 把这条数据，你需要修改的地方进行修改
article1.title = 'new title'
# 3. 做事务的提交
db.session.commit()
</code></pre> </li><li> <p>删：</p> <pre><code># 删
# 1. 把需要删除的数据查找出来
article1 = Article.query.filter(Article.content == 'bbb').first()
# 2. 把这条数据删除掉
db.session.delete(article1)
# 3. 做事务提交
db.session.commit()
</code></pre> </li></ol> 
<p>cmd中</p> 
<pre><code class="prism language-go">create database test_demo charset utf8
use test_demo<span class="token punctuation">;</span>
 show tables<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> from article<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="26FlaskSQLAlchemy_634"></a>26Flask-SQLAlchemy外键及其关系：</h4> 
<p>1.外键：</p> 
<pre><code>```
class User(db.Model):
    __tablename__ = 'user'
    id = db.Column(db.Integer,primary_key=True,autoincrement=True)
    username = db.Column(db.String(100),nullable=False)

class Article(db.Model):
    __tablename__ = 'article'
    id = db.Column(db.Integer, primary_key=True, autoincrement=True)
    title = db.Column(db.String(100),nullable=False)
    content = db.Column(db.Text,nullable=False)
    author_id = db.Column(db.Integer,db.ForeignKey('user.id'))

    author = db.relationship('User',backref=db.backref('articles'))#重点新加的 为了方便访问谋篇文章的作者
```
</code></pre> 
<ol start="2"><li><code>author = db.relationship('User',backref=db.backref('articles'))</code>解释： 
  <ul><li>给<code>Article</code>这个模型添加一个<code>author</code>属性，可以访问这篇文章的作者的数据，像访问普通模型一样。 第一个参数User是模型名字，他会关联到Article中和User中有关的外键。</li><li><code>backref</code>是定义反向引用，可以通过<code>User.articles</code>访问这个模型所写的所有文章。即可以用过author访问这个作者的所有文章<br> <img src="https://images2.imgbox.com/2d/5e/rXalfZYi_o.png" alt="在这里插入图片描述"></li></ul> </li></ol> 
<pre><code class="prism language-go">如上图访问aaa这篇文章的作者现在只需要两行代码
打印结果：username：zhiliao
</code></pre> 
<p>config.py如下：<img src="https://images2.imgbox.com/47/79/lsgsDAKJ_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/07/09/2tOwcK81_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/de/7c/snQUeKTG_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>//如上 如果想要找文章标题为aaa的作者 就先要找文章标题为aaa的article 用这个article找这个文章的作者id<br> 再用这个作者id去user中找user.name 这样过于麻烦</p> 
</blockquote> 
<blockquote> 
 <p>希望可以方便的使用 如下直接用article.author找到作者 如果想要找这个作者其他的文章 可以用后面两句</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/34/6d/Q2lOFtFi_o.png" alt="在这里插入图片描述"><br> 如果需要在表中添加新的字段 比如在user中添加password的字段 你需要新建先drop tables user;然后才能db.create_all() 否则mysql不会显示新的字段因为db.create_all() 只能被创建一次</p> 
<p><img src="https://images2.imgbox.com/67/19/34uplf9T_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-go">如上图： article<span class="token punctuation">.</span>author<span class="token operator">=</span>User<span class="token punctuation">.</span>query<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span>id<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
可以替代article<span class="token operator">=</span>Article（author<span class="token punctuation">.</span>id<span class="token operator">==</span><span class="token number">1</span>）
</code></pre> 
<p><img src="https://images2.imgbox.com/dd/d7/AitOg5vO_o.png" alt=" "><br> 打印结果：<img src="https://images2.imgbox.com/1e/8c/cTYRmtq2_o.png" alt="在这里插入图片描述"></p> 
<p>2.多对多：<br> <img src="https://images2.imgbox.com/16/ba/yszWP5M6_o.png" alt="在这里插入图片描述"><br> 如上图以sql语句为例 article_tag为中间表</p> 
<p>以下为对应的模型 记得添加relationship 使得三张表可以产生关联 因为需要中间表 所以有了 secondary=article_tag<br> <img src="https://images2.imgbox.com/f0/2a/ui1RoB3x_o.png" alt="在这里插入图片描述"></p> 
<p>article_tag为中间表<img src="https://images2.imgbox.com/70/5d/5YuFWs8I_o.png" alt="在这里插入图片描述"></p> 
<pre><code>* 多对多的关系，要通过一个中间表进行关联。
* 中间表，不能通过`class`的方式实现，只能通过`db.Table`的方式实现。
* 设置关联：`tags = db.relationship('Tag',secondary=article_tag,backref=db.backref('articles'))`需要使用一个关键字参数`secondary=中间表`来进行关联。
* 访问和数据添加可以通过以下方式进行操作：
* 因为一篇文章可以使用多种标签 每种标签也可以被多篇文章使用
    - 添加数据：
        ```
        article1 = Article(title='aaa')
        article2 = Article(title='bbb')

        tag1 = Tag(name='111')
        tag2 = Tag(name='222')

        article1.tags.append(tag1)
        article1.tags.append(tag2)

        article2.tags.append(tag1)
        article2.tags.append(tag2)

        db.session.add(article1)
        db.session.add(article2)

        db.session.add(tag1)
        db.session.add(tag2)

        db.session.commit()
        ```
    - 访问数据：访问标题为aaa文章内的所有标签的标签名字
        ```
        article1 = Article.query.filter(Article.title == 'aaa').first()
        tags = article1.tags
        for tag in tags:
            print tag.name
打印结果：
111
222
        ```
</code></pre> 
<p><img src="https://images2.imgbox.com/70/ab/7Koit6jT_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="27FlaskScript_744"></a>27Flask-Script的介绍与安装：</h4> 
<ol><li>Flask-Script：Flask-Script的作用是可以通过命令行的形式来操作Flask。例如通过命令跑一个开发版本的服务器、设置数据库，定时任务等。</li><li>安装：首先进入到虚拟环境中，然后<code>pip install flask-script</code>来进行安装。</li><li>如果直接在主<code>manage.py</code>中写命令，那么在终端就只需要<code>python manage.py command_name</code>就可以了。</li><li>如果把一些命令集中在一个文件中，那么在终端就需要输入一个父命令，比如<code>python manage.py db init</code>。</li><li>例子：<br> 模仿manage.py 以下为manage.py文件：<pre><code>from flask_script import Manager
from flask_script_demo import app
from db_scripts import DBManager
manager = Manager(app)
# 和数据库相关的操作，我都放在一起  
@manager.command   #此为装饰器
def runserver():
    print '服务器跑起来了!!!!!'
    
manager.add_command('db',DBManager)
#db是命令前缀   cmd输入 python manage.py db init
#cmd中显示"数据库完成初始化"

if __name__ == '__main__':
    manager.run()
</code></pre> </li></ol> 
<p>效果如下<br> <img src="https://images2.imgbox.com/fc/38/Ijljb2Vg_o.png" alt="在这里插入图片描述"></p> 
<ol start="6"><li>有子命令的例子：<pre><code>db_scripts文件：
#encoding: utf-8

from flask_script import Manager

DBManager = Manager()

@DBManager.command
def init():
    print '数据库初始化完成'

@DBManager.command
def migrate():
    print '数据表迁移成功'
</code></pre> </li></ol> 
<h4><a id="28models_791"></a>28分开<code>models</code>以及解决循环引用：</h4> 
<p><img src="https://images2.imgbox.com/31/84/WKjr8yVr_o.png" alt="在这里插入图片描述"></p> 
<p>如上图出现循环引用将其修改为以下部分<br> <img src="https://images2.imgbox.com/f9/24/yvGzjjPm_o.png" alt="在这里插入图片描述"></p> 
<ol><li>分开models的目的：为了让代码更加方便的管理。</li><li>如何解决循环引用：把<code>db</code>放在一个单独的文件中（exts），切断循环引用的线条就可以了。</li></ol> 
<p>exts.py<img src="https://images2.imgbox.com/ad/b3/ri6Tpr1L_o.png" alt="在这里插入图片描述"></p> 
<p>models_sep.py（相当于app.py文件)<br> 其中db.init_app(app) 相当于db=SQLAlchemy（）绑定了这个app<img src="https://images2.imgbox.com/3f/a2/jj7PQaoF_o.png" alt="在这里插入图片描述"></p> 
<p>Model.py<br> <img src="https://images2.imgbox.com/3f/74/ddy3ztJx_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="29FlaskMigrate_811"></a>29Flask-Migrate的介绍与安装：</h4> 
<p>exts.py<br> <img src="https://images2.imgbox.com/00/ee/XzYuylMr_o.png" alt="在这里插入图片描述"></p> 
<p>Models.py<br> <img src="https://images2.imgbox.com/82/77/QRHeJdVH_o.png" alt="在这里插入图片描述"><br> migrate_demo.py<br> <img src="https://images2.imgbox.com/78/c9/qit88dXp_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">如果没有
with app<span class="token punctuation">.</span><span class="token function">app_context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>手动将app推到app栈中
   db<span class="token punctuation">.</span><span class="token function">create_all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

即使有db<span class="token punctuation">.</span><span class="token function">init_app</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span>绑定也会不会访问到这个app，
因为没有访问视图函数相当于没有访问这个服务器 ，
这时候这个app并不在app栈中， 
所以db<span class="token punctuation">.</span><span class="token function">init_app</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span> db访问不到app如下图  。
所以需要用with app<span class="token punctuation">.</span><span class="token function">app_context</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 手动将app推到app上下文的这个栈中

</code></pre> 
<p><img src="https://images2.imgbox.com/76/08/rxK03kXH_o.png" alt="在这里插入图片描述"></p> 
<ol><li> <p>介绍：因为采用<code>db.create_all</code>在后期修改字段的时候，不会自动的映射到数据库中，必须删除表，然后重新运行<code>db.craete_all</code>才会重新映射，这样不符合我们的 需求。(因为之前有的数据都会被清空,不符合实际需求)因此flask-migrate就是为了解决这个问题，她可以在每次修改模型后，可以将修改的东西映射到数据库中。</p> </li><li> <p>首先进入到你的虚拟环境中，然后使用<code>pip install flask-migrate</code>进行安装就可以了。（或者直接在pycharm的setting的python interpreter中安装）<img src="https://images2.imgbox.com/85/23/ge8rjj7u_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用<code>flask_migrate</code>必须借助<code>flask_scripts</code>，这个包的<code>MigrateCommand</code>中包含了所有和数据库相关的命令。</p> </li><li> <p><code>flask_migrate</code>相关的命令：<br> 第一步 * <code>python manage.py db init</code>：初始化一个迁移脚本的环境，只需要执行一次。<br> 第二步 * <code>python manage.py db migrate</code>：将模型生成迁移文件，只要模型更改了，就需要执行一遍这个命令。<br> 第三步 * <code>python manage.py db upgrade</code>：将迁移文件真正的映射到数据库中。每次运行了<code>migrate</code>命令后，就记得要运行这个命令。</p> </li><li> <p>注意点：需要将你想要映射到数据库中的模型，都要导入到<code>manage.py</code>文件中，如果没有导入进去，就不会映射到数据库中。</p> </li><li> <p><code>manage.py</code>的相关代码：</p> <pre><code>from flask_script import Manager
from migrate_demo import app
from flask_migrate import Migrate,MigrateCommand
from exts import db
from models import Article#要把需要映射的模型导入

# init  这样会在左侧产生一个migration文件夹
# migrate  将Article这个模型生成迁移文件
# upgrade  把迁移文件真的映射到表中
# 模型  -&gt;  迁移文件  -&gt;  表

manager = Manager(app)

# 1. 要使用flask_migrate，必须绑定app和db
migrate = Migrate(app,db)

# 2. 把MigrateCommand命令添加到manager中
manager.add_command('db',MigrateCommand)

if __name__ == '__main__':
    manager.run()
</code></pre> </li></ol> 
<pre><code class="prism language-c">在cmd中venv虚拟环境下的命令：
python manage<span class="token punctuation">.</span>py db<span class="token punctuation">.</span>init
python manage<span class="token punctuation">.</span>py db migrate
python manage<span class="token punctuation">.</span>py db upgrade
</code></pre> 
<pre><code class="prism language-c">注意：当在model<span class="token punctuation">.</span>py中的类添加了新的行记录时候 
之后就进行migrate和upgrade即可不用init 

且用了migrate相关命令后就不用
 with app<span class="token punctuation">.</span><span class="token function">app_context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
   db<span class="token punctuation">.</span><span class="token function">create_all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="30_cookiesession_890"></a>30 cookie和session</h3> 
<h4><a id="cookie_892"></a>cookie：</h4> 
<ol><li><code>cookie</code>出现的原因：在网站中，http请求是无状态的。也就是说即使第一次和服务器连接后并且登录成功后，第二次请求服务器依然不能知道当前请求是哪个用户。cookie的出现就是为了解决这个问题，第一次登录后服务器返回一些数据（cookie）给浏览器，然后浏览器保存在本地，当该用户发送第二次请求的时候，就会自动的把上次请求存储的cookie数据自动的携带给服务器，服务器通过浏览器携带的数据就能判断当前用户是哪个了。</li><li>如果服务器返回了<code>cookie</code>给浏览器，那么浏览器下次再请求相同的服务器的时候，就会自动的把<code>cookie</code>发送给浏览器，这个过程，用户根本不需要管。</li><li><code>cookie</code>是保存在浏览器中的，相对的是浏览器。<br> 注意：cookie是存储数据的一种格式 ，相当于一种盒子，盒子里面有很多数据<br> <img src="https://images2.imgbox.com/01/30/xmHSUqqM_o.png" alt="在这里插入图片描述"></li></ol> 
<h4><a id="session_902"></a>session：</h4> 
<ol><li> <p><code>session</code>介绍：session和cookie的作用有点类似，都是为了存储用户相关的信息。不同的是，cookie是存储在本地浏览器，而session存储在服务器。存储在服务器的数据会更加的安全，不容易被窃取。但存储在服务器也有一定的弊端，就是会占用服务器的资源，但现在服务器已经发展至今，一些session信息还是绰绰有余的。</p> </li><li> <p>使用<code>session</code>的好处：</p> 
  <ul><li>敏感数据不是直接发送回给浏览器，而是发送回一个<code>session_id</code>，服务器将<code>session_id</code>和敏感数据做一个映射存储在<code>session</code>(在服务器上面)中，更加安全。</li><li><code>session</code>可以设置过期时间，也从另外一方面，保证了用户的账号安全。<br> 注意：cookie和session是共同存在的<br> 下图为一般session的工作机制 但flask中的session与其稍有不同<br> <img src="https://images2.imgbox.com/90/e8/7ZEQOXLC_o.png" alt="在这里插入图片描述"></li></ul> </li></ol> 
<h4><a id="31flasksession_912"></a>31flask中的session工作机制：</h4> 
<ol><li>flask中的session机制是：把敏感数据经过加密后放入<code>session</code>中，然后再把<code>session</code>存放到<code>cookie</code>中，下次请求的时候，再从浏览器发送过来的<code>cookie</code>中读取<code>session</code>，然后再从<code>session</code>中读取敏感数据，并进行解密，获取最终的用户数据。</li><li>flask的这种<code>session</code>机制，可以节省服务器的开销，因为把所有的信息都存储到了客户端（浏览器）。</li><li>安全是相对的，把<code>session</code>放到<code>cookie</code>中，经过加密，也是比较安全的，这点大家放心使用就可以了。<br> 顺序1用户密码 2session 3cookie返回给浏览器<br> <img src="https://images2.imgbox.com/2e/56/BM6ErxAK_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/58/e7/4ndrY9co_o.png" alt="在这里插入图片描述"></li></ol> 
<h4><a id="32session_923"></a>32操作session：</h4> 
<ol><li>session的操作方式： 
  <ul><li> <p>使用<code>session</code>需要从<code>flask</code>中导入<code>session</code>，以后所有和<code>sessoin</code>相关的操作都是通过这个变量来的。from flask import session</p> </li><li> <p>使用<code>session</code>需要设置<code>SECRET_KEY</code>，用来作为加密用的。并且这个<code>SECRET_KEY</code>如果每次服务器启动后都变化的话，那么之前的<code>session</code>就不能再通过当前这个<code>SECRET_KEY</code>进行解密了。（因为每次重启服务器24位字符是随机的每次都不同 所以可以把 SECRET_KEY写死而不是每次都随机产生）<br> SECRET_KEY是24个字符的字符串在config.py设置。如果不想在config.py内设置，也可以直接在app.py内设置。<code>app.config['SECRET_KEY']=os.urandom(24)</code></p> </li><li> <p>操作<code>session</code>的时候，跟操作字典是一样的。</p> </li><li> <p>添加<code>session</code>：<code>session['username']</code>。</p> </li><li> <p>删除：<code>session.pop('username')</code>或者<code>del session['username']</code>。</p> </li><li> <p>清除所有<code>session</code>：<code>session.clear()</code></p> </li><li> <p>获取<code>session</code>：<code>session.get('username')</code><br> <img src="https://images2.imgbox.com/23/4a/kTOjB72E_o.png" alt="在这里插入图片描述"></p> </li></ul> </li></ol> 
<p>下图验证了session放在cookie中且经过了加密<br> <img src="https://images2.imgbox.com/22/70/aU38POkr_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="33session_940"></a>33设置session的过期时间：</h3> 
<ul><li> <p>如果没有指定session的过期时间，那么默认是浏览器关闭后就自动结束</p> </li><li> <p>如果设置了session的permanent属性为True，那么过期时间是31天。<code>session.permanent=True</code><br> <img src="https://images2.imgbox.com/3a/09/R2eonWU3_o.png" alt="在这里插入图片描述"><br> 相当于用户选择记住我的时候，让这个 session.permanent=True</p> </li><li> <p>可以通过给<code>app.config</code>设置<code>PERMANENT_SESSION_LIFETIME</code>来更改过期时间，这个值的数据类型是<code>datetime.timedelay</code>类型。</p> </li></ul> 
<pre><code class="prism language-bash">或者直接写在app.py中：
from datetime <span class="token function">import</span> timedelta
app.config<span class="token punctuation">[</span><span class="token string">'PERMANENT_SESSION_LIFETIME'</span><span class="token punctuation">]</span><span class="token operator">=</span>timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span>7<span class="token punctuation">)</span><span class="token comment">#7天后才结束session</span>
</code></pre> 
<h4><a id="34getpost_959"></a>34get请求和post请求：</h4> 
<ol><li>get请求： 
  <ul><li>使用场景：如果只对服务器获取数据，并没有对服务器产生任何影响，那么这时候使用get请求。</li><li>传参：get请求传参是放在url中，并且是通过<code>?</code>的形式来指定key和value的。</li></ul> </li><li>post请求： 
  <ul><li>使用场景：如果要对服务器产生影响，那么使用post请求。</li><li>传参：post请求传参不是放在url中，是通过<code>form data</code>的形式发送给服务器的。比如登录页面，输入账号和密码之后需要将数据传给session然后保存，session在服务器上面，对服务器产生影响</li><li><img src="https://images2.imgbox.com/4b/e7/qMmwbSKF_o.png" alt="在这里插入图片描述"></li></ul> </li></ol> 
<p>如图,q为查询的关键字，反转回来的url为：/search/?q=hello <img src="https://images2.imgbox.com/c5/3a/oX6nX0UN_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/43/d6/bdQr4FOp_o.png" alt="在这里插入图片描述"></p> 
<p>request.args可以获取传进来的所有参数<br> <img src="https://images2.imgbox.com/ec/c7/uXJFExvQ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/2e/90/GtqXqhnj_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/64/5d/iaxGpjKL_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="35getpost_985"></a>35get和post请求获取参数：</h4> 
<ol><li> <p>get请求是通过<code>flask.request.args</code>来获取。request.args.get（‘q’）</p> </li><li> <p>post请求是通过<code>flask.request.form</code>来获取。request.form.get（‘q’）<br> <img src="https://images2.imgbox.com/7a/17/H6NecN6J_o.png" alt="在这里插入图片描述"></p> </li><li> <p>post请求在模板中要注意几点：</p> 
  <ul><li>input标签中，要写name来标识这个value的key，方便后台获取。如name='username’等</li><li>在写form表单的时候，要指定<code>method='post'</code>，并且要指定<code>action='/login/'</code>。（指定action就是要把数据提交到哪个url上面）</li><li><img src="https://images2.imgbox.com/b5/87/u8Izyr25_o.png" alt="在这里插入图片描述"></li></ul> </li><li> <p>示例代码：</p> <pre><code>    &lt;form action="{<!-- -->{ url_for('login') }}" method="post"&gt;
        &lt;table&gt;
            &lt;tbody&gt;
                &lt;tr&gt;
                    &lt;td&gt;用户名：&lt;/td&gt;
                    &lt;td&gt;&lt;input type="text" placeholder="请输入用户名" name="username"&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td&gt;密码：&lt;/td&gt;
                    &lt;td&gt;&lt;input type="text" placeholder="请输入密码" name="password"&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;input type="submit" value="登录"&gt;&lt;/td&gt;
                &lt;/tr&gt;
            &lt;/tbody&gt;
        &lt;/table&gt;
    &lt;/form&gt;
</code></pre> </li></ol> 
<h4><a id="36g_1026"></a>36保存全局变量的g属性：</h4> 
<p>g：global</p> 
<ol><li>g对象是专门用来保存用户的数据的。</li><li>g对象在一次请求中的所有的代码的地方，都是可以使用的。<br> from flask import Flask</li></ol> 
<p>以下证明g是个全局变量 在login_log中也可以使用<br> <img src="https://images2.imgbox.com/cd/a2/5vB6rYVN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ee/b1/nuJOTpjU_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/94/1f/zExJek5z_o.png" alt="在这里插入图片描述"></p> 
<p>简单模拟：<br> <img src="https://images2.imgbox.com/fe/9c/UbJBdUHd_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a4/96/KJTgOsil_o.png" alt="在这里插入图片描述"><br> 注意：g对象在一次请求中的所有的代码的地方可以使用，是一次如果再次请求g是不存在的，会重新创建一份g，如下图当浏览器把用户名和密码传给服务器时候，这时候g和username绑定为zhiliaoketang，当服务器传回给浏览器的时候g就消失了，当浏览器再次请求服务器的时候g会被重新创建<img src="https://images2.imgbox.com/9b/0b/YRZk6TYn_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="37hook_1045"></a>37钩子函数（hook）：</h4> 
<p>正常是执行函数是AB 有了钩子函数C 变ACB<br> <img src="https://images2.imgbox.com/8b/23/ogPiTMfw_o.png" alt="在这里插入图片描述"></p> 
<ol><li>before_request： 
  <ul><li>在请求之前执行的</li><li>是在视图函数执行之前执行的</li><li>这个函数只是一个装饰器，他可以把需要设置为钩子函数的代码放到视图函数执行之前来执行<br> <img src="https://images2.imgbox.com/b6/df/RqiXyujF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0d/f7/VKVNfBmr_o.png" alt="在这里插入图片描述"><br> 可以看出before_request 在视图函数之前执行，本来应该是顺序执行，现在有before_request 这个钩子函数<br> 就变成hello_world-&gt;before_request -&gt;login<br> <img src="https://images2.imgbox.com/de/78/FRHufY2r_o.png" alt="在这里插入图片描述"></li></ul> </li></ol> 
<p><img src="https://images2.imgbox.com/21/98/sYpWA3e7_o.png" alt="在这里插入图片描述"><br> 如果session可以获取username 则返回修改成功 如果把session删除就返回login<br> <img src="https://images2.imgbox.com/53/5c/WcE1wX4e_o.png" alt="在这里插入图片描述"><br> 在每次执行视图函数之前 都用钩子函数把这些查询工作做完 就不用在视图函数里查找这样就节省性能</p> 
<ol start="2"><li>context_processor： 
  <ul><li>上下文处理器应该返回一个字典。字典中的<code>key</code>会被模板中当成变量来渲染。</li><li>上下文处理器中返回的字典，在所有页面中都是可用的。如下图上下文处理器返回的‘username’在所有html中都可以使用这个参数{<!-- -->{username}} 但是可以不必再html中写出</li><li>被这个装饰器修饰的钩子函数，必须要返回一个字典，即使为空也要返回。<br> <img src="https://images2.imgbox.com/a6/0f/6TK1xwIJ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f8/09/FOAQZK4f_o.png" alt="在这里插入图片描述"></li></ul> </li></ol> 
<p>index.html处没有穿username的参数 但是因为有context_processor也有了username这个参数</p> 
<h3><a id="38_1076"></a>38装饰器</h3> 
<p><img src="https://images2.imgbox.com/7b/32/lZDq0J7q_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/88/12/NYuuEvrL_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b6/2f/akGqH2zL_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d8/30/hHQNRz5t_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/ff/ee/eoG5Xe6T_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="1_1084"></a>实战1项目构架</h3> 
<pre><code class="prism language-bash"><span class="token function">cd</span>  D:\PycharmProjects\flaskProject
d:
<span class="token function">cd</span> venv
<span class="token function">cd</span> Scripts
activate
cd<span class="token punctuation">..</span>
cd<span class="token punctuation">..</span>
python manage.py  runserver
</code></pre> 
<p>1创建一个flask项目<br> 2建立config.py<br> 同时在app.py中要有</p> 
<pre><code class="prism language-bash"><span class="token function">import</span> config
app.config.from_object
</code></pre> 
<p><img src="https://images2.imgbox.com/df/3d/nYmQ0BkV_o.png" alt="在这里插入图片描述"><br> 3连接mysql <code>create database t_demo charset utf8;</code> 创建数据表<br> 4建立exts 存放db<br> <img src="https://images2.imgbox.com/54/fe/pQdzS0Jq_o.png" alt="在这里插入图片描述"><br> 5存放models建立models.py <code>from exts import db</code><br> 6构建manage.py 存放在终端显示的脚本<br> <img src="https://images2.imgbox.com/32/b6/N4ba8l1Z_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">from flask_script <span class="token function">import</span> Manager
from flask_migrate <span class="token function">import</span> Migrate,MigrateCommand
from app <span class="token function">import</span> app
from exts <span class="token function">import</span> db
from models <span class="token function">import</span> User


manager <span class="token operator">=</span> Manager<span class="token punctuation">(</span>app<span class="token punctuation">)</span>

<span class="token comment"># 使用Migrate绑定app和db</span>
migrate <span class="token operator">=</span> Migrate<span class="token punctuation">(</span>app,db<span class="token punctuation">)</span>

<span class="token comment"># 添加迁移脚本的命令到manager中</span>
manager.add_command<span class="token punctuation">(</span><span class="token string">'db'</span>,MigrateCommand<span class="token punctuation">)</span>



<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token keyword">:</span>
    manager.run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2_1136"></a>2导航条完成</h3> 
<p>bootstrap：网站www.bootcss.com</p> 
<p><img src="https://images2.imgbox.com/2c/cf/EhiCr4hX_o.png" alt="在这里插入图片描述">导入加速服务 一般就引入css和js 复制官网的即可<br> 但是引入js前面添加 juery</p> 
<pre><code class="prism language-bash"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>/script<span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5e/ac/hJRxrWGm_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash"><span class="token operator">&lt;</span><span class="token operator">!</span>-- 最新版本的 Bootstrap 核心 CSS 文件 --<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"</span> integrity<span class="token operator">=</span><span class="token string">"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"</span> crossorigin<span class="token operator">=</span><span class="token string">"anonymous"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span>-- 可选的 Bootstrap 主题文件（一般不用引入） --<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap-theme.min.css"</span> integrity<span class="token operator">=</span><span class="token string">"sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp"</span> crossorigin<span class="token operator">=</span><span class="token string">"anonymous"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span>-- 最新的 Bootstrap 核心 JavaScript 文件 --<span class="token operator">&gt;</span>
 
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"</span> integrity<span class="token operator">=</span><span class="token string">"sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"</span> crossorigin<span class="token operator">=</span><span class="token string">"anonymous"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>/script<span class="token operator">&gt;</span>
</code></pre> 
<p>在body内复制导航条的模板<br> 在static下面建立images和css文件夹<br> css用来调节各种html中的样式 字体等等<br> <img src="https://images2.imgbox.com/38/4e/Ajuw1eyn_o.png" alt="在这里插入图片描述"><br> 且要引入link css文件 <img src="https://images2.imgbox.com/c8/dd/maSboLPm_o.png" alt="在这里插入图片描述"></p> 
<p>index.css如下<img src="https://images2.imgbox.com/cd/4e/x2DZNUTO_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/15/70/FXGpAdR5_o.png" alt="在这里插入图片描述"><br> 会使得导航条的左右两边会留一些空隙</p> 
<h3><a id="3_1171"></a>3父模板分离</h3> 
<p>base.html<br> 同时也要建立base.css<br> <img src="https://images2.imgbox.com/f0/74/n286JDGS_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_1176"></a>4登录页面</h3> 
<p>在login.html</p> 
<pre><code class="prism language-bash"><span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('login') }}"</span><span class="token operator">&gt;</span>登录<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
</code></pre> 
<p>且在base.css中加入样式</p> 
<pre><code class="prism language-bash">.logo<span class="token punctuation">{<!-- --></span>
    width: 50px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

body<span class="token punctuation">{<!-- --></span>
    background: <span class="token comment">#f3f3f3;</span>
<span class="token punctuation">}</span>

.main<span class="token punctuation">{<!-- --></span>
    background: <span class="token comment">#fff;</span>
    width: 730px<span class="token punctuation">;</span>
    margin: 0 auto<span class="token punctuation">;</span>
    overflow: hidden<span class="token punctuation">;</span>
    padding: 10px<span class="token punctuation">;</span><span class="token comment">#上下添加边距</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在login-regist .html加样式<br> 选择一个登陆的输入框，表单</p> 
<pre><code class="prism language-bash"><span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">""</span> method<span class="token operator">=</span><span class="token string">"POST"</span><span class="token operator">&gt;</span><span class="token comment">#action默认当前页面</span>
        <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-container"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">&gt;</span>
                

                <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> class<span class="token operator">=</span><span class="token string">"form-control"</span> placeholder<span class="token operator">=</span><span class="token string">"手机号码"</span> name<span class="token operator">=</span><span class="token string">"telephone"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"password"</span> class<span class="token operator">=</span><span class="token string">"form-control"</span> placeholder<span class="token operator">=</span><span class="token string">"密码"</span> name<span class="token operator">=</span><span class="token string">"password"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>button class<span class="token operator">=</span><span class="token string">"btn btn-primary btn-block"</span><span class="token operator">&gt;</span>登录<span class="token operator">&lt;</span>/button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token comment">#app.py</span>
@app.route<span class="token punctuation">(</span><span class="token string">'/login/'</span>,method<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span>,<span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
def login<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    <span class="token keyword">if</span> request.method<span class="token operator">==</span><span class="token string">'GET'</span><span class="token keyword">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">)</span>
    else:
        telephone<span class="token operator">=</span>request.form.get<span class="token punctuation">(</span><span class="token string">'telephone'</span><span class="token punctuation">)</span>
        password<span class="token operator">=</span>request.form.get<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span>
        user<span class="token operator">=</span>User.query.filter<span class="token punctuation">(</span>User.telephone<span class="token operator">==</span>telephone,User.password<span class="token operator">==</span>password<span class="token punctuation">)</span>.first<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> user:
            session<span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">]</span><span class="token operator">=</span>user.id
            session.permanent<span class="token operator">=</span>True
            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">))</span>
        <span class="token keyword">else</span>
            <span class="token keyword">return</span> u<span class="token string">'手机或密码错误请确认后再登录'</span>
</code></pre> 
<h3><a id="5_1238"></a>5注册页面</h3> 
<p>regist.html</p> 
<pre><code class="prism language-bash"><span class="token punctuation">{<!-- --></span>% block <span class="token function">head</span> %<span class="token punctuation">}</span><span class="token comment">#控制这些边框的样式</span>
    <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('static',filename='css/login_regist.css') }}"</span><span class="token operator">&gt;</span>
<span class="token punctuation">{<!-- --></span>% endblock %<span class="token punctuation">}</span>

<span class="token punctuation">{<!-- --></span>% block main %<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>h3 class<span class="token operator">=</span><span class="token string">"page-title"</span><span class="token operator">&gt;</span>注册<span class="token operator">&lt;</span>/h3<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">""</span> method<span class="token operator">=</span><span class="token string">"POST"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-container"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> class<span class="token operator">=</span><span class="token string">"form-control"</span> placeholder<span class="token operator">=</span><span class="token string">"手机号码"</span> name<span class="token operator">=</span><span class="token string">"telephone"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
            <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> msg3 <span class="token punctuation">}</span><span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> class<span class="token operator">=</span><span class="token string">"form-control"</span> placeholder<span class="token operator">=</span><span class="token string">"用户名"</span> name<span class="token operator">=</span><span class="token string">"username"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"password"</span> class<span class="token operator">=</span><span class="token string">"form-control"</span> placeholder<span class="token operator">=</span><span class="token string">"密码"</span> name<span class="token operator">=</span><span class="token string">"password1"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"password"</span> class<span class="token operator">=</span><span class="token string">"form-control"</span> placeholder<span class="token operator">=</span><span class="token string">"确认密码"</span> name<span class="token operator">=</span><span class="token string">"password2"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
            <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> msg4 <span class="token punctuation">}</span><span class="token punctuation">}</span>

            <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> class<span class="token operator">=</span><span class="token string">"col-sm-6"</span> style<span class="token operator">=</span><span class="token string">"height: 33.9px"</span> placeholder<span class="token operator">=</span><span class="token string">"验证码"</span> name<span class="token operator">=</span><span class="token string">"captcha"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group "</span><span class="token operator">&gt;</span>
               <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('pic') }}"</span> alt<span class="token operator">=</span><span class="token string">"图形验证码"</span> class<span class="token operator">=</span><span class="token string">"col-sm-6"</span> style<span class="token operator">=</span><span class="token string">"height: 33.9px"</span> id<span class="token operator">=</span><span class="token string">"pic"</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>#onclick<span class="token operator">=</span><span class="token string">"this.src='/pic/?ran='+ Math.random()"</span>#<span class="token punctuation">}</span>
              <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> msg1 <span class="token punctuation">}</span><span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>

            <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>button class<span class="token operator">=</span><span class="token string">"btn btn-primary btn-block"</span><span class="token operator">&gt;</span>立即注册<span class="token operator">&lt;</span>/button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/form<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="6user_1279"></a>6user模型建立</h3> 
<p>在models.py中创建</p> 
<pre><code class="prism language-bash">class User<span class="token punctuation">(</span>db.Model<span class="token punctuation">)</span>:
    __tablename__<span class="token operator">=</span><span class="token string">'user'</span>
    id<span class="token operator">==</span>db.Column<span class="token punctuation">(</span>db.Integer,primary_key<span class="token operator">=</span>True,autoincrement<span class="token operator">=</span>True<span class="token punctuation">)</span>
    telephone<span class="token operator">=</span>db.Column<span class="token punctuation">(</span>db.String<span class="token punctuation">(</span>11<span class="token punctuation">)</span>,nullable<span class="token operator">=</span>False<span class="token punctuation">)</span>
    username<span class="token operator">=</span>db.Column<span class="token punctuation">(</span>db.String<span class="token punctuation">(</span>50<span class="token punctuation">)</span>,nullable<span class="token operator">=</span>False<span class="token punctuation">)</span>
    password<span class="token operator">=</span>db.Column<span class="token punctuation">(</span>db.String<span class="token punctuation">(</span>100<span class="token punctuation">)</span>,nullable<span class="token operator">=</span>False<span class="token punctuation">)</span>
</code></pre> 
<p>且要在manage.py 把模型导入</p> 
<pre><code class="prism language-bash">from models <span class="token function">import</span> User
</code></pre> 
<p>进入<code>venv /scripts/activate</code> 虚拟环境激活<br> 然后cd…返回到flaskproject <code>python manage.py db.init</code> <code>python manage.py db.migrate</code> <code>python manage.py db.upgrade</code></p> 
<p><em>MYSQL</em></p> 
<pre><code class="prism language-bash"> use zlqt_demo
 show tables<span class="token punctuation">;</span>
 decs user<span class="token punctuation">;</span>
 <span class="token keyword">select</span> * from  user<span class="token punctuation">;</span>//显示所有数据
</code></pre> 
<p><img src="https://images2.imgbox.com/26/35/bMv2aPk1_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/bf/3d/iL4YF4Hn_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/dc/cc/RhlWMFPp_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="7_1312"></a>7注册功能</h3> 
<p>当到达regist这个视图函数的时候 说明已经点击了注册的按钮 且获得了用户名密码手机号等等信息<br> 注意在app.py中导入</p> 
<pre><code class="prism language-bash">from models <span class="token function">import</span> User 
from exts <span class="token function">import</span> db
db.init_app<span class="token punctuation">(</span>app<span class="token punctuation">)</span>  <span class="token comment">#记得初始化db</span>
</code></pre> 
<pre><code class="prism language-bash">@app.route<span class="token punctuation">(</span><span class="token string">'/regist/'</span>,method<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span>,<span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
def regist<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    <span class="token keyword">if</span> request.method<span class="token operator">==</span><span class="token string">'GET'</span><span class="token keyword">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'regist.html'</span><span class="token punctuation">)</span>
    else:
        telephone<span class="token operator">=</span>request.form.get<span class="token punctuation">(</span><span class="token string">'telephone'</span><span class="token punctuation">)</span>
        username<span class="token operator">=</span>request.form.get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span>
        password1<span class="token operator">=</span>request.form.get<span class="token punctuation">(</span><span class="token string">'password1'</span><span class="token punctuation">)</span>
        password2<span class="token operator">=</span>request.form.get<span class="token punctuation">(</span><span class="token string">'password2'</span><span class="token punctuation">)</span>
        
      <span class="token comment">#如果手机号码被注册了  就不能再注册</span>
      user<span class="token operator">=</span>User.query.filter<span class="token punctuation">(</span>User.telephone<span class="token operator">==</span>telephone<span class="token punctuation">)</span>.first<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> user:
            <span class="token keyword">return</span> u<span class="token string">'该号码已被注册，请重新输入'</span>
        <span class="token keyword">else</span>
            <span class="token comment">#手机号码是没被注册过 验证密码1 2是否同</span>
            <span class="token keyword">if</span> password1<span class="token operator">!=</span>password2:
                <span class="token keyword">return</span> u<span class="token string">'两次密码不相同，请重新输入'</span>
	       else：<span class="token comment">#号码 密码均符合将user添加到数据库中</span>
	            user<span class="token operator">=</span>User<span class="token punctuation">(</span>telephone<span class="token operator">=</span>telephone,username<span class="token operator">=</span>username,password<span class="token operator">=</span>password1<span class="token punctuation">)</span>
	            db.session.add<span class="token punctuation">(</span>user<span class="token punctuation">)</span>
	            db.session.commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
	            <span class="token comment">#注册成功跳转到登录页面</span>
	            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">))</span>
</code></pre> 
<h3><a id="8_1350"></a>8登录功能</h3> 
<p>要记得在login.html的input的标签里写上 name=‘xxx’<br> <img src="https://images2.imgbox.com/67/0c/v1KxQKU5_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">@app.route<span class="token punctuation">(</span><span class="token string">'/login/'</span>,method<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span>,<span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
def login<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    <span class="token keyword">if</span> request.method<span class="token operator">==</span><span class="token string">'GET'</span><span class="token keyword">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">)</span>
    else:
        telephone<span class="token operator">=</span>request.form.get<span class="token punctuation">(</span><span class="token string">'telephone'</span><span class="token punctuation">)</span>
        password<span class="token operator">=</span>request.form.get<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span>
        user<span class="token operator">=</span>User.query.filter<span class="token punctuation">(</span>User.telephone<span class="token operator">==</span>telephone,User.password<span class="token operator">==</span>password<span class="token punctuation">)</span>.first<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> user:
            <span class="token comment">#把用户相关信息保存在cookie</span>
            session<span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">]</span><span class="token operator">=</span>user.id
            session.permanent<span class="token operator">=</span>True<span class="token comment">#31天内都不登录</span>
            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">))</span>
        <span class="token keyword">else</span>
            <span class="token keyword">return</span> u<span class="token string">'手机或密码错误请确认后再登录'</span>
</code></pre> 
<h3><a id="9_1373"></a>9注销功能</h3> 
<p>因为登录后页面右上角会显示 <code>欢迎您xxx</code> ， 在所有页面里有会用到，所以就要用上下文处理器 context_processor<br> 注意！要判断用户是否已经登录 所以用session[‘user_id’]来判断 如果存在 则表示之前已经登录过session缓存里面才会有 但是用<code>session.get('user_id')来获取</code>其如果不存在会返回null,不存在会返回null,而用<code>session['user_id']</code>如果不存在会抛出异常</p> 
<pre><code class="prism language-bash">@app.context_processor
def my_context_processor<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    user_id<span class="token operator">=</span>session.get<span class="token punctuation">(</span><span class="token string">'user_id'</span><span class="token punctuation">)</span> <span class="token comment">#session存在id 说明已经登录 则去找获取这个user的信息</span>
    <span class="token keyword">if</span> user_id:
       user<span class="token operator">=</span>User.query.filter<span class="token punctuation">(</span>User.id<span class="token operator">=</span>user.id<span class="token punctuation">)</span>.first<span class="token punctuation">(</span><span class="token punctuation">)</span>
       <span class="token keyword">if</span> user:
         <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token string">'user'</span>:user<span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token comment">#即使用户不是在登录状态也要返回一个空的字典 不能不返回</span>
    
</code></pre> 
<p>登录了显示 <code>欢迎您xxx和注销</code><br> 没登录显示 <code>登录注册</code><br> <img src="https://images2.imgbox.com/d9/28/7G6tpy46_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash"> <span class="token operator">&lt;</span>ul class<span class="token operator">=</span><span class="token string">"nav navbar-nav navbar-right"</span><span class="token operator">&gt;</span>
              <span class="token punctuation">{<!-- --></span>% <span class="token keyword">if</span> user %<span class="token punctuation">}</span>
                  <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('center') }}"</span><span class="token operator">&gt;</span>欢迎您,<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> user.username <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
                  <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('logout') }}"</span><span class="token operator">&gt;</span>注销<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
              <span class="token punctuation">{<!-- --></span>% <span class="token keyword">else</span> %<span class="token punctuation">}</span>
                  <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('login') }}"</span><span class="token operator">&gt;</span>登录<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
                  <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('regist') }}"</span><span class="token operator">&gt;</span>注册<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
              <span class="token punctuation">{<!-- --></span>% endif %<span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>/ul<span class="token operator">&gt;</span>
</code></pre> 
<p>注销功能： 退出登录即session中的这个user_id删除</p> 
<pre><code class="prism language-bash">@app.route<span class="token punctuation">(</span><span class="token string">'/logout/'</span><span class="token punctuation">)</span>
  def logout<span class="token punctuation">(</span><span class="token punctuation">)</span>:
     sesssion.clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">#  sesssion.pop('user_id')</span>
    <span class="token comment"># del sesssion('user_id')</span>
    <span class="token comment">#注销后就跳转到登录页面</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">))</span>
</code></pre> 
<h3><a id="11_1417"></a>11发布问答</h3> 
<p>现在app.py中把question这个视图函数写好</p> 
<pre><code class="prism language-bash">@app.route<span class="token punctuation">(</span><span class="token string">'/question/'</span>,methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span>,<span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
def question<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    <span class="token keyword">if</span> request.method<span class="token operator">==</span><span class="token string">'GET'</span><span class="token keyword">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    else:
       pass
</code></pre> 
<p>然后写question.html</p> 
<pre><code class="prism language-bash"><span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">""</span>,method<span class="token operator">=</span><span class="token string">"post"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>/form<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-container"</span><span class="token operator">&gt;</span>//form-container外面那个大盒子
            <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">&gt;</span>//form-group每个长条都是垂直距离

            <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ea/f5/3cxpo6Y4_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="12_1443"></a>12装饰器详解</h3> 
<p>如果没有登录时 直接按发布问答不可以 需要跳转到登录页面 登录以后才可以发布</p> 
<p>完成这一操作需要先了解装饰器<br> <img src="https://images2.imgbox.com/e4/65/voejLJNy_o.png" alt="在这里插入图片描述">如上图 直接打印hello world可以但是如果有成百上千个函数就很麻烦 所以我们定义一个装饰器（就是函数）<br> <em><strong>装饰器有两个特别之处：（函数进函数出）<br> 1参数是个函数<br> 2返回值是个函数</strong></em></p> 
<p>注意<br> return wrapper 只是返回wrapper这个函数体不执行<br> return wrapper（） 是返回函数执行结束后的结果<br> 以下为实现每个函数前面都执行打印hello world的功能 函数my_log(;func) //参数是个函数返回也是函数wrapper</p> 
<p><img src="https://images2.imgbox.com/d8/bd/zbxhy6rM_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">def my_log<span class="token punctuation">(</span>func<span class="token punctuation">)</span>:
  def wrapper<span class="token punctuation">(</span><span class="token punctuation">)</span>:
     print <span class="token string">'hello world'</span>
     func<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> wrapper


@my_log
def run<span class="token punctuation">(</span><span class="token punctuation">)</span>:
   print<span class="token string">'run'</span>

run<span class="token operator">=</span>my_log<span class="token punctuation">(</span>run<span class="token punctuation">)</span> 

//定义my_log函数后 ，@my_log装饰器写在函数run前面与 run<span class="token operator">=</span>my_log<span class="token punctuation">(</span>run<span class="token punctuation">)</span>等价

my_log返回是wrapper 所以run实际上就是wrapper



run<span class="token punctuation">(</span><span class="token punctuation">)</span>等价于wrapper（）

wrapper（）打印的是hello world且有一个func<span class="token punctuation">(</span><span class="token punctuation">)</span> 
func<span class="token punctuation">(</span><span class="token punctuation">)</span>其实就是run本身
打印run

以上就实现了在每个函数前面都先打印hello world
</code></pre> 
<p><img src="https://images2.imgbox.com/91/60/s5NZCTJO_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/61/d9/OMfW6DUC_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/82/90/dvsW5Nbj_o.png" alt="在这里插入图片描述"></p> 
<p>会报错 因为wrapper没有参数 但是add是有两个参数的 但是wrapper和add又是等价的</p> 
<p>但是run（）没有参数 add（）又需要参数 所以可能出现需要或不需要参数 所以用<code>*args **kwargs</code>他们包含了任何参数<br> 如下 所以这样不管带不带参数都可以解决<br> <img src="https://images2.imgbox.com/4d/b1/jZwAcBOu_o.png" alt="在这里插入图片描述"><br> <code>run.__name__</code>表示的是run这个函数的名称</p> 
<p><img src="https://images2.imgbox.com/2b/0e/yftO8JI7_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f8/cc/kcNJVWvL_o.png" alt="在这里插入图片描述"><br> 有了装饰器后 打印run.__name__应该结果是run但是结果是wrapper 函数名字被改变了</p> 
<p>因为放了装饰器后 因为<code>run=my_log(run)=wrapper</code> 所以run()与wrapper()等价</p> 
<p>为了不改函数名run的结果方法：<br> 再加一个装饰器@wraps()</p> 
<pre><code class="prism language-bash">from functools <span class="token function">import</span> wraps
def my_log<span class="token punctuation">(</span>func<span class="token punctuation">)</span>:
  @wraps<span class="token punctuation">(</span>func<span class="token punctuation">)</span>
  def wrapper<span class="token punctuation">(</span>*args,**kwargs<span class="token punctuation">)</span>:
     print <span class="token string">'hello world'</span>
     func<span class="token punctuation">(</span>*args,**kwargs<span class="token punctuation">)</span>
  <span class="token keyword">return</span> wrapper


@my_log
def run<span class="token punctuation">(</span><span class="token punctuation">)</span>:
   print<span class="token string">'run'</span>

run<span class="token operator">=</span>my_log<span class="token punctuation">(</span>run<span class="token punctuation">)</span> 
</code></pre> 
<p><img src="https://images2.imgbox.com/a0/c0/tPPdO0BN_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash"><span class="token comment">#登录限制的装饰器</span>
def login_required<span class="token punctuation">(</span>func<span class="token punctuation">)</span>:
    @wraps<span class="token punctuation">(</span>func<span class="token punctuation">)</span>
    def wrapper<span class="token punctuation">(</span>*args,**kwargs<span class="token punctuation">)</span>:
        <span class="token keyword">if</span> session.get<span class="token punctuation">(</span><span class="token string">'user_id'</span><span class="token punctuation">)</span>:<span class="token comment">#如果用户登录了</span>
            <span class="token keyword">return</span> func<span class="token punctuation">(</span>*args,**kwargs<span class="token punctuation">)</span><span class="token comment">#返回的是某个页面 记得func前面要加return 不然会产生return render_template('center.html')这样类似的功能</span>
        else:
            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">))</span>
    <span class="token keyword">return</span> wrapper
</code></pre> 
<p>question前面要加装饰器@login_required 使得没有登录的时候不能发布问答 必须跳转到登录页面<img src="https://images2.imgbox.com/94/38/japSsZCA_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="13_1543"></a>13发布问答功能</h3> 
<p>要保存文章的标题 内容所以要建立一张表即模型</p> 
<pre><code class="prism language-bash">class Questio<span class="token punctuation">(</span>db.Model<span class="token punctuation">)</span>:
    __tablename__ <span class="token operator">=</span> <span class="token string">'question'</span>
    <span class="token function">id</span> <span class="token operator">=</span> db.Column<span class="token punctuation">(</span>db.Integer, primary_key<span class="token operator">=</span>True, autoincrement<span class="token operator">=</span>True<span class="token punctuation">)</span>
    title <span class="token operator">=</span> db.Column<span class="token punctuation">(</span>db.String<span class="token punctuation">(</span>100<span class="token punctuation">)</span>, nullable<span class="token operator">=</span>False<span class="token punctuation">)</span>
    content <span class="token operator">=</span> db.Column<span class="token punctuation">(</span>db.Text, nullable<span class="token operator">=</span>False<span class="token punctuation">)</span>
    <span class="token comment">#now()是第一次服务器运行的时间 以后也是这个</span>
    <span class="token comment">#now就是每次创建一个模型的时候，都获取当前的时间</span>
    create_time<span class="token operator">=</span>db.Column<span class="token punctuation">(</span>db.DateTime,default<span class="token operator">=</span>datetime.now<span class="token punctuation">)</span>
    author_id<span class="token operator">=</span>db.Column<span class="token punctuation">(</span>db.Integer,db.ForeignKey<span class="token punctuation">(</span><span class="token string">'user.id'</span><span class="token punctuation">))</span>
    
    author<span class="token operator">=</span>db.relationship<span class="token punctuation">(</span><span class="token string">'User'</span>,backref<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'question'</span><span class="token punctuation">))</span>
</code></pre> 
<p>要记得映射到数据库中 manage.py <code>from models import User,Question</code><br> 然后在cmd中迁移数据</p> 
<pre><code class="prism language-bash"><span class="token function">cd</span>  D:\PycharmProjects\flaskProject
d:
<span class="token function">cd</span> venv
<span class="token function">cd</span> Scripts
activate
cd<span class="token punctuation">..</span>
cd<span class="token punctuation">..</span>
python manage.py  runserver
python manage.py  db migrate
python manage.py  db upgrade

</code></pre> 
<p><img src="https://images2.imgbox.com/33/d6/y59MqrUQ_o.png" alt="在这里插入图片描述"><br> <em>MYSQL中查看</em></p> 
<pre><code class="prism language-bash"> use zlqt_demo
 show tables<span class="token punctuation">;</span>
 desc question<span class="token punctuation">;</span>
 <span class="token keyword">select</span> * from  question<span class="token punctuation">;</span>//显示所有数据
</code></pre> 
<p><img src="https://images2.imgbox.com/49/56/0kqlxCML_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6f/ae/IEnzljI3_o.png" alt="在这里插入图片描述"></p> 
<p>完成question的视图函数</p> 
<pre><code class="prism language-bash">@app.route<span class="token punctuation">(</span><span class="token string">'/question/'</span>,methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span>,<span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
@login_required
def question<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    <span class="token keyword">if</span> request.method<span class="token operator">==</span><span class="token string">'GET'</span><span class="token keyword">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'question.html'</span><span class="token punctuation">)</span>
    else:
        title<span class="token operator">=</span>request.form.get<span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span>
        content<span class="token operator">=</span>request.form.get<span class="token punctuation">(</span><span class="token string">'content'</span><span class="token punctuation">)</span>
        question<span class="token operator">=</span>Question<span class="token punctuation">(</span>title<span class="token operator">=</span>title,content<span class="token operator">=</span>content<span class="token punctuation">)</span><span class="token comment">#添加这个模型</span>
        <span class="token comment">#取外键</span>
        user_id<span class="token operator">=</span>session.get<span class="token punctuation">(</span><span class="token string">'user_id'</span><span class="token punctuation">)</span>
        user<span class="token operator">=</span>User.query.filter<span class="token punctuation">(</span>User.id<span class="token operator">==</span>user_id<span class="token punctuation">)</span>.first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#把这个user从模型中取出</span>
        question.author<span class="token operator">=</span>user
        db.session.add<span class="token punctuation">(</span>question<span class="token punctuation">)</span>
        db.session.commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">#发布问答后马上跳转到首页 可以看到自己的回答</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">))</span>
</code></pre> 
<h3><a id="14_1614"></a>14社区内容的布局</h3> 
<pre><code class="prism language-bash"><span class="token comment">#视图函数</span>
@app.route<span class="token punctuation">(</span><span class="token string">'/text/'</span><span class="token punctuation">)</span>
def text<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    context<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
        <span class="token string">'questions'</span>:Question.query.all<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#所有数据取出 加负号按照时间从大到小排序 order_by(text("-create_time"))</span>


    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'text.html'</span>,**context<span class="token punctuation">)</span>  <span class="token comment"># 传参</span>
</code></pre> 
<pre><code class="prism language-bash">text.html
<span class="token punctuation">{<!-- --></span>% extends <span class="token string">'base.html'</span> %<span class="token punctuation">}</span>

<span class="token punctuation">{<!-- --></span>% block title %<span class="token punctuation">}</span>首页<span class="token punctuation">{<!-- --></span>% endblock %<span class="token punctuation">}</span>

<span class="token punctuation">{<!-- --></span>% block <span class="token function">head</span> %<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('static',filename='css/index.css') }}"</span><span class="token operator">&gt;</span>
<span class="token punctuation">{<!-- --></span>% endblock %<span class="token punctuation">}</span>

<span class="token punctuation">{<!-- --></span>% block main %<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>ul class<span class="token operator">=</span><span class="token string">"question-list-group"</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{<!-- --></span>% <span class="token keyword">for</span> question <span class="token keyword">in</span> questions %<span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"avatar-group"</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('static',filename='images/logo.png') }}"</span> alt<span class="token operator">=</span><span class="token string">""</span> class<span class="token operator">=</span><span class="token string">"avatar"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"question-group"</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>p class<span class="token operator">=</span><span class="token string">"question-title"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"#"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> question.title <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>p class<span class="token operator">=</span><span class="token string">"question-content"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> question.content <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"question-info"</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>span class<span class="token operator">=</span><span class="token string">"question-author"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> question.author.username <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/span<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>span class<span class="token operator">=</span><span class="token string">"question-time"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> question.create_time <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/span<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
        <span class="token punctuation">{<!-- --></span>% endfor %<span class="token punctuation">}</span>


    <span class="token operator">&lt;</span>/ul<span class="token operator">&gt;</span>
<span class="token punctuation">{<!-- --></span>% endblock %<span class="token punctuation">}</span>
</code></pre> 
<p>15问答详情设置<br> 当点击标题的链接时候 跳到问答的一个详情页面detail.html</p> 
<pre><code class="prism language-bash"><span class="token punctuation">{<!-- --></span>% extends <span class="token string">'base.html'</span> %<span class="token punctuation">}</span>

<span class="token punctuation">{<!-- --></span>% block title %<span class="token punctuation">}</span>详情-<span class="token punctuation">{<!-- --></span>% endblock %<span class="token punctuation">}</span>

<span class="token punctuation">{<!-- --></span>% block <span class="token function">head</span> %<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('static',filename='css/detail.css') }}"</span><span class="token operator">&gt;</span>
<span class="token punctuation">{<!-- --></span>% endblock %<span class="token punctuation">}</span>

<span class="token punctuation">{<!-- --></span>% block main %<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>h3 class<span class="token operator">=</span><span class="token string">"page-title"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> question.title <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/h3<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p class<span class="token operator">=</span><span class="token string">"question-info"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>作者：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> question.author.username <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>时间：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> question.create_time <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>hr<span class="token operator">&gt;</span>//hr表示横线
    <span class="token operator">&lt;</span>p class<span class="token operator">=</span><span class="token string">"question-content"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> question.content <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>hr<span class="token operator">&gt;</span>
    
<span class="token punctuation">{<!-- --></span>% endblock %<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="16_1687"></a>16评论模块</h3> 
<p>需要建立一个评论的url 且要处于登录状态</p> 
<p><img src="https://images2.imgbox.com/03/ed/BXK0bgtr_o.png" alt="在这里插入图片描述"></p> 
<p>建立一个添加答案的模型</p> 
<pre><code class="prism language-bash">class Answer<span class="token punctuation">(</span>db.Model<span class="token punctuation">)</span>:
    __tablename__ <span class="token operator">=</span> <span class="token string">'answer'</span>
    <span class="token function">id</span> <span class="token operator">=</span> db.Column<span class="token punctuation">(</span>db.Integer, primary_key<span class="token operator">=</span>True, autoincrement<span class="token operator">=</span>True<span class="token punctuation">)</span>
    content <span class="token operator">=</span> db.Column<span class="token punctuation">(</span>db.Text,nullable<span class="token operator">=</span>False<span class="token punctuation">)</span>
    create_time <span class="token operator">=</span> db.Column<span class="token punctuation">(</span>db.DateTime,default<span class="token operator">=</span>datetime.now<span class="token punctuation">)</span>
    question_id <span class="token operator">=</span> db.Column<span class="token punctuation">(</span>db.Integer,db.ForeignKey<span class="token punctuation">(</span><span class="token string">'question.id'</span><span class="token punctuation">))</span>
    author_id <span class="token operator">=</span> db.Column<span class="token punctuation">(</span>db.Integer,db.ForeignKey<span class="token punctuation">(</span><span class="token string">'user.id'</span><span class="token punctuation">))</span>
    <span class="token comment"># 指定关系 通过Question和User（看作者发表了哪些问答）拿到所有的答案</span>
    question <span class="token operator">=</span> db.relationship<span class="token punctuation">(</span><span class="token string">'Question'</span>,backref<span class="token operator">=</span>db.backref<span class="token punctuation">(</span><span class="token string">'answers'</span>,order_by<span class="token operator">=</span>id.desc<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">)</span><span class="token comment">#且评论按照id序号降序排列</span>
    author <span class="token operator">=</span> db.relationship<span class="token punctuation">(</span><span class="token string">'User'</span>,backref<span class="token operator">=</span>db.backref<span class="token punctuation">(</span><span class="token string">'answers'</span><span class="token punctuation">))</span>
</code></pre> 
<p>建立模型后要在manage.py引入<code>from models import Answer</code><br> 然后在cmd中迁移数据</p> 
<pre><code class="prism language-bash"><span class="token function">cd</span>  D:\PycharmProjects\flaskProject
d:
<span class="token function">cd</span> venv
<span class="token function">cd</span> Scripts
activate
cd<span class="token punctuation">..</span>
cd<span class="token punctuation">..</span>
 
python manage.py  db migrate
python manage.py  db upgrade

``<span class="token variable"><span class="token variable">`</span><span class="token operator">!</span><span class="token punctuation">[</span>在这里插入图片描述<span class="token punctuation">]</span><span class="token punctuation">(</span>https://img-blog.csdnimg.cn/20201214214302949.png?x-oss-process<span class="token operator">=</span>image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1ZW9uZw<span class="token operator">==</span>,size_16,color_FFFFFF,t_70<span class="token punctuation">)</span>
*MYSQL中查看* 

<span class="token variable">`</span></span>``bash
 use zlktqa_demo
 show tables<span class="token punctuation">;</span>
 desc answer<span class="token punctuation">;</span>
 <span class="token keyword">select</span> * from  answer<span class="token punctuation">;</span>//显示所有数据


 

</code></pre> 
<p><img src="https://images2.imgbox.com/b7/98/wM41sb67_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash"><span class="token punctuation">{<!-- --></span>% extends <span class="token string">'base.html'</span> %<span class="token punctuation">}</span>

<span class="token punctuation">{<!-- --></span>% block title %<span class="token punctuation">}</span>详情-<span class="token punctuation">{<!-- --></span>% endblock %<span class="token punctuation">}</span>

<span class="token punctuation">{<!-- --></span>% block <span class="token function">head</span> %<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('static',filename='css/detail.css') }}"</span><span class="token operator">&gt;</span>
<span class="token punctuation">{<!-- --></span>% endblock %<span class="token punctuation">}</span>

<span class="token punctuation">{<!-- --></span>% block main %<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>h3 class<span class="token operator">=</span><span class="token string">"page-title"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> question.title <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/h3<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p class<span class="token operator">=</span><span class="token string">"question-info"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>作者：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> question.author.username <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>时间：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> question.create_time <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>hr<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p class<span class="token operator">=</span><span class="token string">"question-content"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> question.content <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>hr<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h4<span class="token operator">&gt;</span>评论：（0）<span class="token operator">&lt;</span>/h4<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('add_answer') }}"</span> method<span class="token operator">=</span><span class="token string">"post"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>input name<span class="token operator">=</span><span class="token string">"answer_content"</span> type<span class="token operator">=</span><span class="token string">"text"</span> class<span class="token operator">=</span><span class="token string">"form-control"</span> placeholder<span class="token operator">=</span><span class="token string">"请填写评论"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"hidden"</span> name<span class="token operator">=</span><span class="token string">"question_id"</span> value<span class="token operator">=</span><span class="token string">"{<!-- -->{ question.id }}"</span><span class="token operator">&gt;</span><span class="token comment">#会把input标签内的内容（content和id）传递过去 而且question_id是隐藏的不会被看见的 </span>
        <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"form-group"</span> style<span class="token operator">=</span><span class="token string">"text-align: right;"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button class<span class="token operator">=</span><span class="token string">"btn btn-primary"</span><span class="token operator">&gt;</span>立即评论<span class="token operator">&lt;</span>/button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/form<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>ul class<span class="token operator">=</span><span class="token string">"answer-list"</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{<!-- --></span>% <span class="token keyword">for</span> answer <span class="token keyword">in</span> question.answers %<span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"user-info"</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"{<!-- -->{ url_for('static',filename='images/logo'.png') }}"</span> alt<span class="token operator">=</span><span class="token string">""</span> class<span class="token operator">=</span><span class="token string">"avatar"</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>span class<span class="token operator">=</span><span class="token string">"username"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> answer.author.username <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/span<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>span class<span class="token operator">=</span><span class="token string">"create-time"</span><span class="token operator">&gt;</span>2017-06-30 14:04:54<span class="token operator">&lt;</span>/span<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>p class<span class="token operator">=</span><span class="token string">"answer-content"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> answer.content <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
        <span class="token punctuation">{<!-- --></span>% endfor %<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>/ul<span class="token operator">&gt;</span>
<span class="token punctuation">{<!-- --></span>% endblock %<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="17_1784"></a>17查找</h3> 
<p>request.form和request.args.get的区别<br> 1、若get请求改为post请求，那么我们在后台使用request.args访问参数id的值，</p> 
<p>使用request.form访问params参数集中各参数的值</p> 
<p>例如：</p> 
<p>前端代码：1、若get请求改为post请求，那么我们在后台使用request.args访问参数id的值，</p> 
<p>使用request.form访问params参数集中各参数的值</p> 
<p>例如：</p> 
<p>前端代码：<br> 1、若get请求改为post请求，那么我们在后台使用request.args访问参数id的值，</p> 
<p>使用request.form访问params参数集中各参数的值</p> 
<p>例如：</p> 
<pre><code class="prism language-bash">前端代码：<span class="token operator">&lt;</span>form method<span class="token operator">=</span><span class="token string">"post"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
            昵称<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> style<span class="token operator">=</span><span class="token string">"text-align:center"</span> id<span class="token operator">=</span><span class="token string">"username"</span> name<span class="token operator">=</span><span class="token string">"username"</span> maxlength<span class="token operator">=</span><span class="token string">"8"</span> <span class="token punctuation">{<!-- --></span>% <span class="token keyword">if</span> user_list %<span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token string">"{<!-- -->{ user_list.username }}"</span> <span class="token punctuation">{<!-- --></span>% endif %<span class="token punctuation">}</span>/<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/tr<span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
            真实名字<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> style<span class="token operator">=</span><span class="token string">"text-align:center"</span> id<span class="token operator">=</span><span class="token string">"realname"</span> name<span class="token operator">=</span><span class="token string">"realname"</span> maxlength<span class="token operator">=</span><span class="token string">"20"</span> <span class="token punctuation">{<!-- --></span>% <span class="token keyword">if</span> user_list %<span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token string">"{<!-- -->{ user_list.realname }}"</span> <span class="token punctuation">{<!-- --></span>% endif %<span class="token punctuation">}</span>/<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/tr<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
            <span class="token operator">&amp;</span>nbsp
        <span class="token operator">&lt;</span>/tr<span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">"submit"</span> id<span class="token operator">=</span><span class="token string">"not_null"</span> style<span class="token operator">=</span><span class="token string">"display: none"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span>/button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">"button"</span> onclick<span class="token operator">=</span><span class="token string">"judge_null()"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span>/button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/tr<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/form<span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-bash">def edit_user<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    <span class="token keyword">if</span> request.method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token keyword">:</span>
        _id <span class="token operator">=</span> request.args.get<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>
        user_list <span class="token operator">=</span> json_util.loads<span class="token punctuation">(</span>
            json_util.dumps<span class="token punctuation">(</span>MongoHelpMaster<span class="token punctuation">(</span><span class="token string">'temp_users'</span><span class="token punctuation">)</span>.database.find_one<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'_id'</span><span class="token keyword">:</span> ObjectId<span class="token punctuation">(</span>_id<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">))</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'temp_site/peom/backend/edit_user.html'</span>, user_list<span class="token operator">=</span>user_list, session<span class="token operator">=</span>session<span class="token punctuation">[</span><span class="token string">"info"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> request.method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token keyword">:</span>
        username <span class="token operator">=</span> request.form<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span>
        realname <span class="token operator">=</span> request.form<span class="token punctuation">[</span><span class="token string">'realname'</span><span class="token punctuation">]</span>
        _id <span class="token operator">=</span> request.args.get<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>
        print<span class="token punctuation">(</span>_id<span class="token punctuation">)</span>
        result <span class="token operator">=</span> MongoHelpMaster<span class="token punctuation">(</span><span class="token string">'temp_users'</span><span class="token punctuation">)</span>.database.update_one<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"_id"</span><span class="token keyword">:</span> ObjectId<span class="token punctuation">(</span>_id<span class="token punctuation">)</span><span class="token punctuation">}</span>, <span class="token punctuation">{<!-- --></span>
            <span class="token string">"<span class="token variable">$set</span>"</span><span class="token keyword">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">'username'</span><span class="token keyword">:</span> username, <span class="token string">'realname'</span><span class="token keyword">:</span> realname<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>当需要获取前端页面表单传过来的id值的时候，我们就需要用request.args.get,而不能用request.form</p> 
<p>如果使用request.args，它将提供一个带有GET参数的键值对的dictary</p> 
<p>例如：http://website.com/index?arg1=hello&amp;arg2=world</p> 
<p>print request.args</p> 
<blockquote> 
 <blockquote> 
  <p>{“arg1”: “hello”, “arg2”: “world”}<br> request.args.get(key)是一个有用的字典函数，如果未设置参数而不是引发一个KeyError，则返回None</p> 
 </blockquote> 
</blockquote> 
<ol><li>备视图函数search() 修改base.html 中搜索输入框所在的</li></ol> 
<pre><code class="prism language-bash"><span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">"{<!-- -->{url_for('search') }}"</span> method<span class="token operator">=</span><span class="token string">"get"</span><span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token operator">&lt;</span>input name<span class="token operator">=</span><span class="token string">"q"</span> type<span class="token operator">=</span><span class="token string">"text"</span>
        placeholder<span class="token operator">=</span><span class="token string">"请输入关键字"</span><span class="token operator">&gt;</span>
</code></pre> 
<ol start="2"><li> <p>完成视图函数search() 获取搜索关键字 q = request.args.get('q’) 条件查询</p> </li><li> <p>qu=Question.query.filter(Question.title.contains(q)).order_by(’-creat_time’)</p> <p>加载查询结果： return render_template(‘index.html’, question=qu）</p> <p>组合条件查询 from sqlalchemy import or_, and_</p> </li></ol> 
<p>示例：</p> 
<pre><code class="prism language-bash">Lobby.query.filter<span class="token punctuation">(</span>

    or_<span class="token punctuation">(</span>

        and_<span class="token punctuation">(</span>

            Lobby.id <span class="token operator">==</span> Team.lobby_id,

            LobbyPlayer.team_id <span class="token operator">==</span> Team.id,

            LobbyPlayer.player_id <span class="token operator">==</span> player.steamid

        <span class="token punctuation">)</span>,

      and_<span class="token punctuation">(</span>

            Lobby.id <span class="token operator">==</span> spectator_table.c.lobby_id,

            spectator_table.c.player_id <span class="token operator">==</span> player.steamid

        <span class="token punctuation">)</span>

    <span class="token punctuation">)</span>

<span class="token punctuation">)</span>

https://stackoverflow.com/questions/13370993/sqlalchemy-query-and-or-issue
</code></pre> 
<pre><code class="prism language-bash">@app.route<span class="token punctuation">(</span><span class="token string">'/search/'</span><span class="token punctuation">)</span>
def search<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    qu<span class="token operator">=</span>request.args.get<span class="token punctuation">(</span><span class="token string">'q'</span><span class="token punctuation">)</span>
    ques<span class="token operator">=</span>Question.query.filter<span class="token punctuation">(</span>
        or_<span class="token punctuation">(</span>
            Question.title.contains<span class="token punctuation">(</span>qu<span class="token punctuation">)</span>,
            Question.detail.contains<span class="token punctuation">(</span>qu<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
     <span class="token punctuation">)</span>.order_by<span class="token punctuation">(</span><span class="token string">'-create_time'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'base.html'</span>,questions<span class="token operator">=</span>ques<span class="token punctuation">)</span>
 <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">"{<!-- -->{url_for('search')}}"</span> method<span class="token operator">=</span><span class="token string">"get"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input name<span class="token operator">=</span><span class="token string">"q"</span> type<span class="token operator">=</span><span class="token string">"text"</span> placeholder<span class="token operator">=</span><span class="token string">"请输入关键字"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">"submit"</span> <span class="token operator">&gt;</span>搜索<span class="token operator">&lt;</span>/button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/form<span class="token operator">&gt;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6bcb635a1ad30eb78f95523f7791a1d5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">父与子的编程之旅 python 3 pdf_父与子的编程之旅pdf微盘</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f7a72abbfe768586b31bcd4992a6b7f7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">canny算子图像处理实现（C&#43;&#43;）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>