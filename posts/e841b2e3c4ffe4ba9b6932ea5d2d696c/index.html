<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[免费专栏] Android安全之绕过WebView SSL Pinning抓HTTPS数据 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[免费专栏] Android安全之绕过WebView SSL Pinning抓HTTPS数据" />
<meta property="og:description" content="也许每个人出生的时候都以为这世界都是为他一个人而存在的，当他发现自己错的时候，他便开始长大
少走了弯路，也就错过了风景，无论如何，感谢经历
转移发布平台通知：将不再在CSDN博客发布新文章，敬请移步知识星球
感谢大家一直以来对我CSDN博客的关注和支持，但是我决定不再在这里发布新文章了。为了给大家提供更好的服务和更深入的交流，我开设了一个知识星球，内部将会提供更深入、更实用的技术文章，这些文章将更有价值，并且能够帮助你更好地解决实际问题。期待你加入我的知识星球，让我们一起成长和进步
Android安全付费专栏长期更新，本篇最新内容请前往：
[车联网安全自学篇] Android安全之绕过WebView SSL Pinning抓HTTPS数据 注：样本APK下载地址，请见文章末尾
0x01 前言 Android 中的证书固定，Android WebView 中证书锁定，在Android 7.0 Nougat (SDK 24)开始才有的，在 Android 7.0 Nougat (SDK 24)之前，无论开发人员使用什么库，都无法真正管理 Webview 上的固定，因为Android 7.0 Nougat (SDK 24)的网络安全配置允许应用程序定义自己的规则集。
为了不让攻击者抓到数据包货执行中间人攻击，开发人员使用了WebView SSLPinning，如果我们想成功地对固定的证书域执行中间人攻击，就必须获得实际证书或能够生成有效证书（来自受信任的证书颁发机构）
1.1 WebView 忽略证书验证 1.1.1 Okhttp3忽略HTTPS证书校验 import java.security.SecureRandom; import java.security.cert.X509Certificate; import javax.net.ssl.HostnameVerifier; import javax.net.ssl.SSLContext; import javax.net.ssl.SSLSession; import javax.net.ssl.SSLSocketFactory; import javax.net.ssl.TrustManager; import javax.net.ssl.X509TrustManager; public class SSLSocketClient { public static SSLSocketFactory getSSLSocketFactory() { try { SSLContext sslContext = SSLContext.getInstance(&#34;SSL&#34;); sslContext." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e841b2e3c4ffe4ba9b6932ea5d2d696c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-31T10:57:03+08:00" />
<meta property="article:modified_time" content="2023-03-31T10:57:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[免费专栏] Android安全之绕过WebView SSL Pinning抓HTTPS数据</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <hr> 
<p><strong>也许每个人出生的时候都以为这世界都是为他一个人而存在的，当他发现自己错的时候，他便开始长大</strong></p> 
<p><strong>少走了弯路，也就错过了风景，无论如何，感谢经历</strong></p> 
<hr> 
<p><font color="red"><strong>转移发布平台通知：将不再在CSDN博客发布新文章，敬请移步知识星球</strong></font></p> 
<blockquote> 
 <p>感谢大家一直以来对我CSDN博客的关注和支持，但是我决定不再在这里发布新文章了。为了给大家提供更好的服务和更深入的交流，我开设了一个知识星球，内部将会提供更深入、更实用的技术文章，这些文章将更有价值，并且能够帮助你更好地解决实际问题。期待你加入我的知识星球，让我们一起成长和进步</p> 
</blockquote> 
<hr> 
<p>Android安全付费专栏长期更新，本篇最新内容请前往：</p> 
<ul><li><a href="https://orangey.blog.csdn.net/article/details/124793802" rel="nofollow">[车联网安全自学篇] Android安全之绕过WebView SSL Pinning抓HTTPS数据</a></li></ul> 
<p><strong>注</strong>：样本APK下载地址，请见文章末尾</p> 
<h2><a id="0x01__21"></a>0x01 前言</h2> 
<p>Android 中的证书固定，Android WebView 中证书锁定，在Android 7.0 Nougat (SDK 24)开始才有的，在 Android 7.0 Nougat (SDK 24)之前，无论开发人员使用什么库，都无法真正管理 Webview 上的固定，因为Android 7.0 Nougat (SDK 24)的网络安全配置允许应用程序定义自己的规则集。</p> 
<p>为了不让攻击者抓到数据包货执行中间人攻击，开发人员使用了WebView SSLPinning，如果我们想成功地对固定的证书域执行中间人攻击，就必须获得实际证书或能够生成有效证书（来自受信任的证书颁发机构）</p> 
<h3><a id="11_WebView__27"></a>1.1 WebView 忽略证书验证</h3> 
<h4><a id="111_Okhttp3HTTPS_29"></a>1.1.1 Okhttp3忽略HTTPS证书校验</h4> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">SecureRandom</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>cert<span class="token punctuation">.</span></span><span class="token class-name">X509Certificate</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>net<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token class-name">HostnameVerifier</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>net<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token class-name">SSLContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>net<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token class-name">SSLSession</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>net<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token class-name">SSLSocketFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>net<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token class-name">TrustManager</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>net<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token class-name">X509TrustManager</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SSLSocketClient</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">SSLSocketFactory</span> <span class="token function">getSSLSocketFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">SSLContext</span> sslContext <span class="token operator">=</span> <span class="token class-name">SSLContext</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"SSL"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sslContext<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token function">getTrustManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> sslContext<span class="token punctuation">.</span><span class="token function">getSocketFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">TrustManager</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getTrustManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">TrustManager</span><span class="token punctuation">[</span><span class="token punctuation">]</span> trustAllCerts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrustManager</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">new</span> <span class="token class-name">X509TrustManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">checkClientTrusted</span><span class="token punctuation">(</span><span class="token class-name">X509Certificate</span><span class="token punctuation">[</span><span class="token punctuation">]</span> chain<span class="token punctuation">,</span> <span class="token class-name">String</span> authType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token punctuation">}</span>

                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">checkServerTrusted</span><span class="token punctuation">(</span><span class="token class-name">X509Certificate</span><span class="token punctuation">[</span><span class="token punctuation">]</span> chain<span class="token punctuation">,</span> <span class="token class-name">String</span> authType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token punctuation">}</span>

                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token class-name">X509Certificate</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getAcceptedIssuers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">X509Certificate</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> trustAllCerts<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">HostnameVerifier</span> <span class="token function">getHostnameVerifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">HostnameVerifier</span> hostnameVerifier <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HostnameVerifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">verify</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token class-name">SSLSession</span> sslSession<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> hostnameVerifier<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java">sClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OkHttpClient<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">connectTimeout</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">readTimeout</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">writeTimeout</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">sslSocketFactory</span><span class="token punctuation">(</span><span class="token class-name">SSLSocketClient</span><span class="token punctuation">.</span><span class="token function">getSSLSocketFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">hostnameVerifier</span><span class="token punctuation">(</span><span class="token class-name">SSLSocketClient</span><span class="token punctuation">.</span><span class="token function">getHostnameVerifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="112_WebViewHTTPS_97"></a>1.1.2 WebView忽略HTTPS证书校验</h4> 
<p>Android WebView组件加载网页发生证书认证错误时，会调用WebViewClient类的onReceivedSslError方法，如果该方法实现调用了handler.proceed()来忽略该证书错误，则会受到中间人攻击的威胁，可能导致隐私泄露</p> 
<p>httptest APP中，WebView忽略了SSL证书错误，可能引起中间人攻击</p> 
<pre><code class="prism language-java"><span class="token comment">/*
* https协议
* WebView 不进行证书校验
*/</span>
button_webview_ssl_without_ca<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">MyWebViewClient</span> mWebViewClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyWebViewClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWebViewClient<span class="token punctuation">.</span><span class="token function">setCheckflag</span><span class="token punctuation">(</span><span class="token string">"trustAllCerts"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWebview<span class="token punctuation">.</span><span class="token function">setWebViewClient</span><span class="token punctuation">(</span>mWebViewClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWebview<span class="token punctuation">.</span><span class="token function">loadUrl</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com/?q=WebView_without_CAcheck"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>WebView直接调用onReceivedSslError方法时，直接执行handler.proceed()来忽略该证书错误，setWebViewClient() 实现方法如下：</p> 
<pre><code class="prism language-java">wv<span class="token punctuation">.</span><span class="token function">setWebViewClient</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WebViewClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onReceivedSslError</span><span class="token punctuation">(</span><span class="token class-name">WebView</span> view<span class="token punctuation">,</span> <span class="token class-name">SslErrorHandler</span> handler<span class="token punctuation">,</span> <span class="token class-name">SslError</span> error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                handler<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//忽略证书错误继续加载页面</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>客户端访问使用Https协议加密的url时，如果服务器证书校验错误，客户端应该拒绝继续加载页面</p> 
<p>在使用WebView进行HTTPS请求时，同样可以对HTTPS证书进行校验，WebView控件对请求逻辑进行了封装，所以进行证书校验更加方便，具体代码如下所示，handler.cancel()相当于使用系统证书校验:：</p> 
<pre><code class="prism language-java"><span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">MyWebViewClient</span> <span class="token keyword">extends</span> <span class="token class-name">WebViewClient</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> checkflag<span class="token operator">=</span><span class="token string">"checkCerts"</span><span class="token punctuation">;</span> <span class="token comment">// 是否忽略证书校验</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCheckflag</span><span class="token punctuation">(</span><span class="token class-name">String</span> checkflag<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>checkflag <span class="token operator">=</span> checkflag<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onReceivedSslError</span><span class="token punctuation">(</span><span class="token class-name">WebView</span> view<span class="token punctuation">,</span> <span class="token class-name">SslErrorHandler</span> handler<span class="token punctuation">,</span> <span class="token class-name">SslError</span> error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"trustAllCerts"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>checkflag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//忽略证书校验</span>
            handler<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            handler<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"证书异常，停止访问"</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>打开Burp，并在Android 设备中配置好代理，然后打开APP后点击【WEBVIEW SSL(忽略证书校验)】按钮，APP成功访问，并在界面显示百度的一个gif图片，Burp也成功抓到信息，如下：</p> 
<p><img src="https://images2.imgbox.com/48/0f/sR4sp09b_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="12_WebView__162"></a>1.2 WebView 系统证书校验</h3> 
<p>WebView没有自定义SSL Pinning的实现方法，只能通过network_security_config.xml配置证书绑定</p> 
<pre><code class="prism language-java"><span class="token comment">/*
 * https协议
 * WebView 使用系统证书校验
 * 默认证书链校验，只信任系统CA(根证书)
*
* tips: OKHTTP默认的https请求使用系统CA验证服务端证书（Android7.0以下还信任用户证书，Android7.0开始默认只信任系统证书）
 */</span>
button_webview_ssl_with_system_ca<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">MyWebViewClient</span> mWebViewClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyWebViewClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWebViewClient<span class="token punctuation">.</span><span class="token function">setCheckflag</span><span class="token punctuation">(</span><span class="token string">"checkCerts"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWebview<span class="token punctuation">.</span><span class="token function">setWebViewClient</span><span class="token punctuation">(</span>mWebViewClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWebview<span class="token punctuation">.</span><span class="token function">loadUrl</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com/?q=WebView_with_SystemCAcheck"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/47/dc/RZWeZlRO_o.png" alt="在这里插入图片描述"></p> 
<p>绕过WebView 系统证书校验的方法，跟绕过HTTPS 系统证书校验的方法一样，只需要将抓包工具的证书安装到系统信任库里面即可正常抓包或反编译APK在<code>&lt;app&gt;\res\xml\network_security_config.xml</code>和<code>&lt;app&gt;\AndroidManifest.xml</code>中添加如下信息后重打包APK并签名就能抓到数据：</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>network-security-config</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>base-config</span><span class="token punctuation">&gt;</span></span> 
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trust-anchors</span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- 信任系统预置CA 证书 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>certificates</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>system<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
          <span class="token comment">&lt;!-- 信任用户添加的 CA 证书，Charles 和 Fiddler 抓包工具安装的证书属于此类 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>certificates</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trust-anchors</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>base-config</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>network-security-config</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>AndroidManifest.xml：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>application</span>  <span class="token attr-name"><span class="token namespace">android:</span>networkSecurityConfig</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@xml/network_security_config<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>注</strong>：在Android 7.0以前，应用默认会信任系统证书和用户证书，Android 7.0开始，默认只信任系统证书，在root环境下，将证书导入系统目录的方法。只要想办法把证书弄到系统证书列表，就可以抓包解密明文数据，具体的证书安装到系统证书目录的方法，如下：</p> 
<p>目前在Android 7.0或以上的系统有启用了对第三方证书的限制，但在Android 7.0以下依旧可以将Fiddler/Charles/Burp的证书安装在用户的CA集中抓取https请求</p> 
<p>将Burp或者Charles的证书作为系统级别的信任证书安装。建议重新生产burp证书并重启burp后再导出。系统级别的受信任证书以特殊格式存储在/system/etc/security/cacerts文件夹中。我们可以将Burp的证书写入此位置。</p> 
<p>导出一个Burp/Charles证书之后，adb push到模拟器，然后修改后缀为crt直接安全，这种方式在Android 6及之前的版本可用，从Android 7.0开始，Android更改了信任用户安装的证书的默认行为，应用程序仅信任系统级CA。这样就导致安装证书后，如果尝试通过Burp或者Charlse代理访问https网站，系统会提示“该证书并非来自可信的授权中心”</p> 
<p>对于Android 7.0 (API 24) 之后，做了些改动，使得系统安全性增加了，导致：</p> 
<ul><li>APP 默认不信任用户域的证书 
  <ul><li>之前把抓包工具的ssl证书，通过【从SD卡安装】安装到受信任的凭据 -&gt; 用户。就没用了，因为不再受信任了</li><li>只信任（安装到）系统域的证书</li><li>导致无法抓包https，抓出来的https的请求，都是加了密的，无法看到原文了</li></ul> </li></ul> 
<p>对此，总结出相关解决思路和方案：</p> 
<ul><li>让系统信任抓包工具的ssl证书 
  <ul><li>作为app的开发者自己：改自己的app的配置，允许https抓包（得到或本身有app的源码，把证书放到受系统信任的系统证书中去）</li><li>把证书放到受系统信任的系统证书中去（root权限）</li></ul> </li><li>绕开https不去校验 
  <ul><li>借助于其他（JustTrustMe等）工具绕开https的校验（例如XPosed、太极XPosed等框架）</li></ul> </li></ul> 
<p>1） <strong>Android 7抓包问题解决方法</strong></p> 
<ol><li>导出Burp的证书后，使用openssl来做一些改动，最后上传到<code>/system/etc/security/cacerts</code></li></ol> 
<p><img src="https://images2.imgbox.com/15/4e/KBgw4mtb_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/fc/a5/N8TncUPk_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">root@kali<span class="token operator">:</span><span class="token operator">~</span># openssl x509 <span class="token operator">-</span>inform DER <span class="token operator">-</span>in cert<span class="token operator">-</span>der<span class="token punctuation">.</span>crt <span class="token operator">-</span>out PortSwiggerCA<span class="token punctuation">.</span>pem
root@kali<span class="token operator">:</span><span class="token operator">~</span># openssl x509 <span class="token operator">-</span>inform PEM <span class="token operator">-</span>subject_hash_old <span class="token operator">-</span>in PortSwiggerCA<span class="token punctuation">.</span>pem<span class="token operator">|</span>head <span class="token operator">-</span><span class="token number">1</span>
root@kali<span class="token operator">:</span><span class="token operator">~</span># mv PortSwiggerCA<span class="token punctuation">.</span>pem <span class="token number">9999.0</span>
</code></pre> 
<ol start="2"><li>adb传输文件报错<code>couldn‘t create file：Read-only file system</code>解决方法</li></ol> 
<p><img src="https://images2.imgbox.com/7d/77/qTM1Ii8M_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">D<span class="token operator">:</span>\<span class="token operator">&gt;</span>adb shell
VOG<span class="token operator">-</span>AL00<span class="token operator">:</span><span class="token operator">/</span> # mount <span class="token operator">-</span>o remount <span class="token operator">-</span>o rw <span class="token operator">/</span>system
mount <span class="token operator">-</span>o remount <span class="token operator">-</span>o rw <span class="token operator">/</span>system
VOG<span class="token operator">-</span>AL00<span class="token operator">:</span><span class="token operator">/</span> # exit<span class="token punctuation">;</span>
exit<span class="token punctuation">;</span>

D<span class="token operator">:</span>\<span class="token operator">&gt;</span>adb root
adbd is already running as root

D<span class="token operator">:</span>\<span class="token operator">&gt;</span>adb remount
remount succeeded

D<span class="token operator">:</span>\<span class="token operator">&gt;</span>adb push <span class="token number">9999.0</span> <span class="token operator">/</span>system<span class="token operator">/</span>etc<span class="token operator">/</span>security<span class="token operator">/</span>cacerts
<span class="token number">330</span> KB<span class="token operator">/</span><span class="token function">s</span> <span class="token punctuation">(</span><span class="token number">1330</span> bytes in <span class="token number">0.003</span>s<span class="token punctuation">)</span>

D<span class="token operator">:</span>\<span class="token operator">&gt;</span>adb shell chmod <span class="token number">644</span> <span class="token operator">/</span>system<span class="token operator">/</span>etc<span class="token operator">/</span>security<span class="token operator">/</span>cacerts<span class="token operator">/</span><span class="token number">9999.0</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/86/13/vkPjPSqA_o.png" alt="在这里插入图片描述"></p> 
<p>再次输入adb push就能正常传输文件</p> 
<p><img src="https://images2.imgbox.com/a1/eb/o4JjLmD9_o.png" alt="在这里插入图片描述"></p> 
<p>2）<strong>Android10 抓包问题解决方法</strong></p> 
<p>安卓 10 采用了的安全策略-将系统分区 /system 挂载为只读，因此Android10以上需要刷入Magisk,在模块里搜索move Cert（MagiskTrustUserCerts） 安装模块，重启后证书就已经被移动到系统目录（system/etc/security/cacerts），可以正常抓包了</p> 
<p>Magisk下载地址：https://github.com/topjohnwu/Magisk<br> MagiskTrustUserCerts下载地址：https://github.com/NVISOsecurity/MagiskTrustUserCerts</p> 
<h2><a id="0x02_WebView_SSL_Pinning_290"></a>0x02 WebView SSL Pinning</h2> 
<h3><a id="21_WebView_292"></a>2.1 绕过WebView证书文件校验</h3> 
<pre><code class="prism language-java"><span class="token comment">/*
* https协议 SSL Pinning WebView
* 通过network_security_config.xml中定义的证书和密钥进行绑定
*/</span>
button_webview_ssl_pinning<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">MyWebViewClient</span> mWebViewClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyWebViewClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWebViewClient<span class="token punctuation">.</span><span class="token function">setCheckflag</span><span class="token punctuation">(</span><span class="token string">"checkCerts"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWebview<span class="token punctuation">.</span><span class="token function">setWebViewClient</span><span class="token punctuation">(</span>mWebViewClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWebview<span class="token punctuation">.</span><span class="token function">loadUrl</span><span class="token punctuation">(</span><span class="token string">"https://www.sogou.com/web?query=WebView_SSLPinningXML"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 证书文件校验</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>注</strong>：【确定样本APK中编译好的证书是否同学你在使用的时候失效了，建议自行使用下面的方法自行编译】此处的本地证书要替换一下为最新的，下载官网最新的sogou.pem然后在/替换掉/res/raw/目录下的sogou.pem文件</p> 
<pre><code class="prism language-c">openssl s_client <span class="token operator">-</span>connect sogou<span class="token punctuation">.</span>com<span class="token operator">:</span><span class="token number">443</span> <span class="token operator">-</span>servername sogou<span class="token punctuation">.</span>com <span class="token operator">|</span> openssl x509 <span class="token operator">-</span>out sogou<span class="token punctuation">.</span>pem
</code></pre> 
<p><img src="https://images2.imgbox.com/3d/21/zubgBbKw_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e4/71/xMWl4ybN_o.png" alt="在这里插入图片描述"></p> 
<p>network_security_config.xml配置的WebView的证书文件校验和公钥校验内容：</p> 
<p><img src="https://images2.imgbox.com/42/50/4qZIa49q_o.png" alt="在这里插入图片描述"></p> 
<p>正常访问不挂代理，内容如下：</p> 
<p><img src="https://images2.imgbox.com/46/97/yBSZF0vG_o.png" alt="在这里插入图片描述"></p> 
<p>挂代理访问，内容如下：</p> 
<p><img src="https://images2.imgbox.com/9e/f6/vh25Q9g8_o.png" alt="在这里插入图片描述"></p> 
<p>绕过方式：利用Android 特性绕过，使用Frida</p> 
<p>JS脚本：</p> 
<pre><code class="prism language-javascript">Java<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">var</span> TrustManagerImpl <span class="token operator">=</span> Java<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'com.android.org.conscrypt.TrustManagerImpl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		TrustManagerImpl<span class="token punctuation">.</span>verifyChain<span class="token punctuation">.</span><span class="token function-variable function">implementation</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">untrustedChain<span class="token punctuation">,</span> trustAnchorChain<span class="token punctuation">,</span> host<span class="token punctuation">,</span> clientAuth<span class="token punctuation">,</span> ocspData<span class="token punctuation">,</span> tlsSctData</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[+] Bypassing TrustManagerImpl (Android &gt; 7): '</span> <span class="token operator">+</span> host<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> untrustedChain<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[-] TrustManagerImpl (Android &gt; 7) pinner not found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//console.log(err);</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3b/47/hWpjiftJ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="22_WebView_363"></a>2.2 绕过WebView证书公钥校验</h3> 
<pre><code class="prism language-java"><span class="token comment">/*
* https协议 SSL Pinning WebView
* 通过network_security_config.xml中定义的证书和密钥进行绑定
*/</span>
button_webview_ssl_pinning<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">MyWebViewClient</span> mWebViewClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyWebViewClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWebViewClient<span class="token punctuation">.</span><span class="token function">setCheckflag</span><span class="token punctuation">(</span><span class="token string">"checkCerts"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWebview<span class="token punctuation">.</span><span class="token function">setWebViewClient</span><span class="token punctuation">(</span>mWebViewClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mWebview<span class="token punctuation">.</span><span class="token function">loadUrl</span><span class="token punctuation">(</span><span class="token string">"https://www.sogou.com/web?query=WebView_SSLPinningXML"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 证书文件校验</span>
        <span class="token comment">// mWebview.loadUrl("https://www.zhihu.com/"); // 证书公钥校验</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>注</strong>：【确定样本APK中编译好的证书是否同学你在使用的时候失效了，建议自行使用下面的方法自行编译】此处证书公钥要替换一下</p> 
<pre><code class="prism language-c">openssl s_client <span class="token operator">-</span>connect zhihu<span class="token punctuation">.</span>com<span class="token operator">:</span><span class="token number">443</span> <span class="token operator">-</span>servername zhihu<span class="token punctuation">.</span>com <span class="token operator">|</span> openssl x509 <span class="token operator">-</span>pubkey <span class="token operator">-</span>noout <span class="token operator">|</span> openssl rsa <span class="token operator">-</span>pubin <span class="token operator">-</span>outform der <span class="token operator">|</span> openssl dgst <span class="token operator">-</span>sha256 <span class="token operator">-</span>binary <span class="token operator">|</span> openssl enc <span class="token operator">-</span>base64
</code></pre> 
<p><img src="https://images2.imgbox.com/54/25/CZvwFefF_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/1b/32/SR3wOmLQ_o.png" alt="在这里插入图片描述"></p> 
<p>正常访问不挂代理，内容如下：</p> 
<p><img src="https://images2.imgbox.com/ac/3a/7IDp2i6x_o.png" alt="在这里插入图片描述"></p> 
<p>挂代理访问，内容如下：</p> 
<p><img src="https://images2.imgbox.com/80/c2/jGE2OTHY_o.png" alt="在这里插入图片描述"></p> 
<p>绕过方式：利用Android 特性绕过，使用Frida</p> 
<p>JS脚本：</p> 
<pre><code class="prism language-javascript">Java<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">var</span> TrustManagerImpl <span class="token operator">=</span> Java<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'com.android.org.conscrypt.TrustManagerImpl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		TrustManagerImpl<span class="token punctuation">.</span>verifyChain<span class="token punctuation">.</span><span class="token function-variable function">implementation</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">untrustedChain<span class="token punctuation">,</span> trustAnchorChain<span class="token punctuation">,</span> host<span class="token punctuation">,</span> clientAuth<span class="token punctuation">,</span> ocspData<span class="token punctuation">,</span> tlsSctData</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[+] Bypassing TrustManagerImpl (Android &gt; 7): '</span> <span class="token operator">+</span> host<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> untrustedChain<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[-] TrustManagerImpl (Android &gt; 7) pinner not found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//console.log(err);</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/17/dc/FMdA82wU_o.png" alt="在这里插入图片描述"></p> 
<p>当然，也可以通过<code>res/xml/network_security_config.xml</code>配置文件对服务端证书进行校验，例如针对证书校验，反编译APK将对应的证书替换为Burp的即可绕过；公钥校验的同理</p> 
<p><img src="https://images2.imgbox.com/19/71/Z3h3r7Sr_o.png" alt="在这里插入图片描述"></p> 
<p><strong>参考链接</strong>：</p> 
<p>https://www.cnblogs.com/Potato-Eater/p/9792725.html</p> 
<p>https://ch3nye.top/Android-HTTPS%E8%AE%A4%E8%AF%81%E7%9A%84N%E7%A7%8D%E6%96%B9%E5%BC%8F%E5%92%8C%E5%AF%B9%E6%8A%97%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/</p> 
<hr> 
<p><strong>你以为你有很多路可以选择，其实你只有一条路可以走</strong></p> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/24193600bb742c7b040133415543a0c2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[免费专栏] Android安全之绕过SSL Pinning抓HTTPS数据</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/74f0d92de9b08fc53600d2ca7b9361be/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Dart】extends with implements 以及 on 的区别辨析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>