<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ceph、gluster、longhorn选型对比 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ceph、gluster、longhorn选型对比" />
<meta property="og:description" content="Ceph Ceph是一个分布式的存储系统，可以在统一的系统中提供唯一的对象、块和文件存储。
名词解释：
RADOS： 由自我修复、自我管理、智能存储节点组成的可靠、自主、分布式对象存储LIBRADOS： 一个允许应用程序直接访问 RADO 的库，支持 C、C&#43;&#43;、Java、Python、Ruby 和 PHPRADOSGW： 基于存储桶的 REST网关，兼容s3和SwiftRBD： 一个负责任的，完全-分布式块设备，使用Linux内核cliont和QEMU/KVM驱动程序CEPHFS： 符合POSIX标准的分发文件系统，具有Linux内核客户端和对FUSE的支持 进程结构：
1. Ceph监视器(ceph-mon)：用来维护集群状态的映射，包括监视器映射，管理器映射，OSD映射，MDS映射和CRUSH映射，这些映射是ceph守护程序相互协调所需的关键状态，另外还负责客户端到ceph存储的身份验证；通常要实现高可用，需要3个或以上的ceph-mon服务2. Ceph管理器(ceph-mgr)：ceph manager守护进程负责跟踪运行时指标和ceph集群当前的状态，包括存储利用率，当前性能指标和系统负载等，ceph-mgr还托管一些python模块，以实现基于web的ceph仪表盘和rest api，通常要实现高可用至少需要2个ceph-mgr进程，通常ceph-mon和ceph-mgr个数相同，1个ceph-mon同节点会伴随1个ceph-mgr守护进程。Mgr有主从之分。3. Ceph对象存储(ceph-osd)：Ceph OSD是对象存储守护程序，是用来存储数据的核心组件，实现数据存储、数据复制和恢复、数据的重新平衡，并会检查其他Ceph OSD守护程序的心跳来向ceph-mon和ceph-mgr提供一些监控信息，通常至少需要3个ceph-osd才能实现冗余和高可用性，部署的时候ceph-osd会和ceph-mon分开节点部署.4. Ceph元数据服务(ceph-mds)：Ceph MDS为ceph文件系统存储元数据，注意Ceph块设备和对象存储不用mds存储元数据，Ceph MDS允许POSIX文件系统用户执行基本命令，而不会将压力都集中到Ceph OSD集群上，通常mds可以选择部署至少2个节点，可以和其他组件一起也可以分开。Mds有主从之分。 存储过程：首先osd需要干净的磁盘或分区。为文件计算一个值，根据值放在某个pg上（pg属于某个osd），文件的其他副本放到其他osd上。
文件实际是使用对象存储存到osd上，因为脱离了linux文件系统，所以无法在磁盘直观的看到文件，只能通过ceph挂载查看。
Gluster Gluster 是一个可扩展的分布式文件系统。有点像nfs，可以把gluster-server所在节点的目录作为存储目录，gluster-client进行挂载。
进程结构：gluster-server进程，gluster-client进程。
卷类型：
分布卷：如文件1放在节点1，文件2放在节点2。复制卷，有两个server节点，文件1在两个节点都存有一份文件。分散卷：文件1分成两块，一块放在节点1，另一块放在节点2，这样读写更快。分布复制卷：节点 1234，文件1在节点12，文件2在节点34。分布分散，节点1234，文件1的两块各在12，文件2的两块各在34。 高可用gluster-server部署两个以上的节点，gluster-server没有主从之分、是对等的。通过复制卷可以实现数据高可用，一个文件分别存在两个节点上，有一个节点宕机，文件依然能正常读写。
Longhorn Longhorn 是一款Kubernetes 分布式块存储系统。只能用k8s部署。
进程结构：
Longhorn Backing Image Manager：支持磁盘中的备份映像下载、同步和删除Longhorn Engine：核心控制器/副本逻辑。每个卷对应一个engine。Longhorn Instance Manager：控制器/副本实例生命周期管理Longhorn Manager：Longhorn 编排，包括适用于 Kubernetes 的 CSI 驱动程序Longhorn Share Manager：NFS 置备程序，将 Longhorn 卷公开为 ReadWriteMany 卷Longhorn UI：NFS 置备程序，将 Longhorn 卷公开为 ReadWriteMany 卷 高可用：卷有多个副本（可设置），卷默认目录/var/lib/longhorn，进程pod在各节点都有运行。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4137ea9d5f6aa7275b106b5ab266da6a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-11T13:33:43+08:00" />
<meta property="article:modified_time" content="2024-01-11T13:33:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ceph、gluster、longhorn选型对比</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 style="margin-left:0;text-align:justify;">Ceph</h3> 
<p style="margin-left:.0001pt;text-align:justify;">Ceph是一个分布式的存储系统，可以在统一的系统中提供唯一的对象、块和文件存储。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="611" src="https://images2.imgbox.com/f4/d6/VdAgMoG9_o.png" width="865">名词解释：</p> 
<ol><li style="text-align:justify;">RADOS： 由自我修复、自我管理、智能存储节点组成的可靠、自主、分布式对象存储</li><li style="text-align:justify;">LIBRADOS： 一个允许应用程序直接访问 RADO 的库，支持 C、C++、Java、Python、Ruby 和 PHP</li><li style="text-align:justify;">RADOSGW： 基于存储桶的 REST网关，兼容s3和Swift</li><li style="text-align:justify;">RBD： 一个负责任的，完全-分布式块设备，使用Linux内核cliont和QEMU/KVM驱动程序</li><li style="text-align:justify;">CEPHFS： 符合POSIX标准的分发文件系统，具有Linux内核客户端和对FUSE的支持</li></ol> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">进程结构：</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p class="img-center"><img alt="https://docs.ceph.com/en/latest/_images/ditaa-a05e8639fc0d9031e9903a52a15a18e182d673ff.png" height="98" src="https://images2.imgbox.com/c1/29/mg8pwWH6_o.png" width="690"></p> 
<ol><li style="text-align:justify;">1. Ceph监视器(ceph-mon)：用来维护集群状态的映射，包括监视器映射，管理器映射，OSD映射，MDS映射和CRUSH映射，这些映射是ceph守护程序相互协调所需的关键状态，另外还负责客户端到ceph存储的身份验证；通常要实现高可用，需要3个或以上的ceph-mon服务</li><li style="text-align:justify;">2. Ceph管理器(ceph-mgr)：ceph manager守护进程负责跟踪运行时指标和ceph集群当前的状态，包括存储利用率，当前性能指标和系统负载等，ceph-mgr还托管一些python模块，以实现基于web的ceph仪表盘和rest api，通常要实现高可用至少需要2个ceph-mgr进程，通常ceph-mon和ceph-mgr个数相同，1个ceph-mon同节点会伴随1个ceph-mgr守护进程。Mgr有主从之分。</li><li style="text-align:justify;">3. Ceph对象存储(ceph-osd)：Ceph OSD是对象存储守护程序，是用来存储数据的核心组件，实现数据存储、数据复制和恢复、数据的重新平衡，并会检查其他Ceph OSD守护程序的心跳来向ceph-mon和ceph-mgr提供一些监控信息，通常至少需要3个ceph-osd才能实现冗余和高可用性，部署的时候ceph-osd会和ceph-mon分开节点部署.</li><li style="text-align:justify;">4. Ceph元数据服务(ceph-mds)：Ceph MDS为ceph文件系统存储元数据，注意Ceph块设备和对象存储不用mds存储元数据，Ceph MDS允许POSIX文件系统用户执行基本命令，而不会将压力都集中到Ceph OSD集群上，通常mds可以选择部署至少2个节点，可以和其他组件一起也可以分开。Mds有主从之分。</li></ol> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">存储过程：首先osd需要干净的磁盘或分区。为文件计算一个值，根据值放在某个pg上（pg属于某个osd），文件的其他副本放到其他osd上。</p> 
<p style="margin-left:.0001pt;text-align:justify;">文件实际是使用对象存储存到osd上，因为脱离了linux文件系统，所以无法在磁盘直观的看到文件，只能通过ceph挂载查看。</p> 
<h3 style="margin-left:0;text-align:justify;">Gluster</h3> 
<p style="margin-left:.0001pt;text-align:justify;">Gluster 是一个可扩展的分布式文件系统。有点像nfs，可以把gluster-server所在节点的目录作为存储目录，gluster-client进行挂载。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">进程结构：gluster-server进程，gluster-client进程。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">卷类型：</p> 
<ol><li style="text-align:justify;">分布卷：如文件1放在节点1，文件2放在节点2。</li><li style="text-align:justify;">复制卷，有两个server节点，文件1在两个节点都存有一份文件。</li><li style="text-align:justify;">分散卷：文件1分成两块，一块放在节点1，另一块放在节点2，这样读写更快。</li><li style="text-align:justify;">分布复制卷：节点 1234，文件1在节点12，文件2在节点34。</li><li style="text-align:justify;">分布分散，节点1234，文件1的两块各在12，文件2的两块各在34。</li></ol> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">高可用gluster-server部署两个以上的节点，gluster-server没有主从之分、是对等的。通过复制卷可以实现数据高可用，一个文件分别存在两个节点上，有一个节点宕机，文件依然能正常读写。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h3 style="margin-left:0;text-align:justify;">Longhorn</h3> 
<p style="margin-left:.0001pt;text-align:justify;">Longhorn 是一款Kubernetes 分布式块存储系统。只能用k8s部署。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">进程结构：</p> 
<ol><li style="text-align:justify;">Longhorn Backing Image Manager：支持磁盘中的备份映像下载、同步和删除</li><li style="text-align:justify;">Longhorn Engine：核心控制器/副本逻辑。每个卷对应一个engine。</li><li style="text-align:justify;">Longhorn Instance Manager：控制器/副本实例生命周期管理</li><li style="text-align:justify;">Longhorn Manager：Longhorn 编排，包括适用于 Kubernetes 的 CSI 驱动程序</li><li style="text-align:justify;">Longhorn Share Manager：NFS 置备程序，将 Longhorn 卷公开为 ReadWriteMany 卷</li><li style="text-align:justify;">Longhorn UI：NFS 置备程序，将 Longhorn 卷公开为 ReadWriteMany 卷</li></ol> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">高可用：卷有多个副本（可设置），卷默认目录/var/lib/longhorn，进程pod在各节点都有运行。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">容器通过pv使用卷，文件在宿主机目录不能查看。</p> 
<h3 style="margin-left:0;text-align:justify;">比较</h3> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;"></p> </td><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">Ceph</p> </td><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">Gluster</p> </td><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">Longhorn</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">定位</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">分布式存储系统</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">分布式文件系统</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">分布式块存储系统</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">使用Linux文件系统</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">否</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">是</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">否</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">进程种类</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">4</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">2</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">6</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">安装方式</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">手动安装、k8s</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">手动安装</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">K8s</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">安装维护难度</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">高</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">低</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">中</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">UI页面</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">可额外加</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">无</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">有</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">额外功能</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">块存储、对象存储</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">-</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">可视化页面维护卷、快照、备份、恢复、定时任务</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">官方最低硬件</p> <p style="margin-left:.0001pt;text-align:justify;">(cpu/ram/disk)</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">Osd:1c,4g </p> <p style="margin-left:.0001pt;text-align:justify;">Mon:2c,5g,100g</p> <p style="margin-left:.0001pt;text-align:justify;">Mds:2c,2g,1g</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">-</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">3节点，每个节点4c,4g</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">Pod配置卷</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">支持</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">1.25移除</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">不支持</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">PV持久卷</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">支持</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">-</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">支持</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">高可用故障测试</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">有停顿时间，无法读写，等待pg降级</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">有停顿时间，无法读写</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">-</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">缺点</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">安装、维护复杂</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">不能通过pv使用，测试同步文件有两秒延迟</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">宿主机无法查看文件，运维无法在宿主机生成配置文件</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">优点</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">功能全</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">使用简单</p> </td><td style="vertical-align:top;width:103.7pt;"> <p style="margin-left:.0001pt;text-align:justify;">K3s推荐使用</p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e3e97df165a5a7e58d8b4f303a8c2ea3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">鸿蒙HarmonyOS兼容JS的类Web开发-开发指导</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ce8f6f6ec960006c38525913cdc2a291/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">社区论坛小圈子小程序源码系统：自定义小程序管理 带完整的安装代码包以及搭建教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>