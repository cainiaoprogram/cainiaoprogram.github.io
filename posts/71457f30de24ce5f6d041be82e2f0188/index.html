<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>.Net C# 免费PDF合成软件 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content=".Net C# 免费PDF合成软件" />
<meta property="og:description" content="最近用到pdf合成，发现各种软件均收费啊，这个技术非常简单，别人写好的库一大把，这里用到了PDFsharp，项目地址Home of PDFsharp and MigraDoc Foundation
软件下载地址
https://download.csdn.net/download/g313105910/88014569
源码下载地址
https://download.csdn.net/download/g313105910/88014573
废话不多说，上WPF代码
&lt;Window x:Class=&#34;mergePDF.MainWindow&#34; xmlns=&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34; xmlns:x=&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34; xmlns:d=&#34;http://schemas.microsoft.com/expression/blend/2008&#34; xmlns:mc=&#34;http://schemas.openxmlformats.org/markup-compatibility/2006&#34; xmlns:local=&#34;clr-namespace:mergePDF&#34; mc:Ignorable=&#34;d&#34; Title=&#34;PDF合成器,有顺序要求请用数字给文件命名，从小到大排序&#34; Height=&#34;450&#34; Width=&#34;800&#34;&gt; &lt;Grid&gt; &lt;Grid.RowDefinitions&gt; &lt;RowDefinition Height=&#34;10*&#34;/&gt; &lt;RowDefinition Height=&#34;33*&#34;/&gt; &lt;/Grid.RowDefinitions&gt; &lt;Grid.ColumnDefinitions&gt; &lt;ColumnDefinition/&gt; &lt;/Grid.ColumnDefinitions&gt; &lt;Button Content=&#34;合成&#34; HorizontalAlignment=&#34;Left&#34; Margin=&#34;737,0,0,0&#34; VerticalAlignment=&#34;Center&#34; Click=&#34;ButtonStart_Click&#34; Height=&#34;19&#34; Width=&#34;28&#34;/&gt; &lt;Button Content=&#34;选择目录&#34; HorizontalAlignment=&#34;Left&#34; Margin=&#34;675,0,0,0&#34; VerticalAlignment=&#34;Center&#34; Click=&#34;ButtonUrl_Click&#34; Height=&#34;19&#34; Width=&#34;52&#34;/&gt; &lt;TextBox x:Name=&#34;Url_Text&#34; HorizontalAlignment=&#34;Left&#34; Margin=&#34;60,0,0,0&#34; TextWrapping=&#34;Wrap&#34; Text=&#34;&#34; VerticalAlignment=&#34;Center&#34; Width=&#34;600&#34; Height=&#34;17&#34;/&gt; &lt;Label Content=&#34;Url:&#34; HorizontalAlignment=&#34;Left&#34; Margin=&#34;25,0,0,0&#34; VerticalAlignment=&#34;Center&#34;/&gt; &lt;TextBox x:Name=&#34;Info_Text&#34; TextWrapping=&#34;Wrap&#34; VerticalScrollBarVisibility=&#34;Visible&#34; Text=&#34;&#34; Grid.Row=&#34;1&#34;/&gt; &lt;/Grid&gt; &lt;/Window&gt; using FolderBrowserEx; using PdfSharp." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/71457f30de24ce5f6d041be82e2f0188/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-08T16:25:14+08:00" />
<meta property="article:modified_time" content="2023-08-08T16:25:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">.Net C# 免费PDF合成软件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>最近用到pdf合成，发现各种软件均收费啊，这个技术非常简单，别人写好的库一大把，这里用到了PDFsharp，项目地址<a href="https://docs.pdfsharp.net/" rel="nofollow" title="Home of PDFsharp and MigraDoc Foundation">Home of PDFsharp and MigraDoc Foundation</a></p> 
<p>软件下载地址</p> 
<p><a href="https://download.csdn.net/download/g313105910/88014569" title="https://download.csdn.net/download/g313105910/88014569">https://download.csdn.net/download/g313105910/88014569</a></p> 
<p>源码下载地址</p> 
<p><a href="https://download.csdn.net/download/g313105910/88014573" title="https://download.csdn.net/download/g313105910/88014573">https://download.csdn.net/download/g313105910/88014573</a></p> 
<p>废话不多说，上WPF代码</p> 
<pre><code class="language-cs">&lt;Window x:Class="mergePDF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:mergePDF"
        mc:Ignorable="d"
        Title="PDF合成器,有顺序要求请用数字给文件命名，从小到大排序" Height="450" Width="800"&gt;
    &lt;Grid&gt;
        &lt;Grid.RowDefinitions&gt;
            &lt;RowDefinition Height="10*"/&gt;
            &lt;RowDefinition Height="33*"/&gt;
        &lt;/Grid.RowDefinitions&gt;
        &lt;Grid.ColumnDefinitions&gt;
            &lt;ColumnDefinition/&gt;
        &lt;/Grid.ColumnDefinitions&gt;
        &lt;Button Content="合成" HorizontalAlignment="Left" Margin="737,0,0,0" VerticalAlignment="Center" Click="ButtonStart_Click" Height="19" Width="28"/&gt;
        &lt;Button Content="选择目录" HorizontalAlignment="Left" Margin="675,0,0,0" VerticalAlignment="Center" Click="ButtonUrl_Click" Height="19" Width="52"/&gt;
        &lt;TextBox x:Name="Url_Text" HorizontalAlignment="Left" Margin="60,0,0,0" TextWrapping="Wrap" Text="" VerticalAlignment="Center" Width="600" Height="17"/&gt;
        &lt;Label Content="Url:" HorizontalAlignment="Left" Margin="25,0,0,0" VerticalAlignment="Center"/&gt;
        &lt;TextBox x:Name="Info_Text" TextWrapping="Wrap" VerticalScrollBarVisibility="Visible"  Text="" Grid.Row="1"/&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;
</code></pre> 
<pre><code class="language-cs">using FolderBrowserEx;
using PdfSharp.Pdf;
using PdfSharp.Pdf.IO;
using System;
using System.Collections.Generic;
using System.IO;
using System.Windows;

namespace mergePDF
{
    /// &lt;summary&gt;
    /// Interaction logic for MainWindow.xaml
    /// &lt;/summary&gt;
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void ButtonStart_Click(object sender, RoutedEventArgs e)
        {
            Info_Text.Text = string.Empty;
            CombinePdfFiles(Url_Text.Text);
        }

        public void CombinePdfFiles(string folderPath)
        {
            try
            {
                //读取文件夹中的文件夹
                int fileCount = 0;
                int pageCount = 0;
                PdfDocument outPdfFile = new PdfDocument();
                List&lt;string&gt; fileNameList = new List&lt;string&gt;();
                List&lt;string&gt; fileError = new List&lt;string&gt;();
                fileNameList.Add("开始合并");
                foreach (var filename in Directory.GetFiles(folderPath))
                {
                    if (System.IO.Path.GetExtension(filename) == ".pdf")
                    {
                        try
                        {
                            PdfDocument pdfFile = PdfReader.Open(filename, PdfDocumentOpenMode.Import);
                            fileCount++;
                            pageCount += pdfFile.PageCount;
                            int pageIndex = 0;
                            foreach (var pdfPage in pdfFile.Pages)
                            {
                                outPdfFile.AddPage(pdfPage);
                                pageIndex++;
                                fileNameList.Add(string.Format("文件名:{0}\t\t\t\t第{1}页\t文件共有{2}页", System.IO.Path.GetFileName(filename), pageIndex, pdfFile.PageCount));
                            }
                        }
                        catch (Exception ex)
                        {
                            fileError.Add(System.IO.Path.GetFileName(filename));
                            Info_Text.Text += ex.Message + "\r\n";
                        }
                    }
                }
                string combineResult = "";
                if (fileCount &gt; 0)
                {
                    //导出pdf文件
                    string timeTag = DateTime.Now.ToString("MMdd_HH_mm_ss");
                    SavePdfFile(folderPath + "\\合并", timeTag + ".pdf", outPdfFile);
                    fileNameList.Add(string.Format("共 {0} 个文件，共 {1} 页。", fileCount, pageCount));
                    if (fileError.Count &gt; 0)
                    {
                        fileNameList.Add("合并失败文件：");
                        foreach (string p in fileError)
                        {
                            fileNameList.Add(p);
                        }
                    }
                    SaveTxtFile(folderPath + "\\合并", timeTag + ".txt", fileNameList);
                }
                combineResult = string.Format("合并成功文件数量：{0}", fileCount);
                if (fileError.Count &gt; 0)
                {
                    combineResult += "\r\n";
                    combineResult += string.Format("合并失败文件数量：{0}", fileError.Count);
                }
                foreach(var str in fileNameList)
                {
                    Info_Text.Text += str + "\r\n"; ;
                }
                Info_Text.Text += combineResult + "\r\n"; 
            }
            catch (Exception ex)
            {
                Info_Text.Text+=ex.Message + "\r\n";
            }
            Info_Text.ScrollToEnd();
        }
        private void SavePdfFile(string folderPath, string fileName, PdfDocument pdfFile)
        {
            if (!Directory.Exists(folderPath))
            {
                Directory.CreateDirectory(folderPath);
            }
            pdfFile.Save(folderPath + "\\" + fileName);
        }
        private void SaveTxtFile(string folderPath, string fileName, List&lt;string&gt; content)
        {
            if (!Directory.Exists(folderPath))
            {
                Directory.CreateDirectory(folderPath);
            }
            string fileFullPath = folderPath + "\\" + fileName;
            if (!File.Exists(fileFullPath))
            {
                var newFile = File.CreateText(fileFullPath);
                newFile.Close();
            }
            using (StreamWriter sw = new StreamWriter(fileFullPath, true))
            {
                foreach (string line in content)
                {
                    sw.WriteLine(line);
                }
                sw.Close();
            }
        }

        private void ButtonUrl_Click(object sender, RoutedEventArgs e)
        {
            FolderBrowserDialog folderBrowserDialog = new FolderBrowserDialog();
            folderBrowserDialog.Title = "Select a folder";
            //folderBrowserDialog.InitialFolder = @"C:\";
            folderBrowserDialog.AllowMultiSelect = false;
            if (folderBrowserDialog.ShowDialog() == System.Windows.Forms.DialogResult.OK)
            {
                Url_Text.Text = folderBrowserDialog.SelectedFolder;
            }
        }
    }
}
</code></pre> 
<p>使用方法-&gt;打开软件</p> 
<p><img alt="" height="450" src="https://images2.imgbox.com/62/27/k4kqrTZO_o.png" width="800"></p> 
<p>选择目录</p> 
<p><img alt="" height="450" src="https://images2.imgbox.com/a3/8b/C8TChCCp_o.png" width="800"></p> 
<p>合成成功</p> 
<p><img alt="" height="439" src="https://images2.imgbox.com/05/78/uQgXmHnc_o.png" width="788"></p> 
<p>合并后的文件和日志</p> 
<p><img alt="" height="107" src="https://images2.imgbox.com/30/ba/27qjdvhX_o.png" width="512"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/065fb29f15e6bd621afa197ddb7e38fa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JAVA实现图书管理系统（思路，和完整代码）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e801198b2e88ae3d06c2256c2372e831/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">js：Markdown编辑器Vue3版本md-editor-v3</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>