<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql用户关注店铺表_求助微博关注用户表的设计 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql用户关注店铺表_求助微博关注用户表的设计" />
<meta property="og:description" content="本帖最后由 anydy2008 于 2013-10-11 10:43:13 编辑
查询需求如下：
1.查询关注了哪些用户。
2.查询被哪些用户关注了。
3.查询和某个用户共同的关注列表。
4.查询是否互相关注。
用一个表，以 user_id follow_user_id add_time列的形式可以实现上述功能。
可是关注量比较大，需要按用户 id来分表。不知道怎样设计表结构好。
求助友友们，请多多给建议。 谢谢
回复讨论(解决方案)
以 用户id 来分区
用户ID吧，每个表之间都用用户id
以 用户id 来分区
版主 我是想用用用户id来分表，可是分表后上面的功能就不好实现了。比如我要查 哪些用户关注了我，分表后；我不确定要查哪个表。只有将所有分表都查一次才可以知道。
单独保存一个关注表
或者把关注你的用户也存到用户表里可行不？
正因为分表后不确定要查哪个表，所以不能分表而是分区
分区后的表对你而言依然是一个整表(虽然被分成了多个文件)，实际查询的是那个文件由mysql决定而不是你决定
如果你依然想自己分表，那么需要交换 user_id、follow_user_id 列的内容形成新表，再对两个表分表
以 用户id 来分区
版主 我是想用用用户id来分表，可是分表后上面的功能就不好实现了。比如我要查 哪些用户关注了我，分表后；我不确定要查哪个表。只有将所有分表都查一次才可以知道。
不要分表呀，直接写sql语句就可以了
1.查询关注了哪些用户：select `follow_user_id` from `表` where `user_id`=&#39;你的id&#39;
2.查询被哪些用户关注了：select `user_id` from `表` where `follow_user_id`=&#39;你的id&#39;
3.查询和某个用户共同的关注列表。select * from `表` where `user_id` in (&#39;你的id&#39;, &#39;某个用户id&#39;)
4.查询是否互相关注:select * from `表` where `user_id`=&#39;你的id&#39; and `follow_user_id`=&#39;某个用户id&#39; `user_id` in (select `follow_user_id` from `表` where `user_id`=&#39;某个用户id&#39;)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ed6417cccc91b4b893a6f68ac890f8fb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-28T11:31:42+08:00" />
<meta property="article:modified_time" content="2021-02-28T11:31:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql用户关注店铺表_求助微博关注用户表的设计</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>本帖最后由 anydy2008 于 2013-10-11 10:43:13 编辑</p> 
 <p>查询需求如下：</p> 
 <p>1.查询关注了哪些用户。</p> 
 <p>2.查询被哪些用户关注了。</p> 
 <p>3.查询和某个用户共同的关注列表。</p> 
 <p>4.查询是否互相关注。</p> 
 <p>用一个表，以 user_id follow_user_id add_time列的形式可以实现上述功能。</p> 
 <p>可是关注量比较大，需要按用户 id来分表。不知道怎样设计表结构好。</p> 
 <p>求助友友们，请多多给建议。 谢谢</p> 
 <p>回复讨论(解决方案)</p> 
 <p>以 用户id 来分区</p> 
 <p>用户ID吧，每个表之间都用用户id</p> 
 <p>以 用户id 来分区</p> 
 <p>版主 我是想用用用户id来分表，可是分表后上面的功能就不好实现了。比如我要查 哪些用户关注了我，分表后；我不确定要查哪个表。只有将所有分表都查一次才可以知道。</p> 
 <p>单独保存一个关注表</p> 
 <p>或者把关注你的用户也存到用户表里可行不？</p> 
 <p>正因为分表后不确定要查哪个表，所以不能分表而是分区</p> 
 <p>分区后的表对你而言依然是一个整表(虽然被分成了多个文件)，实际查询的是那个文件由mysql决定而不是你决定</p> 
 <p>如果你依然想自己分表，那么需要交换 user_id、follow_user_id 列的内容形成新表，再对两个表分表</p> 
 <p>以 用户id 来分区</p> 
 <p>版主 我是想用用用户id来分表，可是分表后上面的功能就不好实现了。比如我要查 哪些用户关注了我，分表后；我不确定要查哪个表。只有将所有分表都查一次才可以知道。</p> 
 <p>不要分表呀，直接写sql语句就可以了</p> 
 <p>1.查询关注了哪些用户：select `follow_user_id` from `表` where `user_id`='你的id'</p> 
 <p>2.查询被哪些用户关注了：select `user_id` from `表` where `follow_user_id`='你的id'</p> 
 <p>3.查询和某个用户共同的关注列表。select * from `表` where `user_id` in ('你的id', '某个用户id')</p> 
 <p>4.查询是否互相关注:select * from `表` where `user_id`='你的id' and `follow_user_id`='某个用户id' `user_id` in (select `follow_user_id` from `表` where `user_id`='某个用户id')</p> 
 <p>当然估计还有更优秀的写法，特别是第4条</p> 
 <p>select * from `表` where `user_id`='你的id' and `follow_user_id`='某个用户id' and `user_id` in (select `follow_user_id` from `表` where `user_id`='某个用户id')第4条少了一个and,重新写一下</p> 
 <p>正因为分表后不确定要查哪个表，所以不能分表而是分区</p> 
 <p>分区后的表对你而言依然是一个整表(虽然被分成了多个文件)，实际查询的是那个文件由mysql决定而不是你决定</p> 
 <p>如果你依然想自己分表，那么需要交换 user_id、follow_user_id 列的内容形成新表，再对两个表分表</p> 
 <p>谢谢回答 我会参考一下的</p> 
 <p>正因为分表后不确定要查哪个表，所以不能分表而是分区</p> 
 <p>分区后的表对你而言依然是一个整表(虽然被分成了多个文件)，实际查询的是那个文件由mysql决定而不是你决定</p> 
 <p>如果你依然想自己分表，那么需要交换 user_id、follow_user_id 列的内容形成新表，再对两个表分表</p> 
 <p>版主 分区是什么概念呢。吾只懂电脑分区阿</p> 
 <p>还有这句话可以详细说一下吗</p> 
 <p>”那么需要交换 user_id、follow_user_id 列的内容形成新表，再对两个表分表“</p> 
 <p>谢谢啦！</p> 
 <p>关于表分区可参见 http://www.baidu.com/s?ie=utf-8&amp;bs=mysql%E5%88%86%E5%8C%BA%E8%A1%A8&amp;f=8&amp;rsv_bp=1&amp;wd=mysql%E5%88%86%E5%8C%BA&amp;rsv_sug3=1&amp;rsv_sug=1&amp;rsv_sug1=1&amp;rsv_sug4=26&amp;inputT=796</p> 
 <p>关注可以是单向的，比如这个user_id follow_user_id1 21 31 4</p> 
 <p>按 user_id 分表后，你整检查所有的表才能得到与 follow_user_id 相连的 user_id</p> 
 <p>所以你需要另有一组以 follow_user_id 分组的表</p> 
 <p>follow_user_id user_id 2 13 14 1</p> 
 <p>关于表分区可参见 http://www.baidu.com/s?ie=utf-8&amp;bs=mysql%E5%88%86%E5%8C%BA%E8%A1%A8&amp;f=8&amp;rsv_bp=1&amp;wd=mysql%E5%88%86%E5%8C%BA&amp;rsv_sug3=1&amp;rsv_sug=1&amp;rsv_sug1=1&amp;rsv_sug4=26&amp;inputT=796</p> 
 <p>关注可以是单向的，比如这个user_id follow_user_id1 21 31 4</p> 
 <p>按 user_id 分表后，你整检查所有的表才能得到与 follow_user_id 相连的 user_id</p> 
 <p>所以你需要另有一组以 follow_user_id 分组的表</p> 
 <p>follow_user_id user_id 2 13 14 1</p> 
 <p>版主</p> 
 <p>"follow_user_id 分组的表" 也是要分表的吧</p> 
 <p>那这个方案可以支持查，哪些人关注了我吗。</p> 
 <p>比如我的用户id是1 按follow_user_id 尾数进行分表。</p> 
 <p>follow_user_tbl_1</p> 
 <p>follow_user_id user_id</p> 
 <p>1 1</p> 
 <p>11 1</p> 
 <p>21 1</p> 
 <p>follow_user_tbl_2</p> 
 <p>follow_user_id user_id</p> 
 <p>2 1</p> 
 <p>12 1</p> 
 <p>22 1</p> 
 <p>如果 user_id follow_user_id 表示 user_id 被 follow_user_id 关注</p> 
 <p>那么 follow_user_id user_id 表示 follow_user_id 关注了 user_id</p> 
 <p>你把主体确定了，事情就清楚了</p> 
 <p>单独保存一个关注表</p> 
 <p>或者把关注你的用户也存到用户表里可行不？</p> 
 <p>单独保存一个关注表不大可行 因为数据量太大啦</p> 
 <p>关注我的用户存到用户表不合理</p> 
 <p>如果 user_id follow_user_id 表示 user_id 被 follow_user_id 关注</p> 
 <p>那么 follow_user_id user_id 表示 follow_user_id 关注了 user_id</p> 
 <p>你把主体确定了，事情就清楚了</p> 
 <p>版主 吾听了你的，开始明白你的想法啦。 谢谢了。要分表可能只有这样啦</p> 
 <p align="center"></p> 
 <p>本文原创发布php中文网，转载请注明出处，感谢您的尊重！</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/550e3a0070b218c0bcdf13f207651868/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java占用物理内存不释放_JMeter内存溢出：java.lang.OutOfMemoryError: Java heap space解决方法(实测有效)...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3639727239a23a495513220960caaa97/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">岛屿数量JAVA_算法练习帖--54--岛屿数量(Java)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>