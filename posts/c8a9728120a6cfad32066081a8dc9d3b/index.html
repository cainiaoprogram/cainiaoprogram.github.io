<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>用yolov4-tiny检测在电力输电线20种鸟类，灵活运用训练trick，实验较为完备，数据处理丰富度值得参考 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="用yolov4-tiny检测在电力输电线20种鸟类，灵活运用训练trick，实验较为完备，数据处理丰富度值得参考" />
<meta property="og:description" content="Detection of bird species related to transmission line faults based on lightweight convolutional neural network Abstract 输电线路高效防鸟害是电网运行维护面临的长期挑战。本文提出了一种将轻量级卷积神经网络(CNN)、图像处理和目标检测相结合的方法来检测与输电线路故障相关的典型鸟类。构建了威胁输电线路安全的20种鸟类图像数据集。结合分阶段训练、马赛克数据增强、余弦退火和标签平滑，构建并训练了YOLOv4-tiny算法模型。通过调整训练过程的参数，在测试集上的平均精度(mAP)可以达到92.04%。然后，根据测试结果和性能指标，与Faster RCNN、SSD、YOLOv4等方法进行比较，验证了所提方法的有效性。利用运动模糊、散焦模糊、对比度和亮度调节等图像预处理方法模拟了实际工程应用场景。该方法能够高效地检测出栖息在输电线路周围的鸟类，有助于对电网因鸟引起的停电进行差别化预防。
论文地址：Detection of bird species related to transmission line faults based on lightweight convolutional neural network - Qiu - 2022 - IET Generation, Transmission &amp; Distribution - Wiley Online Library
南昌大学信息工程学院 (ncu.edu.cn)
INTRODUCTION 随着电网的大规模建设和生态环境的改善，鸟类活动与输电线路之间的矛盾逐渐引起人们的关注。鸟类故障已成为继雷击和外力破坏之后，输电线路中断的第三大原因。据统计，2010 - 2019年，中国国家电网公司110 (66)kV及以上输电线路共发生鸟类活动相关故障2374起，占输电线路故障总数的10.4%。此外，与鸟类有关的停电仍呈上升趋势。
鸟类造成的主要故障包括鸟粪、筑巢、鸟身短路、啄木鸟停飞等。与鸟类相关的一些典型中断案例如下图所示。
(a)绝缘子表面的鸟粪，(b)绝缘子上方横臂上的鸟巢，©大鸟触电导致短路，(d)鸟啄复合绝缘子
鸟粪故障是指鸟粪的导电通道引起的输电线路跳闸;以及附着的鸟粪引起绝缘子表面闪络。巢断和鸟短路断是由相对相或相对地放电引起的，这种放电是由于鸟巢材料或鸟体减少绝缘距离而发生的。
啄型故障是指复合绝缘子因鸟啄型外壳或护套引起的绝缘子损坏或闪络。在输电走廊周围栖息的鸟类对输电线路安全构成不同程度的威胁。一些鸟类以输电线路为最佳觅食地，在输电塔或线路上站立或筑巢，可能造成鸟类粪便或筑巢中断。有些鸟类，如麻雀，喜欢栖息在电力线或塔上，但它们不容易引起故障。不同的鸟类可能造成不同的断层类型，它们的预防措施也不应该完全相同。
针对鸟类故障问题，人们对防鸟装置进行了大量的研究，如防鸟针、防鸟盾、防鸟箱等。Taklaja通过改进绝缘体结构来避免鸟类粪便引起的闪络，从而缩短了鸟类的停留时间。Yang通过研究鸟流引起绝缘子闪络的机理，讨论了防鸟装置的保护半径。Kuang提出了一种合理的护鸟挡板结构设计方案，并验证了其对电场分布的影响。大规模安装防鸟装置需要巨大的投资。
然而，根据经验和SGCC的统计结果，防鸟装置防止了一些与鸟有关的中断，但性能没有达到预期。材料老化、安装不规范、鸟类适应等往往导致防鸟装置失效，无法长期有效解决鸟损问题。此外，有些装置盲目驱赶鸟类，甚至对一些稀有珍贵鸟类造成伤害，如黑云杉、白云杉等，对生态环境造成不良影响。因此，有必要识别栖息在输电线路周围的鸟类，判断其风险等级和可能引起的故障类型，从而采取差异化和高效的预防措施，减少鸟类引起的故障，节省不必要的投资。
近年来，随着卷积神经网络(CNN)的发展，目标检测得到了广泛的研究和应用，与传统方法相比，其对目标识别的效果有了显著提高。目前常用的目标检测算法有R-CNN、Faster R-CNN、SSD、YOLOv3等，已应用于绝缘子缺陷、缺针缺陷等电气设备的检测。对于鸟类的识别与检测，Tian提出了航拍视频中捕捉飞鸟的glance and stare detection (GSD)框架;该算法利用放大算法生成区域建议，并利用三维卷积神经网络提取自适应深度时空特征。Sharma提出了一种基于YOLOv3的印度家麻雀检测方法，并与Tiny-YOLO、YOLOv2和Mask-RCNN同时进行了比较，结果表明，YOLOv3可以达到92%的检测准确率。Li提出了一种基于超分辨率(super-resolution, SR)的鸟类检测方法，在Faster RCNN中引入了VDSR、FSRCNN和DRRN三种方法进行鸟类检测，提高了精度。邹提出了一种基于YOLOv3的传输线周围鸟类数量检测方法，该方法采用扩展卷积取代原有卷积层，通过比例因子计算置信度得分，并对NMS算法进行优化，检测准确率达到86.31%。一般来说，以往对鸟类识别的研究通常集中在鸟类生态学领域，或者作为一个案例来验证图像识别或目标检测算法的有效性。对可能对电网造成安全隐患的有害鸟类的识别研究较少。
因此，为了解决上述问题，本文引入了一种轻量级的传输线鸟类CNN检测方法。构建了与输电线路故障相关的20种典型鸟类的图像数据集，并进行了图像处理，模拟了实际工程场景。结合多种训练方法，建立YOLOv4-tiny轻量化检测模型，学习鸟类图像的特征。根据性能评价指标，将鸟类检测结果与其他目标检测算法进行比较。该方法可以对与输电线路中断相关的20种典型鸟类进行差异检测。平均精度(mAP)和帧数每秒(FPS)分别达到92.04%和40。它可以用来识别输电线路周围的鸟类，为防鸟装置的安装提供参考，从而减少与鸟类有关的停电。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c8a9728120a6cfad32066081a8dc9d3b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-21T10:49:06+08:00" />
<meta property="article:modified_time" content="2023-08-21T10:49:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">用yolov4-tiny检测在电力输电线20种鸟类，灵活运用训练trick，实验较为完备，数据处理丰富度值得参考</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Detection_of_bird_species_related_to_transmission_line_faults_based_on_lightweight_convolutional_neural_network_0"></a>Detection of bird species related to transmission line faults based on lightweight convolutional neural network</h2> 
<h3><a id="Abstract_2"></a>Abstract</h3> 
<ul><li> <p>输电线路高效防鸟害是电网运行维护面临的长期挑战。本文提出了一种将轻量级卷积神经网络(CNN)、图像处理和目标检测相结合的方法来检测与输电线路故障相关的典型鸟类。构建了威胁输电线路安全的20种鸟类图像数据集。<strong>结合分阶段训练、马赛克数据增强、余弦退火和标签平滑，构建并训练了YOLOv4-tiny算法模型</strong>。通过调整训练过程的参数，在测试集上的平均精度(mAP)可以达到92.04%。然后，根据测试结果和性能指标，与Faster RCNN、SSD、YOLOv4等方法进行比较，验证了所提方法的有效性。利用运动模糊、散焦模糊、对比度和亮度调节等图像预处理方法模拟了实际工程应用场景。该方法能够高效地检测出栖息在输电线路周围的鸟类，有助于对电网因鸟引起的停电进行差别化预防。</p> </li><li> <p>论文地址：<a href="https://ietresearch.onlinelibrary.wiley.com/doi/full/10.1049/gtd2.12333" rel="nofollow">Detection of bird species related to transmission line faults based on lightweight convolutional neural network - Qiu - 2022 - IET Generation, Transmission &amp; Distribution - Wiley Online Library</a></p> </li><li> <p><a href="http://ies.ncu.edu.cn/xydt/xyxw/1f4b41fdc2c044c8a5e4ca086c37a4f9.htm" rel="nofollow">南昌大学信息工程学院 (ncu.edu.cn)</a></p> </li></ul> 
<h3><a id="INTRODUCTION_10"></a>INTRODUCTION</h3> 
<ul><li> <p>随着电网的大规模建设和生态环境的改善，鸟类活动与输电线路之间的矛盾逐渐引起人们的关注。鸟类故障已成为继雷击和外力破坏之后，输电线路中断的第三大原因。<strong>据统计，2010 - 2019年，中国国家电网公司110 (66)kV及以上输电线路共发生鸟类活动相关故障2374起，占输电线路故障总数的10.4%</strong>。此外，与鸟类有关的停电仍呈上升趋势。</p> </li><li> <p>鸟类造成的主要故障包括鸟粪、筑巢、鸟身短路、啄木鸟停飞等。与鸟类相关的一些典型中断案例如下图所示。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/4d/6d/i6G8nlQT_o.png" alt="在这里插入图片描述"></p> </li><li> <p>(a)绝缘子表面的鸟粪，(b)绝缘子上方横臂上的鸟巢，©大鸟触电导致短路，(d)鸟啄复合绝缘子</p> </li></ul> </li><li> <p>鸟粪故障是指鸟粪的导电通道引起的输电线路跳闸;以及附着的鸟粪引起绝缘子表面闪络。巢断和鸟短路断是由相对相或相对地放电引起的，这种放电是由于鸟巢材料或鸟体减少绝缘距离而发生的。</p> </li><li> <p>啄型故障是指复合绝缘子因鸟啄型外壳或护套引起的绝缘子损坏或闪络。在输电走廊周围栖息的鸟类对输电线路安全构成不同程度的威胁。一些鸟类以输电线路为最佳觅食地，在输电塔或线路上站立或筑巢，可能造成鸟类粪便或筑巢中断。<strong>有些鸟类，如麻雀，喜欢栖息在电力线或塔上，但它们不容易引起故障。不同的鸟类可能造成不同的断层类型，它们的预防措施也不应该完全相同</strong>。</p> </li><li> <p>针对鸟类故障问题，人们对防鸟装置进行了大量的研究，如防鸟针、防鸟盾、防鸟箱等。Taklaja通过改进绝缘体结构来避免鸟类粪便引起的闪络，从而缩短了鸟类的停留时间。Yang通过研究鸟流引起绝缘子闪络的机理，讨论了防鸟装置的保护半径。Kuang提出了一种合理的护鸟挡板结构设计方案，并验证了其对电场分布的影响。<strong>大规模安装防鸟装置需要巨大的投资</strong>。</p> </li><li> <p>然而，根据经验和SGCC的统计结果，防鸟装置防止了一些与鸟有关的中断，但性能没有达到预期。<strong>材料老化、安装不规范、鸟类适应等往往导致防鸟装置失效，无法长期有效解决鸟损问题</strong>。此外，有些装置盲目驱赶鸟类，甚至<strong>对一些稀有珍贵鸟类造成伤害，如黑云杉、白云杉等，对生态环境造成不良影响</strong>。因此，有必要识别栖息在输电线路周围的鸟类，判断其风险等级和可能引起的故障类型，从而采取差异化和高效的预防措施，减少鸟类引起的故障，节省不必要的投资。</p> </li><li> <p>近年来，随着卷积神经网络(CNN)的发展，目标检测得到了广泛的研究和应用，与传统方法相比，其对目标识别的效果有了显著提高。目前常用的目标检测算法有R-CNN、Faster R-CNN、SSD、YOLOv3等，已应用于绝缘子缺陷、缺针缺陷等电气设备的检测。对于鸟类的识别与检测，Tian提出了航拍视频中捕捉飞鸟的glance and stare detection (GSD)框架;该算法利用放大算法生成区域建议，并利用三维卷积神经网络提取自适应深度时空特征。Sharma提出了一种基于YOLOv3的印度家麻雀检测方法，并与Tiny-YOLO、YOLOv2和Mask-RCNN同时进行了比较，结果表明，YOLOv3可以达到92%的检测准确率。Li提出了一种基于超分辨率(super-resolution, SR)的鸟类检测方法，在Faster RCNN中引入了VDSR、FSRCNN和DRRN三种方法进行鸟类检测，提高了精度。邹提出了一种基于YOLOv3的传输线周围鸟类数量检测方法，该方法采用扩展卷积取代原有卷积层，通过比例因子计算置信度得分，并对NMS算法进行优化，检测准确率达到86.31%。一般来说，<strong>以往对鸟类识别的研究通常集中在鸟类生态学领域，或者作为一个案例来验证图像识别或目标检测算法的有效性</strong>。<strong>对可能对电网造成安全隐患的有害鸟类的识别研究较少</strong>。</p> </li><li> <p>因此，为了解决上述问题，本文引入了一种轻量级的传输线鸟类CNN检测方法。构建了与输电线路故障相关的20种典型鸟类的图像数据集，并进行了图像处理，模拟了实际工程场景。结合多种训练方法，建立YOLOv4-tiny轻量化检测模型，学习鸟类图像的特征。<strong>根据性能评价指标，将鸟类检测结果与其他目标检测算法进行比较。该方法可以对与输电线路中断相关的20种典型鸟类进行差异检测。平均精度(mAP)和帧数每秒(FPS)分别达到92.04%和40</strong>。它可以用来识别输电线路周围的鸟类，为防鸟装置的安装提供参考，从而减少与鸟类有关的停电。</p> </li></ul> 
<h3><a id="IMAGE_PROCESSING_33"></a>IMAGE PROCESSING</h3> 
<h4><a id="Transmission_line_related_bird_image_dataset_35"></a>Transmission line related bird image dataset</h4> 
<ul><li> <p>与输电线路故障有关的鸟类种类随地理环境和气候条件的不同而不同。根据国家电网委员会的调查和统计结果，可能造成输电线路故障的鸟类有40种是高危鸟类，50种是低危鸟类。本文选取20种典型鸟类进行研究，并建立了图像数据集，包括黑狐蝠、黑尾Sturnus nigricollis、绢尾Sturnus sericeus、cristatellus、Picapica、白狐蝠、Asio otus、中国Streptopelia chinensis、Cuculus canorus、Otis tarda、Ceryle rudis、Upupa epops、Anser cygnoides、Hirundo rustica、Oriolus chinensis、Corvus macrohynchos、Alcedo atthis、Egretta garzetta、Ardeola bacchus、Garrulax canorus。其中，黑凤仙花和凤仙花是中国国家一级保护动物，也是威胁架空输电线路的高危鸟类。上述数据集中的一些鸟类图像样本如下图所示。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/79/1c/7hu1g4K2_o.png" alt="在这里插入图片描述"></p> </li><li> <p>与传送带有关的典型鸟类图像(a)黑狐蝠，(b)黑狐蝠，©黄狐蝠，(d) cristatellus， (e) Picapica， (f)白狐蝠，(g) canorus， (h) Hirundo rustica， (i) Alcedo atthis， (j) Egretta garzetta</p> </li></ul> </li><li> <p>在实际工程中，对传输线上的鸟类图像进行采集是一件不容易的事情。为了提高鸟类检测模型的鲁棒性，需要在数据集中增加更多的图像样本。因此，我们<mark>从互联网上收集了</mark>一些图像，包括不同照明强度、背景、拍摄角度和物体大小的情况。每种鸟类包含400张图像，总共8000张图像样本。这样训练出来的模型对不同场景有更好的适应性。然后，<strong>使用MRLaber标记工具对鸟类图像进行矩形标记，包括类别和位置。位置信息包含在鸟类目标周围矩形框的坐标(xmin, xmax, ymin, ymax)中</strong>。</p> </li></ul> 
<h4><a id="Bird_image_preprocessing_46"></a>Bird image pre-processing</h4> 
<ul><li>在动态目标下获取的图像通常有较大的光线、角度和背景变化，直接影响模型的检测精度。<strong>本文对鸟类图像进行了处理，模拟了在实际工程应用中可能影响检测精度的因素，包括图像运动模糊、离焦模糊、对比度和亮度调整</strong>。</li></ul> 
<h5><a id="Motion_blur_50"></a>Motion blur</h5> 
<ul><li> <p>在拍摄过程中，相机相对于目标移动，导致图像模糊。然而，图像模糊的本质是与点扩散函数(PSF)卷积的结果，即</p> 
  <ul><li> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              g 
             
            
              ( 
             
            
              x 
             
            
              , 
             
            
              y 
             
            
              ) 
             
            
              = 
             
            
              f 
             
            
              ( 
             
            
              x 
             
            
              , 
             
            
              y 
             
            
              ) 
             
            
              ∗ 
             
            
              b 
             
            
              ( 
             
            
              x 
             
            
              , 
             
            
              y 
             
            
              ) 
             
            
              + 
             
            
              n 
             
            
              ( 
             
            
              x 
             
            
              , 
             
            
              y 
             
            
              ) 
             
            
           
             g(x,y)=f(x,y)*b(x,y)+n(x,y) 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span></span></span></span></span></span></p> </li><li> <p>其中，f(x, y) 和g(x, y)分别表示输入图像，运动模糊后，h(x, y)为对原始图像进行卷积的PSF模糊函数，n(x, y)为加性噪声函数。因此，<strong>运动模糊图像是一个清晰的图像与运动模糊函数卷积的结果</strong>。运动模糊函数的一般形式可以表示为</p> </li><li> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              b 
             
            
              ( 
             
            
              x 
             
            
              , 
             
            
              y 
             
            
              ) 
             
            
              = 
             
             
             
               1 
              
             
               L 
              
             
            
              i 
             
            
              f 
             
             
              
               
               
                 x 
                
               
                 2 
                
               
              
                + 
               
               
               
                 y 
                
               
                 2 
                
               
              
             
            
              ≤ 
             
             
             
               L 
              
             
               2 
              
             
            
              a 
             
            
              n 
             
            
              d 
             
             
             
               x 
              
             
               y 
              
             
            
              = 
             
            
              − 
             
            
              t 
             
            
              a 
             
            
              n 
             
            
              ( 
             
            
              ϕ 
             
            
              ) 
             
            
           
             b(x,y)=\frac1Lif\sqrt{x^2+y^2}\leq \frac L2and\frac xy=-tan(\phi) 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">L</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0067em;"><span class="svg-align" style="top: -3.2em;"><span class="pstrut" style="height: 3.2em;"></span><span class="mord" style="padding-left: 1em;"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.9667em;"><span class="pstrut" style="height: 3.2em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 1.28em;"> 
                <svg width="400em" height="1.28em" viewbox="0 0 400000 1296" preserveaspectratio="xMinYMin slice"> 
                 <path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path> 
                </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2333em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.2408em; vertical-align: -0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1076em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.8804em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mord mathnormal">t</span><span class="mord mathnormal">an</span><span class="mopen">(</span><span class="mord mathnormal">ϕ</span><span class="mclose">)</span></span></span></span></span></span></p> </li><li> <p>其中L和φ是运动模糊的长度和方向。</p> </li></ul> </li></ul> 
<h5><a id="Defocus_blur_66"></a>Defocus blur</h5> 
<ul><li> <p><strong>由于无人机等图像采集设备的抖动，鸟类目标可能无法准确对焦，导致图像离焦模糊</strong>。与图像运动模糊相似，离焦模糊是清晰图像与离焦函数 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            b 
           
          
            r 
           
          
         
           ( 
          
         
           x 
          
         
           , 
          
         
           y 
          
         
           ) 
          
         
        
          b_r(x, y) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span></span></span></span></span> 卷积的结果。离焦模糊的数学表达式为</p> 
  <ul><li> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
          
           
            
             
             
               b 
              
             
               r 
              
             
            
              ( 
             
            
              x 
             
            
              , 
             
            
              y 
             
            
              ) 
             
            
              = 
             
             
             
               1 
              
              
              
                π 
               
               
               
                 r 
                
               
                 2 
                
               
              
             
             
              
               
               
                 x 
                
               
                 2 
                
               
              
                + 
               
               
               
                 y 
                
               
                 2 
                
               
              
             
            
              ≤ 
             
            
              r 
             
            
                 
             
            
              o 
             
            
              t 
             
            
              h 
             
            
              e 
             
            
              r 
             
            
                 
             
            
              0 
             
            
           
             b_r(x,y)=\frac{1}{\pi r^2}\sqrt{x^2+y^2}\leq r~~other ~~0 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0067em;"><span class="svg-align" style="top: -3.2em;"><span class="pstrut" style="height: 3.2em;"></span><span class="mord" style="padding-left: 1em;"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.9667em;"><span class="pstrut" style="height: 3.2em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 1.28em;"> 
                <svg width="400em" height="1.28em" viewbox="0 0 400000 1296" preserveaspectratio="xMinYMin slice"> 
                 <path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path> 
                </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2333em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right: 0.0278em;">er</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord">0</span></span></span></span></span></span></p> </li><li> <p>其中r为散焦模糊的半径。</p> </li></ul> </li><li> <p>通过运动和离焦模糊图像验证了检测模型在工程应用中的鲁棒性。运动模糊的长度(L)设置为10像素，方向(φ) w为15◦。散焦模糊半径r设为5像素。以黑鲈为例，运动模糊和散焦模糊处理后的图像如下图所示。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/fb/f0/IxmziMBV_o.png" alt="在这里插入图片描述"></p> </li><li> <p>运动模糊和散焦模糊后的鸟类图像(a)原始图像，(b)选定区域，©运动模糊后的图像，(d)散焦模糊后的图像（bcd有什么明显的变化吗？）</p> </li></ul> </li></ul> 
<h5><a id="Contrast_and_brightness_adjustment_83"></a>Contrast and brightness adjustment</h5> 
<ul><li> <p><strong>不同时间和天气条件下的图像会导致目标和背景的光照强度不同。采用线性变换对鸟类图像的对比度和亮度进行调整</strong>，模拟其对检测精度的影响，可以表示为</p> 
  <ul><li> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
          
           
            
             
             
               g 
              
             
               n 
              
             
            
              ( 
             
            
              x 
             
            
              , 
             
            
              y 
             
            
              ) 
             
            
              = 
             
            
              α 
             
            
              f 
             
            
              ( 
             
            
              x 
             
            
              , 
             
            
              y 
             
            
              ) 
             
            
              + 
             
            
              β 
             
             
             
               f 
              
             
               0 
              
             
            
              + 
             
            
              γ 
             
            
           
             g_n(x,y)=\alpha f(x,y)+\beta f_0+\gamma 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0556em;">γ</span></span></span></span></span></span></p> </li><li> <p>其中f(x, y) 和 gn(x, y)为原始图像和调整后的图像，f0为与f(x, y)大小相同的零像素图像，α和γ用于调整对比度和亮度，β为零像素图像的倍数，β = 1-α。</p> </li></ul> </li><li> <p>根据【Detection and evaluation method of transmission line defects based on deep learning】α设为0.4、0.6、0.8、1.0、1.2、1.4，γ设为−20、−10、0、20、40。在原图像γ = 0或者α = 1的基础上，将γ &lt; 0 或α &lt; 1的图像模拟为多云天气或午后光照条件;γ &gt; 0或α &gt; 1的图像是模拟晴天或清晨光照条件。以Ciconia nigra图像为例，在α和γ两个极值下，对比度和亮度调整后的图像如下图所示。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/57/d9/rRGM95Mt_o.png" alt="在这里插入图片描述"></p> </li><li> <p>对比度和亮度调整后的鸟类图像(a) α = 1.0， γ = 0， (b) α = 1.4， γ = 40， © α = 0.4， γ = - 20</p> </li></ul> </li></ul> 
<h3><a id="TRANSMISSION_LINE_RELATED_BIRD_DETECTION_METHOD_100"></a>TRANSMISSION LINE RELATED BIRD DETECTION METHOD</h3> 
<h4><a id="Basic_principle_of_YOLOv4tiny_algorithm_102"></a>Basic principle of YOLOv4-tiny algorithm</h4> 
<ul><li> <p>目标检测模型的基本结构是一个CNN，它是一种基于卷积运算的深度学习网络，主要由卷积层、池化层、全连接层和输出层组成。卷积层通过卷积核提取输入图像的特征，最后几个卷积层可以提取图像最显著的特征，即语义特征。池化层利用池化函数对卷积层提取的特征图进行下采样。</p> </li><li> <p>常用的池化操作有max-pooling和average pooling，它们可以减少特征维数，从而减少参数数量和计算量，避免过拟合。激活函数用于增加输入和输出之间的非线性。<strong>全连接层对提取的特征进行汇总，输入softmax层进行分类，softmax层将输出目标的位置和类别</strong>。</p> </li><li> <p>常用的基于深度CNN的目标检测算法可以分为两阶段框架，如Faster RCNN，和一阶段框架，如SSD和YOLO。在这些算法中，YOLOv4是最近提出的精度最优的目标检测模型。但是YOLOv4的应用对计算资源的要求很高。<strong>为了使目标检测模型轻量化，引入了YOLOv4-tiny算法对鸟类物种进行检测，大大减少了计算量，与原有的YOLOv4模型相比，检测速度更快</strong>。</p> </li><li> <p>下图是基于YOLOv4-tiny算法的鸟类检测方法示意图。<strong>检测过程主要包括图像数据集构建、图像预处理、YOLOv4-tiny模型的训练、鸟类图像的检测</strong>。其中，最关键的部分是yolov4微型模型的构建和训练。</p> 
  <ul><li><img src="https://images2.imgbox.com/43/ab/ZiVDGFuW_o.png" alt="在这里插入图片描述"></li></ul> </li><li> <p>YOLOv4-tiny是基于YOLOv4的轻量级目标检测模型，简化了网络结构，减少了参数，使其更适合电网中智能检测设备的实际部署。下图是YOLOv4-tiny模型与YOLOv4的网络结构对比图。它的结构可以分为三个部分:骨干(CSPDarkNet53-tiny)、颈部(FPN)和头部(YOLO-head)。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/87/ab/ZB10WLVE_o.png" alt="在这里插入图片描述"></p> </li><li> <p>YOLOv4-tiny模型与YOLOv4模型的网络结构对比(a) YOLOv4结构，(b) YOLOv4-tiny结构</p> </li></ul> </li><li> <p>检测原理可归纳为:(i)通过CSPDarkNet53-tiny特征提取网络从输入图像中提取一系列不同大小的特征图;采用FPN网络融合不同尺度的特征;(iii)根据不同比尺(13 × 13和26 × 26)的融合特征图，利用YOLO-head预测鸟类目标的类别和位置。</p> </li></ul> 
<h3><a id="Network_structure_124"></a>Network structure</h3> 
<ul><li> <p>在YOLOv4模型中，SPP模块、PANet模块和CSP模块的X残差模块是导致模型参数增大的关键因素。为了实现更快的检测，如上图所示，YOLOv4-tiny模型改变了许多结构。网络结构的修改总结如下:</p> 
  <ul><li> <p>首先，对于YOLOv4的CSPDarkNet53, YOLOv4-tiny减少了CSP模块的数量，将X残差模块简化为单个残差模块，并使用CBL (Conv, BN, Leaky_ReLU)和多池化层来实现特征通道的压缩，从而减少特征提取网络中的参数数量。<strong>骨干CSPDarkNet53-tiny通过将Mish激活函数改为Leaky_ReLU激活函数，从CBM模块切换到CBL模块</strong>。Leaky_ReLU激活函数的计算原理可以表示为</p> </li><li> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              L 
             
            
              e 
             
            
              a 
             
            
              k 
             
             
             
               y 
              
             
               R 
              
             
            
              e 
             
            
              L 
             
            
              U 
             
            
              = 
             
             
             
               x 
              
             
               p 
              
             
            
                 
             
            
              i 
             
            
              f 
             
            
                
             
             
             
               x 
              
             
               p 
              
             
            
              &gt; 
             
            
              0 
             
            
                 
             
            
              o 
             
            
              t 
             
            
              h 
             
            
              e 
             
            
              r 
             
            
                
             
            
              w 
             
             
             
               x 
              
             
               p 
              
             
            
           
             Leaky_ReLU=x_p~~if~x_p&gt;0 ~~ other~wx_p 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.0315em;">ak</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0077em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.109em;">LU</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;"></span><span class="mord">0</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right: 0.0278em;">er</span><span class="mspace nobreak"> </span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> </li><li> <p>其中xp表示上一层的输出，ω为xp≤0时对应曲线的斜率，本文设为0.1。</p> </li><li> <p>YOLOv4-tiny模型还减少了CSP网络模块中残差单元的数量。在YOLOv4中，每个CSP模块中都有X个小残差模块，每个小残差模块都以前一层的输出作为输入，通过CBM模块后再将通道与特征<strong>拼接</strong>起来。最后，将CSP的大残留路由与小残留模块的输出连接起来，这是一种跨级部分连接(cross-stage partial connection, CSP)。然而，在YOLOv4-tiny中，CSP模块只有一个小的残差模块。</p> </li><li> <p>其次，对于YOLOv4的SPP和PANet, YOLOv4-tiny删除了SPP网络，将SPP网络前后的CBL模块简化为一个，用FPN网络代替PANet，这样可以减少深浅特征融合时的参数数量。</p> </li><li> <p>YOLOv4的颈部包含一个SPP模块和一个PANet模块。SPP模块的原理是用5 × 5、9 × 9、13 × 13和1 × 1滤波器通过最大池化层连接通道。PANet模块是基于FPN的特征融合模块，如下图所示。可以发现，PANet和FPN模块的原理是深层和浅层之间的特征融合。<strong>FPN是上采样后的深层特征信息与浅层特征信息的融合。除了这样一个过程之外，PANet还具有下采样后的浅层特征信息与深层特征信息的特征融合。其目的是增强提取的特征信息</strong>。</p> </li><li> <p><img src="https://images2.imgbox.com/8d/18/dIvnlEhM_o.png" alt="在这里插入图片描述"></p> </li><li> <p>FPN的结构与PANet的比较</p> </li><li> <p>此外，YOLOv4-tiny将三个尺度特征(52 × 52,26 × 26,13 × 13)简化为两个尺度特征(26 × 26,13 × 13)，从而减少了提取特征所带来的计算次数。<strong>经过FPN模块后，可以得到不同尺度的特征图。然后，将融合后的特征映射重构为13 × 13 × 75和26 × 26 × 75，多尺度检测示意图如下图所示。对于一个尺度特征图，如13 × 13，将使用三个锚点进行检测，每个锚点将使用25个参数进行预测，其中包括4个预测边界框的坐标参数，1个预测边界框的置信度分数和每个类别的20个概率分数参数</strong>。</p> </li><li> <p><img src="https://images2.imgbox.com/5c/35/UN81I2Pn_o.png" alt="在这里插入图片描述"></p> </li><li> <p>多尺度检测原理图</p> </li></ul> </li></ul> 
<h3><a id="Training_method_154"></a>Training method</h3> 
<ul><li>为了提高模型的精度和泛化能力，引入了分阶段训练、Mosaic数据增强、余弦退火和标签平滑等方法对模型进行训练。</li></ul> 
<h5><a id="Stagewise_training_158"></a>Stage-wise training</h5> 
<ul><li>在训练模型时，<strong>对预训练模型的参数进行迁移进行学习的效果比随机初始化参数要好，并且对参数进行合理的冻结和微调，既提高了训练效率，又避免了由于训练集小而导致的过拟合</strong>。采用以下两个步骤进行分阶段训练:(i)在Pascal VOC数据集上加载YOLOv4-tiny的训练权值，冻结前249层，只训练完全连接层的参数。(ii)在第一阶段的训练中，使用冻结操作将选中的层的参数冻结，其它层的参数以更大的学习率进行训练。在第二阶段，将之前冻结的层解冻，以较小的学习率训练模型。<strong>在训练过程中，采用动态学习率策略对各层参数进行微调</strong>。</li></ul> 
<h5><a id="Mosaic_data_augmentation_162"></a>Mosaic data augmentation</h5> 
<ul><li> <p>传统的数据增强包括光学变换和几何变换。而<strong>马赛克数据增强是一种基于CutMix的改进方法</strong>。该方法的实现是在传统的图像增强后，随机读取四幅图像并将其拼接成一幅图像。<strong>其目的是在丰富图像背景的同时，提高模型对<mark>小目标</mark>的检测性能</strong>。马赛克数据增强的效果如下图所示。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/5b/a5/G7e9fYLJ_o.png" alt="在这里插入图片描述"></p> </li><li> <p>马赛克增强原理图</p> </li></ul> </li></ul> 
<h5><a id="Cosine_annealing_171"></a>Cosine annealing</h5> 
<ul><li> <p><strong>为了防止模型在训练过程中陷入局部最小值，需要设置学习率调整策略，余弦退火就是其中之一</strong>。学习率可以通过余弦退火函数来降低，表示为</p> 
  <ul><li> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
          
           
            
             
             
               η 
              
             
               t 
              
             
            
              = 
             
             
             
               η 
              
              
              
                m 
               
              
                i 
               
              
                n 
               
              
             
               i 
              
             
            
              + 
             
             
             
               1 
              
             
               2 
              
             
            
              ( 
             
             
             
               η 
              
              
              
                m 
               
              
                a 
               
              
                x 
               
              
             
               i 
              
             
            
              − 
             
             
             
               η 
              
              
              
                m 
               
              
                i 
               
              
                n 
               
              
             
               i 
              
             
            
              ) 
             
            
              [ 
             
            
              1 
             
            
              + 
             
            
              c 
             
            
              o 
             
            
              s 
             
            
              ( 
             
             
              
              
                T 
               
               
               
                 c 
                
               
                 u 
                
               
                 r 
                
               
              
              
              
                T 
               
              
                I 
               
              
             
            
              π 
             
            
              ) 
             
            
              ] 
             
            
           
             \eta_t=\eta^i_{min}+\frac12(\eta^i_{max}-\eta^i_{min})[1+cos(\frac{T_{cur}}{T_I}\pi)] 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1217em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span class="" style="top: -2.453em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span class="" style="top: -2.453em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1247em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span class="" style="top: -2.453em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.1963em; vertical-align: -0.836em;"></span><span class="mord mathnormal">cos</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0785em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right: 0.0359em;">π</span><span class="mclose">)]</span></span></span></span></span></span></p> </li><li> <p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
            
            
              η 
             
             
             
               m 
              
             
               a 
              
             
               x 
              
             
            
              i 
             
            
           
          
            η^i_{max} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0717em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8247em;"><span class="" style="top: -2.453em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
            
            
              η 
             
             
             
               m 
              
             
               i 
              
             
               n 
              
             
            
              i 
             
            
           
          
            η^i_{min} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0833em; vertical-align: -0.2587em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8247em;"><span class="" style="top: -2.4413em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2587em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 分别为学习率的最大值和最小值， <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
            
            
              T 
             
             
             
               c 
              
             
               u 
              
             
               r 
              
             
            
           
          
            T_{cur} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和Ti分别为一个epoch的当前迭代次数和总迭代次数。这种下降模式可以与学习率相配合，以一种非常有效的计算方法获得较好的结果。</p> </li></ul> </li></ul> 
<h5><a id="Label_smoothing_181"></a>Label smoothing</h5> 
<ul><li> <p>对于多重分类，标签通常采用独热编码，如三分类任务，如果一个标签是第二类，则独热编码为[0,1,0]。但是，这会导致模型更加关注softmax预测结果中接近1的概率值，容易导致过拟合。<strong>针对这一问题，引入标签平滑对分类标签进行平滑处理，表示为</strong></p> 
  <ul><li> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
          
           
            
             
             
               y 
              
             
               K 
              
              
              
                L 
               
              
                S 
               
              
             
            
              = 
             
             
             
               y 
              
             
               K 
              
             
            
              ( 
             
            
              1 
             
            
              − 
             
            
              ε 
             
            
              ) 
             
            
              + 
             
            
              ε 
             
            
              / 
             
            
              K 
             
            
           
             y^{LS}_K=y_K(1-ε)+ε/K 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.1383em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8913em;"><span class="" style="top: -2.453em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">K</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">ε</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">ε</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right: 0.0715em;">K</span></span></span></span></span></span></p> </li><li> <p>式中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
            
            
              y 
             
            
              K 
             
             
             
               L 
              
             
               S 
              
             
            
           
          
            y^{LS}_ K 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.1167em; vertical-align: -0.2753em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -2.4247em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">K</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2753em;"><span class=""></span></span></span></span></span></span></span></span></span></span>为标签平滑后的标签， <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
            
            
              y 
             
            
              K 
             
            
           
          
            y_K 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 为一个热点标签，K为类别数，ε为标签平滑的值，本文设为0.01。然后将原来的one-hot编码标签替换为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
            
            
              y 
             
            
              K 
             
             
             
               L 
              
             
               S 
              
             
            
           
          
            y^{LS}_ K 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.1167em; vertical-align: -0.2753em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -2.4247em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">K</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2753em;"><span class=""></span></span></span></span></span></span></span></span></span></span>进行模型训练。</p> </li></ul> </li></ul> 
<h3><a id="IMPLEMENTATION_AND_ANALYSIS_191"></a>IMPLEMENTATION AND ANALYSIS</h3> 
<h4><a id="Evaluation_indicators_193"></a>Evaluation indicators</h4> 
<ul><li>在目标检测领域，常用平均精度(mAP)和每秒帧数(FPS)作为评价检测精度和速度的指标。此外，<strong>本文还引入了行人检测中使用的平均缺失率(mean miss rate, mMR)来反映模型的缺失检测结果</strong>。通过以上三个指标来判断训练后的模型的性能。</li></ul> 
<h5><a id="Mean_average_precision_197"></a>Mean average precision</h5> 
<ul><li> <p>mAP表示所有类别的平均精度(AP)值的平均值。AP为查准率和查全率曲线下的面积，可计算为</p> 
  <ul><li> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              p 
             
            
              r 
             
            
              e 
             
            
              c 
             
            
              i 
             
            
              s 
             
            
              i 
             
            
              o 
             
            
              n 
             
            
              = 
             
             
              
              
                T 
               
              
                P 
               
              
              
              
                T 
               
              
                P 
               
              
                + 
               
              
                F 
               
              
                P 
               
              
             
            
              , 
             
            
              r 
             
            
              e 
             
            
              c 
             
            
              a 
             
            
              l 
             
            
              l 
             
            
              = 
             
             
              
              
                T 
               
              
                P 
               
              
              
              
                T 
               
              
                P 
               
              
                + 
               
              
                F 
               
              
                N 
               
              
             
            
           
             precision=\frac{TP}{TP+FP},recall=\frac{TP}{TP+FN} 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">rec</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1297em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">FP</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">rec</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.0197em;">ll</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1297em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">FN</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> </li><li> <p>其中TP为正确检测的数量，TP+FP为模型检测到的目标总数，TP+FN为实际检测到的目标总数。</p> </li></ul> </li><li> <p>以0、0.1、…、0.9、1.0 11个查全率水平为横坐标，<strong>以每个查全率水平下的最大查全率为纵坐标，形成一条查全率-查全率曲线，该曲线下的面积为AP值</strong>。设K为类别总数，则mAP可由下式计算</p> 
  <ul><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             m 
            
           
             A 
            
           
             P 
            
           
             = 
            
            
            
              1 
             
            
              K 
             
            
            
            
              ∑ 
             
             
             
               i 
              
             
               = 
              
             
               1 
              
             
            
              K 
             
            
           
             A 
            
            
            
              P 
             
            
              i 
             
            
           
          
            mAP=\frac1K\sum^K_{i=1}AP_i 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.106em; vertical-align: -1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">K</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.8283em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></li></ul> </li></ul> 
<h5><a id="Frame_per_second_213"></a>Frame per second</h5> 
<ul><li>FPS是一秒钟内检测到的图像总数，反映了模型检测的速度。较高的检测速度可以满足工程应用中实时检测的需要。FPS值受计算设备性能影响较大，因此仅用于不同模型之间的对比分析。</li></ul> 
<h5><a id="Mean_miss_rate_217"></a>Mean miss rate</h5> 
<ul><li> <p>mMR是所有类别的对数平均脱靶率(MR)的平均值。各类别MR的计算公式为</p> 
  <ul><li> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              M 
             
            
              R 
             
            
              = 
             
             
             
               e 
              
              
              
                ( 
               
              
                l 
               
              
                n 
               
              
                ( 
               
               
               
                 x 
                
               
                 1 
                
               
              
                ) 
               
              
                + 
               
              
                . 
               
              
                . 
               
              
                . 
               
              
                + 
               
              
                l 
               
              
                n 
               
              
                ( 
               
               
               
                 x 
                
               
                 i 
                
               
              
                ) 
               
              
                + 
               
              
                . 
               
              
                . 
               
              
                . 
               
              
                + 
               
              
                l 
               
              
                n 
               
              
                ( 
               
               
               
                 x 
                
               
                 M 
                
               
              
                ) 
               
              
                ) 
               
              
                / 
               
              
                M 
               
              
             
            
           
             MR=e^{(ln(x_1)+...+ln(x_i)+...+ln(x_M))/M} 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">MR</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.938em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mord mtight">...</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3281em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mord mtight">...</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3567em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.109em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1433em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">))</span><span class="mord mtight">/</span><span class="mord mathnormal mtight" style="margin-right: 0.109em;">M</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> </li><li> <p>式中，M为检测模型检测到的某一类图像总数;mMR值越低，漏检结果越少。</p> </li></ul> </li></ul> 
<h4><a id="Model_training_and_optimization_process_227"></a>Model training and optimization process</h4> 
<ul><li> <p>构建YOLOv4-tiny算法模型后，按照下图所示流程图对其进行训练和测试。配置环境包括:Nvidia GeForce GTX1660Super，内存16G, cuda10和cudn7.4.1.5。但在此过程中影响模型检测精度的因素很多，必须对模型参数进行优化。具体描述如下。</p> 
  <ul><li><img src="https://images2.imgbox.com/97/7c/EXhflF6H_o.png" alt="在这里插入图片描述"></li></ul> </li></ul> 
<h5><a id="Clustering_of_anchors_234"></a>Clustering of anchors</h5> 
<ul><li> <p>传统的锚点选择方法难以提高精度，因此本文采用YOLOv2中的锚点计算方法，<strong>并使用K-means聚类算法对训练集中人工标记的真实边界盒进行聚类，从而获得最佳锚点大小</strong>。然后根据平均IoU选择6个锚点预测边界框，提高检测精度。聚类的距离函数公式为</p> 
  <ul><li> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              d 
             
            
              ( 
             
            
              b 
             
            
              o 
             
            
              x 
             
            
              , 
             
            
              c 
             
            
              e 
             
            
              n 
             
            
              t 
             
            
              r 
             
            
              o 
             
            
              i 
             
            
              d 
             
            
              ) 
             
            
              = 
             
            
              1 
             
            
              − 
             
            
              I 
             
            
              o 
             
            
              U 
             
            
              ( 
             
            
              b 
             
            
              o 
             
            
              x 
             
            
              , 
             
            
              c 
             
            
              e 
             
            
              n 
             
            
              t 
             
            
              r 
             
            
              o 
             
            
              i 
             
            
              d 
             
            
              ) 
             
            
           
             d(box,centroid)=1-IoU(box,centroid) 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord mathnormal">o</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">ce</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ro</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.109em;">U</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord mathnormal">o</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">ce</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ro</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span></span></span></p> </li><li> <p>式中，box表示训练样本中标注的边界框，centroid表示聚类中心的个数，这里设为9。本文锚固尺寸为[10 14、23 27、37 58、81 82、135 169、344 319]。</p> </li></ul> </li></ul> 
<h5><a id="Comparison_of_training_methods_244"></a>Comparison of training methods</h5> 
<ul><li> <p>比较了上述三种训练技术，包括马赛克数据增强、余弦退火和标签平滑，以提高网络的性能。使用上述锚大小，设置训练样本集与测试样本集的比例为9:1，对比结果如下表所示。可以看出，三种训练方法的组合具有最好的mAP效果。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/ad/69/eikDIKX7_o.png" alt="在这里插入图片描述"></p> </li><li> <p>不同训练方法的比较</p> </li></ul> </li></ul> 
<h5><a id="Selection_of_NMS_threshold_253"></a>Selection of NMS threshold</h5> 
<ul><li> <p>非最大抑制(Non-maximum suppression, NMS)是目标检测领域必要的后处理过程，<strong>其目的是消除同一目标上的冗余预测框</strong>。网管阈值的选择直接影响网络检测的准确性。当以上三种训练方法同时使用时，NMS阈值对mAP的影响曲线如下图所示。当网管阈值为0.4时，检测成功次数比0.5的条件少8次，检测错误次数比0.5的条件少133次，未检测次数比0.5的条件多8次。综合分析，本文选择NMS阈值为0.4。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/0a/49/7L8eUeAt_o.png" alt="在这里插入图片描述"></p> </li><li> <p>Influence of NMS threshold value on mAP</p> </li></ul> </li></ul> 
<h5><a id="Training_and_test_samples_262"></a>Training and test samples</h5> 
<ul><li> <p>对比分析了不同比例的训练样本和测试样本对检测结果的影响。在训练样本中，取10%作为验证集，在每个训练epoch后对模型进行验证。上图a和上图b分别展示了训练、验证和测试样本集的分布细节，以及不同样本比例对mAP和mMR值的影响。当比例为9:1时，模型的mAP最高，mMR最低，对应的是较好的准确率和较低的脱靶率。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/c0/ab/fnbYiwpw_o.png" alt="在这里插入图片描述"></p> </li><li> <p>样本分布及其对模型性能指标的影响(a)样本分布，(b)影响曲线</p> </li></ul> </li></ul> 
<h4><a id="Comparisons_with_other_detection_methods_271"></a>Comparisons with other detection methods</h4> 
<ul><li> <p>经过对训练过程的分析，最终用于模型训练和测试的参数如下表所示。为了验证所提出的YOLOv4tiny模型的有效性，构建了几种主流目标检测算法进行对比分析，包括Faster RCNN、SSD、YOLOv3、SSD- mobilenet和YOLOv4。使用相同的训练和测试数据集进行案例研究，通过比较性能指标的结果来评估不同算法的优点。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/f0/f7/i9aAivMY_o.png" alt="在这里插入图片描述"></p> </li><li> <p>YOLOv4-tiny模型参数</p> </li></ul> </li><li> <p>首先从检测结果中统计检测成功次数、漏检次数和误检次数进行对比分析，结果如下表所示。测试样本图像总数为800，其中包含1134个鸟类对象。由下表可以看出，YOLOv4、YOLOv4-tiny和SSD在成功检测次数和漏检次数上都优于其他方法。YOLO相关模型在误检次数上优于其他模型。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/d8/56/jrFGeeGm_o.png" alt="在这里插入图片描述"></p> </li><li> <p>不同方法的检测结果</p> </li></ul> </li><li> <p>利用检测结果的预测边界框和类别信息，结合真值边界框和类别信息，计算并比较上述目标检测方法的mAP和mMR性能指标，如下表所示。top -5为20种鸟类中top 5 ap的mAP值。T1和T2分别表示加载目标检测模型的时间和检测800个测试样本图像的总时间。可以看出，YOLOv4具有最好的mAP，但其FPS低于其他检测方法。YOLOv4-tiny对鸟类的检测mAP可达92.04%，仅比YOLOv4低0.16%，高于其他检测方法。此外，YOLOv4-tiny具有最高的FPS，几乎是YOLOv4的三倍。在这些目标检测算法中，其计算时间最短，T1 = 2.27 s, T2 = 19.85 s。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/8f/e5/z6wiXTjI_o.png" alt="在这里插入图片描述"></p> </li><li> <p>不同目标检测方法的性能指标</p> </li></ul> </li><li> <p>实际工程应用通常需要高实时性的检测，<strong>轻量级的YOLOv4-tiny检测方法牺牲了一点点精度，获得了大大提高的检测速度，在实际部署中可以降低对检测设备的性能要求</strong>。为了进一步改进mAP，可以采用一些可能的方法。通过数据增强和图像预处理，可以提高图像样本的数量和质量。利用CNN具有更强的特征提取能力、多尺度检测和注意机制，可以改进目标检测模型结构。此外，<strong>mAP还可以通过采用更多的训练技术如自对抗训练(SAT)和交叉小批归一化(CmBN)等来改进</strong>。</p> </li></ul> 
<h4><a id="Verification_of_robustness_296"></a>Verification of robustness</h4> 
<ul><li>在实际环境中，无人机、视频监控或摄像机采集到的鸟类图像通常具有复杂多样的背景。影响探测精度的主要因素包括时间、天气、图像采集设备的晃动、鸟类目标的运动等。因此，<strong>引入了一些图像预处理方法来模拟实际工程环境，并使用处理后的鸟类图像来验证上述鸟类检测方法的泛化能力和鲁棒性</strong>。</li></ul> 
<h5><a id="Detection_results_of_blurred_images_300"></a>Detection results of blurred images</h5> 
<ul><li> <p>传输线上的鸟类是运动目标，采集到的图像可能出现运动模糊和散焦模糊现象。因此，将运动模糊和散焦模糊图像作为测试样本，验证训练好的YOLOv4-tiny模型的有效性。以4只白凤花站在发射塔上筑巢的图像为例，以上6种方法的目标检测结果如下图所示。可以看出，YOLO方法比ssd和Faster RCNN对多鸟的检测更有效，特别是在目标重叠的情况下。对于运动模糊和散焦模糊图像，YOLOv4-tiny仍然可以准确地检测到四种目标，而其他方法存在检测错误和漏检的情况。结果表明，在实际应用中，所提出的YOLOv4-tiny模型是可行的，并且在检测运动模糊和离焦模糊鸟类图像方面优于其他方法。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/4a/13/GAQNfGNE_o.png" alt="在这里插入图片描述"></p> </li><li> <p>不同方法对模糊图像的检测结果</p> </li></ul> </li></ul> 
<h5><a id="Detection_results_under_different_contrasts_and_brightness_309"></a>Detection results under different contrasts and brightness</h5> 
<ul><li> <p>采用对比度和亮度调节方法模拟检测过程中由于时间和天气等因素造成的光照不均匀情况，验证检测模型对光强变化的鲁棒性。</p> </li><li> <p>式(4)中α和γ分别为0.4和- 20时，鸟类图像非常暗，α和γ分别为1.4和40时，鸟类图像非常亮。在上述两种光照条件下，以含有3只cristatelluses的图像为例，YOLOv4-tiny模型与其他方法的检测结果对比如下图所示。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/f9/e2/jgu1mYWK_o.png" alt="在这里插入图片描述"></p> </li><li> <p>不同对比度和亮度下的图像检测结果</p> </li></ul> </li><li> <p>发现对比度和亮度的变化会导致YOLOv4、YOLOv3、SSD和Faster RCNN的误检和漏检，而YOLOv4-tiny可以在不同的光环境下准确检测到三种鸟类目标。此外，使用YOLOv4-tiny模型检测不同α、γ值下的图像，测试样品的mAP结果如表5所示。当α = 0.4和γ =−20时，即极暗条件下，模型的mAP最低，为84.41%。而当α = 1.0和γ = 0时，mAP最高，达到92.04%。可以看出，<strong>YOLOv4-tiny模型对于不同时间和天气条件下获取的鸟类图像具有较高的检测精度，并且与其他方法相比具有更好的检测效果，漏检率和误检率都更低</strong>。</p> </li></ul> 
<h5><a id="Detection_results_of_bird_images_partially_covered_by_other_objects_322"></a>Detection results of bird images partially covered by other objects</h5> 
<ul><li> <p>图像样本中的鸟类目标可以被传输线或鸟巢材料的组件覆盖。四幅部分覆盖鸟类目标图像的检测结果如下图所示。由下图a、b、c可以看出，所提出的yolov4微型模型可以正确检测和识别部分被输电塔角钢覆盖的黑斑图、Picapica、Cuculus canorus。此外，下图d所示的5只博西尼亚犬被准确检测到，而4只目标被巢严重覆盖，只有头部暴露在外面。这些结果进一步验证了所提方法的有效性。但需要注意的是，<strong>当鸟目标被隐藏，没有足够的图像特征时，模型会输出错误或漏检的检测结果</strong>。</p> 
  <ul><li> <p><img src="https://images2.imgbox.com/90/41/ZBQE43W0_o.png" alt="在这里插入图片描述"></p> </li><li> <p>Detection results of images with bird target covered by components of transmission tower or the nests (a) Sturnus nigricollis, ( b ) Picapica, © Cuculus canorus, ( d ) Ciconia boyciana</p> </li></ul> </li><li> <p>在实际工程应用方面，<strong>YOLOv4-tiny模型将用于开发手机APP，并部署在传输线大数据分析系统上</strong>。在实际应用场景中，输电线路检测员可以将采集到的图像上传到APP中，APP会显示鸟类识别结果，并提供可能出现的故障类型、风险等级和防范措施。上传至APP的鸟类图像也可以传输到后台的大数据分析系统中，从而增加图像样本集，进一步提高所提出的轻量级CNN模型的训练效果。因此，该算法的实施将有利于防止传输线的鸟类故障。</p> </li></ul> 
<h3><a id="CONCLUSIONS_333"></a>CONCLUSIONS</h3> 
<ul><li> <p>本文提出了一种基于轻量级卷积神经网络(CNN) YOLOv4-tiny的传输线故障相关鸟类检测方法，并通过对20种可能威胁传输线安全的鸟类进行检测研究，验证了该方法的有效性。可以得出以下结论:</p> 
  <ul><li> <p>采用分阶段训练、马赛克数据增强、余弦退火和标签平滑等方法对yolov4微小目标检测模型进行训练后，效果最佳。通过调整锚点大小、NMS阈值和样本比例，可以得到最优的检测模型。</p> </li><li> <p>与Faster RCNN、SSD、YOLOv3和YOLOv4算法相比，YOLOv4-tiny模型具有更少的误检和漏检。从性能指标上看，YOLOv4-tiny的mAP为92.04%，FPS为40张/秒。</p> </li><li> <p>YOLOv4-tiny模型对鸟类图像进行运动模糊、散焦模糊、对比度和亮度调节等预处理，模拟实际工程操作场景，具有较高的检测精度。该方法可为输电线路因鸟故障的差别化、精准化预防提供技术参考。</p> </li></ul> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d3cd94bf5b0912fe37e6139b032a007c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux c&#43;&#43;反汇编源码细节解释说明</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c47a301e930b8d98b9f994befb9f8bfb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue中push和resolve的区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>