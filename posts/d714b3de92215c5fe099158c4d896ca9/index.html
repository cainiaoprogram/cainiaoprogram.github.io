<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>51单片机串行口相关知识 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="51单片机串行口相关知识" />
<meta property="og:description" content="51单片机串行口相关知识 串行通信概念 计算机与外部通信方式就两种：
并行通信串行通信 两种通信方式的特点以及适用场景：
名称特点适用场景并行通信速度快，效率高，成本高适合短距离高速通信，如计算机内部各硬件之间通信串行通信速度慢，效率低，成本低适合远距离低速通信，如线缆，网线 串行通信的三种模式 有三种：
单工：数据只能从A到B半双工：数据可以AB相互传递，但是不能同时进行全双工：数据可以AB相互传递，而且可以同时进行 波特率 用来衡量串行通信的速度，具体含义是每秒传送的二进制数码的位数。
单位： bps （位/秒）
国际规定的标准波特率系列：
110bps300bps600bps1200bps1800bps2400bps4800bps9600bps19200bps 接收端和发送端的波特率分别设置时，必须保证两者相同
串行通信的两种方式 有两种：
异步通信同步通信 异步通信 将字节为单位组成数据帧的格式进行传输，称作异步通信。
一帧数据的组成包括：
起始位：1位，一定为低电平数据位：5~8位，从低到高依次传送可编程校验位：1位，可以作为校验位，具体内容根据校验方式而定停止位：1位，数据帧末尾，始终为高电平 传输线未开始通信时一直处在高电平状态，当接收端检测到传输线上出现低电平时就意味着发送端已经开始发送了，之后接收到终止位就知道数据发送完成。
同步通信 在同步通信种，数据是以块为单位发送的。
下面是同步通信的理解图，注意，51单片机种的传输方式与其略有差别：
以下是51单片机中的同步通信示意图：
可以看出区别：51单片机中的同步通信在数据传输的过程中不需要同步信号。
同步通信的要求较为严格，需要注意的细节如下：
发送端和接收端的设备需要同步（一般由硬件实现）没有开始信号和终止信号适合传输数据量大，效率要求高的场合 51单片机的串行口控制器 串行口内部结构 51单片机的内部有一个全双工的串行通信接口。
这个图可以从最右边看起：
有两个接口：TXD和RXD，一个用于发送，一个用于接收
接着是一个寄存器： SCON串行控制寄存器，这个寄存器通过其中的位的值去控制发送控制器和接收控制器。
然后是发送控制器：观察图片可以发现这个发送控制器的作用受到定时器T1和SCON的控制，其作用是将发送SBUF中的并行数据转换为串行数据然后发送出去的，在这个过程中，还会自动添加起始位，校验位，停止位，发送结束后将SCON中的中断标志位TI标记为1，表示发送完毕
然后是接收控制器：与发送控制器相反，是将接收到的串行数据转换为并行数据然后发送到接收SBUF中，在这个过程中会自动取消起始位，校验位，停止位，接收结束后将SCON中的中断标志位RI标记为1，表示接收完毕
最后是定时计数器T1：定时计数器T1的作用产生用以收发过程中节拍控制的通信时钟（方波脉冲），实际上就是作为一把尺，假如有三个1到来的话，那么T1一定会发出三个方波，这样一来就可以判断了。
可以看出发送端只有一个寄存器SBUF，但是接收端有两个寄存器，这样做的好处是：当接收数据时，接收数据进入SBUF后，接收端还可以通过接收移位寄存器接收下一帧数据。这种双缓冲的结构可以避免在第二帧数据到来时，未将第一帧数据读走而引起的两帧数据重叠覆盖的错误。
SCON串行口控制寄存器 需要知道的有以下内容：
TI、RI：串行口中断请求信号，当接收完毕或者发送完毕时，对应位置就会置1，需要软件置0SM0 和 SM1：串行工作方式定义位，具体内容在后文。RB8 和 TB8：用于接收数据的第9位和发送数据的第9位，用于多机通信和奇偶校验SM2 ：多级通信控制位REN ：允许接收控制位，用于允许或禁止串行口接收数据 串行口工作方式 SM0SM1方式功能说明0008位同步移位寄存器方式01110位数据异步通讯方式10211位数据异步通信方式11311位数据异步通讯方式 上述4种工作方式种，只有后三种才属于严格意义上的异步通信，方式0属于同步移位寄存器方式，主要用于串并转换。
PCON电源控制寄存器 根据芯片手册，PCON内容如下：
我们只需要关注SMOD位即可：当SMOD = 1时（软件置位），使得串行通信方式1、2、3的波特率加倍。当SMOD = 0，各工作方式的波特率正常。复位时SMOD = 0。
SMOD0是帧错误检测有效控制位，详细内容不做介绍（因为用不上）。
通信时钟波特率的计算方式：
通信时钟波特率 = f O S C 12 ∗ ( 2 n − a ) ⋅ 2 S M O D 32 通信时钟波特率 = \frac {f_{OSC}} {12 * (2^{n} - a)} \cdot \frac {2^{SMOD}} {32} 通信时钟波特率=12∗(2n−a)fOSC​​⋅322SMOD​" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/d714b3de92215c5fe099158c4d896ca9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-06T17:46:17+08:00" />
<meta property="article:modified_time" content="2024-01-06T17:46:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">51单片机串行口相关知识</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="51_0"></a>51单片机串行口相关知识</h2> 
<h3><a id="_2"></a>串行通信概念</h3> 
<p>计算机与外部通信方式就<strong>两种</strong>：</p> 
<ul><li>并行通信</li><li>串行通信</li></ul> 
<p>两种通信方式的特点以及适用场景：</p> 
<table><thead><tr><th>名称</th><th>特点</th><th>适用场景</th></tr></thead><tbody><tr><td>并行通信</td><td>速度快，效率高，成本高</td><td>适合短距离高速通信，如计算机内部各硬件之间通信</td></tr><tr><td>串行通信</td><td>速度慢，效率低，成本低</td><td>适合远距离低速通信，如线缆，网线</td></tr></tbody></table> 
<h4><a id="_16"></a>串行通信的三种模式</h4> 
<p>有三种：</p> 
<ul><li>单工：数据只能从A到B</li><li>半双工：数据可以AB相互传递，但是不能同时进行</li><li>全双工：数据可以AB相互传递，而且可以同时进行</li></ul> 
<p><img src="https://images2.imgbox.com/a1/2a/qPCJPs5i_o.png" alt="串行通信的三种方式图"></p> 
<h4><a id="_25"></a>波特率</h4> 
<p>用来衡量串行通信的速度，具体含义是<strong>每秒传送的二进制数码的位数</strong>。</p> 
<p>单位： bps （位/秒）</p> 
<p>国际规定的标准波特率系列：</p> 
<ul><li>110bps</li><li>300bps</li><li>600bps</li><li>1200bps</li><li>1800bps</li><li>2400bps</li><li>4800bps</li><li>9600bps</li><li>19200bps</li></ul> 
<blockquote> 
 <p>接收端和发送端的波特率分别设置时，必须保证两者相同</p> 
</blockquote> 
<h4><a id="_45"></a>串行通信的两种方式</h4> 
<p>有两种：</p> 
<ul><li>异步通信</li><li>同步通信</li></ul> 
<h5><a id="_52"></a>异步通信</h5> 
<p><img src="https://images2.imgbox.com/63/46/bgNHtKhf_o.png" alt="异步通信"><br> 将字节为单位组成数据帧的格式进行传输，称作异步通信。</p> 
<p>一帧数据的组成包括：</p> 
<ul><li>起始位：1位，<strong>一定为低电平</strong></li><li>数据位：5~8位，<strong>从低到高</strong>依次传送</li><li>可编程校验位：1位，可以作为校验位，具体内容根据校验方式而定</li><li>停止位：1位，数据帧末尾，<strong>始终为高电平</strong></li></ul> 
<blockquote> 
 <p>传输线未开始通信时一直处在高电平状态，当接收端检测到传输线上出现低电平时就意味着发送端已经开始发送了，之后接收到终止位就知道数据发送完成。</p> 
</blockquote> 
<h5><a id="_64"></a>同步通信</h5> 
<p>在同步通信种，数据是以<strong>块</strong>为单位发送的。<br> 下面是同步通信的<strong>理解图</strong>，注意，51单片机种的传输方式与其略有差别：<br> <img src="https://images2.imgbox.com/59/64/usB6IqOV_o.png" alt="同步通信"><br> 以下是51单片机中的同步通信示意图：<br> <img src="https://images2.imgbox.com/e6/ba/jyl7FWQk_o.png" alt="51单片机同步通信"></p> 
<blockquote> 
 <p>可以看出区别：51单片机中的同步通信在数据传输的过程中不需要同步信号。</p> 
</blockquote> 
<p>同步通信的要求较为严格，需要注意的细节如下：</p> 
<ul><li>发送端和接收端的设备<strong>需要同步</strong>（一般由硬件实现）</li><li>没有开始信号和终止信号</li><li>适合传输数据量大，效率要求高的场合</li></ul> 
<h3><a id="51_78"></a>51单片机的串行口控制器</h3> 
<h4><a id="_80"></a>串行口内部结构</h4> 
<p>51单片机的内部有一个<strong>全双工</strong>的串行通信接口。</p> 
<p><img src="https://images2.imgbox.com/e7/2c/gsiRrgfo_o.png" alt="51单片机串行口内部结构"><br> 这个图可以从最右边看起：</p> 
<p>有两个接口：<strong>TXD和RXD</strong>，一个用于<strong>发送</strong>，一个用于<strong>接收</strong></p> 
<p>接着是一个寄存器： <strong>SCON串行控制寄存器</strong>，这个寄存器通过其中的位的值去控制发送控制器和接收控制器。</p> 
<p>然后是发送控制器：观察图片可以发现这个发送控制器的作用受到定时器T1和SCON的控制，其作用是<strong>将发送SBUF中的并行数据转换为串行数据</strong>然后发送出去的，在这个过程中，还会自动添加起始位，校验位，停止位，发送结束后将SCON中的中断标志位TI标记为1，表示发送完毕</p> 
<p>然后是接收控制器：与发送控制器相反，是<strong>将接收到的串行数据转换为并行数据然后发送到接收SBUF中</strong>，在这个过程中会自动取消起始位，校验位，停止位，接收结束后将SCON中的中断标志位RI标记为1，表示接收完毕</p> 
<p>最后是定时计数器T1：定时计数器T1的作用产生用以收发过程中节拍控制的通信时钟（方波脉冲），实际上就是作为一把尺，假如有三个1到来的话，那么T1一定会发出三个方波，这样一来就可以判断了。</p> 
<blockquote> 
 <p>可以看出发送端只有一个寄存器SBUF，但是接收端有两个寄存器，这样做的好处是：当接收数据时，接收数据进入SBUF后，接收端还可以通过接收移位寄存器接收下一帧数据。这种双缓冲的结构可以避免在第二帧数据到来时，未将第一帧数据读走而引起的两帧数据重叠覆盖的错误。</p> 
</blockquote> 
<h4><a id="SCON_99"></a>SCON串行口控制寄存器</h4> 
<p><img src="https://images2.imgbox.com/45/30/QtOyTAU2_o.png" alt="串行口控制寄存器SCON"><br> 需要知道的有以下内容：</p> 
<ul><li>TI、RI：串行口中断请求信号，当接收完毕或者发送完毕时，对应位置就会置1，需要软件置0</li><li>SM0 和 SM1：<strong>串行工作方式</strong>定义位，具体内容在后文。</li><li>RB8 和 TB8：用于接收数据的第9位和发送数据的第9位，用于多机通信和奇偶校验</li><li>SM2 ：多级通信控制位</li><li>REN ：允许接收控制位，用于允许或禁止串行口接收数据</li></ul> 
<h5><a id="_109"></a>串行口工作方式</h5> 
<table><thead><tr><th>SM0</th><th>SM1</th><th>方式</th><th>功能说明</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>8位同步移位寄存器方式</td></tr><tr><td>0</td><td>1</td><td>1</td><td>10位数据异步通讯方式</td></tr><tr><td>1</td><td>0</td><td>2</td><td>11位数据异步通信方式</td></tr><tr><td>1</td><td>1</td><td>3</td><td>11位数据异步通讯方式</td></tr></tbody></table> 
<blockquote> 
 <p>上述4种工作方式种，只有后三种才属于严格意义上的异步通信，方式0属于同步移位寄存器方式，主要用于串并转换。</p> 
</blockquote> 
<h4><a id="PCON_119"></a>PCON电源控制寄存器</h4> 
<p>根据芯片手册，PCON内容如下：<br> <img src="https://images2.imgbox.com/bf/40/23NKLvpk_o.png" alt="电源控制寄存器"><br> 我们只需要关注SMOD位即可：当SMOD = 1时（软件置位），使得串行通信方式1、2、3的波特率加倍。当SMOD = 0，各工作方式的波特率正常。复位时SMOD = 0。<br> SMOD0是帧错误检测有效控制位，详细内容不做介绍（因为用不上）。</p> 
<p>通信时钟波特率的计算方式：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          通信时钟波特率 
         
        
          = 
         
         
          
          
            f 
           
           
           
             O 
            
           
             S 
            
           
             C 
            
           
          
          
          
            12 
           
          
            ∗ 
           
          
            ( 
           
           
           
             2 
            
           
             n 
            
           
          
            − 
           
          
            a 
           
          
            ) 
           
          
         
        
          ⋅ 
         
         
          
          
            2 
           
           
           
             S 
            
           
             M 
            
           
             O 
            
           
             D 
            
           
          
         
           32 
          
         
        
       
         通信时钟波特率 = \frac {f_{OSC}} {12 * (2^{n} - a)} \cdot \frac {2^{SMOD}} {32} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback">通信时钟波特率</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.3074em; vertical-align: -0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">12</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.5904em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">OSC</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.2043em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.5183em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">32</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">SMO</span><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">D</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<blockquote> 
 <p>这说明，晶振频率f_{OSC}一定后，波特率的大小取决于T1的工作方式n和计数初值a还有SMOD</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f6318eb165bceddcae4c275d5caf2992/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">2024 Midjourney 基础教程（⼆）：了解 Midjourney Bot 和AI绘画使用技巧进阶教学</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/78b3b4001e90e75ec39085a36744027d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一篇文章学透所有Python知识（建议收藏）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>