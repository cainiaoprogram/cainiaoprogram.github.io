<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Uniapp中h5跨域解决 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Uniapp中h5跨域解决" />
<meta property="og:description" content="H5为啥会存在跨域问题
小程序一切都正常的请求调用
App一切都正常的请求调用
此跨域问题只存在于浏览器端，App和小程序不存在跨域问题
出现如下报错
参考地址：
manifest.json官方配置文档： uni-app官网
Chrome 调试跨域问题解决方案之插件篇： uni-app H5跨域问题解决方案（CORS、Cross-Origin） - DCloud问答
其实uni-app官方有解决跨域的办法，官方推荐使用HBuilderX中内置的浏览器去预览，在内置的浏览器中不会存在跨域问题，但是要是在Chrome 浏览器中预览的话就会出现这个跨域问题，官方推荐使用Allow-Control-Allow-Origin: *插件的方式去解决，但是我试过这个插件，不知道是什么问题，并没有效果，跨域问题依旧还是存在，后面再仔细的看了下文档，看到了下面的提示。
uni-app 中 manifest.json-&gt;h5-&gt;devServer 实际上对应 webpack 的 devServer，鉴于 manifest 为 json 文件，故 webpack.config.js-&gt;devServer 配置项下的简单类型属性均可在manifest.json-&gt;h5-&gt;devServer节点下配置，funciton 等复杂类型暂不支持。
猜想能否使用proxy配置反向代理的方式去实现跨域请求，代码如下：
/* h5特有相关 */ &#34;h5&#34; : { &#34;devServer&#34; : { &#34;port&#34; : 8083, //端口号 &#34;disableHostCheck&#34; : true, &#34;proxy&#34; : { &#34;/api&#34; : { &#34;target&#34; : &#34;http://localhost:8866/&#34;, //目标接口域名 &#34;changeOrigin&#34; : true, //是否跨域 &#34;secure&#34; : false // 设置支持https协议的代理 } } } } 此时需要用相对路径，不能使用绝对路径。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/92b71bda01133c710af437c81169d1b8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-06T16:21:58+08:00" />
<meta property="article:modified_time" content="2022-07-06T16:21:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Uniapp中h5跨域解决</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <ul><li> <p>H5为啥会存在跨域问题</p> </li><li> <p>小程序一切都正常的请求调用</p> </li><li> <p>App一切都正常的请求调用</p> </li></ul> 
<blockquote> 
 <p><strong>此跨域问题只存在于浏览器端，App和小程序不存在跨域问题</strong></p> 
</blockquote> 
<p>出现如下报错</p> 
<p><img alt="" height="233" src="https://images2.imgbox.com/01/9b/kWSs6tPP_o.png" width="1200"></p> 
<p> <strong>参考地址：</strong></p> 
<p></p> 
<p>manifest.json官方配置文档： <a href="https://uniapp.dcloud.io/collocation/manifest?id=devserver" rel="nofollow" title="uni-app官网">uni-app官网</a></p> 
<p>Chrome 调试跨域问题解决方案之插件篇： <a href="https://ask.dcloud.net.cn/article/35267" rel="nofollow" title="uni-app H5跨域问题解决方案（CORS、Cross-Origin） - DCloud问答">uni-app H5跨域问题解决方案（CORS、Cross-Origin） - DCloud问答</a></p> 
<p>其实uni-app官方有解决跨域的办法，官方推荐使用HBuilderX中内置的浏览器去预览，在内置的浏览器中不会存在跨域问题，但是要是在Chrome 浏览器中预览的话就会出现这个跨域问题，官方推荐使用Allow-Control-Allow-Origin: *插件的方式去解决，但是我试过这个插件，不知道是什么问题，并没有效果，跨域问题依旧还是存在，后面再仔细的看了下文档，看到了下面的提示。</p> 
<p><code>uni-app</code> 中 <code>manifest.json-&gt;h5-&gt;devServer</code> 实际上对应 <code>webpack</code> 的 <a href="https://webpack.js.org/configuration/dev-server/" rel="nofollow" title="devServer">devServer</a>，鉴于 manifest 为 json 文件，故 <code>webpack.config.js-&gt;devServer</code> 配置项下的简单类型属性均可在<code>manifest.json-&gt;h5-&gt;devServer</code>节点下配置，funciton 等复杂类型暂不支持。</p> 
<p><img alt="" height="604" src="https://images2.imgbox.com/f0/88/QCVSjkFs_o.png" width="1200"></p> 
<p> 猜想能否使用proxy配置反向代理的方式去实现跨域请求，代码如下：</p> 
<pre><code class="language-javascript">/* h5特有相关 */
"h5" : {
    "devServer" : {
         "port" : 8083, //端口号
          "disableHostCheck" : true,
          "proxy" : {
              "/api" : {
                  "target" : "http://localhost:8866/", //目标接口域名
                   "changeOrigin" : true,  //是否跨域
                   "secure" : false  // 设置支持https协议的代理
             }
        }
    }
}</code></pre> 
<p></p> 
<p>此时需要用相对路径，不能使用绝对路径。</p> 
<p>之前请求路径的配置需要进行更改：</p> 
<p><img alt="" height="439" src="https://images2.imgbox.com/c3/1d/B6YrF86o_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<p>本机转本机的跨域访问：当前访问的端口：<a href="http://localhost:8083" rel="nofollow" title="http://localhost:8083">http://localhost:8083</a> ——————&gt;<a href="http://localhost:8866" rel="nofollow" title="http://localhost:8866">http://localhost:8866</a></p> 
<p>本机转转云服务器的访问：</p> 
<ul><li> <p>当前访问的端口：<a href="http://localhost:8083" rel="nofollow" title="http://localhost:8083">http://localhost:8083</a> ———代理———&gt;<a href="http://158.25.125.15:8866" rel="nofollow" title="http://158.25.125.15:8866">http://158.25.125.15:8866</a></p> </li><li> <p>当前访问的端口：<a href="http://localhost:8083" rel="nofollow" title="http://localhost:8083">http://localhost:8083</a> ———代理———&gt;<a href="http://api.itbooking.net" rel="nofollow" title="http://api.itbooking.net">http://api.itbooking.net</a></p> </li><li> <p>当前访问的端口：<a href="http://localhost:8083" rel="nofollow" title="http://localhost:8083">http://localhost:8083</a> ———代理———&gt;<a href="http://www.itbooking.net:8866" rel="nofollow" title="http://www.itbooking.net:8866">http://www.itbooking.net:8866</a></p> </li></ul> 
<pre><code class="language-javascript">uni.request({url:"http://localhost:8866/api/banner/load"}) 这个是不会转发，代表直接去请求
​
uni.request({url:"/api/banner/load"}) =----------http://localhost:8083 /api/banner/load -------uni.request({url:"http://localhost:8866/api/banner/load"})</code></pre> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d6e99f7b6f399ef7ca246ecdd26cae31/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【注意力】ESE：Effective Squeeze-and-Excitation Block</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8f97239b556695e5f029a807fd17019b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">UnknownHostException 未知的名称或服务</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>