<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JS 装饰器（ Decorator ） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="JS 装饰器（ Decorator ）" />
<meta property="og:description" content="JS 装饰器（ Decorator ） 文章目录 JS 装饰器（ Decorator ）一.概念二.特点三.使用方式1.安装依赖2.配置文件.babelrc3.引入注册babel4.使用 三.装饰器原理`Object.defineProperty()`1.装饰-类2.装饰-类属性（属性，方法，get/set函数）1. 装饰方法2. 装饰类属性（字段）3.装饰getter和setter函数 3.多个装饰器执行顺序4.装饰器不能用于函数 一.概念 说起装饰器之前，先了解一下JS设计模式之装饰器模式。装饰器模式（Decorator Pattern）能够在不改变对象自身的基础上，动态的给某个对象添加额外的职责，不会影响原有的功能。这种类型的设计模式属于结构型设计模式，它是作为现有的类的一个包装
JS 装饰器(Decorator)
装饰器（Decorator）目前仍然处于第2阶段的提案中，提案地址 它可以用来装饰类、方法、属性，然后再进行功能的扩展。
之前在写 React 高阶组件（HOC） 介绍过这个装饰器模式的概念，与接下来我们要讲的，原理是一样的。
二.特点 装饰器是一种函数，写成@函数名的形式,它可以放在类和类方法的定义前面
三.使用方式 在使用装饰器的时候，我们需要引入babel模块transform-decorators-legacy，进行编译！
1.安装依赖 $ npm install @babel/cli @babel/core @babel/plugin-proposal-class-properties @babel/plugin-proposal-decorators @babel/plugin-transform-runtime @babel/preset-env @babel/register babel-loader --save-dev 2.配置文件.babelrc 创建babel 配置文件 .babelrc进行编译
{ &#34;presets&#34;: [ &#34;@babel/preset-env&#34; ], &#34;plugins&#34;: [ [&#34;@babel/plugin-proposal-decorators&#34;, { &#34;legacy&#34;: true }], [&#34;@babel/plugin-proposal-class-properties&#34;, { &#34;loose&#34; : true }], &#34;@babel/plugin-transform-runtime&#34; ] } 3.引入注册babel 在工程项目的入口文件中引入 @babel/register" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/32060e78b37f92089e399c1473d8dbd9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-02T19:32:56+08:00" />
<meta property="article:modified_time" content="2021-11-02T19:32:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JS 装饰器（ Decorator ）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="JS__Decorator__0"></a>JS 装饰器（ Decorator ）</h3> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#JS__Decorator__0" rel="nofollow">JS 装饰器（ Decorator ）</a></li><li><ul><li><a href="#_3" rel="nofollow">一.概念</a></li><li><a href="#_13" rel="nofollow">二.特点</a></li><li><a href="#_17" rel="nofollow">三.使用方式</a></li><li><ul><li><a href="#1_21" rel="nofollow">1.安装依赖</a></li><li><a href="#2babelrc_27" rel="nofollow">2.配置文件.babelrc</a></li><li><a href="#3babel_44" rel="nofollow">3.引入注册babel</a></li><li><a href="#4_52" rel="nofollow">4.使用</a></li></ul> 
    </li><li><a href="#_73" rel="nofollow">三.装饰器原理</a></li><li><ul><li><a href="#ObjectdefineProperty_77" rel="nofollow">`Object.defineProperty()`</a></li><li><a href="#1_152" rel="nofollow">1.装饰-类</a></li><li><a href="#2getset_231" rel="nofollow">2.装饰-类属性（属性，方法，get/set函数）</a></li><li><ul><li><a href="#1__233" rel="nofollow">1. 装饰方法</a></li><li><a href="#2__296" rel="nofollow">2. 装饰类属性（字段）</a></li><li><a href="#3gettersetter_344" rel="nofollow">3.装饰getter和setter函数</a></li></ul> 
     </li><li><a href="#3_424" rel="nofollow">3.多个装饰器执行顺序</a></li><li><a href="#4_449" rel="nofollow">4.装饰器不能用于函数</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h4><a id="_3"></a>一.概念</h4> 
<p>说起装饰器之前，先了解一下JS设计模式之装饰器模式。装饰器模式（Decorator Pattern）能够在不改变对象自身的基础上，动态的给某个对象添加额外的职责，不会影响原有的功能。这种类型的设计模式属于结构型设计模式，它是作为现有的类的一个包装</p> 
<p><code>JS 装饰器(Decorator)</code></p> 
<blockquote> 
 <p>装饰器（Decorator）目前仍然处于第2阶段的提案中，<a href="https://github.com/tc39/proposal-decorators">提案地址</a> 它可以用来装饰<code>类、方法、属性</code>，然后再进行功能的扩展。</p> 
</blockquote> 
<p>之前在写 <a href="https://blog.csdn.net/liuqiao0327/article/details/107284115">React 高阶组件（HOC）</a> 介绍过这个装饰器模式的概念，与接下来我们要讲的，原理是一样的。</p> 
<h4><a id="_13"></a>二.特点</h4> 
<p>装饰器是一种函数，写成<code>@函数名</code>的形式,它可以放在类和类方法的定义前面</p> 
<h4><a id="_17"></a>三.使用方式</h4> 
<p>在使用装饰器的时候，我们需要引入babel模块<code>transform-decorators-legacy</code>，进行编译！</p> 
<h5><a id="1_21"></a>1.安装依赖</h5> 
<pre><code class="prism language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> @babel/cli @babel/core @babel/plugin-proposal-class-properties @babel/plugin-proposal-decorators @babel/plugin-transform-runtime @babel/preset-env @babel/register babel-loader --save-dev
</code></pre> 
<h5><a id="2babelrc_27"></a>2.配置文件.babelrc</h5> 
<p>创建babel 配置文件 <code>.babelrc</code>进行编译</p> 
<pre><code class="prism language-js"><span class="token punctuation">{<!-- --></span>
  <span class="token string">"presets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"@babel/preset-env"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">"@babel/plugin-proposal-decorators"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> <span class="token string">"legacy"</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"@babel/plugin-proposal-class-properties"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> <span class="token string">"loose"</span> <span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"@babel/plugin-transform-runtime"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="3babel_44"></a>3.引入注册babel</h5> 
<p>在工程项目的入口文件中引入 <code>@babel/register</code></p> 
<pre><code class="prism language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/register'</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="4_52"></a>4.使用</h5> 
<pre><code class="prism language-js"><span class="token comment">//user.js</span>
@username
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">username</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  target<span class="token punctuation">.</span>uname<span class="token operator">=</span><span class="token string">'zhangsan'</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-js"><span class="token comment">//app.js</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/register'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> Person <span class="token punctuation">}</span>   <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./user.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span>uname<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//zhangsan</span>
</code></pre> 
<h4><a id="_73"></a>三.装饰器原理</h4> 
<p>说起装饰器的原理，实际上，装饰器<code>Decorator</code> 是一种语法糖，依赖于<code>Object</code>的静态方法：<code>Object.defineProperty</code> 方法,之前在写<a href="https://blog.csdn.net/liuqiao0327/article/details/106741176">Vue响应式原理</a>的时候，粗略介绍过这个方法,这里再详细介绍下：</p> 
<h5><a id="ObjectdefineProperty_77"></a><code>Object.defineProperty()</code></h5> 
<blockquote> 
 <p>MDN:方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性，并返回此对象</p> 
</blockquote> 
<pre><code class="prism language-js">Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> property<span class="token punctuation">,</span> descriptor<span class="token punctuation">)</span>
</code></pre> 
<ul><li><code>obj</code>：要定义属性的对象</li><li><code>property</code>: 要定义或修改的属性的名称</li><li><code>descriptor</code>:要定义或修改的属性描述符</li></ul> 
<p>返回值：返回被传递给此函数的对象obj</p> 
<p><code>descriptor</code>具有以下可选键值：</p> 
<ul><li> <p><code>configurable</code> 当且仅当该属性的<code>configurable</code>键值为<code>true</code>时，该属性的描述符才能够被改变，同时该属性也能从对应的对象上被删除。默认为false</p> </li><li> <p><code>enumerable</code> 当且仅当该属性的<code>enumerable</code>键值为<code>true</code>时，该属性才会出现在对象的枚举属性上。默认为<code>false</code></p> </li><li> <p><code>writable</code> 当且仅当该属性的<code>writable</code>键值为<code>true</code>时，属性的值，也就是<code>value</code>,才能被赋值运算符改变。默认为<code>false</code></p> </li><li> <p><code>value</code>该属性对应的值，可以是任何有效 的<code>JavaScript</code>值（数值，对象，函数等）。默认为<code>undefined</code></p> <pre><code class="prism language-js"><span class="token keyword">const</span> newObj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
  configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//默认为false</span>
  enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//默认为false</span>
  writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//默认为false</span>
  value<span class="token operator">:</span> <span class="token string">'zhangsan'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

newObj<span class="token punctuation">.</span>username <span class="token operator">=</span> <span class="token string">'liuqiao'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//liuqiao</span>
</code></pre> </li></ul> 
<p>对象属性访问器 <code>Getter</code>和<code>Setter</code></p> 
<ul><li> <p><code>get</code>一个给属性提供<code>getter</code>的方法，如果没有<code>getter</code>则为<code>undefined</code>,当访问该属性时，该方法会被执行，默认为<code>undefined</code></p> </li><li> <p><code>set</code> 一个给属性提供<code>setter</code>的方法，如果没有<code>setter</code>则为<code>undefined</code>,当属性值修改时，触发执行该方法，该方法接受唯一参数，即该属性新的参数值，默认为<code>undefined</code></p> <pre><code class="prism language-js"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'liuqiao'</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  <span class="token function-variable function">say</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">//是否可配置（枚举，可写，删除）</span>
  configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">//是否可枚举属性（遍历属性）</span>
  enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'触发getter函数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//需要使用中间介质变量，不能直接使用this.age，否则死循环</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_age
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'触发setter函数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//需要使用中间介质变量，不能直接使用this.age，否则死循环</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_age <span class="token operator">=</span> newValue
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

obj<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">28</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <p>PS:一个描述符不能同时有（<code>writable或value</code>）和（<code>get或set</code>）关键字</p> </li></ul> 
<h5><a id="1_152"></a>1.装饰-类</h5> 
<blockquote> 
 <p><code>当装饰的对象是类时，操作的就是这个类</code></p> 
</blockquote> 
<p>无参数的装饰器：</p> 
<pre><code class="prism language-js">@option
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">gender</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> gender
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">option</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  target<span class="token punctuation">.</span>uname <span class="token operator">=</span> <span class="token string">'liuqiao'</span>
  target<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">shopping</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>uname<span class="token punctuation">,</span> <span class="token string">'go shopping'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>gender<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"男"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">shopping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//liuqiao go shopping 男</span>
</code></pre> 
<p>装饰类时，装饰器函数接收的参数是一个目标类，然后在这个函数中我们可以对这个目标类进行添加静态属性，还可以在当前类的原型上，增加新的方法。</p> 
<p>实际上，装饰器的这种行为，我们可以理解成这样的一种写法：</p> 
<pre><code class="prism language-js">@option
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{<!-- --></span>

<span class="token punctuation">}</span>

<span class="token parameter">等同于</span><span class="token operator">=&gt;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{<!-- --></span>

<span class="token punctuation">}</span>

<span class="token comment">//option是装饰器函数，接收Person类</span>
Person <span class="token operator">=</span> <span class="token function">option</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span> <span class="token operator">||</span> Person
</code></pre> 
<p>有参数的装饰器：</p> 
<pre><code class="prism language-js"><span class="token comment">//高阶函数</span>
<span class="token keyword">const</span> <span class="token function-variable function">option</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">gender<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  target<span class="token punctuation">.</span>uname <span class="token operator">=</span> <span class="token string">'liuqiao'</span>
  target<span class="token punctuation">.</span>gender <span class="token operator">=</span> gender
  target<span class="token punctuation">.</span>age <span class="token operator">=</span> age
  target<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">shopping</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>uname<span class="token punctuation">,</span> <span class="token string">'go shopping'</span><span class="token punctuation">,</span> target<span class="token punctuation">.</span>gender<span class="token punctuation">,</span> target<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

@<span class="token function">option</span><span class="token punctuation">(</span><span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{<!-- --></span>

<span class="token punctuation">}</span>
<span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">shopping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>通过这里的运用，联想到了之前我写 <a href="https://blog.csdn.net/liuqiao0327/article/details/107453361">React Redux 介绍</a> 时，运用了一个高阶函数<code>connect</code>,<code>connect</code>的主要作用是连接React组件与React Store.并且会接收4个参数，这里我们经常是两种</p> 
<pre><code class="prism language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapActionToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>LoyoutCom<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>这里实际上就是一个高阶函数，函数柯里化之后的写法，那这样，我们今天了解了装饰器的写法，我们可以改造一下</p> 
<pre><code class="prism language-js">@<span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapActionToProps<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> LoyoutCom <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="2getset_231"></a>2.装饰-类属性（属性，方法，get/set函数）</h5> 
<h6><a id="1__233"></a>1. 装饰方法</h6> 
<pre><code class="prism language-js"><span class="token comment">/**
 * @param {是否只读，bool值} value
 * @param {类原型} target obj.prototype
 * @param {被装饰的属性或方法} property obj.method
 * @param {被修饰的属性或方法的描述对象} descriptor  
 * descriptor：{ value: f, enumarable: false, writable: true, configurable: true }
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">readonly</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">//设置当前属性或方法是否只读</span>
  descriptor<span class="token punctuation">.</span>writable <span class="token operator">=</span> <span class="token operator">!</span>value
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{<!-- --></span>
  @<span class="token function">readonly</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'zhangsan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> person<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//重新赋值，报错，设置了只读</span>
<span class="token comment">//ERROR:Cannot assign to read only property 'getName' of object '#&lt;Person&gt;'</span>

person<span class="token punctuation">.</span><span class="token function-variable function">getName</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'liuqiao'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
person<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>当装饰方法时，装饰器函数一共可以接受三个参数，原理就是<code>Object.defineProperty(target, property, descriptor)</code>，可以把装饰器就是这个函数的语法糖,但是与装饰类不同的是，这里的第一个参数<code>target</code>实际上是类的原型对象<code>protottype</code>,装饰器的本意是要装饰类的实例，但是此时实例没有生成，只能去装饰原型。<code>不同于类的装饰，类的装饰target参数指的是类本身</code>,第二个参数是要装饰的属性名，第三个参数是该属性的描述对象。</p> 
<p>再来个我们经常使用到的实例，我们项目中，经常会记录操作日志和记录</p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> <span class="token function-variable function">loggor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> desc<span class="token punctuation">,</span> level<span class="token punctuation">,</span> operator</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> oldValue <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>value<span class="token punctuation">;</span>

  descriptor<span class="token punctuation">.</span><span class="token function-variable function">value</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">调用方法名：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>prop<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,相关参数：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>arguments<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">oldValue</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">日志类型：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,日志描述:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>desc<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,日志级别：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>level<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,操作人：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>operator<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> descriptor<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{<!-- --></span>
  @<span class="token function">loggor</span><span class="token punctuation">(</span><span class="token string">'info'</span><span class="token punctuation">,</span> <span class="token string">'获取用户名'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'admin'</span><span class="token punctuation">)</span>
  <span class="token function">getName</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
person<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token string">'zhangsan'</span><span class="token punctuation">)</span>
</code></pre> 
<p>上述@logger装饰器的作用就是在执行每个操作之前，记录操作的日志。这个装饰器还可以更通用，这样写法，在代码层面来说，还是很直观的！并且还有着<code>代码注释的作用</code>，能一眼就看清楚，这里干了什么</p> 
<h6><a id="2__296"></a>2. 装饰类属性（字段）</h6> 
<pre><code class="prism language-js"><span class="token comment">//验证数字正则方法</span>
<span class="token keyword">const</span> <span class="token function-variable function">vality</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\d+(\.\d+)?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//创建一个验证属性只能为数字的装饰器</span>
<span class="token keyword">const</span> <span class="token function-variable function">IsNumber</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> name<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">//这里target指向当前装饰字段所在类的原型,也就是User.prototype</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//可以获取实例化的时候此属性的默认值</span>
  <span class="token keyword">let</span> initializer <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>initializer <span class="token operator">&amp;&amp;</span> descriptor<span class="token punctuation">.</span><span class="token function">initializer</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token comment">//返回一个新的描述对象，也撸修改 descriptor </span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> initializer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 在此对传入的 value 的值做各种检查</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">vality</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'必须为数值类型'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        initializer <span class="token operator">=</span> value<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{<!-- --></span>
  @<span class="token function">IsNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  age<span class="token operator">=</span><span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
user<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token string">'123a'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//null</span>
</code></pre> 
<p>上面是一个简单版本的<code>@IsNumber</code>的装饰器,此装饰器装饰的是类属性中的字段，这里的target指向，它和装饰方法一样，也是指向的当前类的原型对象<code>protottype</code>，所以装饰类属性时，target的指向都是一样的。</p> 
<h6><a id="3gettersetter_344"></a>3.装饰getter和setter函数</h6> 
<p>我们知道，在ES6的class中，在<code>类</code> 的内部可以使用<code>get</code>和<code>set</code>关键字，对某个属性设置存值函数和取值函数，拦截该属性的存取行为。</p> 
<pre><code class="prism language-js"><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">get</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token string">'liuqiao'</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">set</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'value:'</span><span class="token operator">+</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> user<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token comment">//liuqiao</span>
user<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'zhangsan'</span> <span class="token comment">//value:zhangsan</span>
</code></pre> 
<p>这个呢是class的语法，现在呢，我们要使用装饰器，将装饰器使用在getter和setter函数上</p> 
<p>getter函数上的使用：</p> 
<pre><code class="prism language-js"><span class="token comment">//取值时，数据加单位</span>
<span class="token keyword">const</span> <span class="token function-variable function">Unit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    <span class="token operator">...</span>descriptor<span class="token punctuation">,</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>productName <span class="token operator">+</span> value
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{<!-- --></span>
  productName <span class="token operator">=</span> <span class="token string">'iphone13'</span>

  @<span class="token function">Unit</span><span class="token punctuation">(</span><span class="token string">'香'</span><span class="token punctuation">)</span>
  <span class="token keyword">get</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>productName
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">//iphone13香</span>
</code></pre> 
<p>setter函数上的使用：</p> 
<pre><code class="prism language-js"><span class="token comment">//前缀标识</span>
<span class="token keyword">const</span> <span class="token function-variable function">Prefix</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">prefixValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    <span class="token operator">...</span>descriptor<span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> prefixValue <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>url
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{<!-- --></span>
  url <span class="token operator">=</span> <span class="token string">'apis/user'</span>

  <span class="token keyword">get</span> <span class="token function">fullURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>url
  <span class="token punctuation">}</span>

  @<span class="token function">Prefix</span><span class="token punctuation">(</span><span class="token string">'http://'</span><span class="token punctuation">)</span>
  <span class="token keyword">set</span> <span class="token function">fullURL</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token number">1111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
user<span class="token punctuation">.</span>fullURL<span class="token operator">=</span><span class="token string">''</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>fullURL<span class="token punctuation">)</span> <span class="token comment">//http://apis/user</span>
</code></pre> 
<p>上述对getter函数和setter函数进行装饰器的操作，其实就实现了，当取值或赋值时，进行了一个额外的装饰，实际项目中，这种场景很多</p> 
<h5><a id="3_424"></a>3.多个装饰器执行顺序</h5> 
<pre><code class="prism language-js"><span class="token comment">//前缀标识</span>
<span class="token keyword">const</span> <span class="token function-variable function">Prefix</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">prefixValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>prefixValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{<!-- --></span>
  url <span class="token operator">=</span> <span class="token string">'/apis/user'</span>

  @<span class="token function">Prefix</span><span class="token punctuation">(</span><span class="token string">'www.baidu.com'</span><span class="token punctuation">)</span>
  @<span class="token function">Prefix</span><span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">)</span>
  <span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//127.0.0.1</span>
<span class="token comment">//www.baidu.com</span>
</code></pre> 
<p>从上面代码中，可以看到执行结果，所以：<code>当同一个函数存在多个装饰器时，解析器解析时会从外到内解析，但是执行时，是从里到外执行的</code></p> 
<h5><a id="4_449"></a>4.装饰器不能用于函数</h5> 
<p>当我们想要将装饰器用于普通函数，是不可取的，装饰器只能用于类和类方法或属性，但是不能装饰普通函数，因为普通函数存在声明提升！</p> 
<p>拿<a href="https://es6.ruanyifeng.com/#docs/decorator#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A3%85%E9%A5%B0%E5%99%A8%E4%B8%8D%E8%83%BD%E7%94%A8%E4%BA%8E%E5%87%BD%E6%95%B0%EF%BC%9F" rel="nofollow">阮一峰大神</a>的例子看看，更加通俗易懂</p> 
<pre><code class="prism language-js"><span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  counter<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
@add
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>

<span class="token comment">//解析器分析</span>
<span class="token number">1.</span> <span class="token keyword">var</span> counter<span class="token punctuation">,</span>add
<span class="token number">2.</span> @add
   <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   <span class="token punctuation">}</span>
<span class="token number">3.</span> counter<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">4.</span> <span class="token function-variable function">add</span><span class="token operator">=</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    counter<span class="token operator">++</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>下面一个例子，也能非常清晰的知道</p> 
<pre><code class="prism language-js"><span class="token keyword">var</span> readOnly <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"some-decorator"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

@readOnly
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>

实际上解析
<span class="token number">1.</span>var readOnly
<span class="token number">2.</span>@readOnly
  <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token punctuation">}</span>
<span class="token number">3.</span>readOnly<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"some-decorator"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>所以呢，根据以上2个例子，可以知道，因为函数会存在声明提升，使得装饰器不能用于函数，在class类中是没有声明提升的，所以不会有这方面的问题。</p> 
<p><a href="https://www.imooc.com/article/42726" rel="nofollow">参考链接 </a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/08b1b09d6940ab4bddb3ba8511aa018d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">百度文库f12免费复制文章</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b290ee9977ce21696d302e9ca76a5fa1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">聊一聊SpringBoot中酷炫的Banner</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>