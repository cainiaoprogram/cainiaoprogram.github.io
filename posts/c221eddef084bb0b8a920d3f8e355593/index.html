<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>黑马程序员---三天快速入门Python机器学习（第三天） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="黑马程序员---三天快速入门Python机器学习（第三天）" />
<meta property="og:description" content="文章目录 四、回归与聚类算法4.1 线性回归4.1.1 线性回归的原理4.1.2 线性回归的损失和优化原理4.1.3 线性回归API4.1.4 波士顿房价预测4.1.5 梯度下降的扩展：GD、SGD、SAG4.1.6 总结 4.2 欠拟合与过拟合4.2.1 什么是过拟合与欠拟合4.2.2 原因以及解决方法 4.3 线性回归的改进---岭回归4.3.1 带有L2正则化的线性回归--岭回归 4.4 分类算法--逻辑回归与二分类4.4.1 逻辑回归的应用场景4.4.2 逻辑回归的原理4.4.3 逻辑回归API4.4.4 案例：癌症分类预测-良/恶性乳腺癌肿瘤预测4.4.5 分类的评估方法 4.5 模型保存和加载4.5.1 模型的保存和加载API4.5.2 线性回归的模型保存加载案例 4.6 无监督学习：K-means算法什么是无监督学习4.6.2 无监督学习包含算法4.6.3 K-means原理4.6.4 K-means API4.6.5 案例：k-means对instacart Market用户聚类4.6.6 K-means性能评估指标4.6.7 K-means总结 前些天发现了一个巨牛的人工智能学习网站，通俗易懂，风趣幽默，忍不住分享一下给大家。点击跳转到网站：人工智能从入门到精通教程
四、回归与聚类算法 4.1 线性回归 学习目标：
记忆线性回归的原理过程应用LinearRegression或SGDRegressor实现回归预测记忆回归算法的评估标准及其公式 4.1.1 线性回归的原理 1 线性回归应用场景
2 什么是线性回归
不同权重加权
2）线性回归的特征与目标的关系分析
广义线性模型
4.1.2 线性回归的损失和优化原理 1 损失函数：最小二乘法
2 优化算法
正规方程：直接求解W梯度下降：试错，改进 正规方程：直接求解W
梯度下降（Gradient Descent）
4.1.3 线性回归API 1）线性回归：
sklearn.linear_model.LinearRegression(fit_intercept=True) fit_intercept：是否计算偏置LinearRegression.coef_：回归系数LinearRegression.intercept_：偏置 2）梯度下降：
sklearn.linear_model.SGDRegressor(loss=&#34;squared_loss&#34;, fit_intercept=True, learning_rate=&#39;invscaling&#39;, eta0=0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c221eddef084bb0b8a920d3f8e355593/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-11T16:00:54+08:00" />
<meta property="article:modified_time" content="2022-08-11T16:00:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">黑马程序员---三天快速入门Python机器学习（第三天）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_9" rel="nofollow">四、回归与聚类算法</a></li><li><ul><li><a href="#41__10" rel="nofollow">4.1 线性回归</a></li><li><ul><li><a href="#411__16" rel="nofollow">4.1.1 线性回归的原理</a></li><li><a href="#412__26" rel="nofollow">4.1.2 线性回归的损失和优化原理</a></li><li><a href="#413_API_37" rel="nofollow">4.1.3 线性回归API</a></li><li><a href="#414__62" rel="nofollow">4.1.4 波士顿房价预测</a></li><li><a href="#415_GDSGDSAG_232" rel="nofollow">4.1.5 梯度下降的扩展：GD、SGD、SAG</a></li><li><a href="#416__234" rel="nofollow">4.1.6 总结</a></li></ul> 
   </li><li><a href="#42___240" rel="nofollow">4.2 欠拟合与过拟合</a></li><li><ul><li><a href="#421__248" rel="nofollow">4.2.1 什么是过拟合与欠拟合</a></li><li><a href="#422__256" rel="nofollow">4.2.2 原因以及解决方法</a></li></ul> 
   </li><li><a href="#43__281" rel="nofollow">4.3 线性回归的改进---岭回归</a></li><li><ul><li><a href="#431_L2_287" rel="nofollow">4.3.1 带有L2正则化的线性回归--岭回归</a></li></ul> 
   </li><li><a href="#44__419" rel="nofollow">4.4 分类算法--逻辑回归与二分类</a></li><li><ul><li><a href="#441__432" rel="nofollow">4.4.1 逻辑回归的应用场景</a></li><li><a href="#442__440" rel="nofollow">4.4.2 逻辑回归的原理</a></li><li><a href="#443_API_453" rel="nofollow">4.4.3 逻辑回归API</a></li><li><a href="#444__462" rel="nofollow">4.4.4 案例：癌症分类预测-良/恶性乳腺癌肿瘤预测</a></li><li><a href="#445__528" rel="nofollow">4.4.5 分类的评估方法</a></li></ul> 
   </li><li><a href="#45__584" rel="nofollow">4.5 模型保存和加载</a></li><li><ul><li><a href="#451_API_588" rel="nofollow">4.5.1 模型的保存和加载API</a></li><li><a href="#452__595" rel="nofollow">4.5.2 线性回归的模型保存加载案例</a></li></ul> 
   </li><li><a href="#46_Kmeans_601" rel="nofollow">4.6 无监督学习：K-means算法</a></li><li><ul><li><a href="#_607" rel="nofollow">什么是无监督学习</a></li><li><a href="#462__611" rel="nofollow">4.6.2 无监督学习包含算法</a></li><li><a href="#463_Kmeans_615" rel="nofollow">4.6.3 K-means原理</a></li><li><a href="#464_Kmeans_API_617" rel="nofollow">4.6.4 K-means API</a></li><li><a href="#465_kmeansinstacart_Market_636" rel="nofollow">4.6.5 案例：k-means对instacart Market用户聚类</a></li><li><a href="#466_Kmeans_643" rel="nofollow">4.6.6 K-means性能评估指标</a></li><li><a href="#467_Kmeans_666" rel="nofollow">4.6.7 K-means总结</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<p><mark><strong>前些天发现了一个巨牛的人工智能学习网站，通俗易懂，风趣幽默，忍不住分享一下给大家。点击跳转到网站：<a href="https://www.captainai.net/zdb" rel="nofollow">人工智能从入门到精通教程</a></strong></mark></p> 
<hr> 
<p><br><br></p> 
<h2><a id="_9"></a>四、回归与聚类算法</h2> 
<h3><a id="41__10"></a>4.1 线性回归</h3> 
<p>学习目标：</p> 
<ul><li>记忆线性回归的原理过程</li><li>应用LinearRegression或SGDRegressor实现回归预测</li><li>记忆回归算法的评估标准及其公式</li></ul> 
<h4><a id="411__16"></a>4.1.1 线性回归的原理</h4> 
<p><strong>1 线性回归应用场景</strong><br> <img src="https://images2.imgbox.com/2b/bd/9w25C5j8_o.png" alt="在这里插入图片描述"><br> <strong>2 什么是线性回归</strong><br> 不同权重加权<br> <img src="https://images2.imgbox.com/79/1d/PMz8pc9Y_o.png" alt="在这里插入图片描述"><br> <strong>2）线性回归的特征与目标的关系分析</strong><br> <mark>广义线性模型</mark><br> <img src="https://images2.imgbox.com/92/aa/OQB6x2GV_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="412__26"></a>4.1.2 线性回归的损失和优化原理</h4> 
<p><strong>1 损失函数：最小二乘法</strong><br> <img src="https://images2.imgbox.com/4a/0d/2Tjy4HQR_o.png" alt="在这里插入图片描述"><br> <strong>2 优化算法</strong></p> 
<ol><li><mark>正规方程</mark>：直接求解W</li><li><mark>梯度下降</mark>：试错，改进</li></ol> 
<p><strong>正规方程：直接求解W</strong><br> <img src="https://images2.imgbox.com/e0/6b/GvQ8lHDT_o.png" alt="在这里插入图片描述"><br> <strong>梯度下降（Gradient Descent）</strong><br> <img src="https://images2.imgbox.com/4a/ae/iyOzRFfH_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="413_API_37"></a>4.1.3 线性回归API</h4> 
<p>1）线性回归：</p> 
<pre><code class="prism language-python">sklearn<span class="token punctuation">.</span>linear_model<span class="token punctuation">.</span>LinearRegression<span class="token punctuation">(</span>fit_intercept<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>fit_intercept：是否计算偏置</li><li>LinearRegression.coef_：回归系数</li><li>LinearRegression.intercept_：偏置</li></ul> 
<p>2）梯度下降：</p> 
<pre><code class="prism language-python">sklearn<span class="token punctuation">.</span>linear_model<span class="token punctuation">.</span>SGDRegressor<span class="token punctuation">(</span>loss<span class="token operator">=</span><span class="token string">"squared_loss"</span><span class="token punctuation">,</span> fit_intercept<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token string">'invscaling'</span><span class="token punctuation">,</span> eta0<span class="token operator">=</span><span class="token number">0.01</span>
</code></pre> 
<ul><li>SGDRegressor类实现了随机梯度下降学习，它支持不同的<strong>loss函数和正则化惩罚项</strong>来拟合线性回归模型</li><li>loss：损失类型</li><li> 
  <ul><li>loss=“squared_loss”：<strong>普通最小二乘法</strong></li></ul> </li><li>fit_intercept：是否计算偏置</li><li>learning_rate：string，optional</li><li> 
  <ul><li>学习率填充</li></ul> </li><li> 
  <ul><li>‘constant’：eta=eta0</li></ul> </li><li> 
  <ul><li>‘optimal’：eta=1.0 / (alpha*(t+t0)) [default]</li></ul> </li><li> 
  <ul><li>‘invscaling’：eta=eta0 / pow(t, power_t)</li></ul> </li><li>SGDRegression.coef_：回归系数</li><li>SGDRegression.intercept_：偏置<br> <img src="https://images2.imgbox.com/6b/e7/sG2zuNKY_o.png" alt="在这里插入图片描述"></li></ul> 
<h4><a id="414__62"></a>4.1.4 波士顿房价预测</h4> 
<p><img src="https://images2.imgbox.com/07/5b/zZSbLi6g_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4b/2f/N4Md6mMw_o.png" alt="在这里插入图片描述"></p> 
<p>流程：<br> 1）获取数据集<br> 2）划分数据集<br> 3）特征工程：无量纲化 - 标准化<br> 4）预估器流程：fit() -&gt; 模型，coef_ intercept_<br> 5）模型评估</p> 
<p><strong>2 回归性能评估</strong><br> 均方误差（Mean Squared Error）（MSE）评价机制<br> <img src="https://images2.imgbox.com/46/77/tS2SYaet_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">sklearn<span class="token punctuation">.</span>metrics<span class="token punctuation">.</span>mean_squared_error<span class="token punctuation">(</span>y_ture<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>
</code></pre> 
<ul><li>均方误差回归损失</li><li>y_true：真实值</li><li>y_pred：预测值</li><li>return：浮点数结果</li></ul> 
<p><strong>3 代码</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_boston
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression<span class="token punctuation">,</span> SGDRegressor
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error


<span class="token keyword">def</span> <span class="token function">linner1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    正规方程的优化方法
    :return:
    """</span>
    <span class="token comment"># 1）获取数据</span>
    boston <span class="token operator">=</span> load_boston<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 2）划分数据集</span>
    x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>boston<span class="token punctuation">.</span>data<span class="token punctuation">,</span> boston<span class="token punctuation">.</span>target<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">)</span>

    <span class="token comment"># 3）标准化</span>
    transfer <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
    x_train <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
    x_test <span class="token operator">=</span> transfer<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>

    <span class="token comment"># 4）预估器</span>
    estimator <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>
    estimator<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

    <span class="token comment"># 5）得出模型</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正规方程权重系数为：\n"</span><span class="token punctuation">,</span> estimator<span class="token punctuation">.</span>coef_<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正规方程偏置为：\n"</span><span class="token punctuation">,</span> estimator<span class="token punctuation">.</span>intercept_<span class="token punctuation">)</span>

    <span class="token comment"># 6）模型评估</span>
    y_predict <span class="token operator">=</span> estimator<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"预测房价：\n"</span><span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
    error <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正规方程-均分误差为：\n"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token boolean">None</span>


<span class="token keyword">def</span> <span class="token function">linner2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    梯度下降的优化方法
    :return:
    """</span>
    <span class="token comment"># 1）获取数据</span>
    boston <span class="token operator">=</span> load_boston<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"特征数量：\n"</span><span class="token punctuation">,</span> boston<span class="token punctuation">.</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>  <span class="token comment"># 几个特征对应几个权重系数</span>

    <span class="token comment"># 2）划分数据集</span>
    x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>boston<span class="token punctuation">.</span>data<span class="token punctuation">,</span> boston<span class="token punctuation">.</span>target<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">)</span>

    <span class="token comment"># 3）标准化</span>
    transfer <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
    x_train <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
    x_test <span class="token operator">=</span> transfer<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>

    <span class="token comment"># 4）预估器</span>
    estimator <span class="token operator">=</span> SGDRegressor<span class="token punctuation">(</span>learning_rate<span class="token operator">=</span><span class="token string">"constant"</span><span class="token punctuation">,</span> eta0<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">)</span>
    estimator<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

    <span class="token comment"># 5）得出模型</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"梯度下降权重系数为：\n"</span><span class="token punctuation">,</span> estimator<span class="token punctuation">.</span>coef_<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"梯度下降偏置为：\n"</span><span class="token punctuation">,</span> estimator<span class="token punctuation">.</span>intercept_<span class="token punctuation">)</span>

    <span class="token comment"># 6）模型评估</span>
    y_predict <span class="token operator">=</span> estimator<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"预测房价：\n"</span><span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
    error <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"梯度下降-均分误差为：\n"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token boolean">None</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    linner1<span class="token punctuation">(</span><span class="token punctuation">)</span>
    linner2<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">正规方程权重系数为：
 <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.64817766</span>  <span class="token number">1.14673408</span> <span class="token operator">-</span><span class="token number">0.05949444</span>  <span class="token number">0.74216553</span> <span class="token operator">-</span><span class="token number">1.95515269</span>  <span class="token number">2.70902585</span>
 <span class="token operator">-</span><span class="token number">0.07737374</span> <span class="token operator">-</span><span class="token number">3.29889391</span>  <span class="token number">2.50267196</span> <span class="token operator">-</span><span class="token number">1.85679269</span> <span class="token operator">-</span><span class="token number">1.75044624</span>  <span class="token number">0.87341624</span>
 <span class="token operator">-</span><span class="token number">3.91336869</span><span class="token punctuation">]</span>
正规方程偏置为：
 <span class="token number">22.62137203166228</span>
预测房价：
 <span class="token punctuation">[</span><span class="token number">28.22944896</span> <span class="token number">31.5122308</span>  <span class="token number">21.11612841</span> <span class="token number">32.6663189</span>  <span class="token number">20.0023467</span>  <span class="token number">19.07315705</span>
 <span class="token number">21.09772798</span> <span class="token number">19.61400153</span> <span class="token number">19.61907059</span> <span class="token number">32.87611987</span> <span class="token number">20.97911561</span> <span class="token number">27.52898011</span>
 <span class="token number">15.54701758</span> <span class="token number">19.78630176</span> <span class="token number">36.88641203</span> <span class="token number">18.81202132</span>  <span class="token number">9.35912225</span> <span class="token number">18.49452615</span>
 <span class="token number">30.66499315</span> <span class="token number">24.30184448</span> <span class="token number">19.08220837</span> <span class="token number">34.11391208</span> <span class="token number">29.81386585</span> <span class="token number">17.51775647</span>
 <span class="token number">34.91026707</span> <span class="token number">26.54967053</span> <span class="token number">34.71035391</span> <span class="token number">27.4268996</span>  <span class="token number">19.09095832</span> <span class="token number">14.92742976</span>
 <span class="token number">30.86877936</span> <span class="token number">15.88271775</span> <span class="token number">37.17548808</span>  <span class="token number">7.72101675</span> <span class="token number">16.24074861</span> <span class="token number">17.19211608</span>
  <span class="token number">7.42140081</span> <span class="token number">20.0098852</span>  <span class="token number">40.58481466</span> <span class="token number">28.93190595</span> <span class="token number">25.25404307</span> <span class="token number">17.74970308</span>
 <span class="token number">38.76446932</span>  <span class="token number">6.87996052</span> <span class="token number">21.80450956</span> <span class="token number">25.29110265</span> <span class="token number">20.427491</span>   <span class="token number">20.4698034</span>
 <span class="token number">17.25330064</span> <span class="token number">26.12442519</span>  <span class="token number">8.48268143</span> <span class="token number">27.50871869</span> <span class="token number">30.58284841</span> <span class="token number">16.56039764</span>
  <span class="token number">9.38919181</span> <span class="token number">35.54434377</span> <span class="token number">32.29801978</span> <span class="token number">21.81298945</span> <span class="token number">17.60263689</span> <span class="token number">22.0804256</span>
 <span class="token number">23.49262401</span> <span class="token number">24.10617033</span> <span class="token number">20.1346492</span>  <span class="token number">38.5268066</span>  <span class="token number">24.58319594</span> <span class="token number">19.78072415</span>
 <span class="token number">13.93429891</span>  <span class="token number">6.75507808</span> <span class="token number">42.03759064</span> <span class="token number">21.9215625</span>  <span class="token number">16.91352899</span> <span class="token number">22.58327744</span>
 <span class="token number">40.76440704</span> <span class="token number">21.3998946</span>  <span class="token number">36.89912238</span> <span class="token number">27.19273661</span> <span class="token number">20.97945544</span> <span class="token number">20.37925063</span>
 <span class="token number">25.3536439</span>  <span class="token number">22.18729123</span> <span class="token number">31.13342301</span> <span class="token number">20.39451125</span> <span class="token number">23.99224334</span> <span class="token number">31.54729547</span>
 <span class="token number">26.74581308</span> <span class="token number">20.90199941</span> <span class="token number">29.08225233</span> <span class="token number">21.98331503</span> <span class="token number">26.29101202</span> <span class="token number">20.17329401</span>
 <span class="token number">25.49225305</span> <span class="token number">24.09171045</span> <span class="token number">19.90739221</span> <span class="token number">16.35154974</span> <span class="token number">15.25184758</span> <span class="token number">18.40766132</span>
 <span class="token number">24.83797801</span> <span class="token number">16.61703662</span> <span class="token number">20.89470344</span> <span class="token number">26.70854061</span> <span class="token number">20.7591883</span>  <span class="token number">17.88403312</span>
 <span class="token number">24.28656105</span> <span class="token number">23.37651493</span> <span class="token number">21.64202047</span> <span class="token number">36.81476219</span> <span class="token number">15.86570054</span> <span class="token number">21.42338732</span>
 <span class="token number">32.81366203</span> <span class="token number">33.74086414</span> <span class="token number">20.61688336</span> <span class="token number">26.88191023</span> <span class="token number">22.65739323</span> <span class="token number">17.35731771</span>
 <span class="token number">21.67699248</span> <span class="token number">21.65034728</span> <span class="token number">27.66728556</span> <span class="token number">25.04691687</span> <span class="token number">23.73976625</span> <span class="token number">14.6649641</span>
 <span class="token number">15.17700342</span>  <span class="token number">3.81620663</span> <span class="token number">29.18194848</span> <span class="token number">20.68544417</span> <span class="token number">22.32934783</span> <span class="token number">28.01568563</span>
 <span class="token number">28.58237108</span><span class="token punctuation">]</span>
正规方程<span class="token operator">-</span>均分误差为：
 <span class="token number">20.62751376309541</span>
特征数量：
 <span class="token punctuation">(</span><span class="token number">506</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span>
梯度下降权重系数为：
 <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.49204282</span>  <span class="token number">0.90600442</span> <span class="token operator">-</span><span class="token number">0.425408</span>    <span class="token number">0.78122193</span> <span class="token operator">-</span><span class="token number">1.64479112</span>  <span class="token number">2.83475726</span>
 <span class="token operator">-</span><span class="token number">0.13698271</span> <span class="token operator">-</span><span class="token number">3.10445426</span>  <span class="token number">1.64364102</span> <span class="token operator">-</span><span class="token number">0.88718517</span> <span class="token operator">-</span><span class="token number">1.70440114</span>  <span class="token number">0.86728865</span>
 <span class="token operator">-</span><span class="token number">3.89585718</span><span class="token punctuation">]</span>
梯度下降偏置为：
 <span class="token punctuation">[</span><span class="token number">22.64133018</span><span class="token punctuation">]</span>
预测房价：
 <span class="token punctuation">[</span><span class="token number">28.32988027</span> <span class="token number">31.59628165</span> <span class="token number">21.47291021</span> <span class="token number">32.62500214</span> <span class="token number">20.25743881</span> <span class="token number">19.25430704</span>
 <span class="token number">21.38515208</span> <span class="token number">19.41801029</span> <span class="token number">19.65928761</span> <span class="token number">32.85198424</span> <span class="token number">21.37546131</span> <span class="token number">27.39056689</span>
 <span class="token number">15.66170121</span> <span class="token number">20.03328423</span> <span class="token number">37.07101073</span> <span class="token number">18.63258981</span>  <span class="token number">9.77520186</span> <span class="token number">18.65105864</span>
 <span class="token number">30.75325523</span> <span class="token number">24.22837635</span> <span class="token number">19.22472715</span> <span class="token number">34.09165</span>    <span class="token number">29.44791249</span> <span class="token number">17.56977717</span>
 <span class="token number">34.7787419</span>  <span class="token number">26.45428709</span> <span class="token number">34.22802121</span> <span class="token number">27.29578864</span> <span class="token number">19.32013582</span> <span class="token number">15.73108309</span>
 <span class="token number">30.8244829</span>  <span class="token number">14.45690648</span> <span class="token number">37.39673182</span>  <span class="token number">9.17153635</span> <span class="token number">16.4192231</span>  <span class="token number">16.95257013</span>
  <span class="token number">8.02155337</span> <span class="token number">19.91710981</span> <span class="token number">40.38852095</span> <span class="token number">29.15121021</span> <span class="token number">25.24407119</span> <span class="token number">18.010192</span>
 <span class="token number">39.44673115</span>  <span class="token number">6.88236339</span> <span class="token number">21.66834002</span> <span class="token number">25.00581309</span> <span class="token number">20.93463887</span> <span class="token number">20.7354025</span>
 <span class="token number">16.93857116</span> <span class="token number">26.53856695</span>  <span class="token number">9.76725711</span> <span class="token number">27.08260975</span> <span class="token number">30.57506666</span> <span class="token number">16.93015199</span>
  <span class="token number">9.7853468</span>  <span class="token number">35.48002407</span> <span class="token number">31.38771996</span> <span class="token number">22.92251304</span> <span class="token number">17.5887466</span>  <span class="token number">21.81266956</span>
 <span class="token number">23.59614589</span> <span class="token number">23.90931722</span> <span class="token number">20.36883456</span> <span class="token number">38.1178319</span>  <span class="token number">25.69501252</span> <span class="token number">19.84073947</span>
 <span class="token number">14.34417444</span>  <span class="token number">6.91806577</span> <span class="token number">42.47139663</span> <span class="token number">21.77826021</span> <span class="token number">16.84647155</span> <span class="token number">22.57258974</span>
 <span class="token number">40.93987894</span> <span class="token number">21.67674727</span> <span class="token number">36.91202332</span> <span class="token number">27.13881344</span> <span class="token number">21.80877794</span> <span class="token number">20.7595932</span>
 <span class="token number">25.25423255</span> <span class="token number">23.79657533</span> <span class="token number">31.47394835</span> <span class="token number">20.13480903</span> <span class="token number">23.8995206</span>  <span class="token number">31.35105601</span>
 <span class="token number">27.26683269</span> <span class="token number">21.0353684</span>  <span class="token number">29.04765138</span> <span class="token number">21.97300518</span> <span class="token number">26.75012864</span> <span class="token number">18.76796591</span>
 <span class="token number">25.07915162</span> <span class="token number">23.89632104</span> <span class="token number">20.11003321</span> <span class="token number">18.24837709</span> <span class="token number">15.66456151</span> <span class="token number">18.41027271</span>
 <span class="token number">24.51065473</span> <span class="token number">16.92998012</span> <span class="token number">20.79986196</span> <span class="token number">26.80312356</span> <span class="token number">20.88746429</span> <span class="token number">18.18470202</span>
 <span class="token number">24.16520581</span> <span class="token number">23.24517214</span> <span class="token number">20.27485512</span> <span class="token number">36.41503937</span> <span class="token number">16.03109086</span> <span class="token number">22.43965602</span>
 <span class="token number">32.59510994</span> <span class="token number">33.78438794</span> <span class="token number">20.55420887</span> <span class="token number">25.91441489</span> <span class="token number">23.37496527</span> <span class="token number">17.74240561</span>
 <span class="token number">21.45360217</span> <span class="token number">21.65660718</span> <span class="token number">27.41255864</span> <span class="token number">25.15738326</span> <span class="token number">23.64996403</span> <span class="token number">14.61343906</span>
 <span class="token number">15.9240983</span>   <span class="token number">3.86335915</span> <span class="token number">29.20453051</span> <span class="token number">20.82989445</span> <span class="token number">22.24521707</span> <span class="token number">28.00451562</span>
 <span class="token number">28.39269673</span><span class="token punctuation">]</span>
梯度下降<span class="token operator">-</span>均分误差为：
 <span class="token number">21.42768961540712</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a6/f2/uJGeidNq_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="415_GDSGDSAG_232"></a>4.1.5 梯度下降的扩展：GD、SGD、SAG</h4> 
<p><img src="https://images2.imgbox.com/18/73/KmkPfqsz_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="416__234"></a>4.1.6 总结</h4> 
<p>线性回归的损失函数：均方误差<br> 线性回归的优化方法：正规方程、梯度下降<br> 线性回归的性能衡量方法：均方误差</p> 
<h3><a id="42___240"></a>4.2 欠拟合与过拟合</h3> 
<p>学习目标：</p> 
<ul><li>说明线性回归（不带正则化）的缺点</li><li>说明过拟合与欠拟合的原因以及解决方法</li></ul> 
<p>问题：训练数据训练的很好啊，误差也不大，为什么在测试集上有问题呢？<br> <strong>过拟合</strong></p> 
<h4><a id="421__248"></a>4.2.1 什么是过拟合与欠拟合</h4> 
<p>欠拟合：<br> <img src="https://images2.imgbox.com/46/5a/cGwwt57j_o.png" alt="在这里插入图片描述"><br> 过拟合：<br> <img src="https://images2.imgbox.com/d3/53/EPcryaQi_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/15/33/FMxp6KZj_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f7/8b/FH7aogfj_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="422__256"></a>4.2.2 原因以及解决方法</h4> 
<p>欠拟合原因以及解决方法</p> 
<ul><li>原因：学习到数据的特征过少</li><li>解决方法：增加数据的特征数量<br> 过拟合原因以及解决方法</li><li>原因：学到的特征过多，存在一些嘈杂特征，模型过于复杂</li><li>解决办法：正则化<br> <img src="https://images2.imgbox.com/4f/02/eYiptydR_o.png" alt="在这里插入图片描述"><br> <strong>1 正则化类别</strong></li><li><mark>L1正则化</mark></li><li><mark>L2正则化</mark>，更常用</li></ul> 
<p>L2正则化：</p> 
<ul><li>作用：可以使得其中一些W都很小，都接近于0，削弱某个特征的影响</li><li>优点：越小的参数说明模型越简单，越简单的模型也不容易产生过拟合现象</li><li><strong>Ridge回归</strong></li><li>加入L2正则化后的损失函数：<br> <strong>损失函数+惩罚项</strong><br> <img src="https://images2.imgbox.com/b3/df/THPJwHoC_o.png" alt="在这里插入图片描述"></li></ul> 
<p>L1正则化：</p> 
<ul><li>作用：可以使得其中一些W的值直接为0，删除这个特征的影响</li><li><strong>LASSO回归</strong></li></ul> 
<h3><a id="43__281"></a>4.3 线性回归的改进—岭回归</h3> 
<p>学习目标：</p> 
<ul><li>说明岭回归的原理即与线性回归的不同之处</li><li>说明正则化对于权重参数的影响</li><li>说明L1和L2正则化的区别</li></ul> 
<h4><a id="431_L2_287"></a>4.3.1 带有L2正则化的线性回归–岭回归</h4> 
<p>岭回归，其实也是一种线性回归。只不过在算法建立回归方程时候，加上正则化的限制，从而达到解决过拟合的效果</p> 
<p><strong>1 API</strong></p> 
<pre><code class="prism language-python">sklearn<span class="token punctuation">.</span>linear_model<span class="token punctuation">.</span>Ridge<span class="token punctuation">(</span>alpha<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> fit_intercept<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> solver<span class="token operator">=</span><span class="token string">'auto'</span><span class="token punctuation">,</span> normalize<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>alpha：正则化力度，取值范围：0-1,1-10</li><li>solver：会根据数据自动选择优化方法</li><li> 
  <ul><li>sag：如果数据集、特征都较大，选择该随机梯度下降优化</li></ul> </li><li>normalize：数据是否进行标准化</li><li> 
  <ul><li>normalize=False：可以在fit之前调用preprocessing.StandardScaler标准化数据</li></ul> </li><li>Ridge.coef_：回归权重</li><li>Ridge.intercept_：回归偏置<br> <img src="https://images2.imgbox.com/62/d4/7I6cnk3S_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c3/57/hTJMn6JQ_o.png" alt="在这里插入图片描述"><br> <strong>3 波士顿房价预测</strong></li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_boston
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression<span class="token punctuation">,</span> SGDRegressor<span class="token punctuation">,</span> Ridge
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error


<span class="token keyword">def</span> <span class="token function">linner1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    正规方程的优化方法
    :return:
    """</span>
    <span class="token comment"># 1）获取数据</span>
    boston <span class="token operator">=</span> load_boston<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 2）划分数据集</span>
    x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>boston<span class="token punctuation">.</span>data<span class="token punctuation">,</span> boston<span class="token punctuation">.</span>target<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">)</span>

    <span class="token comment"># 3）标准化</span>
    transfer <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
    x_train <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
    x_test <span class="token operator">=</span> transfer<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>

    <span class="token comment"># 4）预估器</span>
    estimator <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>
    estimator<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

    <span class="token comment"># 5）得出模型</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正规方程权重系数为：\n"</span><span class="token punctuation">,</span> estimator<span class="token punctuation">.</span>coef_<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正规方程偏置为：\n"</span><span class="token punctuation">,</span> estimator<span class="token punctuation">.</span>intercept_<span class="token punctuation">)</span>

    <span class="token comment"># 6）模型评估</span>
    y_predict <span class="token operator">=</span> estimator<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"预测房价：\n"</span><span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
    error <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正规方程-均分误差为：\n"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token boolean">None</span>


<span class="token keyword">def</span> <span class="token function">linner2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    梯度下降的优化方法
    :return:
    """</span>
    <span class="token comment"># 1）获取数据</span>
    boston <span class="token operator">=</span> load_boston<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"特征数量：\n"</span><span class="token punctuation">,</span> boston<span class="token punctuation">.</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>  <span class="token comment"># 几个特征对应几个权重系数</span>

    <span class="token comment"># 2）划分数据集</span>
    x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>boston<span class="token punctuation">.</span>data<span class="token punctuation">,</span> boston<span class="token punctuation">.</span>target<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">)</span>

    <span class="token comment"># 3）标准化</span>
    transfer <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
    x_train <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
    x_test <span class="token operator">=</span> transfer<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>

    <span class="token comment"># 4）预估器</span>
    estimator <span class="token operator">=</span> SGDRegressor<span class="token punctuation">(</span>learning_rate<span class="token operator">=</span><span class="token string">"constant"</span><span class="token punctuation">,</span> eta0<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">)</span>
    estimator<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

    <span class="token comment"># 5）得出模型</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"梯度下降权重系数为：\n"</span><span class="token punctuation">,</span> estimator<span class="token punctuation">.</span>coef_<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"梯度下降偏置为：\n"</span><span class="token punctuation">,</span> estimator<span class="token punctuation">.</span>intercept_<span class="token punctuation">)</span>

    <span class="token comment"># 6）模型评估</span>
    y_predict <span class="token operator">=</span> estimator<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"预测房价：\n"</span><span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
    error <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"梯度下降-均分误差为：\n"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token boolean">None</span>


<span class="token keyword">def</span> <span class="token function">linner3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    岭回归
    :return:
    """</span>
    <span class="token comment"># 1）获取数据</span>
    boston <span class="token operator">=</span> load_boston<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"特征数量：\n"</span><span class="token punctuation">,</span> boston<span class="token punctuation">.</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>  <span class="token comment"># 几个特征对应几个权重系数</span>

    <span class="token comment"># 2）划分数据集</span>
    x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>boston<span class="token punctuation">.</span>data<span class="token punctuation">,</span> boston<span class="token punctuation">.</span>target<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">)</span>

    <span class="token comment"># 3）标准化</span>
    transfer <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
    x_train <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
    x_test <span class="token operator">=</span> transfer<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>

    <span class="token comment"># 4）预估器</span>
    estimator <span class="token operator">=</span> Ridge<span class="token punctuation">(</span>alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">)</span>  <span class="token comment"># 可默认参数</span>
    estimator<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

    <span class="token comment"># 5）得出模型</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"岭回归-权重系数为：\n"</span><span class="token punctuation">,</span> estimator<span class="token punctuation">.</span>coef_<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"岭回归-下降偏置为：\n"</span><span class="token punctuation">,</span> estimator<span class="token punctuation">.</span>intercept_<span class="token punctuation">)</span>

    <span class="token comment"># 6）模型评估</span>
    y_predict <span class="token operator">=</span> estimator<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"预测房价：\n"</span><span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
    error <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"岭回归-均分误差为：\n"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token boolean">None</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    linner1<span class="token punctuation">(</span><span class="token punctuation">)</span>
    linner2<span class="token punctuation">(</span><span class="token punctuation">)</span>
    linner3<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/cd/9a/UCtT2Gw6_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="44__419"></a>4.4 分类算法–逻辑回归与二分类</h3> 
<p>学习目标：</p> 
<ul><li>说明逻辑回归的损失函数</li><li>说明逻辑回归的优化方法</li><li>说明sigmoid函数</li><li>知道逻辑回归的应用场景</li><li>知道精确率、召回率指标的区别</li><li>知道F-score指标说明召回率的实际意义</li><li>说明如何解决样本不均衡情况下的评估</li><li>了解ROC曲线的意义，说明AUC指标大小</li><li>应用classificiation_report实现精确率、召回率计算</li><li>应用roc_auc_score实现指标计算</li></ul> 
<h4><a id="441__432"></a>4.4.1 逻辑回归的应用场景</h4> 
<ul><li>广告点击率：是否会被点击</li><li>是否为垃圾邮件</li><li>是否患病</li><li>金融诈骗</li><li>虚假账号<br> <strong>以上都是二分类（正例，反例），逻辑回归就是解决二分类的利器</strong></li></ul> 
<h4><a id="442__440"></a>4.4.2 逻辑回归的原理</h4> 
<p><img src="https://images2.imgbox.com/3f/23/y8g4TYZ3_o.png" alt="在这里插入图片描述"><br> <strong>线性回归的输出就是逻辑回归的输入</strong><br> <img src="https://images2.imgbox.com/17/3a/KXiJbv81_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/2e/1e/b1Qc5T37_o.png" alt="在这里插入图片描述"><br> <strong>3 损失以及优化</strong><br> <img src="https://images2.imgbox.com/fe/f2/HF5V2U3f_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c0/cf/OYJnngva_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/15/68/6OeaUsIq_o.png" alt="在这里插入图片描述"><br> 2 优化<br> 同样使用梯度下降优化算法，去减少损失函数的值。这样去更新逻辑回归前面对应算法的权重参数，<strong>提升原本属于1类别的概率，降低原本是0类别的概率</strong></p> 
<h4><a id="443_API_453"></a>4.4.3 逻辑回归API</h4> 
<pre><code class="prism language-python">sklearn<span class="token punctuation">.</span>linear_model<span class="token punctuation">.</span>LogisticRefression<span class="token punctuation">(</span>solver<span class="token operator">=</span><span class="token string">'liblinear'</span><span class="token punctuation">,</span> penalty<span class="token operator">=</span>'l2<span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>penalty：正则化种类</li><li>C：正则化力度</li><li>solver：优化求解方式（默认开源的liblinear库实现）<br> <img src="https://images2.imgbox.com/6a/30/85J4PCPE_o.png" alt="在这里插入图片描述"></li></ul> 
<h4><a id="444__462"></a>4.4.4 案例：癌症分类预测-良/恶性乳腺癌肿瘤预测</h4> 
<p><img src="https://images2.imgbox.com/30/04/ZwrTwkJv_o.png" alt="在这里插入图片描述"><br> 流程分析：<br> 1）获取数据：读取的时候加上names<br> 2）数据处理：处理缺失值<br> 3）数据集划分<br> 4）特征工程：无量纲化处理—标准化<br> 5）逻辑回归预估器<br> 6）模型评估</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># 1、读取数据</span>
path <span class="token operator">=</span> <span class="token string">"https://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/breast-cancer-wisconsin.data"</span>
column_name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Sample code number'</span><span class="token punctuation">,</span> <span class="token string">'Clump Thickness'</span><span class="token punctuation">,</span> <span class="token string">'Uniformity of Cell Size'</span><span class="token punctuation">,</span> <span class="token string">'Uniformity of Cell Shape'</span><span class="token punctuation">,</span>
                   <span class="token string">'Marginal Adhesion'</span><span class="token punctuation">,</span> <span class="token string">'Single Epithelial Cell Size'</span><span class="token punctuation">,</span> <span class="token string">'Bare Nuclei'</span><span class="token punctuation">,</span> <span class="token string">'Bland Chromatin'</span><span class="token punctuation">,</span>
                   <span class="token string">'Normal Nucleoli'</span><span class="token punctuation">,</span> <span class="token string">'Mitoses'</span><span class="token punctuation">,</span> <span class="token string">'Class'</span><span class="token punctuation">]</span>

data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>path<span class="token punctuation">,</span> names<span class="token operator">=</span>column_name<span class="token punctuation">)</span>  <span class="token comment">#699 rows × 11 columns</span>

<span class="token comment"># 2、缺失值处理</span>
<span class="token comment"># 1）替换-》np.nan</span>
data <span class="token operator">=</span> data<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>to_replace<span class="token operator">=</span><span class="token string">"?"</span><span class="token punctuation">,</span> value<span class="token operator">=</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">)</span>
<span class="token comment"># 2）删除缺失样本</span>
data<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment">#683 rows × 11 columns</span>

<span class="token comment"># 3、划分数据集</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

<span class="token comment"># 筛选特征值和目标值</span>
x <span class="token operator">=</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">"Class"</span><span class="token punctuation">]</span>

x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

<span class="token comment"># 4、标准化</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler

transfer <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_train <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
x_test <span class="token operator">=</span> transfer<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>

<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression

<span class="token comment"># 5、预估器流程</span>
estimator <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>
estimator<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

<span class="token comment"># 逻辑回归的模型参数：回归系数和偏置</span>
estimator<span class="token punctuation">.</span>coef_   <span class="token comment"># 权重</span>

estimator<span class="token punctuation">.</span>intercept_  <span class="token comment"># 偏置</span>

<span class="token comment"># 6、模型评估</span>
<span class="token comment"># 方法1：直接比对真实值和预测值</span>
y_predict <span class="token operator">=</span> estimator<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"y_predict:\n"</span><span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"直接比对真实值和预测值:\n"</span><span class="token punctuation">,</span> y_test <span class="token operator">==</span> y_predict<span class="token punctuation">)</span>

<span class="token comment"># 方法2：计算准确率</span>
score <span class="token operator">=</span> estimator<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"准确率为：\n"</span><span class="token punctuation">,</span> score<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="445__528"></a>4.4.5 分类的评估方法</h4> 
<p><strong>1 精确率与召回率</strong></p> 
<p><strong>1 混淆矩阵</strong><br> 真的患癌症的，能够被检查出来的概率<br> <img src="https://images2.imgbox.com/dc/c6/vHuSHfO9_o.png" alt="在这里插入图片描述"><br> <strong>2 精确率（Precision）与召回率（Recall）</strong><br> <img src="https://images2.imgbox.com/7c/52/eI8Tuo1Z_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/06/30/5P3NIHEQ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b4/ed/zR54iQxw_o.png" alt="在这里插入图片描述"><br> <strong>3 分类评估报告API</strong></p> 
<pre><code class="prism language-python">sklearn<span class="token punctuation">.</span>metrics<span class="token punctuation">.</span>classification_report<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> target_names<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>y_true：真实目标值</li><li>y_pred：估计器预测目标值</li><li>labels：指定类别对应的数字</li><li>target_names：目标类别名称</li><li>return：每个类别精确率与召回率</li></ul> 
<pre><code class="prism language-python"><span class="token comment"># 查看精确率、召回率、F1-score</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report
report <span class="token operator">=</span> classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_predict<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> target_names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"良性"</span><span class="token punctuation">,</span> <span class="token string">"恶性"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a6/32/L6XSzeLc_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/a0/54/vAWn1SoI_o.png" alt="在这里插入图片描述"><br> 衡量样本不均衡下的评估：<br> <strong>2 ROC曲线与AUC指标</strong><br> TPR就是召回率<br> <img src="https://images2.imgbox.com/c8/7b/PRKwheSI_o.png" alt=""><br> <img src="https://images2.imgbox.com/39/99/iGUIqtPQ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d5/36/zrNDkay3_o.png" alt="在这里插入图片描述"><br> <strong>4 AUC计算API</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> roc_auc_score
roc_auc_score<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_score<span class="token punctuation">)</span>
</code></pre> 
<ul><li>y_true：每个样本的真实类别，必须为0（反例）和1（正例）</li><li>y_score：预测得分，可以是正类的估计概率、置信值或者分类器方法的返回值</li></ul> 
<pre><code class="prism language-python"><span class="token comment"># y_true：每个样本的真实类别，必须为0(反例),1(正例)标记</span>
<span class="token comment"># 将y_test 转换成 0 1</span>
y_true <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>y_test <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> roc_auc_score
roc_auc_score<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5e/27/0rQykBoH_o.png" alt="在这里插入图片描述"><br> <strong>5 总结</strong></p> 
<ul><li>AUC只能用来评价二分类</li><li>AUC非常适合评价样本在不平衡中的分类器性能</li></ul> 
<h3><a id="45__584"></a>4.5 模型保存和加载</h3> 
<p>学习目标：</p> 
<ul><li>应用joblib实现模型的保存于加载</li></ul> 
<h4><a id="451_API_588"></a>4.5.1 模型的保存和加载API</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> joblib
</code></pre> 
<ul><li>保存：joblib.dump(rf, ‘test.pkl’)</li><li>加载：estimator = joblib.load(‘test.pkl’)</li></ul> 
<h4><a id="452__595"></a>4.5.2 线性回归的模型保存加载案例</h4> 
<p>1、保存模型<br> <img src="https://images2.imgbox.com/fd/a2/eaA2qNxH_o.png" alt="在这里插入图片描述"><br> 2、加载模型<br> <img src="https://images2.imgbox.com/09/e4/by9vdfHe_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="46_Kmeans_601"></a>4.6 无监督学习：K-means算法</h3> 
<p>学习目标：</p> 
<ul><li>说明K-means算法原理</li><li>说明K-means的性能评估标准轮廓系数</li><li>说明K-means的优缺点</li></ul> 
<h4><a id="_607"></a>什么是无监督学习</h4> 
<p>没有目标值（无标签）—无监督学习<br> <img src="https://images2.imgbox.com/1d/ba/lnZJLICX_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="462__611"></a>4.6.2 无监督学习包含算法</h4> 
<p>聚类：K-means<br> 降维：PCA</p> 
<h4><a id="463_Kmeans_615"></a>4.6.3 K-means原理</h4> 
<p><img src="https://images2.imgbox.com/d7/ee/EMIdRcUQ_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="464_Kmeans_API_617"></a>4.6.4 K-means API</h4> 
<pre><code class="prism language-python">sklearn<span class="token punctuation">.</span>cluster<span class="token punctuation">.</span>KMeans<span class="token punctuation">(</span>n_cluster<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> init<span class="token operator">=</span><span class="token string">'k-means++'</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>n_clusters：开始聚类中心数量</li><li>init：初始化方法，默认为‘k-means++’</li><li>labels_：默认标记的类型，可以和真实值比较（不是值比较）</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans
estimator <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
estimator<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>data_new<span class="token punctuation">)</span>
y_predict <span class="token operator">=</span> estimator<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>data_new<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1e/6b/0jMfloia_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="465_kmeansinstacart_Market_636"></a>4.6.5 案例：k-means对instacart Market用户聚类</h4> 
<p><strong>1 分析</strong></p> 
<ul><li>1）降维之后的数据</li><li>2）预估器流程：k-means聚类</li><li>3）聚类结果显示</li><li>4）模型评估</li></ul> 
<h4><a id="466_Kmeans_643"></a>4.6.6 K-means性能评估指标</h4> 
<p><strong>1 轮廓系数</strong></p> 
<p><img src="https://images2.imgbox.com/59/4b/Fr2N3IzV_o.png" alt="在这里插入图片描述"><br> <strong>2 轮廓系数值分析</strong><br> <img src="https://images2.imgbox.com/35/3f/yVt6nyxB_o.png" alt="在这里插入图片描述"><br> <strong>3 结论</strong><br> <img src="https://images2.imgbox.com/5e/b5/KgNiBL5U_o.png" alt="在这里插入图片描述"><br> <strong>4 轮廓系数API</strong></p> 
<pre><code class="prism language-python">sklearn<span class="token punctuation">.</span>metrics<span class="token punctuation">.</span>silhouette_score<span class="token punctuation">(</span>X<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>
</code></pre> 
<ul><li>计算所有样本的平均轮廓系数</li><li>X：特征值</li><li>labels：被聚类标记的目标值</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span>  sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> silhouette_score
silhouette_score<span class="token punctuation">(</span>data_new<span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e7/16/8zWfobWF_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="467_Kmeans_666"></a>4.6.7 K-means总结</h4> 
<p>特点分析：采用迭代式算法，直观易懂并且非常实用<br> 缺点：容易收敛到局部最优解（多次聚类）</p> 
<p><mark>注意：聚类一般坐在分类之前</mark></p> 
<p><img src="https://images2.imgbox.com/9c/7d/wQjUkyyX_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/01381b4e1b68ac53e2095d3cfd90279f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">各种FIFO硬件设计（FIFO概念、异步、同步、非2次幂深度FIFO）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/de46fd8e3b46075bee0013cb358fcf9c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">黑马程序员---三天快速入门Python机器学习（第一天）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>