<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>总结了这67个pandas函数，完美解决数据处理，拿来即用！ - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="总结了这67个pandas函数，完美解决数据处理，拿来即用！" />
<meta property="og:description" content="不管是业务数据分析 ，还是数据建模。数据处理都是及其重要的一个步骤，它对于最终的结果来说，至关重要。
今天，就为大家总结一下 “Pandas数据处理” 几个方面重要的知识，拿来即用，随查随查。
导⼊数据导出数据查看数据数据选取数据处理数据分组和排序数据合并 # 在使用之前，需要导入pandas库 import pandas as pd 导⼊数据 这里我为大家总结7个常见用法。
pd.DataFrame() # 自己创建数据框，用于练习 pd.read_csv(filename) # 从CSV⽂件导⼊数据 pd.read_table(filename) # 从限定分隔符的⽂本⽂件导⼊数据 pd.read_excel(filename) # 从Excel⽂件导⼊数据 pd.read_sql(query,connection_object) # 从SQL表/库导⼊数据 pd.read_json(json_string) # 从JSON格式的字符串导⼊数据 pd.read_html(url) # 解析URL、字符串或者HTML⽂件，抽取其中的tables表格 导出数据 这里为大家总结5个常见用法。
df.to_csv(filename) #导出数据到CSV⽂件 df.to_excel(filename) #导出数据到Excel⽂件 df.to_sql(table_name,connection_object) #导出数据到SQL表 df.to_json(filename) #以Json格式导出数据到⽂本⽂件 writer=pd.ExcelWriter(&#39;test.xlsx&#39;,index=False) df1.to_excel(writer,sheet_name=&#39;单位&#39;)和writer.save()，将多个数据帧写⼊同⼀个⼯作簿的多个sheet(⼯作表) 查看数据 这里为大家总结11个常见用法。
df.head(n) # 查看DataFrame对象的前n⾏ df.tail(n) # 查看DataFrame对象的最后n⾏ df.shape() # 查看⾏数和列数 df.info() # 查看索引、数据类型和内存信息 df.columns() # 查看字段（⾸⾏）名称 df.describe() # 查看数值型列的汇总统计 s.value_counts(dropna=False) # 查看Series对象的唯⼀值和计数 df." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/7cbf4edccc5b5e245572775d469113ac/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-11T16:56:58+08:00" />
<meta property="article:modified_time" content="2021-04-11T16:56:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">总结了这67个pandas函数，完美解决数据处理，拿来即用！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>不管是业务数据分析 ，还是数据建模。数据处理都是及其重要的一个步骤，它对于最终的结果来说，至关重要。</p> 
<p>今天，就为大家总结一下 “Pandas数据处理” 几个方面重要的知识，拿来即用，随查随查。</p> 
<ul><li>导⼊数据</li><li>导出数据</li><li>查看数据</li><li>数据选取</li><li>数据处理</li><li>数据分组和排序</li><li>数据合并</li></ul> 
<pre><code class="prism language-python"><span class="token comment"># 在使用之前，需要导入pandas库</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
</code></pre> 
<h3><a id="_16"></a>导⼊数据</h3> 
<p>这里我为大家总结7个常见用法。</p> 
<pre><code class="prism language-python">pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 自己创建数据框，用于练习</span>

pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token comment"># 从CSV⽂件导⼊数据</span>

pd<span class="token punctuation">.</span>read_table<span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token comment"># 从限定分隔符的⽂本⽂件导⼊数据</span>

pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token comment"># 从Excel⽂件导⼊数据</span>

pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span>query<span class="token punctuation">,</span>connection_object<span class="token punctuation">)</span> <span class="token comment"># 从SQL表/库导⼊数据</span>

pd<span class="token punctuation">.</span>read_json<span class="token punctuation">(</span>json_string<span class="token punctuation">)</span> <span class="token comment"># 从JSON格式的字符串导⼊数据</span>

pd<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token comment"># 解析URL、字符串或者HTML⽂件，抽取其中的tables表格</span>
</code></pre> 
<h3><a id="_34"></a>导出数据</h3> 
<p>这里为大家总结5个常见用法。</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token comment">#导出数据到CSV⽂件</span>

df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token comment">#导出数据到Excel⽂件</span>

df<span class="token punctuation">.</span>to_sql<span class="token punctuation">(</span>table_name<span class="token punctuation">,</span>connection_object<span class="token punctuation">)</span> <span class="token comment">#导出数据到SQL表</span>

df<span class="token punctuation">.</span>to_json<span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token comment">#以Json格式导出数据到⽂本⽂件</span>

writer<span class="token operator">=</span>pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span><span class="token string">'test.xlsx'</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> 
df1<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">'单位'</span><span class="token punctuation">)</span>和writer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>，将多个数据帧写⼊同⼀个⼯作簿的多个sheet<span class="token punctuation">(</span>⼯作表<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_49"></a>查看数据</h3> 
<p>这里为大家总结11个常见用法。</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>head<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment"># 查看DataFrame对象的前n⾏</span>

df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment"># 查看DataFrame对象的最后n⾏</span>

df<span class="token punctuation">.</span>shape<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查看⾏数和列数</span>

df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查看索引、数据类型和内存信息</span>

df<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查看字段（⾸⾏）名称</span>

df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查看数值型列的汇总统计</span>

s<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span>dropna<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># 查看Series对象的唯⼀值和计数</span>

df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">.</span>value_counts<span class="token punctuation">)</span> <span class="token comment"># 查看DataFrame对象中每⼀列的唯⼀值和计数</span>

df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查看是否有缺失值</span>

df<span class="token punctuation">[</span>df<span class="token punctuation">[</span>column_name<span class="token punctuation">]</span><span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># 查看column_name字段数据重复的数据信息</span>

df<span class="token punctuation">[</span>df<span class="token punctuation">[</span>column_name<span class="token punctuation">]</span><span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查看column_name字段数据重复的个数</span>
</code></pre> 
<h3><a id="_75"></a>数据选取</h3> 
<p>这里为大家总结10个常见用法。</p> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token comment"># 根据列名，并以Series的形式返回列</span>

df<span class="token punctuation">[</span><span class="token punctuation">[</span>col1<span class="token punctuation">,</span>col2<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># 以DataFrame形式返回多列</span>

s<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 按位置选取数据</span>

s<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'index_one'</span><span class="token punctuation">]</span> <span class="token comment"># 按索引选取数据</span>

df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment"># 返回第⼀⾏</span>

df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 返回第⼀列的第⼀个元素</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment"># 返回第⼀⾏（索引为默认的数字时，⽤法同df.iloc），但需要注意的是loc是按索引,iloc参数只接受数字参数</span>

df<span class="token punctuation">.</span>ix<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"col1"</span><span class="token punctuation">,</span><span class="token string">"col2"</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># 返回字段为col1和col2的前5条数据，可以理解为loc和</span>
iloc的结合体。

df<span class="token punctuation">.</span>at<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"col1"</span><span class="token punctuation">]</span> <span class="token comment"># 选择索引名称为5，字段名称为col1的数据</span>

df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 选择索引排序为5，字段排序为0的数据</span>
</code></pre> 
<h3><a id="_100"></a>数据处理</h3> 
<p>这里为大家总结16个常见用法。</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>columns<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span> <span class="token comment"># 重命名列名（需要将所有列名列出，否则会报错）</span>

pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 检查DataFrame对象中的空值，并返回⼀个Boolean数组</span>

pd<span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 检查DataFrame对象中的⾮空值，并返回⼀个Boolean数组</span>

df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 删除所有包含空值的⾏</span>

df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 删除所有包含空值的列</span>

df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>thresh<span class="token operator">=</span>n<span class="token punctuation">)</span> <span class="token comment"># 删除所有⼩于n个⾮空值的⾏</span>

df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>value<span class="token operator">=</span>x<span class="token punctuation">)</span> <span class="token comment"># ⽤x替换DataFrame对象中所有的空值，⽀持</span>

df<span class="token punctuation">[</span>column_name<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

s<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token comment"># 将Series中的数据类型更改为float类型</span>

s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'one'</span><span class="token punctuation">)</span> <span class="token comment"># ⽤‘one’代替所有等于1的值</span>

s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># ⽤'one'代替1，⽤'three'代替3</span>

df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span>lambdax<span class="token punctuation">:</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 批量更改列名</span>

df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'old_name'</span><span class="token punctuation">:</span><span class="token string">'new_ name'</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># 选择性更改列名</span>

df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'column_one'</span><span class="token punctuation">)</span> <span class="token comment"># 将某个字段设为索引，可接受列表参数，即设置多个索引</span>

df<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token string">"col1"</span><span class="token punctuation">)</span> <span class="token comment"># 将索引设置为col1字段，并将索引新设置为0,1,2...</span>

df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>index<span class="token operator">=</span>lambdax<span class="token punctuation">:</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 批量重命名索引</span>
</code></pre> 
<h3><a id="_136"></a>数据分组、排序、透视</h3> 
<p>这里为大家总结13个常见用法。</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token comment"># 对前5条数据进⾏索引排序</span>

df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>col1<span class="token punctuation">)</span> <span class="token comment"># 按照列col1排序数据，默认升序排列</span>

df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>col2<span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># 按照列col1降序排列数据</span>

df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span>col1<span class="token punctuation">,</span>col2<span class="token punctuation">]</span><span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span><span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 先按列col1升序排列，后按col2降序排列数据</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col<span class="token punctuation">)</span> <span class="token comment"># 返回⼀个按列col进⾏分组的Groupby对象</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span>col1<span class="token punctuation">,</span>col2<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 返回⼀个按多列进⾏分组的Groupby对象</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token punctuation">[</span>col2<span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>mean<span class="token punctuation">)</span> <span class="token comment"># 返回按列col1进⾏分组后，列col2的均值,agg可以接受列表参数，agg([len,np.mean])</span>

df<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index<span class="token operator">=</span>col1<span class="token punctuation">,</span>values<span class="token operator">=</span><span class="token punctuation">[</span>col2<span class="token punctuation">,</span>col3<span class="token punctuation">]</span><span class="token punctuation">,</span>aggfunc<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>col2<span class="token punctuation">:</span><span class="token builtin">max</span><span class="token punctuation">,</span>col3<span class="token punctuation">:</span><span class="token punctuation">[</span>ma<span class="token punctuation">,</span><span class="token builtin">min</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># 创建⼀个按列col1进⾏分组，计算col2的最⼤值和col3的最⼤值、最⼩值的数据透视表</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">)</span> <span class="token comment"># 返回按列col1分组的所有列的均值,⽀持</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token punctuation">.</span>col2<span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'min'</span><span class="token punctuation">,</span><span class="token string">'max'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

data<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">)</span> <span class="token comment"># 对DataFrame中的每⼀列应⽤函数np.mean</span>

data<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 对DataFrame中的每⼀⾏应⽤函数np.max</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token punctuation">.</span>col2<span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token string">"sum"</span><span class="token punctuation">)</span> <span class="token comment"># 通常与groupby连⽤，避免索引更改</span>
</code></pre> 
<h3><a id="_166"></a>数据合并</h3> 
<p>这里为大家总结5个常见用法。</p> 
<pre><code class="prism language-python">df1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df2<span class="token punctuation">)</span> <span class="token comment"># 将df2中的⾏添加到df1的尾部</span>

df<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>join<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span> <span class="token comment"># 将df2中的列添加到df1的尾部,值为空的对应⾏与对应列都不要</span>

df1<span class="token punctuation">.</span>join<span class="token punctuation">(</span>df2<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token punctuation">,</span>on<span class="token operator">=</span>col1<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span> <span class="token comment"># 对df1的列和df2的列执⾏SQL形式的join，默认按照索引来进⾏合并，如果df1和df2有共同字段时，会报错，可通过设置lsuffix,rsuffix来进⾏解决，如果需要按照共同列进⾏合并，就要⽤到set_index(col1)</span>

pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token string">'col1'</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span> <span class="token comment"># 对df1和df2合并，按照col1，⽅式为outer</span>

pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">,</span>left_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>right_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span> <span class="token comment">#与 df1.join(df2, how='outer')效果相同</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/faf86dd8a8fe626c09f3ede386a0fe28/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Docker架构原理及常用命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eeb75364f58d10aacee5ea7818672568/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">注册公司流程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>