<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Qualcomm® AI Engine Direct 使用手册（19） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Qualcomm® AI Engine Direct 使用手册（19）" />
<meta property="og:description" content="Qualcomm® AI Engine Direct 使用手册（19） 6.4.3 qnn-accuracy-debugger（实验）6.4.4 qnn 平台验证器6.4.5 qnn-个人资料查看器6.4.6 qnn-上下文-二进制-实用程序 6.4.3 qnn-accuracy-debugger（实验） 依赖关系
精度调试器取决于设置中概述的设置。具体来说，需要满足以下条件：首先，需要根据平台依赖关系满足平台依赖关系。需要安装所需的 ML 框架。还必须遵循环境设置中的环境设置说明。
应使用安装程序中提到的 check-python-dependency 脚本来满足 Python 依赖关系。此外，还需要以下软件包：
absl==0.0 flatbuffers==23.3.3 onnxruntime==1.14.1 protobuf==4.22.4 xlsxwriter==3.1.9 本指南中使用了以下环境变量（用户可以根据需要更改以下路径）：
RESOURCESPATH = {所有模型和输入文件所在目录的路径}
PROJECTREPOPATH = {准确性调试器项目目录的路径}
概述
准确性调试器工具可以发现层级神经网络中的不准确性。该工具将通过特定机器学习框架（即 Tensorflow、Onnx、TFlite）运行模型所产生的黄金输出与通过高通 QNN 推理引擎运行相同模型所产生的结果进行比较。推理引擎可以在多种计算介质上运行，包括GPU、CPU和DSP。
Accuracy Debugger 提供以下功能。每个功能都可以使用相应的选项来运行；例如，。qnn-accuracy-debugger --{option}
qnn-accuracy-debugger -–framework_diagnosis此功能使用机器学习框架（例如tensorflow、tflite 或onnx）来运行模型以获得中间输出。
qnn-accuracy-debugger –-inference_engine此功能使用 QNN 引擎运行模型以检索中间输出。
qnn-accuracy-debugger –-verification此功能使用 CosineSimilarity、RtolAtol 等验证器来比较框架诊断和推理引擎功能生成的输出。
qnn-accuracy-debugger –compare_encodings此功能从给定的 QNN net JSON 文件中提取编码，将它们与给定的 AIMET 编码进行比较，并输出突出显示不匹配的 Excel 工作表。
qnn-accuracy-debugger –tensor_inspection此功能将给定的目标输出与参考输出进行比较。
提示：
您可以在 bin 命令后使用 –help 来查看可以添加哪些其他选项（必需或可选）。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/41bbfdc2e021383d335aa06d95cb8f56/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-04T16:20:03+08:00" />
<meta property="article:modified_time" content="2024-01-04T16:20:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Qualcomm® AI Engine Direct 使用手册（19）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Qualcomm® AI Engine Direct 使用手册（19）</h4> 
 <ul><li><ul><li><ul><li><a href="#643_qnnaccuracydebugger_4" rel="nofollow">6.4.3 qnn-accuracy-debugger（实验）</a></li><li><a href="#644_qnn__1173" rel="nofollow">6.4.4 qnn 平台验证器</a></li><li><a href="#645_qnn_1217" rel="nofollow">6.4.5 qnn-个人资料查看器</a></li><li><a href="#646_qnn_1250" rel="nofollow">6.4.6 qnn-上下文-二进制-实用程序</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h4><a id="643_qnnaccuracydebugger_4"></a>6.4.3 qnn-accuracy-debugger（实验）</h4> 
<p>依赖关系</p> 
<p>精度调试器取决于设置中概述的设置。具体来说，需要满足以下条件：首先，需要根据平台依赖关系满足平台依赖关系。需要安装所需的 ML 框架。还必须遵循环境设置中的环境设置说明。</p> 
<p>应使用安装程序中提到的 check-python-dependency 脚本来满足 Python 依赖关系。此外，还需要以下软件包：</p> 
<pre><code class="prism language-c">absl<span class="token operator">==</span><span class="token number">0.0</span>
flatbuffers<span class="token operator">==</span><span class="token number">23.3</span><span class="token number">.3</span>
onnxruntime<span class="token operator">==</span><span class="token number">1.14</span><span class="token number">.1</span>
protobuf<span class="token operator">==</span><span class="token number">4.22</span><span class="token number">.4</span>
xlsxwriter<span class="token operator">==</span><span class="token number">3.1</span><span class="token number">.9</span>

</code></pre> 
<p>本指南中使用了以下环境变量（用户可以根据需要更改以下路径）：</p> 
<ol><li> <p>RESOURCESPATH = {所有模型和输入文件所在目录的路径}</p> </li><li> <p>PROJECTREPOPATH = {准确性调试器项目目录的路径}</p> </li></ol> 
<p>概述</p> 
<p>准确性调试器工具可以发现层级神经网络中的不准确性。该工具将通过特定机器学习框架（即 Tensorflow、Onnx、TFlite）运行模型所产生的黄金输出与通过高通 QNN 推理引擎运行相同模型所产生的结果进行比较。推理引擎可以在多种计算介质上运行，包括GPU、CPU和DSP。</p> 
<p>Accuracy Debugger 提供以下功能。每个功能都可以使用相应的选项来运行；例如，。qnn-accuracy-debugger --{option}</p> 
<ol><li> <p>qnn-accuracy-debugger -–framework_diagnosis此功能使用机器学习框架（例如tensorflow、tflite 或onnx）来运行模型以获得中间输出。</p> </li><li> <p>qnn-accuracy-debugger –-inference_engine此功能使用 QNN 引擎运行模型以检索中间输出。</p> </li><li> <p>qnn-accuracy-debugger –-verification此功能使用 CosineSimilarity、RtolAtol 等验证器来比较框架诊断和推理引擎功能生成的输出。</p> </li><li> <p>qnn-accuracy-debugger –compare_encodings此功能从给定的 QNN net JSON 文件中提取编码，将它们与给定的 AIMET 编码进行比较，并输出突出显示不匹配的 Excel 工作表。</p> </li><li> <p>qnn-accuracy-debugger –tensor_inspection此功能将给定的目标输出与参考输出进行比较。</p> </li></ol> 
<p>提示：</p> 
<ul><li> <p>您可以在 bin 命令后使用 –help 来查看可以添加哪些其他选项（必需或可选）。</p> </li><li> <p>如果未提供选项，Accuracy Debugger 将依次运行framework_diagnosis、inference_engine 和verification。</p> </li></ul> 
<p>以下是运行 Accuracy Debugger 的说明：</p> 
<p>框架诊断<br> 框架诊断功能旨在运行具有不同机器学习框架（例如Tensorflow等）的模型。选定的模型使用特定的 ML 框架运行。生成黄金输出以供将来与推理引擎步骤的推理结果进行比较。</p> 
<p>用法</p> 
<pre><code class="prism language-c">usage<span class="token operator">:</span> <span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger <span class="token operator">--</span>framework_diagnosis <span class="token punctuation">[</span><span class="token operator">-</span>h<span class="token punctuation">]</span>
                                   <span class="token operator">-</span>f FRAMEWORK <span class="token punctuation">[</span>FRAMEWORK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                                   <span class="token operator">-</span>m MODEL_PATH
                                   <span class="token operator">-</span>i INPUT_TENSOR <span class="token punctuation">[</span>INPUT_TENSOR <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                                   <span class="token operator">-</span>o OUTPUT_TENSOR
                                   <span class="token punctuation">[</span><span class="token operator">-</span>w WORKING_DIR<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>output_dirname OUTPUT_DIRNAME<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>v<span class="token punctuation">]</span>

Script to generate intermediate tensors from an ML Framework<span class="token punctuation">.</span>

optional arguments<span class="token operator">:</span>
     <span class="token operator">-</span>h<span class="token punctuation">,</span> <span class="token operator">--</span>help            show this help message and exit

required arguments<span class="token operator">:</span>
     <span class="token operator">-</span>f FRAMEWORK <span class="token punctuation">[</span>FRAMEWORK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">--</span>framework FRAMEWORK <span class="token punctuation">[</span>FRAMEWORK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                             Framework type and version<span class="token punctuation">,</span> version is optional<span class="token punctuation">.</span> Currently
                             supported frameworks are <span class="token punctuation">[</span><span class="token string">"tensorflow"</span><span class="token punctuation">,</span><span class="token string">"onnx"</span><span class="token punctuation">,</span><span class="token string">"tflite"</span><span class="token punctuation">]</span> <span class="token keyword">case</span>
                             insensitive but spelling sensitive
     <span class="token operator">-</span>m MODEL_PATH<span class="token punctuation">,</span> <span class="token operator">--</span>model_path MODEL_PATH
                             Path to the model <span class="token function">file</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span>
     <span class="token operator">-</span>i INPUT_TENSOR <span class="token punctuation">[</span>INPUT_TENSOR <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">--</span>input_tensor INPUT_TENSOR <span class="token punctuation">[</span>INPUT_TENSOR <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                             The name<span class="token punctuation">,</span> dimensions<span class="token punctuation">,</span> raw data<span class="token punctuation">,</span> and optionally data
                             type of the network input <span class="token function">tensor</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> specifiedin the
                             format <span class="token string">"input_name"</span> comma<span class="token operator">-</span>separated<span class="token operator">-</span>dimensions path<span class="token operator">-</span>
                             to<span class="token operator">-</span>raw<span class="token operator">-</span>file<span class="token punctuation">,</span> <span class="token keyword">for</span> example<span class="token operator">:</span> <span class="token string">"data"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">3</span> data<span class="token punctuation">.</span>raw
                             float32<span class="token punctuation">.</span> Note that the quotes should always be
                             included in order to handle special characters<span class="token punctuation">,</span>
                             spaces<span class="token punctuation">,</span> etc<span class="token punctuation">.</span> For multiple inputs specify multiple
                             <span class="token operator">--</span>input_tensor on the command line like<span class="token operator">:</span>
                             <span class="token operator">--</span>input_tensor <span class="token string">"data1"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">3</span> data1<span class="token punctuation">.</span>raw
                             <span class="token operator">--</span>input_tensor <span class="token string">"data2"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">3</span> data2<span class="token punctuation">.</span>raw float32<span class="token punctuation">.</span>
     <span class="token operator">-</span>o OUTPUT_TENSOR<span class="token punctuation">,</span> <span class="token operator">--</span>output_tensor OUTPUT_TENSOR
                             Name of the graph's specified output <span class="token function">tensor</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span>

     optional arguments<span class="token operator">:</span>
     <span class="token operator">-</span>w WORKING_DIR<span class="token punctuation">,</span> <span class="token operator">--</span>working_dir WORKING_DIR
                             Working directory <span class="token keyword">for</span> the framework_diagnosis to store
                             temporary files<span class="token punctuation">.</span> Creates a new directory <span class="token keyword">if</span> the
                             specified working directory does not exist
     <span class="token operator">--</span>output_dirname OUTPUT_DIRNAME
                             output directory name <span class="token keyword">for</span> the framework_diagnosis to
                             store temporary files under
                             <span class="token operator">&lt;</span>working_dir<span class="token operator">&gt;</span><span class="token operator">/</span>framework_diagnosis<span class="token punctuation">.</span> Creates a new
                             directory <span class="token keyword">if</span> the specified working directory does not
                             exist
     <span class="token operator">-</span>v<span class="token punctuation">,</span> <span class="token operator">--</span>verbose         Verbose printing

Please note<span class="token operator">:</span> All the command line arguments should either be provided through command line or through the config file<span class="token punctuation">.</span> They will not override those in the config file <span class="token keyword">if</span> there is overlap<span class="token punctuation">.</span>

</code></pre> 
<p>命令示例</p> 
<pre><code class="prism language-c"><span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>framework_diagnosis \
    <span class="token operator">--</span>framework tensorflow \
    <span class="token operator">--</span>model_path $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>inception_v3_2016_08_28_frozen<span class="token punctuation">.</span>pb \
    <span class="token operator">--</span>input_tensor <span class="token string">"input:0"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">299</span><span class="token punctuation">,</span><span class="token number">299</span><span class="token punctuation">,</span><span class="token number">3</span> $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>data<span class="token operator">/</span>chairs<span class="token punctuation">.</span>raw \
    <span class="token operator">--</span>output_tensor InceptionV3<span class="token operator">/</span>Predictions<span class="token operator">/</span>Reshape_1<span class="token operator">:</span><span class="token number">0</span>

<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>framework_diagnosis \
    <span class="token operator">--</span>framework onnx \
    <span class="token operator">--</span>model_path $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>dlv3onnx<span class="token operator">/</span>dlv3plus_mbnet_513<span class="token operator">-</span><span class="token number">513</span>_op9_mod_basic<span class="token punctuation">.</span>onnx \
    <span class="token operator">--</span>input_tensor Input <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">513</span><span class="token punctuation">,</span><span class="token number">513</span> $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>dlv3onnx<span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">00000</span>_1_3_513_513<span class="token punctuation">.</span>raw \
    <span class="token operator">--</span>output_tensor Output

</code></pre> 
<p>提示：</p> 
<ul><li> <p>如果没有另外指定，则工作目录是从您调用脚本的位置生成的；建议从同一目录调用所有脚本，以便所有输出和结果都存储在同一目录下，而不会到处都有输出</p> </li><li> <p>对于tensorflow，有时需要在输入和输出节点名称后面添加:0以表示节点的索引。请注意，onnx 型号中删除了 :0。</p> </li></ul> 
<p>输出</p> 
<p>该程序还在working_directory/framework_diagnosis中创建一个名为latest的目录，该目录以符号方式链接到最近生成的目录。在下面的示例中，最新的数据将符号链接到最新目录YYYY-MM-DD_HH:mm:ss中的数据。用户可以选择通过将目录名称传递给 –output_dirname（即 –output_dirname myTest1Ouput）来覆盖目录名称。</p> 
<p>框架诊断步骤生成的浮动数据为验证组件提供精确的参考资料，以诊断推理引擎生成的网络的准确性。除非另外指定路径，否则 Accuracy Debugger 将在当前工作目录中找到的working_directory/framework_diagnosis目录中创建目录。这些目录将以程序执行的日期和时间命名，并包含张量数据。根据模型的张量命名约定，新目录中可能有许多子目录。当张量名称包含斜杠“/”时，就会发生这种情况。例如，对于张量名称“inception_3a/1x1/bn/sc”、“inception_3a/1x1/bn/sc_internal”和“inception_3a/1x1/bn”，将生成子目录。</p> 
<p><img src="https://images2.imgbox.com/a3/ca/i66XgCHE_o.png" alt="请添加图片描述"><br> 上图显示了 Framework_diagnosis 运行的示例输出。InceptionV3 和 Logits 包含最后一层之前每一层的输出。每个输出目录包含与每个节点对应的.raw 文件。每个可见的原始文件都是操作的输出。最后一层的输出保存在 Predictions 目录中。文件framework_diagnosis_options.json包含用于运行此功能的所有选项。</p> 
<p>推理机<br> 推理引擎功能旨在查找 QNN 模型的输出。该步骤产生的输出可以与框架诊断步骤产生的黄金输出进行比较。</p> 
<p>用法</p> 
<pre><code class="prism language-c">usage<span class="token operator">:</span> <span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger <span class="token operator">--</span>inference_engine <span class="token punctuation">[</span><span class="token operator">-</span>h<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>stage <span class="token punctuation">{<!-- --></span>source<span class="token punctuation">,</span>converted<span class="token punctuation">,</span>compiled<span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token operator">-</span>r
                                   <span class="token punctuation">{<!-- --></span>cpu<span class="token punctuation">,</span>gpu<span class="token punctuation">,</span>dsp<span class="token punctuation">,</span>dspv65<span class="token punctuation">,</span>dspv66<span class="token punctuation">,</span>dspv68<span class="token punctuation">,</span>dspv69<span class="token punctuation">,</span>dspv73<span class="token punctuation">,</span>aic<span class="token punctuation">,</span>htp<span class="token punctuation">}</span>
                                   <span class="token operator">-</span>p ENGINE_PATH <span class="token operator">-</span>a
                                   <span class="token punctuation">{<!-- --></span>aarch64<span class="token operator">-</span>android<span class="token punctuation">,</span>x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang<span class="token punctuation">}</span>
                                   <span class="token operator">-</span>l INPUT_LIST
                                   <span class="token punctuation">[</span><span class="token operator">-</span>i INPUT_TENSOR <span class="token punctuation">[</span>INPUT_TENSOR <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>o OUTPUT_TENSOR<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>m MODEL_PATH<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>f FRAMEWORK <span class="token punctuation">[</span>FRAMEWORK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>qmcpp QNN_MODEL_CPP_PATH<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>qmbin QNN_MODEL_BIN_PATH<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>qmb QNN_MODEL_BINARY_PATH<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>deviceId DEVICEID<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>v<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>host_device <span class="token punctuation">{<!-- --></span>x86<span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>w WORKING_DIR<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>output_dirname OUTPUT_DIRNAME<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>engine_version ENGINE_VERSION<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>debug_mode_off<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>print_version PRINT_VERSION<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>offline_prepare<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>bbw <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>abw <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>golden_dir_for_mapping GOLDEN_DIR_FOR_MAPPING<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>wbw <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>lib_name LIB_NAME<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>bd BINARIES_DIR<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>qmn MODEL_NAME<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>pq <span class="token punctuation">{<!-- --></span>tf<span class="token punctuation">,</span>enhanced<span class="token punctuation">,</span>adjusted<span class="token punctuation">,</span>symmetric<span class="token punctuation">}</span><span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>qo QUANTIZATION_OVERRIDES<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>act_quantizer <span class="token punctuation">{<!-- --></span>tf<span class="token punctuation">,</span>enhanced<span class="token punctuation">,</span>adjusted<span class="token punctuation">,</span>symmetric<span class="token punctuation">}</span><span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>algorithms ALGORITHMS<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>ignore_encodings<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>per_channel_quantization<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>idt <span class="token punctuation">{<!-- --></span><span class="token keyword">float</span><span class="token punctuation">,</span>native<span class="token punctuation">}</span><span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">-</span>odt <span class="token punctuation">{<!-- --></span>float_only<span class="token punctuation">,</span>native_only<span class="token punctuation">,</span>float_and_native<span class="token punctuation">}</span><span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>profiling_level <span class="token punctuation">{<!-- --></span>basic<span class="token punctuation">,</span>detailed<span class="token punctuation">}</span><span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>perf_profile <span class="token punctuation">{<!-- --></span>low_balanced<span class="token punctuation">,</span>balanced<span class="token punctuation">,</span>high_performance<span class="token punctuation">,</span>sustained_high_performance<span class="token punctuation">,</span>burst<span class="token punctuation">,</span>low_power_saver<span class="token punctuation">,</span>power_saver<span class="token punctuation">,</span>high_power_saver<span class="token punctuation">,</span>extreme_power_saver<span class="token punctuation">,</span>system_settings<span class="token punctuation">}</span><span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>log_level <span class="token punctuation">{<!-- --></span>error<span class="token punctuation">,</span>warn<span class="token punctuation">,</span>info<span class="token punctuation">,</span>debug<span class="token punctuation">,</span>verbose<span class="token punctuation">}</span><span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>qnn_model_net_json QNN_MODEL_NET_JSON<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>qnn_netrun_config_file QNN_NETRUN_CONFIG_FILE<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>extra_converter_args EXTRA_CONVERTER_ARGS<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>extra_runtime_args EXTRA_RUNTIME_ARGS<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>compiler_config COMPILER_CONFIG<span class="token punctuation">]</span>
                                   <span class="token punctuation">[</span><span class="token operator">--</span>precision <span class="token punctuation">{<!-- --></span>int8<span class="token punctuation">,</span>fp16<span class="token punctuation">}</span><span class="token punctuation">]</span>

Script to run QNN inference engine<span class="token punctuation">.</span>

optional arguments<span class="token operator">:</span>
     <span class="token operator">-</span>h<span class="token punctuation">,</span> <span class="token operator">--</span>help            show this help message and exit

Core Arguments<span class="token operator">:</span>
     <span class="token operator">--</span>stage <span class="token punctuation">{<!-- --></span>source<span class="token punctuation">,</span>converted<span class="token punctuation">,</span>compiled<span class="token punctuation">}</span>
                             Specifies the starting stage in the Accuracy Debugger
                             pipeline<span class="token punctuation">.</span>
                             Source<span class="token operator">:</span> starting with source framework model <span class="token punctuation">[</span><span class="token keyword">default</span><span class="token punctuation">]</span><span class="token punctuation">.</span>
                             Converted<span class="token operator">:</span> starting with model<span class="token punctuation">.</span>cpp and <span class="token punctuation">.</span>bin files<span class="token punctuation">.</span>
                             Compiled<span class="token operator">:</span> starting with a model's <span class="token punctuation">.</span>so binary<span class="token punctuation">.</span>
     <span class="token operator">-</span>r <span class="token punctuation">{<!-- --></span>cpu<span class="token punctuation">,</span>gpu<span class="token punctuation">,</span>dsp<span class="token punctuation">,</span>dspv65<span class="token punctuation">,</span>dspv66<span class="token punctuation">,</span>dspv68<span class="token punctuation">,</span>dspv69<span class="token punctuation">,</span>dspv73<span class="token punctuation">,</span>aic<span class="token punctuation">,</span>htp<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">--</span>runtime <span class="token punctuation">{<!-- --></span>cpu<span class="token punctuation">,</span>gpu<span class="token punctuation">,</span>dsp<span class="token punctuation">,</span>dspv65<span class="token punctuation">,</span>dspv66<span class="token punctuation">,</span>dspv68<span class="token punctuation">,</span>dspv69<span class="token punctuation">,</span>dspv73<span class="token punctuation">,</span>aic<span class="token punctuation">,</span>htp<span class="token punctuation">}</span>
                             Runtime to be used<span class="token punctuation">.</span>
                             Use HTP runtime <span class="token keyword">for</span> emulation on x86 host<span class="token punctuation">.</span>
     <span class="token operator">-</span>a <span class="token punctuation">{<!-- --></span>aarch64<span class="token operator">-</span>android<span class="token punctuation">,</span>x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">--</span>architecture <span class="token punctuation">{<!-- --></span>aarch64<span class="token operator">-</span>android<span class="token punctuation">,</span>x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang<span class="token punctuation">}</span>
                             Name of the architecture to use <span class="token keyword">for</span> inference engine<span class="token punctuation">.</span>
     <span class="token operator">-</span>l INPUT_LIST<span class="token punctuation">,</span> <span class="token operator">--</span>input_list INPUT_LIST
                             Path to the input list text<span class="token punctuation">.</span>

Arguments required <span class="token keyword">for</span> SOURCE stage<span class="token operator">:</span>
     <span class="token operator">-</span>i INPUT_TENSOR <span class="token punctuation">[</span>INPUT_TENSOR <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">--</span>input_tensor INPUT_TENSOR <span class="token punctuation">[</span>INPUT_TENSOR <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                             The name<span class="token punctuation">,</span> dimension<span class="token punctuation">,</span> and raw data of the network input
                             <span class="token function">tensor</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> specified in the format <span class="token string">"input_name"</span> comma<span class="token operator">-</span>
                             separated<span class="token operator">-</span>dimensions path<span class="token operator">-</span>to<span class="token operator">-</span>raw<span class="token operator">-</span>file<span class="token punctuation">,</span> <span class="token keyword">for</span> example<span class="token operator">:</span>
                             <span class="token string">"data"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">3</span> data<span class="token punctuation">.</span>raw<span class="token punctuation">.</span> Note that the quotes
                             should always be included in order to handle special
                             characters<span class="token punctuation">,</span> spaces<span class="token punctuation">,</span> etc<span class="token punctuation">.</span> For multiple inputs specify
                             multiple <span class="token operator">--</span>input_tensor on the command line like<span class="token operator">:</span>
                             <span class="token operator">--</span>input_tensor <span class="token string">"data1"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">3</span> data1<span class="token punctuation">.</span>raw
                             <span class="token operator">--</span>input_tensor <span class="token string">"data2"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">3</span> data2<span class="token punctuation">.</span>raw<span class="token punctuation">.</span>
     <span class="token operator">-</span>o OUTPUT_TENSOR<span class="token punctuation">,</span> <span class="token operator">--</span>output_tensor OUTPUT_TENSOR
                             Name of the graph's output <span class="token function">tensor</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span>
     <span class="token operator">-</span>m MODEL_PATH<span class="token punctuation">,</span> <span class="token operator">--</span>model_path MODEL_PATH
                             Path to the model <span class="token function">file</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span>
     <span class="token operator">-</span>f FRAMEWORK <span class="token punctuation">[</span>FRAMEWORK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">--</span>framework FRAMEWORK <span class="token punctuation">[</span>FRAMEWORK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                             Framework type to be used<span class="token punctuation">,</span> followed optionally by
                             framework version<span class="token punctuation">.</span>

Arguments required <span class="token keyword">for</span> CONVERTED stage<span class="token operator">:</span>
     <span class="token operator">-</span>qmcpp QNN_MODEL_CPP_PATH<span class="token punctuation">,</span> <span class="token operator">--</span>qnn_model_cpp_path QNN_MODEL_CPP_PATH
                             Path to the qnn model <span class="token punctuation">.</span>cpp file
     <span class="token operator">-</span>qmbin QNN_MODEL_BIN_PATH<span class="token punctuation">,</span> <span class="token operator">--</span>qnn_model_bin_path QNN_MODEL_BIN_PATH
                             Path to the qnn model <span class="token punctuation">.</span>bin file

Arguments required <span class="token keyword">for</span> COMPILED stage<span class="token operator">:</span>
     <span class="token operator">-</span>qmb QNN_MODEL_BINARY_PATH<span class="token punctuation">,</span> <span class="token operator">--</span>qnn_model_binary_path QNN_MODEL_BINARY_PATH
                             Path to the qnn model <span class="token punctuation">.</span>so binary<span class="token punctuation">.</span>

Optional Arguments<span class="token operator">:</span>
     <span class="token operator">--</span>deviceId DEVICEID   The serial number of the device to use<span class="token punctuation">.</span> If not
                             available<span class="token punctuation">,</span> the first in a list of queried devices will
                             be used <span class="token keyword">for</span> validation<span class="token punctuation">.</span>
     <span class="token operator">-</span>v<span class="token punctuation">,</span> <span class="token operator">--</span>verbose         Verbose printing
     <span class="token operator">--</span>host_device <span class="token punctuation">{<!-- --></span>x86<span class="token punctuation">}</span>   The device that will be running conversion<span class="token punctuation">.</span> Set to x86
                             by <span class="token keyword">default</span><span class="token punctuation">.</span>
     <span class="token operator">-</span>w WORKING_DIR<span class="token punctuation">,</span> <span class="token operator">--</span>working_dir WORKING_DIR
                             Working directory <span class="token keyword">for</span> the inference_engine to store
                             temporary files<span class="token punctuation">.</span> Creates a new directory <span class="token keyword">if</span> the
                             specified working directory does not exist
     <span class="token operator">--</span>output_dirname OUTPUT_DIRNAME
                             output directory name <span class="token keyword">for</span> the inference_engine to
                             store temporary files under
                             <span class="token operator">&lt;</span>working_dir<span class="token operator">&gt;</span><span class="token operator">/</span>inference_engine <span class="token punctuation">.</span>Creates a new
                             directory <span class="token keyword">if</span> the specified working directory does not
                             exist
     <span class="token operator">-</span>p ENGINE_PATH<span class="token punctuation">,</span> <span class="token operator">--</span>engine_path ENGINE_PATH
                             Path to the inference engine<span class="token punctuation">.</span>
     <span class="token operator">--</span>debug_mode_off      Specifies <span class="token keyword">if</span> wish to turn off debug_mode mode<span class="token punctuation">.</span>
     <span class="token operator">--</span>print_version PRINT_VERSION
                             Print the QNN SDK version alongside the output<span class="token punctuation">.</span>
     <span class="token operator">--</span>offline_prepare     Use offline prepare to run qnn model<span class="token punctuation">.</span>
     <span class="token operator">-</span>bbw <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">--</span>bias_bitwidth <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">}</span>
                             option to select the bitwidth to use when quantizing
                             the bias<span class="token punctuation">.</span> <span class="token keyword">default</span> <span class="token number">8</span>
     <span class="token operator">-</span>abw <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">--</span>act_bitwidth <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">}</span>
                             option to select the bitwidth to use when quantizing
                             the activations<span class="token punctuation">.</span> <span class="token keyword">default</span> <span class="token number">8</span>
     <span class="token operator">--</span>golden_output_reference_directory GOLDEN_OUTPUT_REFERENCE_DIRECTORY<span class="token punctuation">,</span> <span class="token operator">--</span>golden_dir_for_mapping GOLDEN_DIR_FOR_MAPPING
                             Optional parameter to indicate the directory of the
                             goldens<span class="token punctuation">,</span> it's used <span class="token keyword">for</span> tensor mapping without
                             framework<span class="token punctuation">.</span>
     <span class="token operator">-</span>wbw <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">--</span>weights_bitwidth <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">}</span>
                             option to select the bitwidth to use when quantizing
                             the weights<span class="token punctuation">.</span> Only support <span class="token number">8</span> atm
     <span class="token operator">--</span>float_bitwidth <span class="token punctuation">{<!-- --></span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">}</span>
                             option to select the bitwidth to use when using <span class="token keyword">float</span>
                             <span class="token keyword">for</span> <span class="token function">parameters</span><span class="token punctuation">(</span>weights<span class="token operator">/</span>bias<span class="token punctuation">)</span> and activations <span class="token keyword">for</span> all
                             ops or specific <span class="token function">Op</span> <span class="token punctuation">(</span>via encodings<span class="token punctuation">)</span> selected through
                             encoding<span class="token punctuation">;</span> either <span class="token number">32</span> <span class="token punctuation">(</span><span class="token keyword">default</span><span class="token punctuation">)</span> or <span class="token number">16</span>
     <span class="token operator">-</span>nif<span class="token punctuation">,</span> <span class="token operator">--</span>use_native_input_files
                             Specifies that the input files will be parsed in the
                             data type native to the graph<span class="token punctuation">.</span> If not specified<span class="token punctuation">,</span> input
                             files will be parsed in floating point<span class="token punctuation">.</span>
     <span class="token operator">-</span>nof<span class="token punctuation">,</span> <span class="token operator">--</span>use_native_output_files
                             Specifies that the output files will be generated in
                             the data type native to the graph<span class="token punctuation">.</span> If not specified<span class="token punctuation">,</span>
                             output files will be generated in floating point<span class="token punctuation">.</span>
     <span class="token operator">--</span>lib_name LIB_NAME   Name to use <span class="token keyword">for</span> model <span class="token function">library</span> <span class="token punctuation">(</span><span class="token punctuation">.</span>so file<span class="token punctuation">)</span>
     <span class="token operator">-</span>bd BINARIES_DIR<span class="token punctuation">,</span> <span class="token operator">--</span>binaries_dir BINARIES_DIR
                             Directory to which to save model binaries<span class="token punctuation">,</span> <span class="token keyword">if</span> they
                             don't yet exist<span class="token punctuation">.</span>
     <span class="token operator">-</span>mn MODEL_NAME<span class="token punctuation">,</span> <span class="token operator">--</span>model_name MODEL_NAME
                             Name of the desired output qnn model
     <span class="token operator">-</span>pq <span class="token punctuation">{<!-- --></span>tf<span class="token punctuation">,</span>enhanced<span class="token punctuation">,</span>adjusted<span class="token punctuation">,</span>symmetric<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">--</span>param_quantizer <span class="token punctuation">{<!-- --></span>tf<span class="token punctuation">,</span>enhanced<span class="token punctuation">,</span>adjusted<span class="token punctuation">,</span>symmetric<span class="token punctuation">}</span>
                             Param quantizer algorithm used<span class="token punctuation">.</span>
     <span class="token operator">-</span>qo QUANTIZATION_OVERRIDES<span class="token punctuation">,</span> <span class="token operator">--</span>quantization_overrides QUANTIZATION_OVERRIDES
                             Path to quantization overrides json file<span class="token punctuation">.</span>
     <span class="token operator">--</span>act_quantizer <span class="token punctuation">{<!-- --></span>tf<span class="token punctuation">,</span>enhanced<span class="token punctuation">,</span>adjusted<span class="token punctuation">,</span>symmetric<span class="token punctuation">}</span>
                             Optional parameter to indicate the activation
                             quantizer to use
     <span class="token operator">-</span>fbw <span class="token punctuation">{<!-- --></span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">--</span>float_bias_bitwidth <span class="token punctuation">{<!-- --></span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">}</span>
                             option to select the bitwidth to use when biases are in <span class="token keyword">float</span><span class="token punctuation">;</span> <span class="token keyword">default</span> is <span class="token number">32</span>
     <span class="token operator">-</span>rqs RESTRICT_QUANTIZATION_STEPS<span class="token punctuation">,</span> <span class="token operator">--</span>restrict_quantization_steps RESTRICT_QUANTIZATION_STEPS
                             ENCODING_MIN<span class="token punctuation">,</span> ENCODING_MAX
                             Specifies the number of steps to use to compute quantization encodings such that
                             scale <span class="token operator">=</span> <span class="token punctuation">(</span>max <span class="token operator">-</span> min<span class="token punctuation">)</span> <span class="token operator">/</span> number of quantization steps<span class="token punctuation">.</span>
                             The option should be passed as a space separated pair of hexadecimal string minimum and maximum values<span class="token punctuation">,</span>
                             i<span class="token punctuation">.</span>e<span class="token punctuation">.</span> <span class="token operator">--</span>restrict_quantization_steps <span class="token char">'MIN MAX'</span><span class="token punctuation">.</span> Note that this is a hexadecimal string
                             literal and not a <span class="token keyword">signed</span> integer<span class="token punctuation">.</span> To supply a negative value an explicit minus sign is required<span class="token punctuation">.</span>
                             e<span class="token punctuation">.</span>g<span class="token punctuation">.</span><span class="token operator">:</span> <span class="token number">8</span><span class="token operator">-</span>bit range<span class="token operator">:</span> <span class="token operator">--</span>restrict_quantization_steps <span class="token char">'-0x80 0x7F'</span>
                             <span class="token number">16</span><span class="token operator">-</span>bit range<span class="token operator">:</span> <span class="token operator">--</span>restrict_quantization_steps <span class="token char">'-0x8000 0x7F7F'</span>
     <span class="token operator">--</span>algorithms ALGORITHMS
                             Use this option to enable new optimization algorithms<span class="token punctuation">.</span>
                             Usage is<span class="token operator">:</span> <span class="token operator">--</span>algorithms <span class="token operator">&lt;</span>algo_name1<span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> The available
                             optimization algorithms are<span class="token operator">:</span> <span class="token char">'cle '</span> <span class="token operator">-</span> Cross layer
                             equalization includes a number of methods <span class="token keyword">for</span>
                             equalizing weights and biases across layers in order
                             to rectify imbalances that cause quantization errors<span class="token punctuation">.</span>
     <span class="token operator">--</span>ignore_encodings    Use only quantizer generated encodings<span class="token punctuation">,</span> ignoring any
                             user or model provided encodings<span class="token punctuation">.</span>
     <span class="token operator">--</span>per_channel_quantization
                             Use per<span class="token operator">-</span>channel quantization <span class="token keyword">for</span> convolution<span class="token operator">-</span>based op
                             weights<span class="token punctuation">.</span>
     <span class="token operator">-</span>idt <span class="token punctuation">{<!-- --></span><span class="token keyword">float</span><span class="token punctuation">,</span>native<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">--</span>input_data_type <span class="token punctuation">{<!-- --></span><span class="token keyword">float</span><span class="token punctuation">,</span>native<span class="token punctuation">}</span>
                             the input data type<span class="token punctuation">,</span> must match with the supplied
                             inputs
     <span class="token operator">-</span>odt <span class="token punctuation">{<!-- --></span>float_only<span class="token punctuation">,</span>native_only<span class="token punctuation">,</span>float_and_native<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">--</span>output_data_type <span class="token punctuation">{<!-- --></span>float_only<span class="token punctuation">,</span>native_only<span class="token punctuation">,</span>float_and_native<span class="token punctuation">}</span>
                             the desired output data type
     <span class="token operator">--</span>profiling_level <span class="token punctuation">{<!-- --></span>basic<span class="token punctuation">,</span>detailed<span class="token punctuation">,</span>backend<span class="token punctuation">}</span>
                             Enables profiling and sets its level<span class="token punctuation">.</span>
     <span class="token operator">--</span>perf_profile <span class="token punctuation">{<!-- --></span>low_balanced<span class="token punctuation">,</span>balanced<span class="token punctuation">,</span>high_performance<span class="token punctuation">,</span>sustained_high_performance<span class="token punctuation">,</span>burst<span class="token punctuation">,</span>low_power_saver<span class="token punctuation">,</span>power_saver<span class="token punctuation">,</span>high_power_saver<span class="token punctuation">,</span>extreme_power_saver<span class="token punctuation">,</span>system_settings<span class="token punctuation">}</span>
     <span class="token operator">--</span>log_level <span class="token punctuation">{<!-- --></span>error<span class="token punctuation">,</span>warn<span class="token punctuation">,</span>info<span class="token punctuation">,</span>debug<span class="token punctuation">,</span>verbose<span class="token punctuation">}</span>
                             Enable verbose logging<span class="token punctuation">.</span>
     <span class="token operator">--</span>qnn_model_net_json QNN_MODEL_NET_JSON
                             Path to the qnn model net json<span class="token punctuation">.</span> Only necessary <span class="token keyword">if</span> its being run from the converted stage<span class="token punctuation">.</span> It has information about what structure the data is in within framework_diagnosis and inference_engine steps<span class="token punctuation">.</span>
                             This file is required to generate model_graph_struct<span class="token punctuation">.</span>json file which is good to have in the verification step<span class="token punctuation">.</span>
     <span class="token operator">--</span>qnn_netrun_config_file QNN_NETRUN_CONFIG_FILE
                             allow backend_extention features to be applied during
                             qnn<span class="token operator">-</span>net<span class="token operator">-</span>run
     <span class="token operator">--</span>extra_converter_args EXTRA_CONVERTER_ARGS
                             additional convereter arguments in a string<span class="token punctuation">.</span> example<span class="token operator">:</span>
                             <span class="token operator">--</span>extra_converter_args input_dtype<span class="token operator">=</span>data
                             <span class="token keyword">float</span><span class="token punctuation">;</span>input_layout<span class="token operator">=</span>data1 NCHW
     <span class="token operator">--</span>extra_contextbin_args EXTRA_CONTEXTBIN_ARGS
                             additional context binary generator arguments in a quoted string<span class="token punctuation">.</span>
                             example<span class="token operator">:</span> <span class="token operator">--</span>extra_contextbin_args <span class="token char">'arg1=value1;arg2=value2'</span>
     <span class="token operator">--</span>extra_runtime_args EXTRA_RUNTIME_ARGS
                             additional convereter arguments in a quoted string<span class="token punctuation">.</span>
                             example<span class="token operator">:</span> <span class="token operator">--</span>extra_runtime_args
                             profiling_level<span class="token operator">=</span>basic<span class="token punctuation">;</span>log_level<span class="token operator">=</span>debug
     <span class="token operator">--</span>compiler_config COMPILER_CONFIG
                             Path to the compiler config file<span class="token punctuation">.</span>
     <span class="token operator">--</span>precision <span class="token punctuation">{<!-- --></span>int8<span class="token punctuation">,</span>fp16<span class="token punctuation">}</span>
                             select precision
     <span class="token operator">--</span>intermediate_output_tensors INTERMEDIATE_OUTPUT_TENSORS
                             Output tensor names to be dumped<span class="token punctuation">.</span> example<span class="token operator">:</span><span class="token number">1579</span><span class="token punctuation">,</span><span class="token number">232</span>
Please note<span class="token operator">:</span> All the command line arguments should either be provided through command line or through the config file<span class="token punctuation">.</span> They will not override those in the config file <span class="token keyword">if</span> there is overlap<span class="token punctuation">.</span>

</code></pre> 
<p>推理引擎配置文件位于{accuracy_debugger 工具根目录}/python/qti/aisw/accuracy_debugger/lib/inference_engine/configs/config_files中，是一个JSON文件。此配置文件存储的信息可帮助推理引擎确定要读入的工具和参数。</p> 
<p>命令示例</p> 
<pre><code class="prism language-c"><span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>inference_engine \
    <span class="token operator">--</span>framework tensorflow \
    <span class="token operator">--</span>runtime dspv73 \
    <span class="token operator">--</span>model_path $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>inception_v3_2016_08_28_frozen<span class="token punctuation">.</span>pb \
    <span class="token operator">--</span>input_tensor <span class="token string">"input:0"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">299</span><span class="token punctuation">,</span><span class="token number">299</span><span class="token punctuation">,</span><span class="token number">3</span> $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>data<span class="token operator">/</span>chairs<span class="token punctuation">.</span>raw \
    <span class="token operator">--</span>output_tensor InceptionV3<span class="token operator">/</span>Predictions<span class="token operator">/</span>Reshape_1 \
    <span class="token operator">--</span>architecture x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang \
    <span class="token operator">--</span>input_list $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>data<span class="token operator">/</span>image_list<span class="token punctuation">.</span>txt \
    <span class="token operator">--</span>verbose

</code></pre> 
<p>命令示例</p> 
<pre><code class="prism language-c"><span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>inference_engine \
    <span class="token operator">--</span>deviceId <span class="token number">357415</span>c4 \
    <span class="token operator">--</span>framework tensorflow \
    <span class="token operator">--</span>runtime dspv73 \
    <span class="token operator">--</span>architecture aarch64<span class="token operator">-</span>android \
    <span class="token operator">--</span>model_path $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>inception_v3_2016_08_28_frozen<span class="token punctuation">.</span>pb \
    <span class="token operator">--</span>input_tensor <span class="token string">"input:0"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">299</span><span class="token punctuation">,</span><span class="token number">299</span><span class="token punctuation">,</span><span class="token number">3</span> $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>data<span class="token operator">/</span>chairs<span class="token punctuation">.</span>raw \
    <span class="token operator">--</span>output_tensor InceptionV3<span class="token operator">/</span>Predictions<span class="token operator">/</span>Reshape_1 \
    <span class="token operator">--</span>input_list $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>data<span class="token operator">/</span>image_list<span class="token punctuation">.</span>txt \
    <span class="token operator">--</span>verbose

</code></pre> 
<p>提示：</p> 
<ul><li> <p>对于运行时（从“cpu”、“gpu”、“dsp”、“dspv65”、“dspv66”、“dspv68”、“dspv69”、“dspv73”、“aic”、“htp”中选择）。确保 kailua 的运行时为 73，waiipio 的运行时为 69，等等。选择 HTP 运行时在 x86 主机上进行模拟。</p> </li><li> <p>输入张量 (-i) 和输出张量 (-o) 不需要像运行张量流框架诊断时那样的 :0 索引</p> </li><li> <p>生成两个文件，即tensor_mapping.json和qnn_model_graph_struct.json用于验证，请务必在working_directory/inference_engine/latest中找到这2个文件</p> </li></ul> 
<p>从不同阶段运行的更多示例命令：</p> 
<p>命令示例</p> 
<pre><code class="prism language-c">source file stage<span class="token operator">:</span> same as example from above <span class="token function">section</span> <span class="token punctuation">(</span>stage <span class="token keyword">default</span> is <span class="token string">"source"</span><span class="token punctuation">)</span>

running from converted <span class="token function">stage</span> <span class="token punctuation">(</span>x86<span class="token punctuation">)</span><span class="token operator">:</span>
<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>inference_engine \
    <span class="token operator">--</span>stage converted \
    <span class="token operator">-</span>qmcpp $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>inception_v3_2016_08_28_frozen_qnn_model<span class="token punctuation">.</span>cpp \
    <span class="token operator">-</span>qmbin $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>inception_v3_2016_08_28_frozen_qnn_model<span class="token punctuation">.</span>bin \
    <span class="token operator">--</span>runtime dspv73 \
    <span class="token operator">--</span>architecture x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang \
    <span class="token operator">--</span>input_list $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>data<span class="token operator">/</span>image_list<span class="token punctuation">.</span>txt \
    <span class="token operator">--</span>qnn_model_net_json $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>inception_v3_2016_08_28_frozen_qnn_model_net<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>verbose \
    <span class="token operator">--</span>framework tensorflow \
    <span class="token operator">--</span>golden_output_reference_directory $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>golden_from_framework_diagnosis<span class="token operator">/</span>

Android <span class="token function">Devices</span> <span class="token punctuation">(</span>ie<span class="token punctuation">.</span> MTP<span class="token punctuation">)</span><span class="token operator">:</span>
<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>inference_engine \
    <span class="token operator">--</span>stage converted \
    <span class="token operator">-</span>qmcpp $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>inception_v3_2016_08_28_frozen_qnn_model<span class="token punctuation">.</span>cpp \
    <span class="token operator">-</span>qmbin $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>inception_v3_2016_08_28_frozen_qnn_model<span class="token punctuation">.</span>bin \
    <span class="token operator">--</span>deviceId f366ce60 \
    <span class="token operator">--</span>runtime dspv73 \
    <span class="token operator">--</span>architecture aarch64<span class="token operator">-</span>android \
    <span class="token operator">--</span>input_list $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>data<span class="token operator">/</span>image_list<span class="token punctuation">.</span>txt \
    <span class="token operator">--</span>qnn_model_net_json $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>inception_v3_2016_08_28_frozen_qnn_model_net<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>verbose \
    <span class="token operator">--</span>framework tensorflow \
    <span class="token operator">--</span>golden_output_reference_directory $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>golden_from_framework_diagnosis<span class="token operator">/</span>


running in compiled <span class="token function">stage</span> <span class="token punctuation">(</span>x86<span class="token punctuation">)</span><span class="token operator">:</span>

<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>inference_engine \
    <span class="token operator">--</span>stage compiled \
    <span class="token operator">--</span>qnn_model_binary $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>qnn_model_binaries<span class="token operator">/</span>x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang<span class="token operator">/</span>libqnn_model<span class="token punctuation">.</span>so \
    <span class="token operator">--</span>runtime dspv73 \
    <span class="token operator">--</span>architecture x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang \
    <span class="token operator">--</span>input_list $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>data<span class="token operator">/</span>image_list<span class="token punctuation">.</span>txt \
    <span class="token operator">--</span>verbose \
    <span class="token operator">--</span>qnn_model_net_json $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>inception_v3_2016_08_28_frozen_qnn_model_net<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>golden_output_reference_directory $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>golden_from_framework_diagnosis<span class="token operator">/</span>

Android <span class="token function">devices</span> <span class="token punctuation">(</span>ie MTP<span class="token punctuation">)</span><span class="token operator">:</span>
<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>inference_engine \
    <span class="token operator">--</span>stage compiled \
    <span class="token operator">--</span>qnn_model_binary $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>qnn_model_binaries<span class="token operator">/</span>aarch64<span class="token operator">-</span>android<span class="token operator">/</span>libqnn_model<span class="token punctuation">.</span>so \
    <span class="token operator">--</span>runtime dspv73 \
    <span class="token operator">--</span>architecture aarch64<span class="token operator">-</span>android \
    <span class="token operator">--</span>input_list $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>data<span class="token operator">/</span>image_list<span class="token punctuation">.</span>txt \
    <span class="token operator">--</span>verbose \
    <span class="token operator">--</span>qnn_model_net_json $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>inception_v3_2016_08_28_frozen_qnn_model_net<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>framework tensorflow \
    <span class="token operator">--</span>golden_output_reference_directory $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>golden_from_framework_diagnosis<span class="token operator">/</span>

</code></pre> 
<p>提示：</p> 
<ul><li> <p>运行此步骤不需要 qnn_model_net_json 文件。但是，需要构建 qnn_model_graph_struct.json，它可以在验证步骤中使用。model_net.json 文件是在原始模型转换为转换后模型时生成的。因此，如果您从转换后的模型阶段调试此模型，建议您请求此 model_net.json 文件。</p> </li><li> <p>框架和golden_dir_for_mapping，或者只是golden_dir_for_mapping本身是用于生成tensor_mapping.json的原始模型的替代方案。然而，仅提供golden_dir_for_mapping，get_tensor_mapping模块将尽力进行映射，但不能保证该映射100％准确。</p> </li></ul> 
<p>输出<br> 推理引擎运行完成后，会将输出存储在指定目录（默认为当前工作目录）中，并将文件存储在该目录中。默认情况下，它将把输出存储在当前工作目录的working_directory/inference_engine中。</p> 
<p><img src="https://images2.imgbox.com/5e/36/7messq9A_o.png" alt="请添加图片描述"><br> 上图显示了推理引擎步骤之一运行的示例输出。输出目录包含原始文件。每个原始文件都是网络中操作的输出。model.bin 和 model.cpp 文件由模型转换器创建。qnn_model_binaries 目录包含由 modellibgenerator 实用程序生成的 .so 文件。文件 image_list.txt 包含示例测试图像的路径。inference_engine_options.json 文件包含启动此运行时使用的所有选项。除了生成 .raw 文件之外，inference_engine 还在 .json 文件中生成模型的图结构。该文件的名称与protobuf模型文件的名称相同。model_graph_struct.json 有助于在验证步骤期间提供转换后的模型图的结构相关信息。具体来说，它有助于按顺序组织节点（即开始节点应该早于结束节点）。model_net.json 包含有关framework_diagnosis 和inference_engine 步骤中数据的结构的信息（数据可以采用不同的格式，例如通道在前与通道在后）。验证步骤使用此信息，以便可以正确转置和比较数据。它是一个可选参数，可以在推理引擎步骤中提供，用于生成 model_graph_struct.json 文件（仅在从转换阶段运行推理引擎时强制）。最后，tensor_mapping 文件包含框架诊断步骤和推理引擎步骤生成的各种中间输出文件名的映射。</p> 
<p><img src="https://images2.imgbox.com/2a/d8/4ufCgAYJ_o.png" alt="请添加图片描述"><br> 创建的 .raw 文件的组织方式与 Framework_diagnosis 相同（见上文）。</p> 
<p>确认<br> 验证步骤将框架诊断步骤产生的输出（来自给定模型的中间张量）与推理引擎步骤产生的输出进行比较。比较完成后，验证结果将被编译并以用户可以轻松解释的格式直观地显示。</p> 
<p>有不同类型的验证器，例如：CosineSimilarity、RtolAtol 等。要查看可用的验证器，请使用 –help 选项 (./qnn-accuracy-debugger –verification –help)。每个验证者使用错误度量来比较框架诊断和推理引擎输出。它还准备报告和/或可视化以帮助用户分析网络的错误数据。</p> 
<p>用法</p> 
<pre><code class="prism language-c">usage<span class="token operator">:</span> <span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger <span class="token operator">--</span>verification <span class="token punctuation">[</span><span class="token operator">-</span>h<span class="token punctuation">]</span>

Script to run verification<span class="token punctuation">.</span>

required arguments<span class="token operator">:</span>
     <span class="token operator">--</span>default_verifier DEFAULT_VERIFIER <span class="token punctuation">[</span>DEFAULT_VERIFIER <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                             Default verifier used <span class="token keyword">for</span> verification<span class="token punctuation">.</span> The options
                             <span class="token string">"RtolAtol"</span><span class="token punctuation">,</span> <span class="token string">"AdjustedRtolAtol"</span><span class="token punctuation">,</span> <span class="token string">"TopK"</span><span class="token punctuation">,</span> <span class="token string">"L1Error"</span><span class="token punctuation">,</span>
                             <span class="token string">"CosineSimilarity"</span><span class="token punctuation">,</span> <span class="token string">"MSE"</span><span class="token punctuation">,</span> <span class="token string">"MAE"</span><span class="token punctuation">,</span> <span class="token string">"SQNR"</span><span class="token punctuation">,</span> <span class="token string">"MeanIOU"</span><span class="token punctuation">,</span>
                             <span class="token string">"ScaledDiff"</span> are supported<span class="token punctuation">.</span> An optional list of
                             hyperparameters can be appended<span class="token punctuation">.</span> For example<span class="token operator">:</span>
                             <span class="token operator">--</span>default_verifier
                             rtolatol<span class="token punctuation">,</span>rtolmargin<span class="token punctuation">,</span><span class="token number">0.01</span><span class="token punctuation">,</span>atolmargin<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">01.</span> An optional
                             list of placeholders can be appended<span class="token punctuation">.</span> For example<span class="token operator">:</span>
                             <span class="token operator">--</span>default_verifier CosineSimilarity param1 <span class="token number">1</span> param2 <span class="token number">2.</span>
                             to use multiple verifiers<span class="token punctuation">,</span> add additional
                             <span class="token operator">--</span>default_verifier CosineSimilarity
     <span class="token operator">--</span>golden_output_reference_directory GOLDEN_OUTPUT_REFERENCE_DIRECTORY<span class="token punctuation">,</span> <span class="token operator">--</span>framework_results FRAMEWORK_RESULTS
                             Path to root directory generated from framework
                             diagnosis<span class="token punctuation">.</span> Paths may be absolute<span class="token punctuation">,</span> or relative to the
                             working directory<span class="token punctuation">.</span>
     <span class="token operator">--</span>inference_results INFERENCE_RESULTS
                             Path to root directory generated from inference engine
                             diagnosis<span class="token punctuation">.</span> Paths may be absolute<span class="token punctuation">,</span> or relative to the
                             working directory<span class="token punctuation">.</span>

optional arguments<span class="token operator">:</span>
     <span class="token operator">--</span>tensor_mapping TENSOR_MAPPING
                             Path to the file describing the tensor name mapping
                             between inference and golden tensors<span class="token punctuation">.</span>can be generated
                             with in the inference engine step<span class="token punctuation">.</span>
     <span class="token operator">--</span>verifier_config VERIFIER_CONFIG
                             Path to the verifiers' config file
     <span class="token operator">--</span>graph_struct GRAPH_STRUCT
                             Path to the inference graph structure <span class="token punctuation">.</span>json file<span class="token punctuation">.</span> This file
                             aids in providing the structure related information of the converted model graph during this step<span class="token punctuation">.</span>
     <span class="token operator">-</span>v<span class="token punctuation">,</span> <span class="token operator">--</span>verbose         Verbose printing
     <span class="token operator">-</span>w WORKING_DIR<span class="token punctuation">,</span> <span class="token operator">--</span>working_dir WORKING_DIR
                             Working directory <span class="token keyword">for</span> the verification to store
                             temporary files<span class="token punctuation">.</span> Creates a new directory <span class="token keyword">if</span> the
                             specified working directory does not exist
     <span class="token operator">--</span>output_dirname OUTPUT_DIRNAME
                             output directory name <span class="token keyword">for</span> the verification to store
                             temporary files under <span class="token operator">&lt;</span>working_dir<span class="token operator">&gt;</span><span class="token operator">/</span>verification<span class="token punctuation">.</span>
                             Creates a new directory <span class="token keyword">if</span> the specified working
                             directory does not exist
     <span class="token operator">--</span>qnn_model_json_path QNN_MODEL_JSON_PATH
                             Path to the model json <span class="token keyword">for</span> transforming intermediate
                             tensors to spatial<span class="token operator">-</span>first axis order<span class="token punctuation">.</span>

arguments <span class="token keyword">for</span> generating a new tensor_mapping<span class="token punctuation">.</span>json<span class="token operator">:</span>
     <span class="token operator">-</span>m MODEL_PATH<span class="token punctuation">,</span> <span class="token operator">--</span>model_path MODEL_PATH
                             path to original model <span class="token keyword">for</span> tensor_mapping uses here<span class="token punctuation">.</span>
     <span class="token operator">-</span>e ENGINE_NAME <span class="token punctuation">[</span>ENGINE_VERSION <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">--</span>engine ENGINE_NAME <span class="token punctuation">[</span>ENGINE_VERSION <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                             Name of engine that will be running inference<span class="token punctuation">,</span>
                             optionally followed by the engine version<span class="token punctuation">.</span> Used here
                             <span class="token keyword">for</span> tensor_mapping<span class="token punctuation">.</span>
     <span class="token operator">-</span>f FRAMEWORK <span class="token punctuation">[</span>FRAMEWORK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">--</span>framework FRAMEWORK <span class="token punctuation">[</span>FRAMEWORK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                             Framework type to be used<span class="token punctuation">,</span> followed optionally by
                             framework version<span class="token punctuation">.</span> Used here <span class="token keyword">for</span> tensor_mapping<span class="token punctuation">.</span>

Please note<span class="token operator">:</span> All the command line arguments should either be provided through command line or through the config file<span class="token punctuation">.</span> They will not override those in the config file <span class="token keyword">if</span> there is overlap<span class="token punctuation">.</span>

</code></pre> 
<p>使用 ./qnn-accuracy-debugger 运行的主要验证过程 –verification 可以选择使用 –tensor_mapping 和 –graph_struct 来查找要比较的文件。这些文件由推理引擎步骤生成，应提供给验证以获得最佳结果。默认情况下，它们被命名为tensor_mapping.json和{模型名称}_graph_struct.json，可以在推理引擎结果的输出目录中找到。</p> 
<p>命令示例</p> 
<pre><code class="prism language-c">Compare output of framework diagnosis with inference engine<span class="token operator">:</span>

<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
     <span class="token operator">--</span>verification \
     <span class="token operator">--</span>default_verifier CosineSimilarity param1 <span class="token number">1</span> param2 <span class="token number">2</span> \
     <span class="token operator">--</span>default_verifier SQNR param1 <span class="token number">5</span> param2 <span class="token number">1</span> \
     <span class="token operator">--</span>golden_output_reference_directory $PROJECTREPOPATH<span class="token operator">/</span>working_directory<span class="token operator">/</span>framework_diagnosis<span class="token operator">/</span><span class="token number">2022</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">31</span>_17<span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">58</span><span class="token operator">/</span> \
     <span class="token operator">--</span>inference_results $PROJECTREPOPATH<span class="token operator">/</span>working_directory<span class="token operator">/</span>inference_engine<span class="token operator">/</span>latest<span class="token operator">/</span>output<span class="token operator">/</span>Result_0<span class="token operator">/</span> \
     <span class="token operator">--</span>tensor_mapping $PROJECTREPOPATH<span class="token operator">/</span>working_directory<span class="token operator">/</span>inference_engine<span class="token operator">/</span>latest<span class="token operator">/</span>tensor_mapping<span class="token punctuation">.</span>json \
     <span class="token operator">--</span>graph_struct $PROJECTREPOPATH<span class="token operator">/</span>working_directory<span class="token operator">/</span>inference_engine<span class="token operator">/</span>latest<span class="token operator">/</span>qnn_model_graph_struct<span class="token punctuation">.</span>json \
     <span class="token operator">--</span>qnn_model_json_path $PROJECTREPOPATH<span class="token operator">/</span>working_directory<span class="token operator">/</span>inference_engine<span class="token operator">/</span>latest<span class="token operator">/</span>qnn_model_net<span class="token punctuation">.</span>json

</code></pre> 
<p>提示：</p> 
<ul><li> <p>如果您从运行推理引擎诊断中传递了 image_list.txt 中的多个图像，您将收到多个输出/Result_x，选择与您用于框架诊断的输入相匹配的结果进行比较（即，在框架中您使用了 chair.raw 和 inference chair.raw 是 image_list.txt 中的第一项，然后选择 output/Result_0，如果 chair.raw 是 image_list.txt 中的第二项，则选择 output/Result_1)。</p> </li><li> <p>建议始终向命令提供“graph_struct”和“tensor_mapping”，因为它用于排列报告并查找相应的文件进行比较。如果前面的步骤没有生成tensor_mapping，您可以补充’model_path’，‘engine’，‘framework’以使模块在运行时生成’tensor_mapping’。</p> </li><li> <p>您还可以通过将 inference_engine 输出的 /output 传递到“framework_results”来将 inference_engine 输出与 inference_engine 输出进行比较。如果您希望输出完全名称匹配，则不需要提供tensor_mapping 文件。</p> </li><li> <p>请注意，如果您需要生成张量映射而不是提供现有张量映射文件的路径。您可以提供“model_path”选项。</p> </li></ul> 
<p>验证程序使用两个可选的配置文件。第一个文件用于设置特定验证器的参数，以及在哪些张量上使用这些验证器。第二个文件用于将张量名称从framework_diagnosis映射到inference_engine，因为framework_diagnosis生成的某些张量可能与inference_engine生成的张量具有不同的名称。</p> 
<p>验证器配置：</p> 
<p>验证器配置文件是一个 JSON 文件，它告诉验证要使用哪些验证器（默认验证器除外）、使用哪些参数以及在哪些特定张量上。如果未提供配置文件，该工具将仅在所有张量上使用从命令行指定的默认验证器及其默认参数。JSON 文件以验证者名称为键，每个验证者都是自己的字典，以“参数”和“张量”为键。</p> 
<p>配置文件</p> 
<pre><code class="prism language-c">```json
<span class="token punctuation">{<!-- --></span>
    <span class="token string">"MeanIOU"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"parameters"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"background_classification"</span><span class="token operator">:</span> <span class="token number">1.0</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"tensors"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"Postprocessor/BatchMultiClassNonMaxSuppression_boxes"</span><span class="token punctuation">,</span> <span class="token string">"detection_classes:0"</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"TopK"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"parameters"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"k"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token string">"ordered"</span><span class="token operator">:</span> false
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"tensors"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"Reshape_1:0"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"detection_classes:0"</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>请注意，“张量”字段是列表的列表。这样做是因为特定验证器（例如 MeanIOU）一次在两个张量上运行。因此，这两个张量被放置在一个列表中。否则，如果验证器仅在一个张量上运行，它将有一个列表列表，每个列表中只有一个张量名称。</p> 
<p>张量映射：</p> 
<p>张量映射是一个 JSON 文件，由框架张量名称的推理张量名称键入。如果未提供张量映射，该工具将假设推理和黄金张量名称相同。</p> 
<p>张量映射文件</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"Postprocessor/BatchMultiClassNonMaxSuppression_boxes"</span><span class="token operator">:</span> <span class="token string">"detection_boxes:0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"Postprocessor/BatchMultiClassNonMaxSuppression_scores"</span><span class="token operator">:</span> <span class="token string">"detection_scores:0"</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>输出</p> 
<p>验证的输出被分为不同的验证者。例如，如果同时使用RtolAtol和TopK验证器，则会有两个名为“RtolAtol”和“TopK”的子目录。可以通过发出 –help 选项找到可用的验证程序。</p> 
<p><img src="https://images2.imgbox.com/8b/70/E9admM4H_o.png" alt="请添加图片描述"><br> 在每个子目录下，每个张量的验证分析的组织方式类似于framework_diagnosis（见上文）和inference_engine的组织方式。对于每个张量，都会生成一个 CSV 和 HTML 文件。除了特定于张量的分析之外，该工具还生成一个 CSV 和 HTML 摘要文件，其中汇总了所有验证者及其后续张量的数据。下图显示了验证步骤中生成的示例摘要的外观。此摘要中的每一行对应于由框架诊断和推理引擎步骤识别的一个张量名称。最后一列显示余弦相似度分数，可以在 0 到 1 之间变化（这个范围对于其他验证者可能不同）。较高的分数表示相似性，而较低的分数表示差异。然后，开发人员可以进一步研究这些特定的张量细节。开发人员应从上到下的顺序检查张量，这意味着如果张量在较早的节点处损坏，则在该节点正确修复之前生成的任何内容都是不可靠的。</p> 
<p><img src="https://images2.imgbox.com/df/9c/nP4N3uX7_o.png" alt="请添加图片描述"><br> 比较编码<br> 比较编码功能旨在比较 QNN 和 AIMET 编码。此功能将 QNN 模型网络和 AIMET 编码 JSON 文件作为输入。此功能按以下顺序执行。</p> 
<ol><li> <p>从给定的 QNN 模型网络 JSON 中提取编码。</p> </li><li> <p>将提取的 QNN 编码与给定的 AIMET 编码进行比较。</p> </li><li> <p>将结果写入突出显示不匹配的 Excel 文件。</p> </li><li> <p>如果某些编码存在于 QNN 中但不存在于 AIMET 中，则会引发警告，反之亦然。</p> </li><li> <p>写入提取的 QNN 编码 JSON 文件（供参考）。</p> </li></ol> 
<p>用法</p> 
<pre><code class="prism language-c">usage<span class="token operator">:</span> qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger <span class="token operator">--</span>compare_encodings <span class="token punctuation">[</span><span class="token operator">-</span>h<span class="token punctuation">]</span>
                             <span class="token operator">--</span>qnn_net_json QNN_NET_JSON
                             <span class="token operator">--</span>aimet_encodings_json AIMET_ENCODINGS_JSON
                             <span class="token punctuation">[</span><span class="token operator">--</span>precision PRECISION<span class="token punctuation">]</span>
                             <span class="token punctuation">[</span><span class="token operator">--</span>params_only<span class="token punctuation">]</span>
                             <span class="token punctuation">[</span><span class="token operator">--</span>activations_only<span class="token punctuation">]</span>
                             <span class="token punctuation">[</span><span class="token operator">--</span>specific_node SPECIFIC_NODE<span class="token punctuation">]</span>
                             <span class="token punctuation">[</span><span class="token operator">--</span>working_dir WORKING_DIR<span class="token punctuation">]</span>
                             <span class="token punctuation">[</span><span class="token operator">--</span>output_dirname OUTPUT_DIRNAME<span class="token punctuation">]</span>
                             <span class="token punctuation">[</span><span class="token operator">-</span>v<span class="token punctuation">]</span>

Script to compare QNN encodings with AIMET encodings

optional arguments<span class="token operator">:</span>
  <span class="token operator">-</span>h<span class="token punctuation">,</span> <span class="token operator">--</span>help            Show this help message and exit

required arguments<span class="token operator">:</span>
  <span class="token operator">--</span>qnn_net_json QNN_NET_JSON
                        Path to QNN model net JSON file
  <span class="token operator">--</span>aimet_encodings_json AIMET_ENCODINGS_JSON
                        Path to AIMET encodings JSON file
  <span class="token operator">--</span>specific_node SPECIFIC_NODE
                        Display encoding difference <span class="token keyword">for</span> given node name

optional arguments<span class="token operator">:</span>
  <span class="token operator">--</span>precision PRECISION
                        Number of decimal places up to which comparison will be <span class="token function">done</span> <span class="token punctuation">(</span><span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">)</span>
  <span class="token operator">--</span>params_only         Compare only parameters in the encodings
  <span class="token operator">--</span>activations_only    Compare only activations in the encodings
  <span class="token operator">--</span>working_dir WORKING_DIR
                        Working directory <span class="token keyword">for</span> the compare_encodings to store temporary files<span class="token punctuation">.</span>
                        Creates a new directory <span class="token keyword">if</span> the specified working directory does not exist<span class="token punctuation">.</span>
  <span class="token operator">--</span>output_dirname OUTPUT_DIRNAME
                        Output directory name <span class="token keyword">for</span> the compare_encodings to store temporary files
                        under <span class="token operator">&lt;</span>working_dir<span class="token operator">&gt;</span><span class="token operator">/</span>compare_encodings<span class="token punctuation">.</span> Creates a new directory <span class="token keyword">if</span> the
                        specified working directory does not exist<span class="token punctuation">.</span>
  <span class="token operator">-</span>v<span class="token punctuation">,</span> <span class="token operator">--</span>verbose         Verbose printing

</code></pre> 
<p>命令示例</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Compare both params and activations</span></span>
<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>compare_encodings \
    <span class="token operator">--</span>qnn_net_json QNN_model_net<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>aimet_encodings_json aimet_encodings<span class="token punctuation">.</span>json

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Compare only params</span></span>
<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>compare_encodings \
    <span class="token operator">--</span>qnn_net_json QNN_model_net<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>aimet_encodings_json aimet_encodings<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>params_only

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Compare only activations</span></span>
<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>compare_encodings \
    <span class="token operator">--</span>qnn_net_json QNN_model_net<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>aimet_encodings_json aimet_encodings<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>activations_only

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Compare only a specific encoding</span></span>
<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>compare_encodings \
    <span class="token operator">--</span>qnn_net_json QNN_model_net<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>aimet_encodings_json aimet_encodings<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>specific_node _2_22_Conv_output_0

</code></pre> 
<p>提示</p> 
<p>除非另有指定，否则从调用此脚本的任何位置都会生成工作目录。</p> 
<p>输出</p> 
<p>该程序在working_directory/compare_encodings中创建一个名为latest的目录，该目录以符号方式链接到最近生成的目录。在下面的示例中，最新的数据将符号链接到最新目录YYYY-MM-DD_HH:mm:ss中的数据。用户可以选择通过将目录名称传递给 –output_dirname 来覆盖目录名称，例如–output_dirname myTest。</p> 
<p><img src="https://images2.imgbox.com/aa/75/dH2unOQS_o.png" alt="请添加图片描述"><br> 上图显示了compare_encodings 运行的示例输出。以下详细说明每个文件包含的内容。</p> 
<ul><li> <p>Compare_encodings_options.json 包含用于运行此功能的所有选项</p> </li><li> <p>codings_diff.xlsx 包含突出显示不匹配的比较结果</p> </li><li> <p>log.txt 包含运行的日志语句</p> </li><li> <p>qnn_encoding.json 包含提取的 QNN 编码</p> </li></ul> 
<p>张量检查<br> 张量检查器比较给定的参考输出和目标输出张量，并转储各种统计数据以表示它们之间的差异。</p> 
<p>张量检查器工具可以：</p> 
<ul><li> <p>绘制黄金张量和目标张量的直方图</p> </li><li> <p>绘制一个图表，指示黄金张量和目标张量之间的偏差</p> </li><li> <p>绘制黄金张量与目标张量的累积分布图 (CDF)</p> </li><li> <p>绘制目标张量的密度 (KDE) 图，突出显示目标最小/最大值和校准的最小/最大值</p> </li><li> <p>创建一个 CSV 文件，其中包含以下信息：目标最小值/最大值；校准最小值/最大值；黄金输出最小/最大；目标/校准的最小/最大差异；和计算指标（验证者）。</p> </li></ul> 
<blockquote> 
 <p>笔记<br> 仅检查具有匹配目标/黄金文件名的数据；其他数据被忽略<br> 校准的最小/最大值是从用户提供的编码文件中提取的。如果未提供编码文件，将跳过密度图，并且 CSV 摘要输出将不包括校准的最小/最大信息。</p> 
</blockquote> 
<p>用法</p> 
<pre><code class="prism language-c">usage<span class="token operator">:</span> qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger <span class="token operator">--</span>tensor_inspection <span class="token punctuation">[</span><span class="token operator">-</span>h<span class="token punctuation">]</span>
                        <span class="token operator">--</span>golden_data GOLDEN_DATA
                        <span class="token operator">--</span>target_data TARGET_DATA
                        <span class="token operator">--</span>verifier VERIFIER <span class="token punctuation">[</span>VERIFIER <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                        <span class="token punctuation">[</span><span class="token operator">-</span>w WORKING_DIR<span class="token punctuation">]</span>
                        <span class="token punctuation">[</span><span class="token operator">--</span>data_type <span class="token punctuation">{<!-- --></span>int8<span class="token punctuation">,</span>uint8<span class="token punctuation">,</span>int16<span class="token punctuation">,</span>uint16<span class="token punctuation">,</span>float32<span class="token punctuation">}</span><span class="token punctuation">]</span>
                        <span class="token punctuation">[</span><span class="token operator">--</span>target_encodings TARGET_ENCODINGS<span class="token punctuation">]</span>
                        <span class="token punctuation">[</span><span class="token operator">-</span>v<span class="token punctuation">]</span>

Script to inspection tensor<span class="token punctuation">.</span>

required arguments<span class="token operator">:</span>
  <span class="token operator">--</span>golden_data GOLDEN_DATA
                        Path to golden<span class="token operator">/</span>framework outputs folder<span class="token punctuation">.</span> Paths may be absolute or
                        relative to the working directory<span class="token punctuation">.</span>
  <span class="token operator">--</span>target_data TARGET_DATA
                        Path to target outputs folder<span class="token punctuation">.</span> Paths may be absolute or relative to the
                        working directory<span class="token punctuation">.</span>
  <span class="token operator">--</span>verifier VERIFIER <span class="token punctuation">[</span>VERIFIER <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                        Verifier used <span class="token keyword">for</span> verification<span class="token punctuation">.</span> The options <span class="token string">"RtolAtol"</span><span class="token punctuation">,</span>
                        <span class="token string">"AdjustedRtolAtol"</span><span class="token punctuation">,</span> <span class="token string">"TopK"</span><span class="token punctuation">,</span> <span class="token string">"L1Error"</span><span class="token punctuation">,</span> <span class="token string">"CosineSimilarity"</span><span class="token punctuation">,</span> <span class="token string">"MSE"</span><span class="token punctuation">,</span> <span class="token string">"MAE"</span><span class="token punctuation">,</span>
                        <span class="token string">"SQNR"</span><span class="token punctuation">,</span> <span class="token string">"MeanIOU"</span><span class="token punctuation">,</span> <span class="token string">"ScaledDiff"</span> are supported<span class="token punctuation">.</span>
                        An optional list of hyperparameters can be appended<span class="token punctuation">,</span> <span class="token keyword">for</span> example<span class="token operator">:</span>
                        <span class="token operator">--</span>verifier rtolatol<span class="token punctuation">,</span>rtolmargin<span class="token punctuation">,</span><span class="token number">0.01</span><span class="token punctuation">,</span>atolmargin<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">01.</span>
                        To use multiple verifiers<span class="token punctuation">,</span> add additional <span class="token operator">--</span>verifier CosineSimilarity

optional arguments<span class="token operator">:</span>
  <span class="token operator">-</span>w WORKING_DIR<span class="token punctuation">,</span> <span class="token operator">--</span>working_dir WORKING_DIR
                        Working directory to save results<span class="token punctuation">.</span> Creates a new directory <span class="token keyword">if</span> the
                        specified working directory does not exist
  <span class="token operator">--</span>data_type <span class="token punctuation">{<!-- --></span>int8<span class="token punctuation">,</span>uint8<span class="token punctuation">,</span>int16<span class="token punctuation">,</span>uint16<span class="token punctuation">,</span>float32<span class="token punctuation">}</span>
                        DataType of the output tensor<span class="token punctuation">.</span>
  <span class="token operator">--</span>target_encodings TARGET_ENCODINGS
                        Path to target encodings json file<span class="token punctuation">.</span>
  <span class="token operator">-</span>v<span class="token punctuation">,</span> <span class="token operator">--</span>verbose         Verbose printing

</code></pre> 
<p>命令示例</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Basic run</span></span>
<span class="token punctuation">.</span><span class="token operator">/</span>tensor<span class="token operator">-</span>inspector \
    <span class="token operator">--</span>golden_data golden_tensors_dir \
    <span class="token operator">--</span>target_data target_tensors_dir \
    <span class="token operator">--</span>verifier sqnr

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Pass target encodings file and enable multiple verifiers</span></span>
<span class="token punctuation">.</span><span class="token operator">/</span>tensor<span class="token operator">-</span>inspector \
    <span class="token operator">--</span>golden_data golden_tensors_dir \
    <span class="token operator">--</span>target_data target_tensors_dir \
    <span class="token operator">--</span>verifier mse \
    <span class="token operator">--</span>verifier sqnr \
    <span class="token operator">--</span>verifier rtolatol<span class="token punctuation">,</span>rtolmargin<span class="token punctuation">,</span><span class="token number">0.01</span><span class="token punctuation">,</span>atolmargin<span class="token punctuation">,</span><span class="token number">0.01</span> \
    <span class="token operator">--</span>target_encodings qnn_encoding<span class="token punctuation">.</span>json

</code></pre> 
<p>提示</p> 
<p>除非另有指定，否则从调用此脚本的任何位置都会生成工作目录。</p> 
<p><img src="https://images2.imgbox.com/91/21/RsnNiC1k_o.png" alt="请添加图片描述"><br> 上图显示了张量检查运行的示例输出。以下详细说明每个文件包含的内容。</p> 
<ul><li> <p>每个张量都会有自己的目录；目录名称与张量名称匹配。</p> 
  <ul><li>CDF_plots.png – 黄金与目标 CDF 图</li><li>Diff_plots.png – 黄金和目标偏差图</li><li>Distribution_min-max.png – 目标张量的密度图，突出显示目标与校准的最小/最大值</li><li>Histograms.png – 黄金直方图和目标直方图</li><li>Golden_data.csv – 黄金张量数据</li><li>target_data.csv – 目标张量数据</li></ul> </li><li> <p>log.txt – 整个运行过程中的日志语句</p> </li><li> <p>Summary.csv – 目标最小值/最大值、校准最小值/最大值、黄金输出最小值/最大值、目标与校准最小值/最大值差异以及验证器输出</p> </li></ul> 
<p>运行 QNN 精度调试器 E2E<br> 此功能旨在通过单个命令顺序运行框架诊断、推理引擎和验证功能来调试模型。可以使用以下调试算法。</p> 
<ul><li> <p>单次逐层（默认）：</p> 
  <ul><li> <p>该算法旨在通过执行以下步骤一次调试模型的所有层</p> 
    <ul><li> <p>执行框架诊断以收集 fp32 中的参考输出</p> </li><li> <p>执行推理引擎以提供的目标精度收集后端输出。</p> </li><li> <p>执行验证以比较上述 2 个步骤的中间输出</p> </li></ul> </li><li> <p>它提供快速分析来识别导致精度偏差的模型层。</p> </li><li> <p>用户可以选择累积分层（如下）来更深入地分析精度偏差。</p> </li></ul> </li><li> <p>逐层累积：</p> 
  <ul><li> <p>该算法旨在通过执行以下步骤一次调试一层</p> 
    <ul><li> <p>执行框架诊断以收集 fp32 中模型各层的参考输出。</p> </li><li> <p>以迭代的方式执行推理引擎和验证来执行以下操作</p> 
      <ul><li> <p>以目标精度收集每一层的后端输出，同时消除其前一层对最终输出的影响。</p> </li><li> <p>比较框架诊断和推理引擎的中间输出</p> </li></ul> </li></ul> </li><li> <p>它提供更深入的分析来识别导致精度偏差的模型的所有层。</p> </li><li> <p>目前此选项仅支持 onnx 模型。</p> </li></ul> </li><li> <p>分层：</p> 
  <ul><li> <p>该算法旨在通过执行以下步骤一次调试单层模型</p> 
    <ul><li> <p>从外部工具获取每层输出的黄金参考，或者，如果未给出黄金参考，则运行框架诊断以收集中间层输出。</p> </li><li> <p>迭代执行推理引擎和验证以：</p> 
      <ul><li> <p>通过删除前面和后面的层，以目标精度收集每个单层模型的后端输出</p> </li><li> <p>将黄金参考的中间输出与推理引擎单层模型输出进行比较</p> </li></ul> </li></ul> </li><li> <p>分层侦听提供更深入的分析，以识别导致硬件相对于框架/模拟输出的精度偏差的所有模型层。</p> </li><li> <p>分层侦听仅支持 ONNX 模型。</p> </li></ul> </li></ul> 
<p>用法</p> 
<pre><code class="prism language-c">usage<span class="token operator">:</span> qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger <span class="token punctuation">[</span><span class="token operator">--</span>framework_diagnosis<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>inference_engine<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>verification<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>h<span class="token punctuation">]</span>

Script that runs Framework Diagnosis<span class="token punctuation">,</span> Inference Engine or Verification<span class="token punctuation">.</span>

Arguments to select which component of the tool to run<span class="token punctuation">.</span>  Arguments are mutually <span class="token function">exclusive</span> <span class="token punctuation">(</span>at
most <span class="token number">1</span> can be selected<span class="token punctuation">)</span><span class="token punctuation">.</span>  If none are selected<span class="token punctuation">,</span> then all components are run<span class="token operator">:</span>
<span class="token operator">--</span>framework_diagnosis Run framework
<span class="token operator">--</span>inference_engine    Run inference engine
<span class="token operator">--</span>verification        Run verification

optional arguments<span class="token operator">:</span>
<span class="token operator">-</span>h<span class="token punctuation">,</span> <span class="token operator">--</span>help              Show this help message<span class="token punctuation">.</span> To show help <span class="token keyword">for</span> any of the components<span class="token punctuation">,</span> run
                        script with <span class="token operator">--</span>help and <span class="token operator">--</span><span class="token operator">&lt;</span>component<span class="token operator">&gt;</span><span class="token punctuation">.</span> For example<span class="token punctuation">,</span> to show the help
                        <span class="token keyword">for</span> Framework Diagnosis<span class="token punctuation">,</span> run script with the following<span class="token operator">:</span> <span class="token operator">--</span>help
                        <span class="token operator">--</span>framework_diagnosis

usage<span class="token operator">:</span> qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger <span class="token punctuation">[</span><span class="token operator">-</span>h<span class="token punctuation">]</span> <span class="token operator">-</span>f FRAMEWORK <span class="token punctuation">[</span>FRAMEWORK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token operator">-</span>m MODEL_PATH <span class="token operator">-</span>i INPUT_TENSOR
                            <span class="token punctuation">[</span>INPUT_TENSOR <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token operator">-</span>o OUTPUT_TENSOR <span class="token operator">-</span>r RUNTIME <span class="token operator">-</span>a
                            <span class="token punctuation">{<!-- --></span>aarch64<span class="token operator">-</span>android<span class="token punctuation">,</span>x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang<span class="token punctuation">,</span>aarch64<span class="token operator">-</span>android<span class="token operator">-</span>clang6<span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">}</span>
                            <span class="token operator">-</span>l INPUT_LIST <span class="token operator">--</span>default_verifier DEFAULT_VERIFIER
                            <span class="token punctuation">[</span>DEFAULT_VERIFIER <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>v<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>w WORKING_DIR<span class="token punctuation">]</span>
                            <span class="token punctuation">[</span><span class="token operator">--</span>output_dirname OUTPUT_DIRNAME<span class="token punctuation">]</span>
                            <span class="token punctuation">[</span><span class="token operator">--</span>deep_analyzer <span class="token punctuation">{<!-- --></span>modelDissectionAnalyzer<span class="token punctuation">}</span><span class="token punctuation">]</span>
                            <span class="token punctuation">[</span><span class="token operator">--</span>debugging_algorithm <span class="token punctuation">{<!-- --></span>layerwise<span class="token punctuation">,</span>cumulative<span class="token operator">-</span>layerwise<span class="token punctuation">,</span>oneshot<span class="token operator">-</span>layerwise<span class="token punctuation">}</span><span class="token punctuation">]</span>

Options <span class="token keyword">for</span> running the Accuracy Debugger components

optional arguments<span class="token operator">:</span>
<span class="token operator">-</span>h<span class="token punctuation">,</span> <span class="token operator">--</span>help            show this help message and exit

Arguments required by both Framework Diagnosis and Inference Engine<span class="token operator">:</span>
<span class="token operator">-</span>f FRAMEWORK <span class="token punctuation">[</span>FRAMEWORK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">--</span>framework FRAMEWORK <span class="token punctuation">[</span>FRAMEWORK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                        Framework type and version<span class="token punctuation">,</span> version is optional<span class="token punctuation">.</span> Currently supported
                        frameworks are <span class="token punctuation">[</span>tensorflow<span class="token punctuation">,</span> tflite<span class="token punctuation">,</span> onnx<span class="token punctuation">]</span><span class="token punctuation">.</span> For example<span class="token punctuation">,</span> tensorflow
                        <span class="token number">2.3</span><span class="token number">.0</span>
<span class="token operator">-</span>m MODEL_PATH<span class="token punctuation">,</span> <span class="token operator">--</span>model_path MODEL_PATH
                        Path to the model <span class="token function">file</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token operator">-</span>i INPUT_TENSOR <span class="token punctuation">[</span>INPUT_TENSOR <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">--</span>input_tensor INPUT_TENSOR <span class="token punctuation">[</span>INPUT_TENSOR <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                        The name<span class="token punctuation">,</span> dimensions<span class="token punctuation">,</span> raw data<span class="token punctuation">,</span> and optionally data type of the
                        network input <span class="token function">tensor</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> specifiedin the format <span class="token string">"input_name"</span> comma<span class="token operator">-</span>
                        separated<span class="token operator">-</span>dimensions path<span class="token operator">-</span>to<span class="token operator">-</span>raw<span class="token operator">-</span>file<span class="token punctuation">,</span> <span class="token keyword">for</span> example<span class="token operator">:</span> <span class="token string">"data"</span>
                        <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">3</span> data<span class="token punctuation">.</span>raw float32<span class="token punctuation">.</span> Note that the quotes should always be
                        included in order to handle special characters<span class="token punctuation">,</span> spaces<span class="token punctuation">,</span> etc<span class="token punctuation">.</span> For
                        multiple inputs specify multiple <span class="token operator">--</span>input_tensor on the command line
                        like<span class="token operator">:</span> <span class="token operator">--</span>input_tensor <span class="token string">"data1"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">3</span> data1<span class="token punctuation">.</span>raw <span class="token operator">--</span>input_tensor
                        <span class="token string">"data2"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">3</span> data2<span class="token punctuation">.</span>raw float32<span class="token punctuation">.</span>
<span class="token operator">-</span>o OUTPUT_TENSOR<span class="token punctuation">,</span> <span class="token operator">--</span>output_tensor OUTPUT_TENSOR
                        Name of the graph's specified output <span class="token function">tensor</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span>

Arguments required by Inference Engine<span class="token operator">:</span>
<span class="token operator">-</span>r RUNTIME<span class="token punctuation">,</span> <span class="token operator">--</span>runtime RUNTIME
                        Runtime to be used <span class="token keyword">for</span> inference<span class="token punctuation">.</span>
<span class="token operator">-</span>a <span class="token punctuation">{<!-- --></span>aarch64<span class="token operator">-</span>android<span class="token punctuation">,</span>x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang<span class="token punctuation">,</span>aarch64<span class="token operator">-</span>android<span class="token operator">-</span>clang6<span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">--</span>architecture <span class="token punctuation">{<!-- --></span>aarch64<span class="token operator">-</span>an
droid<span class="token punctuation">,</span>x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang<span class="token punctuation">,</span>aarch64<span class="token operator">-</span>android<span class="token operator">-</span>clang6<span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">}</span>
                        Name of the architecture to use <span class="token keyword">for</span> inference engine<span class="token punctuation">.</span>
<span class="token operator">-</span>l INPUT_LIST<span class="token punctuation">,</span> <span class="token operator">--</span>input_list INPUT_LIST
                        Path to the input list text<span class="token punctuation">.</span>
Arguments required by Verification<span class="token operator">:</span>                                                    <span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">467</span><span class="token punctuation">]</span>
<span class="token operator">--</span>default_verifier DEFAULT_VERIFIER <span class="token punctuation">[</span>DEFAULT_VERIFIER <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
                        Default verifier used <span class="token keyword">for</span> verification<span class="token punctuation">.</span> The options <span class="token string">"RtolAtol"</span><span class="token punctuation">,</span>
                        <span class="token string">"AdjustedRtolAtol"</span><span class="token punctuation">,</span> <span class="token string">"TopK"</span><span class="token punctuation">,</span> <span class="token string">"L1Error"</span><span class="token punctuation">,</span> <span class="token string">"CosineSimilarity"</span><span class="token punctuation">,</span> <span class="token string">"MSE"</span><span class="token punctuation">,</span>
                        <span class="token string">"MAE"</span><span class="token punctuation">,</span> <span class="token string">"SQNR"</span><span class="token punctuation">,</span> <span class="token string">"MeanIOU"</span><span class="token punctuation">,</span> <span class="token string">"ScaledDiff"</span> are supported<span class="token punctuation">.</span> An optional
                        list of hyperparameters can be appended<span class="token punctuation">.</span> For example<span class="token operator">:</span>
                        <span class="token operator">--</span>default_verifier rtolatol<span class="token punctuation">,</span>rtolmargin<span class="token punctuation">,</span><span class="token number">0.01</span><span class="token punctuation">,</span>atolmargin<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">01.</span> An
                        optional list of placeholders can be appended<span class="token punctuation">.</span> For example<span class="token operator">:</span>
                        <span class="token operator">--</span>default_verifier CosineSimilarity param1 <span class="token number">1</span> param2 <span class="token number">2.</span> to use
                        multiple verifiers<span class="token punctuation">,</span> add additional <span class="token operator">--</span>default_verifier
                        CosineSimilarity

optional arguments<span class="token operator">:</span>
<span class="token operator">-</span>v<span class="token punctuation">,</span> <span class="token operator">--</span>verbose           Verbose printing
<span class="token operator">-</span>w WORKING_DIR<span class="token punctuation">,</span> <span class="token operator">--</span>working_dir WORKING_DIR
                        Working directory <span class="token keyword">for</span> the wrapper to store temporary files<span class="token punctuation">.</span> Creates
                        a new directory <span class="token keyword">if</span> the specified working directory does not exitst<span class="token punctuation">.</span>
<span class="token operator">--</span>output_dirname OUTPUT_DIRNAME
                        output directory name <span class="token keyword">for</span> the wrapper to store temporary files under
                        <span class="token operator">&lt;</span>working_dir<span class="token operator">&gt;</span><span class="token operator">/</span>wrapper<span class="token punctuation">.</span> Creates a new directory <span class="token keyword">if</span> the specified
                        working directory does not exist
<span class="token operator">--</span>deep_analyzer <span class="token punctuation">{<!-- --></span>modelDissectionAnalyzer<span class="token punctuation">}</span>
                        Deep Analyzer to perform deep analysis
<span class="token operator">--</span>golden_output_reference_directory
                        Optional parameter to indicate the directory of the golden reference outputs<span class="token punctuation">.</span>
                        When this option is provided<span class="token punctuation">,</span> the framework diagnosis is stage skipped<span class="token punctuation">.</span>
                        In inference stage<span class="token punctuation">,</span> it's used <span class="token keyword">for</span> tensor mapping without a framework<span class="token punctuation">.</span>
                        In verification stage<span class="token punctuation">,</span> it's used as a reference to compare
                        outputs produced in the inference engine stage<span class="token punctuation">.</span>
<span class="token operator">--</span>debugging_algorithm <span class="token punctuation">{<!-- --></span>layerwise<span class="token punctuation">,</span>cumulative<span class="token operator">-</span>layerwise<span class="token punctuation">,</span>oneshot<span class="token operator">-</span>layerwise<span class="token punctuation">}</span>
                        Performs model debugging layerwise<span class="token punctuation">,</span> cumulative<span class="token operator">-</span>layerwise or in oneshot<span class="token operator">-</span>
                        layerwise based on choice<span class="token punctuation">.</span>

<span class="token punctuation">(</span>below options are allowed only <span class="token keyword">for</span> Layerwise and Cumulative layerwise run<span class="token punctuation">)</span>
<span class="token operator">--</span>start_layer START_LAYER
                        Extracts the given model from mentioned start layer
                        output name
<span class="token operator">--</span>end_layer END_LAYER
                        Extracts the given model from mentioned end layer
                        output name

</code></pre> 
<p>oneshot-layerwise 的示例命令</p> 
<pre><code class="prism language-c"><span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>framework tensorflow \
    <span class="token operator">--</span>runtime dspv73 \
    <span class="token operator">--</span>model_path $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>inception_v3_2016_08_28_frozen<span class="token punctuation">.</span>pb \
    <span class="token operator">--</span>input_tensor <span class="token string">"input:0"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">299</span><span class="token punctuation">,</span><span class="token number">299</span><span class="token punctuation">,</span><span class="token number">3</span> $PATHTOGOLDENI<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>data<span class="token operator">/</span>chairs<span class="token punctuation">.</span>raw \
    <span class="token operator">--</span>output_tensor InceptionV3<span class="token operator">/</span>Predictions<span class="token operator">/</span>Reshape_1<span class="token operator">:</span><span class="token number">0</span> \
    <span class="token operator">--</span>architecture x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang \
    <span class="token operator">--</span>debugging_algorithm oneshot<span class="token operator">-</span>layerwise
    <span class="token operator">--</span>input_list $RESOURCESPATH<span class="token operator">/</span>samples<span class="token operator">/</span>InceptionV3Model<span class="token operator">/</span>data<span class="token operator">/</span>image_list<span class="token punctuation">.</span>txt \
    <span class="token operator">--</span>default_verifier CosineSimilarity \
    <span class="token operator">--</span>framework_results $PROJECTREPOPATH<span class="token operator">/</span>working_directory<span class="token operator">/</span>framework_diagnosis<span class="token operator">/</span>latest<span class="token operator">/</span> \
    <span class="token operator">--</span>inference_results $PROJECTREPOPATH<span class="token operator">/</span>working_directory<span class="token operator">/</span>inference_engine<span class="token operator">/</span>latest<span class="token operator">/</span>output<span class="token operator">/</span>Result_0<span class="token operator">/</span> \
    <span class="token operator">--</span>tensor_mapping $PROJECTREPOPATH<span class="token operator">/</span>working_directory<span class="token operator">/</span>inference_engine<span class="token operator">/</span>latest<span class="token operator">/</span>tensor_mapping<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>graph_struct $PROJECTREPOPATH<span class="token operator">/</span>working_directory<span class="token operator">/</span>inference_engine<span class="token operator">/</span>latest<span class="token operator">/</span>qnn_model_graph_struct<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>qnn_model_json_path $PROJECTREPOPATH<span class="token operator">/</span>working_directory<span class="token operator">/</span>inference_engine<span class="token operator">/</span>latest<span class="token operator">/</span>qnn_model_net<span class="token punctuation">.</span>json \
    <span class="token operator">--</span>verbose

</code></pre> 
<pre><code class="prism language-c">Command <span class="token keyword">for</span> Oneshot<span class="token operator">-</span>layerwise using HTP emulation on x86 host<span class="token operator">:</span>

<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>framework onnx \
    <span class="token operator">--</span>runtime htp \
    <span class="token operator">--</span>model_path <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>models<span class="token operator">/</span>vit<span class="token operator">/</span>vit_base_16_224<span class="token punctuation">.</span>onnx \
    <span class="token operator">--</span>input_tensor <span class="token string">"input.1"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span> <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>models<span class="token operator">/</span>vit<span class="token operator">/</span><span class="token number">000000039769</span>_1_3_224_224<span class="token punctuation">.</span>raw \
    <span class="token operator">--</span>output_tensor <span class="token number">1597</span> \
    <span class="token operator">--</span>architecture x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang \
    <span class="token operator">--</span>input_list <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>models<span class="token operator">/</span>vit<span class="token operator">/</span>list<span class="token punctuation">.</span>txt \
    <span class="token operator">--</span>default_verifier CosineSimilarity \
    <span class="token operator">--</span>offline_prepare \
    <span class="token operator">--</span>debugging_algorithm oneshot<span class="token operator">-</span>layerwise
    <span class="token operator">--</span>engine QNN \
    <span class="token operator">--</span>verbose

</code></pre> 
<p>输出</p> 
<p>该程序创建framework_diagnosis、inference_engine、verification和wrapper输出目录，如下所示：</p> 
<p><img src="https://images2.imgbox.com/01/ed/xAR6XtyD_o.png" alt="请添加图片描述"></p> 
<ul><li> <p>Framework_diagnosis – 包含带时间戳的目录，其中包含以 .raw 格式存储的中间层输出（框架），如框架诊断步骤中所述。</p> </li><li> <p>inference_engine – 包含带时间戳的目录，其中包含以 .raw 格式存储的中间层输出（推理引擎），如推理引擎步骤中所述。</p> </li><li> <p>验证目录 – 包含带时间戳的目录，其中包含以下内容：</p> 
  <ul><li> <p>运行 oneshot 时指定的每个验证程序的目录；它包含 CSV 和 HTML 文件，其中包含每层输出的指标详细信息</p> </li><li> <p>tensor_inspection – 每层输出的单独目录，包含以下内容：</p> 
    <ul><li>CDF_plots.png – 黄金与目标 CDF 图</li><li>Diff_plots.png – 黄金和目标偏差图</li><li>Histograms.png – 黄金直方图和目标直方图</li><li>Golden_data.csv – 黄金张量数据</li><li>target_data.csv – 目标张量数据</li></ul> </li><li> <p>summary.csv – 每层输出的验证结果报告</p> </li></ul> </li><li> <p>包含 log.txt 的包装器目录以及运行的整个日志。</p> </li></ul> 
<p>注意：除了包装器目录之外，所有其他目录都会有一个名为“latest”的文件夹，它是指向最新运行的相应时间戳目录的符号链接。</p> 
<p>Summary.csv 文件的快照：</p> 
<p><img src="https://images2.imgbox.com/d2/b4/5ndxOAqO_o.png" alt="请添加图片描述"><br> 了解一次性分层报告：</p> 
<table><thead><tr><th>柱子</th><th>描述</th></tr></thead><tbody><tr><td>姓名</td><td>当前图层的输出名称</td></tr><tr><td>图层类型</td><td>当前图层类型</td></tr><tr><td>尺寸</td><td>该层输出的大小</td></tr><tr><td>张量尺寸</td><td>该层输出的形状</td></tr><tr><td>&lt;验证者姓名&gt;</td><td>当前层输出与参考输出相比的验证器值</td></tr><tr><td>黄金分钟</td><td>当前层参考输出中的最小值</td></tr><tr><td>黄金最大</td><td>当前层参考输出中的最大值</td></tr><tr><td>目标最小值</td><td>当前层目标输出的最小值</td></tr><tr><td>目标最大</td><td>当前层目标输出的最大值</td></tr></tbody></table> 
<p>逐层累积命令示例</p> 
<pre><code class="prism language-c"><span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>framework onnx \
    <span class="token operator">--</span>runtime dspv73 \
    <span class="token operator">--</span>model_path <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>models<span class="token operator">/</span>vit<span class="token operator">/</span>vit_base_16_224<span class="token punctuation">.</span>onnx \
    <span class="token operator">--</span>input_tensor <span class="token string">"input.1"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span> <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>models<span class="token operator">/</span>vit<span class="token operator">/</span><span class="token number">000000039769</span>_1_3_224_224<span class="token punctuation">.</span>raw \
    <span class="token operator">--</span>output_tensor <span class="token number">1597</span> \
    <span class="token operator">--</span>architecture x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang \
    <span class="token operator">--</span>input_list <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>models<span class="token operator">/</span>vit<span class="token operator">/</span>list<span class="token punctuation">.</span>txt \
    <span class="token operator">--</span>default_verifier CosineSimilarity \
    <span class="token operator">--</span>offline_prepare \
    <span class="token operator">--</span>debugging_algorithm cumulative<span class="token operator">-</span>layerwise
    <span class="token operator">--</span>engine QNN \
    <span class="token operator">--</span>verbose

</code></pre> 
<pre><code class="prism language-c">Command <span class="token keyword">for</span> Cumulative<span class="token operator">-</span>layerwise using HTP emulation on x86 host<span class="token operator">:</span>

<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>framework onnx \
    <span class="token operator">--</span>runtime htp \
    <span class="token operator">--</span>model_path <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>models<span class="token operator">/</span>vit<span class="token operator">/</span>vit_base_16_224<span class="token punctuation">.</span>onnx \
    <span class="token operator">--</span>input_tensor <span class="token string">"input.1"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span> <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>models<span class="token operator">/</span>vit<span class="token operator">/</span><span class="token number">000000039769</span>_1_3_224_224<span class="token punctuation">.</span>raw \
    <span class="token operator">--</span>output_tensor <span class="token number">1597</span> \
    <span class="token operator">--</span>architecture x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang \
    <span class="token operator">--</span>input_list <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>models<span class="token operator">/</span>vit<span class="token operator">/</span>list<span class="token punctuation">.</span>txt \
    <span class="token operator">--</span>default_verifier CosineSimilarity \
    <span class="token operator">--</span>offline_prepare \
    <span class="token operator">--</span>debugging_algorithm cumulative<span class="token operator">-</span>layerwise
    <span class="token operator">--</span>engine QNN \
    <span class="token operator">--</span>verbose

</code></pre> 
<p>输出<br> 该程序创建输出目录framework_diagnosis、cumulative_layerwise_snooping和wrapper目录如下</p> 
<p><img src="https://images2.imgbox.com/14/bc/GDbtc305_o.png" alt="请添加图片描述"></p> 
<ul><li> <p>Framework_diagnosis 目录包含带时间戳的目录，其中包含以 .raw 格式存储的中间层输出，正如框架诊断步骤中提到的那样。</p> </li><li> <p>cumulative_layerwise_snooping 目录包含从推理引擎步骤获得的中间输出，存储在具有各自层名称的单独目录中。它还包含名为cumulative_layerwise.csv 的最终报告，其中包含每层的验证者分数。用户可以将得分偏差最大的层识别为有问题的节点。</p> </li><li> <p>Wrapper 目录包含一个 log.txt，用户可以在其中引用整个运行的完整日志。<br> <img src="https://images2.imgbox.com/bf/b8/OGHhPXTc_o.png" alt="请添加图片描述"><br> 了解累积分层报告</p> </li></ul> 
<p>在累积分层运行结束时，该工具会生成 .csv，其中每层包含以下信息</p> 
<p><img src="https://images2.imgbox.com/f9/45/CDScU3Xu_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">Command <span class="token keyword">for</span> Layerwise<span class="token operator">:</span>

<span class="token punctuation">.</span><span class="token operator">/</span>qnn<span class="token operator">-</span>accuracy<span class="token operator">-</span>debugger \
    <span class="token operator">--</span>framework onnx \
    <span class="token operator">--</span>runtime dspv73 \
    <span class="token operator">--</span>model_path <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>models<span class="token operator">/</span>vit<span class="token operator">/</span>vit_base_16_224<span class="token punctuation">.</span>onnx \
    <span class="token operator">--</span>input_tensor <span class="token string">"input.1"</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span> <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>models<span class="token operator">/</span>vit<span class="token operator">/</span><span class="token number">000000039769</span>_1_3_224_224<span class="token punctuation">.</span>raw \
    <span class="token operator">--</span>output_tensor <span class="token number">1597</span> \
    <span class="token operator">--</span>architecture x86_64<span class="token operator">-</span>linux<span class="token operator">-</span>clang \
    <span class="token operator">--</span>input_list <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>models<span class="token operator">/</span>vit<span class="token operator">/</span>list<span class="token punctuation">.</span>txt \
    <span class="token operator">--</span>default_verifier CosineSimilarity \
    <span class="token operator">--</span>offline_prepare \
    <span class="token operator">--</span>debugging_algorithm layerwise
    <span class="token operator">--</span>golden_directory <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>aimet_layer_output_dump<span class="token operator">/</span>outputs<span class="token operator">/</span>layer_outputs_0<span class="token operator">/</span>
    <span class="token operator">--</span>quantization_overrides <span class="token operator">/</span>local<span class="token operator">/</span>mnt<span class="token operator">/</span>workspace<span class="token operator">/</span>layer_output_dump<span class="token operator">/</span>vit_base_16_224<span class="token punctuation">.</span>encodings
    <span class="token operator">--</span>engine QNN \
    <span class="token operator">--</span>verbose

</code></pre> 
<p>输出</p> 
<p>如果未提供黄金参考（如针对累积分层所描述的），程序将创建layerwise_snooping和包装器输出目录以及framework_diagnosis。</p> 
<ul><li> <p>Layerwise_snooping 目录 – 包含从存储在单独目录中的推理引擎阶段获得的每个单层模型输出以及名为 Layerwise.csv 的最终报告，其中包含每个层模型的验证器分数。用户可以将得分偏差最大的层识别为有问题的节点。</p> </li><li> <p>包装器目录 – 包含 log.txt，其中存储运行的完整日志。</p> </li><li> <p>输出 .csv 与累积分层输出类似，但原始输出列不会出现在分层监听中，因为我们不处理模型的最终输出。</p> </li></ul> 
<p>使用累积分层侦听调试量化模型的准确性问题</p> 
<ul><li> <p>对于量化模型，预计大多数数据密集层都会出现一些不匹配——这是由于量化误差而引起的。</p> </li><li> <p>调试器可用于识别具有高验证器分数的最敏感操作符，并以更高的精度运行这些操作符以提高整体准确性。</p> </li><li> <p>敏感性由在该层看到的关于参考平台（如 ONNXRT）的验证者分数决定。</p> </li><li> <p>请注意，累积分层调试需要相当长的时间，因为分区模型应在与参考不具有 100% 匹配的每一层进行量化和编译。</p> </li><li> <p>以下是调试较大模型的一种策略：</p> 
  <ul><li> <p>在模型上逐层运行 Oneshot，这有助于识别模型中敏感度的起点。</p> </li><li> <p>使用开始层和结束层选项在模型的不同部分运行累积分层（如果模型有 100 个节点，则在运行 1 的第 25 个节点处使用来自 Oneshot-layerwise 运行的开始节点处的开始层，开始对于运行 2，起始层位于第 26 个节点，结束层位于第 50 个节点；对于运行 3，起始层位于第 51 个节点，结束层位于第 75 个节点…依此类推）。所有运行的最终报告有助于识别模型中最敏感的层。假设节点 A、B、C 的验证者分数较高，这表明敏感度较高</p> 
    <ul><li>在 FP16 中运行具有这些特定层（A/B/C - 一次一个或组合）的原始模型，并观察准确性的提高。</li></ul> </li></ul> </li></ul> 
<p>模型的调试精度问题表现出黄金参考（例如 AIMET/框架运行时输出）与使用分层侦听的目标输出之间的精度差异</p> 
<ul><li> <p>分层侦听的流行用例之一是调试 AIMET 与目标之间的准确度差异</p> 
  <ul><li> <p>尽管我们正在使用 AIMET 等工具创建精确的硬件模拟，但由于环境差异，预计仍然会出现非常微小的不匹配。这可能是因为模拟在 GPU FP32 内核上执行，并且模拟噪声，而不是在硬件执行的情况下在整数内核上实际执行。</p> </li><li> <p>如果我们在模拟和硬件之间有较高的偏差，则可以使用分层窥探来指出具有较高偏差的节点。根据layerwise.csv 显示较高偏差的节点可以被识别为错误节点。</p> </li></ul> </li><li> <p>其他用例包括调试框架运行时的 FP32 输出与目标 INT16 输出偏差。</p> </li></ul> 
<h4><a id="644_qnn__1173"></a>6.4.4 qnn 平台验证器</h4> 
<p>qnn-platform-validator 检查设备的 QNN 兼容性/功能。输出以 csv 格式保存在“output”目录中的 CSV 文件中。基本日志也显示在控制台上。</p> 
<pre><code class="prism language-c">DESCRIPTION<span class="token operator">:</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
Helper script to set up the environment <span class="token keyword">for</span> and launch the qnn<span class="token operator">-</span>platform<span class="token operator">-</span>
validator executable<span class="token punctuation">.</span>

REQUIRED ARGUMENTS<span class="token operator">:</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token operator">--</span>backend            <span class="token operator">&lt;</span>BACKEND<span class="token operator">&gt;</span>          Specify the backend to validate<span class="token operator">:</span> <span class="token operator">&lt;</span>gpu<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>dsp<span class="token operator">&gt;</span>
                                        <span class="token operator">&lt;</span>all<span class="token operator">&gt;</span><span class="token punctuation">.</span>

<span class="token operator">--</span>directory          <span class="token operator">&lt;</span>DIR<span class="token operator">&gt;</span>              Path to the root of the unpacked SDK directory containing
                                        the executable and library files

<span class="token operator">--</span>dsp_type           <span class="token operator">&lt;</span>DSP_VERSION<span class="token operator">&gt;</span>      Specify DSP variant<span class="token operator">:</span> v66 or v68

OPTIONALS ARGUMENTS<span class="token operator">:</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token operator">--</span>buildVariant       <span class="token operator">&lt;</span>TOOLCHAIN<span class="token operator">&gt;</span>        Specify the build variant
                                        aarch64<span class="token operator">-</span>android or aarch64<span class="token operator">-</span>windows<span class="token operator">-</span>msvc to be validated<span class="token punctuation">.</span>
                                        Default<span class="token operator">:</span> aarch64<span class="token operator">-</span>android

<span class="token operator">--</span>testBackend                           Runs a small program on the runtime and Checks <span class="token keyword">if</span> QNN is supported <span class="token keyword">for</span>
                                        backend<span class="token punctuation">.</span>

<span class="token operator">--</span>deviceId           <span class="token operator">&lt;</span>DEVICE_ID<span class="token operator">&gt;</span>        Uses the device <span class="token keyword">for</span> running the adb command<span class="token punctuation">.</span>
                                        Defaults to first device in the adb devices list<span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token operator">--</span>coreVersion                           Outputs the version of the runtime that is present on the target<span class="token punctuation">.</span>

<span class="token operator">--</span>libVersion                            Outputs the library version of the runtime that is present on the target<span class="token punctuation">.</span>

<span class="token operator">--</span>targetPath          <span class="token operator">&lt;</span>DIR<span class="token operator">&gt;</span>             The path to be used on the device<span class="token punctuation">.</span>
                                        Defaults to <span class="token operator">/</span>data<span class="token operator">/</span>local<span class="token operator">/</span>tmp<span class="token operator">/</span>platformValidator

<span class="token operator">--</span>remoteHost         <span class="token operator">&lt;</span>REMOTEHOST<span class="token operator">&gt;</span>       Run on remote host through remote adb server<span class="token punctuation">.</span>
                                        Defaults to localhost<span class="token punctuation">.</span>

<span class="token operator">--</span>debug                                 Set to turn on Debug log

</code></pre> 
<h4><a id="645_qnn_1217"></a>6.4.5 qnn-个人资料查看器</h4> 
<p>qnn-profile-viewer工具用于解析使用 qnn-net-run生成的分析数据。此外，相同的数据可以保存到 csv 文件中。</p> 
<pre><code class="prism language-c">usage<span class="token operator">:</span> qnn<span class="token operator">-</span>profile<span class="token operator">-</span>viewer <span class="token operator">--</span>input_log PROFILING_LOG <span class="token punctuation">[</span><span class="token operator">--</span>help<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>output<span class="token operator">=</span>CSV_FILE<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>extract_opaque_objects<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>reader<span class="token operator">=</span>CUSTOM_READER_SHARED_LIB<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>schematic<span class="token operator">=</span>SCHEMATIC_BINARY<span class="token punctuation">]</span>

Reads a profiling log and outputs the contents to <span class="token constant">stdout</span>

Note<span class="token operator">:</span> The IPS calculation takes the following into account<span class="token operator">:</span> graph execute time<span class="token punctuation">,</span> tensor file IO time<span class="token punctuation">,</span> and misc<span class="token punctuation">.</span> time <span class="token keyword">for</span> quantization<span class="token punctuation">,</span> callbacks<span class="token punctuation">,</span> etc<span class="token punctuation">.</span>

required arguments<span class="token operator">:</span>
  <span class="token operator">--</span>input_log                     PROFILING_LOG
                                  Profiling log file<span class="token punctuation">.</span>

optional arguments<span class="token operator">:</span>
  <span class="token operator">--</span>output                        PATH
                                  Output file with processed profiling data<span class="token punctuation">.</span> File formats vary depending upon the reader <span class="token function">used</span>
                                  <span class="token punctuation">(</span>see <span class="token operator">--</span>reader<span class="token punctuation">)</span><span class="token punctuation">.</span> If not provided<span class="token punctuation">,</span> not output is created<span class="token punctuation">.</span>

  <span class="token operator">--</span>help                          Displays this help message<span class="token punctuation">.</span>

  <span class="token operator">--</span>reader                        CUSTOM_READER_SHARED_LIB
                                  Path to a reader library<span class="token punctuation">.</span> If not specified<span class="token punctuation">,</span> the <span class="token keyword">default</span> reader outputs a CSV file<span class="token punctuation">.</span>

  <span class="token operator">--</span>schematic                     SCHEMATIC_BINARY
                                  Path to the schematic binary file<span class="token punctuation">.</span>
                                  Please note that this option is specific to the QnnHtpOptraceProfilingReader library<span class="token punctuation">.</span>

  <span class="token operator">--</span>version                       Displays version information<span class="token punctuation">.</span>

  <span class="token operator">--</span>extract_opaque_objects        Specifies that the opaque objects will be dumped to output files

</code></pre> 
<h4><a id="646_qnn_1250"></a>6.4.6 qnn-上下文-二进制-实用程序</h4> 
<p>qnn -context-binary-utility工具验证上下文二进制文件的元数据并将其序列化为 json 文件。然后，此 json 文件可用于检查上下文二进制文件，以帮助调试。可以使用 QNN API 或 qnn-context-binary-generator 工具将 QNN 上下文序列化为二进制。</p> 
<pre><code class="prism language-c">usage<span class="token operator">:</span> qnn<span class="token operator">-</span>context<span class="token operator">-</span>binary<span class="token operator">-</span>utility <span class="token operator">--</span>context_binary CONTEXT_BINARY_FILE <span class="token operator">--</span>json_file JSON_FILE_NAME <span class="token punctuation">[</span><span class="token operator">--</span>help<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>version<span class="token punctuation">]</span>

Reads a serialized context binary and validates its metadata<span class="token punctuation">.</span>
If <span class="token operator">--</span>json_file is provided<span class="token punctuation">,</span> it outputs the metadata to a json file

required arguments<span class="token operator">:</span>
  <span class="token operator">--</span>context_binary  CONTEXT_BINARY_FILE
                    Path to cached context binary from which the binary info will be extracted
                    and written to json<span class="token punctuation">.</span>

  <span class="token operator">--</span>json_file       JSON_FILE_NAME
                    Provide path along with the file name <span class="token operator">&lt;</span>DIR<span class="token operator">&gt;</span><span class="token operator">/</span><span class="token operator">&lt;</span>FILE_NAME<span class="token operator">&gt;</span> to serialize
                    context binary info into json<span class="token punctuation">.</span>
                    The directory path must exist<span class="token punctuation">.</span> File with the FILE_NAME will be created at DIR<span class="token punctuation">.</span>

optional arguments<span class="token operator">:</span>
  <span class="token operator">--</span>help          Displays this help message<span class="token punctuation">.</span>

  <span class="token operator">--</span>version       Displays version information<span class="token punctuation">.</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b940db1e43fd4b8b14ec1e631162009f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux启动tomcat</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8ca9775e8b6dfc983d104f6a3b017b02/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CPU平台做视频智能分析，Lnton视频分析平台不仅支持流分析，同时也支持图片分析了</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>