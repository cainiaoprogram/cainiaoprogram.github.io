<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>服务器RAID管理之MegaRaid工具 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="服务器RAID管理之MegaRaid工具" />
<meta property="og:description" content="一、简介 MegaCli是一款管理维护硬件RAID软件，可以通过它来了解当前raid卡的所有信息，包括 raid卡的型号，raid的阵列类型，raid 上各磁盘状态等等。通常，我们对硬盘当前的状态不太好确定，一般通过机房人员巡检来完成，而MegaCli可以轻松通过远程完成硬盘类巡检。
一般通过 MegaCli 巡检到的Media Error Count: 0 Other Error Count: 0 这两个数值来确定阵列中磁盘是否有问题；Medai Error Count 表示磁盘可能错误，可能是磁盘有坏道，这个值不为0值得注意，数值越大，危险系数越高，Other Error Count 表示磁盘可能存在松动，可能需要重新再插入。
二、安装 LINUX版安装如下：
wget https://docs.broadcom.com/docs-and-downloads/raid-controllers/raid-controllers-common-files/8-07-14_MegaCLI.zip
uzip 8-07-14_MegaCLI.zip
rpm -ivh MegaCli-8.07.14-1.noarch.rpm
三、运维高频使用 【1】查raid级别、显示所有逻辑磁盘组信息
/opt/MegaRAID/MegaCli/MegaCli64 -LDInfo -Lall -aALL
【2】查raid卡信息 （可以查看raid卡时间，raid卡时间和系统时间可能不一致，raid卡日志用的是raid卡时间）
/opt/MegaRAID/MegaCli/MegaCli64 -AdpAllInfo -aALL
【3】查看硬盘信息 （查看磁盘有无坏道：Media Error Count ）
/opt/MegaRAID/MegaCli/MegaCli64 -PDList -aALL
【4】查看raid卡日志
/opt/MegaRAID/MegaCli/MegaCli64 -FwTermLog -Dsply -aALL
【5】显示Raid卡型号，Raid设置，Disk相关信息
/opt/MegaRAID/MegaCli/MegaCli64 -cfgdsply -aALL
【6】查看虚拟磁盘信息
/opt/MegaRAID/MegaCli/MegaCli64 -LdPdInfo -aALL |grep -E &#34;Target Id|Slot Number|Firmware state&#34;
Megacli查看硬盘状态，盘笼ID，slot以及是否是热备盘：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6e6db7ec4398bbb77208b9a441f95e4c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-07T20:47:40+08:00" />
<meta property="article:modified_time" content="2024-01-07T20:47:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">服务器RAID管理之MegaRaid工具</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、简介</h2> 
<p>   MegaCli是一款管理维护硬件RAID软件，可以通过它来了解当前raid卡的所有信息，包括 raid卡的型号，raid的阵列类型，raid 上各磁盘状态等等。通常，我们对硬盘当前的状态不太好确定，一般通过机房人员巡检来完成，而MegaCli可以轻松通过远程完成硬盘类巡检。</p> 
<p>   一般通过 MegaCli 巡检到的Media Error Count: 0 Other Error Count: 0 这两个数值来确定阵列中磁盘是否有问题；Medai Error Count 表示磁盘可能错误，可能是磁盘有坏道，这个值不为0值得注意，数值越大，危险系数越高，Other Error Count 表示磁盘可能存在松动，可能需要重新再插入。</p> 
<h2>二、安装</h2> 
<p>LINUX版安装如下：</p> 
<blockquote> 
 <p>wget https://docs.broadcom.com/docs-and-downloads/raid-controllers/raid-controllers-common-files/8-07-14_MegaCLI.zip<br> uzip 8-07-14_MegaCLI.zip<br> rpm -ivh MegaCli-8.07.14-1.noarch.rpm</p> 
</blockquote> 
<h2 style="background-color:transparent;">三、运维高频使用</h2> 
<p>【1】查raid级别、显示所有逻辑磁盘组信息<br> /opt/MegaRAID/MegaCli/MegaCli64 -LDInfo -Lall -aALL</p> 
<p>【2】查raid卡信息 （可以查看raid卡时间，raid卡时间和系统时间可能不一致，raid卡日志用的是raid卡时间）<br> /opt/MegaRAID/MegaCli/MegaCli64 -AdpAllInfo -aALL</p> 
<p>【3】查看硬盘信息 （查看磁盘有无坏道：Media Error Count ）<br> /opt/MegaRAID/MegaCli/MegaCli64 -PDList -aALL</p> 
<p>【4】查看raid卡日志<br> /opt/MegaRAID/MegaCli/MegaCli64 -FwTermLog -Dsply -aALL</p> 
<p>【5】显示Raid卡型号，Raid设置，Disk相关信息<br> /opt/MegaRAID/MegaCli/MegaCli64 -cfgdsply -aALL</p> 
<p>【6】查看虚拟磁盘信息<br> /opt/MegaRAID/MegaCli/MegaCli64 -LdPdInfo -aALL |grep -E "Target Id|Slot Number|Firmware state"<br> Megacli查看硬盘状态，盘笼ID，slot以及是否是热备盘：<br> /opt/MegaRAID/MegaCli/MegaCli64 -PDList -aALL | grep -E "^Enclosure Device|^Slot|^Raw|^Firmware|^Comm"</p> 
<p>【7】在线添加磁盘<br> /opt/MegaRAID/MegaCli/MegaCli64 -LDRecon -Start -r5 -Add -PhysDrv[1:4] -L1 -a0</p> 
<p>【8】创建阵列，不指定热备<br> /opt/MegaRAID/MegaCli/MegaCli64 -CfgLdAdd -r5 [1:2,1:3,1:4] WB Direct -a0</p> 
<p>【9】创建一个 raid5 阵列，由物理盘 2,3,4 构成，指定阵列的热备盘是物理盘5<br> /opt/MegaRAID/MegaCli/MegaCli64 -CfgLdAdd -r5 [1:2,1:3,1:4] WB Direct -Hsp[1:5] -a0</p> 
<p>【10】指定第 5 块盘作为全局热备<br> /opt/MegaRAID/MegaCli/MegaCli64 -PDHSP -Set [-EnclAffinity] [-nonRevertible] -PhysDrv[1:5] -a0</p> 
<p>【11】指定第 5 块盘为某个阵列的专用热备<br> /opt/MegaRAID/MegaCli/MegaCli64 -PDHSP -Set [-Dedicated [-Array1]] [-EnclAffinity] [-nonRevertible] -PhysDrv[1:5] -a0</p> 
<p>【12】删除全局热备<br> /opt/MegaRAID/MegaCli/MegaCli64 -PDHSP -Rmv -PhysDrv[8:11] -a0</p> 
<p>【13】删除阵列<br> /opt/MegaRAID/MegaCli/MegaCli64 -CfgLdDel -L1 -a1</p> 
<p>【14】将某块物理盘下线<br> /opt/MegaRAID/MegaCli/MegaCli64 -PDOffline -PhysDrv [1:4] -a0</p> 
<p>【15】将某块物理盘上线<br> /opt/MegaRAID/MegaCli/MegaCli64 -PDOnline -PhysDrv [1:4] -a0</p> 
<p>【16】清除所有的raid组的配置<br> /opt/MegaRAID/MegaCli/MegaCli64  -cfgclr  -a0      清除所有的raid组的配置<br> /opt/MegaRAID/MegaCli/MegaCli64  -cfglddel  -L1 -a0  删除指定的raid组(Target Id: 0)的raid组，可以通过上面的“查看逻辑盘详细信息”得到。</p> 
<p>【17】让硬盘LED灯闪烁<br> /opt/MegaRAID/MegaCli/MegaCli64 -PdLocate -start –physdrv[252:0] -a0 </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e558dece0bad57351b8e42b3af777160/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【读书笔记】《白帽子讲web安全》浏览器安全</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4174011d9d7da556c5f39a4b1592c555/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">018、通用集合类型</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>