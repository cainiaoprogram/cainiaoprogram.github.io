<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MyBatis 注解多对多 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MyBatis 注解多对多" />
<meta property="og:description" content="示例：测试多对多关联 根据数据模型，分别创建t_user、t_order、t_item表。
然后，输入以下测试数据。
程序清单：com.po.User.java
package com.po; public class User { private Integer userId; private String userName; private String userSex; private String userAddress; public Integer getUserId() { return userId; } public void setUserId(Integer userId) { this.userId = userId; } public String getUserName() { return userName; } public void setUserName(String userName) { this.userName = userName; } public String getUserSex() { return userSex; } public void setUserSex(String userSex) { this.userSex = userSex; } public String getUserAddress() { return userAddress; } public void setUserAddress(String userAddress) { this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/9601c6d455ad936a8e16c7205f84fde5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-09-04T15:55:48+08:00" />
<meta property="article:modified_time" content="2018-09-04T15:55:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MyBatis 注解多对多</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>示例：测试多对多关联</h4> 
<p><strong>根据数据模型，分别创建t_user、t_order、t_item表。</strong></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/e9/aa/LFBpXyUb_o.jpg"></p> 
<p><strong>然后，输入以下测试数据。</strong></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/20/a5/Rid0Ule3_o.jpg"><img alt="" class="has" src="https://images2.imgbox.com/19/71/34dUpxW2_o.jpg"></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/12/45/DiowBEH4_o.jpg"></p> 
<p><strong>程序清单：com.po.User.java</strong></p> 
<pre class="has"><code class="language-java">package com.po;
public class User {
	private Integer userId;
	private String userName;
	private String userSex;
	private String userAddress;
	public Integer getUserId() {
		return userId;
	}
	public void setUserId(Integer userId) {
		this.userId = userId;
	}
	public String getUserName() {
		return userName;
	}
	public void setUserName(String userName) {
		this.userName = userName;
	}
	public String getUserSex() {
		return userSex;
	}
	public void setUserSex(String userSex) {
		this.userSex = userSex;
	}
	public String getUserAddress() {
		return userAddress;
	}
	public void setUserAddress(String userAddress) {
		this.userAddress = userAddress;
	}
	@Override
	public String toString() {
		return "User [userId=" + userId + ", userName=" + userName + ", userSex=" + userSex + ", userAddress="
				+ userAddress + "]";
	}
}
</code></pre> 
<p><strong>程序清单：com.po.Item.java</strong></p> 
<pre class="has"><code class="language-java">package com.po;
public class Item {
	private Integer itemId;
	private String itemName;
	private double itemPrice;
	public Integer getItemId() {
		return itemId;
	}
	public void setItemId(Integer itemId) {
		this.itemId = itemId;
	}
	public String getItemName() {
		return itemName;
	}
	public void setItemName(String itemName) {
		this.itemName = itemName;
	}
	public double getItemPrice() {
		return itemPrice;
	}
	public void setItemPrice(double itemPrice) {
		this.itemPrice = itemPrice;
	}
	@Override
	public String toString() {
		return "Item [itemId=" + itemId + ", itemName=" + itemName + ", itemPrice=" + itemPrice + "]";
	}
}
</code></pre> 
<p><strong>程序清单：com.po.Order.java</strong></p> 
<pre class="has"><code class="language-java">package com.po;
import java.util.List;
public class Order {
	private Integer orderId;
	private User user;
	private List&lt;Item&gt; items;
	public Integer getOrderId() {
		return orderId;
	}
	public void setOrderId(Integer orderId) {
		this.orderId = orderId;
	}
	public User getUser() {
		return user;
	}
	public void setUser(User user) {
		this.user = user;
	}
	public List&lt;Item&gt; getItems() {
		return items;
	}
	public void setItems(List&lt;Item&gt; items) {
		this.items = items;
	}
}
</code></pre> 
<p><strong>程序清单：com.mapper.UserMapper.java</strong></p> 
<pre class="has"><code class="language-java">package com.mapper;
import org.apache.ibatis.annotations.Result;
import org.apache.ibatis.annotations.Results;
import org.apache.ibatis.annotations.Select;
import com.po.User;
public interface UserMapper {
	@Select("select * from t_user where user_id=#{userId}")
	@Results({@Result(id=true,column="user_id",property="userId"),
		@Result(column="user_name",property="userName"),
		@Result(column="user_sex",property="userSex"),
		@Result(column="user_address",property="userAddress")})
	User getUserById(Integer userId);
}
</code></pre> 
<p><strong>程序清单：com.mapper.ItemMapper.java</strong></p> 
<pre class="has"><code class="language-java">package com.mapper;
import java.util.List;
import org.apache.ibatis.annotations.Result;
import org.apache.ibatis.annotations.Results;
import org.apache.ibatis.annotations.Select;
import com.po.Item;
public interface ItemMapper {
	@Select("select * from t_item where item_id in(select item_id from t_order where order_id=#{orderId})")
	@Results({@Result(id=true,column="item_id",property="itemId"),
			@Result(column="item_name",property="itemName"),
			@Result(column="item_price",property="itemPrice")})
	List&lt;Item&gt; getItems(Integer orderId);
}
</code></pre> 
<p><strong>程序清单：com.mapper.OrderMapper.java</strong></p> 
<pre class="has"><code class="language-java">package com.mapper;
import org.apache.ibatis.annotations.Many;
import org.apache.ibatis.annotations.One;
import org.apache.ibatis.annotations.Result;
import org.apache.ibatis.annotations.Results;
import org.apache.ibatis.annotations.Select;
import org.apache.ibatis.mapping.FetchType;
import com.po.Order;
public interface OrderMapper {
	@Select("select * from t_order where order_id=#{orderId}")
	@Results({@Result(id=true,column="order_id",property="orderId"),
			@Result(column="user_id",property="user",
			one=@One(select="com.mapper.UserMapper.getUserById",fetchType=FetchType.EAGER)),
			@Result(column="item_id",property="items",
			many=@Many(select="com.mapper.ItemMapper.getItems",fetchType=FetchType.LAZY))})
	Order getOrderById(Integer orderId);
}
</code></pre> 
<p><strong>程序清单：com.dao.TestDao.java</strong></p> 
<pre class="has"><code class="language-java">package com.dao;
import java.io.IOException;
import java.io.InputStream;
import java.util.List;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;
import com.mapper.OrderMapper;
import com.po.Item;
import com.po.Order;
public class TestDao {
	private SqlSession	session=null;
	//获取SqlSession对象
	public SqlSession getSqlSession() throws IOException {
		InputStream	is = Resources.getResourceAsStream("mybatis-config.xml");
		SqlSessionFactory sessionFactory=new SqlSessionFactoryBuilder().build(is);
		return sessionFactory.openSession();
	}
	@Test
	public void getOrderById() throws IOException {
		session=getSqlSession();
		OrderMapper om=session.getMapper(OrderMapper.class);
		Order order=om.getOrderById(1);
		System.out.println(order.getUser());
		List&lt;Item&gt; items=order.getItems();
		for (Item item : items) {
			System.out.println(item);
		}
	}
}
</code></pre> 
<p><strong>运行TestDao的getOrderById()方法，控制台显示如下：</strong></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/af/2d/tL1hCUao_o.jpg"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8b1a1ce47f8be564cc77bb81b390178f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vector函数总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/95c3ae5986ab5d475b6f32af3603c646/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据表设计思想，ER图及三范式。</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>