<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Bluetooth技术学习笔记 ——蓝牙数据传输架构 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Bluetooth技术学习笔记 ——蓝牙数据传输架构" />
<meta property="og:description" content="参考：蓝牙协议 core_v5.0 LMP：Link Manager Protocol，链路管理协议 PBD：Profile Broadcast Data piconet：微微网 asynchronous：异步 isochronous ：实时 1. 数据传输架构 数据传输架构如下图所示：
（1）物理层：物理传输、物理信道和物理链路
物理传输：物理信道：物理链路： （2）逻辑层：逻辑传输和逻辑链路
逻辑传输：逻辑链路： （3）L2CAP
2. 数据流承载 （1）后缀说明，传输的数据类型
-C： for control links carrying LMP or LL messages-U：for L2CAP links carrying user data(L2CAP PDUs）-S：for stream links carrying unformatted synchronous or isochronous data （2）Framed Data Traffic：利用L2CAP层对应用层数据以帧结构的方式进行异步或实时传输。
应用层数据以变长帧的方式进行传输，帧的最大长度由协商的决定。L2CAP提供面向连接的和非面向连接的数据传输。 （3）Unframed Data Traffic：利用SCO-S、eSCO-S或PBD逻辑链路对应用层数据进行实时的、恒速的传输。
传输特点：
① 保留物理信道带宽
② 提供锁定到微微网时钟的固定传输速率
③ 固定的数据包大小
④ 固定的传输间隔 SCO和eSCO发送端和接收端的关系是一对一，PBD是一对多。若应用层数据是实时的，速率可变的，只能以帧结构的形式通过L2CAP广播信道进行传输。LE系统不支持非帧结构的数据流传输模式。 （4）数据传输的可靠性
BR/EDR：
① 基带数据包头采用前向纠错码（FEC）进行编码，接收端可对存在的头错误进行纠正。
② 接收端利用头错误检查（HEC）来检查纠错后是否依然残留错误。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e3472bc74699c55c60fafd2bfae99d57/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-04-12T16:45:24+08:00" />
<meta property="article:modified_time" content="2019-04-12T16:45:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Bluetooth技术学习笔记 ——蓝牙数据传输架构</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code>参考：蓝牙协议 core_v5.0
</code></pre> 
<pre><code>LMP：Link Manager Protocol，链路管理协议
PBD：Profile Broadcast Data
piconet：微微网
asynchronous：异步
isochronous ：实时
</code></pre> 
<h6><a id="1__12"></a>1. 数据传输架构</h6> 
<p><font color="DarkCyan" size="2" face="微软雅黑">数据传输架构如下图所示：</font><br> <img src="https://images2.imgbox.com/2b/33/SE048VIB_o.png" alt="在这里插入图片描述"><br> <font color="DarkCyan" size="2" face="微软雅黑">（1）物理层：物理传输、物理信道和物理链路</font></p> 
<ul><li><font size="2" face="微软雅黑">物理传输：</font></li><li><font size="2" face="微软雅黑">物理信道：</font></li><li><font size="2" face="微软雅黑">物理链路：</font></li></ul> 
<p><font color="DarkCyan" size="2" face="微软雅黑">（2）逻辑层：逻辑传输和逻辑链路</font></p> 
<ul><li><font size="2" face="微软雅黑">逻辑传输：</font></li><li><font size="2" face="微软雅黑">逻辑链路：</font></li></ul> 
<p><font color="DarkCyan" size="2" face="微软雅黑">（3）L2CAP</font></p> 
<p> </p> 
<h6><a id="2__27"></a>2. 数据流承载</h6> 
<p><img src="https://images2.imgbox.com/5c/e9/AyLXyJpU_o.png" alt="在这里插入图片描述"><br> <font color="DarkCyan" size="2" face="微软雅黑">（1）后缀说明，传输的数据类型</font></p> 
<ul><li><font size="2" face="微软雅黑">-C： for control links carrying LMP or LL messages</font></li><li><font size="2" face="微软雅黑">-U：for L2CAP links carrying user data(L2CAP PDUs）</font></li><li><font size="2" face="微软雅黑">-S：for stream links carrying unformatted synchronous or isochronous data</font></li></ul> 
<p><font color="DarkCyan" size="2" face="微软雅黑">（2）Framed Data Traffic：利用L2CAP层对应用层数据以帧结构的方式进行异步或实时传输。</font></p> 
<ul><li><font size="2" face="微软雅黑">应用层数据以变长帧的方式进行传输，帧的最大长度由协商的决定。</font></li><li><font size="2" face="微软雅黑">L2CAP提供面向连接的和非面向连接的数据传输。</font></li></ul> 
<p><font color="DarkCyan" size="2" face="微软雅黑">（3）Unframed Data Traffic：利用SCO-S、eSCO-S或PBD逻辑链路对应用层数据进行实时的、恒速的传输。</font></p> 
<ul><li><font size="2" face="微软雅黑">传输特点：<br> ① 保留物理信道带宽<br> ② 提供锁定到微微网时钟的固定传输速率<br> ③ 固定的数据包大小<br> ④ 固定的传输间隔 </font></li><li><font size="2" face="微软雅黑">SCO和eSCO发送端和接收端的关系是一对一，PBD是一对多。</font></li><li><font size="2" face="微软雅黑">若应用层数据是实时的，速率可变的，只能以帧结构的形式通过L2CAP广播信道进行传输。</font></li><li><font size="2" face="微软雅黑">LE系统不支持非帧结构的数据流传输模式。</font></li></ul> 
<p><font color="DarkCyan" size="2" face="微软雅黑">（4）数据传输的可靠性</font></p> 
<ul><li> <p><font size="2" face="微软雅黑"><strong>BR/EDR</strong>：<br> ① 基带数据包头采用前向纠错码（FEC）进行编码，接收端可对存在的头错误进行纠正。<br> ② 接收端利用头错误检查（HEC）来检查纠错后是否依然残留错误。<br> ③ 若数据校验未通过，则对数据包进行自动重传（ARQ）。<br> ④ 广播链路上的数据：每个数据包发多次，总有一次可以正确（最好是这样）。</font></p> </li><li> <p><font size="2" face="微软雅黑"><strong>LE</strong>：<br> ① LL数据包采用24-bit CRC。若数据校验未通过，则对数据包进行重传。<br> ② 广播链路上的数据：每个数据包发多次，总有一次可以正确<br> </font></p> </li><li> <p><font size="2" face="微软雅黑"><strong>AMP</strong>：AMP的可靠性取决于MAC/PHY。</font><br>  </p> </li></ul> 
<h6><a id="3__62"></a>3. 传输架构实体</h6> 
<p><font color="DarkCyan" size="2" face="微软雅黑">（1）数据传输架构实体如下图所示：</font><br> <img src="https://images2.imgbox.com/b9/d9/nyyu29MP_o.png" alt="在这里插入图片描述"><br> <font color="DarkCyan" size="2" face="微软雅黑">（2）BR/EDR通用包结构：BR/EDR系统架构的一个映射</font><br> <img src="https://images2.imgbox.com/91/97/lTfoCXyY_o.png" alt="在这里插入图片描述"></p> 
<ul><li><font size="2" face="微软雅黑"><strong>CAC</strong>：channel access code，信道接入码，标识某个特定物理信道上的通信。</font></li><li><font size="2" face="微软雅黑"><strong>LT_ADDR</strong>：logical transport address，逻辑传输地址，接收方用于识别该数据包是否传给自己，或者用于内部路由。</font></li><li><font size="2" face="微软雅黑"><strong>packet header</strong>：携带LT_ADDR和部分LC协议。</font></li><li><font size="2" face="微软雅黑"><strong>payload header</strong>：携带逻辑链路标识和payload信息长度。</font></li><li><font size="2" face="微软雅黑"><strong>MIC</strong>：Message Integrity Check，消息完保校验</font></li></ul> 
<p><font color="DarkCyan" size="2" face="微软雅黑">（3）LE通用包结构</font></p> 
<ul><li><font size="2" face="微软雅黑">LE无线开发基于三种物理层，两种调制方案。</font></li></ul> 
<p><img src="https://images2.imgbox.com/56/a2/9FjYoGpc_o.png" alt="在这里插入图片描述"><br> </p> 
<ul><li><font size="2" face="微软雅黑">LE Uncoded PHYs数据包结构<br> <img src="https://images2.imgbox.com/1e/6c/xQwRan3f_o.png" alt="在这里插入图片描述"></font></li><li><font size="2" face="微软雅黑">LE coded PHYs数据包结构<br> <img src="https://images2.imgbox.com/34/21/fzjZ9FAM_o.png" alt="在这里插入图片描述"></font></li><li><font size="2" face="微软雅黑">说明：<br> ① LL链路层空口包不携带物理链路标识。物理链路标识在信道连接建立或周期性广播信道建立时确定。<br> ② <strong>Access Address</strong>：接入地址，标识物理信道通信。LE物理信道有3种类型：广播物理信道（用于非周期性广播）、周期性物理信道（周期性广播）和微微网物理信道。广播物理信道接入地址为固定的，其余两种为随机生成的32-bit值。<br> </font></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e1b2129ca4ff236defd5412e1a6f4286/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JSP内置对象使用案例——编写两个JSP页面，对表单数据访问提取</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7eb03d30dd8f421db32e102e577dc2ff/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用Powermock工具mock静态方法代码示例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>