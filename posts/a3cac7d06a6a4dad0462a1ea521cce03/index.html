<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MFC 最详细入门教程 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MFC 最详细入门教程" />
<meta property="og:description" content="Visual Studio 下载：https://visualstudio.microsoft.com/zh-hans/downloads/
鸡啄米 ----- VS2010/MFC编程入门教程之目录和总结：VS2010/MFC编程入门教程之目录和总结-软件开发-鸡啄米
一、VS2010/MFC编程入门教程之目录
第一部分：VS2010/MFC开发环境
VS2010/MFC编程入门之前言
VS2010/MFC编程入门之一（VS2010与MSDN安装过程图解）
第二部分：VS2010/MFC应用程序框架
VS2010/MFC编程入门之二（利用MFC向导生成单文档应用程序框架）
VS2010/MFC编程入门之三（VS2010应用程序工程中文件的组成结构）
VS2010/MFC编程入门之四（MFC应用程序框架分析）
VS2010/MFC编程入门之五（MFC消息映射机制概述）
第三部分：对话框
VS2010/MFC编程入门之六（对话框：创建对话框模板和修改对话框属性）
VS2010/MFC编程入门之七（对话框：为对话框添加控件）
VS2010/MFC编程入门之八（对话框：创建对话框类和添加控件变量）
VS2010/MFC编程入门之九（对话框：为控件添加消息处理函数）
VS2010/MFC编程入门之十（对话框：设置对话框控件的Tab顺序）
VS2010/MFC编程入门之十一（对话框：模态对话框及其弹出过程）
VS2010/MFC编程入门之十二（对话框：非模态对话框的创建及显示）
VS2010/MFC编程入门之十三（对话框：属性页对话框及相关类的介绍）
VS2010/MFC编程入门之十四（对话框：向导对话框的创建及显示）
VS2010/MFC编程入门之十五（对话框：一般属性页对话框的创建及显示）
VS2010/MFC编程入门之十六（对话框：消息对话框）
VS2010/MFC编程入门之十七（对话框：文件对话框）
VS2010/MFC编程入门之十八（对话框：字体对话框）
VS2010/MFC编程入门之十九（对话框：颜色对话框）
第四部分：常用控件
VS2010/MFC编程入门之二十（常用控件：静态文本框）
VS2010/MFC编程入门之二十一（常用控件：编辑框Edit Control）
VS2010/MFC编程入门之二十二（常用控件：按钮控件Button、Radio Button和Check Box）
VS2010/MFC编程入门之二十三（常用控件：按钮控件的编程实例）
VS2010/MFC编程入门之二十四（常用控件：列表框控件ListBox）
VS2010/MFC编程入门之二十五（常用控件：组合框控件Combo Box）
VS2010/MFC编程入门之二十六（常用控件：滚动条控件Scroll Bar）
VS2010/MFC编程入门之二十七（常用控件：图片控件Picture Control）
VS2010/MFC编程入门之二十八（常用控件：列表视图控件List Control 上）
VS2010/MFC编程入门之二十九（常用控件：列表视图控件List Control 下）
VS2010/MFC编程入门之三十（常用控件：树形控件Tree Control 上）
VS2010/MFC编程入门之三十一（常用控件：树形控件Tree Control 下）
VS2010/MFC编程入门之三十二（常用控件：标签控件Tab Control 上）
VS2010/MFC编程入门之三十三（常用控件：标签控件Tab Control 下）
第五部分：菜单、工具栏与状态栏
VS2010/MFC编程入门之三十四（菜单：VS2010菜单资源详解）
VS2010/MFC编程入门之三十五（菜单：菜单及CMenu类的使用）
VS2010/MFC编程入门之三十六（工具栏：工具栏资源及CToolBar类）
VS2010/MFC编程入门之三十七（工具栏：工具栏的创建、停靠与使用）
VS2010/MFC编程入门之三十八（状态栏的使用详解）" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a3cac7d06a6a4dad0462a1ea521cce03/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-16T15:42:10+08:00" />
<meta property="article:modified_time" content="2023-12-16T15:42:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MFC 最详细入门教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p>Visual Studio 下载：<a href="https://visualstudio.microsoft.com/zh-hans/downloads/" rel="nofollow" title="https://visualstudio.microsoft.com/zh-hans/downloads/">https://visualstudio.microsoft.com/zh-hans/downloads/</a></p> 
<p></p> 
<p><strong>鸡啄米 ----- VS2010/MFC编程入门教程之目录和总结：</strong><a href="http://www.jizhuomi.com/software/257.html" rel="nofollow" title="VS2010/MFC编程入门教程之目录和总结-软件开发-鸡啄米">VS2010/MFC编程入门教程之目录和总结-软件开发-鸡啄米</a></p> 
<p>      <strong>一、VS2010/MFC编程入门教程之目录</strong></p> 
<p>       <strong>第一部分：VS2010/MFC开发环境</strong></p> 
<p>       <a href="http://www.jizhuomi.com/software/137.html" rel="nofollow" title="VS2010/MFC编程入门之前言">VS2010/MFC编程入门之前言</a><br>        <a href="http://www.jizhuomi.com/software/139.html" rel="nofollow" title="VS2010/MFC编程入门之一（VS2010与MSDN安装过程图解）">VS2010/MFC编程入门之一（VS2010与MSDN安装过程图解）</a></p> 
<p>       <strong>第二部分：VS2010/MFC应用程序框架</strong></p> 
<p>       <a href="http://www.jizhuomi.com/software/141.html" rel="nofollow" title="VS2010/MFC编程入门之二（利用MFC向导生成单文档应用程序框架）">VS2010/MFC编程入门之二（利用MFC向导生成单文档应用程序框架）</a><br>        <a href="http://www.jizhuomi.com/software/143.html" rel="nofollow" title="VS2010/MFC编程入门之三（VS2010应用程序工程中文件的组成结构）">VS2010/MFC编程入门之三（VS2010应用程序工程中文件的组成结构）</a><br>        <a href="http://www.jizhuomi.com/software/145.html" rel="nofollow" title="VS2010/MFC编程入门之四（MFC应用程序框架分析）">VS2010/MFC编程入门之四（MFC应用程序框架分析）</a><br>        <a href="http://www.jizhuomi.com/software/147.html" rel="nofollow" title="VS2010/MFC编程入门之五（MFC消息映射机制概述）">VS2010/MFC编程入门之五（MFC消息映射机制概述）</a></p> 
<p>       <strong>第三部分：对话框</strong></p> 
<p>       <a href="http://www.jizhuomi.com/software/149.html" rel="nofollow" title="VS2010/MFC编程入门之六（对话框：创建对话框模板和修改对话框属性）">VS2010/MFC编程入门之六（对话框：创建对话框模板和修改对话框属性）</a><br>        <a href="http://www.jizhuomi.com/software/151.html" rel="nofollow" title="VS2010/MFC编程入门之七（对话框：为对话框添加控件）">VS2010/MFC编程入门之七（对话框：为对话框添加控件）</a><br>        <a href="http://www.jizhuomi.com/software/153.html" rel="nofollow" title="VS2010/MFC编程入门之八（对话框：创建对话框类和添加控件变量）">VS2010/MFC编程入门之八（对话框：创建对话框类和添加控件变量）</a><br>        <a href="http://www.jizhuomi.com/software/156.html" rel="nofollow" title="VS2010/MFC编程入门之九（对话框：为控件添加消息处理函数）">VS2010/MFC编程入门之九（对话框：为控件添加消息处理函数）</a><br>        <a href="http://www.jizhuomi.com/software/158.html" rel="nofollow" title="VS2010/MFC编程入门之十（对话框：设置对话框控件的Tab顺序）">VS2010/MFC编程入门之十（对话框：设置对话框控件的Tab顺序）</a><br>        <a href="http://www.jizhuomi.com/software/160.html" rel="nofollow" title="VS2010/MFC编程入门之十一（对话框：模态对话框及其弹出过程）">VS2010/MFC编程入门之十一（对话框：模态对话框及其弹出过程）</a><br>        <a href="http://www.jizhuomi.com/software/162.html" rel="nofollow" title="VS2010/MFC编程入门之十二（对话框：非模态对话框的创建及显示）">VS2010/MFC编程入门之十二（对话框：非模态对话框的创建及显示）</a><br>        <a href="http://www.jizhuomi.com/software/164.html" rel="nofollow" title="VS2010/MFC编程入门之十三（对话框：属性页对话框及相关类的介绍）">VS2010/MFC编程入门之十三（对话框：属性页对话框及相关类的介绍）</a><br>        <a href="http://www.jizhuomi.com/software/166.html" rel="nofollow" title="VS2010/MFC编程入门之十四（对话框：向导对话框的创建及显示）">VS2010/MFC编程入门之十四（对话框：向导对话框的创建及显示）</a><br>        <a href="http://www.jizhuomi.com/software/169.html" rel="nofollow" title="VS2010/MFC编程入门之十五（对话框：一般属性页对话框的创建及显示）">VS2010/MFC编程入门之十五（对话框：一般属性页对话框的创建及显示）</a><br>        <a href="http://www.jizhuomi.com/software/171.html" rel="nofollow" title="VS2010/MFC编程入门之十六（对话框：消息对话框）">VS2010/MFC编程入门之十六（对话框：消息对话框）</a><br>        <a href="http://www.jizhuomi.com/software/173.html" rel="nofollow" title="VS2010/MFC编程入门之十七（对话框：文件对话框）">VS2010/MFC编程入门之十七（对话框：文件对话框）</a><br>        <a href="http://www.jizhuomi.com/software/175.html" rel="nofollow" title="VS2010/MFC编程入门之十八（对话框：字体对话框）">VS2010/MFC编程入门之十八（对话框：字体对话框）</a><br>        <a href="http://www.jizhuomi.com/software/177.html" rel="nofollow" title="VS2010/MFC编程入门之十九（对话框：颜色对话框）">VS2010/MFC编程入门之十九（对话框：颜色对话框）</a></p> 
<p>       <strong>第四部分：常用控件</strong></p> 
<p>       <a href="http://www.jizhuomi.com/software/179.html" rel="nofollow" title="VS2010/MFC编程入门之二十（常用控件：静态文本框）">VS2010/MFC编程入门之二十（常用控件：静态文本框）</a><br>        <a href="http://www.jizhuomi.com/software/181.html" rel="nofollow" title="VS2010/MFC编程入门之二十一（常用控件：编辑框Edit Control）">VS2010/MFC编程入门之二十一（常用控件：编辑框Edit Control）</a><br>        <a href="http://www.jizhuomi.com/software/182.html" rel="nofollow" title="VS2010/MFC编程入门之二十二（常用控件：按钮控件Button、Radio Button和Check Box）">VS2010/MFC编程入门之二十二（常用控件：按钮控件Button、Radio Button和Check Box）</a><br>        <a href="http://www.jizhuomi.com/software/184.html" rel="nofollow" title="VS2010/MFC编程入门之二十三（常用控件：按钮控件的编程实例）">VS2010/MFC编程入门之二十三（常用控件：按钮控件的编程实例）</a><br>        <a href="http://www.jizhuomi.com/software/186.html" rel="nofollow" title="VS2010/MFC编程入门之二十四（常用控件：列表框控件ListBox）">VS2010/MFC编程入门之二十四（常用控件：列表框控件ListBox）</a><br>        <a href="http://www.jizhuomi.com/software/189.html" rel="nofollow" title="VS2010/MFC编程入门之二十五（常用控件：组合框控件Combo Box）">VS2010/MFC编程入门之二十五（常用控件：组合框控件Combo Box）</a><br>        <a href="http://www.jizhuomi.com/software/191.html" rel="nofollow" title="VS2010/MFC编程入门之二十六（常用控件：滚动条控件Scroll Bar）">VS2010/MFC编程入门之二十六（常用控件：滚动条控件Scroll Bar）</a><br>        <a href="http://www.jizhuomi.com/software/193.html" rel="nofollow" title="VS2010/MFC编程入门之二十七（常用控件：图片控件Picture Control）">VS2010/MFC编程入门之二十七（常用控件：图片控件Picture Control）</a><br>        <a href="http://www.jizhuomi.com/software/195.html" rel="nofollow" title="VS2010/MFC编程入门之二十八（常用控件：列表视图控件List Control 上）">VS2010/MFC编程入门之二十八（常用控件：列表视图控件List Control 上）</a><br>        <a href="http://www.jizhuomi.com/software/197.html" rel="nofollow" title="VS2010/MFC编程入门之二十九（常用控件：列表视图控件List Control 下）">VS2010/MFC编程入门之二十九（常用控件：列表视图控件List Control 下）</a><br>        <a href="http://www.jizhuomi.com/software/200.html" rel="nofollow" title="VS2010/MFC编程入门之三十（常用控件：树形控件Tree Control 上）">VS2010/MFC编程入门之三十（常用控件：树形控件Tree Control 上）</a><br>        <a href="http://www.jizhuomi.com/software/203.html" rel="nofollow" title="VS2010/MFC编程入门之三十一（常用控件：树形控件Tree Control 下）">VS2010/MFC编程入门之三十一（常用控件：树形控件Tree Control 下）</a><br>        <a href="http://www.jizhuomi.com/software/205.html" rel="nofollow" title="VS2010/MFC编程入门之三十二（常用控件：标签控件Tab Control 上）">VS2010/MFC编程入门之三十二（常用控件：标签控件Tab Control 上）</a><br>        <a href="http://www.jizhuomi.com/software/207.html" rel="nofollow" title="VS2010/MFC编程入门之三十三（常用控件：标签控件Tab Control 下）">VS2010/MFC编程入门之三十三（常用控件：标签控件Tab Control 下）</a></p> 
<p>       <strong>第五部分：菜单、工具栏与状态栏</strong></p> 
<p>       <a href="http://www.jizhuomi.com/software/210.html" rel="nofollow" title="VS2010/MFC编程入门之三十四（菜单：VS2010菜单资源详解）">VS2010/MFC编程入门之三十四（菜单：VS2010菜单资源详解）</a><br>        <a href="http://www.jizhuomi.com/software/212.html" rel="nofollow" title="VS2010/MFC编程入门之三十五（菜单：菜单及CMenu类的使用）">VS2010/MFC编程入门之三十五（菜单：菜单及CMenu类的使用）</a><br>        <a href="http://www.jizhuomi.com/software/215.html" rel="nofollow" title="VS2010/MFC编程入门之三十六（工具栏：工具栏资源及CToolBar类）">VS2010/MFC编程入门之三十六（工具栏：工具栏资源及CToolBar类）</a><br>        <a href="http://www.jizhuomi.com/software/217.html" rel="nofollow" title="VS2010/MFC编程入门之三十七（工具栏：工具栏的创建、停靠与使用）">VS2010/MFC编程入门之三十七（工具栏：工具栏的创建、停靠与使用）</a><br>        <a href="http://www.jizhuomi.com/software/219.html" rel="nofollow" title="VS2010/MFC编程入门之三十八（状态栏的使用详解）">VS2010/MFC编程入门之三十八（状态栏的使用详解）</a></p> 
<p>      <strong> 第六部分：文档、视图和框架</strong></p> 
<p>       <a href="http://www.jizhuomi.com/software/221.html" rel="nofollow" title="VS2010/MFC编程入门之三十九（文档、视图和框架：概述）">VS2010/MFC编程入门之三十九（文档、视图和框架：概述）</a><br>        <a href="http://www.jizhuomi.com/software/223.html" rel="nofollow" title="VS2010/MFC编程入门之四十（文档、视图和框架：各对象之间的关系）">VS2010/MFC编程入门之四十（文档、视图和框架：各对象之间的关系）</a><br>        <a href="http://www.jizhuomi.com/software/226.html" rel="nofollow" title="VS2010/MFC编程入门之四十一（文档、视图和框架：分割窗口）">VS2010/MFC编程入门之四十一（文档、视图和框架：分割窗口）</a></p> 
<p>       <strong>第七部分：MFC常用类</strong></p> 
<p>       <a href="http://www.jizhuomi.com/software/228.html" rel="nofollow" title="VS2010/MFC编程入门之四十二（MFC常用类：CString类）">VS2010/MFC编程入门之四十二（MFC常用类：CString类）</a><br>        <a href="http://www.jizhuomi.com/software/230.html" rel="nofollow" title="VS2010/MFC编程入门之四十三（MFC常用类：CTime类和CTimeSpan类）">VS2010/MFC编程入门之四十三（MFC常用类：CTime类和CTimeSpan类）</a><br>        <a href="http://www.jizhuomi.com/software/232.html" rel="nofollow" title="VS2010/MFC编程入门之四十四（MFC常用类：定时器Timer）">VS2010/MFC编程入门之四十四（MFC常用类：定时器Timer）</a><br>        <a href="http://www.jizhuomi.com/software/234.html" rel="nofollow" title="VS2010/MFC编程入门之四十五（MFC常用类：CFile文件操作类）">VS2010/MFC编程入门之四十五（MFC常用类：CFile文件操作类）</a><br>        <a href="http://www.jizhuomi.com/software/236.html" rel="nofollow" title="VS2010/MFC编程入门之四十六（MFC常用类：MFC异常处理）">VS2010/MFC编程入门之四十六（MFC常用类：MFC异常处理）</a></p> 
<p>      <strong> 第八部分：字体和文本输出</strong></p> 
<p>       <a href="http://www.jizhuomi.com/software/239.html" rel="nofollow" title="VS2010/MFC编程入门之四十七（字体和文本输出：CFont字体类）">VS2010/MFC编程入门之四十七（字体和文本输出：CFont字体类）</a><br>        <a href="http://www.jizhuomi.com/software/241.html" rel="nofollow" title="VS2010/MFC编程入门之四十八（字体和文本输出：文本输出）">VS2010/MFC编程入门之四十八（字体和文本输出：文本输出）</a></p> 
<p>      <strong> 第九部分：图形图像</strong></p> 
<p>       <a href="http://www.jizhuomi.com/software/244.html" rel="nofollow" title="VS2010/MFC编程入门之四十九（图形图像：CDC类及其屏幕绘图函数）">VS2010/MFC编程入门之四十九（图形图像：CDC类及其屏幕绘图函数）</a><br>        <a href="http://www.jizhuomi.com/software/246.html" rel="nofollow" title="VS2010/MFC编程入门之五十（图形图像：GDI对象之画笔CPen）">VS2010/MFC编程入门之五十（图形图像：GDI对象之画笔CPen）</a><br>        <a href="http://www.jizhuomi.com/software/248.html" rel="nofollow" title="VS2010/MFC编程入门之五十一（图形图像：GDI对象之画刷CBrush）">VS2010/MFC编程入门之五十一（图形图像：GDI对象之画刷CBrush）</a></p> 
<p>       <strong>第十部分：Ribbon界面开发</strong></p> 
<p>       <a href="http://www.jizhuomi.com/software/251.html" rel="nofollow" title="VS2010/MFC编程入门之五十二（Ribbon界面开发：创建Ribbon样式的应用程序框架）">VS2010/MFC编程入门之五十二（Ribbon界面开发：创建Ribbon样式的应用程序框架）</a><br>        <a href="http://www.jizhuomi.com/software/253.html" rel="nofollow" title="VS2010/MFC编程入门之五十三（Ribbon界面开发：为Ribbon Bar添加控件）">VS2010/MFC编程入门之五十三（Ribbon界面开发：为Ribbon Bar添加控件）</a><br>        <a href="http://www.jizhuomi.com/software/255.html" rel="nofollow" title="VS2010/MFC编程入门之五十四（Ribbon界面开发：使用更多控件并为控件添加消息处理函数）">VS2010/MFC编程入门之五十四（Ribbon界面开发：使用更多控件并为控件添加消息处理函数）</a></p> 
<p></p> 
<p></p> 
<h2><span style="color:#f33b45;">文中截图都是基于VS2019 </span></h2> 
<p></p> 
<p></p> 
<h2>1. 新建 MFC 项目</h2> 
<p></p> 
<ul><li>1. 选择菜单项  <strong>文件-&gt;新建-&gt;项目</strong>，弹出 “<strong>新项目</strong>” 对话框。</li><li>2. 选择 <strong>MFC</strong>，点击下一步，然后<strong>键入工程名称</strong>，本例取名“Addition”，在<strong>设置工程的保存路径</strong>。点“<strong>创建</strong>”。</li><li>3. 在应用程序类型下拉框选择<strong> 基于对话框</strong>，其他使用默认设置，点 “<strong>完成</strong>”。</li></ul> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/9a/a4/PRR4iMy9_o.png"></p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/8a/94/YYKcevzH_o.png"></p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/42/d1/ZdwGAYp3_o.png"></p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/20/da/LaYglLL2_o.png"></p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/d4/8a/HGoW6DRJ_o.png"></p> 
<p>在 <strong>解决方案视图</strong> 中看到，此工程的文件要比单文档应用程序少的多，在 <strong>Class View</strong> 中主要有三个类：<strong>CAboutDlg</strong>、<strong>CAdditionApp</strong> 和 <strong>CAdditionDlg </strong>。</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/d9/25/l9R6M3SH_o.png"></p> 
<ol><li><strong>CAboutDlg </strong>是应用程序的 “关于” 对话框类，</li><li><strong>CAdditionApp </strong>是由 CWinApp 派生的类，</li><li><strong>CAdditionDlg </strong>是主对话框类，<span style="color:#7c79e5;"><strong>主对话框也就是此应用程序运行后显示的主要界面。</strong></span></li></ol> 
<p></p> 
<p>打开<span style="color:#f33b45;"><strong>资源视图</strong></span></p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/73/ae/T8GtfIFQ_o.png"></p> 
<p>在Resource View视图中可以看到工程 Addition 的资源树，展开Addition.rc，下面有四个子项：Dialog（对话框）、Icon（图标）、String Table（字符串表）和Version（版本）。然后展开Dialog项，下面有两个对话框模板，其ID分别为：IDD_ABOUTBOX和IDD_ADDITION_DIALOG，前者是“关于”对话框的模板，后者是主对话框的模板。ID是资源的唯一标识，本质上是一个无符号整数，一般ID代表的整数值由系统定义，我们无需干涉。</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/4c/88/itvzcG8s_o.png"></p> 
<p>可见对于主对话框来说，创建对话框第一步中的创建新的对话框模板已经由系统自动完成了。如果需要再添加创建新的对话框模板时，需要在Resource View 的“Dialog”节点上点右键，在右键菜单中选择“Insert Dialog”，就会生成新的对话框模板，并且会自动分配ID。如图：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/69/76/yaUMSarp_o.png"></p> 
<p>在Addition对话框模板上点右键，然后在右键菜单中选择Properties，则在右侧面板中会显示对话框的属性列表。如下图：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/12/90/6SkxTlVE_o.png"></p> 
<p>说明：</p> 
<ul><li>1. ID         ：对话框ID，唯一标识对话框资源，可以修改。此处为IDD_ADDITION_DIALOG，我们不修改它。</li><li>2. Caption：<strong>对话框标题</strong>。此处默认为 空，<span style="color:#7c79e5;"><strong>我们将其修改为 “加法计算器” 。</strong></span></li><li>3. Border  ：边框类型。有四种类型：None、Thin、Resizing和Dialog Frame。我们使用默认的Dialog Frame。</li><li>4. Maximize ：是否使用最大化按钮。我们使用默认的False。</li><li>5. Minimize  ：是否使用最小化按钮。同样我们使用默认的False。</li><li>6. Style        ：对话框类型。有三种类型：Overlapped（重叠窗口）、Popup（弹出式窗口）和Child（子窗口）。弹出式窗口比较常见。我们使用默认的Popup类型。</li><li>7. System Menu：是否带有标题栏左上角的系统菜单，包括移动、关闭等菜单项。我们使用默认的True。</li><li>8.Title Bar    ：是否带有标题栏。我们使用默认的True。</li><li>9.Font(Size) ：字体类型和字体大小。如果将其修改为非系统字体，则Use System自动改为False。而如果Use System原来为False，将其修改为True，则Font(Size)自动设置为系统字体。这里我们使用默认的系统字体。</li></ul> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/c6/55/utxOLAZp_o.png"></p> 
<p>修改了标题属性。这时我们运行此程序后的界面如下：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/e5/44/s0ZqgLqG_o.png"></p> 
<p></p> 
<h4>1.为对话框添加一个静态文本框（Static Text），用于显示字符串--“被加数”。</h4> 
<p>对于自动添加的一个标题为“TODO:Place dialog controls here.”的静态文本框，这里将它删掉，继续添加新的静态文本框。<br> 删除控件时，可以使用鼠标左键点击选中它，选中后控件的周围会出现虚线框，然后按Delete键就可以将其删除了。在“Addition”工程的Resource View中打开上一讲中创建的对话框模板IDD_ADDITION_DIALOG，自动添加的静态文本框就可以使用这种方法删除。<br> 在添加新的静态文本框以前，先看看Toolbox视图是否显示了，如果没有显示，在菜单栏上点击 View-&gt;Toolbox 即可。Toolbox视图如下图：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/d1/a7/3X6kwMkW_o.png"></p> 
<p>        <strong>Toolbox</strong>（<strong>工具箱</strong>） 中列出了一些常用控件，其中有一个是 <strong>Static Text</strong>，即是我们要添加的控件。在 Toolbox 中的 Static Text 上点下鼠标左键不放开，并拖到 IDD_ADDITION_DIALOG 对话框模板上，模板上会出现一个虚线框，我们找到合适的位置松开鼠标左键放下它。</p> 
<p>       用鼠标左键选中控件后周围出现虚线框，然后鼠标移到虚线框上几个黑点的位置会变成双向箭头的形状，此时就可以按下鼠标左键并拖动来改变控件大小了。我们可以这样改变新添加的静态文本框控件的大小，以更好的显示标题。当然，整个对话框模板也可以用这种方法改变大小。</p> 
<p>       接下来就该修改静态文本框的文字了。鼠标右键点击静态文本框，在右键菜单中选择 “Properties”，Properties 面板就会显示出来，在面板上修改 Caption 属性为 “被加数”，ID 修改为 IDC_SUMMAND_STATIC。此时模板如下图：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/46/c5/uBYUjKju_o.png"></p> 
<p></p> 
<h4>2.为对话框添加一个编辑框（Edit Control），用来输入被加数。</h4> 
<p>添加编辑框的过程与静态文本框类似，在Toolbox中选中Edit Control控件拖到对话框模板上，并使其与之前的静态文本框水平对齐（为了美观），然后调整其大小使之适合被加数的输入。<br> 在编辑框上点右键，仍然在右键菜单中选择“Properties”显示出属性（Properties）面板，修改其ID为IDC_SUMMAND_EDIT。此时模板如下图：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/b1/81/fRBmdlwp_o.png"></p> 
<p>3. 按照1的方法添加一个标题为“加数”的静态文本框，用于显示字符串--“加数”。并将其ID改为IDC_ADDEND_STATIC。<br> 4. 按照2的方法添加一个ID为IDC_ADDEND_EDIT的编辑框，用来输入加数。<br> 5. 按照1的方法添加一个标题为“和”的静态文本框，用于显示文字--“和”。并修改其ID为IDC_SUM_STATIC。<br> 6. 按照2的方法添加一个ID为IDC_SUM_EDIT的编辑框，用来显示最终的加和。<br> 7. 类似的添加按钮（Button）控件到对话框模板，用于在被点击后触发加法计算。修改其标题为“计算”，ID为IDC_ADD_BUTTON。</p> 
<p>到此，对话框模板如图：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/d1/03/4Hl3azXd_o.png"></p> 
<p>8.删除<strong> 确定</strong> 按钮。打开 <strong>取消</strong> 按钮的属性面板，将标题改为 “退出”，并使其与“计算”按钮水平对齐。<br> 9.根据控件的布局，适当调整整个对话框模板的大小，使其相对控件布局来说大小合适，界面美观。<br> 这样在对话框模板中就把我们在本例中需要用到的控件就添加完了。最终效果如下：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/ec/a6/VcTy0I3H_o.png"></p> 
<p>运行截图：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/a9/9b/1EPt1cxW_o.png"></p> 
<p></p> 
<p></p> 
<h3>创建对话框类</h3> 
<p>因为 程序Addition 是基于对话框的程序，所以程序自动创建了对话框模板 IDD_ADDITION_DIALOG，并自动生成了对话框类CAdditionDlg，它是从 CDialogEx 类派生的。大家用过VC++ 6.0的可能记得，我们定义的对话框类都是从CDialog类派生的，但在VS2010中，一般对话框类都是继承自CDialogEx类。</p> 
<p>如果是自己新添加的对话框模板，怎样为它创建对话框类呢？</p> 
<ul><li>1. 在Resource View的“Dialog”节点上右键，然后在右键菜单中选择“Insert Dialog”创建一个新的对话框模板，ID就使用默认的 IDD_DIALOG1 。</li><li>2. 在中间区域会显示新建的对话框模板，然后选中此对话框模板，点右键，在右键菜单中选择 Add Class。</li></ul> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/f8/31/41LIRNKL_o.png"></p> 
<p>3.选择“Add Class”后会弹出一个对话框，在对话框中“Class name”下的编辑框中写入自定义的类名就可以了，例如CMyDialog。<br> 4.最后点“Finish”完成。</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/c0/9a/ZnzJwmiI_o.png"></p> 
<p>最终你就可以在Class View中看到新生成的对话框类CMyDialog了，并且在Solution Explorer中有相应的MyDialog.h头文件和MyDialog.cpp源文件生成。CMyDialog类同样派生于CDialogEx类。<br> 注意，一般类名都以C打头，又比如，CTestDlg。</p> 
<p></p> 
<p></p> 
<h3><span style="color:#f33b45;">为对话框中的控件添加变量</span></h3> 
<p>        上面步骤中 <a href="http://www.jizhuomi.com/software/151.html" rel="nofollow" title="为对话框添加了几个控件">为对话框添加了几个控件</a>，包括三个静态文本框，三个编辑框，一个按钮控件。程序自动生成的 取消 按钮保留，作为退出按钮，而 确定 按钮删除掉了。</p> 
<p>       静态文本框只是为了说明后面紧跟的编辑框中数据的意义，是被加数、加数还是和，所以它们是不会变的，我们就不为它们添加变量了。按钮控件是用来操作的，这里也不为它们添加变量。<span style="color:#7c79e5;"><strong>编辑框中的数据可能会经常变化，有必要为它们每个控件关联一个变量。</strong></span></p> 
<p></p> 
<p>首先为被加数的编辑框 IDC_SUMMAND_EDIT 添加变量。</p> 
<ul><li>1. 在编辑框上点右键，在右键菜单中选择“Add Variable”。弹出添加成员变量的向导对话框。</li><li>2 .我们想为其添加值变量而不是控件变量，所以对话框中“Category”下的组合框中选择Value。</li><li>3. “Variable type”下的组合框此时默认选中的是“CString”，CString是字符串类，显然不能进行加法运算。我们可以选择double、float、int等。这里我们选择double，即编辑框关联一个double类型的变量。</li><li>4. 在“Variable name”中写入自定义的变量名。鸡啄米为其取名m_editSummand。</li></ul> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/e9/15/WwSL5DGP_o.png"></p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/ec/cf/mPaq4S3q_o.png"></p> 
<p>5.点“Finish”完成。</p> 
<p>注意，类的成员变量名一般以m_打头，以标识它是一个成员变量。</p> 
<p>参照此方法，再分别为加数的编辑框IDD_ADDEND_EDIT添加double型变量m_editAddend、和的编辑框IDD_SUM_EDIT添加double型变量m_editSum。</p> 
<p></p> 
<h4>对话框类的数据交换和检验</h4> 
<p>       在程序运行界面中，用户往往会改变控件的属性，例如，在编辑框中输入字符串，或者改变组合框的选中项，又或者改变复选框的选中状态等。控件的属性改变后<a href="http://www.jizhuomi.com/catalog.asp?tags=MFC" rel="nofollow" title="MFC">MFC</a>会相应修改控件关联变量的值。这种同步的改变是通过MFC为对话框类自动生成的成员函数DoDataExchange()来实现的，这也叫做对话框的数据交换和检验机制。</p> 
<p>       我们为三个编辑框添加了变量以后，在AdditionDlg.cpp 中 CAdditionDlg 的 DoDataExchange()函数的函数体中多了三条DDX_Text调用语句。下面是函数体代码和鸡啄米添加的注释。</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/a5/bb/g8m4Rr1a_o.png"></p> 
<p>       再以 Addition 程序为例简单说下数据交换机制。如果我们在程序运行界面中输入被加数，则通过CAddition的DoDataExchange()函数可以将输入的值保存到 m_editSummand 变量中，反之如果程序运行中修改了变量 m_editSummand 的值，则通过 CAddition 的 DoDataExchange() 函数也可以将新的变量值显示到被加数的编辑框中。</p> 
<p>       但是这种数据交换机制中，DoDataExchange() 并不是被自动调用的，而是需要我们在程序中调用 CDialogEx::UpdateData()函数，由 UpdateData() 函数再去自动调用 DoDataExchange()的。</p> 
<p>       <strong>CDialogEx::UpdateData() 函数的原型为：</strong><span style="color:#7c79e5;">BOOL UpdateData(BOOL bSaveAndValidate = TRUE);</span></p> 
<p>       参数：bSaveAndValidate 用于指示数据传输的方向，<span style="color:#f33b45;"><strong>TRUE 表示从 </strong></span><strong>控件</strong><span style="color:#f33b45;"><strong> 传给 </strong></span><strong>变量</strong>，<span style="color:#7c79e5;"><strong>FALSE 表示从 </strong></span><strong>变量</strong><span style="color:#7c79e5;"><strong> 传给 </strong></span><strong>控件</strong>。<span style="color:#e579b6;"><strong>默认值是 TRUE，即从 控件 传给 变量。</strong></span></p> 
<p>       返回值：CDialogEx::UpdateData()函数的返回值表示操作是否成功，成功则返回TRUE，否则返回FALSE。</p> 
<p>       在下一讲中将具体演示CDialogEx::UpdateData()函数如何使用。</p> 
<p>       鸡啄米本节主要讲的是新建对话框类和添加控件变量，控件的消息处理函数将在下一讲详细介绍。</p> 
<p></p> 
<p></p> 
<h3>为控件添加消息处理函数。</h3> 
<p> <a href="http://www.jizhuomi.com/software/153.html" rel="nofollow" title="创建对话框类和添加控件变量">创建对话框类和添加控件变量</a>在上面已经讲过，这一讲的主要内容是如何为控件添加消息处理函数。</p> 
<p></p> 
<p>       <a href="http://www.jizhuomi.com/catalog.asp?tags=MFC" rel="nofollow" title="MFC">MFC</a>为对话框和控件等定义了诸多<a href="http://www.jizhuomi.com/software/147.html" rel="nofollow" title="消息">消息</a>，我们对它们操作时会触发消息，这些消息最终由消息处理函数处理。比如我们点击按钮时就会产生 BN_CLICKED 消息，修改编辑框内容时会产生 EN_CHANGE消息等。一般为了让某种操作达到效果，我们只需要实现某个消息的消息处理函数。</p> 
<p></p> 
<h4>一.添加消息处理函数</h4> 
<p>       鸡啄米仍以前面的加法计算器的程序为例，说明怎样为“计算”按钮控件添加消息处理函数。添加方法列出4种：</p> 
<p>       </p> 
<ul><li><strong>1. 使用 Class Wizard 添加消息处理函数</strong></li></ul> 
<p>       用过的<a href="http://www.jizhuomi.com/catalog.asp?tags=VC%EF%BC%8B%EF%BC%8B" rel="nofollow" title="VC++ ">VC++ </a>6.0的朋友应该对Class Wizard很熟悉了，添加<a href="http://www.jizhuomi.com/software/49.html" rel="nofollow" title="类">类</a>、消息处理函数等经常会用到它，可以说是一个很核心的功能。但从VS2002开始就见不到Class Wizard了，大部分功能都集成到对话框和控件等的属性中了，使用很方便。到<a href="http://www.jizhuomi.com/software/27.html" rel="nofollow" title="VS2010">VS2010</a>，久违的Class Wizard又回来了。但鸡啄米已经习惯了使用属性中的功能了，对于从VC++ 6.0直接转VS2010的朋友可能觉得还是使用Class Wizard比较习惯。</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/bd/2d/9RyLPqcg_o.png"></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/1c/77/RXHXhcDL_o.png"></p> 
<p>       大家应该记得，“计算” 按钮的 ID 为 IDC_ADD_BUTTON，上图中 <strong>命令 标签</strong>下，<strong>对象 ID</strong> 列表中有此 ID，因为我们是想实现点击按钮后的消息处理函数，所以在 <strong>消息</strong> 列表中选择 <strong>BN_CLICKED</strong> 消息，然后点右上方的 <strong>添加处理程序</strong> 就可以添加BN_CLICKED 消息处理函数 OnClickedAddButton 了。当然你也可以改名，但一般用的默认的就可以。</p> 
<p></p> 
<ul><li><strong>2. 通过 “Add Event Handler...” 添加消息处理函数</strong></li></ul> 
<p>       在 “计算” 按钮上点右键，然后在右键菜单中选择菜单项“Add Event Handler...”，弹出 “Event Handler Wizard” 对话框，如下图：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/09/85/ejhNELky_o.png"></p> 
<p>可见 “消息类型” 中默认选中的就是 BN_CLICKED 消息，<strong>函数名 </strong>和 <strong>所在 类</strong> 都已经自动给出，直接点 “确定” 就可以了。</p> 
<p></p> 
<ul><li><strong>  3.在按钮的 属性视图 中 添加 消息处理函数</strong></li></ul> 
<p>       上面说过，从VS2002开始就主要从 <strong>属性视图</strong> 添加 消息处理函数了。我们在 “计算” 按钮上点右键，在右键菜单中选择“Properties”，右侧面板中会显示按钮的属性视图。</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/9e/50/OH5taXxE_o.png"></p> 
<p>       我们可以像上图中那样，点属性视图的 “<strong>控制事件</strong>” 按钮（<strong>类似 闪电标志</strong>），下面列出了 “计算” 按钮的所有消息。我们要处理的是 BN_CLICKED 消息，点其右侧空白列表项，会出现一个带下箭头的按钮，再点此按钮会出现 “&lt;Add&gt; OnBnClickedAddButton” 选项，最后选中这个选项就会自动添加 BN_CLICKED 处理函数了。</p> 
<p></p> 
<ul><li><strong> 4. 双击按钮添加消息处理函数</strong></li></ul> 
<p>       最直接最简单的方法就是，双击 “计算” 按钮，MFC会自动为其在CAdditionDlg类中添加 BN_CLICKED 消息的处理函数OnBnClickedAddButton()。</p> 
<p></p> 
<p></p> 
<h3>在消息处理函数中添加自定义功能</h3> 
<p>       在我们使用任意一种方法添加了消息处理函数以后，都只能得到一个空的OnBnClickedAddButton()函数的函数体，要实现我们想要的功能，还需要在函数体中加入自定义功能代码。</p> 
<p>       在加法计算器程序中，我们想要“计算”按钮实现的功能是，获取被加数和加数的数值，然后计算它们的和并显示到和的编辑框里。那么，OnBnClickedAddButton()的函数体就应修改为：</p> 
<pre class="has"><code class="language-cpp">void CAdditionDlg::OnClickedAddButton()
{
	// TODO: 在此添加控件通知处理程序代码

	// 将各控件中的数据保存到相应的变量   
	UpdateData(TRUE);

	// 将被加数和加数的加和赋值给m_editSum   
	m_editSum = m_editSummand + m_editAddend;

	// 根据各变量的值更新相应的控件。和的编辑框会显示m_editSum的值   
	UpdateData(FALSE);
}</code></pre> 
<p>        上面的代码中已经添加注释，大家应该很容易理解了。对于UpdateData()函数的说明在上一讲中已经介绍过，如果忘了可以再回上一讲了解了解。接下来我们运行下此应用程序。在运行结果界面中，输入被加数 1.1，加数 2.2 ，然后点“计算”：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/1e/2f/IwfOBPqh_o.png"></p> 
<p>简单分析下运行过程：输入被加数和加数，点“计算”按钮后产生点击消息，从而调用 OnBnClickedAddButton()函数。进入此函数后，首先由 UpdateData(TRUE)函数将被加数的值5.1和加数的值2.3分别保存到变量m_editSummand和m_editAddend，然后通过语句m_editSum = m_editSummand + m_editAddend;计算出被加数和加数的和为7.4，并把7.4赋值给m_editSum。最后调用UpdateData(FALSE) 根据被加数、加数、和的值更新三个编辑框的显示值，就得到了上图中的结果。</p> 
<p>       到此，一个具有简单的加法运算功能的加法计算器应用程序就基本完成了。</p> 
<p></p> 
<p></p> 
<h3>对话框上控件的Tab顺序如何调整。</h3> 
<p>上一讲为“计算”按钮<a href="http://www.jizhuomi.com/software/156.html" rel="nofollow" title="添加了消息处理函数">添加了消息处理函数</a>后，加法计算器已经能够进行浮点数的加法运算。但是还有个遗留的小问题，就是对话框控件的Tab顺序问题。</p> 
<p>       运行加法计算器程序，显示对话框后不进行任何操作，直接按回车，可以看到对话框退出了。这是因为“退出”按钮是Tab顺序为1的控件，也就是第一个接受用户输入的控件。但是按照我们的输入习惯，应该是被加数的编辑框首先接受用户输入，然后是加数编辑框，再接下来是“计算”按钮，最后才是“退出”按钮。</p> 
<p>       <strong>先直观的看看各个控件的Tab顺序</strong>：打开 “<strong>资源视图</strong>” ，然后在资源中找到对话框 IDD_ADDITION_DIALOG，双击ID后中间客户区域出现其模板视图。在主菜单中选择 “Format”-&gt;"Tab Order"，或者按快捷键Ctrl+D，对话框模板上就会显示各个控件的Tab顺序数字。如下图：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/0b/c7/KIMvqa2v_o.png"></p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/a6/1d/swkAS5FC_o.png"></p> 
<p>       上图中每个控件左上角都有一个数字，这就是它的 Tab 响应顺序。对话框刚打开时输入焦点就在Tab顺序为1的“退出”按钮上，不做任何操作按下Tab键，输入焦点就会转移到Tab顺序为2的“被加数”静态文本框上，但是因为静态文本框不接受任何输入，所以输入焦点继续自动转移到Tab顺序为3的被加数编辑框，再按Tab键，输入焦点又会转移到Tab顺序为4的“加数”静态文本框上，同样由于它是静态文本框，输入焦点不停留继续转移到加数编辑框，后面的控件同理。</p> 
<p>       我们认为这个顺序不合理，那怎么修改呢？很简单，从自己认为Tab顺序应该为1的控件开始依次单击，随着单击的完成，各控件的Tab响应顺序也按我们的想法设置好了。</p> 
<p>       例如，此例中我们可以依次单击被加数编辑框、“被加数”静态文本框、加数编辑框、“加数”静态文本框、和编辑框、“和”静态文本框、“计算”按钮和“退出”按钮。设置完后如下图：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/e5/91/CGNfICTA_o.png"></p> 
<p>最后按ESC键，确认设置并退出对话框模板的Tab顺序设置状态。</p> 
<p>       现在我们再运行程序，可以看到对话框打开后最初的输入焦点在被加数编辑框上，然后我们按Tab键，输入焦点移到加数编辑框上，继续多次按Tab键时，输入焦点会按“和编辑框--‘计算’按钮--‘退出’按钮--被加数编辑框--加数编辑框--和编辑框......”的顺序循环转移。这样就达到了我们的目的。</p> 
<p></p> 
<p></p> 
<h3>模态对话框 和 非模态对话框，以及模态对话框怎样弹出。</h3> 
<p></p> 
<p><strong>一 .</strong>  <strong>模态对话框</strong> 和 <strong>非模态对话框</strong></p> 
<p>       Windows对话框分为两类：<strong>模态对话框</strong> 和 <strong>非模态对话框</strong>。</p> 
<ol><li> <span style="color:#f33b45;"><strong>模态对话框是这样的对话框：</strong></span>当它弹出后，本应用程序其他窗口将不再接受用户输入，只有该对话框响应用户输入，在对它进行相应操作退出后，其他窗口才能继续与用户交互。</li><li> <span style="color:#f33b45;"><strong>非模态对话框：</strong></span>非模态对话框是它弹出后，本程序其他窗口仍能响应用户输入。非模态对话框一般用来显示提示信息等。</li></ol> 
<p>       大家对Windows系统很了解，相信这两种对话框应该都遇到过。之前的加法计算器对话框其实就是模态对话框。</p> 
<p></p> 
<p><strong>二 .  模态对话框是怎样弹出的</strong></p> 
<p>       毕竟加法计算器程序大部分都是MFC自动生成的，对话框怎么弹出来的大家可能还不是很清楚。鸡啄米下面简单说说它是在哪里弹出来的，再重新建一个新的对话框并弹出它，这样大家实践以后就能更灵活的使用模态对话框了。</p> 
<p>       大家打开 Addition.cpp 文件，可以看到 CAdditionApp 类有个 InitInstance() 函数，在 <a href="http://www.jizhuomi.com/software/145.html" rel="nofollow" title="MFC应用程序框架分析">MFC应用程序框架分析</a> 中提到过此函数，不过那是单文档应用程序 App类 中的，函数体不太相同，但都是进行App类实例的初始化工作。</p> 
<p>       InitInstance() 函数的 <strong>后半部分有一段代码就是定义对话框对象并弹出对话框的</strong>，鸡啄米下面给出这段代码并加以注释：</p> 
<pre class="has"><code class="language-cpp">CAdditionDlg dlg;                  // 定义对话框类CAdditionDlg的对象dlg   
m_pMainWnd = &amp;dlg;                 // 将dlg设为主窗口   
INT_PTR nResponse = dlg.DoModal(); // 弹出对话框dlg，并将DoModal函数的返回值（退出时点击按钮的ID）赋值给nResponse   
if (nResponse == IDOK)             // 判断返回值是否为OK按钮（其ID为IDOK，鸡啄米已经将它删除）   
{
	// TODO: 在此放置处理何时用
	//  “确定”来关闭对话框的代码
}
else if (nResponse == IDCANCEL)   // 判断返回值是否为Cancel按钮（其ID为IDCANCEL，鸡啄米将它的Caption改为了“退出”）   
{
	// TODO: 在此放置处理何时用
	//  “取消”来关闭对话框的代码
}
else if (nResponse == -1)
{
	TRACE(traceAppMsg, 0, "警告: 对话框创建失败，应用程序将意外终止。\n");
	TRACE(traceAppMsg, 0, "警告: 如果您在对话框上使用 MFC 控件，则无法 #define _AFX_NO_MFC_CONTROLS_IN_DIALOGS。\n");
}</code></pre> 
<p>弹出对话框比较关键的一个函数，就是对话框类的 DoModal() 函数。CDialog::DoModal() 函数的原型为：</p> 
<p>       virtual INT_PTR DoModal(); 　　</p> 
<p>       返回值：整数值，指定了传递给CDialog::EndDialog（该函数用于关闭对话框）的nResult参数值。如果函数不能创建对话框，则返回-1；如果出现其它错误，则返回IDABORT。</p> 
<p>       调用了它，对话框就会弹出，返回值是退出对话框时所点的按钮的 ID，比如，我们点了“退出”按钮，那么 DoModal 返回值为IDCANCEL。</p> 
<p></p> 
<p><strong> 三 .  添加一个新对话框并弹出它</strong></p> 
<p>为加法计算器程序添加一个对话框，在计算之前询问用户是否要进行计算。大家可以完整的看下对话框的添加和弹出过程。</p> 
<p>       1.在 Resource View 中的 “Dialog” 上点右键选择 “Insert Dialog”，创建一个新的对话框模板，修改其ID为IDD_TIP_DIALOG，Caption改为“提示”，然后参考 “<a href="http://www.jizhuomi.com/software/151.html" rel="nofollow" title="为对话框添加控件">为对话框添加控件</a>” 中所讲，在对话框模板上添加一个静态文本框（static text），Caption改为“您确定要进行加法计算吗？”，接下来修改OK按钮的Caption为“确定”，Cancel按钮的Caption为“取消”，最后调整各个控件的位置和对话框的大小。最终的对话框模板如下图：</p> 
<p style="text-align:center;"><img alt="VS2010/MFC编程入门之十一（对话框：模态对话框及其弹出过程）" class="has" src="https://images2.imgbox.com/8d/6c/j2vkEKHd_o.png"></p> 
<p>       2.根据“<a href="http://www.jizhuomi.com/software/153.html" rel="nofollow" title="创建对话框类和添加控件变量">创建对话框类和添加控件变量</a>”中创建对话框类的方法，在对话框模板上点右键选择“Add Class...”，弹出添加类的对话框，设置“Class name”为CTipDlg，点“OK”。在Solution Explorer中可以看到生成了CTipDlg类的头文件TipDlg.h和源文件TipDlg.cpp。</p> 
<p>       3.我们要在点“计算”按钮之后弹出此提示对话框，那么就要在“计算”按钮的消息处理函数OnBnClickedAddButton()中访问提示对话框类，所以为了访问CTipDlg类，在AdditionDlg.cpp中包含CTipDlg的头文件：#include "CTipDlg.h"。</p> 
<p>       4.修改OnBnClickedAddButton()的函数体，在所有代码前，构造CTipDlg类的对象tipDlg，并通过语句tipDlg.DoModal();弹出对话框，最后判断DoModal()函数的返回值是IDOK还是IDCANCEL来确定是否继续进行计算。OnBnClickedAddButton()函数修改后如下：</p> 
<pre class="has"><code class="language-cpp">void CAdditionDlg::OnClickedAddButton()
{
	// TODO: Add your control notification handler code here   
	INT_PTR nRes;             // 用于保存DoModal函数的返回值   

	CTipDlg tipDlg;           // 构造对话框类CTipDlg的实例   
	nRes = tipDlg.DoModal();  // 弹出对话框   
	if (IDCANCEL == nRes)     // 判断对话框退出后返回值是否为IDCANCEL，如果是则return，否则继续向下执行   
		return;

	// 将各控件中的数据保存到相应的变量   
	UpdateData(TRUE);

	// 将被加数和加数的加和赋值给m_editSum   
	m_editSum = m_editSummand + m_editAddend;

	// 根据各变量的值更新相应的控件。和的编辑框会显示m_editSum的值   
	UpdateData(FALSE);
}</code></pre> 
<p>       5.测试。编译运行程序后，在对话框上输入被加数和加数，点“计算”，弹出提示对话框询问是否进行计算，如果选择“确定”，则提示对话框退出，并在主对话框上显示被加数和加数的和，而如果选择“取消”，则提示对话框也会退出，但主对话框显示的和不变，即没有进行加法计算。</p> 
<p></p> 
<p></p> 
<h3>非模态对话框的创建及显示。</h3> 
<p></p> 
<p>总结：主要步骤是，创建新对话框后，关联一个类，然后用一个指针指向该类；接着用该指针创建对话框和显示对话框，最后在虚构函数中销毁该指针，释放资源。</p> 
<p>       <span style="color:#7c79e5;"><strong> 非模态对话框显示后，程序其他窗口仍能正常运行，可以响应用户输入，还可以相互切换</strong></span>。将上一讲中创建的Tip模态对话框改为非模态对话框，让大家看下效果。</p> 
<p>       实际上，<strong>模态对话框</strong> 和 <strong>非模态对话框</strong> 在创建对话框资源和生成对话框类上是没有区别的，所以上一讲中创建的IDD_TIP_DIALOG对话框资源和 CTipDlg 类都不需要修改。</p> 
<p>       需要修改的是，对话框类实例的创建和显示，也就是之前在 CAdditionDlg::OnBnClickedAddButton() 函数体中添加的对话框显示代码。下面是具体步骤：</p> 
<ul><li>1. 在 AdditionDlg.h 中包含 CTipDlg 头文件并定义 CTipDlg类型的指针成员变量。详细操作方法是，在 AdditionDlg.cpp中删除之前添加的 #include "CTipDlg.h"，而在 AdditionDlg.h 中添加 #include "CTipDlg.h"，这是因为我们需要在AdditionDlg.h 中定义 CTipDlg 类型的 指针变量，所以要先包含它的头文件；然后在 AdditionDlg.h 中为 CAdditionDlg类添加 private 成员变量 CTipDlg  *m_pTipDlg; 。</li><li>2. 在CAdditionDlg类的<a href="http://www.jizhuomi.com/software/51.html" rel="nofollow" title="构造函数">构造函数</a>中初始化成员变量m_pTipDlg。如果cpp文件中函数太多，我们可以在Class View上半个视图中找到CAdditionDlg类，再在下半个视图中找到其构造函数双击，中间客户区域即可马上切到构造函数的实现处。在构造函数体中添加m_pTipDlg = NULL;，这是个好习惯，鸡啄米在C++编程入门系列的<a href="http://www.jizhuomi.com/software/78.html" rel="nofollow" title="指针的赋值和指针运算">指针的赋值和指针运算</a>中说到过，在任何指针变量使用前都初始化，可以避免因误访问重要内存地址而破坏此地址的数据。</li><li>3. 将上一讲中添加的模态对话框显示代码注释或删除掉，添加非模态对话框的创建和显示代码。VC++中注释单行代码使用“//”，注释多行代码可以在需注释的代码开始处添加“/*”，结束处添加“*/”。修改后的CAdditionDlg::OnBnClickedAddButton()函数如下：</li></ul> 
<pre class="has"><code class="language-cpp">void CAdditionDlg::OnClickedAddButton()
{
	// TODO: Add your control notification handler code here   
	 /*INT_PTR nRes;             // 用于保存DoModal函数的返回值

	 CTipDlg tipDlg;           // 构造对话框类CTipDlg的实例
	 nRes = tipDlg.DoModal();  // 弹出对话框
	 if (IDCANCEL == nRes)     // 判断对话框退出后返回值是否为IDCANCEL，如果是则return，否则继续向下执行
		 return;*/

	// 如果指针变量m_pTipDlg的值为NULL，则对话框还未创建，需要动态创建   
	if (NULL == m_pTipDlg)
	{
		// 创建非模态对话框实例   
		m_pTipDlg = new CTipDlg();
		m_pTipDlg-&gt;Create(IDD_TIP_DIALOG, this);
	}
	// 显示非模态对话框   
	m_pTipDlg-&gt;ShowWindow(SW_SHOW);

	// 将各控件中的数据保存到相应的变量   
	UpdateData(TRUE);

	// 将被加数和加数的加和赋值给m_editSum   
	m_editSum = m_editSummand + m_editAddend;

	// 根据各变量的值更新相应的控件。和的编辑框会显示m_editSum的值   
	UpdateData(FALSE);
}</code></pre> 
<p>  这样，非模态对话框创建和显示的代码就添加修改完了。让我们运行下看看效果吧。</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/f3/27/0OQbG7s0_o.png"></p> 
<p>      在加法计算器对话框上输入被加数和加数，然后点“计算”按钮，依然像上节一样弹出了提示对话框，但是先不要关闭它，你可以拖动它后面的加法计算器对话框试试，我们发现加法计算器对话框竟然可以拖动了，而且“和”编辑框里已经显示了运算结果，这表明提示对话框显示以后还没有关闭，OnBnClickedAddButton() 就继续向下执行了，不仅如此，加法计算器的每个编辑框还都可以响应输入。</p> 
<p>这只是一个简单的例子，非模态对话框的用处有很多，以后大家在软件开发中会用到。</p> 
<p></p> 
<p></p> 
<h3>属性页对话框</h3> 
<p></p> 
<p><strong>属性页对话框的分类</strong></p> 
<p>属性页对话框想必大家并不陌生，XP系统中桌面右键点属性，弹出的就是属性页对话框，它通过标签切换各个页面。另外，我们在创建MFC工程时使用的向导对话框也属于属性页对话框，它通过点击“Next”等按钮来切换页面。<br> 属性页对话框就是包含一般属性页对话框和向导对话框两类。它将多个对话框集成于一身，通过标签或按钮来切换页面。<br> 属性页对话框相关类</p> 
<p>我们使用属性页对话框时，用到的类主要有两个：CPropertyPage类 和 CPropertySheet 类。</p> 
<p></p> 
<p><strong> 1.CPropertyPage 类</strong></p> 
<p>       CPropertyPage类继承自CDialog类，它被用于处理某单个的属性页，所以要为每个属性页都创建一个继承自CPropertyPage的子类。大家可以在<a href="http://www.jizhuomi.com/software/139.html" rel="nofollow" title="VS2010的MSDN">VS2010的MSDN</a>中查找CPropertyPage类以及它的成员的详细说明。下面鸡啄米就为大家讲解MSDN中列出的CPropertyPage类的部分主要成员函数。</p> 
<pre class="has"><code>（1）构造函数
        这里讲三个CProperty类的构造函数，函数原型为：
        CPropertyPage( );

        explicit CPropertyPage(
                UINT nIDTemplate,
                UINT nIDCaption = 0,
                DWORD dwSize = sizeof(PROPSHEETPAGE)
        );

        explicit CPropertyPage(
                LPCTSTR lpszTemplateName,
                UINT nIDCaption = 0,
                DWORD dwSize = sizeof(PROPSHEETPAGE)
        );

       第一个是没有任何参数的构造函数。
       第二个构造函数中，参数nIDTemplate是属性页的对话框资源ID，
                        参数nIDCaption是属性页对话框选项卡的标题所用字符串资源的ID，
                        若设为0，则选项卡标题就使用该属性页的对话框资源的标题。

       第三个构造函数中，参数lpszTemplateName为属性页的对话框资源的名称字符串，
                        不能为NULL。参数nIDCaption同上。

（2）CancelToClose()函数
       在模态属性页对话框的属性页进行了某不可恢复的操作后，使用CancelToClose() 函数
       将“OK”按钮改为“Close”按钮，并禁用“Cancel”按钮。函数原型为：
       void CancelToClose( );

（3）SetModified()函数
       调用此函数可激活或禁用“Apply”按钮，函数原型为：
       void SetModified(BOOL bChanged = TRUE);

（4）可重载函数
       CPropertyPage类提供了一些消息处理函数，来响应属性页对话框的各种消息。
       我们重载这些消息处理函数，就可以自定义对属性页对话框操作的处理。
       可重载的消息处理函数包括：
       OnApply：处理属性页的“Apply”按钮被单击的消息
       OnCancel：处理属性页的“Cancel”按钮被单击的消息
       OnKillActive：处理属性页当前活动状态被切换的消息，常用于数据验证
       OnOK：处理属性页的“OK”按钮、“Apply”按钮或者“Close”按钮被单击的消息
       OnQueryCancel：处理属性页的“Cancel”按钮被单击前发出的消息
       OnReset：处理属性页的“Reset”按钮被单击的消息
       OnSetActive：处理属性页被切换为当前活动页的消息
       OnWizardBack：处理属性页的“Back”按钮被单击的消息，仅在向导对话框中有效
       OnWizardFinish：处理属性页的“Finish”按钮被单击的消息，仅在向导对话框中有效
       OnWizardNext：处理属性页的“Next”按钮被单击的消息，仅在向导对话框中有效</code></pre> 
<p></p> 
<p>2.CPropertySheet类</p> 
<p>       CPropertySheet类继承自CWnd类，它是属性表类，负责加载、打开或删除属性页，并可以在属性页对话框中切换属性页。它跟对话框类似，也有模态和非模态两种。下面鸡啄米就讲解CPropertySheet类的部分成员函数。</p> 
<pre class="has"><code>（1）构造函数
       这里依然列出CPropertySheet类的三个构造函数：
       CPropertySheet( );

       explicit CPropertySheet(
               UINT nIDCaption,
               CWnd* pParentWnd = NULL,
               UINT iSelectPage = 0 
       );

       explicit CPropertySheet(
               LPCTSTR pszCaption,
               CWnd* pParentWnd = NULL,
               UINT iSelectPage = 0 
       );

       参数 nIDCaption：标题的字符串资源的ID。
       参数 pParentWnd：属性页对话框的父窗口，若设为NULL，则父窗口为应用程序的主窗口。
       参数 iSelectPage：初始状态时，活动属性页的索引，默认为第一个添加到属性表的属性页。
       参数 pszCaption：标题字符串。

（2）GetActiveIndex()函数
       获取当前活动属性页的索引。函数原型为：
       int GetActiveIndex( ) const;
       返回值：当前活动属性页的索引。

（3）GetActivePage()函数
       获取当前活动属性页对象。函数原型为：
       CPropertyPage* GetActivePage( ) const;
       返回值：当前活动属性页对象的指针。

（4）GetPage()函数
       获取某个属性页对象。函数原型为：
       CPropertyPage* GetPage(int nPage) const;
       参数nPage：目标属性页的索引。
       返回值：目标属性页对象的指针。

（5）GetPageCount()函数
       获取属性页的数量。函数原型为：
       int GetPageCount( ) const;
       返回值：属性页的数量。

（6）GetPageIndex()函数
       获取某属性页在属性页对话框中的索引。函数原型为：
       int GetPageIndex(CPropertyPage* pPage);
       参数pPage：要获取索引的属性页对象的指针。
       返回值：属性页对象在属性页对话框中的索引。

（7）SetActivePage()函数
       设置某个属性页为活动属性页。函数原型为：   
       BOOL SetActivePage(
                 int nPage 
       );

       BOOL SetActivePage(
                 CPropertyPage* pPage 
       );
       参数 nPage：要设置为活动属性页的索引。
       参数 pPage：要设置为活动属性页的对象指针。

（8）SetWizardButtons()函数
       在向导对话框上启用或禁用Back、Next或Finish按钮，应在调用DoModal之前调用此函数。
       函数原型为：
       void SetWizardButtons(
                DWORD dwFlags 
       );

       参数dwFlags：设置向导按钮的外观和功能属性。可以是以下值的组合：
       PSWIZB_BACK                    启用“Back”按钮，如果不包含此值则禁用“Back”按钮。
       PSWIZB_NEXT                    启用“Next”按钮，如果不包含此值则禁用“Next”按钮。
       PSWIZB_FINISH                  启用“Finish”按钮。
       PSWIZB_DISABLEDFINISH   显示禁用的“Finish”按钮。

（9）SetWizardMode()函数
       设置属性页对话框为向导对话框模式，应在调用DoModal之前调用此函数。函数原型为：
       void SetWizardMode( );

（10）SetTitle()函数
       设置属性对话框的标题。函数原型为：
       void SetTitle(
               LPCTSTR lpszText,
               UINT nStyle = 0 
       );
       参数lpszText：标题字符串。
       参数nStyle：指定属性表标题的风格。应当为 0 或 PSH_PROPTITLE。
                   如果设为PSH_PROPTITLE，则单词“Properties”会出现在指定标题之后。
       例如，SetTitle("Simple",PSH_PROPTITLE)这种调用会使得属性表标题为 “Simple Properties”。

（11）AddPage()函数
       为属性对话框添加新的属性页。函数原型为：
       void AddPage(
               CPropertyPage *pPage 
       );
       参数pPage：要添加的新的属性页的对象指针。

（12）PressButton()函数
       模拟按下某指定的按钮。函数原型为：   
       void PressButton(
               int nButton 
       );
       参数nButton：要模拟按下的按钮，它可以是下列值之一：
       PSBTN_BACK   选择“Back”按钮。 
       PSBTN_NEXT   选择“Next”按钮。
       PSBTN_FINISH   选择“Finish”按钮。
       PSBTN_OK   选择“OK”按钮。
       PSBTN_APPLYNOW   选择“Apply”按钮。
       PSBTN_CANCEL   选择“Cancel”按钮。
       PSBTN_HELP   选择“帮助”按钮。

（13）RemovePage()函数
       删除某属性页。函数原型为：
       void RemovePage(
               CPropertyPage *pPage 
       );

       void RemovePage(
               int nPage 
       );

       参数pPage：要删除的属性页的对象指针。
       参数nPage：要删除的属性页的索引。</code></pre> 
<p>       属性对话框和相关的两个类鸡啄米就先介绍到这，主要是为后面使用属性页对话框做准备。</p> 
<p></p> 
<p></p> 
<h3>创建向导对话框</h3> 
<p></p> 
<p>       仍然以前面的“加法计算器”的例子为基础，在其中加入向导对话框，我们可以用它来说明加法计算器的使用方法，一步一步引导用户操作，这也是比较常见的用法。</p> 
<p>       加法计算器使用时大概可以分为三步：输入被加数、输入加数、点“计算”按钮。</p> 
<p>       鸡啄米就详细说明向导对话框的创建步骤：</p> 
<p></p> 
<p><strong>1. 创建属性页对话框资源</strong></p> 
<p>       根据<a href="http://www.jizhuomi.com/software/149.html" rel="nofollow" title="创建对话框模板和修改对话框属性">创建对话框模板和修改对话框属性</a>中所讲方法，在“Resource View”的Dialog”节点上点右键，然后在右键菜单中选择“Insert Dialog”创建第一个对话框模板，对话框的ID属性设置为IDD_SUMMAND_PAGE，Caption属性改为“被加数页”，Style属性在下拉列表中选择“Child”，Border属性在下拉列表中选择“Thin”。</p> 
<p>       删除“OK”和“Cancel”按钮，再按照<a href="http://www.jizhuomi.com/software/151.html" rel="nofollow" title="为对话框添加控件">为对话框添加控件</a>中所讲方法，添加一个静态文本框，并修改静态文本框的Caption属性为“请先输入double型被加数”。</p> 
<p>       按照上述步骤，继续添加第二个和第三个对话框资源。第二个对话框模板的ID设为IDD_ADDEND_PAGE，Caption属性改为“加数页”，也添加一个静态文本框，Caption设为“请继续输入double型加数”，其他属性同第一个对话框。第三个对话框模板的ID设为IDD_ADD_PAGE，Caption属性改为“计算页”，添加静态文本框的Caption属性改为“最后请按下“计算”按钮”，其他属性也第一个对话框一样。</p> 
<p></p> 
<p><strong>2. 创建属性页类</strong></p> 
<p>       按照<a href="http://www.jizhuomi.com/software/153.html" rel="nofollow" title="创建对话框类和添加控件变量">创建对话框类和添加控件变量</a>中的方法，在第一个对话框模板上点右键，在右键菜单中选择“Add Class”，弹出类向导对话框，在“Class name”编辑框中输入类名“CSummandPage”，与之前不同的是，因为属性页类都应继承于CPropertyPage类，所以要修改下面“Base class”的选项，在下拉列表中选择“CPropertyPage”。</p> 
<p>       因为是第一个属性页，所以它应该有一个“下一步”按钮，在哪里添加呢？上一讲<a href="http://www.jizhuomi.com/software/164.html" rel="nofollow" title="CPropertyPage类的可重载函数">CPropertyPage类的可重载函数</a>中提到，OnSetActive函数用于处理属性页被切换为当前活动页的消息，所以我们可以在OnSetActive函数中进行相关设置。</p> 
<p>       那怎样重载OnSetActive函数呢？我们可以在“Class View”中找到“CSummandPage”节点，点右键弹出右键菜单，选择“Properties”，然后VS2010右侧面板上会显示对话框的属性列表，属性列表的工具栏上有个tip信息为“Overrides”的按钮，按下它，下方列表中就列出了重载函数，找到“OnSetActive”，点其右侧空白列表项出现向下箭头，再点箭头就在下面出现了“&lt;Add&gt;OnSetActive”的选项，选择它就会自动在CSummandPage类中添加函数OnSetActive。</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/4e/c3/y8kcIPtG_o.png"></p> 
<p>   我们只需在OnSetActive函数体中添加相关代码就可以实现添加“下一步”按钮的效果了。新的函数体如下：</p> 
<pre class="has"><code class="language-cpp">BOOL CSummandPage::OnSetActive()   
{   
    // TODO: Add your specialized code here and/or call the base class  
  
    // 获得父窗口，即属性表CPropertySheet类   
    CPropertySheet* psheet = (CPropertySheet*) GetParent();   
    // 设置属性表只有“下一步”按钮   
    psheet-&gt;SetWizardButtons(PSWIZB_NEXT);   
  
    return CPropertyPage::OnSetActive();   
}  </code></pre> 
<p>       为第二个和第三个对话框也分别添加属性页类CAddendPage和CAddPage。但第二个对话框的属性页不需要重载OnSetActive函数。第三个对话框是最后一个对话框，所以不需要“下一步”按钮，而应该换成“完成”按钮，所以也需要重载OnSetActive函数设置“完成”按钮。重载后的OnSetActive如下：</p> 
<pre class="has"><code class="language-cpp">BOOL CAddPage::OnSetActive()   
{   
    // TODO: Add your specialized code here and/or call the base class  
  
    // 获得父窗口，即属性表CPropertySheet类   
    CPropertySheet* psheet = (CPropertySheet*) GetParent();   
    //设置属性表只有“完成”按钮   
    psheet-&gt;SetFinishText(_T("完成"));   
  
    return CPropertyPage::OnSetActive();   
}  </code></pre> 
<p>       上面的代码段中，字符串“完成”前加了个_T，这是因为本工程创建的时候用的默认的Unicode字符集，而如果“完成”前不加_T就是ASCII字符串。_T实际上是一个宏，工程的字符集选择为Unicode时字符串就转为Unicode字符串，选择为Muli-Byte时就转为ASCII字符串。我们可以在Solution Explorer的Addition根节点上点右键，在右键菜单上选择“Properties”，弹出工程的属性对话框，Configuration Properties-&gt;General右侧列表中的Character Set就显示选择的字符集。</p> 
<p>       那点了第三个属性页上的“完成”按钮我们想进行某些处理的话，就重载OnWizardFinish函数，方法同OnSetActive函数。重载后的OnWizardFinish函数如下：</p> 
<pre class="has"><code class="language-cpp">BOOL CAddPage::OnWizardFinish()   
{   
    // TODO: Add your specialized code here and/or call the base class  
  
    // 提示向导完成   
    MessageBox(_T("使用说明向导已阅读完！"));   
  
    return CPropertyPage::OnWizardFinish();   
}  </code></pre> 
<p></p> 
<p><strong>3. 创建属性表类</strong></p> 
<p>       属性页资源和属性页类创建完以后，还不能生成向导对话框，我们还需要一个属性表类，来容纳这些属性页。</p> 
<p>       在Solution Explorer视图中的根节点“Addition”上点右键，在右键菜单中选择Add-&gt;Class，弹出“Add Class”对话框，然后在中间区域中选择“MFC Class”，点“Add”按钮，弹出另一个类向导对话框，设置Class name为CAddSheet，Base class选择“CPropertySheet”，点“Finish”按钮，这样就属性表类就建好了。</p> 
<p>       接下来，在新生成的AddSheet.h中包含三个属性页类的头文件：</p> 
<p>       #include "SummandPage.h"<br>        #include "AddendPage.h"<br>        #include "AddPage.h"</p> 
<p>       之后在AddSheet.h中添加private变量：</p> 
<p>       CSummandPage    m_summandPage;C<br>        CAddendPage     m_addendPage;<br>        CAddPage        m_addPage;</p> 
<p>       然后在AddSheet.cpp文件中修改CAddSheet的两个构造函数为：</p> 
<pre class="has"><code>CAddSheet::CAddSheet(UINT nIDCaption, CWnd* pParentWnd, UINT iSelectPage)   
    :CPropertySheet(nIDCaption, pParentWnd, iSelectPage)   
{   
    // 添加三个属性页到属性表   
    AddPage(&amp;m_summandPage);   
    AddPage(&amp;m_addendPage);   
    AddPage(&amp;m_addPage);   
}   
  
CAddSheet::CAddSheet(LPCTSTR pszCaption, CWnd* pParentWnd, UINT iSelectPage)   
    :CPropertySheet(pszCaption, pParentWnd, iSelectPage)   
{   
    // 添加三个属性页到属性表   
    AddPage(&amp;m_summandPage);   
    AddPage(&amp;m_addendPage);   
    AddPage(&amp;m_addPage);   
}  </code></pre> 
<p></p> 
<p><strong>4. 显示向导对话框</strong></p> 
<p>        我们在加法计算器对话框上添加一个按钮，点击它就打开向导对话框。此按钮的ID设为IDC_INSTRUCT_BUTTON，Caption属性设为“使用说明”。</p> 
<p>        按照<a href="http://www.jizhuomi.com/software/156.html" rel="nofollow" title="为控件添加消息处理函数">为控件添加消息处理函数</a>中所讲方法，为IDC_INSTRUCT_BUTTON按钮在CAdditionDlg类中添加点击消息的处理函数OnBnClickedInstructButton。然后在AdditionDlg.cpp文件中包含CAddSheet的头文件：#include "AddSheet.h"。最后修改OnBnClickedInstructButton函数如下：</p> 
<pre class="has"><code class="language-cpp">void CAdditionDlg::OnBnClickedInstructButton()   
{   
    // TODO: Add your control notification handler code here   
  
    // 创建属性表对象   
    CAddSheet sheet(_T(""));   
    // 设置属性对话框为向导对话框   
    sheet.SetWizardMode();   
    // 打开模态向导对话框   
    sheet.DoModal();   
}  </code></pre> 
<p>到此，向导对话框就完整的创建完成了，并可以在加法计算器对话框上点 “使用说明” 按钮显示出来。我们来看看效果吧：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/c2/92/BZsa3WTq_o.png"></p> 
<p>       上图只是被加数页的效果，点其上“下一步”按钮就可以继续显示后面的两个页面。</p> 
<p>       是不是向导对话框没有以前想象的那般复杂了？大家可以发挥想象，进行更复杂的修改，实现更完善的功能。依然欢迎朋友们到鸡啄米博客来交流学习。</p> 
<p></p> 
<p></p> 
<h3>属性页对话框的创建和显示</h3> 
<p></p> 
<p>属性页对话框包括向导对话框和一般属性页对话框两类，上一节鸡啄米讲了<a href="http://www.jizhuomi.com/software/166.html" rel="nofollow" title="如何创建并显示向导对话框">如何创建并显示向导对话框</a>，本节将继续介绍一般属性页对话框的创建和显示。</p> 
<p>       实际上，一般属性页对话框的创建和显示过程和向导对话框是很类似的。鸡啄米将上一节中的向导对话框进行少量修改，使其成为一般属性页对话框。</p> 
<p>       一般属性页对话框的创建步骤：</p> 
<p>      <strong> 1. 创建属性页对话框资源</strong></p> 
<p>       属性页对话框资源的创建方法同向导对话框是一样的，上一讲中的对话框资源不需进行任何修改。</p> 
<p>       <strong>2. 创建属性页类</strong></p> 
<p>       属性页类的创建和向导对话框的属性页类也基本一样，只是一般属性页对话框中不需要“下一步”和“完成”等按钮，所以上一讲中属性页类的OnSetActive和OnWizardFinish等重载函数可以去掉。即CSummandPage类中的OnSetActive函数、CAddPage类中的OnSetActive函数和OnWizardFinish函数可以删除或注释掉。其他部分不需作任何修改。</p> 
<p>       <strong>3. 创建属性表类</strong></p> 
<p>       创建属性表类的过程同向导对话框属性表类也是一样的，所以上一讲中的CAddSheet类不需修改。</p> 
<p>       <strong>4. 显示一般属性页对话框</strong></p> 
<p>       上一讲向导对话框的显示是在OnBnClickedInstructButton函数中实现的，其中语句sheet.SetWizardMode();旨在设置属性表为向导对话框模式，所以显示一般属性页对话框时不需调用SetWizardMode成员函数。另外，我们可以将属性页对话框的标题设为“使用说明”，在构造属性表对象时将此字符串作为<a href="http://www.jizhuomi.com/software/51.html" rel="nofollow" title="构造函数">构造函数</a>的参数传入。OnBnClickedInstructButton函数修改如下：</p> 
<pre class="has"><code class="language-cpp">void CAdditionDlg::OnBnClickedInstructButton()   
{   
    // TODO: Add your control notification handler code here   
  
    // 创建属性表对象   
    CAddSheet sheet(_T("使用说明"));   
       
    // 打开模态一般属性页对话框   
    sheet.DoModal();   
}  </code></pre> 
<p>这样一般属性页对话框的创建和显示就讲完了，我们运行下程序，在结果对话框上点“使用说明”按钮看看效果吧：</p> 
<p style="text-align:center;"><img alt="VS2010/MFC编程入门之十五（对话框：一般属性页对话框的创建及显示）" class="has" src="https://images2.imgbox.com/53/1d/pptOozNy_o.png"></p> 
<p>    再总结下，一般属性页对话框和向导对话框的创建和显示的不同包括：<strong>是否需要OnSetActive和OnWizardFinish等重载函数，是否需要调用属性表类的SetWizardMode函数设置为向导对话框模式。</strong></p> 
<p></p> 
<p></p> 
<h3>消息对话框</h3> 
<p></p> 
<p>前面几节鸡啄米讲了<a href="http://www.jizhuomi.com/software/164.html" rel="nofollow" title="属性页对话框">属性页对话框</a>，我们可以根据所讲内容方便的建立自己的属性页对话框。本节讲解Windows系统中最常用最简单的一类对话框--消息对话框。</p> 
<p>       我们在使用Windows系统的过程中经常会见到消息对话框，提示我们有异常发生或提出询问等。因为在软件开发中经常用到消息对话框，所以MFC提供了两个函数可以直接生成指定风格的消息对话框，而不需要我们在每次使用的时候都要去创建对话框资源和生成对话框类等。这两个函数就是CWnd类的成员函数MessageBox()和全局函数AfxMessageBox()。</p> 
<p></p> 
<h4><strong>一 .  </strong><strong>CWnd::MessageBox()函数 和 AfxMessageBox()函数的用法</strong></h4> 
<p>       下面鸡啄米就分别讲解两个函数的用法。</p> 
<p>       <strong>1 . CWnd::MessageBox()函数</strong></p> 
<p>       CWnd::MessageBox()的函数原型如下：     </p> 
<pre class="has"><code> int MessageBox(
           LPCTSTR lpszText,
           LPCTSTR lpszCaption = NULL,
           UINT nType = MB_OK
       );

       参数说明：
       lpszText：需要显示的消息字符串。
       lpszCaption：消息对话框的标题字符串。默认值为NULL。取值为NULL时使用默认标题。
       nType：消息对话框的风格和属性。默认为 MB_OK 风格，即只有“确定”按钮。
              nType 的取值可以是下面两个表中任取一个值，也可以是各取一个值的任意组合。
              即可以指定一个对话框类型，也可以指定一个对话框图标，还可以两者都设定。</code></pre> 
<p>nType 的取值可以是下面两个表中任取一个值，也可以是各取一个值的任意组合。即可以指定一个对话框类型，也可以指定一个对话框图标，还可以两者都设定。下面表格是 <strong>对话框类型表</strong></p> 
<table align="center" border="1" cellpadding="1" cellspacing="1" style="width:400px;"><tbody><tr><td>nType 取值</td><td>参数说明</td></tr><tr><td>MB_ABORTRETRY</td><td>有“终止”、“重试”和“忽略”按钮</td></tr><tr><td>MB_OK</td><td>有“确定”按钮</td></tr><tr><td>MB_OKCANCEL</td><td>有“确定”和“取消”按钮</td></tr><tr><td>MB_RETRYCANCEL</td><td>有“重试”和“取消”按钮</td></tr><tr><td>MB_YESNO</td><td>有“是”和“否”按钮</td></tr><tr><td>MB_YESNOCANCEL</td><td>有“是”、“否”和“取消”按钮</td></tr></tbody></table> 
<p>下面表格是  <strong>对话框图标表</strong></p> 
<table align="center" border="1" cellpadding="1" cellspacing="1" style="width:400px;"><tbody><tr><td>nType 取值</td><td>显示图标</td></tr><tr><td>MB_ICONEXCLAMTION<br> MB_ICONWARNING</td><td><img alt="VS2010/MFC编程入门之十六（对话框：消息对话框）" class="has" src="https://images2.imgbox.com/58/0e/kGAQmroB_o.gif"></td></tr><tr><td>MB_ICONASTERISK<br> MB_ICONINFORMATION</td><td><img alt="VS2010/MFC编程入门之十六（对话框：消息对话框）" class="has" src="https://images2.imgbox.com/c3/33/8L1z6IJN_o.gif"></td></tr><tr><td>MB_ICONQUESTION</td><td><img alt="VS2010/MFC编程入门之十六（对话框：消息对话框）" class="has" src="https://images2.imgbox.com/b0/54/LSTm5RnP_o.gif"></td></tr><tr><td>MB_ICONHAND<br> MB_ICONSTOP<br> MB_ICONERROR</td><td><img alt="VS2010/MFC编程入门之十六（对话框：消息对话框）" class="has" src="https://images2.imgbox.com/b7/d4/eZnlBsoH_o.gif"></td></tr></tbody></table> 
<p>       如果想要设置nType的值为类型和图标的组合，可以像这样取值：MB_OKCANCEL | MB_ICONQUESTION。按位取或就可以了。</p> 
<p></p> 
<p>       <strong>2 . AfxMessageBox()函数</strong></p> 
<p>       AfxMessageBox()的函数原型为：</p> 
<pre class="has"><code>       int AfxMessageBox(
           LPCTSTR lpszText,
           UINT nType = MB_OK,
           UINT nIDHelp = 0
       );

       参数说明：
       lpszText：同CWnd::MessageBox()函数
       nType：CWnd::MessageBox()函数
       nIDHelp：此消息的帮助的上下文ID。默认值为0，取0时表示要使用应用程序的默认帮助上下文。</code></pre> 
<p></p> 
<h4><strong>二 . </strong><strong>CWnd::MessageBox() 和 AfxMessageBox() 的返回值</strong></h4> 
<p><strong>      </strong>我们在调用了上面两个函数后，都可以弹出模态消息对话框。消息对话框关闭后，我们也都可以得到它们的返回值。两者的返回值就是用户在消息对话框上单击的按钮的ID，可以是以下值：</p> 
<p>      IDABORT：单击“终止”按钮。<br>       IDCANCEL：单击“取消”按钮。<br>       IDIGNORE：单击“忽略”按钮。<br>       IDNO：单击“否”按钮。<br>       IDOK：单击“确定”按钮。<br>       IDRETRY：单击“重试”按钮。<br>       IDYES：单击“是”按钮。</p> 
<p></p> 
<h4><strong>三 . </strong><strong>应用举例</strong></h4> 
<p><strong>     </strong>我们还是拿前面加法计算器的程序做例子。</p> 
<p>       大家是否记得，在<a href="http://www.jizhuomi.com/software/160.html" rel="nofollow" title="模态对话框及其弹出过程">模态对话框及其弹出过程</a>中我们修改了CAdditionDlg::OnBnClickedAddButton()函数，在点了“计算”按钮以后先弹出了一个模态对话框，询问用户是否确定要进行加法计算，并通过模态对话框DoModal函数的返回值判断用户选择了“确定”还是“取消”。这些功能很明显消息对话框完全能够实现，鸡啄米就使用消息对话框来替代原来的模态对话框。</p> 
<p>       在<a href="http://www.jizhuomi.com/software/162.html" rel="nofollow" title="非模态对话框的创建及显示">非模态对话框的创建及显示</a>中，鸡啄米注释了模态对话框的相关代码，加入了非模态对话框的创建和显示代码，我们在加入消息对话框之前将非模态对话框的代码也注释或删除掉，确保此函数中不再生成原来的模态对话框或非模态对话框。</p> 
<p>       修改后的CAdditionDlg::OnBnClickedAddButton()函数如下：</p> 
<pre class="has"><code class="language-cpp">void CAdditionDlg::OnBnClickedAddButton()   
{   
    // TODO: Add your control notification handler code here   
 
    INT_PTR nRes;   
  
    // 显示消息对话框   
    nRes = MessageBox(_T("您确定要进行加法计算吗？"), _T("加法计算器"), MB_OKCANCEL | MB_ICONQUESTION);   
    // 判断消息对话框返回值。如果为IDCANCEL就return，否则继续向下执行   
    if (IDCANCEL == nRes)   
        return;   
  
    // 将各控件中的数据保存到相应的变量   
    UpdateData(TRUE);   
  
    // 将被加数和加数的加和赋值给m_editSum   
    m_editSum = m_editSummand + m_editAddend;   
  
    // 根据各变量的值更新相应的控件。和的编辑框会显示m_editSum的值   
    UpdateData(FALSE);   
    // 设置属性对话框为向导对话框   
    //sheet.SetWizardMode();   
}  </code></pre> 
<p>编译运行，在运行结果对话框上点“计算”按钮弹出以下消息对话框：</p> 
<p style="text-align:center;"><img alt="" class="has" height="175" src="https://images2.imgbox.com/2c/fc/N9QvHGTk_o.png" width="253"></p> 
<p>大家也可以将MessageBox函数换为AfxMessageBox()函数，同时参数进行相应修改，运行下看看效果。</p> 
<p></p> 
<p></p> 
<h3>文件对话框</h3> 
<p></p> 
<p>      <strong>文件对话框的分类</strong></p> 
<p><strong>      </strong>文件对话框分为 <strong>打开文件对话框</strong> 和 <strong>保存文件对话框</strong>，相信大家在Windows系统中经常见到这两种文件对话框。例如，很多编辑软件像记事本等都有“打开”选项，选择“打开”后会弹出一个对话框，让我们选择要打开文件的路径，这个对话框就是打开文件对话框；除了“打开”选项一般还会有“另存为”选项，选择“另存为”后往往也会有一个对话框弹出，让我们选择保存路径，这就是保存文件对话框。</p> 
<p>       正如上面举例说明的，打开文件对话框用于选择要打开的文件的路径，保存文件对话框用来选择要保存的文件的路径。</p> 
<p></p> 
<p>       <strong>文件对话框类CFileDialog</strong></p> 
<p><strong>      </strong>MFC使用文件对话框类CFileDialog封装了对文件对话框的操作。CFileDialog类的<a href="http://www.jizhuomi.com/software/51.html" rel="nofollow" title="构造函数">构造函数</a>原型如下：</p> 
<pre class="has"><code class="language-cpp">explicit CFileDialog(
   BOOL bOpenFileDialog,
   LPCTSTR lpszDefExt = NULL,
   LPCTSTR lpszFileName = NULL,
   DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
   LPCTSTR lpszFilter = NULL,
   CWnd* pParentWnd = NULL,
   DWORD dwSize = 0,
   BOOL bVistaStyle = TRUE
);</code></pre> 
<p>       参数说明：</p> 
<p>       bOpenFileDialog：指定要创建的文件对话框的类型。设为TRUE将创建打开文件对话框，否则将创建保存文件对话框。</p> 
<p>       lpszDefExt：默认的文件扩展名。如果用户在文件名编辑框中没有输入扩展名，则由lpszDefExt指定的扩展名将被自动添加到文件名后。默认为NULL。</p> 
<p>       lpszFileName：文件名编辑框中显示的初始文件名。如果为NULL，则不显示初始文件名。</p> 
<p>       dwFlags：文件对话框的属性，可以是一个值也可以是多个值的组合。关于属性值的定义，可以在MSDN中查找结构体OPENFILENAME，元素Flags的说明中包含了所有属性值。默认为OFN_HIDEREADONLY和OFN_OVERWRITEPROMPT的组合，OFN_HIDEREADONLY表示隐藏文件对话框上的“Read Only”复选框，OFN_OVERWRITEPROMPT表示在保存文件对话框中如果你选择的文件存在了，就弹出一个消息对话框，要求确定是否要覆盖此文件。</p> 
<p>       lpszFilter：文件过滤器，它是由若干字符串对组成的一个字符串序列。如果指定了文件过滤器，则文件对话框中只有符合过滤条件的文件显示在文件列表中待选择。给大家看看VS2010 MSDN中给出的一个例子：</p> 
<p>       static TCHAR BASED_CODE szFilter[] = _T("Chart Files (*.xlc)|*.xlc|Worksheet Files (*.xls)|*.xls|Data Files (*.xlc;*.xls)|*.xlc; *.xls|All Files (*.*)|*.*||");</p> 
<p>       这样设置过滤器以后，文件对话框的扩展名组合框中将有四个选项：Chart Files (*.xlc)、Worksheet Files (*.xls)、Data Files(*.xlc;*.xls)和All Files (*.*)，大家可以看到每种文件的扩展名规定都是一个字符串对，例如Chart Files的过滤字符串是Chart Files(*.xlc)和*.xlc成对出现的。</p> 
<p>       pParentWnd：文件对话框的父窗口的指针。</p> 
<p>       dwSize：OPENFILENAME结构体的大小。不同的操作系统对应不同的dwSize值。MFC通过此参数决定文件对话框的适当类型（例如，创建Windows 2000文件对话框还是XP文件对话框）。默认为0，表示MFC将根据程序运行的操作系统版本来决定使用哪种文件对话框。</p> 
<p>       bVistaStyle：指定文件对话框的风格，设为TRUE则使用Vista风格的文件对话框，否则使用旧版本的文件对话框。此参数仅在Windows Vista中编译时适用。</p> 
<p>       文件对话框也是模态对话框，所以在打开时也需要调用CFileDialog类的DoModal()成员函数。在打开文件对话框中点了“打开”或者在保存文件对话框中点了“保存”以后，我们可以使用CFileDialog类的成员函数GetPathName()获取选择的文件路径。</p> 
<p>       下面列出几个CFileDialog类的成员函数，我们可以使用它们获得文件对话框中的各种选择。</p> 
<p>GetFileExt()：获得选定文件的后缀名。<br> GetFileName()：获得选定文件的名称，包括后缀名。<br> GetFileTitle()：获得选定文件的标题，即不包括后缀名。<br> GetFolderPath()：获得选定文件的目录。<br> GetNextPathName()：获得下一个选定的文件的路径全名。<br> GetPathName()：获得选定文件的路径全名。<br> GetReadOnlyPref()：获得是否“以只读方式打开”。<br> GetStartPosition()：获得文件名列表中的第一个元素的位置。</p> 
<p></p> 
<p>       <strong>文件对话框实例</strong></p> 
<p><strong>      </strong>根据前面所讲内容，鸡啄米给大家做个文件对话框实例。</p> 
<p>       1.创建一个基于对话框的MFC应用程序工程，名称设为“Example17”。</p> 
<p>       2.修改主对话框IDD_EXAMPLE17_DIALOG的模板，删除自动生成的“TODO: Place dialog controls here.”静态文本框，添加两个编辑框，ID分别为IDC_OPEN_EDIT和IDC_SAVE_EDIT，再添加两个按钮，ID分别设为IDC_OPEN_BUTTON和IDC_SAVE_BUTTON，Caption分别设为“打开”和“保存”。按钮IDC_OPEN_BUTTON用于显示打开文件对话框，编辑框IDC_OPEN_EDIT显示在打开文件对话框中选择的文件路径。按钮IDC_SAVE_BUTTON用于显示保存文件对话框，编辑框IDC_SAVE_BUTTON显示在保存文件对话框中选择的文件路径。</p> 
<p>       3.分别为按钮IDC_OPEN_BUTTON和IDC_SAVE_BUTTON添加点击消息的<a href="http://www.jizhuomi.com/software/156.html" rel="nofollow" title="消息处理函数">消息处理函数</a>CExample17Dlg::OnBnClickedOpenButton()和CExample17Dlg::OnBnClickedSaveButton()。</p> 
<p>       4.修改两个消息处理函数如下：</p> 
<pre class="has"><code class="language-cpp">void CExample17Dlg::OnBnClickedOpenButton()   
{   
    // TODO: Add your control notification handler code here   
    // 设置过滤器   
    TCHAR szFilter[] = _T("文本文件(*.txt)|*.txt|所有文件(*.*)|*.*||");   
    // 构造打开文件对话框   
    CFileDialog fileDlg(TRUE, _T("txt"), NULL, 0, szFilter, this);   
    CString strFilePath;   
  
    // 显示打开文件对话框   
    if (IDOK == fileDlg.DoModal())   
    {   
        // 如果点击了文件对话框上的“打开”按钮，则将选择的文件路径显示到编辑框里   
        strFilePath = fileDlg.GetPathName();   
        SetDlgItemText(IDC_OPEN_EDIT, strFilePath);   
    }   
}   
  
  
void CExample17Dlg::OnBnClickedSaveButton()   
{   
    // TODO: Add your control notification handler code here   
    // 设置过滤器   
    TCHAR szFilter[] = _T("文本文件(*.txt)|*.txt|Word文件(*.doc)|*.doc|所有文件(*.*)|*.*||");   
    // 构造保存文件对话框   
    CFileDialog fileDlg(FALSE, _T("doc"), _T("my"), OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT, szFilter, this);   
    CString strFilePath;   
  
    // 显示保存文件对话框   
    if (IDOK == fileDlg.DoModal())   
    {   
        // 如果点击了文件对话框上的“保存”按钮，则将选择的文件路径显示到编辑框里   
        strFilePath = fileDlg.GetPathName();   
        SetDlgItemText(IDC_SAVE_EDIT, strFilePath);   
    }   
}  </code></pre> 
<p>       上面显示编辑框内容时，鸡啄米使用了Windows API函数SetDlgItemText，当然也可以先给编辑框关联变量，然后再使用鸡啄米在<a href="http://www.jizhuomi.com/software/153.html" rel="nofollow" title="创建对话框类和添加控件变量">创建对话框类和添加控件变量</a>中介绍的<br> CDialogEx::UpdateData()函数，但是鸡啄米比较习惯使用SetDlgItemText函数，感觉比较灵活。</p> 
<p>       5.运行此程序，在结果对话框上点“打开”按钮，显示打开文件对话框如下：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/be/42/FBHLc2jE_o.jpg"></p> 
<p>点“保存”按钮后，显示保存文件对话框：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/ec/87/DXoKVz0M_o.jpg"></p> 
<p>在打开文件对话框和保存文件对话框都选择了文件路径后，主对话框如下：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/48/12/dFfPy5Zq_o.png"></p> 
<p>    到此，文件对话框就讲完了，是不是依然很简单？如果忘记了文件对话框类构造函数的参数意义，可以回到鸡啄米来看看或者在MSDN上查阅。</p> 
<p></p> 
<p></p> 
<h3>字体对话框</h3> 
<p></p> 
<p>       字体对话框的作用是用来选择字体。我们也经常能够见到。MFC使用CFontDialog类封装了字体对话框的所有操作。字体对话框也是一种<a href="http://www.jizhuomi.com/software/160.html" rel="nofollow" title="模态对话框">模态对话框</a>。</p> 
<p>       <strong>CFontDialog类的<a href="http://www.jizhuomi.com/software/51.html" rel="nofollow" title="构造函数">构造函数</a></strong></p> 
<p>       我们先来了解CFontDialog类。它的常用构造函数原型如下：</p> 
<pre class="has"><code class="language-cpp">CFontDialog(
   LPLOGFONT lplfInitial = NULL,
   DWORD dwFlags = CF_EFFECTS | CF_SCREENFONTS,
   CDC* pdcPrinter = NULL,
   CWnd* pParentWnd = NULL
);

       参数说明：
       lplfInitial：指向LOGFONT结构体数据的指针，可以通过它设置字体的一些特征。
       dwFlags：指定选择字体的一个或多个属性，详情可在MSDN中查阅。
       pdcPrinter：指向一个打印设备上下文的指针。
       pParentWnd：指向字体对话框父窗口的指针。</code></pre> 
<p>       上面的构造函数中第一个参数为LOGFONT指针，LOGFONT结构体中包含了字体的大部分特征，包括字体高度、宽度、方向、名称等等。下面是此结构体的定义：</p> 
<pre class="has"><code>typedef struct tagLOGFONT {
    LONG lfHeight;
    LONG lfWidth;
    LONG lfEscapement;
    LONG lfOrientation;
    LONG lfWeight;
    BYTE lfItalic;
    BYTE lfUnderline;
    BYTE lfStrikeOut;
    BYTE lfCharSet;
    BYTE lfOutPrecision;
    BYTE lfClipPrecision;
    BYTE lfQuality;
    BYTE lfPitchAndFamily;
    TCHAR lfFaceName[LF_FACESIZE];
} LOGFONT;</code></pre> 
<p></p> 
<p>       <strong>获取字体对话框中所选字体</strong></p> 
<p>       我们在字体对话框中选择了字体后，如何获取选定的字体呢？我们可以通过CFontDialog类的成员变量m_cf间接获得选定字体的CFont对象。m_cf是CHOOSEFONT类型的变量，CHOOSEFONT结构体定义如下：</p> 
<pre class="has"><code>typedef struct {
    DWORD lStructSize;
    HWND hwndOwner;
    HDC hDC;
    LPLOGFONT lpLogFont;
    INT iPointSize;
    DWORD Flags;
    COLORREF rgbColors;
    LPARAM lCustData;
    LPCFHOOKPROC lpfnHook;
    LPCTSTR lpTemplateName;
    HINSTANCE hInstance;
    LPTSTR lpszStyle;
    WORD nFontType;
    INT nSizeMin;
    INT nSizeMax;
} CHOOSEFONT, *LPCHOOSEFONT;</code></pre> 
<p>       CHOOSEFON结构体中有个成员lpLogFont，它是指向LOGFONT结构体变量的指针，就像上面所说，LOGFONT中包含了字体特征，例如，我们可以通过LOGFONT的lfFaceName得知字体名。</p> 
<p>       我们最终要获得的是所选择字体的CFont对象，有了字体的LOGFONT怎样获得对应的CFont对象呢？使用CFont类的成员函数CreateFontIndirect可以达到此目的。函数原型如下：</p> 
<p>       BOOL CreateFontIndirect(const LOGFONT* lpLogFont );</p> 
<p>       参数是LOGFONT指针类型，我们可以传入CFontDialog类成员变量m_cf的lpLogFont成员，就可以得到所选字体的CFont对象了。</p> 
<p></p> 
<p>       <strong>字体对话框应用实例</strong></p> 
<p>       鸡啄米给大家做一个字体对话框的实例。先介绍此实例要实现的功能，生成一个对话框，对话框中放置一个“字体选择”按钮和一个编辑框。点击“字体选择”按钮将弹出字体对话框。编辑框用于显示所选字体名，并以选定的字体来显示字体名字符串，例如，如果选择了宋体，则在编辑框中以宋体显示字符串“宋体”。</p> 
<p>       以下是创建此实例的步骤：</p> 
<p>       1.创建一个基于对话框的MFC工程，名字为“Example18”。</p> 
<p>       2.在自动生成的主对话框IDD_EXAMPLE18_DIALOG的模板中，删除“TODO: Place dialog controls here.”静态文本框，添加一个按钮，ID设为IDC_FONT_BUTTON，Caption设为“字体选择”，用于显示字体对话框来选择字体，再添加一个编辑框，ID设为IDC_FONT_EDIT，用来以所选字体显示字体名字符串。</p> 
<p>       3.在Example18Dlg.h中为CExample18Dlg类添加private成员变量：CFont m_font;，用来保存编辑框中选择的字体。</p> 
<p>       4.为按钮IDC_FONT_BUTTON添加点击消息的消息处理函数CExample18Dlg::OnBnClickedFontButton()。</p> 
<p>       5.修改<a href="http://www.jizhuomi.com/software/156.html" rel="nofollow" title="消息处理函数">消息处理函数</a>CExample18Dlg::OnBnClickedFontButton()如下：</p> 
<pre class="has"><code class="language-cpp">void CExample18Dlg::OnBnClickedFontButton()   
{   
    // TODO: Add your control notification handler code here   
    CString strFontName;    // 字体名称   
    LOGFONT lf;             // LOGFONT变量   
  
    // 将lf所有字节清零   
    memset(&amp;lf, 0, sizeof(LOGFONT));   
  
    // 将lf中的元素字体名设为“宋体”   
    _tcscpy_s(lf.lfFaceName, LF_FACESIZE, _T("宋体"));   
       
    // 构造字体对话框，初始选择字体名为“宋体”   
    CFontDialog fontDlg(&amp;lf);   
  
    if (IDOK == fontDlg.DoModal())     // 显示字体对话框   
    {   
        // 如果m_font已经关联了一个字体资源对象，则释放它   
        if (m_font.m_hObject)   
        {   
            m_font.DeleteObject();   
        }   
        // 使用选定字体的LOGFONT创建新的字体   
        m_font.CreateFontIndirect(fontDlg.m_cf.lpLogFont);   
        // 获取编辑框IDC_FONT_EDIT的CWnd指针，并设置其字体   
        GetDlgItem(IDC_FONT_EDIT)-&gt;SetFont(&amp;m_font);   
  
        // 如果用户选择了字体对话框的OK按钮，则获取被选择字体的名称并显示到编辑框里   
        strFontName = fontDlg.m_cf.lpLogFont-&gt;lfFaceName;   
        SetDlgItemText(IDC_FONT_EDIT, strFontName);   
    }   
}  </code></pre> 
<p>       6.最后，编译运行程序。显示结果对话框，点击“字体选择”按钮，将弹出字体对话框，默认选择为“宋体”，我们改而选择“华文彩云”字体点“确定”，编辑框中会像如下显示：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/c9/51/OgMADzeY_o.jpg"></p> 
<p>       到此，我们又学会了字体对话框的使用，对于以后在界面开发中控制显示的字体很有帮助。有问题欢迎在鸡啄米留言。</p> 
<p></p> 
<p></p> 
<h3>颜色对话框</h3> 
<p></p> 
<p>       颜色对话框大家肯定也不陌生，我们可以打开它选择需要的颜色，简单说，它的作用就是用来选择颜色。MFC中提供了CColorDialog类封装了颜色对话框的所有操作，我们可以通过它显示颜色对话框，并获取颜色对话框中选择的颜色。颜色对话框跟字体对话框一样，也是一种<a href="http://www.jizhuomi.com/software/160.html" rel="nofollow" title="模态对话框">模态对话框</a>。</p> 
<p>       <strong>CColorDialog类的<a href="http://www.jizhuomi.com/software/51.html" rel="nofollow" title="构造函数">构造函数</a></strong></p> 
<p>CColorDialog(<br>    COLORREF clrInit = 0,<br>    DWORD dwFlags = 0,<br>    CWnd* pParentWnd = NULL<br> );</p> 
<p>       参数说明：</p> 
<p>       clrInit：默认选择颜色的颜色值，类型为COLORREF，实际上就是unsigned long类型。如果没有设置它的值，则默认为RGB(0,0,0)，即黑色。</p> 
<p>       注：RGB(r,g,b)是<a href="http://www.jizhuomi.com/software/70.html" rel="nofollow" title="宏">宏</a>，可以计算颜色值。括号中的三个值分别为红、绿、蓝分量的值。</p> 
<p>       dwFlags：自定义颜色对话框功能和外观的属性值。详情可在MSDN中查阅。</p> 
<p>       pParentWnd：颜色对话框的父窗口的指针。</p> 
<p>       <strong>获取颜色对话框中所选颜色值</strong></p> 
<p>       我们使用颜色对话框的最终目的还是要获得在颜色对话框中选择的颜色值。为此CColorDialog类的成员函数GetColor()能够很好的实现我们的要求。GetColor()函数的原型为：</p> 
<p>       COLORREF GetColor( ) const;</p> 
<p>       它返回所选颜色的COLORREF值。</p> 
<p>       如果我们想获得R、G、B各分量的值呢？可以根据GetColor得到的COLORREF颜色值，通过使用GetRValue、GetGValue和GetBValue三个宏获得。GetRValue的语法形式为：</p> 
<p>       BYTE GetRValue(DWORD rgb);</p> 
<p>       参数rgb就是COLORREF颜色值，返回值即是R分量值。其他两个宏的形式与之类似。例如，GetColor()函数返回的COLORREF为10000，则R分量值就是GetRValue(10000)。</p> 
<p>       <strong>颜色对话框应用实例</strong></p> 
<p>       鸡啄米下面给大家做一个颜色对话框的小例子。此例要实现的功能简单介绍下：生成一个对话框，对话框中放置一个“颜色选择”按钮，四个静态文本框和四个编辑框。四个静态文本框分别显示Color：、R：、G：、B：，每个静态文本框后面跟一个编辑框，分别用来显示颜色对话框中选择的颜色值和所选颜色值的红色分量、绿色分量、蓝色分量。</p> 
<p>       以下是实例创建的步骤：</p> 
<p>       1.创建一个基于对话框的MFC工程，名字为“Example19”。</p> 
<p>       2.在自动生成的主对话框IDD_EXAMPLE19_DIALOG的模板中，删除“TODO: Place dialog controls here.”静态文本框，添加一个按钮，ID设为IDC_COLOR_BUTTON，Caption设为“颜色选择”，用于显示颜色对话框来选择颜色。再添加四个静态文本框，ID分别为IDC_COLOR_STATIC、IDC_R_STATIC、IDC_G_STATIC、IDC_B_STATIC，Caption分别设为“Color：”、“R：”、“G：”、“B：”，然后每个静态文本框后添加一个编辑框，四个编辑框的ID分别为IDC_COLOR_EDIT、IDC_R_EDIT、IDC_G_EDIT、IDC_B_EDIT，分别用来显示颜色对话框中选择的颜色值和所选颜色值的红色分量、绿色分量、蓝色分量。</p> 
<p>       3.为按钮IDC_COLOR_BUTTON添加点击消息的消息处理函数CExample19Dlg::OnBnClickedColorButton()。</p> 
<p>       4.修改<a href="http://www.jizhuomi.com/software/156.html" rel="nofollow" title="消息处理函数">消息处理函数</a>CExample19Dlg::OnBnClickedColorButton()如下：</p> 
<pre class="has"><code class="language-cpp">void CExample19Dlg::OnBnClickedColorButton()   
{   
    // TODO: Add your control notification handler code here   
    COLORREF color = RGB(255, 0, 0);      // 颜色对话框的初始颜色为红色  
    CColorDialog colorDlg(color);         // 构造颜色对话框，传入初始颜色值   
  
    if (IDOK == colorDlg.DoModal())       // 显示颜色对话框，并判断是否点击了“确定”   
    {   
        color = colorDlg.GetColor();      // 获取颜色对话框中选择的颜色值   
        SetDlgItemInt(IDC_COLOR_EDIT, color);         // 在Color编辑框中显示所选颜色值   
        SetDlgItemInt(IDC_R_EDIT, GetRValue(color));  // 在R编辑框中显示所选颜色的R分量值   
        SetDlgItemInt(IDC_G_EDIT, GetGValue(color));  // 在G编辑框中显示所选颜色的G分量值   
        SetDlgItemInt(IDC_B_EDIT, GetBValue(color));  // 在B编辑框中显示所选颜色的B分量值   
    }   
}  </code></pre> 
<p>       5.最后编译运行程序，在结果对话框中点击“颜色选择”按钮，弹出颜色对话框。初始状态下，选择框在红色上，我们选另一种颜色，此时的颜色对话框如下：</p> 
<p style="text-align:center;"><img alt="" class="has" height="306" src="https://images2.imgbox.com/99/d8/pIaiPUjS_o.jpg" width="228"></p> 
<p>点“确定”，主对话框上的四个编辑框中分别显示了选择的颜色值、R分量、G分量和B分量：</p> 
<p style="text-align:center;"><img alt="" class="has" src="https://images2.imgbox.com/ec/84/4WAUnBsS_o.jpg"></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ce436d77e1c0b0646744ea87a31006d7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【今日话题】在嘈声中精确分离出个体——“正所谓：长乐钟声花外尽，龙池柳色雨中深</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8f018977a646569d19a786e3f0aa3bf5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">大模型：常见的文字表情包(可以直接加到微调数据里)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>