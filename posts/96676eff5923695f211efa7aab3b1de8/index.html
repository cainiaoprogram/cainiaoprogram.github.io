<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux下（乌班图）安装Redis - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux下（乌班图）安装Redis" />
<meta property="og:description" content="配置文件参考资料
Redis的安装 第一步：更新软件源列表 打开Linux终端 （管他三七二十一，我们先对软件源列表更新下，防止安装软件的时候出现无法定位软件包的问题）
执行更新软件源列表命令：sudo apt-get udpate 第二步：安装Redis 执行安装Redis命令： sudo apt-get install redis-server 第三步：启动Redis服务 执行启动Redis服务命令： sudo /etc/init.d/redis-server start 第四步：查看Redis服务是否启动成功 执行查看是否启动Redis服务的命令： redis-cli 如果启动成功：会是显示如下信息：↓ 127.0.0.1:6379&gt;set myname &#34;zhangshang&#34; （这里我们用set命令写一条 键为myname，值为zhangshang的数据） OK （如果数据写入成功这里则会显示OK） 127.0.0.1:6379&gt;get myname （然后我们用get命令来获取这条 键为myname的数据） &#34;zhangshang&#34; （在这里得到zhangshang） 第五步：修改redis的配置文件 sudo dir /etc/redis (首先查询redis文件夹下所有的文件，去这个文件夹去找一个叫redis.conf的配置文件) 如果有这个文件，我们用vi修改这个配置文件
sudo vi /etc/redis/redis.conf （用vi打开这个redis.conf的配置文件） 将redis.conf配置文件中的bind 127.0.0.1注释掉（改成#bind 127.0.0.1）保存
第六步：重启redis服务 执行重启Redis命令：sudo /etc/init.d/redis-server restart 第七步：开启ufw防火墙配置工具，打开防火墙 执行开启防火墙命令： sudo ufw enable 添加规则： 允许指定的IP访问这个Redis服务（redis默认端口为6379）
sudo ufw allow from 192.168.31.1 to any port 6379 （即：允许192." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/96676eff5923695f211efa7aab3b1de8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-07-04T16:24:21+08:00" />
<meta property="article:modified_time" content="2018-07-04T16:24:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux下（乌班图）安装Redis</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><a href="https://blog.csdn.net/xiamoyanyulrq/article/details/80402302">配置文件参考资料</a></p> 
<h2><span style="color:#990000;">Redis的安装</span></h2> 
<h3>第一步：更新软件源列表</h3> 
<p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">打开Linux终端 （管他三七二十一，我们先对软件源列表更新下，防止安装软件的时候出现无法定位软件包的问题）</p> 
<pre class="prettyprint prettyprinted" style="font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);"><span class="pln" style="border:0px;color:rgb(0,0,0);">执行更新软件源列表命令：sudo apt</span><span class="pun" style="border:0px;color:rgb(102,102,0);">-</span><span class="kwd" style="border:0px;color:rgb(0,0,136);">get</span><span class="pln" style="border:0px;color:rgb(0,0,0);"> udpate</span></pre> 
<h3>第二步：安装Redis</h3> 
<pre class="prettyprint prettyprinted" style="font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">执行安装Redis命令： sudo apt-get install redis-server  </pre> 
<h3>第三步：启动Redis服务</h3> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">执行启动Redis服务命令： sudo /etc/init.d/redis-server start</pre> 
<h3>第四步：查看Redis服务是否启动成功</h3> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">执行查看是否启动Redis服务的命令： redis-cli

如果启动成功：会是显示如下信息：↓
127.0.0.1:6379&gt;set myname "zhangshang" （这里我们用set命令写一条 键为myname，值为zhangshang的数据）
OK （如果数据写入成功这里则会显示OK）
127.0.0.1:6379&gt;get myname    （然后我们用get命令来获取这条 键为myname的数据）
"zhangshang"  （在这里得到zhangshang）
</pre> 
<h3>第五步：修改redis的配置文件</h3> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">sudo dir /etc/redis    (首先查询redis文件夹下所有的文件，去这个文件夹去找一个叫redis.conf的配置文件) </pre> 
<p>如果有这个文件，我们用vi修改这个配置文件</p> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">sudo vi /etc/redis/redis.conf    （用vi打开这个redis.conf的配置文件） </pre> 
<p><span style="color:#cc0000;">将redis.conf配置文件中的bind 127.0.0.1注释掉（改成#bind 127.0.0.1）保存</span></p> 
<h3>第六步：重启redis服务</h3> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">执行重启Redis命令：sudo /etc/init.d/redis-server restart</pre> 
<h3>第七步：开启ufw防火墙配置工具，打开防火墙</h3> 
<pre class="prettyprint prettyprinted" style="font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">执行开启防火墙命令： sudo ufw enable</pre> 
<h4>添加规则：</h4> 
<p>允许指定的IP访问这个Redis服务（redis默认端口为6379）</p> 
<pre class="prettyprint prettyprinted" style="font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">sudo ufw allow from 192.168.31.1 to any port 6379 （即：允许192.168.31.1这个IP访问6379这个端口）</pre> 
<h4 style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">重启防火墙</h4> 
<p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">（编辑或新增规则后需要重启防火墙才能生效）</p> 
<pre class="prettyprint prettyprinted" style="font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">执行重启防火墙命令： sudo ufw reload</pre> 
<p>搞定收工</p> 
<p><br></p> 
<h3>停止Redis服务</h3> 
<p>如果想停止Redis服务，则执行如下命令</p> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">执行停止防火墙命令：sudo /etc/init.d/redis-server stop</pre> 
<br> 
<h2><span style="color:#990000;">设置Redis密码</span></h2> 
<p>用vi打开Redis的配置文件</p> 
<p></p> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">执行用vi打开redis配置文件命令：sudo vi /etc/redis/redis.conf</pre> 
<p>打开之后在命令模式下输入 “/”(不要双引号)  搜索requirepass关键字</p> 
<p>找到# requirepass foobared 这一行，将前面的#号删除，然后将foobared改成你要设置的密码</p> 
<p>（最好是直接删除foobared,改成你要配置的密码，而不是再下面独立添加一行）</p> 
<p><img src="https://images2.imgbox.com/f4/04/mhWkdeEh_o.png" alt=""><br></p> 
<p>保存后，重启Redis服务（这里可能需要重启电脑）</p> 
<p>如果不重启电脑可能报如下错误：</p> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">[....] Restarting redis-server (via systemctl): redis-server.serviceJob for redis-server.service failed because the control process exited with error code. See "systemctl status redis-server.service" and "journalctl -xe" for details.
failed!</pre> 
<p>重启Redis服务</p> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">执行重启Redis命令：sudo /etc/init.d/redis-server restart</pre> 
<p>或者在重启命令后面追加配置文件：如下 ↓</p> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">执行重启Redis命令：sudo /etc/init.d/redis-server restart /etc/redis/redis.conf</pre> 
<p>使用redis-cli命令工具连接测试</p> 
<p></p> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">执行连接Redis命令：sudo redis-cli</pre> 
<p>会弹出如下信息</p> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">127.0.0.1:6379&gt;
我们只要在这个&gt;后面输入auth 123456就可以了（123456是我redis的密码）即
127.0.0.1:6379&gt;auth 123456    //回车
如果连接成功，则又会弹出如下信息
127.0.0.1:6379&gt;
那么现在我们就可以对数据进行写入了。例如：
127.0.0.1：6379&gt;set name "lily" //写入数据
127.0.0.1:6379&gt;get name         //获取数据</pre> 
<p><img src="https://images2.imgbox.com/74/7b/rCtbkx6W_o.png" alt=""><br></p> 
<p>如果不想这么麻烦，就直接执行以下连接命</p> 
<pre class="prettyprint prettyprinted" style="background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;font-family:Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace;font-size:14px;line-height:22px;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);">执行连接Redis命令：redis-cli -h 127.0.0.1 -p 6379 -a 123456</pre> 
<p>在用C#连接SQL数据库时，我们需要在Config配置文件里面配置SQL连接字符串，同样，在连接Redis时，也可以配置连接字符串：</p> 
<pre><code class="language-html">&lt;add key="RedisTest"  WriteServer="127.0.0.1:6379,password=123456,connectTimeout=1000,connectRetry=1,syncTimeout=1000"/&gt;
</code></pre>注释： 
<br>127.0.0.1:6379：IP，端口 
<br>password：Redis密码 
<br>connectTimeout：连接超时时间，这里设置的是1000毫秒 
<br>connectRetry：重试连接次数 
<br> 
<p>syncTimeout：同步操作默认超时时间</p> 
<pre><code class="language-csharp">/// &lt;summary&gt;
/// Redis帮助类
/// &lt;/summary&gt;
public class RedisHelper
{
    /// &lt;summary&gt;
    /// 连接字符串，一般写在配置文件里面
    /// &lt;/summary&gt;
    private static readonly string ConnectionString = "127.0.0.1:6379,password=123456,connectTimeout=1000,connectRetry=1,syncTimeout=10000";
    /// &lt;summary&gt;
    /// 上锁，单例模式
    /// &lt;/summary&gt;
    private static object locker = new object();
    /// &lt;summary&gt;
    /// 连接对象
    /// &lt;/summary&gt;
    private volatile IConnectionMultiplexer _connection;
    /// &lt;summary&gt;
    /// 数据库
    /// &lt;/summary&gt;
    private IDatabase _db;
    #region 创建Redis实例
    public RedisHelper()
    {
        _connection = ConnectionMultiplexer.Connect(ConnectionString);
        _db = GetDatabase();
    }


    private static RedisHelper redisHelper;

    public static RedisHelper GetRedisHelper()
    {

        if (redisHelper == null)
        {
            lock (locker)
            {
                if (redisHelper == null)
                {
                    redisHelper = new RedisHelper();
                }
            }
        }
        return redisHelper;
    }
    #endregion


    /// &lt;summary&gt;
    /// 获取连接
    /// &lt;/summary&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    protected IConnectionMultiplexer GetConnection()
    {
        if (_connection != null &amp;&amp; _connection.IsConnected)
        {
            return _connection;
        }
        lock (locker)
        {
            if (_connection != null &amp;&amp; _connection.IsConnected)
            {
                return _connection;
            }

            if (_connection != null)
            {
                _connection.Dispose();
            }
            _connection = ConnectionMultiplexer.Connect(ConnectionString);
        }

        return _connection;
    }
    /// &lt;summary&gt;
    /// 获取数据库
    /// &lt;/summary&gt;
    /// &lt;param name="db"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public IDatabase GetDatabase(int? db = null)
    {
        return GetConnection().GetDatabase(db ?? -1);
    }
    /// &lt;summary&gt;
    /// 设置
    /// &lt;/summary&gt;
    /// &lt;param name="key"&gt;键&lt;/param&gt;
    /// &lt;param name="data"&gt;值&lt;/param&gt;
    /// &lt;param name="cacheTime"&gt;过期时间&lt;/param&gt;
    public virtual void Set(string key, object data, int? cacheTime=null)
    {
        if (data == null)
        {
            return;
        }
        var entryBytes = Serialize(data);
        if (cacheTime != null)
        {
            var expiresIn = TimeSpan.FromMinutes(Convert.ToDouble(cacheTime));
            _db.StringSet(key, entryBytes, expiresIn);
        }
        else
        {
            _db.StringSet(key, entryBytes);
        }

    }

    /// &lt;summary&gt;
    /// 根据键获取值
    /// &lt;/summary&gt;
    /// &lt;typeparam name="T"&gt;&lt;/typeparam&gt;
    /// &lt;param name="key"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public virtual T Get&lt;T&gt;(string key)
    {
        var rValue = _db.StringGet(key);
        if (!rValue.HasValue)
        {
            return default(T);
        }

        var result = Deserialize&lt;T&gt;(rValue);

        return result;
    }

    /// &lt;summary&gt;
    /// 判断键是否已存在
    /// &lt;/summary&gt;
    /// &lt;param name="key"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public bool IsExit(string key)
    {
        return _db.KeyExists(key);
    }

    /// &lt;summary&gt;
    /// 判断是否已经设置
    /// &lt;/summary&gt;
    /// &lt;param name="key"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public virtual bool IsSet(string key)
    {
        return _db.KeyExists(key);
    }
    /// &lt;summary&gt;
    /// 序列化
    /// &lt;/summary&gt;
    /// &lt;param name="data"&gt;&lt;/param&gt;
    /// &lt;returns&gt;byte[]&lt;/returns&gt;
    private byte[] Serialize(object data)
    {
        var json = JsonConvert.SerializeObject(data);
        return Encoding.UTF8.GetBytes(json);
    }

    /// &lt;summary&gt;
    /// 反序列化
    /// &lt;/summary&gt;
    /// &lt;typeparam name="T"&gt;&lt;/typeparam&gt;
    /// &lt;param name="serializedObject"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    protected virtual T Deserialize&lt;T&gt;(byte[] serializedObject)
    {
        if (serializedObject == null)
        {
            return default(T);
        }
        var json = Encoding.UTF8.GetString(serializedObject);
        return JsonConvert.DeserializeObject&lt;T&gt;(json);
    }
}</code></pre> 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1d757f2751ab0a3eb8f056c006a686cc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">冒泡排序、选择排序和插入排序的区别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/03bfa59ca6b608f4c7a5045f0147b435/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Ext6.2  sencha app build 几种报错的解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>