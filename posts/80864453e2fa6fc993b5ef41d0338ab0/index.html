<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>用python处理MS Word - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="用python处理MS Word" />
<meta property="og:description" content="使用python工具读写MS Word文件（docx与doc文件），主要利用了python-docx包。本文给出一些常用的操作，并完成一个样例，帮助大家快速入手。
安装 pyhton处理docx文件需要使用python-docx 包，可以利用pip工具很方便的安装，pip工具在python安装路径下的Scripts文件夹中
pip install python-docx 当然你也可以选择使用easy_install或者手动方式进行安装
写入文件内容 此处我们直接给出一个样例，根据自己的需要摘取有用的内容
#coding=utf-8 from docx import Document from docx.shared import Pt from docx.shared import Inches from docx.oxml.ns import qn #打开文档 document = Document() #加入不同等级的标题 document.add_heading(u&#39;MS WORD写入测试&#39;,0) document.add_heading(u&#39;一级标题&#39;,1) document.add_heading(u&#39;二级标题&#39;,2) #添加文本 paragraph = document.add_paragraph(u&#39;我们在做文本测试！&#39;) #设置字号 run = paragraph.add_run(u&#39;设置字号、&#39;) run.font.size = Pt(24) #设置字体 run = paragraph.add_run(&#39;Set Font,&#39;) run.font.name = &#39;Consolas&#39; #设置中文字体 run = paragraph.add_run(u&#39;设置中文字体、&#39;) run.font.name=u&#39;宋体&#39; r = run._element r.rPr.rFonts.set(qn(&#39;w:eastAsia&#39;), u&#39;宋体&#39;) #设置斜体 run = paragraph." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/80864453e2fa6fc993b5ef41d0338ab0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-06-03T22:04:46+08:00" />
<meta property="article:modified_time" content="2016-06-03T22:04:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">用python处理MS Word</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>使用python工具读写MS Word文件（docx与doc文件），主要利用了python-docx包。本文给出一些常用的操作，并完成一个样例，帮助大家快速入手。</p> 
<h2 id="安装">安装</h2> 
<p>pyhton处理docx文件需要使用<code>python-docx</code> 包，可以利用pip工具很方便的安装，pip工具在python安装路径下的Scripts文件夹中</p> 
<pre class="prettyprint"><code class="language-bat hljs cmake">pip <span class="hljs-keyword">install</span> python-docx</code></pre> 
<p>当然你也可以选择使用easy_install或者手动方式进行安装</p> 
<h2 id="写入文件内容">写入文件内容</h2> 
<p>此处我们直接给出一个样例，根据自己的需要摘取有用的内容</p> 
<pre class="prettyprint"><code class="language-python hljs "><span class="hljs-comment">#coding=utf-8</span>

<span class="hljs-keyword">from</span> docx <span class="hljs-keyword">import</span> Document
<span class="hljs-keyword">from</span> docx.shared <span class="hljs-keyword">import</span> Pt
<span class="hljs-keyword">from</span> docx.shared <span class="hljs-keyword">import</span> Inches
<span class="hljs-keyword">from</span> docx.oxml.ns <span class="hljs-keyword">import</span> qn
<span class="hljs-comment">#打开文档</span>
document = Document()
<span class="hljs-comment">#加入不同等级的标题</span>
document.add_heading(<span class="hljs-string">u'MS WORD写入测试'</span>,<span class="hljs-number">0</span>)
document.add_heading(<span class="hljs-string">u'一级标题'</span>,<span class="hljs-number">1</span>)
document.add_heading(<span class="hljs-string">u'二级标题'</span>,<span class="hljs-number">2</span>)
<span class="hljs-comment">#添加文本</span>
paragraph = document.add_paragraph(<span class="hljs-string">u'我们在做文本测试！'</span>)
<span class="hljs-comment">#设置字号</span>
run = paragraph.add_run(<span class="hljs-string">u'设置字号、'</span>)
run.font.size = Pt(<span class="hljs-number">24</span>)

<span class="hljs-comment">#设置字体</span>
run = paragraph.add_run(<span class="hljs-string">'Set Font,'</span>)
run.font.name = <span class="hljs-string">'Consolas'</span>

<span class="hljs-comment">#设置中文字体</span>
run = paragraph.add_run(<span class="hljs-string">u'设置中文字体、'</span>)
run.font.name=<span class="hljs-string">u'宋体'</span>
r = run._element
r.rPr.rFonts.set(qn(<span class="hljs-string">'w:eastAsia'</span>), <span class="hljs-string">u'宋体'</span>)

<span class="hljs-comment">#设置斜体</span>
run = paragraph.add_run(<span class="hljs-string">u'斜体、'</span>)
run.italic = <span class="hljs-keyword">True</span>

<span class="hljs-comment">#设置粗体</span>
run = paragraph.add_run(<span class="hljs-string">u'粗体'</span>).bold = <span class="hljs-keyword">True</span>

<span class="hljs-comment">#增加引用</span>
document.add_paragraph(<span class="hljs-string">'Intense quote'</span>, style=<span class="hljs-string">'Intense Quote'</span>)

<span class="hljs-comment">#增加无序列表</span>
document.add_paragraph(
    <span class="hljs-string">u'无序列表元素1'</span>, style=<span class="hljs-string">'List Bullet'</span>
)
document.add_paragraph(
    <span class="hljs-string">u'无序列表元素2'</span>, style=<span class="hljs-string">'List Bullet'</span>
)
<span class="hljs-comment">#增加有序列表</span>
document.add_paragraph(
    <span class="hljs-string">u'有序列表元素1'</span>, style=<span class="hljs-string">'List Number'</span>
)
document.add_paragraph(
    <span class="hljs-string">u'有序列表元素2'</span>, style=<span class="hljs-string">'List Number'</span>
)
<span class="hljs-comment">#增加图像（此处用到图像image.bmp，请自行添加脚本所在目录中）</span>
document.add_picture(<span class="hljs-string">'image.bmp'</span>, width=Inches(<span class="hljs-number">1.25</span>))

<span class="hljs-comment">#增加表格</span>
table = document.add_table(rows=<span class="hljs-number">1</span>, cols=<span class="hljs-number">3</span>)
hdr_cells = table.rows[<span class="hljs-number">0</span>].cells
hdr_cells[<span class="hljs-number">0</span>].text = <span class="hljs-string">'Name'</span>
hdr_cells[<span class="hljs-number">1</span>].text = <span class="hljs-string">'Id'</span>
hdr_cells[<span class="hljs-number">2</span>].text = <span class="hljs-string">'Desc'</span>
<span class="hljs-comment">#再增加3行表格元素</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">3</span>):
    row_cells = table.add_row().cells
    row_cells[<span class="hljs-number">0</span>].text = <span class="hljs-string">'test'</span>+str(i)
    row_cells[<span class="hljs-number">1</span>].text = str(i)
    row_cells[<span class="hljs-number">2</span>].text = <span class="hljs-string">'desc'</span>+str(i)

<span class="hljs-comment">#增加分页</span>
document.add_page_break()

<span class="hljs-comment">#保存文件</span>
document.save(<span class="hljs-string">u'测试.docx'</span>)</code></pre> 
<p>该段代码生成的文档样式如下 <br> <img src="https://images2.imgbox.com/37/56/3fWg6R7d_o.png" alt="word内容" title=""></p> 
<p>注：有一个问题没找到如何解决，即如何为表格设置边框线。如果您知道，还请能够指教。</p> 
<h2 id="读取文件内容">读取文件内容</h2> 
<pre class="prettyprint"><code class="language-python hljs "><span class="hljs-comment">#coding=utf-8</span>

<span class="hljs-keyword">from</span> docx <span class="hljs-keyword">import</span> Document
<span class="hljs-comment">#打开文档</span>
document = Document(<span class="hljs-string">u'测试.docx'</span>)
<span class="hljs-comment">#读取每段资料</span>
l = [ paragraph.text.encode(<span class="hljs-string">'gb2312'</span>) <span class="hljs-keyword">for</span> paragraph <span class="hljs-keyword">in</span> document.paragraphs];
<span class="hljs-comment">#输出并观察结果，也可以通过其他手段处理文本即可</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> l:
    <span class="hljs-keyword">print</span> i
<span class="hljs-comment">#读取表格材料，并输出结果</span>
tables = [table <span class="hljs-keyword">for</span> table <span class="hljs-keyword">in</span> document.tables];
<span class="hljs-keyword">for</span> table <span class="hljs-keyword">in</span> tables:
    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table.rows:
        <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> row.cells:
            <span class="hljs-keyword">print</span> cell.text.encode(<span class="hljs-string">'gb2312'</span>),<span class="hljs-string">'\t'</span>,
        <span class="hljs-keyword">print</span>
    <span class="hljs-keyword">print</span> <span class="hljs-string">'\n'</span></code></pre> 
<p>我们仍然使用刚才我们生成的文件，可以看到，输出的结果为 <br> <img src="https://images2.imgbox.com/de/5e/6ER5Z6xK_o.jpg" alt="读取文档" title=""> <br> 注意：此处我们使用gb2312编码方式读取，主要是保证中文的读写正确。一般情况下，使用的utf-8编码方式。另外，python-docx主要处理docx文件，在加载doc文件时，会出现问题，如果有大量doc文件，建议先将doc文件批量转换为docx文件，例如利用工具<a href="http://www.batchwork.com/en/doc2doc/" rel="nofollow">doc2doc</a></p> 
<h2 id="参考资料">参考资料</h2> 
<p><a href="https://python-docx.readthedocs.io/en/latest" rel="nofollow">python-docx</a> <br> <a href="http://stackoverflow.com/questions/42482/best-way-to-extract-text-from-a-word-doc-without-using-com-automation" rel="nofollow">Best way to extract text from a Word doc without using COM/automation?</a> <br> <a href="http://stackoverflow.com/questions/125222/extracting-text-from-ms-word-files-in-python" rel="nofollow">Extracting text from MS word files in python</a> <br> <a href="https://github.com/python-openxml/python-docx/issues/154#issuecomment-77707775"> Add a w:eastAsia attribute </a></p> 
<h2 id="致谢">致谢</h2> 
<p>感谢<a href="http://blog.csdn.net/zanlaoli">zanlaoli</a>在文章评论中帮助指出如何设置中文字体的问题。 <br> 感谢<a href="http://blog.csdn.net/u013421941">四路组相联</a> 指出包引入缺失的问题。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8ef2bccc778b16974215ea35267298f3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于如何处理JSONObject.fromObject(Object obj)无法转换特殊日期（java.sql.Date,java.sql.Timestamp）格式的问题。</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6d87dffbfb122ac2e06431096f0be114/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java多线程使用不当造成的问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>