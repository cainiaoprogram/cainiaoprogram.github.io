<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AFX_MANAGE_STATE(AfxGetStaticModuleState())的使用 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="AFX_MANAGE_STATE(AfxGetStaticModuleState())的使用" />
<meta property="og:description" content="[MSDN]
By default, MFC uses the resource handle of the main application to load the resource template. If you have an exported function in a DLL, such as one that launches a dialog box in the DLL, this template is actually stored in the DLL module. You need to switch the module state for the correct handle to be used. You can do this by adding the following code to the beginning of the function:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6580fe93b5823a076e95d4a361e57776/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-17T22:43:40+08:00" />
<meta property="article:modified_time" content="2022-03-17T22:43:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">AFX_MANAGE_STATE(AfxGetStaticModuleState())的使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>[MSDN]</p> 
<p>By default, MFC uses the resource handle of <strong>the main application </strong>to load the resource template. If you have an exported function in a DLL, such as one that launches a dialog box in the DLL, this template is actually stored in the DLL module. You need to <strong>switch the module</strong> state for the correct handle to be used. You can do this by adding the following code to the beginning of the function:</p> 
<p>AFX_MANAGE_STATE(AfxGetStaticModuleState( ));</p> 
<p>这行代码，是跟MFC资源相关的，资源就是 MFC工程里，你通过可视化编辑生成的菜单，图片和对话框。就是 xxxx.rc 里面的东西。<br><br> 如果你的dll里没这些东西，则不需要使用这个宏<br><br> 如果你在 dll里的某个函数里，要弹出一个对话框，则需要在这个函数前面加上这个宏，意思就是告诉系统，程序进入这个函数的时候，<strong>就从该DLL中查找资源</strong>，<strong>而不是从主程序中查找资源</strong>。<br><br> 也就是说，在函数堆栈结构中，（针对当前DLL）只需要在最外层入口的地方使用一次即可。并且使用了 这个宏的接口，<strong>最好不要再嵌套调用</strong>，那样就相当于上面说的 “告诉系统，程序进入这个函数的时候，就从当前DLL去查找资源” 执行了多次。 </p> 
<p>参考：</p> 
<p><a href="https://www.cnblogs.com/linlf03/archive/2011/11/16/2251318.html" rel="nofollow" title="C++ AFX_MANAGE_STATE(AfxGetStaticModuleState())的作用 - work hard work smart - 博客园">C++ AFX_MANAGE_STATE(AfxGetStaticModuleState())的作用 - work hard work smart - 博客园</a></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/eb1f6828f8707762a238e11f8b1d97d4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">前端布局：圣杯布局/双飞翼布局(两者小小的区别)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6a52670d7c7aade906159e32b69f0093/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">TS无法找到模块“common.js”的声明文件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>