<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android -- 读写文件到内部ROM，SD卡，SharedPreferences，文件读写权限 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android -- 读写文件到内部ROM，SD卡，SharedPreferences，文件读写权限" />
<meta property="og:description" content="（内容整理自张泽华教程）
1. 概述
使用文件进行数据存储
首先给大家介绍使用文件如何对数据进行存储，Activity提供了openFileOutput()方法可以用于把数据输出到文件中，具体的实现过程与在J2SE环境中保存数据到文件中是一样的。
public class FileActivity extends Activity {
@Override public void onCreate(Bundle savedInstanceState) {
... FileOutputStream outStream = this.openFileOutput(&#34;itcast.txt&#34;, Context.MODE_PRIVATE);
outStream.write(&#34;传智播客&#34;.getBytes());
outStream.close(); }
}
openFileOutput()方法的第一参数用于指定文件名称，不能包含路径分隔符“/” ，如果文件不存在，Android 会自动创建它。创建的文件保存在/data/data/&lt;package name&gt;/files目录，如： /data/data/cn.itcast.action/files/itcast.txt，通过点击Eclipse菜单“Window”-“Show View”-“Other”，在对话窗口中展开android文件夹，选择下面的File Explorer视图，然后在File Explorer视图中展开/data/data/&lt;package name&gt;/files目录就可以看到该文件。
openFileOutput()方法的第二参数用于指定操作模式，有四种模式，分别为： Context.MODE_PRIVATE = 0
Context.MODE_APPEND = 32768
Context.MODE_WORLD_READABLE = 1
Context.MODE_WORLD_WRITEABLE = 2
Context.MODE_PRIVATE：为默认操作模式，代表该文件是私有数据，只能被应用本身访问，在该模式下，写入的内容会覆盖原文件的内容，如果想把新写入的内容追加到原文件中。可以使用Context.MODE_APPEND
Context.MODE_APPEND：模式会检查文件是否存在，存在就往文件追加内容，否则就创建新文件。
Context.MODE_WORLD_READABLE和Context.MODE_WORLD_WRITEABLE用来控制其他应用是否有权限读写该文件。
MODE_WORLD_READABLE：表示当前文件可以被其他应用读取；MODE_WORLD_WRITEABLE：表示当前文件可以被其他应用写入。
如果希望文件被其他应用读和写，可以传入： openFileOutput(&#34;itcast.txt&#34;, Context.MODE_WORLD_READABLE &#43; Context.MODE_WORLD_WRITEABLE);
读取文件内容
如果要打开存放在/data/data/&lt;package name&gt;/files目录应用私有的文件，可以使用Activity提供openFileInput()方法。
FileInputStream inStream = this.getContext().openFileInput(&#34;itcast.txt&#34;);
Log.i(&#34;FileTest&#34;, readInStream(inStream));
readInStream()的方法请看本页下面备注。
或者直接使用文件的绝对路径：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/bf2257b0dbda6ee322d0836f4a180edf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-03-21T11:38:00+08:00" />
<meta property="article:modified_time" content="2014-03-21T11:38:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android -- 读写文件到内部ROM，SD卡，SharedPreferences，文件读写权限</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <p>（内容整理自张泽华教程）</p> 
 <p><strong><span style="color:#ff0000;">1. 概述</span></strong></p> 
 <p><strong><span style="color:#ff0000;">使用文件进行数据存储</span></strong></p> 
 <p><span style="color:#000000;">首先给大家介绍使用文件如何对数据进行存储，</span><span style="color:#000000;">Activity</span><span style="color:#000000;">提供了</span><span style="color:#000000;">openFileOutput()</span><span style="color:#000000;">方法可以用于把数据输出到文件中，具体的实现过程与在</span><span style="color:#000000;">J2SE</span><span style="color:#000000;">环境中保存数据到文件中是一样的。</span></p> 
 <p><span style="color:#000000;">public class FileActivity extends Activity {<!-- --></span></p> 
 <p><span style="color:#000000;">    </span>@Override public void onCreate(Bundle savedInstanceState) {<!-- --></p> 
 <p><span style="color:#000000;">        </span>... </p> 
 <p><span style="color:#0070c0;">         </span>FileOutputStream outStream = this.openFileOutput("itcast.txt", Context.MODE_PRIVATE);</p> 
 <p><span style="color:#0070c0;">         </span>outStream.write("<span style="color:#0070c0;">传智播客</span><span style="color:#0070c0;">".getBytes());</span></p> 
 <p><span style="color:#0070c0;">         </span>outStream.close();   </p> 
 <p><span style="color:#000000;">    </span>}</p> 
 <p><span style="color:#000000;">}</span></p> 
 <p><span style="color:#000000;">openFileOutput()</span><span style="color:#000000;">方法的第一参数用于指定文件名称，不能包含路径分隔符“</span><span style="color:#000000;">/” </span><span style="color:#000000;">，如果文件不存在，</span><span style="color:#000000;">Android </span><span style="color:#000000;">会自动创建它。创建的文件保存在</span><span style="color:#000000;">/data/data/&lt;package name&gt;/files</span><span style="color:#000000;">目录，如</span><span style="color:#0000FF;">： </span><span style="color:#0000FF;">/data/data/cn.itcast.action/files/itcast.txt</span><span style="color:#000000;">，通过点击</span><span style="color:#000000;">Eclipse</span><span style="color:#000000;">菜单“</span><span style="color:#000000;">Window”-“Show View”-“Other”</span><span style="color:#000000;">，在对话窗口中展开</span><span style="color:#000000;">android</span><span style="color:#000000;">文件夹，选择下面的</span><span style="color:#000000;">File Explorer</span><span style="color:#000000;">视图，然后在</span><span style="color:#000000;">File Explorer</span><span style="color:#000000;">视图中展开</span><span style="color:#000000;">/data/data/&lt;package name&gt;/files</span><span style="color:#000000;">目录就可以看到该文件。</span></p> 
 <p><span style="color:#000000;">openFileOutput()</span><span style="color:#000000;">方法的第二参数用于指定操作模式，有四种模式，分别为： </span><span style="color:#000000;">Context.MODE_PRIVATE   </span><span style="color:#000000;"> </span><span style="color:#000000;">=  </span>0</p> 
 <p><span style="color:#000000;">Context.MODE_APPEND   </span><span style="color:#000000;"> </span><span style="color:#000000;">=  </span>32768</p> 
 <p><span style="color:#000000;">Context.MODE_WORLD_READABLE =  </span>1</p> 
 <p><span style="color:#000000;">Context.MODE_WORLD_WRITEABLE =  </span>2</p> 
 <p><span style="color:#000000;">Context.MODE_PRIVATE</span><span style="color:#000000;">：为默认操作模式，代表该文件是私有数据，只能被应用本身访问，在该模式下，写入的内容会覆盖原文件的内容，如果想把新写入的内容追加到原文件中。可以使用</span><span style="color:#000000;">Context.MODE_APPEND</span></p> 
 <p><span style="color:#000000;">Context.MODE_APPEND</span><span style="color:#000000;">：模式会检查文件是否存在，存在就往文件追加内容，否则就创建新文件。</span></p> 
 <p><span style="color:#000000;">Context.MODE_WORLD_READABLE</span><span style="color:#000000;">和</span><span style="color:#000000;">Context.MODE_WORLD_WRITEABLE</span><span style="color:#000000;">用来控制其他应用是否有权限读写该文件。</span></p> 
 <p><span style="color:#000000;">MODE_WORLD_READABLE</span><span style="color:#000000;">：表示当前文件可以被其他应用读取；</span><span style="color:#000000;">MODE_WORLD_WRITEABLE</span><span style="color:#000000;">：表示当前文件可以被其他应用写入。</span></p> 
 <p><span style="color:#000000;">如果希望文件被其他应用读和写，可以传入： </span></p> 
 <p><span style="color:#000000;">openFileOutput("itcast.txt", </span><span style="color:#FF0000;">Context.MODE_WORLD_READABLE + Context.MODE_WORLD_WRITEABLE</span><span style="color:#000000;">);</span></p> 
 <p><span style="color:#330066;"></span> </p> 
 <p><strong><span style="color:#ff0000;">读取文件内容</span></strong></p> 
 <p><span style="color:#000000;">如果要打开存放在</span><span style="color:#000000;">/data/data/&lt;package name&gt;/files</span><span style="color:#000000;">目录应用私有的文件，可以使用</span><span style="color:#000000;">Activity</span><span style="color:#000000;">提供</span><span style="color:#000000;">openFileInput()</span><span style="color:#000000;">方法。</span></p> 
 <p><span style="color:#000000;">FileInputStream inStream = this.getContext().openFileInput("itcast.txt");</span></p> 
 <p><span style="color:#000000;">Log.i("FileTest", readInStream(inStream));</span></p> 
 <p><span style="color:#000000;">readInStream()</span><span style="color:#000000;">的方法请看本页下面备注。</span></p> 
 <p><span style="color:#000000;">或者直接使用文件的绝对路径：</span></p> 
 <p><span style="color:#000000;">File file = new File("/data/data/</span><span style="color:#0070c0;">cn.itcast.action</span><span style="color:#000000;">/files/itcast.txt");</span></p> 
 <p><span style="color:#000000;">FileInputStream inStream = new FileInputStream(file);</span></p> 
 <p><span style="color:#000000;">Log.i("FileTest", readInStream(inStream));</span></p> 
 <p><span style="color:#FF0000;">注意：上面文件路径中的“</span><span style="color:#FF0000;">cn.itcast.action”</span><span style="color:#FF0000;">为应用所在包，当你在编写代码时应替换为你自己应用使用的包。</span></p> 
 <p><span style="color:#000000;">对于私有文件只能被创建该文件的应用访问，如果希望文件能被其他应用读和写，可以在创建文件时，指定</span><span style="color:#000000;">Context.MODE_WORLD_READABLE</span><span style="color:#000000;">和</span><span style="color:#000000;">Context.MODE_WORLD_WRITEABLE</span><span style="color:#000000;">权限。</span></p> 
 <p><span style="color:#000000;">Activity</span><span style="color:#000000;">还提供了</span><span style="color:#000000;">getCacheDir()</span><span style="color:#000000;">和</span><span style="color:#000000;">getFilesDir()</span><span style="color:#000000;">方法：</span></p> 
 <p><span style="color:#000000;">getCacheDir()</span><span style="color:#000000;">方法用于获取</span><span style="color:#000000;">/data/data/&lt;package name&gt;/cache</span><span style="color:#000000;">目录</span></p> 
 <p><span style="color:#000000;">getFilesDir()</span><span style="color:#000000;">方法用于获取</span><span style="color:#000000;">/data/data/&lt;package name&gt;/files</span><span style="color:#000000;">目录</span></p> 
 <p> </p> 
 <p><strong><span style="color:#ff0000;">把文件存放在SDCard</span></strong></p> 
 <p><span style="color:#ff0000;"><strong>在程序中访问SDCard，你需要申请访问SDCard的权限</strong></span><span style="color:#000000;">。</span></p> 
 <p><span style="color:#000000;">在</span><span style="color:#000000;">AndroidManifest.xml</span><span style="color:#000000;">中加入访问</span><span style="color:#000000;">SDCard</span><span style="color:#000000;">的权限如下</span><span style="color:#000000;">:</span></p> 
 <p><span style="color:#000000;">&lt;!-- </span><span style="color:#000000;">在</span><span style="color:#000000;">SDCard</span><span style="color:#000000;">中创建与删除文件权限 </span><span style="color:#000000;">--&gt;</span></p> 
 <p><span style="color:#0070c0;">&lt;uses-permission android:name="android.permission.MOUNT_UNMOUNT_FILESYSTEMS"/&gt;</span></p> 
 <p><span style="color:#000000;">&lt;!-- </span><span style="color:#000000;">往</span><span style="color:#000000;">SDCard</span><span style="color:#000000;">写入数据权限 </span><span style="color:#000000;">--&gt;</span></p> 
 <p><span style="color:#0070c0;">&lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/&gt;</span></p> 
 <p><span style="color:#000000;">要往</span><span style="color:#000000;">SDCard</span><span style="color:#000000;">存放文件，程序必须先判断手机是否装有</span><span style="color:#000000;">SDCard</span><span style="color:#000000;">，并且可以进行读写。</span></p> 
 <p><span style="color:#FF0000;">注意：访问</span><span style="color:#FF0000;">SDCard</span><span style="color:#FF0000;">必须在</span><span style="color:#FF0000;">AndroidManifest.xml</span><span style="color:#FF0000;">中加入访问</span><span style="color:#FF0000;">SDCard</span><span style="color:#FF0000;">的权限</span></p> 
 <p><span style="color:#000000;">if(Environment.getExternalStorageState().equals(Environment.MEDIA_MOUNTED)){<!-- --></span></p> 
 <p><span style="color:#0070c0;">         </span>File sdCardDir = Environment.getExternalStorageDirectory();<span style="color:#00b050;">//</span><span style="color:#00b050;">获取</span><span style="color:#00b050;">SDCard</span><span style="color:#00b050;">目录</span></p> 
 <p><span style="color:#0070c0;">         </span><span style="color:#0070c0;">File saveFile = new File(sdCardDir, “itcast.txt”);</span></p> 
 <p><span style="color:#0070c0;">FileOutputStream outStream = new FileOutputStream(saveFile);</span></p> 
 <p><span style="color:#0070c0;">outStream.write("</span><span style="color:#0070c0;">传智播客</span><span style="color:#0070c0;">".getBytes());</span></p> 
 <p><span style="color:#0070c0;">outStream.close();</span></p> 
 <p><span style="color:#000000;">}</span></p> 
 <p><span style="color:#000000;">Environment.getExternalStorageState()</span><span style="color:#000000;">方法用于获取</span><span style="color:#000000;">SDCard</span><span style="color:#000000;">的状态，如果手机装有</span><span style="color:#000000;">SDCard</span><span style="color:#000000;">，并且可以进行读写，那么方法返回的状态等于</span><span style="color:#000000;">Environment.MEDIA_MOUNTED</span><span style="color:#000000;">。</span></p> 
 <p><span style="color:#000000;">Environment.getExternalStorageDirectory()</span><span style="color:#000000;">方法用于获取</span><span style="color:#000000;">SDCard</span><span style="color:#000000;">的目录，当然要获取</span><span style="color:#000000;">SDCard</span><span style="color:#000000;">的目录，你也可以这样写：</span></p> 
 <p><span style="color:#0070c0;">File sdCardDir = new File("/mnt/sdcard");</span><span style="color:#00b050;"> //</span><span style="color:#00b050;">获取</span><span style="color:#00b050;">SDCard</span><span style="color:#00b050;">目录</span></p> 
 <p><span style="color:#0070c0;">File saveFile = new File(sdCardDir, "itcast.txt");</span></p> 
 <p><span style="color:#00b050;">//</span><span style="color:#00b050;">上面两句代码可以合成一句： </span><span style="color:#00b050;">File saveFile = new File("/mnt/sdcard/itcast.txt");</span></p> 
 <p><span style="color:#000000;">FileOutputStream outStream = new FileOutputStream(saveFile);</span></p> 
 <p><span style="color:#000000;">outStream.write("</span><span style="color:#000000;">传智播客</span><span style="color:#000000;">test".getBytes());</span></p> 
 <p><span style="color:#000000;">outStream.close();</span></p> 
 <p> </p> 
 <p>2. 示例代码</p> 
 <p>获取SD卡大小示例代码</p> 
 <pre><code class="language-java">protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_main);
		TextView tv = (TextView) findViewById(R.id.tv_sdsize);
		File path = Environment.getExternalStorageDirectory();
		StatFs stat = new StatFs(path.getPath());
		long blockSize = stat.getBlockSize();
		long availableBlocks = stat.getAvailableBlocks();
		long sizeAvailSize = blockSize * availableBlocks;
		String str = Formatter.formatFileSize(this, sizeAvailSize);
		tv.setText(str);
	}</code></pre> 
 <p> </p> 
 <p>数据存储示例代码：</p> 
 <p>activity_main.xml 布局</p> 
 <pre><code class="language-html">&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".MainActivity" &gt;

    &lt;TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/input_name" /&gt;

    &lt;EditText
        android:id="@+id/et_name"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:inputType="text" /&gt;

    &lt;TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/input_password" /&gt;

    &lt;EditText
        android:id="@+id/et_password"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:inputType="textPassword" /&gt;

    &lt;RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" &gt;

        &lt;CheckBox
            android:id="@+id/cb_remember"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/remember_pwd" /&gt;

        &lt;Button
            android:onClick="login"
            android:layout_alignParentRight="true"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/login" /&gt;
    &lt;/RelativeLayout&gt;

    &lt;RadioGroup
        android:id="@+id/rg_save_location"
        android:orientation="horizontal"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" &gt;

        &lt;RadioButton
            android:id="@+id/rb_rom"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:checked="true"
            android:text="ROM" /&gt;

        &lt;RadioButton
            android:id="@+id/rb_sd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="SD" /&gt;

       
                &lt;RadioButton
            android:id="@+id/rb_sp"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="SP" /&gt;
    &lt;/RadioGroup&gt;

&lt;/LinearLayout&gt;</code></pre> 
 <p>AndroidManifest.xml SD权限</p> 
 <pre><code class="language-html">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.itheima.login"
    android:versionCode="1"
    android:versionName="1.0" &gt;

    &lt;uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" /&gt;
    &lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/&gt;

    &lt;application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" &gt;
        &lt;activity
            android:name="com.itheima.login.MainActivity"
            android:label="@string/app_name" &gt;
            &lt;intent-filter&gt;
                &lt;action android:name="android.intent.action.MAIN" /&gt;

                &lt;category android:name="android.intent.category.LAUNCHER" /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
    &lt;/application&gt;

&lt;/manifest&gt;</code></pre> 
 <p>SaveService.java 业务类</p> 
 <pre><code class="language-java">package com.itheima.login.service;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.util.HashMap;
import java.util.Map;

import android.content.Context;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.os.Environment;

import com.itheima.login.utils.StreamTools;

public class SaveService {
	/**
	 * 保存数据到手机rom的文件里面.
	 * @param context 应用程序的上下文 提供环境
	 * @param name 用户名
	 * @param password 密码
	 * @throws Exception
	 */
	public static void saveToRom(Context context, String name , String password) throws Exception{
		//File file = new File("/data/data/com.itheima.login/files/pwd.txt");
		File file = new File(context.getFilesDir(),"pwd.txt");
		FileOutputStream fos = new FileOutputStream(file);
		String txt = name+":"+password;
		fos.write(txt.getBytes());
		fos.flush();
		fos.close();
	}
	/**
	 * 从rom读取用户的密码信息
	 * @param context
	 * @return
	 */
	public static String readFromRom(Context context) throws Exception{
		File file = new File(context.getFilesDir(),"pwd.txt");
		FileInputStream fis = new FileInputStream(file);
		String result = StreamTools.readFromStream(fis);
		return result;
	}
	
	/**
	 * 保存数据到SD卡
	 * @param name 用户名
	 * @param password 密码
	 * @throws Exception
	 */
	public static void saveTOSD(String name ,String password) throws Exception{
		File file = new File(Environment.getExternalStorageDirectory(),"pwd.txt");
		FileOutputStream fos = new FileOutputStream(file);
		String txt = name+":"+password;
		fos.write(txt.getBytes());
		fos.flush();
		fos.close();
	}
	
	/**
	 * 保存应用程序数据 到sharedpreference
	 * @param context 上下文
	 * @param name 姓名
	 * @param password 密码
	 */
	public static void saveTOSP (Context context, String name, String password){
		//获取系统的一个sharedpreference文件  名字叫 sp
		SharedPreferences sp = context.getSharedPreferences("sp", Context.MODE_WORLD_READABLE+Context.MODE_WORLD_WRITEABLE);
		//创建一个编辑器 可以编辑 sp
		Editor editor = sp.edit();
		editor.putString("name", name);
		editor.putString("password", password);
		editor.putBoolean("boolean", false);
		editor.putInt("int", 8888);
		editor.putFloat("float",3.14159f);
		//注意:调用 commit 提交 数据到文件.
		editor.commit();
		//editor.clear();
	}
	
	/**
	 * 获取系统sharepreference里面的数据
	 * @param context
	 * @return
	 */
	public static Map&lt;String,String&gt; readFromSP(Context context){
		Map&lt;String,String&gt; map = new HashMap&lt;String, String&gt;();
		SharedPreferences sp = context.getSharedPreferences("sp", Context.MODE_PRIVATE);
		String name = sp.getString("name", "defaultname");
		String password = sp.getString("password", "password");
		map.put("name", name);
		map.put("password", password);
		return map;
	}
	
	
}
</code></pre> 
 <p>MainActivity.java </p> 
 <pre><code class="language-java">package com.itheima.login;

import java.util.Map;

import com.itheima.login.service.SaveService;

import android.os.Bundle;
import android.os.Environment;
import android.app.Activity;
import android.text.TextUtils;
import android.util.Log;
import android.view.View;
import android.widget.CheckBox;
import android.widget.EditText;
import android.widget.RadioGroup;
import android.widget.Toast;

public class MainActivity extends Activity {
	private static final String TAG = "MainActivity";
	private EditText et_name;
	private EditText et_password;
	private CheckBox cb_remember;
	private RadioGroup rg_save_location;

	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_main);
		et_name = (EditText) findViewById(R.id.et_name);
		et_password = (EditText) findViewById(R.id.et_password);
		cb_remember = (CheckBox) findViewById(R.id.cb_remember);
		rg_save_location = (RadioGroup) findViewById(R.id.rg_save_location);

		// 检查 rom文件里面是否 有 密码信息
		/*try {
			String result = SaveService.readFromRom(this);
			String[] infos = result.split(":");
			et_name.setText(infos[0]);
			et_password.setText(infos[1]);
		} catch (Exception e) {
			e.printStackTrace();
		}*/
		
		//获取sp里面的数据
		
		Map&lt;String, String&gt; map = SaveService.readFromSP(this);
		et_name.setText(map.get("name"));
		et_password.setText(map.get("password"));
		
	}

	public void login(View view) {
		String name = et_name.getText().toString().trim();
		String password = et_password.getText().toString().trim();
		if (TextUtils.isEmpty(name) || TextUtils.isEmpty(password)) {
			Toast.makeText(this, R.string.error_msg, Toast.LENGTH_SHORT).show();
			return;
		}
		if (cb_remember.isChecked()) {
			Log.i(TAG, "记住密码");
			Log.d(TAG, "NAME=" + name);
			Log.d(TAG, "PASSWORD=" + password);
			int radiobuttonId = rg_save_location.getCheckedRadioButtonId();
			switch (radiobuttonId) {
			case R.id.rb_rom:
				try {
					SaveService.saveToRom(this, name, password);
					Toast.makeText(this, "保存rom用户名密码 成功", Toast.LENGTH_LONG)
							.show();
				} catch (Exception e) {
					e.printStackTrace();
					Toast.makeText(this, "保存rom用户名密码 失败", Toast.LENGTH_LONG)
							.show();
				}
				break;

			case R.id.rb_sd:
				if (Environment.MEDIA_MOUNTED.equals(Environment
						.getExternalStorageState())) {
					try {
						SaveService.saveTOSD(name, password);
						Toast.makeText(this, "保存sd用户名密码 成功", Toast.LENGTH_LONG)
								.show();
					} catch (Exception e) {
						e.printStackTrace();
						Toast.makeText(this, "保存sd用户名密码 失败", Toast.LENGTH_LONG)
								.show();
					}
				}else{
					Toast.makeText(this, "sd卡不可用 ,请检查sd卡状态", 0).show();
				}
				break;
				
			case R.id.rb_sp:
				SaveService.saveTOSP(this, name, password);
				Toast.makeText(this, "保存到sp完成", 0).show();
				break;
			}

		} else {
			Log.i(TAG, "不需要记住密码");
		}

	}

}
</code></pre> 
 <p><br><br><br><br><br>  </p> 
 <p> </p> 
</div> 
<p>转载于:https://www.cnblogs.com/xj626852095/p/3647986.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7e30dec57b04db9114c0eddca81a4714/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">nodejs  daemon</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a9fd8bb859b91563e1c6b8161444d97d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">堆排序算法及其c语言泛型编程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>