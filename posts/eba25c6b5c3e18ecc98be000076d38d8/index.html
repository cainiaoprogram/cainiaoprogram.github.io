<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>开源Webmail客户端Claros inTouch2.1＋James MailServer配置和调试 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="开源Webmail客户端Claros inTouch2.1＋James MailServer配置和调试" />
<meta property="og:description" content="准备： 环境winxp &#43; jdk1.6 &#43; tomcat6.0.16 apache james2.3.2 (邮件服务器) Claros inTouch2.1.war (WebMail界面程序) 安装： 1、安装james邮件服务容器：james下载后直接解压后启动就可以了 bin目录中的run.bat和run.sh是James的启动程序。 apps目录下在服务器第一次启动之前，只有james.sar、dummy.txt两个文件，第一次启动后apps下会生产其他文件。apps\james\SAR-INF下有一个config.xml是james中的核心配置文件。config.xml是在第一次启动james服务器来。 运行run.dat启动服务器 Java代码 Using PHOENIX_HOME: C:\james-2.3.2 Using PHOENIX_TMPDIR: C:\james-2.3.2\temp Using JAVA_HOME: Phoenix 4.2 James Mail Server 2.3.2 Remote Manager Service started plain:4555 POP3 Service started plain:110 SMTP Service started plain:25 NNTP Service started plain:119 FetchMail Disabled Using PHOENIX_HOME: C:\james-2.3.2 Using PHOENIX_TMPDIR: C:\james-2.3.2\temp Using JAVA_HOME: Phoenix 4.2 James Mail Server 2.3.2 Remote Manager Service started plain:4555 POP3 Service started plain:110 SMTP Service started plain:25 NNTP Service started plain:119 FetchMail Disabled 对james_home\apps\james\SAR-INF\config." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/eba25c6b5c3e18ecc98be000076d38d8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-07-19T15:57:48+08:00" />
<meta property="article:modified_time" content="2011-07-19T15:57:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">开源Webmail客户端Claros inTouch2.1＋James MailServer配置和调试</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    准备： 
<br> 环境winxp + jdk1.6 + tomcat6.0.16 
<br> apache james2.3.2 (邮件服务器) 
<br> Claros inTouch2.1.war (WebMail界面程序) 
<br>安装： 
<br> 1、安装james邮件服务容器：james下载后直接解压后启动就可以了 
<br>bin目录中的run.bat和run.sh是James的启动程序。 
<br>apps目录下在服务器第一次启动之前，只有james.sar、dummy.txt两个文件，第一次启动后apps下会生产其他文件。apps\james\SAR-INF下有一个config.xml是james中的核心配置文件。config.xml是在第一次启动james服务器来。 
<br>运行run.dat启动服务器 
<br> 
<br>Java代码 
<br>Using PHOENIX_HOME: C:\james-2.3.2 
<br>Using PHOENIX_TMPDIR: C:\james-2.3.2\temp 
<br>Using JAVA_HOME: 
<br> 
<br>Phoenix 4.2 
<br> 
<br>James Mail Server 2.3.2 
<br>Remote Manager Service started plain:4555 
<br>POP3 Service started plain:110 
<br>SMTP Service started plain:25 
<br>NNTP Service started plain:119 
<br>FetchMail Disabled 
<br> 
<br>Using PHOENIX_HOME: C:\james-2.3.2 
<br>Using PHOENIX_TMPDIR: C:\james-2.3.2\temp 
<br>Using JAVA_HOME: 
<br> 
<br>Phoenix 4.2 
<br> 
<br>James Mail Server 2.3.2 
<br>Remote Manager Service started plain:4555 
<br>POP3 Service started plain:110 
<br>SMTP Service started plain:25 
<br>NNTP Service started plain:119 
<br>FetchMail Disabled 
<br> 对james_home\apps\james\SAR-INF\config.xml做修改。 
<br> 1.1：修改自己的邮件服务名 
<br>Java代码 
<br>&lt;postmaster&gt;Postmaster@localhost.com&lt;/postmaster&gt; 
<br> &lt;servernames autodetect="true" autodetectIP="true"&gt;&lt;!-- 如果将autodetect和autodetectIP设置为false，标识邮件服务器将不侦测ip--&gt; 
<br> &lt;servername&gt;localhost.com&lt;/servername&gt; 
<br> &lt;/servernames&gt; 
<br> 
<br> 1.2：修改dns服务。 
<br> 
<br>Java代码 
<br> &lt;dnsserver&gt; 
<br> &lt;servers&gt; 
<br> &lt;server&gt;XXXXXX&lt;/server&gt;本机IP 
<br> &lt;server&gt;XXXXXXX&lt;/server&gt;DNS服务地址 
<br> &lt;/servers&gt; 
<br> &lt;!-- 修改自动探测为false 如果为true 可能在开发时出现异常 --&gt; 
<br> &lt;autodiscover&gt;false&lt;/autodiscover&gt; 
<br> &lt;authoritative&gt;false&lt;/authoritative&gt; 
<br> &lt;maxcachesize&gt;50000&lt;/maxcachesize&gt; 
<br>&lt;/dnsserver&gt; 
<br> 
<br>修改了dns，(在开启smtp验证的情况下)注释掉以下配置， 
<br>Java代码 
<br>&lt;mailet match="RemoteAddrNotInNetwork=127.0.0.1" class="ToProcessor"&gt; 
<br> &lt;processor&gt; relay-denied &lt;/processor&gt; 
<br> &lt;notice&gt;550 - Requested action not taken: relaying denied&lt;/notice&gt; 
<br>&lt;/mailet&gt; 
<br>并且，开启SMTP Server 身份验证： 
<br>Java代码 
<br>&lt;authRequired&gt;true&lt;/authRequired&gt; 
<br> 
<br>将位于&lt;smtpserver&gt;标签之间的&lt;authRequired&gt;标签得值设为true 
<br> 
<br> 1.3：修改远程管理。以便在cmd控制台中执行telnet byzh.com 4566命令。 
<br>Java代码 
<br>&lt;remotemanager enabled="true"&gt; 
<br> &lt;port&gt;4566&lt;/port&gt; 
<br> &lt;handler&gt; 
<br> &lt;helloName autodetect="true"&gt;myMailServer&lt;/helloName&gt; 
<br> &lt;administrator_accounts&gt; 
<br> &lt;account login="root" password="123"/&gt; 
<br> &lt;/administrator_accounts&gt; 
<br> &lt;connectiontimeout&gt;60000&lt;/connectiontimeout&gt; 
<br> &lt;prompt&gt;welcome to mt Sever&gt;&lt;/prompt&gt; 
<br> &lt;/handler&gt; 
<br> &lt;/remotemanager&gt; 
<br>1.4：修改pop3，stmp，nntp服务。 
<br>Java代码 
<br> &lt;pop3server enabled="true"&gt; 
<br> &lt;port&gt;110&lt;/port&gt; 
<br> &lt;handler&gt; 
<br> &lt;helloName autodetect="true"&gt;myMailServer&lt;/helloName&gt; 
<br> &lt;connectiontimeout&gt;120000&lt;/connectiontimeout&gt; 
<br> &lt;/handler&gt; 
<br> &lt;/pop3server&gt; 
<br>Java代码 
<br>&lt;smtpserver enabled="true"&gt; 
<br> &lt;port&gt;25&lt;/port&gt; 
<br> &lt;handler&gt; 
<br> &lt;helloName autodetect="true"&gt;myMailServer&lt;/helloName&gt; 
<br> &lt;connectiontimeout&gt;360000&lt;/connectiontimeout&gt; 
<br> &lt;authRequired&gt;true&lt;/authRequired&gt; 
<br> &lt;authorizedAddresses&gt;127.0.0.0/8&lt;/authorizedAddresses&gt; 
<br> &lt;maxmessagesize&gt;0&lt;/maxmessagesize&gt; 
<br> &lt;/handler&gt; 
<br> &lt;/smtpserver&gt;Java代码 
<br>&lt;nntpserver enabled="true"&gt; 
<br> &lt;port&gt;119&lt;/port&gt; 
<br> &lt;handler&gt; 
<br> &lt;helloName autodetect="true"&gt;myMailServer&lt;/helloName&gt; 
<br> &lt;connectiontimeout&gt;120000&lt;/connectiontimeout&gt; 
<br> &lt;authRequired&gt;false&lt;/authRequired&gt; 
<br> &lt;/handler&gt; 
<br> &lt;/nntpserver&gt; 
<br> 1.5：James邮件用户的用户信息默认保存在apps\james\var\users目录下， 
<br> 通过修改配置文件apps\james\SAR-INF\config.xml，可以把用户信息保存到数据库中，配置方法如下 
<br> 打开config.xml，找到这一项，此面默认的内容为： 
<br>Java代码 
<br>&lt;repository name="LocalUsers" class="org.apache.james.userrepository.UsersFileRepository"&gt; 
<br> &lt;destination URL="file://var/users/"/&gt; 
<br> &lt;/repository&gt; 
<br>需要修改为: 
<br>Java代码 
<br>&lt;repository name="LocalUsers" class="org.apache.james.userrepository.JamesUsersJdbcRepository" 
<br> destinationURL="db://maildb/users"&gt; 
<br> &lt;sqlFile&gt;file://conf/sqlResources.xml&lt;/sqlFile&gt; 
<br> &lt;/repository&gt; 
<br> 通过修改，我们就把用户信息的存储介质从file改成了db，是指明了在db中的数据表结构及相关数据库信息。 
<br> 仍然是config.xml，找到项，注意先要创建好java_mail数据库，把此项内容修改为： 
<br>Java代码 
<br>&lt;data-source name="maildb" class="org.apache.james.util.mordred.JdbcDataSource"&gt; 
<br> &lt;driver&gt;com.mysql.jdbc.Driver&lt;/driver&gt; 
<br>3 &lt;dburl&gt;jdbc:mysql://127.0.0.1:3306/java_mail?useUnicode=true&amp;characterEncoding=gbk&lt;/dburl&gt; 
<br> &lt;user&gt;root&lt;/user&gt; 
<br> &lt;password&gt;123&lt;/password&gt; 
<br> &lt;max&gt;20&lt;/max&gt; 
<br> &lt;/data-source&gt; 
<br>&lt;driver&gt;是指MySQL的JDBC驱动，指数据库的访问路径，IP后的mail即MySQL中新建数据库名，接下来是用户名、密码及最大连接数。 需要讲mysql的驱动jar包添加到lib目录下. 
<br> 至此，数据库配置完成，启动James，若正常无误，请通过telnet添加一个新用户，比如adduser holen 123456，然后检查MySQL中的mail数据库，下面将有一个表users，这是James根据james_home\apps\james\conf的内容创建的。 
<br> 通过以上配置，James的用户信息就可以保存在数据库中了。 
<br> 
<br> 1.6：修改c:/windows/system32/drivers/etc/hosts文件，增加一个地址映射。 
<br>Java代码 
<br> 127.0.0.1 localhost 
<br> 
<br> 1.8：执行james_home\bin\run.bat，启动james2.3服务。 
<br> 
<br> 1.9：进入命令模式，执行telnet localhost 4566，连接james2.3服务。 
<br> 
<br> 2.0：以管理员省份登录james2.3服务，用户就是1.3节配置的root/123。 
<br> 2.1：添加2个用户 adduser lin lin ,adduser chen chen 
<br> 2.2：安装claros inTouch，下载claros-intouch-2.1，把intouch2.war拷贝到tomcat中。配置tomcat_home\webapps\intouch2\WEB-INF\config\config.xml。 
<br>Java代码 
<br>&lt;?xml version="1.0" encoding="UTF-8"?&gt; 
<br>&lt;claros-config&gt; 
<br> &lt;!-- COMMON PARAMETERS --&gt; 
<br> &lt;common-params&gt; 
<br> &lt;charset&gt;gbk&lt;/charset&gt; 
<br> &lt;!-- the timezone is not functional at 2.0 --&gt; 
<br> &lt;server-timezone&gt;Europe/Istanbul&lt;/server-timezone&gt; 
<br> &lt;!-- this directory must be writable (e.g. run a chmod 777 on it) --&gt; 
<br> &lt;tmp-dir&gt;/tmp&lt;/tmp-dir&gt; 
<br> &lt;!-- th e following two is in MB's--&gt; 
<br> &lt;max-attachment-size&gt;5&lt;/max-attachment-size&gt; 
<br> &lt;max-mail-size&gt;10&lt;/max-mail-size&gt; 
<br> &lt;title&gt;Claros inTouch 2.1&lt;/title&gt; 
<br> &lt;!-- We recommend running spamassasin. --&gt; 
<br> &lt;spam-check-enabled&gt;false&lt;/spam-check-enabled&gt; 
<br> &lt;!-- valid values are: da, de, en, fr, it, pt_br, pl, sk, tr, vi, zh_cn_utf8 --&gt; 
<br> &lt;default-lang&gt;en&lt;/default-lang&gt; 
<br> &lt;!-- this is the default rss feed. users can set their own --&gt; 
<br> &lt;rss-feed&gt;http://rss.cnn.com/rss/cnn_topstories.rss&lt;/rss-feed&gt; 
<br> &lt;/common-params&gt; 
<br> 
<br> &lt;!-- CHAT SERVER SETUP --&gt; 
<br> &lt;!-- if you have a jabber server with transports running such as 
<br> the MSN, yahoo, icq, aol transports the following transport 
<br> domains must be set. If you don't have your own jabber server 
<br> or not running transports omit the following settings. 
<br> --&gt; 
<br> &lt;chat&gt; 
<br> &lt;default-domain&gt;claros.org&lt;/default-domain&gt; 
<br> &lt;msn-transport&gt;msn.claros.org&lt;/msn-transport&gt; 
<br> &lt;yahoo-transport&gt;yahoo.claros.org&lt;/yahoo-transport&gt; 
<br> &lt;icq-transport&gt;icq.claros.org&lt;/icq-transport&gt; 
<br> &lt;aol-transport&gt;aol.claros.org&lt;/aol-transport&gt; 
<br> &lt;/chat&gt; 
<br> 
<br> &lt;!-- MAIL SERVER SETUP --&gt; 
<br> &lt;servers&gt; 
<br> &lt;server&gt; 
<br> &lt;!-- give any name you desire --&gt; 
<br> &lt;shortname&gt;localhost&lt;/shortname&gt; 
<br> &lt;!-- your imap/pop3 server ip/dns --&gt; 
<br> &lt;fetch-server&gt;127.0.0.1&lt;/fetch-server&gt; 
<br> &lt;!-- port you are running the pop3/imap server --&gt; 
<br> &lt;!--fetch-server-port&gt;143&lt;/fetch-server-port--&gt; 
<br> &lt;!-- which protocol? valid values are imap or pop3 (case sensitive) --&gt; 
<br> &lt;!--fetch-protocol&gt;imap&lt;/fetch-protocol--&gt; 
<br> &lt;!-- your smtp server's ip/dns --&gt; 
<br> &lt;fetch-server&gt;localhost&lt;/fetch-server&gt; 
<br> &lt;fetch-server-port&gt;110&lt;/fetch-server-port&gt; 
<br> &lt;fetch-protocol&gt;pop3&lt;/fetch-protocol&gt; 
<br> &lt;fetch-ssl&gt;false&lt;/fetch-ssl&gt; 
<br> &lt;smtp-server&gt;localhost&lt;/smtp-server&gt; 
<br> &lt;!-- port you are running the smtp server --&gt; 
<br> &lt;smtp-server-port&gt;25&lt;/smtp-server-port&gt; 
<br> &lt;!-- does your smtp server need authentication? --&gt; 
<br> &lt;smtp-authenticated&gt;true&lt;/smtp-authenticated&gt; 
<br> &lt;!-- IMAP only: if you use courier or cyrus you'll need to set the following to "INBOX." (with the dot(.) but omit the quotes) --&gt; 
<br> &lt;folder-namespace&gt;&lt;/folder-namespace&gt; 
<br> &lt;/server&gt; 
<br> &lt;/servers&gt; 
<br> 
<br> &lt;!-- THE DATABASE SETUP --&gt; 
<br> &lt;!-- 
<br> Please note that DB setup is essential to work. There is a intouch-mysql file in the SQL directory 
<br> of the zip file. Please create a database and dump the sql file to the db. 
<br> 
<br> mysqladmin -u root -p create intouch 
<br> mysql -u root -p intouch &lt; intouch-mysql.sql 
<br> --&gt; 
<br> &lt;db-config&gt; 
<br> &lt;db&gt; 
<br> &lt;!-- do not change the term file!!! --&gt; 
<br> &lt;id&gt;file&lt;/id&gt; 
<br> &lt;!-- the connection url for the JDBC connection --&gt; 
<br> &lt;database&gt;jdbc:mysql://localhost/java_mail?useUnicode=true&amp;characterEncoding=gbk&lt;/database&gt; 
<br> &lt;!-- the connection class --&gt; 
<br> &lt;driver&gt;com.mysql.jdbc.Driver&lt;/driver&gt; 
<br> &lt;!-- the user with read/write/delete/update/select permission to the database --&gt; 
<br> &lt;login&gt;root&lt;/login&gt; 
<br> &lt;!-- the plain text password --&gt; 
<br> &lt;password&gt;123&lt;/password&gt; 
<br> &lt;/db&gt; 
<br> &lt;/db-config&gt; 
<br>&lt;/claros-config&gt; 
<br>注意点：安装路径不能带空格，不然会找不到config.xml。 
<br> 正常情况下就可以登录了，数据库使用了是MySQL。 
<br> 
<br> 2.3：同样在java_mail数据库中创建inTouch webmail需要的表，sql文件在下载的claros-intouch包中。 
<br>2.4：启动tomcat，打开浏览器， 
<br>输入http://localhost/intouch2/index.jsp 
<br> 2.5：登录inTouch WebMail，用户lin/lin。 
<br> 
<br> 如果不能登录，可以查看log文件夹底下的log文件，查看出错信息。 
<br>附上：安装程序
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d1a49cc91334290e4ae8cfed9bb655e4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于 CPU的 基础知识</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ae878066d0f2943e3d2c9643cf4227af/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ABI  EABI</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>