<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MindOpt——优化虚拟电厂智能调度问题(一) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MindOpt——优化虚拟电厂智能调度问题(一)" />
<meta property="og:description" content="文章目录 背景光储荷经济性调度1. 问题描述2. 数学规划模型3. 使用MindOpt APL建模和求解3.1. 方法1：cell中直接输入代码3.2. 方法2：导入.mapl文件来运行 4. 结果解析 在本系列中，我们将介绍虚拟电厂多个实际应用场景中的智能决策，包括智慧楼宇、零碳园区等。
案例来源：https://opt.aliyun.com/example/aqIv2uBnQZfe/src/01_%E5%85%89%E5%82%A8%E8%8D%B7%E7%BB%8F%E6%B5%8E%E6%80%A7%E8%B0%83%E5%BA%A6.ipynb
案例作者：蒋蔚(蔚绛)
背景 近年来，在实现“双碳”目标的道路上，以风、光为代表的可再生能源作为缓解能源压力、促进可持续发展的重要途径广受关注。虚拟电厂作为一种区域性多能源聚合形式，实现了可再生能源大量接入电力系统运行，推动城市能源系统绿色高效发展。研究大规模常态化运行的虚拟电厂关键技术成为亟待解决的问题。分布式光伏、分布式储能及可控负荷等灵活性资源具有容量小、资源种类多、数量庞大等特点，难以直接参与电网互动运行。虚拟电厂有效聚合电源、负荷、储能等各类资源，参与电力市场，响应价格信号，为电网提供调峰、调频、调压与备用等辅助服务。
在电力市场价格、用户负荷需求、电源功率调节范围等参数随时间变化的情况下，我们考虑多时段优化问题，在满足各时刻功率平衡约束和设备固有约束的条件下，实现经济性调度最优，提供调度决策指令参考值。
在实际情况下，我们考虑虚拟电厂调度的问题难点主要包括以下两条：
不确定性：可再生能源、储能及负荷等单独运行时，电源容量较小，且具有较大的随机性、波动性、间歇性。例如： 发电功率：从产生原理来看，光伏、风力的发电和天气息息相关，具有不稳定性。用电负荷：用户端用电规律会随时间变化，同时，不同的用电场景（例如居民楼、商业楼、写字楼）具有不同的负荷特性。 多目标优化：在并网状态下，虚拟电厂与大电网同步运行，在孤网状态下，虚拟电厂需要自动控制电压和频率的平衡。在用电设备可控的情况下，我们可以联合调节用电负荷和储能设备实现虚拟电厂内部设备的协同和与电网的互动；但是，在本案例中，为了不影响居民或产业正常用电，我们希望在不削减负荷需求的情况下，通过控制虚拟电厂的储能单元，确保电力系统经济（降低电费）、低碳（降低碳排）、安全（削峰填谷）地运行。 为了应对以上问题，我们考虑不确定性存在情况下的决策。
首先，采用数学规划进行问题建模，确定决策变量、约束条件和目标函数；然后，通过MindOpt建模语言(MindOpt Algebra Programming Language, 简称为MAPL)将数学模型&#34;翻译&#34;为求解器可以理解的机器模型；最后，调用数学规划求解器(Solver)进行求解，进而得到最优决策。 光储荷经济性调度 本篇将以最简单的虚拟电厂场景为例，帮助快速理解。
1. 问题描述 我们考虑单个光伏、单个用户和单个储能设备在内的虚拟电厂场景中，在满足用户负荷需求的条件下，较短调度周期内（例如，四小时）的经济性最优目标。光伏可以发电给用户直用，也可以存储于储能设备中，在未来放电给用户使用；同时，光储不能覆盖的用户需求，可以从大电网中消费。
为了得到该调度问题的答案，我们首先需要将问题建模为数学规划问题，然后调用数学规划求解器来求解。
2. 数学规划模型 数学规划问题由三个要素组成： 决策变量，目标 和 约束条件，在该问题中具体如下：
考虑 T T T时间段调度问题，输入以下参数：
用户净负荷需求（负荷和光伏功率的差值）: L = ( l t ) ∈ R T L = (l_{t}) \in {\mathbb{R}}^{T} L=(lt​)∈RT （单位：kWh）电价： P = ( p t ) ∈ [ 0 , ∞ ) T P = (p_t) \in {[0, \infty)}^{T} P=(pt​)∈[0,∞)T （单位: $/kWh）储能充电效率： c 1 ∈ [ 0 , 1 ] c_1 \in [0,1] c1​∈[0,1]储能放电效率： c 2 ∈ [ 0 , 1 ] c_2 \in [0,1] c2​∈[0,1]储能单次充放电限制： α ∈ [ 0 , 1 ] \alpha \in [0,1] α∈[0,1] 决策变量为各时刻归一化的储能动作：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1945132b884ebb43799c7cb9e3ea4ea8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-03T17:34:04+08:00" />
<meta property="article:modified_time" content="2023-11-03T17:34:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MindOpt——优化虚拟电厂智能调度问题(一)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_7" rel="nofollow">背景</a></li><li><a href="#_32" rel="nofollow">光储荷经济性调度</a></li><li><ul><li><a href="#1__36" rel="nofollow">1. 问题描述</a></li><li><a href="#2__42" rel="nofollow">2. 数学规划模型</a></li><li><a href="#3_MindOpt_APL_72" rel="nofollow">3. 使用MindOpt APL建模和求解</a></li><li><ul><li><ul><li><a href="#31_1cell_76" rel="nofollow">3.1. 方法1：cell中直接输入代码</a></li><li><a href="#32_2mapl_189" rel="nofollow">3.2. 方法2：导入.mapl文件来运行</a></li></ul> 
   </li></ul> 
   </li><li><a href="#4__217" rel="nofollow">4. 结果解析</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p>在本系列中，我们将介绍虚拟电厂多个实际应用场景中的智能决策，包括智慧楼宇、零碳园区等。</p> 
<blockquote> 
 <p>案例来源：<a href="https://opt.aliyun.com/example/aqIv2uBnQZfe/src/01_%E5%85%89%E5%82%A8%E8%8D%B7%E7%BB%8F%E6%B5%8E%E6%80%A7%E8%B0%83%E5%BA%A6.ipynb" rel="nofollow">https://opt.aliyun.com/example/aqIv2uBnQZfe/src/01_%E5%85%89%E5%82%A8%E8%8D%B7%E7%BB%8F%E6%B5%8E%E6%80%A7%E8%B0%83%E5%BA%A6.ipynb</a><br> 案例作者：<strong>蒋蔚(蔚绛)</strong></p> 
</blockquote> 
<h2><a id="_7"></a>背景</h2> 
<p>近年来，在实现“双碳”目标的道路上，以风、光为代表的可再生能源作为缓解能源压力、促进可持续发展的重要途径广受关注。虚拟电厂作为一种区域性多能源聚合形式，实现了可再生能源大量接入电力系统运行，推动城市能源系统绿色高效发展。研究大规模常态化运行的虚拟电厂关键技术成为亟待解决的问题。分布式光伏、分布式储能及可控负荷等灵活性资源具有容量小、资源种类多、数量庞大等特点，难以直接参与电网互动运行。虚拟电厂有效聚合电源、负荷、储能等各类资源，参与电力市场，响应价格信号，为电网提供调峰、调频、调压与备用等辅助服务。</p> 
<p>在电力市场价格、用户负荷需求、电源功率调节范围等参数随时间变化的情况下，我们考虑多时段优化问题，在满足各时刻功率平衡约束和设备固有约束的条件下，实现经济性调度最优，提供调度决策指令参考值。</p> 
<p><img src="https://images2.imgbox.com/6c/ac/OxCswVrA_o.png" alt="image.png"></p> 
<p>在实际情况下，我们考虑虚拟电厂调度的问题难点主要包括以下两条：</p> 
<ol><li><strong>不确定性</strong>：可再生能源、储能及负荷等单独运行时，电源容量较小，且具有较大的随机性、波动性、间歇性。例如： 
  <ul><li>发电功率：从产生原理来看，光伏、风力的发电和天气息息相关，具有不稳定性。</li><li>用电负荷：用户端用电规律会随时间变化，同时，不同的用电场景（例如居民楼、商业楼、写字楼）具有不同的负荷特性。</li></ul> </li><li><strong>多目标优化</strong>：在并网状态下，虚拟电厂与大电网同步运行，在孤网状态下，虚拟电厂需要自动控制电压和频率的平衡。在用电设备可控的情况下，我们可以联合调节用电负荷和储能设备实现虚拟电厂内部设备的协同和与电网的互动；但是，在本案例中，为了不影响居民或产业正常用电，我们希望在不削减负荷需求的情况下，通过控制虚拟电厂的储能单元，确保电力系统经济（降低电费）、低碳（降低碳排）、安全（削峰填谷）地运行。</li></ol> 
<hr> 
<p>为了应对以上问题，我们考虑不确定性存在情况下的决策。</p> 
<ul><li>首先，采用数学规划进行问题建模，确定决策变量、约束条件和目标函数；</li><li>然后，通过MindOpt建模语言(MindOpt Algebra Programming Language, <strong>简称为MAPL</strong>)将数学模型"翻译"为求解器可以理解的机器模型；</li><li>最后，调用数学规划求解器(Solver)进行求解，进而得到最优决策。</li></ul> 
<hr> 
<h2><a id="_32"></a>光储荷经济性调度</h2> 
<p>本篇将以最简单的虚拟电厂场景为例，帮助快速理解。</p> 
<h3><a id="1__36"></a>1. 问题描述</h3> 
<p>我们考虑单个光伏、单个用户和单个储能设备在内的虚拟电厂场景中，在满足用户负荷需求的条件下，较短调度周期内（例如，四小时）的经济性最优目标。光伏可以发电给用户直用，也可以存储于储能设备中，在未来放电给用户使用；同时，光储不能覆盖的用户需求，可以从大电网中消费。</p> 
<p>为了得到该调度问题的答案，我们首先需要将问题建模为数学规划问题，然后调用数学规划求解器来求解。</p> 
<h3><a id="2__42"></a>2. 数学规划模型</h3> 
<p>数学规划问题由三个要素组成： <strong>决策变量</strong>，<strong>目标</strong> 和 <strong>约束条件</strong>，在该问题中具体如下：</p> 
<p>考虑<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         T 
        
       
      
        T 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span></span></span></span></span>时间段调度问题，输入以下参数：</p> 
<ul><li>用户净负荷需求（负荷和光伏功率的差值）: <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          L 
         
        
          = 
         
        
          ( 
         
         
         
           l 
          
         
           t 
          
         
        
          ) 
         
        
          ∈ 
         
         
         
           R 
          
         
           T 
          
         
        
       
         L = (l_{t}) \in {\mathbb{R}}^{T} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0197em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8413em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">T</span></span></span></span></span></span></span></span></span></span></span></span></span> （单位：kWh）</li><li>电价： <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          P 
         
        
          = 
         
        
          ( 
         
         
         
           p 
          
         
           t 
          
         
        
          ) 
         
        
          ∈ 
         
         
          
          
            [ 
           
          
            0 
           
          
            , 
           
          
            ∞ 
           
          
            ) 
           
          
         
           T 
          
         
        
       
         P = (p_t) \in {[0, \infty)}^{T} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.2312em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord"><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">∞</span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9812em;"><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">T</span></span></span></span></span></span></span></span></span></span></span></span></span> （单位: $/kWh）</li><li>储能充电效率： <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           c 
          
         
           1 
          
         
        
          ∈ 
         
        
          [ 
         
        
          0 
         
        
          , 
         
        
          1 
         
        
          ] 
         
        
       
         c_1 \in [0,1] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6891em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></li><li>储能放电效率： <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           c 
          
         
           2 
          
         
        
          ∈ 
         
        
          [ 
         
        
          0 
         
        
          , 
         
        
          1 
         
        
          ] 
         
        
       
         c_2 \in [0,1] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6891em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></li><li>储能单次充放电限制：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          α 
         
        
          ∈ 
         
        
          [ 
         
        
          0 
         
        
          , 
         
        
          1 
         
        
          ] 
         
        
       
         \alpha \in [0,1] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></li></ul> 
<p><strong>决策变量</strong>为各时刻归一化的储能动作：</p> 
<ul><li>充电变量：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          X 
         
        
          = 
         
        
          ( 
         
         
         
           x 
          
         
           t 
          
         
        
          ) 
         
        
          ∈ 
         
        
          [ 
         
        
          0 
         
        
          , 
         
        
          α 
         
         
         
           ] 
          
         
           T 
          
         
        
       
         X = (x_{t}) \in [0,\alpha]^{T} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0913em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">T</span></span></span></span></span></span></span></span></span></span></span></span></span></li><li>放电变量：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          Y 
         
        
          = 
         
        
          ( 
         
         
         
           y 
          
         
           t 
          
         
        
          ) 
         
        
          ∈ 
         
        
          [ 
         
        
          − 
         
        
          α 
         
        
          , 
         
        
          0 
         
         
         
           ] 
          
         
           T 
          
         
        
       
         Y = (y_{t}) \in [-\alpha,0]^{T} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0913em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">0</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">T</span></span></span></span></span></span></span></span></span></span></span></span></span></li><li>储能设备能量状态：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          S 
         
        
          = 
         
        
          ( 
         
         
         
           s 
          
         
           t 
          
         
        
          ) 
         
        
          ∈ 
         
        
          [ 
         
        
          0 
         
        
          , 
         
        
          1 
         
         
         
           ] 
          
         
           T 
          
         
        
       
         S = (s_{t}) \in[0,1]^{T} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">S</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0913em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">T</span></span></span></span></span></span></span></span></span></span></span></span></span></li></ul> 
<p>最小化经济性最优<strong>目标</strong>：</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
          
          
            m 
           
          
            i 
           
          
            n 
           
          
            i 
           
          
            m 
           
          
            i 
           
          
            z 
           
          
            e 
           
          
         
         
         
           X 
          
         
           , 
          
         
           Y 
          
         
           , 
          
         
           S 
          
         
        
        
       
         Cost 
        
       
         = 
        
        
        
          ∑ 
         
         
         
           t 
          
         
           = 
          
         
           1 
          
         
        
          T 
         
        
        
        
          ( 
         
         
         
           l 
          
          
          
            i 
           
          
            t 
           
          
         
        
          + 
         
         
         
           x 
          
          
          
            i 
           
          
            t 
           
          
         
        
          + 
         
         
         
           y 
          
          
          
            i 
           
          
            t 
           
          
         
        
          ) 
         
        
       
         ⋅ 
        
        
        
          p 
         
        
          t 
         
        
       
      
        \mathop{\mathrm{minimize}}_{X,Y,S} \quad \text{Cost} = \sum_{t=1}^T \left(l_{it}+x_{it}+y_{it}\right)\cdot p_t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;"></span><span class="mop"><span class="mop"><span class="mord"><span class="mord mathrm">minimize</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0785em;">X</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.2222em;">Y</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord text"><span class="mord">Cost</span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.2809em; vertical-align: -0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9812em;"><span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2997em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0197em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p> 
<p>满足以下<strong>约束条件</strong>：</p> 
<ul><li>储能设备功率约束：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          0 
         
        
          ≤ 
         
         
         
           x 
          
          
          
            i 
           
          
            t 
           
          
         
        
          ≤ 
         
        
          α 
          
        
          , 
          
        
          − 
         
        
          α 
         
        
          ≤ 
         
         
         
           y 
          
          
          
            i 
           
          
            t 
           
          
         
        
          ≤ 
         
        
          0 
          
        
          , 
         
         
        
          i 
         
        
          = 
         
        
          1 
         
        
          , 
         
        
          … 
         
        
          , 
         
        
          I 
         
        
          , 
           
        
          t 
         
        
          = 
         
        
          1 
         
        
          , 
         
        
          … 
         
        
          , 
         
        
          T 
         
        
       
         0 \le x_{it} \le \alpha\,, \, -\alpha \le y_{it} \le 0\,, \quad i = 1,\ldots,I,\,\,t=1,\ldots, T 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7804em; vertical-align: -0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.786em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8304em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8304em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span></span></span></span></span></li><li>储能能量状态更新：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           s 
          
          
          
            i 
           
          
            0 
           
          
         
        
          = 
         
        
          0 
          
        
          , 
          
         
         
           s 
          
          
          
            i 
           
          
            t 
           
          
         
        
          = 
         
         
         
           s 
          
          
          
            i 
           
          
            , 
           
          
            t 
           
          
            − 
           
          
            1 
           
          
         
        
          + 
         
         
         
           c 
          
         
           1 
          
         
        
          ⋅ 
         
         
         
           x 
          
          
          
            i 
           
          
            t 
           
          
         
        
          + 
         
         
         
           1 
          
          
          
            c 
           
          
            2 
           
          
         
        
          ⋅ 
         
         
         
           y 
          
          
          
            i 
           
          
            t 
           
          
          
        
          , 
         
         
        
          i 
         
        
          = 
         
        
          1 
         
        
          , 
         
        
          … 
         
        
          , 
         
        
          I 
         
        
          , 
           
        
          t 
         
        
          = 
         
        
          1 
         
        
          , 
         
        
          … 
         
        
          , 
         
        
          T 
         
        
       
         s_{i0} = 0\,,\, s_{it} = s_{i,t-1} + c_1 \cdot x_{it} + \frac{1}{c_2} \cdot y_{it}\,, \quad i = 1,\ldots,I,\,\,t=1,\ldots, T 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8694em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.5945em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.2902em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span></span></span></span></span></li><li>储能能量状态约束：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          0 
         
        
          ≤ 
         
         
         
           s 
          
          
          
            i 
           
          
            t 
           
          
         
        
          ≤ 
         
        
          1 
          
        
          , 
         
         
        
          i 
         
        
          = 
         
        
          1 
         
        
          , 
         
        
          … 
         
        
          , 
         
        
          I 
         
        
          , 
           
        
          t 
         
        
          = 
         
        
          1 
         
        
          , 
         
        
          … 
         
        
          , 
         
        
          T 
         
        
       
         0\le s_{it} \le 1\,, \quad i = 1,\ldots,I,\,\,t=1,\ldots, T 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7804em; vertical-align: -0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.786em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span></span></span></span></span></li></ul> 
<hr> 
<h3><a id="3_MindOpt_APL_72"></a>3. 使用MindOpt APL建模和求解</h3> 
<p>根据MindOpt APL的建模语法，建立此经济调度的完整模型，可如下两种方式运行。</p> 
<h5><a id="31_1cell_76"></a>3.1. 方法1：cell中直接输入代码</h5> 
<p>直接在cell中输入建模和求解的代码：</p> 
<pre><code>clear model;   #清除环境内存，多次run的时候使用
option modelname ../model/vpp_single; #定义存储文件名

#### 多时段优化问题
set T := 1..4;
set T0 := 1..5; # T时段前后共T+1个状态点

#### 功率和负荷
param load[T] := &lt;1&gt; 0.15, &lt;2&gt; 0.12, &lt;3&gt; 0.12, &lt;4&gt; 0.22; 
param power[T] := &lt;1&gt; 0.10, &lt;2&gt; 0.05, &lt;3&gt; 0.01, &lt;4&gt; 0.03;  

#### 单位电价
param price[T] := &lt;1&gt; 0.54, &lt;2&gt; 0.22, &lt;3&gt; 0.32, &lt;4&gt; 0.24; 

#### 充放电损耗系数
param charge_efficiency := 0.91;
param discharge_efficiency := 0.95;

#### 储能单次充放电限制
param nominal_power := 0.8;

#### 在不使用储能情况下的各指标，作为评测的对比基准值
param cost_base := sum{t in T} (load[t] - power[t]) * price[t];

#### 定义优化问题的变量
var x[T] &gt;= 0 &lt;= nominal_power; # 充电变量
var y[T] &lt;= 0 &gt;= - nominal_power; # 放电变量
var soc[T0] &gt;= 0 &lt;= 1; # State-of-Charge 储能设备状态

#### 定义优化目标函数
minimize Cost: sum{t in T} (load[t] - power[t] + x[t] + y[t]) * price[t] / cost_base;

#### 定义约束条件
subto State_of_Charge_Init: # 储能设备初始状态
    soc[1] == 0;
subto State_of_Charge_Update: # 储能设备状态更新
    forall {t in T} do
        soc[t+1] == soc[t] + x[t] * charge_efficiency + y[t] / discharge_efficiency;    

option solver mindopt;     # 指定求解用的求解器
solve;         # 求解

#### 展示结果
print "-----------------Display---------------"; 
print "Charging(+) / Discharging (-) Solution:";
forall {t in T} print 'Time {}: Solution {}'  % t, x[t] + y[t];

forall {t in T0} print 'Time {}: State-of-Charge {}'  % t-1, soc[t];

#### 评测指标
print "-----------------Evaluation Metrics---------------";
print "Cost = "; 
print sum{t in T} (load[t] - power[t] + x[t] + y[t]) * price[t] / cost_base;
</code></pre> 
<p>运行结果如下：</p> 
<pre><code>Running mindoptampl
wantsol=1
mip_integer_tolerance=1e-9
MindOpt Version 0.23.0 (Build date: 20221129)
Copyright (c) 2020-2022 Alibaba Cloud.

Start license validation (current time : 02-MAR-2023 13:48:19).
License validation terminated. Time : 0.002s

Model summary.
 - Num. variables     : 13
 - Num. constraints   : 4
 - Num. nonzeros      : 16
 - Bound range        : [8.0e-01,1.0e+00]
 - Objective range    : [1.8e+00,4.4e+00]
 - Matrix range       : [9.1e-01,1.1e+00]

Presolver started.
Presolver terminated. Time : 0.000s

Simplex method started.
Model fingerprint: =Y2dmZ2dvd3Y

    Iteration       Objective       Dual Inf.     Primal Inf.     Time
            0    -1.45041e+00      0.0000e+00      2.1141e+00     0.00s  
            3     6.32208e-01      0.0000e+00      0.0000e+00     0.00s  
Postsolver started.
Simplex method terminated. Time : 0.002s


OPTIMAL; objective 0.63
3 simplex iterations

Completed.
-----------------Display---------------
Charging(+) / Discharging (-) Solution:
Time 1: Solution 0
Time 2: Solution 0.8
Time 3: Solution -0.6915999999999991
Time 4: Solution 0
Time 0: State-of-Charge 0
Time 1: State-of-Charge 0
Time 2: State-of-Charge 0.7280000000000001
Time 3: State-of-Charge 0
Time 4: State-of-Charge 0
-----------------Evaluation Metrics---------------
Cost = 
0.6322077922077942
</code></pre> 
<h5><a id="32_2mapl_189"></a>3.2. 方法2：导入.mapl文件来运行</h5> 
<p>我们可将建模部分的代码保存为 <code>vpp_single.mapl</code>文件。然后运行如下code，进行建模和求解。</p> 
<pre><code>clear model;       # 清除模型的内存
model ../model/vpp_single.mapl;    # 链接.mapl模型文件，建模

option solver mindopt;     # 指定求解用的求解器
solve;         # 求解

#### 展示结果
print "-----------------Display---------------"; 
print "Charging(+) / Discharging (-) Solution:";
forall {t in T} print 'Time {}: Solution {}'  % t, x[t] + y[t];

forall {t in T0} print 'Time {}: State-of-Charge {}'  % t-1, soc[t];

#### 评测指标
print "-----------------Evaluation Metrics---------------";
print "Cost = "; 
print sum{t in T} (load[t] - power[t] + x[t] + y[t]) * price[t] / cost_base;
</code></pre> 
<p>运行结果与方法一一致。</p> 
<hr> 
<h3><a id="4__217"></a>4. 结果解析</h3> 
<ul><li>在执行 <code>model</code>命令后，MAPL将 <code>.mapl</code>中声明的数学规划模型转化成机器可以理解的模型。</li><li>在执行 <code>solve</code>命令后，MAPL将启动mindopt求解器进行求解，此时屏幕会打印出mindopt的求解过程。同时会在.mapl文件的同目录下生成待求解问题文件 <code>vpp_single.nl</code>和解文件 <code>vpp_single.sol</code>。</li><li>在执行 <code>print</code>命令后，MAPL将打印如下结果：</li></ul> 
<hr> 
<pre><code>-----------------Display---------------
Charging(+) / Discharging (-) Solution:
Time 1: Solution 0
Time 2: Solution 0.8
Time 3: Solution -0.6931199999999991
Time 4: Solution 0
Time 0: State-of-Charge 0
Time 1: State-of-Charge 0
Time 2: State-of-Charge 0.7296
Time 3: State-of-Charge 0
Time 4: State-of-Charge 0
-----------------Evaluation Metrics---------------
Cost = 
0.6282597402597423
</code></pre> 
<hr> 
<p>其中显示了各时段储能决策变量的最优值分别为:</p> 
<ul><li>第一个小时：不进行储能操作（即：光伏直用，剩余需求从电网购买）。</li><li>第二个小时：充电80%。</li><li>第三个小时：放电69.3%。</li><li>第四个小时：不进行操作。</li></ul> 
<p>最终，我们可以得到最优目标函数为0.63，即上述最优储能调度对比不使用储能，可以节省37%电费。</p> 
<p>为了简明起见，这个例子只用了4个时间段变量，但是相同的模型可以扩展到任意多个时间段，以满足更全面和准确的调度分析需求。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2be723ae79b63c6f50a745cdd3d50f2a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">鲁棒线性回归问题，使用MindOpt也可优化</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c8993ab82b0183835406919896f3a782/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何吃，少花钱又营养丰富？可用MindOpt线性规划求解来决策</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>