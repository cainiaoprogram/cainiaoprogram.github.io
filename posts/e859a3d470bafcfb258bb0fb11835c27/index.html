<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>keil MDK5插件推荐——Astyle代码格式化插件 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="keil MDK5插件推荐——Astyle代码格式化插件" />
<meta property="og:description" content="前言 代码格式化是提高代码质量和可读性的重要手段之一。然而，在Keil MDK5中并没有内置代码格式化工具，因此需要寻找第三方工具来解决这个问题。开源的代码格式化工具Astyle能以插件的形式集成到Keil中以满足我们对代码格式化的需求。
本文将详细介绍如何下载、配置Astyle，并在Keil中设置Astyle，以及使用快捷键调用Astyle的方法。
一. Astyle介绍 Astyle官网：https://astyle.sourceforge.net/
Artistic Style 是一种用于 C、C&#43;&#43;、C&#43;&#43;/CLI、Objective-C、C# 和 Java 编程语言的源代码缩进器、格式化程序和美化程序。它用 C&#43;&#43; 编写，可以从命令行中使用，也可以被嵌入到另一个程序中作为库。选项可以从命令行或选项文件中输入。库版本可以从用其他语言编写的程序中调用。
Artistic Style 为开源软件，可以在 MIT 许可证下使用和分发。MIT 许可证是一种对软件使用最少限制的宽松许可证。它与 GNU 通用公共许可证 (GPL) 和大多数其他许可证兼容。
从官网可以进入Astyle的文档和下载界面。
二. Astyle常用配置 此节完全参考Astyle的Documentation，但仅列出了我了个人感兴趣的关于C语言的配置选项，对于其它的C语言配置选项以及其它语言配置选项均未列出，对全部配置选项感兴趣的同学可去官网看文档。
2.1 Brace Style Options（花括号样式选项） 1.–style=allman / --style=bsd / --style=break / -A1
​ Allman样式使用折行的大括号。
2.–style=java / --style=attach / -A2
​ Java样式使用紧挨着的大括号。
3.–style=kr / --style=k&amp;r / --style=k/r / -A3
​ Kernighan &amp; Ritchie样式使用Linux风格的花括号。命名空间、类和函数定义的左花括号是单独一行的。花括号与其他所有内容都相连，包括函数内的数组、结构、枚举和语句。
​ 使用k&amp;r选项可能会因为&amp;符号而导致问题。可以通过将k&amp;r用引号括起来（例如 ‑‑style=“k&amp;r”）或使用其中一个备选项（‑‑style=kr或‑‑style=k/r）来解决此问题。
4.–style=1tbs / --style=otbs / -A10" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e859a3d470bafcfb258bb0fb11835c27/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-17T00:30:31+08:00" />
<meta property="article:modified_time" content="2023-05-17T00:30:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">keil MDK5插件推荐——Astyle代码格式化插件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <img src="https://images2.imgbox.com/49/ff/kXVWwDtU_o.png"> 
<hr> 
<h3><a id="center_7"></a> 
 <center>
   前言 
 </center></h3> 
<p>代码格式化是提高代码质量和可读性的重要手段之一。然而，在Keil MDK5中并没有内置代码格式化工具，因此需要寻找第三方工具来解决这个问题。开源的代码格式化工具Astyle能以插件的形式集成到Keil中以满足我们对代码格式化的需求。</p> 
<p>本文将详细介绍如何下载、配置Astyle，并在Keil中设置Astyle，以及使用快捷键调用Astyle的方法。</p> 
<hr> 
<h3><a id="center_Astyle_15"></a> 
 <center>
   一. Astyle介绍 
 </center></h3> 
<p>Astyle官网：<a href="https://astyle.sourceforge.net/" rel="nofollow">https://astyle.sourceforge.net/</a></p> 
<p>Artistic Style 是一种用于 C、C++、C++/CLI、Objective-C、C# 和 Java 编程语言的源代码缩进器、格式化程序和美化程序。它用 C++ 编写，可以从命令行中使用，也可以被嵌入到另一个程序中作为库。选项可以从命令行或选项文件中输入。库版本可以从用其他语言编写的程序中调用。</p> 
<p>Artistic Style 为开源软件，可以在 MIT 许可证下使用和分发。MIT 许可证是一种对软件使用最少限制的宽松许可证。它与 GNU 通用公共许可证 (GPL) 和大多数其他许可证兼容。</p> 
<img src="https://images2.imgbox.com/1e/e2/vxNOfVV8_o.png"> 
<p>从官网可以进入Astyle的文档和下载界面。</p> 
<h3><a id="_Astyle_27"></a>二. Astyle常用配置</h3> 
<p>此节完全参考Astyle的<strong>Documentation</strong>，但仅列出了我了个人感兴趣的关于C语言的配置选项，对于其它的C语言配置选项以及其它语言配置选项均未列出，对全部配置选项感兴趣的同学可去官网看文档。</p> 
<h4><a id="21_Brace_Style_Options_31"></a>2.1 Brace Style Options（花括号样式选项）</h4> 
<p>1.<strong>–style=allman / --style=bsd / --style=break / -A1</strong></p> 
<p>​ Allman样式使用折行的大括号。</p> 
<p>2.<strong>–style=java / --style=attach / -A2</strong></p> 
<p>​ Java样式使用紧挨着的大括号。</p> 
<p>3.<strong>–style=kr / --style=k&amp;r / --style=k/r / -A3</strong></p> 
<p>​ Kernighan &amp; Ritchie样式使用Linux风格的花括号。命名空间、类和函数定义的左花括号是单独一行的。花括号与其他所有内容都相连，包括函数内的数组、结构、枚举和语句。</p> 
<p>​ 使用k&amp;r选项可能会因为&amp;符号而导致问题。可以通过将k&amp;r用引号括起来（例如 ‑‑style=“k&amp;r”）或使用其中一个备选项（‑‑style=kr或‑‑style=k/r）来解决此问题。</p> 
<p>4.<strong>–style=1tbs / --style=otbs / -A10</strong></p> 
<p>​ "One True Brace Style"使用Linux风格的花括号，并且对没有花括号的单行条件语句添加花括号。命名空间、类和函数定义的左花括号是单独一行的。花括号与其他所有内容都相连，包括函数内的数组、结构、枚举和语句。</p> 
<p>4种风格的对比如下图所示。<strong>我个人更偏爱1tbs样式</strong>。</p> 
<img src="https://images2.imgbox.com/27/4f/zk3ojAzh_o.png"> 
<h4><a id="22_Tab_OptionsTab_55"></a>2.2 Tab Options（Tab选项）</h4> 
<p>默认选项：–indent=spaces=<strong>4</strong>或者-s<strong>4</strong>，意思是用4个空格替代Tab，所以这部分保持默认即可，<strong>无需设置</strong>。</p> 
<h4><a id="23_Brace_Modify_Options_59"></a>2.3 Brace Modify Options（大括号修改选项）</h4> 
<p>1.<strong>–attach-closing-while</strong></p> 
<p>将“do-while”循环语句的“while”附加到关闭大括号上。此选项比大括号样式和“break closing braces”选项具有更高的优先级。</p> 
<img src="https://images2.imgbox.com/81/16/KoUAQFzu_o.png"> 
<h4><a id="24_Indentation_Options_67"></a>2.4 Indentation Options（缩进选项）</h4> 
<p>1.<strong>–indent-preproc-define</strong></p> 
<p>定义多行define的缩进。</p> 
<img src="https://images2.imgbox.com/f2/74/97AlMWtd_o.png"> 
<p>2.<strong>–indent-col1-comments / -Y</strong></p> 
<p>缩进以第一列开头的C++注释。默认情况下，C++中以第一列开头的注释被视为注释掉的代码并不进行缩进。使用此选项可以使这些注释与代码一起进行缩进。</p> 
<img src="https://images2.imgbox.com/e5/b7/A9tBu2W5_o.png"> 
<h4><a id="25_Padding_Options_81"></a>2.5 Padding Options（填充选项）</h4> 
<p>1.<strong>–break-blocks / -f</strong></p> 
<p>在控制块周围添加空行（例如，‘if’，‘for’，‘while’…）。</p> 
<img src="https://images2.imgbox.com/0a/bf/zpCSKEKE_o.png"> 
<p>2.<strong>–pad-oper / -p</strong></p> 
<p>在运算符周围插入空格填充。这也会在逗号周围添加空格。任何行尾注释将尽可能保留在原始列中。请注意，没有取消填充的选项。一旦填充了，它们就保持填充状态。</p> 
<img src="https://images2.imgbox.com/1e/0f/yjxeextW_o.png"> 
<p>3.<strong>–pad-comma / -xg</strong></p> 
<p>在逗号后插入空格填充。如果使用pad-oper，这不是必需的。任何行尾注释将尽可能保留在原始列中。请注意，没有取消填充的选项。一旦填充了，它们就保持填充状态。</p> 
<img src="https://images2.imgbox.com/62/d5/Zrn6Ujm8_o.png"> 
<p>4.<strong>–pad-header / -H</strong></p> 
<p>在头部（例如，‘if’，‘for’，‘while’…）和随后的括号之间插入空格填充。任何行尾注释将尽可能保留在原始列中。这可以与unpad-paren一起使用，以删除不需要的空格。</p> 
<img src="https://images2.imgbox.com/00/63/tD9dLqVA_o.png"> 
<p>5.<strong>–unpad-paren / -U</strong></p> 
<p><strong>删除括号内外的额外空格填充</strong>。任何行尾注释将尽可能保留在原始列中。此选项可以与上面的paren padding选项pad‑paren、pad‑paren‑out、pad‑paren‑in和pad‑header组合使用。只会移除其他选项未请求的填充。</p> 
<p>例如，如果源代码中的括号内外都有填充，而您只想保留内部填充。您需要使用unpad-paren来删除外部填充，然后使用pad‑paren‑in来保留内部填充。仅使用pad‑paren‑in可能不会删除外部填充。</p> 
<img src="https://images2.imgbox.com/2a/51/YVPj5egZ_o.png"> 
<p>6.<strong>–delete-empty-lines / -xe</strong></p> 
<p>删除函数或方法中的空行。函数或方法外的空行不会被删除。如果与break-blocks或break-blocks = all一起使用，则将删除除break-blocks选项添加的行之外的所有行。</p> 
<img src="https://images2.imgbox.com/dc/98/A1ysPydQ_o.png"> 
<p>7.<strong>–align-pointer=name / -k3</strong></p> 
<p>将指针或引用运算符（*，&amp;或^）靠近变量名称，这是更优秀的C语言风格，特别是在同一行声明多个变量时，更加清晰。</p> 
<img src="https://images2.imgbox.com/80/b4/0rT56Tqd_o.png"> 
<h4><a id="26_Formatting_Options_127"></a>2.6 Formatting Options（格式化选项）</h4> 
<p>1.<strong>–break-one-line-headers / -xb</strong></p> 
<p>从与语句位于同一行的语句中断一行标题（例如，‘if’，‘while’，‘else’，…）。如果语句被大括号括起来，则大括号将根据请求的大括号样式进行格式化。</p> 
<p>如果请求keep-one-line-statements，则不会中断多语句行。如果请求keep-one-line-blocks并且标题包含在块中，则不会中断一行块。</p> 
<img src="https://images2.imgbox.com/6a/52/72C18mCS_o.png"> 
<p>2.<strong>–add-braces / -j</strong></p> 
<p>向未加括号的一行条件语句（例如，‘if’，‘for’，‘while’ …）添加大括号。语句必须在单行上。大括号将根据请求的大括号样式添加。如果没有请求样式，则将添加大括号。如果选择–style=1tbs 则此选项可不需要。</p> 
<p>如果请求keep-one-line-statements，则不会向多语句行添加大括号。如果请求keep-one-line-blocks，则不会向一行块添加大括号。如果与–add-one-line-braces一起使用，则结果将是一行括号。</p> 
<img src="https://images2.imgbox.com/45/a5/JngKiqPC_o.png"> 
<p>3.<strong>–max-code-length=# / -xC</strong>#</p> 
<p>max-code-length选项将在代码超过#个字符时中断该行。有效值为50到200。没有逻辑条件的行将在逻辑条件（||，&amp;&amp;，…），逗号，括号，分号或空格上中断。</p> 
<p>某些代码不会被中断，例如注释、引号和数组。如果与keep-one-line-blocks或add-one-line-braces一起使用，则不会中断块。如果与keep-one-line-statements一起使用，则如果行超过最大长度，语句将在分号处中断。如果在最大代码长度内没有可用的断点，则该行将在最大代码长度后找到第一个可用的断点处中断。</p> 
<img src="https://images2.imgbox.com/7f/3f/XGpZRuOO_o.png"> 
<p>建议设置为–max-code-length=120。</p> 
<hr> 
<h3><a id="center_Astyle_157"></a> 
 <center>
   三. Astyle无法实现的效果 
 </center></h3> 
<p>1.<strong>无法实现两个短行拼成一个长行的效果</strong>。</p> 
<img src="https://images2.imgbox.com/4b/a3/aS2WrtAr_o.png"> 
<p>2.<strong>无法去除非括号内多余的空格</strong></p> 
<img src="https://images2.imgbox.com/4e/f2/xH8IZld0_o.png"> 
<p>其它无法实现的效果（待补充）…。</p> 
<p>总的来说Astyle的代码格式化功能还是不那么完善，格式化效果Clang-foramt，它的主要优势是使用起来比较简单方便。</p> 
<hr> 
<h3><a id="center_KeilAstyle_173"></a> 
 <center>
   四. 在Keil中设置Astyle 
 </center></h3> 
<p>解压下载得到的安装包，将其放到Keil安装目录中，如F:\Keil_v5\，如下图所示。</p> 
<img src="https://images2.imgbox.com/bd/00/WS6KJrof_o.png"> 
<p>打开Keil，<kbd>Tools</kbd> -&gt; <kbd>Customize Tools Menu…</kbd>，</p> 
<img src="https://images2.imgbox.com/d8/43/mFHo75vx_o.png"> 
<img src="https://images2.imgbox.com/aa/98/69CodkTF_o.png"> 
<p>在Command（命令）行中填入astyle.exe的绝对路径。</p> 
<p>在Arguments（参数）行中填入配置选项，如下：</p> 
<pre><code class="prism language-c"><span class="token operator">!</span>E <span class="token operator">--</span>style<span class="token operator">=</span><span class="token number">1</span>tbs <span class="token operator">--</span>indent<span class="token operator">-</span>col1<span class="token operator">-</span>comments <span class="token operator">--</span><span class="token keyword">break</span><span class="token operator">-</span>blocks <span class="token operator">--</span>pad<span class="token operator">-</span>oper <span class="token operator">--</span>pad<span class="token operator">-</span>comma <span class="token operator">--</span>pad<span class="token operator">-</span>header <span class="token operator">--</span>unpad<span class="token operator">-</span>paren <span class="token operator">--</span>delete<span class="token operator">-</span>empty<span class="token operator">-</span>lines <span class="token operator">--</span>align<span class="token operator">-</span>pointer<span class="token operator">=</span>name <span class="token operator">--</span><span class="token keyword">break</span><span class="token operator">-</span>one<span class="token operator">-</span>line<span class="token operator">-</span>headers <span class="token operator">--</span>add<span class="token operator">-</span>braces <span class="token operator">--</span>max<span class="token operator">-</span>code<span class="token operator">-</span>length<span class="token operator">=</span><span class="token number">120</span>
</code></pre> 
<p>在文章中不方便复制的同学可以关注我的公众号：徐晓康的博客，回复以下四位数字获取配置。</p> 
<p>3567</p> 
<p>建议复制过去不会码错字！</p> 
<p>设置完之后，就可以通过<kbd>Tools</kbd> -&gt; <kbd>Astyle Current File</kbd>，<strong>来调用Astyle格式化当前文件</strong>，如下图所示。</p> 
<p><strong>注意，必须先Ctrl + S保存更改后再调用Astyle，否则调用是无效的</strong>。</p> 
<img src="https://images2.imgbox.com/bf/f3/Bm0cb7ax_o.png"> 
<p><strong>如果想更方便的调用Astyle，可以设置快捷键</strong>，方法如下：</p> 
<p><kbd>Edit </kbd>-&gt; <kbd>Configuration…</kbd>，打开配置窗口，在Shorteut Keys界面找到Tools:Astyle Current File，点击<kbd>Create Shortcut</kbd>，输入想设置的快捷键即可。</p> 
<img src="https://images2.imgbox.com/a4/88/8Ak3vmlC_o.png"> 
<hr> 
<img src="https://images2.imgbox.com/ec/1d/oy4tEeVW_o.png"> 
<p><strong>徐晓康的博客</strong>持续分享高质量硬件、FPGA与嵌入式知识，软件，工具等内容，欢迎大家关注。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9870194c4cc2ed56f080f0191ca9797d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">eclipse连接SQLserver</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9a5a227966ed894c8cfe56e2ba3a74c8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">青龙面板最全依赖</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>