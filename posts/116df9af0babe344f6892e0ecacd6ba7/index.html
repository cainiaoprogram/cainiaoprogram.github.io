<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java.lang.ClassCastException: java.util.ArrayList cannot be cast to java.util.Map的解决和补充 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java.lang.ClassCastException: java.util.ArrayList cannot be cast to java.util.Map的解决和补充" />
<meta property="og:description" content="一、问题描述 报错：java.lang.ClassCastException: java.util.ArrayList cannot be cast to java.util.Map
二、解决 导致这个问题是因为，存进去的是list，却直接强转为map。
有这样一段代码：（注：代码已经做了“马赛克”处理）
TestObject t = new TestObject(); List&lt;Map&lt;String, Object&gt;&gt; list1= new ArrayList&lt;&gt;(); Map&lt;String, Object&gt; map1= new HashMap&lt;&gt;(); map1.put(&#34;test&#34;, test); list1.add(map1); t.put(&#34;aaa&#34;, list1); 原来取值的时候：
TestObject testObject = (TestObject) object; Map&lt;String, Object&gt; map2 = (Map&lt;String, Object&gt;) testObject .get(&#34;aaa&#34;); 然后就报错了java.lang.ClassCastException: java.util.ArrayList cannot be cast to java.util.Map
是因为存进去的是list，却强转为map
所以这里要多加一层转换，先拿到list，再去取map
TestObject testObject = (TestObject) object; List&lt;Map&lt;String, Object&gt;&gt; list2 = (List&lt;Map&lt;String, Object&gt;&gt;) testObject.get(&#34;aaa&#34;); if (list2 == null) continue; Map&lt;String, Object&gt; map2 = list2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/116df9af0babe344f6892e0ecacd6ba7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-09T15:05:06+08:00" />
<meta property="article:modified_time" content="2022-05-09T15:05:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java.lang.ClassCastException: java.util.ArrayList cannot be cast to java.util.Map的解决和补充</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>一、问题描述</h4> 
<p>报错：java.lang.ClassCastException: java.util.ArrayList cannot be cast to java.util.Map</p> 
<p></p> 
<h4>二、解决</h4> 
<p>导致这个问题是因为，存进去的是list，却直接强转为map。</p> 
<p>有这样一段代码：（注：代码已经做了“马赛克”处理）</p> 
<pre><code>TestObject t = new TestObject();  
List&lt;Map&lt;String, Object&gt;&gt; list1= new ArrayList&lt;&gt;();
Map&lt;String, Object&gt; map1= new HashMap&lt;&gt;();
map1.put("test", test);
list1.add(map1);
t.put("aaa", list1);
</code></pre> 
<p>原来取值的时候：</p> 
<pre><code>TestObject testObject = (TestObject) object;

Map&lt;String, Object&gt; map2 = (Map&lt;String, Object&gt;) testObject .get("aaa");</code></pre> 
<p>然后就报错了java.lang.ClassCastException: java.util.ArrayList cannot be cast to java.util.Map</p> 
<p><span style="background-color:#ffd900;">是因为存进去的是list，却强转为map</span></p> 
<p><span style="background-color:#ffd900;">所以这里要多加一层转换，先拿到list，再去取map</span></p> 
<pre><code>TestObject testObject = (TestObject) object;
List&lt;Map&lt;String, Object&gt;&gt; list2 = (List&lt;Map&lt;String, Object&gt;&gt;) testObject.get("aaa");
if (list2 == null) continue;
Map&lt;String, Object&gt; map2 = list2.get(0);</code></pre> 
<h4>三、补充</h4> 
<p>有时报错：java.lang.ClassCastException: java.util.Arrays$ArrayList cannot be cast to java.util.ArrayList..</p> 
<p>等等诸如此类的报错，都是存进和取出的不恰当，怎么存的，就该怎么取。</p> 
<p>有些同学可能觉得这样的代码奇奇怪怪，但是一个项目不只是一个做的，不同的人有不同的做法，我这里出现的bug，就是因为上层代码的改变，致使我下层的代码出现这个错误。</p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/34a84ae00a037d59be0bc933118148aa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">kubelet启动报错cannot find network namespace for the terminated container</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9c9de741b625640bf8651b1ab3bc54ed/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">RK3566 Android11 替换开机logo导致死机问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>