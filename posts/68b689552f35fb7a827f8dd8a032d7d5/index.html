<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【pandas】模块——DataFrame数据处理（一） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【pandas】模块——DataFrame数据处理（一）" />
<meta property="og:description" content="DataFrame-数据创建与导入 下一篇：dataframe数据筛选(二)
下二篇：dataframe高级用法(三）
这里写目录标题 DataFrame-数据创建与导入一定义1.1 特征1.2 获得DataFrame的两种方式1.3.导出csv文件 二、 数据检查2.1 查考表头和表尾 2.2查看列名 2.3 查看索引 2.4查看行列数 2.5查看数据类型2.6查看空值2.7查看数据表的信息2.8查看唯一值三、 数据清洗3.1缺失值处理3.2清楚空格3.3转换数据格式3.4大小写转换3.5更改列名3.6更改索引 四、 重复值处理4.1查看是否有重复值4.2保留重复值 五、替换值六、数据的增删改6.1 增加行6.2删除行6.3修改行6.4增加列&lt;/font&gt;6.5删除列&lt;/font&gt;6.6修改列&lt;/font&gt; 七、数据集合并 7.1按照公有的列表名为“name&#34;进行合并`merge`7.2按照两个数据指定的列的列名合并`merge`7.3 按照多个键来进行合并`merge`7.4 数据的轴向连接`concat`7.4.1axis=0数据拼接7.4.2纵轴的连接,axis=1 7.5 合并重叠数据 `combine_first` 八、数据分组8.1通过条件判断来进行二分组8.2通过条件判断划分为多个组 &lt;/font&gt; 九、数据割分列与合并列9.11列分割2列 9.2合并 十、排序10.1根据值来排序 `.sort_values() `10.2根据索引来排序 &lt;/font&gt; `.sort_index()`10.3排名 `.rank()` ,红,橙,蓝
一定义 DataFrame是一种表格型的数据结构
姓名类型成绩0张三高中891李四初中90 1.1 特征 第一行为字段,即列名,从第二行开始为一行一行的记录每列可以是不同的值类型(数值/字符串/布尔值等)即有行索引也有列索引 1.2 获得DataFrame的两种方式 A. 自己创建DateFrame
A.1 通过字典的方式创建DataFrame
通过单层字典创建通过嵌套字典创建 import pandas as pd df=pd.DataFrame({&#39;a&#39;:[1,3,3,4],&#39;b&#39;:[2,3,6,7],&#39;c&#39;:[10,2,3,4]}) df 注意
arange(12):其实和arange()差不多,只不过arange是在数组意义上的快速生成数列的方法reshape(3,4):将数组对象按照3行4列的方式排列index:索引columns:列名 A.2 在表格中取列并生成新的表格
索引为字符串 d3=df[[‘站点编号’,‘借车总量’,‘还车总量’]]索引为数字 df[[1,2,3]] B .从外部导入dataframe
导入csv文件 .对于windows系统,在导入数据时可能会遇到一些编码问题,添加参数encoding=&#39;gbk’就可以解决大部分情况了导入的文件必须存放在python的当前的路径中如果导入无中文的文件,输入文件名名称即可如果文件中包含中文,则添加encoding=‘gbk’ 对于Excel文件的处理办法" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/68b689552f35fb7a827f8dd8a032d7d5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-06T15:12:28+08:00" />
<meta property="article:modified_time" content="2023-01-06T15:12:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【pandas】模块——DataFrame数据处理（一）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="DataFrame_1"></a>DataFrame-数据创建与导入</h2> 
<p>下一篇：<a href="https://blog.csdn.net/panbaoran913/article/details/114757946">dataframe数据筛选(二)</a><br> 下二篇：<a href="https://blog.csdn.net/panbaoran913/article/details/120706553">dataframe高级用法(三）</a></p> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>这里写目录标题</h4> 
 <ul><li><a href="#DataFrame_1" rel="nofollow">DataFrame-数据创建与导入</a></li><li><ul><li><a href="#font_colorredfont_13" rel="nofollow"><font color="red">一定义</font></a></li><li><ul><li><a href="#font_colorred11_font_25" rel="nofollow"><font color="red">1.1 特征</font></a></li><li><a href="#font_colorred12_DataFramefont_33" rel="nofollow"><font color="red">1.2 获得DataFrame的两种方式</font></a></li><li><a href="#13font_colororangecsvfont_78" rel="nofollow">1.3.<font color="orange">导出csv文件</font></a></li></ul> 
   </li><li><a href="#_font_colorred_font_82" rel="nofollow">二、 <font color="red"> 数据检查</font></a></li><li><ul><li><a href="#21_font_colororange_font_86" rel="nofollow">2.1 <font color="orange">查考表头和表尾 </font></a></li><li><a href="#22font_colororange__font_89" rel="nofollow">2.2<font color="orange">查看列名 </font></a></li><li><a href="#23_font_colororange__font_91" rel="nofollow">2.3 <font color="orange">查看索引 </font></a></li><li><a href="#24font_colororange__font_93" rel="nofollow">2.4<font color="orange">查看行列数 </font></a></li><li><a href="#25font_colororangefont_95" rel="nofollow">2.5<font color="orange">查看数据类型</font></a></li><li><a href="#26font_colororangefont_101" rel="nofollow">2.6<font color="orange">查看空值</font></a></li><li><a href="#27font_colororangefont_107" rel="nofollow">2.7<font color="orange">查看数据表的信息</font></a></li><li><a href="#28font_colororangefont_109" rel="nofollow">2.8<font color="orange">查看唯一值</font></a></li><li><a href="#_font_colorredfont_125" rel="nofollow">三、 <font color="red">数据清洗</font></a></li><li><a href="#31font_colororangefont_131" rel="nofollow">3.1<font color="orange">缺失值处理</font></a></li><li><a href="#32font_colororangefont_162" rel="nofollow">3.2<font color="orange">清楚空格</font></a></li><li><a href="#33font_colororangefont_167" rel="nofollow">3.3<font color="orange">转换数据格式</font></a></li><li><a href="#34font_colororangefont_180" rel="nofollow">3.4<font color="orange">大小写转换</font></a></li><li><a href="#35font_colororangefont_194" rel="nofollow">3.5<font color="orange">更改列名</font></a></li><li><a href="#36font_colororangefont_205" rel="nofollow">3.6<font color="orange">更改索引</font></a></li></ul> 
   </li><li><a href="#_font_colorredfont_219" rel="nofollow">四、 <font color="red">重复值处理</font></a></li><li><ul><li><a href="#41font_colorbluefont_224" rel="nofollow">4.1<font color="blue">查看是否有重复值</font></a></li><li><a href="#42font_colorbluefont_232" rel="nofollow">4.2<font color="blue">保留重复值</font></a></li></ul> 
   </li><li><a href="#font_colorredfont_246" rel="nofollow">五、<font color="red">替换值</font></a></li><li><a href="#font_colorredfont_258" rel="nofollow">六、<font color="red">数据的增删改</font></a></li><li><ul><li><a href="#61_font_colorbluefont_259" rel="nofollow">6.1 <font color="blue">增加行</font></a></li><li><a href="#62font_colorbluefont_274" rel="nofollow">6.2<font color="blue">删除行</font></a></li><li><a href="#63font_colorbluefont_280" rel="nofollow">6.3<font color="blue">修改行</font></a></li><li><a href="#64font_colorbluefont_colorpurplefontfont_286" rel="nofollow">6.4<font color="blue">增加<font color="purple">列</font>&lt;/font&gt;</font></a></li><li><a href="#65font_colorbluefont_colorpurplefontfont_298" rel="nofollow">6.5<font color="blue">删除<font color="purple">列</font>&lt;/font&gt;</font></a></li><li><a href="#66font_colorbluefont_colorpurplefontfont_309" rel="nofollow">6.6<font color="blue">修改<font color="purple">列</font>&lt;/font&gt;</font></a></li></ul> 
   </li><li><a href="#font_colorred_font_319" rel="nofollow">七、<font color="red">数据集合并 </font></a></li><li><ul><li><a href="#71font_colororangenamemergefont_321" rel="nofollow">7.1<font color="orange">按照公有的列表名为“name"进行合并`merge`</font></a></li><li><a href="#72font_colororangemergefont_352" rel="nofollow">7.2<font color="orange">按照两个数据指定的列的列名合并`merge`</font></a></li><li><a href="#73_font_colororangemergefont_360" rel="nofollow">7.3 <font color="orange">按照多个键来进行合并`merge`</font></a></li><li><a href="#74_font_colororangeconcatfont_377" rel="nofollow">7.4 <font color="orange">数据的轴向连接`concat`</font></a></li><li><ul><li><a href="#741font_colorblueaxis0font_400" rel="nofollow">7.4.1<font color="blue">axis=0数据拼接</font></a></li><li><a href="#742font_colorblueaxis1font_422" rel="nofollow">7.4.2<font color="blue">纵轴的连接,axis=1</font></a></li></ul> 
    </li><li><a href="#75_font_colororangefont__combine_first_427" rel="nofollow">7.5 <font color="orange">合并重叠数据</font> `combine_first`</a></li></ul> 
   </li><li><a href="#font_colorredfont_433" rel="nofollow">八、<font color="red">数据分组</font></a></li><li><ul><li><a href="#81font_colorbluefont_colorpurplefont_434" rel="nofollow">8.1<font color="blue">通过条件判断来进行<font color="purple">二分组</font></font></a></li><li><a href="#82font_colorbluefont_colorpurplefont_font_445" rel="nofollow">8.2<font color="blue">通过条件判断划分为<font color="purple">多个组</font> &lt;/font&gt;</font></a></li></ul> 
   </li><li><a href="#font_colorredfont_456" rel="nofollow">九、<font color="red">数据割分列与合并列</font></a></li><li><ul><li><a href="#91font_colorblue12_font_457" rel="nofollow">9.1<font color="blue">1列分割2列 </font></a></li><li><a href="#92font_colorblue_font_468" rel="nofollow">9.2<font color="blue">合并 </font></a></li></ul> 
   </li><li><a href="#font_colorredfont_476" rel="nofollow">十、<font color="red">排序</font></a></li><li><ul><li><a href="#101font_colorblue_font__sort_values___477" rel="nofollow">10.1<font color="blue">根据值来排序 </font> `.sort_values() `</a></li><li><a href="#102font_colorbluefont_colorpurplefont_font__sort_index_492" rel="nofollow">10.2<font color="blue">根据<font color="purple">索引</font>来排序 &lt;/font&gt; `.sort_index()`</font></a></li><li><a href="#103font_colorbluefont__rank_500" rel="nofollow">10.3<font color="blue">排名</font> `.rank()`</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p>,红,橙,蓝</p> 
<h3><a id="font_colorredfont_13"></a><font color="red">一定义</font></h3> 
<hr> 
<p>DataFrame是一种表格型的数据结构</p> 
<table><thead><tr><th></th><th>姓名</th><th>类型</th><th>成绩</th></tr></thead><tbody><tr><td>0</td><td>张三</td><td>高中</td><td>89</td></tr><tr><td>1</td><td>李四</td><td>初中</td><td>90</td></tr></tbody></table> 
<h4><a id="font_colorred11_font_25"></a><font color="red">1.1 特征</font></h4> 
<hr> 
<ol><li>第一行为字段,即列名,从第二行开始为一行一行的记录</li><li>每列可以是不同的值类型(数值/字符串/布尔值等)</li><li>即有行索引也有列索引</li></ol> 
<h4><a id="font_colorred12_DataFramefont_33"></a><font color="red">1.2 获得DataFrame的两种方式</font></h4> 
<hr> 
<p>A. <font color="orange">自己创建DateFrame</font></p> 
<p>A.1 <font color="blue">通过字典的方式创建DataFrame</font></p> 
<ul><li>通过单层字典创建</li><li>通过嵌套字典创建</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
df
</code></pre> 
<p><strong>注意</strong></p> 
<ul><li><font color="green">arange(12):其实和arange()差不多,只不过arange是在数组意义上的快速生成数列的方法</font></li><li><font color="green">reshape(3,4):将数组对象按照3行4列的方式排列</font></li><li><font color="green">index:索引</font></li><li><font color="green">columns:列名</font></li></ul> 
<hr> 
<p>A.2 <font color="blue">在表格中取列并生成新的表格</font></p> 
<ul><li>索引为字符串 d3=df[[‘站点编号’,‘借车总量’,‘还车总量’]]</li><li>索引为数字 df[[1,2,3]]</li></ul> 
<hr> 
<p>B .<font color="orange">从外部导入dataframe</font></p> 
<ul><li>导入csv文件 .对于windows系统,在导入数据时可能会遇到一些编码问题,添加参数encoding='gbk’就可以解决大部分情况了</li><li>导入的文件必须存放在python的当前的路径中</li><li>如果导入无中文的文件,输入文件名名称即可</li><li>如果文件中包含中文,则添加encoding=‘gbk’</li></ul> 
<hr> 
<blockquote> 
 <p><font color="green">对于Excel文件的处理办法</font></p> 
</blockquote> 
<ul><li>将原来的文件转化成csv</li><li>df3=pd.read_excel(“名字.xlsx”),中文的话继续加参数</li></ul> 
<h4><a id="13font_colororangecsvfont_78"></a>1.3.<font color="orange">导出csv文件</font></h4> 
<blockquote> 
 <p>df2.to_csv(“111导.csv”)</p> 
</blockquote> 
<h3><a id="_font_colorred_font_82"></a>二、 <font color="red"> 数据检查</font></h3> 
<hr> 
<h4><a id="21_font_colororange_font_86"></a>2.1 <font color="orange">查考表头和表尾 </font></h4> 
<p>.head()查看表头(前几行)<br> .tall()查看表尾(后几行)</p> 
<h4><a id="22font_colororange__font_89"></a>2.2<font color="orange">查看列名 </font></h4> 
<p>.columns</p> 
<h4><a id="23_font_colororange__font_91"></a>2.3 <font color="orange">查看索引 </font></h4> 
<p>.index</p> 
<h4><a id="24font_colororange__font_93"></a>2.4<font color="orange">查看行列数 </font></h4> 
<p>.shape 返回行和列的个数</p> 
<h4><a id="25font_colororangefont_95"></a>2.5<font color="orange">查看数据类型</font></h4> 
<p>.dtype</p> 
<blockquote> 
 <ul><li>df.dtype<font color="red">s</font>查看某表格的数据类型</li><li>df[“yanse”].dtype查看某列的数据类型</li></ul> 
</blockquote> 
<h4><a id="26font_colororangefont_101"></a>2.6<font color="orange">查看空值</font></h4> 
<p>.isnull()</p> 
<blockquote> 
 <ul><li>df.isnull()判断表格的是否具有缺失值,False代表无,True代表有</li><li>df[df["颜色区分“].isnull()]返回“颜色区分”这一列中数值缺失的表格的行</li></ul> 
</blockquote> 
<h4><a id="27font_colororangefont_107"></a>2.7<font color="orange">查看数据表的信息</font></h4> 
<p>.info()</p> 
<h4><a id="28font_colororangefont_109"></a>2.8<font color="orange">查看唯一值</font></h4> 
<p>.unique()</p> 
<pre><code>info(self, verbose=None, buf=None, max_cols=None, memory_usage=None, null_counts=None)
</code></pre> 
<ul><li>verbose:是否打印全部summary</li><li>buf:</li><li>max_cols:何时从详细输出切换到截断输出</li><li>memory_usage:指定DataFrame的总内存使用量应显示元素（包括索引）</li><li>null_counts:</li></ul> 
<blockquote> 
 <ul><li>df["颜色区分“].unique()查看某列中的唯一值</li></ul> 
</blockquote> 
<ul><li>所有唯一值的数量 len(df[“颜色区分”].unique())</li><li>每个值出现的次数(频次) df[“颜色区分”].value_counts()</li></ul> 
<h4><a id="_font_colorredfont_125"></a>三、 <font color="red">数据清洗</font></h4> 
<hr> 
<p><mark>创建一个4行3列的含有NaN的数据作为演示</mark></p> 
<h4><a id="31font_colororangefont_131"></a>3.1<font color="orange">缺失值处理</font></h4> 
<p>3.1.1<font color="blue">判断是否是缺失值</font><br> .isnull()</p> 
<blockquote> 
 <ul><li>df.isnull()判断数据表中是否有缺失值</li><li>df[“借车总量”].isnull()判断列中是否有缺失值</li><li>df_m[“还车总量”].isnull().value_counts()查看这一列的非缺失值和缺失值的数量分布</li></ul> 
</blockquote> 
<p>3.1.2<font color="blue">缺失值删除</font><br> .dropna()</p> 
<blockquote> 
 <ul><li>默认删除掉含有缺失值的所有行,与.dropna(how=“any”)等价</li><li>.dropna(how=“all”)删除满足行内数据均为NaN这个条件的行</li><li>.dropna(how=“all”,axis=1)删除掉列内均为NaN这个条件,按列删除,会返回一个新的数据表格,</li><li>.dropna(how=“all”,axis=1,inplace=True)如果想要在原表格上操作,加inplace=True参数</li></ul> 
</blockquote> 
<p>3.1.3<font color="blue">填充缺失值</font><br> .fillna()</p> 
<blockquote> 
 <ul><li>.fillna(value=0,inplace=True)填充指定值,同理inplace函数是在原表格上进行操作</li><li>.fillna(df[1].mean()),填充函数:采用平均值填充</li><li>.fillna(method=“ffill”)向前填充</li></ul> 
</blockquote> 
<ul><li>.fillna(method=“bfill”) 向后填充</li></ul> 
<p>== 创建含有空格的示例数据==</p> 
<p>dict1={“name”:[“小红”,“小明”,“小张”],“age”:[16,17,18],“city”:["北京 “,”杭州“,”上海 “]}</p> 
<hr> 
<h4><a id="32font_colororangefont_162"></a>3.2<font color="orange">清楚空格</font></h4> 
<p>.map(str.strip)</p> 
<blockquote> 
 <ul><li>dic[“city”]=dic[“city”].map(str.strip)清除“city”列的空格并赋值</li></ul> 
</blockquote> 
<h4><a id="33font_colororangefont_167"></a>3.3<font color="orange">转换数据格式</font></h4> 
<p>3.3.1 查看数据类型:<br> <code>df.dtypes</code><br> 3.3.2 转换数据类型<br> <code>df.astype () </code></p> 
<ul><li> <p><code>.astype("str")</code>转换成字符串格式</p> </li><li> <p><code>.astype("float")</code>转换成浮点数格式</p> </li><li> <p><code>dic["age"]=dic["age"].astype("float")</code></p> </li><li> <p><code> .astype("int")</code>转化成整数格式</p> </li></ul> 
<h4><a id="34font_colororangefont_180"></a>3.4<font color="orange">大小写转换</font></h4> 
<ul><li> <p><code>.str.upper()</code></p> <p><code>dic["city"]=dic["city"].str.upper()</code>:转换成大写</p> </li><li> <p><code>.str.lower()</code></p> <p><code>dic["city"]=dic["city"].str.lower()</code>转换成小写</p> </li><li> <p><code>.str.title()</code></p> <p><code>dic["city"]=dic["city"].str.title()</code>转换成首字母大写</p> </li></ul> 
<h4><a id="35font_colororangefont_194"></a>3.5<font color="orange">更改列名</font></h4> 
<ul><li><code>.rename()</code></li></ul> 
<blockquote> 
 <p>dic.rename(columns={“name”:“name2”,“age”:“age2”},inplace=True)<br> 通过rename函数更改部分或者所有列名,并默认返回一个新的数据框,若在原表基础上修改则添加参数inplace=True即可</p> 
</blockquote> 
<ul><li><code>.columns</code></li></ul> 
<blockquote> 
 <p>dic.columns=[“n”,“a”,“c”]<br> 通过columns属性修改列名,这种方式需要输入所有的列名,并直接在原基础上修改</p> 
</blockquote> 
<h4><a id="36font_colororangefont_205"></a>3.6<font color="orange">更改索引</font></h4> 
<ul><li><code>.set_index() </code></li><li><code>set_index(self, keys, drop=True, append=False, inplace=False)</code>:</li></ul> 
<blockquote> 
 <p>keys为标签或者标签列表<br> drop=True:删除原索引，inplace=True在原表操作<br> <code> df.set_index(['year', 'month'])</code><br> dic1=dic.set_index(“n”)<font color="red">以某列为索引</font><br> 将“n”这一列作为索引,同时发现原来默认的数字索引没了,且新的表格少了一列</p> 
</blockquote> 
<ul><li><code>.reset_index() </code></li></ul> 
<blockquote> 
 <p>dic2=dic1.reset_index()<font color="red">重置</font> 索引<br> <code>df.reset_index(drop=True,inplace=True)</code> :drop=True,是将原索引删除再重置新索引，inplace=True是在原DF上修改</p> 
</blockquote> 
<h3><a id="_font_colorredfont_219"></a>四、 <font color="red">重复值处理</font></h3> 
<p><mark>创建含重复值数据</mark></p> 
<p><code>df5=pd.DataFrame({"c1":["apple"]*3+["banana"]*3,"c2":[1,1,2,3,3,2]}) </code></p> 
<h4><a id="41font_colorbluefont_224"></a>4.1<font color="blue">查看是否有重复值</font></h4> 
<p><code>.duplicated() </code></p> 
<blockquote> 
 <ul><li><code>df5.duplicated(subset=["c1","c2"],keep="first") </code><br> subset是<font color="red">判断基准</font>,以“c1","c2"联合起来判断是否有重复值<br> keep保留,“first”保留第一个出现的重复值,即第一个出现的不为重复值,第二个出现的才为重复值</li><li><code>df5_duplicated.value_counts()</code> 当数据量较大是可以查看重复数值和非重复数值分布</li></ul> 
</blockquote> 
<h4><a id="42font_colorbluefont_232"></a>4.2<font color="blue">保留重复值</font></h4> 
<p><code>df5[df5.duplicated(subset=["c1","c2"],keep="first")] </code></p> 
<blockquote> 
 <p>df5[]中的是返回的<font color="red">布尔值</font>,直接提取出来即可</p> 
</blockquote> 
<p>4.3<font color="blue">删除重复值</font><br> <code>.drop_duplicates() </code></p> 
<blockquote> 
 <ul><li><code>df5.drop_duplicates(subset=["c1","c2"],keep="first")</code><br> 默认保留第一个出现的重复值,删除掉后面的重复值</li><li><code>df5.drop_duplicates(subset=["c1","c2"],keep="last")</code>保留最后一个重复值,删除掉前面的重复值</li><li>希望在原基础上修改,则添加参数inplace=True</li></ul> 
</blockquote> 
<h3><a id="font_colorredfont_246"></a>五、<font color="red">替换值</font></h3> 
<p><font color="blue">忽略警告的做法</font><br> import warnings #导入包<br> warnings.filterwarning(“ignore”)</p> 
<p><code>.replace() </code></p> 
<blockquote> 
 <ul><li><code>df6["产品1"]=df6["产品1"].replace("a","bb")</code><font color="purple">单个对象替换单个值</font></li><li><code>df6["产品1"]=df6["产品1"].replace(["c","d"],"gg")</code><font color="purple">多个对象替换单个值</font></li><li><code>df6["产品1"]=df6["产品1"].replace(["f","gg"],["f_s","gs"])</code><font color="purple">多个对象替换多个值</font></li><li><code>df6["产品1"]=df6["产品1"].replace({"f_s":"fs","gs":"ggs"})</code><font color="purple">参数为字典的方式</font></li></ul> 
</blockquote> 
<h3><a id="font_colorredfont_258"></a>六、<font color="red">数据的增删改</font></h3> 
<h4><a id="61_font_colorbluefont_259"></a>6.1 <font color="blue">增加行</font></h4> 
<ul><li><code>.loc</code></li></ul> 
<blockquote> 
 <p><code>df7.loc[5]=["baby","shanghai",80]</code>#.loc[]通过<font color="purple">行索引</font>来取得数值<br> <code>.iloc[]</code>通过<font color="purple">行号</font>来取行数据</p> 
</blockquote> 
<ul><li><code>.append() </code></li></ul> 
<blockquote> 
 <p><code>df7.append(df8)</code>在<font color="purple">列名相同</font>的情况下,直接添加行上去,<font color="purple">索引号不会直接顺接上去</font><br> <code>df7.append(df8,ignore_index=True)</code>忽略掉原来的索引,索引可以顺接了</p> 
</blockquote> 
<ul><li><code>pd.concat</code></li></ul> 
<blockquote> 
 <p><code>pd.concat([df7,df8],ignore_index=True)</code><font color="purple">拼接相同字段</font>,顺接</p> 
</blockquote> 
<h4><a id="62font_colorbluefont_274"></a>6.2<font color="blue">删除行</font></h4> 
<p><code>.drop()</code></p> 
<blockquote> 
 <p><code>df9.drop(6,inplace=True)</code>按<font color="purple">索引行号</font>删除行,6即删除第7行<br> <code>df9.drop([3,5])</code>删除多行</p> 
</blockquote> 
<h4><a id="63font_colorbluefont_280"></a>6.3<font color="blue">修改行</font></h4> 
<p><code>.loc </code></p> 
<blockquote> 
 <p><code>df7.loc[0]=["daseen","hangzhou",35]</code>按<font color="purple">单行</font>修改,在原表上修改<br> <code>df7.loc[0:2]=[["a","b","c"],["d","e","f"],[1,2,3]]</code>按<font color="purple">多行</font>修改,多行用方括号扩起来</p> 
</blockquote> 
<h4><a id="64font_colorbluefont_colorpurplefontfont_286"></a>6.4<font color="blue">增加<font color="purple">列</font></font></h4> 
<ul><li>按列索引在<font color="purple">列末尾</font>增加列</li></ul> 
<blockquote> 
 <p><code>df7["gender"]=["male","male","female","female","male"]</code><br> 列中的数量必须相同或<font color="purple">方括号中的元素数量必须与原表中的行数相同</font></p> 
</blockquote> 
<ul><li><code>.insert </code> <font color="purple">任意列</font>位置插列</li></ul> 
<blockquote> 
 <p><code>df7.insert(1,"heigh",[170,168,175,180,179])</code>在第2列插入列名为“heigh”的一列<br> 1-&gt;代表位置,列名,值<br> <font color="purple">方括号中的元素数量必须与原表中的行数相同</font></p> 
</blockquote> 
<h4><a id="65font_colorbluefont_colorpurplefontfont_298"></a>6.5<font color="blue">删除<font color="purple">列</font></font></h4> 
<ul><li><code>del DataFrame[colnane] </code></li></ul> 
<blockquote> 
 <p>del df7[“score”]</p> 
</blockquote> 
<ul><li><code>.drop(["列名"],axis=1)</code></li></ul> 
<blockquote> 
 <ul><li><code>df7.drop(["city"],axis=1)</code><br> 注意,drop删除行或列的时候,默认删除行,要删除列的时候要如上添加参数</li><li><code>df7.drop(["city",“age”],axis=1)</code>删除多列</li></ul> 
</blockquote> 
<h4><a id="66font_colorbluefont_colorpurplefontfont_309"></a>6.6<font color="blue">修改<font color="purple">列</font></font></h4> 
<ul><li>按单列赋单值</li></ul> 
<blockquote> 
 <p><code>df7["score"]=50</code></p> 
</blockquote> 
<ul><li>按多列修改值</li></ul> 
<blockquote> 
 <p><code>df7[["score","city"]]=[60,["hz","bj","hz","cd","sz"]] </code><br> 注意方括号的个数</p> 
</blockquote> 
<h3><a id="font_colorred_font_319"></a>七、<font color="red">数据集合并 </font></h3> 
<h4><a id="71font_colororangenamemergefont_321"></a>7.1<font color="orange">按照公有的列表名为“name"进行合并<code>merge</code></font></h4> 
<ol><li><font color="blue">inner连接(交集)</font></li></ol> 
<ul><li>·pd.merge(df7,df8)·</li></ul> 
<blockquote> 
 <p>默认连接方式为交集:若没有指定,则默认将重叠列的列名作为键<br> 新表格的行的数量为按“name”列取<font color="purple">交集元素</font>的个数</p> 
</blockquote> 
<ul><li><code>pd.merge(df7,df8,how="inner")</code></li></ul> 
<blockquote> 
 <p>与上一种方式等价,显示指定连接方式</p> 
</blockquote> 
<ul><li><code>pd.merge(df7,df8,on="name")</code></li></ul> 
<blockquote> 
 <p>显现的指定键为“name”列,不同的列名都会保留下来</p> 
</blockquote> 
<ol start="2"><li><font color="blue">outer连接(并集)</font><br> <code>pd.merge(df7,df8,on="name",how="outer")</code></li></ol> 
<blockquote> 
 <p>显现的指定键为“name”列,保留两个表的“name”的所有内容,按原来的表格填充,没有内容的返回NaN<br> 新表格的行的数量为按“name”列取<font color="purple">并集元素</font>的个数</p> 
</blockquote> 
<ol start="3"><li><font color="blue">left连接(保左加右)</font><br> <code>pd.merge(df7,df8,on="name",how="left")</code></li></ol> 
<blockquote> 
 <p>显现的指定键为“name”列,保留左边的表,右边的边进行填充,没有内容的返回NaN<br> 新表格的行的数量为按“name”列取<font color="purple">左边表格元素</font>的个数</p> 
</blockquote> 
<ol start="4"><li><font color="blue">right连接(保右加左)</font><br> <code>pd.merge(df7,df8,on="name",how="right") </code></li></ol> 
<h4><a id="72font_colororangemergefont_352"></a>7.2<font color="orange">按照两个数据指定的列的列名合并<code>merge</code></font></h4> 
<ol><li><font color="blue">单对不同列名的匹配</font></li></ol> 
<pre><code>df8=df8.rename(columns={"name":"name2"})  
pd.merge(df7,df8,left_on="name",right_on="name2",how="inner")
</code></pre> 
<h4><a id="73_font_colororangemergefont_360"></a>7.3 <font color="orange">按照多个键来进行合并<code>merge</code></font></h4> 
<ol><li><font color="blue">按多个列名来匹配</font></li></ol> 
<pre><code>df8["city"]=["hangzhou","hangzhou","heilongjiang"]
pd.merge(df7,df8,on=["name","city"],how="left")  
</code></pre> 
<ol start="2"><li><font color="blue">将索引作为键来合并</font></li></ol> 
<p><mark>示例数据</mark></p> 
<pre><code>left1=pd.DatFrame({"key":list("abcd"),"value":range(4)})  
right1=pd.DataFrame({"value2":[10,20]},index=["a","b"])
pd.merge(left1,right1,left_on="key",right_index=True,how="inner")
</code></pre> 
<blockquote> 
 <p>左侧通过键“key",右侧的通过列表的索引</p> 
</blockquote> 
<h4><a id="74_font_colororangeconcatfont_377"></a>7.4 <font color="orange">数据的轴向连接<code>concat</code></font></h4> 
<ul><li>axis=0</li></ul> 
<blockquote> 
 <p>表示在横轴上工作,所谓的横轴也即时行,而行的方向是上下,因此你可以理解为在上下方向执行操作</p> 
</blockquote> 
<ul><li>axis=1</li></ul> 
<blockquote> 
 <p>表示在纵轴上工作,所谓的纵轴也即时行,而行的方向是左右,因此你可以理解为在左右方向执行操作</p> 
</blockquote> 
<p>因此,轴向连接也就是指:当axis=0,将两份数据或者多分数据按照上下方向拼接起来;当axis=1,…左右方向拼接起来.<br> <mark>创建实例数据</mark></p> 
<pre><code>df1=pd.DataFrame({"name":["ray","jcack","lucy","bob","candy"],
                  "city":["hangzhou","beijing","hangzhou","chengdu","suzhou"],
                  "score":[10,30,20,15,50]},columns=["name","city","score"])
df2=pd.DataFrame({"name":["faker","fizz"],"city":["wenzhou","shanghai"],"score":[55,80]},
                 columns=["name","city","score"])
df3=pd.DataFrame({"name":["faker","fizz"],"city":["wenzhou","shanghai"],"gender":["male","female"]},
                 columns={"name","city","gender"} )

</code></pre> 
<h5><a id="741font_colorblueaxis0font_400"></a>7.4.1<font color="blue">axis=0数据拼接</font></h5> 
<p><code>pd.concat </code>横轴的连接,axis=0,concat默认横轴</p> 
<ul><li>两份数据的字段完全相同的情况</li></ul> 
<p><code>pd.concat([df1,df2],ignore_index=True)</code></p> 
<blockquote> 
 <p>同增加行相同<br> 按照横轴连接df1和df2</p> 
</blockquote> 
<ul><li>两份数据字段存在不同的情况下</li></ul> 
<p><code>pd.concat([df1,df3],ignore_index=True)</code></p> 
<blockquote> 
 <p>会得到两份数据的并集,没有的值返回NaN</p> 
</blockquote> 
<ul><li>在连接轴上创建一个索引层次</li></ul> 
<p><code>df_concat=pd.concat([df1,df3],keys=["df1","df3"])</code></p> 
<blockquote> 
 <p>当要访问df1和df2时,可以从这个合并的数据集里提取<br> <code>df_concat.loc["df3"]</code>访问合并后的df3的数据<br> <code>df_concat.loc["df3"].loc[1]</code>访问合并df3中的第2行,</p> 
</blockquote> 
<h5><a id="742font_colorblueaxis1font_422"></a>7.4.2<font color="blue">纵轴的连接,axis=1</font></h5> 
<p><code>pd.concat([df1,df3],axis=1) </code></p> 
<blockquote> 
 <p>纵轴方向合并df1和df2</p> 
</blockquote> 
<h4><a id="75_font_colororangefont__combine_first_427"></a>7.5 <font color="orange">合并重叠数据</font> <code>combine_first</code></h4> 
<p><code>DataFrame1.combine_first(DataFrame2) </code></p> 
<blockquote> 
 <p>采用data2的数据给data1数据进行打布丁<br> data1和data2有索引重叠的部分:即level列和score列的前三行,name对于data1中已有数据,则继续用data1的数据,如果data1中缺失的数据,那么对于缺失数据用参数的对象data2的对应值来填充.</p> 
</blockquote> 
<h3><a id="font_colorredfont_433"></a>八、<font color="red">数据分组</font></h3> 
<h4><a id="81font_colorbluefont_colorpurplefont_434"></a>8.1<font color="blue">通过条件判断来进行<font color="purple">二分组</font></font></h4> 
<p>满足条件的为一组,不满足条件的为另外一组<br> <code>np.where </code></p> 
<blockquote> 
 <ul><li>单条件判断<br> <code>df4["借车状态"]=np.where(df4["借车总量"]&gt;=50,"多","少")</code><br> 创建列,用np.where函数进行填充.如果“借车总量”大于50则“多”,否则“少</li><li>多条件判断<br> <code>df4["站点级别"]=np.where((df4["借车总量"]&gt;=50)&amp;(df4["还车总量"]&gt;=50),"A级","B级") </code><br> 追加条件的情况</li></ul> 
</blockquote> 
<h4><a id="82font_colorbluefont_colorpurplefont_font_445"></a>8.2<font color="blue">通过条件判断划分为<font color="purple">多个组</font> </font></h4> 
<p><code>.loc</code></p> 
<blockquote> 
 <ul><li>非条件判断<br> <code>df4.loc[(df4["借车总量"]&gt;25),"jibie"]="ok" </code><br> <code>df4.loc[~(df4["借车总量"]&gt;25),"jibie"]="no ok" </code></li><li>划分多组<br> <code>df4.loc[(df4["借车总量"]&gt;25),"jibie"]="ok" </code><br> <code>df4.loc[df4["借车总量"]&lt;25,"jibie"]="no ok" </code><br> <code>df4.loc[df4["借车总量"]==25,"jibie"]="nice" </code></li></ul> 
</blockquote> 
<h3><a id="font_colorredfont_456"></a>九、<font color="red">数据割分列与合并列</font></h3> 
<h4><a id="91font_colorblue12_font_457"></a>9.1<font color="blue">1列分割2列 </font></h4> 
<p><code>.split</code></p> 
<blockquote> 
 <p>对h&amp;w列的值依次进行分列,并创建数据表df5_split,索引值为df5的索引值,列名为height和weight<br> <code>df5_split=pd.DataFrame([x.split("-") for x in df5["h&amp;w"]],index=df5.index,columns=["height","weight"]) </code></p> 
</blockquote> 
<blockquote> 
 <p>将分列后的数据表df_split与原df5的数据表进行匹配<br> <code>df5=pd.merge(df5,df5_split,right_index=True,left_index=True)</code></p> 
</blockquote> 
<h4><a id="92font_colorblue_font_468"></a>9.2<font color="blue">合并 </font></h4> 
<p><code>.apply</code></p> 
<blockquote> 
 <p><code>df5["name:score"]=df5["name"]+":"+df5["score"].apply(str) </code><br> 创建列,赋值,<font color="purple">字符与数值不能直接相加</font>,需要用apply将数值转化为字符串<br> apply可以将一个函数用于DataFrame的所有行或者所有列,也可以应用到DataFrame的一行或者一列</p> 
</blockquote> 
<h3><a id="font_colorredfont_476"></a>十、<font color="red">排序</font></h3> 
<h4><a id="101font_colorblue_font__sort_values___477"></a>10.1<font color="blue">根据值来排序 </font> <code>.sort_values() </code></h4> 
<p><code>.sort_values() </code><br> <code>sort_values(self, by, axis=0, ascending=True, inplace=False)</code>:axis=0表示列，ascending=True默认升序，inplace=True表示在原表操作</p> 
<blockquote> 
 <ul><li><code>df5.sort_values(by="score") </code><br> 默认为升序排列</li><li><code>df5.sort_values(by="score",ascending=False) </code><br> 增加参数,降序排列</li><li><code>df5.sort_values(by=["score","height"]) </code><br> <font color="purple">多级升序排序</font>,第一级关键词是“score”,第二级关键词是“height”</li><li><code>df5.sort_values(by=["score","height"],ascending=False) </code><br> <font color="purple">多级降序排序</font><br> *<code>df5.sort_values(by=["score","height"],ascending=[False,True]) </code><br> <font color="purple">第一级降序,第二级升序</font></li></ul> 
</blockquote> 
<h4><a id="102font_colorbluefont_colorpurplefont_font__sort_index_492"></a>10.2<font color="blue">根据<font color="purple">索引</font>来排序 </font> <code>.sort_index()</code></h4> 
<p><code>.sort_index()</code></p> 
<blockquote> 
 <ul><li><code>df5.sort_index(inplace=True) </code><br> 升序排列</li><li><code>df5.sort_index(inplace=False) </code><br> 降序排列</li></ul> 
</blockquote> 
<h4><a id="103font_colorbluefont__rank_500"></a>10.3<font color="blue">排名</font> <code>.rank()</code></h4> 
<p><code>.rank()</code></p> 
<blockquote> 
 <p><code>df6["rank"]=df6["还车总量"].rank(ascending=False,method="dense") </code></p> 
 <p><font color="grass">中国式排名:值大的排名靠前,值小的排名靠后,如果值一样则占同一个排名位,排名位是连续的,不存在间断 </font></p> 
</blockquote> 
<p>10.4 <font color="blue">转置</font></p> 
<ul><li>行索引和列索引进行转置<a href="https://blog.csdn.net/panbaoran913/article/details/120706553">添加链接描述</a></li></ul> 
<blockquote> 
 <p><code>df7=df7.T</code></p> 
</blockquote> 
<p>下一篇：<a href="https://blog.csdn.net/panbaoran913/article/details/114757946">dataframe数据筛选(二)</a><br> 下二篇：<a href="https://blog.csdn.net/panbaoran913/article/details/120706553">dataframe高级用法(三）</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/70298e77a120992e32a66c42ed366a50/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">linux6.8设置时间同步,CentOS6 更改时区方法（以设置 UTC&#43;8 为例）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/82dd6eb2bf2b70f971f4187af12a4da6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">lotus-miner 元数据备份</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>