<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>深入浅出EF之ModelFirst和DBFirst - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="深入浅出EF之ModelFirst和DBFirst" />
<meta property="og:description" content="在上篇博文中，小编主要简单的介绍了一下EF的一些基础知识，其中，小编蜻蜓点水的提了一下ModelFirst和DBFirst，ModelFirst先设计实体，然后根据模型生成数据库，DBFirst根据数据库生成模型，两个方向都是可以了，两个方向可以相互更新，比如新添加了实体，可以根据模型生成数据库，如果在数据库里面新添加了字段，我们可以从数据库更新模型。在介绍ModelFirst和DBFirst之前，我们先来解决两个问题，EF与linq to sql的关系以及为什么使用linq to sql和EF。
EF与linq to sql的关系
linq to sql 是微软ORM思想的一个具体化，EF也是它的一个具体化，那么，这两个产品有什么区别呢？Linq to Sql是ORM思想实现的一个轻量级的框架，EF是一个重量级框架；Linq to Sql和EF的一个重要的区别就是，Linq to Sql只能针对于SQL Server数据库，而EF可以针对于很多的数据库(Oracle，SQL Server等)，也就是说EF是跨数据库的，不要小看这一点，在实际的开发中，非常的实用，举个简单的小例子，还记我们敲的VB.NET版本的机房收费系统么，其中涉及到了数据访问层，如果出于某种原因，我们换了数据库，那么，我们就需要重新编写数据访问层，如果我们在创机房收费系统这个项目的时候，使用了linq to sql，更换了数据库linq to sql框架就需要重新进行大量的改动，如果使用了EF框架，那么我们只需要改动其中的配置文件就可以了，不需要修改程序中的代码。
为什么使用linq to sql和EF
这个问题，也关乎我们的D层，还记得敲机房收费系统的时候，我们会抽出来一个sqlhelper类，这个类实现了对数据库的增删改查，然后，我们的再创建相应的D层类，这些类方法的功能，其实都差不多，唯一不同的就是sql，从这里我们可以看到，我们的D层的问题，那就是，我们重复性的书写一些不必要的类或者方法，解决这个方法就需要慢慢的抽象，抽象出共有的东西，像：DataTable装换为实体集，操作数据库的几类方法(注意其参数)，然后将其一整合，这个大致就是我们所属的ORM思想实现的雏形了，当然，上面所说的那些东西，Linq to Sql或EF这些框架已经帮助我们实现了，我们只需要使用它们提供的方法就行了，从这里我们也可以看到，如果我们使用这些框架，我们程序员在编程的时候，几乎不需要管理D层的东西，只需要关注业务的实现就可以了。
接下来，小编就来简单的介绍一下ModelFirst，ModelFirst先设计实体，然后根据模型生成数据库，如下图所示，
我们可以再图中空白处右击添加实体，还可以新增标量属性，以及添加关联。接着，我们可以根据上面的实体生成数据库，如下图所示：
生成的代码如下所示：
&lt;span style=&#34;font-size:18px;&#34;&gt;&lt;span style=&#34;font-size:18px;&#34;&gt;-- ---------------------------------------------------- Entity Designer DDL Script for SQL Server 2005, 2008, 2012 and Azure-- ---------------------------------------------------- Date Created: 01/28/2015 15:43:19-- Generated from EDMX file: C:\Users\Flower\Desktop\EFDemo\ModelFirstDemo\DataModel.edmx-- --------------------------------------------------SET QUOTED_IDENTIFIER OFF;GOUSE [ModelFirstDemoDb2];GOIF SCHEMA_ID(N&#39;dbo&#39;) IS NULL EXECUTE(N&#39;CREATE SCHEMA [dbo]&#39;);GO-- ---------------------------------------------------- Dropping existing FOREIGN KEY constraints-- --------------------------------------------------IF OBJECT_ID(N&#39;[dbo]." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4615f3cc21cddbf100fecd7c7a9bd6c9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-02-09T14:48:53+08:00" />
<meta property="article:modified_time" content="2019-02-09T14:48:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">深入浅出EF之ModelFirst和DBFirst</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <div class="htmledit_views" id="content_views">
                  
 <p>        在上篇博文中，小编主要简单的介绍了一下EF的一些基础知识，其中，小编<a href="https://www.baidu.com/s?wd=%E8%9C%BB%E8%9C%93%E7%82%B9%E6%B0%B4&amp;tn=24004469_oem_dg&amp;rsv_dl=gh_pl_sl_csd" rel="nofollow noopener noreferrer" target="_blank">蜻蜓点水</a>的提了一下ModelFirst和DBFirst，ModelFirst先设计实体，然后根据模型生成数据库，DBFirst根据数据库生成模型，两个方向都是可以了，两个方向可以相互更新，比如新添加了实体，可以根据模型生成数据库，如果在数据库里面新添加了字段，我们可以从数据库更新模型。在介绍ModelFirst和DBFirst之前，我们先来解决两个问题，EF与linq to sql的关系以及为什么使用linq to sql和EF。</p> 
 <p>         <strong>EF与linq to sql的关系</strong></p> 
 <p>         linq  to sql 是<a href="https://www.baidu.com/s?wd=%E5%BE%AE%E8%BD%AF&amp;tn=24004469_oem_dg&amp;rsv_dl=gh_pl_sl_csd" rel="nofollow noopener noreferrer" target="_blank">微软</a>ORM思想的一个具体化，EF也是它的一个具体化，那么，这两个产品有什么区别呢？Linq to Sql是ORM思想实现的一个轻量级的框架，EF是一个重量级框架；Linq to Sql和EF的一个重要的区别就是，Linq to Sql只能针对于SQL Server数据库，而EF可以针对于很多的数据库(<a href="https://www.baidu.com/s?wd=Oracle&amp;tn=24004469_oem_dg&amp;rsv_dl=gh_pl_sl_csd" rel="nofollow noopener noreferrer" target="_blank">Oracle</a>，SQL Server等)，也就是说EF是跨数据库的，不要小看这一点，在实际的开发中，非常的实用，举个简单的小例子，还记我们敲的VB.NET版本的机房收费系统么，其中涉及到了数据访问层，如果出于某种原因，我们换了数据库，那么，我们就需要重新编写数据访问层，如果我们在创机房收费系统这个项目的时候，使用了linq to sql，更换了数据库linq to sql框架就需要重新进行大量的改动，如果使用了EF框架，那么我们只需要改动其中的配置文件就可以了，不需要修改程序中的代码。</p> 
 <p>        <strong>为什么使用linq to sql和EF</strong></p> 
 <p>        这个问题，也关乎我们的D层，还记得敲机房收费系统的时候，我们会抽出来一个sqlhelper类，这个类实现了对数据库的增删改查，然后，我们的再创建相应的D层类，这些类方法的功能，其实都差不多，唯一不同的就是sql，从这里我们可以看到，我们的D层的问题，那就是，我们重复性的书写一些不必要的类或者方法，解决这个方法就需要慢慢的抽象，抽象出共有的东西，像：DataTable装换为实体集，操作数据库的几类方法(注意其参数)，然后将其一整合，这个大致就是我们所属的ORM思想实现的雏形了，当然，上面所说的那些东西，Linq to Sql或EF这些框架已经帮助我们实现了，我们只需要使用它们提供的方法就行了，从这里我们也可以看到，如果我们使用这些框架，我们程序员在编程的时候，几乎不需要管理D层的东西，只需要关注业务的实现就可以了。</p> 
 <p>        接下来，小编就来简单的介绍一下ModelFirst，ModelFirst先设计实体，然后根据模型生成数据库，如下图所示，</p> 
 <p>        <img alt="" src="https://images2.imgbox.com/63/c1/AZ3V7Q62_o.png"></p> 
 <p>        我们可以再图中空白处右击添加实体，还可以新增标量属性，以及添加关联。接着，我们可以根据上面的实体生成数据库，如下图所示：</p> 
 <p>        <img alt="" src="https://images2.imgbox.com/e2/1a/ihkYfOrM_o.png"></p> 
 <p>        生成的代码如下所示：</p> 
 <p></p> 
 <pre><code class="language-csharp hljs">&lt;span style=<span class="hljs-string">"font-size:18px;"</span>&gt;&lt;span style=<span class="hljs-string">"font-size:18px;"</span>&gt;-- ---------------------------------------------------- Entity Designer DDL Script <span class="hljs-keyword">for</span> SQL Server <span class="hljs-number">2005</span>, <span class="hljs-number">2008</span>, <span class="hljs-number">2012</span> and Azure-- ---------------------------------------------------- Date Created: <span class="hljs-number">01</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2015</span> <span class="hljs-number">15</span>:<span class="hljs-number">43</span>:<span class="hljs-number">19</span>-- Generated <span class="hljs-keyword">from</span> EDMX file: C:\Users\Flower\Desktop\EFDemo\ModelFirstDemo\DataModel.edmx-- --------------------------------------------------SET QUOTED_IDENTIFIER OFF;GOUSE [ModelFirstDemoDb2];<span class="hljs-function">GOIF <span class="hljs-title">SCHEMA_ID</span>(<span class="hljs-params">N<span class="hljs-string">'dbo'</span></span>) IS NULL <span class="hljs-title">EXECUTE</span>(<span class="hljs-params">N<span class="hljs-string">'CREATE SCHEMA [dbo]'</span></span>)</span>;GO-- ---------------------------------------------------- Dropping existing FOREIGN KEY constraints-- --------------------------------------------------<span class="hljs-function">IF <span class="hljs-title">OBJECT_ID</span>(<span class="hljs-params">N<span class="hljs-string">'[dbo].[FK_CustomerOrder]'</span>, <span class="hljs-string">'F'</span></span>) IS NOT NULL    ALTER TABLE [dbo].[Order] DROP CONSTRAINT [FK_CustomerOrder]</span>;GO-- ---------------------------------------------------- Dropping existing tables-- --------------------------------------------------<span class="hljs-function">IF <span class="hljs-title">OBJECT_ID</span>(<span class="hljs-params">N<span class="hljs-string">'[dbo].[Customer]'</span>, <span class="hljs-string">'U'</span></span>) IS NOT NULL    DROP TABLE [dbo].[Customer]</span>;<span class="hljs-function">GOIF <span class="hljs-title">OBJECT_ID</span>(<span class="hljs-params">N<span class="hljs-string">'[dbo].[Order]'</span>, <span class="hljs-string">'U'</span></span>) IS NOT NULL    DROP TABLE [dbo].[Order]</span>;GO-- ---------------------------------------------------- Creating all tables-- ---------------------------------------------------- Creating table <span class="hljs-string">'Customer'</span>CREATE TABLE [dbo].[Customer] (    [<span class="hljs-meta">Id</span>] <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">IDENTITY</span>(<span class="hljs-params"><span class="hljs-number">1</span>,<span class="hljs-number">1</span></span>) NOT NULL,    [CusName] <span class="hljs-title">nvarchar</span>(<span class="hljs-params"><span class="hljs-number">32</span></span>)  NULL,    [SubTime] datetime  NOT NULL,    [DelFlag] smallint  NULL)</span>;GO-- Creating table <span class="hljs-string">'Order'</span>CREATE TABLE [dbo].[Order] (    [<span class="hljs-meta">Id</span>] <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">IDENTITY</span>(<span class="hljs-params"><span class="hljs-number">1</span>,<span class="hljs-number">1</span></span>) NOT NULL,    [OrderContent] <span class="hljs-title">nvarchar</span>(<span class="hljs-params">max</span>)  NOT NULL,    [CustomerId] <span class="hljs-keyword">int</span>  NOT NULL)</span>;GO-- Creating table <span class="hljs-string">'UserInfo'</span>CREATE TABLE [dbo].[UserInfo] (    [<span class="hljs-meta">Id</span>] <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">IDENTITY</span>(<span class="hljs-params"><span class="hljs-number">1</span>,<span class="hljs-number">1</span></span>) NOT NULL)</span>;GO-- ---------------------------------------------------- Creating all PRIMARY KEY constraints-- ---------------------------------------------------- Creating primary key <span class="hljs-keyword">on</span> [Id] <span class="hljs-keyword">in</span> table <span class="hljs-string">'Customer'</span>ALTER TABLE [dbo].[Customer]ADD CONSTRAINT [PK_Customer]    <span class="hljs-function">PRIMARY KEY <span class="hljs-title">CLUSTERED</span> (<span class="hljs-params">[Id] ASC</span>)</span>;GO-- Creating primary key <span class="hljs-keyword">on</span> [Id] <span class="hljs-keyword">in</span> table <span class="hljs-string">'Order'</span>ALTER TABLE [dbo].[Order]ADD CONSTRAINT [PK_Order]    <span class="hljs-function">PRIMARY KEY <span class="hljs-title">CLUSTERED</span> (<span class="hljs-params">[Id] ASC</span>)</span>;GO-- Creating primary key <span class="hljs-keyword">on</span> [Id] <span class="hljs-keyword">in</span> table <span class="hljs-string">'UserInfo'</span>ALTER TABLE [dbo].[UserInfo]ADD CONSTRAINT [PK_UserInfo]    <span class="hljs-function">PRIMARY KEY <span class="hljs-title">CLUSTERED</span> (<span class="hljs-params">[Id] ASC</span>)</span>;GO-- ---------------------------------------------------- Creating all FOREIGN KEY constraints-- ---------------------------------------------------- Creating foreign key <span class="hljs-keyword">on</span> [CustomerId] <span class="hljs-keyword">in</span> table <span class="hljs-string">'Order'</span>ALTER TABLE [dbo].[Order]ADD CONSTRAINT [FK_CustomerOrder]    <span class="hljs-function">FOREIGN <span class="hljs-title">KEY</span> (<span class="hljs-params">[CustomerId]</span>)    REFERENCES [dbo].[Customer]        (<span class="hljs-params">[Id]</span>)    ON DELETE NO ACTION ON UPDATE NO ACTION</span>;-- Creating non-clustered index <span class="hljs-keyword">for</span> FOREIGN KEY <span class="hljs-string">'FK_CustomerOrder'</span>CREATE INDEX [IX_FK_CustomerOrder]ON [dbo].[Order]    ([CustomerId]);GO-- ---------------------------------------------------- Script has ended-- --------------------------------------------------&lt;/span&gt;&lt;/span&gt;</code></pre> 
         接着我们来看一个具体的例子，ModelFirst关联实体的插入操作代码如下所示： 
 <p></p> 
 <p></p> 
 <pre><code class="language-csharp hljs">&lt;span style=<span class="hljs-string">"font-size:18px;"</span>&gt;&lt;span style=<span class="hljs-string">"font-size:18px;"</span>&gt;<span class="hljs-keyword">using</span> System;<span class="hljs-keyword">using</span> System.Collections.Generic;<span class="hljs-keyword">using</span> System.Linq;<span class="hljs-keyword">using</span> System.Text;<span class="hljs-keyword">using</span> System.Threading.Tasks;<span class="hljs-keyword">namespace</span> <span class="hljs-title">ModelFirstDemo</span>{    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>    {        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)        </span>{            DataModelContainer db = <span class="hljs-keyword">new</span> DataModelContainer();            <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span>  Model First 关联实体的插入操作</span>            Customer customer = <span class="hljs-keyword">new</span> Customer();            customer.CusName = <span class="hljs-string">"呵呵"</span>;            customer.DelFlag = <span class="hljs-number">0</span>;            customer.SubTime = DateTime.Now;            Order order = <span class="hljs-keyword">new</span> Order();            order.OrderContent = <span class="hljs-string">"Flower"</span>;            <span class="hljs-comment">//给导航属性赋值</span>            <span class="hljs-comment">//order.CustomerID= customer.ID;</span>            order.Customer = customer;            Order order2 = <span class="hljs-keyword">new</span> Order();            order2.OrderContent= <span class="hljs-string">"Flower2"</span>;             order.CustomerID= customer.ID;            order2.Customer = customer;            db.Customer.Add(customer);            db.Order.Add(order);            db.Order.Add(order2);            db.SaveChanges();            <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span>        }    }}&lt;/span&gt;&lt;/span&gt;</code></pre> 
         接着，我们来看一下DBFirst，根据数据库生成模型，我们具体来看下面一段代码： 
 <p></p> 
 <p></p> 
 <pre><code class="language-csharp hljs">&lt;span style=<span class="hljs-string">"font-size:18px;"</span>&gt;&lt;span style=<span class="hljs-string">"font-size:18px;"</span>&gt;<span class="hljs-keyword">using</span> System;  <span class="hljs-keyword">using</span> System.Collections.Generic;  <span class="hljs-keyword">using</span> System.Linq;  <span class="hljs-keyword">using</span> System.Text;  <span class="hljs-keyword">using</span> System.Data;    <span class="hljs-keyword">namespace</span> <span class="hljs-title">EF.EntityFrameworkDemo</span>  {      <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>      {          <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)          </span>{              <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> 添加实体  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/创建上下文对象  </span>            <span class="hljs-comment">//DBFirstEntities dbFirst = new DBFirstEntities();  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/操作实体              </span>            <span class="hljs-comment">//T_Customer customer = new T_Customer();  </span>            <span class="hljs-comment">//customer.CusName = "新添用户";  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/附加在上下文  </span>            <span class="hljs-comment">//dbFirst.T_Customer.AddObject(customer);  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/保存  </span>            <span class="hljs-comment">//dbFirst.SaveChanges();  </span>            <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span>  </span>             <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> 删除实体  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/1、创建上下文对象  </span>            <span class="hljs-comment">//DBFirstEntities dbFirst = new DBFirstEntities();  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/2、创建实体  </span>            <span class="hljs-comment">//T_Customer customer = new T_Customer();  </span>            <span class="hljs-comment">//customer.ID = 9;  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/3、将实体附加到上下文里面来进行管理  </span>            <span class="hljs-comment">//dbFirst.T_Customer.Attach(customer);  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/修改实体的状态  </span>            <span class="hljs-comment">//dbFirst.ObjectStateManager.ChangeObjectState(customer, EntityState.Deleted);  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/4、上下文操作数据库  </span>            <span class="hljs-comment">//dbFirst.SaveChanges();  </span>            <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span>  </span>             <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> 修改实体  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/1、创建访问数据库的上下文对象  </span>            <span class="hljs-comment">//DBFirstEntities dbFirst = new DBFirstEntities();  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/2、修改对象  </span>            <span class="hljs-comment">//T_Customer customer = new T_Customer();  </span>            <span class="hljs-comment">//customer.ID = 4;  </span>            <span class="hljs-comment">//customer.CusName = "用户4_修改后2";  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/3、附加到数据库  </span>            <span class="hljs-comment">//dbFirst.T_Customer.AddObject(customer);  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/修改对象状态  </span>            <span class="hljs-comment">//dbFirst.ObjectStateManager.ChangeObjectState(customer, EntityState.Modified);  </span>            <span class="hljs-comment"><span class="hljs-doctag">///</span>/4、上下文更新数据库  </span>            <span class="hljs-comment">//dbFirst.SaveChanges();  </span>            <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span>  </span>             <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> 查询  </span>            DBFirstEntities dbFirst = <span class="hljs-keyword">new</span> DBFirstEntities();                <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> item <span class="hljs-keyword">in</span> dbFirst.T_Customer)              {                  Console.WriteLine(<span class="hljs-keyword">string</span>.Format(<span class="hljs-string">"ID:{0}  Name:{1}"</span>,item.ID,item.CusName));              }              <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> linq表达式  </span>            T_Customer cs = (<span class="hljs-keyword">from</span> customer <span class="hljs-keyword">in</span> dbFirst.T_Customer <span class="hljs-keyword">where</span> customer.ID == <span class="hljs-number">2</span> <span class="hljs-keyword">select</span> customer).SingleOrDefault();              Console.WriteLine(<span class="hljs-string">"ID:{0}  Name:{1}"</span>,cs.ID,cs.CusName);              <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span>  </span>             <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span>  </span>              Console.ReadKey();          }      }  }  &lt;/span&gt;&lt;/span&gt;</code></pre> 
 <p></p> 
 <p>        ModelFirst和DBFirst两种方式，都可以达到我们想要的效果，实现同样的目的，两个方法可以相互更新，最后小编简单的来介绍一下延迟加载，延迟加载也可以叫做按需加载，可以分两方面来理解，一方面指暂时不需要该数据，不用在当前马上加载，而可以推迟到使用它时再加载；另一方面指不确定是否将会需要该数据，所以暂时请不要加载，待确定需要后再加载它。延迟加载是一种很重要的数据访问特性，可以有效地减少与数据源的交互（注意，这里所提的交互不是指交互次数，而是指交互的数据量），从而提升程序性能。在EF中有两种延迟加载，具体代码如下所示：</p> 
 <p></p> 
 <pre><code class="language-csharp hljs">&lt;span style=<span class="hljs-string">"font-size:18px;"</span>&gt;&lt;span style=<span class="hljs-string">"font-size:18px;"</span>&gt;<span class="hljs-keyword">using</span> System;<span class="hljs-keyword">using</span> System.Collections.Generic;<span class="hljs-keyword">using</span> System.Linq;<span class="hljs-keyword">using</span> System.Text;<span class="hljs-keyword">using</span> System.Threading.Tasks;<span class="hljs-keyword">namespace</span> <span class="hljs-title">ModelFirstDemo</span>{    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>    {        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)        </span>{            DataModelContainer db = <span class="hljs-keyword">new</span> DataModelContainer();            <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span>  Model First 关联实体的插入操作</span>            Customer customer = <span class="hljs-keyword">new</span> Customer();            customer.CusName = <span class="hljs-string">"呵呵"</span>;            customer.DelFlag = <span class="hljs-number">0</span>;            customer.SubTime = DateTime.Now;            Order order = <span class="hljs-keyword">new</span> Order();            order.OrderContent = <span class="hljs-string">"Flower"</span>;            <span class="hljs-comment">//给导航属性赋值</span>            order.CustomerID= customer.ID;            order.Customer = customer;            Order order2 = <span class="hljs-keyword">new</span> Order();            order2.OrderContent= <span class="hljs-string">"Flower2"</span>;             order.CustomerID= customer.ID;            order2.Customer = customer;            db.Customer.Add(customer);            db.Order.Add(order);            db.Order.Add(order2);            db.SaveChanges();            <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span>            <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> 补充另外一个汇总查询方式：Lambda表达式</span>            Lambda表达式和linq表达式在编译阶段之后生成的IL代码是一样的            <span class="hljs-keyword">var</span> item = (<span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> db.Customer                        <span class="hljs-keyword">where</span> c.Id == <span class="hljs-number">2</span>                        <span class="hljs-keyword">select</span> c).FirstOrDefault();            List&lt;<span class="hljs-keyword">string</span>&gt; list = <span class="hljs-keyword">new</span> List&lt;<span class="hljs-keyword">string</span>&gt;();            list.FindAll()            Function&lt;Customer,<span class="hljs-keyword">bool</span>&gt;            lambda的方式            <span class="hljs-keyword">var</span> itemLambda = db.Customer.Where&lt;Customer&gt;(c=&gt;c.Id==<span class="hljs-number">1</span>).FirstOrDefault();            Console.WriteLine(itemLambda.CusName);            <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span>            <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> 延迟第一种</span>            使用linq或者lambda表达式查出来的数据，只有使用的时候才回去真正的查询数据            <span class="hljs-keyword">var</span> items = <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> db.Customer                        <span class="hljs-keyword">where</span> c.Id &lt; <span class="hljs-number">10</span>                        <span class="hljs-keyword">select</span> c;            <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> customer <span class="hljs-keyword">in</span> items)            {                Console.WriteLine(customer.Id);            }            <span class="hljs-function">IQueryable            <span class="hljs-title">foreach</span> (<span class="hljs-params"><span class="hljs-keyword">var</span> customer <span class="hljs-keyword">in</span> items</span>)            </span>{                Console.WriteLine(customer.Id);            }            <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span>            <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> 第二种延迟加载</span>            <span class="hljs-keyword">var</span> customers = <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> db.Customer                            <span class="hljs-keyword">select</span> c;            <span class="hljs-keyword">foreach</span>(<span class="hljs-keyword">var</span> cus <span class="hljs-keyword">in</span> customers)            {                Console.WriteLine(cus.Id + <span class="hljs-string">"------"</span>);                <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> cus.Order)                {                    Console.WriteLine(order.Id);                }                Console.WriteLine(<span class="hljs-string">"------"</span>);            }            <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span>            <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> 查询部分列的数据</span>            只查询表中的部分列的数据            <span class="hljs-keyword">var</span> items = <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> Customer                        <span class="hljs-keyword">where</span> c.Id &lt; <span class="hljs-number">100</span>                        <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { id = c.Id, CusName = c.CusName, count = <span class="hljs-number">0</span>, orderCount = c.Order.Count() };            <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> item <span class="hljs-keyword">in</span> items)            {                Console.WriteLine(item.CusName + <span class="hljs-string">"------"</span> + item.orderCount);            }            <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span>            <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> IQuerable接口跟其他集合的区别</span>            <span class="hljs-keyword">var</span> items = (<span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> db.Order                         <span class="hljs-keyword">where</span> c.Id &lt; <span class="hljs-number">2</span>                         <span class="hljs-keyword">select</span> c).ToList();            <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> items)            {                Console.WriteLine(order.Id);            }            <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span>            Console.ReadKey();        }    }}&lt;/span&gt;&lt;/span&gt;</code></pre> 
        <strong>小编寄语</strong>：该博文，小编主要介绍了一些EF的基础知识，分别从三个大方面对EF进行详细介绍，第一个方面：EF与linq to sql的关系以及为什么要使用EF与linq  to sql，第二方面，介绍了一下ModelFirst和DBFirst，最后介绍了一下延迟加载，对于EF的相关知识，小编刚刚接触，理解的还是很浅，有不同意见的小伙伴可以一起讨论交流哦，常常想，如果不是因为缘分，如果不是因为接受了项目什么mvc、EF、linq等，小编也没有这么快就开始接触，在接项目的过程中学习，再把学习到的知识运用到项目中，赶脚棒棒哒，档案管理项目，未完待续......            
</div> 
<p>再分享一下我老师大神的人工智能教程吧。零基础！通俗易懂！风趣幽默！还带黄段子！希望你也加入到我们人工智能的队伍中来！<a href="https://blog.csdn.net/jiangjunshow/article/details/77338485">https://blog.csdn.net/jiangjunshow</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c448c8e64c167296530544cea1320a0e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">力扣——体育馆的人流量</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a0e060f616db3838568d4fa72fe4c183/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Skimage图像处理教程3）曝光度调整</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>