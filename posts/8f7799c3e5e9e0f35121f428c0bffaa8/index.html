<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C# Winform 异常: 没有执行权限 的解决方法 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C# Winform 异常: 没有执行权限 的解决方法" />
<meta property="og:description" content="写时间:2018年06月13日 03:54:40
前几天博主写关于访问注册表的程序, 却发现读取到的Value值为空, 这就很奇怪了. 检查代码却并未发现有什么问题, 捕获到的异常如下:
异常: System.Security.SecurityException (用户没有读取注册表项所需的权限)
最开始我认为是需要用右键的管理员权限来运行程序, 结果不行. 经查阅资料和以前乱玩项目属性的时候遇到一个以管理员权限来运行的程序的方式, 马上做出修改, 果然成功了. 修改过程如下:
右键项目-&gt;属性-&gt;安全性-&gt;勾上(启用ClickOnce安全设置, 然后立刻取消勾选, 此操作目的是为了让app.manifest文件显示在项目里以方便修改该文件内容)
然后修改项目Properties下面的app.manifest文件(将第11行的配置覆盖到18行)
修改好后程序就可以使用管理员权限来访问一些系统敏感位置了.
更新时间: 2018年9月21日14点47分
注意: 当你编写的程序需要使用管理员权限时, 你的VS在调试时可能会有如下提示
以前我碰到这种情况的时候都是 F7生成--&gt;浏览目录--&gt;双击生成的EXE文件, 然后查看控制台输出和程序运行结果来查看效果的. 小项目还行, 代码不多, 但是到了公司里, 一个解决方案里三十几个项目, 一个文件里几千行无注释代码.......头疼!!
现在我才发现可以直接退出VS, 以管理员权限运行VS就可以继续调试了." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8f7799c3e5e9e0f35121f428c0bffaa8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-06-13T03:54:40+08:00" />
<meta property="article:modified_time" content="2018-06-13T03:54:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C# Winform 异常: 没有执行权限 的解决方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="color:#f33b45;"><strong><em>写时间:2018年06月13日 03:54:40</em></strong></span></p> 
<p>前几天博主写关于访问注册表的程序, 却发现读取到的Value值为空, 这就很奇怪了. </p> 
<p>检查代码却并未发现有什么问题, 捕获到的异常如下:</p> 
<p>异常: System.Security.SecurityException (用户没有读取注册表项所需的权限)</p> 
<p>最开始我认为是需要用右键的管理员权限来运行程序, 结果不行. 经查阅资料和以前乱玩项目属性的时候遇到一个以管理员权限来运行的程序的方式, 马上做出修改, 果然成功了. 修改过程如下:</p> 
<p> 右键项目-&gt;属性-&gt;安全性-&gt;勾上(启用ClickOnce安全设置, 然后立刻取消勾选, 此操作目的是为了让app.manifest文件显示在项目里以方便修改该文件内容)</p> 
<p>然后修改项目Properties下面的app.manifest文件(将第11行的配置覆盖到18行)</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/a8/30/sLTHkPnT_o.png"></p> 
<p>修改好后程序就可以使用管理员权限来访问一些系统敏感位置了.</p> 
<p><span style="color:#f33b45;"><strong><em>更新时间: 2018年9月21日14点47分</em></strong></span></p> 
<p>注意: 当你编写的程序需要使用管理员权限时, 你的VS在调试时可能会有如下提示</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/37/74/pw3xXnl7_o.jpg"></p> 
<p>以前我碰到这种情况的时候都是 F7生成--&gt;浏览目录--&gt;双击生成的EXE文件, 然后查看控制台输出和程序运行结果来查看效果的. 小项目还行, 代码不多, 但是到了公司里, 一个解决方案里三十几个项目, 一个文件里几千行无注释代码.......头疼!!</p> 
<p>现在我才发现可以直接退出VS, 以管理员权限运行VS就可以继续调试了.</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5658f8c9404d7ec1fc3c01ecb47d3a67/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JavaScript获取uuid</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c7be0c603f1874c94db6b32812607759/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Js修改密码，并限制为8位长度，包含大小写加数字</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>