<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>excel vba真正的动态数组实例-按需定义数组大小 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="excel vba真正的动态数组实例-按需定义数组大小" />
<meta property="og:description" content="excel vba真正的动态数组实例
一、动态数组的定义
动态数组的定义，一开始不需要给数组标明上界和下界。直接定义即可，如下面的代码：
Dim MyStr() As String
这样，就定义了一个动态数组及其名称：MyStr()，现在，该数组的上界下界都是个未知数，也就是说，数组中到底有没有内容或到底有什么内容，是个未知数。
因此，要使用动态数组，就必须对其定义好下界和上界。
二、给动态数组确定下界和上界
给动态数组重新确定下界和上界，那么，分两种情况。
①保留原值
采用此代码：ReDim Preserve MyStr(n)　&#39;n为数组长度
②不保留原值
采用此代码：ReDim MyStr(n)　&#39;n为数组长度
③以上两种情况的实例
下面我们看如上两种情况的小实例：
比如：
Dim MyStr() As String ReDim MyStr(2) MyStr(0)=”1” MyStr(1)=”2”
现在，这个动态数组有两个值了，分别是0和1，现在，我们再重新确定该数组的长度。
当然，重新确定自然又有两种情况了。
Ａ、保留原有数据
ReDim Preserve MyStr(3) &#39;原来长度是2，现在重新确定为3，并且，保留原有的数据。 MyStr(2)=”3” &#39;现在，该数组就有三个值了，分别是：
MyStr(0)为1、MyStr(1)为2、MyStr(2)为3
Ｂ、不保留原有数据
如果我们使用如下代码
ReDim MyStr(3) MyStr(2)=”3”
现在，该数组的长度尽管为3，但是，里面却只有一个数据了，那就是，MyStr(2)的值是3，而MyStr(0)和MyStr(1)里面，什么都没有。
关键字：Preserve的作用就的保留原有值，请根据需要加以取舍。
三、动态数组与EXCEL的结合使用实例
Dim n As Integer n = 0 Dim MyStr() As String For i = 1 To Sheet1.UsedRange.Rows.Count For j = 1 To Sheet1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/42a5e803897b437f73de0c1b564c1a72/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-09-30T16:59:30+08:00" />
<meta property="article:modified_time" content="2013-09-30T16:59:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">excel vba真正的动态数组实例-按需定义数组大小</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); font-family:Verdana,Arial,Tahoma; font-size:14px; line-height:25px"> <span style="padding:0px; margin:0px; font-family:Arial,Helvetica,sans-serif; font-size:12px; line-height:18px">excel vba真正的动态数组实例</span></p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); font-family:Verdana,Arial,Tahoma; font-size:14px; line-height:25px"> </p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> <span style="color:#0000ff; padding:0px; margin:0px"><span style="padding:0px; margin:0px">一、动态数组的定义</span></span></p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　动态数组的定义，一开始不需要给数组标明上界和下界。直接定义即可，如下面的代码：</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　Dim MyStr() As String</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　这样，就定义了一个动态数组及其名称：MyStr()，现在，该数组的上界下界都是个未知数，也就是说，数组中到底有没有内容或到底有什么内容，是个未知数。</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　因此，要使用动态数组，就必须对其定义好下界和上界。</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　<span style="color:#0000ff; padding:0px; margin:0px"><span style="padding:0px; margin:0px">二、给动态数组确定下界和上界</span></span></p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　给动态数组重新确定下界和上界，那么，分两种情况。</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　<span style="padding:0px; margin:0px">①保留原值</span></p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　采用此代码：ReDim <span style="color:#ff0000; padding:0px; margin:0px"><span style="padding:0px; margin:0px">Preserve</span></span> MyStr(n)　'n为数组长度</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　<span style="padding:0px; margin:0px">②不保留原值</span></p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　采用此代码：ReDim MyStr(n)　'n为数组长度</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　<span style="padding:0px; margin:0px">③以上两种情况的实例</span></p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　下面我们看如上两种情况的小实例：</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　比如：</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　Dim MyStr() As String<br style="padding:0px; margin:0px"> ReDim MyStr(2)<br style="padding:0px; margin:0px"> MyStr(0)=”1”<br style="padding:0px; margin:0px"> MyStr(1)=”2”</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　现在，这个动态数组有两个值了，分别是0和1，现在，我们再重新确定该数组的长度。</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　当然，重新确定自然又有两种情况了。</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　<span style="padding:0px; margin:0px; font-style:normal"><span style="padding:0px; margin:0px">Ａ、保留原有数据</span></span></p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　ReDim <span style="color:#ff0000; padding:0px; margin:0px"><span style="padding:0px; margin:0px">Preserve</span></span> MyStr(3) '原来长度是2，现在重新确定为3，并且，保留原有的数据。<br style="padding:0px; margin:0px"> MyStr(2)=”3” '现在，该数组就有三个值了，分别是：</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　MyStr(0)为1、MyStr(1)为2、MyStr(2)为3</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　<span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px; font-style:normal; font-weight:normal">Ｂ、不保留原有数据</span></span></p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　如果我们使用如下代码</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　ReDim MyStr(3)<br style="padding:0px; margin:0px"> MyStr(2)=”3”</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　现在，该数组的长度尽管为3，但是，里面却只有一个数据了，那就是，MyStr(2)的值是3，而MyStr(0)和MyStr(1)里面，什么都没有。</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　关键字：Preserve的作用就的保留原有值，请根据需要加以取舍。</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　<span style="color:#0000ff; padding:0px; margin:0px"><span style="padding:0px; margin:0px">三、动态数组与EXCEL的结合使用实例</span></span></p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　Dim n As Integer<br style="padding:0px; margin:0px"> n = 0<br style="padding:0px; margin:0px"> Dim MyStr() As String<br style="padding:0px; margin:0px"> For i = 1 To Sheet1.UsedRange.Rows.Count<br style="padding:0px; margin:0px"> For j = 1 To Sheet1.UsedRange.Columns.Count<br style="padding:0px; margin:0px"> n = n + 1<br style="padding:0px; margin:0px"> <span style="color:#ff0000; padding:0px; margin:0px"><span style="padding:0px; margin:0px">ReDim Preserve MyStr(n)</span></span> '给动态数组重定义一个实际的大小<br style="padding:0px; margin:0px"> MyStr(n - 1) = Sheet1.Cells(i, j).Value '存到动态数组里去<br style="padding:0px; margin:0px"> Next j<br style="padding:0px; margin:0px"> Next i<br style="padding:0px; margin:0px"> For Each MyArray In MyStr<br style="padding:0px; margin:0px"> MsgBox "数组的值是" &amp; MyArray<br style="padding:0px; margin:0px"> Next</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　以上代码的功能是：将Sheet1中已经有数据的单元格区域，通过VBA代码循环找到每行每列对应的单元格的值，通过对话框显示出来。</p> 
<p style="padding-top:0px; padding-bottom:0px; margin-top:0px; margin-bottom:0px; color:rgb(51,51,51); line-height:18px"> 　　注意哦，数组的使用，其下界都是从0开始的。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/852296c6077330bfe3927d3e06c9391b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL-5.6.13免安装版配置方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9c8fdc70cbb1a4f13d3d81c60b5fcb57/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【数据结构】之二叉树的java实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>