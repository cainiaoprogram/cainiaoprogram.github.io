<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>02 DIY流星观测站——手把手搭建指南 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="02 DIY流星观测站——手把手搭建指南" />
<meta property="og:description" content="相关系列文章 01 DIY流星观测站02 DIY流星观测站——手把手搭建指南03 DIY流星观测站——设备选型与采购04 DIY流星观测站——镜头简介05 DIY流星观测站——相机简介 该教程的目的是快速引导流星爱好者（天文爱好者）搭建一个完整的流星观测站，并通过该观测站观测流星。建站所需的器材都是市场上成熟的的工业产品，价格在大众可以接受的范围之内，所有器材都可以在网上买到。该项目为开源项目，欢迎大家的参与和讨论。 更多详细信息请参考项目的源码站点。
1 相关配件 1.1 必须器材列表 树莓派电脑：Raspberry Pi 3（RPi3）树莓派电源：电压5V，最大电流至少2AmicroSD卡：大于等于64GB，树莓派的系统盘，U盘不能作为系统盘。microSD读卡器：向microSD卡中安装树莓派操作系统，读取microSD卡的数据，从树莓派拷贝数据。3厘米×3厘米风扇：树莓派散热风扇。铝合金散热片：一共需要3个。树莓派散热片，选择有粘胶的，可以直接贴在树莓派的芯片上。时间模块：DS3231时间模块，树莓派关机后，可保存树莓派的时间。USB视频采集卡(UTV007)：将模拟相机的模拟视频信号转换为数字信号。模拟相机：Sony673相机或WATEC WAT-902H相机，配置一个4mm或6mm的镜头。其他镜头也行，观测效果会略有不同。12伏电源：模拟相机电压一般为12V。HDMI线：树莓派视频输出接口为HDMI接口，如果显示器不支持HDMI接口，则需要配置一个HDMI转VGA接口的线。 1.2 可选器材列表 万用表：检验新买回的电源的电压是否正常，相机组装及故障时也会需要。电烙铁、锡丝、夹子、绝缘胶带、松香：电子产品DIY必备物品。相机板镜头接口：如果直接购买相机板，则需要在购买配套的镜头接口。相机盒：网上买的工业相机，有时候没有相机盒。AUTO IRIS接口：自动光圈控制线接口。不同的品牌和型号之间，自动光圈接口中4根线的对应位置会有所差异，或许需要手动调整接线。AV延长线：延长模拟相机的视频输出线。C/CS转接口：工业相机和镜头有C接口和CS接口之分，用于转接不匹配的相机和镜头。USB延长线：USB视频采集卡的USB线偏短，接上延长线后方便操作。三脚架：测试时放置相机。 2 DIY流星观测站硬件组装 所需器材列表：树莓派电脑（RPi3），5V树莓派电源，microSD卡，microSD读卡器，一个3厘米*3厘米风扇，3个铝合金散热片，一个DS3231时间模块
2.1 安装Raspbian操作系统 在树莓派官网下载最新版Raspbian镜像，通过microSD卡读卡器将Raspbian镜像安装到microSD上，详细的安装过程请参考官网教程Raspbian安装
2.2 安装散热片 将CPU和GPU的正反两面各粘一个散热片
2.3 安装树莓派保护壳： 上面两幅图是网上最便宜的“亚克力”保护壳，其实就是硬塑料，这种保护壳比较脆，在调试时需要频繁拆开外壳时，会非常不方便。左下角是另一种外壳，相对来说比较结实方便，右下角为安装好外壳的树莓派。
2.4 安装DS3231时间模块和风扇 DS3231时间模块应该插在靠里一排GPIO的前四个引脚上，如上图左图所示。 风扇接口应该插在靠外一排GPIO的第2和3个引脚上，如上图右图所示。
2.5 树莓派连接电脑 所需器材列表： - 显示器：查看显示器是否有HDMI、DVI或VGA接口 - 视频线：HDMI线、HDMI转VGA线、或HDMI转DVI线，取决于显示器的视频输入接口 - USB鼠标和键盘：树莓派一共4个USB接口，测试时或许会不够用，使用USB键鼠套装可以省一个USB接口。 - 网线：更新系统，安装软件 2.6 连接模拟相机（数字相机的支持正在研发当中） 所需器材列表：USB视频采集卡(UTV007)，Sony673相机或WATEC WAT-902H相机，12V电源，两公头AV线。
取一根两端都是公头的AV线，一段接在相机的视频输出接口（AV母头），另一端接在USB视频采集卡(UTV007)的黄色视频输入母头。 2.7 联机测试 将相机和树莓派电脑连接起来，测试电脑是否能从相机正常采集图像。
打开终端（可通过快捷方式Crtl&#43;Alt&#43;T打开），安装mplayer：
sudo apt-get install mplayer
通过mplayer可以预览相机的视频，如果是NTSC相机，则在命令行运行：
mplayer tv:// -tv driver=v4l2:device=/dev/video0:input=0:norm=NTSC -vo x11
如果是PAL相机，则在命令行运行：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/d4fc766e2f7be5dcbe1532240b03c1ab/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-08-13T23:55:33+08:00" />
<meta property="article:modified_time" content="2018-08-13T23:55:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">02 DIY流星观测站——手把手搭建指南</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4 id="相关系列文章">相关系列文章</h4> 
<ul><li><a href="https://blog.csdn.net/mseeworld/article/details/81639468">01 DIY流星观测站</a></li><li><a href="https://blog.csdn.net/mseeworld/article/details/81636441">02 DIY流星观测站——手把手搭建指南</a></li><li><a href="https://blog.csdn.net/mseeworld/article/details/81639565">03 DIY流星观测站——设备选型与采购</a></li><li><a href="https://blog.csdn.net/mseeworld/article/details/81639607">04 DIY流星观测站——镜头简介</a></li><li><a href="https://blog.csdn.net/mseeworld/article/details/81639619">05 DIY流星观测站——相机简介</a></li></ul> 
<p>该教程的目的是快速引导流星爱好者（天文爱好者）搭建一个完整的流星观测站，并通过该观测站观测流星。建站所需的器材都是市场上成熟的的工业产品，价格在大众可以接受的范围之内，所有器材都可以在网上买到。该项目为开源项目，欢迎大家的参与和讨论。 <br> 更多详细信息请参考项目的<a href="https://gitee.com/mseeworld/DIY-MeteorStation" rel="nofollow">源码站点</a>。</p> 
<h2 id="1-相关配件">1 相关配件</h2> 
<p><img src="https://images2.imgbox.com/33/02/CganSQhm_o.jpg" alt="配件列表" title=""></p> 
<h3 id="11-必须器材列表">1.1 必须器材列表</h3> 
<ul><li><strong>树莓派电脑</strong>：Raspberry Pi 3（RPi3）</li><li><strong>树莓派电源</strong>：电压5V，最大电流至少2A</li><li><strong>microSD卡</strong>：大于等于64GB，树莓派的系统盘，U盘不能作为系统盘。</li><li><strong>microSD读卡器</strong>：向microSD卡中安装树莓派操作系统，读取microSD卡的数据，从树莓派拷贝数据。</li><li><strong>3厘米×3厘米风扇</strong>：树莓派散热风扇。</li><li><strong>铝合金散热片</strong>：一共需要3个。树莓派散热片，选择有粘胶的，可以直接贴在树莓派的芯片上。</li><li><strong>时间模块</strong>：DS3231时间模块，树莓派关机后，可保存树莓派的时间。</li><li><strong>USB视频采集卡(UTV007)</strong>：将模拟相机的模拟视频信号转换为数字信号。</li><li><strong>模拟相机</strong>：Sony673相机或WATEC WAT-902H相机，配置一个4mm或6mm的镜头。其他镜头也行，观测效果会略有不同。</li><li><strong>12伏电源</strong>：模拟相机电压一般为12V。</li><li><strong>HDMI线</strong>：树莓派视频输出接口为HDMI接口，如果显示器不支持HDMI接口，则需要配置一个HDMI转VGA接口的线。</li></ul> 
<h3 id="12-可选器材列表">1.2 可选器材列表</h3> 
<ul><li><strong>万用表</strong>：检验新买回的电源的电压是否正常，相机组装及故障时也会需要。</li><li><strong>电烙铁、锡丝、夹子、绝缘胶带、松香</strong>：电子产品DIY必备物品。</li><li><strong>相机板镜头接口</strong>：如果直接购买相机板，则需要在购买配套的镜头接口。</li><li><strong>相机盒</strong>：网上买的工业相机，有时候没有相机盒。</li><li><strong>AUTO IRIS接口</strong>：自动光圈控制线接口。不同的品牌和型号之间，自动光圈接口中4根线的对应位置会有所差异，或许需要手动调整接线。</li><li><strong>AV延长线</strong>：延长模拟相机的视频输出线。</li><li><strong>C/CS转接口</strong>：工业相机和镜头有C接口和CS接口之分，用于转接不匹配的相机和镜头。</li><li><strong>USB延长线</strong>：USB视频采集卡的USB线偏短，接上延长线后方便操作。</li><li><strong>三脚架</strong>：测试时放置相机。</li></ul> 
<h2 id="2-diy流星观测站硬件组装">2 DIY流星观测站硬件组装</h2> 
<p><img src="https://images2.imgbox.com/89/f8/NLPfdDSr_o.jpg" alt="DIY流星观测站硬件组装" title=""> <br> <strong>所需器材列表</strong>：树莓派电脑（RPi3），5V树莓派电源，microSD卡，microSD读卡器，一个3厘米*3厘米风扇，3个铝合金散热片，一个DS3231时间模块</p> 
<h3 id="21-安装raspbian操作系统">2.1 安装Raspbian操作系统</h3> 
<p><img src="https://images2.imgbox.com/17/bb/5zFWoEe6_o.png" alt="Raspbian官网" title=""> <br> 在树莓派官网下载最新版<a href="https://www.raspberrypi.org/downloads/raspbian/" rel="nofollow">Raspbian镜像</a>，通过microSD卡读卡器将Raspbian镜像安装到microSD上，详细的安装过程请参考官网教程<a href="https://www.raspberrypi.org/documentation/installation/installing-images/README.md" rel="nofollow">Raspbian安装</a></p> 
<h3 id="22-安装散热片">2.2 安装散热片</h3> 
<p><img src="https://images2.imgbox.com/29/4c/54ALhPKJ_o.png" alt="散热片" title=""> <br> 将CPU和GPU的正反两面各粘一个散热片</p> 
<h3 id="23-安装树莓派保护壳">2.3 安装树莓派保护壳：</h3> 
<p><img src="https://images2.imgbox.com/28/91/DrfVsDk2_o.jpg" alt="树莓派保护壳" title=""> <br> 上面两幅图是网上最便宜的“亚克力”保护壳，其实就是硬塑料，这种保护壳比较脆，在调试时需要频繁拆开外壳时，会非常不方便。左下角是另一种外壳，相对来说比较结实方便，右下角为安装好外壳的树莓派。</p> 
<h3 id="24-安装ds3231时间模块和风扇">2.4 安装DS3231时间模块和风扇</h3> 
<p><img src="https://images2.imgbox.com/84/f4/fnDj3sQI_o.jpg" alt="DS3231时间模块和风扇" title=""> <br> DS3231时间模块应该插在靠里一排GPIO的前四个引脚上，如上图左图所示。 <br> 风扇接口应该插在靠外一排GPIO的第2和3个引脚上，如上图右图所示。</p> 
<h3 id="25-树莓派连接电脑">2.5 树莓派连接电脑</h3> 
<p>所需器材列表： <br> - <strong>显示器</strong>：查看显示器是否有HDMI、DVI或VGA接口 <br> - <strong>视频线</strong>：HDMI线、HDMI转VGA线、或HDMI转DVI线，取决于显示器的视频输入接口 <br> - <strong>USB鼠标和键盘</strong>：树莓派一共4个USB接口，测试时或许会不够用，使用USB键鼠套装可以省一个USB接口。 <br> - <strong>网线</strong>：更新系统，安装软件 <br> <img src="https://images2.imgbox.com/32/ac/C6ydWPVA_o.jpg" alt="树莓派连接电脑" title=""></p> 
<h3 id="26-连接模拟相机数字相机的支持正在研发当中">2.6 连接模拟相机（数字相机的支持正在研发当中）</h3> 
<p>所需器材列表：USB视频采集卡(UTV007)，Sony673相机或WATEC WAT-902H相机，12V电源，两公头AV线。</p> 
<p>取一根两端都是公头的AV线，一段接在相机的视频输出接口（AV母头），另一端接在USB视频采集卡(UTV007)的黄色视频输入母头。 <br> <img src="https://images2.imgbox.com/5b/23/9RCjdv3e_o.jpg" alt="模拟相机连接USB视频采集卡" title=""></p> 
<h3 id="27-联机测试">2.7 联机测试</h3> 
<p><img src="https://images2.imgbox.com/ba/c2/DunMYndf_o.jpg" alt="联机测试" title=""></p> 
<p>将相机和树莓派电脑连接起来，测试电脑是否能从相机正常采集图像。</p> 
<p>打开终端（可通过快捷方式Crtl+Alt+T打开），安装mplayer：</p> 
<blockquote> 
 <p>sudo apt-get install mplayer</p> 
</blockquote> 
<p>通过mplayer可以预览相机的视频，如果是NTSC相机，则在命令行运行：</p> 
<blockquote> 
 <p>mplayer tv:// -tv driver=v4l2:device=/dev/video0:input=0:norm=NTSC -vo x11</p> 
</blockquote> 
<p>如果是PAL相机，则在命令行运行：</p> 
<blockquote> 
 <p>mplayer tv:// -tv driver=v4l2:device=/dev/video0:input=0:norm=PAL -vo x11</p> 
</blockquote> 
<p>请注意，上面两条命令中的“driver=v4l2”，“l”是小写的L。</p> 
<p>如果一切正常，将会弹出一个窗口，窗口中会显示相机拍摄的视频。如果没有看到视频，请检查前面的步骤。</p> 
<h2 id="3-安装流星观测软件">3 安装流星观测软件</h2> 
<h3 id="31-安装相关依赖包">3.1 安装相关依赖包</h3> 
<p>更新系统和系统中的软件包：</p> 
<blockquote> 
 <p>sudo apt-get update <br> sudo apt-get upgrade</p> 
</blockquote> 
<p>安装流星观测软件的依赖包：</p> 
<blockquote> 
 <p>sudo apt-get install git mplayer python-scipy python-matplotlib python2.7 python2.7-dev libblas-dev liblapack-dev at-spi2-core python-matplotlib libopencv-dev python-opencv python-imaging-tk libffi-dev libssl-dev</p> 
</blockquote> 
<p>安装图形化文本编辑器：</p> 
<blockquote> 
 <p>sudo apt-get install gedit</p> 
</blockquote> 
<p>安装python环境 <br> 更新pip</p> 
<blockquote> 
 <p>sudo pip install -U pip setuptools</p> 
</blockquote> 
<p>安装并更新numpy</p> 
<blockquote> 
 <p>sudo pip install numpy <br> sudo pip –upgrade numpy</p> 
</blockquote> 
<p>安装其他python依赖包：</p> 
<blockquote> 
 <p>sudo pip install gitpython Pillow scipy cython astropy pyephem weave paramiko</p> 
</blockquote> 
<h3 id="32-设置时区和时钟模块">3.2 设置时区和时钟模块</h3> 
<p>在天文领域，时间是非常重要的一个属性。我们观测的每一幅图像都需要有一个准确的时间标识，这样才能准确计算天文事件（如流星、引力波）的发生时间。</p> 
<h4 id="321-将树莓派的时区设置为utc在命令行中运行">3.2.1 将树莓派的时区设置为UTC，在命令行中运行：</h4> 
<blockquote> 
 <p>sudo dpkg-reconfigure tzdata</p> 
</blockquote> 
<p>该命令会打开一个界面，选择“None of the above” ，然后选择“UTC”，之后退出。</p> 
<h4 id="322-设置时间模块">3.2.2 设置时间模块</h4> 
<p>前面我们已经为树莓派添加了时间模块硬件，这里对时间模块进行设置，在树莓派关机后，时间模块能够保持系统的时间。</p> 
<p>编辑文件/boot/config.txt：</p> 
<blockquote> 
 <p>sudo gedit /boot/config.txt</p> 
</blockquote> 
<pre class="prettyprint"><code class=" hljs ini"><span class="hljs-setting">dtparam=<span class="hljs-value">i2c_arm=<span class="hljs-keyword">on</span></span></span>
<span class="hljs-setting">dtoverlay=<span class="hljs-value">i2c-rtc,ds3231</span></span></code></pre> 
<p>保存后关闭gedit，重启树莓派：</p> 
<blockquote> 
 <p>sudo reboot</p> 
</blockquote> 
<h4 id="323-移除伪时间模块fake-hwclock">3.2.3 移除伪时间模块fake-hwclock</h4> 
<blockquote> 
 <p>sudo apt-get remove fake-hwclock <br> sudo update-rc.d hwclock.sh enable <br> sudo update-rc.d fake-hwclock remove</p> 
</blockquote> 
<p>注释掉文件/lib/udev/hwclock-set的有-systz的那一行：</p> 
<blockquote> 
 <p>sudo gedit /lib/udev/hwclock-set</p> 
</blockquote> 
<p>在“有-systz的那一行”前面加上“#”</p> 
<h4 id="324-将当前时间写入到时间模块中并删除ntp服务">3.2.4 将当前时间写入到时间模块中，并删除NTP服务：</h4> 
<blockquote> 
 <p>sudo hwclock -w <br> sudo apt-get remove ntp <br> sudo apt-get install ntpdate</p> 
</blockquote> 
<h4 id="325-开机自动设置时间">3.2.5 开机自动设置时间：</h4> 
<p>编辑/etc/rc.local，在exit 0前添加hwclock相关的命令</p> 
<blockquote> 
 <p>sudo gedit /etc/rc.local</p> 
</blockquote> 
<pre class="prettyprint"><code class=" hljs bash">sleep <span class="hljs-number">1</span>
hwclock <span class="hljs-operator">-s</span>
ntpdate-debian
<span class="hljs-keyword">exit</span> <span class="hljs-number">0</span></code></pre> 
<h4 id="326-阻止系统自动修改时间">3.2.6 阻止系统自动修改时间</h4> 
<p>编辑/etc/default/hwclock文件，设置参数HWCLOCKACCESS=no</p> 
<blockquote> 
 <p>gedit /etc/default/hwclock</p> 
</blockquote> 
<pre class="prettyprint"><code class=" hljs ini"><span class="hljs-setting">HWCLOCKACCESS=<span class="hljs-value"><span class="hljs-keyword">no</span></span></span></code></pre> 
<h4 id="327-关闭自动更新时间的功能">3.2.7 关闭自动更新时间的功能</h4> 
<p>在/lib/systemd/system/hwclock-save.service中注释掉下一行： <br> ConditionFileIsExecutable=!/usr/sbin/ntpd</p> 
<blockquote> 
 <p>gedit /lib/systemd/system/hwclock-save.service</p> 
</blockquote> 
<pre class="prettyprint"><code class=" hljs vala"><span class="hljs-preprocessor">#ConditionFileIsExecutable=!/usr/sbin/ntpd</span></code></pre> 
<h4 id="328-开启实时时间服务">3.2.8 开启实时时间服务：</h4> 
<blockquote> 
 <p>sudo systemctl enable hwclock-save.service</p> 
</blockquote> 
<p>设置每15分钟更新一次时间，运行命令：</p> 
<blockquote> 
 <p>crontab -e</p> 
</blockquote> 
<p>然后选择一个文本编辑器，在文件的最后面增加下面的内容：</p> 
<pre class="prettyprint"><code class=" hljs javascript">*<span class="hljs-regexp">/15 * * * * ntpdate-debian &gt;/</span>dev/<span class="hljs-literal">null</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span></code></pre> 
<p>然后重启系统</p> 
<h3 id="33-开启看门狗watchdog服务">3.3 开启看门狗（watchdog）服务</h3> 
<p>有时候树莓派电脑会莫名其妙的死掉，通过看门狗服务可以在电脑死机后自动重启电脑。</p> 
<h4 id="331-安装看门狗服务">3.3.1 安装看门狗服务</h4> 
<blockquote> 
 <p>sudo apt-get install watchdog</p> 
</blockquote> 
<h3 id="332-加载看门狗模块">3.3.2 加载看门狗模块</h3> 
<blockquote> 
 <p>sudo modprobe bcm2835_wdt</p> 
</blockquote> 
<h4 id="333-自动加载模块">3.3.3 自动加载模块</h4> 
<blockquote> 
 <p>sudo gedit /etc/modules-load.d/bcm2835_wdt.conf</p> 
</blockquote> 
<p>添加内容：</p> 
<pre class="prettyprint"><code class=" hljs ">bcm2835_wdt</code></pre> 
<blockquote> 
 <p>sudo gedit /lib/systemd/system/watchdog.service</p> 
</blockquote> 
<p>在[Install]部分添加如下内容：</p> 
<pre class="prettyprint"><code class=" hljs ini"><span class="hljs-title">[Install]</span>
<span class="hljs-setting">WantedBy=<span class="hljs-value">multi-user.target</span></span></code></pre> 
<h4 id="334-配置看门狗服务">3.3.4 配置看门狗服务：</h4> 
<blockquote> 
 <p>sudo gedit /etc/watchdog.conf</p> 
</blockquote> 
<p>删除掉“#watchdog-device”开头的行的前面的“#”</p> 
<p>同时也删除掉“#max-load-1 = 24”前面的“#”</p> 
<h4 id="335-设置看门狗服务为开机自启动并启动看门狗">3.3.5 设置看门狗服务为开机自启动并启动看门狗</h4> 
<blockquote> 
 <p>sudo systemctl enable watchdog.service <br> sudo systemctl start watchdog.service</p> 
</blockquote> 
<h3 id="34-安装流星观测软件">3.4 安装流星观测软件</h3> 
<h4 id="341下载软件源代码默认将源码下载到用户根目录">3.4.1下载软件源代码（默认将源码下载到用户根目录）：</h4> 
<blockquote> 
 <p>cd ~ <br> git clone “<a href="https://gitee.com/mseeworld/DIY-MeteorStation.git" rel="nofollow">https://gitee.com/mseeworld/DIY-MeteorStation.git</a>”</p> 
</blockquote> 
<h4 id="342-安装流星观测软件">3.4.2 安装流星观测软件：</h4> 
<blockquote> 
 <p>cd DIY-MeteorStation <br> sudo python setup.py install</p> 
</blockquote> 
<h4 id="343-编辑观测软件的配置文件config">3.4.3 编辑观测软件的配置文件.config</h4> 
<blockquote> 
 <p>sudo gedit DIY-MeteorStation/.config</p> 
</blockquote> 
<pre class="prettyprint"><code class=" hljs markdown">[System]
Station ID
观测站的唯一编号，可以随便取一个3位数数字。
GPS location
观测站所在位置的经纬度坐标，该坐标用来自动计算每天的黄昏和黎明时间，用于控制系统的开始和结束运行时间。
经纬多坐标可以通过手机的GPS软件查询，也可以通过百度等网站查询：[<span class="hljs-link_label">百度页面查询经纬度</span>](<span class="hljs-link_url">http://api.map.baidu.com/lbsapi/getpoint/index.html</span>)。
[Capture]
Resolution and FPS
对不同的相机，需要正确设置相机的分辨率和帧频。对模拟相机可参考下表。
| 参数   | PAL | NTSC |
|--------|-----|------|
| 相机宽 |720  |720   |
| 图像高 |576  |480   |
| 帧频   |25.0 |29.97 |</code></pre> 
<p>修改完成后，保存并退出gedit文本编辑器。</p> 
<h3 id="35-配置模拟相机sony673">3.5 配置模拟相机（Sony673）</h3> 
<p>将相机和树莓派连接上，打开树莓派电脑，运行mplayer，进行相机参数的配置。</p> 
<p>打开终端，如果是NTSC相机，运行如下命令：</p> 
<blockquote> 
 <p>mplayer tv:// -tv driver=v4l2:device=/dev/video0:input=0:norm=NTSC -vo x11</p> 
</blockquote> 
<p>如果是PAL相机，运行如下命令：</p> 
<blockquote> 
 <p>mplayer tv:// -tv driver=v4l2:device=/dev/video0:input=0:norm=PAL -vo x11</p> 
</blockquote> 
<p>现在可以通过mplayer看到相机的内容，按相机中间的“SET”按钮，会出现配置菜单。详细参数配置请参考DIY-MeteorStation/Guides/icx673_settings.txt文件，或者参考设置步骤：</p> 
<pre class="prettyprint"><code class=" hljs vbnet">LENS - MANUAL
SHUTTER/AGC - MANUAL (ENTER)
             MODE - SHT+AGC
             SHUTTER - <span class="hljs-number">1</span>/<span class="hljs-number">50</span>
             AGC - <span class="hljs-number">18</span>
WHITE BALLANCE - ANTI CR
BACKLIGHT - <span class="hljs-keyword">OFF</span>
PICT ADJUSTMENT (ENTER)
          MIRROR - <span class="hljs-keyword">OFF</span>
          BRIGHTNESS - <span class="hljs-number">0</span>
          CONTRAST - <span class="hljs-number">255</span>
          SHARPNESS - <span class="hljs-number">0</span>
          HUE - <span class="hljs-number">128</span>
          GAIN - <span class="hljs-number">128</span>
          DEFOGG - <span class="hljs-keyword">OFF</span>
ATR - <span class="hljs-keyword">OFF</span>
MOTION DETECTION - <span class="hljs-keyword">OFF</span>
.........
Press <span class="hljs-keyword">NEXT</span>
.........
PRIVACY - <span class="hljs-keyword">OFF</span>
DAY/NIGHT - B/W (<span class="hljs-keyword">OFF</span>,<span class="hljs-keyword">OFF</span>,-,-)
NR (ENTER)
      NR MODE - <span class="hljs-keyword">OFF</span>
      Y LEVEL - -
      C LEVEL - -
CAM ID - <span class="hljs-keyword">OFF</span>
SYNC - INT
LANG - ENG
.........
SAVE ALL
<span class="hljs-keyword">EXIT</span></code></pre> 
<p>该参数适用于Sony673相机在夜晚观测流星时的情景，如果图像太暗，看不到任何星星，可以设置AGC=24。</p> 
<p>如果mplayer显示一片绿，可以尝试在终端命令行中多次执行：</p> 
<blockquote> 
 <p>sudo killall mplayer</p> 
</blockquote> 
<h2 id="4-运行流星观测软件">4 运行流星观测软件</h2> 
<h3 id="41-测试运行01小时6分钟">4.1 测试运行0.1小时（6分钟）</h3> 
<blockquote> 
 <p>python -m RMS.StartCapture -d 0.1</p> 
</blockquote> 
<p>如果一切正常，会看到一个全白的窗口，在这个窗口的最上面会有一行显示“Maxpixel”。如果没有出现窗口，请参考下一节的“4.3常见故障”。</p> 
<h3 id="42-正式运行">4.2 正式运行</h3> 
<blockquote> 
 <p>python -m RMS.StartCapture</p> 
</blockquote> 
<p>程序会自动每天在日落时开始运行，在日出时结束运行。</p> 
<p>数据会保存在目录：/home/pi/RMS_data/CapturedFiles <br> 观测到的流星目录：/home/pi/RMS_data/ArchivedFiles</p> 
<h3 id="43-常见故障">4.3 常见故障</h3> 
<p><strong>1） 有时候一些设备没有出现“Maxpixel”窗口，如果同时在日志文件中看到如下错误信息：</strong></p> 
<pre class="prettyprint"><code class=" hljs vbnet">(StartCapture.py:<span class="hljs-number">14244</span>): Gtk-<span class="hljs-keyword">ERROR</span> **: GTK+ <span class="hljs-number">2.</span>x symbols detected. <span class="hljs-keyword">Using</span> GTK+ <span class="hljs-number">2.</span>x <span class="hljs-keyword">and</span> GTK+ <span class="hljs-number">3</span> <span class="hljs-keyword">in</span> the same process <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> supported</code></pre> 
<p>可能是缺少pyqt4-dev-tools库，安装该库：</p> 
<blockquote> 
 <p>sudo apt-get install pyqt4-dev-tools</p> 
</blockquote> 
<p>然后通过如下步骤解决该问题：</p> 
<blockquote> 
 <p>python</p> 
</blockquote> 
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">import</span> matplotlib
matplotlib.matplotlib_fname()</code></pre> 
<p>这时会打印出matplotlib包的配置文件路径“file_location”，编辑该文件：</p> 
<blockquote> 
 <p>sudo gedit “file_location”</p> 
</blockquote> 
<pre class="prettyprint"><code class=" hljs vala">将行
backend      : gtk3agg
替换为
backend      : Qt4Agg
并删除行
<span class="hljs-preprocessor">#backend.qt4 : PyQt4</span>
前的注释</code></pre> 
<p>然后保存并退出。</p> 
<p><strong>2）Astropy库安装失败</strong> <br> 报错:</p> 
<blockquote> 
 <p>ImportError: No module named _build_utils.apple_accelerate</p> 
</blockquote> 
<p>或许是因为numpy的版本太老，运行下面命令更新numpy：</p> 
<blockquote> 
 <p>sudo pip –upgrade numpy</p> 
</blockquote> 
<p>之后需要按照3.1从新安装相关的软件包。</p> 
<h2 id="5-运行结果">5 运行结果</h2> 
<p><img src="https://images2.imgbox.com/a4/c5/rO5hnDTG_o.jpg" alt="观测的流星结果" title=""> <br> 流星观测站观测到的流星图像。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/279771ef3991eb504361a170b5054feb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python解包</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9ed35cbb0fed29f8bb76a9630d9a099a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">IOS移动端中H5页面用on绑定click无效的解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>