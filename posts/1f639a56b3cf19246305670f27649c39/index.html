<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>zabbix搭建及使用 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="zabbix搭建及使用" />
<meta property="og:description" content="一、server：redhat6 192.168.1.224 client：windows、redhat6 192.168.1.125、192.168.1.122 二、Linxu 服务端安装（源码包安装） 1、配置网络yum源 https://blog.csdn.net/weixin_36524613/article/details/80855481
2、安装mysql
1）yum -y install mysql mysql-server mysql-devel
2）MySQL 配置文件/etc/my.cnf中加入default-character-set=utf8
vim /etc/my.cnf 加入default-character-set=utf8
3）开启mysql服务
service mysqld start
4）创建 Root 管理员，设置root密码
mysqladmin -u root password 123456
5）登陆 MySQL
mysql -uroot -p123456
6）创建 zabbix 数据库，并设置登陆权限
mysql&gt; create database zabbix character set utf8 collate utf8_bin;
7）添加zabbix用户并设置密码和访问权限
mysql&gt; grant all privileges on zabbix.* to zabbix@localhost identified by &#39;zabbix&#39;;
8）如果需要本地连接数据库，添加权限
mysql&gt; GRANT ALL PRIVILEGES ON *.* TO &#39;zabbix&#39;@&#39;192." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1f639a56b3cf19246305670f27649c39/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-15T10:50:49+08:00" />
<meta property="article:modified_time" content="2018-10-15T10:50:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">zabbix搭建及使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4><strong>一、server：redhat6      192.168.1.224</strong></h4> 
<h4><strong>      client：windows、redhat6   192.168.1.125、192.168.1.122</strong></h4> 
<h4><strong>二、Linxu 服务端安装（源码包安装）</strong></h4> 
<p>      <strong>1、配置网络yum源</strong> <a href="https://blog.csdn.net/weixin_36524613/article/details/80855481">https://blog.csdn.net/weixin_36524613/article/details/80855481</a></p> 
<p>      <strong>2、安装mysql</strong></p> 
<p>           1）yum -y install mysql mysql-server mysql-devel<br>            2）MySQL 配置文件/etc/my.cnf中加入default-character-set=utf8<br>                  vim /etc/my.cnf 加入default-character-set=utf8<br>            3）开启mysql服务<br>                 service mysqld start<br>           4）创建 Root 管理员，设置root密码<br>                 mysqladmin -u root password 123456<br>           5）登陆 MySQL<br>                mysql -uroot -p123456<br>           6）创建 zabbix 数据库，并设置登陆权限<br>                mysql&gt; create database zabbix character set utf8 collate utf8_bin;<br>           7）添加zabbix用户并设置密码和访问权限<br>                mysql&gt; grant all privileges on zabbix.* to zabbix@localhost identified by 'zabbix';<br>           8）如果需要本地连接数据库，添加权限<br>               mysql&gt; GRANT ALL PRIVILEGES ON *.* TO 'zabbix'@'192.168.0.125' IDENTIFIED BY 'zabbix';<br>               mysql&gt; flush privileges;<br>           9）\q</p> 
<p>    </p> 
<p>   <strong> 3、安装zabbixserver</strong><br>          1）安装必要环境<br>              yum install httpd php http-devel php-devel php-pear php-xmlrpc php-bcmath mysql-connector-odbc libdbi-dbd-mysql                   httpd-manual mod_ssl mod_perl mod_auth_mysql php-gd php-xml php-mbstring php-ldap net-snmp-devel curl-devel                 unixODBC-devel OpenIPMI-devel java-devel libssh2-devel openldap openldap-devel -y<br>         2）配置php环境<br>             sed -i "s/;date.timezone =/date.timezone = Asia\/Shanghai/g" /etc/php.ini<br>             sed -i "s#max_execution_time = 30#max_execution_time = 300#g" /etc/php.ini<br>             sed -i "s#post_max_size = 8M#post_max_size = 32M#g" /etc/php.ini<br>             sed -i "s#max_input_time = 60#max_input_time = 300#g" /etc/php.ini<br>             sed -i "s#memory_limit = 128M#memory_limit = 128M#g" /etc/php.ini<br>             sed -i "s/;mbstring.func_overload = 0/mbstring.func_overload = 0\n/" /etc/php.ini<br>         3）安装zabbix服务端<br>            下载源码包，添加组<br>            wget prdownloads.sourceforge.net/zabbix/zabbix-2.4.8.tar.gz<br>            groupadd zabbix -g 201<br>            useradd -g zabbix -u 201 -m zabbix<br>            解压编译，要确认是否安装gcc<br>            yum install gcc –y<br>            tar zxf zabbix-2.4.8.tar.gz<br>            cd zabbix-2.4.8</p> 
<p>           ./configure --prefix=/usr/local/zabbix-2.4.8 --sysconfdir=/etc/zabbix --enable-server --enable-proxy --enable-agent --                      enable-ipv6 --with-mysql=/usr/bin/mysql_config --with-net-snmp --with-libcurl --with-openipmi --with-unixodbc --with-ldap               --with-ssh2 --enable-java<br>            检查出错的话根据提示安装相应工具包<br>           make install</p> 
<p>          ln -s /usr/local/zabbix-2.4.8 /usr/local/zabbix<br>    <strong>4、添加zabbix到系统服务文件</strong><br>          cat /etc/services |grep zabbix  #可以看一眼，没有就加上，默认已经加上了<br>          zabbix-agent    10050/tcp               # Zabbix Agent<br>          zabbix-agent    10050/udp               # Zabbix Agent<br>          zabbix-trapper  10051/tcp               # Zabbix Trapper<br>          zabbix-trapper  10051/udp               # Zabbix Trapper<br>     <br>   <strong> 5、向zabbix数据库导入sql文件</strong><br>          这个sql文件的导入顺序不能变，不然要报错<br>          mysql -uzabbix -pzabbix zabbix &lt;/root/zabbix-2.4.8/database/mysql/schema.sql  <br>          mysql -uzabbix -pzabbix zabbix &lt;/root/zabbix-2.4.8/database/mysql/images.sql <br>          mysql -uzabbix -pzabbix zabbix &lt;/root/zabbix-2.4.8/database/mysql/data.sql<br>          如果上面导入sql的时候出现错误，可以使用远程连接导入，注意用户名和密码要使用zabbix，zabbix</p> 
<p>        <img alt="" class="has" height="503" src="https://images2.imgbox.com/70/ec/6KKtSP3H_o.png" width="367"></p> 
<p><strong>6、拷贝启动脚本并配置</strong><br>       cp /root/zabbix-2.4.8/misc/init.d/fedora/core/zabbix_* /etc/init.d/<br>       sed -i "s#BASEDIR=/usr/local#BASEDIR=/usr/local/zabbix#" /etc/init.d/zabbix_server<br>       sed -i "s#BASEDIR=/usr/local#BASEDIR=/usr/local/zabbix#" /etc/init.d/zabbix_agentd</p> 
<p><strong>7、zabbix主配置文件修改</strong><br>       简单配置一下，主要是配置连接数据库的账号和密码<br>       vim /etc/zabbix/zabbix_server.conf  #默认配置就好<br>       LogFile=/var/zabbix/zabbix_server.log<br>       DBName=zabbix<br>       DBUser=zabbix<br>       DBPassword=zabbix<br>       ListenIP=127.0.0.1<br><strong>8、拷贝网页文件到web站点目录下</strong><br>       cp -r /root/zabbix-2.4.8/frontends/php /var/www/html/zabbix<br>       chown apache:apache /var/www/html/zabbix/conf  #此目录下，程序要创建一个php，当然不授权的话，等到安装到哪部，         下载php文件也可以。<br><strong>9、通过web页面配置zabbix</strong><br>       http://192.168.0.224/zabbix/        <br>       访问格式是IP/zabbix<br>       注意需要启动mysql服务、apache服务、zabbix_server服务<br>       service mysqld start<br>       service httpd start<br>       service zabbix_server start<br>       如果启动zabbix_server服务出错<br>       wget -O /usr/lib64/libmysqlclient.so.16<br>       http://files.directadmin.com/services/debian_5.0_64/libmysqlclient.so.16<br><strong>10、找不到mysql数据库</strong><br>      <img alt="" class="has" height="246" src="https://images2.imgbox.com/c5/79/pP3AKpfB_o.png" width="468"></p> 
<p>      yum install -y php-mysql.x86_64<br>       service mysqld restart<br>       service httpd restart<br><strong>  11、web页面配置zabbix</strong></p> 
<p>      <img alt="" class="has" height="235" src="https://images2.imgbox.com/4d/d3/An0Siqsx_o.png" width="554"></p> 
<p>      <img alt="" class="has" height="273" src="https://images2.imgbox.com/f8/55/A3haf4rX_o.png" width="554"></p> 
<p>      <img alt="" class="has" height="228" src="https://images2.imgbox.com/c1/19/KVXs1Sxf_o.png" width="554"></p> 
<p>      <img alt="" class="has" height="267" src="https://images2.imgbox.com/63/ac/71WC41ch_o.png" width="554"></p> 
<p>      <img alt="" class="has" height="196" src="https://images2.imgbox.com/b5/ed/JwYbAFi7_o.png" width="554"></p> 
<p>      <img alt="" class="has" height="239" src="https://images2.imgbox.com/57/2d/zRqBoUU8_o.png" width="554"></p> 
<p>      跳到登录界面了，用户名是admin,密码是zabbix<br>   <strong>12、中文显示</strong></p> 
<p>      <img alt="" class="has" height="68" src="https://images2.imgbox.com/eb/77/36sUDR7S_o.png" width="554"></p> 
<p>      点击图上圈着的位置</p> 
<p>      <img alt="" class="has" height="382" src="https://images2.imgbox.com/25/47/v0fcDCHG_o.png" width="554"></p> 
<p>      选择chinese 之后更新<br>   <strong>13、汉化之后图标的位置会出现乱码的问题</strong></p> 
<p>      <img alt="" class="has" height="366" src="https://images2.imgbox.com/e2/51/dRsPmKaA_o.png" width="554"></p> 
<p>        白框内正常应该是文字<br>         解决办法：<br>         进入到本地windos目录下：C:\Windows\Fonts</p> 
<p>       <img alt="" class="has" height="474" src="https://images2.imgbox.com/d8/45/DM1x1Umx_o.png" width="554"><br>        </p> 
<p>        将红色圈中的文件上传到服务器端的/var/www/html/zabbix/fonts目录中。<br>         将原本文件备份，simhei.ttf文件改成小写<br>         -rw-r--r--. 1 root root  756072 Jun 22 10:23 DejaVuSans.ttf.bak<br>         -rw-r--r--. 1 root root 9751960 Jun 22 14:02 simhei.ttf<br>         编辑web页面配置文件<br>         vim /var/www/html/zabbix/include/defines.inc.php +45<br>         修改文件<br>         define('ZBX_GRAPH_FONT_NAME',    'DejaVuSans');  替换为：define('ZBX_GRAPH_FONT_NAME',            'simhei');   <br>         重新刷新web页面即可<br>   <strong>14、关闭防火墙和selinux</strong><br>         如果页面出现zabbix server is not running<br>         查看日志78655:20180622:113738.275 cannot send list of active checks to [127.0.0.1]: host [Zabbix server] not monitored</p> 
<p>        那么有可能是防火墙没关或者把zabbix_server重启一下</p> 
<h4>二、Linux  zabbix_agent安装</h4> 
<p><br>        重新找一台rhel6系统<br>       <strong>1、配置yum源<br>       2、下载源码包并编译</strong><br>            wget prdownloads.sourceforge.net/zabbix/zabbix-3.2.6.tar.gz<br>            groupadd zabbix -g 201<br>            useradd -g zabbix -u 201 -m zabbix<br>            tar zxf zabbix-3.2.6.tar.gz<br>            cd zabbix-3.2.6 </p> 
<p>          ./configure --prefix=/usr/local/zabbix-3.2.6 --sysconfdir=/etc/zabbix  --enable-agent</p> 
<p>          make install<br>           ln -s /usr/local/zabbix-3.2.6 /usr/local/zabbix<br>     <strong>3、拷贝启动脚本并配置</strong><br>          cp /root/zabbix-3.2.6/misc/init.d/fedora/core/zabbix_agentd /etc/init.d/<br>          sed -i "s#BASEDIR=/usr/local#BASEDIR=/usr/local/zabbix#" /etc/init.d/zabbix_agentd<br>     <strong>4、 编辑配置文件，使agent指向server端</strong><br>         vim /etc/zabbix/zabbix_agentd.conf  <br>         Server=192.168.0.224<br>     <strong>5、启动agent服务</strong><br>        service zabbix_agentd restart</p> 
<h4>三、Windows zabbix_agent安装</h4> 
<p><br>     <strong>1、下载zabbix_agent</strong><br>     被监控的主机装在Windows7 64位操作系统，需关闭防火墙。 <br>     被监控端需要安装 <br>     https://www.zabbix.com/downloads/2.4.1/zabbix_agents_2.4.1.win.zip <br>     解压即用。<br>     <strong>2、修改配置</strong><br>     在解压出来的conf文件夹中找到zabbix_agentd.win.conf，以记事本打开，修改如下四项参数 :<br>     LogFile=d:\tmp\zabbix_agentd.log               #日志文件存储位置<br>     Server=192.168.0.224                         #zabbix主控端IP地址<br>     Hostname=windows name            #本监控主机的主机名可以在cmd使用hostname命令获得<br>     ServerActive=192.168.0.224                     #zabbix主控端IP地址<br>     <strong>3、解压并启动</strong><br>     修改完成后用管理员身份cmd进入到解压目录，逼着这里解压在D盘的根目录下<br>     D:\&gt;cd D:\bin\win64<br>     D:\bin\win64&gt;zabbix_agentd.exe -c d:\conf\zabbix_agentd.win.conf -i<br>     zabbix_agentd.exe [1636]: service [Zabbix Agent] installed successfully<br>     zabbix_agentd.exe [1636]: event source [Zabbix Agent] installed successfully<br>     D:\bin\win64&gt;zabbix_agentd.exe -c d:\conf\zabbix_agentd.win.conf -s<br>     zabbix_agentd.exe [2328]: service [Zabbix Agent] started successfully</p> 
<p>    -c：指定配置文件位置<br>     -i：安装agent<br>     -s：启动agent<br>     -x：停止agent<br>     -d：卸载agent1 <br>     检查zabbix-agent是否正常启动，在Windows的服务中可以看到zabbix-agent的服务，或在cmd下使用netstat -an | find "10050"处于监听状态即可。</p> 
<h4>四、多个agent监控配置</h4> 
<p><br>     <strong>1、首先创建一个主机组</strong><br>     配置==》主机群组==》创建主机群组（web页面右上角）==》添加组名，如：Zabbix agents（在弹出框中输入组名）==&gt;添加<br>     <strong>2、添加一个主机</strong><br>     配置==》主机==》右上角在群组那里选择Zabbix agents==》点击创建主机   #如下图<br>     <strong>3、给此主机引用一条模板：</strong><br>     在上面那张图片中可以看到主机的右边有个模板，点击模板，链接指示器那一栏点击选择按钮，然后选择你要添加的模板，点击添加，然后返回到模板界面之后，再点击下面的添加按钮，然后点击更新。</p> 
<p>    <img alt="" class="has" height="433" src="https://images2.imgbox.com/ef/35/aWZkljYE_o.png" width="554"></p> 
<p>    <img alt="" class="has" height="171" src="https://images2.imgbox.com/7a/58/kCZkgP88_o.png" width="554"></p> 
<p>    <img alt="" class="has" height="185" src="https://images2.imgbox.com/a2/a4/7OTSVrHG_o.png" width="554"></p> 
<p>    </p> 
<p>    需要注意的是linux的agent和windows的agent添加的模板不一样，上面添加的模板是linux的模板。</p> 
<p>    效果图</p> 
<p>    <img alt="" class="has" height="186" src="https://images2.imgbox.com/79/01/nwLIpeui_o.png" width="554"></p> 
<p>    <img alt="" class="has" height="129" src="https://images2.imgbox.com/e3/28/gVEPj3wO_o.png" width="554"></p> 
<p>    <img alt="" class="has" height="181" src="https://images2.imgbox.com/17/6a/jJRJi5BW_o.png" width="554"></p> 
<p> </p> 
<p>     上面是监控不同节点，不同操作系统的效果图。</p> 
<h4><br> 五、开机启动</h4> 
<p><br>     <strong>1、Zabbix agentd使用 chkconfig 将其加入 init 的启动服务</strong><br>     chkconfig --add zabbix_server<br>     chkconfig --add zabbix_agentd<br>     chkconfig --level 345 zabbix_server on<br>     chkconfig --level 345 zabbix_agentd on</p> 
<p>    <strong>2、使用 chkconfig --list 检查一下</strong><br>     chkconfig --list | grep zabbix<br>     输出如下：<br>     zabbix_agentd   0:off   1:off   2:off   3:on    4:on    5:on    6:off<br>     zabbix_server    0:off   1:off   2:off   3:on    4:on    5:on    6:off<br>     <strong>3、agent的机器只需要</strong><br>     chkconfig --add zabbix_agentd<br>     chkconfig --level 345 zabbix_agentd on</p> 
<p>    window开启启动在service中设置即可<br>     <strong>4、开机启动apache和mysql</strong><br>     chkconfig --add httpd  #加入开启启动项<br>     chkconfig --del httpd  #从开启启动项删除<br>     chkconfig --list | grep httpd  #查看是否在开机启动项</p> 
<p>    chkconfig --level 5 httpd on  #在5级别下开机启动<br>     runlevel            #查看开机启动级别</p> 
<p>    chkconfig --add mysqld  #mysql服务添加到开机启动项<br>     chkconfig  --list | grep mysqld  #查看是否添加到开机启动项</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3217cde6feaad2aca6f4c39ff360ca4f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">live2d看板娘一览图</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8d424a6201844343435a805d07590651/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">div内的scroll局部滚动</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>