<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vue实战开发--后台管理系统Vue&#43;Element ui（9） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Vue实战开发--后台管理系统Vue&#43;Element ui（9）" />
<meta property="og:description" content="这节课完成面包屑和tag的布局，并且与左侧菜单联系，涉及组件间通信。 1.提前准备 首先我们先完成每个页面的路由，之前已经有home页面和user页面，缺少mail页面和其它选项下的page1和page2页面。在view文件夹下新建mail文件夹，新建index.vue，填充user页面的内容即可。在view下新建other文件夹，新建pageOne.vue和pageTwo.vue，页面内容简单填充即可。三个页面都要更改name属性，后面会用到，首字母大写。
示例：
配置路由：在路由主文件添加路由，路由位置在CommonAside的menu数组中保持偶一致。这里的name属性是小写，与上面不相同。
{ path:&#39;/mail&#39;, name:&#39;mail&#39;, component:()=&gt;import(&#39;../view/mail&#39;) }, { path:&#39;/page1&#39;, name:&#39;page1&#39;, component:()=&gt;import(&#39;../view/other/pageOne.vue&#39;) }, { path:&#39;/page2&#39;, name:&#39;page2&#39;, component:()=&gt;import(&#39;../view/other/pageTwo.vue&#39;) } 测试发现商品管理可以正常跳转，但是其他的二级菜单不能跳转，原因是没有设置点击事件。为左侧导航栏二级菜单添加点击事件。为el-menu-item添加点击事件。
&lt;el-menu-item-group v-for=&#34;(subItem,subIndex) in item.children&#34; :key=&#34;subItem.path&#34;&gt; &lt;el-menu-item @click=&#34;clickMenu(subItem)&#34; :index=&#34;subIndex.toString()&#34;&gt;{{ subItem.label }}&lt;/el-menu-item&gt; &lt;/el-menu-item-group&gt; 2.面包屑功能 面包屑有数据记忆存储功能，每次点击导航栏后后记录选中的导航栏并列出。这里需要用到Vuex.Store,我们前面左侧导航栏的收起与展开同样使用到Vuex.Store，store可以看做是容器，里面有四个值，由State、Getters、Mutation、Actions这四种组成。在store下的tab.js文件，默认数据定义在state中，我们定义为一个数组tabsList，数组里有多个对象，但这里知识默认对象，对象里有四个属性，path、name、label、icon。currentMenu为一个临时变量，存储点击的tab。
state:{ isCollapse:false, tabsList:[ { path:&#39;/&#39;, name:&#39;home&#39;, label:&#39;首页&#39;, icon:&#39;home&#39; } ], currentMenu:null }, 改变tabsList里的内容要用到Vuex.store的mutations。改变state数据的发都会以函数的形式写在mutations中，之后在页面调用即可。selectMenu函数接收两个参数，state和val，此时需要进行判断，当前点击的导航栏是不是首页，用name属性判断，判断传入的item.name是否等于‘home’，如果不是home，需要赋值val给currentMenu，这样currentMenu就会不断累加，最多为五个（首页、用户、商品、其他1、其他2）。此处还需要一个判断，判断当前点击的导航栏是是不是刚刚已经点击过来，点击过了不再进行累加，而是将面包屑跳转到点击过的那一个。这里用到findIndex（）方法。判断item.name里是否有val.name。 有的话为1，无的话为-1，无的话那么使用push（）方法将val累加到currentMenu。如果点击是‘home’的情况，currentMenu置空。
selectMenu(state,val){ if(val.name !== &#39;home&#39;){ state.currentMenu = val const result = state.tabsList.findIndex(item =&gt; item.name === val.name) if(result === -1){ state.tabsList.push(val) } }else{ state." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f4c83d42e15ee239533dde7ea425fa09/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-11T18:28:09+08:00" />
<meta property="article:modified_time" content="2022-06-11T18:28:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vue实战开发--后台管理系统Vue&#43;Element ui（9）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>这节课完成面包屑和tag的布局，并且与左侧菜单联系，涉及组件间通信。 </p> 
<h2>1.提前准备</h2> 
<p>首先我们先完成每个页面的路由，之前已经有home页面和user页面，缺少mail页面和其它选项下的page1和page2页面。在view文件夹下新建mail文件夹，新建index.vue，填充user页面的内容即可。在view下新建other文件夹，新建pageOne.vue和pageTwo.vue，页面内容简单填充即可。三个页面都要更改name属性，后面会用到，首字母大写。</p> 
<p>示例：</p> 
<p><img alt="" height="396" src="https://images2.imgbox.com/47/2e/k5m3yuVH_o.png" width="664"></p> 
<p>配置路由：在路由主文件添加路由，路由位置在CommonAside的menu数组中保持偶一致。这里的name属性是小写，与上面不相同。</p> 
<pre><code class="language-javascript">            {
                path:'/mail',
                name:'mail',
                component:()=&gt;import('../view/mail')
            },
            {
                path:'/page1',
                name:'page1',
                component:()=&gt;import('../view/other/pageOne.vue')
            },
            {
                path:'/page2',
                name:'page2',
                component:()=&gt;import('../view/other/pageTwo.vue')
            }</code></pre> 
<p>测试发现商品管理可以正常跳转，但是其他的二级菜单不能跳转，原因是没有设置点击事件。为左侧导航栏二级菜单添加点击事件。为el-menu-item添加点击事件。</p> 
<pre><code class="language-javascript">      &lt;el-menu-item-group
        v-for="(subItem,subIndex) in item.children"
        :key="subItem.path"&gt;
        &lt;el-menu-item
        @click="clickMenu(subItem)"
        :index="subIndex.toString()"&gt;{<!-- -->{ subItem.label }}&lt;/el-menu-item&gt;
      &lt;/el-menu-item-group&gt;</code></pre> 
<h2>2.面包屑功能</h2> 
<p>面包屑有数据记忆存储功能，每次点击导航栏后后记录选中的导航栏并列出。这里需要用到Vuex.Store,我们前面左侧导航栏的收起与展开同样使用到Vuex.Store，store可以看做是容器，里面有四个值，由<strong>State</strong>、<strong>Getters</strong>、<strong>Mutation</strong>、<strong>Actions</strong>这四种组成。在store下的tab.js文件，默认数据定义在state中，我们定义为一个数组tabsList，数组里有多个对象，但这里知识默认对象，对象里有四个属性，path、name、label、icon。currentMenu为一个临时变量，存储点击的tab。</p> 
<pre><code class="language-javascript">    state:{
        isCollapse:false,
        tabsList:[
            {
                path:'/',
                name:'home',
                label:'首页',
                icon:'home'
            }
        ],
        currentMenu:null
    },</code></pre> 
<p>改变tabsList里的内容要用到Vuex.store的mutations。改变state数据的发都会以函数的形式写在mutations中，之后在页面调用即可。selectMenu函数接收两个参数，state和val，此时需要进行判断，当前点击的导航栏是不是首页，用name属性判断，判断传入的item.name是否等于‘home’，如果不是home，需要赋值val给currentMenu，这样currentMenu就会不断累加，最多为五个（首页、用户、商品、其他1、其他2）。此处还需要一个判断，判断当前点击的导航栏是是不是刚刚已经点击过来，点击过了不再进行累加，而是将面包屑跳转到点击过的那一个。这里用到findIndex（）方法。判断item.name里是否有val.name。 有的话为1，无的话为-1，无的话那么使用push（）方法将val累加到currentMenu。如果点击是‘home’的情况，currentMenu置空。</p> 
<pre><code class="language-javascript">        selectMenu(state,val){
            if(val.name !== 'home'){
                state.currentMenu = val
                const result = state.tabsList.findIndex(item =&gt; item.name === val.name)
                if(result === -1){
                    state.tabsList.push(val)
                }
            }else{
                state.currentMenu = null
            }
        },</code></pre> 
<p>在CommonAside中调用currentMenu，并传入item，item实际就menu数组中的任一对象。</p> 
<pre><code class="language-javascript">    clickMenu(item){
      this.$router.push({
        name:item.name
      })
      this.$store.commit('selectMenu',item)</code></pre> 
<p>更改CommonHeader.vue，使用element ui的面包屑元素。</p> 
<pre><code class="language-javascript">//element ui官方案例

&lt;el-breadcrumb separator="/"&gt;
  &lt;el-breadcrumb-item :to="{ path: '/' }"&gt;首页&lt;/el-breadcrumb-item&gt;
  &lt;el-breadcrumb-item&gt;&lt;a href="/"&gt;活动管理&lt;/a&gt;&lt;/el-breadcrumb-item&gt;
  &lt;el-breadcrumb-item&gt;活动列表&lt;/el-breadcrumb-item&gt;
  &lt;el-breadcrumb-item&gt;活动详情&lt;/el-breadcrumb-item&gt;
&lt;/el-breadcrumb&gt;</code></pre> 
<p> 我们需要进行数据渲染，渲染成动态数据，v-for循环tags，:key使用item.path识别。{<!-- -->{}}表示动态渲染数据。</p> 
<p>这里数据比较比较长，item--tags--tabsList--menu。tabsList里的数据也是menu动态加载进去的。</p> 
<pre><code class="language-javascript">    &lt;el-breadcrumb separator="/"&gt;
        &lt;el-breadcrumb-item v-for="item in tags" :key="item.path" :to="{ path: item.path }"&gt;{<!-- -->{item.label}}&lt;/el-breadcrumb-item&gt;
    &lt;/el-breadcrumb&gt;</code></pre> 
<p>引入mapState，这个是vuex的辅助函数。</p> 
<pre><code class="language-javascript">import { mapState } from 'vuex'</code></pre> 
<p>在computed属性中进行注入，这里起了一个别名tags。</p> 
<pre><code class="language-javascript">    computed:{
      ...mapState({
        tags:state =&gt; state.tab.tabsList
      })
    }</code></pre> 
<p>效果：这里样式有问题，不过影响不大，后期可以自行更改。</p> 
<p>页面会根据面包屑进行，路由也会自行更改。</p> 
<p><img alt="" height="468" src="https://images2.imgbox.com/a9/c0/FcHa1mS5_o.png" width="775"></p> 
<h2> 3.tag区域</h2> 
<p>这个功能其实类似于面包屑，只是多了删除功能。使用element ui的tag组件。tag组件的close属性表示组件是否可以关闭。tag组件有两个触发事件click、close。分别是点击tag和删除tag。</p> 
<p>tag组件为公共组件，在components下新建CommonTag.vue。v-for遍历tags，这里注意，首页tag是不能删除的，closable属性表示有删除按钮，后面可以附带条件。effect属性为主题（样式），表示为高亮显示。判断方法是根据路由地址和当前tag的名称是否一致，注意是route（不是router）一致则为dark（高亮），不一致为plain（白色）。添加改变tag事件和删除tag事件。这里用模块化，用函数实现。</p> 
<pre><code class="language-javascript">&lt;template&gt;
    &lt;div class="tabs"&gt;
        &lt;el-tag
        v-for="(tag,index) in tags"
        :key="tag.name"
        :closable="tag.name !== 'home'"
        :effect="$route.name === tag.name ? 'dark' : 'plain'"
        @click="changeMenu(tag)"
        @close="handleClose(tag,index)"
        size="small"&gt;
            {<!-- -->{ tag.label }}
        &lt;/el-tag&gt;
    &lt;/div&gt;
&lt;/template&gt;</code></pre> 
<p>渲染tag，同样需要用到tabsList，引入mapState，在computed属性中注入，注入为三个点（...），这里同样将tabsList赋值给tags，两个页面的tags互不干扰。</p> 
<pre><code class="language-javascript">&lt;script&gt;
import { mapState,mapMutations } from 'vuex'
    export default{
        name:'CommonTag',
        data(){
            return{

            }
        },
        computed:{
            ...mapState({
                tags:state =&gt; state.tab.tabsList
        }) ,

        },
        methods:{
            ...mapMutations({
                close:'closeTag'
            }),
            changeMenu()
            handleClose()

            },
   
    }
&lt;/script&gt;</code></pre> 
<p>在mian.vue引入组件</p> 
<pre><code class="language-javascript">import CommonTag from "../src/components/CommonTag.vue";
export default {
  name: "Home",
  components: {
    CommonTag
  },</code></pre> 
<p> 注意在el-header和el-main之间，因为这个组件并不属于header也不属于main，所以在中间。</p> 
<pre><code class="language-javascript">      &lt;el-header&gt;
        &lt;common-header&gt;&lt;/common-header&gt;
      &lt;/el-header&gt;
      &lt;common-tag&gt;&lt;/common-tag&gt;
      &lt;el-main&gt;
        &lt;router-view&gt;&lt;/router-view&gt;
      &lt;/el-main&gt;</code></pre> 
<p>覆盖样式</p> 
<pre><code class="language-javascript">&lt;style lang="less" scoped&gt;
    .tabs{
        padding: 20px;
        .el-tag{
            margin-right: 15px;
            cursor: pointer;
        }
    }

&lt;/style&gt;</code></pre> 
<p>接下来完成点击事件个删除事件<span style="color:#fe2c24;">（重难点！！！）</span><span style="color:#0d0016;">，点击就是路由切换。</span><span style="color:#0d0016;">methods里更改函数。</span></p> 
<pre><code class="language-javascript">            changeMenu(item){
                this.$router.push({ name: item.name })
                console.log(name)</code></pre> 
<p>删除tag：</p> 
<p>删除tag也会删除对应的面包屑，面包屑对应的是state.tabsList。首先拿到tag的总长度，总长度减1就是我们当前选中的tag，赋值给length，判断length和index的长度进行比较，如果这两个值相等，那么就表示此时我们选中的tag是tag中的最后一项。首先判断tag.name与当前的路由是否一致，如果不一致，不需要额外操作，直接return，即高亮在最后一个tag，删除的tag是非选中的tag，所以无需操作。</p> 
<p>如果当前删除的tag是最后一个tag，那么高亮部分一个向左移动一格。如果当前菜单高亮才当在中间，并且你删除当前的菜单时，高亮显示向右移动一格。</p> 
<pre><code class="language-javascript">            handleClose(tag,index){
                this.close(tag)
                const length = this.tags.length - 1
                if(tag.name !== this.$route.name){
                    return;
                }
                //高亮向左移动,这里视频代码错误，应该是上面不减1，下面减1.
                if(index === length){
                    this.$router.push({
                        name: this.tags[index].name
                    })
                }else{
                    this.$router.push({
                        name: this.tags[index - 1].name
                    })
                }
            }</code></pre> 
<p>此时需要删除state下的tabsList，修改state必须使用mutations。因此需要在mutations中声明closeTag。</p> 
<pre><code class="language-javascript">        closeTag(state,val){
            const result = state.tabsList.findIndex(item =&gt; item.name === val.name)
            state.tabsList.splice(result,1)
        }</code></pre> 
<p>调用mutations</p> 
<pre><code class="language-javascript">import { mapState,mapMutations } from 'vuex'

            ...mapMutations({
                close:'closeTag'
            }),</code></pre> 
<p>总体CommonTag的script代码。</p> 
<pre><code class="language-javascript">&lt;script&gt;
import { mapState,mapMutations } from 'vuex'
    export default{
        name:'CommonTag',
        data(){
            return{

            }
        },
        computed:{
            ...mapState({
                tags:state =&gt; state.tab.tabsList
        }) ,

        },
        methods:{
            ...mapMutations({
                close:'closeTag'
            }),
            changeMenu(item){
                this.$router.push({ name: item.name })
                console.log(name)
            },handleClose(tag,index){
                this.close(tag)
                const length = this.tags.length - 1
                if(tag.name !== this.$route.name){
                    return;
                }
                //高亮向左移动,这里视频代码错误，应该是上面不减1，下面减1.
                if(index === length){
                    this.$router.push({
                        name: this.tags[index].name
                    })
                }else{
                    this.$router.push({
                        name: this.tags[index - 1].name
                    })
                }
            },

        }
        
    }
&lt;/script&gt;</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/484e54231a718914a185b6df7477e827/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vue.js nextTick 源码分析</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c03961b1bc728439a1f5e8006dc11cb2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQLite数据库的增删改查</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>