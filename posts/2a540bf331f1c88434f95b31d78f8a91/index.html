<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【引用】引用的概念与基本使用原则 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【引用】引用的概念与基本使用原则" />
<meta property="og:description" content="学习导航 一、引用的基本介绍二、引用的基本特性三、引用的基本原则①引用类型和引用实体类型相同②引用类型和引用实体类型不同 四、引用的基础应用①对标传址操作②作为返回值 一、引用的基本介绍 什么是引用？通俗的讲，引用就是&#34;取别名&#34;，我们看下面的例子：
可以看到，引用并不会开辟新的空间。
二、引用的基本特性 特性①：必须有初始化
特性②：一个变量可以有多个引用
可以给别名取别名，但本质上都是对a的引用
特性③：一旦引用了一个实体，就不能引用其他实体
可以看到，之后b不会再引用实体c，只能对b做赋值修改
三、引用的基本原则 ①引用类型和引用实体类型相同 引用的一个极其重要的基本原则是：对变量实体的读写权限只能缩小不能放大。我们在接下来的例子中来说明这个原则。
引用可以引用常量吗？答案是可以的。但是我们需要加上const来保证读写权限没有被放大：
✪代码分析
我们来分析这段代码我们需要注意到，引用就是给实体取的别名，二者在地址上是一样的，对别名的修改也会改变实体的值，所以我们在取别名的时候就要保证对引用的读写权限没有扩大。就像上面的例子，10是一个只读变量，如果不加上const，那么就意味着可以通过a来修改常变量10，这显示是不行的。
②引用类型和引用实体类型不同 引用类型必须和引用实体是同种类型吗？不一定！怎么理解这个问题呢？我们可以类比我们在C语言中学到的隐式类型转化，我们来分析中间的过程：
int main() { double d = 6.66; int a = d; } 为什么可以将类型为double的变量赋值给类型为int的变量呢？实际上这个赋值过程不是一步到位的，而是存在一个 “中间变量”。这个中间变量接收d的整数部分，最后再把这个中间变量拷贝给a。需要注意的是，这个中间变量具有常属性。引用也是同样的道理：
✪代码分析
a并不是直接引用d，而是引用这个中间变量。由于中间变量具有常属性，所以前面必须加上const修饰避免扩大读写权限。
通过取地址我们可以确认a没有引用d，从而也间接说明了中间临时变量的存在。
四、引用的基础应用 ①对标传址操作 void swap(int&amp; a, int&amp; b) { int tmp = a; a = b; b = tmp; } int main() { int a = 10; int b = 20; swap(a, b); return 0; } 正是由于引用和引用实体存在互相改变的关系，所以我们可以用引用来替代传值操作。拿我们C语言中常写的swap函数举例，这样写起来是不是更爽了呢？" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2a540bf331f1c88434f95b31d78f8a91/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-19T11:12:23+08:00" />
<meta property="article:modified_time" content="2023-07-19T11:12:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【引用】引用的概念与基本使用原则</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>学习导航</h4> 
 <ul><li><ul><li><ul><li><a href="#_1" rel="nofollow">一、引用的基本介绍</a></li><li><a href="#_8" rel="nofollow">二、引用的基本特性</a></li><li><a href="#_19" rel="nofollow">三、引用的基本原则</a></li><li><ul><li><a href="#_20" rel="nofollow">①引用类型和引用实体类型相同</a></li><li><a href="#_27" rel="nofollow">②引用类型和引用实体类型不同</a></li></ul> 
    </li><li><a href="#_45" rel="nofollow">四、引用的基础应用</a></li><li><ul><li><a href="#_46" rel="nofollow">①对标传址操作</a></li><li><a href="#_73" rel="nofollow">②作为返回值</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h4><a id="_1"></a>一、引用的基本介绍</h4> 
<p> 什么是引用？通俗的讲，引用就是"取别名"，我们看下面的例子：<br> <img src="https://images2.imgbox.com/96/d4/EU9ydPpi_o.png" alt="在这里插入图片描述"><br>  可以看到，引用并不会开辟新的空间。</p> 
<hr> 
<h4><a id="_8"></a>二、引用的基本特性</h4> 
<blockquote> 
 <p><strong>特性①：必须有初始化</strong><br> <img src="https://images2.imgbox.com/74/a5/8X7Tnnb9_o.png" alt="在这里插入图片描述"><br> <strong>特性②：一个变量可以有多个引用</strong><br> <img src="https://images2.imgbox.com/5c/7f/ieSexIZM_o.png" alt="在这里插入图片描述"><br> 可以给别名取别名，但本质上都是对a的引用<br> <strong>特性③：一旦引用了一个实体，就不能引用其他实体</strong><br> <img src="https://images2.imgbox.com/f0/b3/YOM9N1oR_o.png" alt="在这里插入图片描述"><br> 可以看到，之后b不会再引用实体c，只能对b做赋值修改</p> 
</blockquote> 
<hr> 
<h4><a id="_19"></a>三、引用的基本原则</h4> 
<h5><a id="_20"></a>①引用类型和引用实体类型相同</h5> 
<p> 引用的一个极其重要的基本原则是：<strong><font color="#98d98e">对变量实体的读写权限只能缩小不能放大</font></strong>。我们在接下来的例子中来说明这个原则。<br>  引用可以引用常量吗？答案是可以的。但是我们需要加上const来保证读写权限没有被放大：<br> <img src="https://images2.imgbox.com/13/15/bc3M1VIN_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>✪代码分析</strong><br>  我们来分析这段代码我们需要注意到，<strong>引用就是给实体取的别名，二者在地址上是一样的，对别名的修改也会改变实体的值</strong>，所以我们在取别名的时候就要保证对引用的读写权限没有扩大。就像上面的例子，10是一个只读变量，如果不加上const，那么就意味着可以通过a来修改常变量10，这显示是不行的。</p> 
</blockquote> 
<h5><a id="_27"></a>②引用类型和引用实体类型不同</h5> 
<p> 引用类型必须和引用实体是同种类型吗？不一定！怎么理解这个问题呢？我们可以类比我们在C语言中学到的隐式类型转化，我们来分析中间的过程：</p> 
<pre><code class="prism language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token number">6.66</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> d<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p> 为什么可以将类型为double的变量赋值给类型为int的变量呢？实际上这个赋值过程不是一步到位的，而是存在一个 <strong>“中间变量”</strong>。这个中间变量接收d的整数部分，最后再把这个中间变量拷贝给a。需要注意的是，这个中间变量具有<font color="#98d98e"><strong>常属性</strong></font>。引用也是同样的道理：<br> <img src="https://images2.imgbox.com/6d/d3/TUOGla16_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>✪代码分析</strong><br>  a并不是直接引用d，而是引用这个中间变量。由于中间变量具有常属性，所以前面必须加上const修饰避免扩大读写权限。<br> <img src="https://images2.imgbox.com/a4/a2/YgwLSjFc_o.png" alt="在这里插入图片描述"><br>  通过取地址我们可以确认a没有引用d，从而也间接说明了中间临时变量的存在。</p> 
</blockquote> 
<hr> 
<h4><a id="_45"></a>四、引用的基础应用</h4> 
<h5><a id="_46"></a>①对标传址操作</h5> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> tmp <span class="token operator">=</span> a<span class="token punctuation">;</span>
	a <span class="token operator">=</span> b<span class="token punctuation">;</span>
	b <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p> 正是由于引用和引用实体存在互相改变的关系，所以我们可以用引用来替代传值操作。拿我们C语言中常写的swap函数举例，这样写起来是不是更爽了呢？<br>  但如果设计的函数中需要传入常数，那么就必须在参数前面加上const，否则存在扩大实体读写权限的风险。经过实际测试，引用的效率和传址的效率是差不多的。<br>  相应的，一些输出型参数也可以用引用来实现，例如：</p> 
<pre><code class="prism language-c"><span class="token keyword">int</span><span class="token operator">*</span> <span class="token function">sortArray</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> numsSize<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span> returnSize<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>

<span class="token punctuation">}</span>
</code></pre> 
<p> returnSize是我们的输出型参数，在C语言中我们只能通过传址的方式实现，现在用引用也可以实现这样的效果。</p> 
<h5><a id="_73"></a>②作为返回值</h5> 
<pre><code class="prism language-c"><span class="token keyword">int</span><span class="token operator">&amp;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	n<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> n<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p> 用引用作为返回值和传统的方式相比有什么好处呢？我们先来谈谈传统的方式是如何传递返回值的：</p> 
<ul><li>首先将预备返回的值存储到临时变量，再将临时变量拷贝给用于接收函数返回值的变量</li><li>预备返回的变量小则用寄存器存储，变量大则则创建函数栈帧的时候预先为返回值创建存储空间</li></ul> 
<p> 如果我们使用引用，那我们根本就不需要额外的临时空间和额外的拷贝，因为我们是通过引用直接对实体进行操作的，这可以提供程序的效率。<br> <img src="https://images2.imgbox.com/4b/4d/cPQI965T_o.png" alt="在这里插入图片描述" width="400"></p> 
<p> 但是引用作为返回值只适合返回值出作用域不销毁的情况，如上面static修饰的n变量，如果我们我们引用的变量出函数作用域销毁，那我们实际上通过引用创建了<strong>间接的“野指针”</strong>。</p> 
<pre><code class="prism language-c"><span class="token keyword">int</span><span class="token operator">&amp;</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> c <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
	<span class="token keyword">return</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span><span class="token operator">&amp;</span> ret <span class="token operator">=</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Add(1, 2): "</span> <span class="token operator">&lt;&lt;</span> ret <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Add(1, 2): "</span> <span class="token operator">&lt;&lt;</span> ret <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/bd/a3/q43wyjhq_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p> ret的值可能是随机值也可能不是，取决于这块空间有没有被重新覆盖和使用。cout函数栈帧的创建覆盖了Add函数的函数栈帧，所以ret的值变成随机值了</p> 
</blockquote> 
<pre><code>再来看几个变式：
</code></pre> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span><span class="token operator">&amp;</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> c<span class="token punctuation">;</span>
	c <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
	<span class="token keyword">return</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span><span class="token operator">&amp;</span> ret <span class="token operator">=</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Add(1, 2): "</span> <span class="token operator">&lt;&lt;</span> ret <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Add(1, 2): "</span> <span class="token operator">&lt;&lt;</span> ret <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/01/1e/4IHSQovl_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p> 变量c用static修饰后，这块空间出函数作用域后不会被销毁，不用担心被其他函数栈帧所覆盖</p> 
</blockquote> 
<p> </p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span><span class="token operator">&amp;</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> c <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
	<span class="token keyword">return</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span><span class="token operator">&amp;</span> ret <span class="token operator">=</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Add(1, 2): "</span> <span class="token operator">&lt;&lt;</span> ret <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Add(1, 2): "</span> <span class="token operator">&lt;&lt;</span> ret <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f9/6f/AMyzMzbR_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>注意static语句只在初始化时执行一次</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/398f2e59ea4a582955b0dcb8e98a4be7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VSCode像Idea一样为springboot启动设置Environment variables</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f76204970e5fa91e13b8958f2f4e31dd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Flutter】自动测试探索</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>