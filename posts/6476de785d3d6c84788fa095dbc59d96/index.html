<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>关于HAL库外部中断的开关流程 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="关于HAL库外部中断的开关流程" />
<meta property="og:description" content="通过HAL库配置好外部中断后，会生成如下代码：
static void MX_GPIO_Init(void) { GPIO_InitTypeDef GPIO_InitStruct = {0}; /* USER CODE BEGIN MX_GPIO_Init_1 */ /* USER CODE END MX_GPIO_Init_1 */ /* GPIO Ports Clock Enable */ __HAL_RCC_GPIOD_CLK_ENABLE(); __HAL_RCC_GPIOA_CLK_ENABLE(); /*Configure GPIO pin : PA3 */ GPIO_InitStruct.Pin = GPIO_PIN_3; GPIO_InitStruct.Mode = GPIO_MODE_IT_FALLING; GPIO_InitStruct.Pull = GPIO_NOPULL; HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStruct); /* EXTI interrupt init*/ HAL_NVIC_SetPriority(EXTI3_IRQn, 0, 0); HAL_NVIC_EnableIRQ(EXTI3_IRQn); /* USER CODE BEGIN MX_GPIO_Init_2 */ /* USER CODE END MX_GPIO_Init_2 */ } 设置中断引脚
GPIO_InitStruct.Pin = GPIO_PIN_3;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6476de785d3d6c84788fa095dbc59d96/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-03T10:11:57+08:00" />
<meta property="article:modified_time" content="2024-01-03T10:11:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">关于HAL库外部中断的开关流程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>通过HAL库配置好外部中断后，会生成如下代码：</p> 
<pre><code class="hljs">static void MX_GPIO_Init(void)
{
  GPIO_InitTypeDef GPIO_InitStruct = {0};
/* USER CODE BEGIN MX_GPIO_Init_1 */
/* USER CODE END MX_GPIO_Init_1 */

  /* GPIO Ports Clock Enable */
  __HAL_RCC_GPIOD_CLK_ENABLE();
  __HAL_RCC_GPIOA_CLK_ENABLE();

  /*Configure GPIO pin : PA3 */
  GPIO_InitStruct.Pin = GPIO_PIN_3;
  GPIO_InitStruct.Mode = GPIO_MODE_IT_FALLING;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStruct);

  /* EXTI interrupt init*/
  HAL_NVIC_SetPriority(EXTI3_IRQn, 0, 0);
  HAL_NVIC_EnableIRQ(EXTI3_IRQn);

/* USER CODE BEGIN MX_GPIO_Init_2 */
/* USER CODE END MX_GPIO_Init_2 */
}</code></pre> 
<p>设置中断引脚<br>   GPIO_InitStruct.Pin = GPIO_PIN_3;</p> 
<p>设置触发方式<br>   GPIO_InitStruct.Mode = GPIO_MODE_IT_FALLING;</p> 
<p>设置有无上下拉电阻<br>   GPIO_InitStruct.Pull = GPIO_NOPULL;</p> 
<p>初始化<br>   HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStruct);</p> 
<p>设置中断优先级<br>   HAL_NVIC_SetPriority(EXTI3_IRQn, 0, 0);</p> 
<p>中断使能<br>   HAL_NVIC_EnableIRQ(EXTI3_IRQn);</p> 
<p></p> 
<p></p> 
<p>****因此我们要关闭中断只需要在想要关闭的地方写上</p> 
<p>HAL_NVIC_DisableIRQ(EXTI3_IRQn);       </p> 
<p>即可****</p> 
<p></p> 
<p></p> 
<p>关闭中断只是不去执行中断处理函数</p> 
<p>中断处理函数在stm32f1xx_hal_gpio.c(不同型号文件名也不用，可以通过查找中断回调函数HAL_GPIO_EXTI_Callback，点击find all，双击查找到的结果就可以跳转到该文件)</p> 
<pre><code class="hljs">void HAL_GPIO_EXTI_IRQHandler(uint16_t GPIO_Pin)
{
  /* EXTI line interrupt detected */
  if (__HAL_GPIO_EXTI_GET_IT(GPIO_Pin) != 0x00u)
  {
    __HAL_GPIO_EXTI_CLEAR_IT(GPIO_Pin);
    HAL_GPIO_EXTI_Callback(GPIO_Pin);
  }
}</code></pre> 
<p>****生成的中断处理函数中会主动清除中断标志位(__HAL_GPIO_EXTI_CLEAR_IT(GPIO_Pin);)</p> 
<p>因此我们在打开中断前需要手动添加</p> 
<p>__HAL_GPIO_EXTI_CLEAR_IT(GPIO_PIN_3);</p> 
<p>进行中断标志位清零操作****</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bdb4a8fce047be8c98792a5ddc77f14f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用 MATLAB 产生单位抽样序列、单位阶跃序列、矩形序列、正弦序列和复指数序列</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f68cce2442b6172651167f6b7d357afa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java中100==100为true，而1000==1000为false？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>