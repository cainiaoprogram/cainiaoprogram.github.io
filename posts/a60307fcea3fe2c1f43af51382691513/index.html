<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>STM32通用定时器-输入捕获-脉冲计数 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="STM32通用定时器-输入捕获-脉冲计数" />
<meta property="og:description" content="一、知识点 编码器
两相编码器（正交编码器）：两相编码器由 A 相和 B 相组成，相位差为 90 度。当旋转方向为顺时针时，A 相先变化，然后 B 相变化；当旋转方向为逆时针时，B 相先变化，然后 A 相变化。通过检测相位差变化，可以确定旋转的方向。STM32 单片机可以使用定时器的正交编码器模式（Encoder Mode）来实现两相编码器的接口。
四相编码器：四相编码器由 A 相、B 相、C 相和 D 相组成，相位差为 90 度。通过检测相位差变化和不同相位的信号变化情况，可以确定旋转的方向。STM32 单片机可以使用定时器的四相编码器模式（X4 Encoder Mode）来实现四相编码器的接口。
编码器接口
编码器的两个输入引脚，就是每个定时器的CH1和CH2引脚，CH3和CH4不能接编码器。
最终的实验现象，编码器有两个输出，一个是A相，一个是B相，然后接入到STM32，定时器的编码器接口，编码器的接口自动控制定时器时基单元中的CNT计数器，进行自增或自减。比如初始化之后，CNT初始值为0，然后编码器右转，CNT就&#43;&#43;，右转产生一个脉冲，CNT就加一次，比如右转产生10个脉冲后，停下来，那么这个过程CNT就由0自增到10，停下来，编码器左转，CNT就–，左转产生一个脉冲，CNT就自减一次， 比如编码器再左转产生5个脉冲，那CNT就在原来10的基础上自减5，停下来。
编码器接口，其实就相当于是一个带有方向控制的外部时钟，同时控制着CNT的计数时钟和计数方向，这样CNT的值就表示了编码器的位置。如果我们每隔一段时间取一次编码器的值，再把CNT清零，那么每次取出来的值就表示了编码器的速度。
编码器测速实际上就是测频法测正交脉冲的频率，CNT计次，然后每隔一段时间取一次计次，这就是测频法的思路。编码器计次能根据旋转方向，不仅能自增计次还能自减计次，是一个带方向的测速。
每个高级定时器和通用定时器都拥有1个编码器接口。 二、框图 三、编码器计数操作 解释：当Tl1先产生脉冲，Tl2后产生脉冲。（A相先变化，B相后变化）时电机正转，计数器开始计数CNT&#43;&#43;。当产生毛刺时，CNT不计数。Tl2先产生脉冲，Tl1后产生脉冲。（B相先变化，A相后变化）时电机反转，计数器CNT–。当产生毛刺时不计数。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a60307fcea3fe2c1f43af51382691513/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T18:05:23+08:00" />
<meta property="article:modified_time" content="2024-01-05T18:05:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">STM32通用定时器-输入捕获-脉冲计数</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>一、知识点</h3> 
<ol><li>编码器<br>   两相编码器（正交编码器）：两相编码器由 A 相和 B 相组成，相位差为 90 度。当旋转方向为顺时针时，A 相先变化，然后 B 相变化；当旋转方向为逆时针时，B 相先变化，然后 A 相变化。通过检测相位差变化，可以确定旋转的方向。STM32 单片机可以使用定时器的正交编码器模式（Encoder Mode）来实现两相编码器的接口。<br> <img src="https://images2.imgbox.com/44/09/PlXAJF1B_o.png" alt="在这里插入图片描述"></li></ol> 
<p>  四相编码器：四相编码器由 A 相、B 相、C 相和 D 相组成，相位差为 90 度。通过检测相位差变化和不同相位的信号变化情况，可以确定旋转的方向。STM32 单片机可以使用定时器的四相编码器模式（X4 Encoder Mode）来实现四相编码器的接口。</p> 
<ol start="2"><li>编码器接口<br>   编码器的两个输入引脚，就是每个定时器的CH1和CH2引脚，CH3和CH4不能接编码器。<br>   最终的实验现象，编码器有两个输出，一个是A相，一个是B相，然后接入到STM32，定时器的编码器接口，编码器的接口自动控制定时器时基单元中的CNT计数器，进行自增或自减。比如初始化之后，CNT初始值为0，然后编码器右转，CNT就++，右转产生一个脉冲，CNT就加一次，比如右转产生10个脉冲后，停下来，那么这个过程CNT就由0自增到10，停下来，编码器左转，CNT就–，左转产生一个脉冲，CNT就自减一次， 比如编码器再左转产生5个脉冲，那CNT就在原来10的基础上自减5，停下来。<br>   编码器接口，其实就相当于是一个带有方向控制的外部时钟，同时控制着CNT的计数时钟和计数方向，这样CNT的值就表示了编码器的位置。如果我们每隔一段时间取一次编码器的值，再把CNT清零，那么每次取出来的值就表示了编码器的速度。<br>   编码器测速实际上就是测频法测正交脉冲的频率，CNT计次，然后每隔一段时间取一次计次，这就是测频法的思路。编码器计次能根据旋转方向，不仅能自增计次还能自减计次，是一个带方向的测速。<br> 每个高级定时器和通用定时器都拥有1个编码器接口。</li></ol> 
<h3><a id="_14"></a>二、框图</h3> 
<p><img src="https://images2.imgbox.com/9c/46/f46qEaZT_o.png" alt="在这里插入图片描述"><br>   <br> <img src="https://images2.imgbox.com/f5/7e/qySHDyQg_o.png" alt="在这里插入图片描述"><br>   </p> 
<h3><a id="_20"></a>三、编码器计数操作</h3> 
<p><img src="https://images2.imgbox.com/61/aa/E7NPLdqR_o.png" alt="在这里插入图片描述"><br>   解释：当Tl1先产生脉冲，Tl2后产生脉冲。（A相先变化，B相后变化）时电机正转，计数器开始计数CNT++。当产生毛刺时，CNT不计数。Tl2先产生脉冲，Tl1后产生脉冲。（B相先变化，A相后变化）时电机反转，计数器CNT–。当产生毛刺时不计数。</p> 
<p>  <br> <img src="https://images2.imgbox.com/6a/f7/jo7JtohO_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1b0e6b2a0c505c0a63bd9902358561db/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">全网最简单vscode使用Makefile调试多文件的C/C&#43;&#43;代码</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1d25be182a696cca3de2033f87709545/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">小程序购物商城搭建开发分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>