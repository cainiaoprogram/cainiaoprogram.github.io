<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Codeforces 711D  dfs找环 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Codeforces 711D  dfs找环" />
<meta property="og:description" content="D. Directed Roads time limit per test 2 seconds memory limit per test 256 megabytes input standard input output standard output ZS the Coder and Chris the Baboon has explored Udayland for quite some time. They realize that it consists of n towns numbered from 1 to n. There are n directed roads in the Udayland. i-th of them goes from town i to some other town ai (ai ≠ i)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/d16194fe66e4caa974c86c32455ffbb7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-08-30T11:09:00+08:00" />
<meta property="article:modified_time" content="2016-08-30T11:09:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Codeforces 711D  dfs找环</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <div class="problem-statement"> 
  <div class="header"> 
   <div class="title">
     D. Directed Roads 
   </div> 
   <div class="time-limit"> 
    <div class="property-title">
      time limit per test 
    </div> 2 seconds 
   </div> 
   <div class="memory-limit"> 
    <div class="property-title">
      memory limit per test 
    </div> 256 megabytes 
   </div> 
   <div class="input-file"> 
    <div class="property-title">
      input 
    </div> standard input 
   </div> 
   <div class="output-file"> 
    <div class="property-title">
      output 
    </div> standard output 
   </div> 
  </div> 
  <div> 
   <p>ZS the Coder and Chris the Baboon has explored Udayland for quite some time. They realize that it consists of <span class="tex-span"><em>n</em> towns numbered from <span class="tex-span">1 to <span class="tex-span"><em>n</em>. </span></span></span></p> 
   <p>There are <span class="tex-span"><em>n</em> directed roads in the Udayland. <span class="tex-span"><em>i</em>-th of them goes from town <span class="tex-span"><em>i</em> to some other town <span class="tex-span"><em>a</em><sub class="lower-index"><em>i</em></sub> (<span class="tex-span"><em>a</em><sub class="lower-index"><em>i</em></sub> ≠ <em>i</em>). ZS the Coder can flip the direction of any road in Udayland, i.e. if it goes from town <span class="tex-span"><em>A</em> to town <span class="tex-span"><em>B</em> before the flip, it will go from town <span class="tex-span"><em>B</em> to town <span class="tex-span"><em>A</em> after.</span></span></span></span></span></span></span></span></span></p> 
   <p>ZS the Coder considers the roads in the Udayland <span class="tex-font-style-it">confusing, if there is a sequence of distinct towns <span class="tex-span"><em>A</em><sub class="lower-index">1</sub>, <em>A</em><sub class="lower-index">2</sub>, ..., <em>A</em><sub class="lower-index"><em>k</em></sub> (<span class="tex-span"><em>k</em> &gt; 1) such that for every <span class="tex-span">1 ≤ <em>i</em> &lt; <em>k</em> there is a road from town <span class="tex-span"><em>A</em><sub class="lower-index"><em>i</em></sub> to town <span class="tex-span"><em>A</em><sub class="lower-index"><em>i</em> + 1</sub> and another road from town <span class="tex-span"><em>A</em><sub class="lower-index"><em>k</em></sub> to town <span class="tex-span"><em>A</em><sub class="lower-index">1</sub>. In other words, the roads are confusing if <span class="tex-font-style-bf">some of them form a directed cycle of some towns.</span></span></span></span></span></span></span></span></span></p> 
   <p>Now ZS the Coder wonders how many sets of roads (there are <span class="tex-span">2<sup class="upper-index"><em>n</em></sup> variants) in initial configuration can he choose to flip such that after flipping each road in the set exactly once, the resulting network will <span class="tex-font-style-bf">not be confusing.</span></span></p> 
   <p>Note that it is allowed that after the flipping there are more than one directed road from some town and possibly some towns with no roads leading out of it, or multiple roads between any pair of cities.</p> 
  </div> 
  <div class="input-specification"> 
   <div class="section-title">
     Input 
   </div> 
   <p>The first line of the input contains single integer <span class="tex-span"><em>n</em> (<span class="tex-span">2 ≤ <em>n</em> ≤ 2·10<sup class="upper-index">5</sup>) — the number of towns in Udayland.</span></span></p> 
   <p>The next line contains <span class="tex-span"><em>n</em> integers <span class="tex-span"><em>a</em><sub class="lower-index">1</sub>, <em>a</em><sub class="lower-index">2</sub>, ..., <em>a</em><sub class="lower-index"><em>n</em></sub><span class="tex-span">(1 ≤ <em>a</em><sub class="lower-index"><em>i</em></sub> ≤ <em>n</em>, <em>a</em><sub class="lower-index"><em>i</em></sub> ≠ <em>i</em>), <span class="tex-span"><em>a</em><sub class="lower-index"><em>i</em></sub> denotes a road going from town <span class="tex-span"><em>i</em> to town <span class="tex-span"><em>a</em><sub class="lower-index"><em>i</em></sub>.</span></span></span></span></span></span></p> 
  </div> 
  <div class="output-specification"> 
   <div class="section-title">
     Output 
   </div> 
   <p>Print a single integer — the number of ways to flip some set of the roads so that the resulting whole set of all roads is not confusing. Since this number may be too large, print the answer modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7.</span></p> 
  </div> 
  <div class="sample-tests"> 
   <div class="section-title">
     Examples 
   </div> 
   <div class="sample-test"> 
    <div class="input"> 
     <div class="title">
       Input 
     </div> 
     <pre>3<br>2 3 1</pre> 
    </div> 
    <div class="output"> 
     <div class="title">
       Output 
     </div> 
     <pre>6</pre> 
    </div> 
    <div class="input"> 
     <div class="title">
       Input 
     </div> 
     <pre>4<br>2 1 1 1</pre> 
    </div> 
    <div class="output"> 
     <div class="title">
       Output 
     </div> 
     <pre>8</pre> 
    </div> 
    <div class="input"> 
     <div class="title">
       Input 
     </div> 
     <pre>5<br>2 4 2 5 3</pre> 
    </div> 
    <div class="output"> 
     <div class="title">
       Output 
     </div> 
     <pre>28</pre> 
    </div> 
   </div> 
  </div> 
  <div class="note"> 
   <div class="section-title">
     Note 
   </div> 
   <p>Consider the first sample case. There are <span class="tex-span">3 towns and <span class="tex-span">3 roads. The towns are numbered from <span class="tex-span">1 to <span class="tex-span">3 and the roads are <img class="tex-formula" src="https://images2.imgbox.com/d2/9b/PbTxui8H_o.png" alt="" align="middle">, <img class="tex-formula" src="https://images2.imgbox.com/67/eb/3d11NvJ2_o.png" alt="" align="middle">, <img class="tex-formula" src="https://images2.imgbox.com/7c/98/LlUsvVky_o.png" alt="" align="middle"> initially. Number the roads <span class="tex-span">1 to <span class="tex-span">3 in this order. </span></span></span></span></span></span></p> 
   <p>The sets of roads that ZS the Coder can flip (to make them not confusing) are <span class="tex-span">{1}, {2}, {3}, {1, 2}, {1, 3}, {2, 3}. Note that the empty set is invalid because if no roads are flipped, then towns <span class="tex-span">1, 2, 3 is form a directed cycle, so it is confusing. Similarly, flipping all roads is confusing too. Thus, there are a total of <span class="tex-span">6 possible sets ZS the Coder can flip.</span></span></span></p> 
   <p>The sample image shows all possible ways of orienting the roads from the first sample such that the network is <span class="tex-font-style-bf">not confusing.</span></p> 
   <p> </p> 
   <p> </p> 
   <p> </p> 
   <p><img class="tex-graphics" src="https://images2.imgbox.com/9d/fc/qO4jMCJI_o.png" alt=""></p> 
   <p> </p> 
   <p>题意：</p> 
   <p>有一个n个点的有向图，有n条边，分别从每个点出发指向某个点，现在可以把某些边翻转，问总共可以得到多少种无换图？</p> 
   <p>分析：</p> 
   <p>要想得到无换图，那么就需要把环找出来，然后至少翻转一条边就可以了，总的方法数是2^x-2,2是一条边也不翻转和翻转所有边。</p> 
   <p>其他不在环中的边可以翻转也可以不翻转，所以方案数是2^x</p> 
   <div class="cnblogs_code"> 
    <pre>#include&lt;bits/stdc++.h&gt;
<span style="color:#0000ff;">using</span> <span style="color:#0000ff;">namespace</span><span style="color:#000000;"> std;
</span><span style="color:#0000ff;">#define</span> rep(i,s,t) for(int i=(s);i&lt;(t);i++)
<span style="color:#0000ff;">#define</span> per(i,t,s) for(int i=(t);i&gt;=(s);i--)
<span style="color:#0000ff;">#define</span> fi first
<span style="color:#0000ff;">#define</span> se second<span style="color:#000000;">
typedef </span><span style="color:#0000ff;">long</span> <span style="color:#0000ff;">long</span><span style="color:#000000;"> ll;
typedef unsigned </span><span style="color:#0000ff;">long</span> <span style="color:#0000ff;">long</span><span style="color:#000000;"> ull;
typedef pair</span>&lt;<span style="color:#0000ff;">int</span>, <span style="color:#0000ff;">int</span>&gt;<span style="color:#000000;">pii;
</span><span style="color:#0000ff;">const</span> <span style="color:#0000ff;">int</span> mod = 1e9 + <span style="color:#800080;">7</span><span style="color:#000000;">;
</span><span style="color:#0000ff;">const</span> <span style="color:#0000ff;">int</span> N = 2e5 + <span style="color:#800080;">9</span><span style="color:#000000;">;
vector</span>&lt;pii&gt;<span style="color:#000000;">g[N];
</span><span style="color:#0000ff;">int</span><span style="color:#000000;"> r;
</span><span style="color:#0000ff;">int</span><span style="color:#000000;"> d[N], vis[N];
</span><span style="color:#0000ff;">void</span> dfs (<span style="color:#0000ff;">int</span> u, <span style="color:#0000ff;">int</span> fa, <span style="color:#0000ff;">int</span><span style="color:#000000;"> deep) {
    </span><span style="color:#0000ff;">if</span><span style="color:#000000;"> (vis[u]) {
        </span><span style="color:#0000ff;">if</span> (r == <span style="color:#800080;">0</span>) r = deep -<span style="color:#000000;"> d[u];
        </span><span style="color:#0000ff;">return</span><span style="color:#000000;">;
    }
    vis[u] </span>= <span style="color:#800080;">1</span><span style="color:#000000;">;
    d[u] </span>=<span style="color:#000000;"> deep;
    rep (i, </span><span style="color:#800080;">0</span><span style="color:#000000;">, g[u].size() ) {
        </span><span style="color:#0000ff;">if</span> (g[u][i].se == fa) <span style="color:#0000ff;">continue</span><span style="color:#000000;">;
        dfs (g[u][i].fi, g[u][i].se, deep </span>+ <span style="color:#800080;">1</span><span style="color:#000000;">);
    }
}
ll f[N];
</span><span style="color:#0000ff;">int</span><span style="color:#000000;"> main() {
    </span><span style="color:#008000;">//</span><span style="color:#008000;">freopen("f.txt","r",stdin);</span>
    <span style="color:#0000ff;">int</span><span style="color:#000000;"> n, x;
    scanf (</span><span style="color:#800000;">"</span><span style="color:#800000;">%d</span><span style="color:#800000;">"</span>, &amp;<span style="color:#000000;">n);
    f[</span><span style="color:#800080;">0</span>] = <span style="color:#800080;">1</span><span style="color:#000000;">;
    rep (i, </span><span style="color:#800080;">1</span>, n + <span style="color:#800080;">1</span>) f[i] = f[i - <span style="color:#800080;">1</span>] * <span style="color:#800080;">2</span> %<span style="color:#000000;"> mod;
    rep (i, </span><span style="color:#800080;">1</span>, n + <span style="color:#800080;">1</span><span style="color:#000000;">) {
        scanf (</span><span style="color:#800000;">"</span><span style="color:#800000;">%d</span><span style="color:#800000;">"</span>, &amp;<span style="color:#000000;">x);
        g[i].push_back (pii (x, i) );
        g[x].push_back (pii (i, i) );
    }
    ll ans </span>= <span style="color:#800080;">1</span><span style="color:#000000;">;
    </span><span style="color:#0000ff;">int</span> sum = <span style="color:#800080;">0</span><span style="color:#000000;">;
    rep (i, </span><span style="color:#800080;">1</span>, n + <span style="color:#800080;">1</span>) <span style="color:#0000ff;">if</span> (!<span style="color:#000000;">vis[i]) {
        r </span>= <span style="color:#800080;">0</span><span style="color:#000000;">;
        dfs (i, </span><span style="color:#800080;">0</span>, <span style="color:#800080;">0</span><span style="color:#000000;">);
        sum </span>+=<span style="color:#000000;"> r;
        </span><span style="color:#008000;">//</span><span style="color:#008000;">cout&lt;&lt;r&lt;&lt;endl;</span>
        ans = ans * (f[r] - <span style="color:#800080;">2</span>) %<span style="color:#000000;"> mod;
    }
    cout </span>&lt;&lt; ans* (f[n - sum]) % mod &lt;&lt;<span style="color:#000000;"> endl;
    </span><span style="color:#0000ff;">return</span> <span style="color:#800080;">0</span><span style="color:#000000;">;
}</span></pre> 
   </div> 
   <p> </p> 
  </div> 
 </div> 
</div> 
<p>转载于:https://www.cnblogs.com/01world/p/5821190.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7eb129446a0721273ed0af28fb47b07f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ngrok.net 国内ngrok资源网</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5f9d5d93341e972e390500a09d794af3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vtkInteractorStyleRubberBandPick 类简介</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>