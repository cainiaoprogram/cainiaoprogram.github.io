<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Flutter 底部抽屉，三阶滑动； - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Flutter 底部抽屉，三阶滑动；" />
<meta property="og:description" content="Flutter 底部抽屉，三阶滑动，但不跟随手指滑动、效果一般；Head布局可以触发抽屉滑动， 内部的Sliver布局单独滑动；
推荐看这篇文章，支持列表Sliver滑动；Flutter 底部列表抽屉，三阶滑动 ， 支持列表Sliver布局_Choi晨的博客-CSDN博客
、、
import &#39;package:flutter/material.dart&#39;; class SlidingPanel3Controller { _SlidingPanel3ViewState? onState; _addState(_SlidingPanel3ViewState? onState){ this.onState = onState; } void setPanel3State(Panel3State state){ onState?.setPanel3state(state); } Panel3State getPanel3State(){ return onState?._panel3state.value ?? Panel3State.CENTER; } } enum Panel3State { OPEN, CENTER, CLOSE, EXIT } class SlidingPanel3View extends StatefulWidget { final double heightOpen; //展开高度 final double heightCenter; //中间高度 final double heightClose; //闭合高度 final Widget headWidget; //标题布局（内含滑动操作） final Widget bodyWidget; //内容布局 final Panel3State initPanel3state; //初始状态 final Color backColor; //背景色 final SlidingPanel3Controller?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/cd5db12dc7054c81849be59ceac7b2e2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-07T10:22:38+08:00" />
<meta property="article:modified_time" content="2023-06-07T10:22:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Flutter 底部抽屉，三阶滑动；</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>Flutter 底部抽屉，三阶滑动，但不跟随手指滑动、效果一般；Head布局可以触发抽屉滑动， 内部的Sliver布局单独滑动；</p> 
<p>推荐看这篇文章，支持列表Sliver滑动；<a href="https://blog.csdn.net/qq_35605213/article/details/131069198" title="Flutter 底部列表抽屉，三阶滑动 ， 支持列表Sliver布局_Choi晨的博客-CSDN博客">Flutter 底部列表抽屉，三阶滑动 ， 支持列表Sliver布局_Choi晨的博客-CSDN博客</a></p> 
<p>  </p> 
<p><img alt="" height="455" src="https://images2.imgbox.com/81/c6/szwFQ1HH_o.png" width="210">、<img alt="" height="457" src="https://images2.imgbox.com/0c/09/3oA6Qvgw_o.png" width="211">、<img alt="" height="457" src="https://images2.imgbox.com/d0/dd/dYtaFCxh_o.png" width="211"></p> 
<p></p> 
<p></p> 
<pre><code>import 'package:flutter/material.dart';


class SlidingPanel3Controller {
  _SlidingPanel3ViewState? onState;

  _addState(_SlidingPanel3ViewState? onState){
    this.onState = onState;
  }

  void setPanel3State(Panel3State state){
    onState?.setPanel3state(state);
  }

  Panel3State getPanel3State(){
    return onState?._panel3state.value ?? Panel3State.CENTER;
  }

}

enum Panel3State { OPEN, CENTER, CLOSE, EXIT }

class SlidingPanel3View extends StatefulWidget {
  final double heightOpen; //展开高度
  final double heightCenter; //中间高度
  final double heightClose; //闭合高度
  final Widget headWidget; //标题布局（内含滑动操作）
  final Widget bodyWidget; //内容布局
  final Panel3State initPanel3state; //初始状态
  final Color backColor; //背景色
  final SlidingPanel3Controller? slidingPanel3Controller; //控制器

  const SlidingPanel3View(
      {Key? key,
      this.heightOpen = 600,
      this.heightCenter = 360,
      this.heightClose = 100,
      required this.headWidget,
      required this.bodyWidget,
        this.slidingPanel3Controller,
      this.initPanel3state = Panel3State.CENTER,
      this.backColor = Colors.transparent})
      : super(key: key);

  @override
  State&lt;SlidingPanel3View&gt; createState() =&gt; _SlidingPanel3ViewState();
}


class _SlidingPanel3ViewState extends State&lt;SlidingPanel3View&gt; {
  double heightClose = 100;
  double heightCenter = 360;
  double heightOpen = 600;
  final ValueNotifier&lt;Panel3State&gt; _panel3state = ValueNotifier(Panel3State.CENTER);
  SlidingPanel3Controller? slidingPanel3Controller;

  @override
  void initState() {
    super.initState();
    heightClose = widget.heightClose;
    heightCenter = widget.heightCenter;
    heightOpen = widget.heightOpen;
    _panel3state.value = widget.initPanel3state;
    slidingPanel3Controller = widget.slidingPanel3Controller;
    slidingPanel3Controller?._addState(this);

  }

  void setPanel3state(Panel3State s){
    _panel3state.value = s;
  }

  double panelHeight() {
    if (_panel3state.value == Panel3State.OPEN) {
      return heightOpen;
    } else if (_panel3state.value == Panel3State.CENTER) {
      return heightCenter;
    } else if (_panel3state.value == Panel3State.CLOSE) {
      return heightClose;
    } else {
      return 0;
    }
  }

  @override
  Widget build(BuildContext context) {
    return ValueListenableBuilder(
      valueListenable: _panel3state,
      builder: (context, state, child) {
        return AnimatedContainer(
          color: widget.backColor,
          duration: const Duration(milliseconds: 220),
          width: double.infinity,
          height: panelHeight(),
          child: Column(
            children: [HeadView(),  Expanded(child: widget.bodyWidget)],
          ),
        );
      },
    );
  }

  double pointerMove = 0;
  bool isCan = true;

  Widget HeadView() {
    return Listener(
      onPointerDown: (e) {
        pointerMove = e.position.dy;
        isCan = true;
      },
      onPointerMove: (e) {
        if (e.position.dy - pointerMove &gt; 20 &amp;&amp; isCan) {
          // print("手指下滑触发 -- ");
          isCan = false;
          if (_panel3state.value == Panel3State.OPEN) {
            _panel3state.value = Panel3State.CENTER;
          } else if (_panel3state.value == Panel3State.CENTER) {
            _panel3state.value = Panel3State.CLOSE;
          }
        } else if (e.position.dy - pointerMove &lt; -20 &amp;&amp; isCan) {
          // print("手指上滑触发 -- ");
          isCan = false;
          if (_panel3state.value == Panel3State.CLOSE) {
            _panel3state.value = Panel3State.CENTER;
          } else if (_panel3state.value == Panel3State.CENTER) {
            _panel3state.value = Panel3State.OPEN;
          }
        }
      },
      onPointerUp: (e) {
        isCan = true;
      },
      child: widget.headWidget,
    );
  }
}
</code></pre> 
<p></p> 
<p>使用：</p> 
<pre><code>  SlidingPanel3Controller slidingPanel3Controller = SlidingPanel3Controller();

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Stack(
        children: [
          InkWell(
            onTap: (){
              slidingPanel3Controller.setPanel3State(Panel3State.CLOSE);
            },
            child: Container(
              width: double.infinity,
              height: double.infinity,
              color: Colors.blue.withAlpha(88),
            ),
          ),
          Align(
              alignment: AlignmentDirectional.bottomCenter,
              child: SlidingPanel3View(
                heightClose: ScreenUtils.getDip(116),
                heightCenter: ScreenUtils.getDip(330),
                heightOpen: ScreenUtils.getDip(680),
                headWidget: headView(),
                bodyWidget: BodyView(),
                slidingPanel3Controller: slidingPanel3Controller,
                initPanel3state: Panel3State.CENTER,

              )),
        ],
      ),
    );
  }</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c5bea45495e21f184cfd8d6045f1a754/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【VS CODE提示#include错误】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5998e90fc104e0cb010b617ea0a75eae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue3&#43;ts ----element-plus使用日历等插件如何把语言环境英文改成中文</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>