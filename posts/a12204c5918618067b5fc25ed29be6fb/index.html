<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>将指定excel的一列数据提取到另一个excel的指定列 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="将指定excel的一列数据提取到另一个excel的指定列" />
<meta property="og:description" content="#!/usr/bin/env python import openpyxl bj=&#39;D:/地市县公司/西藏台账数据分析-设备台帐分析.xlsx&#39; wb = openpyxl.load_workbook (bj) get_sheets = wb.sheetnames #print(get_sheets) TA01=&#39;TA01&#39; TA02=&#39;TA02&#39; TA03=&#39;TA03&#39; TE01=&#39;TE01&#39; YG201=&#39;YG201&#39; YG202=&#39;YG202&#39; YG203=&#39;YG203&#39; YG204=&#39;YG204&#39; YG205=&#39;YG205&#39; a=0 max=0 for name in get_sheets: ws = wb[name] sheet = wb.active a = 0 num=1 for row in ws: if not all([cell.value == None for cell in row]): num &#43;= 1 i=0 b = [] total=0 while i &lt; num: if TE01 == name: # b.insert(i, ws." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a12204c5918618067b5fc25ed29be6fb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-13T20:08:08+08:00" />
<meta property="article:modified_time" content="2021-03-13T20:08:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">将指定excel的一列数据提取到另一个excel的指定列</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code class="language-python">#!/usr/bin/env python
import openpyxl
bj='D:/地市县公司/西藏台账数据分析-设备台帐分析.xlsx'
wb = openpyxl.load_workbook (bj)
get_sheets = wb.sheetnames
#print(get_sheets)
TA01='TA01'
TA02='TA02'
TA03='TA03'
TE01='TE01'
YG201='YG201'
YG202='YG202'
YG203='YG203'
YG204='YG204'
YG205='YG205'
a=0
max=0
for  name in get_sheets:
    ws = wb[name]
    sheet = wb.active
    a = 0
    num=1
    for row in ws:
        if not all([cell.value == None for cell in row]):
            num += 1
    i=0
    b = []
    total=0
    while i &lt; num:
      if TE01 == name:
      #  b.insert(i, ws.cell(i+5,2).value)
        b.append(ws.cell(i+5,2).value)
        total = num-5
        i = i+1
        #break
      elif TA01 == name:
        #b.insert(i, ws.cell(i + 4, 2).value)
        b.append(ws.cell(i + 4, 2).value)
        total = num - 4
        i = i + 1
      elif TA02 == name:
       # b.insert(i, ws.cell(i + 5, 2).value)
        b.append(ws.cell(i + 5, 2).value)
        total = num - 5
        i = i + 1
        #break
      elif TA03 == name:
       # b.insert(i, ws.cell(i + 4, 2).value)
        b.append(ws.cell(i + 4, 2).value)
        total = num - 4
        i = i + 1
       # break
      elif YG201 == name:
        #b.insert(i, ws.cell(i + 7, 2).value)
        b.append(ws.cell(i + 7, 2).value)
        total = num - 7
        i = i + 1
        #break
      elif YG202 == name:
      #  b.insert(i, ws.cell(i + 7, 2).value)
        b.append(ws.cell(i + 7, 2).value)
        total = num - 7
        i = i + 1
        #break
      elif YG203 == name:
        #b.insert(i, ws.cell(i + 7, 2).value)
        b.append(ws.cell(i + 7, 2).value)
        total = num - 7
        i = i + 1
        #break
      elif YG204 == name:
       # b.insert(i, ws.cell(i + 7, 2).value)
        b.append(ws.cell(i + 7, 2).value)
        total = num - 7
        i = i + 1
        #break
      elif YG205==name:
       # b.insert(i, ws.cell(i + 7, 2).value)
        b.append(ws.cell(i + 7, 2).value)
        total = num - 7
        i = i + 1
        #break
    #print(b)
    c= [ii for ii in b if ii is not None]
    #print(c)
    num1=1
    if TE01 == name:
        wbtest = openpyxl.load_workbook('D:/定员测试数据收集表/1-1客户服务台账数据.xlsx')
        ws = wbtest['供电公司-客户服务台账数据']
        sheet = wb.active
        for row1 in ws:
            if not all([cell1.value == None for cell1 in row1]):
              num1 += 1
        #break
    elif TA01==name:
        wbtest = openpyxl.load_workbook('D:/定员测试数据收集表/1-2电力调度台账数据.xlsx')
        ws = wbtest['供电公司-电力调度台账数据']
        sheet = wb.active
        for row1 in ws:
          if not all([cell1.value == None for cell1 in row1]):
              num1 += 1
    elif TA02 == name:
        wbtest = openpyxl.load_workbook('D:/定员测试数据收集表/1-3输电运检台账数据.xlsx')
        ws = wbtest['供电公司-输电运检台账数据']
        sheet = wb.active
        for row1 in ws:
           if not all([cell1.value == None for cell1 in row1]):
               num1 += 1
        #break
    elif TA03 == name:
        wbtest = openpyxl.load_workbook('D:/定员测试数据收集表/1-4变电运检台账数据.xlsx')
        ws = wbtest['供电公司-变电运检台账数据']
        sheet = wb.active
        for row1 in ws:
           if not all([cell1.value == None for cell1 in row1]):
              num1 += 1
       # break
    elif YG201 == name:
        wbtest = openpyxl.load_workbook('D:/定员测试数据收集表/2-1前端供电服务实际用工数据.xlsx')
        ws = wbtest['供电公司-前端供电服务-实际用工']
        sheet = wb.active
        for row1 in ws:
          if not all([cell1.value == None for cell1 in row1]):
             num1 += 1
    elif YG202 == name:
        wbtest = openpyxl.load_workbook('D:/定员测试数据收集表/2-2供电服务支撑实际用工数据.xlsx')
        ws = wbtest['供电公司-供电服务支撑-实际用工']
        sheet = wb.active
        for row1 in ws:
          if not all([cell1.value == None for cell1 in row1]):
              num1 += 1
    elif YG203 == name:
        wbtest = openpyxl.load_workbook('D:/定员测试数据收集表/2-3电力调度实际用工数据.xlsx')
        ws = wbtest['供电公司-电力调度-实际用工']
        sheet = wb.active
        for row1 in ws:
          if not all([cell1.value == None for cell1 in row1]):
             num1 += 1
    elif YG204 == name:
        wbtest = openpyxl.load_workbook('D:/定员测试数据收集表/2-4输电运检实际用工数据.xlsx')
        ws = wbtest['供电公司-输电运检-实际用工']
        sheet = wb.active
        for row1 in ws:
           if not all([cell1.value == None for cell1 in row1]):
              num1 += 1
    elif YG205 == name:
        wbtest = openpyxl.load_workbook('D:/定员测试数据收集表/2-5变电运检实际用工数据.xlsx')
        ws = wbtest['供电公司-变电运检-实际用工']
        sheet = wb.active
        print(c)
        for row1 in ws:
            if not all([cell1.value == None for cell1 in row1]):
                num1 += 1

    iii=0
    while iii &lt; len(c):

        ws.cell(row=num1+iii, column=2).value = c[iii]
      #  print( c[iii])
        #print(ws.cell(row=num1+iii, column=2).value)
        #ws.cell(row=num1+iii, column=1).value = 1+iii
        iii = iii+1
   # print(c)
    #print(num1)
    #print(TA01)
    if TE01 == name:
      #  print(num1)
        wbtest.save('D:/定员测试数据收集表/1-1客户服务台账数据.xlsx')
    elif TA01 == name:
       # print(name)
        wbtest.save('D:/定员测试数据收集表/1-2电力调度台账数据.xlsx')
    elif TA02 == name:
        wbtest.save('D:/定员测试数据收集表/1-3输电运检台账数据.xlsx')
    elif TA03 == name:
        wbtest.save('D:/定员测试数据收集表/1-4变电运检台账数据.xlsx')
    elif YG201 == name:
        wbtest.save('D:/定员测试数据收集表/2-1前端供电服务实际用工数据.xlsx')
    elif YG202 == name:
        wbtest.save('D:/定员测试数据收集表/2-2供电服务支撑实际用工数据.xlsx')
    elif YG203 == name:
        wbtest.save('D:/定员测试数据收集表/2-3电力调度实际用工数据.xlsx')
    elif YG204 == name:
        wbtest.save('D:/定员测试数据收集表/2-4输电运检实际用工数据.xlsx')
    elif YG205 == name:
        wbtest.save('D:/定员测试数据收集表/2-5变电运检实际用工数据.xlsx')




</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/992dde315259f5c0cedee444220ba66c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">springboot集成spring security实现登录和注销</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ce9afa6ba7e0a9990adb9979b77b1289/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">无法部署应用目录 [D:\Tomcat\apache-tomcat-9.0.44\webapps\ROOT]java.lang.IllegalStateException: 启动子级时出错</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>