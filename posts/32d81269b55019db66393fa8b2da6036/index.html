<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>rest_framework_django 学习笔记二（视图路由） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="rest_framework_django 学习笔记二（视图路由）" />
<meta property="og:description" content="rest_framework_django 学习笔记二（视图路由） rest_framwork_django学习笔记一(序列化器)
一、rest framework 中Request 与 Response 1、Request REST framework 传入视图的request对象不再是Django默认的HttpRequest对象，二是REST Famework 提供的扩展了 Http Request 类的Request 类的对象。
REST framework 提供了 Parser 解析器，在接受到请求后悔自藕丁工具Content-Type 指明的请求数据类型（如JSON、表单等）将请求数据就行parse 解析，解析为类字典对象保存到Request对象中。
Request对象的数据时自动工具前端发送的哪种格式的数据，我们都可以以统一的方式读取数据。
常用属性 1).data request.data 返回解析之后的请求数据 类似于django中标准的 request.POST 和request.FILES属性，但提供如下特性：
包含了解析之后的文件和非文件数据；包含了对POST，PUT，PATCH请求方式解析后的数据；利用REST ftamework 的parsers 解析器，不仅支持表单类型数据，也支持JSON数据； 2）.query_params request.query_params 与 django标准的 request.GET 相同，只是更换了更准确的名称而已。
2、Response rest_framework.response.Response REST framework 提供了一个响应类 Response，使用该类构造响应对象时，响应的具体数据内容会被转换（render渲染）成符合前端需求的类型。
REST framework 提供了 Renderer 渲染器，用来工具请求头中的 Accept （接收数据类型声明）来自自动转换响应数据到对应格式。如果前端请求中为进行 Accept 声明，则会采用默认方式处理响应数据，我们可以通过配置来修改默认响应格式。
# settings.py # ================================================= # # ***************** REST_FRAMEWORK **************** # # ================================================= # REST_FRAMEWORK = { &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/32d81269b55019db66393fa8b2da6036/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-30T14:19:24+08:00" />
<meta property="article:modified_time" content="2023-11-30T14:19:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">rest_framework_django 学习笔记二（视图路由）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="rest_framework_django__0"></a>rest_framework_django 学习笔记二（视图路由）</h2> 
<p><a href="https://blog.csdn.net/weixin_51715424/article/details/134681145">rest_framwork_django学习笔记一(序列化器)</a></p> 
<h2><a id="rest_framework_Request__Response_4"></a>一、rest framework 中Request 与 Response</h2> 
<h3><a id="1Request_6"></a>1、Request</h3> 
<p>REST framework 传入视图的request对象不再是Django默认的HttpRequest对象，二是REST Famework 提供的扩展了 Http Request 类的Request 类的对象。</p> 
<p>REST framework 提供了 Parser 解析器，在接受到请求后悔自藕丁工具Content-Type 指明的请求数据类型（如JSON、表单等）将请求数据就行parse 解析，解析为类字典对象保存到Request对象中。</p> 
<p>Request对象的数据时自动工具前端发送的哪种格式的数据，我们都可以以统一的方式读取数据。</p> 
<h4><a id="_14"></a>常用属性</h4> 
<h5><a id="1data_16"></a>1).data</h5> 
<p>request.data 返回解析之后的请求数据 类似于django中标准的 request.POST 和request.FILES属性，但提供如下特性：</p> 
<ul><li>包含了解析之后的文件和非文件数据；</li><li>包含了对POST，PUT，PATCH请求方式解析后的数据；</li><li>利用REST ftamework 的parsers <strong>解析器</strong>，不仅支持表单类型数据，也支持JSON数据；</li></ul> 
<h5><a id="2query_params_24"></a>2）.query_params</h5> 
<p>request.query_params 与 django标准的 request.GET 相同，只是更换了更准确的名称而已。</p> 
<h3><a id="2Response_28"></a>2、Response</h3> 
<pre><code class="prism language-python">rest_framework<span class="token punctuation">.</span>response<span class="token punctuation">.</span>Response
</code></pre> 
<p>REST framework 提供了一个响应类 Response，使用该类构造响应对象时，响应的具体数据内容会被转换（render<strong>渲染</strong>）成符合前端需求的类型。</p> 
<p>REST framework 提供了 Renderer 渲染器，用来工具请求头中的 Accept （接收数据类型声明）来自自动转换响应数据到对应格式。如果前端请求中为进行 Accept 声明，则会采用默认方式处理响应数据，我们可以通过配置来修改默认响应格式。</p> 
<pre><code class="prism language-python"><span class="token comment"># settings.py</span>
<span class="token comment"># ================================================= #</span>
<span class="token comment"># ***************** REST_FRAMEWORK **************** #</span>
<span class="token comment"># ================================================= #</span>
REST_FRAMEWORK <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string">"DATETIME_FORMAT"</span><span class="token punctuation">:</span> <span class="token string">"%Y-%m-%d %H:%M:%S"</span><span class="token punctuation">,</span>  <span class="token comment"># 日期时间格式配置</span>
	<span class="token string">"DATE_FORMAT"</span><span class="token punctuation">:</span> <span class="token string">"%Y-%m-%d"</span><span class="token punctuation">,</span>
	<span class="token string">'DEFAULT_PERMISSION_CLASSES'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">'rest_framework.renderers.JONSRenderer'</span><span class="token punctuation">,</span><span class="token comment">#json 渲染器</span>
        <span class="token string">'rest_framework.renderers,BrowsableAPIRenderer'</span><span class="token punctuation">,</span><span class="token comment"># 浏览API渲染器</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_54"></a>构造方式</h4> 
<pre><code class="prism language-python">Response<span class="token punctuation">(</span>data<span class="token punctuation">,</span>status<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>template_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>headers<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>content_type<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre> 
<p>data 数据不要是 render 处理之后的数据，只是传递 python 的内建类型数据即可，REST framework 会使用 renderer 渲染器处理 data .</p> 
<p>data不能是复杂结构的数据，如 Django的模型对象，对于这样的数据我们可以使用 Serializer 序列化器序列化处理后（转为了python字典类型）再传递给 data 参数。</p> 
<h4><a id="_64"></a><strong>参数说明：</strong></h4> 
<ul><li>data：为响应准备的序列化处理后的数据；</li><li>status：状态吗，默认200；</li><li>template_name：末班名称，如果使用HTMLRenderer 时需要指明；</li><li>headers：用于存放响应头信息的字典；</li><li>content_type:响应数据的Content_type，通常此参数无需传递，REST framework 会工具前端所需类型数据来设置该参数。</li></ul> 
<h4><a id="_72"></a>常用属性</h4> 
<h5><a id="1data_74"></a>1).data</h5> 
<p>传给 response 对象的序列化后，但尚未 render 处理的数据</p> 
<h6><a id="2status_code_78"></a>2）.status_code</h6> 
<p>状态码的数字</p> 
<h5><a id="3content_82"></a>3）.content</h5> 
<p>结果 render 处理后的响应数据</p> 
<h4><a id="_86"></a>状态码</h4> 
<p>为了方便设置状态码 REST framework 在 <strong>rest_framework.status</strong> 模块中提供了常用状态码常量。</p> 
<pre><code class="prism language-python">rest_framework<span class="token punctuation">.</span>status
</code></pre> 
<h5><a id="1__1xx_94"></a>1)信息告知 - 1xx</h5> 
<pre><code class="prism language-python">HTTP_100_CONTINUE <span class="token operator">=</span> <span class="token number">100</span>
HTTP_101_SWITCHING_PROTOCOLS <span class="token operator">=</span> <span class="token number">101</span>
HTTP_102_PROCESSING <span class="token operator">=</span> <span class="token number">102</span>
HTTP_103_EARLY_HINTS <span class="token operator">=</span> <span class="token number">103</span>
</code></pre> 
<h5><a id="2___2xx_105"></a>2) 成功 - 2xx</h5> 
<pre><code class="prism language-python">HTTP_200_OK <span class="token operator">=</span> <span class="token number">200</span>
HTTP_201_CREATED <span class="token operator">=</span> <span class="token number">201</span>
HTTP_202_ACCEPTED <span class="token operator">=</span> <span class="token number">202</span>
HTTP_203_NON_AUTHORITATIVE_INFORMATION <span class="token operator">=</span> <span class="token number">203</span>
HTTP_204_NO_CONTENT <span class="token operator">=</span> <span class="token number">204</span>
HTTP_205_RESET_CONTENT <span class="token operator">=</span> <span class="token number">205</span>
HTTP_206_PARTIAL_CONTENT <span class="token operator">=</span> <span class="token number">206</span>
HTTP_207_MULTI_STATUS <span class="token operator">=</span> <span class="token number">207</span>
HTTP_208_ALREADY_REPORTED <span class="token operator">=</span> <span class="token number">208</span>
HTTP_226_IM_USED <span class="token operator">=</span> <span class="token number">226</span>
</code></pre> 
<h5><a id="3__3xx_120"></a>3)重定向 - 3xx</h5> 
<pre><code class="prism language-python">HTTP_300_MULTIPLE_CHOICES <span class="token operator">=</span> <span class="token number">300</span>
HTTP_301_MOVED_PERMANENTLY <span class="token operator">=</span> <span class="token number">301</span>
HTTP_302_FOUND <span class="token operator">=</span> <span class="token number">302</span>
HTTP_303_SEE_OTHER <span class="token operator">=</span> <span class="token number">303</span>
HTTP_304_NOT_MODIFIED <span class="token operator">=</span> <span class="token number">304</span>
HTTP_305_USE_PROXY <span class="token operator">=</span> <span class="token number">305</span>
HTTP_306_RESERVED <span class="token operator">=</span> <span class="token number">306</span>
HTTP_307_TEMPORARY_REDIRECT <span class="token operator">=</span> <span class="token number">307</span>
HTTP_308_PERMANENT_REDIRECT <span class="token operator">=</span> <span class="token number">308</span>
</code></pre> 
<h5><a id="4__4xx_134"></a>4)客户端错误 - 4xx</h5> 
<pre><code class="prism language-python">HTTP_400_BAD_REQUEST <span class="token operator">=</span> <span class="token number">400</span>
HTTP_401_UNAUTHORIZED <span class="token operator">=</span> <span class="token number">401</span>
HTTP_402_PAYMENT_REQUIRED <span class="token operator">=</span> <span class="token number">402</span>
HTTP_403_FORBIDDEN <span class="token operator">=</span> <span class="token number">403</span>
HTTP_404_NOT_FOUND <span class="token operator">=</span> <span class="token number">404</span>
HTTP_405_METHOD_NOT_ALLOWED <span class="token operator">=</span> <span class="token number">405</span>
HTTP_406_NOT_ACCEPTABLE <span class="token operator">=</span> <span class="token number">406</span>
HTTP_407_PROXY_AUTHENTICATION_REQUIRED <span class="token operator">=</span> <span class="token number">407</span>
HTTP_408_REQUEST_TIMEOUT <span class="token operator">=</span> <span class="token number">408</span>
HTTP_409_CONFLICT <span class="token operator">=</span> <span class="token number">409</span>
HTTP_410_GONE <span class="token operator">=</span> <span class="token number">410</span>
HTTP_411_LENGTH_REQUIRED <span class="token operator">=</span> <span class="token number">411</span>
HTTP_412_PRECONDITION_FAILED <span class="token operator">=</span> <span class="token number">412</span>
HTTP_413_REQUEST_ENTITY_TOO_LARGE <span class="token operator">=</span> <span class="token number">413</span>
HTTP_414_REQUEST_URI_TOO_LONG <span class="token operator">=</span> <span class="token number">414</span>
HTTP_415_UNSUPPORTED_MEDIA_TYPE <span class="token operator">=</span> <span class="token number">415</span>
HTTP_416_REQUESTED_RANGE_NOT_SATISFIABLE <span class="token operator">=</span> <span class="token number">416</span>
HTTP_417_EXPECTATION_FAILED <span class="token operator">=</span> <span class="token number">417</span>
HTTP_418_IM_A_TEAPOT <span class="token operator">=</span> <span class="token number">418</span>
HTTP_421_MISDIRECTED_REQUEST <span class="token operator">=</span> <span class="token number">421</span>
HTTP_422_UNPROCESSABLE_ENTITY <span class="token operator">=</span> <span class="token number">422</span>
HTTP_423_LOCKED <span class="token operator">=</span> <span class="token number">423</span>
HTTP_424_FAILED_DEPENDENCY <span class="token operator">=</span> <span class="token number">424</span>
HTTP_425_TOO_EARLY <span class="token operator">=</span> <span class="token number">425</span>
HTTP_426_UPGRADE_REQUIRED <span class="token operator">=</span> <span class="token number">426</span>
HTTP_428_PRECONDITION_REQUIRED <span class="token operator">=</span> <span class="token number">428</span>
HTTP_429_TOO_MANY_REQUESTS <span class="token operator">=</span> <span class="token number">429</span>
HTTP_431_REQUEST_HEADER_FIELDS_TOO_LARGE <span class="token operator">=</span> <span class="token number">431</span>
HTTP_451_UNAVAILABLE_FOR_LEGAL_REASONS <span class="token operator">=</span> <span class="token number">451</span>
</code></pre> 
<h5><a id="5__5xx_168"></a>5)服务端错误 - 5xx</h5> 
<pre><code class="prism language-python">HTTP_500_INTERNAL_SERVER_ERROR <span class="token operator">=</span> <span class="token number">500</span>
HTTP_501_NOT_IMPLEMENTED <span class="token operator">=</span> <span class="token number">501</span>
HTTP_502_BAD_GATEWAY <span class="token operator">=</span> <span class="token number">502</span>
HTTP_503_SERVICE_UNAVAILABLE <span class="token operator">=</span> <span class="token number">503</span>
HTTP_504_GATEWAY_TIMEOUT <span class="token operator">=</span> <span class="token number">504</span>
HTTP_505_HTTP_VERSION_NOT_SUPPORTED <span class="token operator">=</span> <span class="token number">505</span>
HTTP_506_VARIANT_ALSO_NEGOTIATES <span class="token operator">=</span> <span class="token number">506</span>
HTTP_507_INSUFFICIENT_STORAGE <span class="token operator">=</span> <span class="token number">507</span>
HTTP_508_LOOP_DETECTED <span class="token operator">=</span> <span class="token number">508</span>
HTTP_509_BANDWIDTH_LIMIT_EXCEEDED <span class="token operator">=</span> <span class="token number">509</span>
HTTP_510_NOT_EXTENDED <span class="token operator">=</span> <span class="token number">510</span>
HTTP_511_NETWORK_AUTHENTICATION_REQUIRED <span class="token operator">=</span> <span class="token number">511</span>
</code></pre> 
<h3><a id="_184"></a>自定义返回</h3> 
<pre><code class="prism language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response

<span class="token keyword">class</span> <span class="token class-name">SuccessResponse</span><span class="token punctuation">(</span>Response<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    标准响应成功的返回, SuccessResponse(data)或者SuccessResponse(data=data)
    (1)默认code返回2000, 不支持指定其他返回码
    """</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> msg<span class="token operator">=</span><span class="token string">'success'</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> template_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> exception<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                 content_type<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>page<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>limit<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>total<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        std_data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
            <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string">"page"</span><span class="token punctuation">:</span> page<span class="token punctuation">,</span>
                <span class="token string">"limit"</span><span class="token punctuation">:</span> limit<span class="token punctuation">,</span>
                <span class="token string">"total"</span><span class="token punctuation">:</span> total<span class="token punctuation">,</span>
                <span class="token string">"data"</span><span class="token punctuation">:</span> data
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"msg"</span><span class="token punctuation">:</span> msg
        <span class="token punctuation">}</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>std_data<span class="token punctuation">,</span> status<span class="token punctuation">,</span> template_name<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> exception<span class="token punctuation">,</span> content_type<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">DetailResponse</span><span class="token punctuation">(</span>Response<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    不包含分页信息的接口返回,主要用于单条数据查询
    (1)默认code返回2000, 不支持指定其他返回码
    """</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> 
                 msg<span class="token operator">=</span><span class="token string">'success'</span><span class="token punctuation">,</span> 
                 status<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> 
                 template_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> 
                 headers<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> 
                 exception<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                 content_type<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        std_data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
            <span class="token string">"data"</span><span class="token punctuation">:</span> data<span class="token punctuation">,</span>
            <span class="token string">"msg"</span><span class="token punctuation">:</span> msg
        <span class="token punctuation">}</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>std_data<span class="token punctuation">,</span> status<span class="token punctuation">,</span> template_name<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> exception<span class="token punctuation">,</span> content_type<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">ErrorResponse</span><span class="token punctuation">(</span>Response<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    标准响应错误的返回,ErrorResponse(msg='xxx')
    (1)默认错误码返回400, 也可以指定其他返回码:ErrorResponse(code=xxx)
    """</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> msg<span class="token operator">=</span><span class="token string">'error'</span><span class="token punctuation">,</span> code<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> template_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
                 exception<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> content_type<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        std_data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"code"</span><span class="token punctuation">:</span> code<span class="token punctuation">,</span>
            <span class="token string">"data"</span><span class="token punctuation">:</span> data<span class="token punctuation">,</span>
            <span class="token string">"msg"</span><span class="token punctuation">:</span> msg
        <span class="token punctuation">}</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>std_data<span class="token punctuation">,</span> status<span class="token punctuation">,</span> template_name<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> exception<span class="token punctuation">,</span> content_type<span class="token punctuation">)</span>


</code></pre> 
<h2><a id="_248"></a>二、视图</h2> 
<h3><a id="1_250"></a>1、两个基类</h3> 
<h4><a id="11_APIView_252"></a>1.1 APIView</h4> 
<pre><code>rest_framework.views.APIView
</code></pre> 
<p>APIView 是 REST framework 提供的所有视图的基类，<strong>继承自django的 view 父类</strong>。</p> 
<p>APIView 与 view 的不同之处在于：</p> 
<ul><li>传入到视图方法中的是REST framework 的 request 对象，而不是 django 的 HttpRequest 对象；</li><li>视图方法可以返回 REST framework 的 Response 对象，视图会响应数据设置（render）符合前端要求的格式；</li><li>任何 APIException 异常都会被捕获到，并且处理成合适的响应学习；</li><li>在进行 dispatch() 分发前，会对请求进行<strong>身份认证、权限检查、流量控制</strong>；</li></ul> 
<p><strong>支持定义的属性：</strong></p> 
<ul><li>authentication_classes 列表或原则，身份认证类；</li><li>permissoin_classes 列表或元祖，权限检查类；</li><li>throttle_classes 列表或元祖，流量控制类；</li></ul> 
<p>在 APIView 中仍以常规的类视图定义方法来实现 get()\post() 或者其他请求方式的方法。</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">''' 序列化器 '''</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author<span class="token punctuation">,</span>AuthorDetail
<span class="token keyword">class</span> <span class="token class-name">PublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Publish
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">''' urls.py '''</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
		path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishListAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
		path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:id&gt;/'</span><span class="token punctuation">,</span>PublishDetaAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>
</code></pre> 
<h5><a id="1_295"></a>1）查询列表</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>


<span class="token keyword">class</span> <span class="token class-name">PublishListAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 列表视图 '''</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询所有 '''</span>
		publish_list <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>publish_list<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/85/18/Mh9yKKjY_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="2_316"></a>2）增</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">class</span> <span class="token class-name">PublishListAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 列表视图 '''</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询所有 '''</span>
		publish_list <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>publish_list<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		response <span class="token operator">=</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
		<span class="token keyword">return</span> response
		<span class="token comment"># return Response(serializer.data)</span>
	<span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 新增 '''</span>
		<span class="token comment"># 1、获取前端传入的数据</span>
		data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
		<span class="token comment"># 2、创建序列化器进行反序列化</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
		<span class="token comment"># 3、调用序列化器 is_valid 方法进行校验</span>
		serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		<span class="token comment"># 4、调用序列化器的save() 方法进行执行 create 方法</span>
		serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token comment"># 5、响应</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a9/d4/FZYPZoXR_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="3_349"></a>3）删</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> status
<span class="token keyword">class</span> <span class="token class-name">PublishDetaAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 详情列表 '''</span>
	<span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">try</span><span class="token punctuation">:</span>
			publish <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">except</span> Publish<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
			<span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_404_NOT_FOUND<span class="token punctuation">)</span>
		publish<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_200_OK<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ea/ff/yR4lxNfU_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="4_372"></a>4）改</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> status

<span class="token keyword">class</span> <span class="token class-name">PublishDetaAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 详情列表 '''</span>
	<span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 修改 '''</span>
		<span class="token comment"># 1、查询修改内容</span>
		publish_obj <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token keyword">not</span> publish_obj<span class="token punctuation">:</span>
			<span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_404_NOT_FOUND<span class="token punctuation">)</span>
		<span class="token comment"># 2、获取前端出入的请求体数据</span>
		data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
		<span class="token comment"># 3、创建序列化器进行反序列化</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>publish_obj<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
		<span class="token comment"># 4、校验</span>
		serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token comment"># 5、保存</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/20/cf/Ga749cBU_o.png" alt="在这里插入图片描述"></p> 
<p>增删查改代码全</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">''' urls.py'''</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishListAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图  增加、查询数据列表</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:id&gt;/'</span><span class="token punctuation">,</span>PublishDetaAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图  删除、单一查询、修改</span>
<span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book<span class="token punctuation">,</span> Publish<span class="token punctuation">,</span> Author<span class="token punctuation">,</span>AuthorDetail
<span class="token keyword">class</span> <span class="token class-name">PublishSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">''' 序列化器 '''</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Publish
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models
<span class="token triple-quoted-string string">''' models.py '''</span>
<span class="token keyword">class</span> <span class="token class-name">Publish</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
	name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
	city <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span>
	email <span class="token operator">=</span> models<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
		verbose_name <span class="token operator">=</span> <span class="token string">'出版社表'</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># coding=utf-8</span>
<span class="token triple-quoted-string string">'''
@date：2023/11/20 13:37
@mail：xiaochun235@qq.com
@Content:
APIView 序列化器
'''</span>
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> status


<span class="token keyword">class</span> <span class="token class-name">PublishListAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 列表视图 '''</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询所有 '''</span>
		publish_list <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>publish_list<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		response <span class="token operator">=</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
		<span class="token keyword">return</span> response
		<span class="token comment"># return Response(serializer.data)</span>
	<span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 新增 '''</span>
		<span class="token comment"># 1、获取前端传入的数据</span>
		data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
		<span class="token comment"># 2、创建序列化器进行反序列化</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
		<span class="token comment"># 3、调用序列化器 is_valid 方法进行校验</span>
		serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		<span class="token comment"># 4、调用序列化器的save() 方法进行执行 create 方法</span>
		serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token comment"># 5、响应</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">PublishDetaAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 详情列表 '''</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询 pk  '''</span>
		<span class="token comment"># 查询pk</span>
		publish_obj <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk <span class="token operator">=</span> <span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token keyword">not</span> publish_obj<span class="token punctuation">:</span>
			<span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_404_NOT_FOUND<span class="token punctuation">)</span>
		<span class="token comment"># 将查询内容序列化</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance <span class="token operator">=</span> publish_obj<span class="token punctuation">)</span>
		<span class="token comment"># 响应</span>
		response <span class="token operator">=</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
		<span class="token keyword">return</span> response
	<span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 修改 '''</span>
		<span class="token comment"># 1、查询修改内容</span>
		publish_obj <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token keyword">not</span> publish_obj<span class="token punctuation">:</span>
			<span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_404_NOT_FOUND<span class="token punctuation">)</span>
		<span class="token comment"># 2、获取前端出入的请求体数据</span>
		data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
		<span class="token comment"># 3、创建序列化器进行反序列化</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>publish_obj<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
		<span class="token comment"># 4、校验</span>
		serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token comment"># 5、保存</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 删除 '''</span>
		<span class="token keyword">try</span><span class="token punctuation">:</span>
			publish <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">except</span> Publish<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
			<span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_404_NOT_FOUND<span class="token punctuation">)</span>
		publish<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_200_OK<span class="token punctuation">)</span>

</code></pre> 
<h4><a id="12__GenericAPIView_511"></a>1.2 GenericAPIView</h4> 
<p><img src="https://images2.imgbox.com/3c/b2/rvl1I3wx_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">rest_framework<span class="token punctuation">.</span>generics<span class="token punctuation">.</span>GenericAPIView
</code></pre> 
<p>继承自 APIVIew，<strong>主要增加了操作序列化器和数据查询的方法，作用是为了Mixin扩展类的执行提供方法支持，通常在使用时，可搭配一个或多个 Mixin扩展类</strong>；</p> 
<p>提供的相关序列化器使用的属性与方法</p> 
<h5><a id="_524"></a>属性：</h5> 
<ul><li>serializer_class 指明视图使用的序列化器</li></ul> 
<h5><a id="_528"></a>方法：</h5> 
<ul><li>get_serializer_class(self)</li></ul> 
<p>返回序列化器类，默认范湖 serializer_class，可以 重写。例如：</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">get_serializer_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>user<span class="token punctuation">.</span>is_staff<span class="token punctuation">:</span>
		<span class="token keyword">return</span> FullAccounSerializer
	<span class="token keyword">return</span> BasicAccountSerializer
</code></pre> 
<ul><li>get_serializer(self,args,*Kwargs)</li></ul> 
<p>返回序列化器对象，主要用来提供给Mixin扩展类使用，如果我们在视图中想要获取序列化器对象也可以直接调用此方法。</p> 
<p><strong>注意，该方法在提供序列化器对象的时候，会向序列化器对象的 context属性补充三个数据：request、format、view，这三个数据对象可以在定义序列化器时使用。</strong></p> 
<ul><li>request 当前视图的请求对象</li><li>view 当前请求的类视图对象</li><li>format 当前请求期望返回的数据格式</li></ul> 
<h5><a id="_551"></a>提供的关于数据库查询的属性与方法</h5> 
<h6><a id="_553"></a>属性：</h6> 
<ul><li>queryser 指明使用的数据查询集</li></ul> 
<h6><a id="_557"></a>方法：</h6> 
<ul><li>get_queryset(self)</li></ul> 
<p>返回视图使用的<strong>查询集</strong>，主要用来提供给Mixin 扩展使用，是列表视图与相求视图获取数据的基础，默认返回 queryset 属性，可以重写，例如：</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span>  <span class="token function">get_queryset</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
	user <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>user
	<span class="token keyword">return</span>  user<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>get_object(self)</li></ul> 
<p>返回详情视图所需的模型类数据对象，主要用来提供给Mixin扩展类使用。</p> 
<p>在视图中可以调用该方法获取详情学习的模型类对象。</p> 
<p>若详情访问的模型类对象不存在，会返回404.</p> 
<p>该方法默认使用 APIView 提供的check_object_permissions 方法检查当前对象是否有权限被访问。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>generics <span class="token keyword">import</span> GenericAPIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">class</span> <span class="token class-name">PublishListGenericAPIView</span><span class="token punctuation">(</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token comment"># 指定序列化器的 类</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
	<span class="token comment"># 指定查询集 ’数据来源‘</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>reqest<span class="token punctuation">)</span><span class="token punctuation">:</span>
		publish <span class="token operator">=</span> self<span class="token punctuation">.</span>get_queryset<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 获取所有数据</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>publish<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment"># 构造序列化器对象</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">PublishDetaGenericAPIView</span><span class="token punctuation">(</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 详情视图 '''</span>
	<span class="token comment"># 指定序列化器的 类</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
	<span class="token comment"># 指定查询集 ’数据来源‘</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询 单一'''</span>
		publish <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 查询单一</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>publish<span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<p>urls.py</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span>generic_apiview_views <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token comment"># GenericAPIView</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishListGenericAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
	<span class="token comment"># GenericAPIView</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:pk&gt;/'</span><span class="token punctuation">,</span>PublishDetaGenericAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fc/68/u0bfe4oY_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_623"></a>其他扩展</h5> 
<ul><li><strong>pagination_class</strong> 指明<strong>分页</strong>控制类</li><li><strong>filter_backends</strong> 指明<strong>过滤控制</strong>后端</li><li><strong>ordering_fields</strong> 指明<strong>过滤中的排序</strong>后端</li><li><strong>authentication_classes</strong> 指明<strong>认证</strong>后端</li><li><strong>permission_classes</strong> 指明<strong>权限</strong>后端</li></ul> 
<h5><a id="1_633"></a>1）查询、修改、单个查询</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span>generic_apiview_views <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token comment"># GenericAPIView</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishListGenericAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
	<span class="token comment"># GenericAPIView</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:pk&gt;/'</span><span class="token punctuation">,</span>PublishDetaGenericAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>generics <span class="token keyword">import</span> GenericAPIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">class</span> <span class="token class-name">PublishListGenericAPIView</span><span class="token punctuation">(</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token comment"># 指定序列化器的 类</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
	<span class="token comment"># 指定查询集 ’数据来源‘</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>reqest<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">'''
		'''</span>
		publish <span class="token operator">=</span> self<span class="token punctuation">.</span>get_queryset<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 获取所有数据</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>publish<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment"># 构造序列化器对象</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">PublishDetaGenericAPIView</span><span class="token punctuation">(</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 详情视图 '''</span>
	<span class="token comment"># 指定序列化器的 类</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
	<span class="token comment"># 指定查询集 ’数据来源‘</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询 单一'''</span>
		publish <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 查询单一</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>publish<span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		publish <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>publish<span class="token punctuation">,</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="2__Mixin__686"></a>2） 整合 Mixin 实现简单增删查改操作</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>generics <span class="token keyword">import</span> GenericAPIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>mixins <span class="token keyword">import</span> ListModelMixin<span class="token punctuation">,</span>CreateModelMixin<span class="token punctuation">,</span>DestroyModelMixin<span class="token punctuation">,</span>RetrieveModelMixin<span class="token punctuation">,</span>UpdateModelMixin
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">class</span> <span class="token class-name">PublishListGenericAPIView</span><span class="token punctuation">(</span>ListModelMixin<span class="token punctuation">,</span>CreateModelMixin<span class="token punctuation">,</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token comment"># 指定序列化器的 类</span>
   serializer_class <span class="token operator">=</span> PublishSerializer
   <span class="token comment"># 指定查询集 ’数据来源‘</span>
   queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token triple-quoted-string string">''' 查询 '''</span>
      <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">(</span>request<span class="token operator">=</span>request<span class="token punctuation">)</span>
   <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token triple-quoted-string string">''' 新增 '''</span>
      <span class="token keyword">return</span> self<span class="token punctuation">.</span>create<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">PublishDetaGenericAPIView</span><span class="token punctuation">(</span>RetrieveModelMixin<span class="token punctuation">,</span>DestroyModelMixin<span class="token punctuation">,</span>UpdateModelMixin<span class="token punctuation">,</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 详情视图 '''</span>
	<span class="token comment"># 指定序列化器的 类</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
	<span class="token comment"># 指定查询集 ’数据来源‘</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询 单一'''</span>
		<span class="token keyword">return</span> self<span class="token punctuation">.</span>retrieve<span class="token punctuation">(</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 修改 '''</span>
		<span class="token keyword">return</span> self<span class="token punctuation">.</span>update<span class="token punctuation">(</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 删除 '''</span>
		<span class="token keyword">return</span> self<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3c/c2/DpYJljsr_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="3__GenericApiView_725"></a>3) 简化后的 GenericApiView增删查改</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span>generic_apiview_views <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token comment"># GenericAPIView</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishListGenericAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
	<span class="token comment"># GenericAPIView</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:pk&gt;/'</span><span class="token punctuation">,</span>PublishDetaGenericAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python">rest_framework<span class="token punctuation">.</span>generics<span class="token punctuation">.</span>ListAPIView <span class="token comment"># 列表查询</span>
rest_framework<span class="token punctuation">.</span>generics<span class="token punctuation">.</span>CreateAPIView <span class="token comment"># 新增</span>
rest_framework<span class="token punctuation">.</span>generics<span class="token punctuation">.</span>UpdateAPIView  <span class="token comment"># 修改</span>
rest_framework<span class="token punctuation">.</span>generics<span class="token punctuation">.</span>DestroyAPIView  <span class="token comment">#删除 </span>
rest_framework<span class="token punctuation">.</span>generics<span class="token punctuation">.</span>RetrieveAPIView <span class="token comment"># 查询一条数据</span>
rest_framework<span class="token punctuation">.</span>generics<span class="token punctuation">.</span>ListCreateAPIView  <span class="token comment"># 列表查询 + 新增</span>
rest_framework<span class="token punctuation">.</span>generics<span class="token punctuation">.</span>RetrieveUpdateDestroyAPIView <span class="token comment"># 单个查询，修改，删除</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>generics <span class="token keyword">import</span> GenericAPIView<span class="token punctuation">,</span>\
	ListAPIView<span class="token punctuation">,</span>\
	CreateAPIView<span class="token punctuation">,</span>\
	UpdateAPIView<span class="token punctuation">,</span>\
	DestroyAPIView<span class="token punctuation">,</span>\
	RetrieveAPIView<span class="token punctuation">,</span>\
	ListCreateAPIView<span class="token punctuation">,</span>\
	RetrieveUpdateDestroyAPIView
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">class</span> <span class="token class-name">PublishListGenericAPIView</span><span class="token punctuation">(</span>ListCreateAPIView<span class="token punctuation">,</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token comment"># 指定序列化器的 类</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
	<span class="token comment"># 指定查询集 ’数据来源‘</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">PublishDetaGenericAPIView</span><span class="token punctuation">(</span>RetrieveUpdateDestroyAPIView<span class="token punctuation">,</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 详情视图 '''</span>
	<span class="token comment"># 指定序列化器的 类</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
	<span class="token comment"># 指定查询集 ’数据来源‘</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/73/57/UqiFbgOo_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/31/d8/P4fsdxcD_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2ViewSet_782"></a>2、视图集ViewSet</h3> 
<h4><a id="21_ViewSet_784"></a>2.1 ViewSet</h4> 
<p>使用视图集 ViewSet，可以将一系列逻辑相关的动作放到一个类中：</p> 
<ul><li><strong>list() 提供一组数据</strong></li><li><strong>retrieve() 提供单个数据</strong></li><li><strong>create() 创建数据</strong></li><li><strong>update() 保存数据</strong></li><li><strong>destory() 删除数据</strong></li></ul> 
<p>ViewSet 视图集类不再实现 get()、post() 等方法，而是实现动作 action 如list()、create() 等。</p> 
<p>视图集只在使用 as_view() 方法的时候，才会到 action 动作与具体请求方式对应上，如：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> ViewSet
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> PublishSerializer
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">class</span> <span class="token class-name">PublishViewset</span><span class="token punctuation">(</span>ViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">def</span> <span class="token function">list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		objects_filter <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>objects_filter<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">''' 方法未实现 '''</span>
		<span class="token keyword">pass</span>
	<span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">''' 方法未实现 '''</span>
		<span class="token keyword">pass</span>
	<span class="token keyword">def</span> <span class="token function">get_by</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		objects_filter <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span>pk<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>objects_filter<span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">''' 方法未实现 '''</span>
		<span class="token keyword">pass</span>

</code></pre> 
<p>在设置路由时，我们可以如下操作：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span>view_set_views <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token comment"># GenericAPIView</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishViewset<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span><span class="token string">'list'</span><span class="token punctuation">,</span><span class="token string">'post'</span><span class="token punctuation">:</span><span class="token string">'add'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
	<span class="token comment"># GenericAPIView</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:pk&gt;/'</span><span class="token punctuation">,</span>PublishViewset<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span><span class="token string">'get_by'</span><span class="token punctuation">,</span><span class="token string">'delete'</span><span class="token punctuation">:</span><span class="token string">'delete'</span><span class="token punctuation">,</span><span class="token string">'put'</span><span class="token punctuation">:</span><span class="token string">'update'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/51/dd/v9wbX0PQ_o.png" alt="在这里插入图片描述"></p> 
<p>继承自 APIView 与ViewSetMixin ，作用也与APIView 基本类似，提供了身份认证、权限校验、流量管理等。</p> 
<p><strong>ViewSet 主要通过继承ViewSetMixin 来实现在调用 as_view() 时传入字典（如{‘get’:‘list’}）的映射处理工作。</strong></p> 
<p>在ViewSet中，没有提供如何动作 action 方法，需要我们自己实现 action 方法</p> 
<h4><a id="22_GenericViewset_847"></a>2.2 GenericViewset</h4> 
<p>使用ViewSet 通常并不方便，因为list、retrieve、create、update、destory 等方法都需要自己编写、而这些方法与前面讲的 Mixin 扩展类提供的方法同名，所以我们可以通过继承 Mixin 扩展类来服用这些方法而无需自己编写，但是Mixin扩展类依赖于 GenericAPIView ，所以还需要继承 GenericAPIView.</p> 
<p>GenericViewSet 就帮助我们完成了这样的继承工作，继承自 GenericAPIView 与 ViewSetMixin,在实现了调用as_view() 时传入字典（如{‘get’:‘list’}）的映射处理工作同时，还提供了 GenericAPIView 提供的基础方法，可以直接搭配Minxin 扩展类使用。</p> 
<p>举例：</p> 
<p>urls.py</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span>view_set_views <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token comment"># GenericViewSet 整合 mixins</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishViewset<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span><span class="token string">'list'</span><span class="token punctuation">,</span><span class="token string">'post'</span><span class="token punctuation">:</span><span class="token string">'create'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
	<span class="token comment"># GenericViewSet 整合 mixins</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:pk&gt;/'</span><span class="token punctuation">,</span>PublishViewset<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span><span class="token string">'retrieve'</span><span class="token punctuation">,</span><span class="token string">'delete'</span><span class="token punctuation">:</span><span class="token string">'destroy'</span><span class="token punctuation">,</span><span class="token string">'put'</span><span class="token punctuation">:</span><span class="token string">'update'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">''' 原始 GenericViewSet  配合 mixin  '''</span>
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> ViewSet<span class="token punctuation">,</span>GenericViewSet<span class="token punctuation">,</span>ReadOnlyModelViewSet
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>mixins <span class="token keyword">import</span> ListModelMixin<span class="token punctuation">,</span>RetrieveModelMixin<span class="token punctuation">,</span>CreateModelMixin<span class="token punctuation">,</span>UpdateModelMixin<span class="token punctuation">,</span>DestroyModelMixin
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> PublishSerializer
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">class</span> <span class="token class-name">PublishViewset</span><span class="token punctuation">(</span>GenericViewSet<span class="token punctuation">,</span>ListModelMixin<span class="token punctuation">,</span>RetrieveModelMixin<span class="token punctuation">,</span>CreateModelMixin<span class="token punctuation">,</span>DestroyModelMixin<span class="token punctuation">,</span>UpdateModelMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 视图集 '''</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
</code></pre> 
<p><img src="https://images2.imgbox.com/a7/cc/R1OYDLW7_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="23ReadOnlyModelViewSet_889"></a>2.3ReadOnlyModelViewSet</h4> 
<p><img src="https://images2.imgbox.com/64/63/96sjyAoA_o.png" alt="在这里插入图片描述"></p> 
<pre><code>rest_framework.viewsets.ReadOnlyModelViewSet
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> GenericViewSet<span class="token punctuation">,</span>ReadOnlyModelViewSet<span class="token punctuation">,</span>ModelViewSet
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> PublishSerializer
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">class</span> <span class="token class-name">PublishViewset</span><span class="token punctuation">(</span>ReadOnlyModelViewSet<span class="token punctuation">,</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 视图集 '''</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
</code></pre> 
<p><img src="https://images2.imgbox.com/79/22/LOmp2hsD_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="24ModelViewSet_913"></a>2.4ModelViewSet</h4> 
<pre><code>rest_framework.viewsets.ModelViewSet
</code></pre> 
<p><img src="https://images2.imgbox.com/f4/93/Vobwzr3Z_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_action__924"></a>3、视图集中定义附加 action 动作</h3> 
<h4><a id="31___926"></a>3.1 增加自定义方法</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span>view_set_views <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
<span class="token keyword">from</span> <span class="token punctuation">.</span>book_views <span class="token keyword">import</span> BookModelViewSet
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
	path<span class="token punctuation">(</span><span class="token string">'book/'</span><span class="token punctuation">,</span> BookModelViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span> <span class="token string">'post'</span><span class="token punctuation">:</span> <span class="token string">'create'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 列表视图</span>
	path<span class="token punctuation">(</span><span class="token string">'book/&lt;int:pk&gt;/'</span><span class="token punctuation">,</span> BookModelViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span> <span class="token string">'retrieve'</span><span class="token punctuation">,</span> <span class="token string">'delete'</span><span class="token punctuation">:</span> <span class="token string">'destroy'</span><span class="token punctuation">,</span> <span class="token string">'put'</span><span class="token punctuation">:</span> <span class="token string">'update'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token comment"># 详情视图</span>
	path<span class="token punctuation">(</span><span class="token string">'book/get_book'</span><span class="token punctuation">,</span> BookModelViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span> <span class="token string">'get_book'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 通过获取大于 多少钱的书</span>
	path<span class="token punctuation">(</span><span class="token string">'book/&lt;int:pk&gt;/update_book_price'</span><span class="token punctuation">,</span> BookModelViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'put'</span><span class="token punctuation">:</span> <span class="token string">'update_book_price'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 修改书的价格</span>
<span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db<span class="token punctuation">.</span>models <span class="token keyword">import</span> Q
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> ModelViewSet
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookSerializer
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">class</span> <span class="token class-name">BookModelViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
	queryset <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	serializer_class <span class="token operator">=</span> BookSerializer
	<span class="token keyword">def</span> <span class="token function">get_book</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询 price 大于data['price']的书 '''</span>
		data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
		book_qy <span class="token operator">=</span> Q<span class="token punctuation">(</span>price__gt<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
		book_list <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>book_qy<span class="token punctuation">)</span>  <span class="token comment"># 工具id获取最后一本书</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>book_list<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">update_book_price</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 修改某一本书的价格 '''</span>
		book_object <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
		book_object<span class="token punctuation">.</span>price <span class="token operator">=</span> request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span>
		book_object<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>book_object<span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/15/81/HDGgPwJv_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_975"></a>4、总结</h3> 
<h4><a id="41APIView_977"></a>4.1APIView</h4> 
<p>在APIView中的request直接叫 request；</p> 
<p>django中的响应对象叫HttpResponse，而APIView中的叫Response；</p> 
<p>APIView中新增了异常捕获；</p> 
<p>在APIView中可以用序列化器；</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">''' urls.py '''</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
		path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishListAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
		path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:id&gt;/'</span><span class="token punctuation">,</span>PublishDetaAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> status
<span class="token keyword">class</span> <span class="token class-name">PublishListAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 列表视图 '''</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询所有 '''</span>
		publish_list <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>publish_list<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		response <span class="token operator">=</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
		<span class="token keyword">return</span> response
		<span class="token comment"># return Response(serializer.data)</span>
	<span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 新增 '''</span>
		<span class="token comment"># 1、获取前端传入的数据</span>
		data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
		<span class="token comment"># 2、创建序列化器进行反序列化</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
		<span class="token comment"># 3、调用序列化器 is_valid 方法进行校验</span>
		serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		<span class="token comment"># 4、调用序列化器的save() 方法进行执行 create 方法</span>
		serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token comment"># 5、响应</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">PublishDetaAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 详情列表 '''</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询 pk  '''</span>
		<span class="token comment"># 查询pk</span>
		publish_obj <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk <span class="token operator">=</span> <span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token keyword">not</span> publish_obj<span class="token punctuation">:</span>
			<span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_404_NOT_FOUND<span class="token punctuation">)</span>
		<span class="token comment"># 将查询内容序列化</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance <span class="token operator">=</span> publish_obj<span class="token punctuation">)</span>
		<span class="token comment"># 响应</span>
		response <span class="token operator">=</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
		<span class="token keyword">return</span> response
	<span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 修改 '''</span>
		<span class="token comment"># 1、查询修改内容</span>
		publish_obj <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token keyword">not</span> publish_obj<span class="token punctuation">:</span>
			<span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_404_NOT_FOUND<span class="token punctuation">)</span>
		<span class="token comment"># 2、获取前端出入的请求体数据</span>
		data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
		<span class="token comment"># 3、创建序列化器进行反序列化</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>publish_obj<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
		<span class="token comment"># 4、校验</span>
		serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token comment"># 5、保存</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 删除 '''</span>
		<span class="token keyword">try</span><span class="token punctuation">:</span>
			publish <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">except</span> Publish<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
			<span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_404_NOT_FOUND<span class="token punctuation">)</span>
		publish<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_200_OK<span class="token punctuation">)</span>

</code></pre> 
<h4><a id="42GenericAPIView_1064"></a>4.2GenericAPIView</h4> 
<p>GenericAPIView 继承的就是 APIView；</p> 
<p>GenericAPIView 增加了分页和过滤功能；</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">''' urls.py '''</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
		path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishListAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
		path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:id&gt;/'</span><span class="token punctuation">,</span>PublishDetaAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>generics <span class="token keyword">import</span> GenericAPIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">class</span> <span class="token class-name">PublishListGenericAPIView</span><span class="token punctuation">(</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token comment"># 指定序列化器的 类</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
	<span class="token comment"># 指定查询集 ’数据来源‘</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>reqest<span class="token punctuation">)</span><span class="token punctuation">:</span>
		publish <span class="token operator">=</span> self<span class="token punctuation">.</span>get_queryset<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 获取所有数据</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>publish<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment"># 构造序列化器对象</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">PublishDetaGenericAPIView</span><span class="token punctuation">(</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 详情视图 '''</span>
	<span class="token comment"># 指定序列化器的 类</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
	<span class="token comment"># 指定查询集 ’数据来源‘</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询 单一'''</span>
		publish <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 查询单一</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>publish<span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="1__GenericAPIView___Minxin_1106"></a>1) GenericAPIView + Minxin</h5> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">''' urls.py '''</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
		path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishListAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
		path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:id&gt;/'</span><span class="token punctuation">,</span>PublishDetaAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>generics <span class="token keyword">import</span> GenericAPIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>mixins <span class="token keyword">import</span> ListModelMixin<span class="token punctuation">,</span>CreateModelMixin<span class="token punctuation">,</span>DestroyModelMixin<span class="token punctuation">,</span>RetrieveModelMixin<span class="token punctuation">,</span>UpdateModelMixin
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">class</span> <span class="token class-name">PublishListGenericAPIView</span><span class="token punctuation">(</span>ListModelMixin<span class="token punctuation">,</span>CreateModelMixin<span class="token punctuation">,</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token comment"># 指定序列化器的 类</span>
   serializer_class <span class="token operator">=</span> PublishSerializer
   <span class="token comment"># 指定查询集 ’数据来源‘</span>
   queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token triple-quoted-string string">''' 查询 '''</span>
      <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">(</span>request<span class="token operator">=</span>request<span class="token punctuation">)</span>
   <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token triple-quoted-string string">''' 新增 '''</span>
      <span class="token keyword">return</span> self<span class="token punctuation">.</span>create<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">PublishDetaGenericAPIView</span><span class="token punctuation">(</span>RetrieveModelMixin<span class="token punctuation">,</span>DestroyModelMixin<span class="token punctuation">,</span>UpdateModelMixin<span class="token punctuation">,</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">''' 详情视图 '''</span>
	<span class="token comment"># 指定序列化器的 类</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
	<span class="token comment"># 指定查询集 ’数据来源‘</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询 单一'''</span>
		<span class="token keyword">return</span> self<span class="token punctuation">.</span>retrieve<span class="token punctuation">(</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 修改 '''</span>
		<span class="token keyword">return</span> self<span class="token punctuation">.</span>update<span class="token punctuation">(</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 删除 '''</span>
		<span class="token keyword">return</span> self<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="43__ViewSet_1154"></a>4.3 ViewSet</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span>views <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment"># 可以使用 路由器</span>
	<span class="token comment"># ViewSet</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishViewset<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span><span class="token string">'list'</span><span class="token punctuation">,</span><span class="token string">'post'</span><span class="token punctuation">:</span><span class="token string">'add'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
	<span class="token comment"># ViewSet</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:pk&gt;/'</span><span class="token punctuation">,</span>PublishViewset<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span><span class="token string">'get_by'</span><span class="token punctuation">,</span><span class="token string">'delete'</span><span class="token punctuation">:</span><span class="token string">'delete'</span><span class="token punctuation">,</span><span class="token string">'put'</span><span class="token punctuation">:</span><span class="token string">'update'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>

</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> ViewSet
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> PublishSerializer
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">class</span> <span class="token class-name">PublishViewset</span><span class="token punctuation">(</span>ViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">def</span> <span class="token function">list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		objects_filter <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>objects_filter<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token comment"># 注意序列化器中 的第一个参数是 instance 第二个是 data，当没写时，默认从第一个开始</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 删除 '''</span>
		publish <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 查询单一</span>
		publish<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">get_by</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		objects_filter <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span>pk<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> PublishSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>objects_filter<span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		get_object <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>get_object<span class="token punctuation">,</span> request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="44GenericViewSet_1205"></a>4.4GenericViewSet</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span>views <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment"># 可以使用 路由器</span>
	<span class="token comment"># ViewSet</span>
path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishViewset<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span><span class="token string">'list'</span><span class="token punctuation">,</span><span class="token string">'post'</span><span class="token punctuation">:</span><span class="token string">'create'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
	<span class="token comment"># ViewSet</span>
path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:pk&gt;/'</span><span class="token punctuation">,</span>PublishViewset<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span><span class="token string">'retrieve'</span><span class="token punctuation">,</span><span class="token string">'delete'</span><span class="token punctuation">:</span><span class="token string">'destroy'</span><span class="token punctuation">,</span><span class="token string">'put'</span><span class="token punctuation">:</span><span class="token string">'update'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> GenericViewSet
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> PublishSerializer
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">class</span> <span class="token class-name">PublishViewset</span><span class="token punctuation">(</span>GenericViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
	<span class="token keyword">def</span> <span class="token function">list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		data_lis <span class="token operator">=</span> self<span class="token punctuation">.</span>get_queryset<span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>data_lis<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">retrieve</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询 单一'''</span>
		publish <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 查询单一</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>publish<span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">destroy</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 删除 '''</span>
		publish <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 查询单一</span>
		publish<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 修改 '''</span>
		get_object <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>get_object<span class="token punctuation">,</span> request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 新增 '''</span>
		<span class="token comment"># 注意序列化器中 的第一个参数是 instance 第二个是 data，当没写时，默认从第一个开始</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token operator">=</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

</code></pre> 
<h5><a id="1__GenericViewSet___Minxin_1258"></a>1) GenericViewSet + Minxin</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span>view_set_views <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment"># 可以使用 路由器</span>
	<span class="token comment"># GenericAPIView</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/'</span><span class="token punctuation">,</span>PublishViewset<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span><span class="token string">'list'</span><span class="token punctuation">,</span><span class="token string">'post'</span><span class="token punctuation">:</span><span class="token string">'create'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 列表视图</span>
	<span class="token comment"># GenericAPIView</span>
	path<span class="token punctuation">(</span><span class="token string">'publish/&lt;int:pk&gt;/'</span><span class="token punctuation">,</span>PublishViewset<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'get'</span><span class="token punctuation">:</span><span class="token string">'retrieve'</span><span class="token punctuation">,</span><span class="token string">'delete'</span><span class="token punctuation">:</span><span class="token string">'destroy'</span><span class="token punctuation">,</span><span class="token string">'put'</span><span class="token punctuation">:</span><span class="token string">'update'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># 详情视图</span>
<span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> GenericViewSet
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>mixins <span class="token keyword">import</span> ListModelMixin<span class="token punctuation">,</span>\
	RetrieveModelMixin<span class="token punctuation">,</span>\
	CreateModelMixin<span class="token punctuation">,</span>\
	UpdateModelMixin<span class="token punctuation">,</span>\
	DestroyModelMixin
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> PublishSerializer
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">class</span> <span class="token class-name">PublishViewset</span><span class="token punctuation">(</span>GenericViewSet<span class="token punctuation">,</span>ListModelMixin<span class="token punctuation">,</span>RetrieveModelMixin<span class="token punctuation">,</span>CreateModelMixin<span class="token punctuation">,</span>UpdateModelMixin<span class="token punctuation">,</span>DestroyModelMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 由于 mixins 中 已经将重用的方法写了，不用在写 也可以自行重写。</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
</code></pre> 
<h4><a id="45_ModelViewSet_1292"></a>4.5 ModelViewSet</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> ModelViewSet
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> PublishSerializer
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">class</span> <span class="token class-name">PublishViewset</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">''' ModelViewSet 已经继承了mixins中常用的内容 '''</span>
	queryset <span class="token operator">=</span> Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	serializer_class <span class="token operator">=</span> PublishSerializer
</code></pre> 
<p><img src="https://images2.imgbox.com/c7/34/mOBU1Hrw_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_1307"></a>三、路由器</h2> 
<p>路由器只能配合视图一起使用</p> 
<p>视图集：<strong>ViewSet、GenericViewSet 、ModelViewSet</strong></p> 
<pre><code>rest_framework.routers.DefaultRouter
</code></pre> 
<p>路由器只会生成默认的五个路由</p> 
<p><img src="https://images2.imgbox.com/1b/c1/kfxSkCvT_o.png" alt="在这里插入图片描述"></p> 
<p>其余的还需要自己手动加入</p> 
<p>路由器使用方法：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>routers <span class="token keyword">import</span> DefaultRouter
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 其他手动加入的路由内容</span>
router <span class="token operator">=</span> DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 创建路由器</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">'book'</span><span class="token punctuation">,</span>BookModelViewSet<span class="token punctuation">,</span>basename<span class="token operator">=</span><span class="token string">'book'</span><span class="token punctuation">)</span><span class="token comment"># 注册路由</span>
urlpatterns <span class="token operator">+=</span> router<span class="token punctuation">.</span>urls<span class="token comment"># 把生成好的路由拼接到urlpatterns中去</span>
</code></pre> 
<h3><a id="_1334"></a>自定义增加的行为</h3> 
<p>@action(methods=[‘get’],detail=False)</p> 
<p>action 中的参数</p> 
<p>methods 表示的是 请求方式</p> 
<p>detail 表示的是 路由生成方式；当detail=True 时会生成的url 则是 book/+ **PK/方法名/ ** 当 detail=False 时会生成 book/+ **方法名/ **</p> 
<pre><code>rest_framework.decorators.action
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db<span class="token punctuation">.</span>models <span class="token keyword">import</span> Q
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> ModelViewSet
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> action
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookSerializer
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Book
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">class</span> <span class="token class-name">BookModelViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
	queryset <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	serializer_class <span class="token operator">=</span> BookSerializer
	<span class="token comment"># datail 为 False 表示路径名格式应该为：  books/get_book/</span>
	<span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'get'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>detail<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">get_book</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 查询 price 大于data['price']的书 '''</span>
		data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
		book_qy <span class="token operator">=</span> Q<span class="token punctuation">(</span>price__gt<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
		book_list <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>book_qy<span class="token punctuation">)</span>  <span class="token comment"># 工具id获取最后一本书</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>book_list<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

	<span class="token comment"># datail 为 True 表示路径名格式应该为：  books/pk/update_book_price/</span>
	<span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'put'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">update_book_price</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token triple-quoted-string string">''' 修改某一本书的价格 '''</span>
		book_object <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
		book_object<span class="token punctuation">.</span>price <span class="token operator">=</span> request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span>
		book_object<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
		serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>book_object<span class="token punctuation">)</span>
		<span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">''' urls.py '''</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>book_views <span class="token keyword">import</span> BookModelViewSet
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>routers <span class="token keyword">import</span> DefaultRouter
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
router <span class="token operator">=</span> DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 创建路由器</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">'book'</span><span class="token punctuation">,</span>BookModelViewSet<span class="token punctuation">,</span>basename<span class="token operator">=</span><span class="token string">'book'</span><span class="token punctuation">)</span><span class="token comment"># 注册路由</span>
urlpatterns <span class="token operator">+=</span> router<span class="token punctuation">.</span>urls<span class="token comment"># 把生成好的路由拼接到urlpatterns中去</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/db/6a/qlZLXlnj_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="DefaultRouter_1393"></a>DefaultRouter</h3> 
<pre><code>rest_framework.routers.DefaultRouter
</code></pre> 
<h3><a id="SimpleRouter_1401"></a>SimpleRouter</h3> 
<pre><code>rest_framework.routers.SimpleRouter
</code></pre> 
<h3><a id="_1408"></a>注意：</h3> 
<p>SinmpleRouter 和 DefaultRouter 只有一个区别，DefaultRouter 会多生成一个根路由</p> 
<h2><a id="_1413"></a>其他笔记</h2> 
<h3><a id="httpsblogcsdnnetweixin_51715424articledetails134681145_1414"></a><a href="https://blog.csdn.net/weixin_51715424/article/details/134681145">序列化器</a></h3> 
<h3><a id="_1415"></a>视图路由</h3> 
<h3><a id="httpsblogcsdnnetweixin_51715424articledetails134707077_1416"></a><a href="https://blog.csdn.net/weixin_51715424/article/details/134707077">异常、登录认证</a></h3>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7f3fb5eeb59cf59766aa773a21062486/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">rest_framework_django学习笔记一(序列化器)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/03bd6643baf1c2ae3dd72cdcd8e95ff4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">FFmpeg 集成 x265 编译及解码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>